<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html" class="current">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3791464">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3791519">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3791573">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3791624">package</span>&nbsp;<span class="ident" id="3791632">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3791637">import</span>&nbsp;<span class="string" id="3791644">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3791653">type</span>&nbsp;<span class="ident" id="3791658">clientHelloMsg</span>&nbsp;<span class="keyword" id="3791673">struct</span>&nbsp;<span class="op" id="3791680">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791683">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3791703">[</span><span class="op" id="3791704">]</span><span class="builtintype" id="3791705">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791711">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3791731">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791739">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3791759">[</span><span class="op" id="3791760">]</span><span class="builtintype" id="3791761">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791767">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3791787">[</span><span class="op" id="3791788">]</span><span class="builtintype" id="3791789">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791795">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3791815">[</span><span class="op" id="3791816">]</span><span class="builtintype" id="3791817">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791825">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="3791845">[</span><span class="op" id="3791846">]</span><span class="builtintype" id="3791847">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791854">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3791874">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791880">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3791900">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791908">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3791928">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791934">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3791954">[</span><span class="op" id="3791955">]</span><span class="ident" id="3791956">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791965">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3791985">[</span><span class="op" id="3791986">]</span><span class="builtintype" id="3791987">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791994">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3792014">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792020">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3792040">[</span><span class="op" id="3792041">]</span><span class="builtintype" id="3792042">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792049">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="3792069">[</span><span class="op" id="3792070">]</span><span class="ident" id="3792071">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792089">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3792109">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792115">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3792135">[</span><span class="op" id="3792136">]</span><span class="builtintype" id="3792137">string</span><br>
<span class="lineno"></span><span class="op" id="3792144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3792147">func</span>&nbsp;<span class="op" id="3792152">(</span><span class="ident" id="3792153">m</span>&nbsp;<span class="op" id="3792155">*</span><span class="ident" id="3792156">clientHelloMsg</span><span class="op" id="3792170">)</span>&nbsp;<span class="ident" id="3792172">equal</span><span class="op" id="3792177">(</span><span class="ident" id="3792178">i</span>&nbsp;<span class="keyword" id="3792180">interface</span><span class="op" id="3792189">{</span><span class="op" id="3792190">}</span><span class="op" id="3792191">)</span>&nbsp;<span class="builtintype" id="3792193">bool</span>&nbsp;<span class="op" id="3792198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792201">m1</span><span class="op" id="3792203">,</span>&nbsp;<span class="ident" id="3792205">ok</span>&nbsp;<span class="op" id="3792208">:=</span>&nbsp;<span class="ident" id="3792211">i</span><span class="op" id="3792212">.</span><span class="op" id="3792213">(</span><span class="op" id="3792214">*</span><span class="ident" id="3792215">clientHelloMsg</span><span class="op" id="3792229">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3792232">if</span>&nbsp;<span class="op" id="3792235">!</span><span class="ident" id="3792236">ok</span>&nbsp;<span class="op" id="3792239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3792243">return</span>&nbsp;<span class="builtintype" id="3792250">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3792257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3792261">return</span>&nbsp;<span class="ident" id="3792268">bytes</span><span class="op" id="3792273">.</span><span class="ident" id="3792274">Equal</span><span class="op" id="3792279">(</span><span class="ident" id="3792280">m</span><span class="op" id="3792281">.</span><span class="ident" id="3792282">raw</span><span class="op" id="3792285">,</span>&nbsp;<span class="ident" id="3792287">m1</span><span class="op" id="3792289">.</span><span class="ident" id="3792290">raw</span><span class="op" id="3792293">)</span>&nbsp;<span class="op" id="3792295">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792300">m</span><span class="op" id="3792301">.</span><span class="ident" id="3792302">vers</span>&nbsp;<span class="op" id="3792307">==</span>&nbsp;<span class="ident" id="3792310">m1</span><span class="op" id="3792312">.</span><span class="ident" id="3792313">vers</span>&nbsp;<span class="op" id="3792318">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792323">bytes</span><span class="op" id="3792328">.</span><span class="ident" id="3792329">Equal</span><span class="op" id="3792334">(</span><span class="ident" id="3792335">m</span><span class="op" id="3792336">.</span><span class="ident" id="3792337">random</span><span class="op" id="3792343">,</span>&nbsp;<span class="ident" id="3792345">m1</span><span class="op" id="3792347">.</span><span class="ident" id="3792348">random</span><span class="op" id="3792354">)</span>&nbsp;<span class="op" id="3792356">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792361">bytes</span><span class="op" id="3792366">.</span><span class="ident" id="3792367">Equal</span><span class="op" id="3792372">(</span><span class="ident" id="3792373">m</span><span class="op" id="3792374">.</span><span class="ident" id="3792375">sessionId</span><span class="op" id="3792384">,</span>&nbsp;<span class="ident" id="3792386">m1</span><span class="op" id="3792388">.</span><span class="ident" id="3792389">sessionId</span><span class="op" id="3792398">)</span>&nbsp;<span class="op" id="3792400">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792405">eqUint16s</span><span class="op" id="3792414">(</span><span class="ident" id="3792415">m</span><span class="op" id="3792416">.</span><span class="ident" id="3792417">cipherSuites</span><span class="op" id="3792429">,</span>&nbsp;<span class="ident" id="3792431">m1</span><span class="op" id="3792433">.</span><span class="ident" id="3792434">cipherSuites</span><span class="op" id="3792446">)</span>&nbsp;<span class="op" id="3792448">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792453">bytes</span><span class="op" id="3792458">.</span><span class="ident" id="3792459">Equal</span><span class="op" id="3792464">(</span><span class="ident" id="3792465">m</span><span class="op" id="3792466">.</span><span class="ident" id="3792467">compressionMethods</span><span class="op" id="3792485">,</span>&nbsp;<span class="ident" id="3792487">m1</span><span class="op" id="3792489">.</span><span class="ident" id="3792490">compressionMethods</span><span class="op" id="3792508">)</span>&nbsp;<span class="op" id="3792510">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792515">m</span><span class="op" id="3792516">.</span><span class="ident" id="3792517">nextProtoNeg</span>&nbsp;<span class="op" id="3792530">==</span>&nbsp;<span class="ident" id="3792533">m1</span><span class="op" id="3792535">.</span><span class="ident" id="3792536">nextProtoNeg</span>&nbsp;<span class="op" id="3792549">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792554">m</span><span class="op" id="3792555">.</span><span class="ident" id="3792556">serverName</span>&nbsp;<span class="op" id="3792567">==</span>&nbsp;<span class="ident" id="3792570">m1</span><span class="op" id="3792572">.</span><span class="ident" id="3792573">serverName</span>&nbsp;<span class="op" id="3792584">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792589">m</span><span class="op" id="3792590">.</span><span class="ident" id="3792591">ocspStapling</span>&nbsp;<span class="op" id="3792604">==</span>&nbsp;<span class="ident" id="3792607">m1</span><span class="op" id="3792609">.</span><span class="ident" id="3792610">ocspStapling</span>&nbsp;<span class="op" id="3792623">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792628">eqCurveIDs</span><span class="op" id="3792638">(</span><span class="ident" id="3792639">m</span><span class="op" id="3792640">.</span><span class="ident" id="3792641">supportedCurves</span><span class="op" id="3792656">,</span>&nbsp;<span class="ident" id="3792658">m1</span><span class="op" id="3792660">.</span><span class="ident" id="3792661">supportedCurves</span><span class="op" id="3792676">)</span>&nbsp;<span class="op" id="3792678">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792683">bytes</span><span class="op" id="3792688">.</span><span class="ident" id="3792689">Equal</span><span class="op" id="3792694">(</span><span class="ident" id="3792695">m</span><span class="op" id="3792696">.</span><span class="ident" id="3792697">supportedPoints</span><span class="op" id="3792712">,</span>&nbsp;<span class="ident" id="3792714">m1</span><span class="op" id="3792716">.</span><span class="ident" id="3792717">supportedPoints</span><span class="op" id="3792732">)</span>&nbsp;<span class="op" id="3792734">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792739">m</span><span class="op" id="3792740">.</span><span class="ident" id="3792741">ticketSupported</span>&nbsp;<span class="op" id="3792757">==</span>&nbsp;<span class="ident" id="3792760">m1</span><span class="op" id="3792762">.</span><span class="ident" id="3792763">ticketSupported</span>&nbsp;<span class="op" id="3792779">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792784">bytes</span><span class="op" id="3792789">.</span><span class="ident" id="3792790">Equal</span><span class="op" id="3792795">(</span><span class="ident" id="3792796">m</span><span class="op" id="3792797">.</span><span class="ident" id="3792798">sessionTicket</span><span class="op" id="3792811">,</span>&nbsp;<span class="ident" id="3792813">m1</span><span class="op" id="3792815">.</span><span class="ident" id="3792816">sessionTicket</span><span class="op" id="3792829">)</span>&nbsp;<span class="op" id="3792831">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792836">eqSignatureAndHashes</span><span class="op" id="3792856">(</span><span class="ident" id="3792857">m</span><span class="op" id="3792858">.</span><span class="ident" id="3792859">signatureAndHashes</span><span class="op" id="3792877">,</span>&nbsp;<span class="ident" id="3792879">m1</span><span class="op" id="3792881">.</span><span class="ident" id="3792882">signatureAndHashes</span><span class="op" id="3792900">)</span>&nbsp;<span class="op" id="3792902">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792907">m</span><span class="op" id="3792908">.</span><span class="ident" id="3792909">secureRenegotiation</span>&nbsp;<span class="op" id="3792929">==</span>&nbsp;<span class="ident" id="3792932">m1</span><span class="op" id="3792934">.</span><span class="ident" id="3792935">secureRenegotiation</span>&nbsp;<span class="op" id="3792955">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792960">eqStrings</span><span class="op" id="3792969">(</span><span class="ident" id="3792970">m</span><span class="op" id="3792971">.</span><span class="ident" id="3792972">alpnProtocols</span><span class="op" id="3792985">,</span>&nbsp;<span class="ident" id="3792987">m1</span><span class="op" id="3792989">.</span><span class="ident" id="3792990">alpnProtocols</span><span class="op" id="3793003">)</span><br>
<span class="lineno">50</span><span class="op" id="3793005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3793008">func</span>&nbsp;<span class="op" id="3793013">(</span><span class="ident" id="3793014">m</span>&nbsp;<span class="op" id="3793016">*</span><span class="ident" id="3793017">clientHelloMsg</span><span class="op" id="3793031">)</span>&nbsp;<span class="ident" id="3793033">marshal</span><span class="op" id="3793040">(</span><span class="op" id="3793041">)</span>&nbsp;<span class="op" id="3793043">[</span><span class="op" id="3793044">]</span><span class="builtintype" id="3793045">byte</span>&nbsp;<span class="op" id="3793050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793053">if</span>&nbsp;<span class="ident" id="3793056">m</span><span class="op" id="3793057">.</span><span class="ident" id="3793058">raw</span>&nbsp;<span class="op" id="3793062">!=</span>&nbsp;<span class="builtintype" id="3793065">nil</span>&nbsp;<span class="op" id="3793069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793073">return</span>&nbsp;<span class="ident" id="3793080">m</span><span class="op" id="3793081">.</span><span class="ident" id="3793082">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793091">length</span>&nbsp;<span class="op" id="3793098">:=</span>&nbsp;<span class="num" id="3793101">2</span>&nbsp;<span class="op" id="3793103">+</span>&nbsp;<span class="num" id="3793105">32</span>&nbsp;<span class="op" id="3793108">+</span>&nbsp;<span class="num" id="3793110">1</span>&nbsp;<span class="op" id="3793112">+</span>&nbsp;<span class="builtinfunc" id="3793114">len</span><span class="op" id="3793117">(</span><span class="ident" id="3793118">m</span><span class="op" id="3793119">.</span><span class="ident" id="3793120">sessionId</span><span class="op" id="3793129">)</span>&nbsp;<span class="op" id="3793131">+</span>&nbsp;<span class="num" id="3793133">2</span>&nbsp;<span class="op" id="3793135">+</span>&nbsp;<span class="builtinfunc" id="3793137">len</span><span class="op" id="3793140">(</span><span class="ident" id="3793141">m</span><span class="op" id="3793142">.</span><span class="ident" id="3793143">cipherSuites</span><span class="op" id="3793155">)</span><span class="op" id="3793156">*</span><span class="num" id="3793157">2</span>&nbsp;<span class="op" id="3793159">+</span>&nbsp;<span class="num" id="3793161">1</span>&nbsp;<span class="op" id="3793163">+</span>&nbsp;<span class="builtinfunc" id="3793165">len</span><span class="op" id="3793168">(</span><span class="ident" id="3793169">m</span><span class="op" id="3793170">.</span><span class="ident" id="3793171">compressionMethods</span><span class="op" id="3793189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793192">numExtensions</span>&nbsp;<span class="op" id="3793206">:=</span>&nbsp;<span class="num" id="3793209">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793212">extensionsLength</span>&nbsp;<span class="op" id="3793229">:=</span>&nbsp;<span class="num" id="3793232">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793235">if</span>&nbsp;<span class="ident" id="3793238">m</span><span class="op" id="3793239">.</span><span class="ident" id="3793240">nextProtoNeg</span>&nbsp;<span class="op" id="3793253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793257">numExtensions</span><span class="op" id="3793270">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793277">if</span>&nbsp;<span class="ident" id="3793280">m</span><span class="op" id="3793281">.</span><span class="ident" id="3793282">ocspStapling</span>&nbsp;<span class="op" id="3793295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793299">extensionsLength</span>&nbsp;<span class="op" id="3793316">+=</span>&nbsp;<span class="num" id="3793319">1</span>&nbsp;<span class="op" id="3793321">+</span>&nbsp;<span class="num" id="3793323">2</span>&nbsp;<span class="op" id="3793325">+</span>&nbsp;<span class="num" id="3793327">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793331">numExtensions</span><span class="op" id="3793344">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793351">if</span>&nbsp;<span class="builtinfunc" id="3793354">len</span><span class="op" id="3793357">(</span><span class="ident" id="3793358">m</span><span class="op" id="3793359">.</span><span class="ident" id="3793360">serverName</span><span class="op" id="3793370">)</span>&nbsp;<span class="op" id="3793372">&gt;</span>&nbsp;<span class="num" id="3793374">0</span>&nbsp;<span class="op" id="3793376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793380">extensionsLength</span>&nbsp;<span class="op" id="3793397">+=</span>&nbsp;<span class="num" id="3793400">5</span>&nbsp;<span class="op" id="3793402">+</span>&nbsp;<span class="builtinfunc" id="3793404">len</span><span class="op" id="3793407">(</span><span class="ident" id="3793408">m</span><span class="op" id="3793409">.</span><span class="ident" id="3793410">serverName</span><span class="op" id="3793420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793424">numExtensions</span><span class="op" id="3793437">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793444">if</span>&nbsp;<span class="builtinfunc" id="3793447">len</span><span class="op" id="3793450">(</span><span class="ident" id="3793451">m</span><span class="op" id="3793452">.</span><span class="ident" id="3793453">supportedCurves</span><span class="op" id="3793468">)</span>&nbsp;<span class="op" id="3793470">&gt;</span>&nbsp;<span class="num" id="3793472">0</span>&nbsp;<span class="op" id="3793474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793478">extensionsLength</span>&nbsp;<span class="op" id="3793495">+=</span>&nbsp;<span class="num" id="3793498">2</span>&nbsp;<span class="op" id="3793500">+</span>&nbsp;<span class="num" id="3793502">2</span><span class="op" id="3793503">*</span><span class="builtinfunc" id="3793504">len</span><span class="op" id="3793507">(</span><span class="ident" id="3793508">m</span><span class="op" id="3793509">.</span><span class="ident" id="3793510">supportedCurves</span><span class="op" id="3793525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793529">numExtensions</span><span class="op" id="3793542">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793546">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793549">if</span>&nbsp;<span class="builtinfunc" id="3793552">len</span><span class="op" id="3793555">(</span><span class="ident" id="3793556">m</span><span class="op" id="3793557">.</span><span class="ident" id="3793558">supportedPoints</span><span class="op" id="3793573">)</span>&nbsp;<span class="op" id="3793575">&gt;</span>&nbsp;<span class="num" id="3793577">0</span>&nbsp;<span class="op" id="3793579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793583">extensionsLength</span>&nbsp;<span class="op" id="3793600">+=</span>&nbsp;<span class="num" id="3793603">1</span>&nbsp;<span class="op" id="3793605">+</span>&nbsp;<span class="builtinfunc" id="3793607">len</span><span class="op" id="3793610">(</span><span class="ident" id="3793611">m</span><span class="op" id="3793612">.</span><span class="ident" id="3793613">supportedPoints</span><span class="op" id="3793628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793632">numExtensions</span><span class="op" id="3793645">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793652">if</span>&nbsp;<span class="ident" id="3793655">m</span><span class="op" id="3793656">.</span><span class="ident" id="3793657">ticketSupported</span>&nbsp;<span class="op" id="3793673">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793677">extensionsLength</span>&nbsp;<span class="op" id="3793694">+=</span>&nbsp;<span class="builtinfunc" id="3793697">len</span><span class="op" id="3793700">(</span><span class="ident" id="3793701">m</span><span class="op" id="3793702">.</span><span class="ident" id="3793703">sessionTicket</span><span class="op" id="3793716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793720">numExtensions</span><span class="op" id="3793733">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793740">if</span>&nbsp;<span class="builtinfunc" id="3793743">len</span><span class="op" id="3793746">(</span><span class="ident" id="3793747">m</span><span class="op" id="3793748">.</span><span class="ident" id="3793749">signatureAndHashes</span><span class="op" id="3793767">)</span>&nbsp;<span class="op" id="3793769">&gt;</span>&nbsp;<span class="num" id="3793771">0</span>&nbsp;<span class="op" id="3793773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793777">extensionsLength</span>&nbsp;<span class="op" id="3793794">+=</span>&nbsp;<span class="num" id="3793797">2</span>&nbsp;<span class="op" id="3793799">+</span>&nbsp;<span class="num" id="3793801">2</span><span class="op" id="3793802">*</span><span class="builtinfunc" id="3793803">len</span><span class="op" id="3793806">(</span><span class="ident" id="3793807">m</span><span class="op" id="3793808">.</span><span class="ident" id="3793809">signatureAndHashes</span><span class="op" id="3793827">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793831">numExtensions</span><span class="op" id="3793844">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793851">if</span>&nbsp;<span class="ident" id="3793854">m</span><span class="op" id="3793855">.</span><span class="ident" id="3793856">secureRenegotiation</span>&nbsp;<span class="op" id="3793876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793880">extensionsLength</span>&nbsp;<span class="op" id="3793897">+=</span>&nbsp;<span class="num" id="3793900">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793904">numExtensions</span><span class="op" id="3793917">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793924">if</span>&nbsp;<span class="builtinfunc" id="3793927">len</span><span class="op" id="3793930">(</span><span class="ident" id="3793931">m</span><span class="op" id="3793932">.</span><span class="ident" id="3793933">alpnProtocols</span><span class="op" id="3793946">)</span>&nbsp;<span class="op" id="3793948">&gt;</span>&nbsp;<span class="num" id="3793950">0</span>&nbsp;<span class="op" id="3793952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793956">extensionsLength</span>&nbsp;<span class="op" id="3793973">+=</span>&nbsp;<span class="num" id="3793976">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793980">for</span>&nbsp;<span class="ident" id="3793984">_</span><span class="op" id="3793985">,</span>&nbsp;<span class="ident" id="3793987">s</span>&nbsp;<span class="op" id="3793989">:=</span>&nbsp;<span class="keyword" id="3793992">range</span>&nbsp;<span class="ident" id="3793998">m</span><span class="op" id="3793999">.</span><span class="ident" id="3794000">alpnProtocols</span>&nbsp;<span class="op" id="3794014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3794019">if</span>&nbsp;<span class="ident" id="3794022">l</span>&nbsp;<span class="op" id="3794024">:=</span>&nbsp;<span class="builtinfunc" id="3794027">len</span><span class="op" id="3794030">(</span><span class="ident" id="3794031">s</span><span class="op" id="3794032">)</span><span class="op" id="3794033">;</span>&nbsp;<span class="ident" id="3794035">l</span>&nbsp;<span class="op" id="3794037">==</span>&nbsp;<span class="num" id="3794040">0</span>&nbsp;<span class="op" id="3794042">||</span>&nbsp;<span class="ident" id="3794045">l</span>&nbsp;<span class="op" id="3794047">&gt;</span>&nbsp;<span class="num" id="3794049">255</span>&nbsp;<span class="op" id="3794053">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3794059">panic</span><span class="op" id="3794064">(</span><span class="string" id="3794065">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3794088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3794093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794098">extensionsLength</span><span class="op" id="3794114">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794120">extensionsLength</span>&nbsp;<span class="op" id="3794137">+=</span>&nbsp;<span class="builtinfunc" id="3794140">len</span><span class="op" id="3794143">(</span><span class="ident" id="3794144">s</span><span class="op" id="3794145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3794149">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794153">numExtensions</span><span class="op" id="3794166">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3794170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3794173">if</span>&nbsp;<span class="ident" id="3794176">numExtensions</span>&nbsp;<span class="op" id="3794190">&gt;</span>&nbsp;<span class="num" id="3794192">0</span>&nbsp;<span class="op" id="3794194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794198">extensionsLength</span>&nbsp;<span class="op" id="3794215">+=</span>&nbsp;<span class="num" id="3794218">4</span>&nbsp;<span class="op" id="3794220">*</span>&nbsp;<span class="ident" id="3794222">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794238">length</span>&nbsp;<span class="op" id="3794245">+=</span>&nbsp;<span class="num" id="3794248">2</span>&nbsp;<span class="op" id="3794250">+</span>&nbsp;<span class="ident" id="3794252">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3794270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794274">x</span>&nbsp;<span class="op" id="3794276">:=</span>&nbsp;<span class="builtinfunc" id="3794279">make</span><span class="op" id="3794283">(</span><span class="op" id="3794284">[</span><span class="op" id="3794285">]</span><span class="builtintype" id="3794286">byte</span><span class="op" id="3794290">,</span>&nbsp;<span class="num" id="3794292">4</span><span class="op" id="3794293">+</span><span class="ident" id="3794294">length</span><span class="op" id="3794300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794303">x</span><span class="op" id="3794304">[</span><span class="num" id="3794305">0</span><span class="op" id="3794306">]</span>&nbsp;<span class="op" id="3794308">=</span>&nbsp;<span class="ident" id="3794310">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794327">x</span><span class="op" id="3794328">[</span><span class="num" id="3794329">1</span><span class="op" id="3794330">]</span>&nbsp;<span class="op" id="3794332">=</span>&nbsp;<span class="builtintype" id="3794334">uint8</span><span class="op" id="3794339">(</span><span class="ident" id="3794340">length</span>&nbsp;<span class="op" id="3794347">&gt;&gt;</span>&nbsp;<span class="num" id="3794350">16</span><span class="op" id="3794352">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794355">x</span><span class="op" id="3794356">[</span><span class="num" id="3794357">2</span><span class="op" id="3794358">]</span>&nbsp;<span class="op" id="3794360">=</span>&nbsp;<span class="builtintype" id="3794362">uint8</span><span class="op" id="3794367">(</span><span class="ident" id="3794368">length</span>&nbsp;<span class="op" id="3794375">&gt;&gt;</span>&nbsp;<span class="num" id="3794378">8</span><span class="op" id="3794379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794382">x</span><span class="op" id="3794383">[</span><span class="num" id="3794384">3</span><span class="op" id="3794385">]</span>&nbsp;<span class="op" id="3794387">=</span>&nbsp;<span class="builtintype" id="3794389">uint8</span><span class="op" id="3794394">(</span><span class="ident" id="3794395">length</span><span class="op" id="3794401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794404">x</span><span class="op" id="3794405">[</span><span class="num" id="3794406">4</span><span class="op" id="3794407">]</span>&nbsp;<span class="op" id="3794409">=</span>&nbsp;<span class="builtintype" id="3794411">uint8</span><span class="op" id="3794416">(</span><span class="ident" id="3794417">m</span><span class="op" id="3794418">.</span><span class="ident" id="3794419">vers</span>&nbsp;<span class="op" id="3794424">&gt;&gt;</span>&nbsp;<span class="num" id="3794427">8</span><span class="op" id="3794428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794431">x</span><span class="op" id="3794432">[</span><span class="num" id="3794433">5</span><span class="op" id="3794434">]</span>&nbsp;<span class="op" id="3794436">=</span>&nbsp;<span class="builtintype" id="3794438">uint8</span><span class="op" id="3794443">(</span><span class="ident" id="3794444">m</span><span class="op" id="3794445">.</span><span class="ident" id="3794446">vers</span><span class="op" id="3794450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3794453">copy</span><span class="op" id="3794457">(</span><span class="ident" id="3794458">x</span><span class="op" id="3794459">[</span><span class="num" id="3794460">6</span><span class="op" id="3794461">:</span><span class="num" id="3794462">38</span><span class="op" id="3794464">]</span><span class="op" id="3794465">,</span>&nbsp;<span class="ident" id="3794467">m</span><span class="op" id="3794468">.</span><span class="ident" id="3794469">random</span><span class="op" id="3794475">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794478">x</span><span class="op" id="3794479">[</span><span class="num" id="3794480">38</span><span class="op" id="3794482">]</span>&nbsp;<span class="op" id="3794484">=</span>&nbsp;<span class="builtintype" id="3794486">uint8</span><span class="op" id="3794491">(</span><span class="builtinfunc" id="3794492">len</span><span class="op" id="3794495">(</span><span class="ident" id="3794496">m</span><span class="op" id="3794497">.</span><span class="ident" id="3794498">sessionId</span><span class="op" id="3794507">)</span><span class="op" id="3794508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3794511">copy</span><span class="op" id="3794515">(</span><span class="ident" id="3794516">x</span><span class="op" id="3794517">[</span><span class="num" id="3794518">39</span><span class="op" id="3794520">:</span><span class="num" id="3794521">39</span><span class="op" id="3794523">+</span><span class="builtinfunc" id="3794524">len</span><span class="op" id="3794527">(</span><span class="ident" id="3794528">m</span><span class="op" id="3794529">.</span><span class="ident" id="3794530">sessionId</span><span class="op" id="3794539">)</span><span class="op" id="3794540">]</span><span class="op" id="3794541">,</span>&nbsp;<span class="ident" id="3794543">m</span><span class="op" id="3794544">.</span><span class="ident" id="3794545">sessionId</span><span class="op" id="3794554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794557">y</span>&nbsp;<span class="op" id="3794559">:=</span>&nbsp;<span class="ident" id="3794562">x</span><span class="op" id="3794563">[</span><span class="num" id="3794564">39</span><span class="op" id="3794566">+</span><span class="builtinfunc" id="3794567">len</span><span class="op" id="3794570">(</span><span class="ident" id="3794571">m</span><span class="op" id="3794572">.</span><span class="ident" id="3794573">sessionId</span><span class="op" id="3794582">)</span><span class="op" id="3794583">:</span><span class="op" id="3794584">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794587">y</span><span class="op" id="3794588">[</span><span class="num" id="3794589">0</span><span class="op" id="3794590">]</span>&nbsp;<span class="op" id="3794592">=</span>&nbsp;<span class="builtintype" id="3794594">uint8</span><span class="op" id="3794599">(</span><span class="builtinfunc" id="3794600">len</span><span class="op" id="3794603">(</span><span class="ident" id="3794604">m</span><span class="op" id="3794605">.</span><span class="ident" id="3794606">cipherSuites</span><span class="op" id="3794618">)</span>&nbsp;<span class="op" id="3794620">&gt;&gt;</span>&nbsp;<span class="num" id="3794623">7</span><span class="op" id="3794624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794627">y</span><span class="op" id="3794628">[</span><span class="num" id="3794629">1</span><span class="op" id="3794630">]</span>&nbsp;<span class="op" id="3794632">=</span>&nbsp;<span class="builtintype" id="3794634">uint8</span><span class="op" id="3794639">(</span><span class="builtinfunc" id="3794640">len</span><span class="op" id="3794643">(</span><span class="ident" id="3794644">m</span><span class="op" id="3794645">.</span><span class="ident" id="3794646">cipherSuites</span><span class="op" id="3794658">)</span>&nbsp;<span class="op" id="3794660">&lt;&lt;</span>&nbsp;<span class="num" id="3794663">1</span><span class="op" id="3794664">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3794667">for</span>&nbsp;<span class="ident" id="3794671">i</span><span class="op" id="3794672">,</span>&nbsp;<span class="ident" id="3794674">suite</span>&nbsp;<span class="op" id="3794680">:=</span>&nbsp;<span class="keyword" id="3794683">range</span>&nbsp;<span class="ident" id="3794689">m</span><span class="op" id="3794690">.</span><span class="ident" id="3794691">cipherSuites</span>&nbsp;<span class="op" id="3794704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794708">y</span><span class="op" id="3794709">[</span><span class="num" id="3794710">2</span><span class="op" id="3794711">+</span><span class="ident" id="3794712">i</span><span class="op" id="3794713">*</span><span class="num" id="3794714">2</span><span class="op" id="3794715">]</span>&nbsp;<span class="op" id="3794717">=</span>&nbsp;<span class="builtintype" id="3794719">uint8</span><span class="op" id="3794724">(</span><span class="ident" id="3794725">suite</span>&nbsp;<span class="op" id="3794731">&gt;&gt;</span>&nbsp;<span class="num" id="3794734">8</span><span class="op" id="3794735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794739">y</span><span class="op" id="3794740">[</span><span class="num" id="3794741">3</span><span class="op" id="3794742">+</span><span class="ident" id="3794743">i</span><span class="op" id="3794744">*</span><span class="num" id="3794745">2</span><span class="op" id="3794746">]</span>&nbsp;<span class="op" id="3794748">=</span>&nbsp;<span class="builtintype" id="3794750">uint8</span><span class="op" id="3794755">(</span><span class="ident" id="3794756">suite</span><span class="op" id="3794761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3794764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794767">z</span>&nbsp;<span class="op" id="3794769">:=</span>&nbsp;<span class="ident" id="3794772">y</span><span class="op" id="3794773">[</span><span class="num" id="3794774">2</span><span class="op" id="3794775">+</span><span class="builtinfunc" id="3794776">len</span><span class="op" id="3794779">(</span><span class="ident" id="3794780">m</span><span class="op" id="3794781">.</span><span class="ident" id="3794782">cipherSuites</span><span class="op" id="3794794">)</span><span class="op" id="3794795">*</span><span class="num" id="3794796">2</span><span class="op" id="3794797">:</span><span class="op" id="3794798">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794801">z</span><span class="op" id="3794802">[</span><span class="num" id="3794803">0</span><span class="op" id="3794804">]</span>&nbsp;<span class="op" id="3794806">=</span>&nbsp;<span class="builtintype" id="3794808">uint8</span><span class="op" id="3794813">(</span><span class="builtinfunc" id="3794814">len</span><span class="op" id="3794817">(</span><span class="ident" id="3794818">m</span><span class="op" id="3794819">.</span><span class="ident" id="3794820">compressionMethods</span><span class="op" id="3794838">)</span><span class="op" id="3794839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3794842">copy</span><span class="op" id="3794846">(</span><span class="ident" id="3794847">z</span><span class="op" id="3794848">[</span><span class="num" id="3794849">1</span><span class="op" id="3794850">:</span><span class="op" id="3794851">]</span><span class="op" id="3794852">,</span>&nbsp;<span class="ident" id="3794854">m</span><span class="op" id="3794855">.</span><span class="ident" id="3794856">compressionMethods</span><span class="op" id="3794874">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794878">z</span>&nbsp;<span class="op" id="3794880">=</span>&nbsp;<span class="ident" id="3794882">z</span><span class="op" id="3794883">[</span><span class="num" id="3794884">1</span><span class="op" id="3794885">+</span><span class="builtinfunc" id="3794886">len</span><span class="op" id="3794889">(</span><span class="ident" id="3794890">m</span><span class="op" id="3794891">.</span><span class="ident" id="3794892">compressionMethods</span><span class="op" id="3794910">)</span><span class="op" id="3794911">:</span><span class="op" id="3794912">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3794915">if</span>&nbsp;<span class="ident" id="3794918">numExtensions</span>&nbsp;<span class="op" id="3794932">&gt;</span>&nbsp;<span class="num" id="3794934">0</span>&nbsp;<span class="op" id="3794936">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794940">z</span><span class="op" id="3794941">[</span><span class="num" id="3794942">0</span><span class="op" id="3794943">]</span>&nbsp;<span class="op" id="3794945">=</span>&nbsp;<span class="builtintype" id="3794947">byte</span><span class="op" id="3794951">(</span><span class="ident" id="3794952">extensionsLength</span>&nbsp;<span class="op" id="3794969">&gt;&gt;</span>&nbsp;<span class="num" id="3794972">8</span><span class="op" id="3794973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794977">z</span><span class="op" id="3794978">[</span><span class="num" id="3794979">1</span><span class="op" id="3794980">]</span>&nbsp;<span class="op" id="3794982">=</span>&nbsp;<span class="builtintype" id="3794984">byte</span><span class="op" id="3794988">(</span><span class="ident" id="3794989">extensionsLength</span><span class="op" id="3795005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795009">z</span>&nbsp;<span class="op" id="3795011">=</span>&nbsp;<span class="ident" id="3795013">z</span><span class="op" id="3795014">[</span><span class="num" id="3795015">2</span><span class="op" id="3795016">:</span><span class="op" id="3795017">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3795020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3795023">if</span>&nbsp;<span class="ident" id="3795026">m</span><span class="op" id="3795027">.</span><span class="ident" id="3795028">nextProtoNeg</span>&nbsp;<span class="op" id="3795041">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795045">z</span><span class="op" id="3795046">[</span><span class="num" id="3795047">0</span><span class="op" id="3795048">]</span>&nbsp;<span class="op" id="3795050">=</span>&nbsp;<span class="builtintype" id="3795052">byte</span><span class="op" id="3795056">(</span><span class="ident" id="3795057">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3795079">&gt;&gt;</span>&nbsp;<span class="num" id="3795082">8</span><span class="op" id="3795083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795087">z</span><span class="op" id="3795088">[</span><span class="num" id="3795089">1</span><span class="op" id="3795090">]</span>&nbsp;<span class="op" id="3795092">=</span>&nbsp;<span class="builtintype" id="3795094">byte</span><span class="op" id="3795098">(</span><span class="ident" id="3795099">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3795121">&amp;</span>&nbsp;<span class="num" id="3795123">0xff</span><span class="op" id="3795127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795131">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795159">z</span>&nbsp;<span class="op" id="3795161">=</span>&nbsp;<span class="ident" id="3795163">z</span><span class="op" id="3795164">[</span><span class="num" id="3795165">4</span><span class="op" id="3795166">:</span><span class="op" id="3795167">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3795170">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3795173">if</span>&nbsp;<span class="builtinfunc" id="3795176">len</span><span class="op" id="3795179">(</span><span class="ident" id="3795180">m</span><span class="op" id="3795181">.</span><span class="ident" id="3795182">serverName</span><span class="op" id="3795192">)</span>&nbsp;<span class="op" id="3795194">&gt;</span>&nbsp;<span class="num" id="3795196">0</span>&nbsp;<span class="op" id="3795198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795202">z</span><span class="op" id="3795203">[</span><span class="num" id="3795204">0</span><span class="op" id="3795205">]</span>&nbsp;<span class="op" id="3795207">=</span>&nbsp;<span class="builtintype" id="3795209">byte</span><span class="op" id="3795213">(</span><span class="ident" id="3795214">extensionServerName</span>&nbsp;<span class="op" id="3795234">&gt;&gt;</span>&nbsp;<span class="num" id="3795237">8</span><span class="op" id="3795238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795242">z</span><span class="op" id="3795243">[</span><span class="num" id="3795244">1</span><span class="op" id="3795245">]</span>&nbsp;<span class="op" id="3795247">=</span>&nbsp;<span class="builtintype" id="3795249">byte</span><span class="op" id="3795253">(</span><span class="ident" id="3795254">extensionServerName</span>&nbsp;<span class="op" id="3795274">&amp;</span>&nbsp;<span class="num" id="3795276">0xff</span><span class="op" id="3795280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795284">l</span>&nbsp;<span class="op" id="3795286">:=</span>&nbsp;<span class="builtinfunc" id="3795289">len</span><span class="op" id="3795292">(</span><span class="ident" id="3795293">m</span><span class="op" id="3795294">.</span><span class="ident" id="3795295">serverName</span><span class="op" id="3795305">)</span>&nbsp;<span class="op" id="3795307">+</span>&nbsp;<span class="num" id="3795309">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795313">z</span><span class="op" id="3795314">[</span><span class="num" id="3795315">2</span><span class="op" id="3795316">]</span>&nbsp;<span class="op" id="3795318">=</span>&nbsp;<span class="builtintype" id="3795320">byte</span><span class="op" id="3795324">(</span><span class="ident" id="3795325">l</span>&nbsp;<span class="op" id="3795327">&gt;&gt;</span>&nbsp;<span class="num" id="3795330">8</span><span class="op" id="3795331">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795335">z</span><span class="op" id="3795336">[</span><span class="num" id="3795337">3</span><span class="op" id="3795338">]</span>&nbsp;<span class="op" id="3795340">=</span>&nbsp;<span class="builtintype" id="3795342">byte</span><span class="op" id="3795346">(</span><span class="ident" id="3795347">l</span><span class="op" id="3795348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795352">z</span>&nbsp;<span class="op" id="3795354">=</span>&nbsp;<span class="ident" id="3795356">z</span><span class="op" id="3795357">[</span><span class="num" id="3795358">4</span><span class="op" id="3795359">:</span><span class="op" id="3795360">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795365">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795392">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795397">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795411">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795440">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795470">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795509">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795526">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795545">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795550">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795562">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795591">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795608">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795613">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795646">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795651">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795665">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795713">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795737">z</span><span class="op" id="3795738">[</span><span class="num" id="3795739">0</span><span class="op" id="3795740">]</span>&nbsp;<span class="op" id="3795742">=</span>&nbsp;<span class="builtintype" id="3795744">byte</span><span class="op" id="3795748">(</span><span class="op" id="3795749">(</span><span class="builtinfunc" id="3795750">len</span><span class="op" id="3795753">(</span><span class="ident" id="3795754">m</span><span class="op" id="3795755">.</span><span class="ident" id="3795756">serverName</span><span class="op" id="3795766">)</span>&nbsp;<span class="op" id="3795768">+</span>&nbsp;<span class="num" id="3795770">3</span><span class="op" id="3795771">)</span>&nbsp;<span class="op" id="3795773">&gt;&gt;</span>&nbsp;<span class="num" id="3795776">8</span><span class="op" id="3795777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795781">z</span><span class="op" id="3795782">[</span><span class="num" id="3795783">1</span><span class="op" id="3795784">]</span>&nbsp;<span class="op" id="3795786">=</span>&nbsp;<span class="builtintype" id="3795788">byte</span><span class="op" id="3795792">(</span><span class="builtinfunc" id="3795793">len</span><span class="op" id="3795796">(</span><span class="ident" id="3795797">m</span><span class="op" id="3795798">.</span><span class="ident" id="3795799">serverName</span><span class="op" id="3795809">)</span>&nbsp;<span class="op" id="3795811">+</span>&nbsp;<span class="num" id="3795813">3</span><span class="op" id="3795814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795818">z</span><span class="op" id="3795819">[</span><span class="num" id="3795820">3</span><span class="op" id="3795821">]</span>&nbsp;<span class="op" id="3795823">=</span>&nbsp;<span class="builtintype" id="3795825">byte</span><span class="op" id="3795829">(</span><span class="builtinfunc" id="3795830">len</span><span class="op" id="3795833">(</span><span class="ident" id="3795834">m</span><span class="op" id="3795835">.</span><span class="ident" id="3795836">serverName</span><span class="op" id="3795846">)</span>&nbsp;<span class="op" id="3795848">&gt;&gt;</span>&nbsp;<span class="num" id="3795851">8</span><span class="op" id="3795852">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795856">z</span><span class="op" id="3795857">[</span><span class="num" id="3795858">4</span><span class="op" id="3795859">]</span>&nbsp;<span class="op" id="3795861">=</span>&nbsp;<span class="builtintype" id="3795863">byte</span><span class="op" id="3795867">(</span><span class="builtinfunc" id="3795868">len</span><span class="op" id="3795871">(</span><span class="ident" id="3795872">m</span><span class="op" id="3795873">.</span><span class="ident" id="3795874">serverName</span><span class="op" id="3795884">)</span><span class="op" id="3795885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3795889">copy</span><span class="op" id="3795893">(</span><span class="ident" id="3795894">z</span><span class="op" id="3795895">[</span><span class="num" id="3795896">5</span><span class="op" id="3795897">:</span><span class="op" id="3795898">]</span><span class="op" id="3795899">,</span>&nbsp;<span class="op" id="3795901">[</span><span class="op" id="3795902">]</span><span class="builtintype" id="3795903">byte</span><span class="op" id="3795907">(</span><span class="ident" id="3795908">m</span><span class="op" id="3795909">.</span><span class="ident" id="3795910">serverName</span><span class="op" id="3795920">)</span><span class="op" id="3795921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795925">z</span>&nbsp;<span class="op" id="3795927">=</span>&nbsp;<span class="ident" id="3795929">z</span><span class="op" id="3795930">[</span><span class="ident" id="3795931">l</span><span class="op" id="3795932">:</span><span class="op" id="3795933">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3795936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3795939">if</span>&nbsp;<span class="ident" id="3795942">m</span><span class="op" id="3795943">.</span><span class="ident" id="3795944">ocspStapling</span>&nbsp;<span class="op" id="3795957">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3795961">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3795988">z</span><span class="op" id="3795989">[</span><span class="num" id="3795990">0</span><span class="op" id="3795991">]</span>&nbsp;<span class="op" id="3795993">=</span>&nbsp;<span class="builtintype" id="3795995">byte</span><span class="op" id="3795999">(</span><span class="ident" id="3796000">extensionStatusRequest</span>&nbsp;<span class="op" id="3796023">&gt;&gt;</span>&nbsp;<span class="num" id="3796026">8</span><span class="op" id="3796027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796031">z</span><span class="op" id="3796032">[</span><span class="num" id="3796033">1</span><span class="op" id="3796034">]</span>&nbsp;<span class="op" id="3796036">=</span>&nbsp;<span class="builtintype" id="3796038">byte</span><span class="op" id="3796042">(</span><span class="ident" id="3796043">extensionStatusRequest</span><span class="op" id="3796065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796069">z</span><span class="op" id="3796070">[</span><span class="num" id="3796071">2</span><span class="op" id="3796072">]</span>&nbsp;<span class="op" id="3796074">=</span>&nbsp;<span class="num" id="3796076">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796080">z</span><span class="op" id="3796081">[</span><span class="num" id="3796082">3</span><span class="op" id="3796083">]</span>&nbsp;<span class="op" id="3796085">=</span>&nbsp;<span class="num" id="3796087">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796091">z</span><span class="op" id="3796092">[</span><span class="num" id="3796093">4</span><span class="op" id="3796094">]</span>&nbsp;<span class="op" id="3796096">=</span>&nbsp;<span class="num" id="3796098">1</span>&nbsp;<span class="comment" id="3796100">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3796115">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796165">z</span>&nbsp;<span class="op" id="3796167">=</span>&nbsp;<span class="ident" id="3796169">z</span><span class="op" id="3796170">[</span><span class="num" id="3796171">9</span><span class="op" id="3796172">:</span><span class="op" id="3796173">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3796176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3796179">if</span>&nbsp;<span class="builtinfunc" id="3796182">len</span><span class="op" id="3796185">(</span><span class="ident" id="3796186">m</span><span class="op" id="3796187">.</span><span class="ident" id="3796188">supportedCurves</span><span class="op" id="3796203">)</span>&nbsp;<span class="op" id="3796205">&gt;</span>&nbsp;<span class="num" id="3796207">0</span>&nbsp;<span class="op" id="3796209">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3796213">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796267">z</span><span class="op" id="3796268">[</span><span class="num" id="3796269">0</span><span class="op" id="3796270">]</span>&nbsp;<span class="op" id="3796272">=</span>&nbsp;<span class="builtintype" id="3796274">byte</span><span class="op" id="3796278">(</span><span class="ident" id="3796279">extensionSupportedCurves</span>&nbsp;<span class="op" id="3796304">&gt;&gt;</span>&nbsp;<span class="num" id="3796307">8</span><span class="op" id="3796308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796312">z</span><span class="op" id="3796313">[</span><span class="num" id="3796314">1</span><span class="op" id="3796315">]</span>&nbsp;<span class="op" id="3796317">=</span>&nbsp;<span class="builtintype" id="3796319">byte</span><span class="op" id="3796323">(</span><span class="ident" id="3796324">extensionSupportedCurves</span><span class="op" id="3796348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796352">l</span>&nbsp;<span class="op" id="3796354">:=</span>&nbsp;<span class="num" id="3796357">2</span>&nbsp;<span class="op" id="3796359">+</span>&nbsp;<span class="num" id="3796361">2</span><span class="op" id="3796362">*</span><span class="builtinfunc" id="3796363">len</span><span class="op" id="3796366">(</span><span class="ident" id="3796367">m</span><span class="op" id="3796368">.</span><span class="ident" id="3796369">supportedCurves</span><span class="op" id="3796384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796388">z</span><span class="op" id="3796389">[</span><span class="num" id="3796390">2</span><span class="op" id="3796391">]</span>&nbsp;<span class="op" id="3796393">=</span>&nbsp;<span class="builtintype" id="3796395">byte</span><span class="op" id="3796399">(</span><span class="ident" id="3796400">l</span>&nbsp;<span class="op" id="3796402">&gt;&gt;</span>&nbsp;<span class="num" id="3796405">8</span><span class="op" id="3796406">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796410">z</span><span class="op" id="3796411">[</span><span class="num" id="3796412">3</span><span class="op" id="3796413">]</span>&nbsp;<span class="op" id="3796415">=</span>&nbsp;<span class="builtintype" id="3796417">byte</span><span class="op" id="3796421">(</span><span class="ident" id="3796422">l</span><span class="op" id="3796423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796427">l</span>&nbsp;<span class="op" id="3796429">-=</span>&nbsp;<span class="num" id="3796432">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796436">z</span><span class="op" id="3796437">[</span><span class="num" id="3796438">4</span><span class="op" id="3796439">]</span>&nbsp;<span class="op" id="3796441">=</span>&nbsp;<span class="builtintype" id="3796443">byte</span><span class="op" id="3796447">(</span><span class="ident" id="3796448">l</span>&nbsp;<span class="op" id="3796450">&gt;&gt;</span>&nbsp;<span class="num" id="3796453">8</span><span class="op" id="3796454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796458">z</span><span class="op" id="3796459">[</span><span class="num" id="3796460">5</span><span class="op" id="3796461">]</span>&nbsp;<span class="op" id="3796463">=</span>&nbsp;<span class="builtintype" id="3796465">byte</span><span class="op" id="3796469">(</span><span class="ident" id="3796470">l</span><span class="op" id="3796471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796475">z</span>&nbsp;<span class="op" id="3796477">=</span>&nbsp;<span class="ident" id="3796479">z</span><span class="op" id="3796480">[</span><span class="num" id="3796481">6</span><span class="op" id="3796482">:</span><span class="op" id="3796483">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3796487">for</span>&nbsp;<span class="ident" id="3796491">_</span><span class="op" id="3796492">,</span>&nbsp;<span class="ident" id="3796494">curve</span>&nbsp;<span class="op" id="3796500">:=</span>&nbsp;<span class="keyword" id="3796503">range</span>&nbsp;<span class="ident" id="3796509">m</span><span class="op" id="3796510">.</span><span class="ident" id="3796511">supportedCurves</span>&nbsp;<span class="op" id="3796527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796532">z</span><span class="op" id="3796533">[</span><span class="num" id="3796534">0</span><span class="op" id="3796535">]</span>&nbsp;<span class="op" id="3796537">=</span>&nbsp;<span class="builtintype" id="3796539">byte</span><span class="op" id="3796543">(</span><span class="ident" id="3796544">curve</span>&nbsp;<span class="op" id="3796550">&gt;&gt;</span>&nbsp;<span class="num" id="3796553">8</span><span class="op" id="3796554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796559">z</span><span class="op" id="3796560">[</span><span class="num" id="3796561">1</span><span class="op" id="3796562">]</span>&nbsp;<span class="op" id="3796564">=</span>&nbsp;<span class="builtintype" id="3796566">byte</span><span class="op" id="3796570">(</span><span class="ident" id="3796571">curve</span><span class="op" id="3796576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796581">z</span>&nbsp;<span class="op" id="3796583">=</span>&nbsp;<span class="ident" id="3796585">z</span><span class="op" id="3796586">[</span><span class="num" id="3796587">2</span><span class="op" id="3796588">:</span><span class="op" id="3796589">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3796593">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3796596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3796599">if</span>&nbsp;<span class="builtinfunc" id="3796602">len</span><span class="op" id="3796605">(</span><span class="ident" id="3796606">m</span><span class="op" id="3796607">.</span><span class="ident" id="3796608">supportedPoints</span><span class="op" id="3796623">)</span>&nbsp;<span class="op" id="3796625">&gt;</span>&nbsp;<span class="num" id="3796627">0</span>&nbsp;<span class="op" id="3796629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3796633">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796687">z</span><span class="op" id="3796688">[</span><span class="num" id="3796689">0</span><span class="op" id="3796690">]</span>&nbsp;<span class="op" id="3796692">=</span>&nbsp;<span class="builtintype" id="3796694">byte</span><span class="op" id="3796698">(</span><span class="ident" id="3796699">extensionSupportedPoints</span>&nbsp;<span class="op" id="3796724">&gt;&gt;</span>&nbsp;<span class="num" id="3796727">8</span><span class="op" id="3796728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796732">z</span><span class="op" id="3796733">[</span><span class="num" id="3796734">1</span><span class="op" id="3796735">]</span>&nbsp;<span class="op" id="3796737">=</span>&nbsp;<span class="builtintype" id="3796739">byte</span><span class="op" id="3796743">(</span><span class="ident" id="3796744">extensionSupportedPoints</span><span class="op" id="3796768">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796772">l</span>&nbsp;<span class="op" id="3796774">:=</span>&nbsp;<span class="num" id="3796777">1</span>&nbsp;<span class="op" id="3796779">+</span>&nbsp;<span class="builtinfunc" id="3796781">len</span><span class="op" id="3796784">(</span><span class="ident" id="3796785">m</span><span class="op" id="3796786">.</span><span class="ident" id="3796787">supportedPoints</span><span class="op" id="3796802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796806">z</span><span class="op" id="3796807">[</span><span class="num" id="3796808">2</span><span class="op" id="3796809">]</span>&nbsp;<span class="op" id="3796811">=</span>&nbsp;<span class="builtintype" id="3796813">byte</span><span class="op" id="3796817">(</span><span class="ident" id="3796818">l</span>&nbsp;<span class="op" id="3796820">&gt;&gt;</span>&nbsp;<span class="num" id="3796823">8</span><span class="op" id="3796824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796828">z</span><span class="op" id="3796829">[</span><span class="num" id="3796830">3</span><span class="op" id="3796831">]</span>&nbsp;<span class="op" id="3796833">=</span>&nbsp;<span class="builtintype" id="3796835">byte</span><span class="op" id="3796839">(</span><span class="ident" id="3796840">l</span><span class="op" id="3796841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796845">l</span><span class="op" id="3796846">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796851">z</span><span class="op" id="3796852">[</span><span class="num" id="3796853">4</span><span class="op" id="3796854">]</span>&nbsp;<span class="op" id="3796856">=</span>&nbsp;<span class="builtintype" id="3796858">byte</span><span class="op" id="3796862">(</span><span class="ident" id="3796863">l</span><span class="op" id="3796864">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796868">z</span>&nbsp;<span class="op" id="3796870">=</span>&nbsp;<span class="ident" id="3796872">z</span><span class="op" id="3796873">[</span><span class="num" id="3796874">5</span><span class="op" id="3796875">:</span><span class="op" id="3796876">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3796880">for</span>&nbsp;<span class="ident" id="3796884">_</span><span class="op" id="3796885">,</span>&nbsp;<span class="ident" id="3796887">pointFormat</span>&nbsp;<span class="op" id="3796899">:=</span>&nbsp;<span class="keyword" id="3796902">range</span>&nbsp;<span class="ident" id="3796908">m</span><span class="op" id="3796909">.</span><span class="ident" id="3796910">supportedPoints</span>&nbsp;<span class="op" id="3796926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796931">z</span><span class="op" id="3796932">[</span><span class="num" id="3796933">0</span><span class="op" id="3796934">]</span>&nbsp;<span class="op" id="3796936">=</span>&nbsp;<span class="builtintype" id="3796938">byte</span><span class="op" id="3796942">(</span><span class="ident" id="3796943">pointFormat</span><span class="op" id="3796954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3796959">z</span>&nbsp;<span class="op" id="3796961">=</span>&nbsp;<span class="ident" id="3796963">z</span><span class="op" id="3796964">[</span><span class="num" id="3796965">1</span><span class="op" id="3796966">:</span><span class="op" id="3796967">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3796971">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3796974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3796977">if</span>&nbsp;<span class="ident" id="3796980">m</span><span class="op" id="3796981">.</span><span class="ident" id="3796982">ticketSupported</span>&nbsp;<span class="op" id="3796998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3797002">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797054">z</span><span class="op" id="3797055">[</span><span class="num" id="3797056">0</span><span class="op" id="3797057">]</span>&nbsp;<span class="op" id="3797059">=</span>&nbsp;<span class="builtintype" id="3797061">byte</span><span class="op" id="3797065">(</span><span class="ident" id="3797066">extensionSessionTicket</span>&nbsp;<span class="op" id="3797089">&gt;&gt;</span>&nbsp;<span class="num" id="3797092">8</span><span class="op" id="3797093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797097">z</span><span class="op" id="3797098">[</span><span class="num" id="3797099">1</span><span class="op" id="3797100">]</span>&nbsp;<span class="op" id="3797102">=</span>&nbsp;<span class="builtintype" id="3797104">byte</span><span class="op" id="3797108">(</span><span class="ident" id="3797109">extensionSessionTicket</span><span class="op" id="3797131">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797135">l</span>&nbsp;<span class="op" id="3797137">:=</span>&nbsp;<span class="builtinfunc" id="3797140">len</span><span class="op" id="3797143">(</span><span class="ident" id="3797144">m</span><span class="op" id="3797145">.</span><span class="ident" id="3797146">sessionTicket</span><span class="op" id="3797159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797163">z</span><span class="op" id="3797164">[</span><span class="num" id="3797165">2</span><span class="op" id="3797166">]</span>&nbsp;<span class="op" id="3797168">=</span>&nbsp;<span class="builtintype" id="3797170">byte</span><span class="op" id="3797174">(</span><span class="ident" id="3797175">l</span>&nbsp;<span class="op" id="3797177">&gt;&gt;</span>&nbsp;<span class="num" id="3797180">8</span><span class="op" id="3797181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797185">z</span><span class="op" id="3797186">[</span><span class="num" id="3797187">3</span><span class="op" id="3797188">]</span>&nbsp;<span class="op" id="3797190">=</span>&nbsp;<span class="builtintype" id="3797192">byte</span><span class="op" id="3797196">(</span><span class="ident" id="3797197">l</span><span class="op" id="3797198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797202">z</span>&nbsp;<span class="op" id="3797204">=</span>&nbsp;<span class="ident" id="3797206">z</span><span class="op" id="3797207">[</span><span class="num" id="3797208">4</span><span class="op" id="3797209">:</span><span class="op" id="3797210">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3797214">copy</span><span class="op" id="3797218">(</span><span class="ident" id="3797219">z</span><span class="op" id="3797220">,</span>&nbsp;<span class="ident" id="3797222">m</span><span class="op" id="3797223">.</span><span class="ident" id="3797224">sessionTicket</span><span class="op" id="3797237">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797241">z</span>&nbsp;<span class="op" id="3797243">=</span>&nbsp;<span class="ident" id="3797245">z</span><span class="op" id="3797246">[</span><span class="builtinfunc" id="3797247">len</span><span class="op" id="3797250">(</span><span class="ident" id="3797251">m</span><span class="op" id="3797252">.</span><span class="ident" id="3797253">sessionTicket</span><span class="op" id="3797266">)</span><span class="op" id="3797267">:</span><span class="op" id="3797268">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3797271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3797274">if</span>&nbsp;<span class="builtinfunc" id="3797277">len</span><span class="op" id="3797280">(</span><span class="ident" id="3797281">m</span><span class="op" id="3797282">.</span><span class="ident" id="3797283">signatureAndHashes</span><span class="op" id="3797301">)</span>&nbsp;<span class="op" id="3797303">&gt;</span>&nbsp;<span class="num" id="3797305">0</span>&nbsp;<span class="op" id="3797307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3797311">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797370">z</span><span class="op" id="3797371">[</span><span class="num" id="3797372">0</span><span class="op" id="3797373">]</span>&nbsp;<span class="op" id="3797375">=</span>&nbsp;<span class="builtintype" id="3797377">byte</span><span class="op" id="3797381">(</span><span class="ident" id="3797382">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="3797411">&gt;&gt;</span>&nbsp;<span class="num" id="3797414">8</span><span class="op" id="3797415">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797419">z</span><span class="op" id="3797420">[</span><span class="num" id="3797421">1</span><span class="op" id="3797422">]</span>&nbsp;<span class="op" id="3797424">=</span>&nbsp;<span class="builtintype" id="3797426">byte</span><span class="op" id="3797430">(</span><span class="ident" id="3797431">extensionSignatureAlgorithms</span><span class="op" id="3797459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797463">l</span>&nbsp;<span class="op" id="3797465">:=</span>&nbsp;<span class="num" id="3797468">2</span>&nbsp;<span class="op" id="3797470">+</span>&nbsp;<span class="num" id="3797472">2</span><span class="op" id="3797473">*</span><span class="builtinfunc" id="3797474">len</span><span class="op" id="3797477">(</span><span class="ident" id="3797478">m</span><span class="op" id="3797479">.</span><span class="ident" id="3797480">signatureAndHashes</span><span class="op" id="3797498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797502">z</span><span class="op" id="3797503">[</span><span class="num" id="3797504">2</span><span class="op" id="3797505">]</span>&nbsp;<span class="op" id="3797507">=</span>&nbsp;<span class="builtintype" id="3797509">byte</span><span class="op" id="3797513">(</span><span class="ident" id="3797514">l</span>&nbsp;<span class="op" id="3797516">&gt;&gt;</span>&nbsp;<span class="num" id="3797519">8</span><span class="op" id="3797520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797524">z</span><span class="op" id="3797525">[</span><span class="num" id="3797526">3</span><span class="op" id="3797527">]</span>&nbsp;<span class="op" id="3797529">=</span>&nbsp;<span class="builtintype" id="3797531">byte</span><span class="op" id="3797535">(</span><span class="ident" id="3797536">l</span><span class="op" id="3797537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797541">z</span>&nbsp;<span class="op" id="3797543">=</span>&nbsp;<span class="ident" id="3797545">z</span><span class="op" id="3797546">[</span><span class="num" id="3797547">4</span><span class="op" id="3797548">:</span><span class="op" id="3797549">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797554">l</span>&nbsp;<span class="op" id="3797556">-=</span>&nbsp;<span class="num" id="3797559">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797563">z</span><span class="op" id="3797564">[</span><span class="num" id="3797565">0</span><span class="op" id="3797566">]</span>&nbsp;<span class="op" id="3797568">=</span>&nbsp;<span class="builtintype" id="3797570">byte</span><span class="op" id="3797574">(</span><span class="ident" id="3797575">l</span>&nbsp;<span class="op" id="3797577">&gt;&gt;</span>&nbsp;<span class="num" id="3797580">8</span><span class="op" id="3797581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797585">z</span><span class="op" id="3797586">[</span><span class="num" id="3797587">1</span><span class="op" id="3797588">]</span>&nbsp;<span class="op" id="3797590">=</span>&nbsp;<span class="builtintype" id="3797592">byte</span><span class="op" id="3797596">(</span><span class="ident" id="3797597">l</span><span class="op" id="3797598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797602">z</span>&nbsp;<span class="op" id="3797604">=</span>&nbsp;<span class="ident" id="3797606">z</span><span class="op" id="3797607">[</span><span class="num" id="3797608">2</span><span class="op" id="3797609">:</span><span class="op" id="3797610">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3797614">for</span>&nbsp;<span class="ident" id="3797618">_</span><span class="op" id="3797619">,</span>&nbsp;<span class="ident" id="3797621">sigAndHash</span>&nbsp;<span class="op" id="3797632">:=</span>&nbsp;<span class="keyword" id="3797635">range</span>&nbsp;<span class="ident" id="3797641">m</span><span class="op" id="3797642">.</span><span class="ident" id="3797643">signatureAndHashes</span>&nbsp;<span class="op" id="3797662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797667">z</span><span class="op" id="3797668">[</span><span class="num" id="3797669">0</span><span class="op" id="3797670">]</span>&nbsp;<span class="op" id="3797672">=</span>&nbsp;<span class="ident" id="3797674">sigAndHash</span><span class="op" id="3797684">.</span><span class="ident" id="3797685">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797693">z</span><span class="op" id="3797694">[</span><span class="num" id="3797695">1</span><span class="op" id="3797696">]</span>&nbsp;<span class="op" id="3797698">=</span>&nbsp;<span class="ident" id="3797700">sigAndHash</span><span class="op" id="3797710">.</span><span class="ident" id="3797711">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797724">z</span>&nbsp;<span class="op" id="3797726">=</span>&nbsp;<span class="ident" id="3797728">z</span><span class="op" id="3797729">[</span><span class="num" id="3797730">2</span><span class="op" id="3797731">:</span><span class="op" id="3797732">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3797736">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3797739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3797742">if</span>&nbsp;<span class="ident" id="3797745">m</span><span class="op" id="3797746">.</span><span class="ident" id="3797747">secureRenegotiation</span>&nbsp;<span class="op" id="3797767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797771">z</span><span class="op" id="3797772">[</span><span class="num" id="3797773">0</span><span class="op" id="3797774">]</span>&nbsp;<span class="op" id="3797776">=</span>&nbsp;<span class="builtintype" id="3797778">byte</span><span class="op" id="3797782">(</span><span class="ident" id="3797783">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3797810">&gt;&gt;</span>&nbsp;<span class="num" id="3797813">8</span><span class="op" id="3797814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797818">z</span><span class="op" id="3797819">[</span><span class="num" id="3797820">1</span><span class="op" id="3797821">]</span>&nbsp;<span class="op" id="3797823">=</span>&nbsp;<span class="builtintype" id="3797825">byte</span><span class="op" id="3797829">(</span><span class="ident" id="3797830">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3797857">&amp;</span>&nbsp;<span class="num" id="3797859">0xff</span><span class="op" id="3797863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797867">z</span><span class="op" id="3797868">[</span><span class="num" id="3797869">2</span><span class="op" id="3797870">]</span>&nbsp;<span class="op" id="3797872">=</span>&nbsp;<span class="num" id="3797874">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797878">z</span><span class="op" id="3797879">[</span><span class="num" id="3797880">3</span><span class="op" id="3797881">]</span>&nbsp;<span class="op" id="3797883">=</span>&nbsp;<span class="num" id="3797885">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797889">z</span>&nbsp;<span class="op" id="3797891">=</span>&nbsp;<span class="ident" id="3797893">z</span><span class="op" id="3797894">[</span><span class="num" id="3797895">5</span><span class="op" id="3797896">:</span><span class="op" id="3797897">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3797900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3797903">if</span>&nbsp;<span class="builtinfunc" id="3797906">len</span><span class="op" id="3797909">(</span><span class="ident" id="3797910">m</span><span class="op" id="3797911">.</span><span class="ident" id="3797912">alpnProtocols</span><span class="op" id="3797925">)</span>&nbsp;<span class="op" id="3797927">&gt;</span>&nbsp;<span class="num" id="3797929">0</span>&nbsp;<span class="op" id="3797931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797935">z</span><span class="op" id="3797936">[</span><span class="num" id="3797937">0</span><span class="op" id="3797938">]</span>&nbsp;<span class="op" id="3797940">=</span>&nbsp;<span class="builtintype" id="3797942">byte</span><span class="op" id="3797946">(</span><span class="ident" id="3797947">extensionALPN</span>&nbsp;<span class="op" id="3797961">&gt;&gt;</span>&nbsp;<span class="num" id="3797964">8</span><span class="op" id="3797965">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3797969">z</span><span class="op" id="3797970">[</span><span class="num" id="3797971">1</span><span class="op" id="3797972">]</span>&nbsp;<span class="op" id="3797974">=</span>&nbsp;<span class="builtintype" id="3797976">byte</span><span class="op" id="3797980">(</span><span class="ident" id="3797981">extensionALPN</span>&nbsp;<span class="op" id="3797995">&amp;</span>&nbsp;<span class="num" id="3797997">0xff</span><span class="op" id="3798001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798005">lengths</span>&nbsp;<span class="op" id="3798013">:=</span>&nbsp;<span class="ident" id="3798016">z</span><span class="op" id="3798017">[</span><span class="num" id="3798018">2</span><span class="op" id="3798019">:</span><span class="op" id="3798020">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798024">z</span>&nbsp;<span class="op" id="3798026">=</span>&nbsp;<span class="ident" id="3798028">z</span><span class="op" id="3798029">[</span><span class="num" id="3798030">6</span><span class="op" id="3798031">:</span><span class="op" id="3798032">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798037">stringsLength</span>&nbsp;<span class="op" id="3798051">:=</span>&nbsp;<span class="num" id="3798054">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3798058">for</span>&nbsp;<span class="ident" id="3798062">_</span><span class="op" id="3798063">,</span>&nbsp;<span class="ident" id="3798065">s</span>&nbsp;<span class="op" id="3798067">:=</span>&nbsp;<span class="keyword" id="3798070">range</span>&nbsp;<span class="ident" id="3798076">m</span><span class="op" id="3798077">.</span><span class="ident" id="3798078">alpnProtocols</span>&nbsp;<span class="op" id="3798092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798097">l</span>&nbsp;<span class="op" id="3798099">:=</span>&nbsp;<span class="builtinfunc" id="3798102">len</span><span class="op" id="3798105">(</span><span class="ident" id="3798106">s</span><span class="op" id="3798107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798112">z</span><span class="op" id="3798113">[</span><span class="num" id="3798114">0</span><span class="op" id="3798115">]</span>&nbsp;<span class="op" id="3798117">=</span>&nbsp;<span class="builtintype" id="3798119">byte</span><span class="op" id="3798123">(</span><span class="ident" id="3798124">l</span><span class="op" id="3798125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3798130">copy</span><span class="op" id="3798134">(</span><span class="ident" id="3798135">z</span><span class="op" id="3798136">[</span><span class="num" id="3798137">1</span><span class="op" id="3798138">:</span><span class="op" id="3798139">]</span><span class="op" id="3798140">,</span>&nbsp;<span class="ident" id="3798142">s</span><span class="op" id="3798143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798148">z</span>&nbsp;<span class="op" id="3798150">=</span>&nbsp;<span class="ident" id="3798152">z</span><span class="op" id="3798153">[</span><span class="num" id="3798154">1</span><span class="op" id="3798155">+</span><span class="ident" id="3798156">l</span><span class="op" id="3798157">:</span><span class="op" id="3798158">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798163">stringsLength</span>&nbsp;<span class="op" id="3798177">+=</span>&nbsp;<span class="num" id="3798180">1</span>&nbsp;<span class="op" id="3798182">+</span>&nbsp;<span class="ident" id="3798184">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3798188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798193">lengths</span><span class="op" id="3798200">[</span><span class="num" id="3798201">2</span><span class="op" id="3798202">]</span>&nbsp;<span class="op" id="3798204">=</span>&nbsp;<span class="builtintype" id="3798206">byte</span><span class="op" id="3798210">(</span><span class="ident" id="3798211">stringsLength</span>&nbsp;<span class="op" id="3798225">&gt;&gt;</span>&nbsp;<span class="num" id="3798228">8</span><span class="op" id="3798229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798233">lengths</span><span class="op" id="3798240">[</span><span class="num" id="3798241">3</span><span class="op" id="3798242">]</span>&nbsp;<span class="op" id="3798244">=</span>&nbsp;<span class="builtintype" id="3798246">byte</span><span class="op" id="3798250">(</span><span class="ident" id="3798251">stringsLength</span><span class="op" id="3798264">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798268">stringsLength</span>&nbsp;<span class="op" id="3798282">+=</span>&nbsp;<span class="num" id="3798285">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798289">lengths</span><span class="op" id="3798296">[</span><span class="num" id="3798297">0</span><span class="op" id="3798298">]</span>&nbsp;<span class="op" id="3798300">=</span>&nbsp;<span class="builtintype" id="3798302">byte</span><span class="op" id="3798306">(</span><span class="ident" id="3798307">stringsLength</span>&nbsp;<span class="op" id="3798321">&gt;&gt;</span>&nbsp;<span class="num" id="3798324">8</span><span class="op" id="3798325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798329">lengths</span><span class="op" id="3798336">[</span><span class="num" id="3798337">1</span><span class="op" id="3798338">]</span>&nbsp;<span class="op" id="3798340">=</span>&nbsp;<span class="builtintype" id="3798342">byte</span><span class="op" id="3798346">(</span><span class="ident" id="3798347">stringsLength</span><span class="op" id="3798360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3798363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798367">m</span><span class="op" id="3798368">.</span><span class="ident" id="3798369">raw</span>&nbsp;<span class="op" id="3798373">=</span>&nbsp;<span class="ident" id="3798375">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3798379">return</span>&nbsp;<span class="ident" id="3798386">x</span><br>
<span class="lineno"></span><span class="op" id="3798388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3798391">func</span>&nbsp;<span class="op" id="3798396">(</span><span class="ident" id="3798397">m</span>&nbsp;<span class="op" id="3798399">*</span><span class="ident" id="3798400">clientHelloMsg</span><span class="op" id="3798414">)</span>&nbsp;<span class="ident" id="3798416">unmarshal</span><span class="op" id="3798425">(</span><span class="ident" id="3798426">data</span>&nbsp;<span class="op" id="3798431">[</span><span class="op" id="3798432">]</span><span class="builtintype" id="3798433">byte</span><span class="op" id="3798437">)</span>&nbsp;<span class="builtintype" id="3798439">bool</span>&nbsp;<span class="op" id="3798444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3798447">if</span>&nbsp;<span class="builtinfunc" id="3798450">len</span><span class="op" id="3798453">(</span><span class="ident" id="3798454">data</span><span class="op" id="3798458">)</span>&nbsp;<span class="op" id="3798460">&lt;</span>&nbsp;<span class="num" id="3798462">42</span>&nbsp;<span class="op" id="3798465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3798469">return</span>&nbsp;<span class="builtintype" id="3798476">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3798483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798486">m</span><span class="op" id="3798487">.</span><span class="ident" id="3798488">raw</span>&nbsp;<span class="op" id="3798492">=</span>&nbsp;<span class="ident" id="3798494">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798500">m</span><span class="op" id="3798501">.</span><span class="ident" id="3798502">vers</span>&nbsp;<span class="op" id="3798507">=</span>&nbsp;<span class="builtintype" id="3798509">uint16</span><span class="op" id="3798515">(</span><span class="ident" id="3798516">data</span><span class="op" id="3798520">[</span><span class="num" id="3798521">4</span><span class="op" id="3798522">]</span><span class="op" id="3798523">)</span><span class="op" id="3798524">&lt;&lt;</span><span class="num" id="3798526">8</span>&nbsp;<span class="op" id="3798528">|</span>&nbsp;<span class="builtintype" id="3798530">uint16</span><span class="op" id="3798536">(</span><span class="ident" id="3798537">data</span><span class="op" id="3798541">[</span><span class="num" id="3798542">5</span><span class="op" id="3798543">]</span><span class="op" id="3798544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798547">m</span><span class="op" id="3798548">.</span><span class="ident" id="3798549">random</span>&nbsp;<span class="op" id="3798556">=</span>&nbsp;<span class="ident" id="3798558">data</span><span class="op" id="3798562">[</span><span class="num" id="3798563">6</span><span class="op" id="3798564">:</span><span class="num" id="3798565">38</span><span class="op" id="3798567">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798570">sessionIdLen</span>&nbsp;<span class="op" id="3798583">:=</span>&nbsp;<span class="builtintype" id="3798586">int</span><span class="op" id="3798589">(</span><span class="ident" id="3798590">data</span><span class="op" id="3798594">[</span><span class="num" id="3798595">38</span><span class="op" id="3798597">]</span><span class="op" id="3798598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3798601">if</span>&nbsp;<span class="ident" id="3798604">sessionIdLen</span>&nbsp;<span class="op" id="3798617">&gt;</span>&nbsp;<span class="num" id="3798619">32</span>&nbsp;<span class="op" id="3798622">||</span>&nbsp;<span class="builtinfunc" id="3798625">len</span><span class="op" id="3798628">(</span><span class="ident" id="3798629">data</span><span class="op" id="3798633">)</span>&nbsp;<span class="op" id="3798635">&lt;</span>&nbsp;<span class="num" id="3798637">39</span><span class="op" id="3798639">+</span><span class="ident" id="3798640">sessionIdLen</span>&nbsp;<span class="op" id="3798653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3798657">return</span>&nbsp;<span class="builtintype" id="3798664">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3798671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798674">m</span><span class="op" id="3798675">.</span><span class="ident" id="3798676">sessionId</span>&nbsp;<span class="op" id="3798686">=</span>&nbsp;<span class="ident" id="3798688">data</span><span class="op" id="3798692">[</span><span class="num" id="3798693">39</span>&nbsp;<span class="op" id="3798696">:</span>&nbsp;<span class="num" id="3798698">39</span><span class="op" id="3798700">+</span><span class="ident" id="3798701">sessionIdLen</span><span class="op" id="3798713">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798716">data</span>&nbsp;<span class="op" id="3798721">=</span>&nbsp;<span class="ident" id="3798723">data</span><span class="op" id="3798727">[</span><span class="num" id="3798728">39</span><span class="op" id="3798730">+</span><span class="ident" id="3798731">sessionIdLen</span><span class="op" id="3798743">:</span><span class="op" id="3798744">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3798747">if</span>&nbsp;<span class="builtinfunc" id="3798750">len</span><span class="op" id="3798753">(</span><span class="ident" id="3798754">data</span><span class="op" id="3798758">)</span>&nbsp;<span class="op" id="3798760">&lt;</span>&nbsp;<span class="num" id="3798762">2</span>&nbsp;<span class="op" id="3798764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3798768">return</span>&nbsp;<span class="builtintype" id="3798775">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3798782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3798785">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3798858">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3798905">cipherSuiteLen</span>&nbsp;<span class="op" id="3798920">:=</span>&nbsp;<span class="builtintype" id="3798923">int</span><span class="op" id="3798926">(</span><span class="ident" id="3798927">data</span><span class="op" id="3798931">[</span><span class="num" id="3798932">0</span><span class="op" id="3798933">]</span><span class="op" id="3798934">)</span><span class="op" id="3798935">&lt;&lt;</span><span class="num" id="3798937">8</span>&nbsp;<span class="op" id="3798939">|</span>&nbsp;<span class="builtintype" id="3798941">int</span><span class="op" id="3798944">(</span><span class="ident" id="3798945">data</span><span class="op" id="3798949">[</span><span class="num" id="3798950">1</span><span class="op" id="3798951">]</span><span class="op" id="3798952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3798955">if</span>&nbsp;<span class="ident" id="3798958">cipherSuiteLen</span><span class="op" id="3798972">%</span><span class="num" id="3798973">2</span>&nbsp;<span class="op" id="3798975">==</span>&nbsp;<span class="num" id="3798978">1</span>&nbsp;<span class="op" id="3798980">||</span>&nbsp;<span class="builtinfunc" id="3798983">len</span><span class="op" id="3798986">(</span><span class="ident" id="3798987">data</span><span class="op" id="3798991">)</span>&nbsp;<span class="op" id="3798993">&lt;</span>&nbsp;<span class="num" id="3798995">2</span><span class="op" id="3798996">+</span><span class="ident" id="3798997">cipherSuiteLen</span>&nbsp;<span class="op" id="3799012">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799016">return</span>&nbsp;<span class="builtintype" id="3799023">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3799030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799033">numCipherSuites</span>&nbsp;<span class="op" id="3799049">:=</span>&nbsp;<span class="ident" id="3799052">cipherSuiteLen</span>&nbsp;<span class="op" id="3799067">/</span>&nbsp;<span class="num" id="3799069">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799072">m</span><span class="op" id="3799073">.</span><span class="ident" id="3799074">cipherSuites</span>&nbsp;<span class="op" id="3799087">=</span>&nbsp;<span class="builtinfunc" id="3799089">make</span><span class="op" id="3799093">(</span><span class="op" id="3799094">[</span><span class="op" id="3799095">]</span><span class="builtintype" id="3799096">uint16</span><span class="op" id="3799102">,</span>&nbsp;<span class="ident" id="3799104">numCipherSuites</span><span class="op" id="3799119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799122">for</span>&nbsp;<span class="ident" id="3799126">i</span>&nbsp;<span class="op" id="3799128">:=</span>&nbsp;<span class="num" id="3799131">0</span><span class="op" id="3799132">;</span>&nbsp;<span class="ident" id="3799134">i</span>&nbsp;<span class="op" id="3799136">&lt;</span>&nbsp;<span class="ident" id="3799138">numCipherSuites</span><span class="op" id="3799153">;</span>&nbsp;<span class="ident" id="3799155">i</span><span class="op" id="3799156">++</span>&nbsp;<span class="op" id="3799159">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799163">m</span><span class="op" id="3799164">.</span><span class="ident" id="3799165">cipherSuites</span><span class="op" id="3799177">[</span><span class="ident" id="3799178">i</span><span class="op" id="3799179">]</span>&nbsp;<span class="op" id="3799181">=</span>&nbsp;<span class="builtintype" id="3799183">uint16</span><span class="op" id="3799189">(</span><span class="ident" id="3799190">data</span><span class="op" id="3799194">[</span><span class="num" id="3799195">2</span><span class="op" id="3799196">+</span><span class="num" id="3799197">2</span><span class="op" id="3799198">*</span><span class="ident" id="3799199">i</span><span class="op" id="3799200">]</span><span class="op" id="3799201">)</span><span class="op" id="3799202">&lt;&lt;</span><span class="num" id="3799204">8</span>&nbsp;<span class="op" id="3799206">|</span>&nbsp;<span class="builtintype" id="3799208">uint16</span><span class="op" id="3799214">(</span><span class="ident" id="3799215">data</span><span class="op" id="3799219">[</span><span class="num" id="3799220">3</span><span class="op" id="3799221">+</span><span class="num" id="3799222">2</span><span class="op" id="3799223">*</span><span class="ident" id="3799224">i</span><span class="op" id="3799225">]</span><span class="op" id="3799226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799230">if</span>&nbsp;<span class="ident" id="3799233">m</span><span class="op" id="3799234">.</span><span class="ident" id="3799235">cipherSuites</span><span class="op" id="3799247">[</span><span class="ident" id="3799248">i</span><span class="op" id="3799249">]</span>&nbsp;<span class="op" id="3799251">==</span>&nbsp;<span class="ident" id="3799254">scsvRenegotiation</span>&nbsp;<span class="op" id="3799272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799277">m</span><span class="op" id="3799278">.</span><span class="ident" id="3799279">secureRenegotiation</span>&nbsp;<span class="op" id="3799299">=</span>&nbsp;<span class="builtintype" id="3799301">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3799308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3799311">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799314">data</span>&nbsp;<span class="op" id="3799319">=</span>&nbsp;<span class="ident" id="3799321">data</span><span class="op" id="3799325">[</span><span class="num" id="3799326">2</span><span class="op" id="3799327">+</span><span class="ident" id="3799328">cipherSuiteLen</span><span class="op" id="3799342">:</span><span class="op" id="3799343">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799346">if</span>&nbsp;<span class="builtinfunc" id="3799349">len</span><span class="op" id="3799352">(</span><span class="ident" id="3799353">data</span><span class="op" id="3799357">)</span>&nbsp;<span class="op" id="3799359">&lt;</span>&nbsp;<span class="num" id="3799361">1</span>&nbsp;<span class="op" id="3799363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799367">return</span>&nbsp;<span class="builtintype" id="3799374">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3799381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799384">compressionMethodsLen</span>&nbsp;<span class="op" id="3799406">:=</span>&nbsp;<span class="builtintype" id="3799409">int</span><span class="op" id="3799412">(</span><span class="ident" id="3799413">data</span><span class="op" id="3799417">[</span><span class="num" id="3799418">0</span><span class="op" id="3799419">]</span><span class="op" id="3799420">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799423">if</span>&nbsp;<span class="builtinfunc" id="3799426">len</span><span class="op" id="3799429">(</span><span class="ident" id="3799430">data</span><span class="op" id="3799434">)</span>&nbsp;<span class="op" id="3799436">&lt;</span>&nbsp;<span class="num" id="3799438">1</span><span class="op" id="3799439">+</span><span class="ident" id="3799440">compressionMethodsLen</span>&nbsp;<span class="op" id="3799462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799466">return</span>&nbsp;<span class="builtintype" id="3799473">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3799480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799483">m</span><span class="op" id="3799484">.</span><span class="ident" id="3799485">compressionMethods</span>&nbsp;<span class="op" id="3799504">=</span>&nbsp;<span class="ident" id="3799506">data</span><span class="op" id="3799510">[</span><span class="num" id="3799511">1</span>&nbsp;<span class="op" id="3799513">:</span>&nbsp;<span class="num" id="3799515">1</span><span class="op" id="3799516">+</span><span class="ident" id="3799517">compressionMethodsLen</span><span class="op" id="3799538">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799542">data</span>&nbsp;<span class="op" id="3799547">=</span>&nbsp;<span class="ident" id="3799549">data</span><span class="op" id="3799553">[</span><span class="num" id="3799554">1</span><span class="op" id="3799555">+</span><span class="ident" id="3799556">compressionMethodsLen</span><span class="op" id="3799577">:</span><span class="op" id="3799578">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799582">m</span><span class="op" id="3799583">.</span><span class="ident" id="3799584">nextProtoNeg</span>&nbsp;<span class="op" id="3799597">=</span>&nbsp;<span class="builtintype" id="3799599">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799606">m</span><span class="op" id="3799607">.</span><span class="ident" id="3799608">serverName</span>&nbsp;<span class="op" id="3799619">=</span>&nbsp;<span class="string" id="3799621">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799625">m</span><span class="op" id="3799626">.</span><span class="ident" id="3799627">ocspStapling</span>&nbsp;<span class="op" id="3799640">=</span>&nbsp;<span class="builtintype" id="3799642">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799649">m</span><span class="op" id="3799650">.</span><span class="ident" id="3799651">ticketSupported</span>&nbsp;<span class="op" id="3799667">=</span>&nbsp;<span class="builtintype" id="3799669">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799676">m</span><span class="op" id="3799677">.</span><span class="ident" id="3799678">sessionTicket</span>&nbsp;<span class="op" id="3799692">=</span>&nbsp;<span class="builtintype" id="3799694">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799699">m</span><span class="op" id="3799700">.</span><span class="ident" id="3799701">signatureAndHashes</span>&nbsp;<span class="op" id="3799720">=</span>&nbsp;<span class="builtintype" id="3799722">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799727">m</span><span class="op" id="3799728">.</span><span class="ident" id="3799729">alpnProtocols</span>&nbsp;<span class="op" id="3799743">=</span>&nbsp;<span class="builtintype" id="3799745">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799751">if</span>&nbsp;<span class="builtinfunc" id="3799754">len</span><span class="op" id="3799757">(</span><span class="ident" id="3799758">data</span><span class="op" id="3799762">)</span>&nbsp;<span class="op" id="3799764">==</span>&nbsp;<span class="num" id="3799767">0</span>&nbsp;<span class="op" id="3799769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3799773">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799831">return</span>&nbsp;<span class="builtintype" id="3799838">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3799844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799847">if</span>&nbsp;<span class="builtinfunc" id="3799850">len</span><span class="op" id="3799853">(</span><span class="ident" id="3799854">data</span><span class="op" id="3799858">)</span>&nbsp;<span class="op" id="3799860">&lt;</span>&nbsp;<span class="num" id="3799862">2</span>&nbsp;<span class="op" id="3799864">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799868">return</span>&nbsp;<span class="builtintype" id="3799875">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3799882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799886">extensionsLength</span>&nbsp;<span class="op" id="3799903">:=</span>&nbsp;<span class="builtintype" id="3799906">int</span><span class="op" id="3799909">(</span><span class="ident" id="3799910">data</span><span class="op" id="3799914">[</span><span class="num" id="3799915">0</span><span class="op" id="3799916">]</span><span class="op" id="3799917">)</span><span class="op" id="3799918">&lt;&lt;</span><span class="num" id="3799920">8</span>&nbsp;<span class="op" id="3799922">|</span>&nbsp;<span class="builtintype" id="3799924">int</span><span class="op" id="3799927">(</span><span class="ident" id="3799928">data</span><span class="op" id="3799932">[</span><span class="num" id="3799933">1</span><span class="op" id="3799934">]</span><span class="op" id="3799935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3799938">data</span>&nbsp;<span class="op" id="3799943">=</span>&nbsp;<span class="ident" id="3799945">data</span><span class="op" id="3799949">[</span><span class="num" id="3799950">2</span><span class="op" id="3799951">:</span><span class="op" id="3799952">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799955">if</span>&nbsp;<span class="ident" id="3799958">extensionsLength</span>&nbsp;<span class="op" id="3799975">!=</span>&nbsp;<span class="builtinfunc" id="3799978">len</span><span class="op" id="3799981">(</span><span class="ident" id="3799982">data</span><span class="op" id="3799986">)</span>&nbsp;<span class="op" id="3799988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3799992">return</span>&nbsp;<span class="builtintype" id="3799999">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3800006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800010">for</span>&nbsp;<span class="builtinfunc" id="3800014">len</span><span class="op" id="3800017">(</span><span class="ident" id="3800018">data</span><span class="op" id="3800022">)</span>&nbsp;<span class="op" id="3800024">!=</span>&nbsp;<span class="num" id="3800027">0</span>&nbsp;<span class="op" id="3800029">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800033">if</span>&nbsp;<span class="builtinfunc" id="3800036">len</span><span class="op" id="3800039">(</span><span class="ident" id="3800040">data</span><span class="op" id="3800044">)</span>&nbsp;<span class="op" id="3800046">&lt;</span>&nbsp;<span class="num" id="3800048">4</span>&nbsp;<span class="op" id="3800050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800055">return</span>&nbsp;<span class="builtintype" id="3800062">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3800070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800074">extension</span>&nbsp;<span class="op" id="3800084">:=</span>&nbsp;<span class="builtintype" id="3800087">uint16</span><span class="op" id="3800093">(</span><span class="ident" id="3800094">data</span><span class="op" id="3800098">[</span><span class="num" id="3800099">0</span><span class="op" id="3800100">]</span><span class="op" id="3800101">)</span><span class="op" id="3800102">&lt;&lt;</span><span class="num" id="3800104">8</span>&nbsp;<span class="op" id="3800106">|</span>&nbsp;<span class="builtintype" id="3800108">uint16</span><span class="op" id="3800114">(</span><span class="ident" id="3800115">data</span><span class="op" id="3800119">[</span><span class="num" id="3800120">1</span><span class="op" id="3800121">]</span><span class="op" id="3800122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800126">length</span>&nbsp;<span class="op" id="3800133">:=</span>&nbsp;<span class="builtintype" id="3800136">int</span><span class="op" id="3800139">(</span><span class="ident" id="3800140">data</span><span class="op" id="3800144">[</span><span class="num" id="3800145">2</span><span class="op" id="3800146">]</span><span class="op" id="3800147">)</span><span class="op" id="3800148">&lt;&lt;</span><span class="num" id="3800150">8</span>&nbsp;<span class="op" id="3800152">|</span>&nbsp;<span class="builtintype" id="3800154">int</span><span class="op" id="3800157">(</span><span class="ident" id="3800158">data</span><span class="op" id="3800162">[</span><span class="num" id="3800163">3</span><span class="op" id="3800164">]</span><span class="op" id="3800165">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800169">data</span>&nbsp;<span class="op" id="3800174">=</span>&nbsp;<span class="ident" id="3800176">data</span><span class="op" id="3800180">[</span><span class="num" id="3800181">4</span><span class="op" id="3800182">:</span><span class="op" id="3800183">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800187">if</span>&nbsp;<span class="builtinfunc" id="3800190">len</span><span class="op" id="3800193">(</span><span class="ident" id="3800194">data</span><span class="op" id="3800198">)</span>&nbsp;<span class="op" id="3800200">&lt;</span>&nbsp;<span class="ident" id="3800202">length</span>&nbsp;<span class="op" id="3800209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800214">return</span>&nbsp;<span class="builtintype" id="3800221">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3800229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800234">switch</span>&nbsp;<span class="ident" id="3800241">extension</span>&nbsp;<span class="op" id="3800251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800255">case</span>&nbsp;<span class="ident" id="3800260">extensionServerName</span><span class="op" id="3800279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800284">if</span>&nbsp;<span class="ident" id="3800287">length</span>&nbsp;<span class="op" id="3800294">&lt;</span>&nbsp;<span class="num" id="3800296">2</span>&nbsp;<span class="op" id="3800298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800304">return</span>&nbsp;<span class="builtintype" id="3800311">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3800320">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800325">numNames</span>&nbsp;<span class="op" id="3800334">:=</span>&nbsp;<span class="builtintype" id="3800337">int</span><span class="op" id="3800340">(</span><span class="ident" id="3800341">data</span><span class="op" id="3800345">[</span><span class="num" id="3800346">0</span><span class="op" id="3800347">]</span><span class="op" id="3800348">)</span><span class="op" id="3800349">&lt;&lt;</span><span class="num" id="3800351">8</span>&nbsp;<span class="op" id="3800353">|</span>&nbsp;<span class="builtintype" id="3800355">int</span><span class="op" id="3800358">(</span><span class="ident" id="3800359">data</span><span class="op" id="3800363">[</span><span class="num" id="3800364">1</span><span class="op" id="3800365">]</span><span class="op" id="3800366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800371">d</span>&nbsp;<span class="op" id="3800373">:=</span>&nbsp;<span class="ident" id="3800376">data</span><span class="op" id="3800380">[</span><span class="num" id="3800381">2</span><span class="op" id="3800382">:</span><span class="op" id="3800383">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800388">for</span>&nbsp;<span class="ident" id="3800392">i</span>&nbsp;<span class="op" id="3800394">:=</span>&nbsp;<span class="num" id="3800397">0</span><span class="op" id="3800398">;</span>&nbsp;<span class="ident" id="3800400">i</span>&nbsp;<span class="op" id="3800402">&lt;</span>&nbsp;<span class="ident" id="3800404">numNames</span><span class="op" id="3800412">;</span>&nbsp;<span class="ident" id="3800414">i</span><span class="op" id="3800415">++</span>&nbsp;<span class="op" id="3800418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800424">if</span>&nbsp;<span class="builtinfunc" id="3800427">len</span><span class="op" id="3800430">(</span><span class="ident" id="3800431">d</span><span class="op" id="3800432">)</span>&nbsp;<span class="op" id="3800434">&lt;</span>&nbsp;<span class="num" id="3800436">3</span>&nbsp;<span class="op" id="3800438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800445">return</span>&nbsp;<span class="builtintype" id="3800452">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3800462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800468">nameType</span>&nbsp;<span class="op" id="3800477">:=</span>&nbsp;<span class="ident" id="3800480">d</span><span class="op" id="3800481">[</span><span class="num" id="3800482">0</span><span class="op" id="3800483">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800489">nameLen</span>&nbsp;<span class="op" id="3800497">:=</span>&nbsp;<span class="builtintype" id="3800500">int</span><span class="op" id="3800503">(</span><span class="ident" id="3800504">d</span><span class="op" id="3800505">[</span><span class="num" id="3800506">1</span><span class="op" id="3800507">]</span><span class="op" id="3800508">)</span><span class="op" id="3800509">&lt;&lt;</span><span class="num" id="3800511">8</span>&nbsp;<span class="op" id="3800513">|</span>&nbsp;<span class="builtintype" id="3800515">int</span><span class="op" id="3800518">(</span><span class="ident" id="3800519">d</span><span class="op" id="3800520">[</span><span class="num" id="3800521">2</span><span class="op" id="3800522">]</span><span class="op" id="3800523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800529">d</span>&nbsp;<span class="op" id="3800531">=</span>&nbsp;<span class="ident" id="3800533">d</span><span class="op" id="3800534">[</span><span class="num" id="3800535">3</span><span class="op" id="3800536">:</span><span class="op" id="3800537">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800543">if</span>&nbsp;<span class="builtinfunc" id="3800546">len</span><span class="op" id="3800549">(</span><span class="ident" id="3800550">d</span><span class="op" id="3800551">)</span>&nbsp;<span class="op" id="3800553">&lt;</span>&nbsp;<span class="ident" id="3800555">nameLen</span>&nbsp;<span class="op" id="3800563">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800570">return</span>&nbsp;<span class="builtintype" id="3800577">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3800587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800593">if</span>&nbsp;<span class="ident" id="3800596">nameType</span>&nbsp;<span class="op" id="3800605">==</span>&nbsp;<span class="num" id="3800608">0</span>&nbsp;<span class="op" id="3800610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800617">m</span><span class="op" id="3800618">.</span><span class="ident" id="3800619">serverName</span>&nbsp;<span class="op" id="3800630">=</span>&nbsp;<span class="builtintype" id="3800632">string</span><span class="op" id="3800638">(</span><span class="ident" id="3800639">d</span><span class="op" id="3800640">[</span><span class="num" id="3800641">0</span><span class="op" id="3800642">:</span><span class="ident" id="3800643">nameLen</span><span class="op" id="3800650">]</span><span class="op" id="3800651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800658">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3800668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800674">d</span>&nbsp;<span class="op" id="3800676">=</span>&nbsp;<span class="ident" id="3800678">d</span><span class="op" id="3800679">[</span><span class="ident" id="3800680">nameLen</span><span class="op" id="3800687">:</span><span class="op" id="3800688">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3800693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800697">case</span>&nbsp;<span class="ident" id="3800702">extensionNextProtoNeg</span><span class="op" id="3800723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800728">if</span>&nbsp;<span class="ident" id="3800731">length</span>&nbsp;<span class="op" id="3800738">&gt;</span>&nbsp;<span class="num" id="3800740">0</span>&nbsp;<span class="op" id="3800742">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800748">return</span>&nbsp;<span class="builtintype" id="3800755">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3800764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800769">m</span><span class="op" id="3800770">.</span><span class="ident" id="3800771">nextProtoNeg</span>&nbsp;<span class="op" id="3800784">=</span>&nbsp;<span class="builtintype" id="3800786">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800793">case</span>&nbsp;<span class="ident" id="3800798">extensionStatusRequest</span><span class="op" id="3800820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3800825">m</span><span class="op" id="3800826">.</span><span class="ident" id="3800827">ocspStapling</span>&nbsp;<span class="op" id="3800840">=</span>&nbsp;<span class="ident" id="3800842">length</span>&nbsp;<span class="op" id="3800849">&gt;</span>&nbsp;<span class="num" id="3800851">0</span>&nbsp;<span class="op" id="3800853">&amp;&amp;</span>&nbsp;<span class="ident" id="3800856">data</span><span class="op" id="3800860">[</span><span class="num" id="3800861">0</span><span class="op" id="3800862">]</span>&nbsp;<span class="op" id="3800864">==</span>&nbsp;<span class="ident" id="3800867">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800884">case</span>&nbsp;<span class="ident" id="3800889">extensionSupportedCurves</span><span class="op" id="3800913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3800918">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800973">if</span>&nbsp;<span class="ident" id="3800976">length</span>&nbsp;<span class="op" id="3800983">&lt;</span>&nbsp;<span class="num" id="3800985">2</span>&nbsp;<span class="op" id="3800987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3800993">return</span>&nbsp;<span class="builtintype" id="3801000">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3801009">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801014">l</span>&nbsp;<span class="op" id="3801016">:=</span>&nbsp;<span class="builtintype" id="3801019">int</span><span class="op" id="3801022">(</span><span class="ident" id="3801023">data</span><span class="op" id="3801027">[</span><span class="num" id="3801028">0</span><span class="op" id="3801029">]</span><span class="op" id="3801030">)</span><span class="op" id="3801031">&lt;&lt;</span><span class="num" id="3801033">8</span>&nbsp;<span class="op" id="3801035">|</span>&nbsp;<span class="builtintype" id="3801037">int</span><span class="op" id="3801040">(</span><span class="ident" id="3801041">data</span><span class="op" id="3801045">[</span><span class="num" id="3801046">1</span><span class="op" id="3801047">]</span><span class="op" id="3801048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801053">if</span>&nbsp;<span class="ident" id="3801056">l</span><span class="op" id="3801057">%</span><span class="num" id="3801058">2</span>&nbsp;<span class="op" id="3801060">==</span>&nbsp;<span class="num" id="3801063">1</span>&nbsp;<span class="op" id="3801065">||</span>&nbsp;<span class="ident" id="3801068">length</span>&nbsp;<span class="op" id="3801075">!=</span>&nbsp;<span class="ident" id="3801078">l</span><span class="op" id="3801079">+</span><span class="num" id="3801080">2</span>&nbsp;<span class="op" id="3801082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801088">return</span>&nbsp;<span class="builtintype" id="3801095">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3801104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801109">numCurves</span>&nbsp;<span class="op" id="3801119">:=</span>&nbsp;<span class="ident" id="3801122">l</span>&nbsp;<span class="op" id="3801124">/</span>&nbsp;<span class="num" id="3801126">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801131">m</span><span class="op" id="3801132">.</span><span class="ident" id="3801133">supportedCurves</span>&nbsp;<span class="op" id="3801149">=</span>&nbsp;<span class="builtinfunc" id="3801151">make</span><span class="op" id="3801155">(</span><span class="op" id="3801156">[</span><span class="op" id="3801157">]</span><span class="ident" id="3801158">CurveID</span><span class="op" id="3801165">,</span>&nbsp;<span class="ident" id="3801167">numCurves</span><span class="op" id="3801176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801181">d</span>&nbsp;<span class="op" id="3801183">:=</span>&nbsp;<span class="ident" id="3801186">data</span><span class="op" id="3801190">[</span><span class="num" id="3801191">2</span><span class="op" id="3801192">:</span><span class="op" id="3801193">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801198">for</span>&nbsp;<span class="ident" id="3801202">i</span>&nbsp;<span class="op" id="3801204">:=</span>&nbsp;<span class="num" id="3801207">0</span><span class="op" id="3801208">;</span>&nbsp;<span class="ident" id="3801210">i</span>&nbsp;<span class="op" id="3801212">&lt;</span>&nbsp;<span class="ident" id="3801214">numCurves</span><span class="op" id="3801223">;</span>&nbsp;<span class="ident" id="3801225">i</span><span class="op" id="3801226">++</span>&nbsp;<span class="op" id="3801229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801235">m</span><span class="op" id="3801236">.</span><span class="ident" id="3801237">supportedCurves</span><span class="op" id="3801252">[</span><span class="ident" id="3801253">i</span><span class="op" id="3801254">]</span>&nbsp;<span class="op" id="3801256">=</span>&nbsp;<span class="ident" id="3801258">CurveID</span><span class="op" id="3801265">(</span><span class="ident" id="3801266">d</span><span class="op" id="3801267">[</span><span class="num" id="3801268">0</span><span class="op" id="3801269">]</span><span class="op" id="3801270">)</span><span class="op" id="3801271">&lt;&lt;</span><span class="num" id="3801273">8</span>&nbsp;<span class="op" id="3801275">|</span>&nbsp;<span class="ident" id="3801277">CurveID</span><span class="op" id="3801284">(</span><span class="ident" id="3801285">d</span><span class="op" id="3801286">[</span><span class="num" id="3801287">1</span><span class="op" id="3801288">]</span><span class="op" id="3801289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801295">d</span>&nbsp;<span class="op" id="3801297">=</span>&nbsp;<span class="ident" id="3801299">d</span><span class="op" id="3801300">[</span><span class="num" id="3801301">2</span><span class="op" id="3801302">:</span><span class="op" id="3801303">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3801308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801312">case</span>&nbsp;<span class="ident" id="3801317">extensionSupportedPoints</span><span class="op" id="3801341">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3801346">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801401">if</span>&nbsp;<span class="ident" id="3801404">length</span>&nbsp;<span class="op" id="3801411">&lt;</span>&nbsp;<span class="num" id="3801413">1</span>&nbsp;<span class="op" id="3801415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801421">return</span>&nbsp;<span class="builtintype" id="3801428">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3801437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801442">l</span>&nbsp;<span class="op" id="3801444">:=</span>&nbsp;<span class="builtintype" id="3801447">int</span><span class="op" id="3801450">(</span><span class="ident" id="3801451">data</span><span class="op" id="3801455">[</span><span class="num" id="3801456">0</span><span class="op" id="3801457">]</span><span class="op" id="3801458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801463">if</span>&nbsp;<span class="ident" id="3801466">length</span>&nbsp;<span class="op" id="3801473">!=</span>&nbsp;<span class="ident" id="3801476">l</span><span class="op" id="3801477">+</span><span class="num" id="3801478">1</span>&nbsp;<span class="op" id="3801480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801486">return</span>&nbsp;<span class="builtintype" id="3801493">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3801502">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801507">m</span><span class="op" id="3801508">.</span><span class="ident" id="3801509">supportedPoints</span>&nbsp;<span class="op" id="3801525">=</span>&nbsp;<span class="builtinfunc" id="3801527">make</span><span class="op" id="3801531">(</span><span class="op" id="3801532">[</span><span class="op" id="3801533">]</span><span class="builtintype" id="3801534">uint8</span><span class="op" id="3801539">,</span>&nbsp;<span class="ident" id="3801541">l</span><span class="op" id="3801542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3801547">copy</span><span class="op" id="3801551">(</span><span class="ident" id="3801552">m</span><span class="op" id="3801553">.</span><span class="ident" id="3801554">supportedPoints</span><span class="op" id="3801569">,</span>&nbsp;<span class="ident" id="3801571">data</span><span class="op" id="3801575">[</span><span class="num" id="3801576">1</span><span class="op" id="3801577">:</span><span class="op" id="3801578">]</span><span class="op" id="3801579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801583">case</span>&nbsp;<span class="ident" id="3801588">extensionSessionTicket</span><span class="op" id="3801610">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3801615">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801668">m</span><span class="op" id="3801669">.</span><span class="ident" id="3801670">ticketSupported</span>&nbsp;<span class="op" id="3801686">=</span>&nbsp;<span class="builtintype" id="3801688">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801696">m</span><span class="op" id="3801697">.</span><span class="ident" id="3801698">sessionTicket</span>&nbsp;<span class="op" id="3801712">=</span>&nbsp;<span class="ident" id="3801714">data</span><span class="op" id="3801718">[</span><span class="op" id="3801719">:</span><span class="ident" id="3801720">length</span><span class="op" id="3801726">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801730">case</span>&nbsp;<span class="ident" id="3801735">extensionSignatureAlgorithms</span><span class="op" id="3801763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3801768">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801828">if</span>&nbsp;<span class="ident" id="3801831">length</span>&nbsp;<span class="op" id="3801838">&lt;</span>&nbsp;<span class="num" id="3801840">2</span>&nbsp;<span class="op" id="3801842">||</span>&nbsp;<span class="ident" id="3801845">length</span><span class="op" id="3801851">&amp;</span><span class="num" id="3801852">1</span>&nbsp;<span class="op" id="3801854">!=</span>&nbsp;<span class="num" id="3801857">0</span>&nbsp;<span class="op" id="3801859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801865">return</span>&nbsp;<span class="builtintype" id="3801872">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3801881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801886">l</span>&nbsp;<span class="op" id="3801888">:=</span>&nbsp;<span class="builtintype" id="3801891">int</span><span class="op" id="3801894">(</span><span class="ident" id="3801895">data</span><span class="op" id="3801899">[</span><span class="num" id="3801900">0</span><span class="op" id="3801901">]</span><span class="op" id="3801902">)</span><span class="op" id="3801903">&lt;&lt;</span><span class="num" id="3801905">8</span>&nbsp;<span class="op" id="3801907">|</span>&nbsp;<span class="builtintype" id="3801909">int</span><span class="op" id="3801912">(</span><span class="ident" id="3801913">data</span><span class="op" id="3801917">[</span><span class="num" id="3801918">1</span><span class="op" id="3801919">]</span><span class="op" id="3801920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801925">if</span>&nbsp;<span class="ident" id="3801928">l</span>&nbsp;<span class="op" id="3801930">!=</span>&nbsp;<span class="ident" id="3801933">length</span><span class="op" id="3801939">-</span><span class="num" id="3801940">2</span>&nbsp;<span class="op" id="3801942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3801948">return</span>&nbsp;<span class="builtintype" id="3801955">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3801964">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801969">n</span>&nbsp;<span class="op" id="3801971">:=</span>&nbsp;<span class="ident" id="3801974">l</span>&nbsp;<span class="op" id="3801976">/</span>&nbsp;<span class="num" id="3801978">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3801983">d</span>&nbsp;<span class="op" id="3801985">:=</span>&nbsp;<span class="ident" id="3801988">data</span><span class="op" id="3801992">[</span><span class="num" id="3801993">2</span><span class="op" id="3801994">:</span><span class="op" id="3801995">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802000">m</span><span class="op" id="3802001">.</span><span class="ident" id="3802002">signatureAndHashes</span>&nbsp;<span class="op" id="3802021">=</span>&nbsp;<span class="builtinfunc" id="3802023">make</span><span class="op" id="3802027">(</span><span class="op" id="3802028">[</span><span class="op" id="3802029">]</span><span class="ident" id="3802030">signatureAndHash</span><span class="op" id="3802046">,</span>&nbsp;<span class="ident" id="3802048">n</span><span class="op" id="3802049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802054">for</span>&nbsp;<span class="ident" id="3802058">i</span>&nbsp;<span class="op" id="3802060">:=</span>&nbsp;<span class="keyword" id="3802063">range</span>&nbsp;<span class="ident" id="3802069">m</span><span class="op" id="3802070">.</span><span class="ident" id="3802071">signatureAndHashes</span>&nbsp;<span class="op" id="3802090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802096">m</span><span class="op" id="3802097">.</span><span class="ident" id="3802098">signatureAndHashes</span><span class="op" id="3802116">[</span><span class="ident" id="3802117">i</span><span class="op" id="3802118">]</span><span class="op" id="3802119">.</span><span class="ident" id="3802120">hash</span>&nbsp;<span class="op" id="3802125">=</span>&nbsp;<span class="ident" id="3802127">d</span><span class="op" id="3802128">[</span><span class="num" id="3802129">0</span><span class="op" id="3802130">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802136">m</span><span class="op" id="3802137">.</span><span class="ident" id="3802138">signatureAndHashes</span><span class="op" id="3802156">[</span><span class="ident" id="3802157">i</span><span class="op" id="3802158">]</span><span class="op" id="3802159">.</span><span class="ident" id="3802160">signature</span>&nbsp;<span class="op" id="3802170">=</span>&nbsp;<span class="ident" id="3802172">d</span><span class="op" id="3802173">[</span><span class="num" id="3802174">1</span><span class="op" id="3802175">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802181">d</span>&nbsp;<span class="op" id="3802183">=</span>&nbsp;<span class="ident" id="3802185">d</span><span class="op" id="3802186">[</span><span class="num" id="3802187">2</span><span class="op" id="3802188">:</span><span class="op" id="3802189">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802198">case</span>&nbsp;<span class="ident" id="3802203">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3802230">+</span>&nbsp;<span class="num" id="3802232">1</span><span class="op" id="3802233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802238">if</span>&nbsp;<span class="ident" id="3802241">length</span>&nbsp;<span class="op" id="3802248">!=</span>&nbsp;<span class="num" id="3802251">1</span>&nbsp;<span class="op" id="3802253">||</span>&nbsp;<span class="ident" id="3802256">data</span><span class="op" id="3802260">[</span><span class="num" id="3802261">0</span><span class="op" id="3802262">]</span>&nbsp;<span class="op" id="3802264">!=</span>&nbsp;<span class="num" id="3802267">0</span>&nbsp;<span class="op" id="3802269">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802275">return</span>&nbsp;<span class="builtintype" id="3802282">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802296">m</span><span class="op" id="3802297">.</span><span class="ident" id="3802298">secureRenegotiation</span>&nbsp;<span class="op" id="3802318">=</span>&nbsp;<span class="builtintype" id="3802320">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802327">case</span>&nbsp;<span class="ident" id="3802332">extensionALPN</span><span class="op" id="3802345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802350">if</span>&nbsp;<span class="ident" id="3802353">length</span>&nbsp;<span class="op" id="3802360">&lt;</span>&nbsp;<span class="num" id="3802362">2</span>&nbsp;<span class="op" id="3802364">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802370">return</span>&nbsp;<span class="builtintype" id="3802377">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802391">l</span>&nbsp;<span class="op" id="3802393">:=</span>&nbsp;<span class="builtintype" id="3802396">int</span><span class="op" id="3802399">(</span><span class="ident" id="3802400">data</span><span class="op" id="3802404">[</span><span class="num" id="3802405">0</span><span class="op" id="3802406">]</span><span class="op" id="3802407">)</span><span class="op" id="3802408">&lt;&lt;</span><span class="num" id="3802410">8</span>&nbsp;<span class="op" id="3802412">|</span>&nbsp;<span class="builtintype" id="3802414">int</span><span class="op" id="3802417">(</span><span class="ident" id="3802418">data</span><span class="op" id="3802422">[</span><span class="num" id="3802423">1</span><span class="op" id="3802424">]</span><span class="op" id="3802425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802430">if</span>&nbsp;<span class="ident" id="3802433">l</span>&nbsp;<span class="op" id="3802435">!=</span>&nbsp;<span class="ident" id="3802438">length</span><span class="op" id="3802444">-</span><span class="num" id="3802445">2</span>&nbsp;<span class="op" id="3802447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802453">return</span>&nbsp;<span class="builtintype" id="3802460">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802474">d</span>&nbsp;<span class="op" id="3802476">:=</span>&nbsp;<span class="ident" id="3802479">data</span><span class="op" id="3802483">[</span><span class="num" id="3802484">2</span><span class="op" id="3802485">:</span><span class="ident" id="3802486">length</span><span class="op" id="3802492">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802497">for</span>&nbsp;<span class="builtinfunc" id="3802501">len</span><span class="op" id="3802504">(</span><span class="ident" id="3802505">d</span><span class="op" id="3802506">)</span>&nbsp;<span class="op" id="3802508">!=</span>&nbsp;<span class="num" id="3802511">0</span>&nbsp;<span class="op" id="3802513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802519">stringLen</span>&nbsp;<span class="op" id="3802529">:=</span>&nbsp;<span class="builtintype" id="3802532">int</span><span class="op" id="3802535">(</span><span class="ident" id="3802536">d</span><span class="op" id="3802537">[</span><span class="num" id="3802538">0</span><span class="op" id="3802539">]</span><span class="op" id="3802540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802546">d</span>&nbsp;<span class="op" id="3802548">=</span>&nbsp;<span class="ident" id="3802550">d</span><span class="op" id="3802551">[</span><span class="num" id="3802552">1</span><span class="op" id="3802553">:</span><span class="op" id="3802554">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802560">if</span>&nbsp;<span class="ident" id="3802563">stringLen</span>&nbsp;<span class="op" id="3802573">==</span>&nbsp;<span class="num" id="3802576">0</span>&nbsp;<span class="op" id="3802578">||</span>&nbsp;<span class="ident" id="3802581">stringLen</span>&nbsp;<span class="op" id="3802591">&gt;</span>&nbsp;<span class="builtinfunc" id="3802593">len</span><span class="op" id="3802596">(</span><span class="ident" id="3802597">d</span><span class="op" id="3802598">)</span>&nbsp;<span class="op" id="3802600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802607">return</span>&nbsp;<span class="builtintype" id="3802614">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802630">m</span><span class="op" id="3802631">.</span><span class="ident" id="3802632">alpnProtocols</span>&nbsp;<span class="op" id="3802646">=</span>&nbsp;<span class="builtinfunc" id="3802648">append</span><span class="op" id="3802654">(</span><span class="ident" id="3802655">m</span><span class="op" id="3802656">.</span><span class="ident" id="3802657">alpnProtocols</span><span class="op" id="3802670">,</span>&nbsp;<span class="builtintype" id="3802672">string</span><span class="op" id="3802678">(</span><span class="ident" id="3802679">d</span><span class="op" id="3802680">[</span><span class="op" id="3802681">:</span><span class="ident" id="3802682">stringLen</span><span class="op" id="3802691">]</span><span class="op" id="3802692">)</span><span class="op" id="3802693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802699">d</span>&nbsp;<span class="op" id="3802701">=</span>&nbsp;<span class="ident" id="3802703">d</span><span class="op" id="3802704">[</span><span class="ident" id="3802705">stringLen</span><span class="op" id="3802714">:</span><span class="op" id="3802715">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802728">data</span>&nbsp;<span class="op" id="3802733">=</span>&nbsp;<span class="ident" id="3802735">data</span><span class="op" id="3802739">[</span><span class="ident" id="3802740">length</span><span class="op" id="3802746">:</span><span class="op" id="3802747">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3802754">return</span>&nbsp;<span class="builtintype" id="3802761">true</span><br>
<span class="lineno"></span><span class="op" id="3802766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3802769">type</span>&nbsp;<span class="ident" id="3802774">serverHelloMsg</span>&nbsp;<span class="keyword" id="3802789">struct</span>&nbsp;<span class="op" id="3802796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802799">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802819">[</span><span class="op" id="3802820">]</span><span class="builtintype" id="3802821">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802827">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3802847">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802855">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802875">[</span><span class="op" id="3802876">]</span><span class="builtintype" id="3802877">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802883">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3802903">[</span><span class="op" id="3802904">]</span><span class="builtintype" id="3802905">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802911">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3802931">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802939">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3802959">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802966">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3802986">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3802992">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3803012">[</span><span class="op" id="3803013">]</span><span class="builtintype" id="3803014">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803022">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3803042">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803048">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3803068">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803074">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3803094">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803100">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3803120">string</span><br>
<span class="lineno"></span><span class="op" id="3803127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3803130">func</span>&nbsp;<span class="op" id="3803135">(</span><span class="ident" id="3803136">m</span>&nbsp;<span class="op" id="3803138">*</span><span class="ident" id="3803139">serverHelloMsg</span><span class="op" id="3803153">)</span>&nbsp;<span class="ident" id="3803155">equal</span><span class="op" id="3803160">(</span><span class="ident" id="3803161">i</span>&nbsp;<span class="keyword" id="3803163">interface</span><span class="op" id="3803172">{</span><span class="op" id="3803173">}</span><span class="op" id="3803174">)</span>&nbsp;<span class="builtintype" id="3803176">bool</span>&nbsp;<span class="op" id="3803181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803184">m1</span><span class="op" id="3803186">,</span>&nbsp;<span class="ident" id="3803188">ok</span>&nbsp;<span class="op" id="3803191">:=</span>&nbsp;<span class="ident" id="3803194">i</span><span class="op" id="3803195">.</span><span class="op" id="3803196">(</span><span class="op" id="3803197">*</span><span class="ident" id="3803198">serverHelloMsg</span><span class="op" id="3803212">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3803215">if</span>&nbsp;<span class="op" id="3803218">!</span><span class="ident" id="3803219">ok</span>&nbsp;<span class="op" id="3803222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3803226">return</span>&nbsp;<span class="builtintype" id="3803233">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3803240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3803244">return</span>&nbsp;<span class="ident" id="3803251">bytes</span><span class="op" id="3803256">.</span><span class="ident" id="3803257">Equal</span><span class="op" id="3803262">(</span><span class="ident" id="3803263">m</span><span class="op" id="3803264">.</span><span class="ident" id="3803265">raw</span><span class="op" id="3803268">,</span>&nbsp;<span class="ident" id="3803270">m1</span><span class="op" id="3803272">.</span><span class="ident" id="3803273">raw</span><span class="op" id="3803276">)</span>&nbsp;<span class="op" id="3803278">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803283">m</span><span class="op" id="3803284">.</span><span class="ident" id="3803285">vers</span>&nbsp;<span class="op" id="3803290">==</span>&nbsp;<span class="ident" id="3803293">m1</span><span class="op" id="3803295">.</span><span class="ident" id="3803296">vers</span>&nbsp;<span class="op" id="3803301">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803306">bytes</span><span class="op" id="3803311">.</span><span class="ident" id="3803312">Equal</span><span class="op" id="3803317">(</span><span class="ident" id="3803318">m</span><span class="op" id="3803319">.</span><span class="ident" id="3803320">random</span><span class="op" id="3803326">,</span>&nbsp;<span class="ident" id="3803328">m1</span><span class="op" id="3803330">.</span><span class="ident" id="3803331">random</span><span class="op" id="3803337">)</span>&nbsp;<span class="op" id="3803339">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803344">bytes</span><span class="op" id="3803349">.</span><span class="ident" id="3803350">Equal</span><span class="op" id="3803355">(</span><span class="ident" id="3803356">m</span><span class="op" id="3803357">.</span><span class="ident" id="3803358">sessionId</span><span class="op" id="3803367">,</span>&nbsp;<span class="ident" id="3803369">m1</span><span class="op" id="3803371">.</span><span class="ident" id="3803372">sessionId</span><span class="op" id="3803381">)</span>&nbsp;<span class="op" id="3803383">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803388">m</span><span class="op" id="3803389">.</span><span class="ident" id="3803390">cipherSuite</span>&nbsp;<span class="op" id="3803402">==</span>&nbsp;<span class="ident" id="3803405">m1</span><span class="op" id="3803407">.</span><span class="ident" id="3803408">cipherSuite</span>&nbsp;<span class="op" id="3803420">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803425">m</span><span class="op" id="3803426">.</span><span class="ident" id="3803427">compressionMethod</span>&nbsp;<span class="op" id="3803445">==</span>&nbsp;<span class="ident" id="3803448">m1</span><span class="op" id="3803450">.</span><span class="ident" id="3803451">compressionMethod</span>&nbsp;<span class="op" id="3803469">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803474">m</span><span class="op" id="3803475">.</span><span class="ident" id="3803476">nextProtoNeg</span>&nbsp;<span class="op" id="3803489">==</span>&nbsp;<span class="ident" id="3803492">m1</span><span class="op" id="3803494">.</span><span class="ident" id="3803495">nextProtoNeg</span>&nbsp;<span class="op" id="3803508">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803513">eqStrings</span><span class="op" id="3803522">(</span><span class="ident" id="3803523">m</span><span class="op" id="3803524">.</span><span class="ident" id="3803525">nextProtos</span><span class="op" id="3803535">,</span>&nbsp;<span class="ident" id="3803537">m1</span><span class="op" id="3803539">.</span><span class="ident" id="3803540">nextProtos</span><span class="op" id="3803550">)</span>&nbsp;<span class="op" id="3803552">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803557">m</span><span class="op" id="3803558">.</span><span class="ident" id="3803559">ocspStapling</span>&nbsp;<span class="op" id="3803572">==</span>&nbsp;<span class="ident" id="3803575">m1</span><span class="op" id="3803577">.</span><span class="ident" id="3803578">ocspStapling</span>&nbsp;<span class="op" id="3803591">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803596">m</span><span class="op" id="3803597">.</span><span class="ident" id="3803598">ticketSupported</span>&nbsp;<span class="op" id="3803614">==</span>&nbsp;<span class="ident" id="3803617">m1</span><span class="op" id="3803619">.</span><span class="ident" id="3803620">ticketSupported</span>&nbsp;<span class="op" id="3803636">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803641">m</span><span class="op" id="3803642">.</span><span class="ident" id="3803643">secureRenegotiation</span>&nbsp;<span class="op" id="3803663">==</span>&nbsp;<span class="ident" id="3803666">m1</span><span class="op" id="3803668">.</span><span class="ident" id="3803669">secureRenegotiation</span>&nbsp;<span class="op" id="3803689">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803694">m</span><span class="op" id="3803695">.</span><span class="ident" id="3803696">alpnProtocol</span>&nbsp;<span class="op" id="3803709">==</span>&nbsp;<span class="ident" id="3803712">m1</span><span class="op" id="3803714">.</span><span class="ident" id="3803715">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="3803728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3803731">func</span>&nbsp;<span class="op" id="3803736">(</span><span class="ident" id="3803737">m</span>&nbsp;<span class="op" id="3803739">*</span><span class="ident" id="3803740">serverHelloMsg</span><span class="op" id="3803754">)</span>&nbsp;<span class="ident" id="3803756">marshal</span><span class="op" id="3803763">(</span><span class="op" id="3803764">)</span>&nbsp;<span class="op" id="3803766">[</span><span class="op" id="3803767">]</span><span class="builtintype" id="3803768">byte</span>&nbsp;<span class="op" id="3803773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3803776">if</span>&nbsp;<span class="ident" id="3803779">m</span><span class="op" id="3803780">.</span><span class="ident" id="3803781">raw</span>&nbsp;<span class="op" id="3803785">!=</span>&nbsp;<span class="builtintype" id="3803788">nil</span>&nbsp;<span class="op" id="3803792">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3803796">return</span>&nbsp;<span class="ident" id="3803803">m</span><span class="op" id="3803804">.</span><span class="ident" id="3803805">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3803810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803814">length</span>&nbsp;<span class="op" id="3803821">:=</span>&nbsp;<span class="num" id="3803824">38</span>&nbsp;<span class="op" id="3803827">+</span>&nbsp;<span class="builtinfunc" id="3803829">len</span><span class="op" id="3803832">(</span><span class="ident" id="3803833">m</span><span class="op" id="3803834">.</span><span class="ident" id="3803835">sessionId</span><span class="op" id="3803844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803847">numExtensions</span>&nbsp;<span class="op" id="3803861">:=</span>&nbsp;<span class="num" id="3803864">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803867">extensionsLength</span>&nbsp;<span class="op" id="3803884">:=</span>&nbsp;<span class="num" id="3803887">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803891">nextProtoLen</span>&nbsp;<span class="op" id="3803904">:=</span>&nbsp;<span class="num" id="3803907">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3803910">if</span>&nbsp;<span class="ident" id="3803913">m</span><span class="op" id="3803914">.</span><span class="ident" id="3803915">nextProtoNeg</span>&nbsp;<span class="op" id="3803928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803932">numExtensions</span><span class="op" id="3803945">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3803950">for</span>&nbsp;<span class="ident" id="3803954">_</span><span class="op" id="3803955">,</span>&nbsp;<span class="ident" id="3803957">v</span>&nbsp;<span class="op" id="3803959">:=</span>&nbsp;<span class="keyword" id="3803962">range</span>&nbsp;<span class="ident" id="3803968">m</span><span class="op" id="3803969">.</span><span class="ident" id="3803970">nextProtos</span>&nbsp;<span class="op" id="3803981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3803986">nextProtoLen</span>&nbsp;<span class="op" id="3803999">+=</span>&nbsp;<span class="builtinfunc" id="3804002">len</span><span class="op" id="3804005">(</span><span class="ident" id="3804006">v</span><span class="op" id="3804007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804015">nextProtoLen</span>&nbsp;<span class="op" id="3804028">+=</span>&nbsp;<span class="builtinfunc" id="3804031">len</span><span class="op" id="3804034">(</span><span class="ident" id="3804035">m</span><span class="op" id="3804036">.</span><span class="ident" id="3804037">nextProtos</span><span class="op" id="3804047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804051">extensionsLength</span>&nbsp;<span class="op" id="3804068">+=</span>&nbsp;<span class="ident" id="3804071">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804088">if</span>&nbsp;<span class="ident" id="3804091">m</span><span class="op" id="3804092">.</span><span class="ident" id="3804093">ocspStapling</span>&nbsp;<span class="op" id="3804106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804110">numExtensions</span><span class="op" id="3804123">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804130">if</span>&nbsp;<span class="ident" id="3804133">m</span><span class="op" id="3804134">.</span><span class="ident" id="3804135">ticketSupported</span>&nbsp;<span class="op" id="3804151">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804155">numExtensions</span><span class="op" id="3804168">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804175">if</span>&nbsp;<span class="ident" id="3804178">m</span><span class="op" id="3804179">.</span><span class="ident" id="3804180">secureRenegotiation</span>&nbsp;<span class="op" id="3804200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804204">extensionsLength</span>&nbsp;<span class="op" id="3804221">+=</span>&nbsp;<span class="num" id="3804224">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804228">numExtensions</span><span class="op" id="3804241">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804248">if</span>&nbsp;<span class="ident" id="3804251">alpnLen</span>&nbsp;<span class="op" id="3804259">:=</span>&nbsp;<span class="builtinfunc" id="3804262">len</span><span class="op" id="3804265">(</span><span class="ident" id="3804266">m</span><span class="op" id="3804267">.</span><span class="ident" id="3804268">alpnProtocol</span><span class="op" id="3804280">)</span><span class="op" id="3804281">;</span>&nbsp;<span class="ident" id="3804283">alpnLen</span>&nbsp;<span class="op" id="3804291">&gt;</span>&nbsp;<span class="num" id="3804293">0</span>&nbsp;<span class="op" id="3804295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804299">if</span>&nbsp;<span class="ident" id="3804302">alpnLen</span>&nbsp;<span class="op" id="3804310">&gt;=</span>&nbsp;<span class="num" id="3804313">256</span>&nbsp;<span class="op" id="3804317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3804322">panic</span><span class="op" id="3804327">(</span><span class="string" id="3804328">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3804351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804355">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804359">extensionsLength</span>&nbsp;<span class="op" id="3804376">+=</span>&nbsp;<span class="num" id="3804379">2</span>&nbsp;<span class="op" id="3804381">+</span>&nbsp;<span class="num" id="3804383">1</span>&nbsp;<span class="op" id="3804385">+</span>&nbsp;<span class="ident" id="3804387">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804397">numExtensions</span><span class="op" id="3804410">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804418">if</span>&nbsp;<span class="ident" id="3804421">numExtensions</span>&nbsp;<span class="op" id="3804435">&gt;</span>&nbsp;<span class="num" id="3804437">0</span>&nbsp;<span class="op" id="3804439">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804443">extensionsLength</span>&nbsp;<span class="op" id="3804460">+=</span>&nbsp;<span class="num" id="3804463">4</span>&nbsp;<span class="op" id="3804465">*</span>&nbsp;<span class="ident" id="3804467">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804483">length</span>&nbsp;<span class="op" id="3804490">+=</span>&nbsp;<span class="num" id="3804493">2</span>&nbsp;<span class="op" id="3804495">+</span>&nbsp;<span class="ident" id="3804497">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3804515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804519">x</span>&nbsp;<span class="op" id="3804521">:=</span>&nbsp;<span class="builtinfunc" id="3804524">make</span><span class="op" id="3804528">(</span><span class="op" id="3804529">[</span><span class="op" id="3804530">]</span><span class="builtintype" id="3804531">byte</span><span class="op" id="3804535">,</span>&nbsp;<span class="num" id="3804537">4</span><span class="op" id="3804538">+</span><span class="ident" id="3804539">length</span><span class="op" id="3804545">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804548">x</span><span class="op" id="3804549">[</span><span class="num" id="3804550">0</span><span class="op" id="3804551">]</span>&nbsp;<span class="op" id="3804553">=</span>&nbsp;<span class="ident" id="3804555">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804572">x</span><span class="op" id="3804573">[</span><span class="num" id="3804574">1</span><span class="op" id="3804575">]</span>&nbsp;<span class="op" id="3804577">=</span>&nbsp;<span class="builtintype" id="3804579">uint8</span><span class="op" id="3804584">(</span><span class="ident" id="3804585">length</span>&nbsp;<span class="op" id="3804592">&gt;&gt;</span>&nbsp;<span class="num" id="3804595">16</span><span class="op" id="3804597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804600">x</span><span class="op" id="3804601">[</span><span class="num" id="3804602">2</span><span class="op" id="3804603">]</span>&nbsp;<span class="op" id="3804605">=</span>&nbsp;<span class="builtintype" id="3804607">uint8</span><span class="op" id="3804612">(</span><span class="ident" id="3804613">length</span>&nbsp;<span class="op" id="3804620">&gt;&gt;</span>&nbsp;<span class="num" id="3804623">8</span><span class="op" id="3804624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804627">x</span><span class="op" id="3804628">[</span><span class="num" id="3804629">3</span><span class="op" id="3804630">]</span>&nbsp;<span class="op" id="3804632">=</span>&nbsp;<span class="builtintype" id="3804634">uint8</span><span class="op" id="3804639">(</span><span class="ident" id="3804640">length</span><span class="op" id="3804646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804649">x</span><span class="op" id="3804650">[</span><span class="num" id="3804651">4</span><span class="op" id="3804652">]</span>&nbsp;<span class="op" id="3804654">=</span>&nbsp;<span class="builtintype" id="3804656">uint8</span><span class="op" id="3804661">(</span><span class="ident" id="3804662">m</span><span class="op" id="3804663">.</span><span class="ident" id="3804664">vers</span>&nbsp;<span class="op" id="3804669">&gt;&gt;</span>&nbsp;<span class="num" id="3804672">8</span><span class="op" id="3804673">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804676">x</span><span class="op" id="3804677">[</span><span class="num" id="3804678">5</span><span class="op" id="3804679">]</span>&nbsp;<span class="op" id="3804681">=</span>&nbsp;<span class="builtintype" id="3804683">uint8</span><span class="op" id="3804688">(</span><span class="ident" id="3804689">m</span><span class="op" id="3804690">.</span><span class="ident" id="3804691">vers</span><span class="op" id="3804695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3804698">copy</span><span class="op" id="3804702">(</span><span class="ident" id="3804703">x</span><span class="op" id="3804704">[</span><span class="num" id="3804705">6</span><span class="op" id="3804706">:</span><span class="num" id="3804707">38</span><span class="op" id="3804709">]</span><span class="op" id="3804710">,</span>&nbsp;<span class="ident" id="3804712">m</span><span class="op" id="3804713">.</span><span class="ident" id="3804714">random</span><span class="op" id="3804720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804723">x</span><span class="op" id="3804724">[</span><span class="num" id="3804725">38</span><span class="op" id="3804727">]</span>&nbsp;<span class="op" id="3804729">=</span>&nbsp;<span class="builtintype" id="3804731">uint8</span><span class="op" id="3804736">(</span><span class="builtinfunc" id="3804737">len</span><span class="op" id="3804740">(</span><span class="ident" id="3804741">m</span><span class="op" id="3804742">.</span><span class="ident" id="3804743">sessionId</span><span class="op" id="3804752">)</span><span class="op" id="3804753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3804756">copy</span><span class="op" id="3804760">(</span><span class="ident" id="3804761">x</span><span class="op" id="3804762">[</span><span class="num" id="3804763">39</span><span class="op" id="3804765">:</span><span class="num" id="3804766">39</span><span class="op" id="3804768">+</span><span class="builtinfunc" id="3804769">len</span><span class="op" id="3804772">(</span><span class="ident" id="3804773">m</span><span class="op" id="3804774">.</span><span class="ident" id="3804775">sessionId</span><span class="op" id="3804784">)</span><span class="op" id="3804785">]</span><span class="op" id="3804786">,</span>&nbsp;<span class="ident" id="3804788">m</span><span class="op" id="3804789">.</span><span class="ident" id="3804790">sessionId</span><span class="op" id="3804799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804802">z</span>&nbsp;<span class="op" id="3804804">:=</span>&nbsp;<span class="ident" id="3804807">x</span><span class="op" id="3804808">[</span><span class="num" id="3804809">39</span><span class="op" id="3804811">+</span><span class="builtinfunc" id="3804812">len</span><span class="op" id="3804815">(</span><span class="ident" id="3804816">m</span><span class="op" id="3804817">.</span><span class="ident" id="3804818">sessionId</span><span class="op" id="3804827">)</span><span class="op" id="3804828">:</span><span class="op" id="3804829">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804832">z</span><span class="op" id="3804833">[</span><span class="num" id="3804834">0</span><span class="op" id="3804835">]</span>&nbsp;<span class="op" id="3804837">=</span>&nbsp;<span class="builtintype" id="3804839">uint8</span><span class="op" id="3804844">(</span><span class="ident" id="3804845">m</span><span class="op" id="3804846">.</span><span class="ident" id="3804847">cipherSuite</span>&nbsp;<span class="op" id="3804859">&gt;&gt;</span>&nbsp;<span class="num" id="3804862">8</span><span class="op" id="3804863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804866">z</span><span class="op" id="3804867">[</span><span class="num" id="3804868">1</span><span class="op" id="3804869">]</span>&nbsp;<span class="op" id="3804871">=</span>&nbsp;<span class="builtintype" id="3804873">uint8</span><span class="op" id="3804878">(</span><span class="ident" id="3804879">m</span><span class="op" id="3804880">.</span><span class="ident" id="3804881">cipherSuite</span><span class="op" id="3804892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804895">z</span><span class="op" id="3804896">[</span><span class="num" id="3804897">2</span><span class="op" id="3804898">]</span>&nbsp;<span class="op" id="3804900">=</span>&nbsp;<span class="builtintype" id="3804902">uint8</span><span class="op" id="3804907">(</span><span class="ident" id="3804908">m</span><span class="op" id="3804909">.</span><span class="ident" id="3804910">compressionMethod</span><span class="op" id="3804927">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804931">z</span>&nbsp;<span class="op" id="3804933">=</span>&nbsp;<span class="ident" id="3804935">z</span><span class="op" id="3804936">[</span><span class="num" id="3804937">3</span><span class="op" id="3804938">:</span><span class="op" id="3804939">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3804942">if</span>&nbsp;<span class="ident" id="3804945">numExtensions</span>&nbsp;<span class="op" id="3804959">&gt;</span>&nbsp;<span class="num" id="3804961">0</span>&nbsp;<span class="op" id="3804963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3804967">z</span><span class="op" id="3804968">[</span><span class="num" id="3804969">0</span><span class="op" id="3804970">]</span>&nbsp;<span class="op" id="3804972">=</span>&nbsp;<span class="builtintype" id="3804974">byte</span><span class="op" id="3804978">(</span><span class="ident" id="3804979">extensionsLength</span>&nbsp;<span class="op" id="3804996">&gt;&gt;</span>&nbsp;<span class="num" id="3804999">8</span><span class="op" id="3805000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805004">z</span><span class="op" id="3805005">[</span><span class="num" id="3805006">1</span><span class="op" id="3805007">]</span>&nbsp;<span class="op" id="3805009">=</span>&nbsp;<span class="builtintype" id="3805011">byte</span><span class="op" id="3805015">(</span><span class="ident" id="3805016">extensionsLength</span><span class="op" id="3805032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805036">z</span>&nbsp;<span class="op" id="3805038">=</span>&nbsp;<span class="ident" id="3805040">z</span><span class="op" id="3805041">[</span><span class="num" id="3805042">2</span><span class="op" id="3805043">:</span><span class="op" id="3805044">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805047">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805050">if</span>&nbsp;<span class="ident" id="3805053">m</span><span class="op" id="3805054">.</span><span class="ident" id="3805055">nextProtoNeg</span>&nbsp;<span class="op" id="3805068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805072">z</span><span class="op" id="3805073">[</span><span class="num" id="3805074">0</span><span class="op" id="3805075">]</span>&nbsp;<span class="op" id="3805077">=</span>&nbsp;<span class="builtintype" id="3805079">byte</span><span class="op" id="3805083">(</span><span class="ident" id="3805084">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3805106">&gt;&gt;</span>&nbsp;<span class="num" id="3805109">8</span><span class="op" id="3805110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805114">z</span><span class="op" id="3805115">[</span><span class="num" id="3805116">1</span><span class="op" id="3805117">]</span>&nbsp;<span class="op" id="3805119">=</span>&nbsp;<span class="builtintype" id="3805121">byte</span><span class="op" id="3805125">(</span><span class="ident" id="3805126">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3805148">&amp;</span>&nbsp;<span class="num" id="3805150">0xff</span><span class="op" id="3805154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805158">z</span><span class="op" id="3805159">[</span><span class="num" id="3805160">2</span><span class="op" id="3805161">]</span>&nbsp;<span class="op" id="3805163">=</span>&nbsp;<span class="builtintype" id="3805165">byte</span><span class="op" id="3805169">(</span><span class="ident" id="3805170">nextProtoLen</span>&nbsp;<span class="op" id="3805183">&gt;&gt;</span>&nbsp;<span class="num" id="3805186">8</span><span class="op" id="3805187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805191">z</span><span class="op" id="3805192">[</span><span class="num" id="3805193">3</span><span class="op" id="3805194">]</span>&nbsp;<span class="op" id="3805196">=</span>&nbsp;<span class="builtintype" id="3805198">byte</span><span class="op" id="3805202">(</span><span class="ident" id="3805203">nextProtoLen</span><span class="op" id="3805215">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805219">z</span>&nbsp;<span class="op" id="3805221">=</span>&nbsp;<span class="ident" id="3805223">z</span><span class="op" id="3805224">[</span><span class="num" id="3805225">4</span><span class="op" id="3805226">:</span><span class="op" id="3805227">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805232">for</span>&nbsp;<span class="ident" id="3805236">_</span><span class="op" id="3805237">,</span>&nbsp;<span class="ident" id="3805239">v</span>&nbsp;<span class="op" id="3805241">:=</span>&nbsp;<span class="keyword" id="3805244">range</span>&nbsp;<span class="ident" id="3805250">m</span><span class="op" id="3805251">.</span><span class="ident" id="3805252">nextProtos</span>&nbsp;<span class="op" id="3805263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805268">l</span>&nbsp;<span class="op" id="3805270">:=</span>&nbsp;<span class="builtinfunc" id="3805273">len</span><span class="op" id="3805276">(</span><span class="ident" id="3805277">v</span><span class="op" id="3805278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805283">if</span>&nbsp;<span class="ident" id="3805286">l</span>&nbsp;<span class="op" id="3805288">&gt;</span>&nbsp;<span class="num" id="3805290">255</span>&nbsp;<span class="op" id="3805294">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805300">l</span>&nbsp;<span class="op" id="3805302">=</span>&nbsp;<span class="num" id="3805304">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805316">z</span><span class="op" id="3805317">[</span><span class="num" id="3805318">0</span><span class="op" id="3805319">]</span>&nbsp;<span class="op" id="3805321">=</span>&nbsp;<span class="builtintype" id="3805323">byte</span><span class="op" id="3805327">(</span><span class="ident" id="3805328">l</span><span class="op" id="3805329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3805334">copy</span><span class="op" id="3805338">(</span><span class="ident" id="3805339">z</span><span class="op" id="3805340">[</span><span class="num" id="3805341">1</span><span class="op" id="3805342">:</span><span class="op" id="3805343">]</span><span class="op" id="3805344">,</span>&nbsp;<span class="op" id="3805346">[</span><span class="op" id="3805347">]</span><span class="builtintype" id="3805348">byte</span><span class="op" id="3805352">(</span><span class="ident" id="3805353">v</span><span class="op" id="3805354">[</span><span class="num" id="3805355">0</span><span class="op" id="3805356">:</span><span class="ident" id="3805357">l</span><span class="op" id="3805358">]</span><span class="op" id="3805359">)</span><span class="op" id="3805360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805365">z</span>&nbsp;<span class="op" id="3805367">=</span>&nbsp;<span class="ident" id="3805369">z</span><span class="op" id="3805370">[</span><span class="num" id="3805371">1</span><span class="op" id="3805372">+</span><span class="ident" id="3805373">l</span><span class="op" id="3805374">:</span><span class="op" id="3805375">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805385">if</span>&nbsp;<span class="ident" id="3805388">m</span><span class="op" id="3805389">.</span><span class="ident" id="3805390">ocspStapling</span>&nbsp;<span class="op" id="3805403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805407">z</span><span class="op" id="3805408">[</span><span class="num" id="3805409">0</span><span class="op" id="3805410">]</span>&nbsp;<span class="op" id="3805412">=</span>&nbsp;<span class="builtintype" id="3805414">byte</span><span class="op" id="3805418">(</span><span class="ident" id="3805419">extensionStatusRequest</span>&nbsp;<span class="op" id="3805442">&gt;&gt;</span>&nbsp;<span class="num" id="3805445">8</span><span class="op" id="3805446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805450">z</span><span class="op" id="3805451">[</span><span class="num" id="3805452">1</span><span class="op" id="3805453">]</span>&nbsp;<span class="op" id="3805455">=</span>&nbsp;<span class="builtintype" id="3805457">byte</span><span class="op" id="3805461">(</span><span class="ident" id="3805462">extensionStatusRequest</span><span class="op" id="3805484">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805488">z</span>&nbsp;<span class="op" id="3805490">=</span>&nbsp;<span class="ident" id="3805492">z</span><span class="op" id="3805493">[</span><span class="num" id="3805494">4</span><span class="op" id="3805495">:</span><span class="op" id="3805496">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805502">if</span>&nbsp;<span class="ident" id="3805505">m</span><span class="op" id="3805506">.</span><span class="ident" id="3805507">ticketSupported</span>&nbsp;<span class="op" id="3805523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805527">z</span><span class="op" id="3805528">[</span><span class="num" id="3805529">0</span><span class="op" id="3805530">]</span>&nbsp;<span class="op" id="3805532">=</span>&nbsp;<span class="builtintype" id="3805534">byte</span><span class="op" id="3805538">(</span><span class="ident" id="3805539">extensionSessionTicket</span>&nbsp;<span class="op" id="3805562">&gt;&gt;</span>&nbsp;<span class="num" id="3805565">8</span><span class="op" id="3805566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805570">z</span><span class="op" id="3805571">[</span><span class="num" id="3805572">1</span><span class="op" id="3805573">]</span>&nbsp;<span class="op" id="3805575">=</span>&nbsp;<span class="builtintype" id="3805577">byte</span><span class="op" id="3805581">(</span><span class="ident" id="3805582">extensionSessionTicket</span><span class="op" id="3805604">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805608">z</span>&nbsp;<span class="op" id="3805610">=</span>&nbsp;<span class="ident" id="3805612">z</span><span class="op" id="3805613">[</span><span class="num" id="3805614">4</span><span class="op" id="3805615">:</span><span class="op" id="3805616">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805622">if</span>&nbsp;<span class="ident" id="3805625">m</span><span class="op" id="3805626">.</span><span class="ident" id="3805627">secureRenegotiation</span>&nbsp;<span class="op" id="3805647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805651">z</span><span class="op" id="3805652">[</span><span class="num" id="3805653">0</span><span class="op" id="3805654">]</span>&nbsp;<span class="op" id="3805656">=</span>&nbsp;<span class="builtintype" id="3805658">byte</span><span class="op" id="3805662">(</span><span class="ident" id="3805663">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3805690">&gt;&gt;</span>&nbsp;<span class="num" id="3805693">8</span><span class="op" id="3805694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805698">z</span><span class="op" id="3805699">[</span><span class="num" id="3805700">1</span><span class="op" id="3805701">]</span>&nbsp;<span class="op" id="3805703">=</span>&nbsp;<span class="builtintype" id="3805705">byte</span><span class="op" id="3805709">(</span><span class="ident" id="3805710">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3805737">&amp;</span>&nbsp;<span class="num" id="3805739">0xff</span><span class="op" id="3805743">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805747">z</span><span class="op" id="3805748">[</span><span class="num" id="3805749">2</span><span class="op" id="3805750">]</span>&nbsp;<span class="op" id="3805752">=</span>&nbsp;<span class="num" id="3805754">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805758">z</span><span class="op" id="3805759">[</span><span class="num" id="3805760">3</span><span class="op" id="3805761">]</span>&nbsp;<span class="op" id="3805763">=</span>&nbsp;<span class="num" id="3805765">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805769">z</span>&nbsp;<span class="op" id="3805771">=</span>&nbsp;<span class="ident" id="3805773">z</span><span class="op" id="3805774">[</span><span class="num" id="3805775">5</span><span class="op" id="3805776">:</span><span class="op" id="3805777">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3805780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3805783">if</span>&nbsp;<span class="ident" id="3805786">alpnLen</span>&nbsp;<span class="op" id="3805794">:=</span>&nbsp;<span class="builtinfunc" id="3805797">len</span><span class="op" id="3805800">(</span><span class="ident" id="3805801">m</span><span class="op" id="3805802">.</span><span class="ident" id="3805803">alpnProtocol</span><span class="op" id="3805815">)</span><span class="op" id="3805816">;</span>&nbsp;<span class="ident" id="3805818">alpnLen</span>&nbsp;<span class="op" id="3805826">&gt;</span>&nbsp;<span class="num" id="3805828">0</span>&nbsp;<span class="op" id="3805830">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805834">z</span><span class="op" id="3805835">[</span><span class="num" id="3805836">0</span><span class="op" id="3805837">]</span>&nbsp;<span class="op" id="3805839">=</span>&nbsp;<span class="builtintype" id="3805841">byte</span><span class="op" id="3805845">(</span><span class="ident" id="3805846">extensionALPN</span>&nbsp;<span class="op" id="3805860">&gt;&gt;</span>&nbsp;<span class="num" id="3805863">8</span><span class="op" id="3805864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805868">z</span><span class="op" id="3805869">[</span><span class="num" id="3805870">1</span><span class="op" id="3805871">]</span>&nbsp;<span class="op" id="3805873">=</span>&nbsp;<span class="builtintype" id="3805875">byte</span><span class="op" id="3805879">(</span><span class="ident" id="3805880">extensionALPN</span>&nbsp;<span class="op" id="3805894">&amp;</span>&nbsp;<span class="num" id="3805896">0xff</span><span class="op" id="3805900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805904">l</span>&nbsp;<span class="op" id="3805906">:=</span>&nbsp;<span class="num" id="3805909">2</span>&nbsp;<span class="op" id="3805911">+</span>&nbsp;<span class="num" id="3805913">1</span>&nbsp;<span class="op" id="3805915">+</span>&nbsp;<span class="ident" id="3805917">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805927">z</span><span class="op" id="3805928">[</span><span class="num" id="3805929">2</span><span class="op" id="3805930">]</span>&nbsp;<span class="op" id="3805932">=</span>&nbsp;<span class="builtintype" id="3805934">byte</span><span class="op" id="3805938">(</span><span class="ident" id="3805939">l</span>&nbsp;<span class="op" id="3805941">&gt;&gt;</span>&nbsp;<span class="num" id="3805944">8</span><span class="op" id="3805945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805949">z</span><span class="op" id="3805950">[</span><span class="num" id="3805951">3</span><span class="op" id="3805952">]</span>&nbsp;<span class="op" id="3805954">=</span>&nbsp;<span class="builtintype" id="3805956">byte</span><span class="op" id="3805960">(</span><span class="ident" id="3805961">l</span><span class="op" id="3805962">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805966">l</span>&nbsp;<span class="op" id="3805968">-=</span>&nbsp;<span class="num" id="3805971">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805975">z</span><span class="op" id="3805976">[</span><span class="num" id="3805977">4</span><span class="op" id="3805978">]</span>&nbsp;<span class="op" id="3805980">=</span>&nbsp;<span class="builtintype" id="3805982">byte</span><span class="op" id="3805986">(</span><span class="ident" id="3805987">l</span>&nbsp;<span class="op" id="3805989">&gt;&gt;</span>&nbsp;<span class="num" id="3805992">8</span><span class="op" id="3805993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805997">z</span><span class="op" id="3805998">[</span><span class="num" id="3805999">5</span><span class="op" id="3806000">]</span>&nbsp;<span class="op" id="3806002">=</span>&nbsp;<span class="builtintype" id="3806004">byte</span><span class="op" id="3806008">(</span><span class="ident" id="3806009">l</span><span class="op" id="3806010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806014">l</span>&nbsp;<span class="op" id="3806016">-=</span>&nbsp;<span class="num" id="3806019">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806023">z</span><span class="op" id="3806024">[</span><span class="num" id="3806025">6</span><span class="op" id="3806026">]</span>&nbsp;<span class="op" id="3806028">=</span>&nbsp;<span class="builtintype" id="3806030">byte</span><span class="op" id="3806034">(</span><span class="ident" id="3806035">l</span><span class="op" id="3806036">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3806040">copy</span><span class="op" id="3806044">(</span><span class="ident" id="3806045">z</span><span class="op" id="3806046">[</span><span class="num" id="3806047">7</span><span class="op" id="3806048">:</span><span class="op" id="3806049">]</span><span class="op" id="3806050">,</span>&nbsp;<span class="op" id="3806052">[</span><span class="op" id="3806053">]</span><span class="builtintype" id="3806054">byte</span><span class="op" id="3806058">(</span><span class="ident" id="3806059">m</span><span class="op" id="3806060">.</span><span class="ident" id="3806061">alpnProtocol</span><span class="op" id="3806073">)</span><span class="op" id="3806074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806078">z</span>&nbsp;<span class="op" id="3806080">=</span>&nbsp;<span class="ident" id="3806082">z</span><span class="op" id="3806083">[</span><span class="num" id="3806084">7</span><span class="op" id="3806085">+</span><span class="ident" id="3806086">alpnLen</span><span class="op" id="3806093">:</span><span class="op" id="3806094">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806101">m</span><span class="op" id="3806102">.</span><span class="ident" id="3806103">raw</span>&nbsp;<span class="op" id="3806107">=</span>&nbsp;<span class="ident" id="3806109">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806113">return</span>&nbsp;<span class="ident" id="3806120">x</span><br>
<span class="lineno"></span><span class="op" id="3806122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3806125">func</span>&nbsp;<span class="op" id="3806130">(</span><span class="ident" id="3806131">m</span>&nbsp;<span class="op" id="3806133">*</span><span class="ident" id="3806134">serverHelloMsg</span><span class="op" id="3806148">)</span>&nbsp;<span class="ident" id="3806150">unmarshal</span><span class="op" id="3806159">(</span><span class="ident" id="3806160">data</span>&nbsp;<span class="op" id="3806165">[</span><span class="op" id="3806166">]</span><span class="builtintype" id="3806167">byte</span><span class="op" id="3806171">)</span>&nbsp;<span class="builtintype" id="3806173">bool</span>&nbsp;<span class="op" id="3806178">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806181">if</span>&nbsp;<span class="builtinfunc" id="3806184">len</span><span class="op" id="3806187">(</span><span class="ident" id="3806188">data</span><span class="op" id="3806192">)</span>&nbsp;<span class="op" id="3806194">&lt;</span>&nbsp;<span class="num" id="3806196">42</span>&nbsp;<span class="op" id="3806199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806203">return</span>&nbsp;<span class="builtintype" id="3806210">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806220">m</span><span class="op" id="3806221">.</span><span class="ident" id="3806222">raw</span>&nbsp;<span class="op" id="3806226">=</span>&nbsp;<span class="ident" id="3806228">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806234">m</span><span class="op" id="3806235">.</span><span class="ident" id="3806236">vers</span>&nbsp;<span class="op" id="3806241">=</span>&nbsp;<span class="builtintype" id="3806243">uint16</span><span class="op" id="3806249">(</span><span class="ident" id="3806250">data</span><span class="op" id="3806254">[</span><span class="num" id="3806255">4</span><span class="op" id="3806256">]</span><span class="op" id="3806257">)</span><span class="op" id="3806258">&lt;&lt;</span><span class="num" id="3806260">8</span>&nbsp;<span class="op" id="3806262">|</span>&nbsp;<span class="builtintype" id="3806264">uint16</span><span class="op" id="3806270">(</span><span class="ident" id="3806271">data</span><span class="op" id="3806275">[</span><span class="num" id="3806276">5</span><span class="op" id="3806277">]</span><span class="op" id="3806278">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806281">m</span><span class="op" id="3806282">.</span><span class="ident" id="3806283">random</span>&nbsp;<span class="op" id="3806290">=</span>&nbsp;<span class="ident" id="3806292">data</span><span class="op" id="3806296">[</span><span class="num" id="3806297">6</span><span class="op" id="3806298">:</span><span class="num" id="3806299">38</span><span class="op" id="3806301">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806304">sessionIdLen</span>&nbsp;<span class="op" id="3806317">:=</span>&nbsp;<span class="builtintype" id="3806320">int</span><span class="op" id="3806323">(</span><span class="ident" id="3806324">data</span><span class="op" id="3806328">[</span><span class="num" id="3806329">38</span><span class="op" id="3806331">]</span><span class="op" id="3806332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806335">if</span>&nbsp;<span class="ident" id="3806338">sessionIdLen</span>&nbsp;<span class="op" id="3806351">&gt;</span>&nbsp;<span class="num" id="3806353">32</span>&nbsp;<span class="op" id="3806356">||</span>&nbsp;<span class="builtinfunc" id="3806359">len</span><span class="op" id="3806362">(</span><span class="ident" id="3806363">data</span><span class="op" id="3806367">)</span>&nbsp;<span class="op" id="3806369">&lt;</span>&nbsp;<span class="num" id="3806371">39</span><span class="op" id="3806373">+</span><span class="ident" id="3806374">sessionIdLen</span>&nbsp;<span class="op" id="3806387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806391">return</span>&nbsp;<span class="builtintype" id="3806398">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806405">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806408">m</span><span class="op" id="3806409">.</span><span class="ident" id="3806410">sessionId</span>&nbsp;<span class="op" id="3806420">=</span>&nbsp;<span class="ident" id="3806422">data</span><span class="op" id="3806426">[</span><span class="num" id="3806427">39</span>&nbsp;<span class="op" id="3806430">:</span>&nbsp;<span class="num" id="3806432">39</span><span class="op" id="3806434">+</span><span class="ident" id="3806435">sessionIdLen</span><span class="op" id="3806447">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806450">data</span>&nbsp;<span class="op" id="3806455">=</span>&nbsp;<span class="ident" id="3806457">data</span><span class="op" id="3806461">[</span><span class="num" id="3806462">39</span><span class="op" id="3806464">+</span><span class="ident" id="3806465">sessionIdLen</span><span class="op" id="3806477">:</span><span class="op" id="3806478">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806481">if</span>&nbsp;<span class="builtinfunc" id="3806484">len</span><span class="op" id="3806487">(</span><span class="ident" id="3806488">data</span><span class="op" id="3806492">)</span>&nbsp;<span class="op" id="3806494">&lt;</span>&nbsp;<span class="num" id="3806496">3</span>&nbsp;<span class="op" id="3806498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806502">return</span>&nbsp;<span class="builtintype" id="3806509">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806516">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806519">m</span><span class="op" id="3806520">.</span><span class="ident" id="3806521">cipherSuite</span>&nbsp;<span class="op" id="3806533">=</span>&nbsp;<span class="builtintype" id="3806535">uint16</span><span class="op" id="3806541">(</span><span class="ident" id="3806542">data</span><span class="op" id="3806546">[</span><span class="num" id="3806547">0</span><span class="op" id="3806548">]</span><span class="op" id="3806549">)</span><span class="op" id="3806550">&lt;&lt;</span><span class="num" id="3806552">8</span>&nbsp;<span class="op" id="3806554">|</span>&nbsp;<span class="builtintype" id="3806556">uint16</span><span class="op" id="3806562">(</span><span class="ident" id="3806563">data</span><span class="op" id="3806567">[</span><span class="num" id="3806568">1</span><span class="op" id="3806569">]</span><span class="op" id="3806570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806573">m</span><span class="op" id="3806574">.</span><span class="ident" id="3806575">compressionMethod</span>&nbsp;<span class="op" id="3806593">=</span>&nbsp;<span class="ident" id="3806595">data</span><span class="op" id="3806599">[</span><span class="num" id="3806600">2</span><span class="op" id="3806601">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806604">data</span>&nbsp;<span class="op" id="3806609">=</span>&nbsp;<span class="ident" id="3806611">data</span><span class="op" id="3806615">[</span><span class="num" id="3806616">3</span><span class="op" id="3806617">:</span><span class="op" id="3806618">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806622">m</span><span class="op" id="3806623">.</span><span class="ident" id="3806624">nextProtoNeg</span>&nbsp;<span class="op" id="3806637">=</span>&nbsp;<span class="builtintype" id="3806639">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806646">m</span><span class="op" id="3806647">.</span><span class="ident" id="3806648">nextProtos</span>&nbsp;<span class="op" id="3806659">=</span>&nbsp;<span class="builtintype" id="3806661">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806666">m</span><span class="op" id="3806667">.</span><span class="ident" id="3806668">ocspStapling</span>&nbsp;<span class="op" id="3806681">=</span>&nbsp;<span class="builtintype" id="3806683">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806690">m</span><span class="op" id="3806691">.</span><span class="ident" id="3806692">ticketSupported</span>&nbsp;<span class="op" id="3806708">=</span>&nbsp;<span class="builtintype" id="3806710">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806717">m</span><span class="op" id="3806718">.</span><span class="ident" id="3806719">alpnProtocol</span>&nbsp;<span class="op" id="3806732">=</span>&nbsp;<span class="string" id="3806734">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806739">if</span>&nbsp;<span class="builtinfunc" id="3806742">len</span><span class="op" id="3806745">(</span><span class="ident" id="3806746">data</span><span class="op" id="3806750">)</span>&nbsp;<span class="op" id="3806752">==</span>&nbsp;<span class="num" id="3806755">0</span>&nbsp;<span class="op" id="3806757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3806761">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806819">return</span>&nbsp;<span class="builtintype" id="3806826">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806835">if</span>&nbsp;<span class="builtinfunc" id="3806838">len</span><span class="op" id="3806841">(</span><span class="ident" id="3806842">data</span><span class="op" id="3806846">)</span>&nbsp;<span class="op" id="3806848">&lt;</span>&nbsp;<span class="num" id="3806850">2</span>&nbsp;<span class="op" id="3806852">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806856">return</span>&nbsp;<span class="builtintype" id="3806863">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806874">extensionsLength</span>&nbsp;<span class="op" id="3806891">:=</span>&nbsp;<span class="builtintype" id="3806894">int</span><span class="op" id="3806897">(</span><span class="ident" id="3806898">data</span><span class="op" id="3806902">[</span><span class="num" id="3806903">0</span><span class="op" id="3806904">]</span><span class="op" id="3806905">)</span><span class="op" id="3806906">&lt;&lt;</span><span class="num" id="3806908">8</span>&nbsp;<span class="op" id="3806910">|</span>&nbsp;<span class="builtintype" id="3806912">int</span><span class="op" id="3806915">(</span><span class="ident" id="3806916">data</span><span class="op" id="3806920">[</span><span class="num" id="3806921">1</span><span class="op" id="3806922">]</span><span class="op" id="3806923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3806926">data</span>&nbsp;<span class="op" id="3806931">=</span>&nbsp;<span class="ident" id="3806933">data</span><span class="op" id="3806937">[</span><span class="num" id="3806938">2</span><span class="op" id="3806939">:</span><span class="op" id="3806940">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806943">if</span>&nbsp;<span class="builtinfunc" id="3806946">len</span><span class="op" id="3806949">(</span><span class="ident" id="3806950">data</span><span class="op" id="3806954">)</span>&nbsp;<span class="op" id="3806956">!=</span>&nbsp;<span class="ident" id="3806959">extensionsLength</span>&nbsp;<span class="op" id="3806976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806980">return</span>&nbsp;<span class="builtintype" id="3806987">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3806994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3806998">for</span>&nbsp;<span class="builtinfunc" id="3807002">len</span><span class="op" id="3807005">(</span><span class="ident" id="3807006">data</span><span class="op" id="3807010">)</span>&nbsp;<span class="op" id="3807012">!=</span>&nbsp;<span class="num" id="3807015">0</span>&nbsp;<span class="op" id="3807017">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807021">if</span>&nbsp;<span class="builtinfunc" id="3807024">len</span><span class="op" id="3807027">(</span><span class="ident" id="3807028">data</span><span class="op" id="3807032">)</span>&nbsp;<span class="op" id="3807034">&lt;</span>&nbsp;<span class="num" id="3807036">4</span>&nbsp;<span class="op" id="3807038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807043">return</span>&nbsp;<span class="builtintype" id="3807050">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807062">extension</span>&nbsp;<span class="op" id="3807072">:=</span>&nbsp;<span class="builtintype" id="3807075">uint16</span><span class="op" id="3807081">(</span><span class="ident" id="3807082">data</span><span class="op" id="3807086">[</span><span class="num" id="3807087">0</span><span class="op" id="3807088">]</span><span class="op" id="3807089">)</span><span class="op" id="3807090">&lt;&lt;</span><span class="num" id="3807092">8</span>&nbsp;<span class="op" id="3807094">|</span>&nbsp;<span class="builtintype" id="3807096">uint16</span><span class="op" id="3807102">(</span><span class="ident" id="3807103">data</span><span class="op" id="3807107">[</span><span class="num" id="3807108">1</span><span class="op" id="3807109">]</span><span class="op" id="3807110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807114">length</span>&nbsp;<span class="op" id="3807121">:=</span>&nbsp;<span class="builtintype" id="3807124">int</span><span class="op" id="3807127">(</span><span class="ident" id="3807128">data</span><span class="op" id="3807132">[</span><span class="num" id="3807133">2</span><span class="op" id="3807134">]</span><span class="op" id="3807135">)</span><span class="op" id="3807136">&lt;&lt;</span><span class="num" id="3807138">8</span>&nbsp;<span class="op" id="3807140">|</span>&nbsp;<span class="builtintype" id="3807142">int</span><span class="op" id="3807145">(</span><span class="ident" id="3807146">data</span><span class="op" id="3807150">[</span><span class="num" id="3807151">3</span><span class="op" id="3807152">]</span><span class="op" id="3807153">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807157">data</span>&nbsp;<span class="op" id="3807162">=</span>&nbsp;<span class="ident" id="3807164">data</span><span class="op" id="3807168">[</span><span class="num" id="3807169">4</span><span class="op" id="3807170">:</span><span class="op" id="3807171">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807175">if</span>&nbsp;<span class="builtinfunc" id="3807178">len</span><span class="op" id="3807181">(</span><span class="ident" id="3807182">data</span><span class="op" id="3807186">)</span>&nbsp;<span class="op" id="3807188">&lt;</span>&nbsp;<span class="ident" id="3807190">length</span>&nbsp;<span class="op" id="3807197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807202">return</span>&nbsp;<span class="builtintype" id="3807209">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807222">switch</span>&nbsp;<span class="ident" id="3807229">extension</span>&nbsp;<span class="op" id="3807239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807243">case</span>&nbsp;<span class="ident" id="3807248">extensionNextProtoNeg</span><span class="op" id="3807269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807274">m</span><span class="op" id="3807275">.</span><span class="ident" id="3807276">nextProtoNeg</span>&nbsp;<span class="op" id="3807289">=</span>&nbsp;<span class="builtintype" id="3807291">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807299">d</span>&nbsp;<span class="op" id="3807301">:=</span>&nbsp;<span class="ident" id="3807304">data</span><span class="op" id="3807308">[</span><span class="op" id="3807309">:</span><span class="ident" id="3807310">length</span><span class="op" id="3807316">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807321">for</span>&nbsp;<span class="builtinfunc" id="3807325">len</span><span class="op" id="3807328">(</span><span class="ident" id="3807329">d</span><span class="op" id="3807330">)</span>&nbsp;<span class="op" id="3807332">&gt;</span>&nbsp;<span class="num" id="3807334">0</span>&nbsp;<span class="op" id="3807336">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807342">l</span>&nbsp;<span class="op" id="3807344">:=</span>&nbsp;<span class="builtintype" id="3807347">int</span><span class="op" id="3807350">(</span><span class="ident" id="3807351">d</span><span class="op" id="3807352">[</span><span class="num" id="3807353">0</span><span class="op" id="3807354">]</span><span class="op" id="3807355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807361">d</span>&nbsp;<span class="op" id="3807363">=</span>&nbsp;<span class="ident" id="3807365">d</span><span class="op" id="3807366">[</span><span class="num" id="3807367">1</span><span class="op" id="3807368">:</span><span class="op" id="3807369">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807375">if</span>&nbsp;<span class="ident" id="3807378">l</span>&nbsp;<span class="op" id="3807380">==</span>&nbsp;<span class="num" id="3807383">0</span>&nbsp;<span class="op" id="3807385">||</span>&nbsp;<span class="ident" id="3807388">l</span>&nbsp;<span class="op" id="3807390">&gt;</span>&nbsp;<span class="builtinfunc" id="3807392">len</span><span class="op" id="3807395">(</span><span class="ident" id="3807396">d</span><span class="op" id="3807397">)</span>&nbsp;<span class="op" id="3807399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807406">return</span>&nbsp;<span class="builtintype" id="3807413">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807423">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807429">m</span><span class="op" id="3807430">.</span><span class="ident" id="3807431">nextProtos</span>&nbsp;<span class="op" id="3807442">=</span>&nbsp;<span class="builtinfunc" id="3807444">append</span><span class="op" id="3807450">(</span><span class="ident" id="3807451">m</span><span class="op" id="3807452">.</span><span class="ident" id="3807453">nextProtos</span><span class="op" id="3807463">,</span>&nbsp;<span class="builtintype" id="3807465">string</span><span class="op" id="3807471">(</span><span class="ident" id="3807472">d</span><span class="op" id="3807473">[</span><span class="op" id="3807474">:</span><span class="ident" id="3807475">l</span><span class="op" id="3807476">]</span><span class="op" id="3807477">)</span><span class="op" id="3807478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807484">d</span>&nbsp;<span class="op" id="3807486">=</span>&nbsp;<span class="ident" id="3807488">d</span><span class="op" id="3807489">[</span><span class="ident" id="3807490">l</span><span class="op" id="3807491">:</span><span class="op" id="3807492">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807501">case</span>&nbsp;<span class="ident" id="3807506">extensionStatusRequest</span><span class="op" id="3807528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807533">if</span>&nbsp;<span class="ident" id="3807536">length</span>&nbsp;<span class="op" id="3807543">&gt;</span>&nbsp;<span class="num" id="3807545">0</span>&nbsp;<span class="op" id="3807547">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807553">return</span>&nbsp;<span class="builtintype" id="3807560">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807574">m</span><span class="op" id="3807575">.</span><span class="ident" id="3807576">ocspStapling</span>&nbsp;<span class="op" id="3807589">=</span>&nbsp;<span class="builtintype" id="3807591">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807598">case</span>&nbsp;<span class="ident" id="3807603">extensionSessionTicket</span><span class="op" id="3807625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807630">if</span>&nbsp;<span class="ident" id="3807633">length</span>&nbsp;<span class="op" id="3807640">&gt;</span>&nbsp;<span class="num" id="3807642">0</span>&nbsp;<span class="op" id="3807644">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807650">return</span>&nbsp;<span class="builtintype" id="3807657">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807671">m</span><span class="op" id="3807672">.</span><span class="ident" id="3807673">ticketSupported</span>&nbsp;<span class="op" id="3807689">=</span>&nbsp;<span class="builtintype" id="3807691">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807698">case</span>&nbsp;<span class="ident" id="3807703">extensionRenegotiationInfo</span><span class="op" id="3807729">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807734">if</span>&nbsp;<span class="ident" id="3807737">length</span>&nbsp;<span class="op" id="3807744">!=</span>&nbsp;<span class="num" id="3807747">1</span>&nbsp;<span class="op" id="3807749">||</span>&nbsp;<span class="ident" id="3807752">data</span><span class="op" id="3807756">[</span><span class="num" id="3807757">0</span><span class="op" id="3807758">]</span>&nbsp;<span class="op" id="3807760">!=</span>&nbsp;<span class="num" id="3807763">0</span>&nbsp;<span class="op" id="3807765">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807771">return</span>&nbsp;<span class="builtintype" id="3807778">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807792">m</span><span class="op" id="3807793">.</span><span class="ident" id="3807794">secureRenegotiation</span>&nbsp;<span class="op" id="3807814">=</span>&nbsp;<span class="builtintype" id="3807816">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807823">case</span>&nbsp;<span class="ident" id="3807828">extensionALPN</span><span class="op" id="3807841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807846">d</span>&nbsp;<span class="op" id="3807848">:=</span>&nbsp;<span class="ident" id="3807851">data</span><span class="op" id="3807855">[</span><span class="op" id="3807856">:</span><span class="ident" id="3807857">length</span><span class="op" id="3807863">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807868">if</span>&nbsp;<span class="builtinfunc" id="3807871">len</span><span class="op" id="3807874">(</span><span class="ident" id="3807875">d</span><span class="op" id="3807876">)</span>&nbsp;<span class="op" id="3807878">&lt;</span>&nbsp;<span class="num" id="3807880">3</span>&nbsp;<span class="op" id="3807882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807888">return</span>&nbsp;<span class="builtintype" id="3807895">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807909">l</span>&nbsp;<span class="op" id="3807911">:=</span>&nbsp;<span class="builtintype" id="3807914">int</span><span class="op" id="3807917">(</span><span class="ident" id="3807918">d</span><span class="op" id="3807919">[</span><span class="num" id="3807920">0</span><span class="op" id="3807921">]</span><span class="op" id="3807922">)</span><span class="op" id="3807923">&lt;&lt;</span><span class="num" id="3807925">8</span>&nbsp;<span class="op" id="3807927">|</span>&nbsp;<span class="builtintype" id="3807929">int</span><span class="op" id="3807932">(</span><span class="ident" id="3807933">d</span><span class="op" id="3807934">[</span><span class="num" id="3807935">1</span><span class="op" id="3807936">]</span><span class="op" id="3807937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807942">if</span>&nbsp;<span class="ident" id="3807945">l</span>&nbsp;<span class="op" id="3807947">!=</span>&nbsp;<span class="builtinfunc" id="3807950">len</span><span class="op" id="3807953">(</span><span class="ident" id="3807954">d</span><span class="op" id="3807955">)</span><span class="op" id="3807956">-</span><span class="num" id="3807957">2</span>&nbsp;<span class="op" id="3807959">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3807965">return</span>&nbsp;<span class="builtintype" id="3807972">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807986">d</span>&nbsp;<span class="op" id="3807988">=</span>&nbsp;<span class="ident" id="3807990">d</span><span class="op" id="3807991">[</span><span class="num" id="3807992">2</span><span class="op" id="3807993">:</span><span class="op" id="3807994">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3807999">l</span>&nbsp;<span class="op" id="3808001">=</span>&nbsp;<span class="builtintype" id="3808003">int</span><span class="op" id="3808006">(</span><span class="ident" id="3808007">d</span><span class="op" id="3808008">[</span><span class="num" id="3808009">0</span><span class="op" id="3808010">]</span><span class="op" id="3808011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808016">if</span>&nbsp;<span class="ident" id="3808019">l</span>&nbsp;<span class="op" id="3808021">!=</span>&nbsp;<span class="builtinfunc" id="3808024">len</span><span class="op" id="3808027">(</span><span class="ident" id="3808028">d</span><span class="op" id="3808029">)</span><span class="op" id="3808030">-</span><span class="num" id="3808031">1</span>&nbsp;<span class="op" id="3808033">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808039">return</span>&nbsp;<span class="builtintype" id="3808046">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3808055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808060">d</span>&nbsp;<span class="op" id="3808062">=</span>&nbsp;<span class="ident" id="3808064">d</span><span class="op" id="3808065">[</span><span class="num" id="3808066">1</span><span class="op" id="3808067">:</span><span class="op" id="3808068">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808073">m</span><span class="op" id="3808074">.</span><span class="ident" id="3808075">alpnProtocol</span>&nbsp;<span class="op" id="3808088">=</span>&nbsp;<span class="builtintype" id="3808090">string</span><span class="op" id="3808096">(</span><span class="ident" id="3808097">d</span><span class="op" id="3808098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3808102">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808106">data</span>&nbsp;<span class="op" id="3808111">=</span>&nbsp;<span class="ident" id="3808113">data</span><span class="op" id="3808117">[</span><span class="ident" id="3808118">length</span><span class="op" id="3808124">:</span><span class="op" id="3808125">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3808128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808132">return</span>&nbsp;<span class="builtintype" id="3808139">true</span><br>
<span class="lineno"></span><span class="op" id="3808144">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="3808147">type</span>&nbsp;<span class="ident" id="3808152">certificateMsg</span>&nbsp;<span class="keyword" id="3808167">struct</span>&nbsp;<span class="op" id="3808174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808177">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3808190">[</span><span class="op" id="3808191">]</span><span class="builtintype" id="3808192">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808198">certificates</span>&nbsp;<span class="op" id="3808211">[</span><span class="op" id="3808212">]</span><span class="op" id="3808213">[</span><span class="op" id="3808214">]</span><span class="builtintype" id="3808215">byte</span><br>
<span class="lineno"></span><span class="op" id="3808220">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="3808223">func</span>&nbsp;<span class="op" id="3808228">(</span><span class="ident" id="3808229">m</span>&nbsp;<span class="op" id="3808231">*</span><span class="ident" id="3808232">certificateMsg</span><span class="op" id="3808246">)</span>&nbsp;<span class="ident" id="3808248">equal</span><span class="op" id="3808253">(</span><span class="ident" id="3808254">i</span>&nbsp;<span class="keyword" id="3808256">interface</span><span class="op" id="3808265">{</span><span class="op" id="3808266">}</span><span class="op" id="3808267">)</span>&nbsp;<span class="builtintype" id="3808269">bool</span>&nbsp;<span class="op" id="3808274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808277">m1</span><span class="op" id="3808279">,</span>&nbsp;<span class="ident" id="3808281">ok</span>&nbsp;<span class="op" id="3808284">:=</span>&nbsp;<span class="ident" id="3808287">i</span><span class="op" id="3808288">.</span><span class="op" id="3808289">(</span><span class="op" id="3808290">*</span><span class="ident" id="3808291">certificateMsg</span><span class="op" id="3808305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808308">if</span>&nbsp;<span class="op" id="3808311">!</span><span class="ident" id="3808312">ok</span>&nbsp;<span class="op" id="3808315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808319">return</span>&nbsp;<span class="builtintype" id="3808326">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3808333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808337">return</span>&nbsp;<span class="ident" id="3808344">bytes</span><span class="op" id="3808349">.</span><span class="ident" id="3808350">Equal</span><span class="op" id="3808355">(</span><span class="ident" id="3808356">m</span><span class="op" id="3808357">.</span><span class="ident" id="3808358">raw</span><span class="op" id="3808361">,</span>&nbsp;<span class="ident" id="3808363">m1</span><span class="op" id="3808365">.</span><span class="ident" id="3808366">raw</span><span class="op" id="3808369">)</span>&nbsp;<span class="op" id="3808371">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808376">eqByteSlices</span><span class="op" id="3808388">(</span><span class="ident" id="3808389">m</span><span class="op" id="3808390">.</span><span class="ident" id="3808391">certificates</span><span class="op" id="3808403">,</span>&nbsp;<span class="ident" id="3808405">m1</span><span class="op" id="3808407">.</span><span class="ident" id="3808408">certificates</span><span class="op" id="3808420">)</span><br>
<span class="lineno"></span><span class="op" id="3808422">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="3808425">func</span>&nbsp;<span class="op" id="3808430">(</span><span class="ident" id="3808431">m</span>&nbsp;<span class="op" id="3808433">*</span><span class="ident" id="3808434">certificateMsg</span><span class="op" id="3808448">)</span>&nbsp;<span class="ident" id="3808450">marshal</span><span class="op" id="3808457">(</span><span class="op" id="3808458">)</span>&nbsp;<span class="op" id="3808460">(</span><span class="ident" id="3808461">x</span>&nbsp;<span class="op" id="3808463">[</span><span class="op" id="3808464">]</span><span class="builtintype" id="3808465">byte</span><span class="op" id="3808469">)</span>&nbsp;<span class="op" id="3808471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808474">if</span>&nbsp;<span class="ident" id="3808477">m</span><span class="op" id="3808478">.</span><span class="ident" id="3808479">raw</span>&nbsp;<span class="op" id="3808483">!=</span>&nbsp;<span class="builtintype" id="3808486">nil</span>&nbsp;<span class="op" id="3808490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808494">return</span>&nbsp;<span class="ident" id="3808501">m</span><span class="op" id="3808502">.</span><span class="ident" id="3808503">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3808508">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808512">var</span>&nbsp;<span class="ident" id="3808516">i</span>&nbsp;<span class="builtintype" id="3808518">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808523">for</span>&nbsp;<span class="ident" id="3808527">_</span><span class="op" id="3808528">,</span>&nbsp;<span class="ident" id="3808530">slice</span>&nbsp;<span class="op" id="3808536">:=</span>&nbsp;<span class="keyword" id="3808539">range</span>&nbsp;<span class="ident" id="3808545">m</span><span class="op" id="3808546">.</span><span class="ident" id="3808547">certificates</span>&nbsp;<span class="op" id="3808560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808564">i</span>&nbsp;<span class="op" id="3808566">+=</span>&nbsp;<span class="builtinfunc" id="3808569">len</span><span class="op" id="3808572">(</span><span class="ident" id="3808573">slice</span><span class="op" id="3808578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3808581">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808585">length</span>&nbsp;<span class="op" id="3808592">:=</span>&nbsp;<span class="num" id="3808595">3</span>&nbsp;<span class="op" id="3808597">+</span>&nbsp;<span class="num" id="3808599">3</span><span class="op" id="3808600">*</span><span class="builtinfunc" id="3808601">len</span><span class="op" id="3808604">(</span><span class="ident" id="3808605">m</span><span class="op" id="3808606">.</span><span class="ident" id="3808607">certificates</span><span class="op" id="3808619">)</span>&nbsp;<span class="op" id="3808621">+</span>&nbsp;<span class="ident" id="3808623">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808626">x</span>&nbsp;<span class="op" id="3808628">=</span>&nbsp;<span class="builtinfunc" id="3808630">make</span><span class="op" id="3808634">(</span><span class="op" id="3808635">[</span><span class="op" id="3808636">]</span><span class="builtintype" id="3808637">byte</span><span class="op" id="3808641">,</span>&nbsp;<span class="num" id="3808643">4</span><span class="op" id="3808644">+</span><span class="ident" id="3808645">length</span><span class="op" id="3808651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808654">x</span><span class="op" id="3808655">[</span><span class="num" id="3808656">0</span><span class="op" id="3808657">]</span>&nbsp;<span class="op" id="3808659">=</span>&nbsp;<span class="ident" id="3808661">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808678">x</span><span class="op" id="3808679">[</span><span class="num" id="3808680">1</span><span class="op" id="3808681">]</span>&nbsp;<span class="op" id="3808683">=</span>&nbsp;<span class="builtintype" id="3808685">uint8</span><span class="op" id="3808690">(</span><span class="ident" id="3808691">length</span>&nbsp;<span class="op" id="3808698">&gt;&gt;</span>&nbsp;<span class="num" id="3808701">16</span><span class="op" id="3808703">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808706">x</span><span class="op" id="3808707">[</span><span class="num" id="3808708">2</span><span class="op" id="3808709">]</span>&nbsp;<span class="op" id="3808711">=</span>&nbsp;<span class="builtintype" id="3808713">uint8</span><span class="op" id="3808718">(</span><span class="ident" id="3808719">length</span>&nbsp;<span class="op" id="3808726">&gt;&gt;</span>&nbsp;<span class="num" id="3808729">8</span><span class="op" id="3808730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808733">x</span><span class="op" id="3808734">[</span><span class="num" id="3808735">3</span><span class="op" id="3808736">]</span>&nbsp;<span class="op" id="3808738">=</span>&nbsp;<span class="builtintype" id="3808740">uint8</span><span class="op" id="3808745">(</span><span class="ident" id="3808746">length</span><span class="op" id="3808752">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808756">certificateOctets</span>&nbsp;<span class="op" id="3808774">:=</span>&nbsp;<span class="ident" id="3808777">length</span>&nbsp;<span class="op" id="3808784">-</span>&nbsp;<span class="num" id="3808786">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808789">x</span><span class="op" id="3808790">[</span><span class="num" id="3808791">4</span><span class="op" id="3808792">]</span>&nbsp;<span class="op" id="3808794">=</span>&nbsp;<span class="builtintype" id="3808796">uint8</span><span class="op" id="3808801">(</span><span class="ident" id="3808802">certificateOctets</span>&nbsp;<span class="op" id="3808820">&gt;&gt;</span>&nbsp;<span class="num" id="3808823">16</span><span class="op" id="3808825">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808828">x</span><span class="op" id="3808829">[</span><span class="num" id="3808830">5</span><span class="op" id="3808831">]</span>&nbsp;<span class="op" id="3808833">=</span>&nbsp;<span class="builtintype" id="3808835">uint8</span><span class="op" id="3808840">(</span><span class="ident" id="3808841">certificateOctets</span>&nbsp;<span class="op" id="3808859">&gt;&gt;</span>&nbsp;<span class="num" id="3808862">8</span><span class="op" id="3808863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808866">x</span><span class="op" id="3808867">[</span><span class="num" id="3808868">6</span><span class="op" id="3808869">]</span>&nbsp;<span class="op" id="3808871">=</span>&nbsp;<span class="builtintype" id="3808873">uint8</span><span class="op" id="3808878">(</span><span class="ident" id="3808879">certificateOctets</span><span class="op" id="3808896">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808900">y</span>&nbsp;<span class="op" id="3808902">:=</span>&nbsp;<span class="ident" id="3808905">x</span><span class="op" id="3808906">[</span><span class="num" id="3808907">7</span><span class="op" id="3808908">:</span><span class="op" id="3808909">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3808912">for</span>&nbsp;<span class="ident" id="3808916">_</span><span class="op" id="3808917">,</span>&nbsp;<span class="ident" id="3808919">slice</span>&nbsp;<span class="op" id="3808925">:=</span>&nbsp;<span class="keyword" id="3808928">range</span>&nbsp;<span class="ident" id="3808934">m</span><span class="op" id="3808935">.</span><span class="ident" id="3808936">certificates</span>&nbsp;<span class="op" id="3808949">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808953">y</span><span class="op" id="3808954">[</span><span class="num" id="3808955">0</span><span class="op" id="3808956">]</span>&nbsp;<span class="op" id="3808958">=</span>&nbsp;<span class="builtintype" id="3808960">uint8</span><span class="op" id="3808965">(</span><span class="builtinfunc" id="3808966">len</span><span class="op" id="3808969">(</span><span class="ident" id="3808970">slice</span><span class="op" id="3808975">)</span>&nbsp;<span class="op" id="3808977">&gt;&gt;</span>&nbsp;<span class="num" id="3808980">16</span><span class="op" id="3808982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3808986">y</span><span class="op" id="3808987">[</span><span class="num" id="3808988">1</span><span class="op" id="3808989">]</span>&nbsp;<span class="op" id="3808991">=</span>&nbsp;<span class="builtintype" id="3808993">uint8</span><span class="op" id="3808998">(</span><span class="builtinfunc" id="3808999">len</span><span class="op" id="3809002">(</span><span class="ident" id="3809003">slice</span><span class="op" id="3809008">)</span>&nbsp;<span class="op" id="3809010">&gt;&gt;</span>&nbsp;<span class="num" id="3809013">8</span><span class="op" id="3809014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809018">y</span><span class="op" id="3809019">[</span><span class="num" id="3809020">2</span><span class="op" id="3809021">]</span>&nbsp;<span class="op" id="3809023">=</span>&nbsp;<span class="builtintype" id="3809025">uint8</span><span class="op" id="3809030">(</span><span class="builtinfunc" id="3809031">len</span><span class="op" id="3809034">(</span><span class="ident" id="3809035">slice</span><span class="op" id="3809040">)</span><span class="op" id="3809041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3809045">copy</span><span class="op" id="3809049">(</span><span class="ident" id="3809050">y</span><span class="op" id="3809051">[</span><span class="num" id="3809052">3</span><span class="op" id="3809053">:</span><span class="op" id="3809054">]</span><span class="op" id="3809055">,</span>&nbsp;<span class="ident" id="3809057">slice</span><span class="op" id="3809062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809066">y</span>&nbsp;<span class="op" id="3809068">=</span>&nbsp;<span class="ident" id="3809070">y</span><span class="op" id="3809071">[</span><span class="num" id="3809072">3</span><span class="op" id="3809073">+</span><span class="builtinfunc" id="3809074">len</span><span class="op" id="3809077">(</span><span class="ident" id="3809078">slice</span><span class="op" id="3809083">)</span><span class="op" id="3809084">:</span><span class="op" id="3809085">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3809088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809092">m</span><span class="op" id="3809093">.</span><span class="ident" id="3809094">raw</span>&nbsp;<span class="op" id="3809098">=</span>&nbsp;<span class="ident" id="3809100">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809103">return</span><br>
<span class="lineno"></span><span class="op" id="3809110">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="3809113">func</span>&nbsp;<span class="op" id="3809118">(</span><span class="ident" id="3809119">m</span>&nbsp;<span class="op" id="3809121">*</span><span class="ident" id="3809122">certificateMsg</span><span class="op" id="3809136">)</span>&nbsp;<span class="ident" id="3809138">unmarshal</span><span class="op" id="3809147">(</span><span class="ident" id="3809148">data</span>&nbsp;<span class="op" id="3809153">[</span><span class="op" id="3809154">]</span><span class="builtintype" id="3809155">byte</span><span class="op" id="3809159">)</span>&nbsp;<span class="builtintype" id="3809161">bool</span>&nbsp;<span class="op" id="3809166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809169">if</span>&nbsp;<span class="builtinfunc" id="3809172">len</span><span class="op" id="3809175">(</span><span class="ident" id="3809176">data</span><span class="op" id="3809180">)</span>&nbsp;<span class="op" id="3809182">&lt;</span>&nbsp;<span class="num" id="3809184">7</span>&nbsp;<span class="op" id="3809186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809190">return</span>&nbsp;<span class="builtintype" id="3809197">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3809204">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809208">m</span><span class="op" id="3809209">.</span><span class="ident" id="3809210">raw</span>&nbsp;<span class="op" id="3809214">=</span>&nbsp;<span class="ident" id="3809216">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809222">certsLen</span>&nbsp;<span class="op" id="3809231">:=</span>&nbsp;<span class="builtintype" id="3809234">uint32</span><span class="op" id="3809240">(</span><span class="ident" id="3809241">data</span><span class="op" id="3809245">[</span><span class="num" id="3809246">4</span><span class="op" id="3809247">]</span><span class="op" id="3809248">)</span><span class="op" id="3809249">&lt;&lt;</span><span class="num" id="3809251">16</span>&nbsp;<span class="op" id="3809254">|</span>&nbsp;<span class="builtintype" id="3809256">uint32</span><span class="op" id="3809262">(</span><span class="ident" id="3809263">data</span><span class="op" id="3809267">[</span><span class="num" id="3809268">5</span><span class="op" id="3809269">]</span><span class="op" id="3809270">)</span><span class="op" id="3809271">&lt;&lt;</span><span class="num" id="3809273">8</span>&nbsp;<span class="op" id="3809275">|</span>&nbsp;<span class="builtintype" id="3809277">uint32</span><span class="op" id="3809283">(</span><span class="ident" id="3809284">data</span><span class="op" id="3809288">[</span><span class="num" id="3809289">6</span><span class="op" id="3809290">]</span><span class="op" id="3809291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809294">if</span>&nbsp;<span class="builtintype" id="3809297">uint32</span><span class="op" id="3809303">(</span><span class="builtinfunc" id="3809304">len</span><span class="op" id="3809307">(</span><span class="ident" id="3809308">data</span><span class="op" id="3809312">)</span><span class="op" id="3809313">)</span>&nbsp;<span class="op" id="3809315">!=</span>&nbsp;<span class="ident" id="3809318">certsLen</span><span class="op" id="3809326">+</span><span class="num" id="3809327">7</span>&nbsp;<span class="op" id="3809329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809333">return</span>&nbsp;<span class="builtintype" id="3809340">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3809347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809351">numCerts</span>&nbsp;<span class="op" id="3809360">:=</span>&nbsp;<span class="num" id="3809363">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809366">d</span>&nbsp;<span class="op" id="3809368">:=</span>&nbsp;<span class="ident" id="3809371">data</span><span class="op" id="3809375">[</span><span class="num" id="3809376">7</span><span class="op" id="3809377">:</span><span class="op" id="3809378">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809381">for</span>&nbsp;<span class="ident" id="3809385">certsLen</span>&nbsp;<span class="op" id="3809394">&gt;</span>&nbsp;<span class="num" id="3809396">0</span>&nbsp;<span class="op" id="3809398">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809402">if</span>&nbsp;<span class="builtinfunc" id="3809405">len</span><span class="op" id="3809408">(</span><span class="ident" id="3809409">d</span><span class="op" id="3809410">)</span>&nbsp;<span class="op" id="3809412">&lt;</span>&nbsp;<span class="num" id="3809414">4</span>&nbsp;<span class="op" id="3809416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809421">return</span>&nbsp;<span class="builtintype" id="3809428">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3809436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809440">certLen</span>&nbsp;<span class="op" id="3809448">:=</span>&nbsp;<span class="builtintype" id="3809451">uint32</span><span class="op" id="3809457">(</span><span class="ident" id="3809458">d</span><span class="op" id="3809459">[</span><span class="num" id="3809460">0</span><span class="op" id="3809461">]</span><span class="op" id="3809462">)</span><span class="op" id="3809463">&lt;&lt;</span><span class="num" id="3809465">16</span>&nbsp;<span class="op" id="3809468">|</span>&nbsp;<span class="builtintype" id="3809470">uint32</span><span class="op" id="3809476">(</span><span class="ident" id="3809477">d</span><span class="op" id="3809478">[</span><span class="num" id="3809479">1</span><span class="op" id="3809480">]</span><span class="op" id="3809481">)</span><span class="op" id="3809482">&lt;&lt;</span><span class="num" id="3809484">8</span>&nbsp;<span class="op" id="3809486">|</span>&nbsp;<span class="builtintype" id="3809488">uint32</span><span class="op" id="3809494">(</span><span class="ident" id="3809495">d</span><span class="op" id="3809496">[</span><span class="num" id="3809497">2</span><span class="op" id="3809498">]</span><span class="op" id="3809499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809503">if</span>&nbsp;<span class="builtintype" id="3809506">uint32</span><span class="op" id="3809512">(</span><span class="builtinfunc" id="3809513">len</span><span class="op" id="3809516">(</span><span class="ident" id="3809517">d</span><span class="op" id="3809518">)</span><span class="op" id="3809519">)</span>&nbsp;<span class="op" id="3809521">&lt;</span>&nbsp;<span class="num" id="3809523">3</span><span class="op" id="3809524">+</span><span class="ident" id="3809525">certLen</span>&nbsp;<span class="op" id="3809533">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809538">return</span>&nbsp;<span class="builtintype" id="3809545">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3809553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809557">d</span>&nbsp;<span class="op" id="3809559">=</span>&nbsp;<span class="ident" id="3809561">d</span><span class="op" id="3809562">[</span><span class="num" id="3809563">3</span><span class="op" id="3809564">+</span><span class="ident" id="3809565">certLen</span><span class="op" id="3809572">:</span><span class="op" id="3809573">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809577">certsLen</span>&nbsp;<span class="op" id="3809586">-=</span>&nbsp;<span class="num" id="3809589">3</span>&nbsp;<span class="op" id="3809591">+</span>&nbsp;<span class="ident" id="3809593">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809603">numCerts</span><span class="op" id="3809611">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3809615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809619">m</span><span class="op" id="3809620">.</span><span class="ident" id="3809621">certificates</span>&nbsp;<span class="op" id="3809634">=</span>&nbsp;<span class="builtinfunc" id="3809636">make</span><span class="op" id="3809640">(</span><span class="op" id="3809641">[</span><span class="op" id="3809642">]</span><span class="op" id="3809643">[</span><span class="op" id="3809644">]</span><span class="builtintype" id="3809645">byte</span><span class="op" id="3809649">,</span>&nbsp;<span class="ident" id="3809651">numCerts</span><span class="op" id="3809659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809662">d</span>&nbsp;<span class="op" id="3809664">=</span>&nbsp;<span class="ident" id="3809666">data</span><span class="op" id="3809670">[</span><span class="num" id="3809671">7</span><span class="op" id="3809672">:</span><span class="op" id="3809673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809676">for</span>&nbsp;<span class="ident" id="3809680">i</span>&nbsp;<span class="op" id="3809682">:=</span>&nbsp;<span class="num" id="3809685">0</span><span class="op" id="3809686">;</span>&nbsp;<span class="ident" id="3809688">i</span>&nbsp;<span class="op" id="3809690">&lt;</span>&nbsp;<span class="ident" id="3809692">numCerts</span><span class="op" id="3809700">;</span>&nbsp;<span class="ident" id="3809702">i</span><span class="op" id="3809703">++</span>&nbsp;<span class="op" id="3809706">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809710">certLen</span>&nbsp;<span class="op" id="3809718">:=</span>&nbsp;<span class="builtintype" id="3809721">uint32</span><span class="op" id="3809727">(</span><span class="ident" id="3809728">d</span><span class="op" id="3809729">[</span><span class="num" id="3809730">0</span><span class="op" id="3809731">]</span><span class="op" id="3809732">)</span><span class="op" id="3809733">&lt;&lt;</span><span class="num" id="3809735">16</span>&nbsp;<span class="op" id="3809738">|</span>&nbsp;<span class="builtintype" id="3809740">uint32</span><span class="op" id="3809746">(</span><span class="ident" id="3809747">d</span><span class="op" id="3809748">[</span><span class="num" id="3809749">1</span><span class="op" id="3809750">]</span><span class="op" id="3809751">)</span><span class="op" id="3809752">&lt;&lt;</span><span class="num" id="3809754">8</span>&nbsp;<span class="op" id="3809756">|</span>&nbsp;<span class="builtintype" id="3809758">uint32</span><span class="op" id="3809764">(</span><span class="ident" id="3809765">d</span><span class="op" id="3809766">[</span><span class="num" id="3809767">2</span><span class="op" id="3809768">]</span><span class="op" id="3809769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809773">m</span><span class="op" id="3809774">.</span><span class="ident" id="3809775">certificates</span><span class="op" id="3809787">[</span><span class="ident" id="3809788">i</span><span class="op" id="3809789">]</span>&nbsp;<span class="op" id="3809791">=</span>&nbsp;<span class="ident" id="3809793">d</span><span class="op" id="3809794">[</span><span class="num" id="3809795">3</span>&nbsp;<span class="op" id="3809797">:</span>&nbsp;<span class="num" id="3809799">3</span><span class="op" id="3809800">+</span><span class="ident" id="3809801">certLen</span><span class="op" id="3809808">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809812">d</span>&nbsp;<span class="op" id="3809814">=</span>&nbsp;<span class="ident" id="3809816">d</span><span class="op" id="3809817">[</span><span class="num" id="3809818">3</span><span class="op" id="3809819">+</span><span class="ident" id="3809820">certLen</span><span class="op" id="3809827">:</span><span class="op" id="3809828">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3809831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3809835">return</span>&nbsp;<span class="builtintype" id="3809842">true</span><br>
<span class="lineno"></span><span class="op" id="3809847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3809850">type</span>&nbsp;<span class="ident" id="3809855">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3809876">struct</span>&nbsp;<span class="op" id="3809883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809886">raw</span>&nbsp;<span class="op" id="3809890">[</span><span class="op" id="3809891">]</span><span class="builtintype" id="3809892">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809898">key</span>&nbsp;<span class="op" id="3809902">[</span><span class="op" id="3809903">]</span><span class="builtintype" id="3809904">byte</span><br>
<span class="lineno"></span><span class="op" id="3809909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3809912">func</span>&nbsp;<span class="op" id="3809917">(</span><span class="ident" id="3809918">m</span>&nbsp;<span class="op" id="3809920">*</span><span class="ident" id="3809921">serverKeyExchangeMsg</span><span class="op" id="3809941">)</span>&nbsp;<span class="ident" id="3809943">equal</span><span class="op" id="3809948">(</span><span class="ident" id="3809949">i</span>&nbsp;<span class="keyword" id="3809951">interface</span><span class="op" id="3809960">{</span><span class="op" id="3809961">}</span><span class="op" id="3809962">)</span>&nbsp;<span class="builtintype" id="3809964">bool</span>&nbsp;<span class="op" id="3809969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809972">m1</span><span class="op" id="3809974">,</span>&nbsp;<span class="ident" id="3809976">ok</span>&nbsp;<span class="op" id="3809979">:=</span>&nbsp;<span class="ident" id="3809982">i</span><span class="op" id="3809983">.</span><span class="op" id="3809984">(</span><span class="op" id="3809985">*</span><span class="ident" id="3809986">serverKeyExchangeMsg</span><span class="op" id="3810006">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810009">if</span>&nbsp;<span class="op" id="3810012">!</span><span class="ident" id="3810013">ok</span>&nbsp;<span class="op" id="3810016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810020">return</span>&nbsp;<span class="builtintype" id="3810027">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3810034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810038">return</span>&nbsp;<span class="ident" id="3810045">bytes</span><span class="op" id="3810050">.</span><span class="ident" id="3810051">Equal</span><span class="op" id="3810056">(</span><span class="ident" id="3810057">m</span><span class="op" id="3810058">.</span><span class="ident" id="3810059">raw</span><span class="op" id="3810062">,</span>&nbsp;<span class="ident" id="3810064">m1</span><span class="op" id="3810066">.</span><span class="ident" id="3810067">raw</span><span class="op" id="3810070">)</span>&nbsp;<span class="op" id="3810072">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810077">bytes</span><span class="op" id="3810082">.</span><span class="ident" id="3810083">Equal</span><span class="op" id="3810088">(</span><span class="ident" id="3810089">m</span><span class="op" id="3810090">.</span><span class="ident" id="3810091">key</span><span class="op" id="3810094">,</span>&nbsp;<span class="ident" id="3810096">m1</span><span class="op" id="3810098">.</span><span class="ident" id="3810099">key</span><span class="op" id="3810102">)</span><br>
<span class="lineno"></span><span class="op" id="3810104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3810107">func</span>&nbsp;<span class="op" id="3810112">(</span><span class="ident" id="3810113">m</span>&nbsp;<span class="op" id="3810115">*</span><span class="ident" id="3810116">serverKeyExchangeMsg</span><span class="op" id="3810136">)</span>&nbsp;<span class="ident" id="3810138">marshal</span><span class="op" id="3810145">(</span><span class="op" id="3810146">)</span>&nbsp;<span class="op" id="3810148">[</span><span class="op" id="3810149">]</span><span class="builtintype" id="3810150">byte</span>&nbsp;<span class="op" id="3810155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810158">if</span>&nbsp;<span class="ident" id="3810161">m</span><span class="op" id="3810162">.</span><span class="ident" id="3810163">raw</span>&nbsp;<span class="op" id="3810167">!=</span>&nbsp;<span class="builtintype" id="3810170">nil</span>&nbsp;<span class="op" id="3810174">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810178">return</span>&nbsp;<span class="ident" id="3810185">m</span><span class="op" id="3810186">.</span><span class="ident" id="3810187">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3810192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810195">length</span>&nbsp;<span class="op" id="3810202">:=</span>&nbsp;<span class="builtinfunc" id="3810205">len</span><span class="op" id="3810208">(</span><span class="ident" id="3810209">m</span><span class="op" id="3810210">.</span><span class="ident" id="3810211">key</span><span class="op" id="3810214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810217">x</span>&nbsp;<span class="op" id="3810219">:=</span>&nbsp;<span class="builtinfunc" id="3810222">make</span><span class="op" id="3810226">(</span><span class="op" id="3810227">[</span><span class="op" id="3810228">]</span><span class="builtintype" id="3810229">byte</span><span class="op" id="3810233">,</span>&nbsp;<span class="ident" id="3810235">length</span><span class="op" id="3810241">+</span><span class="num" id="3810242">4</span><span class="op" id="3810243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810246">x</span><span class="op" id="3810247">[</span><span class="num" id="3810248">0</span><span class="op" id="3810249">]</span>&nbsp;<span class="op" id="3810251">=</span>&nbsp;<span class="ident" id="3810253">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810276">x</span><span class="op" id="3810277">[</span><span class="num" id="3810278">1</span><span class="op" id="3810279">]</span>&nbsp;<span class="op" id="3810281">=</span>&nbsp;<span class="builtintype" id="3810283">uint8</span><span class="op" id="3810288">(</span><span class="ident" id="3810289">length</span>&nbsp;<span class="op" id="3810296">&gt;&gt;</span>&nbsp;<span class="num" id="3810299">16</span><span class="op" id="3810301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810304">x</span><span class="op" id="3810305">[</span><span class="num" id="3810306">2</span><span class="op" id="3810307">]</span>&nbsp;<span class="op" id="3810309">=</span>&nbsp;<span class="builtintype" id="3810311">uint8</span><span class="op" id="3810316">(</span><span class="ident" id="3810317">length</span>&nbsp;<span class="op" id="3810324">&gt;&gt;</span>&nbsp;<span class="num" id="3810327">8</span><span class="op" id="3810328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810331">x</span><span class="op" id="3810332">[</span><span class="num" id="3810333">3</span><span class="op" id="3810334">]</span>&nbsp;<span class="op" id="3810336">=</span>&nbsp;<span class="builtintype" id="3810338">uint8</span><span class="op" id="3810343">(</span><span class="ident" id="3810344">length</span><span class="op" id="3810350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3810353">copy</span><span class="op" id="3810357">(</span><span class="ident" id="3810358">x</span><span class="op" id="3810359">[</span><span class="num" id="3810360">4</span><span class="op" id="3810361">:</span><span class="op" id="3810362">]</span><span class="op" id="3810363">,</span>&nbsp;<span class="ident" id="3810365">m</span><span class="op" id="3810366">.</span><span class="ident" id="3810367">key</span><span class="op" id="3810370">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810374">m</span><span class="op" id="3810375">.</span><span class="ident" id="3810376">raw</span>&nbsp;<span class="op" id="3810380">=</span>&nbsp;<span class="ident" id="3810382">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810385">return</span>&nbsp;<span class="ident" id="3810392">x</span><br>
<span class="lineno"></span><span class="op" id="3810394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3810397">func</span>&nbsp;<span class="op" id="3810402">(</span><span class="ident" id="3810403">m</span>&nbsp;<span class="op" id="3810405">*</span><span class="ident" id="3810406">serverKeyExchangeMsg</span><span class="op" id="3810426">)</span>&nbsp;<span class="ident" id="3810428">unmarshal</span><span class="op" id="3810437">(</span><span class="ident" id="3810438">data</span>&nbsp;<span class="op" id="3810443">[</span><span class="op" id="3810444">]</span><span class="builtintype" id="3810445">byte</span><span class="op" id="3810449">)</span>&nbsp;<span class="builtintype" id="3810451">bool</span>&nbsp;<span class="op" id="3810456">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810459">m</span><span class="op" id="3810460">.</span><span class="ident" id="3810461">raw</span>&nbsp;<span class="op" id="3810465">=</span>&nbsp;<span class="ident" id="3810467">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810473">if</span>&nbsp;<span class="builtinfunc" id="3810476">len</span><span class="op" id="3810479">(</span><span class="ident" id="3810480">data</span><span class="op" id="3810484">)</span>&nbsp;<span class="op" id="3810486">&lt;</span>&nbsp;<span class="num" id="3810488">4</span>&nbsp;<span class="op" id="3810490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810494">return</span>&nbsp;<span class="builtintype" id="3810501">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3810508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810511">m</span><span class="op" id="3810512">.</span><span class="ident" id="3810513">key</span>&nbsp;<span class="op" id="3810517">=</span>&nbsp;<span class="ident" id="3810519">data</span><span class="op" id="3810523">[</span><span class="num" id="3810524">4</span><span class="op" id="3810525">:</span><span class="op" id="3810526">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810529">return</span>&nbsp;<span class="builtintype" id="3810536">true</span><br>
<span class="lineno"></span><span class="op" id="3810541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3810544">type</span>&nbsp;<span class="ident" id="3810549">certificateStatusMsg</span>&nbsp;<span class="keyword" id="3810570">struct</span>&nbsp;<span class="op" id="3810577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810580">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3810591">[</span><span class="op" id="3810592">]</span><span class="builtintype" id="3810593">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810599">statusType</span>&nbsp;<span class="builtintype" id="3810610">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810617">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3810628">[</span><span class="op" id="3810629">]</span><span class="builtintype" id="3810630">byte</span><br>
<span class="lineno"></span><span class="op" id="3810635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3810638">func</span>&nbsp;<span class="op" id="3810643">(</span><span class="ident" id="3810644">m</span>&nbsp;<span class="op" id="3810646">*</span><span class="ident" id="3810647">certificateStatusMsg</span><span class="op" id="3810667">)</span>&nbsp;<span class="ident" id="3810669">equal</span><span class="op" id="3810674">(</span><span class="ident" id="3810675">i</span>&nbsp;<span class="keyword" id="3810677">interface</span><span class="op" id="3810686">{</span><span class="op" id="3810687">}</span><span class="op" id="3810688">)</span>&nbsp;<span class="builtintype" id="3810690">bool</span>&nbsp;<span class="op" id="3810695">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810698">m1</span><span class="op" id="3810700">,</span>&nbsp;<span class="ident" id="3810702">ok</span>&nbsp;<span class="op" id="3810705">:=</span>&nbsp;<span class="ident" id="3810708">i</span><span class="op" id="3810709">.</span><span class="op" id="3810710">(</span><span class="op" id="3810711">*</span><span class="ident" id="3810712">certificateStatusMsg</span><span class="op" id="3810732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810735">if</span>&nbsp;<span class="op" id="3810738">!</span><span class="ident" id="3810739">ok</span>&nbsp;<span class="op" id="3810742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810746">return</span>&nbsp;<span class="builtintype" id="3810753">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3810760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810764">return</span>&nbsp;<span class="ident" id="3810771">bytes</span><span class="op" id="3810776">.</span><span class="ident" id="3810777">Equal</span><span class="op" id="3810782">(</span><span class="ident" id="3810783">m</span><span class="op" id="3810784">.</span><span class="ident" id="3810785">raw</span><span class="op" id="3810788">,</span>&nbsp;<span class="ident" id="3810790">m1</span><span class="op" id="3810792">.</span><span class="ident" id="3810793">raw</span><span class="op" id="3810796">)</span>&nbsp;<span class="op" id="3810798">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810803">m</span><span class="op" id="3810804">.</span><span class="ident" id="3810805">statusType</span>&nbsp;<span class="op" id="3810816">==</span>&nbsp;<span class="ident" id="3810819">m1</span><span class="op" id="3810821">.</span><span class="ident" id="3810822">statusType</span>&nbsp;<span class="op" id="3810833">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810838">bytes</span><span class="op" id="3810843">.</span><span class="ident" id="3810844">Equal</span><span class="op" id="3810849">(</span><span class="ident" id="3810850">m</span><span class="op" id="3810851">.</span><span class="ident" id="3810852">response</span><span class="op" id="3810860">,</span>&nbsp;<span class="ident" id="3810862">m1</span><span class="op" id="3810864">.</span><span class="ident" id="3810865">response</span><span class="op" id="3810873">)</span><br>
<span class="lineno"></span><span class="op" id="3810875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3810878">func</span>&nbsp;<span class="op" id="3810883">(</span><span class="ident" id="3810884">m</span>&nbsp;<span class="op" id="3810886">*</span><span class="ident" id="3810887">certificateStatusMsg</span><span class="op" id="3810907">)</span>&nbsp;<span class="ident" id="3810909">marshal</span><span class="op" id="3810916">(</span><span class="op" id="3810917">)</span>&nbsp;<span class="op" id="3810919">[</span><span class="op" id="3810920">]</span><span class="builtintype" id="3810921">byte</span>&nbsp;<span class="op" id="3810926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810929">if</span>&nbsp;<span class="ident" id="3810932">m</span><span class="op" id="3810933">.</span><span class="ident" id="3810934">raw</span>&nbsp;<span class="op" id="3810938">!=</span>&nbsp;<span class="builtintype" id="3810941">nil</span>&nbsp;<span class="op" id="3810945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810949">return</span>&nbsp;<span class="ident" id="3810956">m</span><span class="op" id="3810957">.</span><span class="ident" id="3810958">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3810963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810967">var</span>&nbsp;<span class="ident" id="3810971">x</span>&nbsp;<span class="op" id="3810973">[</span><span class="op" id="3810974">]</span><span class="builtintype" id="3810975">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3810981">if</span>&nbsp;<span class="ident" id="3810984">m</span><span class="op" id="3810985">.</span><span class="ident" id="3810986">statusType</span>&nbsp;<span class="op" id="3810997">==</span>&nbsp;<span class="ident" id="3811000">statusTypeOCSP</span>&nbsp;<span class="op" id="3811015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811019">x</span>&nbsp;<span class="op" id="3811021">=</span>&nbsp;<span class="builtinfunc" id="3811023">make</span><span class="op" id="3811027">(</span><span class="op" id="3811028">[</span><span class="op" id="3811029">]</span><span class="builtintype" id="3811030">byte</span><span class="op" id="3811034">,</span>&nbsp;<span class="num" id="3811036">4</span><span class="op" id="3811037">+</span><span class="num" id="3811038">4</span><span class="op" id="3811039">+</span><span class="builtinfunc" id="3811040">len</span><span class="op" id="3811043">(</span><span class="ident" id="3811044">m</span><span class="op" id="3811045">.</span><span class="ident" id="3811046">response</span><span class="op" id="3811054">)</span><span class="op" id="3811055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811059">x</span><span class="op" id="3811060">[</span><span class="num" id="3811061">0</span><span class="op" id="3811062">]</span>&nbsp;<span class="op" id="3811064">=</span>&nbsp;<span class="ident" id="3811066">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811090">l</span>&nbsp;<span class="op" id="3811092">:=</span>&nbsp;<span class="builtinfunc" id="3811095">len</span><span class="op" id="3811098">(</span><span class="ident" id="3811099">m</span><span class="op" id="3811100">.</span><span class="ident" id="3811101">response</span><span class="op" id="3811109">)</span>&nbsp;<span class="op" id="3811111">+</span>&nbsp;<span class="num" id="3811113">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811117">x</span><span class="op" id="3811118">[</span><span class="num" id="3811119">1</span><span class="op" id="3811120">]</span>&nbsp;<span class="op" id="3811122">=</span>&nbsp;<span class="builtintype" id="3811124">byte</span><span class="op" id="3811128">(</span><span class="ident" id="3811129">l</span>&nbsp;<span class="op" id="3811131">&gt;&gt;</span>&nbsp;<span class="num" id="3811134">16</span><span class="op" id="3811136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811140">x</span><span class="op" id="3811141">[</span><span class="num" id="3811142">2</span><span class="op" id="3811143">]</span>&nbsp;<span class="op" id="3811145">=</span>&nbsp;<span class="builtintype" id="3811147">byte</span><span class="op" id="3811151">(</span><span class="ident" id="3811152">l</span>&nbsp;<span class="op" id="3811154">&gt;&gt;</span>&nbsp;<span class="num" id="3811157">8</span><span class="op" id="3811158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811162">x</span><span class="op" id="3811163">[</span><span class="num" id="3811164">3</span><span class="op" id="3811165">]</span>&nbsp;<span class="op" id="3811167">=</span>&nbsp;<span class="builtintype" id="3811169">byte</span><span class="op" id="3811173">(</span><span class="ident" id="3811174">l</span><span class="op" id="3811175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811179">x</span><span class="op" id="3811180">[</span><span class="num" id="3811181">4</span><span class="op" id="3811182">]</span>&nbsp;<span class="op" id="3811184">=</span>&nbsp;<span class="ident" id="3811186">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811204">l</span>&nbsp;<span class="op" id="3811206">-=</span>&nbsp;<span class="num" id="3811209">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811213">x</span><span class="op" id="3811214">[</span><span class="num" id="3811215">5</span><span class="op" id="3811216">]</span>&nbsp;<span class="op" id="3811218">=</span>&nbsp;<span class="builtintype" id="3811220">byte</span><span class="op" id="3811224">(</span><span class="ident" id="3811225">l</span>&nbsp;<span class="op" id="3811227">&gt;&gt;</span>&nbsp;<span class="num" id="3811230">16</span><span class="op" id="3811232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811236">x</span><span class="op" id="3811237">[</span><span class="num" id="3811238">6</span><span class="op" id="3811239">]</span>&nbsp;<span class="op" id="3811241">=</span>&nbsp;<span class="builtintype" id="3811243">byte</span><span class="op" id="3811247">(</span><span class="ident" id="3811248">l</span>&nbsp;<span class="op" id="3811250">&gt;&gt;</span>&nbsp;<span class="num" id="3811253">8</span><span class="op" id="3811254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811258">x</span><span class="op" id="3811259">[</span><span class="num" id="3811260">7</span><span class="op" id="3811261">]</span>&nbsp;<span class="op" id="3811263">=</span>&nbsp;<span class="builtintype" id="3811265">byte</span><span class="op" id="3811269">(</span><span class="ident" id="3811270">l</span><span class="op" id="3811271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3811275">copy</span><span class="op" id="3811279">(</span><span class="ident" id="3811280">x</span><span class="op" id="3811281">[</span><span class="num" id="3811282">8</span><span class="op" id="3811283">:</span><span class="op" id="3811284">]</span><span class="op" id="3811285">,</span>&nbsp;<span class="ident" id="3811287">m</span><span class="op" id="3811288">.</span><span class="ident" id="3811289">response</span><span class="op" id="3811297">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3811300">}</span>&nbsp;<span class="keyword" id="3811302">else</span>&nbsp;<span class="op" id="3811307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811311">x</span>&nbsp;<span class="op" id="3811313">=</span>&nbsp;<span class="op" id="3811315">[</span><span class="op" id="3811316">]</span><span class="builtintype" id="3811317">byte</span><span class="op" id="3811321">{</span><span class="ident" id="3811322">typeCertificateStatus</span><span class="op" id="3811343">,</span>&nbsp;<span class="num" id="3811345">0</span><span class="op" id="3811346">,</span>&nbsp;<span class="num" id="3811348">0</span><span class="op" id="3811349">,</span>&nbsp;<span class="num" id="3811351">1</span><span class="op" id="3811352">,</span>&nbsp;<span class="ident" id="3811354">m</span><span class="op" id="3811355">.</span><span class="ident" id="3811356">statusType</span><span class="op" id="3811366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3811369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811373">m</span><span class="op" id="3811374">.</span><span class="ident" id="3811375">raw</span>&nbsp;<span class="op" id="3811379">=</span>&nbsp;<span class="ident" id="3811381">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3811384">return</span>&nbsp;<span class="ident" id="3811391">x</span><br>
<span class="lineno"></span><span class="op" id="3811393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3811396">func</span>&nbsp;<span class="op" id="3811401">(</span><span class="ident" id="3811402">m</span>&nbsp;<span class="op" id="3811404">*</span><span class="ident" id="3811405">certificateStatusMsg</span><span class="op" id="3811425">)</span>&nbsp;<span class="ident" id="3811427">unmarshal</span><span class="op" id="3811436">(</span><span class="ident" id="3811437">data</span>&nbsp;<span class="op" id="3811442">[</span><span class="op" id="3811443">]</span><span class="builtintype" id="3811444">byte</span><span class="op" id="3811448">)</span>&nbsp;<span class="builtintype" id="3811450">bool</span>&nbsp;<span class="op" id="3811455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811458">m</span><span class="op" id="3811459">.</span><span class="ident" id="3811460">raw</span>&nbsp;<span class="op" id="3811464">=</span>&nbsp;<span class="ident" id="3811466">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3811472">if</span>&nbsp;<span class="builtinfunc" id="3811475">len</span><span class="op" id="3811478">(</span><span class="ident" id="3811479">data</span><span class="op" id="3811483">)</span>&nbsp;<span class="op" id="3811485">&lt;</span>&nbsp;<span class="num" id="3811487">5</span>&nbsp;<span class="op" id="3811489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3811493">return</span>&nbsp;<span class="builtintype" id="3811500">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3811507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811510">m</span><span class="op" id="3811511">.</span><span class="ident" id="3811512">statusType</span>&nbsp;<span class="op" id="3811523">=</span>&nbsp;<span class="ident" id="3811525">data</span><span class="op" id="3811529">[</span><span class="num" id="3811530">4</span><span class="op" id="3811531">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811535">m</span><span class="op" id="3811536">.</span><span class="ident" id="3811537">response</span>&nbsp;<span class="op" id="3811546">=</span>&nbsp;<span class="builtintype" id="3811548">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3811553">if</span>&nbsp;<span class="ident" id="3811556">m</span><span class="op" id="3811557">.</span><span class="ident" id="3811558">statusType</span>&nbsp;<span class="op" id="3811569">==</span>&nbsp;<span class="ident" id="3811572">statusTypeOCSP</span>&nbsp;<span class="op" id="3811587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3811591">if</span>&nbsp;<span class="builtinfunc" id="3811594">len</span><span class="op" id="3811597">(</span><span class="ident" id="3811598">data</span><span class="op" id="3811602">)</span>&nbsp;<span class="op" id="3811604">&lt;</span>&nbsp;<span class="num" id="3811606">8</span>&nbsp;<span class="op" id="3811608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3811613">return</span>&nbsp;<span class="builtintype" id="3811620">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3811628">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811632">respLen</span>&nbsp;<span class="op" id="3811640">:=</span>&nbsp;<span class="builtintype" id="3811643">uint32</span><span class="op" id="3811649">(</span><span class="ident" id="3811650">data</span><span class="op" id="3811654">[</span><span class="num" id="3811655">5</span><span class="op" id="3811656">]</span><span class="op" id="3811657">)</span><span class="op" id="3811658">&lt;&lt;</span><span class="num" id="3811660">16</span>&nbsp;<span class="op" id="3811663">|</span>&nbsp;<span class="builtintype" id="3811665">uint32</span><span class="op" id="3811671">(</span><span class="ident" id="3811672">data</span><span class="op" id="3811676">[</span><span class="num" id="3811677">6</span><span class="op" id="3811678">]</span><span class="op" id="3811679">)</span><span class="op" id="3811680">&lt;&lt;</span><span class="num" id="3811682">8</span>&nbsp;<span class="op" id="3811684">|</span>&nbsp;<span class="builtintype" id="3811686">uint32</span><span class="op" id="3811692">(</span><span class="ident" id="3811693">data</span><span class="op" id="3811697">[</span><span class="num" id="3811698">7</span><span class="op" id="3811699">]</span><span class="op" id="3811700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3811704">if</span>&nbsp;<span class="builtintype" id="3811707">uint32</span><span class="op" id="3811713">(</span><span class="builtinfunc" id="3811714">len</span><span class="op" id="3811717">(</span><span class="ident" id="3811718">data</span><span class="op" id="3811722">)</span><span class="op" id="3811723">)</span>&nbsp;<span class="op" id="3811725">!=</span>&nbsp;<span class="num" id="3811728">4</span><span class="op" id="3811729">+</span><span class="num" id="3811730">4</span><span class="op" id="3811731">+</span><span class="ident" id="3811732">respLen</span>&nbsp;<span class="op" id="3811740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3811745">return</span>&nbsp;<span class="builtintype" id="3811752">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3811760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811764">m</span><span class="op" id="3811765">.</span><span class="ident" id="3811766">response</span>&nbsp;<span class="op" id="3811775">=</span>&nbsp;<span class="ident" id="3811777">data</span><span class="op" id="3811781">[</span><span class="num" id="3811782">8</span><span class="op" id="3811783">:</span><span class="op" id="3811784">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3811787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3811790">return</span>&nbsp;<span class="builtintype" id="3811797">true</span><br>
<span class="lineno"></span><span class="op" id="3811802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3811805">type</span>&nbsp;<span class="ident" id="3811810">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="3811829">struct</span><span class="op" id="3811835">{</span><span class="op" id="3811836">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="3811839">func</span>&nbsp;<span class="op" id="3811844">(</span><span class="ident" id="3811845">m</span>&nbsp;<span class="op" id="3811847">*</span><span class="ident" id="3811848">serverHelloDoneMsg</span><span class="op" id="3811866">)</span>&nbsp;<span class="ident" id="3811868">equal</span><span class="op" id="3811873">(</span><span class="ident" id="3811874">i</span>&nbsp;<span class="keyword" id="3811876">interface</span><span class="op" id="3811885">{</span><span class="op" id="3811886">}</span><span class="op" id="3811887">)</span>&nbsp;<span class="builtintype" id="3811889">bool</span>&nbsp;<span class="op" id="3811894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811897">_</span><span class="op" id="3811898">,</span>&nbsp;<span class="ident" id="3811900">ok</span>&nbsp;<span class="op" id="3811903">:=</span>&nbsp;<span class="ident" id="3811906">i</span><span class="op" id="3811907">.</span><span class="op" id="3811908">(</span><span class="op" id="3811909">*</span><span class="ident" id="3811910">serverHelloDoneMsg</span><span class="op" id="3811928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3811931">return</span>&nbsp;<span class="ident" id="3811938">ok</span><br>
<span class="lineno"></span><span class="op" id="3811941">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="3811944">func</span>&nbsp;<span class="op" id="3811949">(</span><span class="ident" id="3811950">m</span>&nbsp;<span class="op" id="3811952">*</span><span class="ident" id="3811953">serverHelloDoneMsg</span><span class="op" id="3811971">)</span>&nbsp;<span class="ident" id="3811973">marshal</span><span class="op" id="3811980">(</span><span class="op" id="3811981">)</span>&nbsp;<span class="op" id="3811983">[</span><span class="op" id="3811984">]</span><span class="builtintype" id="3811985">byte</span>&nbsp;<span class="op" id="3811990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3811993">x</span>&nbsp;<span class="op" id="3811995">:=</span>&nbsp;<span class="builtinfunc" id="3811998">make</span><span class="op" id="3812002">(</span><span class="op" id="3812003">[</span><span class="op" id="3812004">]</span><span class="builtintype" id="3812005">byte</span><span class="op" id="3812009">,</span>&nbsp;<span class="num" id="3812011">4</span><span class="op" id="3812012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812015">x</span><span class="op" id="3812016">[</span><span class="num" id="3812017">0</span><span class="op" id="3812018">]</span>&nbsp;<span class="op" id="3812020">=</span>&nbsp;<span class="ident" id="3812022">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812043">return</span>&nbsp;<span class="ident" id="3812050">x</span><br>
<span class="lineno">920</span><span class="op" id="3812052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3812055">func</span>&nbsp;<span class="op" id="3812060">(</span><span class="ident" id="3812061">m</span>&nbsp;<span class="op" id="3812063">*</span><span class="ident" id="3812064">serverHelloDoneMsg</span><span class="op" id="3812082">)</span>&nbsp;<span class="ident" id="3812084">unmarshal</span><span class="op" id="3812093">(</span><span class="ident" id="3812094">data</span>&nbsp;<span class="op" id="3812099">[</span><span class="op" id="3812100">]</span><span class="builtintype" id="3812101">byte</span><span class="op" id="3812105">)</span>&nbsp;<span class="builtintype" id="3812107">bool</span>&nbsp;<span class="op" id="3812112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812115">return</span>&nbsp;<span class="builtinfunc" id="3812122">len</span><span class="op" id="3812125">(</span><span class="ident" id="3812126">data</span><span class="op" id="3812130">)</span>&nbsp;<span class="op" id="3812132">==</span>&nbsp;<span class="num" id="3812135">4</span><br>
<span class="lineno"></span><span class="op" id="3812137">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="3812140">type</span>&nbsp;<span class="ident" id="3812145">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3812166">struct</span>&nbsp;<span class="op" id="3812173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812176">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3812187">[</span><span class="op" id="3812188">]</span><span class="builtintype" id="3812189">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812195">ciphertext</span>&nbsp;<span class="op" id="3812206">[</span><span class="op" id="3812207">]</span><span class="builtintype" id="3812208">byte</span><br>
<span class="lineno"></span><span class="op" id="3812213">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="3812216">func</span>&nbsp;<span class="op" id="3812221">(</span><span class="ident" id="3812222">m</span>&nbsp;<span class="op" id="3812224">*</span><span class="ident" id="3812225">clientKeyExchangeMsg</span><span class="op" id="3812245">)</span>&nbsp;<span class="ident" id="3812247">equal</span><span class="op" id="3812252">(</span><span class="ident" id="3812253">i</span>&nbsp;<span class="keyword" id="3812255">interface</span><span class="op" id="3812264">{</span><span class="op" id="3812265">}</span><span class="op" id="3812266">)</span>&nbsp;<span class="builtintype" id="3812268">bool</span>&nbsp;<span class="op" id="3812273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812276">m1</span><span class="op" id="3812278">,</span>&nbsp;<span class="ident" id="3812280">ok</span>&nbsp;<span class="op" id="3812283">:=</span>&nbsp;<span class="ident" id="3812286">i</span><span class="op" id="3812287">.</span><span class="op" id="3812288">(</span><span class="op" id="3812289">*</span><span class="ident" id="3812290">clientKeyExchangeMsg</span><span class="op" id="3812310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812313">if</span>&nbsp;<span class="op" id="3812316">!</span><span class="ident" id="3812317">ok</span>&nbsp;<span class="op" id="3812320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812324">return</span>&nbsp;<span class="builtintype" id="3812331">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3812338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812342">return</span>&nbsp;<span class="ident" id="3812349">bytes</span><span class="op" id="3812354">.</span><span class="ident" id="3812355">Equal</span><span class="op" id="3812360">(</span><span class="ident" id="3812361">m</span><span class="op" id="3812362">.</span><span class="ident" id="3812363">raw</span><span class="op" id="3812366">,</span>&nbsp;<span class="ident" id="3812368">m1</span><span class="op" id="3812370">.</span><span class="ident" id="3812371">raw</span><span class="op" id="3812374">)</span>&nbsp;<span class="op" id="3812376">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812381">bytes</span><span class="op" id="3812386">.</span><span class="ident" id="3812387">Equal</span><span class="op" id="3812392">(</span><span class="ident" id="3812393">m</span><span class="op" id="3812394">.</span><span class="ident" id="3812395">ciphertext</span><span class="op" id="3812405">,</span>&nbsp;<span class="ident" id="3812407">m1</span><span class="op" id="3812409">.</span><span class="ident" id="3812410">ciphertext</span><span class="op" id="3812420">)</span><br>
<span class="lineno"></span><span class="op" id="3812422">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="3812425">func</span>&nbsp;<span class="op" id="3812430">(</span><span class="ident" id="3812431">m</span>&nbsp;<span class="op" id="3812433">*</span><span class="ident" id="3812434">clientKeyExchangeMsg</span><span class="op" id="3812454">)</span>&nbsp;<span class="ident" id="3812456">marshal</span><span class="op" id="3812463">(</span><span class="op" id="3812464">)</span>&nbsp;<span class="op" id="3812466">[</span><span class="op" id="3812467">]</span><span class="builtintype" id="3812468">byte</span>&nbsp;<span class="op" id="3812473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812476">if</span>&nbsp;<span class="ident" id="3812479">m</span><span class="op" id="3812480">.</span><span class="ident" id="3812481">raw</span>&nbsp;<span class="op" id="3812485">!=</span>&nbsp;<span class="builtintype" id="3812488">nil</span>&nbsp;<span class="op" id="3812492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812496">return</span>&nbsp;<span class="ident" id="3812503">m</span><span class="op" id="3812504">.</span><span class="ident" id="3812505">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3812510">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812513">length</span>&nbsp;<span class="op" id="3812520">:=</span>&nbsp;<span class="builtinfunc" id="3812523">len</span><span class="op" id="3812526">(</span><span class="ident" id="3812527">m</span><span class="op" id="3812528">.</span><span class="ident" id="3812529">ciphertext</span><span class="op" id="3812539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812542">x</span>&nbsp;<span class="op" id="3812544">:=</span>&nbsp;<span class="builtinfunc" id="3812547">make</span><span class="op" id="3812551">(</span><span class="op" id="3812552">[</span><span class="op" id="3812553">]</span><span class="builtintype" id="3812554">byte</span><span class="op" id="3812558">,</span>&nbsp;<span class="ident" id="3812560">length</span><span class="op" id="3812566">+</span><span class="num" id="3812567">4</span><span class="op" id="3812568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812571">x</span><span class="op" id="3812572">[</span><span class="num" id="3812573">0</span><span class="op" id="3812574">]</span>&nbsp;<span class="op" id="3812576">=</span>&nbsp;<span class="ident" id="3812578">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812601">x</span><span class="op" id="3812602">[</span><span class="num" id="3812603">1</span><span class="op" id="3812604">]</span>&nbsp;<span class="op" id="3812606">=</span>&nbsp;<span class="builtintype" id="3812608">uint8</span><span class="op" id="3812613">(</span><span class="ident" id="3812614">length</span>&nbsp;<span class="op" id="3812621">&gt;&gt;</span>&nbsp;<span class="num" id="3812624">16</span><span class="op" id="3812626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812629">x</span><span class="op" id="3812630">[</span><span class="num" id="3812631">2</span><span class="op" id="3812632">]</span>&nbsp;<span class="op" id="3812634">=</span>&nbsp;<span class="builtintype" id="3812636">uint8</span><span class="op" id="3812641">(</span><span class="ident" id="3812642">length</span>&nbsp;<span class="op" id="3812649">&gt;&gt;</span>&nbsp;<span class="num" id="3812652">8</span><span class="op" id="3812653">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812656">x</span><span class="op" id="3812657">[</span><span class="num" id="3812658">3</span><span class="op" id="3812659">]</span>&nbsp;<span class="op" id="3812661">=</span>&nbsp;<span class="builtintype" id="3812663">uint8</span><span class="op" id="3812668">(</span><span class="ident" id="3812669">length</span><span class="op" id="3812675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3812678">copy</span><span class="op" id="3812682">(</span><span class="ident" id="3812683">x</span><span class="op" id="3812684">[</span><span class="num" id="3812685">4</span><span class="op" id="3812686">:</span><span class="op" id="3812687">]</span><span class="op" id="3812688">,</span>&nbsp;<span class="ident" id="3812690">m</span><span class="op" id="3812691">.</span><span class="ident" id="3812692">ciphertext</span><span class="op" id="3812702">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812706">m</span><span class="op" id="3812707">.</span><span class="ident" id="3812708">raw</span>&nbsp;<span class="op" id="3812712">=</span>&nbsp;<span class="ident" id="3812714">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812717">return</span>&nbsp;<span class="ident" id="3812724">x</span><br>
<span class="lineno">955</span><span class="op" id="3812726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3812729">func</span>&nbsp;<span class="op" id="3812734">(</span><span class="ident" id="3812735">m</span>&nbsp;<span class="op" id="3812737">*</span><span class="ident" id="3812738">clientKeyExchangeMsg</span><span class="op" id="3812758">)</span>&nbsp;<span class="ident" id="3812760">unmarshal</span><span class="op" id="3812769">(</span><span class="ident" id="3812770">data</span>&nbsp;<span class="op" id="3812775">[</span><span class="op" id="3812776">]</span><span class="builtintype" id="3812777">byte</span><span class="op" id="3812781">)</span>&nbsp;<span class="builtintype" id="3812783">bool</span>&nbsp;<span class="op" id="3812788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812791">m</span><span class="op" id="3812792">.</span><span class="ident" id="3812793">raw</span>&nbsp;<span class="op" id="3812797">=</span>&nbsp;<span class="ident" id="3812799">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812805">if</span>&nbsp;<span class="builtinfunc" id="3812808">len</span><span class="op" id="3812811">(</span><span class="ident" id="3812812">data</span><span class="op" id="3812816">)</span>&nbsp;<span class="op" id="3812818">&lt;</span>&nbsp;<span class="num" id="3812820">4</span>&nbsp;<span class="op" id="3812822">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812826">return</span>&nbsp;<span class="builtintype" id="3812833">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3812840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812843">l</span>&nbsp;<span class="op" id="3812845">:=</span>&nbsp;<span class="builtintype" id="3812848">int</span><span class="op" id="3812851">(</span><span class="ident" id="3812852">data</span><span class="op" id="3812856">[</span><span class="num" id="3812857">1</span><span class="op" id="3812858">]</span><span class="op" id="3812859">)</span><span class="op" id="3812860">&lt;&lt;</span><span class="num" id="3812862">16</span>&nbsp;<span class="op" id="3812865">|</span>&nbsp;<span class="builtintype" id="3812867">int</span><span class="op" id="3812870">(</span><span class="ident" id="3812871">data</span><span class="op" id="3812875">[</span><span class="num" id="3812876">2</span><span class="op" id="3812877">]</span><span class="op" id="3812878">)</span><span class="op" id="3812879">&lt;&lt;</span><span class="num" id="3812881">8</span>&nbsp;<span class="op" id="3812883">|</span>&nbsp;<span class="builtintype" id="3812885">int</span><span class="op" id="3812888">(</span><span class="ident" id="3812889">data</span><span class="op" id="3812893">[</span><span class="num" id="3812894">3</span><span class="op" id="3812895">]</span><span class="op" id="3812896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812899">if</span>&nbsp;<span class="ident" id="3812902">l</span>&nbsp;<span class="op" id="3812904">!=</span>&nbsp;<span class="builtinfunc" id="3812907">len</span><span class="op" id="3812910">(</span><span class="ident" id="3812911">data</span><span class="op" id="3812915">)</span><span class="op" id="3812916">-</span><span class="num" id="3812917">4</span>&nbsp;<span class="op" id="3812919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812923">return</span>&nbsp;<span class="builtintype" id="3812930">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3812937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3812940">m</span><span class="op" id="3812941">.</span><span class="ident" id="3812942">ciphertext</span>&nbsp;<span class="op" id="3812953">=</span>&nbsp;<span class="ident" id="3812955">data</span><span class="op" id="3812959">[</span><span class="num" id="3812960">4</span><span class="op" id="3812961">:</span><span class="op" id="3812962">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3812965">return</span>&nbsp;<span class="builtintype" id="3812972">true</span><br>
<span class="lineno"></span><span class="op" id="3812977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="3812980">type</span>&nbsp;<span class="ident" id="3812985">finishedMsg</span>&nbsp;<span class="keyword" id="3812997">struct</span>&nbsp;<span class="op" id="3813004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813007">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3813018">[</span><span class="op" id="3813019">]</span><span class="builtintype" id="3813020">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813026">verifyData</span>&nbsp;<span class="op" id="3813037">[</span><span class="op" id="3813038">]</span><span class="builtintype" id="3813039">byte</span><br>
<span class="lineno"></span><span class="op" id="3813044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="3813047">func</span>&nbsp;<span class="op" id="3813052">(</span><span class="ident" id="3813053">m</span>&nbsp;<span class="op" id="3813055">*</span><span class="ident" id="3813056">finishedMsg</span><span class="op" id="3813067">)</span>&nbsp;<span class="ident" id="3813069">equal</span><span class="op" id="3813074">(</span><span class="ident" id="3813075">i</span>&nbsp;<span class="keyword" id="3813077">interface</span><span class="op" id="3813086">{</span><span class="op" id="3813087">}</span><span class="op" id="3813088">)</span>&nbsp;<span class="builtintype" id="3813090">bool</span>&nbsp;<span class="op" id="3813095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813098">m1</span><span class="op" id="3813100">,</span>&nbsp;<span class="ident" id="3813102">ok</span>&nbsp;<span class="op" id="3813105">:=</span>&nbsp;<span class="ident" id="3813108">i</span><span class="op" id="3813109">.</span><span class="op" id="3813110">(</span><span class="op" id="3813111">*</span><span class="ident" id="3813112">finishedMsg</span><span class="op" id="3813123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813126">if</span>&nbsp;<span class="op" id="3813129">!</span><span class="ident" id="3813130">ok</span>&nbsp;<span class="op" id="3813133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813137">return</span>&nbsp;<span class="builtintype" id="3813144">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3813151">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813155">return</span>&nbsp;<span class="ident" id="3813162">bytes</span><span class="op" id="3813167">.</span><span class="ident" id="3813168">Equal</span><span class="op" id="3813173">(</span><span class="ident" id="3813174">m</span><span class="op" id="3813175">.</span><span class="ident" id="3813176">raw</span><span class="op" id="3813179">,</span>&nbsp;<span class="ident" id="3813181">m1</span><span class="op" id="3813183">.</span><span class="ident" id="3813184">raw</span><span class="op" id="3813187">)</span>&nbsp;<span class="op" id="3813189">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813194">bytes</span><span class="op" id="3813199">.</span><span class="ident" id="3813200">Equal</span><span class="op" id="3813205">(</span><span class="ident" id="3813206">m</span><span class="op" id="3813207">.</span><span class="ident" id="3813208">verifyData</span><span class="op" id="3813218">,</span>&nbsp;<span class="ident" id="3813220">m1</span><span class="op" id="3813222">.</span><span class="ident" id="3813223">verifyData</span><span class="op" id="3813233">)</span><br>
<span class="lineno"></span><span class="op" id="3813235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="3813238">func</span>&nbsp;<span class="op" id="3813243">(</span><span class="ident" id="3813244">m</span>&nbsp;<span class="op" id="3813246">*</span><span class="ident" id="3813247">finishedMsg</span><span class="op" id="3813258">)</span>&nbsp;<span class="ident" id="3813260">marshal</span><span class="op" id="3813267">(</span><span class="op" id="3813268">)</span>&nbsp;<span class="op" id="3813270">(</span><span class="ident" id="3813271">x</span>&nbsp;<span class="op" id="3813273">[</span><span class="op" id="3813274">]</span><span class="builtintype" id="3813275">byte</span><span class="op" id="3813279">)</span>&nbsp;<span class="op" id="3813281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813284">if</span>&nbsp;<span class="ident" id="3813287">m</span><span class="op" id="3813288">.</span><span class="ident" id="3813289">raw</span>&nbsp;<span class="op" id="3813293">!=</span>&nbsp;<span class="builtintype" id="3813296">nil</span>&nbsp;<span class="op" id="3813300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813304">return</span>&nbsp;<span class="ident" id="3813311">m</span><span class="op" id="3813312">.</span><span class="ident" id="3813313">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3813318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813322">x</span>&nbsp;<span class="op" id="3813324">=</span>&nbsp;<span class="builtinfunc" id="3813326">make</span><span class="op" id="3813330">(</span><span class="op" id="3813331">[</span><span class="op" id="3813332">]</span><span class="builtintype" id="3813333">byte</span><span class="op" id="3813337">,</span>&nbsp;<span class="num" id="3813339">4</span><span class="op" id="3813340">+</span><span class="builtinfunc" id="3813341">len</span><span class="op" id="3813344">(</span><span class="ident" id="3813345">m</span><span class="op" id="3813346">.</span><span class="ident" id="3813347">verifyData</span><span class="op" id="3813357">)</span><span class="op" id="3813358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813361">x</span><span class="op" id="3813362">[</span><span class="num" id="3813363">0</span><span class="op" id="3813364">]</span>&nbsp;<span class="op" id="3813366">=</span>&nbsp;<span class="ident" id="3813368">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813382">x</span><span class="op" id="3813383">[</span><span class="num" id="3813384">3</span><span class="op" id="3813385">]</span>&nbsp;<span class="op" id="3813387">=</span>&nbsp;<span class="builtintype" id="3813389">byte</span><span class="op" id="3813393">(</span><span class="builtinfunc" id="3813394">len</span><span class="op" id="3813397">(</span><span class="ident" id="3813398">m</span><span class="op" id="3813399">.</span><span class="ident" id="3813400">verifyData</span><span class="op" id="3813410">)</span><span class="op" id="3813411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3813414">copy</span><span class="op" id="3813418">(</span><span class="ident" id="3813419">x</span><span class="op" id="3813420">[</span><span class="num" id="3813421">4</span><span class="op" id="3813422">:</span><span class="op" id="3813423">]</span><span class="op" id="3813424">,</span>&nbsp;<span class="ident" id="3813426">m</span><span class="op" id="3813427">.</span><span class="ident" id="3813428">verifyData</span><span class="op" id="3813438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813441">m</span><span class="op" id="3813442">.</span><span class="ident" id="3813443">raw</span>&nbsp;<span class="op" id="3813447">=</span>&nbsp;<span class="ident" id="3813449">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813452">return</span><br>
<span class="lineno"></span><span class="op" id="3813459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3813462">func</span>&nbsp;<span class="op" id="3813467">(</span><span class="ident" id="3813468">m</span>&nbsp;<span class="op" id="3813470">*</span><span class="ident" id="3813471">finishedMsg</span><span class="op" id="3813482">)</span>&nbsp;<span class="ident" id="3813484">unmarshal</span><span class="op" id="3813493">(</span><span class="ident" id="3813494">data</span>&nbsp;<span class="op" id="3813499">[</span><span class="op" id="3813500">]</span><span class="builtintype" id="3813501">byte</span><span class="op" id="3813505">)</span>&nbsp;<span class="builtintype" id="3813507">bool</span>&nbsp;<span class="op" id="3813512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813515">m</span><span class="op" id="3813516">.</span><span class="ident" id="3813517">raw</span>&nbsp;<span class="op" id="3813521">=</span>&nbsp;<span class="ident" id="3813523">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813529">if</span>&nbsp;<span class="builtinfunc" id="3813532">len</span><span class="op" id="3813535">(</span><span class="ident" id="3813536">data</span><span class="op" id="3813540">)</span>&nbsp;<span class="op" id="3813542">&lt;</span>&nbsp;<span class="num" id="3813544">4</span>&nbsp;<span class="op" id="3813546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813550">return</span>&nbsp;<span class="builtintype" id="3813557">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3813564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813567">m</span><span class="op" id="3813568">.</span><span class="ident" id="3813569">verifyData</span>&nbsp;<span class="op" id="3813580">=</span>&nbsp;<span class="ident" id="3813582">data</span><span class="op" id="3813586">[</span><span class="num" id="3813587">4</span><span class="op" id="3813588">:</span><span class="op" id="3813589">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813592">return</span>&nbsp;<span class="builtintype" id="3813599">true</span><br>
<span class="lineno">1005</span><span class="op" id="3813604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3813607">type</span>&nbsp;<span class="ident" id="3813612">nextProtoMsg</span>&nbsp;<span class="keyword" id="3813625">struct</span>&nbsp;<span class="op" id="3813632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813635">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3813641">[</span><span class="op" id="3813642">]</span><span class="builtintype" id="3813643">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813649">proto</span>&nbsp;<span class="builtintype" id="3813655">string</span><br>
<span class="lineno">1010</span><span class="op" id="3813662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3813665">func</span>&nbsp;<span class="op" id="3813670">(</span><span class="ident" id="3813671">m</span>&nbsp;<span class="op" id="3813673">*</span><span class="ident" id="3813674">nextProtoMsg</span><span class="op" id="3813686">)</span>&nbsp;<span class="ident" id="3813688">equal</span><span class="op" id="3813693">(</span><span class="ident" id="3813694">i</span>&nbsp;<span class="keyword" id="3813696">interface</span><span class="op" id="3813705">{</span><span class="op" id="3813706">}</span><span class="op" id="3813707">)</span>&nbsp;<span class="builtintype" id="3813709">bool</span>&nbsp;<span class="op" id="3813714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813717">m1</span><span class="op" id="3813719">,</span>&nbsp;<span class="ident" id="3813721">ok</span>&nbsp;<span class="op" id="3813724">:=</span>&nbsp;<span class="ident" id="3813727">i</span><span class="op" id="3813728">.</span><span class="op" id="3813729">(</span><span class="op" id="3813730">*</span><span class="ident" id="3813731">nextProtoMsg</span><span class="op" id="3813743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813746">if</span>&nbsp;<span class="op" id="3813749">!</span><span class="ident" id="3813750">ok</span>&nbsp;<span class="op" id="3813753">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813757">return</span>&nbsp;<span class="builtintype" id="3813764">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3813771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813775">return</span>&nbsp;<span class="ident" id="3813782">bytes</span><span class="op" id="3813787">.</span><span class="ident" id="3813788">Equal</span><span class="op" id="3813793">(</span><span class="ident" id="3813794">m</span><span class="op" id="3813795">.</span><span class="ident" id="3813796">raw</span><span class="op" id="3813799">,</span>&nbsp;<span class="ident" id="3813801">m1</span><span class="op" id="3813803">.</span><span class="ident" id="3813804">raw</span><span class="op" id="3813807">)</span>&nbsp;<span class="op" id="3813809">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813814">m</span><span class="op" id="3813815">.</span><span class="ident" id="3813816">proto</span>&nbsp;<span class="op" id="3813822">==</span>&nbsp;<span class="ident" id="3813825">m1</span><span class="op" id="3813827">.</span><span class="ident" id="3813828">proto</span><br>
<span class="lineno">1020</span><span class="op" id="3813834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3813837">func</span>&nbsp;<span class="op" id="3813842">(</span><span class="ident" id="3813843">m</span>&nbsp;<span class="op" id="3813845">*</span><span class="ident" id="3813846">nextProtoMsg</span><span class="op" id="3813858">)</span>&nbsp;<span class="ident" id="3813860">marshal</span><span class="op" id="3813867">(</span><span class="op" id="3813868">)</span>&nbsp;<span class="op" id="3813870">[</span><span class="op" id="3813871">]</span><span class="builtintype" id="3813872">byte</span>&nbsp;<span class="op" id="3813877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813880">if</span>&nbsp;<span class="ident" id="3813883">m</span><span class="op" id="3813884">.</span><span class="ident" id="3813885">raw</span>&nbsp;<span class="op" id="3813889">!=</span>&nbsp;<span class="builtintype" id="3813892">nil</span>&nbsp;<span class="op" id="3813896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813900">return</span>&nbsp;<span class="ident" id="3813907">m</span><span class="op" id="3813908">.</span><span class="ident" id="3813909">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3813914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813917">l</span>&nbsp;<span class="op" id="3813919">:=</span>&nbsp;<span class="builtinfunc" id="3813922">len</span><span class="op" id="3813925">(</span><span class="ident" id="3813926">m</span><span class="op" id="3813927">.</span><span class="ident" id="3813928">proto</span><span class="op" id="3813933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3813936">if</span>&nbsp;<span class="ident" id="3813939">l</span>&nbsp;<span class="op" id="3813941">&gt;</span>&nbsp;<span class="num" id="3813943">255</span>&nbsp;<span class="op" id="3813947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813951">l</span>&nbsp;<span class="op" id="3813953">=</span>&nbsp;<span class="num" id="3813955">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3813960">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813964">padding</span>&nbsp;<span class="op" id="3813972">:=</span>&nbsp;<span class="num" id="3813975">32</span>&nbsp;<span class="op" id="3813978">-</span>&nbsp;<span class="op" id="3813980">(</span><span class="ident" id="3813981">l</span><span class="op" id="3813982">+</span><span class="num" id="3813983">2</span><span class="op" id="3813984">)</span><span class="op" id="3813985">%</span><span class="num" id="3813986">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3813990">length</span>&nbsp;<span class="op" id="3813997">:=</span>&nbsp;<span class="ident" id="3814000">l</span>&nbsp;<span class="op" id="3814002">+</span>&nbsp;<span class="ident" id="3814004">padding</span>&nbsp;<span class="op" id="3814012">+</span>&nbsp;<span class="num" id="3814014">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814017">x</span>&nbsp;<span class="op" id="3814019">:=</span>&nbsp;<span class="builtinfunc" id="3814022">make</span><span class="op" id="3814026">(</span><span class="op" id="3814027">[</span><span class="op" id="3814028">]</span><span class="builtintype" id="3814029">byte</span><span class="op" id="3814033">,</span>&nbsp;<span class="ident" id="3814035">length</span><span class="op" id="3814041">+</span><span class="num" id="3814042">4</span><span class="op" id="3814043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814046">x</span><span class="op" id="3814047">[</span><span class="num" id="3814048">0</span><span class="op" id="3814049">]</span>&nbsp;<span class="op" id="3814051">=</span>&nbsp;<span class="ident" id="3814053">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814071">x</span><span class="op" id="3814072">[</span><span class="num" id="3814073">1</span><span class="op" id="3814074">]</span>&nbsp;<span class="op" id="3814076">=</span>&nbsp;<span class="builtintype" id="3814078">uint8</span><span class="op" id="3814083">(</span><span class="ident" id="3814084">length</span>&nbsp;<span class="op" id="3814091">&gt;&gt;</span>&nbsp;<span class="num" id="3814094">16</span><span class="op" id="3814096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814099">x</span><span class="op" id="3814100">[</span><span class="num" id="3814101">2</span><span class="op" id="3814102">]</span>&nbsp;<span class="op" id="3814104">=</span>&nbsp;<span class="builtintype" id="3814106">uint8</span><span class="op" id="3814111">(</span><span class="ident" id="3814112">length</span>&nbsp;<span class="op" id="3814119">&gt;&gt;</span>&nbsp;<span class="num" id="3814122">8</span><span class="op" id="3814123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814126">x</span><span class="op" id="3814127">[</span><span class="num" id="3814128">3</span><span class="op" id="3814129">]</span>&nbsp;<span class="op" id="3814131">=</span>&nbsp;<span class="builtintype" id="3814133">uint8</span><span class="op" id="3814138">(</span><span class="ident" id="3814139">length</span><span class="op" id="3814145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814149">y</span>&nbsp;<span class="op" id="3814151">:=</span>&nbsp;<span class="ident" id="3814154">x</span><span class="op" id="3814155">[</span><span class="num" id="3814156">4</span><span class="op" id="3814157">:</span><span class="op" id="3814158">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814161">y</span><span class="op" id="3814162">[</span><span class="num" id="3814163">0</span><span class="op" id="3814164">]</span>&nbsp;<span class="op" id="3814166">=</span>&nbsp;<span class="builtintype" id="3814168">byte</span><span class="op" id="3814172">(</span><span class="ident" id="3814173">l</span><span class="op" id="3814174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3814177">copy</span><span class="op" id="3814181">(</span><span class="ident" id="3814182">y</span><span class="op" id="3814183">[</span><span class="num" id="3814184">1</span><span class="op" id="3814185">:</span><span class="op" id="3814186">]</span><span class="op" id="3814187">,</span>&nbsp;<span class="op" id="3814189">[</span><span class="op" id="3814190">]</span><span class="builtintype" id="3814191">byte</span><span class="op" id="3814195">(</span><span class="ident" id="3814196">m</span><span class="op" id="3814197">.</span><span class="ident" id="3814198">proto</span><span class="op" id="3814203">[</span><span class="num" id="3814204">0</span><span class="op" id="3814205">:</span><span class="ident" id="3814206">l</span><span class="op" id="3814207">]</span><span class="op" id="3814208">)</span><span class="op" id="3814209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814212">y</span>&nbsp;<span class="op" id="3814214">=</span>&nbsp;<span class="ident" id="3814216">y</span><span class="op" id="3814217">[</span><span class="num" id="3814218">1</span><span class="op" id="3814219">+</span><span class="ident" id="3814220">l</span><span class="op" id="3814221">:</span><span class="op" id="3814222">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814225">y</span><span class="op" id="3814226">[</span><span class="num" id="3814227">0</span><span class="op" id="3814228">]</span>&nbsp;<span class="op" id="3814230">=</span>&nbsp;<span class="builtintype" id="3814232">byte</span><span class="op" id="3814236">(</span><span class="ident" id="3814237">padding</span><span class="op" id="3814244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814248">m</span><span class="op" id="3814249">.</span><span class="ident" id="3814250">raw</span>&nbsp;<span class="op" id="3814254">=</span>&nbsp;<span class="ident" id="3814256">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3814260">return</span>&nbsp;<span class="ident" id="3814267">x</span><br>
<span class="lineno"></span><span class="op" id="3814269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="3814272">func</span>&nbsp;<span class="op" id="3814277">(</span><span class="ident" id="3814278">m</span>&nbsp;<span class="op" id="3814280">*</span><span class="ident" id="3814281">nextProtoMsg</span><span class="op" id="3814293">)</span>&nbsp;<span class="ident" id="3814295">unmarshal</span><span class="op" id="3814304">(</span><span class="ident" id="3814305">data</span>&nbsp;<span class="op" id="3814310">[</span><span class="op" id="3814311">]</span><span class="builtintype" id="3814312">byte</span><span class="op" id="3814316">)</span>&nbsp;<span class="builtintype" id="3814318">bool</span>&nbsp;<span class="op" id="3814323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814326">m</span><span class="op" id="3814327">.</span><span class="ident" id="3814328">raw</span>&nbsp;<span class="op" id="3814332">=</span>&nbsp;<span class="ident" id="3814334">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3814341">if</span>&nbsp;<span class="builtinfunc" id="3814344">len</span><span class="op" id="3814347">(</span><span class="ident" id="3814348">data</span><span class="op" id="3814352">)</span>&nbsp;<span class="op" id="3814354">&lt;</span>&nbsp;<span class="num" id="3814356">5</span>&nbsp;<span class="op" id="3814358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3814362">return</span>&nbsp;<span class="builtintype" id="3814369">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3814376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814379">data</span>&nbsp;<span class="op" id="3814384">=</span>&nbsp;<span class="ident" id="3814386">data</span><span class="op" id="3814390">[</span><span class="num" id="3814391">4</span><span class="op" id="3814392">:</span><span class="op" id="3814393">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814396">protoLen</span>&nbsp;<span class="op" id="3814405">:=</span>&nbsp;<span class="builtintype" id="3814408">int</span><span class="op" id="3814411">(</span><span class="ident" id="3814412">data</span><span class="op" id="3814416">[</span><span class="num" id="3814417">0</span><span class="op" id="3814418">]</span><span class="op" id="3814419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814422">data</span>&nbsp;<span class="op" id="3814427">=</span>&nbsp;<span class="ident" id="3814429">data</span><span class="op" id="3814433">[</span><span class="num" id="3814434">1</span><span class="op" id="3814435">:</span><span class="op" id="3814436">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3814439">if</span>&nbsp;<span class="builtinfunc" id="3814442">len</span><span class="op" id="3814445">(</span><span class="ident" id="3814446">data</span><span class="op" id="3814450">)</span>&nbsp;<span class="op" id="3814452">&lt;</span>&nbsp;<span class="ident" id="3814454">protoLen</span>&nbsp;<span class="op" id="3814463">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3814467">return</span>&nbsp;<span class="builtintype" id="3814474">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3814481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814484">m</span><span class="op" id="3814485">.</span><span class="ident" id="3814486">proto</span>&nbsp;<span class="op" id="3814492">=</span>&nbsp;<span class="builtintype" id="3814494">string</span><span class="op" id="3814500">(</span><span class="ident" id="3814501">data</span><span class="op" id="3814505">[</span><span class="num" id="3814506">0</span><span class="op" id="3814507">:</span><span class="ident" id="3814508">protoLen</span><span class="op" id="3814516">]</span><span class="op" id="3814517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814520">data</span>&nbsp;<span class="op" id="3814525">=</span>&nbsp;<span class="ident" id="3814527">data</span><span class="op" id="3814531">[</span><span class="ident" id="3814532">protoLen</span><span class="op" id="3814540">:</span><span class="op" id="3814541">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3814545">if</span>&nbsp;<span class="builtinfunc" id="3814548">len</span><span class="op" id="3814551">(</span><span class="ident" id="3814552">data</span><span class="op" id="3814556">)</span>&nbsp;<span class="op" id="3814558">&lt;</span>&nbsp;<span class="num" id="3814560">1</span>&nbsp;<span class="op" id="3814562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3814566">return</span>&nbsp;<span class="builtintype" id="3814573">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3814580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814583">paddingLen</span>&nbsp;<span class="op" id="3814594">:=</span>&nbsp;<span class="builtintype" id="3814597">int</span><span class="op" id="3814600">(</span><span class="ident" id="3814601">data</span><span class="op" id="3814605">[</span><span class="num" id="3814606">0</span><span class="op" id="3814607">]</span><span class="op" id="3814608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814611">data</span>&nbsp;<span class="op" id="3814616">=</span>&nbsp;<span class="ident" id="3814618">data</span><span class="op" id="3814622">[</span><span class="num" id="3814623">1</span><span class="op" id="3814624">:</span><span class="op" id="3814625">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3814628">if</span>&nbsp;<span class="builtinfunc" id="3814631">len</span><span class="op" id="3814634">(</span><span class="ident" id="3814635">data</span><span class="op" id="3814639">)</span>&nbsp;<span class="op" id="3814641">!=</span>&nbsp;<span class="ident" id="3814644">paddingLen</span>&nbsp;<span class="op" id="3814655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3814659">return</span>&nbsp;<span class="builtintype" id="3814666">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3814673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3814677">return</span>&nbsp;<span class="builtintype" id="3814684">true</span><br>
<span class="lineno">1075</span><span class="op" id="3814689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3814692">type</span>&nbsp;<span class="ident" id="3814697">certificateRequestMsg</span>&nbsp;<span class="keyword" id="3814719">struct</span>&nbsp;<span class="op" id="3814726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814729">raw</span>&nbsp;<span class="op" id="3814733">[</span><span class="op" id="3814734">]</span><span class="builtintype" id="3814735">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3814741">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3814812">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3814885">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814894">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3814914">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814921">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3814944">[</span><span class="op" id="3814945">]</span><span class="builtintype" id="3814946">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814952">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3814975">[</span><span class="op" id="3814976">]</span><span class="ident" id="3814977">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3814995">certificateAuthorities</span>&nbsp;<span class="op" id="3815018">[</span><span class="op" id="3815019">]</span><span class="op" id="3815020">[</span><span class="op" id="3815021">]</span><span class="builtintype" id="3815022">byte</span><br>
<span class="lineno"></span><span class="op" id="3815027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3815030">func</span>&nbsp;<span class="op" id="3815035">(</span><span class="ident" id="3815036">m</span>&nbsp;<span class="op" id="3815038">*</span><span class="ident" id="3815039">certificateRequestMsg</span><span class="op" id="3815060">)</span>&nbsp;<span class="ident" id="3815062">equal</span><span class="op" id="3815067">(</span><span class="ident" id="3815068">i</span>&nbsp;<span class="keyword" id="3815070">interface</span><span class="op" id="3815079">{</span><span class="op" id="3815080">}</span><span class="op" id="3815081">)</span>&nbsp;<span class="builtintype" id="3815083">bool</span>&nbsp;<span class="op" id="3815088">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815091">m1</span><span class="op" id="3815093">,</span>&nbsp;<span class="ident" id="3815095">ok</span>&nbsp;<span class="op" id="3815098">:=</span>&nbsp;<span class="ident" id="3815101">i</span><span class="op" id="3815102">.</span><span class="op" id="3815103">(</span><span class="op" id="3815104">*</span><span class="ident" id="3815105">certificateRequestMsg</span><span class="op" id="3815126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3815129">if</span>&nbsp;<span class="op" id="3815132">!</span><span class="ident" id="3815133">ok</span>&nbsp;<span class="op" id="3815136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3815140">return</span>&nbsp;<span class="builtintype" id="3815147">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3815154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3815158">return</span>&nbsp;<span class="ident" id="3815165">bytes</span><span class="op" id="3815170">.</span><span class="ident" id="3815171">Equal</span><span class="op" id="3815176">(</span><span class="ident" id="3815177">m</span><span class="op" id="3815178">.</span><span class="ident" id="3815179">raw</span><span class="op" id="3815182">,</span>&nbsp;<span class="ident" id="3815184">m1</span><span class="op" id="3815186">.</span><span class="ident" id="3815187">raw</span><span class="op" id="3815190">)</span>&nbsp;<span class="op" id="3815192">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815197">bytes</span><span class="op" id="3815202">.</span><span class="ident" id="3815203">Equal</span><span class="op" id="3815208">(</span><span class="ident" id="3815209">m</span><span class="op" id="3815210">.</span><span class="ident" id="3815211">certificateTypes</span><span class="op" id="3815227">,</span>&nbsp;<span class="ident" id="3815229">m1</span><span class="op" id="3815231">.</span><span class="ident" id="3815232">certificateTypes</span><span class="op" id="3815248">)</span>&nbsp;<span class="op" id="3815250">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815255">eqByteSlices</span><span class="op" id="3815267">(</span><span class="ident" id="3815268">m</span><span class="op" id="3815269">.</span><span class="ident" id="3815270">certificateAuthorities</span><span class="op" id="3815292">,</span>&nbsp;<span class="ident" id="3815294">m1</span><span class="op" id="3815296">.</span><span class="ident" id="3815297">certificateAuthorities</span><span class="op" id="3815319">)</span>&nbsp;<span class="op" id="3815321">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815326">eqSignatureAndHashes</span><span class="op" id="3815346">(</span><span class="ident" id="3815347">m</span><span class="op" id="3815348">.</span><span class="ident" id="3815349">signatureAndHashes</span><span class="op" id="3815367">,</span>&nbsp;<span class="ident" id="3815369">m1</span><span class="op" id="3815371">.</span><span class="ident" id="3815372">signatureAndHashes</span><span class="op" id="3815390">)</span><br>
<span class="lineno"></span><span class="op" id="3815392">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="3815395">func</span>&nbsp;<span class="op" id="3815400">(</span><span class="ident" id="3815401">m</span>&nbsp;<span class="op" id="3815403">*</span><span class="ident" id="3815404">certificateRequestMsg</span><span class="op" id="3815425">)</span>&nbsp;<span class="ident" id="3815427">marshal</span><span class="op" id="3815434">(</span><span class="op" id="3815435">)</span>&nbsp;<span class="op" id="3815437">(</span><span class="ident" id="3815438">x</span>&nbsp;<span class="op" id="3815440">[</span><span class="op" id="3815441">]</span><span class="builtintype" id="3815442">byte</span><span class="op" id="3815446">)</span>&nbsp;<span class="op" id="3815448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3815451">if</span>&nbsp;<span class="ident" id="3815454">m</span><span class="op" id="3815455">.</span><span class="ident" id="3815456">raw</span>&nbsp;<span class="op" id="3815460">!=</span>&nbsp;<span class="builtintype" id="3815463">nil</span>&nbsp;<span class="op" id="3815467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3815471">return</span>&nbsp;<span class="ident" id="3815478">m</span><span class="op" id="3815479">.</span><span class="ident" id="3815480">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3815485">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3815489">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815546">length</span>&nbsp;<span class="op" id="3815553">:=</span>&nbsp;<span class="num" id="3815556">1</span>&nbsp;<span class="op" id="3815558">+</span>&nbsp;<span class="builtinfunc" id="3815560">len</span><span class="op" id="3815563">(</span><span class="ident" id="3815564">m</span><span class="op" id="3815565">.</span><span class="ident" id="3815566">certificateTypes</span><span class="op" id="3815582">)</span>&nbsp;<span class="op" id="3815584">+</span>&nbsp;<span class="num" id="3815586">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815589">casLength</span>&nbsp;<span class="op" id="3815599">:=</span>&nbsp;<span class="num" id="3815602">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3815605">for</span>&nbsp;<span class="ident" id="3815609">_</span><span class="op" id="3815610">,</span>&nbsp;<span class="ident" id="3815612">ca</span>&nbsp;<span class="op" id="3815615">:=</span>&nbsp;<span class="keyword" id="3815618">range</span>&nbsp;<span class="ident" id="3815624">m</span><span class="op" id="3815625">.</span><span class="ident" id="3815626">certificateAuthorities</span>&nbsp;<span class="op" id="3815649">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815653">casLength</span>&nbsp;<span class="op" id="3815663">+=</span>&nbsp;<span class="num" id="3815666">2</span>&nbsp;<span class="op" id="3815668">+</span>&nbsp;<span class="builtinfunc" id="3815670">len</span><span class="op" id="3815673">(</span><span class="ident" id="3815674">ca</span><span class="op" id="3815676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3815679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815682">length</span>&nbsp;<span class="op" id="3815689">+=</span>&nbsp;<span class="ident" id="3815692">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3815704">if</span>&nbsp;<span class="ident" id="3815707">m</span><span class="op" id="3815708">.</span><span class="ident" id="3815709">hasSignatureAndHash</span>&nbsp;<span class="op" id="3815729">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815733">length</span>&nbsp;<span class="op" id="3815740">+=</span>&nbsp;<span class="num" id="3815743">2</span>&nbsp;<span class="op" id="3815745">+</span>&nbsp;<span class="num" id="3815747">2</span><span class="op" id="3815748">*</span><span class="builtinfunc" id="3815749">len</span><span class="op" id="3815752">(</span><span class="ident" id="3815753">m</span><span class="op" id="3815754">.</span><span class="ident" id="3815755">signatureAndHashes</span><span class="op" id="3815773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3815776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815780">x</span>&nbsp;<span class="op" id="3815782">=</span>&nbsp;<span class="builtinfunc" id="3815784">make</span><span class="op" id="3815788">(</span><span class="op" id="3815789">[</span><span class="op" id="3815790">]</span><span class="builtintype" id="3815791">byte</span><span class="op" id="3815795">,</span>&nbsp;<span class="num" id="3815797">4</span><span class="op" id="3815798">+</span><span class="ident" id="3815799">length</span><span class="op" id="3815805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815808">x</span><span class="op" id="3815809">[</span><span class="num" id="3815810">0</span><span class="op" id="3815811">]</span>&nbsp;<span class="op" id="3815813">=</span>&nbsp;<span class="ident" id="3815815">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815839">x</span><span class="op" id="3815840">[</span><span class="num" id="3815841">1</span><span class="op" id="3815842">]</span>&nbsp;<span class="op" id="3815844">=</span>&nbsp;<span class="builtintype" id="3815846">uint8</span><span class="op" id="3815851">(</span><span class="ident" id="3815852">length</span>&nbsp;<span class="op" id="3815859">&gt;&gt;</span>&nbsp;<span class="num" id="3815862">16</span><span class="op" id="3815864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815867">x</span><span class="op" id="3815868">[</span><span class="num" id="3815869">2</span><span class="op" id="3815870">]</span>&nbsp;<span class="op" id="3815872">=</span>&nbsp;<span class="builtintype" id="3815874">uint8</span><span class="op" id="3815879">(</span><span class="ident" id="3815880">length</span>&nbsp;<span class="op" id="3815887">&gt;&gt;</span>&nbsp;<span class="num" id="3815890">8</span><span class="op" id="3815891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815894">x</span><span class="op" id="3815895">[</span><span class="num" id="3815896">3</span><span class="op" id="3815897">]</span>&nbsp;<span class="op" id="3815899">=</span>&nbsp;<span class="builtintype" id="3815901">uint8</span><span class="op" id="3815906">(</span><span class="ident" id="3815907">length</span><span class="op" id="3815913">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815917">x</span><span class="op" id="3815918">[</span><span class="num" id="3815919">4</span><span class="op" id="3815920">]</span>&nbsp;<span class="op" id="3815922">=</span>&nbsp;<span class="builtintype" id="3815924">uint8</span><span class="op" id="3815929">(</span><span class="builtinfunc" id="3815930">len</span><span class="op" id="3815933">(</span><span class="ident" id="3815934">m</span><span class="op" id="3815935">.</span><span class="ident" id="3815936">certificateTypes</span><span class="op" id="3815952">)</span><span class="op" id="3815953">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3815957">copy</span><span class="op" id="3815961">(</span><span class="ident" id="3815962">x</span><span class="op" id="3815963">[</span><span class="num" id="3815964">5</span><span class="op" id="3815965">:</span><span class="op" id="3815966">]</span><span class="op" id="3815967">,</span>&nbsp;<span class="ident" id="3815969">m</span><span class="op" id="3815970">.</span><span class="ident" id="3815971">certificateTypes</span><span class="op" id="3815987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3815990">y</span>&nbsp;<span class="op" id="3815992">:=</span>&nbsp;<span class="ident" id="3815995">x</span><span class="op" id="3815996">[</span><span class="num" id="3815997">5</span><span class="op" id="3815998">+</span><span class="builtinfunc" id="3815999">len</span><span class="op" id="3816002">(</span><span class="ident" id="3816003">m</span><span class="op" id="3816004">.</span><span class="ident" id="3816005">certificateTypes</span><span class="op" id="3816021">)</span><span class="op" id="3816022">:</span><span class="op" id="3816023">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816027">if</span>&nbsp;<span class="ident" id="3816030">m</span><span class="op" id="3816031">.</span><span class="ident" id="3816032">hasSignatureAndHash</span>&nbsp;<span class="op" id="3816052">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816056">n</span>&nbsp;<span class="op" id="3816058">:=</span>&nbsp;<span class="builtinfunc" id="3816061">len</span><span class="op" id="3816064">(</span><span class="ident" id="3816065">m</span><span class="op" id="3816066">.</span><span class="ident" id="3816067">signatureAndHashes</span><span class="op" id="3816085">)</span>&nbsp;<span class="op" id="3816087">*</span>&nbsp;<span class="num" id="3816089">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816093">y</span><span class="op" id="3816094">[</span><span class="num" id="3816095">0</span><span class="op" id="3816096">]</span>&nbsp;<span class="op" id="3816098">=</span>&nbsp;<span class="builtintype" id="3816100">uint8</span><span class="op" id="3816105">(</span><span class="ident" id="3816106">n</span>&nbsp;<span class="op" id="3816108">&gt;&gt;</span>&nbsp;<span class="num" id="3816111">8</span><span class="op" id="3816112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816116">y</span><span class="op" id="3816117">[</span><span class="num" id="3816118">1</span><span class="op" id="3816119">]</span>&nbsp;<span class="op" id="3816121">=</span>&nbsp;<span class="builtintype" id="3816123">uint8</span><span class="op" id="3816128">(</span><span class="ident" id="3816129">n</span><span class="op" id="3816130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816134">y</span>&nbsp;<span class="op" id="3816136">=</span>&nbsp;<span class="ident" id="3816138">y</span><span class="op" id="3816139">[</span><span class="num" id="3816140">2</span><span class="op" id="3816141">:</span><span class="op" id="3816142">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816146">for</span>&nbsp;<span class="ident" id="3816150">_</span><span class="op" id="3816151">,</span>&nbsp;<span class="ident" id="3816153">sigAndHash</span>&nbsp;<span class="op" id="3816164">:=</span>&nbsp;<span class="keyword" id="3816167">range</span>&nbsp;<span class="ident" id="3816173">m</span><span class="op" id="3816174">.</span><span class="ident" id="3816175">signatureAndHashes</span>&nbsp;<span class="op" id="3816194">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816199">y</span><span class="op" id="3816200">[</span><span class="num" id="3816201">0</span><span class="op" id="3816202">]</span>&nbsp;<span class="op" id="3816204">=</span>&nbsp;<span class="ident" id="3816206">sigAndHash</span><span class="op" id="3816216">.</span><span class="ident" id="3816217">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816225">y</span><span class="op" id="3816226">[</span><span class="num" id="3816227">1</span><span class="op" id="3816228">]</span>&nbsp;<span class="op" id="3816230">=</span>&nbsp;<span class="ident" id="3816232">sigAndHash</span><span class="op" id="3816242">.</span><span class="ident" id="3816243">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816256">y</span>&nbsp;<span class="op" id="3816258">=</span>&nbsp;<span class="ident" id="3816260">y</span><span class="op" id="3816261">[</span><span class="num" id="3816262">2</span><span class="op" id="3816263">:</span><span class="op" id="3816264">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816271">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816275">y</span><span class="op" id="3816276">[</span><span class="num" id="3816277">0</span><span class="op" id="3816278">]</span>&nbsp;<span class="op" id="3816280">=</span>&nbsp;<span class="builtintype" id="3816282">uint8</span><span class="op" id="3816287">(</span><span class="ident" id="3816288">casLength</span>&nbsp;<span class="op" id="3816298">&gt;&gt;</span>&nbsp;<span class="num" id="3816301">8</span><span class="op" id="3816302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816305">y</span><span class="op" id="3816306">[</span><span class="num" id="3816307">1</span><span class="op" id="3816308">]</span>&nbsp;<span class="op" id="3816310">=</span>&nbsp;<span class="builtintype" id="3816312">uint8</span><span class="op" id="3816317">(</span><span class="ident" id="3816318">casLength</span><span class="op" id="3816327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816330">y</span>&nbsp;<span class="op" id="3816332">=</span>&nbsp;<span class="ident" id="3816334">y</span><span class="op" id="3816335">[</span><span class="num" id="3816336">2</span><span class="op" id="3816337">:</span><span class="op" id="3816338">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816341">for</span>&nbsp;<span class="ident" id="3816345">_</span><span class="op" id="3816346">,</span>&nbsp;<span class="ident" id="3816348">ca</span>&nbsp;<span class="op" id="3816351">:=</span>&nbsp;<span class="keyword" id="3816354">range</span>&nbsp;<span class="ident" id="3816360">m</span><span class="op" id="3816361">.</span><span class="ident" id="3816362">certificateAuthorities</span>&nbsp;<span class="op" id="3816385">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816389">y</span><span class="op" id="3816390">[</span><span class="num" id="3816391">0</span><span class="op" id="3816392">]</span>&nbsp;<span class="op" id="3816394">=</span>&nbsp;<span class="builtintype" id="3816396">uint8</span><span class="op" id="3816401">(</span><span class="builtinfunc" id="3816402">len</span><span class="op" id="3816405">(</span><span class="ident" id="3816406">ca</span><span class="op" id="3816408">)</span>&nbsp;<span class="op" id="3816410">&gt;&gt;</span>&nbsp;<span class="num" id="3816413">8</span><span class="op" id="3816414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816418">y</span><span class="op" id="3816419">[</span><span class="num" id="3816420">1</span><span class="op" id="3816421">]</span>&nbsp;<span class="op" id="3816423">=</span>&nbsp;<span class="builtintype" id="3816425">uint8</span><span class="op" id="3816430">(</span><span class="builtinfunc" id="3816431">len</span><span class="op" id="3816434">(</span><span class="ident" id="3816435">ca</span><span class="op" id="3816437">)</span><span class="op" id="3816438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816442">y</span>&nbsp;<span class="op" id="3816444">=</span>&nbsp;<span class="ident" id="3816446">y</span><span class="op" id="3816447">[</span><span class="num" id="3816448">2</span><span class="op" id="3816449">:</span><span class="op" id="3816450">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3816454">copy</span><span class="op" id="3816458">(</span><span class="ident" id="3816459">y</span><span class="op" id="3816460">,</span>&nbsp;<span class="ident" id="3816462">ca</span><span class="op" id="3816464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816468">y</span>&nbsp;<span class="op" id="3816470">=</span>&nbsp;<span class="ident" id="3816472">y</span><span class="op" id="3816473">[</span><span class="builtinfunc" id="3816474">len</span><span class="op" id="3816477">(</span><span class="ident" id="3816478">ca</span><span class="op" id="3816480">)</span><span class="op" id="3816481">:</span><span class="op" id="3816482">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816489">m</span><span class="op" id="3816490">.</span><span class="ident" id="3816491">raw</span>&nbsp;<span class="op" id="3816495">=</span>&nbsp;<span class="ident" id="3816497">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816500">return</span><br>
<span class="lineno"></span><span class="op" id="3816507">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="3816510">func</span>&nbsp;<span class="op" id="3816515">(</span><span class="ident" id="3816516">m</span>&nbsp;<span class="op" id="3816518">*</span><span class="ident" id="3816519">certificateRequestMsg</span><span class="op" id="3816540">)</span>&nbsp;<span class="ident" id="3816542">unmarshal</span><span class="op" id="3816551">(</span><span class="ident" id="3816552">data</span>&nbsp;<span class="op" id="3816557">[</span><span class="op" id="3816558">]</span><span class="builtintype" id="3816559">byte</span><span class="op" id="3816563">)</span>&nbsp;<span class="builtintype" id="3816565">bool</span>&nbsp;<span class="op" id="3816570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816573">m</span><span class="op" id="3816574">.</span><span class="ident" id="3816575">raw</span>&nbsp;<span class="op" id="3816579">=</span>&nbsp;<span class="ident" id="3816581">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816588">if</span>&nbsp;<span class="builtinfunc" id="3816591">len</span><span class="op" id="3816594">(</span><span class="ident" id="3816595">data</span><span class="op" id="3816599">)</span>&nbsp;<span class="op" id="3816601">&lt;</span>&nbsp;<span class="num" id="3816603">5</span>&nbsp;<span class="op" id="3816605">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816609">return</span>&nbsp;<span class="builtintype" id="3816616">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816627">length</span>&nbsp;<span class="op" id="3816634">:=</span>&nbsp;<span class="builtintype" id="3816637">uint32</span><span class="op" id="3816643">(</span><span class="ident" id="3816644">data</span><span class="op" id="3816648">[</span><span class="num" id="3816649">1</span><span class="op" id="3816650">]</span><span class="op" id="3816651">)</span><span class="op" id="3816652">&lt;&lt;</span><span class="num" id="3816654">16</span>&nbsp;<span class="op" id="3816657">|</span>&nbsp;<span class="builtintype" id="3816659">uint32</span><span class="op" id="3816665">(</span><span class="ident" id="3816666">data</span><span class="op" id="3816670">[</span><span class="num" id="3816671">2</span><span class="op" id="3816672">]</span><span class="op" id="3816673">)</span><span class="op" id="3816674">&lt;&lt;</span><span class="num" id="3816676">8</span>&nbsp;<span class="op" id="3816678">|</span>&nbsp;<span class="builtintype" id="3816680">uint32</span><span class="op" id="3816686">(</span><span class="ident" id="3816687">data</span><span class="op" id="3816691">[</span><span class="num" id="3816692">3</span><span class="op" id="3816693">]</span><span class="op" id="3816694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816697">if</span>&nbsp;<span class="builtintype" id="3816700">uint32</span><span class="op" id="3816706">(</span><span class="builtinfunc" id="3816707">len</span><span class="op" id="3816710">(</span><span class="ident" id="3816711">data</span><span class="op" id="3816715">)</span><span class="op" id="3816716">)</span><span class="op" id="3816717">-</span><span class="num" id="3816718">4</span>&nbsp;<span class="op" id="3816720">!=</span>&nbsp;<span class="ident" id="3816723">length</span>&nbsp;<span class="op" id="3816730">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816734">return</span>&nbsp;<span class="builtintype" id="3816741">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816752">numCertTypes</span>&nbsp;<span class="op" id="3816765">:=</span>&nbsp;<span class="builtintype" id="3816768">int</span><span class="op" id="3816771">(</span><span class="ident" id="3816772">data</span><span class="op" id="3816776">[</span><span class="num" id="3816777">4</span><span class="op" id="3816778">]</span><span class="op" id="3816779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816782">data</span>&nbsp;<span class="op" id="3816787">=</span>&nbsp;<span class="ident" id="3816789">data</span><span class="op" id="3816793">[</span><span class="num" id="3816794">5</span><span class="op" id="3816795">:</span><span class="op" id="3816796">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816799">if</span>&nbsp;<span class="ident" id="3816802">numCertTypes</span>&nbsp;<span class="op" id="3816815">==</span>&nbsp;<span class="num" id="3816818">0</span>&nbsp;<span class="op" id="3816820">||</span>&nbsp;<span class="builtinfunc" id="3816823">len</span><span class="op" id="3816826">(</span><span class="ident" id="3816827">data</span><span class="op" id="3816831">)</span>&nbsp;<span class="op" id="3816833">&lt;=</span>&nbsp;<span class="ident" id="3816836">numCertTypes</span>&nbsp;<span class="op" id="3816849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816853">return</span>&nbsp;<span class="builtintype" id="3816860">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816871">m</span><span class="op" id="3816872">.</span><span class="ident" id="3816873">certificateTypes</span>&nbsp;<span class="op" id="3816890">=</span>&nbsp;<span class="builtinfunc" id="3816892">make</span><span class="op" id="3816896">(</span><span class="op" id="3816897">[</span><span class="op" id="3816898">]</span><span class="builtintype" id="3816899">byte</span><span class="op" id="3816903">,</span>&nbsp;<span class="ident" id="3816905">numCertTypes</span><span class="op" id="3816917">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816920">if</span>&nbsp;<span class="builtinfunc" id="3816923">copy</span><span class="op" id="3816927">(</span><span class="ident" id="3816928">m</span><span class="op" id="3816929">.</span><span class="ident" id="3816930">certificateTypes</span><span class="op" id="3816946">,</span>&nbsp;<span class="ident" id="3816948">data</span><span class="op" id="3816952">)</span>&nbsp;<span class="op" id="3816954">!=</span>&nbsp;<span class="ident" id="3816957">numCertTypes</span>&nbsp;<span class="op" id="3816970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3816974">return</span>&nbsp;<span class="builtintype" id="3816981">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816992">data</span>&nbsp;<span class="op" id="3816997">=</span>&nbsp;<span class="ident" id="3816999">data</span><span class="op" id="3817003">[</span><span class="ident" id="3817004">numCertTypes</span><span class="op" id="3817016">:</span><span class="op" id="3817017">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817021">if</span>&nbsp;<span class="ident" id="3817024">m</span><span class="op" id="3817025">.</span><span class="ident" id="3817026">hasSignatureAndHash</span>&nbsp;<span class="op" id="3817046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817050">if</span>&nbsp;<span class="builtinfunc" id="3817053">len</span><span class="op" id="3817056">(</span><span class="ident" id="3817057">data</span><span class="op" id="3817061">)</span>&nbsp;<span class="op" id="3817063">&lt;</span>&nbsp;<span class="num" id="3817065">2</span>&nbsp;<span class="op" id="3817067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817072">return</span>&nbsp;<span class="builtintype" id="3817079">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3817087">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817091">sigAndHashLen</span>&nbsp;<span class="op" id="3817105">:=</span>&nbsp;<span class="builtintype" id="3817108">uint16</span><span class="op" id="3817114">(</span><span class="ident" id="3817115">data</span><span class="op" id="3817119">[</span><span class="num" id="3817120">0</span><span class="op" id="3817121">]</span><span class="op" id="3817122">)</span><span class="op" id="3817123">&lt;&lt;</span><span class="num" id="3817125">8</span>&nbsp;<span class="op" id="3817127">|</span>&nbsp;<span class="builtintype" id="3817129">uint16</span><span class="op" id="3817135">(</span><span class="ident" id="3817136">data</span><span class="op" id="3817140">[</span><span class="num" id="3817141">1</span><span class="op" id="3817142">]</span><span class="op" id="3817143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817147">data</span>&nbsp;<span class="op" id="3817152">=</span>&nbsp;<span class="ident" id="3817154">data</span><span class="op" id="3817158">[</span><span class="num" id="3817159">2</span><span class="op" id="3817160">:</span><span class="op" id="3817161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817165">if</span>&nbsp;<span class="ident" id="3817168">sigAndHashLen</span><span class="op" id="3817181">&amp;</span><span class="num" id="3817182">1</span>&nbsp;<span class="op" id="3817184">!=</span>&nbsp;<span class="num" id="3817187">0</span>&nbsp;<span class="op" id="3817189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817194">return</span>&nbsp;<span class="builtintype" id="3817201">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3817209">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817213">if</span>&nbsp;<span class="builtinfunc" id="3817216">len</span><span class="op" id="3817219">(</span><span class="ident" id="3817220">data</span><span class="op" id="3817224">)</span>&nbsp;<span class="op" id="3817226">&lt;</span>&nbsp;<span class="builtintype" id="3817228">int</span><span class="op" id="3817231">(</span><span class="ident" id="3817232">sigAndHashLen</span><span class="op" id="3817245">)</span>&nbsp;<span class="op" id="3817247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817252">return</span>&nbsp;<span class="builtintype" id="3817259">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3817267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817271">numSigAndHash</span>&nbsp;<span class="op" id="3817285">:=</span>&nbsp;<span class="ident" id="3817288">sigAndHashLen</span>&nbsp;<span class="op" id="3817302">/</span>&nbsp;<span class="num" id="3817304">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817308">m</span><span class="op" id="3817309">.</span><span class="ident" id="3817310">signatureAndHashes</span>&nbsp;<span class="op" id="3817329">=</span>&nbsp;<span class="builtinfunc" id="3817331">make</span><span class="op" id="3817335">(</span><span class="op" id="3817336">[</span><span class="op" id="3817337">]</span><span class="ident" id="3817338">signatureAndHash</span><span class="op" id="3817354">,</span>&nbsp;<span class="ident" id="3817356">numSigAndHash</span><span class="op" id="3817369">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817373">for</span>&nbsp;<span class="ident" id="3817377">i</span>&nbsp;<span class="op" id="3817379">:=</span>&nbsp;<span class="keyword" id="3817382">range</span>&nbsp;<span class="ident" id="3817388">m</span><span class="op" id="3817389">.</span><span class="ident" id="3817390">signatureAndHashes</span>&nbsp;<span class="op" id="3817409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817414">m</span><span class="op" id="3817415">.</span><span class="ident" id="3817416">signatureAndHashes</span><span class="op" id="3817434">[</span><span class="ident" id="3817435">i</span><span class="op" id="3817436">]</span><span class="op" id="3817437">.</span><span class="ident" id="3817438">hash</span>&nbsp;<span class="op" id="3817443">=</span>&nbsp;<span class="ident" id="3817445">data</span><span class="op" id="3817449">[</span><span class="num" id="3817450">0</span><span class="op" id="3817451">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817456">m</span><span class="op" id="3817457">.</span><span class="ident" id="3817458">signatureAndHashes</span><span class="op" id="3817476">[</span><span class="ident" id="3817477">i</span><span class="op" id="3817478">]</span><span class="op" id="3817479">.</span><span class="ident" id="3817480">signature</span>&nbsp;<span class="op" id="3817490">=</span>&nbsp;<span class="ident" id="3817492">data</span><span class="op" id="3817496">[</span><span class="num" id="3817497">1</span><span class="op" id="3817498">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817503">data</span>&nbsp;<span class="op" id="3817508">=</span>&nbsp;<span class="ident" id="3817510">data</span><span class="op" id="3817514">[</span><span class="num" id="3817515">2</span><span class="op" id="3817516">:</span><span class="op" id="3817517">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3817521">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3817524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817528">if</span>&nbsp;<span class="builtinfunc" id="3817531">len</span><span class="op" id="3817534">(</span><span class="ident" id="3817535">data</span><span class="op" id="3817539">)</span>&nbsp;<span class="op" id="3817541">&lt;</span>&nbsp;<span class="num" id="3817543">2</span>&nbsp;<span class="op" id="3817545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817549">return</span>&nbsp;<span class="builtintype" id="3817556">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3817563">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817566">casLength</span>&nbsp;<span class="op" id="3817576">:=</span>&nbsp;<span class="builtintype" id="3817579">uint16</span><span class="op" id="3817585">(</span><span class="ident" id="3817586">data</span><span class="op" id="3817590">[</span><span class="num" id="3817591">0</span><span class="op" id="3817592">]</span><span class="op" id="3817593">)</span><span class="op" id="3817594">&lt;&lt;</span><span class="num" id="3817596">8</span>&nbsp;<span class="op" id="3817598">|</span>&nbsp;<span class="builtintype" id="3817600">uint16</span><span class="op" id="3817606">(</span><span class="ident" id="3817607">data</span><span class="op" id="3817611">[</span><span class="num" id="3817612">1</span><span class="op" id="3817613">]</span><span class="op" id="3817614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817617">data</span>&nbsp;<span class="op" id="3817622">=</span>&nbsp;<span class="ident" id="3817624">data</span><span class="op" id="3817628">[</span><span class="num" id="3817629">2</span><span class="op" id="3817630">:</span><span class="op" id="3817631">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817634">if</span>&nbsp;<span class="builtinfunc" id="3817637">len</span><span class="op" id="3817640">(</span><span class="ident" id="3817641">data</span><span class="op" id="3817645">)</span>&nbsp;<span class="op" id="3817647">&lt;</span>&nbsp;<span class="builtintype" id="3817649">int</span><span class="op" id="3817652">(</span><span class="ident" id="3817653">casLength</span><span class="op" id="3817662">)</span>&nbsp;<span class="op" id="3817664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817668">return</span>&nbsp;<span class="builtintype" id="3817675">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3817682">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817685">cas</span>&nbsp;<span class="op" id="3817689">:=</span>&nbsp;<span class="builtinfunc" id="3817692">make</span><span class="op" id="3817696">(</span><span class="op" id="3817697">[</span><span class="op" id="3817698">]</span><span class="builtintype" id="3817699">byte</span><span class="op" id="3817703">,</span>&nbsp;<span class="ident" id="3817705">casLength</span><span class="op" id="3817714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3817717">copy</span><span class="op" id="3817721">(</span><span class="ident" id="3817722">cas</span><span class="op" id="3817725">,</span>&nbsp;<span class="ident" id="3817727">data</span><span class="op" id="3817731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817734">data</span>&nbsp;<span class="op" id="3817739">=</span>&nbsp;<span class="ident" id="3817741">data</span><span class="op" id="3817745">[</span><span class="ident" id="3817746">casLength</span><span class="op" id="3817755">:</span><span class="op" id="3817756">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817760">m</span><span class="op" id="3817761">.</span><span class="ident" id="3817762">certificateAuthorities</span>&nbsp;<span class="op" id="3817785">=</span>&nbsp;<span class="builtintype" id="3817787">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817792">for</span>&nbsp;<span class="builtinfunc" id="3817796">len</span><span class="op" id="3817799">(</span><span class="ident" id="3817800">cas</span><span class="op" id="3817803">)</span>&nbsp;<span class="op" id="3817805">&gt;</span>&nbsp;<span class="num" id="3817807">0</span>&nbsp;<span class="op" id="3817809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817813">if</span>&nbsp;<span class="builtinfunc" id="3817816">len</span><span class="op" id="3817819">(</span><span class="ident" id="3817820">cas</span><span class="op" id="3817823">)</span>&nbsp;<span class="op" id="3817825">&lt;</span>&nbsp;<span class="num" id="3817827">2</span>&nbsp;<span class="op" id="3817829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817834">return</span>&nbsp;<span class="builtintype" id="3817841">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3817849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817853">caLen</span>&nbsp;<span class="op" id="3817859">:=</span>&nbsp;<span class="builtintype" id="3817862">uint16</span><span class="op" id="3817868">(</span><span class="ident" id="3817869">cas</span><span class="op" id="3817872">[</span><span class="num" id="3817873">0</span><span class="op" id="3817874">]</span><span class="op" id="3817875">)</span><span class="op" id="3817876">&lt;&lt;</span><span class="num" id="3817878">8</span>&nbsp;<span class="op" id="3817880">|</span>&nbsp;<span class="builtintype" id="3817882">uint16</span><span class="op" id="3817888">(</span><span class="ident" id="3817889">cas</span><span class="op" id="3817892">[</span><span class="num" id="3817893">1</span><span class="op" id="3817894">]</span><span class="op" id="3817895">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817899">cas</span>&nbsp;<span class="op" id="3817903">=</span>&nbsp;<span class="ident" id="3817905">cas</span><span class="op" id="3817908">[</span><span class="num" id="3817909">2</span><span class="op" id="3817910">:</span><span class="op" id="3817911">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817916">if</span>&nbsp;<span class="builtinfunc" id="3817919">len</span><span class="op" id="3817922">(</span><span class="ident" id="3817923">cas</span><span class="op" id="3817926">)</span>&nbsp;<span class="op" id="3817928">&lt;</span>&nbsp;<span class="builtintype" id="3817930">int</span><span class="op" id="3817933">(</span><span class="ident" id="3817934">caLen</span><span class="op" id="3817939">)</span>&nbsp;<span class="op" id="3817941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3817946">return</span>&nbsp;<span class="builtintype" id="3817953">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3817961">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817966">m</span><span class="op" id="3817967">.</span><span class="ident" id="3817968">certificateAuthorities</span>&nbsp;<span class="op" id="3817991">=</span>&nbsp;<span class="builtinfunc" id="3817993">append</span><span class="op" id="3817999">(</span><span class="ident" id="3818000">m</span><span class="op" id="3818001">.</span><span class="ident" id="3818002">certificateAuthorities</span><span class="op" id="3818024">,</span>&nbsp;<span class="ident" id="3818026">cas</span><span class="op" id="3818029">[</span><span class="op" id="3818030">:</span><span class="ident" id="3818031">caLen</span><span class="op" id="3818036">]</span><span class="op" id="3818037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818041">cas</span>&nbsp;<span class="op" id="3818045">=</span>&nbsp;<span class="ident" id="3818047">cas</span><span class="op" id="3818050">[</span><span class="ident" id="3818051">caLen</span><span class="op" id="3818056">:</span><span class="op" id="3818057">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3818060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3818063">if</span>&nbsp;<span class="builtinfunc" id="3818066">len</span><span class="op" id="3818069">(</span><span class="ident" id="3818070">data</span><span class="op" id="3818074">)</span>&nbsp;<span class="op" id="3818076">&gt;</span>&nbsp;<span class="num" id="3818078">0</span>&nbsp;<span class="op" id="3818080">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3818084">return</span>&nbsp;<span class="builtintype" id="3818091">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3818098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3818102">return</span>&nbsp;<span class="builtintype" id="3818109">true</span><br>
<span class="lineno"></span><span class="op" id="3818114">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="3818117">type</span>&nbsp;<span class="ident" id="3818122">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="3818143">struct</span>&nbsp;<span class="op" id="3818150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818153">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3818173">[</span><span class="op" id="3818174">]</span><span class="builtintype" id="3818175">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818181">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3818201">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818207">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818227">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818245">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3818265">[</span><span class="op" id="3818266">]</span><span class="builtintype" id="3818267">byte</span><br>
<span class="lineno"></span><span class="op" id="3818272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3818275">func</span>&nbsp;<span class="op" id="3818280">(</span><span class="ident" id="3818281">m</span>&nbsp;<span class="op" id="3818283">*</span><span class="ident" id="3818284">certificateVerifyMsg</span><span class="op" id="3818304">)</span>&nbsp;<span class="ident" id="3818306">equal</span><span class="op" id="3818311">(</span><span class="ident" id="3818312">i</span>&nbsp;<span class="keyword" id="3818314">interface</span><span class="op" id="3818323">{</span><span class="op" id="3818324">}</span><span class="op" id="3818325">)</span>&nbsp;<span class="builtintype" id="3818327">bool</span>&nbsp;<span class="op" id="3818332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818335">m1</span><span class="op" id="3818337">,</span>&nbsp;<span class="ident" id="3818339">ok</span>&nbsp;<span class="op" id="3818342">:=</span>&nbsp;<span class="ident" id="3818345">i</span><span class="op" id="3818346">.</span><span class="op" id="3818347">(</span><span class="op" id="3818348">*</span><span class="ident" id="3818349">certificateVerifyMsg</span><span class="op" id="3818369">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3818372">if</span>&nbsp;<span class="op" id="3818375">!</span><span class="ident" id="3818376">ok</span>&nbsp;<span class="op" id="3818379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3818383">return</span>&nbsp;<span class="builtintype" id="3818390">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3818397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3818401">return</span>&nbsp;<span class="ident" id="3818408">bytes</span><span class="op" id="3818413">.</span><span class="ident" id="3818414">Equal</span><span class="op" id="3818419">(</span><span class="ident" id="3818420">m</span><span class="op" id="3818421">.</span><span class="ident" id="3818422">raw</span><span class="op" id="3818425">,</span>&nbsp;<span class="ident" id="3818427">m1</span><span class="op" id="3818429">.</span><span class="ident" id="3818430">raw</span><span class="op" id="3818433">)</span>&nbsp;<span class="op" id="3818435">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818440">m</span><span class="op" id="3818441">.</span><span class="ident" id="3818442">hasSignatureAndHash</span>&nbsp;<span class="op" id="3818462">==</span>&nbsp;<span class="ident" id="3818465">m1</span><span class="op" id="3818467">.</span><span class="ident" id="3818468">hasSignatureAndHash</span>&nbsp;<span class="op" id="3818488">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818493">m</span><span class="op" id="3818494">.</span><span class="ident" id="3818495">signatureAndHash</span><span class="op" id="3818511">.</span><span class="ident" id="3818512">hash</span>&nbsp;<span class="op" id="3818517">==</span>&nbsp;<span class="ident" id="3818520">m1</span><span class="op" id="3818522">.</span><span class="ident" id="3818523">signatureAndHash</span><span class="op" id="3818539">.</span><span class="ident" id="3818540">hash</span>&nbsp;<span class="op" id="3818545">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818550">m</span><span class="op" id="3818551">.</span><span class="ident" id="3818552">signatureAndHash</span><span class="op" id="3818568">.</span><span class="ident" id="3818569">signature</span>&nbsp;<span class="op" id="3818579">==</span>&nbsp;<span class="ident" id="3818582">m1</span><span class="op" id="3818584">.</span><span class="ident" id="3818585">signatureAndHash</span><span class="op" id="3818601">.</span><span class="ident" id="3818602">signature</span>&nbsp;<span class="op" id="3818612">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818617">bytes</span><span class="op" id="3818622">.</span><span class="ident" id="3818623">Equal</span><span class="op" id="3818628">(</span><span class="ident" id="3818629">m</span><span class="op" id="3818630">.</span><span class="ident" id="3818631">signature</span><span class="op" id="3818640">,</span>&nbsp;<span class="ident" id="3818642">m1</span><span class="op" id="3818644">.</span><span class="ident" id="3818645">signature</span><span class="op" id="3818654">)</span><br>
<span class="lineno"></span><span class="op" id="3818656">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="3818659">func</span>&nbsp;<span class="op" id="3818664">(</span><span class="ident" id="3818665">m</span>&nbsp;<span class="op" id="3818667">*</span><span class="ident" id="3818668">certificateVerifyMsg</span><span class="op" id="3818688">)</span>&nbsp;<span class="ident" id="3818690">marshal</span><span class="op" id="3818697">(</span><span class="op" id="3818698">)</span>&nbsp;<span class="op" id="3818700">(</span><span class="ident" id="3818701">x</span>&nbsp;<span class="op" id="3818703">[</span><span class="op" id="3818704">]</span><span class="builtintype" id="3818705">byte</span><span class="op" id="3818709">)</span>&nbsp;<span class="op" id="3818711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3818714">if</span>&nbsp;<span class="ident" id="3818717">m</span><span class="op" id="3818718">.</span><span class="ident" id="3818719">raw</span>&nbsp;<span class="op" id="3818723">!=</span>&nbsp;<span class="builtintype" id="3818726">nil</span>&nbsp;<span class="op" id="3818730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3818734">return</span>&nbsp;<span class="ident" id="3818741">m</span><span class="op" id="3818742">.</span><span class="ident" id="3818743">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3818748">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3818752">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818809">siglength</span>&nbsp;<span class="op" id="3818819">:=</span>&nbsp;<span class="builtinfunc" id="3818822">len</span><span class="op" id="3818825">(</span><span class="ident" id="3818826">m</span><span class="op" id="3818827">.</span><span class="ident" id="3818828">signature</span><span class="op" id="3818837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818840">length</span>&nbsp;<span class="op" id="3818847">:=</span>&nbsp;<span class="num" id="3818850">2</span>&nbsp;<span class="op" id="3818852">+</span>&nbsp;<span class="ident" id="3818854">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3818865">if</span>&nbsp;<span class="ident" id="3818868">m</span><span class="op" id="3818869">.</span><span class="ident" id="3818870">hasSignatureAndHash</span>&nbsp;<span class="op" id="3818890">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818894">length</span>&nbsp;<span class="op" id="3818901">+=</span>&nbsp;<span class="num" id="3818904">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3818907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818910">x</span>&nbsp;<span class="op" id="3818912">=</span>&nbsp;<span class="builtinfunc" id="3818914">make</span><span class="op" id="3818918">(</span><span class="op" id="3818919">[</span><span class="op" id="3818920">]</span><span class="builtintype" id="3818921">byte</span><span class="op" id="3818925">,</span>&nbsp;<span class="num" id="3818927">4</span><span class="op" id="3818928">+</span><span class="ident" id="3818929">length</span><span class="op" id="3818935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818938">x</span><span class="op" id="3818939">[</span><span class="num" id="3818940">0</span><span class="op" id="3818941">]</span>&nbsp;<span class="op" id="3818943">=</span>&nbsp;<span class="ident" id="3818945">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818968">x</span><span class="op" id="3818969">[</span><span class="num" id="3818970">1</span><span class="op" id="3818971">]</span>&nbsp;<span class="op" id="3818973">=</span>&nbsp;<span class="builtintype" id="3818975">uint8</span><span class="op" id="3818980">(</span><span class="ident" id="3818981">length</span>&nbsp;<span class="op" id="3818988">&gt;&gt;</span>&nbsp;<span class="num" id="3818991">16</span><span class="op" id="3818993">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3818996">x</span><span class="op" id="3818997">[</span><span class="num" id="3818998">2</span><span class="op" id="3818999">]</span>&nbsp;<span class="op" id="3819001">=</span>&nbsp;<span class="builtintype" id="3819003">uint8</span><span class="op" id="3819008">(</span><span class="ident" id="3819009">length</span>&nbsp;<span class="op" id="3819016">&gt;&gt;</span>&nbsp;<span class="num" id="3819019">8</span><span class="op" id="3819020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819023">x</span><span class="op" id="3819024">[</span><span class="num" id="3819025">3</span><span class="op" id="3819026">]</span>&nbsp;<span class="op" id="3819028">=</span>&nbsp;<span class="builtintype" id="3819030">uint8</span><span class="op" id="3819035">(</span><span class="ident" id="3819036">length</span><span class="op" id="3819042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819045">y</span>&nbsp;<span class="op" id="3819047">:=</span>&nbsp;<span class="ident" id="3819050">x</span><span class="op" id="3819051">[</span><span class="num" id="3819052">4</span><span class="op" id="3819053">:</span><span class="op" id="3819054">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819057">if</span>&nbsp;<span class="ident" id="3819060">m</span><span class="op" id="3819061">.</span><span class="ident" id="3819062">hasSignatureAndHash</span>&nbsp;<span class="op" id="3819082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819086">y</span><span class="op" id="3819087">[</span><span class="num" id="3819088">0</span><span class="op" id="3819089">]</span>&nbsp;<span class="op" id="3819091">=</span>&nbsp;<span class="ident" id="3819093">m</span><span class="op" id="3819094">.</span><span class="ident" id="3819095">signatureAndHash</span><span class="op" id="3819111">.</span><span class="ident" id="3819112">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819119">y</span><span class="op" id="3819120">[</span><span class="num" id="3819121">1</span><span class="op" id="3819122">]</span>&nbsp;<span class="op" id="3819124">=</span>&nbsp;<span class="ident" id="3819126">m</span><span class="op" id="3819127">.</span><span class="ident" id="3819128">signatureAndHash</span><span class="op" id="3819144">.</span><span class="ident" id="3819145">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819157">y</span>&nbsp;<span class="op" id="3819159">=</span>&nbsp;<span class="ident" id="3819161">y</span><span class="op" id="3819162">[</span><span class="num" id="3819163">2</span><span class="op" id="3819164">:</span><span class="op" id="3819165">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3819168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819171">y</span><span class="op" id="3819172">[</span><span class="num" id="3819173">0</span><span class="op" id="3819174">]</span>&nbsp;<span class="op" id="3819176">=</span>&nbsp;<span class="builtintype" id="3819178">uint8</span><span class="op" id="3819183">(</span><span class="ident" id="3819184">siglength</span>&nbsp;<span class="op" id="3819194">&gt;&gt;</span>&nbsp;<span class="num" id="3819197">8</span><span class="op" id="3819198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819201">y</span><span class="op" id="3819202">[</span><span class="num" id="3819203">1</span><span class="op" id="3819204">]</span>&nbsp;<span class="op" id="3819206">=</span>&nbsp;<span class="builtintype" id="3819208">uint8</span><span class="op" id="3819213">(</span><span class="ident" id="3819214">siglength</span><span class="op" id="3819223">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3819226">copy</span><span class="op" id="3819230">(</span><span class="ident" id="3819231">y</span><span class="op" id="3819232">[</span><span class="num" id="3819233">2</span><span class="op" id="3819234">:</span><span class="op" id="3819235">]</span><span class="op" id="3819236">,</span>&nbsp;<span class="ident" id="3819238">m</span><span class="op" id="3819239">.</span><span class="ident" id="3819240">signature</span><span class="op" id="3819249">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819253">m</span><span class="op" id="3819254">.</span><span class="ident" id="3819255">raw</span>&nbsp;<span class="op" id="3819259">=</span>&nbsp;<span class="ident" id="3819261">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819265">return</span><br>
<span class="lineno">1285</span><span class="op" id="3819272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3819275">func</span>&nbsp;<span class="op" id="3819280">(</span><span class="ident" id="3819281">m</span>&nbsp;<span class="op" id="3819283">*</span><span class="ident" id="3819284">certificateVerifyMsg</span><span class="op" id="3819304">)</span>&nbsp;<span class="ident" id="3819306">unmarshal</span><span class="op" id="3819315">(</span><span class="ident" id="3819316">data</span>&nbsp;<span class="op" id="3819321">[</span><span class="op" id="3819322">]</span><span class="builtintype" id="3819323">byte</span><span class="op" id="3819327">)</span>&nbsp;<span class="builtintype" id="3819329">bool</span>&nbsp;<span class="op" id="3819334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819337">m</span><span class="op" id="3819338">.</span><span class="ident" id="3819339">raw</span>&nbsp;<span class="op" id="3819343">=</span>&nbsp;<span class="ident" id="3819345">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819352">if</span>&nbsp;<span class="builtinfunc" id="3819355">len</span><span class="op" id="3819358">(</span><span class="ident" id="3819359">data</span><span class="op" id="3819363">)</span>&nbsp;<span class="op" id="3819365">&lt;</span>&nbsp;<span class="num" id="3819367">6</span>&nbsp;<span class="op" id="3819369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819373">return</span>&nbsp;<span class="builtintype" id="3819380">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3819387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819391">length</span>&nbsp;<span class="op" id="3819398">:=</span>&nbsp;<span class="builtintype" id="3819401">uint32</span><span class="op" id="3819407">(</span><span class="ident" id="3819408">data</span><span class="op" id="3819412">[</span><span class="num" id="3819413">1</span><span class="op" id="3819414">]</span><span class="op" id="3819415">)</span><span class="op" id="3819416">&lt;&lt;</span><span class="num" id="3819418">16</span>&nbsp;<span class="op" id="3819421">|</span>&nbsp;<span class="builtintype" id="3819423">uint32</span><span class="op" id="3819429">(</span><span class="ident" id="3819430">data</span><span class="op" id="3819434">[</span><span class="num" id="3819435">2</span><span class="op" id="3819436">]</span><span class="op" id="3819437">)</span><span class="op" id="3819438">&lt;&lt;</span><span class="num" id="3819440">8</span>&nbsp;<span class="op" id="3819442">|</span>&nbsp;<span class="builtintype" id="3819444">uint32</span><span class="op" id="3819450">(</span><span class="ident" id="3819451">data</span><span class="op" id="3819455">[</span><span class="num" id="3819456">3</span><span class="op" id="3819457">]</span><span class="op" id="3819458">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819461">if</span>&nbsp;<span class="builtintype" id="3819464">uint32</span><span class="op" id="3819470">(</span><span class="builtinfunc" id="3819471">len</span><span class="op" id="3819474">(</span><span class="ident" id="3819475">data</span><span class="op" id="3819479">)</span><span class="op" id="3819480">)</span><span class="op" id="3819481">-</span><span class="num" id="3819482">4</span>&nbsp;<span class="op" id="3819484">!=</span>&nbsp;<span class="ident" id="3819487">length</span>&nbsp;<span class="op" id="3819494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819498">return</span>&nbsp;<span class="builtintype" id="3819505">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3819512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819516">data</span>&nbsp;<span class="op" id="3819521">=</span>&nbsp;<span class="ident" id="3819523">data</span><span class="op" id="3819527">[</span><span class="num" id="3819528">4</span><span class="op" id="3819529">:</span><span class="op" id="3819530">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819533">if</span>&nbsp;<span class="ident" id="3819536">m</span><span class="op" id="3819537">.</span><span class="ident" id="3819538">hasSignatureAndHash</span>&nbsp;<span class="op" id="3819558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819562">m</span><span class="op" id="3819563">.</span><span class="ident" id="3819564">signatureAndHash</span><span class="op" id="3819580">.</span><span class="ident" id="3819581">hash</span>&nbsp;<span class="op" id="3819586">=</span>&nbsp;<span class="ident" id="3819588">data</span><span class="op" id="3819592">[</span><span class="num" id="3819593">0</span><span class="op" id="3819594">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819598">m</span><span class="op" id="3819599">.</span><span class="ident" id="3819600">signatureAndHash</span><span class="op" id="3819616">.</span><span class="ident" id="3819617">signature</span>&nbsp;<span class="op" id="3819627">=</span>&nbsp;<span class="ident" id="3819629">data</span><span class="op" id="3819633">[</span><span class="num" id="3819634">1</span><span class="op" id="3819635">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819639">data</span>&nbsp;<span class="op" id="3819644">=</span>&nbsp;<span class="ident" id="3819646">data</span><span class="op" id="3819650">[</span><span class="num" id="3819651">2</span><span class="op" id="3819652">:</span><span class="op" id="3819653">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3819656">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819660">if</span>&nbsp;<span class="builtinfunc" id="3819663">len</span><span class="op" id="3819666">(</span><span class="ident" id="3819667">data</span><span class="op" id="3819671">)</span>&nbsp;<span class="op" id="3819673">&lt;</span>&nbsp;<span class="num" id="3819675">2</span>&nbsp;<span class="op" id="3819677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819681">return</span>&nbsp;<span class="builtintype" id="3819688">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3819695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819698">siglength</span>&nbsp;<span class="op" id="3819708">:=</span>&nbsp;<span class="builtintype" id="3819711">int</span><span class="op" id="3819714">(</span><span class="ident" id="3819715">data</span><span class="op" id="3819719">[</span><span class="num" id="3819720">0</span><span class="op" id="3819721">]</span><span class="op" id="3819722">)</span><span class="op" id="3819723">&lt;&lt;</span><span class="num" id="3819725">8</span>&nbsp;<span class="op" id="3819727">+</span>&nbsp;<span class="builtintype" id="3819729">int</span><span class="op" id="3819732">(</span><span class="ident" id="3819733">data</span><span class="op" id="3819737">[</span><span class="num" id="3819738">1</span><span class="op" id="3819739">]</span><span class="op" id="3819740">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819743">data</span>&nbsp;<span class="op" id="3819748">=</span>&nbsp;<span class="ident" id="3819750">data</span><span class="op" id="3819754">[</span><span class="num" id="3819755">2</span><span class="op" id="3819756">:</span><span class="op" id="3819757">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819760">if</span>&nbsp;<span class="builtinfunc" id="3819763">len</span><span class="op" id="3819766">(</span><span class="ident" id="3819767">data</span><span class="op" id="3819771">)</span>&nbsp;<span class="op" id="3819773">!=</span>&nbsp;<span class="ident" id="3819776">siglength</span>&nbsp;<span class="op" id="3819786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819790">return</span>&nbsp;<span class="builtintype" id="3819797">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3819804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819808">m</span><span class="op" id="3819809">.</span><span class="ident" id="3819810">signature</span>&nbsp;<span class="op" id="3819820">=</span>&nbsp;<span class="ident" id="3819822">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3819829">return</span>&nbsp;<span class="builtintype" id="3819836">true</span><br>
<span class="lineno"></span><span class="op" id="3819841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="3819844">type</span>&nbsp;<span class="ident" id="3819849">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="3819869">struct</span>&nbsp;<span class="op" id="3819876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819879">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3819886">[</span><span class="op" id="3819887">]</span><span class="builtintype" id="3819888">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819894">ticket</span>&nbsp;<span class="op" id="3819901">[</span><span class="op" id="3819902">]</span><span class="builtintype" id="3819903">byte</span><br>
<span class="lineno"></span><span class="op" id="3819908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="3819911">func</span>&nbsp;<span class="op" id="3819916">(</span><span class="ident" id="3819917">m</span>&nbsp;<span class="op" id="3819919">*</span><span class="ident" id="3819920">newSessionTicketMsg</span><span class="op" id="3819939">)</span>&nbsp;<span class="ident" id="3819941">equal</span><span class="op" id="3819946">(</span><span class="ident" id="3819947">i</span>&nbsp;<span class="keyword" id="3819949">interface</span><span class="op" id="3819958">{</span><span class="op" id="3819959">}</span><span class="op" id="3819960">)</span>&nbsp;<span class="builtintype" id="3819962">bool</span>&nbsp;<span class="op" id="3819967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3819970">m1</span><span class="op" id="3819972">,</span>&nbsp;<span class="ident" id="3819974">ok</span>&nbsp;<span class="op" id="3819977">:=</span>&nbsp;<span class="ident" id="3819980">i</span><span class="op" id="3819981">.</span><span class="op" id="3819982">(</span><span class="op" id="3819983">*</span><span class="ident" id="3819984">newSessionTicketMsg</span><span class="op" id="3820003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820006">if</span>&nbsp;<span class="op" id="3820009">!</span><span class="ident" id="3820010">ok</span>&nbsp;<span class="op" id="3820013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820017">return</span>&nbsp;<span class="builtintype" id="3820024">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3820031">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820035">return</span>&nbsp;<span class="ident" id="3820042">bytes</span><span class="op" id="3820047">.</span><span class="ident" id="3820048">Equal</span><span class="op" id="3820053">(</span><span class="ident" id="3820054">m</span><span class="op" id="3820055">.</span><span class="ident" id="3820056">raw</span><span class="op" id="3820059">,</span>&nbsp;<span class="ident" id="3820061">m1</span><span class="op" id="3820063">.</span><span class="ident" id="3820064">raw</span><span class="op" id="3820067">)</span>&nbsp;<span class="op" id="3820069">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820074">bytes</span><span class="op" id="3820079">.</span><span class="ident" id="3820080">Equal</span><span class="op" id="3820085">(</span><span class="ident" id="3820086">m</span><span class="op" id="3820087">.</span><span class="ident" id="3820088">ticket</span><span class="op" id="3820094">,</span>&nbsp;<span class="ident" id="3820096">m1</span><span class="op" id="3820098">.</span><span class="ident" id="3820099">ticket</span><span class="op" id="3820105">)</span><br>
<span class="lineno"></span><span class="op" id="3820107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="3820110">func</span>&nbsp;<span class="op" id="3820115">(</span><span class="ident" id="3820116">m</span>&nbsp;<span class="op" id="3820118">*</span><span class="ident" id="3820119">newSessionTicketMsg</span><span class="op" id="3820138">)</span>&nbsp;<span class="ident" id="3820140">marshal</span><span class="op" id="3820147">(</span><span class="op" id="3820148">)</span>&nbsp;<span class="op" id="3820150">(</span><span class="ident" id="3820151">x</span>&nbsp;<span class="op" id="3820153">[</span><span class="op" id="3820154">]</span><span class="builtintype" id="3820155">byte</span><span class="op" id="3820159">)</span>&nbsp;<span class="op" id="3820161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820164">if</span>&nbsp;<span class="ident" id="3820167">m</span><span class="op" id="3820168">.</span><span class="ident" id="3820169">raw</span>&nbsp;<span class="op" id="3820173">!=</span>&nbsp;<span class="builtintype" id="3820176">nil</span>&nbsp;<span class="op" id="3820180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820184">return</span>&nbsp;<span class="ident" id="3820191">m</span><span class="op" id="3820192">.</span><span class="ident" id="3820193">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3820198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3820202">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820257">ticketLen</span>&nbsp;<span class="op" id="3820267">:=</span>&nbsp;<span class="builtinfunc" id="3820270">len</span><span class="op" id="3820273">(</span><span class="ident" id="3820274">m</span><span class="op" id="3820275">.</span><span class="ident" id="3820276">ticket</span><span class="op" id="3820282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820285">length</span>&nbsp;<span class="op" id="3820292">:=</span>&nbsp;<span class="num" id="3820295">2</span>&nbsp;<span class="op" id="3820297">+</span>&nbsp;<span class="num" id="3820299">4</span>&nbsp;<span class="op" id="3820301">+</span>&nbsp;<span class="ident" id="3820303">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820314">x</span>&nbsp;<span class="op" id="3820316">=</span>&nbsp;<span class="builtinfunc" id="3820318">make</span><span class="op" id="3820322">(</span><span class="op" id="3820323">[</span><span class="op" id="3820324">]</span><span class="builtintype" id="3820325">byte</span><span class="op" id="3820329">,</span>&nbsp;<span class="num" id="3820331">4</span><span class="op" id="3820332">+</span><span class="ident" id="3820333">length</span><span class="op" id="3820339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820342">x</span><span class="op" id="3820343">[</span><span class="num" id="3820344">0</span><span class="op" id="3820345">]</span>&nbsp;<span class="op" id="3820347">=</span>&nbsp;<span class="ident" id="3820349">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820371">x</span><span class="op" id="3820372">[</span><span class="num" id="3820373">1</span><span class="op" id="3820374">]</span>&nbsp;<span class="op" id="3820376">=</span>&nbsp;<span class="builtintype" id="3820378">uint8</span><span class="op" id="3820383">(</span><span class="ident" id="3820384">length</span>&nbsp;<span class="op" id="3820391">&gt;&gt;</span>&nbsp;<span class="num" id="3820394">16</span><span class="op" id="3820396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820399">x</span><span class="op" id="3820400">[</span><span class="num" id="3820401">2</span><span class="op" id="3820402">]</span>&nbsp;<span class="op" id="3820404">=</span>&nbsp;<span class="builtintype" id="3820406">uint8</span><span class="op" id="3820411">(</span><span class="ident" id="3820412">length</span>&nbsp;<span class="op" id="3820419">&gt;&gt;</span>&nbsp;<span class="num" id="3820422">8</span><span class="op" id="3820423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820426">x</span><span class="op" id="3820427">[</span><span class="num" id="3820428">3</span><span class="op" id="3820429">]</span>&nbsp;<span class="op" id="3820431">=</span>&nbsp;<span class="builtintype" id="3820433">uint8</span><span class="op" id="3820438">(</span><span class="ident" id="3820439">length</span><span class="op" id="3820445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820448">x</span><span class="op" id="3820449">[</span><span class="num" id="3820450">8</span><span class="op" id="3820451">]</span>&nbsp;<span class="op" id="3820453">=</span>&nbsp;<span class="builtintype" id="3820455">uint8</span><span class="op" id="3820460">(</span><span class="ident" id="3820461">ticketLen</span>&nbsp;<span class="op" id="3820471">&gt;&gt;</span>&nbsp;<span class="num" id="3820474">8</span><span class="op" id="3820475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820478">x</span><span class="op" id="3820479">[</span><span class="num" id="3820480">9</span><span class="op" id="3820481">]</span>&nbsp;<span class="op" id="3820483">=</span>&nbsp;<span class="builtintype" id="3820485">uint8</span><span class="op" id="3820490">(</span><span class="ident" id="3820491">ticketLen</span><span class="op" id="3820500">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3820503">copy</span><span class="op" id="3820507">(</span><span class="ident" id="3820508">x</span><span class="op" id="3820509">[</span><span class="num" id="3820510">10</span><span class="op" id="3820512">:</span><span class="op" id="3820513">]</span><span class="op" id="3820514">,</span>&nbsp;<span class="ident" id="3820516">m</span><span class="op" id="3820517">.</span><span class="ident" id="3820518">ticket</span><span class="op" id="3820524">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820528">m</span><span class="op" id="3820529">.</span><span class="ident" id="3820530">raw</span>&nbsp;<span class="op" id="3820534">=</span>&nbsp;<span class="ident" id="3820536">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820540">return</span><br>
<span class="lineno">1355</span><span class="op" id="3820547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3820550">func</span>&nbsp;<span class="op" id="3820555">(</span><span class="ident" id="3820556">m</span>&nbsp;<span class="op" id="3820558">*</span><span class="ident" id="3820559">newSessionTicketMsg</span><span class="op" id="3820578">)</span>&nbsp;<span class="ident" id="3820580">unmarshal</span><span class="op" id="3820589">(</span><span class="ident" id="3820590">data</span>&nbsp;<span class="op" id="3820595">[</span><span class="op" id="3820596">]</span><span class="builtintype" id="3820597">byte</span><span class="op" id="3820601">)</span>&nbsp;<span class="builtintype" id="3820603">bool</span>&nbsp;<span class="op" id="3820608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820611">m</span><span class="op" id="3820612">.</span><span class="ident" id="3820613">raw</span>&nbsp;<span class="op" id="3820617">=</span>&nbsp;<span class="ident" id="3820619">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820626">if</span>&nbsp;<span class="builtinfunc" id="3820629">len</span><span class="op" id="3820632">(</span><span class="ident" id="3820633">data</span><span class="op" id="3820637">)</span>&nbsp;<span class="op" id="3820639">&lt;</span>&nbsp;<span class="num" id="3820641">10</span>&nbsp;<span class="op" id="3820644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820648">return</span>&nbsp;<span class="builtintype" id="3820655">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3820662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820666">length</span>&nbsp;<span class="op" id="3820673">:=</span>&nbsp;<span class="builtintype" id="3820676">uint32</span><span class="op" id="3820682">(</span><span class="ident" id="3820683">data</span><span class="op" id="3820687">[</span><span class="num" id="3820688">1</span><span class="op" id="3820689">]</span><span class="op" id="3820690">)</span><span class="op" id="3820691">&lt;&lt;</span><span class="num" id="3820693">16</span>&nbsp;<span class="op" id="3820696">|</span>&nbsp;<span class="builtintype" id="3820698">uint32</span><span class="op" id="3820704">(</span><span class="ident" id="3820705">data</span><span class="op" id="3820709">[</span><span class="num" id="3820710">2</span><span class="op" id="3820711">]</span><span class="op" id="3820712">)</span><span class="op" id="3820713">&lt;&lt;</span><span class="num" id="3820715">8</span>&nbsp;<span class="op" id="3820717">|</span>&nbsp;<span class="builtintype" id="3820719">uint32</span><span class="op" id="3820725">(</span><span class="ident" id="3820726">data</span><span class="op" id="3820730">[</span><span class="num" id="3820731">3</span><span class="op" id="3820732">]</span><span class="op" id="3820733">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820736">if</span>&nbsp;<span class="builtintype" id="3820739">uint32</span><span class="op" id="3820745">(</span><span class="builtinfunc" id="3820746">len</span><span class="op" id="3820749">(</span><span class="ident" id="3820750">data</span><span class="op" id="3820754">)</span><span class="op" id="3820755">)</span><span class="op" id="3820756">-</span><span class="num" id="3820757">4</span>&nbsp;<span class="op" id="3820759">!=</span>&nbsp;<span class="ident" id="3820762">length</span>&nbsp;<span class="op" id="3820769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820773">return</span>&nbsp;<span class="builtintype" id="3820780">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3820787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820791">ticketLen</span>&nbsp;<span class="op" id="3820801">:=</span>&nbsp;<span class="builtintype" id="3820804">int</span><span class="op" id="3820807">(</span><span class="ident" id="3820808">data</span><span class="op" id="3820812">[</span><span class="num" id="3820813">8</span><span class="op" id="3820814">]</span><span class="op" id="3820815">)</span><span class="op" id="3820816">&lt;&lt;</span><span class="num" id="3820818">8</span>&nbsp;<span class="op" id="3820820">+</span>&nbsp;<span class="builtintype" id="3820822">int</span><span class="op" id="3820825">(</span><span class="ident" id="3820826">data</span><span class="op" id="3820830">[</span><span class="num" id="3820831">9</span><span class="op" id="3820832">]</span><span class="op" id="3820833">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820836">if</span>&nbsp;<span class="builtinfunc" id="3820839">len</span><span class="op" id="3820842">(</span><span class="ident" id="3820843">data</span><span class="op" id="3820847">)</span><span class="op" id="3820848">-</span><span class="num" id="3820849">10</span>&nbsp;<span class="op" id="3820852">!=</span>&nbsp;<span class="ident" id="3820855">ticketLen</span>&nbsp;<span class="op" id="3820865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820869">return</span>&nbsp;<span class="builtintype" id="3820876">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3820883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3820887">m</span><span class="op" id="3820888">.</span><span class="ident" id="3820889">ticket</span>&nbsp;<span class="op" id="3820896">=</span>&nbsp;<span class="ident" id="3820898">data</span><span class="op" id="3820902">[</span><span class="num" id="3820903">10</span><span class="op" id="3820905">:</span><span class="op" id="3820906">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820910">return</span>&nbsp;<span class="builtintype" id="3820917">true</span><br>
<span class="lineno"></span><span class="op" id="3820922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3820925">func</span>&nbsp;<span class="ident" id="3820930">eqUint16s</span><span class="op" id="3820939">(</span><span class="ident" id="3820940">x</span><span class="op" id="3820941">,</span>&nbsp;<span class="ident" id="3820943">y</span>&nbsp;<span class="op" id="3820945">[</span><span class="op" id="3820946">]</span><span class="builtintype" id="3820947">uint16</span><span class="op" id="3820953">)</span>&nbsp;<span class="builtintype" id="3820955">bool</span>&nbsp;<span class="op" id="3820960">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820963">if</span>&nbsp;<span class="builtinfunc" id="3820966">len</span><span class="op" id="3820969">(</span><span class="ident" id="3820970">x</span><span class="op" id="3820971">)</span>&nbsp;<span class="op" id="3820973">!=</span>&nbsp;<span class="builtinfunc" id="3820976">len</span><span class="op" id="3820979">(</span><span class="ident" id="3820980">y</span><span class="op" id="3820981">)</span>&nbsp;<span class="op" id="3820983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3820987">return</span>&nbsp;<span class="builtintype" id="3820994">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821004">for</span>&nbsp;<span class="ident" id="3821008">i</span><span class="op" id="3821009">,</span>&nbsp;<span class="ident" id="3821011">v</span>&nbsp;<span class="op" id="3821013">:=</span>&nbsp;<span class="keyword" id="3821016">range</span>&nbsp;<span class="ident" id="3821022">x</span>&nbsp;<span class="op" id="3821024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821028">if</span>&nbsp;<span class="ident" id="3821031">y</span><span class="op" id="3821032">[</span><span class="ident" id="3821033">i</span><span class="op" id="3821034">]</span>&nbsp;<span class="op" id="3821036">!=</span>&nbsp;<span class="ident" id="3821039">v</span>&nbsp;<span class="op" id="3821041">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821046">return</span>&nbsp;<span class="builtintype" id="3821053">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821067">return</span>&nbsp;<span class="builtintype" id="3821074">true</span><br>
<span class="lineno"></span><span class="op" id="3821079">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="3821082">func</span>&nbsp;<span class="ident" id="3821087">eqCurveIDs</span><span class="op" id="3821097">(</span><span class="ident" id="3821098">x</span><span class="op" id="3821099">,</span>&nbsp;<span class="ident" id="3821101">y</span>&nbsp;<span class="op" id="3821103">[</span><span class="op" id="3821104">]</span><span class="ident" id="3821105">CurveID</span><span class="op" id="3821112">)</span>&nbsp;<span class="builtintype" id="3821114">bool</span>&nbsp;<span class="op" id="3821119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821122">if</span>&nbsp;<span class="builtinfunc" id="3821125">len</span><span class="op" id="3821128">(</span><span class="ident" id="3821129">x</span><span class="op" id="3821130">)</span>&nbsp;<span class="op" id="3821132">!=</span>&nbsp;<span class="builtinfunc" id="3821135">len</span><span class="op" id="3821138">(</span><span class="ident" id="3821139">y</span><span class="op" id="3821140">)</span>&nbsp;<span class="op" id="3821142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821146">return</span>&nbsp;<span class="builtintype" id="3821153">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821160">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821163">for</span>&nbsp;<span class="ident" id="3821167">i</span><span class="op" id="3821168">,</span>&nbsp;<span class="ident" id="3821170">v</span>&nbsp;<span class="op" id="3821172">:=</span>&nbsp;<span class="keyword" id="3821175">range</span>&nbsp;<span class="ident" id="3821181">x</span>&nbsp;<span class="op" id="3821183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821187">if</span>&nbsp;<span class="ident" id="3821190">y</span><span class="op" id="3821191">[</span><span class="ident" id="3821192">i</span><span class="op" id="3821193">]</span>&nbsp;<span class="op" id="3821195">!=</span>&nbsp;<span class="ident" id="3821198">v</span>&nbsp;<span class="op" id="3821200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821205">return</span>&nbsp;<span class="builtintype" id="3821212">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821223">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821226">return</span>&nbsp;<span class="builtintype" id="3821233">true</span><br>
<span class="lineno"></span><span class="op" id="3821238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3821241">func</span>&nbsp;<span class="ident" id="3821246">eqStrings</span><span class="op" id="3821255">(</span><span class="ident" id="3821256">x</span><span class="op" id="3821257">,</span>&nbsp;<span class="ident" id="3821259">y</span>&nbsp;<span class="op" id="3821261">[</span><span class="op" id="3821262">]</span><span class="builtintype" id="3821263">string</span><span class="op" id="3821269">)</span>&nbsp;<span class="builtintype" id="3821271">bool</span>&nbsp;<span class="op" id="3821276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821279">if</span>&nbsp;<span class="builtinfunc" id="3821282">len</span><span class="op" id="3821285">(</span><span class="ident" id="3821286">x</span><span class="op" id="3821287">)</span>&nbsp;<span class="op" id="3821289">!=</span>&nbsp;<span class="builtinfunc" id="3821292">len</span><span class="op" id="3821295">(</span><span class="ident" id="3821296">y</span><span class="op" id="3821297">)</span>&nbsp;<span class="op" id="3821299">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821303">return</span>&nbsp;<span class="builtintype" id="3821310">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821320">for</span>&nbsp;<span class="ident" id="3821324">i</span><span class="op" id="3821325">,</span>&nbsp;<span class="ident" id="3821327">v</span>&nbsp;<span class="op" id="3821329">:=</span>&nbsp;<span class="keyword" id="3821332">range</span>&nbsp;<span class="ident" id="3821338">x</span>&nbsp;<span class="op" id="3821340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821344">if</span>&nbsp;<span class="ident" id="3821347">y</span><span class="op" id="3821348">[</span><span class="ident" id="3821349">i</span><span class="op" id="3821350">]</span>&nbsp;<span class="op" id="3821352">!=</span>&nbsp;<span class="ident" id="3821355">v</span>&nbsp;<span class="op" id="3821357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821362">return</span>&nbsp;<span class="builtintype" id="3821369">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821383">return</span>&nbsp;<span class="builtintype" id="3821390">true</span><br>
<span class="lineno"></span><span class="op" id="3821395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="3821398">func</span>&nbsp;<span class="ident" id="3821403">eqByteSlices</span><span class="op" id="3821415">(</span><span class="ident" id="3821416">x</span><span class="op" id="3821417">,</span>&nbsp;<span class="ident" id="3821419">y</span>&nbsp;<span class="op" id="3821421">[</span><span class="op" id="3821422">]</span><span class="op" id="3821423">[</span><span class="op" id="3821424">]</span><span class="builtintype" id="3821425">byte</span><span class="op" id="3821429">)</span>&nbsp;<span class="builtintype" id="3821431">bool</span>&nbsp;<span class="op" id="3821436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821439">if</span>&nbsp;<span class="builtinfunc" id="3821442">len</span><span class="op" id="3821445">(</span><span class="ident" id="3821446">x</span><span class="op" id="3821447">)</span>&nbsp;<span class="op" id="3821449">!=</span>&nbsp;<span class="builtinfunc" id="3821452">len</span><span class="op" id="3821455">(</span><span class="ident" id="3821456">y</span><span class="op" id="3821457">)</span>&nbsp;<span class="op" id="3821459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821463">return</span>&nbsp;<span class="builtintype" id="3821470">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821480">for</span>&nbsp;<span class="ident" id="3821484">i</span><span class="op" id="3821485">,</span>&nbsp;<span class="ident" id="3821487">v</span>&nbsp;<span class="op" id="3821489">:=</span>&nbsp;<span class="keyword" id="3821492">range</span>&nbsp;<span class="ident" id="3821498">x</span>&nbsp;<span class="op" id="3821500">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821504">if</span>&nbsp;<span class="op" id="3821507">!</span><span class="ident" id="3821508">bytes</span><span class="op" id="3821513">.</span><span class="ident" id="3821514">Equal</span><span class="op" id="3821519">(</span><span class="ident" id="3821520">v</span><span class="op" id="3821521">,</span>&nbsp;<span class="ident" id="3821523">y</span><span class="op" id="3821524">[</span><span class="ident" id="3821525">i</span><span class="op" id="3821526">]</span><span class="op" id="3821527">)</span>&nbsp;<span class="op" id="3821529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821534">return</span>&nbsp;<span class="builtintype" id="3821541">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821555">return</span>&nbsp;<span class="builtintype" id="3821562">true</span><br>
<span class="lineno">1425</span><span class="op" id="3821567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3821570">func</span>&nbsp;<span class="ident" id="3821575">eqSignatureAndHashes</span><span class="op" id="3821595">(</span><span class="ident" id="3821596">x</span><span class="op" id="3821597">,</span>&nbsp;<span class="ident" id="3821599">y</span>&nbsp;<span class="op" id="3821601">[</span><span class="op" id="3821602">]</span><span class="ident" id="3821603">signatureAndHash</span><span class="op" id="3821619">)</span>&nbsp;<span class="builtintype" id="3821621">bool</span>&nbsp;<span class="op" id="3821626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821629">if</span>&nbsp;<span class="builtinfunc" id="3821632">len</span><span class="op" id="3821635">(</span><span class="ident" id="3821636">x</span><span class="op" id="3821637">)</span>&nbsp;<span class="op" id="3821639">!=</span>&nbsp;<span class="builtinfunc" id="3821642">len</span><span class="op" id="3821645">(</span><span class="ident" id="3821646">y</span><span class="op" id="3821647">)</span>&nbsp;<span class="op" id="3821649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821653">return</span>&nbsp;<span class="builtintype" id="3821660">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821670">for</span>&nbsp;<span class="ident" id="3821674">i</span><span class="op" id="3821675">,</span>&nbsp;<span class="ident" id="3821677">v</span>&nbsp;<span class="op" id="3821679">:=</span>&nbsp;<span class="keyword" id="3821682">range</span>&nbsp;<span class="ident" id="3821688">x</span>&nbsp;<span class="op" id="3821690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3821694">v2</span>&nbsp;<span class="op" id="3821697">:=</span>&nbsp;<span class="ident" id="3821700">y</span><span class="op" id="3821701">[</span><span class="ident" id="3821702">i</span><span class="op" id="3821703">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821707">if</span>&nbsp;<span class="ident" id="3821710">v</span><span class="op" id="3821711">.</span><span class="ident" id="3821712">hash</span>&nbsp;<span class="op" id="3821717">!=</span>&nbsp;<span class="ident" id="3821720">v2</span><span class="op" id="3821722">.</span><span class="ident" id="3821723">hash</span>&nbsp;<span class="op" id="3821728">||</span>&nbsp;<span class="ident" id="3821731">v</span><span class="op" id="3821732">.</span><span class="ident" id="3821733">signature</span>&nbsp;<span class="op" id="3821743">!=</span>&nbsp;<span class="ident" id="3821746">v2</span><span class="op" id="3821748">.</span><span class="ident" id="3821749">signature</span>&nbsp;<span class="op" id="3821759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821764">return</span>&nbsp;<span class="builtintype" id="3821771">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3821782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3821785">return</span>&nbsp;<span class="builtintype" id="3821792">true</span><br>
<span class="lineno"></span><span class="op" id="3821797">}</span>
</div>
</body>
</html>
