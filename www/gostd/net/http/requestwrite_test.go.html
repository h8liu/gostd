<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html" class="current">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7054438">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7054494">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7054548">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7054599">package</span>&nbsp;<span class="ident" id="7054607">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7054613">import</span>&nbsp;<span class="op" id="7054620">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054623">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054632">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054642">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054649">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054655">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054668">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054679">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054690">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7054700">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7054703">type</span>&nbsp;<span class="ident" id="7054708">reqWriteTest</span>&nbsp;<span class="keyword" id="7054721">struct</span>&nbsp;<span class="op" id="7054728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054731">Req</span>&nbsp;&nbsp;<span class="ident" id="7054736">Request</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054745">Body</span>&nbsp;<span class="keyword" id="7054750">interface</span><span class="op" id="7054759">{</span><span class="op" id="7054760">}</span>&nbsp;<span class="comment" id="7054762">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7054828">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054883">WantWrite</span>&nbsp;<span class="builtintype" id="7054893">string</span>&nbsp;<span class="comment" id="7054900">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054918">WantProxy</span>&nbsp;<span class="builtintype" id="7054928">string</span>&nbsp;<span class="comment" id="7054935">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054959">WantError</span>&nbsp;<span class="builtintype" id="7054969">error</span>&nbsp;<span class="comment" id="7054975">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="7055010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7055013">var</span>&nbsp;<span class="ident" id="7055017">reqWriteTests</span>&nbsp;<span class="op" id="7055031">=</span>&nbsp;<span class="op" id="7055033">[</span><span class="op" id="7055034">]</span><span class="ident" id="7055035">reqWriteTest</span><span class="op" id="7055047">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7055050">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055106">Req</span><span class="op" id="7055109">:</span>&nbsp;<span class="ident" id="7055111">Request</span><span class="op" id="7055118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055123">Method</span><span class="op" id="7055129">:</span>&nbsp;<span class="string" id="7055131">&#34;GET&#34;</span><span class="op" id="7055136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055141">URL</span><span class="op" id="7055144">:</span>&nbsp;<span class="op" id="7055146">&amp;</span><span class="ident" id="7055147">url</span><span class="op" id="7055150">.</span><span class="ident" id="7055151">URL</span><span class="op" id="7055154">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055160">Scheme</span><span class="op" id="7055166">:</span>&nbsp;<span class="string" id="7055168">&#34;http&#34;</span><span class="op" id="7055174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055180">Host</span><span class="op" id="7055184">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7055188">&#34;www.techcrunch.com&#34;</span><span class="op" id="7055208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055214">Path</span><span class="op" id="7055218">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7055222">&#34;/&#34;</span><span class="op" id="7055225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055230">}</span><span class="op" id="7055231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055236">Proto</span><span class="op" id="7055241">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7055248">&#34;HTTP/1.1&#34;</span><span class="op" id="7055258">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055263">ProtoMajor</span><span class="op" id="7055273">:</span>&nbsp;<span class="num" id="7055275">1</span><span class="op" id="7055276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055281">ProtoMinor</span><span class="op" id="7055291">:</span>&nbsp;<span class="num" id="7055293">1</span><span class="op" id="7055294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055299">Header</span><span class="op" id="7055305">:</span>&nbsp;<span class="ident" id="7055307">Header</span><span class="op" id="7055313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055319">&#34;Accept&#34;</span><span class="op" id="7055327">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055339">{</span><span class="string" id="7055340">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="7055405">}</span><span class="op" id="7055406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055412">&#34;Accept-Charset&#34;</span><span class="op" id="7055428">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7055432">{</span><span class="string" id="7055433">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="7055465">}</span><span class="op" id="7055466">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055472">&#34;Accept-Encoding&#34;</span><span class="op" id="7055489">:</span>&nbsp;&nbsp;<span class="op" id="7055492">{</span><span class="string" id="7055493">&#34;gzip,deflate&#34;</span><span class="op" id="7055507">}</span><span class="op" id="7055508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055514">&#34;Accept-Language&#34;</span><span class="op" id="7055531">:</span>&nbsp;&nbsp;<span class="op" id="7055534">{</span><span class="string" id="7055535">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="7055551">}</span><span class="op" id="7055552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055558">&#34;Keep-Alive&#34;</span><span class="op" id="7055570">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055578">{</span><span class="string" id="7055579">&#34;300&#34;</span><span class="op" id="7055584">}</span><span class="op" id="7055585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055591">&#34;Proxy-Connection&#34;</span><span class="op" id="7055609">:</span>&nbsp;<span class="op" id="7055611">{</span><span class="string" id="7055612">&#34;keep-alive&#34;</span><span class="op" id="7055624">}</span><span class="op" id="7055625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055631">&#34;User-Agent&#34;</span><span class="op" id="7055643">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055651">{</span><span class="string" id="7055652">&#34;Fake&#34;</span><span class="op" id="7055658">}</span><span class="op" id="7055659">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055664">}</span><span class="op" id="7055665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055670">Body</span><span class="op" id="7055674">:</span>&nbsp;&nbsp;<span class="ident" id="7055677">nil</span><span class="op" id="7055680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055685">Close</span><span class="op" id="7055690">:</span>&nbsp;<span class="builtintype" id="7055692">false</span><span class="op" id="7055697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055702">Host</span><span class="op" id="7055706">:</span>&nbsp;&nbsp;<span class="string" id="7055709">&#34;www.techcrunch.com&#34;</span><span class="op" id="7055729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055734">Form</span><span class="op" id="7055738">:</span>&nbsp;&nbsp;<span class="keyword" id="7055741">map</span><span class="op" id="7055744">[</span><span class="builtintype" id="7055745">string</span><span class="op" id="7055751">]</span><span class="op" id="7055752">[</span><span class="op" id="7055753">]</span><span class="builtintype" id="7055754">string</span><span class="op" id="7055760">{</span><span class="op" id="7055761">}</span><span class="op" id="7055762">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055766">}</span><span class="op" id="7055767">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055772">WantWrite</span><span class="op" id="7055781">:</span>&nbsp;<span class="string" id="7055783">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7055804">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055809">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7055840">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055845">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7055868">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055873">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7055951">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7055956">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7056009">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056014">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7056050">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056055">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7056093">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056098">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7056120">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056125">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7056163">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056168">WantProxy</span><span class="op" id="7056177">:</span>&nbsp;<span class="string" id="7056179">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7056225">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056230">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7056261">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056266">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7056289">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056294">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7056372">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056377">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7056430">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056435">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7056471">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056476">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7056514">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056519">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7056541">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056546">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7056584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7056587">}</span><span class="op" id="7056588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7056591">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7056643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056647">Req</span><span class="op" id="7056650">:</span>&nbsp;<span class="ident" id="7056652">Request</span><span class="op" id="7056659">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056664">Method</span><span class="op" id="7056670">:</span>&nbsp;<span class="string" id="7056672">&#34;GET&#34;</span><span class="op" id="7056677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056682">URL</span><span class="op" id="7056685">:</span>&nbsp;<span class="op" id="7056687">&amp;</span><span class="ident" id="7056688">url</span><span class="op" id="7056691">.</span><span class="ident" id="7056692">URL</span><span class="op" id="7056695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056701">Scheme</span><span class="op" id="7056707">:</span>&nbsp;<span class="string" id="7056709">&#34;http&#34;</span><span class="op" id="7056715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056721">Host</span><span class="op" id="7056725">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7056729">&#34;www.google.com&#34;</span><span class="op" id="7056745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056751">Path</span><span class="op" id="7056755">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7056759">&#34;/search&#34;</span><span class="op" id="7056768">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7056773">}</span><span class="op" id="7056774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056779">ProtoMajor</span><span class="op" id="7056789">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7056797">1</span><span class="op" id="7056798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056803">ProtoMinor</span><span class="op" id="7056813">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7056821">1</span><span class="op" id="7056822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056827">Header</span><span class="op" id="7056833">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7056845">Header</span><span class="op" id="7056851">{</span><span class="op" id="7056852">}</span><span class="op" id="7056853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056858">TransferEncoding</span><span class="op" id="7056874">:</span>&nbsp;<span class="op" id="7056876">[</span><span class="op" id="7056877">]</span><span class="builtintype" id="7056878">string</span><span class="op" id="7056884">{</span><span class="string" id="7056885">&#34;chunked&#34;</span><span class="op" id="7056894">}</span><span class="op" id="7056895">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7056899">}</span><span class="op" id="7056900">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056905">Body</span><span class="op" id="7056909">:</span>&nbsp;<span class="op" id="7056911">[</span><span class="op" id="7056912">]</span><span class="builtintype" id="7056913">byte</span><span class="op" id="7056917">(</span><span class="string" id="7056918">&#34;abcdef&#34;</span><span class="op" id="7056926">)</span><span class="op" id="7056927">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056932">WantWrite</span><span class="op" id="7056941">:</span>&nbsp;<span class="string" id="7056943">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7056970">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7056975">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7057002">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7057007">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7057045">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7057050">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7057087">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057092">chunk</span><span class="op" id="7057097">(</span><span class="string" id="7057098">&#34;abcdef&#34;</span><span class="op" id="7057106">)</span>&nbsp;<span class="op" id="7057108">+</span>&nbsp;<span class="ident" id="7057110">chunk</span><span class="op" id="7057115">(</span><span class="string" id="7057116">&#34;&#34;</span><span class="op" id="7057118">)</span><span class="op" id="7057119">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057124">WantProxy</span><span class="op" id="7057133">:</span>&nbsp;<span class="string" id="7057135">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7057183">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7057188">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7057215">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7057220">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7057258">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7057263">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7057300">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057305">chunk</span><span class="op" id="7057310">(</span><span class="string" id="7057311">&#34;abcdef&#34;</span><span class="op" id="7057319">)</span>&nbsp;<span class="op" id="7057321">+</span>&nbsp;<span class="ident" id="7057323">chunk</span><span class="op" id="7057328">(</span><span class="string" id="7057329">&#34;&#34;</span><span class="op" id="7057331">)</span><span class="op" id="7057332">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057335">}</span><span class="op" id="7057336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7057339">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057400">Req</span><span class="op" id="7057403">:</span>&nbsp;<span class="ident" id="7057405">Request</span><span class="op" id="7057412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057417">Method</span><span class="op" id="7057423">:</span>&nbsp;<span class="string" id="7057425">&#34;POST&#34;</span><span class="op" id="7057431">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057436">URL</span><span class="op" id="7057439">:</span>&nbsp;<span class="op" id="7057441">&amp;</span><span class="ident" id="7057442">url</span><span class="op" id="7057445">.</span><span class="ident" id="7057446">URL</span><span class="op" id="7057449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057455">Scheme</span><span class="op" id="7057461">:</span>&nbsp;<span class="string" id="7057463">&#34;http&#34;</span><span class="op" id="7057469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057475">Host</span><span class="op" id="7057479">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7057483">&#34;www.google.com&#34;</span><span class="op" id="7057499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057505">Path</span><span class="op" id="7057509">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7057513">&#34;/search&#34;</span><span class="op" id="7057522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057527">}</span><span class="op" id="7057528">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057533">ProtoMajor</span><span class="op" id="7057543">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7057551">1</span><span class="op" id="7057552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057557">ProtoMinor</span><span class="op" id="7057567">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7057575">1</span><span class="op" id="7057576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057581">Header</span><span class="op" id="7057587">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7057599">Header</span><span class="op" id="7057605">{</span><span class="op" id="7057606">}</span><span class="op" id="7057607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057612">Close</span><span class="op" id="7057617">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7057630">true</span><span class="op" id="7057634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057639">TransferEncoding</span><span class="op" id="7057655">:</span>&nbsp;<span class="op" id="7057657">[</span><span class="op" id="7057658">]</span><span class="builtintype" id="7057659">string</span><span class="op" id="7057665">{</span><span class="string" id="7057666">&#34;chunked&#34;</span><span class="op" id="7057675">}</span><span class="op" id="7057676">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057680">}</span><span class="op" id="7057681">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057686">Body</span><span class="op" id="7057690">:</span>&nbsp;<span class="op" id="7057692">[</span><span class="op" id="7057693">]</span><span class="builtintype" id="7057694">byte</span><span class="op" id="7057698">(</span><span class="string" id="7057699">&#34;abcdef&#34;</span><span class="op" id="7057707">)</span><span class="op" id="7057708">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057713">WantWrite</span><span class="op" id="7057722">:</span>&nbsp;<span class="string" id="7057724">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7057752">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7057757">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7057784">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7057789">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7057827">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7057832">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7057856">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7057861">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7057898">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057903">chunk</span><span class="op" id="7057908">(</span><span class="string" id="7057909">&#34;abcdef&#34;</span><span class="op" id="7057917">)</span>&nbsp;<span class="op" id="7057919">+</span>&nbsp;<span class="ident" id="7057921">chunk</span><span class="op" id="7057926">(</span><span class="string" id="7057927">&#34;&#34;</span><span class="op" id="7057929">)</span><span class="op" id="7057930">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057935">WantProxy</span><span class="op" id="7057944">:</span>&nbsp;<span class="string" id="7057946">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7057995">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058000">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7058027">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058032">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7058070">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058075">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7058099">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058104">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7058141">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058146">chunk</span><span class="op" id="7058151">(</span><span class="string" id="7058152">&#34;abcdef&#34;</span><span class="op" id="7058160">)</span>&nbsp;<span class="op" id="7058162">+</span>&nbsp;<span class="ident" id="7058164">chunk</span><span class="op" id="7058169">(</span><span class="string" id="7058170">&#34;&#34;</span><span class="op" id="7058172">)</span><span class="op" id="7058173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058176">}</span><span class="op" id="7058177">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7058181">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058236">Req</span><span class="op" id="7058239">:</span>&nbsp;<span class="ident" id="7058241">Request</span><span class="op" id="7058248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058253">Method</span><span class="op" id="7058259">:</span>&nbsp;<span class="string" id="7058261">&#34;POST&#34;</span><span class="op" id="7058267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058272">URL</span><span class="op" id="7058275">:</span>&nbsp;<span class="op" id="7058277">&amp;</span><span class="ident" id="7058278">url</span><span class="op" id="7058281">.</span><span class="ident" id="7058282">URL</span><span class="op" id="7058285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058291">Scheme</span><span class="op" id="7058297">:</span>&nbsp;<span class="string" id="7058299">&#34;http&#34;</span><span class="op" id="7058305">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058311">Host</span><span class="op" id="7058315">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7058319">&#34;www.google.com&#34;</span><span class="op" id="7058335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058341">Path</span><span class="op" id="7058345">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7058349">&#34;/search&#34;</span><span class="op" id="7058358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058363">}</span><span class="op" id="7058364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058369">ProtoMajor</span><span class="op" id="7058379">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7058384">1</span><span class="op" id="7058385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058390">ProtoMinor</span><span class="op" id="7058400">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7058405">1</span><span class="op" id="7058406">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058411">Header</span><span class="op" id="7058417">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7058426">Header</span><span class="op" id="7058432">{</span><span class="op" id="7058433">}</span><span class="op" id="7058434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058439">Close</span><span class="op" id="7058444">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7058454">true</span><span class="op" id="7058458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058463">ContentLength</span><span class="op" id="7058476">:</span>&nbsp;<span class="num" id="7058478">6</span><span class="op" id="7058479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058483">}</span><span class="op" id="7058484">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058489">Body</span><span class="op" id="7058493">:</span>&nbsp;<span class="op" id="7058495">[</span><span class="op" id="7058496">]</span><span class="builtintype" id="7058497">byte</span><span class="op" id="7058501">(</span><span class="string" id="7058502">&#34;abcdef&#34;</span><span class="op" id="7058510">)</span><span class="op" id="7058511">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058516">WantWrite</span><span class="op" id="7058525">:</span>&nbsp;<span class="string" id="7058527">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7058555">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058560">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7058587">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058592">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7058630">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058635">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7058659">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058664">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7058688">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058693">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7058700">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058705">&#34;abcdef&#34;</span><span class="op" id="7058713">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058718">WantProxy</span><span class="op" id="7058727">:</span>&nbsp;<span class="string" id="7058729">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7058778">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058783">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7058810">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058815">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7058853">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058858">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7058882">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058887">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7058911">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058916">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7058923">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7058928">&#34;abcdef&#34;</span><span class="op" id="7058936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058939">}</span><span class="op" id="7058940">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7058944">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058997">Req</span><span class="op" id="7059000">:</span>&nbsp;<span class="ident" id="7059002">Request</span><span class="op" id="7059009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059014">Method</span><span class="op" id="7059020">:</span>&nbsp;<span class="string" id="7059022">&#34;POST&#34;</span><span class="op" id="7059028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059033">URL</span><span class="op" id="7059036">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059041">mustParseURL</span><span class="op" id="7059053">(</span><span class="string" id="7059054">&#34;http://example.com/&#34;</span><span class="op" id="7059075">)</span><span class="op" id="7059076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059081">Host</span><span class="op" id="7059085">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7059089">&#34;example.com&#34;</span><span class="op" id="7059102">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059107">Header</span><span class="op" id="7059113">:</span>&nbsp;<span class="ident" id="7059115">Header</span><span class="op" id="7059121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059127">&#34;Content-Length&#34;</span><span class="op" id="7059143">:</span>&nbsp;<span class="op" id="7059145">[</span><span class="op" id="7059146">]</span><span class="builtintype" id="7059147">string</span><span class="op" id="7059153">{</span><span class="string" id="7059154">&#34;10&#34;</span><span class="op" id="7059158">}</span><span class="op" id="7059159">,</span>&nbsp;<span class="comment" id="7059161">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7059175">}</span><span class="op" id="7059176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059181">ContentLength</span><span class="op" id="7059194">:</span>&nbsp;<span class="num" id="7059196">6</span><span class="op" id="7059197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7059201">}</span><span class="op" id="7059202">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059207">Body</span><span class="op" id="7059211">:</span>&nbsp;<span class="op" id="7059213">[</span><span class="op" id="7059214">]</span><span class="builtintype" id="7059215">byte</span><span class="op" id="7059219">(</span><span class="string" id="7059220">&#34;abcdef&#34;</span><span class="op" id="7059228">)</span><span class="op" id="7059229">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059234">WantWrite</span><span class="op" id="7059243">:</span>&nbsp;<span class="string" id="7059245">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7059267">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059272">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7059296">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059301">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7059339">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059344">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7059368">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059373">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7059380">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059385">&#34;abcdef&#34;</span><span class="op" id="7059393">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059398">WantProxy</span><span class="op" id="7059407">:</span>&nbsp;<span class="string" id="7059409">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7059449">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059454">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7059478">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059483">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7059521">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059526">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7059550">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059555">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7059562">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059567">&#34;abcdef&#34;</span><span class="op" id="7059575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7059578">}</span><span class="op" id="7059579">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7059583">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7059607">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059611">Req</span><span class="op" id="7059614">:</span>&nbsp;<span class="ident" id="7059616">Request</span><span class="op" id="7059623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059628">Method</span><span class="op" id="7059634">:</span>&nbsp;<span class="string" id="7059636">&#34;GET&#34;</span><span class="op" id="7059641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059646">URL</span><span class="op" id="7059649">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059654">mustParseURL</span><span class="op" id="7059666">(</span><span class="string" id="7059667">&#34;/search&#34;</span><span class="op" id="7059676">)</span><span class="op" id="7059677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059682">Host</span><span class="op" id="7059686">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7059690">&#34;www.google.com&#34;</span><span class="op" id="7059706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7059710">}</span><span class="op" id="7059711">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059716">WantWrite</span><span class="op" id="7059725">:</span>&nbsp;<span class="string" id="7059727">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7059754">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059759">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7059786">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059791">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7059829">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7059834">&#34;\r\n&#34;</span><span class="op" id="7059840">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7059843">}</span><span class="op" id="7059844">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7059848">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7059902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059906">Req</span><span class="op" id="7059909">:</span>&nbsp;<span class="ident" id="7059911">Request</span><span class="op" id="7059918">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059923">Method</span><span class="op" id="7059929">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7059938">&#34;POST&#34;</span><span class="op" id="7059944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059949">URL</span><span class="op" id="7059952">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059964">mustParseURL</span><span class="op" id="7059976">(</span><span class="string" id="7059977">&#34;/&#34;</span><span class="op" id="7059980">)</span><span class="op" id="7059981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7059986">Host</span><span class="op" id="7059990">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7060001">&#34;example.com&#34;</span><span class="op" id="7060014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060019">ProtoMajor</span><span class="op" id="7060029">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7060034">1</span><span class="op" id="7060035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060040">ProtoMinor</span><span class="op" id="7060050">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7060055">1</span><span class="op" id="7060056">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060061">ContentLength</span><span class="op" id="7060074">:</span>&nbsp;<span class="num" id="7060076">0</span><span class="op" id="7060077">,</span>&nbsp;<span class="comment" id="7060079">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7060104">}</span><span class="op" id="7060105">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060110">Body</span><span class="op" id="7060114">:</span>&nbsp;<span class="keyword" id="7060116">func</span><span class="op" id="7060120">(</span><span class="op" id="7060121">)</span>&nbsp;<span class="ident" id="7060123">io</span><span class="op" id="7060125">.</span><span class="ident" id="7060126">ReadCloser</span>&nbsp;<span class="op" id="7060137">{</span>&nbsp;<span class="keyword" id="7060139">return</span>&nbsp;<span class="ident" id="7060146">ioutil</span><span class="op" id="7060152">.</span><span class="ident" id="7060153">NopCloser</span><span class="op" id="7060162">(</span><span class="ident" id="7060163">io</span><span class="op" id="7060165">.</span><span class="ident" id="7060166">LimitReader</span><span class="op" id="7060177">(</span><span class="ident" id="7060178">strings</span><span class="op" id="7060185">.</span><span class="ident" id="7060186">NewReader</span><span class="op" id="7060195">(</span><span class="string" id="7060196">&#34;xx&#34;</span><span class="op" id="7060200">)</span><span class="op" id="7060201">,</span>&nbsp;<span class="num" id="7060203">0</span><span class="op" id="7060204">)</span><span class="op" id="7060205">)</span>&nbsp;<span class="op" id="7060207">}</span><span class="op" id="7060208">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7060213">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7060281">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7060335">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060381">WantWrite</span><span class="op" id="7060390">:</span>&nbsp;<span class="string" id="7060392">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7060414">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060419">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7060443">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060448">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7060486">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060491">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7060515">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060520">&#34;\r\n&#34;</span><span class="op" id="7060526">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060531">WantProxy</span><span class="op" id="7060540">:</span>&nbsp;<span class="string" id="7060542">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7060564">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060569">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7060593">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060598">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7060636">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060641">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7060665">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060670">&#34;\r\n&#34;</span><span class="op" id="7060676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7060679">}</span><span class="op" id="7060680">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7060684">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7060738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060742">Req</span><span class="op" id="7060745">:</span>&nbsp;<span class="ident" id="7060747">Request</span><span class="op" id="7060754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060759">Method</span><span class="op" id="7060765">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7060774">&#34;POST&#34;</span><span class="op" id="7060780">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060785">URL</span><span class="op" id="7060788">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7060800">mustParseURL</span><span class="op" id="7060812">(</span><span class="string" id="7060813">&#34;/&#34;</span><span class="op" id="7060816">)</span><span class="op" id="7060817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060822">Host</span><span class="op" id="7060826">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7060837">&#34;example.com&#34;</span><span class="op" id="7060850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060855">ProtoMajor</span><span class="op" id="7060865">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7060870">1</span><span class="op" id="7060871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060876">ProtoMinor</span><span class="op" id="7060886">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7060891">1</span><span class="op" id="7060892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060897">ContentLength</span><span class="op" id="7060910">:</span>&nbsp;<span class="num" id="7060912">0</span><span class="op" id="7060913">,</span>&nbsp;<span class="comment" id="7060915">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7060940">}</span><span class="op" id="7060941">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060946">Body</span><span class="op" id="7060950">:</span>&nbsp;<span class="keyword" id="7060952">func</span><span class="op" id="7060956">(</span><span class="op" id="7060957">)</span>&nbsp;<span class="ident" id="7060959">io</span><span class="op" id="7060961">.</span><span class="ident" id="7060962">ReadCloser</span>&nbsp;<span class="op" id="7060973">{</span>&nbsp;<span class="keyword" id="7060975">return</span>&nbsp;<span class="ident" id="7060982">ioutil</span><span class="op" id="7060988">.</span><span class="ident" id="7060989">NopCloser</span><span class="op" id="7060998">(</span><span class="ident" id="7060999">io</span><span class="op" id="7061001">.</span><span class="ident" id="7061002">LimitReader</span><span class="op" id="7061013">(</span><span class="ident" id="7061014">strings</span><span class="op" id="7061021">.</span><span class="ident" id="7061022">NewReader</span><span class="op" id="7061031">(</span><span class="string" id="7061032">&#34;xx&#34;</span><span class="op" id="7061036">)</span><span class="op" id="7061037">,</span>&nbsp;<span class="num" id="7061039">1</span><span class="op" id="7061040">)</span><span class="op" id="7061041">)</span>&nbsp;<span class="op" id="7061043">}</span><span class="op" id="7061044">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061049">WantWrite</span><span class="op" id="7061058">:</span>&nbsp;<span class="string" id="7061060">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7061082">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061087">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7061111">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061116">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7061154">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061159">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7061196">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061201">chunk</span><span class="op" id="7061206">(</span><span class="string" id="7061207">&#34;x&#34;</span><span class="op" id="7061210">)</span>&nbsp;<span class="op" id="7061212">+</span>&nbsp;<span class="ident" id="7061214">chunk</span><span class="op" id="7061219">(</span><span class="string" id="7061220">&#34;&#34;</span><span class="op" id="7061222">)</span><span class="op" id="7061223">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061228">WantProxy</span><span class="op" id="7061237">:</span>&nbsp;<span class="string" id="7061239">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7061261">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061266">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7061290">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061295">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7061333">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061338">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7061375">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061380">chunk</span><span class="op" id="7061385">(</span><span class="string" id="7061386">&#34;x&#34;</span><span class="op" id="7061389">)</span>&nbsp;<span class="op" id="7061391">+</span>&nbsp;<span class="ident" id="7061393">chunk</span><span class="op" id="7061398">(</span><span class="string" id="7061399">&#34;&#34;</span><span class="op" id="7061401">)</span><span class="op" id="7061402">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7061405">}</span><span class="op" id="7061406">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7061410">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7061468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061472">Req</span><span class="op" id="7061475">:</span>&nbsp;<span class="ident" id="7061477">Request</span><span class="op" id="7061484">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061489">Method</span><span class="op" id="7061495">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7061504">&#34;POST&#34;</span><span class="op" id="7061510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061515">URL</span><span class="op" id="7061518">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7061530">mustParseURL</span><span class="op" id="7061542">(</span><span class="string" id="7061543">&#34;/&#34;</span><span class="op" id="7061546">)</span><span class="op" id="7061547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061552">Host</span><span class="op" id="7061556">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7061567">&#34;example.com&#34;</span><span class="op" id="7061580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061585">ProtoMajor</span><span class="op" id="7061595">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7061600">1</span><span class="op" id="7061601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061606">ProtoMinor</span><span class="op" id="7061616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7061621">1</span><span class="op" id="7061622">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061627">ContentLength</span><span class="op" id="7061640">:</span>&nbsp;<span class="num" id="7061642">10</span><span class="op" id="7061644">,</span>&nbsp;<span class="comment" id="7061646">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7061688">}</span><span class="op" id="7061689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061693">Body</span><span class="op" id="7061697">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7061704">[</span><span class="op" id="7061705">]</span><span class="builtintype" id="7061706">byte</span><span class="op" id="7061710">(</span><span class="string" id="7061711">&#34;12345&#34;</span><span class="op" id="7061718">)</span><span class="op" id="7061719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061723">WantError</span><span class="op" id="7061732">:</span>&nbsp;<span class="ident" id="7061734">errors</span><span class="op" id="7061740">.</span><span class="ident" id="7061741">New</span><span class="op" id="7061744">(</span><span class="string" id="7061745">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="7061788">)</span><span class="op" id="7061789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7061792">}</span><span class="op" id="7061793">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7061797">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7061855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061859">Req</span><span class="op" id="7061862">:</span>&nbsp;<span class="ident" id="7061864">Request</span><span class="op" id="7061871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061876">Method</span><span class="op" id="7061882">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7061891">&#34;POST&#34;</span><span class="op" id="7061897">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061902">URL</span><span class="op" id="7061905">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7061917">mustParseURL</span><span class="op" id="7061929">(</span><span class="string" id="7061930">&#34;/&#34;</span><span class="op" id="7061933">)</span><span class="op" id="7061934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061939">Host</span><span class="op" id="7061943">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7061954">&#34;example.com&#34;</span><span class="op" id="7061967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061972">ProtoMajor</span><span class="op" id="7061982">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7061987">1</span><span class="op" id="7061988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061993">ProtoMinor</span><span class="op" id="7062003">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7062008">1</span><span class="op" id="7062009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062014">ContentLength</span><span class="op" id="7062027">:</span>&nbsp;<span class="num" id="7062029">4</span><span class="op" id="7062030">,</span>&nbsp;<span class="comment" id="7062032">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062076">}</span><span class="op" id="7062077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062081">Body</span><span class="op" id="7062085">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7062092">[</span><span class="op" id="7062093">]</span><span class="builtintype" id="7062094">byte</span><span class="op" id="7062098">(</span><span class="string" id="7062099">&#34;12345678&#34;</span><span class="op" id="7062109">)</span><span class="op" id="7062110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062114">WantError</span><span class="op" id="7062123">:</span>&nbsp;<span class="ident" id="7062125">errors</span><span class="op" id="7062131">.</span><span class="ident" id="7062132">New</span><span class="op" id="7062135">(</span><span class="string" id="7062136">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="7062178">)</span><span class="op" id="7062179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062182">}</span><span class="op" id="7062183">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7062187">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062240">Req</span><span class="op" id="7062243">:</span>&nbsp;<span class="ident" id="7062245">Request</span><span class="op" id="7062252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062257">Method</span><span class="op" id="7062263">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7062272">&#34;POST&#34;</span><span class="op" id="7062278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062283">URL</span><span class="op" id="7062286">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7062298">mustParseURL</span><span class="op" id="7062310">(</span><span class="string" id="7062311">&#34;/&#34;</span><span class="op" id="7062314">)</span><span class="op" id="7062315">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062320">Host</span><span class="op" id="7062324">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7062335">&#34;example.com&#34;</span><span class="op" id="7062348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062353">ProtoMajor</span><span class="op" id="7062363">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7062368">1</span><span class="op" id="7062369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062374">ProtoMinor</span><span class="op" id="7062384">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7062389">1</span><span class="op" id="7062390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062395">ContentLength</span><span class="op" id="7062408">:</span>&nbsp;<span class="num" id="7062410">5</span><span class="op" id="7062411">,</span>&nbsp;<span class="comment" id="7062413">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062442">}</span><span class="op" id="7062443">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062447">WantError</span><span class="op" id="7062456">:</span>&nbsp;<span class="ident" id="7062458">errors</span><span class="op" id="7062464">.</span><span class="ident" id="7062465">New</span><span class="op" id="7062468">(</span><span class="string" id="7062469">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="7062514">)</span><span class="op" id="7062515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062518">}</span><span class="op" id="7062519">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7062523">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062603">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062607">Req</span><span class="op" id="7062610">:</span>&nbsp;<span class="ident" id="7062612">Request</span><span class="op" id="7062619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062624">Method</span><span class="op" id="7062630">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7062639">&#34;POST&#34;</span><span class="op" id="7062645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062650">URL</span><span class="op" id="7062653">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7062665">mustParseURL</span><span class="op" id="7062677">(</span><span class="string" id="7062678">&#34;/&#34;</span><span class="op" id="7062681">)</span><span class="op" id="7062682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062687">Host</span><span class="op" id="7062691">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7062702">&#34;example.com&#34;</span><span class="op" id="7062715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062720">ProtoMajor</span><span class="op" id="7062730">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7062735">1</span><span class="op" id="7062736">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062741">ProtoMinor</span><span class="op" id="7062751">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7062756">1</span><span class="op" id="7062757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062762">ContentLength</span><span class="op" id="7062775">:</span>&nbsp;<span class="num" id="7062777">0</span><span class="op" id="7062778">,</span>&nbsp;<span class="comment" id="7062780">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062805">}</span><span class="op" id="7062806">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062811">Body</span><span class="op" id="7062815">:</span>&nbsp;<span class="keyword" id="7062817">func</span><span class="op" id="7062821">(</span><span class="op" id="7062822">)</span>&nbsp;<span class="ident" id="7062824">io</span><span class="op" id="7062826">.</span><span class="ident" id="7062827">ReadCloser</span>&nbsp;<span class="op" id="7062838">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062843">err</span>&nbsp;<span class="op" id="7062847">:=</span>&nbsp;<span class="ident" id="7062850">errors</span><span class="op" id="7062856">.</span><span class="ident" id="7062857">New</span><span class="op" id="7062860">(</span><span class="string" id="7062861">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7062882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062887">errReader</span>&nbsp;<span class="op" id="7062897">:=</span>&nbsp;<span class="op" id="7062900">&amp;</span><span class="ident" id="7062901">errorReader</span><span class="op" id="7062912">{</span><span class="ident" id="7062913">err</span><span class="op" id="7062916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7062921">return</span>&nbsp;<span class="ident" id="7062928">ioutil</span><span class="op" id="7062934">.</span><span class="ident" id="7062935">NopCloser</span><span class="op" id="7062944">(</span><span class="ident" id="7062945">io</span><span class="op" id="7062947">.</span><span class="ident" id="7062948">MultiReader</span><span class="op" id="7062959">(</span><span class="ident" id="7062960">strings</span><span class="op" id="7062967">.</span><span class="ident" id="7062968">NewReader</span><span class="op" id="7062977">(</span><span class="string" id="7062978">&#34;x&#34;</span><span class="op" id="7062981">)</span><span class="op" id="7062982">,</span>&nbsp;<span class="ident" id="7062984">errReader</span><span class="op" id="7062993">)</span><span class="op" id="7062994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062998">}</span><span class="op" id="7062999">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063004">WantError</span><span class="op" id="7063013">:</span>&nbsp;<span class="ident" id="7063015">errors</span><span class="op" id="7063021">.</span><span class="ident" id="7063022">New</span><span class="op" id="7063025">(</span><span class="string" id="7063026">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7063047">)</span><span class="op" id="7063048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063051">}</span><span class="op" id="7063052">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7063056">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063132">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063136">Req</span><span class="op" id="7063139">:</span>&nbsp;<span class="ident" id="7063141">Request</span><span class="op" id="7063148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063153">Method</span><span class="op" id="7063159">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7063168">&#34;POST&#34;</span><span class="op" id="7063174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063179">URL</span><span class="op" id="7063182">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7063194">mustParseURL</span><span class="op" id="7063206">(</span><span class="string" id="7063207">&#34;/&#34;</span><span class="op" id="7063210">)</span><span class="op" id="7063211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063216">Host</span><span class="op" id="7063220">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7063231">&#34;example.com&#34;</span><span class="op" id="7063244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063249">ProtoMajor</span><span class="op" id="7063259">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7063264">1</span><span class="op" id="7063265">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063270">ProtoMinor</span><span class="op" id="7063280">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7063285">1</span><span class="op" id="7063286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063291">ContentLength</span><span class="op" id="7063304">:</span>&nbsp;<span class="num" id="7063306">0</span><span class="op" id="7063307">,</span>&nbsp;<span class="comment" id="7063309">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063334">}</span><span class="op" id="7063335">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063340">Body</span><span class="op" id="7063344">:</span>&nbsp;<span class="keyword" id="7063346">func</span><span class="op" id="7063350">(</span><span class="op" id="7063351">)</span>&nbsp;<span class="ident" id="7063353">io</span><span class="op" id="7063355">.</span><span class="ident" id="7063356">ReadCloser</span>&nbsp;<span class="op" id="7063367">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063372">err</span>&nbsp;<span class="op" id="7063376">:=</span>&nbsp;<span class="ident" id="7063379">errors</span><span class="op" id="7063385">.</span><span class="ident" id="7063386">New</span><span class="op" id="7063389">(</span><span class="string" id="7063390">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7063411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063416">errReader</span>&nbsp;<span class="op" id="7063426">:=</span>&nbsp;<span class="op" id="7063429">&amp;</span><span class="ident" id="7063430">errorReader</span><span class="op" id="7063441">{</span><span class="ident" id="7063442">err</span><span class="op" id="7063445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7063450">return</span>&nbsp;<span class="ident" id="7063457">ioutil</span><span class="op" id="7063463">.</span><span class="ident" id="7063464">NopCloser</span><span class="op" id="7063473">(</span><span class="ident" id="7063474">errReader</span><span class="op" id="7063483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063487">}</span><span class="op" id="7063488">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063493">WantError</span><span class="op" id="7063502">:</span>&nbsp;<span class="ident" id="7063504">errors</span><span class="op" id="7063510">.</span><span class="ident" id="7063511">New</span><span class="op" id="7063514">(</span><span class="string" id="7063515">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7063536">)</span><span class="op" id="7063537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063540">}</span><span class="op" id="7063541">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7063545">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7063628">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063666">Req</span><span class="op" id="7063669">:</span>&nbsp;<span class="ident" id="7063671">Request</span><span class="op" id="7063678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063683">Method</span><span class="op" id="7063689">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7063695">&#34;GET&#34;</span><span class="op" id="7063700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063705">URL</span><span class="op" id="7063708">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7063717">mustParseURL</span><span class="op" id="7063729">(</span><span class="string" id="7063730">&#34;/foo&#34;</span><span class="op" id="7063736">)</span><span class="op" id="7063737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063742">ProtoMajor</span><span class="op" id="7063752">:</span>&nbsp;<span class="num" id="7063754">1</span><span class="op" id="7063755">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063760">ProtoMinor</span><span class="op" id="7063770">:</span>&nbsp;<span class="num" id="7063772">0</span><span class="op" id="7063773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063778">Header</span><span class="op" id="7063784">:</span>&nbsp;<span class="ident" id="7063786">Header</span><span class="op" id="7063792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063798">&#34;X-Foo&#34;</span><span class="op" id="7063805">:</span>&nbsp;<span class="op" id="7063807">[</span><span class="op" id="7063808">]</span><span class="builtintype" id="7063809">string</span><span class="op" id="7063815">{</span><span class="string" id="7063816">&#34;X-Bar&#34;</span><span class="op" id="7063823">}</span><span class="op" id="7063824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063829">}</span><span class="op" id="7063830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063834">}</span><span class="op" id="7063835">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063840">WantWrite</span><span class="op" id="7063849">:</span>&nbsp;<span class="string" id="7063851">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7063875">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063880">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7063893">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063898">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7063936">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063941">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="7063963">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063966">}</span><span class="op" id="7063967">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7063971">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7064027">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7064067">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7064121">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064162">Req</span><span class="op" id="7064165">:</span>&nbsp;<span class="ident" id="7064167">Request</span><span class="op" id="7064174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064179">Method</span><span class="op" id="7064185">:</span>&nbsp;<span class="string" id="7064187">&#34;GET&#34;</span><span class="op" id="7064192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064197">Host</span><span class="op" id="7064201">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7064205">&#34;&#34;</span><span class="op" id="7064207">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064212">URL</span><span class="op" id="7064215">:</span>&nbsp;<span class="op" id="7064217">&amp;</span><span class="ident" id="7064218">url</span><span class="op" id="7064221">.</span><span class="ident" id="7064222">URL</span><span class="op" id="7064225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064231">Scheme</span><span class="op" id="7064237">:</span>&nbsp;<span class="string" id="7064239">&#34;http&#34;</span><span class="op" id="7064245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064251">Host</span><span class="op" id="7064255">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7064259">&#34;&#34;</span><span class="op" id="7064261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064267">Path</span><span class="op" id="7064271">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7064275">&#34;/search&#34;</span><span class="op" id="7064284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064289">}</span><span class="op" id="7064290">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064295">ProtoMajor</span><span class="op" id="7064305">:</span>&nbsp;<span class="num" id="7064307">1</span><span class="op" id="7064308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064313">ProtoMinor</span><span class="op" id="7064323">:</span>&nbsp;<span class="num" id="7064325">1</span><span class="op" id="7064326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064331">Header</span><span class="op" id="7064337">:</span>&nbsp;<span class="ident" id="7064339">Header</span><span class="op" id="7064345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064351">&#34;Host&#34;</span><span class="op" id="7064357">:</span>&nbsp;<span class="op" id="7064359">[</span><span class="op" id="7064360">]</span><span class="builtintype" id="7064361">string</span><span class="op" id="7064367">{</span><span class="string" id="7064368">&#34;bad.example.com&#34;</span><span class="op" id="7064385">}</span><span class="op" id="7064386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064391">}</span><span class="op" id="7064392">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064396">}</span><span class="op" id="7064397">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064402">WantWrite</span><span class="op" id="7064411">:</span>&nbsp;<span class="string" id="7064413">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7064440">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064445">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7064458">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064463">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7064504">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064507">}</span><span class="op" id="7064508">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7064512">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064562">Req</span><span class="op" id="7064565">:</span>&nbsp;<span class="ident" id="7064567">Request</span><span class="op" id="7064574">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064579">Method</span><span class="op" id="7064585">:</span>&nbsp;<span class="string" id="7064587">&#34;GET&#34;</span><span class="op" id="7064592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064597">URL</span><span class="op" id="7064600">:</span>&nbsp;<span class="op" id="7064602">&amp;</span><span class="ident" id="7064603">url</span><span class="op" id="7064606">.</span><span class="ident" id="7064607">URL</span><span class="op" id="7064610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064616">Scheme</span><span class="op" id="7064622">:</span>&nbsp;<span class="string" id="7064624">&#34;http&#34;</span><span class="op" id="7064630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064636">Host</span><span class="op" id="7064640">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7064644">&#34;www.google.com&#34;</span><span class="op" id="7064660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064666">Opaque</span><span class="op" id="7064672">:</span>&nbsp;<span class="string" id="7064674">&#34;/%2F/%2F/&#34;</span><span class="op" id="7064685">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064690">}</span><span class="op" id="7064691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064696">ProtoMajor</span><span class="op" id="7064706">:</span>&nbsp;<span class="num" id="7064708">1</span><span class="op" id="7064709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064714">ProtoMinor</span><span class="op" id="7064724">:</span>&nbsp;<span class="num" id="7064726">1</span><span class="op" id="7064727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064732">Header</span><span class="op" id="7064738">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7064744">Header</span><span class="op" id="7064750">{</span><span class="op" id="7064751">}</span><span class="op" id="7064752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064756">}</span><span class="op" id="7064757">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064762">WantWrite</span><span class="op" id="7064771">:</span>&nbsp;<span class="string" id="7064773">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7064802">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064807">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7064834">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064839">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7064880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064883">}</span><span class="op" id="7064884">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7064888">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064938">Req</span><span class="op" id="7064941">:</span>&nbsp;<span class="ident" id="7064943">Request</span><span class="op" id="7064950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064955">Method</span><span class="op" id="7064961">:</span>&nbsp;<span class="string" id="7064963">&#34;GET&#34;</span><span class="op" id="7064968">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064973">URL</span><span class="op" id="7064976">:</span>&nbsp;<span class="op" id="7064978">&amp;</span><span class="ident" id="7064979">url</span><span class="op" id="7064982">.</span><span class="ident" id="7064983">URL</span><span class="op" id="7064986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064992">Scheme</span><span class="op" id="7064998">:</span>&nbsp;<span class="string" id="7065000">&#34;http&#34;</span><span class="op" id="7065006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065012">Host</span><span class="op" id="7065016">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7065020">&#34;x.google.com&#34;</span><span class="op" id="7065034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065040">Opaque</span><span class="op" id="7065046">:</span>&nbsp;<span class="string" id="7065048">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="7065073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065078">}</span><span class="op" id="7065079">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065084">ProtoMajor</span><span class="op" id="7065094">:</span>&nbsp;<span class="num" id="7065096">1</span><span class="op" id="7065097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065102">ProtoMinor</span><span class="op" id="7065112">:</span>&nbsp;<span class="num" id="7065114">1</span><span class="op" id="7065115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065120">Header</span><span class="op" id="7065126">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7065132">Header</span><span class="op" id="7065138">{</span><span class="op" id="7065139">}</span><span class="op" id="7065140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065144">}</span><span class="op" id="7065145">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065150">WantWrite</span><span class="op" id="7065159">:</span>&nbsp;<span class="string" id="7065161">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7065209">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065214">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7065239">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065244">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7065285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065288">}</span><span class="op" id="7065289">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7065293">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065349">Req</span><span class="op" id="7065352">:</span>&nbsp;<span class="ident" id="7065354">Request</span><span class="op" id="7065361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065366">Method</span><span class="op" id="7065372">:</span>&nbsp;<span class="string" id="7065374">&#34;GET&#34;</span><span class="op" id="7065379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065384">URL</span><span class="op" id="7065387">:</span>&nbsp;<span class="op" id="7065389">&amp;</span><span class="ident" id="7065390">url</span><span class="op" id="7065393">.</span><span class="ident" id="7065394">URL</span><span class="op" id="7065397">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065403">Scheme</span><span class="op" id="7065409">:</span>&nbsp;<span class="string" id="7065411">&#34;http&#34;</span><span class="op" id="7065417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065423">Host</span><span class="op" id="7065427">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7065431">&#34;www.google.com&#34;</span><span class="op" id="7065447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065453">Path</span><span class="op" id="7065457">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7065461">&#34;/&#34;</span><span class="op" id="7065464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065469">}</span><span class="op" id="7065470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065475">Proto</span><span class="op" id="7065480">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7065487">&#34;HTTP/1.1&#34;</span><span class="op" id="7065497">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065502">ProtoMajor</span><span class="op" id="7065512">:</span>&nbsp;<span class="num" id="7065514">1</span><span class="op" id="7065515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065520">ProtoMinor</span><span class="op" id="7065530">:</span>&nbsp;<span class="num" id="7065532">1</span><span class="op" id="7065533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065538">Header</span><span class="op" id="7065544">:</span>&nbsp;<span class="ident" id="7065546">Header</span><span class="op" id="7065552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065558">&#34;ALL-CAPS&#34;</span><span class="op" id="7065568">:</span>&nbsp;<span class="op" id="7065570">{</span><span class="string" id="7065571">&#34;x&#34;</span><span class="op" id="7065574">}</span><span class="op" id="7065575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065580">}</span><span class="op" id="7065581">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065585">}</span><span class="op" id="7065586">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065591">WantWrite</span><span class="op" id="7065600">:</span>&nbsp;<span class="string" id="7065602">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7065623">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065628">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7065655">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065660">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7065698">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065703">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="7065721">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065726">&#34;\r\n&#34;</span><span class="op" id="7065732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065735">}</span><span class="op" id="7065736">,</span><br>
<span class="lineno"></span><span class="op" id="7065738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="7065741">func</span>&nbsp;<span class="ident" id="7065746">TestRequestWrite</span><span class="op" id="7065762">(</span><span class="ident" id="7065763">t</span>&nbsp;<span class="op" id="7065765">*</span><span class="ident" id="7065766">testing</span><span class="op" id="7065773">.</span><span class="ident" id="7065774">T</span><span class="op" id="7065775">)</span>&nbsp;<span class="op" id="7065777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7065780">for</span>&nbsp;<span class="ident" id="7065784">i</span>&nbsp;<span class="op" id="7065786">:=</span>&nbsp;<span class="keyword" id="7065789">range</span>&nbsp;<span class="ident" id="7065795">reqWriteTests</span>&nbsp;<span class="op" id="7065809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065813">tt</span>&nbsp;<span class="op" id="7065816">:=</span>&nbsp;<span class="op" id="7065819">&amp;</span><span class="ident" id="7065820">reqWriteTests</span><span class="op" id="7065833">[</span><span class="ident" id="7065834">i</span><span class="op" id="7065835">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065840">setBody</span>&nbsp;<span class="op" id="7065848">:=</span>&nbsp;<span class="keyword" id="7065851">func</span><span class="op" id="7065855">(</span><span class="op" id="7065856">)</span>&nbsp;<span class="op" id="7065858">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7065863">if</span>&nbsp;<span class="ident" id="7065866">tt</span><span class="op" id="7065868">.</span><span class="ident" id="7065869">Body</span>&nbsp;<span class="op" id="7065874">==</span>&nbsp;<span class="ident" id="7065877">nil</span>&nbsp;<span class="op" id="7065881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7065887">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7065902">switch</span>&nbsp;<span class="ident" id="7065909">b</span>&nbsp;<span class="op" id="7065911">:=</span>&nbsp;<span class="ident" id="7065914">tt</span><span class="op" id="7065916">.</span><span class="ident" id="7065917">Body</span><span class="op" id="7065921">.</span><span class="op" id="7065922">(</span><span class="keyword" id="7065923">type</span><span class="op" id="7065927">)</span>&nbsp;<span class="op" id="7065929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7065934">case</span>&nbsp;<span class="op" id="7065939">[</span><span class="op" id="7065940">]</span><span class="builtintype" id="7065941">byte</span><span class="op" id="7065945">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065951">tt</span><span class="op" id="7065953">.</span><span class="ident" id="7065954">Req</span><span class="op" id="7065957">.</span><span class="ident" id="7065958">Body</span>&nbsp;<span class="op" id="7065963">=</span>&nbsp;<span class="ident" id="7065965">ioutil</span><span class="op" id="7065971">.</span><span class="ident" id="7065972">NopCloser</span><span class="op" id="7065981">(</span><span class="ident" id="7065982">bytes</span><span class="op" id="7065987">.</span><span class="ident" id="7065988">NewReader</span><span class="op" id="7065997">(</span><span class="ident" id="7065998">b</span><span class="op" id="7065999">)</span><span class="op" id="7066000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066005">case</span>&nbsp;<span class="keyword" id="7066010">func</span><span class="op" id="7066014">(</span><span class="op" id="7066015">)</span>&nbsp;<span class="ident" id="7066017">io</span><span class="op" id="7066019">.</span><span class="ident" id="7066020">ReadCloser</span><span class="op" id="7066030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066036">tt</span><span class="op" id="7066038">.</span><span class="ident" id="7066039">Req</span><span class="op" id="7066042">.</span><span class="ident" id="7066043">Body</span>&nbsp;<span class="op" id="7066048">=</span>&nbsp;<span class="ident" id="7066050">b</span><span class="op" id="7066051">(</span><span class="op" id="7066052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066061">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066065">setBody</span><span class="op" id="7066072">(</span><span class="op" id="7066073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066077">if</span>&nbsp;<span class="ident" id="7066080">tt</span><span class="op" id="7066082">.</span><span class="ident" id="7066083">Req</span><span class="op" id="7066086">.</span><span class="ident" id="7066087">Header</span>&nbsp;<span class="op" id="7066094">==</span>&nbsp;<span class="ident" id="7066097">nil</span>&nbsp;<span class="op" id="7066101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066106">tt</span><span class="op" id="7066108">.</span><span class="ident" id="7066109">Req</span><span class="op" id="7066112">.</span><span class="ident" id="7066113">Header</span>&nbsp;<span class="op" id="7066120">=</span>&nbsp;<span class="builtinfunc" id="7066122">make</span><span class="op" id="7066126">(</span><span class="ident" id="7066127">Header</span><span class="op" id="7066133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066142">var</span>&nbsp;<span class="ident" id="7066146">braw</span>&nbsp;<span class="ident" id="7066151">bytes</span><span class="op" id="7066156">.</span><span class="ident" id="7066157">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066166">err</span>&nbsp;<span class="op" id="7066170">:=</span>&nbsp;<span class="ident" id="7066173">tt</span><span class="op" id="7066175">.</span><span class="ident" id="7066176">Req</span><span class="op" id="7066179">.</span><span class="ident" id="7066180">Write</span><span class="op" id="7066185">(</span><span class="op" id="7066186">&amp;</span><span class="ident" id="7066187">braw</span><span class="op" id="7066191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066195">if</span>&nbsp;<span class="ident" id="7066198">g</span><span class="op" id="7066199">,</span>&nbsp;<span class="ident" id="7066201">e</span>&nbsp;<span class="op" id="7066203">:=</span>&nbsp;<span class="ident" id="7066206">fmt</span><span class="op" id="7066209">.</span><span class="ident" id="7066210">Sprintf</span><span class="op" id="7066217">(</span><span class="string" id="7066218">&#34;%v&#34;</span><span class="op" id="7066222">,</span>&nbsp;<span class="ident" id="7066224">err</span><span class="op" id="7066227">)</span><span class="op" id="7066228">,</span>&nbsp;<span class="ident" id="7066230">fmt</span><span class="op" id="7066233">.</span><span class="ident" id="7066234">Sprintf</span><span class="op" id="7066241">(</span><span class="string" id="7066242">&#34;%v&#34;</span><span class="op" id="7066246">,</span>&nbsp;<span class="ident" id="7066248">tt</span><span class="op" id="7066250">.</span><span class="ident" id="7066251">WantError</span><span class="op" id="7066260">)</span><span class="op" id="7066261">;</span>&nbsp;<span class="ident" id="7066263">g</span>&nbsp;<span class="op" id="7066265">!=</span>&nbsp;<span class="ident" id="7066268">e</span>&nbsp;<span class="op" id="7066270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066275">t</span><span class="op" id="7066276">.</span><span class="ident" id="7066277">Errorf</span><span class="op" id="7066283">(</span><span class="string" id="7066284">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7066316">,</span>&nbsp;<span class="ident" id="7066318">i</span><span class="op" id="7066319">,</span>&nbsp;<span class="ident" id="7066321">g</span><span class="op" id="7066322">,</span>&nbsp;<span class="ident" id="7066324">e</span><span class="op" id="7066325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066330">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066345">if</span>&nbsp;<span class="ident" id="7066348">err</span>&nbsp;<span class="op" id="7066352">!=</span>&nbsp;<span class="ident" id="7066355">nil</span>&nbsp;<span class="op" id="7066359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066364">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066380">if</span>&nbsp;<span class="ident" id="7066383">tt</span><span class="op" id="7066385">.</span><span class="ident" id="7066386">WantWrite</span>&nbsp;<span class="op" id="7066396">!=</span>&nbsp;<span class="string" id="7066399">&#34;&#34;</span>&nbsp;<span class="op" id="7066402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066407">sraw</span>&nbsp;<span class="op" id="7066412">:=</span>&nbsp;<span class="ident" id="7066415">braw</span><span class="op" id="7066419">.</span><span class="ident" id="7066420">String</span><span class="op" id="7066426">(</span><span class="op" id="7066427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066432">if</span>&nbsp;<span class="ident" id="7066435">sraw</span>&nbsp;<span class="op" id="7066440">!=</span>&nbsp;<span class="ident" id="7066443">tt</span><span class="op" id="7066445">.</span><span class="ident" id="7066446">WantWrite</span>&nbsp;<span class="op" id="7066456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066462">t</span><span class="op" id="7066463">.</span><span class="ident" id="7066464">Errorf</span><span class="op" id="7066470">(</span><span class="string" id="7066471">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7066508">,</span>&nbsp;<span class="ident" id="7066510">i</span><span class="op" id="7066511">,</span>&nbsp;<span class="ident" id="7066513">tt</span><span class="op" id="7066515">.</span><span class="ident" id="7066516">WantWrite</span><span class="op" id="7066525">,</span>&nbsp;<span class="ident" id="7066527">sraw</span><span class="op" id="7066531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066537">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066558">if</span>&nbsp;<span class="ident" id="7066561">tt</span><span class="op" id="7066563">.</span><span class="ident" id="7066564">WantProxy</span>&nbsp;<span class="op" id="7066574">!=</span>&nbsp;<span class="string" id="7066577">&#34;&#34;</span>&nbsp;<span class="op" id="7066580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066585">setBody</span><span class="op" id="7066592">(</span><span class="op" id="7066593">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066598">var</span>&nbsp;<span class="ident" id="7066602">praw</span>&nbsp;<span class="ident" id="7066607">bytes</span><span class="op" id="7066612">.</span><span class="ident" id="7066613">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066623">err</span>&nbsp;<span class="op" id="7066627">=</span>&nbsp;<span class="ident" id="7066629">tt</span><span class="op" id="7066631">.</span><span class="ident" id="7066632">Req</span><span class="op" id="7066635">.</span><span class="ident" id="7066636">WriteProxy</span><span class="op" id="7066646">(</span><span class="op" id="7066647">&amp;</span><span class="ident" id="7066648">praw</span><span class="op" id="7066652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066657">if</span>&nbsp;<span class="ident" id="7066660">err</span>&nbsp;<span class="op" id="7066664">!=</span>&nbsp;<span class="ident" id="7066667">nil</span>&nbsp;<span class="op" id="7066671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066677">t</span><span class="op" id="7066678">.</span><span class="ident" id="7066679">Errorf</span><span class="op" id="7066685">(</span><span class="string" id="7066686">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7066706">,</span>&nbsp;<span class="ident" id="7066708">i</span><span class="op" id="7066709">,</span>&nbsp;<span class="ident" id="7066711">err</span><span class="op" id="7066714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066720">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066737">sraw</span>&nbsp;<span class="op" id="7066742">:=</span>&nbsp;<span class="ident" id="7066745">praw</span><span class="op" id="7066749">.</span><span class="ident" id="7066750">String</span><span class="op" id="7066756">(</span><span class="op" id="7066757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066762">if</span>&nbsp;<span class="ident" id="7066765">sraw</span>&nbsp;<span class="op" id="7066770">!=</span>&nbsp;<span class="ident" id="7066773">tt</span><span class="op" id="7066775">.</span><span class="ident" id="7066776">WantProxy</span>&nbsp;<span class="op" id="7066786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066792">t</span><span class="op" id="7066793">.</span><span class="ident" id="7066794">Errorf</span><span class="op" id="7066800">(</span><span class="string" id="7066801">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7066844">,</span>&nbsp;<span class="ident" id="7066846">i</span><span class="op" id="7066847">,</span>&nbsp;<span class="ident" id="7066849">tt</span><span class="op" id="7066851">.</span><span class="ident" id="7066852">WantProxy</span><span class="op" id="7066861">,</span>&nbsp;<span class="ident" id="7066863">sraw</span><span class="op" id="7066867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7066873">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066892">}</span><br>
<span class="lineno"></span><span class="op" id="7066894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7066897">type</span>&nbsp;<span class="ident" id="7066902">closeChecker</span>&nbsp;<span class="keyword" id="7066915">struct</span>&nbsp;<span class="op" id="7066922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066925">io</span><span class="op" id="7066927">.</span><span class="ident" id="7066928">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066936">closed</span>&nbsp;<span class="builtintype" id="7066943">bool</span><br>
<span class="lineno"></span><span class="op" id="7066948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="7066951">func</span>&nbsp;<span class="op" id="7066956">(</span><span class="ident" id="7066957">rc</span>&nbsp;<span class="op" id="7066960">*</span><span class="ident" id="7066961">closeChecker</span><span class="op" id="7066973">)</span>&nbsp;<span class="ident" id="7066975">Close</span><span class="op" id="7066980">(</span><span class="op" id="7066981">)</span>&nbsp;<span class="builtintype" id="7066983">error</span>&nbsp;<span class="op" id="7066989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066992">rc</span><span class="op" id="7066994">.</span><span class="ident" id="7066995">closed</span>&nbsp;<span class="op" id="7067002">=</span>&nbsp;<span class="builtintype" id="7067004">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7067010">return</span>&nbsp;<span class="ident" id="7067017">nil</span><br>
<span class="lineno"></span><span class="op" id="7067021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="7067024">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="7067108">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="7067191">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="7067251">func</span>&nbsp;<span class="ident" id="7067256">TestRequestWriteClosesBody</span><span class="op" id="7067282">(</span><span class="ident" id="7067283">t</span>&nbsp;<span class="op" id="7067285">*</span><span class="ident" id="7067286">testing</span><span class="op" id="7067293">.</span><span class="ident" id="7067294">T</span><span class="op" id="7067295">)</span>&nbsp;<span class="op" id="7067297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067300">rc</span>&nbsp;<span class="op" id="7067303">:=</span>&nbsp;<span class="op" id="7067306">&amp;</span><span class="ident" id="7067307">closeChecker</span><span class="op" id="7067319">{</span><span class="ident" id="7067320">Reader</span><span class="op" id="7067326">:</span>&nbsp;<span class="ident" id="7067328">strings</span><span class="op" id="7067335">.</span><span class="ident" id="7067336">NewReader</span><span class="op" id="7067345">(</span><span class="string" id="7067346">&#34;my&nbsp;body&#34;</span><span class="op" id="7067355">)</span><span class="op" id="7067356">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067359">req</span><span class="op" id="7067362">,</span>&nbsp;<span class="ident" id="7067364">_</span>&nbsp;<span class="op" id="7067366">:=</span>&nbsp;<span class="ident" id="7067369">NewRequest</span><span class="op" id="7067379">(</span><span class="string" id="7067380">&#34;POST&#34;</span><span class="op" id="7067386">,</span>&nbsp;<span class="string" id="7067388">&#34;http://foo.com/&#34;</span><span class="op" id="7067405">,</span>&nbsp;<span class="ident" id="7067407">rc</span><span class="op" id="7067409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7067412">if</span>&nbsp;<span class="ident" id="7067415">req</span><span class="op" id="7067418">.</span><span class="ident" id="7067419">ContentLength</span>&nbsp;<span class="op" id="7067433">!=</span>&nbsp;<span class="num" id="7067436">0</span>&nbsp;<span class="op" id="7067438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067442">t</span><span class="op" id="7067443">.</span><span class="ident" id="7067444">Errorf</span><span class="op" id="7067450">(</span><span class="string" id="7067451">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="7067485">,</span>&nbsp;<span class="ident" id="7067487">req</span><span class="op" id="7067490">.</span><span class="ident" id="7067491">ContentLength</span><span class="op" id="7067504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067510">buf</span>&nbsp;<span class="op" id="7067514">:=</span>&nbsp;<span class="builtinfunc" id="7067517">new</span><span class="op" id="7067520">(</span><span class="ident" id="7067521">bytes</span><span class="op" id="7067526">.</span><span class="ident" id="7067527">Buffer</span><span class="op" id="7067533">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067536">req</span><span class="op" id="7067539">.</span><span class="ident" id="7067540">Write</span><span class="op" id="7067545">(</span><span class="ident" id="7067546">buf</span><span class="op" id="7067549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7067552">if</span>&nbsp;<span class="op" id="7067555">!</span><span class="ident" id="7067556">rc</span><span class="op" id="7067558">.</span><span class="ident" id="7067559">closed</span>&nbsp;<span class="op" id="7067566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067570">t</span><span class="op" id="7067571">.</span><span class="ident" id="7067572">Error</span><span class="op" id="7067577">(</span><span class="string" id="7067578">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="7067607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067613">expected</span>&nbsp;<span class="op" id="7067622">:=</span>&nbsp;<span class="string" id="7067625">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7067647">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067651">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="7067671">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067675">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7067713">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067717">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7067754">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7067758">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7067824">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7067894">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7067965">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068022">chunk</span><span class="op" id="7068027">(</span><span class="string" id="7068028">&#34;m&#34;</span><span class="op" id="7068031">)</span>&nbsp;<span class="op" id="7068033">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068037">chunk</span><span class="op" id="7068042">(</span><span class="string" id="7068043">&#34;y&nbsp;body&#34;</span><span class="op" id="7068051">)</span>&nbsp;<span class="op" id="7068053">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068057">chunk</span><span class="op" id="7068062">(</span><span class="string" id="7068063">&#34;&#34;</span><span class="op" id="7068065">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068068">if</span>&nbsp;<span class="ident" id="7068071">buf</span><span class="op" id="7068074">.</span><span class="ident" id="7068075">String</span><span class="op" id="7068081">(</span><span class="op" id="7068082">)</span>&nbsp;<span class="op" id="7068084">!=</span>&nbsp;<span class="ident" id="7068087">expected</span>&nbsp;<span class="op" id="7068096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068100">t</span><span class="op" id="7068101">.</span><span class="ident" id="7068102">Errorf</span><span class="op" id="7068108">(</span><span class="string" id="7068109">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="7068137">,</span>&nbsp;<span class="ident" id="7068139">buf</span><span class="op" id="7068142">.</span><span class="ident" id="7068143">String</span><span class="op" id="7068149">(</span><span class="op" id="7068150">)</span><span class="op" id="7068151">,</span>&nbsp;<span class="ident" id="7068153">expected</span><span class="op" id="7068161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068164">}</span><br>
<span class="lineno"></span><span class="op" id="7068166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="7068169">func</span>&nbsp;<span class="ident" id="7068174">chunk</span><span class="op" id="7068179">(</span><span class="ident" id="7068180">s</span>&nbsp;<span class="builtintype" id="7068182">string</span><span class="op" id="7068188">)</span>&nbsp;<span class="builtintype" id="7068190">string</span>&nbsp;<span class="op" id="7068197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068200">return</span>&nbsp;<span class="ident" id="7068207">fmt</span><span class="op" id="7068210">.</span><span class="ident" id="7068211">Sprintf</span><span class="op" id="7068218">(</span><span class="string" id="7068219">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="7068233">,</span>&nbsp;<span class="builtinfunc" id="7068235">len</span><span class="op" id="7068238">(</span><span class="ident" id="7068239">s</span><span class="op" id="7068240">)</span><span class="op" id="7068241">,</span>&nbsp;<span class="ident" id="7068243">s</span><span class="op" id="7068244">)</span><br>
<span class="lineno"></span><span class="op" id="7068246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7068249">func</span>&nbsp;<span class="ident" id="7068254">mustParseURL</span><span class="op" id="7068266">(</span><span class="ident" id="7068267">s</span>&nbsp;<span class="builtintype" id="7068269">string</span><span class="op" id="7068275">)</span>&nbsp;<span class="op" id="7068277">*</span><span class="ident" id="7068278">url</span><span class="op" id="7068281">.</span><span class="ident" id="7068282">URL</span>&nbsp;<span class="op" id="7068286">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068289">u</span><span class="op" id="7068290">,</span>&nbsp;<span class="ident" id="7068292">err</span>&nbsp;<span class="op" id="7068296">:=</span>&nbsp;<span class="ident" id="7068299">url</span><span class="op" id="7068302">.</span><span class="ident" id="7068303">Parse</span><span class="op" id="7068308">(</span><span class="ident" id="7068309">s</span><span class="op" id="7068310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068313">if</span>&nbsp;<span class="ident" id="7068316">err</span>&nbsp;<span class="op" id="7068320">!=</span>&nbsp;<span class="ident" id="7068323">nil</span>&nbsp;<span class="op" id="7068327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7068331">panic</span><span class="op" id="7068336">(</span><span class="ident" id="7068337">fmt</span><span class="op" id="7068340">.</span><span class="ident" id="7068341">Sprintf</span><span class="op" id="7068348">(</span><span class="string" id="7068349">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7068375">,</span>&nbsp;<span class="ident" id="7068377">s</span><span class="op" id="7068378">,</span>&nbsp;<span class="ident" id="7068380">err</span><span class="op" id="7068383">)</span><span class="op" id="7068384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068390">return</span>&nbsp;<span class="ident" id="7068397">u</span><br>
<span class="lineno">565</span><span class="op" id="7068399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7068402">type</span>&nbsp;<span class="ident" id="7068407">writerFunc</span>&nbsp;<span class="keyword" id="7068418">func</span><span class="op" id="7068422">(</span><span class="op" id="7068423">[</span><span class="op" id="7068424">]</span><span class="builtintype" id="7068425">byte</span><span class="op" id="7068429">)</span>&nbsp;<span class="op" id="7068431">(</span><span class="builtintype" id="7068432">int</span><span class="op" id="7068435">,</span>&nbsp;<span class="builtintype" id="7068437">error</span><span class="op" id="7068442">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7068445">func</span>&nbsp;<span class="op" id="7068450">(</span><span class="ident" id="7068451">f</span>&nbsp;<span class="ident" id="7068453">writerFunc</span><span class="op" id="7068463">)</span>&nbsp;<span class="ident" id="7068465">Write</span><span class="op" id="7068470">(</span><span class="ident" id="7068471">p</span>&nbsp;<span class="op" id="7068473">[</span><span class="op" id="7068474">]</span><span class="builtintype" id="7068475">byte</span><span class="op" id="7068479">)</span>&nbsp;<span class="op" id="7068481">(</span><span class="builtintype" id="7068482">int</span><span class="op" id="7068485">,</span>&nbsp;<span class="builtintype" id="7068487">error</span><span class="op" id="7068492">)</span>&nbsp;<span class="op" id="7068494">{</span>&nbsp;<span class="keyword" id="7068496">return</span>&nbsp;<span class="ident" id="7068503">f</span><span class="op" id="7068504">(</span><span class="ident" id="7068505">p</span><span class="op" id="7068506">)</span>&nbsp;<span class="op" id="7068508">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="7068511">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="7068591">func</span>&nbsp;<span class="ident" id="7068596">TestRequestWriteError</span><span class="op" id="7068617">(</span><span class="ident" id="7068618">t</span>&nbsp;<span class="op" id="7068620">*</span><span class="ident" id="7068621">testing</span><span class="op" id="7068628">.</span><span class="ident" id="7068629">T</span><span class="op" id="7068630">)</span>&nbsp;<span class="op" id="7068632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068635">failAfter</span><span class="op" id="7068644">,</span>&nbsp;<span class="ident" id="7068646">writeCount</span>&nbsp;<span class="op" id="7068657">:=</span>&nbsp;<span class="num" id="7068660">0</span><span class="op" id="7068661">,</span>&nbsp;<span class="num" id="7068663">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068666">errFail</span>&nbsp;<span class="op" id="7068674">:=</span>&nbsp;<span class="ident" id="7068677">errors</span><span class="op" id="7068683">.</span><span class="ident" id="7068684">New</span><span class="op" id="7068687">(</span><span class="string" id="7068688">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="7068708">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7068712">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7068773">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7068836">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7068889">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068905">w</span>&nbsp;<span class="op" id="7068907">:=</span>&nbsp;<span class="keyword" id="7068910">struct</span>&nbsp;<span class="op" id="7068917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068921">io</span><span class="op" id="7068923">.</span><span class="ident" id="7068924">ByteWriter</span>&nbsp;<span class="comment" id="7068935">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068981">io</span><span class="op" id="7068983">.</span><span class="ident" id="7068984">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068992">}</span><span class="op" id="7068993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068997">nil</span><span class="op" id="7069000">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069004">writerFunc</span><span class="op" id="7069014">(</span><span class="keyword" id="7069015">func</span><span class="op" id="7069019">(</span><span class="ident" id="7069020">p</span>&nbsp;<span class="op" id="7069022">[</span><span class="op" id="7069023">]</span><span class="builtintype" id="7069024">byte</span><span class="op" id="7069028">)</span>&nbsp;<span class="op" id="7069030">(</span><span class="ident" id="7069031">n</span>&nbsp;<span class="builtintype" id="7069033">int</span><span class="op" id="7069036">,</span>&nbsp;<span class="ident" id="7069038">err</span>&nbsp;<span class="builtintype" id="7069042">error</span><span class="op" id="7069047">)</span>&nbsp;<span class="op" id="7069049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069054">writeCount</span><span class="op" id="7069064">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069070">if</span>&nbsp;<span class="ident" id="7069073">failAfter</span>&nbsp;<span class="op" id="7069083">==</span>&nbsp;<span class="num" id="7069086">0</span>&nbsp;<span class="op" id="7069088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069094">err</span>&nbsp;<span class="op" id="7069098">=</span>&nbsp;<span class="ident" id="7069100">errFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069111">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069116">failAfter</span><span class="op" id="7069125">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069131">return</span>&nbsp;<span class="builtinfunc" id="7069138">len</span><span class="op" id="7069141">(</span><span class="ident" id="7069142">p</span><span class="op" id="7069143">)</span><span class="op" id="7069144">,</span>&nbsp;<span class="ident" id="7069146">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069152">}</span><span class="op" id="7069153">)</span><span class="op" id="7069154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069161">req</span><span class="op" id="7069164">,</span>&nbsp;<span class="ident" id="7069166">_</span>&nbsp;<span class="op" id="7069168">:=</span>&nbsp;<span class="ident" id="7069171">NewRequest</span><span class="op" id="7069181">(</span><span class="string" id="7069182">&#34;GET&#34;</span><span class="op" id="7069187">,</span>&nbsp;<span class="string" id="7069189">&#34;http://example.com/&#34;</span><span class="op" id="7069210">,</span>&nbsp;<span class="ident" id="7069212">nil</span><span class="op" id="7069215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069218">const</span>&nbsp;<span class="ident" id="7069224">writeCalls</span>&nbsp;<span class="op" id="7069235">=</span>&nbsp;<span class="num" id="7069237">4</span>&nbsp;<span class="comment" id="7069239">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069291">sawGood</span>&nbsp;<span class="op" id="7069299">:=</span>&nbsp;<span class="builtintype" id="7069302">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069309">for</span>&nbsp;<span class="ident" id="7069313">n</span>&nbsp;<span class="op" id="7069315">:=</span>&nbsp;<span class="num" id="7069318">0</span><span class="op" id="7069319">;</span>&nbsp;<span class="ident" id="7069321">n</span>&nbsp;<span class="op" id="7069323">&lt;=</span>&nbsp;<span class="ident" id="7069326">writeCalls</span><span class="op" id="7069336">+</span><span class="num" id="7069337">2</span><span class="op" id="7069338">;</span>&nbsp;<span class="ident" id="7069340">n</span><span class="op" id="7069341">++</span>&nbsp;<span class="op" id="7069344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069348">failAfter</span>&nbsp;<span class="op" id="7069358">=</span>&nbsp;<span class="ident" id="7069360">n</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069364">writeCount</span>&nbsp;<span class="op" id="7069375">=</span>&nbsp;<span class="num" id="7069377">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069381">err</span>&nbsp;<span class="op" id="7069385">:=</span>&nbsp;<span class="ident" id="7069388">req</span><span class="op" id="7069391">.</span><span class="ident" id="7069392">Write</span><span class="op" id="7069397">(</span><span class="ident" id="7069398">w</span><span class="op" id="7069399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069403">var</span>&nbsp;<span class="ident" id="7069407">wantErr</span>&nbsp;<span class="builtintype" id="7069415">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069423">if</span>&nbsp;<span class="ident" id="7069426">n</span>&nbsp;<span class="op" id="7069428">&lt;</span>&nbsp;<span class="ident" id="7069430">writeCalls</span>&nbsp;<span class="op" id="7069441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069446">wantErr</span>&nbsp;<span class="op" id="7069454">=</span>&nbsp;<span class="ident" id="7069456">errFail</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069470">if</span>&nbsp;<span class="ident" id="7069473">err</span>&nbsp;<span class="op" id="7069477">!=</span>&nbsp;<span class="ident" id="7069480">wantErr</span>&nbsp;<span class="op" id="7069488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069493">t</span><span class="op" id="7069494">.</span><span class="ident" id="7069495">Errorf</span><span class="op" id="7069501">(</span><span class="string" id="7069502">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7069547">,</span>&nbsp;<span class="ident" id="7069549">n</span><span class="op" id="7069550">,</span>&nbsp;<span class="ident" id="7069552">err</span><span class="op" id="7069555">,</span>&nbsp;<span class="ident" id="7069557">wantErr</span><span class="op" id="7069564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069569">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069580">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069584">if</span>&nbsp;<span class="ident" id="7069587">err</span>&nbsp;<span class="op" id="7069591">==</span>&nbsp;<span class="ident" id="7069594">nil</span>&nbsp;<span class="op" id="7069598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069603">sawGood</span>&nbsp;<span class="op" id="7069611">=</span>&nbsp;<span class="builtintype" id="7069613">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069621">if</span>&nbsp;<span class="ident" id="7069624">writeCount</span>&nbsp;<span class="op" id="7069635">!=</span>&nbsp;<span class="ident" id="7069638">writeCalls</span>&nbsp;<span class="op" id="7069649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069655">t</span><span class="op" id="7069656">.</span><span class="ident" id="7069657">Fatalf</span><span class="op" id="7069663">(</span><span class="string" id="7069664">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7069705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069710">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069718">if</span>&nbsp;<span class="ident" id="7069721">writeCount</span>&nbsp;<span class="op" id="7069732">&gt;</span>&nbsp;<span class="ident" id="7069734">writeCalls</span>&nbsp;<span class="op" id="7069745">||</span>&nbsp;<span class="ident" id="7069748">writeCount</span>&nbsp;<span class="op" id="7069759">&gt;</span>&nbsp;<span class="ident" id="7069761">n</span><span class="op" id="7069762">+</span><span class="num" id="7069763">1</span>&nbsp;<span class="op" id="7069765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069770">t</span><span class="op" id="7069771">.</span><span class="ident" id="7069772">Errorf</span><span class="op" id="7069778">(</span><span class="string" id="7069779">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="7069838">,</span>&nbsp;<span class="ident" id="7069840">n</span><span class="op" id="7069841">,</span>&nbsp;<span class="ident" id="7069843">writeCount</span><span class="op" id="7069853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069860">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069863">if</span>&nbsp;<span class="op" id="7069866">!</span><span class="ident" id="7069867">sawGood</span>&nbsp;<span class="op" id="7069875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069879">t</span><span class="op" id="7069880">.</span><span class="ident" id="7069881">Fatalf</span><span class="op" id="7069887">(</span><span class="string" id="7069888">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7069929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069932">}</span><br>
<span class="lineno"></span><span class="op" id="7069934">}</span>
</div>
</body>
</html>
