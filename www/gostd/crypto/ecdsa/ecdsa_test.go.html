<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7461717">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7461772">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7461826">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7461877">package</span>&nbsp;<span class="ident" id="7461885">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7461892">import</span>&nbsp;<span class="op" id="7461899">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7461902">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7461911">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7461929">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7461948">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7461963">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7461978">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7461995">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7462012">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7462028">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7462036">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7462042">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7462054">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7462060">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7462071">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7462081">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7462084">func</span>&nbsp;<span class="ident" id="7462089">testKeyGeneration</span><span class="op" id="7462106">(</span><span class="ident" id="7462107">t</span>&nbsp;<span class="op" id="7462109">*</span><span class="ident" id="7462110">testing</span><span class="op" id="7462117">.</span><span class="ident" id="7462118">T</span><span class="op" id="7462119">,</span>&nbsp;<span class="ident" id="7462121">c</span>&nbsp;<span class="ident" id="7462123">elliptic</span><span class="op" id="7462131">.</span><span class="ident" id="7462132">Curve</span><span class="op" id="7462137">,</span>&nbsp;<span class="ident" id="7462139">tag</span>&nbsp;<span class="builtintype" id="7462143">string</span><span class="op" id="7462149">)</span>&nbsp;<span class="op" id="7462151">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462154">priv</span><span class="op" id="7462158">,</span>&nbsp;<span class="ident" id="7462160">err</span>&nbsp;<span class="op" id="7462164">:=</span>&nbsp;<span class="ident" id="7462167">GenerateKey</span><span class="op" id="7462178">(</span><span class="ident" id="7462179">c</span><span class="op" id="7462180">,</span>&nbsp;<span class="ident" id="7462182">rand</span><span class="op" id="7462186">.</span><span class="ident" id="7462187">Reader</span><span class="op" id="7462193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462196">if</span>&nbsp;<span class="ident" id="7462199">err</span>&nbsp;<span class="op" id="7462203">!=</span>&nbsp;<span class="ident" id="7462206">nil</span>&nbsp;<span class="op" id="7462210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462214">t</span><span class="op" id="7462215">.</span><span class="ident" id="7462216">Errorf</span><span class="op" id="7462222">(</span><span class="string" id="7462223">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7462238">,</span>&nbsp;<span class="ident" id="7462240">tag</span><span class="op" id="7462243">,</span>&nbsp;<span class="ident" id="7462245">err</span><span class="op" id="7462248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462252">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7462260">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462263">if</span>&nbsp;<span class="op" id="7462266">!</span><span class="ident" id="7462267">c</span><span class="op" id="7462268">.</span><span class="ident" id="7462269">IsOnCurve</span><span class="op" id="7462278">(</span><span class="ident" id="7462279">priv</span><span class="op" id="7462283">.</span><span class="ident" id="7462284">PublicKey</span><span class="op" id="7462293">.</span><span class="ident" id="7462294">X</span><span class="op" id="7462295">,</span>&nbsp;<span class="ident" id="7462297">priv</span><span class="op" id="7462301">.</span><span class="ident" id="7462302">PublicKey</span><span class="op" id="7462311">.</span><span class="ident" id="7462312">Y</span><span class="op" id="7462313">)</span>&nbsp;<span class="op" id="7462315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462319">t</span><span class="op" id="7462320">.</span><span class="ident" id="7462321">Errorf</span><span class="op" id="7462327">(</span><span class="string" id="7462328">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="7462356">,</span>&nbsp;<span class="ident" id="7462358">tag</span><span class="op" id="7462361">,</span>&nbsp;<span class="ident" id="7462363">err</span><span class="op" id="7462366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7462369">}</span><br>
<span class="lineno"></span><span class="op" id="7462371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7462374">func</span>&nbsp;<span class="ident" id="7462379">TestKeyGeneration</span><span class="op" id="7462396">(</span><span class="ident" id="7462397">t</span>&nbsp;<span class="op" id="7462399">*</span><span class="ident" id="7462400">testing</span><span class="op" id="7462407">.</span><span class="ident" id="7462408">T</span><span class="op" id="7462409">)</span>&nbsp;<span class="op" id="7462411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462414">testKeyGeneration</span><span class="op" id="7462431">(</span><span class="ident" id="7462432">t</span><span class="op" id="7462433">,</span>&nbsp;<span class="ident" id="7462435">elliptic</span><span class="op" id="7462443">.</span><span class="ident" id="7462444">P224</span><span class="op" id="7462448">(</span><span class="op" id="7462449">)</span><span class="op" id="7462450">,</span>&nbsp;<span class="string" id="7462452">&#34;p224&#34;</span><span class="op" id="7462458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462461">if</span>&nbsp;<span class="ident" id="7462464">testing</span><span class="op" id="7462471">.</span><span class="ident" id="7462472">Short</span><span class="op" id="7462477">(</span><span class="op" id="7462478">)</span>&nbsp;<span class="op" id="7462480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462484">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7462492">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462495">testKeyGeneration</span><span class="op" id="7462512">(</span><span class="ident" id="7462513">t</span><span class="op" id="7462514">,</span>&nbsp;<span class="ident" id="7462516">elliptic</span><span class="op" id="7462524">.</span><span class="ident" id="7462525">P256</span><span class="op" id="7462529">(</span><span class="op" id="7462530">)</span><span class="op" id="7462531">,</span>&nbsp;<span class="string" id="7462533">&#34;p256&#34;</span><span class="op" id="7462539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462542">testKeyGeneration</span><span class="op" id="7462559">(</span><span class="ident" id="7462560">t</span><span class="op" id="7462561">,</span>&nbsp;<span class="ident" id="7462563">elliptic</span><span class="op" id="7462571">.</span><span class="ident" id="7462572">P384</span><span class="op" id="7462576">(</span><span class="op" id="7462577">)</span><span class="op" id="7462578">,</span>&nbsp;<span class="string" id="7462580">&#34;p384&#34;</span><span class="op" id="7462586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462589">testKeyGeneration</span><span class="op" id="7462606">(</span><span class="ident" id="7462607">t</span><span class="op" id="7462608">,</span>&nbsp;<span class="ident" id="7462610">elliptic</span><span class="op" id="7462618">.</span><span class="ident" id="7462619">P521</span><span class="op" id="7462623">(</span><span class="op" id="7462624">)</span><span class="op" id="7462625">,</span>&nbsp;<span class="string" id="7462627">&#34;p521&#34;</span><span class="op" id="7462633">)</span><br>
<span class="lineno"></span><span class="op" id="7462635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7462638">func</span>&nbsp;<span class="ident" id="7462643">testSignAndVerify</span><span class="op" id="7462660">(</span><span class="ident" id="7462661">t</span>&nbsp;<span class="op" id="7462663">*</span><span class="ident" id="7462664">testing</span><span class="op" id="7462671">.</span><span class="ident" id="7462672">T</span><span class="op" id="7462673">,</span>&nbsp;<span class="ident" id="7462675">c</span>&nbsp;<span class="ident" id="7462677">elliptic</span><span class="op" id="7462685">.</span><span class="ident" id="7462686">Curve</span><span class="op" id="7462691">,</span>&nbsp;<span class="ident" id="7462693">tag</span>&nbsp;<span class="builtintype" id="7462697">string</span><span class="op" id="7462703">)</span>&nbsp;<span class="op" id="7462705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462708">priv</span><span class="op" id="7462712">,</span>&nbsp;<span class="ident" id="7462714">_</span>&nbsp;<span class="op" id="7462716">:=</span>&nbsp;<span class="ident" id="7462719">GenerateKey</span><span class="op" id="7462730">(</span><span class="ident" id="7462731">c</span><span class="op" id="7462732">,</span>&nbsp;<span class="ident" id="7462734">rand</span><span class="op" id="7462738">.</span><span class="ident" id="7462739">Reader</span><span class="op" id="7462745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462749">hashed</span>&nbsp;<span class="op" id="7462756">:=</span>&nbsp;<span class="op" id="7462759">[</span><span class="op" id="7462760">]</span><span class="builtintype" id="7462761">byte</span><span class="op" id="7462765">(</span><span class="string" id="7462766">&#34;testing&#34;</span><span class="op" id="7462775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462778">r</span><span class="op" id="7462779">,</span>&nbsp;<span class="ident" id="7462781">s</span><span class="op" id="7462782">,</span>&nbsp;<span class="ident" id="7462784">err</span>&nbsp;<span class="op" id="7462788">:=</span>&nbsp;<span class="ident" id="7462791">Sign</span><span class="op" id="7462795">(</span><span class="ident" id="7462796">rand</span><span class="op" id="7462800">.</span><span class="ident" id="7462801">Reader</span><span class="op" id="7462807">,</span>&nbsp;<span class="ident" id="7462809">priv</span><span class="op" id="7462813">,</span>&nbsp;<span class="ident" id="7462815">hashed</span><span class="op" id="7462821">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462824">if</span>&nbsp;<span class="ident" id="7462827">err</span>&nbsp;<span class="op" id="7462831">!=</span>&nbsp;<span class="ident" id="7462834">nil</span>&nbsp;<span class="op" id="7462838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462842">t</span><span class="op" id="7462843">.</span><span class="ident" id="7462844">Errorf</span><span class="op" id="7462850">(</span><span class="string" id="7462851">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7462874">,</span>&nbsp;<span class="ident" id="7462876">tag</span><span class="op" id="7462879">,</span>&nbsp;<span class="ident" id="7462881">err</span><span class="op" id="7462884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462888">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7462896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462900">if</span>&nbsp;<span class="op" id="7462903">!</span><span class="ident" id="7462904">Verify</span><span class="op" id="7462910">(</span><span class="op" id="7462911">&amp;</span><span class="ident" id="7462912">priv</span><span class="op" id="7462916">.</span><span class="ident" id="7462917">PublicKey</span><span class="op" id="7462926">,</span>&nbsp;<span class="ident" id="7462928">hashed</span><span class="op" id="7462934">,</span>&nbsp;<span class="ident" id="7462936">r</span><span class="op" id="7462937">,</span>&nbsp;<span class="ident" id="7462939">s</span><span class="op" id="7462940">)</span>&nbsp;<span class="op" id="7462942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462946">t</span><span class="op" id="7462947">.</span><span class="ident" id="7462948">Errorf</span><span class="op" id="7462954">(</span><span class="string" id="7462955">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7462974">,</span>&nbsp;<span class="ident" id="7462976">tag</span><span class="op" id="7462979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7462982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462986">hashed</span><span class="op" id="7462992">[</span><span class="num" id="7462993">0</span><span class="op" id="7462994">]</span>&nbsp;<span class="op" id="7462996">^=</span>&nbsp;<span class="num" id="7462999">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463005">if</span>&nbsp;<span class="ident" id="7463008">Verify</span><span class="op" id="7463014">(</span><span class="op" id="7463015">&amp;</span><span class="ident" id="7463016">priv</span><span class="op" id="7463020">.</span><span class="ident" id="7463021">PublicKey</span><span class="op" id="7463030">,</span>&nbsp;<span class="ident" id="7463032">hashed</span><span class="op" id="7463038">,</span>&nbsp;<span class="ident" id="7463040">r</span><span class="op" id="7463041">,</span>&nbsp;<span class="ident" id="7463043">s</span><span class="op" id="7463044">)</span>&nbsp;<span class="op" id="7463046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463050">t</span><span class="op" id="7463051">.</span><span class="ident" id="7463052">Errorf</span><span class="op" id="7463058">(</span><span class="string" id="7463059">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="7463085">,</span>&nbsp;<span class="ident" id="7463087">tag</span><span class="op" id="7463090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463093">}</span><br>
<span class="lineno"></span><span class="op" id="7463095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7463098">func</span>&nbsp;<span class="ident" id="7463103">TestSignAndVerify</span><span class="op" id="7463120">(</span><span class="ident" id="7463121">t</span>&nbsp;<span class="op" id="7463123">*</span><span class="ident" id="7463124">testing</span><span class="op" id="7463131">.</span><span class="ident" id="7463132">T</span><span class="op" id="7463133">)</span>&nbsp;<span class="op" id="7463135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463138">testSignAndVerify</span><span class="op" id="7463155">(</span><span class="ident" id="7463156">t</span><span class="op" id="7463157">,</span>&nbsp;<span class="ident" id="7463159">elliptic</span><span class="op" id="7463167">.</span><span class="ident" id="7463168">P224</span><span class="op" id="7463172">(</span><span class="op" id="7463173">)</span><span class="op" id="7463174">,</span>&nbsp;<span class="string" id="7463176">&#34;p224&#34;</span><span class="op" id="7463182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463185">if</span>&nbsp;<span class="ident" id="7463188">testing</span><span class="op" id="7463195">.</span><span class="ident" id="7463196">Short</span><span class="op" id="7463201">(</span><span class="op" id="7463202">)</span>&nbsp;<span class="op" id="7463204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463208">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463216">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463219">testSignAndVerify</span><span class="op" id="7463236">(</span><span class="ident" id="7463237">t</span><span class="op" id="7463238">,</span>&nbsp;<span class="ident" id="7463240">elliptic</span><span class="op" id="7463248">.</span><span class="ident" id="7463249">P256</span><span class="op" id="7463253">(</span><span class="op" id="7463254">)</span><span class="op" id="7463255">,</span>&nbsp;<span class="string" id="7463257">&#34;p256&#34;</span><span class="op" id="7463263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463266">testSignAndVerify</span><span class="op" id="7463283">(</span><span class="ident" id="7463284">t</span><span class="op" id="7463285">,</span>&nbsp;<span class="ident" id="7463287">elliptic</span><span class="op" id="7463295">.</span><span class="ident" id="7463296">P384</span><span class="op" id="7463300">(</span><span class="op" id="7463301">)</span><span class="op" id="7463302">,</span>&nbsp;<span class="string" id="7463304">&#34;p384&#34;</span><span class="op" id="7463310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463313">testSignAndVerify</span><span class="op" id="7463330">(</span><span class="ident" id="7463331">t</span><span class="op" id="7463332">,</span>&nbsp;<span class="ident" id="7463334">elliptic</span><span class="op" id="7463342">.</span><span class="ident" id="7463343">P521</span><span class="op" id="7463347">(</span><span class="op" id="7463348">)</span><span class="op" id="7463349">,</span>&nbsp;<span class="string" id="7463351">&#34;p521&#34;</span><span class="op" id="7463357">)</span><br>
<span class="lineno"></span><span class="op" id="7463359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7463362">func</span>&nbsp;<span class="ident" id="7463367">fromHex</span><span class="op" id="7463374">(</span><span class="ident" id="7463375">s</span>&nbsp;<span class="builtintype" id="7463377">string</span><span class="op" id="7463383">)</span>&nbsp;<span class="op" id="7463385">*</span><span class="ident" id="7463386">big</span><span class="op" id="7463389">.</span><span class="ident" id="7463390">Int</span>&nbsp;<span class="op" id="7463394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463397">r</span><span class="op" id="7463398">,</span>&nbsp;<span class="ident" id="7463400">ok</span>&nbsp;<span class="op" id="7463403">:=</span>&nbsp;<span class="builtinfunc" id="7463406">new</span><span class="op" id="7463409">(</span><span class="ident" id="7463410">big</span><span class="op" id="7463413">.</span><span class="ident" id="7463414">Int</span><span class="op" id="7463417">)</span><span class="op" id="7463418">.</span><span class="ident" id="7463419">SetString</span><span class="op" id="7463428">(</span><span class="ident" id="7463429">s</span><span class="op" id="7463430">,</span>&nbsp;<span class="num" id="7463432">16</span><span class="op" id="7463434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463437">if</span>&nbsp;<span class="op" id="7463440">!</span><span class="ident" id="7463441">ok</span>&nbsp;<span class="op" id="7463444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7463448">panic</span><span class="op" id="7463453">(</span><span class="string" id="7463454">&#34;bad&nbsp;hex&#34;</span><span class="op" id="7463463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463466">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463469">return</span>&nbsp;<span class="ident" id="7463476">r</span><br>
<span class="lineno"></span><span class="op" id="7463478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7463481">func</span>&nbsp;<span class="ident" id="7463486">TestVectors</span><span class="op" id="7463497">(</span><span class="ident" id="7463498">t</span>&nbsp;<span class="op" id="7463500">*</span><span class="ident" id="7463501">testing</span><span class="op" id="7463508">.</span><span class="ident" id="7463509">T</span><span class="op" id="7463510">)</span>&nbsp;<span class="op" id="7463512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7463515">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7463573">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7463654">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7463658">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7463725">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463778">if</span>&nbsp;<span class="ident" id="7463781">testing</span><span class="op" id="7463788">.</span><span class="ident" id="7463789">Short</span><span class="op" id="7463794">(</span><span class="op" id="7463795">)</span>&nbsp;<span class="op" id="7463797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463801">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463813">f</span><span class="op" id="7463814">,</span>&nbsp;<span class="ident" id="7463816">err</span>&nbsp;<span class="op" id="7463820">:=</span>&nbsp;<span class="ident" id="7463823">os</span><span class="op" id="7463825">.</span><span class="ident" id="7463826">Open</span><span class="op" id="7463830">(</span><span class="string" id="7463831">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="7463856">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463859">if</span>&nbsp;<span class="ident" id="7463862">err</span>&nbsp;<span class="op" id="7463866">!=</span>&nbsp;<span class="ident" id="7463869">nil</span>&nbsp;<span class="op" id="7463873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463877">t</span><span class="op" id="7463878">.</span><span class="ident" id="7463879">Fatal</span><span class="op" id="7463884">(</span><span class="ident" id="7463885">err</span><span class="op" id="7463888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463895">buf</span>&nbsp;<span class="op" id="7463899">:=</span>&nbsp;<span class="ident" id="7463902">bufio</span><span class="op" id="7463907">.</span><span class="ident" id="7463908">NewReader</span><span class="op" id="7463917">(</span><span class="ident" id="7463918">bzip2</span><span class="op" id="7463923">.</span><span class="ident" id="7463924">NewReader</span><span class="op" id="7463933">(</span><span class="ident" id="7463934">f</span><span class="op" id="7463935">)</span><span class="op" id="7463936">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463940">lineNo</span>&nbsp;<span class="op" id="7463947">:=</span>&nbsp;<span class="num" id="7463950">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463953">var</span>&nbsp;<span class="ident" id="7463957">h</span>&nbsp;<span class="ident" id="7463959">hash</span><span class="op" id="7463963">.</span><span class="ident" id="7463964">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463970">var</span>&nbsp;<span class="ident" id="7463974">msg</span>&nbsp;<span class="op" id="7463978">[</span><span class="op" id="7463979">]</span><span class="builtintype" id="7463980">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463986">var</span>&nbsp;<span class="ident" id="7463990">hashed</span>&nbsp;<span class="op" id="7463997">[</span><span class="op" id="7463998">]</span><span class="builtintype" id="7463999">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464005">var</span>&nbsp;<span class="ident" id="7464009">r</span><span class="op" id="7464010">,</span>&nbsp;<span class="ident" id="7464012">s</span>&nbsp;<span class="op" id="7464014">*</span><span class="ident" id="7464015">big</span><span class="op" id="7464018">.</span><span class="ident" id="7464019">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464024">pub</span>&nbsp;<span class="op" id="7464028">:=</span>&nbsp;<span class="builtinfunc" id="7464031">new</span><span class="op" id="7464034">(</span><span class="ident" id="7464035">PublicKey</span><span class="op" id="7464044">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464048">for</span>&nbsp;<span class="op" id="7464052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464056">line</span><span class="op" id="7464060">,</span>&nbsp;<span class="ident" id="7464062">err</span>&nbsp;<span class="op" id="7464066">:=</span>&nbsp;<span class="ident" id="7464069">buf</span><span class="op" id="7464072">.</span><span class="ident" id="7464073">ReadString</span><span class="op" id="7464083">(</span><span class="string" id="7464084">&#39;\n&#39;</span><span class="op" id="7464088">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464092">if</span>&nbsp;<span class="builtinfunc" id="7464095">len</span><span class="op" id="7464098">(</span><span class="ident" id="7464099">line</span><span class="op" id="7464103">)</span>&nbsp;<span class="op" id="7464105">==</span>&nbsp;<span class="num" id="7464108">0</span>&nbsp;<span class="op" id="7464110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464115">if</span>&nbsp;<span class="ident" id="7464118">err</span>&nbsp;<span class="op" id="7464122">==</span>&nbsp;<span class="ident" id="7464125">io</span><span class="op" id="7464127">.</span><span class="ident" id="7464128">EOF</span>&nbsp;<span class="op" id="7464132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464138">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464152">t</span><span class="op" id="7464153">.</span><span class="ident" id="7464154">Fatalf</span><span class="op" id="7464160">(</span><span class="string" id="7464161">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="7464191">,</span>&nbsp;<span class="ident" id="7464193">err</span><span class="op" id="7464196">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464204">lineNo</span><span class="op" id="7464210">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7464215">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464266">if</span>&nbsp;<span class="op" id="7464269">!</span><span class="ident" id="7464270">strings</span><span class="op" id="7464277">.</span><span class="ident" id="7464278">HasSuffix</span><span class="op" id="7464287">(</span><span class="ident" id="7464288">line</span><span class="op" id="7464292">,</span>&nbsp;<span class="string" id="7464294">&#34;\r\n&#34;</span><span class="op" id="7464300">)</span>&nbsp;<span class="op" id="7464302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464307">t</span><span class="op" id="7464308">.</span><span class="ident" id="7464309">Fatalf</span><span class="op" id="7464315">(</span><span class="string" id="7464316">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7464362">,</span>&nbsp;<span class="ident" id="7464364">lineNo</span><span class="op" id="7464370">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464378">line</span>&nbsp;<span class="op" id="7464383">=</span>&nbsp;<span class="ident" id="7464385">line</span><span class="op" id="7464389">[</span><span class="op" id="7464390">:</span><span class="builtinfunc" id="7464391">len</span><span class="op" id="7464394">(</span><span class="ident" id="7464395">line</span><span class="op" id="7464399">)</span><span class="op" id="7464400">-</span><span class="num" id="7464401">2</span><span class="op" id="7464402">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464407">if</span>&nbsp;<span class="builtinfunc" id="7464410">len</span><span class="op" id="7464413">(</span><span class="ident" id="7464414">line</span><span class="op" id="7464418">)</span>&nbsp;<span class="op" id="7464420">==</span>&nbsp;<span class="num" id="7464423">0</span>&nbsp;<span class="op" id="7464425">||</span>&nbsp;<span class="ident" id="7464428">line</span><span class="op" id="7464432">[</span><span class="num" id="7464433">0</span><span class="op" id="7464434">]</span>&nbsp;<span class="op" id="7464436">==</span>&nbsp;<span class="string" id="7464439">&#39;#&#39;</span>&nbsp;<span class="op" id="7464443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464448">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464464">if</span>&nbsp;<span class="ident" id="7464467">line</span><span class="op" id="7464471">[</span><span class="num" id="7464472">0</span><span class="op" id="7464473">]</span>&nbsp;<span class="op" id="7464475">==</span>&nbsp;<span class="string" id="7464478">&#39;[&#39;</span>&nbsp;<span class="op" id="7464482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464487">line</span>&nbsp;<span class="op" id="7464492">=</span>&nbsp;<span class="ident" id="7464494">line</span><span class="op" id="7464498">[</span><span class="num" id="7464499">1</span>&nbsp;<span class="op" id="7464501">:</span>&nbsp;<span class="builtinfunc" id="7464503">len</span><span class="op" id="7464506">(</span><span class="ident" id="7464507">line</span><span class="op" id="7464511">)</span><span class="op" id="7464512">-</span><span class="num" id="7464513">1</span><span class="op" id="7464514">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464519">parts</span>&nbsp;<span class="op" id="7464525">:=</span>&nbsp;<span class="ident" id="7464528">strings</span><span class="op" id="7464535">.</span><span class="ident" id="7464536">SplitN</span><span class="op" id="7464542">(</span><span class="ident" id="7464543">line</span><span class="op" id="7464547">,</span>&nbsp;<span class="string" id="7464549">&#34;,&#34;</span><span class="op" id="7464552">,</span>&nbsp;<span class="num" id="7464554">2</span><span class="op" id="7464555">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464561">switch</span>&nbsp;<span class="ident" id="7464568">parts</span><span class="op" id="7464573">[</span><span class="num" id="7464574">0</span><span class="op" id="7464575">]</span>&nbsp;<span class="op" id="7464577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464582">case</span>&nbsp;<span class="string" id="7464587">&#34;P-224&#34;</span><span class="op" id="7464594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464600">pub</span><span class="op" id="7464603">.</span><span class="ident" id="7464604">Curve</span>&nbsp;<span class="op" id="7464610">=</span>&nbsp;<span class="ident" id="7464612">elliptic</span><span class="op" id="7464620">.</span><span class="ident" id="7464621">P224</span><span class="op" id="7464625">(</span><span class="op" id="7464626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464631">case</span>&nbsp;<span class="string" id="7464636">&#34;P-256&#34;</span><span class="op" id="7464643">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464649">pub</span><span class="op" id="7464652">.</span><span class="ident" id="7464653">Curve</span>&nbsp;<span class="op" id="7464659">=</span>&nbsp;<span class="ident" id="7464661">elliptic</span><span class="op" id="7464669">.</span><span class="ident" id="7464670">P256</span><span class="op" id="7464674">(</span><span class="op" id="7464675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464680">case</span>&nbsp;<span class="string" id="7464685">&#34;P-384&#34;</span><span class="op" id="7464692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464698">pub</span><span class="op" id="7464701">.</span><span class="ident" id="7464702">Curve</span>&nbsp;<span class="op" id="7464708">=</span>&nbsp;<span class="ident" id="7464710">elliptic</span><span class="op" id="7464718">.</span><span class="ident" id="7464719">P384</span><span class="op" id="7464723">(</span><span class="op" id="7464724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464729">case</span>&nbsp;<span class="string" id="7464734">&#34;P-521&#34;</span><span class="op" id="7464741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464747">pub</span><span class="op" id="7464750">.</span><span class="ident" id="7464751">Curve</span>&nbsp;<span class="op" id="7464757">=</span>&nbsp;<span class="ident" id="7464759">elliptic</span><span class="op" id="7464767">.</span><span class="ident" id="7464768">P521</span><span class="op" id="7464772">(</span><span class="op" id="7464773">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464778">default</span><span class="op" id="7464785">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464791">pub</span><span class="op" id="7464794">.</span><span class="ident" id="7464795">Curve</span>&nbsp;<span class="op" id="7464801">=</span>&nbsp;<span class="ident" id="7464803">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464816">switch</span>&nbsp;<span class="ident" id="7464823">parts</span><span class="op" id="7464828">[</span><span class="num" id="7464829">1</span><span class="op" id="7464830">]</span>&nbsp;<span class="op" id="7464832">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464837">case</span>&nbsp;<span class="string" id="7464842">&#34;SHA-1&#34;</span><span class="op" id="7464849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464855">h</span>&nbsp;<span class="op" id="7464857">=</span>&nbsp;<span class="ident" id="7464859">sha1</span><span class="op" id="7464863">.</span><span class="ident" id="7464864">New</span><span class="op" id="7464867">(</span><span class="op" id="7464868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464873">case</span>&nbsp;<span class="string" id="7464878">&#34;SHA-224&#34;</span><span class="op" id="7464887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464893">h</span>&nbsp;<span class="op" id="7464895">=</span>&nbsp;<span class="ident" id="7464897">sha256</span><span class="op" id="7464903">.</span><span class="ident" id="7464904">New224</span><span class="op" id="7464910">(</span><span class="op" id="7464911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464916">case</span>&nbsp;<span class="string" id="7464921">&#34;SHA-256&#34;</span><span class="op" id="7464930">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464936">h</span>&nbsp;<span class="op" id="7464938">=</span>&nbsp;<span class="ident" id="7464940">sha256</span><span class="op" id="7464946">.</span><span class="ident" id="7464947">New</span><span class="op" id="7464950">(</span><span class="op" id="7464951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464956">case</span>&nbsp;<span class="string" id="7464961">&#34;SHA-384&#34;</span><span class="op" id="7464970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464976">h</span>&nbsp;<span class="op" id="7464978">=</span>&nbsp;<span class="ident" id="7464980">sha512</span><span class="op" id="7464986">.</span><span class="ident" id="7464987">New384</span><span class="op" id="7464993">(</span><span class="op" id="7464994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464999">case</span>&nbsp;<span class="string" id="7465004">&#34;SHA-512&#34;</span><span class="op" id="7465013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465019">h</span>&nbsp;<span class="op" id="7465021">=</span>&nbsp;<span class="ident" id="7465023">sha512</span><span class="op" id="7465029">.</span><span class="ident" id="7465030">New</span><span class="op" id="7465033">(</span><span class="op" id="7465034">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465039">default</span><span class="op" id="7465046">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465052">h</span>&nbsp;<span class="op" id="7465054">=</span>&nbsp;<span class="ident" id="7465056">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7465063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465069">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7465080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465085">if</span>&nbsp;<span class="ident" id="7465088">h</span>&nbsp;<span class="op" id="7465090">==</span>&nbsp;<span class="ident" id="7465093">nil</span>&nbsp;<span class="op" id="7465097">||</span>&nbsp;<span class="ident" id="7465100">pub</span><span class="op" id="7465103">.</span><span class="ident" id="7465104">Curve</span>&nbsp;<span class="op" id="7465110">==</span>&nbsp;<span class="ident" id="7465113">nil</span>&nbsp;<span class="op" id="7465117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465122">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7465133">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465138">switch</span>&nbsp;<span class="op" id="7465145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465149">case</span>&nbsp;<span class="ident" id="7465154">strings</span><span class="op" id="7465161">.</span><span class="ident" id="7465162">HasPrefix</span><span class="op" id="7465171">(</span><span class="ident" id="7465172">line</span><span class="op" id="7465176">,</span>&nbsp;<span class="string" id="7465178">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="7465186">)</span><span class="op" id="7465187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465192">if</span>&nbsp;<span class="ident" id="7465195">msg</span><span class="op" id="7465198">,</span>&nbsp;<span class="ident" id="7465200">err</span>&nbsp;<span class="op" id="7465204">=</span>&nbsp;<span class="ident" id="7465206">hex</span><span class="op" id="7465209">.</span><span class="ident" id="7465210">DecodeString</span><span class="op" id="7465222">(</span><span class="ident" id="7465223">line</span><span class="op" id="7465227">[</span><span class="num" id="7465228">6</span><span class="op" id="7465229">:</span><span class="op" id="7465230">]</span><span class="op" id="7465231">)</span><span class="op" id="7465232">;</span>&nbsp;<span class="ident" id="7465234">err</span>&nbsp;<span class="op" id="7465238">!=</span>&nbsp;<span class="ident" id="7465241">nil</span>&nbsp;<span class="op" id="7465245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465251">t</span><span class="op" id="7465252">.</span><span class="ident" id="7465253">Fatalf</span><span class="op" id="7465259">(</span><span class="string" id="7465260">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7465301">,</span>&nbsp;<span class="ident" id="7465303">lineNo</span><span class="op" id="7465309">,</span>&nbsp;<span class="ident" id="7465311">err</span><span class="op" id="7465314">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7465319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465323">case</span>&nbsp;<span class="ident" id="7465328">strings</span><span class="op" id="7465335">.</span><span class="ident" id="7465336">HasPrefix</span><span class="op" id="7465345">(</span><span class="ident" id="7465346">line</span><span class="op" id="7465350">,</span>&nbsp;<span class="string" id="7465352">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="7465359">)</span><span class="op" id="7465360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465365">pub</span><span class="op" id="7465368">.</span><span class="ident" id="7465369">X</span>&nbsp;<span class="op" id="7465371">=</span>&nbsp;<span class="ident" id="7465373">fromHex</span><span class="op" id="7465380">(</span><span class="ident" id="7465381">line</span><span class="op" id="7465385">[</span><span class="num" id="7465386">5</span><span class="op" id="7465387">:</span><span class="op" id="7465388">]</span><span class="op" id="7465389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465393">case</span>&nbsp;<span class="ident" id="7465398">strings</span><span class="op" id="7465405">.</span><span class="ident" id="7465406">HasPrefix</span><span class="op" id="7465415">(</span><span class="ident" id="7465416">line</span><span class="op" id="7465420">,</span>&nbsp;<span class="string" id="7465422">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="7465429">)</span><span class="op" id="7465430">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465435">pub</span><span class="op" id="7465438">.</span><span class="ident" id="7465439">Y</span>&nbsp;<span class="op" id="7465441">=</span>&nbsp;<span class="ident" id="7465443">fromHex</span><span class="op" id="7465450">(</span><span class="ident" id="7465451">line</span><span class="op" id="7465455">[</span><span class="num" id="7465456">5</span><span class="op" id="7465457">:</span><span class="op" id="7465458">]</span><span class="op" id="7465459">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465463">case</span>&nbsp;<span class="ident" id="7465468">strings</span><span class="op" id="7465475">.</span><span class="ident" id="7465476">HasPrefix</span><span class="op" id="7465485">(</span><span class="ident" id="7465486">line</span><span class="op" id="7465490">,</span>&nbsp;<span class="string" id="7465492">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="7465498">)</span><span class="op" id="7465499">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465504">r</span>&nbsp;<span class="op" id="7465506">=</span>&nbsp;<span class="ident" id="7465508">fromHex</span><span class="op" id="7465515">(</span><span class="ident" id="7465516">line</span><span class="op" id="7465520">[</span><span class="num" id="7465521">4</span><span class="op" id="7465522">:</span><span class="op" id="7465523">]</span><span class="op" id="7465524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465528">case</span>&nbsp;<span class="ident" id="7465533">strings</span><span class="op" id="7465540">.</span><span class="ident" id="7465541">HasPrefix</span><span class="op" id="7465550">(</span><span class="ident" id="7465551">line</span><span class="op" id="7465555">,</span>&nbsp;<span class="string" id="7465557">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="7465563">)</span><span class="op" id="7465564">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465569">s</span>&nbsp;<span class="op" id="7465571">=</span>&nbsp;<span class="ident" id="7465573">fromHex</span><span class="op" id="7465580">(</span><span class="ident" id="7465581">line</span><span class="op" id="7465585">[</span><span class="num" id="7465586">4</span><span class="op" id="7465587">:</span><span class="op" id="7465588">]</span><span class="op" id="7465589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465593">case</span>&nbsp;<span class="ident" id="7465598">strings</span><span class="op" id="7465605">.</span><span class="ident" id="7465606">HasPrefix</span><span class="op" id="7465615">(</span><span class="ident" id="7465616">line</span><span class="op" id="7465620">,</span>&nbsp;<span class="string" id="7465622">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="7465633">)</span><span class="op" id="7465634">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465639">expected</span>&nbsp;<span class="op" id="7465648">:=</span>&nbsp;<span class="ident" id="7465651">line</span><span class="op" id="7465655">[</span><span class="num" id="7465656">9</span><span class="op" id="7465657">]</span>&nbsp;<span class="op" id="7465659">==</span>&nbsp;<span class="string" id="7465662">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465669">h</span><span class="op" id="7465670">.</span><span class="ident" id="7465671">Reset</span><span class="op" id="7465676">(</span><span class="op" id="7465677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465682">h</span><span class="op" id="7465683">.</span><span class="ident" id="7465684">Write</span><span class="op" id="7465689">(</span><span class="ident" id="7465690">msg</span><span class="op" id="7465693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465698">hashed</span>&nbsp;<span class="op" id="7465705">:=</span>&nbsp;<span class="ident" id="7465708">h</span><span class="op" id="7465709">.</span><span class="ident" id="7465710">Sum</span><span class="op" id="7465713">(</span><span class="ident" id="7465714">hashed</span><span class="op" id="7465720">[</span><span class="op" id="7465721">:</span><span class="num" id="7465722">0</span><span class="op" id="7465723">]</span><span class="op" id="7465724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465729">if</span>&nbsp;<span class="ident" id="7465732">Verify</span><span class="op" id="7465738">(</span><span class="ident" id="7465739">pub</span><span class="op" id="7465742">,</span>&nbsp;<span class="ident" id="7465744">hashed</span><span class="op" id="7465750">,</span>&nbsp;<span class="ident" id="7465752">r</span><span class="op" id="7465753">,</span>&nbsp;<span class="ident" id="7465755">s</span><span class="op" id="7465756">)</span>&nbsp;<span class="op" id="7465758">!=</span>&nbsp;<span class="ident" id="7465761">expected</span>&nbsp;<span class="op" id="7465770">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465776">t</span><span class="op" id="7465777">.</span><span class="ident" id="7465778">Fatalf</span><span class="op" id="7465784">(</span><span class="string" id="7465785">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7465814">,</span>&nbsp;<span class="ident" id="7465816">lineNo</span><span class="op" id="7465822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7465827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7465831">default</span><span class="op" id="7465838">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465843">t</span><span class="op" id="7465844">.</span><span class="ident" id="7465845">Fatalf</span><span class="op" id="7465851">(</span><span class="string" id="7465852">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7465885">,</span>&nbsp;<span class="ident" id="7465887">lineNo</span><span class="op" id="7465893">,</span>&nbsp;<span class="ident" id="7465895">line</span><span class="op" id="7465899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7465903">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7465906">}</span><br>
<span class="lineno"></span><span class="op" id="7465908">}</span>
</div>
</body>
</html>
