<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5687487">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5687542">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5687596">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5687647">package</span>&nbsp;<span class="ident" id="5687655">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5687665">import</span>&nbsp;<span class="op" id="5687672">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5687675">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5687684">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5687691">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5687697">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5687708">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5687719">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5687727">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5687738">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="5687760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5687763">//&nbsp;state&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;an&nbsp;execution.&nbsp;It&#39;s&nbsp;not&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5687831">//&nbsp;template&nbsp;so&nbsp;that&nbsp;multiple&nbsp;executions&nbsp;of&nbsp;the&nbsp;same&nbsp;template</span><br>
<span class="lineno">20</span><span class="comment" id="5687892">//&nbsp;can&nbsp;execute&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5687920">type</span>&nbsp;<span class="ident" id="5687925">state</span>&nbsp;<span class="keyword" id="5687931">struct</span>&nbsp;<span class="op" id="5687938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5687941">tmpl</span>&nbsp;<span class="op" id="5687946">*</span><span class="ident" id="5687947">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5687957">wr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5687962">io</span><span class="op" id="5687964">.</span><span class="ident" id="5687965">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5687973">node</span>&nbsp;<span class="ident" id="5687978">parse</span><span class="op" id="5687983">.</span><span class="ident" id="5687984">Node</span>&nbsp;<span class="comment" id="5687989">//&nbsp;current&nbsp;node,&nbsp;for&nbsp;errors</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5688018">vars</span>&nbsp;<span class="op" id="5688023">[</span><span class="op" id="5688024">]</span><span class="ident" id="5688025">variable</span>&nbsp;<span class="comment" id="5688034">//&nbsp;push-down&nbsp;stack&nbsp;of&nbsp;variable&nbsp;values.</span><br>
<span class="lineno"></span><span class="op" id="5688073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5688076">//&nbsp;variable&nbsp;holds&nbsp;the&nbsp;dynamic&nbsp;value&nbsp;of&nbsp;a&nbsp;variable&nbsp;such&nbsp;as&nbsp;$,&nbsp;$x&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="5688145">type</span>&nbsp;<span class="ident" id="5688150">variable</span>&nbsp;<span class="keyword" id="5688159">struct</span>&nbsp;<span class="op" id="5688166">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5688169">name</span>&nbsp;&nbsp;<span class="builtintype" id="5688175">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5688183">value</span>&nbsp;<span class="ident" id="5688189">reflect</span><span class="op" id="5688196">.</span><span class="ident" id="5688197">Value</span><br>
<span class="lineno"></span><span class="op" id="5688203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5688206">//&nbsp;push&nbsp;pushes&nbsp;a&nbsp;new&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno">35</span><span class="keyword" id="5688250">func</span>&nbsp;<span class="op" id="5688255">(</span><span class="ident" id="5688256">s</span>&nbsp;<span class="op" id="5688258">*</span><span class="ident" id="5688259">state</span><span class="op" id="5688264">)</span>&nbsp;<span class="ident" id="5688266">push</span><span class="op" id="5688270">(</span><span class="ident" id="5688271">name</span>&nbsp;<span class="builtintype" id="5688276">string</span><span class="op" id="5688282">,</span>&nbsp;<span class="ident" id="5688284">value</span>&nbsp;<span class="ident" id="5688290">reflect</span><span class="op" id="5688297">.</span><span class="ident" id="5688298">Value</span><span class="op" id="5688303">)</span>&nbsp;<span class="op" id="5688305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5688308">s</span><span class="op" id="5688309">.</span><span class="ident" id="5688310">vars</span>&nbsp;<span class="op" id="5688315">=</span>&nbsp;<span class="builtinfunc" id="5688317">append</span><span class="op" id="5688323">(</span><span class="ident" id="5688324">s</span><span class="op" id="5688325">.</span><span class="ident" id="5688326">vars</span><span class="op" id="5688330">,</span>&nbsp;<span class="ident" id="5688332">variable</span><span class="op" id="5688340">{</span><span class="ident" id="5688341">name</span><span class="op" id="5688345">,</span>&nbsp;<span class="ident" id="5688347">value</span><span class="op" id="5688352">}</span><span class="op" id="5688353">)</span><br>
<span class="lineno"></span><span class="op" id="5688355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5688358">//&nbsp;mark&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;variable&nbsp;stack.</span><br>
<span class="lineno">40</span><span class="keyword" id="5688408">func</span>&nbsp;<span class="op" id="5688413">(</span><span class="ident" id="5688414">s</span>&nbsp;<span class="op" id="5688416">*</span><span class="ident" id="5688417">state</span><span class="op" id="5688422">)</span>&nbsp;<span class="ident" id="5688424">mark</span><span class="op" id="5688428">(</span><span class="op" id="5688429">)</span>&nbsp;<span class="builtintype" id="5688431">int</span>&nbsp;<span class="op" id="5688435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5688438">return</span>&nbsp;<span class="builtinfunc" id="5688445">len</span><span class="op" id="5688448">(</span><span class="ident" id="5688449">s</span><span class="op" id="5688450">.</span><span class="ident" id="5688451">vars</span><span class="op" id="5688455">)</span><br>
<span class="lineno"></span><span class="op" id="5688457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5688460">//&nbsp;pop&nbsp;pops&nbsp;the&nbsp;variable&nbsp;stack&nbsp;up&nbsp;to&nbsp;the&nbsp;mark.</span><br>
<span class="lineno">45</span><span class="keyword" id="5688507">func</span>&nbsp;<span class="op" id="5688512">(</span><span class="ident" id="5688513">s</span>&nbsp;<span class="op" id="5688515">*</span><span class="ident" id="5688516">state</span><span class="op" id="5688521">)</span>&nbsp;<span class="ident" id="5688523">pop</span><span class="op" id="5688526">(</span><span class="ident" id="5688527">mark</span>&nbsp;<span class="builtintype" id="5688532">int</span><span class="op" id="5688535">)</span>&nbsp;<span class="op" id="5688537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5688540">s</span><span class="op" id="5688541">.</span><span class="ident" id="5688542">vars</span>&nbsp;<span class="op" id="5688547">=</span>&nbsp;<span class="ident" id="5688549">s</span><span class="op" id="5688550">.</span><span class="ident" id="5688551">vars</span><span class="op" id="5688555">[</span><span class="num" id="5688556">0</span><span class="op" id="5688557">:</span><span class="ident" id="5688558">mark</span><span class="op" id="5688562">]</span><br>
<span class="lineno"></span><span class="op" id="5688564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5688567">//&nbsp;setVar&nbsp;overwrites&nbsp;the&nbsp;top-nth&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.&nbsp;Used&nbsp;by&nbsp;range&nbsp;iterations.</span><br>
<span class="lineno">50</span><span class="keyword" id="5688649">func</span>&nbsp;<span class="op" id="5688654">(</span><span class="ident" id="5688655">s</span>&nbsp;<span class="op" id="5688657">*</span><span class="ident" id="5688658">state</span><span class="op" id="5688663">)</span>&nbsp;<span class="ident" id="5688665">setVar</span><span class="op" id="5688671">(</span><span class="ident" id="5688672">n</span>&nbsp;<span class="builtintype" id="5688674">int</span><span class="op" id="5688677">,</span>&nbsp;<span class="ident" id="5688679">value</span>&nbsp;<span class="ident" id="5688685">reflect</span><span class="op" id="5688692">.</span><span class="ident" id="5688693">Value</span><span class="op" id="5688698">)</span>&nbsp;<span class="op" id="5688700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5688703">s</span><span class="op" id="5688704">.</span><span class="ident" id="5688705">vars</span><span class="op" id="5688709">[</span><span class="builtinfunc" id="5688710">len</span><span class="op" id="5688713">(</span><span class="ident" id="5688714">s</span><span class="op" id="5688715">.</span><span class="ident" id="5688716">vars</span><span class="op" id="5688720">)</span><span class="op" id="5688721">-</span><span class="ident" id="5688722">n</span><span class="op" id="5688723">]</span><span class="op" id="5688724">.</span><span class="ident" id="5688725">value</span>&nbsp;<span class="op" id="5688731">=</span>&nbsp;<span class="ident" id="5688733">value</span><br>
<span class="lineno"></span><span class="op" id="5688739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5688742">//&nbsp;varValue&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;named&nbsp;variable.</span><br>
<span class="lineno">55</span><span class="keyword" id="5688795">func</span>&nbsp;<span class="op" id="5688800">(</span><span class="ident" id="5688801">s</span>&nbsp;<span class="op" id="5688803">*</span><span class="ident" id="5688804">state</span><span class="op" id="5688809">)</span>&nbsp;<span class="ident" id="5688811">varValue</span><span class="op" id="5688819">(</span><span class="ident" id="5688820">name</span>&nbsp;<span class="builtintype" id="5688825">string</span><span class="op" id="5688831">)</span>&nbsp;<span class="ident" id="5688833">reflect</span><span class="op" id="5688840">.</span><span class="ident" id="5688841">Value</span>&nbsp;<span class="op" id="5688847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5688850">for</span>&nbsp;<span class="ident" id="5688854">i</span>&nbsp;<span class="op" id="5688856">:=</span>&nbsp;<span class="ident" id="5688859">s</span><span class="op" id="5688860">.</span><span class="ident" id="5688861">mark</span><span class="op" id="5688865">(</span><span class="op" id="5688866">)</span>&nbsp;<span class="op" id="5688868">-</span>&nbsp;<span class="num" id="5688870">1</span><span class="op" id="5688871">;</span>&nbsp;<span class="ident" id="5688873">i</span>&nbsp;<span class="op" id="5688875">&gt;=</span>&nbsp;<span class="num" id="5688878">0</span><span class="op" id="5688879">;</span>&nbsp;<span class="ident" id="5688881">i</span><span class="op" id="5688882">--</span>&nbsp;<span class="op" id="5688885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5688889">if</span>&nbsp;<span class="ident" id="5688892">s</span><span class="op" id="5688893">.</span><span class="ident" id="5688894">vars</span><span class="op" id="5688898">[</span><span class="ident" id="5688899">i</span><span class="op" id="5688900">]</span><span class="op" id="5688901">.</span><span class="ident" id="5688902">name</span>&nbsp;<span class="op" id="5688907">==</span>&nbsp;<span class="ident" id="5688910">name</span>&nbsp;<span class="op" id="5688915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5688920">return</span>&nbsp;<span class="ident" id="5688927">s</span><span class="op" id="5688928">.</span><span class="ident" id="5688929">vars</span><span class="op" id="5688933">[</span><span class="ident" id="5688934">i</span><span class="op" id="5688935">]</span><span class="op" id="5688936">.</span><span class="ident" id="5688937">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5688945">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5688948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5688951">s</span><span class="op" id="5688952">.</span><span class="ident" id="5688953">errorf</span><span class="op" id="5688959">(</span><span class="string" id="5688960">&#34;undefined&nbsp;variable:&nbsp;%s&#34;</span><span class="op" id="5688984">,</span>&nbsp;<span class="ident" id="5688986">name</span><span class="op" id="5688990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5688993">return</span>&nbsp;<span class="ident" id="5689000">zero</span><br>
<span class="lineno"></span><span class="op" id="5689005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="5689008">var</span>&nbsp;<span class="ident" id="5689012">zero</span>&nbsp;<span class="ident" id="5689017">reflect</span><span class="op" id="5689024">.</span><span class="ident" id="5689025">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5689032">//&nbsp;at&nbsp;marks&nbsp;the&nbsp;state&nbsp;to&nbsp;be&nbsp;on&nbsp;node&nbsp;n,&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span><span class="keyword" id="5689092">func</span>&nbsp;<span class="op" id="5689097">(</span><span class="ident" id="5689098">s</span>&nbsp;<span class="op" id="5689100">*</span><span class="ident" id="5689101">state</span><span class="op" id="5689106">)</span>&nbsp;<span class="ident" id="5689108">at</span><span class="op" id="5689110">(</span><span class="ident" id="5689111">node</span>&nbsp;<span class="ident" id="5689116">parse</span><span class="op" id="5689121">.</span><span class="ident" id="5689122">Node</span><span class="op" id="5689126">)</span>&nbsp;<span class="op" id="5689128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5689131">s</span><span class="op" id="5689132">.</span><span class="ident" id="5689133">node</span>&nbsp;<span class="op" id="5689138">=</span>&nbsp;<span class="ident" id="5689140">node</span><br>
<span class="lineno">70</span><span class="op" id="5689145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5689148">//&nbsp;doublePercent&nbsp;returns&nbsp;the&nbsp;string&nbsp;with&nbsp;%&#39;s&nbsp;replaced&nbsp;by&nbsp;%%,&nbsp;if&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="5689223">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;safely&nbsp;inside&nbsp;a&nbsp;Printf&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5689282">func</span>&nbsp;<span class="ident" id="5689287">doublePercent</span><span class="op" id="5689300">(</span><span class="ident" id="5689301">str</span>&nbsp;<span class="builtintype" id="5689305">string</span><span class="op" id="5689311">)</span>&nbsp;<span class="builtintype" id="5689313">string</span>&nbsp;<span class="op" id="5689320">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5689323">if</span>&nbsp;<span class="ident" id="5689326">strings</span><span class="op" id="5689333">.</span><span class="ident" id="5689334">Contains</span><span class="op" id="5689342">(</span><span class="ident" id="5689343">str</span><span class="op" id="5689346">,</span>&nbsp;<span class="string" id="5689348">&#34;%&#34;</span><span class="op" id="5689351">)</span>&nbsp;<span class="op" id="5689353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5689357">str</span>&nbsp;<span class="op" id="5689361">=</span>&nbsp;<span class="ident" id="5689363">strings</span><span class="op" id="5689370">.</span><span class="ident" id="5689371">Replace</span><span class="op" id="5689378">(</span><span class="ident" id="5689379">str</span><span class="op" id="5689382">,</span>&nbsp;<span class="string" id="5689384">&#34;%&#34;</span><span class="op" id="5689387">,</span>&nbsp;<span class="string" id="5689389">&#34;%%&#34;</span><span class="op" id="5689393">,</span>&nbsp;<span class="op" id="5689395">-</span><span class="num" id="5689396">1</span><span class="op" id="5689397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5689400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5689403">return</span>&nbsp;<span class="ident" id="5689410">str</span><br>
<span class="lineno"></span><span class="op" id="5689414">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="5689417">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="5689472">func</span>&nbsp;<span class="op" id="5689477">(</span><span class="ident" id="5689478">s</span>&nbsp;<span class="op" id="5689480">*</span><span class="ident" id="5689481">state</span><span class="op" id="5689486">)</span>&nbsp;<span class="ident" id="5689488">errorf</span><span class="op" id="5689494">(</span><span class="ident" id="5689495">format</span>&nbsp;<span class="builtintype" id="5689502">string</span><span class="op" id="5689508">,</span>&nbsp;<span class="ident" id="5689510">args</span>&nbsp;<span class="op" id="5689515">...</span><span class="keyword" id="5689518">interface</span><span class="op" id="5689527">{</span><span class="op" id="5689528">}</span><span class="op" id="5689529">)</span>&nbsp;<span class="op" id="5689531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5689534">name</span>&nbsp;<span class="op" id="5689539">:=</span>&nbsp;<span class="ident" id="5689542">doublePercent</span><span class="op" id="5689555">(</span><span class="ident" id="5689556">s</span><span class="op" id="5689557">.</span><span class="ident" id="5689558">tmpl</span><span class="op" id="5689562">.</span><span class="ident" id="5689563">Name</span><span class="op" id="5689567">(</span><span class="op" id="5689568">)</span><span class="op" id="5689569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5689572">if</span>&nbsp;<span class="ident" id="5689575">s</span><span class="op" id="5689576">.</span><span class="ident" id="5689577">node</span>&nbsp;<span class="op" id="5689582">==</span>&nbsp;<span class="ident" id="5689585">nil</span>&nbsp;<span class="op" id="5689589">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5689593">format</span>&nbsp;<span class="op" id="5689600">=</span>&nbsp;<span class="ident" id="5689602">fmt</span><span class="op" id="5689605">.</span><span class="ident" id="5689606">Sprintf</span><span class="op" id="5689613">(</span><span class="string" id="5689614">&#34;template:&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="5689632">,</span>&nbsp;<span class="ident" id="5689634">name</span><span class="op" id="5689638">,</span>&nbsp;<span class="ident" id="5689640">format</span><span class="op" id="5689646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5689649">}</span>&nbsp;<span class="keyword" id="5689651">else</span>&nbsp;<span class="op" id="5689656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5689660">location</span><span class="op" id="5689668">,</span>&nbsp;<span class="ident" id="5689670">context</span>&nbsp;<span class="op" id="5689678">:=</span>&nbsp;<span class="ident" id="5689681">s</span><span class="op" id="5689682">.</span><span class="ident" id="5689683">tmpl</span><span class="op" id="5689687">.</span><span class="ident" id="5689688">ErrorContext</span><span class="op" id="5689700">(</span><span class="ident" id="5689701">s</span><span class="op" id="5689702">.</span><span class="ident" id="5689703">node</span><span class="op" id="5689707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5689711">format</span>&nbsp;<span class="op" id="5689718">=</span>&nbsp;<span class="ident" id="5689720">fmt</span><span class="op" id="5689723">.</span><span class="ident" id="5689724">Sprintf</span><span class="op" id="5689731">(</span><span class="string" id="5689732">&#34;template:&nbsp;%s:&nbsp;executing&nbsp;%q&nbsp;at&nbsp;&lt;%s&gt;:&nbsp;%s&#34;</span><span class="op" id="5689772">,</span>&nbsp;<span class="ident" id="5689774">location</span><span class="op" id="5689782">,</span>&nbsp;<span class="ident" id="5689784">name</span><span class="op" id="5689788">,</span>&nbsp;<span class="ident" id="5689790">doublePercent</span><span class="op" id="5689803">(</span><span class="ident" id="5689804">context</span><span class="op" id="5689811">)</span><span class="op" id="5689812">,</span>&nbsp;<span class="ident" id="5689814">format</span><span class="op" id="5689820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5689823">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5689826">panic</span><span class="op" id="5689831">(</span><span class="ident" id="5689832">fmt</span><span class="op" id="5689835">.</span><span class="ident" id="5689836">Errorf</span><span class="op" id="5689842">(</span><span class="ident" id="5689843">format</span><span class="op" id="5689849">,</span>&nbsp;<span class="ident" id="5689851">args</span><span class="op" id="5689855">...</span><span class="op" id="5689858">)</span><span class="op" id="5689859">)</span><br>
<span class="lineno"></span><span class="op" id="5689861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5689864">//&nbsp;errRecover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="5689937">//&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno">95</span><span class="keyword" id="5689956">func</span>&nbsp;<span class="ident" id="5689961">errRecover</span><span class="op" id="5689971">(</span><span class="ident" id="5689972">errp</span>&nbsp;<span class="op" id="5689977">*</span><span class="builtintype" id="5689978">error</span><span class="op" id="5689983">)</span>&nbsp;<span class="op" id="5689985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5689988">e</span>&nbsp;<span class="op" id="5689990">:=</span>&nbsp;<span class="builtinfunc" id="5689993">recover</span><span class="op" id="5690000">(</span><span class="op" id="5690001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5690004">if</span>&nbsp;<span class="ident" id="5690007">e</span>&nbsp;<span class="op" id="5690009">!=</span>&nbsp;<span class="ident" id="5690012">nil</span>&nbsp;<span class="op" id="5690016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5690020">switch</span>&nbsp;<span class="ident" id="5690027">err</span>&nbsp;<span class="op" id="5690031">:=</span>&nbsp;<span class="ident" id="5690034">e</span><span class="op" id="5690035">.</span><span class="op" id="5690036">(</span><span class="keyword" id="5690037">type</span><span class="op" id="5690041">)</span>&nbsp;<span class="op" id="5690043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5690047">case</span>&nbsp;<span class="ident" id="5690052">runtime</span><span class="op" id="5690059">.</span><span class="ident" id="5690060">Error</span><span class="op" id="5690065">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5690070">panic</span><span class="op" id="5690075">(</span><span class="ident" id="5690076">e</span><span class="op" id="5690077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5690081">case</span>&nbsp;<span class="builtintype" id="5690086">error</span><span class="op" id="5690091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5690096">*</span><span class="ident" id="5690097">errp</span>&nbsp;<span class="op" id="5690102">=</span>&nbsp;<span class="ident" id="5690104">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5690110">default</span><span class="op" id="5690117">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5690122">panic</span><span class="op" id="5690127">(</span><span class="ident" id="5690128">e</span><span class="op" id="5690129">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5690133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5690136">}</span><br>
<span class="lineno"></span><span class="op" id="5690138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5690141">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">110</span><span class="comment" id="5690223">//&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="5690284">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5690352">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5690425">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5690447">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno">115</span><span class="keyword" id="5690497">func</span>&nbsp;<span class="op" id="5690502">(</span><span class="ident" id="5690503">t</span>&nbsp;<span class="op" id="5690505">*</span><span class="ident" id="5690506">Template</span><span class="op" id="5690514">)</span>&nbsp;<span class="ident" id="5690516">ExecuteTemplate</span><span class="op" id="5690531">(</span><span class="ident" id="5690532">wr</span>&nbsp;<span class="ident" id="5690535">io</span><span class="op" id="5690537">.</span><span class="ident" id="5690538">Writer</span><span class="op" id="5690544">,</span>&nbsp;<span class="ident" id="5690546">name</span>&nbsp;<span class="builtintype" id="5690551">string</span><span class="op" id="5690557">,</span>&nbsp;<span class="ident" id="5690559">data</span>&nbsp;<span class="keyword" id="5690564">interface</span><span class="op" id="5690573">{</span><span class="op" id="5690574">}</span><span class="op" id="5690575">)</span>&nbsp;<span class="builtintype" id="5690577">error</span>&nbsp;<span class="op" id="5690583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5690586">tmpl</span>&nbsp;<span class="op" id="5690591">:=</span>&nbsp;<span class="ident" id="5690594">t</span><span class="op" id="5690595">.</span><span class="ident" id="5690596">tmpl</span><span class="op" id="5690600">[</span><span class="ident" id="5690601">name</span><span class="op" id="5690605">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5690608">if</span>&nbsp;<span class="ident" id="5690611">tmpl</span>&nbsp;<span class="op" id="5690616">==</span>&nbsp;<span class="ident" id="5690619">nil</span>&nbsp;<span class="op" id="5690623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5690627">return</span>&nbsp;<span class="ident" id="5690634">fmt</span><span class="op" id="5690637">.</span><span class="ident" id="5690638">Errorf</span><span class="op" id="5690644">(</span><span class="string" id="5690645">&#34;template:&nbsp;no&nbsp;template&nbsp;%q&nbsp;associated&nbsp;with&nbsp;template&nbsp;%q&#34;</span><span class="op" id="5690699">,</span>&nbsp;<span class="ident" id="5690701">name</span><span class="op" id="5690705">,</span>&nbsp;<span class="ident" id="5690707">t</span><span class="op" id="5690708">.</span><span class="ident" id="5690709">name</span><span class="op" id="5690713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5690716">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5690719">return</span>&nbsp;<span class="ident" id="5690726">tmpl</span><span class="op" id="5690730">.</span><span class="ident" id="5690731">Execute</span><span class="op" id="5690738">(</span><span class="ident" id="5690739">wr</span><span class="op" id="5690741">,</span>&nbsp;<span class="ident" id="5690743">data</span><span class="op" id="5690747">)</span><br>
<span class="lineno"></span><span class="op" id="5690749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5690752">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="5690819">//&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">125</span><span class="comment" id="5690851">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5690919">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5690992">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5691014">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5691064">func</span>&nbsp;<span class="op" id="5691069">(</span><span class="ident" id="5691070">t</span>&nbsp;<span class="op" id="5691072">*</span><span class="ident" id="5691073">Template</span><span class="op" id="5691081">)</span>&nbsp;<span class="ident" id="5691083">Execute</span><span class="op" id="5691090">(</span><span class="ident" id="5691091">wr</span>&nbsp;<span class="ident" id="5691094">io</span><span class="op" id="5691096">.</span><span class="ident" id="5691097">Writer</span><span class="op" id="5691103">,</span>&nbsp;<span class="ident" id="5691105">data</span>&nbsp;<span class="keyword" id="5691110">interface</span><span class="op" id="5691119">{</span><span class="op" id="5691120">}</span><span class="op" id="5691121">)</span>&nbsp;<span class="op" id="5691123">(</span><span class="ident" id="5691124">err</span>&nbsp;<span class="builtintype" id="5691128">error</span><span class="op" id="5691133">)</span>&nbsp;<span class="op" id="5691135">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691138">defer</span>&nbsp;<span class="ident" id="5691144">errRecover</span><span class="op" id="5691154">(</span><span class="op" id="5691155">&amp;</span><span class="ident" id="5691156">err</span><span class="op" id="5691159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691162">value</span>&nbsp;<span class="op" id="5691168">:=</span>&nbsp;<span class="ident" id="5691171">reflect</span><span class="op" id="5691178">.</span><span class="ident" id="5691179">ValueOf</span><span class="op" id="5691186">(</span><span class="ident" id="5691187">data</span><span class="op" id="5691191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691194">state</span>&nbsp;<span class="op" id="5691200">:=</span>&nbsp;<span class="op" id="5691203">&amp;</span><span class="ident" id="5691204">state</span><span class="op" id="5691209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691213">tmpl</span><span class="op" id="5691217">:</span>&nbsp;<span class="ident" id="5691219">t</span><span class="op" id="5691220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691224">wr</span><span class="op" id="5691226">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5691230">wr</span><span class="op" id="5691232">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691236">vars</span><span class="op" id="5691240">:</span>&nbsp;<span class="op" id="5691242">[</span><span class="op" id="5691243">]</span><span class="ident" id="5691244">variable</span><span class="op" id="5691252">{</span><span class="op" id="5691253">{</span><span class="string" id="5691254">&#34;$&#34;</span><span class="op" id="5691257">,</span>&nbsp;<span class="ident" id="5691259">value</span><span class="op" id="5691264">}</span><span class="op" id="5691265">}</span><span class="op" id="5691266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5691269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691272">t</span><span class="op" id="5691273">.</span><span class="ident" id="5691274">init</span><span class="op" id="5691278">(</span><span class="op" id="5691279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691282">if</span>&nbsp;<span class="ident" id="5691285">t</span><span class="op" id="5691286">.</span><span class="ident" id="5691287">Tree</span>&nbsp;<span class="op" id="5691292">==</span>&nbsp;<span class="ident" id="5691295">nil</span>&nbsp;<span class="op" id="5691299">||</span>&nbsp;<span class="ident" id="5691302">t</span><span class="op" id="5691303">.</span><span class="ident" id="5691304">Root</span>&nbsp;<span class="op" id="5691309">==</span>&nbsp;<span class="ident" id="5691312">nil</span>&nbsp;<span class="op" id="5691316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691320">var</span>&nbsp;<span class="ident" id="5691324">b</span>&nbsp;<span class="ident" id="5691326">bytes</span><span class="op" id="5691331">.</span><span class="ident" id="5691332">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691341">for</span>&nbsp;<span class="ident" id="5691345">name</span><span class="op" id="5691349">,</span>&nbsp;<span class="ident" id="5691351">tmpl</span>&nbsp;<span class="op" id="5691356">:=</span>&nbsp;<span class="keyword" id="5691359">range</span>&nbsp;<span class="ident" id="5691365">t</span><span class="op" id="5691366">.</span><span class="ident" id="5691367">tmpl</span>&nbsp;<span class="op" id="5691372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691377">if</span>&nbsp;<span class="ident" id="5691380">tmpl</span><span class="op" id="5691384">.</span><span class="ident" id="5691385">Tree</span>&nbsp;<span class="op" id="5691390">==</span>&nbsp;<span class="ident" id="5691393">nil</span>&nbsp;<span class="op" id="5691397">||</span>&nbsp;<span class="ident" id="5691400">tmpl</span><span class="op" id="5691404">.</span><span class="ident" id="5691405">Root</span>&nbsp;<span class="op" id="5691410">==</span>&nbsp;<span class="ident" id="5691413">nil</span>&nbsp;<span class="op" id="5691417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691423">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5691435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691440">if</span>&nbsp;<span class="ident" id="5691443">b</span><span class="op" id="5691444">.</span><span class="ident" id="5691445">Len</span><span class="op" id="5691448">(</span><span class="op" id="5691449">)</span>&nbsp;<span class="op" id="5691451">&gt;</span>&nbsp;<span class="num" id="5691453">0</span>&nbsp;<span class="op" id="5691455">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691461">b</span><span class="op" id="5691462">.</span><span class="ident" id="5691463">WriteString</span><span class="op" id="5691474">(</span><span class="string" id="5691475">&#34;,&nbsp;&#34;</span><span class="op" id="5691479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5691484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691489">fmt</span><span class="op" id="5691492">.</span><span class="ident" id="5691493">Fprintf</span><span class="op" id="5691500">(</span><span class="op" id="5691501">&amp;</span><span class="ident" id="5691502">b</span><span class="op" id="5691503">,</span>&nbsp;<span class="string" id="5691505">&#34;%q&#34;</span><span class="op" id="5691509">,</span>&nbsp;<span class="ident" id="5691511">name</span><span class="op" id="5691515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5691519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691523">var</span>&nbsp;<span class="ident" id="5691527">s</span>&nbsp;<span class="builtintype" id="5691529">string</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691538">if</span>&nbsp;<span class="ident" id="5691541">b</span><span class="op" id="5691542">.</span><span class="ident" id="5691543">Len</span><span class="op" id="5691546">(</span><span class="op" id="5691547">)</span>&nbsp;<span class="op" id="5691549">&gt;</span>&nbsp;<span class="num" id="5691551">0</span>&nbsp;<span class="op" id="5691553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691558">s</span>&nbsp;<span class="op" id="5691560">=</span>&nbsp;<span class="string" id="5691562">&#34;;&nbsp;defined&nbsp;templates&nbsp;are:&nbsp;&#34;</span>&nbsp;<span class="op" id="5691590">+</span>&nbsp;<span class="ident" id="5691592">b</span><span class="op" id="5691593">.</span><span class="ident" id="5691594">String</span><span class="op" id="5691600">(</span><span class="op" id="5691601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5691605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691609">state</span><span class="op" id="5691614">.</span><span class="ident" id="5691615">errorf</span><span class="op" id="5691621">(</span><span class="string" id="5691622">&#34;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;or&nbsp;empty&nbsp;template%s&#34;</span><span class="op" id="5691663">,</span>&nbsp;<span class="ident" id="5691665">t</span><span class="op" id="5691666">.</span><span class="ident" id="5691667">Name</span><span class="op" id="5691671">(</span><span class="op" id="5691672">)</span><span class="op" id="5691673">,</span>&nbsp;<span class="ident" id="5691675">s</span><span class="op" id="5691676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5691679">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691682">state</span><span class="op" id="5691687">.</span><span class="ident" id="5691688">walk</span><span class="op" id="5691692">(</span><span class="ident" id="5691693">value</span><span class="op" id="5691698">,</span>&nbsp;<span class="ident" id="5691700">t</span><span class="op" id="5691701">.</span><span class="ident" id="5691702">Root</span><span class="op" id="5691706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691709">return</span><br>
<span class="lineno"></span><span class="op" id="5691716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5691719">//&nbsp;Walk&nbsp;functions&nbsp;step&nbsp;through&nbsp;the&nbsp;major&nbsp;pieces&nbsp;of&nbsp;the&nbsp;template&nbsp;structure,</span><br>
<span class="lineno">160</span><span class="comment" id="5691794">//&nbsp;generating&nbsp;output&nbsp;as&nbsp;they&nbsp;go.</span><br>
<span class="lineno"></span><span class="keyword" id="5691827">func</span>&nbsp;<span class="op" id="5691832">(</span><span class="ident" id="5691833">s</span>&nbsp;<span class="op" id="5691835">*</span><span class="ident" id="5691836">state</span><span class="op" id="5691841">)</span>&nbsp;<span class="ident" id="5691843">walk</span><span class="op" id="5691847">(</span><span class="ident" id="5691848">dot</span>&nbsp;<span class="ident" id="5691852">reflect</span><span class="op" id="5691859">.</span><span class="ident" id="5691860">Value</span><span class="op" id="5691865">,</span>&nbsp;<span class="ident" id="5691867">node</span>&nbsp;<span class="ident" id="5691872">parse</span><span class="op" id="5691877">.</span><span class="ident" id="5691878">Node</span><span class="op" id="5691882">)</span>&nbsp;<span class="op" id="5691884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5691887">s</span><span class="op" id="5691888">.</span><span class="ident" id="5691889">at</span><span class="op" id="5691891">(</span><span class="ident" id="5691892">node</span><span class="op" id="5691896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691899">switch</span>&nbsp;<span class="ident" id="5691906">node</span>&nbsp;<span class="op" id="5691911">:=</span>&nbsp;<span class="ident" id="5691914">node</span><span class="op" id="5691918">.</span><span class="op" id="5691919">(</span><span class="keyword" id="5691920">type</span><span class="op" id="5691924">)</span>&nbsp;<span class="op" id="5691926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5691929">case</span>&nbsp;<span class="op" id="5691934">*</span><span class="ident" id="5691935">parse</span><span class="op" id="5691940">.</span><span class="ident" id="5691941">ActionNode</span><span class="op" id="5691951">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5691955">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables&nbsp;so&nbsp;they&nbsp;persist&nbsp;until&nbsp;next&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5692013">//&nbsp;Also,&nbsp;if&nbsp;the&nbsp;action&nbsp;declares&nbsp;variables,&nbsp;don&#39;t&nbsp;print&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5692082">val</span>&nbsp;<span class="op" id="5692086">:=</span>&nbsp;<span class="ident" id="5692089">s</span><span class="op" id="5692090">.</span><span class="ident" id="5692091">evalPipeline</span><span class="op" id="5692103">(</span><span class="ident" id="5692104">dot</span><span class="op" id="5692107">,</span>&nbsp;<span class="ident" id="5692109">node</span><span class="op" id="5692113">.</span><span class="ident" id="5692114">Pipe</span><span class="op" id="5692118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692122">if</span>&nbsp;<span class="builtinfunc" id="5692125">len</span><span class="op" id="5692128">(</span><span class="ident" id="5692129">node</span><span class="op" id="5692133">.</span><span class="ident" id="5692134">Pipe</span><span class="op" id="5692138">.</span><span class="ident" id="5692139">Decl</span><span class="op" id="5692143">)</span>&nbsp;<span class="op" id="5692145">==</span>&nbsp;<span class="num" id="5692148">0</span>&nbsp;<span class="op" id="5692150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5692155">s</span><span class="op" id="5692156">.</span><span class="ident" id="5692157">printValue</span><span class="op" id="5692167">(</span><span class="ident" id="5692168">node</span><span class="op" id="5692172">,</span>&nbsp;<span class="ident" id="5692174">val</span><span class="op" id="5692177">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5692181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692184">case</span>&nbsp;<span class="op" id="5692189">*</span><span class="ident" id="5692190">parse</span><span class="op" id="5692195">.</span><span class="ident" id="5692196">IfNode</span><span class="op" id="5692202">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5692206">s</span><span class="op" id="5692207">.</span><span class="ident" id="5692208">walkIfOrWith</span><span class="op" id="5692220">(</span><span class="ident" id="5692221">parse</span><span class="op" id="5692226">.</span><span class="ident" id="5692227">NodeIf</span><span class="op" id="5692233">,</span>&nbsp;<span class="ident" id="5692235">dot</span><span class="op" id="5692238">,</span>&nbsp;<span class="ident" id="5692240">node</span><span class="op" id="5692244">.</span><span class="ident" id="5692245">Pipe</span><span class="op" id="5692249">,</span>&nbsp;<span class="ident" id="5692251">node</span><span class="op" id="5692255">.</span><span class="ident" id="5692256">List</span><span class="op" id="5692260">,</span>&nbsp;<span class="ident" id="5692262">node</span><span class="op" id="5692266">.</span><span class="ident" id="5692267">ElseList</span><span class="op" id="5692275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692278">case</span>&nbsp;<span class="op" id="5692283">*</span><span class="ident" id="5692284">parse</span><span class="op" id="5692289">.</span><span class="ident" id="5692290">ListNode</span><span class="op" id="5692298">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692302">for</span>&nbsp;<span class="ident" id="5692306">_</span><span class="op" id="5692307">,</span>&nbsp;<span class="ident" id="5692309">node</span>&nbsp;<span class="op" id="5692314">:=</span>&nbsp;<span class="keyword" id="5692317">range</span>&nbsp;<span class="ident" id="5692323">node</span><span class="op" id="5692327">.</span><span class="ident" id="5692328">Nodes</span>&nbsp;<span class="op" id="5692334">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5692339">s</span><span class="op" id="5692340">.</span><span class="ident" id="5692341">walk</span><span class="op" id="5692345">(</span><span class="ident" id="5692346">dot</span><span class="op" id="5692349">,</span>&nbsp;<span class="ident" id="5692351">node</span><span class="op" id="5692355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5692359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692362">case</span>&nbsp;<span class="op" id="5692367">*</span><span class="ident" id="5692368">parse</span><span class="op" id="5692373">.</span><span class="ident" id="5692374">RangeNode</span><span class="op" id="5692383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5692387">s</span><span class="op" id="5692388">.</span><span class="ident" id="5692389">walkRange</span><span class="op" id="5692398">(</span><span class="ident" id="5692399">dot</span><span class="op" id="5692402">,</span>&nbsp;<span class="ident" id="5692404">node</span><span class="op" id="5692408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692411">case</span>&nbsp;<span class="op" id="5692416">*</span><span class="ident" id="5692417">parse</span><span class="op" id="5692422">.</span><span class="ident" id="5692423">TemplateNode</span><span class="op" id="5692435">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5692439">s</span><span class="op" id="5692440">.</span><span class="ident" id="5692441">walkTemplate</span><span class="op" id="5692453">(</span><span class="ident" id="5692454">dot</span><span class="op" id="5692457">,</span>&nbsp;<span class="ident" id="5692459">node</span><span class="op" id="5692463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692466">case</span>&nbsp;<span class="op" id="5692471">*</span><span class="ident" id="5692472">parse</span><span class="op" id="5692477">.</span><span class="ident" id="5692478">TextNode</span><span class="op" id="5692486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692490">if</span>&nbsp;<span class="ident" id="5692493">_</span><span class="op" id="5692494">,</span>&nbsp;<span class="ident" id="5692496">err</span>&nbsp;<span class="op" id="5692500">:=</span>&nbsp;<span class="ident" id="5692503">s</span><span class="op" id="5692504">.</span><span class="ident" id="5692505">wr</span><span class="op" id="5692507">.</span><span class="ident" id="5692508">Write</span><span class="op" id="5692513">(</span><span class="ident" id="5692514">node</span><span class="op" id="5692518">.</span><span class="ident" id="5692519">Text</span><span class="op" id="5692523">)</span><span class="op" id="5692524">;</span>&nbsp;<span class="ident" id="5692526">err</span>&nbsp;<span class="op" id="5692530">!=</span>&nbsp;<span class="ident" id="5692533">nil</span>&nbsp;<span class="op" id="5692537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5692542">s</span><span class="op" id="5692543">.</span><span class="ident" id="5692544">errorf</span><span class="op" id="5692550">(</span><span class="string" id="5692551">&#34;%s&#34;</span><span class="op" id="5692555">,</span>&nbsp;<span class="ident" id="5692557">err</span><span class="op" id="5692560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5692564">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692567">case</span>&nbsp;<span class="op" id="5692572">*</span><span class="ident" id="5692573">parse</span><span class="op" id="5692578">.</span><span class="ident" id="5692579">WithNode</span><span class="op" id="5692587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5692591">s</span><span class="op" id="5692592">.</span><span class="ident" id="5692593">walkIfOrWith</span><span class="op" id="5692605">(</span><span class="ident" id="5692606">parse</span><span class="op" id="5692611">.</span><span class="ident" id="5692612">NodeWith</span><span class="op" id="5692620">,</span>&nbsp;<span class="ident" id="5692622">dot</span><span class="op" id="5692625">,</span>&nbsp;<span class="ident" id="5692627">node</span><span class="op" id="5692631">.</span><span class="ident" id="5692632">Pipe</span><span class="op" id="5692636">,</span>&nbsp;<span class="ident" id="5692638">node</span><span class="op" id="5692642">.</span><span class="ident" id="5692643">List</span><span class="op" id="5692647">,</span>&nbsp;<span class="ident" id="5692649">node</span><span class="op" id="5692653">.</span><span class="ident" id="5692654">ElseList</span><span class="op" id="5692662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692665">default</span><span class="op" id="5692672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5692676">s</span><span class="op" id="5692677">.</span><span class="ident" id="5692678">errorf</span><span class="op" id="5692684">(</span><span class="string" id="5692685">&#34;unknown&nbsp;node:&nbsp;%s&#34;</span><span class="op" id="5692703">,</span>&nbsp;<span class="ident" id="5692705">node</span><span class="op" id="5692709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5692712">}</span><br>
<span class="lineno">190</span><span class="op" id="5692714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5692717">//&nbsp;walkIfOrWith&nbsp;walks&nbsp;an&nbsp;&#39;if&#39;&nbsp;or&nbsp;&#39;with&#39;&nbsp;node.&nbsp;The&nbsp;two&nbsp;control&nbsp;structures</span><br>
<span class="lineno"></span><span class="comment" id="5692790">//&nbsp;are&nbsp;identical&nbsp;in&nbsp;behavior&nbsp;except&nbsp;that&nbsp;&#39;with&#39;&nbsp;sets&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="5692848">func</span>&nbsp;<span class="op" id="5692853">(</span><span class="ident" id="5692854">s</span>&nbsp;<span class="op" id="5692856">*</span><span class="ident" id="5692857">state</span><span class="op" id="5692862">)</span>&nbsp;<span class="ident" id="5692864">walkIfOrWith</span><span class="op" id="5692876">(</span><span class="ident" id="5692877">typ</span>&nbsp;<span class="ident" id="5692881">parse</span><span class="op" id="5692886">.</span><span class="ident" id="5692887">NodeType</span><span class="op" id="5692895">,</span>&nbsp;<span class="ident" id="5692897">dot</span>&nbsp;<span class="ident" id="5692901">reflect</span><span class="op" id="5692908">.</span><span class="ident" id="5692909">Value</span><span class="op" id="5692914">,</span>&nbsp;<span class="ident" id="5692916">pipe</span>&nbsp;<span class="op" id="5692921">*</span><span class="ident" id="5692922">parse</span><span class="op" id="5692927">.</span><span class="ident" id="5692928">PipeNode</span><span class="op" id="5692936">,</span>&nbsp;<span class="ident" id="5692938">list</span><span class="op" id="5692942">,</span>&nbsp;<span class="ident" id="5692944">elseList</span>&nbsp;<span class="op" id="5692953">*</span><span class="ident" id="5692954">parse</span><span class="op" id="5692959">.</span><span class="ident" id="5692960">ListNode</span><span class="op" id="5692968">)</span>&nbsp;<span class="op" id="5692970">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5692973">defer</span>&nbsp;<span class="ident" id="5692979">s</span><span class="op" id="5692980">.</span><span class="ident" id="5692981">pop</span><span class="op" id="5692984">(</span><span class="ident" id="5692985">s</span><span class="op" id="5692986">.</span><span class="ident" id="5692987">mark</span><span class="op" id="5692991">(</span><span class="op" id="5692992">)</span><span class="op" id="5692993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5692996">val</span>&nbsp;<span class="op" id="5693000">:=</span>&nbsp;<span class="ident" id="5693003">s</span><span class="op" id="5693004">.</span><span class="ident" id="5693005">evalPipeline</span><span class="op" id="5693017">(</span><span class="ident" id="5693018">dot</span><span class="op" id="5693021">,</span>&nbsp;<span class="ident" id="5693023">pipe</span><span class="op" id="5693027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5693030">truth</span><span class="op" id="5693035">,</span>&nbsp;<span class="ident" id="5693037">ok</span>&nbsp;<span class="op" id="5693040">:=</span>&nbsp;<span class="ident" id="5693043">isTrue</span><span class="op" id="5693049">(</span><span class="ident" id="5693050">val</span><span class="op" id="5693053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693056">if</span>&nbsp;<span class="op" id="5693059">!</span><span class="ident" id="5693060">ok</span>&nbsp;<span class="op" id="5693063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5693067">s</span><span class="op" id="5693068">.</span><span class="ident" id="5693069">errorf</span><span class="op" id="5693075">(</span><span class="string" id="5693076">&#34;if/with&nbsp;can&#39;t&nbsp;use&nbsp;%v&#34;</span><span class="op" id="5693098">,</span>&nbsp;<span class="ident" id="5693100">val</span><span class="op" id="5693103">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5693106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693109">if</span>&nbsp;<span class="ident" id="5693112">truth</span>&nbsp;<span class="op" id="5693118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693122">if</span>&nbsp;<span class="ident" id="5693125">typ</span>&nbsp;<span class="op" id="5693129">==</span>&nbsp;<span class="ident" id="5693132">parse</span><span class="op" id="5693137">.</span><span class="ident" id="5693138">NodeWith</span>&nbsp;<span class="op" id="5693147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5693152">s</span><span class="op" id="5693153">.</span><span class="ident" id="5693154">walk</span><span class="op" id="5693158">(</span><span class="ident" id="5693159">val</span><span class="op" id="5693162">,</span>&nbsp;<span class="ident" id="5693164">list</span><span class="op" id="5693168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5693172">}</span>&nbsp;<span class="keyword" id="5693174">else</span>&nbsp;<span class="op" id="5693179">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5693184">s</span><span class="op" id="5693185">.</span><span class="ident" id="5693186">walk</span><span class="op" id="5693190">(</span><span class="ident" id="5693191">dot</span><span class="op" id="5693194">,</span>&nbsp;<span class="ident" id="5693196">list</span><span class="op" id="5693200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5693204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5693207">}</span>&nbsp;<span class="keyword" id="5693209">else</span>&nbsp;<span class="keyword" id="5693214">if</span>&nbsp;<span class="ident" id="5693217">elseList</span>&nbsp;<span class="op" id="5693226">!=</span>&nbsp;<span class="ident" id="5693229">nil</span>&nbsp;<span class="op" id="5693233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5693237">s</span><span class="op" id="5693238">.</span><span class="ident" id="5693239">walk</span><span class="op" id="5693243">(</span><span class="ident" id="5693244">dot</span><span class="op" id="5693247">,</span>&nbsp;<span class="ident" id="5693249">elseList</span><span class="op" id="5693257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5693260">}</span><br>
<span class="lineno">210</span><span class="op" id="5693262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5693265">//&nbsp;isTrue&nbsp;reports&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;&#39;true&#39;,&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;not&nbsp;the&nbsp;zero&nbsp;of&nbsp;its&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="5693354">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;value&nbsp;has&nbsp;a&nbsp;meaningful&nbsp;truth&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5693409">func</span>&nbsp;<span class="ident" id="5693414">isTrue</span><span class="op" id="5693420">(</span><span class="ident" id="5693421">val</span>&nbsp;<span class="ident" id="5693425">reflect</span><span class="op" id="5693432">.</span><span class="ident" id="5693433">Value</span><span class="op" id="5693438">)</span>&nbsp;<span class="op" id="5693440">(</span><span class="ident" id="5693441">truth</span><span class="op" id="5693446">,</span>&nbsp;<span class="ident" id="5693448">ok</span>&nbsp;<span class="builtintype" id="5693451">bool</span><span class="op" id="5693455">)</span>&nbsp;<span class="op" id="5693457">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693460">if</span>&nbsp;<span class="op" id="5693463">!</span><span class="ident" id="5693464">val</span><span class="op" id="5693467">.</span><span class="ident" id="5693468">IsValid</span><span class="op" id="5693475">(</span><span class="op" id="5693476">)</span>&nbsp;<span class="op" id="5693478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5693482">//&nbsp;Something&nbsp;like&nbsp;var&nbsp;x&nbsp;interface{},&nbsp;never&nbsp;set.&nbsp;It&#39;s&nbsp;a&nbsp;form&nbsp;of&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693552">return</span>&nbsp;<span class="builtintype" id="5693559">false</span><span class="op" id="5693564">,</span>&nbsp;<span class="builtintype" id="5693566">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5693572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693575">switch</span>&nbsp;<span class="ident" id="5693582">val</span><span class="op" id="5693585">.</span><span class="ident" id="5693586">Kind</span><span class="op" id="5693590">(</span><span class="op" id="5693591">)</span>&nbsp;<span class="op" id="5693593">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693596">case</span>&nbsp;<span class="ident" id="5693601">reflect</span><span class="op" id="5693608">.</span><span class="ident" id="5693609">Array</span><span class="op" id="5693614">,</span>&nbsp;<span class="ident" id="5693616">reflect</span><span class="op" id="5693623">.</span><span class="ident" id="5693624">Map</span><span class="op" id="5693627">,</span>&nbsp;<span class="ident" id="5693629">reflect</span><span class="op" id="5693636">.</span><span class="ident" id="5693637">Slice</span><span class="op" id="5693642">,</span>&nbsp;<span class="ident" id="5693644">reflect</span><span class="op" id="5693651">.</span><span class="ident" id="5693652">String</span><span class="op" id="5693658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5693662">truth</span>&nbsp;<span class="op" id="5693668">=</span>&nbsp;<span class="ident" id="5693670">val</span><span class="op" id="5693673">.</span><span class="ident" id="5693674">Len</span><span class="op" id="5693677">(</span><span class="op" id="5693678">)</span>&nbsp;<span class="op" id="5693680">&gt;</span>&nbsp;<span class="num" id="5693682">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693685">case</span>&nbsp;<span class="ident" id="5693690">reflect</span><span class="op" id="5693697">.</span><span class="ident" id="5693698">Bool</span><span class="op" id="5693702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5693706">truth</span>&nbsp;<span class="op" id="5693712">=</span>&nbsp;<span class="ident" id="5693714">val</span><span class="op" id="5693717">.</span><span class="ident" id="5693718">Bool</span><span class="op" id="5693722">(</span><span class="op" id="5693723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693726">case</span>&nbsp;<span class="ident" id="5693731">reflect</span><span class="op" id="5693738">.</span><span class="ident" id="5693739">Complex64</span><span class="op" id="5693748">,</span>&nbsp;<span class="ident" id="5693750">reflect</span><span class="op" id="5693757">.</span><span class="ident" id="5693758">Complex128</span><span class="op" id="5693768">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5693772">truth</span>&nbsp;<span class="op" id="5693778">=</span>&nbsp;<span class="ident" id="5693780">val</span><span class="op" id="5693783">.</span><span class="ident" id="5693784">Complex</span><span class="op" id="5693791">(</span><span class="op" id="5693792">)</span>&nbsp;<span class="op" id="5693794">!=</span>&nbsp;<span class="num" id="5693797">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693800">case</span>&nbsp;<span class="ident" id="5693805">reflect</span><span class="op" id="5693812">.</span><span class="ident" id="5693813">Chan</span><span class="op" id="5693817">,</span>&nbsp;<span class="ident" id="5693819">reflect</span><span class="op" id="5693826">.</span><span class="ident" id="5693827">Func</span><span class="op" id="5693831">,</span>&nbsp;<span class="ident" id="5693833">reflect</span><span class="op" id="5693840">.</span><span class="ident" id="5693841">Ptr</span><span class="op" id="5693844">,</span>&nbsp;<span class="ident" id="5693846">reflect</span><span class="op" id="5693853">.</span><span class="ident" id="5693854">Interface</span><span class="op" id="5693863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5693867">truth</span>&nbsp;<span class="op" id="5693873">=</span>&nbsp;<span class="op" id="5693875">!</span><span class="ident" id="5693876">val</span><span class="op" id="5693879">.</span><span class="ident" id="5693880">IsNil</span><span class="op" id="5693885">(</span><span class="op" id="5693886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693889">case</span>&nbsp;<span class="ident" id="5693894">reflect</span><span class="op" id="5693901">.</span><span class="ident" id="5693902">Int</span><span class="op" id="5693905">,</span>&nbsp;<span class="ident" id="5693907">reflect</span><span class="op" id="5693914">.</span><span class="ident" id="5693915">Int8</span><span class="op" id="5693919">,</span>&nbsp;<span class="ident" id="5693921">reflect</span><span class="op" id="5693928">.</span><span class="ident" id="5693929">Int16</span><span class="op" id="5693934">,</span>&nbsp;<span class="ident" id="5693936">reflect</span><span class="op" id="5693943">.</span><span class="ident" id="5693944">Int32</span><span class="op" id="5693949">,</span>&nbsp;<span class="ident" id="5693951">reflect</span><span class="op" id="5693958">.</span><span class="ident" id="5693959">Int64</span><span class="op" id="5693964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5693968">truth</span>&nbsp;<span class="op" id="5693974">=</span>&nbsp;<span class="ident" id="5693976">val</span><span class="op" id="5693979">.</span><span class="ident" id="5693980">Int</span><span class="op" id="5693983">(</span><span class="op" id="5693984">)</span>&nbsp;<span class="op" id="5693986">!=</span>&nbsp;<span class="num" id="5693989">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5693992">case</span>&nbsp;<span class="ident" id="5693997">reflect</span><span class="op" id="5694004">.</span><span class="ident" id="5694005">Float32</span><span class="op" id="5694012">,</span>&nbsp;<span class="ident" id="5694014">reflect</span><span class="op" id="5694021">.</span><span class="ident" id="5694022">Float64</span><span class="op" id="5694029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694033">truth</span>&nbsp;<span class="op" id="5694039">=</span>&nbsp;<span class="ident" id="5694041">val</span><span class="op" id="5694044">.</span><span class="ident" id="5694045">Float</span><span class="op" id="5694050">(</span><span class="op" id="5694051">)</span>&nbsp;<span class="op" id="5694053">!=</span>&nbsp;<span class="num" id="5694056">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694059">case</span>&nbsp;<span class="ident" id="5694064">reflect</span><span class="op" id="5694071">.</span><span class="ident" id="5694072">Uint</span><span class="op" id="5694076">,</span>&nbsp;<span class="ident" id="5694078">reflect</span><span class="op" id="5694085">.</span><span class="ident" id="5694086">Uint8</span><span class="op" id="5694091">,</span>&nbsp;<span class="ident" id="5694093">reflect</span><span class="op" id="5694100">.</span><span class="ident" id="5694101">Uint16</span><span class="op" id="5694107">,</span>&nbsp;<span class="ident" id="5694109">reflect</span><span class="op" id="5694116">.</span><span class="ident" id="5694117">Uint32</span><span class="op" id="5694123">,</span>&nbsp;<span class="ident" id="5694125">reflect</span><span class="op" id="5694132">.</span><span class="ident" id="5694133">Uint64</span><span class="op" id="5694139">,</span>&nbsp;<span class="ident" id="5694141">reflect</span><span class="op" id="5694148">.</span><span class="ident" id="5694149">Uintptr</span><span class="op" id="5694156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694160">truth</span>&nbsp;<span class="op" id="5694166">=</span>&nbsp;<span class="ident" id="5694168">val</span><span class="op" id="5694171">.</span><span class="ident" id="5694172">Uint</span><span class="op" id="5694176">(</span><span class="op" id="5694177">)</span>&nbsp;<span class="op" id="5694179">!=</span>&nbsp;<span class="num" id="5694182">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694185">case</span>&nbsp;<span class="ident" id="5694190">reflect</span><span class="op" id="5694197">.</span><span class="ident" id="5694198">Struct</span><span class="op" id="5694204">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694208">truth</span>&nbsp;<span class="op" id="5694214">=</span>&nbsp;<span class="builtintype" id="5694216">true</span>&nbsp;<span class="comment" id="5694221">//&nbsp;Struct&nbsp;values&nbsp;are&nbsp;always&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694256">default</span><span class="op" id="5694263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694267">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5694275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694278">return</span>&nbsp;<span class="ident" id="5694285">truth</span><span class="op" id="5694290">,</span>&nbsp;<span class="builtintype" id="5694292">true</span><br>
<span class="lineno">240</span><span class="op" id="5694297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5694300">func</span>&nbsp;<span class="op" id="5694305">(</span><span class="ident" id="5694306">s</span>&nbsp;<span class="op" id="5694308">*</span><span class="ident" id="5694309">state</span><span class="op" id="5694314">)</span>&nbsp;<span class="ident" id="5694316">walkRange</span><span class="op" id="5694325">(</span><span class="ident" id="5694326">dot</span>&nbsp;<span class="ident" id="5694330">reflect</span><span class="op" id="5694337">.</span><span class="ident" id="5694338">Value</span><span class="op" id="5694343">,</span>&nbsp;<span class="ident" id="5694345">r</span>&nbsp;<span class="op" id="5694347">*</span><span class="ident" id="5694348">parse</span><span class="op" id="5694353">.</span><span class="ident" id="5694354">RangeNode</span><span class="op" id="5694363">)</span>&nbsp;<span class="op" id="5694365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694368">s</span><span class="op" id="5694369">.</span><span class="ident" id="5694370">at</span><span class="op" id="5694372">(</span><span class="ident" id="5694373">r</span><span class="op" id="5694374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694377">defer</span>&nbsp;<span class="ident" id="5694383">s</span><span class="op" id="5694384">.</span><span class="ident" id="5694385">pop</span><span class="op" id="5694388">(</span><span class="ident" id="5694389">s</span><span class="op" id="5694390">.</span><span class="ident" id="5694391">mark</span><span class="op" id="5694395">(</span><span class="op" id="5694396">)</span><span class="op" id="5694397">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694400">val</span><span class="op" id="5694403">,</span>&nbsp;<span class="ident" id="5694405">_</span>&nbsp;<span class="op" id="5694407">:=</span>&nbsp;<span class="ident" id="5694410">indirect</span><span class="op" id="5694418">(</span><span class="ident" id="5694419">s</span><span class="op" id="5694420">.</span><span class="ident" id="5694421">evalPipeline</span><span class="op" id="5694433">(</span><span class="ident" id="5694434">dot</span><span class="op" id="5694437">,</span>&nbsp;<span class="ident" id="5694439">r</span><span class="op" id="5694440">.</span><span class="ident" id="5694441">Pipe</span><span class="op" id="5694445">)</span><span class="op" id="5694446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5694449">//&nbsp;mark&nbsp;top&nbsp;of&nbsp;stack&nbsp;before&nbsp;any&nbsp;variables&nbsp;in&nbsp;the&nbsp;body&nbsp;are&nbsp;pushed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694516">mark</span>&nbsp;<span class="op" id="5694521">:=</span>&nbsp;<span class="ident" id="5694524">s</span><span class="op" id="5694525">.</span><span class="ident" id="5694526">mark</span><span class="op" id="5694530">(</span><span class="op" id="5694531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694534">oneIteration</span>&nbsp;<span class="op" id="5694547">:=</span>&nbsp;<span class="keyword" id="5694550">func</span><span class="op" id="5694554">(</span><span class="ident" id="5694555">index</span><span class="op" id="5694560">,</span>&nbsp;<span class="ident" id="5694562">elem</span>&nbsp;<span class="ident" id="5694567">reflect</span><span class="op" id="5694574">.</span><span class="ident" id="5694575">Value</span><span class="op" id="5694580">)</span>&nbsp;<span class="op" id="5694582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5694586">//&nbsp;Set&nbsp;top&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;second&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;element.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694659">if</span>&nbsp;<span class="builtinfunc" id="5694662">len</span><span class="op" id="5694665">(</span><span class="ident" id="5694666">r</span><span class="op" id="5694667">.</span><span class="ident" id="5694668">Pipe</span><span class="op" id="5694672">.</span><span class="ident" id="5694673">Decl</span><span class="op" id="5694677">)</span>&nbsp;<span class="op" id="5694679">&gt;</span>&nbsp;<span class="num" id="5694681">0</span>&nbsp;<span class="op" id="5694683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694688">s</span><span class="op" id="5694689">.</span><span class="ident" id="5694690">setVar</span><span class="op" id="5694696">(</span><span class="num" id="5694697">1</span><span class="op" id="5694698">,</span>&nbsp;<span class="ident" id="5694700">elem</span><span class="op" id="5694704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5694708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5694712">//&nbsp;Set&nbsp;next&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;first&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694783">if</span>&nbsp;<span class="builtinfunc" id="5694786">len</span><span class="op" id="5694789">(</span><span class="ident" id="5694790">r</span><span class="op" id="5694791">.</span><span class="ident" id="5694792">Pipe</span><span class="op" id="5694796">.</span><span class="ident" id="5694797">Decl</span><span class="op" id="5694801">)</span>&nbsp;<span class="op" id="5694803">&gt;</span>&nbsp;<span class="num" id="5694805">1</span>&nbsp;<span class="op" id="5694807">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694812">s</span><span class="op" id="5694813">.</span><span class="ident" id="5694814">setVar</span><span class="op" id="5694820">(</span><span class="num" id="5694821">2</span><span class="op" id="5694822">,</span>&nbsp;<span class="ident" id="5694824">index</span><span class="op" id="5694829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5694833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694837">s</span><span class="op" id="5694838">.</span><span class="ident" id="5694839">walk</span><span class="op" id="5694843">(</span><span class="ident" id="5694844">elem</span><span class="op" id="5694848">,</span>&nbsp;<span class="ident" id="5694850">r</span><span class="op" id="5694851">.</span><span class="ident" id="5694852">List</span><span class="op" id="5694856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694860">s</span><span class="op" id="5694861">.</span><span class="ident" id="5694862">pop</span><span class="op" id="5694865">(</span><span class="ident" id="5694866">mark</span><span class="op" id="5694870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5694873">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694876">switch</span>&nbsp;<span class="ident" id="5694883">val</span><span class="op" id="5694886">.</span><span class="ident" id="5694887">Kind</span><span class="op" id="5694891">(</span><span class="op" id="5694892">)</span>&nbsp;<span class="op" id="5694894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694897">case</span>&nbsp;<span class="ident" id="5694902">reflect</span><span class="op" id="5694909">.</span><span class="ident" id="5694910">Array</span><span class="op" id="5694915">,</span>&nbsp;<span class="ident" id="5694917">reflect</span><span class="op" id="5694924">.</span><span class="ident" id="5694925">Slice</span><span class="op" id="5694930">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694934">if</span>&nbsp;<span class="ident" id="5694937">val</span><span class="op" id="5694940">.</span><span class="ident" id="5694941">Len</span><span class="op" id="5694944">(</span><span class="op" id="5694945">)</span>&nbsp;<span class="op" id="5694947">==</span>&nbsp;<span class="num" id="5694950">0</span>&nbsp;<span class="op" id="5694952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694957">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5694965">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694969">for</span>&nbsp;<span class="ident" id="5694973">i</span>&nbsp;<span class="op" id="5694975">:=</span>&nbsp;<span class="num" id="5694978">0</span><span class="op" id="5694979">;</span>&nbsp;<span class="ident" id="5694981">i</span>&nbsp;<span class="op" id="5694983">&lt;</span>&nbsp;<span class="ident" id="5694985">val</span><span class="op" id="5694988">.</span><span class="ident" id="5694989">Len</span><span class="op" id="5694992">(</span><span class="op" id="5694993">)</span><span class="op" id="5694994">;</span>&nbsp;<span class="ident" id="5694996">i</span><span class="op" id="5694997">++</span>&nbsp;<span class="op" id="5695000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695005">oneIteration</span><span class="op" id="5695017">(</span><span class="ident" id="5695018">reflect</span><span class="op" id="5695025">.</span><span class="ident" id="5695026">ValueOf</span><span class="op" id="5695033">(</span><span class="ident" id="5695034">i</span><span class="op" id="5695035">)</span><span class="op" id="5695036">,</span>&nbsp;<span class="ident" id="5695038">val</span><span class="op" id="5695041">.</span><span class="ident" id="5695042">Index</span><span class="op" id="5695047">(</span><span class="ident" id="5695048">i</span><span class="op" id="5695049">)</span><span class="op" id="5695050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695058">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695066">case</span>&nbsp;<span class="ident" id="5695071">reflect</span><span class="op" id="5695078">.</span><span class="ident" id="5695079">Map</span><span class="op" id="5695082">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695086">if</span>&nbsp;<span class="ident" id="5695089">val</span><span class="op" id="5695092">.</span><span class="ident" id="5695093">Len</span><span class="op" id="5695096">(</span><span class="op" id="5695097">)</span>&nbsp;<span class="op" id="5695099">==</span>&nbsp;<span class="num" id="5695102">0</span>&nbsp;<span class="op" id="5695104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695109">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695121">for</span>&nbsp;<span class="ident" id="5695125">_</span><span class="op" id="5695126">,</span>&nbsp;<span class="ident" id="5695128">key</span>&nbsp;<span class="op" id="5695132">:=</span>&nbsp;<span class="keyword" id="5695135">range</span>&nbsp;<span class="ident" id="5695141">sortKeys</span><span class="op" id="5695149">(</span><span class="ident" id="5695150">val</span><span class="op" id="5695153">.</span><span class="ident" id="5695154">MapKeys</span><span class="op" id="5695161">(</span><span class="op" id="5695162">)</span><span class="op" id="5695163">)</span>&nbsp;<span class="op" id="5695165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695170">oneIteration</span><span class="op" id="5695182">(</span><span class="ident" id="5695183">key</span><span class="op" id="5695186">,</span>&nbsp;<span class="ident" id="5695188">val</span><span class="op" id="5695191">.</span><span class="ident" id="5695192">MapIndex</span><span class="op" id="5695200">(</span><span class="ident" id="5695201">key</span><span class="op" id="5695204">)</span><span class="op" id="5695205">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695213">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695221">case</span>&nbsp;<span class="ident" id="5695226">reflect</span><span class="op" id="5695233">.</span><span class="ident" id="5695234">Chan</span><span class="op" id="5695238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695242">if</span>&nbsp;<span class="ident" id="5695245">val</span><span class="op" id="5695248">.</span><span class="ident" id="5695249">IsNil</span><span class="op" id="5695254">(</span><span class="op" id="5695255">)</span>&nbsp;<span class="op" id="5695257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695262">break</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695274">i</span>&nbsp;<span class="op" id="5695276">:=</span>&nbsp;<span class="num" id="5695279">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695283">for</span>&nbsp;<span class="op" id="5695287">;</span>&nbsp;<span class="op" id="5695289">;</span>&nbsp;<span class="ident" id="5695291">i</span><span class="op" id="5695292">++</span>&nbsp;<span class="op" id="5695295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695300">elem</span><span class="op" id="5695304">,</span>&nbsp;<span class="ident" id="5695306">ok</span>&nbsp;<span class="op" id="5695309">:=</span>&nbsp;<span class="ident" id="5695312">val</span><span class="op" id="5695315">.</span><span class="ident" id="5695316">Recv</span><span class="op" id="5695320">(</span><span class="op" id="5695321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695326">if</span>&nbsp;<span class="op" id="5695329">!</span><span class="ident" id="5695330">ok</span>&nbsp;<span class="op" id="5695333">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695339">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695353">oneIteration</span><span class="op" id="5695365">(</span><span class="ident" id="5695366">reflect</span><span class="op" id="5695373">.</span><span class="ident" id="5695374">ValueOf</span><span class="op" id="5695381">(</span><span class="ident" id="5695382">i</span><span class="op" id="5695383">)</span><span class="op" id="5695384">,</span>&nbsp;<span class="ident" id="5695386">elem</span><span class="op" id="5695390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695398">if</span>&nbsp;<span class="ident" id="5695401">i</span>&nbsp;<span class="op" id="5695403">==</span>&nbsp;<span class="num" id="5695406">0</span>&nbsp;<span class="op" id="5695408">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695413">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695425">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695433">case</span>&nbsp;<span class="ident" id="5695438">reflect</span><span class="op" id="5695445">.</span><span class="ident" id="5695446">Invalid</span><span class="op" id="5695453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695457">break</span>&nbsp;<span class="comment" id="5695463">//&nbsp;An&nbsp;invalid&nbsp;value&nbsp;is&nbsp;likely&nbsp;a&nbsp;nil&nbsp;map,&nbsp;etc.&nbsp;and&nbsp;acts&nbsp;like&nbsp;an&nbsp;empty&nbsp;map.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695538">default</span><span class="op" id="5695545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695549">s</span><span class="op" id="5695550">.</span><span class="ident" id="5695551">errorf</span><span class="op" id="5695557">(</span><span class="string" id="5695558">&#34;range&nbsp;can&#39;t&nbsp;iterate&nbsp;over&nbsp;%v&#34;</span><span class="op" id="5695587">,</span>&nbsp;<span class="ident" id="5695589">val</span><span class="op" id="5695592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695598">if</span>&nbsp;<span class="ident" id="5695601">r</span><span class="op" id="5695602">.</span><span class="ident" id="5695603">ElseList</span>&nbsp;<span class="op" id="5695612">!=</span>&nbsp;<span class="ident" id="5695615">nil</span>&nbsp;<span class="op" id="5695619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695623">s</span><span class="op" id="5695624">.</span><span class="ident" id="5695625">walk</span><span class="op" id="5695629">(</span><span class="ident" id="5695630">dot</span><span class="op" id="5695633">,</span>&nbsp;<span class="ident" id="5695635">r</span><span class="op" id="5695636">.</span><span class="ident" id="5695637">ElseList</span><span class="op" id="5695645">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695648">}</span><br>
<span class="lineno"></span><span class="op" id="5695650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5695653">func</span>&nbsp;<span class="op" id="5695658">(</span><span class="ident" id="5695659">s</span>&nbsp;<span class="op" id="5695661">*</span><span class="ident" id="5695662">state</span><span class="op" id="5695667">)</span>&nbsp;<span class="ident" id="5695669">walkTemplate</span><span class="op" id="5695681">(</span><span class="ident" id="5695682">dot</span>&nbsp;<span class="ident" id="5695686">reflect</span><span class="op" id="5695693">.</span><span class="ident" id="5695694">Value</span><span class="op" id="5695699">,</span>&nbsp;<span class="ident" id="5695701">t</span>&nbsp;<span class="op" id="5695703">*</span><span class="ident" id="5695704">parse</span><span class="op" id="5695709">.</span><span class="ident" id="5695710">TemplateNode</span><span class="op" id="5695722">)</span>&nbsp;<span class="op" id="5695724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695727">s</span><span class="op" id="5695728">.</span><span class="ident" id="5695729">at</span><span class="op" id="5695731">(</span><span class="ident" id="5695732">t</span><span class="op" id="5695733">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695736">tmpl</span>&nbsp;<span class="op" id="5695741">:=</span>&nbsp;<span class="ident" id="5695744">s</span><span class="op" id="5695745">.</span><span class="ident" id="5695746">tmpl</span><span class="op" id="5695750">.</span><span class="ident" id="5695751">tmpl</span><span class="op" id="5695755">[</span><span class="ident" id="5695756">t</span><span class="op" id="5695757">.</span><span class="ident" id="5695758">Name</span><span class="op" id="5695762">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695765">if</span>&nbsp;<span class="ident" id="5695768">tmpl</span>&nbsp;<span class="op" id="5695773">==</span>&nbsp;<span class="ident" id="5695776">nil</span>&nbsp;<span class="op" id="5695780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695784">s</span><span class="op" id="5695785">.</span><span class="ident" id="5695786">errorf</span><span class="op" id="5695792">(</span><span class="string" id="5695793">&#34;template&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="5695818">,</span>&nbsp;<span class="ident" id="5695820">t</span><span class="op" id="5695821">.</span><span class="ident" id="5695822">Name</span><span class="op" id="5695826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5695832">//&nbsp;Variables&nbsp;declared&nbsp;by&nbsp;the&nbsp;pipeline&nbsp;persist.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695880">dot</span>&nbsp;<span class="op" id="5695884">=</span>&nbsp;<span class="ident" id="5695886">s</span><span class="op" id="5695887">.</span><span class="ident" id="5695888">evalPipeline</span><span class="op" id="5695900">(</span><span class="ident" id="5695901">dot</span><span class="op" id="5695904">,</span>&nbsp;<span class="ident" id="5695906">t</span><span class="op" id="5695907">.</span><span class="ident" id="5695908">Pipe</span><span class="op" id="5695912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695915">newState</span>&nbsp;<span class="op" id="5695924">:=</span>&nbsp;<span class="op" id="5695927">*</span><span class="ident" id="5695928">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695931">newState</span><span class="op" id="5695939">.</span><span class="ident" id="5695940">tmpl</span>&nbsp;<span class="op" id="5695945">=</span>&nbsp;<span class="ident" id="5695947">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5695953">//&nbsp;No&nbsp;dynamic&nbsp;scoping:&nbsp;template&nbsp;invocations&nbsp;inherit&nbsp;no&nbsp;variables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5696020">newState</span><span class="op" id="5696028">.</span><span class="ident" id="5696029">vars</span>&nbsp;<span class="op" id="5696034">=</span>&nbsp;<span class="op" id="5696036">[</span><span class="op" id="5696037">]</span><span class="ident" id="5696038">variable</span><span class="op" id="5696046">{</span><span class="op" id="5696047">{</span><span class="string" id="5696048">&#34;$&#34;</span><span class="op" id="5696051">,</span>&nbsp;<span class="ident" id="5696053">dot</span><span class="op" id="5696056">}</span><span class="op" id="5696057">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5696060">newState</span><span class="op" id="5696068">.</span><span class="ident" id="5696069">walk</span><span class="op" id="5696073">(</span><span class="ident" id="5696074">dot</span><span class="op" id="5696077">,</span>&nbsp;<span class="ident" id="5696079">tmpl</span><span class="op" id="5696083">.</span><span class="ident" id="5696084">Root</span><span class="op" id="5696088">)</span><br>
<span class="lineno"></span><span class="op" id="5696090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5696093">//&nbsp;Eval&nbsp;functions&nbsp;evaluate&nbsp;pipelines,&nbsp;commands,&nbsp;and&nbsp;their&nbsp;elements&nbsp;and&nbsp;extract</span><br>
<span class="lineno"></span><span class="comment" id="5696172">//&nbsp;values&nbsp;from&nbsp;the&nbsp;data&nbsp;structure&nbsp;by&nbsp;examining&nbsp;fields,&nbsp;calling&nbsp;methods,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">320</span><span class="comment" id="5696255">//&nbsp;The&nbsp;printing&nbsp;of&nbsp;those&nbsp;values&nbsp;happens&nbsp;only&nbsp;through&nbsp;walk&nbsp;functions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5696325">//&nbsp;evalPipeline&nbsp;returns&nbsp;the&nbsp;value&nbsp;acquired&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;pipeline.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5696401">//&nbsp;pipeline&nbsp;has&nbsp;a&nbsp;variable&nbsp;declaration,&nbsp;the&nbsp;variable&nbsp;will&nbsp;be&nbsp;pushed&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5696476">//&nbsp;stack.&nbsp;Callers&nbsp;should&nbsp;therefore&nbsp;pop&nbsp;the&nbsp;stack&nbsp;after&nbsp;they&nbsp;are&nbsp;finished</span><br>
<span class="lineno">325</span><span class="comment" id="5696549">//&nbsp;executing&nbsp;commands&nbsp;depending&nbsp;on&nbsp;the&nbsp;pipeline&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5696604">func</span>&nbsp;<span class="op" id="5696609">(</span><span class="ident" id="5696610">s</span>&nbsp;<span class="op" id="5696612">*</span><span class="ident" id="5696613">state</span><span class="op" id="5696618">)</span>&nbsp;<span class="ident" id="5696620">evalPipeline</span><span class="op" id="5696632">(</span><span class="ident" id="5696633">dot</span>&nbsp;<span class="ident" id="5696637">reflect</span><span class="op" id="5696644">.</span><span class="ident" id="5696645">Value</span><span class="op" id="5696650">,</span>&nbsp;<span class="ident" id="5696652">pipe</span>&nbsp;<span class="op" id="5696657">*</span><span class="ident" id="5696658">parse</span><span class="op" id="5696663">.</span><span class="ident" id="5696664">PipeNode</span><span class="op" id="5696672">)</span>&nbsp;<span class="op" id="5696674">(</span><span class="ident" id="5696675">value</span>&nbsp;<span class="ident" id="5696681">reflect</span><span class="op" id="5696688">.</span><span class="ident" id="5696689">Value</span><span class="op" id="5696694">)</span>&nbsp;<span class="op" id="5696696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5696699">if</span>&nbsp;<span class="ident" id="5696702">pipe</span>&nbsp;<span class="op" id="5696707">==</span>&nbsp;<span class="ident" id="5696710">nil</span>&nbsp;<span class="op" id="5696714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5696718">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5696726">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5696729">s</span><span class="op" id="5696730">.</span><span class="ident" id="5696731">at</span><span class="op" id="5696733">(</span><span class="ident" id="5696734">pipe</span><span class="op" id="5696738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5696741">for</span>&nbsp;<span class="ident" id="5696745">_</span><span class="op" id="5696746">,</span>&nbsp;<span class="ident" id="5696748">cmd</span>&nbsp;<span class="op" id="5696752">:=</span>&nbsp;<span class="keyword" id="5696755">range</span>&nbsp;<span class="ident" id="5696761">pipe</span><span class="op" id="5696765">.</span><span class="ident" id="5696766">Cmds</span>&nbsp;<span class="op" id="5696771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5696775">value</span>&nbsp;<span class="op" id="5696781">=</span>&nbsp;<span class="ident" id="5696783">s</span><span class="op" id="5696784">.</span><span class="ident" id="5696785">evalCommand</span><span class="op" id="5696796">(</span><span class="ident" id="5696797">dot</span><span class="op" id="5696800">,</span>&nbsp;<span class="ident" id="5696802">cmd</span><span class="op" id="5696805">,</span>&nbsp;<span class="ident" id="5696807">value</span><span class="op" id="5696812">)</span>&nbsp;<span class="comment" id="5696814">//&nbsp;previous&nbsp;value&nbsp;is&nbsp;this&nbsp;one&#39;s&nbsp;final&nbsp;arg.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5696859">//&nbsp;If&nbsp;the&nbsp;object&nbsp;has&nbsp;type&nbsp;interface{},&nbsp;dig&nbsp;down&nbsp;one&nbsp;level&nbsp;to&nbsp;the&nbsp;thing&nbsp;inside.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5696940">if</span>&nbsp;<span class="ident" id="5696943">value</span><span class="op" id="5696948">.</span><span class="ident" id="5696949">Kind</span><span class="op" id="5696953">(</span><span class="op" id="5696954">)</span>&nbsp;<span class="op" id="5696956">==</span>&nbsp;<span class="ident" id="5696959">reflect</span><span class="op" id="5696966">.</span><span class="ident" id="5696967">Interface</span>&nbsp;<span class="op" id="5696977">&amp;&amp;</span>&nbsp;<span class="ident" id="5696980">value</span><span class="op" id="5696985">.</span><span class="ident" id="5696986">Type</span><span class="op" id="5696990">(</span><span class="op" id="5696991">)</span><span class="op" id="5696992">.</span><span class="ident" id="5696993">NumMethod</span><span class="op" id="5697002">(</span><span class="op" id="5697003">)</span>&nbsp;<span class="op" id="5697005">==</span>&nbsp;<span class="num" id="5697008">0</span>&nbsp;<span class="op" id="5697010">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697015">value</span>&nbsp;<span class="op" id="5697021">=</span>&nbsp;<span class="ident" id="5697023">reflect</span><span class="op" id="5697030">.</span><span class="ident" id="5697031">ValueOf</span><span class="op" id="5697038">(</span><span class="ident" id="5697039">value</span><span class="op" id="5697044">.</span><span class="ident" id="5697045">Interface</span><span class="op" id="5697054">(</span><span class="op" id="5697055">)</span><span class="op" id="5697056">)</span>&nbsp;<span class="comment" id="5697058">//&nbsp;lovely!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5697071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5697074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697077">for</span>&nbsp;<span class="ident" id="5697081">_</span><span class="op" id="5697082">,</span>&nbsp;<span class="ident" id="5697084">variable</span>&nbsp;<span class="op" id="5697093">:=</span>&nbsp;<span class="keyword" id="5697096">range</span>&nbsp;<span class="ident" id="5697102">pipe</span><span class="op" id="5697106">.</span><span class="ident" id="5697107">Decl</span>&nbsp;<span class="op" id="5697112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697116">s</span><span class="op" id="5697117">.</span><span class="ident" id="5697118">push</span><span class="op" id="5697122">(</span><span class="ident" id="5697123">variable</span><span class="op" id="5697131">.</span><span class="ident" id="5697132">Ident</span><span class="op" id="5697137">[</span><span class="num" id="5697138">0</span><span class="op" id="5697139">]</span><span class="op" id="5697140">,</span>&nbsp;<span class="ident" id="5697142">value</span><span class="op" id="5697147">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5697150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697153">return</span>&nbsp;<span class="ident" id="5697160">value</span><br>
<span class="lineno"></span><span class="op" id="5697166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5697169">func</span>&nbsp;<span class="op" id="5697174">(</span><span class="ident" id="5697175">s</span>&nbsp;<span class="op" id="5697177">*</span><span class="ident" id="5697178">state</span><span class="op" id="5697183">)</span>&nbsp;<span class="ident" id="5697185">notAFunction</span><span class="op" id="5697197">(</span><span class="ident" id="5697198">args</span>&nbsp;<span class="op" id="5697203">[</span><span class="op" id="5697204">]</span><span class="ident" id="5697205">parse</span><span class="op" id="5697210">.</span><span class="ident" id="5697211">Node</span><span class="op" id="5697215">,</span>&nbsp;<span class="ident" id="5697217">final</span>&nbsp;<span class="ident" id="5697223">reflect</span><span class="op" id="5697230">.</span><span class="ident" id="5697231">Value</span><span class="op" id="5697236">)</span>&nbsp;<span class="op" id="5697238">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697241">if</span>&nbsp;<span class="builtinfunc" id="5697244">len</span><span class="op" id="5697247">(</span><span class="ident" id="5697248">args</span><span class="op" id="5697252">)</span>&nbsp;<span class="op" id="5697254">&gt;</span>&nbsp;<span class="num" id="5697256">1</span>&nbsp;<span class="op" id="5697258">||</span>&nbsp;<span class="ident" id="5697261">final</span><span class="op" id="5697266">.</span><span class="ident" id="5697267">IsValid</span><span class="op" id="5697274">(</span><span class="op" id="5697275">)</span>&nbsp;<span class="op" id="5697277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697281">s</span><span class="op" id="5697282">.</span><span class="ident" id="5697283">errorf</span><span class="op" id="5697289">(</span><span class="string" id="5697290">&#34;can&#39;t&nbsp;give&nbsp;argument&nbsp;to&nbsp;non-function&nbsp;%s&#34;</span><span class="op" id="5697330">,</span>&nbsp;<span class="ident" id="5697332">args</span><span class="op" id="5697336">[</span><span class="num" id="5697337">0</span><span class="op" id="5697338">]</span><span class="op" id="5697339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5697342">}</span><br>
<span class="lineno"></span><span class="op" id="5697344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="5697347">func</span>&nbsp;<span class="op" id="5697352">(</span><span class="ident" id="5697353">s</span>&nbsp;<span class="op" id="5697355">*</span><span class="ident" id="5697356">state</span><span class="op" id="5697361">)</span>&nbsp;<span class="ident" id="5697363">evalCommand</span><span class="op" id="5697374">(</span><span class="ident" id="5697375">dot</span>&nbsp;<span class="ident" id="5697379">reflect</span><span class="op" id="5697386">.</span><span class="ident" id="5697387">Value</span><span class="op" id="5697392">,</span>&nbsp;<span class="ident" id="5697394">cmd</span>&nbsp;<span class="op" id="5697398">*</span><span class="ident" id="5697399">parse</span><span class="op" id="5697404">.</span><span class="ident" id="5697405">CommandNode</span><span class="op" id="5697416">,</span>&nbsp;<span class="ident" id="5697418">final</span>&nbsp;<span class="ident" id="5697424">reflect</span><span class="op" id="5697431">.</span><span class="ident" id="5697432">Value</span><span class="op" id="5697437">)</span>&nbsp;<span class="ident" id="5697439">reflect</span><span class="op" id="5697446">.</span><span class="ident" id="5697447">Value</span>&nbsp;<span class="op" id="5697453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697456">firstWord</span>&nbsp;<span class="op" id="5697466">:=</span>&nbsp;<span class="ident" id="5697469">cmd</span><span class="op" id="5697472">.</span><span class="ident" id="5697473">Args</span><span class="op" id="5697477">[</span><span class="num" id="5697478">0</span><span class="op" id="5697479">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697482">switch</span>&nbsp;<span class="ident" id="5697489">n</span>&nbsp;<span class="op" id="5697491">:=</span>&nbsp;<span class="ident" id="5697494">firstWord</span><span class="op" id="5697503">.</span><span class="op" id="5697504">(</span><span class="keyword" id="5697505">type</span><span class="op" id="5697509">)</span>&nbsp;<span class="op" id="5697511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697514">case</span>&nbsp;<span class="op" id="5697519">*</span><span class="ident" id="5697520">parse</span><span class="op" id="5697525">.</span><span class="ident" id="5697526">FieldNode</span><span class="op" id="5697535">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697539">return</span>&nbsp;<span class="ident" id="5697546">s</span><span class="op" id="5697547">.</span><span class="ident" id="5697548">evalFieldNode</span><span class="op" id="5697561">(</span><span class="ident" id="5697562">dot</span><span class="op" id="5697565">,</span>&nbsp;<span class="ident" id="5697567">n</span><span class="op" id="5697568">,</span>&nbsp;<span class="ident" id="5697570">cmd</span><span class="op" id="5697573">.</span><span class="ident" id="5697574">Args</span><span class="op" id="5697578">,</span>&nbsp;<span class="ident" id="5697580">final</span><span class="op" id="5697585">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697588">case</span>&nbsp;<span class="op" id="5697593">*</span><span class="ident" id="5697594">parse</span><span class="op" id="5697599">.</span><span class="ident" id="5697600">ChainNode</span><span class="op" id="5697609">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697613">return</span>&nbsp;<span class="ident" id="5697620">s</span><span class="op" id="5697621">.</span><span class="ident" id="5697622">evalChainNode</span><span class="op" id="5697635">(</span><span class="ident" id="5697636">dot</span><span class="op" id="5697639">,</span>&nbsp;<span class="ident" id="5697641">n</span><span class="op" id="5697642">,</span>&nbsp;<span class="ident" id="5697644">cmd</span><span class="op" id="5697647">.</span><span class="ident" id="5697648">Args</span><span class="op" id="5697652">,</span>&nbsp;<span class="ident" id="5697654">final</span><span class="op" id="5697659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697662">case</span>&nbsp;<span class="op" id="5697667">*</span><span class="ident" id="5697668">parse</span><span class="op" id="5697673">.</span><span class="ident" id="5697674">IdentifierNode</span><span class="op" id="5697688">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5697692">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697717">return</span>&nbsp;<span class="ident" id="5697724">s</span><span class="op" id="5697725">.</span><span class="ident" id="5697726">evalFunction</span><span class="op" id="5697738">(</span><span class="ident" id="5697739">dot</span><span class="op" id="5697742">,</span>&nbsp;<span class="ident" id="5697744">n</span><span class="op" id="5697745">,</span>&nbsp;<span class="ident" id="5697747">cmd</span><span class="op" id="5697750">,</span>&nbsp;<span class="ident" id="5697752">cmd</span><span class="op" id="5697755">.</span><span class="ident" id="5697756">Args</span><span class="op" id="5697760">,</span>&nbsp;<span class="ident" id="5697762">final</span><span class="op" id="5697767">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697770">case</span>&nbsp;<span class="op" id="5697775">*</span><span class="ident" id="5697776">parse</span><span class="op" id="5697781">.</span><span class="ident" id="5697782">PipeNode</span><span class="op" id="5697790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5697794">//&nbsp;Parenthesized&nbsp;pipeline.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;all&nbsp;inside&nbsp;the&nbsp;pipeline;&nbsp;final&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697884">return</span>&nbsp;<span class="ident" id="5697891">s</span><span class="op" id="5697892">.</span><span class="ident" id="5697893">evalPipeline</span><span class="op" id="5697905">(</span><span class="ident" id="5697906">dot</span><span class="op" id="5697909">,</span>&nbsp;<span class="ident" id="5697911">n</span><span class="op" id="5697912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697915">case</span>&nbsp;<span class="op" id="5697920">*</span><span class="ident" id="5697921">parse</span><span class="op" id="5697926">.</span><span class="ident" id="5697927">VariableNode</span><span class="op" id="5697939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5697943">return</span>&nbsp;<span class="ident" id="5697950">s</span><span class="op" id="5697951">.</span><span class="ident" id="5697952">evalVariableNode</span><span class="op" id="5697968">(</span><span class="ident" id="5697969">dot</span><span class="op" id="5697972">,</span>&nbsp;<span class="ident" id="5697974">n</span><span class="op" id="5697975">,</span>&nbsp;<span class="ident" id="5697977">cmd</span><span class="op" id="5697980">.</span><span class="ident" id="5697981">Args</span><span class="op" id="5697985">,</span>&nbsp;<span class="ident" id="5697987">final</span><span class="op" id="5697992">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5697995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697998">s</span><span class="op" id="5697999">.</span><span class="ident" id="5698000">at</span><span class="op" id="5698002">(</span><span class="ident" id="5698003">firstWord</span><span class="op" id="5698012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5698015">s</span><span class="op" id="5698016">.</span><span class="ident" id="5698017">notAFunction</span><span class="op" id="5698029">(</span><span class="ident" id="5698030">cmd</span><span class="op" id="5698033">.</span><span class="ident" id="5698034">Args</span><span class="op" id="5698038">,</span>&nbsp;<span class="ident" id="5698040">final</span><span class="op" id="5698045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5698048">switch</span>&nbsp;<span class="ident" id="5698055">word</span>&nbsp;<span class="op" id="5698060">:=</span>&nbsp;<span class="ident" id="5698063">firstWord</span><span class="op" id="5698072">.</span><span class="op" id="5698073">(</span><span class="keyword" id="5698074">type</span><span class="op" id="5698078">)</span>&nbsp;<span class="op" id="5698080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5698083">case</span>&nbsp;<span class="op" id="5698088">*</span><span class="ident" id="5698089">parse</span><span class="op" id="5698094">.</span><span class="ident" id="5698095">BoolNode</span><span class="op" id="5698103">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5698107">return</span>&nbsp;<span class="ident" id="5698114">reflect</span><span class="op" id="5698121">.</span><span class="ident" id="5698122">ValueOf</span><span class="op" id="5698129">(</span><span class="ident" id="5698130">word</span><span class="op" id="5698134">.</span><span class="ident" id="5698135">True</span><span class="op" id="5698139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5698142">case</span>&nbsp;<span class="op" id="5698147">*</span><span class="ident" id="5698148">parse</span><span class="op" id="5698153">.</span><span class="ident" id="5698154">DotNode</span><span class="op" id="5698161">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5698165">return</span>&nbsp;<span class="ident" id="5698172">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5698177">case</span>&nbsp;<span class="op" id="5698182">*</span><span class="ident" id="5698183">parse</span><span class="op" id="5698188">.</span><span class="ident" id="5698189">NilNode</span><span class="op" id="5698196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5698200">s</span><span class="op" id="5698201">.</span><span class="ident" id="5698202">errorf</span><span class="op" id="5698208">(</span><span class="string" id="5698209">&#34;nil&nbsp;is&nbsp;not&nbsp;a&nbsp;command&#34;</span><span class="op" id="5698231">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5698234">case</span>&nbsp;<span class="op" id="5698239">*</span><span class="ident" id="5698240">parse</span><span class="op" id="5698245">.</span><span class="ident" id="5698246">NumberNode</span><span class="op" id="5698256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5698260">return</span>&nbsp;<span class="ident" id="5698267">s</span><span class="op" id="5698268">.</span><span class="ident" id="5698269">idealConstant</span><span class="op" id="5698282">(</span><span class="ident" id="5698283">word</span><span class="op" id="5698287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5698290">case</span>&nbsp;<span class="op" id="5698295">*</span><span class="ident" id="5698296">parse</span><span class="op" id="5698301">.</span><span class="ident" id="5698302">StringNode</span><span class="op" id="5698312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5698316">return</span>&nbsp;<span class="ident" id="5698323">reflect</span><span class="op" id="5698330">.</span><span class="ident" id="5698331">ValueOf</span><span class="op" id="5698338">(</span><span class="ident" id="5698339">word</span><span class="op" id="5698343">.</span><span class="ident" id="5698344">Text</span><span class="op" id="5698348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5698351">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5698354">s</span><span class="op" id="5698355">.</span><span class="ident" id="5698356">errorf</span><span class="op" id="5698362">(</span><span class="string" id="5698363">&#34;can&#39;t&nbsp;evaluate&nbsp;command&nbsp;%q&#34;</span><span class="op" id="5698390">,</span>&nbsp;<span class="ident" id="5698392">firstWord</span><span class="op" id="5698401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5698404">panic</span><span class="op" id="5698409">(</span><span class="string" id="5698410">&#34;not&nbsp;reached&#34;</span><span class="op" id="5698423">)</span><br>
<span class="lineno"></span><span class="op" id="5698425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5698428">//&nbsp;idealConstant&nbsp;is&nbsp;called&nbsp;to&nbsp;return&nbsp;the&nbsp;value&nbsp;of&nbsp;a&nbsp;number&nbsp;in&nbsp;a&nbsp;context&nbsp;where</span><br>
<span class="lineno">385</span><span class="comment" id="5698506">//&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;syntax&nbsp;of&nbsp;the&nbsp;number&nbsp;tells&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="5698581">//&nbsp;its&nbsp;type,&nbsp;and&nbsp;we&nbsp;use&nbsp;Go&nbsp;rules&nbsp;to&nbsp;resolve.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5698658">//&nbsp;a&nbsp;uint&nbsp;ideal&nbsp;constant&nbsp;in&nbsp;this&nbsp;situation&nbsp;-&nbsp;the&nbsp;value&nbsp;must&nbsp;be&nbsp;of&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5698734">func</span>&nbsp;<span class="op" id="5698739">(</span><span class="ident" id="5698740">s</span>&nbsp;<span class="op" id="5698742">*</span><span class="ident" id="5698743">state</span><span class="op" id="5698748">)</span>&nbsp;<span class="ident" id="5698750">idealConstant</span><span class="op" id="5698763">(</span><span class="ident" id="5698764">constant</span>&nbsp;<span class="op" id="5698773">*</span><span class="ident" id="5698774">parse</span><span class="op" id="5698779">.</span><span class="ident" id="5698780">NumberNode</span><span class="op" id="5698790">)</span>&nbsp;<span class="ident" id="5698792">reflect</span><span class="op" id="5698799">.</span><span class="ident" id="5698800">Value</span>&nbsp;<span class="op" id="5698806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698809">//&nbsp;These&nbsp;are&nbsp;ideal&nbsp;constants&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698866">//&nbsp;and&nbsp;we&nbsp;have&nbsp;no&nbsp;context.&nbsp;&nbsp;(If&nbsp;it&nbsp;was&nbsp;a&nbsp;method&nbsp;argument,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698925">//&nbsp;we&#39;d&nbsp;know&nbsp;what&nbsp;we&nbsp;need.)&nbsp;The&nbsp;syntax&nbsp;guides&nbsp;us&nbsp;to&nbsp;some&nbsp;extent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5698991">s</span><span class="op" id="5698992">.</span><span class="ident" id="5698993">at</span><span class="op" id="5698995">(</span><span class="ident" id="5698996">constant</span><span class="op" id="5699004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699007">switch</span>&nbsp;<span class="op" id="5699014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699017">case</span>&nbsp;<span class="ident" id="5699022">constant</span><span class="op" id="5699030">.</span><span class="ident" id="5699031">IsComplex</span><span class="op" id="5699040">:</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699044">return</span>&nbsp;<span class="ident" id="5699051">reflect</span><span class="op" id="5699058">.</span><span class="ident" id="5699059">ValueOf</span><span class="op" id="5699066">(</span><span class="ident" id="5699067">constant</span><span class="op" id="5699075">.</span><span class="ident" id="5699076">Complex128</span><span class="op" id="5699086">)</span>&nbsp;<span class="comment" id="5699088">//&nbsp;incontrovertible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699110">case</span>&nbsp;<span class="ident" id="5699115">constant</span><span class="op" id="5699123">.</span><span class="ident" id="5699124">IsFloat</span>&nbsp;<span class="op" id="5699132">&amp;&amp;</span>&nbsp;<span class="op" id="5699135">!</span><span class="ident" id="5699136">isHexConstant</span><span class="op" id="5699149">(</span><span class="ident" id="5699150">constant</span><span class="op" id="5699158">.</span><span class="ident" id="5699159">Text</span><span class="op" id="5699163">)</span>&nbsp;<span class="op" id="5699165">&amp;&amp;</span>&nbsp;<span class="ident" id="5699168">strings</span><span class="op" id="5699175">.</span><span class="ident" id="5699176">IndexAny</span><span class="op" id="5699184">(</span><span class="ident" id="5699185">constant</span><span class="op" id="5699193">.</span><span class="ident" id="5699194">Text</span><span class="op" id="5699198">,</span>&nbsp;<span class="string" id="5699200">&#34;.eE&#34;</span><span class="op" id="5699205">)</span>&nbsp;<span class="op" id="5699207">&gt;=</span>&nbsp;<span class="num" id="5699210">0</span><span class="op" id="5699211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699215">return</span>&nbsp;<span class="ident" id="5699222">reflect</span><span class="op" id="5699229">.</span><span class="ident" id="5699230">ValueOf</span><span class="op" id="5699237">(</span><span class="ident" id="5699238">constant</span><span class="op" id="5699246">.</span><span class="ident" id="5699247">Float64</span><span class="op" id="5699254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699257">case</span>&nbsp;<span class="ident" id="5699262">constant</span><span class="op" id="5699270">.</span><span class="ident" id="5699271">IsInt</span><span class="op" id="5699276">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5699280">n</span>&nbsp;<span class="op" id="5699282">:=</span>&nbsp;<span class="builtintype" id="5699285">int</span><span class="op" id="5699288">(</span><span class="ident" id="5699289">constant</span><span class="op" id="5699297">.</span><span class="ident" id="5699298">Int64</span><span class="op" id="5699303">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699307">if</span>&nbsp;<span class="ident" id="5699310">int64</span><span class="op" id="5699315">(</span><span class="ident" id="5699316">n</span><span class="op" id="5699317">)</span>&nbsp;<span class="op" id="5699319">!=</span>&nbsp;<span class="ident" id="5699322">constant</span><span class="op" id="5699330">.</span><span class="ident" id="5699331">Int64</span>&nbsp;<span class="op" id="5699337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5699342">s</span><span class="op" id="5699343">.</span><span class="ident" id="5699344">errorf</span><span class="op" id="5699350">(</span><span class="string" id="5699351">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="5699369">,</span>&nbsp;<span class="ident" id="5699371">constant</span><span class="op" id="5699379">.</span><span class="ident" id="5699380">Text</span><span class="op" id="5699384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5699388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699392">return</span>&nbsp;<span class="ident" id="5699399">reflect</span><span class="op" id="5699406">.</span><span class="ident" id="5699407">ValueOf</span><span class="op" id="5699414">(</span><span class="ident" id="5699415">n</span><span class="op" id="5699416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699419">case</span>&nbsp;<span class="ident" id="5699424">constant</span><span class="op" id="5699432">.</span><span class="ident" id="5699433">IsUint</span><span class="op" id="5699439">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5699443">s</span><span class="op" id="5699444">.</span><span class="ident" id="5699445">errorf</span><span class="op" id="5699451">(</span><span class="string" id="5699452">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="5699470">,</span>&nbsp;<span class="ident" id="5699472">constant</span><span class="op" id="5699480">.</span><span class="ident" id="5699481">Text</span><span class="op" id="5699485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5699488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699491">return</span>&nbsp;<span class="ident" id="5699498">zero</span><br>
<span class="lineno"></span><span class="op" id="5699503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="5699506">func</span>&nbsp;<span class="ident" id="5699511">isHexConstant</span><span class="op" id="5699524">(</span><span class="ident" id="5699525">s</span>&nbsp;<span class="builtintype" id="5699527">string</span><span class="op" id="5699533">)</span>&nbsp;<span class="builtintype" id="5699535">bool</span>&nbsp;<span class="op" id="5699540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699543">return</span>&nbsp;<span class="builtinfunc" id="5699550">len</span><span class="op" id="5699553">(</span><span class="ident" id="5699554">s</span><span class="op" id="5699555">)</span>&nbsp;<span class="op" id="5699557">&gt;</span>&nbsp;<span class="num" id="5699559">2</span>&nbsp;<span class="op" id="5699561">&amp;&amp;</span>&nbsp;<span class="ident" id="5699564">s</span><span class="op" id="5699565">[</span><span class="num" id="5699566">0</span><span class="op" id="5699567">]</span>&nbsp;<span class="op" id="5699569">==</span>&nbsp;<span class="string" id="5699572">&#39;0&#39;</span>&nbsp;<span class="op" id="5699576">&amp;&amp;</span>&nbsp;<span class="op" id="5699579">(</span><span class="ident" id="5699580">s</span><span class="op" id="5699581">[</span><span class="num" id="5699582">1</span><span class="op" id="5699583">]</span>&nbsp;<span class="op" id="5699585">==</span>&nbsp;<span class="string" id="5699588">&#39;x&#39;</span>&nbsp;<span class="op" id="5699592">||</span>&nbsp;<span class="ident" id="5699595">s</span><span class="op" id="5699596">[</span><span class="num" id="5699597">1</span><span class="op" id="5699598">]</span>&nbsp;<span class="op" id="5699600">==</span>&nbsp;<span class="string" id="5699603">&#39;X&#39;</span><span class="op" id="5699606">)</span><br>
<span class="lineno"></span><span class="op" id="5699608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5699611">func</span>&nbsp;<span class="op" id="5699616">(</span><span class="ident" id="5699617">s</span>&nbsp;<span class="op" id="5699619">*</span><span class="ident" id="5699620">state</span><span class="op" id="5699625">)</span>&nbsp;<span class="ident" id="5699627">evalFieldNode</span><span class="op" id="5699640">(</span><span class="ident" id="5699641">dot</span>&nbsp;<span class="ident" id="5699645">reflect</span><span class="op" id="5699652">.</span><span class="ident" id="5699653">Value</span><span class="op" id="5699658">,</span>&nbsp;<span class="ident" id="5699660">field</span>&nbsp;<span class="op" id="5699666">*</span><span class="ident" id="5699667">parse</span><span class="op" id="5699672">.</span><span class="ident" id="5699673">FieldNode</span><span class="op" id="5699682">,</span>&nbsp;<span class="ident" id="5699684">args</span>&nbsp;<span class="op" id="5699689">[</span><span class="op" id="5699690">]</span><span class="ident" id="5699691">parse</span><span class="op" id="5699696">.</span><span class="ident" id="5699697">Node</span><span class="op" id="5699701">,</span>&nbsp;<span class="ident" id="5699703">final</span>&nbsp;<span class="ident" id="5699709">reflect</span><span class="op" id="5699716">.</span><span class="ident" id="5699717">Value</span><span class="op" id="5699722">)</span>&nbsp;<span class="ident" id="5699724">reflect</span><span class="op" id="5699731">.</span><span class="ident" id="5699732">Value</span>&nbsp;<span class="op" id="5699738">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5699741">s</span><span class="op" id="5699742">.</span><span class="ident" id="5699743">at</span><span class="op" id="5699745">(</span><span class="ident" id="5699746">field</span><span class="op" id="5699751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5699754">return</span>&nbsp;<span class="ident" id="5699761">s</span><span class="op" id="5699762">.</span><span class="ident" id="5699763">evalFieldChain</span><span class="op" id="5699777">(</span><span class="ident" id="5699778">dot</span><span class="op" id="5699781">,</span>&nbsp;<span class="ident" id="5699783">dot</span><span class="op" id="5699786">,</span>&nbsp;<span class="ident" id="5699788">field</span><span class="op" id="5699793">,</span>&nbsp;<span class="ident" id="5699795">field</span><span class="op" id="5699800">.</span><span class="ident" id="5699801">Ident</span><span class="op" id="5699806">,</span>&nbsp;<span class="ident" id="5699808">args</span><span class="op" id="5699812">,</span>&nbsp;<span class="ident" id="5699814">final</span><span class="op" id="5699819">)</span><br>
<span class="lineno"></span><span class="op" id="5699821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5699824">func</span>&nbsp;<span class="op" id="5699829">(</span><span class="ident" id="5699830">s</span>&nbsp;<span class="op" id="5699832">*</span><span class="ident" id="5699833">state</span><span class="op" id="5699838">)</span>&nbsp;<span class="ident" id="5699840">evalChainNode</span><span class="op" id="5699853">(</span><span class="ident" id="5699854">dot</span>&nbsp;<span class="ident" id="5699858">reflect</span><span class="op" id="5699865">.</span><span class="ident" id="5699866">Value</span><span class="op" id="5699871">,</span>&nbsp;<span class="ident" id="5699873">chain</span>&nbsp;<span class="op" id="5699879">*</span><span class="ident" id="5699880">parse</span><span class="op" id="5699885">.</span><span class="ident" id="5699886">ChainNode</span><span class="op" id="5699895">,</span>&nbsp;<span class="ident" id="5699897">args</span>&nbsp;<span class="op" id="5699902">[</span><span class="op" id="5699903">]</span><span class="ident" id="5699904">parse</span><span class="op" id="5699909">.</span><span class="ident" id="5699910">Node</span><span class="op" id="5699914">,</span>&nbsp;<span class="ident" id="5699916">final</span>&nbsp;<span class="ident" id="5699922">reflect</span><span class="op" id="5699929">.</span><span class="ident" id="5699930">Value</span><span class="op" id="5699935">)</span>&nbsp;<span class="ident" id="5699937">reflect</span><span class="op" id="5699944">.</span><span class="ident" id="5699945">Value</span>&nbsp;<span class="op" id="5699951">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5699954">s</span><span class="op" id="5699955">.</span><span class="ident" id="5699956">at</span><span class="op" id="5699958">(</span><span class="ident" id="5699959">chain</span><span class="op" id="5699964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699967">//&nbsp;(pipe).Field1.Field2&nbsp;has&nbsp;pipe&nbsp;as&nbsp;.Node,&nbsp;fields&nbsp;as&nbsp;.Field.&nbsp;Eval&nbsp;the&nbsp;pipeline,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5700065">pipe</span>&nbsp;<span class="op" id="5700070">:=</span>&nbsp;<span class="ident" id="5700073">s</span><span class="op" id="5700074">.</span><span class="ident" id="5700075">evalArg</span><span class="op" id="5700082">(</span><span class="ident" id="5700083">dot</span><span class="op" id="5700086">,</span>&nbsp;<span class="ident" id="5700088">nil</span><span class="op" id="5700091">,</span>&nbsp;<span class="ident" id="5700093">chain</span><span class="op" id="5700098">.</span><span class="ident" id="5700099">Node</span><span class="op" id="5700103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5700106">if</span>&nbsp;<span class="builtinfunc" id="5700109">len</span><span class="op" id="5700112">(</span><span class="ident" id="5700113">chain</span><span class="op" id="5700118">.</span><span class="ident" id="5700119">Field</span><span class="op" id="5700124">)</span>&nbsp;<span class="op" id="5700126">==</span>&nbsp;<span class="num" id="5700129">0</span>&nbsp;<span class="op" id="5700131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5700135">s</span><span class="op" id="5700136">.</span><span class="ident" id="5700137">errorf</span><span class="op" id="5700143">(</span><span class="string" id="5700144">&#34;internal&nbsp;error:&nbsp;no&nbsp;fields&nbsp;in&nbsp;evalChainNode&#34;</span><span class="op" id="5700188">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5700191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5700194">return</span>&nbsp;<span class="ident" id="5700201">s</span><span class="op" id="5700202">.</span><span class="ident" id="5700203">evalFieldChain</span><span class="op" id="5700217">(</span><span class="ident" id="5700218">dot</span><span class="op" id="5700221">,</span>&nbsp;<span class="ident" id="5700223">pipe</span><span class="op" id="5700227">,</span>&nbsp;<span class="ident" id="5700229">chain</span><span class="op" id="5700234">,</span>&nbsp;<span class="ident" id="5700236">chain</span><span class="op" id="5700241">.</span><span class="ident" id="5700242">Field</span><span class="op" id="5700247">,</span>&nbsp;<span class="ident" id="5700249">args</span><span class="op" id="5700253">,</span>&nbsp;<span class="ident" id="5700255">final</span><span class="op" id="5700260">)</span><br>
<span class="lineno"></span><span class="op" id="5700262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5700265">func</span>&nbsp;<span class="op" id="5700270">(</span><span class="ident" id="5700271">s</span>&nbsp;<span class="op" id="5700273">*</span><span class="ident" id="5700274">state</span><span class="op" id="5700279">)</span>&nbsp;<span class="ident" id="5700281">evalVariableNode</span><span class="op" id="5700297">(</span><span class="ident" id="5700298">dot</span>&nbsp;<span class="ident" id="5700302">reflect</span><span class="op" id="5700309">.</span><span class="ident" id="5700310">Value</span><span class="op" id="5700315">,</span>&nbsp;<span class="ident" id="5700317">variable</span>&nbsp;<span class="op" id="5700326">*</span><span class="ident" id="5700327">parse</span><span class="op" id="5700332">.</span><span class="ident" id="5700333">VariableNode</span><span class="op" id="5700345">,</span>&nbsp;<span class="ident" id="5700347">args</span>&nbsp;<span class="op" id="5700352">[</span><span class="op" id="5700353">]</span><span class="ident" id="5700354">parse</span><span class="op" id="5700359">.</span><span class="ident" id="5700360">Node</span><span class="op" id="5700364">,</span>&nbsp;<span class="ident" id="5700366">final</span>&nbsp;<span class="ident" id="5700372">reflect</span><span class="op" id="5700379">.</span><span class="ident" id="5700380">Value</span><span class="op" id="5700385">)</span>&nbsp;<span class="ident" id="5700387">reflect</span><span class="op" id="5700394">.</span><span class="ident" id="5700395">Value</span>&nbsp;<span class="op" id="5700401">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700404">//&nbsp;$x.Field&nbsp;has&nbsp;$x&nbsp;as&nbsp;the&nbsp;first&nbsp;ident,&nbsp;Field&nbsp;as&nbsp;the&nbsp;second.&nbsp;Eval&nbsp;the&nbsp;var,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5700496">s</span><span class="op" id="5700497">.</span><span class="ident" id="5700498">at</span><span class="op" id="5700500">(</span><span class="ident" id="5700501">variable</span><span class="op" id="5700509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5700512">value</span>&nbsp;<span class="op" id="5700518">:=</span>&nbsp;<span class="ident" id="5700521">s</span><span class="op" id="5700522">.</span><span class="ident" id="5700523">varValue</span><span class="op" id="5700531">(</span><span class="ident" id="5700532">variable</span><span class="op" id="5700540">.</span><span class="ident" id="5700541">Ident</span><span class="op" id="5700546">[</span><span class="num" id="5700547">0</span><span class="op" id="5700548">]</span><span class="op" id="5700549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5700552">if</span>&nbsp;<span class="builtinfunc" id="5700555">len</span><span class="op" id="5700558">(</span><span class="ident" id="5700559">variable</span><span class="op" id="5700567">.</span><span class="ident" id="5700568">Ident</span><span class="op" id="5700573">)</span>&nbsp;<span class="op" id="5700575">==</span>&nbsp;<span class="num" id="5700578">1</span>&nbsp;<span class="op" id="5700580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5700584">s</span><span class="op" id="5700585">.</span><span class="ident" id="5700586">notAFunction</span><span class="op" id="5700598">(</span><span class="ident" id="5700599">args</span><span class="op" id="5700603">,</span>&nbsp;<span class="ident" id="5700605">final</span><span class="op" id="5700610">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5700614">return</span>&nbsp;<span class="ident" id="5700621">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5700628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5700631">return</span>&nbsp;<span class="ident" id="5700638">s</span><span class="op" id="5700639">.</span><span class="ident" id="5700640">evalFieldChain</span><span class="op" id="5700654">(</span><span class="ident" id="5700655">dot</span><span class="op" id="5700658">,</span>&nbsp;<span class="ident" id="5700660">value</span><span class="op" id="5700665">,</span>&nbsp;<span class="ident" id="5700667">variable</span><span class="op" id="5700675">,</span>&nbsp;<span class="ident" id="5700677">variable</span><span class="op" id="5700685">.</span><span class="ident" id="5700686">Ident</span><span class="op" id="5700691">[</span><span class="num" id="5700692">1</span><span class="op" id="5700693">:</span><span class="op" id="5700694">]</span><span class="op" id="5700695">,</span>&nbsp;<span class="ident" id="5700697">args</span><span class="op" id="5700701">,</span>&nbsp;<span class="ident" id="5700703">final</span><span class="op" id="5700708">)</span><br>
<span class="lineno"></span><span class="op" id="5700710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="5700713">//&nbsp;evalFieldChain&nbsp;evaluates&nbsp;.X.Y.Z&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5700780">//&nbsp;dot&nbsp;is&nbsp;the&nbsp;environment&nbsp;in&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;arguments,&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="5700844">//&nbsp;receiver&nbsp;is&nbsp;the&nbsp;value&nbsp;being&nbsp;walked&nbsp;along&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="5700899">func</span>&nbsp;<span class="op" id="5700904">(</span><span class="ident" id="5700905">s</span>&nbsp;<span class="op" id="5700907">*</span><span class="ident" id="5700908">state</span><span class="op" id="5700913">)</span>&nbsp;<span class="ident" id="5700915">evalFieldChain</span><span class="op" id="5700929">(</span><span class="ident" id="5700930">dot</span><span class="op" id="5700933">,</span>&nbsp;<span class="ident" id="5700935">receiver</span>&nbsp;<span class="ident" id="5700944">reflect</span><span class="op" id="5700951">.</span><span class="ident" id="5700952">Value</span><span class="op" id="5700957">,</span>&nbsp;<span class="ident" id="5700959">node</span>&nbsp;<span class="ident" id="5700964">parse</span><span class="op" id="5700969">.</span><span class="ident" id="5700970">Node</span><span class="op" id="5700974">,</span>&nbsp;<span class="ident" id="5700976">ident</span>&nbsp;<span class="op" id="5700982">[</span><span class="op" id="5700983">]</span><span class="builtintype" id="5700984">string</span><span class="op" id="5700990">,</span>&nbsp;<span class="ident" id="5700992">args</span>&nbsp;<span class="op" id="5700997">[</span><span class="op" id="5700998">]</span><span class="ident" id="5700999">parse</span><span class="op" id="5701004">.</span><span class="ident" id="5701005">Node</span><span class="op" id="5701009">,</span>&nbsp;<span class="ident" id="5701011">final</span>&nbsp;<span class="ident" id="5701017">reflect</span><span class="op" id="5701024">.</span><span class="ident" id="5701025">Value</span><span class="op" id="5701030">)</span>&nbsp;<span class="ident" id="5701032">reflect</span><span class="op" id="5701039">.</span><span class="ident" id="5701040">Value</span>&nbsp;<span class="op" id="5701046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5701049">n</span>&nbsp;<span class="op" id="5701051">:=</span>&nbsp;<span class="builtinfunc" id="5701054">len</span><span class="op" id="5701057">(</span><span class="ident" id="5701058">ident</span><span class="op" id="5701063">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701066">for</span>&nbsp;<span class="ident" id="5701070">i</span>&nbsp;<span class="op" id="5701072">:=</span>&nbsp;<span class="num" id="5701075">0</span><span class="op" id="5701076">;</span>&nbsp;<span class="ident" id="5701078">i</span>&nbsp;<span class="op" id="5701080">&lt;</span>&nbsp;<span class="ident" id="5701082">n</span><span class="op" id="5701083">-</span><span class="num" id="5701084">1</span><span class="op" id="5701085">;</span>&nbsp;<span class="ident" id="5701087">i</span><span class="op" id="5701088">++</span>&nbsp;<span class="op" id="5701091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5701095">receiver</span>&nbsp;<span class="op" id="5701104">=</span>&nbsp;<span class="ident" id="5701106">s</span><span class="op" id="5701107">.</span><span class="ident" id="5701108">evalField</span><span class="op" id="5701117">(</span><span class="ident" id="5701118">dot</span><span class="op" id="5701121">,</span>&nbsp;<span class="ident" id="5701123">ident</span><span class="op" id="5701128">[</span><span class="ident" id="5701129">i</span><span class="op" id="5701130">]</span><span class="op" id="5701131">,</span>&nbsp;<span class="ident" id="5701133">node</span><span class="op" id="5701137">,</span>&nbsp;<span class="ident" id="5701139">nil</span><span class="op" id="5701142">,</span>&nbsp;<span class="ident" id="5701144">zero</span><span class="op" id="5701148">,</span>&nbsp;<span class="ident" id="5701150">receiver</span><span class="op" id="5701158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5701161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5701164">//&nbsp;Now&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;it&nbsp;gets&nbsp;the&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701213">return</span>&nbsp;<span class="ident" id="5701220">s</span><span class="op" id="5701221">.</span><span class="ident" id="5701222">evalField</span><span class="op" id="5701231">(</span><span class="ident" id="5701232">dot</span><span class="op" id="5701235">,</span>&nbsp;<span class="ident" id="5701237">ident</span><span class="op" id="5701242">[</span><span class="ident" id="5701243">n</span><span class="op" id="5701244">-</span><span class="num" id="5701245">1</span><span class="op" id="5701246">]</span><span class="op" id="5701247">,</span>&nbsp;<span class="ident" id="5701249">node</span><span class="op" id="5701253">,</span>&nbsp;<span class="ident" id="5701255">args</span><span class="op" id="5701259">,</span>&nbsp;<span class="ident" id="5701261">final</span><span class="op" id="5701266">,</span>&nbsp;<span class="ident" id="5701268">receiver</span><span class="op" id="5701276">)</span><br>
<span class="lineno">450</span><span class="op" id="5701278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5701281">func</span>&nbsp;<span class="op" id="5701286">(</span><span class="ident" id="5701287">s</span>&nbsp;<span class="op" id="5701289">*</span><span class="ident" id="5701290">state</span><span class="op" id="5701295">)</span>&nbsp;<span class="ident" id="5701297">evalFunction</span><span class="op" id="5701309">(</span><span class="ident" id="5701310">dot</span>&nbsp;<span class="ident" id="5701314">reflect</span><span class="op" id="5701321">.</span><span class="ident" id="5701322">Value</span><span class="op" id="5701327">,</span>&nbsp;<span class="ident" id="5701329">node</span>&nbsp;<span class="op" id="5701334">*</span><span class="ident" id="5701335">parse</span><span class="op" id="5701340">.</span><span class="ident" id="5701341">IdentifierNode</span><span class="op" id="5701355">,</span>&nbsp;<span class="ident" id="5701357">cmd</span>&nbsp;<span class="ident" id="5701361">parse</span><span class="op" id="5701366">.</span><span class="ident" id="5701367">Node</span><span class="op" id="5701371">,</span>&nbsp;<span class="ident" id="5701373">args</span>&nbsp;<span class="op" id="5701378">[</span><span class="op" id="5701379">]</span><span class="ident" id="5701380">parse</span><span class="op" id="5701385">.</span><span class="ident" id="5701386">Node</span><span class="op" id="5701390">,</span>&nbsp;<span class="ident" id="5701392">final</span>&nbsp;<span class="ident" id="5701398">reflect</span><span class="op" id="5701405">.</span><span class="ident" id="5701406">Value</span><span class="op" id="5701411">)</span>&nbsp;<span class="ident" id="5701413">reflect</span><span class="op" id="5701420">.</span><span class="ident" id="5701421">Value</span>&nbsp;<span class="op" id="5701427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5701430">s</span><span class="op" id="5701431">.</span><span class="ident" id="5701432">at</span><span class="op" id="5701434">(</span><span class="ident" id="5701435">node</span><span class="op" id="5701439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5701442">name</span>&nbsp;<span class="op" id="5701447">:=</span>&nbsp;<span class="ident" id="5701450">node</span><span class="op" id="5701454">.</span><span class="ident" id="5701455">Ident</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5701462">function</span><span class="op" id="5701470">,</span>&nbsp;<span class="ident" id="5701472">ok</span>&nbsp;<span class="op" id="5701475">:=</span>&nbsp;<span class="ident" id="5701478">findFunction</span><span class="op" id="5701490">(</span><span class="ident" id="5701491">name</span><span class="op" id="5701495">,</span>&nbsp;<span class="ident" id="5701497">s</span><span class="op" id="5701498">.</span><span class="ident" id="5701499">tmpl</span><span class="op" id="5701503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701506">if</span>&nbsp;<span class="op" id="5701509">!</span><span class="ident" id="5701510">ok</span>&nbsp;<span class="op" id="5701513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5701517">s</span><span class="op" id="5701518">.</span><span class="ident" id="5701519">errorf</span><span class="op" id="5701525">(</span><span class="string" id="5701526">&#34;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;function&#34;</span><span class="op" id="5701556">,</span>&nbsp;<span class="ident" id="5701558">name</span><span class="op" id="5701562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5701565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701568">return</span>&nbsp;<span class="ident" id="5701575">s</span><span class="op" id="5701576">.</span><span class="ident" id="5701577">evalCall</span><span class="op" id="5701585">(</span><span class="ident" id="5701586">dot</span><span class="op" id="5701589">,</span>&nbsp;<span class="ident" id="5701591">function</span><span class="op" id="5701599">,</span>&nbsp;<span class="ident" id="5701601">cmd</span><span class="op" id="5701604">,</span>&nbsp;<span class="ident" id="5701606">name</span><span class="op" id="5701610">,</span>&nbsp;<span class="ident" id="5701612">args</span><span class="op" id="5701616">,</span>&nbsp;<span class="ident" id="5701618">final</span><span class="op" id="5701623">)</span><br>
<span class="lineno">460</span><span class="op" id="5701625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5701628">//&nbsp;evalField&nbsp;evaluates&nbsp;an&nbsp;expression&nbsp;like&nbsp;(.Field)&nbsp;or&nbsp;(.Field&nbsp;arg1&nbsp;arg2).</span><br>
<span class="lineno"></span><span class="comment" id="5701702">//&nbsp;The&nbsp;&#39;final&#39;&nbsp;argument&nbsp;represents&nbsp;the&nbsp;return&nbsp;value&nbsp;from&nbsp;the&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="5701773">//&nbsp;value&nbsp;of&nbsp;the&nbsp;pipeline,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">465</span><span class="keyword" id="5701807">func</span>&nbsp;<span class="op" id="5701812">(</span><span class="ident" id="5701813">s</span>&nbsp;<span class="op" id="5701815">*</span><span class="ident" id="5701816">state</span><span class="op" id="5701821">)</span>&nbsp;<span class="ident" id="5701823">evalField</span><span class="op" id="5701832">(</span><span class="ident" id="5701833">dot</span>&nbsp;<span class="ident" id="5701837">reflect</span><span class="op" id="5701844">.</span><span class="ident" id="5701845">Value</span><span class="op" id="5701850">,</span>&nbsp;<span class="ident" id="5701852">fieldName</span>&nbsp;<span class="builtintype" id="5701862">string</span><span class="op" id="5701868">,</span>&nbsp;<span class="ident" id="5701870">node</span>&nbsp;<span class="ident" id="5701875">parse</span><span class="op" id="5701880">.</span><span class="ident" id="5701881">Node</span><span class="op" id="5701885">,</span>&nbsp;<span class="ident" id="5701887">args</span>&nbsp;<span class="op" id="5701892">[</span><span class="op" id="5701893">]</span><span class="ident" id="5701894">parse</span><span class="op" id="5701899">.</span><span class="ident" id="5701900">Node</span><span class="op" id="5701904">,</span>&nbsp;<span class="ident" id="5701906">final</span><span class="op" id="5701911">,</span>&nbsp;<span class="ident" id="5701913">receiver</span>&nbsp;<span class="ident" id="5701922">reflect</span><span class="op" id="5701929">.</span><span class="ident" id="5701930">Value</span><span class="op" id="5701935">)</span>&nbsp;<span class="ident" id="5701937">reflect</span><span class="op" id="5701944">.</span><span class="ident" id="5701945">Value</span>&nbsp;<span class="op" id="5701951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701954">if</span>&nbsp;<span class="op" id="5701957">!</span><span class="ident" id="5701958">receiver</span><span class="op" id="5701966">.</span><span class="ident" id="5701967">IsValid</span><span class="op" id="5701974">(</span><span class="op" id="5701975">)</span>&nbsp;<span class="op" id="5701977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701981">return</span>&nbsp;<span class="ident" id="5701988">zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5701994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5701997">typ</span>&nbsp;<span class="op" id="5702001">:=</span>&nbsp;<span class="ident" id="5702004">receiver</span><span class="op" id="5702012">.</span><span class="ident" id="5702013">Type</span><span class="op" id="5702017">(</span><span class="op" id="5702018">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702021">receiver</span><span class="op" id="5702029">,</span>&nbsp;<span class="ident" id="5702031">_</span>&nbsp;<span class="op" id="5702033">=</span>&nbsp;<span class="ident" id="5702035">indirect</span><span class="op" id="5702043">(</span><span class="ident" id="5702044">receiver</span><span class="op" id="5702052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5702055">//&nbsp;Unless&nbsp;it&#39;s&nbsp;an&nbsp;interface,&nbsp;need&nbsp;to&nbsp;get&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;*T&nbsp;to&nbsp;guarantee</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5702132">//&nbsp;we&nbsp;see&nbsp;all&nbsp;methods&nbsp;of&nbsp;T&nbsp;and&nbsp;*T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702168">ptr</span>&nbsp;<span class="op" id="5702172">:=</span>&nbsp;<span class="ident" id="5702175">receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702185">if</span>&nbsp;<span class="ident" id="5702188">ptr</span><span class="op" id="5702191">.</span><span class="ident" id="5702192">Kind</span><span class="op" id="5702196">(</span><span class="op" id="5702197">)</span>&nbsp;<span class="op" id="5702199">!=</span>&nbsp;<span class="ident" id="5702202">reflect</span><span class="op" id="5702209">.</span><span class="ident" id="5702210">Interface</span>&nbsp;<span class="op" id="5702220">&amp;&amp;</span>&nbsp;<span class="ident" id="5702223">ptr</span><span class="op" id="5702226">.</span><span class="ident" id="5702227">CanAddr</span><span class="op" id="5702234">(</span><span class="op" id="5702235">)</span>&nbsp;<span class="op" id="5702237">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702241">ptr</span>&nbsp;<span class="op" id="5702245">=</span>&nbsp;<span class="ident" id="5702247">ptr</span><span class="op" id="5702250">.</span><span class="ident" id="5702251">Addr</span><span class="op" id="5702255">(</span><span class="op" id="5702256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5702259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702262">if</span>&nbsp;<span class="ident" id="5702265">method</span>&nbsp;<span class="op" id="5702272">:=</span>&nbsp;<span class="ident" id="5702275">ptr</span><span class="op" id="5702278">.</span><span class="ident" id="5702279">MethodByName</span><span class="op" id="5702291">(</span><span class="ident" id="5702292">fieldName</span><span class="op" id="5702301">)</span><span class="op" id="5702302">;</span>&nbsp;<span class="ident" id="5702304">method</span><span class="op" id="5702310">.</span><span class="ident" id="5702311">IsValid</span><span class="op" id="5702318">(</span><span class="op" id="5702319">)</span>&nbsp;<span class="op" id="5702321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702325">return</span>&nbsp;<span class="ident" id="5702332">s</span><span class="op" id="5702333">.</span><span class="ident" id="5702334">evalCall</span><span class="op" id="5702342">(</span><span class="ident" id="5702343">dot</span><span class="op" id="5702346">,</span>&nbsp;<span class="ident" id="5702348">method</span><span class="op" id="5702354">,</span>&nbsp;<span class="ident" id="5702356">node</span><span class="op" id="5702360">,</span>&nbsp;<span class="ident" id="5702362">fieldName</span><span class="op" id="5702371">,</span>&nbsp;<span class="ident" id="5702373">args</span><span class="op" id="5702377">,</span>&nbsp;<span class="ident" id="5702379">final</span><span class="op" id="5702384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5702387">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702390">hasArgs</span>&nbsp;<span class="op" id="5702398">:=</span>&nbsp;<span class="builtinfunc" id="5702401">len</span><span class="op" id="5702404">(</span><span class="ident" id="5702405">args</span><span class="op" id="5702409">)</span>&nbsp;<span class="op" id="5702411">&gt;</span>&nbsp;<span class="num" id="5702413">1</span>&nbsp;<span class="op" id="5702415">||</span>&nbsp;<span class="ident" id="5702418">final</span><span class="op" id="5702423">.</span><span class="ident" id="5702424">IsValid</span><span class="op" id="5702431">(</span><span class="op" id="5702432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5702435">//&nbsp;It&#39;s&nbsp;not&nbsp;a&nbsp;method;&nbsp;must&nbsp;be&nbsp;a&nbsp;field&nbsp;of&nbsp;a&nbsp;struct&nbsp;or&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;map.&nbsp;The&nbsp;receiver&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702540">receiver</span><span class="op" id="5702548">,</span>&nbsp;<span class="ident" id="5702550">isNil</span>&nbsp;<span class="op" id="5702556">:=</span>&nbsp;<span class="ident" id="5702559">indirect</span><span class="op" id="5702567">(</span><span class="ident" id="5702568">receiver</span><span class="op" id="5702576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702579">if</span>&nbsp;<span class="ident" id="5702582">isNil</span>&nbsp;<span class="op" id="5702588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702592">s</span><span class="op" id="5702593">.</span><span class="ident" id="5702594">errorf</span><span class="op" id="5702600">(</span><span class="string" id="5702601">&#34;nil&nbsp;pointer&nbsp;evaluating&nbsp;%s.%s&#34;</span><span class="op" id="5702631">,</span>&nbsp;<span class="ident" id="5702633">typ</span><span class="op" id="5702636">,</span>&nbsp;<span class="ident" id="5702638">fieldName</span><span class="op" id="5702647">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5702650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702653">switch</span>&nbsp;<span class="ident" id="5702660">receiver</span><span class="op" id="5702668">.</span><span class="ident" id="5702669">Kind</span><span class="op" id="5702673">(</span><span class="op" id="5702674">)</span>&nbsp;<span class="op" id="5702676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702679">case</span>&nbsp;<span class="ident" id="5702684">reflect</span><span class="op" id="5702691">.</span><span class="ident" id="5702692">Struct</span><span class="op" id="5702698">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702702">tField</span><span class="op" id="5702708">,</span>&nbsp;<span class="ident" id="5702710">ok</span>&nbsp;<span class="op" id="5702713">:=</span>&nbsp;<span class="ident" id="5702716">receiver</span><span class="op" id="5702724">.</span><span class="ident" id="5702725">Type</span><span class="op" id="5702729">(</span><span class="op" id="5702730">)</span><span class="op" id="5702731">.</span><span class="ident" id="5702732">FieldByName</span><span class="op" id="5702743">(</span><span class="ident" id="5702744">fieldName</span><span class="op" id="5702753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702757">if</span>&nbsp;<span class="ident" id="5702760">ok</span>&nbsp;<span class="op" id="5702763">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702768">field</span>&nbsp;<span class="op" id="5702774">:=</span>&nbsp;<span class="ident" id="5702777">receiver</span><span class="op" id="5702785">.</span><span class="ident" id="5702786">FieldByIndex</span><span class="op" id="5702798">(</span><span class="ident" id="5702799">tField</span><span class="op" id="5702805">.</span><span class="ident" id="5702806">Index</span><span class="op" id="5702811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702816">if</span>&nbsp;<span class="ident" id="5702819">tField</span><span class="op" id="5702825">.</span><span class="ident" id="5702826">PkgPath</span>&nbsp;<span class="op" id="5702834">!=</span>&nbsp;<span class="string" id="5702837">&#34;&#34;</span>&nbsp;<span class="op" id="5702840">{</span>&nbsp;<span class="comment" id="5702842">//&nbsp;field&nbsp;is&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702869">s</span><span class="op" id="5702870">.</span><span class="ident" id="5702871">errorf</span><span class="op" id="5702877">(</span><span class="string" id="5702878">&#34;%s&nbsp;is&nbsp;an&nbsp;unexported&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5702923">,</span>&nbsp;<span class="ident" id="5702925">fieldName</span><span class="op" id="5702934">,</span>&nbsp;<span class="ident" id="5702936">typ</span><span class="op" id="5702939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5702944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5702949">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;function,&nbsp;we&nbsp;must&nbsp;call&nbsp;it.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702992">if</span>&nbsp;<span class="ident" id="5702995">hasArgs</span>&nbsp;<span class="op" id="5703003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5703009">s</span><span class="op" id="5703010">.</span><span class="ident" id="5703011">errorf</span><span class="op" id="5703017">(</span><span class="string" id="5703018">&#34;%s&nbsp;has&nbsp;arguments&nbsp;but&nbsp;cannot&nbsp;be&nbsp;invoked&nbsp;as&nbsp;function&#34;</span><span class="op" id="5703070">,</span>&nbsp;<span class="ident" id="5703072">fieldName</span><span class="op" id="5703081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5703086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703091">return</span>&nbsp;<span class="ident" id="5703098">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5703106">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5703110">s</span><span class="op" id="5703111">.</span><span class="ident" id="5703112">errorf</span><span class="op" id="5703118">(</span><span class="string" id="5703119">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5703156">,</span>&nbsp;<span class="ident" id="5703158">fieldName</span><span class="op" id="5703167">,</span>&nbsp;<span class="ident" id="5703169">typ</span><span class="op" id="5703172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703175">case</span>&nbsp;<span class="ident" id="5703180">reflect</span><span class="op" id="5703187">.</span><span class="ident" id="5703188">Map</span><span class="op" id="5703191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5703195">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;map,&nbsp;attempt&nbsp;to&nbsp;use&nbsp;the&nbsp;field&nbsp;name&nbsp;as&nbsp;a&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5703255">nameVal</span>&nbsp;<span class="op" id="5703263">:=</span>&nbsp;<span class="ident" id="5703266">reflect</span><span class="op" id="5703273">.</span><span class="ident" id="5703274">ValueOf</span><span class="op" id="5703281">(</span><span class="ident" id="5703282">fieldName</span><span class="op" id="5703291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703295">if</span>&nbsp;<span class="ident" id="5703298">nameVal</span><span class="op" id="5703305">.</span><span class="ident" id="5703306">Type</span><span class="op" id="5703310">(</span><span class="op" id="5703311">)</span><span class="op" id="5703312">.</span><span class="ident" id="5703313">AssignableTo</span><span class="op" id="5703325">(</span><span class="ident" id="5703326">receiver</span><span class="op" id="5703334">.</span><span class="ident" id="5703335">Type</span><span class="op" id="5703339">(</span><span class="op" id="5703340">)</span><span class="op" id="5703341">.</span><span class="ident" id="5703342">Key</span><span class="op" id="5703345">(</span><span class="op" id="5703346">)</span><span class="op" id="5703347">)</span>&nbsp;<span class="op" id="5703349">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703354">if</span>&nbsp;<span class="ident" id="5703357">hasArgs</span>&nbsp;<span class="op" id="5703365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5703371">s</span><span class="op" id="5703372">.</span><span class="ident" id="5703373">errorf</span><span class="op" id="5703379">(</span><span class="string" id="5703380">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;method&nbsp;but&nbsp;has&nbsp;arguments&#34;</span><span class="op" id="5703418">,</span>&nbsp;<span class="ident" id="5703420">fieldName</span><span class="op" id="5703429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5703434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703439">return</span>&nbsp;<span class="ident" id="5703446">receiver</span><span class="op" id="5703454">.</span><span class="ident" id="5703455">MapIndex</span><span class="op" id="5703463">(</span><span class="ident" id="5703464">nameVal</span><span class="op" id="5703471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5703475">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5703478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5703481">s</span><span class="op" id="5703482">.</span><span class="ident" id="5703483">errorf</span><span class="op" id="5703489">(</span><span class="string" id="5703490">&#34;can&#39;t&nbsp;evaluate&nbsp;field&nbsp;%s&nbsp;in&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5703526">,</span>&nbsp;<span class="ident" id="5703528">fieldName</span><span class="op" id="5703537">,</span>&nbsp;<span class="ident" id="5703539">typ</span><span class="op" id="5703542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5703545">panic</span><span class="op" id="5703550">(</span><span class="string" id="5703551">&#34;not&nbsp;reached&#34;</span><span class="op" id="5703564">)</span><br>
<span class="lineno"></span><span class="op" id="5703566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="5703569">var</span>&nbsp;<span class="op" id="5703573">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5703576">errorType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5703592">=</span>&nbsp;<span class="ident" id="5703594">reflect</span><span class="op" id="5703601">.</span><span class="ident" id="5703602">TypeOf</span><span class="op" id="5703608">(</span><span class="op" id="5703609">(</span><span class="op" id="5703610">*</span><span class="builtintype" id="5703611">error</span><span class="op" id="5703616">)</span><span class="op" id="5703617">(</span><span class="ident" id="5703618">nil</span><span class="op" id="5703621">)</span><span class="op" id="5703622">)</span><span class="op" id="5703623">.</span><span class="ident" id="5703624">Elem</span><span class="op" id="5703628">(</span><span class="op" id="5703629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5703632">fmtStringerType</span>&nbsp;<span class="op" id="5703648">=</span>&nbsp;<span class="ident" id="5703650">reflect</span><span class="op" id="5703657">.</span><span class="ident" id="5703658">TypeOf</span><span class="op" id="5703664">(</span><span class="op" id="5703665">(</span><span class="op" id="5703666">*</span><span class="ident" id="5703667">fmt</span><span class="op" id="5703670">.</span><span class="ident" id="5703671">Stringer</span><span class="op" id="5703679">)</span><span class="op" id="5703680">(</span><span class="ident" id="5703681">nil</span><span class="op" id="5703684">)</span><span class="op" id="5703685">)</span><span class="op" id="5703686">.</span><span class="ident" id="5703687">Elem</span><span class="op" id="5703691">(</span><span class="op" id="5703692">)</span><br>
<span class="lineno"></span><span class="op" id="5703694">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="comment" id="5703697">//&nbsp;evalCall&nbsp;executes&nbsp;a&nbsp;function&nbsp;or&nbsp;method&nbsp;call.&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;fun&nbsp;already&nbsp;has&nbsp;the&nbsp;receiver&nbsp;bound,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="5703802">//&nbsp;it&nbsp;looks&nbsp;just&nbsp;like&nbsp;a&nbsp;function&nbsp;call.&nbsp;&nbsp;The&nbsp;arg&nbsp;list,&nbsp;if&nbsp;non-nil,&nbsp;includes&nbsp;(in&nbsp;the&nbsp;manner&nbsp;of&nbsp;the&nbsp;shell),&nbsp;arg[0]</span><br>
<span class="lineno"></span><span class="comment" id="5703914">//&nbsp;as&nbsp;the&nbsp;function&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="5703941">func</span>&nbsp;<span class="op" id="5703946">(</span><span class="ident" id="5703947">s</span>&nbsp;<span class="op" id="5703949">*</span><span class="ident" id="5703950">state</span><span class="op" id="5703955">)</span>&nbsp;<span class="ident" id="5703957">evalCall</span><span class="op" id="5703965">(</span><span class="ident" id="5703966">dot</span><span class="op" id="5703969">,</span>&nbsp;<span class="ident" id="5703971">fun</span>&nbsp;<span class="ident" id="5703975">reflect</span><span class="op" id="5703982">.</span><span class="ident" id="5703983">Value</span><span class="op" id="5703988">,</span>&nbsp;<span class="ident" id="5703990">node</span>&nbsp;<span class="ident" id="5703995">parse</span><span class="op" id="5704000">.</span><span class="ident" id="5704001">Node</span><span class="op" id="5704005">,</span>&nbsp;<span class="ident" id="5704007">name</span>&nbsp;<span class="builtintype" id="5704012">string</span><span class="op" id="5704018">,</span>&nbsp;<span class="ident" id="5704020">args</span>&nbsp;<span class="op" id="5704025">[</span><span class="op" id="5704026">]</span><span class="ident" id="5704027">parse</span><span class="op" id="5704032">.</span><span class="ident" id="5704033">Node</span><span class="op" id="5704037">,</span>&nbsp;<span class="ident" id="5704039">final</span>&nbsp;<span class="ident" id="5704045">reflect</span><span class="op" id="5704052">.</span><span class="ident" id="5704053">Value</span><span class="op" id="5704058">)</span>&nbsp;<span class="ident" id="5704060">reflect</span><span class="op" id="5704067">.</span><span class="ident" id="5704068">Value</span>&nbsp;<span class="op" id="5704074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704077">if</span>&nbsp;<span class="ident" id="5704080">args</span>&nbsp;<span class="op" id="5704085">!=</span>&nbsp;<span class="ident" id="5704088">nil</span>&nbsp;<span class="op" id="5704092">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704096">args</span>&nbsp;<span class="op" id="5704101">=</span>&nbsp;<span class="ident" id="5704103">args</span><span class="op" id="5704107">[</span><span class="num" id="5704108">1</span><span class="op" id="5704109">:</span><span class="op" id="5704110">]</span>&nbsp;<span class="comment" id="5704112">//&nbsp;Zeroth&nbsp;arg&nbsp;is&nbsp;function&nbsp;name/node;&nbsp;not&nbsp;passed&nbsp;to&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5704174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704177">typ</span>&nbsp;<span class="op" id="5704181">:=</span>&nbsp;<span class="ident" id="5704184">fun</span><span class="op" id="5704187">.</span><span class="ident" id="5704188">Type</span><span class="op" id="5704192">(</span><span class="op" id="5704193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704196">numIn</span>&nbsp;<span class="op" id="5704202">:=</span>&nbsp;<span class="builtinfunc" id="5704205">len</span><span class="op" id="5704208">(</span><span class="ident" id="5704209">args</span><span class="op" id="5704213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704216">if</span>&nbsp;<span class="ident" id="5704219">final</span><span class="op" id="5704224">.</span><span class="ident" id="5704225">IsValid</span><span class="op" id="5704232">(</span><span class="op" id="5704233">)</span>&nbsp;<span class="op" id="5704235">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704239">numIn</span><span class="op" id="5704244">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5704248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704251">numFixed</span>&nbsp;<span class="op" id="5704260">:=</span>&nbsp;<span class="builtinfunc" id="5704263">len</span><span class="op" id="5704266">(</span><span class="ident" id="5704267">args</span><span class="op" id="5704271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704274">if</span>&nbsp;<span class="ident" id="5704277">typ</span><span class="op" id="5704280">.</span><span class="ident" id="5704281">IsVariadic</span><span class="op" id="5704291">(</span><span class="op" id="5704292">)</span>&nbsp;<span class="op" id="5704294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704298">numFixed</span>&nbsp;<span class="op" id="5704307">=</span>&nbsp;<span class="ident" id="5704309">typ</span><span class="op" id="5704312">.</span><span class="ident" id="5704313">NumIn</span><span class="op" id="5704318">(</span><span class="op" id="5704319">)</span>&nbsp;<span class="op" id="5704321">-</span>&nbsp;<span class="num" id="5704323">1</span>&nbsp;<span class="comment" id="5704325">//&nbsp;last&nbsp;arg&nbsp;is&nbsp;the&nbsp;variadic&nbsp;one.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704360">if</span>&nbsp;<span class="ident" id="5704363">numIn</span>&nbsp;<span class="op" id="5704369">&lt;</span>&nbsp;<span class="ident" id="5704371">numFixed</span>&nbsp;<span class="op" id="5704380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704385">s</span><span class="op" id="5704386">.</span><span class="ident" id="5704387">errorf</span><span class="op" id="5704393">(</span><span class="string" id="5704394">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="5704448">,</span>&nbsp;<span class="ident" id="5704450">name</span><span class="op" id="5704454">,</span>&nbsp;<span class="ident" id="5704456">typ</span><span class="op" id="5704459">.</span><span class="ident" id="5704460">NumIn</span><span class="op" id="5704465">(</span><span class="op" id="5704466">)</span><span class="op" id="5704467">-</span><span class="num" id="5704468">1</span><span class="op" id="5704469">,</span>&nbsp;<span class="builtinfunc" id="5704471">len</span><span class="op" id="5704474">(</span><span class="ident" id="5704475">args</span><span class="op" id="5704479">)</span><span class="op" id="5704480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5704484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5704487">}</span>&nbsp;<span class="keyword" id="5704489">else</span>&nbsp;<span class="keyword" id="5704494">if</span>&nbsp;<span class="ident" id="5704497">numIn</span>&nbsp;<span class="op" id="5704503">&lt;</span>&nbsp;<span class="ident" id="5704505">typ</span><span class="op" id="5704508">.</span><span class="ident" id="5704509">NumIn</span><span class="op" id="5704514">(</span><span class="op" id="5704515">)</span><span class="op" id="5704516">-</span><span class="num" id="5704517">1</span>&nbsp;<span class="op" id="5704519">||</span>&nbsp;<span class="op" id="5704522">!</span><span class="ident" id="5704523">typ</span><span class="op" id="5704526">.</span><span class="ident" id="5704527">IsVariadic</span><span class="op" id="5704537">(</span><span class="op" id="5704538">)</span>&nbsp;<span class="op" id="5704540">&amp;&amp;</span>&nbsp;<span class="ident" id="5704543">numIn</span>&nbsp;<span class="op" id="5704549">!=</span>&nbsp;<span class="ident" id="5704552">typ</span><span class="op" id="5704555">.</span><span class="ident" id="5704556">NumIn</span><span class="op" id="5704561">(</span><span class="op" id="5704562">)</span>&nbsp;<span class="op" id="5704564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704568">s</span><span class="op" id="5704569">.</span><span class="ident" id="5704570">errorf</span><span class="op" id="5704576">(</span><span class="string" id="5704577">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="5704622">,</span>&nbsp;<span class="ident" id="5704624">name</span><span class="op" id="5704628">,</span>&nbsp;<span class="ident" id="5704630">typ</span><span class="op" id="5704633">.</span><span class="ident" id="5704634">NumIn</span><span class="op" id="5704639">(</span><span class="op" id="5704640">)</span><span class="op" id="5704641">,</span>&nbsp;<span class="builtinfunc" id="5704643">len</span><span class="op" id="5704646">(</span><span class="ident" id="5704647">args</span><span class="op" id="5704651">)</span><span class="op" id="5704652">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5704655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704658">if</span>&nbsp;<span class="op" id="5704661">!</span><span class="ident" id="5704662">goodFunc</span><span class="op" id="5704670">(</span><span class="ident" id="5704671">typ</span><span class="op" id="5704674">)</span>&nbsp;<span class="op" id="5704676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704680">//&nbsp;TODO:&nbsp;This&nbsp;could&nbsp;still&nbsp;be&nbsp;a&nbsp;confusing&nbsp;error;&nbsp;maybe&nbsp;goodFunc&nbsp;should&nbsp;provide&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704766">s</span><span class="op" id="5704767">.</span><span class="ident" id="5704768">errorf</span><span class="op" id="5704774">(</span><span class="string" id="5704775">&#34;can&#39;t&nbsp;call&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="5704822">,</span>&nbsp;<span class="ident" id="5704824">name</span><span class="op" id="5704828">,</span>&nbsp;<span class="ident" id="5704830">typ</span><span class="op" id="5704833">.</span><span class="ident" id="5704834">NumOut</span><span class="op" id="5704840">(</span><span class="op" id="5704841">)</span><span class="op" id="5704842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5704845">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704848">//&nbsp;Build&nbsp;the&nbsp;arg&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704872">argv</span>&nbsp;<span class="op" id="5704877">:=</span>&nbsp;<span class="builtinfunc" id="5704880">make</span><span class="op" id="5704884">(</span><span class="op" id="5704885">[</span><span class="op" id="5704886">]</span><span class="ident" id="5704887">reflect</span><span class="op" id="5704894">.</span><span class="ident" id="5704895">Value</span><span class="op" id="5704900">,</span>&nbsp;<span class="ident" id="5704902">numIn</span><span class="op" id="5704907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704910">//&nbsp;Args&nbsp;must&nbsp;be&nbsp;evaluated.&nbsp;Fixed&nbsp;args&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704956">i</span>&nbsp;<span class="op" id="5704958">:=</span>&nbsp;<span class="num" id="5704961">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704964">for</span>&nbsp;<span class="op" id="5704968">;</span>&nbsp;<span class="ident" id="5704970">i</span>&nbsp;<span class="op" id="5704972">&lt;</span>&nbsp;<span class="ident" id="5704974">numFixed</span>&nbsp;<span class="op" id="5704983">&amp;&amp;</span>&nbsp;<span class="ident" id="5704986">i</span>&nbsp;<span class="op" id="5704988">&lt;</span>&nbsp;<span class="builtinfunc" id="5704990">len</span><span class="op" id="5704993">(</span><span class="ident" id="5704994">args</span><span class="op" id="5704998">)</span><span class="op" id="5704999">;</span>&nbsp;<span class="ident" id="5705001">i</span><span class="op" id="5705002">++</span>&nbsp;<span class="op" id="5705005">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705009">argv</span><span class="op" id="5705013">[</span><span class="ident" id="5705014">i</span><span class="op" id="5705015">]</span>&nbsp;<span class="op" id="5705017">=</span>&nbsp;<span class="ident" id="5705019">s</span><span class="op" id="5705020">.</span><span class="ident" id="5705021">evalArg</span><span class="op" id="5705028">(</span><span class="ident" id="5705029">dot</span><span class="op" id="5705032">,</span>&nbsp;<span class="ident" id="5705034">typ</span><span class="op" id="5705037">.</span><span class="ident" id="5705038">In</span><span class="op" id="5705040">(</span><span class="ident" id="5705041">i</span><span class="op" id="5705042">)</span><span class="op" id="5705043">,</span>&nbsp;<span class="ident" id="5705045">args</span><span class="op" id="5705049">[</span><span class="ident" id="5705050">i</span><span class="op" id="5705051">]</span><span class="op" id="5705052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5705058">//&nbsp;Now&nbsp;the&nbsp;...&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705080">if</span>&nbsp;<span class="ident" id="5705083">typ</span><span class="op" id="5705086">.</span><span class="ident" id="5705087">IsVariadic</span><span class="op" id="5705097">(</span><span class="op" id="5705098">)</span>&nbsp;<span class="op" id="5705100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705104">argType</span>&nbsp;<span class="op" id="5705112">:=</span>&nbsp;<span class="ident" id="5705115">typ</span><span class="op" id="5705118">.</span><span class="ident" id="5705119">In</span><span class="op" id="5705121">(</span><span class="ident" id="5705122">typ</span><span class="op" id="5705125">.</span><span class="ident" id="5705126">NumIn</span><span class="op" id="5705131">(</span><span class="op" id="5705132">)</span>&nbsp;<span class="op" id="5705134">-</span>&nbsp;<span class="num" id="5705136">1</span><span class="op" id="5705137">)</span><span class="op" id="5705138">.</span><span class="ident" id="5705139">Elem</span><span class="op" id="5705143">(</span><span class="op" id="5705144">)</span>&nbsp;<span class="comment" id="5705146">//&nbsp;Argument&nbsp;is&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705172">for</span>&nbsp;<span class="op" id="5705176">;</span>&nbsp;<span class="ident" id="5705178">i</span>&nbsp;<span class="op" id="5705180">&lt;</span>&nbsp;<span class="builtinfunc" id="5705182">len</span><span class="op" id="5705185">(</span><span class="ident" id="5705186">args</span><span class="op" id="5705190">)</span><span class="op" id="5705191">;</span>&nbsp;<span class="ident" id="5705193">i</span><span class="op" id="5705194">++</span>&nbsp;<span class="op" id="5705197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705202">argv</span><span class="op" id="5705206">[</span><span class="ident" id="5705207">i</span><span class="op" id="5705208">]</span>&nbsp;<span class="op" id="5705210">=</span>&nbsp;<span class="ident" id="5705212">s</span><span class="op" id="5705213">.</span><span class="ident" id="5705214">evalArg</span><span class="op" id="5705221">(</span><span class="ident" id="5705222">dot</span><span class="op" id="5705225">,</span>&nbsp;<span class="ident" id="5705227">argType</span><span class="op" id="5705234">,</span>&nbsp;<span class="ident" id="5705236">args</span><span class="op" id="5705240">[</span><span class="ident" id="5705241">i</span><span class="op" id="5705242">]</span><span class="op" id="5705243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5705253">//&nbsp;Add&nbsp;final&nbsp;value&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705287">if</span>&nbsp;<span class="ident" id="5705290">final</span><span class="op" id="5705295">.</span><span class="ident" id="5705296">IsValid</span><span class="op" id="5705303">(</span><span class="op" id="5705304">)</span>&nbsp;<span class="op" id="5705306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705310">t</span>&nbsp;<span class="op" id="5705312">:=</span>&nbsp;<span class="ident" id="5705315">typ</span><span class="op" id="5705318">.</span><span class="ident" id="5705319">In</span><span class="op" id="5705321">(</span><span class="ident" id="5705322">typ</span><span class="op" id="5705325">.</span><span class="ident" id="5705326">NumIn</span><span class="op" id="5705331">(</span><span class="op" id="5705332">)</span>&nbsp;<span class="op" id="5705334">-</span>&nbsp;<span class="num" id="5705336">1</span><span class="op" id="5705337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705341">if</span>&nbsp;<span class="ident" id="5705344">typ</span><span class="op" id="5705347">.</span><span class="ident" id="5705348">IsVariadic</span><span class="op" id="5705358">(</span><span class="op" id="5705359">)</span>&nbsp;<span class="op" id="5705361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705366">t</span>&nbsp;<span class="op" id="5705368">=</span>&nbsp;<span class="ident" id="5705370">t</span><span class="op" id="5705371">.</span><span class="ident" id="5705372">Elem</span><span class="op" id="5705376">(</span><span class="op" id="5705377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705381">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705385">argv</span><span class="op" id="5705389">[</span><span class="ident" id="5705390">i</span><span class="op" id="5705391">]</span>&nbsp;<span class="op" id="5705393">=</span>&nbsp;<span class="ident" id="5705395">s</span><span class="op" id="5705396">.</span><span class="ident" id="5705397">validateType</span><span class="op" id="5705409">(</span><span class="ident" id="5705410">final</span><span class="op" id="5705415">,</span>&nbsp;<span class="ident" id="5705417">t</span><span class="op" id="5705418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705424">result</span>&nbsp;<span class="op" id="5705431">:=</span>&nbsp;<span class="ident" id="5705434">fun</span><span class="op" id="5705437">.</span><span class="ident" id="5705438">Call</span><span class="op" id="5705442">(</span><span class="ident" id="5705443">argv</span><span class="op" id="5705447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5705450">//&nbsp;If&nbsp;we&nbsp;have&nbsp;an&nbsp;error&nbsp;that&nbsp;is&nbsp;not&nbsp;nil,&nbsp;stop&nbsp;execution&nbsp;and&nbsp;return&nbsp;that&nbsp;error&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705543">if</span>&nbsp;<span class="builtinfunc" id="5705546">len</span><span class="op" id="5705549">(</span><span class="ident" id="5705550">result</span><span class="op" id="5705556">)</span>&nbsp;<span class="op" id="5705558">==</span>&nbsp;<span class="num" id="5705561">2</span>&nbsp;<span class="op" id="5705563">&amp;&amp;</span>&nbsp;<span class="op" id="5705566">!</span><span class="ident" id="5705567">result</span><span class="op" id="5705573">[</span><span class="num" id="5705574">1</span><span class="op" id="5705575">]</span><span class="op" id="5705576">.</span><span class="ident" id="5705577">IsNil</span><span class="op" id="5705582">(</span><span class="op" id="5705583">)</span>&nbsp;<span class="op" id="5705585">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705589">s</span><span class="op" id="5705590">.</span><span class="ident" id="5705591">at</span><span class="op" id="5705593">(</span><span class="ident" id="5705594">node</span><span class="op" id="5705598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705602">s</span><span class="op" id="5705603">.</span><span class="ident" id="5705604">errorf</span><span class="op" id="5705610">(</span><span class="string" id="5705611">&#34;error&nbsp;calling&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="5705633">,</span>&nbsp;<span class="ident" id="5705635">name</span><span class="op" id="5705639">,</span>&nbsp;<span class="ident" id="5705641">result</span><span class="op" id="5705647">[</span><span class="num" id="5705648">1</span><span class="op" id="5705649">]</span><span class="op" id="5705650">.</span><span class="ident" id="5705651">Interface</span><span class="op" id="5705660">(</span><span class="op" id="5705661">)</span><span class="op" id="5705662">.</span><span class="op" id="5705663">(</span><span class="builtintype" id="5705664">error</span><span class="op" id="5705669">)</span><span class="op" id="5705670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705676">return</span>&nbsp;<span class="ident" id="5705683">result</span><span class="op" id="5705689">[</span><span class="num" id="5705690">0</span><span class="op" id="5705691">]</span><br>
<span class="lineno"></span><span class="op" id="5705693">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="5705696">//&nbsp;canBeNil&nbsp;reports&nbsp;whether&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;can&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the&nbsp;type.&nbsp;See&nbsp;reflect.Zero.</span><br>
<span class="lineno"></span><span class="keyword" id="5705786">func</span>&nbsp;<span class="ident" id="5705791">canBeNil</span><span class="op" id="5705799">(</span><span class="ident" id="5705800">typ</span>&nbsp;<span class="ident" id="5705804">reflect</span><span class="op" id="5705811">.</span><span class="ident" id="5705812">Type</span><span class="op" id="5705816">)</span>&nbsp;<span class="builtintype" id="5705818">bool</span>&nbsp;<span class="op" id="5705823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705826">switch</span>&nbsp;<span class="ident" id="5705833">typ</span><span class="op" id="5705836">.</span><span class="ident" id="5705837">Kind</span><span class="op" id="5705841">(</span><span class="op" id="5705842">)</span>&nbsp;<span class="op" id="5705844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705847">case</span>&nbsp;<span class="ident" id="5705852">reflect</span><span class="op" id="5705859">.</span><span class="ident" id="5705860">Chan</span><span class="op" id="5705864">,</span>&nbsp;<span class="ident" id="5705866">reflect</span><span class="op" id="5705873">.</span><span class="ident" id="5705874">Func</span><span class="op" id="5705878">,</span>&nbsp;<span class="ident" id="5705880">reflect</span><span class="op" id="5705887">.</span><span class="ident" id="5705888">Interface</span><span class="op" id="5705897">,</span>&nbsp;<span class="ident" id="5705899">reflect</span><span class="op" id="5705906">.</span><span class="ident" id="5705907">Map</span><span class="op" id="5705910">,</span>&nbsp;<span class="ident" id="5705912">reflect</span><span class="op" id="5705919">.</span><span class="ident" id="5705920">Ptr</span><span class="op" id="5705923">,</span>&nbsp;<span class="ident" id="5705925">reflect</span><span class="op" id="5705932">.</span><span class="ident" id="5705933">Slice</span><span class="op" id="5705938">:</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705942">return</span>&nbsp;<span class="builtintype" id="5705949">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705958">return</span>&nbsp;<span class="builtintype" id="5705965">false</span><br>
<span class="lineno"></span><span class="op" id="5705971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="5705974">//&nbsp;validateType&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;assignable&nbsp;to&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5706053">func</span>&nbsp;<span class="op" id="5706058">(</span><span class="ident" id="5706059">s</span>&nbsp;<span class="op" id="5706061">*</span><span class="ident" id="5706062">state</span><span class="op" id="5706067">)</span>&nbsp;<span class="ident" id="5706069">validateType</span><span class="op" id="5706081">(</span><span class="ident" id="5706082">value</span>&nbsp;<span class="ident" id="5706088">reflect</span><span class="op" id="5706095">.</span><span class="ident" id="5706096">Value</span><span class="op" id="5706101">,</span>&nbsp;<span class="ident" id="5706103">typ</span>&nbsp;<span class="ident" id="5706107">reflect</span><span class="op" id="5706114">.</span><span class="ident" id="5706115">Type</span><span class="op" id="5706119">)</span>&nbsp;<span class="ident" id="5706121">reflect</span><span class="op" id="5706128">.</span><span class="ident" id="5706129">Value</span>&nbsp;<span class="op" id="5706135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706138">if</span>&nbsp;<span class="op" id="5706141">!</span><span class="ident" id="5706142">value</span><span class="op" id="5706147">.</span><span class="ident" id="5706148">IsValid</span><span class="op" id="5706155">(</span><span class="op" id="5706156">)</span>&nbsp;<span class="op" id="5706158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706162">if</span>&nbsp;<span class="ident" id="5706165">typ</span>&nbsp;<span class="op" id="5706169">==</span>&nbsp;<span class="ident" id="5706172">nil</span>&nbsp;<span class="op" id="5706176">||</span>&nbsp;<span class="ident" id="5706179">canBeNil</span><span class="op" id="5706187">(</span><span class="ident" id="5706188">typ</span><span class="op" id="5706191">)</span>&nbsp;<span class="op" id="5706193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706198">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;interface{}.&nbsp;Accept&nbsp;as&nbsp;a&nbsp;proper&nbsp;nil&nbsp;value.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706262">return</span>&nbsp;<span class="ident" id="5706269">reflect</span><span class="op" id="5706276">.</span><span class="ident" id="5706277">Zero</span><span class="op" id="5706281">(</span><span class="ident" id="5706282">typ</span><span class="op" id="5706285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5706289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706293">s</span><span class="op" id="5706294">.</span><span class="ident" id="5706295">errorf</span><span class="op" id="5706301">(</span><span class="string" id="5706302">&#34;invalid&nbsp;value;&nbsp;expected&nbsp;%s&#34;</span><span class="op" id="5706330">,</span>&nbsp;<span class="ident" id="5706332">typ</span><span class="op" id="5706335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5706338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706341">if</span>&nbsp;<span class="ident" id="5706344">typ</span>&nbsp;<span class="op" id="5706348">!=</span>&nbsp;<span class="ident" id="5706351">nil</span>&nbsp;<span class="op" id="5706355">&amp;&amp;</span>&nbsp;<span class="op" id="5706358">!</span><span class="ident" id="5706359">value</span><span class="op" id="5706364">.</span><span class="ident" id="5706365">Type</span><span class="op" id="5706369">(</span><span class="op" id="5706370">)</span><span class="op" id="5706371">.</span><span class="ident" id="5706372">AssignableTo</span><span class="op" id="5706384">(</span><span class="ident" id="5706385">typ</span><span class="op" id="5706388">)</span>&nbsp;<span class="op" id="5706390">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706394">if</span>&nbsp;<span class="ident" id="5706397">value</span><span class="op" id="5706402">.</span><span class="ident" id="5706403">Kind</span><span class="op" id="5706407">(</span><span class="op" id="5706408">)</span>&nbsp;<span class="op" id="5706410">==</span>&nbsp;<span class="ident" id="5706413">reflect</span><span class="op" id="5706420">.</span><span class="ident" id="5706421">Interface</span>&nbsp;<span class="op" id="5706431">&amp;&amp;</span>&nbsp;<span class="op" id="5706434">!</span><span class="ident" id="5706435">value</span><span class="op" id="5706440">.</span><span class="ident" id="5706441">IsNil</span><span class="op" id="5706446">(</span><span class="op" id="5706447">)</span>&nbsp;<span class="op" id="5706449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706454">value</span>&nbsp;<span class="op" id="5706460">=</span>&nbsp;<span class="ident" id="5706462">value</span><span class="op" id="5706467">.</span><span class="ident" id="5706468">Elem</span><span class="op" id="5706472">(</span><span class="op" id="5706473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706478">if</span>&nbsp;<span class="ident" id="5706481">value</span><span class="op" id="5706486">.</span><span class="ident" id="5706487">Type</span><span class="op" id="5706491">(</span><span class="op" id="5706492">)</span><span class="op" id="5706493">.</span><span class="ident" id="5706494">AssignableTo</span><span class="op" id="5706506">(</span><span class="ident" id="5706507">typ</span><span class="op" id="5706510">)</span>&nbsp;<span class="op" id="5706512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706518">return</span>&nbsp;<span class="ident" id="5706525">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5706534">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706539">//&nbsp;fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5706556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706560">//&nbsp;Does&nbsp;one&nbsp;dereference&nbsp;or&nbsp;indirection&nbsp;work?&nbsp;We&nbsp;could&nbsp;do&nbsp;more,&nbsp;as&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706631">//&nbsp;do&nbsp;with&nbsp;method&nbsp;receivers,&nbsp;but&nbsp;that&nbsp;gets&nbsp;messy&nbsp;and&nbsp;method&nbsp;receivers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706703">//&nbsp;are&nbsp;much&nbsp;more&nbsp;constrained,&nbsp;so&nbsp;it&nbsp;makes&nbsp;more&nbsp;sense&nbsp;there&nbsp;than&nbsp;here.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706775">//&nbsp;Besides,&nbsp;one&nbsp;is&nbsp;almost&nbsp;always&nbsp;all&nbsp;you&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706824">switch</span>&nbsp;<span class="op" id="5706831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706835">case</span>&nbsp;<span class="ident" id="5706840">value</span><span class="op" id="5706845">.</span><span class="ident" id="5706846">Kind</span><span class="op" id="5706850">(</span><span class="op" id="5706851">)</span>&nbsp;<span class="op" id="5706853">==</span>&nbsp;<span class="ident" id="5706856">reflect</span><span class="op" id="5706863">.</span><span class="ident" id="5706864">Ptr</span>&nbsp;<span class="op" id="5706868">&amp;&amp;</span>&nbsp;<span class="ident" id="5706871">value</span><span class="op" id="5706876">.</span><span class="ident" id="5706877">Type</span><span class="op" id="5706881">(</span><span class="op" id="5706882">)</span><span class="op" id="5706883">.</span><span class="ident" id="5706884">Elem</span><span class="op" id="5706888">(</span><span class="op" id="5706889">)</span><span class="op" id="5706890">.</span><span class="ident" id="5706891">AssignableTo</span><span class="op" id="5706903">(</span><span class="ident" id="5706904">typ</span><span class="op" id="5706907">)</span><span class="op" id="5706908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706913">value</span>&nbsp;<span class="op" id="5706919">=</span>&nbsp;<span class="ident" id="5706921">value</span><span class="op" id="5706926">.</span><span class="ident" id="5706927">Elem</span><span class="op" id="5706931">(</span><span class="op" id="5706932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706937">if</span>&nbsp;<span class="op" id="5706940">!</span><span class="ident" id="5706941">value</span><span class="op" id="5706946">.</span><span class="ident" id="5706947">IsValid</span><span class="op" id="5706954">(</span><span class="op" id="5706955">)</span>&nbsp;<span class="op" id="5706957">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706963">s</span><span class="op" id="5706964">.</span><span class="ident" id="5706965">errorf</span><span class="op" id="5706971">(</span><span class="string" id="5706972">&#34;dereference&nbsp;of&nbsp;nil&nbsp;pointer&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5707011">,</span>&nbsp;<span class="ident" id="5707013">typ</span><span class="op" id="5707016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707025">case</span>&nbsp;<span class="ident" id="5707030">reflect</span><span class="op" id="5707037">.</span><span class="ident" id="5707038">PtrTo</span><span class="op" id="5707043">(</span><span class="ident" id="5707044">value</span><span class="op" id="5707049">.</span><span class="ident" id="5707050">Type</span><span class="op" id="5707054">(</span><span class="op" id="5707055">)</span><span class="op" id="5707056">)</span><span class="op" id="5707057">.</span><span class="ident" id="5707058">AssignableTo</span><span class="op" id="5707070">(</span><span class="ident" id="5707071">typ</span><span class="op" id="5707074">)</span>&nbsp;<span class="op" id="5707076">&amp;&amp;</span>&nbsp;<span class="ident" id="5707079">value</span><span class="op" id="5707084">.</span><span class="ident" id="5707085">CanAddr</span><span class="op" id="5707092">(</span><span class="op" id="5707093">)</span><span class="op" id="5707094">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707099">value</span>&nbsp;<span class="op" id="5707105">=</span>&nbsp;<span class="ident" id="5707107">value</span><span class="op" id="5707112">.</span><span class="ident" id="5707113">Addr</span><span class="op" id="5707117">(</span><span class="op" id="5707118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707122">default</span><span class="op" id="5707129">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707134">s</span><span class="op" id="5707135">.</span><span class="ident" id="5707136">errorf</span><span class="op" id="5707142">(</span><span class="string" id="5707143">&#34;wrong&nbsp;type&nbsp;for&nbsp;value;&nbsp;expected&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="5707186">,</span>&nbsp;<span class="ident" id="5707188">typ</span><span class="op" id="5707191">,</span>&nbsp;<span class="ident" id="5707193">value</span><span class="op" id="5707198">.</span><span class="ident" id="5707199">Type</span><span class="op" id="5707203">(</span><span class="op" id="5707204">)</span><span class="op" id="5707205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707215">return</span>&nbsp;<span class="ident" id="5707222">value</span><br>
<span class="lineno"></span><span class="op" id="5707228">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="5707231">func</span>&nbsp;<span class="op" id="5707236">(</span><span class="ident" id="5707237">s</span>&nbsp;<span class="op" id="5707239">*</span><span class="ident" id="5707240">state</span><span class="op" id="5707245">)</span>&nbsp;<span class="ident" id="5707247">evalArg</span><span class="op" id="5707254">(</span><span class="ident" id="5707255">dot</span>&nbsp;<span class="ident" id="5707259">reflect</span><span class="op" id="5707266">.</span><span class="ident" id="5707267">Value</span><span class="op" id="5707272">,</span>&nbsp;<span class="ident" id="5707274">typ</span>&nbsp;<span class="ident" id="5707278">reflect</span><span class="op" id="5707285">.</span><span class="ident" id="5707286">Type</span><span class="op" id="5707290">,</span>&nbsp;<span class="ident" id="5707292">n</span>&nbsp;<span class="ident" id="5707294">parse</span><span class="op" id="5707299">.</span><span class="ident" id="5707300">Node</span><span class="op" id="5707304">)</span>&nbsp;<span class="ident" id="5707306">reflect</span><span class="op" id="5707313">.</span><span class="ident" id="5707314">Value</span>&nbsp;<span class="op" id="5707320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707323">s</span><span class="op" id="5707324">.</span><span class="ident" id="5707325">at</span><span class="op" id="5707327">(</span><span class="ident" id="5707328">n</span><span class="op" id="5707329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707332">switch</span>&nbsp;<span class="ident" id="5707339">arg</span>&nbsp;<span class="op" id="5707343">:=</span>&nbsp;<span class="ident" id="5707346">n</span><span class="op" id="5707347">.</span><span class="op" id="5707348">(</span><span class="keyword" id="5707349">type</span><span class="op" id="5707353">)</span>&nbsp;<span class="op" id="5707355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707358">case</span>&nbsp;<span class="op" id="5707363">*</span><span class="ident" id="5707364">parse</span><span class="op" id="5707369">.</span><span class="ident" id="5707370">DotNode</span><span class="op" id="5707377">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707381">return</span>&nbsp;<span class="ident" id="5707388">s</span><span class="op" id="5707389">.</span><span class="ident" id="5707390">validateType</span><span class="op" id="5707402">(</span><span class="ident" id="5707403">dot</span><span class="op" id="5707406">,</span>&nbsp;<span class="ident" id="5707408">typ</span><span class="op" id="5707411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707414">case</span>&nbsp;<span class="op" id="5707419">*</span><span class="ident" id="5707420">parse</span><span class="op" id="5707425">.</span><span class="ident" id="5707426">NilNode</span><span class="op" id="5707433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707437">if</span>&nbsp;<span class="ident" id="5707440">canBeNil</span><span class="op" id="5707448">(</span><span class="ident" id="5707449">typ</span><span class="op" id="5707452">)</span>&nbsp;<span class="op" id="5707454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707459">return</span>&nbsp;<span class="ident" id="5707466">reflect</span><span class="op" id="5707473">.</span><span class="ident" id="5707474">Zero</span><span class="op" id="5707478">(</span><span class="ident" id="5707479">typ</span><span class="op" id="5707482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707486">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707490">s</span><span class="op" id="5707491">.</span><span class="ident" id="5707492">errorf</span><span class="op" id="5707498">(</span><span class="string" id="5707499">&#34;cannot&nbsp;assign&nbsp;nil&nbsp;to&nbsp;%s&#34;</span><span class="op" id="5707524">,</span>&nbsp;<span class="ident" id="5707526">typ</span><span class="op" id="5707529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707532">case</span>&nbsp;<span class="op" id="5707537">*</span><span class="ident" id="5707538">parse</span><span class="op" id="5707543">.</span><span class="ident" id="5707544">FieldNode</span><span class="op" id="5707553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707557">return</span>&nbsp;<span class="ident" id="5707564">s</span><span class="op" id="5707565">.</span><span class="ident" id="5707566">validateType</span><span class="op" id="5707578">(</span><span class="ident" id="5707579">s</span><span class="op" id="5707580">.</span><span class="ident" id="5707581">evalFieldNode</span><span class="op" id="5707594">(</span><span class="ident" id="5707595">dot</span><span class="op" id="5707598">,</span>&nbsp;<span class="ident" id="5707600">arg</span><span class="op" id="5707603">,</span>&nbsp;<span class="op" id="5707605">[</span><span class="op" id="5707606">]</span><span class="ident" id="5707607">parse</span><span class="op" id="5707612">.</span><span class="ident" id="5707613">Node</span><span class="op" id="5707617">{</span><span class="ident" id="5707618">n</span><span class="op" id="5707619">}</span><span class="op" id="5707620">,</span>&nbsp;<span class="ident" id="5707622">zero</span><span class="op" id="5707626">)</span><span class="op" id="5707627">,</span>&nbsp;<span class="ident" id="5707629">typ</span><span class="op" id="5707632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707635">case</span>&nbsp;<span class="op" id="5707640">*</span><span class="ident" id="5707641">parse</span><span class="op" id="5707646">.</span><span class="ident" id="5707647">VariableNode</span><span class="op" id="5707659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707663">return</span>&nbsp;<span class="ident" id="5707670">s</span><span class="op" id="5707671">.</span><span class="ident" id="5707672">validateType</span><span class="op" id="5707684">(</span><span class="ident" id="5707685">s</span><span class="op" id="5707686">.</span><span class="ident" id="5707687">evalVariableNode</span><span class="op" id="5707703">(</span><span class="ident" id="5707704">dot</span><span class="op" id="5707707">,</span>&nbsp;<span class="ident" id="5707709">arg</span><span class="op" id="5707712">,</span>&nbsp;<span class="ident" id="5707714">nil</span><span class="op" id="5707717">,</span>&nbsp;<span class="ident" id="5707719">zero</span><span class="op" id="5707723">)</span><span class="op" id="5707724">,</span>&nbsp;<span class="ident" id="5707726">typ</span><span class="op" id="5707729">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707732">case</span>&nbsp;<span class="op" id="5707737">*</span><span class="ident" id="5707738">parse</span><span class="op" id="5707743">.</span><span class="ident" id="5707744">PipeNode</span><span class="op" id="5707752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707756">return</span>&nbsp;<span class="ident" id="5707763">s</span><span class="op" id="5707764">.</span><span class="ident" id="5707765">validateType</span><span class="op" id="5707777">(</span><span class="ident" id="5707778">s</span><span class="op" id="5707779">.</span><span class="ident" id="5707780">evalPipeline</span><span class="op" id="5707792">(</span><span class="ident" id="5707793">dot</span><span class="op" id="5707796">,</span>&nbsp;<span class="ident" id="5707798">arg</span><span class="op" id="5707801">)</span><span class="op" id="5707802">,</span>&nbsp;<span class="ident" id="5707804">typ</span><span class="op" id="5707807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707810">case</span>&nbsp;<span class="op" id="5707815">*</span><span class="ident" id="5707816">parse</span><span class="op" id="5707821">.</span><span class="ident" id="5707822">IdentifierNode</span><span class="op" id="5707836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707840">return</span>&nbsp;<span class="ident" id="5707847">s</span><span class="op" id="5707848">.</span><span class="ident" id="5707849">evalFunction</span><span class="op" id="5707861">(</span><span class="ident" id="5707862">dot</span><span class="op" id="5707865">,</span>&nbsp;<span class="ident" id="5707867">arg</span><span class="op" id="5707870">,</span>&nbsp;<span class="ident" id="5707872">arg</span><span class="op" id="5707875">,</span>&nbsp;<span class="ident" id="5707877">nil</span><span class="op" id="5707880">,</span>&nbsp;<span class="ident" id="5707882">zero</span><span class="op" id="5707886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707889">case</span>&nbsp;<span class="op" id="5707894">*</span><span class="ident" id="5707895">parse</span><span class="op" id="5707900">.</span><span class="ident" id="5707901">ChainNode</span><span class="op" id="5707910">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707914">return</span>&nbsp;<span class="ident" id="5707921">s</span><span class="op" id="5707922">.</span><span class="ident" id="5707923">validateType</span><span class="op" id="5707935">(</span><span class="ident" id="5707936">s</span><span class="op" id="5707937">.</span><span class="ident" id="5707938">evalChainNode</span><span class="op" id="5707951">(</span><span class="ident" id="5707952">dot</span><span class="op" id="5707955">,</span>&nbsp;<span class="ident" id="5707957">arg</span><span class="op" id="5707960">,</span>&nbsp;<span class="ident" id="5707962">nil</span><span class="op" id="5707965">,</span>&nbsp;<span class="ident" id="5707967">zero</span><span class="op" id="5707971">)</span><span class="op" id="5707972">,</span>&nbsp;<span class="ident" id="5707974">typ</span><span class="op" id="5707977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707983">switch</span>&nbsp;<span class="ident" id="5707990">typ</span><span class="op" id="5707993">.</span><span class="ident" id="5707994">Kind</span><span class="op" id="5707998">(</span><span class="op" id="5707999">)</span>&nbsp;<span class="op" id="5708001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708004">case</span>&nbsp;<span class="ident" id="5708009">reflect</span><span class="op" id="5708016">.</span><span class="ident" id="5708017">Bool</span><span class="op" id="5708021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708025">return</span>&nbsp;<span class="ident" id="5708032">s</span><span class="op" id="5708033">.</span><span class="ident" id="5708034">evalBool</span><span class="op" id="5708042">(</span><span class="ident" id="5708043">typ</span><span class="op" id="5708046">,</span>&nbsp;<span class="ident" id="5708048">n</span><span class="op" id="5708049">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708052">case</span>&nbsp;<span class="ident" id="5708057">reflect</span><span class="op" id="5708064">.</span><span class="ident" id="5708065">Complex64</span><span class="op" id="5708074">,</span>&nbsp;<span class="ident" id="5708076">reflect</span><span class="op" id="5708083">.</span><span class="ident" id="5708084">Complex128</span><span class="op" id="5708094">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708098">return</span>&nbsp;<span class="ident" id="5708105">s</span><span class="op" id="5708106">.</span><span class="ident" id="5708107">evalComplex</span><span class="op" id="5708118">(</span><span class="ident" id="5708119">typ</span><span class="op" id="5708122">,</span>&nbsp;<span class="ident" id="5708124">n</span><span class="op" id="5708125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708128">case</span>&nbsp;<span class="ident" id="5708133">reflect</span><span class="op" id="5708140">.</span><span class="ident" id="5708141">Float32</span><span class="op" id="5708148">,</span>&nbsp;<span class="ident" id="5708150">reflect</span><span class="op" id="5708157">.</span><span class="ident" id="5708158">Float64</span><span class="op" id="5708165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708169">return</span>&nbsp;<span class="ident" id="5708176">s</span><span class="op" id="5708177">.</span><span class="ident" id="5708178">evalFloat</span><span class="op" id="5708187">(</span><span class="ident" id="5708188">typ</span><span class="op" id="5708191">,</span>&nbsp;<span class="ident" id="5708193">n</span><span class="op" id="5708194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708197">case</span>&nbsp;<span class="ident" id="5708202">reflect</span><span class="op" id="5708209">.</span><span class="ident" id="5708210">Int</span><span class="op" id="5708213">,</span>&nbsp;<span class="ident" id="5708215">reflect</span><span class="op" id="5708222">.</span><span class="ident" id="5708223">Int8</span><span class="op" id="5708227">,</span>&nbsp;<span class="ident" id="5708229">reflect</span><span class="op" id="5708236">.</span><span class="ident" id="5708237">Int16</span><span class="op" id="5708242">,</span>&nbsp;<span class="ident" id="5708244">reflect</span><span class="op" id="5708251">.</span><span class="ident" id="5708252">Int32</span><span class="op" id="5708257">,</span>&nbsp;<span class="ident" id="5708259">reflect</span><span class="op" id="5708266">.</span><span class="ident" id="5708267">Int64</span><span class="op" id="5708272">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708276">return</span>&nbsp;<span class="ident" id="5708283">s</span><span class="op" id="5708284">.</span><span class="ident" id="5708285">evalInteger</span><span class="op" id="5708296">(</span><span class="ident" id="5708297">typ</span><span class="op" id="5708300">,</span>&nbsp;<span class="ident" id="5708302">n</span><span class="op" id="5708303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708306">case</span>&nbsp;<span class="ident" id="5708311">reflect</span><span class="op" id="5708318">.</span><span class="ident" id="5708319">Interface</span><span class="op" id="5708328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708332">if</span>&nbsp;<span class="ident" id="5708335">typ</span><span class="op" id="5708338">.</span><span class="ident" id="5708339">NumMethod</span><span class="op" id="5708348">(</span><span class="op" id="5708349">)</span>&nbsp;<span class="op" id="5708351">==</span>&nbsp;<span class="num" id="5708354">0</span>&nbsp;<span class="op" id="5708356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708361">return</span>&nbsp;<span class="ident" id="5708368">s</span><span class="op" id="5708369">.</span><span class="ident" id="5708370">evalEmptyInterface</span><span class="op" id="5708388">(</span><span class="ident" id="5708389">dot</span><span class="op" id="5708392">,</span>&nbsp;<span class="ident" id="5708394">n</span><span class="op" id="5708395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5708399">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708402">case</span>&nbsp;<span class="ident" id="5708407">reflect</span><span class="op" id="5708414">.</span><span class="ident" id="5708415">String</span><span class="op" id="5708421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708425">return</span>&nbsp;<span class="ident" id="5708432">s</span><span class="op" id="5708433">.</span><span class="ident" id="5708434">evalString</span><span class="op" id="5708444">(</span><span class="ident" id="5708445">typ</span><span class="op" id="5708448">,</span>&nbsp;<span class="ident" id="5708450">n</span><span class="op" id="5708451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708454">case</span>&nbsp;<span class="ident" id="5708459">reflect</span><span class="op" id="5708466">.</span><span class="ident" id="5708467">Uint</span><span class="op" id="5708471">,</span>&nbsp;<span class="ident" id="5708473">reflect</span><span class="op" id="5708480">.</span><span class="ident" id="5708481">Uint8</span><span class="op" id="5708486">,</span>&nbsp;<span class="ident" id="5708488">reflect</span><span class="op" id="5708495">.</span><span class="ident" id="5708496">Uint16</span><span class="op" id="5708502">,</span>&nbsp;<span class="ident" id="5708504">reflect</span><span class="op" id="5708511">.</span><span class="ident" id="5708512">Uint32</span><span class="op" id="5708518">,</span>&nbsp;<span class="ident" id="5708520">reflect</span><span class="op" id="5708527">.</span><span class="ident" id="5708528">Uint64</span><span class="op" id="5708534">,</span>&nbsp;<span class="ident" id="5708536">reflect</span><span class="op" id="5708543">.</span><span class="ident" id="5708544">Uintptr</span><span class="op" id="5708551">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708555">return</span>&nbsp;<span class="ident" id="5708562">s</span><span class="op" id="5708563">.</span><span class="ident" id="5708564">evalUnsignedInteger</span><span class="op" id="5708583">(</span><span class="ident" id="5708584">typ</span><span class="op" id="5708587">,</span>&nbsp;<span class="ident" id="5708589">n</span><span class="op" id="5708590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5708593">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708596">s</span><span class="op" id="5708597">.</span><span class="ident" id="5708598">errorf</span><span class="op" id="5708604">(</span><span class="string" id="5708605">&#34;can&#39;t&nbsp;handle&nbsp;%s&nbsp;for&nbsp;arg&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5708641">,</span>&nbsp;<span class="ident" id="5708643">n</span><span class="op" id="5708644">,</span>&nbsp;<span class="ident" id="5708646">typ</span><span class="op" id="5708649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5708652">panic</span><span class="op" id="5708657">(</span><span class="string" id="5708658">&#34;not&nbsp;reached&#34;</span><span class="op" id="5708671">)</span><br>
<span class="lineno"></span><span class="op" id="5708673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5708676">func</span>&nbsp;<span class="op" id="5708681">(</span><span class="ident" id="5708682">s</span>&nbsp;<span class="op" id="5708684">*</span><span class="ident" id="5708685">state</span><span class="op" id="5708690">)</span>&nbsp;<span class="ident" id="5708692">evalBool</span><span class="op" id="5708700">(</span><span class="ident" id="5708701">typ</span>&nbsp;<span class="ident" id="5708705">reflect</span><span class="op" id="5708712">.</span><span class="ident" id="5708713">Type</span><span class="op" id="5708717">,</span>&nbsp;<span class="ident" id="5708719">n</span>&nbsp;<span class="ident" id="5708721">parse</span><span class="op" id="5708726">.</span><span class="ident" id="5708727">Node</span><span class="op" id="5708731">)</span>&nbsp;<span class="ident" id="5708733">reflect</span><span class="op" id="5708740">.</span><span class="ident" id="5708741">Value</span>&nbsp;<span class="op" id="5708747">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708750">s</span><span class="op" id="5708751">.</span><span class="ident" id="5708752">at</span><span class="op" id="5708754">(</span><span class="ident" id="5708755">n</span><span class="op" id="5708756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708759">if</span>&nbsp;<span class="ident" id="5708762">n</span><span class="op" id="5708763">,</span>&nbsp;<span class="ident" id="5708765">ok</span>&nbsp;<span class="op" id="5708768">:=</span>&nbsp;<span class="ident" id="5708771">n</span><span class="op" id="5708772">.</span><span class="op" id="5708773">(</span><span class="op" id="5708774">*</span><span class="ident" id="5708775">parse</span><span class="op" id="5708780">.</span><span class="ident" id="5708781">BoolNode</span><span class="op" id="5708789">)</span><span class="op" id="5708790">;</span>&nbsp;<span class="ident" id="5708792">ok</span>&nbsp;<span class="op" id="5708795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708799">value</span>&nbsp;<span class="op" id="5708805">:=</span>&nbsp;<span class="ident" id="5708808">reflect</span><span class="op" id="5708815">.</span><span class="ident" id="5708816">New</span><span class="op" id="5708819">(</span><span class="ident" id="5708820">typ</span><span class="op" id="5708823">)</span><span class="op" id="5708824">.</span><span class="ident" id="5708825">Elem</span><span class="op" id="5708829">(</span><span class="op" id="5708830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708834">value</span><span class="op" id="5708839">.</span><span class="ident" id="5708840">SetBool</span><span class="op" id="5708847">(</span><span class="ident" id="5708848">n</span><span class="op" id="5708849">.</span><span class="ident" id="5708850">True</span><span class="op" id="5708854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708858">return</span>&nbsp;<span class="ident" id="5708865">value</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5708872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708875">s</span><span class="op" id="5708876">.</span><span class="ident" id="5708877">errorf</span><span class="op" id="5708883">(</span><span class="string" id="5708884">&#34;expected&nbsp;bool;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5708909">,</span>&nbsp;<span class="ident" id="5708911">n</span><span class="op" id="5708912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5708915">panic</span><span class="op" id="5708920">(</span><span class="string" id="5708921">&#34;not&nbsp;reached&#34;</span><span class="op" id="5708934">)</span><br>
<span class="lineno"></span><span class="op" id="5708936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5708939">func</span>&nbsp;<span class="op" id="5708944">(</span><span class="ident" id="5708945">s</span>&nbsp;<span class="op" id="5708947">*</span><span class="ident" id="5708948">state</span><span class="op" id="5708953">)</span>&nbsp;<span class="ident" id="5708955">evalString</span><span class="op" id="5708965">(</span><span class="ident" id="5708966">typ</span>&nbsp;<span class="ident" id="5708970">reflect</span><span class="op" id="5708977">.</span><span class="ident" id="5708978">Type</span><span class="op" id="5708982">,</span>&nbsp;<span class="ident" id="5708984">n</span>&nbsp;<span class="ident" id="5708986">parse</span><span class="op" id="5708991">.</span><span class="ident" id="5708992">Node</span><span class="op" id="5708996">)</span>&nbsp;<span class="ident" id="5708998">reflect</span><span class="op" id="5709005">.</span><span class="ident" id="5709006">Value</span>&nbsp;<span class="op" id="5709012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709015">s</span><span class="op" id="5709016">.</span><span class="ident" id="5709017">at</span><span class="op" id="5709019">(</span><span class="ident" id="5709020">n</span><span class="op" id="5709021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709024">if</span>&nbsp;<span class="ident" id="5709027">n</span><span class="op" id="5709028">,</span>&nbsp;<span class="ident" id="5709030">ok</span>&nbsp;<span class="op" id="5709033">:=</span>&nbsp;<span class="ident" id="5709036">n</span><span class="op" id="5709037">.</span><span class="op" id="5709038">(</span><span class="op" id="5709039">*</span><span class="ident" id="5709040">parse</span><span class="op" id="5709045">.</span><span class="ident" id="5709046">StringNode</span><span class="op" id="5709056">)</span><span class="op" id="5709057">;</span>&nbsp;<span class="ident" id="5709059">ok</span>&nbsp;<span class="op" id="5709062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709066">value</span>&nbsp;<span class="op" id="5709072">:=</span>&nbsp;<span class="ident" id="5709075">reflect</span><span class="op" id="5709082">.</span><span class="ident" id="5709083">New</span><span class="op" id="5709086">(</span><span class="ident" id="5709087">typ</span><span class="op" id="5709090">)</span><span class="op" id="5709091">.</span><span class="ident" id="5709092">Elem</span><span class="op" id="5709096">(</span><span class="op" id="5709097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709101">value</span><span class="op" id="5709106">.</span><span class="ident" id="5709107">SetString</span><span class="op" id="5709116">(</span><span class="ident" id="5709117">n</span><span class="op" id="5709118">.</span><span class="ident" id="5709119">Text</span><span class="op" id="5709123">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709127">return</span>&nbsp;<span class="ident" id="5709134">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5709141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709144">s</span><span class="op" id="5709145">.</span><span class="ident" id="5709146">errorf</span><span class="op" id="5709152">(</span><span class="string" id="5709153">&#34;expected&nbsp;string;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5709180">,</span>&nbsp;<span class="ident" id="5709182">n</span><span class="op" id="5709183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5709186">panic</span><span class="op" id="5709191">(</span><span class="string" id="5709192">&#34;not&nbsp;reached&#34;</span><span class="op" id="5709205">)</span><br>
<span class="lineno"></span><span class="op" id="5709207">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="5709210">func</span>&nbsp;<span class="op" id="5709215">(</span><span class="ident" id="5709216">s</span>&nbsp;<span class="op" id="5709218">*</span><span class="ident" id="5709219">state</span><span class="op" id="5709224">)</span>&nbsp;<span class="ident" id="5709226">evalInteger</span><span class="op" id="5709237">(</span><span class="ident" id="5709238">typ</span>&nbsp;<span class="ident" id="5709242">reflect</span><span class="op" id="5709249">.</span><span class="ident" id="5709250">Type</span><span class="op" id="5709254">,</span>&nbsp;<span class="ident" id="5709256">n</span>&nbsp;<span class="ident" id="5709258">parse</span><span class="op" id="5709263">.</span><span class="ident" id="5709264">Node</span><span class="op" id="5709268">)</span>&nbsp;<span class="ident" id="5709270">reflect</span><span class="op" id="5709277">.</span><span class="ident" id="5709278">Value</span>&nbsp;<span class="op" id="5709284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709287">s</span><span class="op" id="5709288">.</span><span class="ident" id="5709289">at</span><span class="op" id="5709291">(</span><span class="ident" id="5709292">n</span><span class="op" id="5709293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709296">if</span>&nbsp;<span class="ident" id="5709299">n</span><span class="op" id="5709300">,</span>&nbsp;<span class="ident" id="5709302">ok</span>&nbsp;<span class="op" id="5709305">:=</span>&nbsp;<span class="ident" id="5709308">n</span><span class="op" id="5709309">.</span><span class="op" id="5709310">(</span><span class="op" id="5709311">*</span><span class="ident" id="5709312">parse</span><span class="op" id="5709317">.</span><span class="ident" id="5709318">NumberNode</span><span class="op" id="5709328">)</span><span class="op" id="5709329">;</span>&nbsp;<span class="ident" id="5709331">ok</span>&nbsp;<span class="op" id="5709334">&amp;&amp;</span>&nbsp;<span class="ident" id="5709337">n</span><span class="op" id="5709338">.</span><span class="ident" id="5709339">IsInt</span>&nbsp;<span class="op" id="5709345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709349">value</span>&nbsp;<span class="op" id="5709355">:=</span>&nbsp;<span class="ident" id="5709358">reflect</span><span class="op" id="5709365">.</span><span class="ident" id="5709366">New</span><span class="op" id="5709369">(</span><span class="ident" id="5709370">typ</span><span class="op" id="5709373">)</span><span class="op" id="5709374">.</span><span class="ident" id="5709375">Elem</span><span class="op" id="5709379">(</span><span class="op" id="5709380">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709384">value</span><span class="op" id="5709389">.</span><span class="ident" id="5709390">SetInt</span><span class="op" id="5709396">(</span><span class="ident" id="5709397">n</span><span class="op" id="5709398">.</span><span class="ident" id="5709399">Int64</span><span class="op" id="5709404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709408">return</span>&nbsp;<span class="ident" id="5709415">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5709422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709425">s</span><span class="op" id="5709426">.</span><span class="ident" id="5709427">errorf</span><span class="op" id="5709433">(</span><span class="string" id="5709434">&#34;expected&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5709462">,</span>&nbsp;<span class="ident" id="5709464">n</span><span class="op" id="5709465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5709468">panic</span><span class="op" id="5709473">(</span><span class="string" id="5709474">&#34;not&nbsp;reached&#34;</span><span class="op" id="5709487">)</span><br>
<span class="lineno">695</span><span class="op" id="5709489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5709492">func</span>&nbsp;<span class="op" id="5709497">(</span><span class="ident" id="5709498">s</span>&nbsp;<span class="op" id="5709500">*</span><span class="ident" id="5709501">state</span><span class="op" id="5709506">)</span>&nbsp;<span class="ident" id="5709508">evalUnsignedInteger</span><span class="op" id="5709527">(</span><span class="ident" id="5709528">typ</span>&nbsp;<span class="ident" id="5709532">reflect</span><span class="op" id="5709539">.</span><span class="ident" id="5709540">Type</span><span class="op" id="5709544">,</span>&nbsp;<span class="ident" id="5709546">n</span>&nbsp;<span class="ident" id="5709548">parse</span><span class="op" id="5709553">.</span><span class="ident" id="5709554">Node</span><span class="op" id="5709558">)</span>&nbsp;<span class="ident" id="5709560">reflect</span><span class="op" id="5709567">.</span><span class="ident" id="5709568">Value</span>&nbsp;<span class="op" id="5709574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709577">s</span><span class="op" id="5709578">.</span><span class="ident" id="5709579">at</span><span class="op" id="5709581">(</span><span class="ident" id="5709582">n</span><span class="op" id="5709583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709586">if</span>&nbsp;<span class="ident" id="5709589">n</span><span class="op" id="5709590">,</span>&nbsp;<span class="ident" id="5709592">ok</span>&nbsp;<span class="op" id="5709595">:=</span>&nbsp;<span class="ident" id="5709598">n</span><span class="op" id="5709599">.</span><span class="op" id="5709600">(</span><span class="op" id="5709601">*</span><span class="ident" id="5709602">parse</span><span class="op" id="5709607">.</span><span class="ident" id="5709608">NumberNode</span><span class="op" id="5709618">)</span><span class="op" id="5709619">;</span>&nbsp;<span class="ident" id="5709621">ok</span>&nbsp;<span class="op" id="5709624">&amp;&amp;</span>&nbsp;<span class="ident" id="5709627">n</span><span class="op" id="5709628">.</span><span class="ident" id="5709629">IsUint</span>&nbsp;<span class="op" id="5709636">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709640">value</span>&nbsp;<span class="op" id="5709646">:=</span>&nbsp;<span class="ident" id="5709649">reflect</span><span class="op" id="5709656">.</span><span class="ident" id="5709657">New</span><span class="op" id="5709660">(</span><span class="ident" id="5709661">typ</span><span class="op" id="5709664">)</span><span class="op" id="5709665">.</span><span class="ident" id="5709666">Elem</span><span class="op" id="5709670">(</span><span class="op" id="5709671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709675">value</span><span class="op" id="5709680">.</span><span class="ident" id="5709681">SetUint</span><span class="op" id="5709688">(</span><span class="ident" id="5709689">n</span><span class="op" id="5709690">.</span><span class="ident" id="5709691">Uint64</span><span class="op" id="5709697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709701">return</span>&nbsp;<span class="ident" id="5709708">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5709715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709718">s</span><span class="op" id="5709719">.</span><span class="ident" id="5709720">errorf</span><span class="op" id="5709726">(</span><span class="string" id="5709727">&#34;expected&nbsp;unsigned&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5709764">,</span>&nbsp;<span class="ident" id="5709766">n</span><span class="op" id="5709767">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5709770">panic</span><span class="op" id="5709775">(</span><span class="string" id="5709776">&#34;not&nbsp;reached&#34;</span><span class="op" id="5709789">)</span><br>
<span class="lineno"></span><span class="op" id="5709791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5709794">func</span>&nbsp;<span class="op" id="5709799">(</span><span class="ident" id="5709800">s</span>&nbsp;<span class="op" id="5709802">*</span><span class="ident" id="5709803">state</span><span class="op" id="5709808">)</span>&nbsp;<span class="ident" id="5709810">evalFloat</span><span class="op" id="5709819">(</span><span class="ident" id="5709820">typ</span>&nbsp;<span class="ident" id="5709824">reflect</span><span class="op" id="5709831">.</span><span class="ident" id="5709832">Type</span><span class="op" id="5709836">,</span>&nbsp;<span class="ident" id="5709838">n</span>&nbsp;<span class="ident" id="5709840">parse</span><span class="op" id="5709845">.</span><span class="ident" id="5709846">Node</span><span class="op" id="5709850">)</span>&nbsp;<span class="ident" id="5709852">reflect</span><span class="op" id="5709859">.</span><span class="ident" id="5709860">Value</span>&nbsp;<span class="op" id="5709866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709869">s</span><span class="op" id="5709870">.</span><span class="ident" id="5709871">at</span><span class="op" id="5709873">(</span><span class="ident" id="5709874">n</span><span class="op" id="5709875">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709878">if</span>&nbsp;<span class="ident" id="5709881">n</span><span class="op" id="5709882">,</span>&nbsp;<span class="ident" id="5709884">ok</span>&nbsp;<span class="op" id="5709887">:=</span>&nbsp;<span class="ident" id="5709890">n</span><span class="op" id="5709891">.</span><span class="op" id="5709892">(</span><span class="op" id="5709893">*</span><span class="ident" id="5709894">parse</span><span class="op" id="5709899">.</span><span class="ident" id="5709900">NumberNode</span><span class="op" id="5709910">)</span><span class="op" id="5709911">;</span>&nbsp;<span class="ident" id="5709913">ok</span>&nbsp;<span class="op" id="5709916">&amp;&amp;</span>&nbsp;<span class="ident" id="5709919">n</span><span class="op" id="5709920">.</span><span class="ident" id="5709921">IsFloat</span>&nbsp;<span class="op" id="5709929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709933">value</span>&nbsp;<span class="op" id="5709939">:=</span>&nbsp;<span class="ident" id="5709942">reflect</span><span class="op" id="5709949">.</span><span class="ident" id="5709950">New</span><span class="op" id="5709953">(</span><span class="ident" id="5709954">typ</span><span class="op" id="5709957">)</span><span class="op" id="5709958">.</span><span class="ident" id="5709959">Elem</span><span class="op" id="5709963">(</span><span class="op" id="5709964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709968">value</span><span class="op" id="5709973">.</span><span class="ident" id="5709974">SetFloat</span><span class="op" id="5709982">(</span><span class="ident" id="5709983">n</span><span class="op" id="5709984">.</span><span class="ident" id="5709985">Float64</span><span class="op" id="5709992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709996">return</span>&nbsp;<span class="ident" id="5710003">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710010">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710013">s</span><span class="op" id="5710014">.</span><span class="ident" id="5710015">errorf</span><span class="op" id="5710021">(</span><span class="string" id="5710022">&#34;expected&nbsp;float;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5710048">,</span>&nbsp;<span class="ident" id="5710050">n</span><span class="op" id="5710051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5710054">panic</span><span class="op" id="5710059">(</span><span class="string" id="5710060">&#34;not&nbsp;reached&#34;</span><span class="op" id="5710073">)</span><br>
<span class="lineno"></span><span class="op" id="5710075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5710078">func</span>&nbsp;<span class="op" id="5710083">(</span><span class="ident" id="5710084">s</span>&nbsp;<span class="op" id="5710086">*</span><span class="ident" id="5710087">state</span><span class="op" id="5710092">)</span>&nbsp;<span class="ident" id="5710094">evalComplex</span><span class="op" id="5710105">(</span><span class="ident" id="5710106">typ</span>&nbsp;<span class="ident" id="5710110">reflect</span><span class="op" id="5710117">.</span><span class="ident" id="5710118">Type</span><span class="op" id="5710122">,</span>&nbsp;<span class="ident" id="5710124">n</span>&nbsp;<span class="ident" id="5710126">parse</span><span class="op" id="5710131">.</span><span class="ident" id="5710132">Node</span><span class="op" id="5710136">)</span>&nbsp;<span class="ident" id="5710138">reflect</span><span class="op" id="5710145">.</span><span class="ident" id="5710146">Value</span>&nbsp;<span class="op" id="5710152">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710155">if</span>&nbsp;<span class="ident" id="5710158">n</span><span class="op" id="5710159">,</span>&nbsp;<span class="ident" id="5710161">ok</span>&nbsp;<span class="op" id="5710164">:=</span>&nbsp;<span class="ident" id="5710167">n</span><span class="op" id="5710168">.</span><span class="op" id="5710169">(</span><span class="op" id="5710170">*</span><span class="ident" id="5710171">parse</span><span class="op" id="5710176">.</span><span class="ident" id="5710177">NumberNode</span><span class="op" id="5710187">)</span><span class="op" id="5710188">;</span>&nbsp;<span class="ident" id="5710190">ok</span>&nbsp;<span class="op" id="5710193">&amp;&amp;</span>&nbsp;<span class="ident" id="5710196">n</span><span class="op" id="5710197">.</span><span class="ident" id="5710198">IsComplex</span>&nbsp;<span class="op" id="5710208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710212">value</span>&nbsp;<span class="op" id="5710218">:=</span>&nbsp;<span class="ident" id="5710221">reflect</span><span class="op" id="5710228">.</span><span class="ident" id="5710229">New</span><span class="op" id="5710232">(</span><span class="ident" id="5710233">typ</span><span class="op" id="5710236">)</span><span class="op" id="5710237">.</span><span class="ident" id="5710238">Elem</span><span class="op" id="5710242">(</span><span class="op" id="5710243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710247">value</span><span class="op" id="5710252">.</span><span class="ident" id="5710253">SetComplex</span><span class="op" id="5710263">(</span><span class="ident" id="5710264">n</span><span class="op" id="5710265">.</span><span class="ident" id="5710266">Complex128</span><span class="op" id="5710276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710280">return</span>&nbsp;<span class="ident" id="5710287">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710294">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710297">s</span><span class="op" id="5710298">.</span><span class="ident" id="5710299">errorf</span><span class="op" id="5710305">(</span><span class="string" id="5710306">&#34;expected&nbsp;complex;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="5710334">,</span>&nbsp;<span class="ident" id="5710336">n</span><span class="op" id="5710337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5710340">panic</span><span class="op" id="5710345">(</span><span class="string" id="5710346">&#34;not&nbsp;reached&#34;</span><span class="op" id="5710359">)</span><br>
<span class="lineno"></span><span class="op" id="5710361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5710364">func</span>&nbsp;<span class="op" id="5710369">(</span><span class="ident" id="5710370">s</span>&nbsp;<span class="op" id="5710372">*</span><span class="ident" id="5710373">state</span><span class="op" id="5710378">)</span>&nbsp;<span class="ident" id="5710380">evalEmptyInterface</span><span class="op" id="5710398">(</span><span class="ident" id="5710399">dot</span>&nbsp;<span class="ident" id="5710403">reflect</span><span class="op" id="5710410">.</span><span class="ident" id="5710411">Value</span><span class="op" id="5710416">,</span>&nbsp;<span class="ident" id="5710418">n</span>&nbsp;<span class="ident" id="5710420">parse</span><span class="op" id="5710425">.</span><span class="ident" id="5710426">Node</span><span class="op" id="5710430">)</span>&nbsp;<span class="ident" id="5710432">reflect</span><span class="op" id="5710439">.</span><span class="ident" id="5710440">Value</span>&nbsp;<span class="op" id="5710446">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710449">s</span><span class="op" id="5710450">.</span><span class="ident" id="5710451">at</span><span class="op" id="5710453">(</span><span class="ident" id="5710454">n</span><span class="op" id="5710455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710458">switch</span>&nbsp;<span class="ident" id="5710465">n</span>&nbsp;<span class="op" id="5710467">:=</span>&nbsp;<span class="ident" id="5710470">n</span><span class="op" id="5710471">.</span><span class="op" id="5710472">(</span><span class="keyword" id="5710473">type</span><span class="op" id="5710477">)</span>&nbsp;<span class="op" id="5710479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710482">case</span>&nbsp;<span class="op" id="5710487">*</span><span class="ident" id="5710488">parse</span><span class="op" id="5710493">.</span><span class="ident" id="5710494">BoolNode</span><span class="op" id="5710502">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710506">return</span>&nbsp;<span class="ident" id="5710513">reflect</span><span class="op" id="5710520">.</span><span class="ident" id="5710521">ValueOf</span><span class="op" id="5710528">(</span><span class="ident" id="5710529">n</span><span class="op" id="5710530">.</span><span class="ident" id="5710531">True</span><span class="op" id="5710535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710538">case</span>&nbsp;<span class="op" id="5710543">*</span><span class="ident" id="5710544">parse</span><span class="op" id="5710549">.</span><span class="ident" id="5710550">DotNode</span><span class="op" id="5710557">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710561">return</span>&nbsp;<span class="ident" id="5710568">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710573">case</span>&nbsp;<span class="op" id="5710578">*</span><span class="ident" id="5710579">parse</span><span class="op" id="5710584">.</span><span class="ident" id="5710585">FieldNode</span><span class="op" id="5710594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710598">return</span>&nbsp;<span class="ident" id="5710605">s</span><span class="op" id="5710606">.</span><span class="ident" id="5710607">evalFieldNode</span><span class="op" id="5710620">(</span><span class="ident" id="5710621">dot</span><span class="op" id="5710624">,</span>&nbsp;<span class="ident" id="5710626">n</span><span class="op" id="5710627">,</span>&nbsp;<span class="ident" id="5710629">nil</span><span class="op" id="5710632">,</span>&nbsp;<span class="ident" id="5710634">zero</span><span class="op" id="5710638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710641">case</span>&nbsp;<span class="op" id="5710646">*</span><span class="ident" id="5710647">parse</span><span class="op" id="5710652">.</span><span class="ident" id="5710653">IdentifierNode</span><span class="op" id="5710667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710671">return</span>&nbsp;<span class="ident" id="5710678">s</span><span class="op" id="5710679">.</span><span class="ident" id="5710680">evalFunction</span><span class="op" id="5710692">(</span><span class="ident" id="5710693">dot</span><span class="op" id="5710696">,</span>&nbsp;<span class="ident" id="5710698">n</span><span class="op" id="5710699">,</span>&nbsp;<span class="ident" id="5710701">n</span><span class="op" id="5710702">,</span>&nbsp;<span class="ident" id="5710704">nil</span><span class="op" id="5710707">,</span>&nbsp;<span class="ident" id="5710709">zero</span><span class="op" id="5710713">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710716">case</span>&nbsp;<span class="op" id="5710721">*</span><span class="ident" id="5710722">parse</span><span class="op" id="5710727">.</span><span class="ident" id="5710728">NilNode</span><span class="op" id="5710735">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5710739">//&nbsp;NilNode&nbsp;is&nbsp;handled&nbsp;in&nbsp;evalArg,&nbsp;the&nbsp;only&nbsp;place&nbsp;that&nbsp;calls&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710807">s</span><span class="op" id="5710808">.</span><span class="ident" id="5710809">errorf</span><span class="op" id="5710815">(</span><span class="string" id="5710816">&#34;evalEmptyInterface:&nbsp;nil&nbsp;(can&#39;t&nbsp;happen)&#34;</span><span class="op" id="5710856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710859">case</span>&nbsp;<span class="op" id="5710864">*</span><span class="ident" id="5710865">parse</span><span class="op" id="5710870">.</span><span class="ident" id="5710871">NumberNode</span><span class="op" id="5710881">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710885">return</span>&nbsp;<span class="ident" id="5710892">s</span><span class="op" id="5710893">.</span><span class="ident" id="5710894">idealConstant</span><span class="op" id="5710907">(</span><span class="ident" id="5710908">n</span><span class="op" id="5710909">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710912">case</span>&nbsp;<span class="op" id="5710917">*</span><span class="ident" id="5710918">parse</span><span class="op" id="5710923">.</span><span class="ident" id="5710924">StringNode</span><span class="op" id="5710934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710938">return</span>&nbsp;<span class="ident" id="5710945">reflect</span><span class="op" id="5710952">.</span><span class="ident" id="5710953">ValueOf</span><span class="op" id="5710960">(</span><span class="ident" id="5710961">n</span><span class="op" id="5710962">.</span><span class="ident" id="5710963">Text</span><span class="op" id="5710967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710970">case</span>&nbsp;<span class="op" id="5710975">*</span><span class="ident" id="5710976">parse</span><span class="op" id="5710981">.</span><span class="ident" id="5710982">VariableNode</span><span class="op" id="5710994">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710998">return</span>&nbsp;<span class="ident" id="5711005">s</span><span class="op" id="5711006">.</span><span class="ident" id="5711007">evalVariableNode</span><span class="op" id="5711023">(</span><span class="ident" id="5711024">dot</span><span class="op" id="5711027">,</span>&nbsp;<span class="ident" id="5711029">n</span><span class="op" id="5711030">,</span>&nbsp;<span class="ident" id="5711032">nil</span><span class="op" id="5711035">,</span>&nbsp;<span class="ident" id="5711037">zero</span><span class="op" id="5711041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711044">case</span>&nbsp;<span class="op" id="5711049">*</span><span class="ident" id="5711050">parse</span><span class="op" id="5711055">.</span><span class="ident" id="5711056">PipeNode</span><span class="op" id="5711064">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711068">return</span>&nbsp;<span class="ident" id="5711075">s</span><span class="op" id="5711076">.</span><span class="ident" id="5711077">evalPipeline</span><span class="op" id="5711089">(</span><span class="ident" id="5711090">dot</span><span class="op" id="5711093">,</span>&nbsp;<span class="ident" id="5711095">n</span><span class="op" id="5711096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711102">s</span><span class="op" id="5711103">.</span><span class="ident" id="5711104">errorf</span><span class="op" id="5711110">(</span><span class="string" id="5711111">&#34;can&#39;t&nbsp;handle&nbsp;assignment&nbsp;of&nbsp;%s&nbsp;to&nbsp;empty&nbsp;interface&nbsp;argument&#34;</span><span class="op" id="5711170">,</span>&nbsp;<span class="ident" id="5711172">n</span><span class="op" id="5711173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5711176">panic</span><span class="op" id="5711181">(</span><span class="string" id="5711182">&#34;not&nbsp;reached&#34;</span><span class="op" id="5711195">)</span><br>
<span class="lineno"></span><span class="op" id="5711197">}</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="comment" id="5711200">//&nbsp;indirect&nbsp;returns&nbsp;the&nbsp;item&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;indirection,&nbsp;and&nbsp;a&nbsp;bool&nbsp;to&nbsp;indicate&nbsp;if&nbsp;it&#39;s&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="5711292">//&nbsp;We&nbsp;indirect&nbsp;through&nbsp;pointers&nbsp;and&nbsp;empty&nbsp;interfaces&nbsp;(only)&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="5711360">//&nbsp;non-empty&nbsp;interfaces&nbsp;have&nbsp;methods&nbsp;we&nbsp;might&nbsp;need.</span><br>
<span class="lineno"></span><span class="keyword" id="5711412">func</span>&nbsp;<span class="ident" id="5711417">indirect</span><span class="op" id="5711425">(</span><span class="ident" id="5711426">v</span>&nbsp;<span class="ident" id="5711428">reflect</span><span class="op" id="5711435">.</span><span class="ident" id="5711436">Value</span><span class="op" id="5711441">)</span>&nbsp;<span class="op" id="5711443">(</span><span class="ident" id="5711444">rv</span>&nbsp;<span class="ident" id="5711447">reflect</span><span class="op" id="5711454">.</span><span class="ident" id="5711455">Value</span><span class="op" id="5711460">,</span>&nbsp;<span class="ident" id="5711462">isNil</span>&nbsp;<span class="builtintype" id="5711468">bool</span><span class="op" id="5711472">)</span>&nbsp;<span class="op" id="5711474">{</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711477">for</span>&nbsp;<span class="op" id="5711481">;</span>&nbsp;<span class="ident" id="5711483">v</span><span class="op" id="5711484">.</span><span class="ident" id="5711485">Kind</span><span class="op" id="5711489">(</span><span class="op" id="5711490">)</span>&nbsp;<span class="op" id="5711492">==</span>&nbsp;<span class="ident" id="5711495">reflect</span><span class="op" id="5711502">.</span><span class="ident" id="5711503">Ptr</span>&nbsp;<span class="op" id="5711507">||</span>&nbsp;<span class="ident" id="5711510">v</span><span class="op" id="5711511">.</span><span class="ident" id="5711512">Kind</span><span class="op" id="5711516">(</span><span class="op" id="5711517">)</span>&nbsp;<span class="op" id="5711519">==</span>&nbsp;<span class="ident" id="5711522">reflect</span><span class="op" id="5711529">.</span><span class="ident" id="5711530">Interface</span><span class="op" id="5711539">;</span>&nbsp;<span class="ident" id="5711541">v</span>&nbsp;<span class="op" id="5711543">=</span>&nbsp;<span class="ident" id="5711545">v</span><span class="op" id="5711546">.</span><span class="ident" id="5711547">Elem</span><span class="op" id="5711551">(</span><span class="op" id="5711552">)</span>&nbsp;<span class="op" id="5711554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711558">if</span>&nbsp;<span class="ident" id="5711561">v</span><span class="op" id="5711562">.</span><span class="ident" id="5711563">IsNil</span><span class="op" id="5711568">(</span><span class="op" id="5711569">)</span>&nbsp;<span class="op" id="5711571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711576">return</span>&nbsp;<span class="ident" id="5711583">v</span><span class="op" id="5711584">,</span>&nbsp;<span class="builtintype" id="5711586">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711597">if</span>&nbsp;<span class="ident" id="5711600">v</span><span class="op" id="5711601">.</span><span class="ident" id="5711602">Kind</span><span class="op" id="5711606">(</span><span class="op" id="5711607">)</span>&nbsp;<span class="op" id="5711609">==</span>&nbsp;<span class="ident" id="5711612">reflect</span><span class="op" id="5711619">.</span><span class="ident" id="5711620">Interface</span>&nbsp;<span class="op" id="5711630">&amp;&amp;</span>&nbsp;<span class="ident" id="5711633">v</span><span class="op" id="5711634">.</span><span class="ident" id="5711635">NumMethod</span><span class="op" id="5711644">(</span><span class="op" id="5711645">)</span>&nbsp;<span class="op" id="5711647">&gt;</span>&nbsp;<span class="num" id="5711649">0</span>&nbsp;<span class="op" id="5711651">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711656">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711670">return</span>&nbsp;<span class="ident" id="5711677">v</span><span class="op" id="5711678">,</span>&nbsp;<span class="builtintype" id="5711680">false</span><br>
<span class="lineno"></span><span class="op" id="5711686">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="comment" id="5711689">//&nbsp;printValue&nbsp;writes&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;output&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5711767">//&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5711784">func</span>&nbsp;<span class="op" id="5711789">(</span><span class="ident" id="5711790">s</span>&nbsp;<span class="op" id="5711792">*</span><span class="ident" id="5711793">state</span><span class="op" id="5711798">)</span>&nbsp;<span class="ident" id="5711800">printValue</span><span class="op" id="5711810">(</span><span class="ident" id="5711811">n</span>&nbsp;<span class="ident" id="5711813">parse</span><span class="op" id="5711818">.</span><span class="ident" id="5711819">Node</span><span class="op" id="5711823">,</span>&nbsp;<span class="ident" id="5711825">v</span>&nbsp;<span class="ident" id="5711827">reflect</span><span class="op" id="5711834">.</span><span class="ident" id="5711835">Value</span><span class="op" id="5711840">)</span>&nbsp;<span class="op" id="5711842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711845">s</span><span class="op" id="5711846">.</span><span class="ident" id="5711847">at</span><span class="op" id="5711849">(</span><span class="ident" id="5711850">n</span><span class="op" id="5711851">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711854">iface</span><span class="op" id="5711859">,</span>&nbsp;<span class="ident" id="5711861">ok</span>&nbsp;<span class="op" id="5711864">:=</span>&nbsp;<span class="ident" id="5711867">printableValue</span><span class="op" id="5711881">(</span><span class="ident" id="5711882">v</span><span class="op" id="5711883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711886">if</span>&nbsp;<span class="op" id="5711889">!</span><span class="ident" id="5711890">ok</span>&nbsp;<span class="op" id="5711893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711897">s</span><span class="op" id="5711898">.</span><span class="ident" id="5711899">errorf</span><span class="op" id="5711905">(</span><span class="string" id="5711906">&#34;can&#39;t&nbsp;print&nbsp;%s&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5711933">,</span>&nbsp;<span class="ident" id="5711935">n</span><span class="op" id="5711936">,</span>&nbsp;<span class="ident" id="5711938">v</span><span class="op" id="5711939">.</span><span class="ident" id="5711940">Type</span><span class="op" id="5711944">(</span><span class="op" id="5711945">)</span><span class="op" id="5711946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711952">fmt</span><span class="op" id="5711955">.</span><span class="ident" id="5711956">Fprint</span><span class="op" id="5711962">(</span><span class="ident" id="5711963">s</span><span class="op" id="5711964">.</span><span class="ident" id="5711965">wr</span><span class="op" id="5711967">,</span>&nbsp;<span class="ident" id="5711969">iface</span><span class="op" id="5711974">)</span><br>
<span class="lineno">780</span><span class="op" id="5711976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5711979">//&nbsp;printableValue&nbsp;returns&nbsp;the,&nbsp;possibly&nbsp;indirected,&nbsp;interface&nbsp;value&nbsp;inside&nbsp;v&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5712061">//&nbsp;is&nbsp;best&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;formatted&nbsp;printer.</span><br>
<span class="lineno"></span><span class="keyword" id="5712105">func</span>&nbsp;<span class="ident" id="5712110">printableValue</span><span class="op" id="5712124">(</span><span class="ident" id="5712125">v</span>&nbsp;<span class="ident" id="5712127">reflect</span><span class="op" id="5712134">.</span><span class="ident" id="5712135">Value</span><span class="op" id="5712140">)</span>&nbsp;<span class="op" id="5712142">(</span><span class="keyword" id="5712143">interface</span><span class="op" id="5712152">{</span><span class="op" id="5712153">}</span><span class="op" id="5712154">,</span>&nbsp;<span class="builtintype" id="5712156">bool</span><span class="op" id="5712160">)</span>&nbsp;<span class="op" id="5712162">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712165">if</span>&nbsp;<span class="ident" id="5712168">v</span><span class="op" id="5712169">.</span><span class="ident" id="5712170">Kind</span><span class="op" id="5712174">(</span><span class="op" id="5712175">)</span>&nbsp;<span class="op" id="5712177">==</span>&nbsp;<span class="ident" id="5712180">reflect</span><span class="op" id="5712187">.</span><span class="ident" id="5712188">Ptr</span>&nbsp;<span class="op" id="5712192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712196">v</span><span class="op" id="5712197">,</span>&nbsp;<span class="ident" id="5712199">_</span>&nbsp;<span class="op" id="5712201">=</span>&nbsp;<span class="ident" id="5712203">indirect</span><span class="op" id="5712211">(</span><span class="ident" id="5712212">v</span><span class="op" id="5712213">)</span>&nbsp;<span class="comment" id="5712215">//&nbsp;fmt.Fprint&nbsp;handles&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712246">if</span>&nbsp;<span class="op" id="5712249">!</span><span class="ident" id="5712250">v</span><span class="op" id="5712251">.</span><span class="ident" id="5712252">IsValid</span><span class="op" id="5712259">(</span><span class="op" id="5712260">)</span>&nbsp;<span class="op" id="5712262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712266">return</span>&nbsp;<span class="string" id="5712273">&#34;&lt;no&nbsp;value&gt;&#34;</span><span class="op" id="5712285">,</span>&nbsp;<span class="builtintype" id="5712287">true</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712297">if</span>&nbsp;<span class="op" id="5712300">!</span><span class="ident" id="5712301">v</span><span class="op" id="5712302">.</span><span class="ident" id="5712303">Type</span><span class="op" id="5712307">(</span><span class="op" id="5712308">)</span><span class="op" id="5712309">.</span><span class="ident" id="5712310">Implements</span><span class="op" id="5712320">(</span><span class="ident" id="5712321">errorType</span><span class="op" id="5712330">)</span>&nbsp;<span class="op" id="5712332">&amp;&amp;</span>&nbsp;<span class="op" id="5712335">!</span><span class="ident" id="5712336">v</span><span class="op" id="5712337">.</span><span class="ident" id="5712338">Type</span><span class="op" id="5712342">(</span><span class="op" id="5712343">)</span><span class="op" id="5712344">.</span><span class="ident" id="5712345">Implements</span><span class="op" id="5712355">(</span><span class="ident" id="5712356">fmtStringerType</span><span class="op" id="5712371">)</span>&nbsp;<span class="op" id="5712373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712377">if</span>&nbsp;<span class="ident" id="5712380">v</span><span class="op" id="5712381">.</span><span class="ident" id="5712382">CanAddr</span><span class="op" id="5712389">(</span><span class="op" id="5712390">)</span>&nbsp;<span class="op" id="5712392">&amp;&amp;</span>&nbsp;<span class="op" id="5712395">(</span><span class="ident" id="5712396">reflect</span><span class="op" id="5712403">.</span><span class="ident" id="5712404">PtrTo</span><span class="op" id="5712409">(</span><span class="ident" id="5712410">v</span><span class="op" id="5712411">.</span><span class="ident" id="5712412">Type</span><span class="op" id="5712416">(</span><span class="op" id="5712417">)</span><span class="op" id="5712418">)</span><span class="op" id="5712419">.</span><span class="ident" id="5712420">Implements</span><span class="op" id="5712430">(</span><span class="ident" id="5712431">errorType</span><span class="op" id="5712440">)</span>&nbsp;<span class="op" id="5712442">||</span>&nbsp;<span class="ident" id="5712445">reflect</span><span class="op" id="5712452">.</span><span class="ident" id="5712453">PtrTo</span><span class="op" id="5712458">(</span><span class="ident" id="5712459">v</span><span class="op" id="5712460">.</span><span class="ident" id="5712461">Type</span><span class="op" id="5712465">(</span><span class="op" id="5712466">)</span><span class="op" id="5712467">)</span><span class="op" id="5712468">.</span><span class="ident" id="5712469">Implements</span><span class="op" id="5712479">(</span><span class="ident" id="5712480">fmtStringerType</span><span class="op" id="5712495">)</span><span class="op" id="5712496">)</span>&nbsp;<span class="op" id="5712498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712503">v</span>&nbsp;<span class="op" id="5712505">=</span>&nbsp;<span class="ident" id="5712507">v</span><span class="op" id="5712508">.</span><span class="ident" id="5712509">Addr</span><span class="op" id="5712513">(</span><span class="op" id="5712514">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712518">}</span>&nbsp;<span class="keyword" id="5712520">else</span>&nbsp;<span class="op" id="5712525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712530">switch</span>&nbsp;<span class="ident" id="5712537">v</span><span class="op" id="5712538">.</span><span class="ident" id="5712539">Kind</span><span class="op" id="5712543">(</span><span class="op" id="5712544">)</span>&nbsp;<span class="op" id="5712546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712551">case</span>&nbsp;<span class="ident" id="5712556">reflect</span><span class="op" id="5712563">.</span><span class="ident" id="5712564">Chan</span><span class="op" id="5712568">,</span>&nbsp;<span class="ident" id="5712570">reflect</span><span class="op" id="5712577">.</span><span class="ident" id="5712578">Func</span><span class="op" id="5712582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712588">return</span>&nbsp;<span class="ident" id="5712595">nil</span><span class="op" id="5712598">,</span>&nbsp;<span class="builtintype" id="5712600">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712609">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712619">return</span>&nbsp;<span class="ident" id="5712626">v</span><span class="op" id="5712627">.</span><span class="ident" id="5712628">Interface</span><span class="op" id="5712637">(</span><span class="op" id="5712638">)</span><span class="op" id="5712639">,</span>&nbsp;<span class="builtintype" id="5712641">true</span><br>
<span class="lineno"></span><span class="op" id="5712646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="comment" id="5712649">//&nbsp;Types&nbsp;to&nbsp;help&nbsp;sort&nbsp;the&nbsp;keys&nbsp;in&nbsp;a&nbsp;map&nbsp;for&nbsp;reproducible&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5712715">type</span>&nbsp;<span class="ident" id="5712720">rvs</span>&nbsp;<span class="op" id="5712724">[</span><span class="op" id="5712725">]</span><span class="ident" id="5712726">reflect</span><span class="op" id="5712733">.</span><span class="ident" id="5712734">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5712741">func</span>&nbsp;<span class="op" id="5712746">(</span><span class="ident" id="5712747">x</span>&nbsp;<span class="ident" id="5712749">rvs</span><span class="op" id="5712752">)</span>&nbsp;<span class="ident" id="5712754">Len</span><span class="op" id="5712757">(</span><span class="op" id="5712758">)</span>&nbsp;<span class="builtintype" id="5712760">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5712769">{</span>&nbsp;<span class="keyword" id="5712771">return</span>&nbsp;<span class="builtinfunc" id="5712778">len</span><span class="op" id="5712781">(</span><span class="ident" id="5712782">x</span><span class="op" id="5712783">)</span>&nbsp;<span class="op" id="5712785">}</span><br>
<span class="lineno">810</span><span class="keyword" id="5712787">func</span>&nbsp;<span class="op" id="5712792">(</span><span class="ident" id="5712793">x</span>&nbsp;<span class="ident" id="5712795">rvs</span><span class="op" id="5712798">)</span>&nbsp;<span class="ident" id="5712800">Swap</span><span class="op" id="5712804">(</span><span class="ident" id="5712805">i</span><span class="op" id="5712806">,</span>&nbsp;<span class="ident" id="5712808">j</span>&nbsp;<span class="builtintype" id="5712810">int</span><span class="op" id="5712813">)</span>&nbsp;<span class="op" id="5712815">{</span>&nbsp;<span class="ident" id="5712817">x</span><span class="op" id="5712818">[</span><span class="ident" id="5712819">i</span><span class="op" id="5712820">]</span><span class="op" id="5712821">,</span>&nbsp;<span class="ident" id="5712823">x</span><span class="op" id="5712824">[</span><span class="ident" id="5712825">j</span><span class="op" id="5712826">]</span>&nbsp;<span class="op" id="5712828">=</span>&nbsp;<span class="ident" id="5712830">x</span><span class="op" id="5712831">[</span><span class="ident" id="5712832">j</span><span class="op" id="5712833">]</span><span class="op" id="5712834">,</span>&nbsp;<span class="ident" id="5712836">x</span><span class="op" id="5712837">[</span><span class="ident" id="5712838">i</span><span class="op" id="5712839">]</span>&nbsp;<span class="op" id="5712841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5712844">type</span>&nbsp;<span class="ident" id="5712849">rvInts</span>&nbsp;<span class="keyword" id="5712856">struct</span><span class="op" id="5712862">{</span>&nbsp;<span class="ident" id="5712864">rvs</span>&nbsp;<span class="op" id="5712868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5712871">func</span>&nbsp;<span class="op" id="5712876">(</span><span class="ident" id="5712877">x</span>&nbsp;<span class="ident" id="5712879">rvInts</span><span class="op" id="5712885">)</span>&nbsp;<span class="ident" id="5712887">Less</span><span class="op" id="5712891">(</span><span class="ident" id="5712892">i</span><span class="op" id="5712893">,</span>&nbsp;<span class="ident" id="5712895">j</span>&nbsp;<span class="builtintype" id="5712897">int</span><span class="op" id="5712900">)</span>&nbsp;<span class="builtintype" id="5712902">bool</span>&nbsp;<span class="op" id="5712907">{</span>&nbsp;<span class="keyword" id="5712909">return</span>&nbsp;<span class="ident" id="5712916">x</span><span class="op" id="5712917">.</span><span class="ident" id="5712918">rvs</span><span class="op" id="5712921">[</span><span class="ident" id="5712922">i</span><span class="op" id="5712923">]</span><span class="op" id="5712924">.</span><span class="ident" id="5712925">Int</span><span class="op" id="5712928">(</span><span class="op" id="5712929">)</span>&nbsp;<span class="op" id="5712931">&lt;</span>&nbsp;<span class="ident" id="5712933">x</span><span class="op" id="5712934">.</span><span class="ident" id="5712935">rvs</span><span class="op" id="5712938">[</span><span class="ident" id="5712939">j</span><span class="op" id="5712940">]</span><span class="op" id="5712941">.</span><span class="ident" id="5712942">Int</span><span class="op" id="5712945">(</span><span class="op" id="5712946">)</span>&nbsp;<span class="op" id="5712948">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="keyword" id="5712951">type</span>&nbsp;<span class="ident" id="5712956">rvUints</span>&nbsp;<span class="keyword" id="5712964">struct</span><span class="op" id="5712970">{</span>&nbsp;<span class="ident" id="5712972">rvs</span>&nbsp;<span class="op" id="5712976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5712979">func</span>&nbsp;<span class="op" id="5712984">(</span><span class="ident" id="5712985">x</span>&nbsp;<span class="ident" id="5712987">rvUints</span><span class="op" id="5712994">)</span>&nbsp;<span class="ident" id="5712996">Less</span><span class="op" id="5713000">(</span><span class="ident" id="5713001">i</span><span class="op" id="5713002">,</span>&nbsp;<span class="ident" id="5713004">j</span>&nbsp;<span class="builtintype" id="5713006">int</span><span class="op" id="5713009">)</span>&nbsp;<span class="builtintype" id="5713011">bool</span>&nbsp;<span class="op" id="5713016">{</span>&nbsp;<span class="keyword" id="5713018">return</span>&nbsp;<span class="ident" id="5713025">x</span><span class="op" id="5713026">.</span><span class="ident" id="5713027">rvs</span><span class="op" id="5713030">[</span><span class="ident" id="5713031">i</span><span class="op" id="5713032">]</span><span class="op" id="5713033">.</span><span class="ident" id="5713034">Uint</span><span class="op" id="5713038">(</span><span class="op" id="5713039">)</span>&nbsp;<span class="op" id="5713041">&lt;</span>&nbsp;<span class="ident" id="5713043">x</span><span class="op" id="5713044">.</span><span class="ident" id="5713045">rvs</span><span class="op" id="5713048">[</span><span class="ident" id="5713049">j</span><span class="op" id="5713050">]</span><span class="op" id="5713051">.</span><span class="ident" id="5713052">Uint</span><span class="op" id="5713056">(</span><span class="op" id="5713057">)</span>&nbsp;<span class="op" id="5713059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span><span class="keyword" id="5713062">type</span>&nbsp;<span class="ident" id="5713067">rvFloats</span>&nbsp;<span class="keyword" id="5713076">struct</span><span class="op" id="5713082">{</span>&nbsp;<span class="ident" id="5713084">rvs</span>&nbsp;<span class="op" id="5713088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5713091">func</span>&nbsp;<span class="op" id="5713096">(</span><span class="ident" id="5713097">x</span>&nbsp;<span class="ident" id="5713099">rvFloats</span><span class="op" id="5713107">)</span>&nbsp;<span class="ident" id="5713109">Less</span><span class="op" id="5713113">(</span><span class="ident" id="5713114">i</span><span class="op" id="5713115">,</span>&nbsp;<span class="ident" id="5713117">j</span>&nbsp;<span class="builtintype" id="5713119">int</span><span class="op" id="5713122">)</span>&nbsp;<span class="builtintype" id="5713124">bool</span>&nbsp;<span class="op" id="5713129">{</span>&nbsp;<span class="keyword" id="5713131">return</span>&nbsp;<span class="ident" id="5713138">x</span><span class="op" id="5713139">.</span><span class="ident" id="5713140">rvs</span><span class="op" id="5713143">[</span><span class="ident" id="5713144">i</span><span class="op" id="5713145">]</span><span class="op" id="5713146">.</span><span class="ident" id="5713147">Float</span><span class="op" id="5713152">(</span><span class="op" id="5713153">)</span>&nbsp;<span class="op" id="5713155">&lt;</span>&nbsp;<span class="ident" id="5713157">x</span><span class="op" id="5713158">.</span><span class="ident" id="5713159">rvs</span><span class="op" id="5713162">[</span><span class="ident" id="5713163">j</span><span class="op" id="5713164">]</span><span class="op" id="5713165">.</span><span class="ident" id="5713166">Float</span><span class="op" id="5713171">(</span><span class="op" id="5713172">)</span>&nbsp;<span class="op" id="5713174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5713177">type</span>&nbsp;<span class="ident" id="5713182">rvStrings</span>&nbsp;<span class="keyword" id="5713192">struct</span><span class="op" id="5713198">{</span>&nbsp;<span class="ident" id="5713200">rvs</span>&nbsp;<span class="op" id="5713204">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span><span class="keyword" id="5713207">func</span>&nbsp;<span class="op" id="5713212">(</span><span class="ident" id="5713213">x</span>&nbsp;<span class="ident" id="5713215">rvStrings</span><span class="op" id="5713224">)</span>&nbsp;<span class="ident" id="5713226">Less</span><span class="op" id="5713230">(</span><span class="ident" id="5713231">i</span><span class="op" id="5713232">,</span>&nbsp;<span class="ident" id="5713234">j</span>&nbsp;<span class="builtintype" id="5713236">int</span><span class="op" id="5713239">)</span>&nbsp;<span class="builtintype" id="5713241">bool</span>&nbsp;<span class="op" id="5713246">{</span>&nbsp;<span class="keyword" id="5713248">return</span>&nbsp;<span class="ident" id="5713255">x</span><span class="op" id="5713256">.</span><span class="ident" id="5713257">rvs</span><span class="op" id="5713260">[</span><span class="ident" id="5713261">i</span><span class="op" id="5713262">]</span><span class="op" id="5713263">.</span><span class="ident" id="5713264">String</span><span class="op" id="5713270">(</span><span class="op" id="5713271">)</span>&nbsp;<span class="op" id="5713273">&lt;</span>&nbsp;<span class="ident" id="5713275">x</span><span class="op" id="5713276">.</span><span class="ident" id="5713277">rvs</span><span class="op" id="5713280">[</span><span class="ident" id="5713281">j</span><span class="op" id="5713282">]</span><span class="op" id="5713283">.</span><span class="ident" id="5713284">String</span><span class="op" id="5713290">(</span><span class="op" id="5713291">)</span>&nbsp;<span class="op" id="5713293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5713296">//&nbsp;sortKeys&nbsp;sorts&nbsp;(if&nbsp;it&nbsp;can)&nbsp;the&nbsp;slice&nbsp;of&nbsp;reflect.Values,&nbsp;which&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="keyword" id="5713385">func</span>&nbsp;<span class="ident" id="5713390">sortKeys</span><span class="op" id="5713398">(</span><span class="ident" id="5713399">v</span>&nbsp;<span class="op" id="5713401">[</span><span class="op" id="5713402">]</span><span class="ident" id="5713403">reflect</span><span class="op" id="5713410">.</span><span class="ident" id="5713411">Value</span><span class="op" id="5713416">)</span>&nbsp;<span class="op" id="5713418">[</span><span class="op" id="5713419">]</span><span class="ident" id="5713420">reflect</span><span class="op" id="5713427">.</span><span class="ident" id="5713428">Value</span>&nbsp;<span class="op" id="5713434">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713437">if</span>&nbsp;<span class="builtinfunc" id="5713440">len</span><span class="op" id="5713443">(</span><span class="ident" id="5713444">v</span><span class="op" id="5713445">)</span>&nbsp;<span class="op" id="5713447">&lt;=</span>&nbsp;<span class="num" id="5713450">1</span>&nbsp;<span class="op" id="5713452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713456">return</span>&nbsp;<span class="ident" id="5713463">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713469">switch</span>&nbsp;<span class="ident" id="5713476">v</span><span class="op" id="5713477">[</span><span class="num" id="5713478">0</span><span class="op" id="5713479">]</span><span class="op" id="5713480">.</span><span class="ident" id="5713481">Kind</span><span class="op" id="5713485">(</span><span class="op" id="5713486">)</span>&nbsp;<span class="op" id="5713488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713491">case</span>&nbsp;<span class="ident" id="5713496">reflect</span><span class="op" id="5713503">.</span><span class="ident" id="5713504">Float32</span><span class="op" id="5713511">,</span>&nbsp;<span class="ident" id="5713513">reflect</span><span class="op" id="5713520">.</span><span class="ident" id="5713521">Float64</span><span class="op" id="5713528">:</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713532">sort</span><span class="op" id="5713536">.</span><span class="ident" id="5713537">Sort</span><span class="op" id="5713541">(</span><span class="ident" id="5713542">rvFloats</span><span class="op" id="5713550">{</span><span class="ident" id="5713551">v</span><span class="op" id="5713552">}</span><span class="op" id="5713553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713556">case</span>&nbsp;<span class="ident" id="5713561">reflect</span><span class="op" id="5713568">.</span><span class="ident" id="5713569">Int</span><span class="op" id="5713572">,</span>&nbsp;<span class="ident" id="5713574">reflect</span><span class="op" id="5713581">.</span><span class="ident" id="5713582">Int8</span><span class="op" id="5713586">,</span>&nbsp;<span class="ident" id="5713588">reflect</span><span class="op" id="5713595">.</span><span class="ident" id="5713596">Int16</span><span class="op" id="5713601">,</span>&nbsp;<span class="ident" id="5713603">reflect</span><span class="op" id="5713610">.</span><span class="ident" id="5713611">Int32</span><span class="op" id="5713616">,</span>&nbsp;<span class="ident" id="5713618">reflect</span><span class="op" id="5713625">.</span><span class="ident" id="5713626">Int64</span><span class="op" id="5713631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713635">sort</span><span class="op" id="5713639">.</span><span class="ident" id="5713640">Sort</span><span class="op" id="5713644">(</span><span class="ident" id="5713645">rvInts</span><span class="op" id="5713651">{</span><span class="ident" id="5713652">v</span><span class="op" id="5713653">}</span><span class="op" id="5713654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713657">case</span>&nbsp;<span class="ident" id="5713662">reflect</span><span class="op" id="5713669">.</span><span class="ident" id="5713670">String</span><span class="op" id="5713676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713680">sort</span><span class="op" id="5713684">.</span><span class="ident" id="5713685">Sort</span><span class="op" id="5713689">(</span><span class="ident" id="5713690">rvStrings</span><span class="op" id="5713699">{</span><span class="ident" id="5713700">v</span><span class="op" id="5713701">}</span><span class="op" id="5713702">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713705">case</span>&nbsp;<span class="ident" id="5713710">reflect</span><span class="op" id="5713717">.</span><span class="ident" id="5713718">Uint</span><span class="op" id="5713722">,</span>&nbsp;<span class="ident" id="5713724">reflect</span><span class="op" id="5713731">.</span><span class="ident" id="5713732">Uint8</span><span class="op" id="5713737">,</span>&nbsp;<span class="ident" id="5713739">reflect</span><span class="op" id="5713746">.</span><span class="ident" id="5713747">Uint16</span><span class="op" id="5713753">,</span>&nbsp;<span class="ident" id="5713755">reflect</span><span class="op" id="5713762">.</span><span class="ident" id="5713763">Uint32</span><span class="op" id="5713769">,</span>&nbsp;<span class="ident" id="5713771">reflect</span><span class="op" id="5713778">.</span><span class="ident" id="5713779">Uint64</span><span class="op" id="5713785">,</span>&nbsp;<span class="ident" id="5713787">reflect</span><span class="op" id="5713794">.</span><span class="ident" id="5713795">Uintptr</span><span class="op" id="5713802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713806">sort</span><span class="op" id="5713810">.</span><span class="ident" id="5713811">Sort</span><span class="op" id="5713815">(</span><span class="ident" id="5713816">rvUints</span><span class="op" id="5713823">{</span><span class="ident" id="5713824">v</span><span class="op" id="5713825">}</span><span class="op" id="5713826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713832">return</span>&nbsp;<span class="ident" id="5713839">v</span><br>
<span class="lineno"></span><span class="op" id="5713841">}</span>
</div>
</body>
</html>
