<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6237945">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6238000">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6238054">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6238105">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="6238176">package</span>&nbsp;<span class="ident" id="6238184">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6238192">import</span>&nbsp;<span class="op" id="6238199">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238202">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238211">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238217">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238228">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="6238238">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6238241">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6238262">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6238330">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="6238398">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="6238458">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="6238515">type</span>&nbsp;<span class="ident" id="6238520">Encoding</span>&nbsp;<span class="keyword" id="6238529">struct</span>&nbsp;<span class="op" id="6238536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238539">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6238549">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238557">decodeMap</span>&nbsp;<span class="op" id="6238567">[</span><span class="num" id="6238568">256</span><span class="op" id="6238571">]</span><span class="builtintype" id="6238572">byte</span><br>
<span class="lineno"></span><span class="op" id="6238577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6238580">const</span>&nbsp;<span class="ident" id="6238586">encodeStd</span>&nbsp;<span class="op" id="6238596">=</span>&nbsp;<span class="string" id="6238598">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="6238633">const</span>&nbsp;<span class="ident" id="6238639">encodeHex</span>&nbsp;<span class="op" id="6238649">=</span>&nbsp;<span class="string" id="6238651">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6238687">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="6238756">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="6238791">func</span>&nbsp;<span class="ident" id="6238796">NewEncoding</span><span class="op" id="6238807">(</span><span class="ident" id="6238808">encoder</span>&nbsp;<span class="builtintype" id="6238816">string</span><span class="op" id="6238822">)</span>&nbsp;<span class="op" id="6238824">*</span><span class="ident" id="6238825">Encoding</span>&nbsp;<span class="op" id="6238834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238837">e</span>&nbsp;<span class="op" id="6238839">:=</span>&nbsp;<span class="builtinfunc" id="6238842">new</span><span class="op" id="6238845">(</span><span class="ident" id="6238846">Encoding</span><span class="op" id="6238854">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238857">e</span><span class="op" id="6238858">.</span><span class="ident" id="6238859">encode</span>&nbsp;<span class="op" id="6238866">=</span>&nbsp;<span class="ident" id="6238868">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238877">for</span>&nbsp;<span class="ident" id="6238881">i</span>&nbsp;<span class="op" id="6238883">:=</span>&nbsp;<span class="num" id="6238886">0</span><span class="op" id="6238887">;</span>&nbsp;<span class="ident" id="6238889">i</span>&nbsp;<span class="op" id="6238891">&lt;</span>&nbsp;<span class="builtinfunc" id="6238893">len</span><span class="op" id="6238896">(</span><span class="ident" id="6238897">e</span><span class="op" id="6238898">.</span><span class="ident" id="6238899">decodeMap</span><span class="op" id="6238908">)</span><span class="op" id="6238909">;</span>&nbsp;<span class="ident" id="6238911">i</span><span class="op" id="6238912">++</span>&nbsp;<span class="op" id="6238915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238919">e</span><span class="op" id="6238920">.</span><span class="ident" id="6238921">decodeMap</span><span class="op" id="6238930">[</span><span class="ident" id="6238931">i</span><span class="op" id="6238932">]</span>&nbsp;<span class="op" id="6238934">=</span>&nbsp;<span class="num" id="6238936">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6238942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238945">for</span>&nbsp;<span class="ident" id="6238949">i</span>&nbsp;<span class="op" id="6238951">:=</span>&nbsp;<span class="num" id="6238954">0</span><span class="op" id="6238955">;</span>&nbsp;<span class="ident" id="6238957">i</span>&nbsp;<span class="op" id="6238959">&lt;</span>&nbsp;<span class="builtinfunc" id="6238961">len</span><span class="op" id="6238964">(</span><span class="ident" id="6238965">encoder</span><span class="op" id="6238972">)</span><span class="op" id="6238973">;</span>&nbsp;<span class="ident" id="6238975">i</span><span class="op" id="6238976">++</span>&nbsp;<span class="op" id="6238979">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238983">e</span><span class="op" id="6238984">.</span><span class="ident" id="6238985">decodeMap</span><span class="op" id="6238994">[</span><span class="ident" id="6238995">encoder</span><span class="op" id="6239002">[</span><span class="ident" id="6239003">i</span><span class="op" id="6239004">]</span><span class="op" id="6239005">]</span>&nbsp;<span class="op" id="6239007">=</span>&nbsp;<span class="builtintype" id="6239009">byte</span><span class="op" id="6239013">(</span><span class="ident" id="6239014">i</span><span class="op" id="6239015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6239018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239021">return</span>&nbsp;<span class="ident" id="6239028">e</span><br>
<span class="lineno"></span><span class="op" id="6239030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="6239033">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6239095">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="6239108">var</span>&nbsp;<span class="ident" id="6239112">StdEncoding</span>&nbsp;<span class="op" id="6239124">=</span>&nbsp;<span class="ident" id="6239126">NewEncoding</span><span class="op" id="6239137">(</span><span class="ident" id="6239138">encodeStd</span><span class="op" id="6239147">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6239150">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="6239219">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="6239251">var</span>&nbsp;<span class="ident" id="6239255">HexEncoding</span>&nbsp;<span class="op" id="6239267">=</span>&nbsp;<span class="ident" id="6239269">NewEncoding</span><span class="op" id="6239280">(</span><span class="ident" id="6239281">encodeHex</span><span class="op" id="6239290">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6239293">var</span>&nbsp;<span class="ident" id="6239297">removeNewlinesMapper</span>&nbsp;<span class="op" id="6239318">=</span>&nbsp;<span class="keyword" id="6239320">func</span><span class="op" id="6239324">(</span><span class="ident" id="6239325">r</span>&nbsp;<span class="builtintype" id="6239327">rune</span><span class="op" id="6239331">)</span>&nbsp;<span class="builtintype" id="6239333">rune</span>&nbsp;<span class="op" id="6239338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239341">if</span>&nbsp;<span class="ident" id="6239344">r</span>&nbsp;<span class="op" id="6239346">==</span>&nbsp;<span class="string" id="6239349">&#39;\r&#39;</span>&nbsp;<span class="op" id="6239354">||</span>&nbsp;<span class="ident" id="6239357">r</span>&nbsp;<span class="op" id="6239359">==</span>&nbsp;<span class="string" id="6239362">&#39;\n&#39;</span>&nbsp;<span class="op" id="6239367">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239371">return</span>&nbsp;<span class="op" id="6239378">-</span><span class="num" id="6239379">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6239382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239385">return</span>&nbsp;<span class="ident" id="6239392">r</span><br>
<span class="lineno"></span><span class="op" id="6239394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="6239397">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6239416">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="6239470">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="6239508">//</span><br>
<span class="lineno"></span><span class="comment" id="6239511">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="6239569">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="6239630">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="6239684">func</span>&nbsp;<span class="op" id="6239689">(</span><span class="ident" id="6239690">enc</span>&nbsp;<span class="op" id="6239694">*</span><span class="ident" id="6239695">Encoding</span><span class="op" id="6239703">)</span>&nbsp;<span class="ident" id="6239705">Encode</span><span class="op" id="6239711">(</span><span class="ident" id="6239712">dst</span><span class="op" id="6239715">,</span>&nbsp;<span class="ident" id="6239717">src</span>&nbsp;<span class="op" id="6239721">[</span><span class="op" id="6239722">]</span><span class="builtintype" id="6239723">byte</span><span class="op" id="6239727">)</span>&nbsp;<span class="op" id="6239729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239732">if</span>&nbsp;<span class="builtinfunc" id="6239735">len</span><span class="op" id="6239738">(</span><span class="ident" id="6239739">src</span><span class="op" id="6239742">)</span>&nbsp;<span class="op" id="6239744">==</span>&nbsp;<span class="num" id="6239747">0</span>&nbsp;<span class="op" id="6239749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239753">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6239761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239765">for</span>&nbsp;<span class="builtinfunc" id="6239769">len</span><span class="op" id="6239772">(</span><span class="ident" id="6239773">src</span><span class="op" id="6239776">)</span>&nbsp;<span class="op" id="6239778">&gt;</span>&nbsp;<span class="num" id="6239780">0</span>&nbsp;<span class="op" id="6239782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239786">var</span>&nbsp;<span class="ident" id="6239790">b0</span><span class="op" id="6239792">,</span>&nbsp;<span class="ident" id="6239794">b1</span><span class="op" id="6239796">,</span>&nbsp;<span class="ident" id="6239798">b2</span><span class="op" id="6239800">,</span>&nbsp;<span class="ident" id="6239802">b3</span><span class="op" id="6239804">,</span>&nbsp;<span class="ident" id="6239806">b4</span><span class="op" id="6239808">,</span>&nbsp;<span class="ident" id="6239810">b5</span><span class="op" id="6239812">,</span>&nbsp;<span class="ident" id="6239814">b6</span><span class="op" id="6239816">,</span>&nbsp;<span class="ident" id="6239818">b7</span>&nbsp;<span class="builtintype" id="6239821">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239829">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239878">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239903">switch</span>&nbsp;<span class="builtinfunc" id="6239910">len</span><span class="op" id="6239913">(</span><span class="ident" id="6239914">src</span><span class="op" id="6239917">)</span>&nbsp;<span class="op" id="6239919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239923">default</span><span class="op" id="6239930">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239935">b7</span>&nbsp;<span class="op" id="6239938">=</span>&nbsp;<span class="ident" id="6239940">src</span><span class="op" id="6239943">[</span><span class="num" id="6239944">4</span><span class="op" id="6239945">]</span>&nbsp;<span class="op" id="6239947">&amp;</span>&nbsp;<span class="num" id="6239949">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239957">b6</span>&nbsp;<span class="op" id="6239960">=</span>&nbsp;<span class="ident" id="6239962">src</span><span class="op" id="6239965">[</span><span class="num" id="6239966">4</span><span class="op" id="6239967">]</span>&nbsp;<span class="op" id="6239969">&gt;&gt;</span>&nbsp;<span class="num" id="6239972">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239977">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239991">case</span>&nbsp;<span class="num" id="6239996">4</span><span class="op" id="6239997">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240002">b6</span>&nbsp;<span class="op" id="6240005">|=</span>&nbsp;<span class="op" id="6240008">(</span><span class="ident" id="6240009">src</span><span class="op" id="6240012">[</span><span class="num" id="6240013">3</span><span class="op" id="6240014">]</span>&nbsp;<span class="op" id="6240016">&lt;&lt;</span>&nbsp;<span class="num" id="6240019">3</span><span class="op" id="6240020">)</span>&nbsp;<span class="op" id="6240022">&amp;</span>&nbsp;<span class="num" id="6240024">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240032">b5</span>&nbsp;<span class="op" id="6240035">=</span>&nbsp;<span class="op" id="6240037">(</span><span class="ident" id="6240038">src</span><span class="op" id="6240041">[</span><span class="num" id="6240042">3</span><span class="op" id="6240043">]</span>&nbsp;<span class="op" id="6240045">&gt;&gt;</span>&nbsp;<span class="num" id="6240048">2</span><span class="op" id="6240049">)</span>&nbsp;<span class="op" id="6240051">&amp;</span>&nbsp;<span class="num" id="6240053">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240061">b4</span>&nbsp;<span class="op" id="6240064">=</span>&nbsp;<span class="ident" id="6240066">src</span><span class="op" id="6240069">[</span><span class="num" id="6240070">3</span><span class="op" id="6240071">]</span>&nbsp;<span class="op" id="6240073">&gt;&gt;</span>&nbsp;<span class="num" id="6240076">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240081">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240095">case</span>&nbsp;<span class="num" id="6240100">3</span><span class="op" id="6240101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240106">b4</span>&nbsp;<span class="op" id="6240109">|=</span>&nbsp;<span class="op" id="6240112">(</span><span class="ident" id="6240113">src</span><span class="op" id="6240116">[</span><span class="num" id="6240117">2</span><span class="op" id="6240118">]</span>&nbsp;<span class="op" id="6240120">&lt;&lt;</span>&nbsp;<span class="num" id="6240123">1</span><span class="op" id="6240124">)</span>&nbsp;<span class="op" id="6240126">&amp;</span>&nbsp;<span class="num" id="6240128">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240136">b3</span>&nbsp;<span class="op" id="6240139">=</span>&nbsp;<span class="op" id="6240141">(</span><span class="ident" id="6240142">src</span><span class="op" id="6240145">[</span><span class="num" id="6240146">2</span><span class="op" id="6240147">]</span>&nbsp;<span class="op" id="6240149">&gt;&gt;</span>&nbsp;<span class="num" id="6240152">4</span><span class="op" id="6240153">)</span>&nbsp;<span class="op" id="6240155">&amp;</span>&nbsp;<span class="num" id="6240157">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240165">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240179">case</span>&nbsp;<span class="num" id="6240184">2</span><span class="op" id="6240185">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240190">b3</span>&nbsp;<span class="op" id="6240193">|=</span>&nbsp;<span class="op" id="6240196">(</span><span class="ident" id="6240197">src</span><span class="op" id="6240200">[</span><span class="num" id="6240201">1</span><span class="op" id="6240202">]</span>&nbsp;<span class="op" id="6240204">&lt;&lt;</span>&nbsp;<span class="num" id="6240207">4</span><span class="op" id="6240208">)</span>&nbsp;<span class="op" id="6240210">&amp;</span>&nbsp;<span class="num" id="6240212">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240220">b2</span>&nbsp;<span class="op" id="6240223">=</span>&nbsp;<span class="op" id="6240225">(</span><span class="ident" id="6240226">src</span><span class="op" id="6240229">[</span><span class="num" id="6240230">1</span><span class="op" id="6240231">]</span>&nbsp;<span class="op" id="6240233">&gt;&gt;</span>&nbsp;<span class="num" id="6240236">1</span><span class="op" id="6240237">)</span>&nbsp;<span class="op" id="6240239">&amp;</span>&nbsp;<span class="num" id="6240241">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240249">b1</span>&nbsp;<span class="op" id="6240252">=</span>&nbsp;<span class="op" id="6240254">(</span><span class="ident" id="6240255">src</span><span class="op" id="6240258">[</span><span class="num" id="6240259">1</span><span class="op" id="6240260">]</span>&nbsp;<span class="op" id="6240262">&gt;&gt;</span>&nbsp;<span class="num" id="6240265">6</span><span class="op" id="6240266">)</span>&nbsp;<span class="op" id="6240268">&amp;</span>&nbsp;<span class="num" id="6240270">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240278">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240292">case</span>&nbsp;<span class="num" id="6240297">1</span><span class="op" id="6240298">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240303">b1</span>&nbsp;<span class="op" id="6240306">|=</span>&nbsp;<span class="op" id="6240309">(</span><span class="ident" id="6240310">src</span><span class="op" id="6240313">[</span><span class="num" id="6240314">0</span><span class="op" id="6240315">]</span>&nbsp;<span class="op" id="6240317">&lt;&lt;</span>&nbsp;<span class="num" id="6240320">2</span><span class="op" id="6240321">)</span>&nbsp;<span class="op" id="6240323">&amp;</span>&nbsp;<span class="num" id="6240325">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240333">b0</span>&nbsp;<span class="op" id="6240336">=</span>&nbsp;<span class="ident" id="6240338">src</span><span class="op" id="6240341">[</span><span class="num" id="6240342">0</span><span class="op" id="6240343">]</span>&nbsp;<span class="op" id="6240345">&gt;&gt;</span>&nbsp;<span class="num" id="6240348">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240357">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240408">dst</span><span class="op" id="6240411">[</span><span class="num" id="6240412">0</span><span class="op" id="6240413">]</span>&nbsp;<span class="op" id="6240415">=</span>&nbsp;<span class="ident" id="6240417">enc</span><span class="op" id="6240420">.</span><span class="ident" id="6240421">encode</span><span class="op" id="6240427">[</span><span class="ident" id="6240428">b0</span><span class="op" id="6240430">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240434">dst</span><span class="op" id="6240437">[</span><span class="num" id="6240438">1</span><span class="op" id="6240439">]</span>&nbsp;<span class="op" id="6240441">=</span>&nbsp;<span class="ident" id="6240443">enc</span><span class="op" id="6240446">.</span><span class="ident" id="6240447">encode</span><span class="op" id="6240453">[</span><span class="ident" id="6240454">b1</span><span class="op" id="6240456">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240460">dst</span><span class="op" id="6240463">[</span><span class="num" id="6240464">2</span><span class="op" id="6240465">]</span>&nbsp;<span class="op" id="6240467">=</span>&nbsp;<span class="ident" id="6240469">enc</span><span class="op" id="6240472">.</span><span class="ident" id="6240473">encode</span><span class="op" id="6240479">[</span><span class="ident" id="6240480">b2</span><span class="op" id="6240482">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240486">dst</span><span class="op" id="6240489">[</span><span class="num" id="6240490">3</span><span class="op" id="6240491">]</span>&nbsp;<span class="op" id="6240493">=</span>&nbsp;<span class="ident" id="6240495">enc</span><span class="op" id="6240498">.</span><span class="ident" id="6240499">encode</span><span class="op" id="6240505">[</span><span class="ident" id="6240506">b3</span><span class="op" id="6240508">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240512">dst</span><span class="op" id="6240515">[</span><span class="num" id="6240516">4</span><span class="op" id="6240517">]</span>&nbsp;<span class="op" id="6240519">=</span>&nbsp;<span class="ident" id="6240521">enc</span><span class="op" id="6240524">.</span><span class="ident" id="6240525">encode</span><span class="op" id="6240531">[</span><span class="ident" id="6240532">b4</span><span class="op" id="6240534">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240538">dst</span><span class="op" id="6240541">[</span><span class="num" id="6240542">5</span><span class="op" id="6240543">]</span>&nbsp;<span class="op" id="6240545">=</span>&nbsp;<span class="ident" id="6240547">enc</span><span class="op" id="6240550">.</span><span class="ident" id="6240551">encode</span><span class="op" id="6240557">[</span><span class="ident" id="6240558">b5</span><span class="op" id="6240560">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240564">dst</span><span class="op" id="6240567">[</span><span class="num" id="6240568">6</span><span class="op" id="6240569">]</span>&nbsp;<span class="op" id="6240571">=</span>&nbsp;<span class="ident" id="6240573">enc</span><span class="op" id="6240576">.</span><span class="ident" id="6240577">encode</span><span class="op" id="6240583">[</span><span class="ident" id="6240584">b6</span><span class="op" id="6240586">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240590">dst</span><span class="op" id="6240593">[</span><span class="num" id="6240594">7</span><span class="op" id="6240595">]</span>&nbsp;<span class="op" id="6240597">=</span>&nbsp;<span class="ident" id="6240599">enc</span><span class="op" id="6240602">.</span><span class="ident" id="6240603">encode</span><span class="op" id="6240609">[</span><span class="ident" id="6240610">b7</span><span class="op" id="6240612">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240617">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240644">if</span>&nbsp;<span class="builtinfunc" id="6240647">len</span><span class="op" id="6240650">(</span><span class="ident" id="6240651">src</span><span class="op" id="6240654">)</span>&nbsp;<span class="op" id="6240656">&lt;</span>&nbsp;<span class="num" id="6240658">5</span>&nbsp;<span class="op" id="6240660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240665">dst</span><span class="op" id="6240668">[</span><span class="num" id="6240669">7</span><span class="op" id="6240670">]</span>&nbsp;<span class="op" id="6240672">=</span>&nbsp;<span class="string" id="6240674">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240681">if</span>&nbsp;<span class="builtinfunc" id="6240684">len</span><span class="op" id="6240687">(</span><span class="ident" id="6240688">src</span><span class="op" id="6240691">)</span>&nbsp;<span class="op" id="6240693">&lt;</span>&nbsp;<span class="num" id="6240695">4</span>&nbsp;<span class="op" id="6240697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240703">dst</span><span class="op" id="6240706">[</span><span class="num" id="6240707">6</span><span class="op" id="6240708">]</span>&nbsp;<span class="op" id="6240710">=</span>&nbsp;<span class="string" id="6240712">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240720">dst</span><span class="op" id="6240723">[</span><span class="num" id="6240724">5</span><span class="op" id="6240725">]</span>&nbsp;<span class="op" id="6240727">=</span>&nbsp;<span class="string" id="6240729">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240737">if</span>&nbsp;<span class="builtinfunc" id="6240740">len</span><span class="op" id="6240743">(</span><span class="ident" id="6240744">src</span><span class="op" id="6240747">)</span>&nbsp;<span class="op" id="6240749">&lt;</span>&nbsp;<span class="num" id="6240751">3</span>&nbsp;<span class="op" id="6240753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240760">dst</span><span class="op" id="6240763">[</span><span class="num" id="6240764">4</span><span class="op" id="6240765">]</span>&nbsp;<span class="op" id="6240767">=</span>&nbsp;<span class="string" id="6240769">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240778">if</span>&nbsp;<span class="builtinfunc" id="6240781">len</span><span class="op" id="6240784">(</span><span class="ident" id="6240785">src</span><span class="op" id="6240788">)</span>&nbsp;<span class="op" id="6240790">&lt;</span>&nbsp;<span class="num" id="6240792">2</span>&nbsp;<span class="op" id="6240794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240802">dst</span><span class="op" id="6240805">[</span><span class="num" id="6240806">3</span><span class="op" id="6240807">]</span>&nbsp;<span class="op" id="6240809">=</span>&nbsp;<span class="string" id="6240811">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240821">dst</span><span class="op" id="6240824">[</span><span class="num" id="6240825">2</span><span class="op" id="6240826">]</span>&nbsp;<span class="op" id="6240828">=</span>&nbsp;<span class="string" id="6240830">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240855">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240863">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240867">src</span>&nbsp;<span class="op" id="6240871">=</span>&nbsp;<span class="ident" id="6240873">src</span><span class="op" id="6240876">[</span><span class="num" id="6240877">5</span><span class="op" id="6240878">:</span><span class="op" id="6240879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240883">dst</span>&nbsp;<span class="op" id="6240887">=</span>&nbsp;<span class="ident" id="6240889">dst</span><span class="op" id="6240892">[</span><span class="num" id="6240893">8</span><span class="op" id="6240894">:</span><span class="op" id="6240895">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240898">}</span><br>
<span class="lineno"></span><span class="op" id="6240900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="6240903">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="6240957">func</span>&nbsp;<span class="op" id="6240962">(</span><span class="ident" id="6240963">enc</span>&nbsp;<span class="op" id="6240967">*</span><span class="ident" id="6240968">Encoding</span><span class="op" id="6240976">)</span>&nbsp;<span class="ident" id="6240978">EncodeToString</span><span class="op" id="6240992">(</span><span class="ident" id="6240993">src</span>&nbsp;<span class="op" id="6240997">[</span><span class="op" id="6240998">]</span><span class="builtintype" id="6240999">byte</span><span class="op" id="6241003">)</span>&nbsp;<span class="builtintype" id="6241005">string</span>&nbsp;<span class="op" id="6241012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241015">buf</span>&nbsp;<span class="op" id="6241019">:=</span>&nbsp;<span class="builtinfunc" id="6241022">make</span><span class="op" id="6241026">(</span><span class="op" id="6241027">[</span><span class="op" id="6241028">]</span><span class="builtintype" id="6241029">byte</span><span class="op" id="6241033">,</span>&nbsp;<span class="ident" id="6241035">enc</span><span class="op" id="6241038">.</span><span class="ident" id="6241039">EncodedLen</span><span class="op" id="6241049">(</span><span class="builtinfunc" id="6241050">len</span><span class="op" id="6241053">(</span><span class="ident" id="6241054">src</span><span class="op" id="6241057">)</span><span class="op" id="6241058">)</span><span class="op" id="6241059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241062">enc</span><span class="op" id="6241065">.</span><span class="ident" id="6241066">Encode</span><span class="op" id="6241072">(</span><span class="ident" id="6241073">buf</span><span class="op" id="6241076">,</span>&nbsp;<span class="ident" id="6241078">src</span><span class="op" id="6241081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241084">return</span>&nbsp;<span class="builtintype" id="6241091">string</span><span class="op" id="6241097">(</span><span class="ident" id="6241098">buf</span><span class="op" id="6241101">)</span><br>
<span class="lineno">140</span><span class="op" id="6241103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6241106">type</span>&nbsp;<span class="ident" id="6241111">encoder</span>&nbsp;<span class="keyword" id="6241119">struct</span>&nbsp;<span class="op" id="6241126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241129">err</span>&nbsp;&nbsp;<span class="builtintype" id="6241134">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241141">enc</span>&nbsp;&nbsp;<span class="op" id="6241146">*</span><span class="ident" id="6241147">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241157">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241162">io</span><span class="op" id="6241164">.</span><span class="ident" id="6241165">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241173">buf</span>&nbsp;&nbsp;<span class="op" id="6241178">[</span><span class="num" id="6241179">5</span><span class="op" id="6241180">]</span><span class="builtintype" id="6241181">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6241189">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241229">nbuf</span>&nbsp;<span class="builtintype" id="6241234">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6241245">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241272">out</span>&nbsp;&nbsp;<span class="op" id="6241277">[</span><span class="num" id="6241278">1024</span><span class="op" id="6241282">]</span><span class="builtintype" id="6241283">byte</span>&nbsp;<span class="comment" id="6241288">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="6241305">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6241308">func</span>&nbsp;<span class="op" id="6241313">(</span><span class="ident" id="6241314">e</span>&nbsp;<span class="op" id="6241316">*</span><span class="ident" id="6241317">encoder</span><span class="op" id="6241324">)</span>&nbsp;<span class="ident" id="6241326">Write</span><span class="op" id="6241331">(</span><span class="ident" id="6241332">p</span>&nbsp;<span class="op" id="6241334">[</span><span class="op" id="6241335">]</span><span class="builtintype" id="6241336">byte</span><span class="op" id="6241340">)</span>&nbsp;<span class="op" id="6241342">(</span><span class="ident" id="6241343">n</span>&nbsp;<span class="builtintype" id="6241345">int</span><span class="op" id="6241348">,</span>&nbsp;<span class="ident" id="6241350">err</span>&nbsp;<span class="builtintype" id="6241354">error</span><span class="op" id="6241359">)</span>&nbsp;<span class="op" id="6241361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241364">if</span>&nbsp;<span class="ident" id="6241367">e</span><span class="op" id="6241368">.</span><span class="ident" id="6241369">err</span>&nbsp;<span class="op" id="6241373">!=</span>&nbsp;<span class="ident" id="6241376">nil</span>&nbsp;<span class="op" id="6241380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241384">return</span>&nbsp;<span class="num" id="6241391">0</span><span class="op" id="6241392">,</span>&nbsp;<span class="ident" id="6241394">e</span><span class="op" id="6241395">.</span><span class="ident" id="6241396">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241401">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241405">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241425">if</span>&nbsp;<span class="ident" id="6241428">e</span><span class="op" id="6241429">.</span><span class="ident" id="6241430">nbuf</span>&nbsp;<span class="op" id="6241435">&gt;</span>&nbsp;<span class="num" id="6241437">0</span>&nbsp;<span class="op" id="6241439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241443">var</span>&nbsp;<span class="ident" id="6241447">i</span>&nbsp;<span class="builtintype" id="6241449">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241455">for</span>&nbsp;<span class="ident" id="6241459">i</span>&nbsp;<span class="op" id="6241461">=</span>&nbsp;<span class="num" id="6241463">0</span><span class="op" id="6241464">;</span>&nbsp;<span class="ident" id="6241466">i</span>&nbsp;<span class="op" id="6241468">&lt;</span>&nbsp;<span class="builtinfunc" id="6241470">len</span><span class="op" id="6241473">(</span><span class="ident" id="6241474">p</span><span class="op" id="6241475">)</span>&nbsp;<span class="op" id="6241477">&amp;&amp;</span>&nbsp;<span class="ident" id="6241480">e</span><span class="op" id="6241481">.</span><span class="ident" id="6241482">nbuf</span>&nbsp;<span class="op" id="6241487">&lt;</span>&nbsp;<span class="num" id="6241489">5</span><span class="op" id="6241490">;</span>&nbsp;<span class="ident" id="6241492">i</span><span class="op" id="6241493">++</span>&nbsp;<span class="op" id="6241496">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241501">e</span><span class="op" id="6241502">.</span><span class="ident" id="6241503">buf</span><span class="op" id="6241506">[</span><span class="ident" id="6241507">e</span><span class="op" id="6241508">.</span><span class="ident" id="6241509">nbuf</span><span class="op" id="6241513">]</span>&nbsp;<span class="op" id="6241515">=</span>&nbsp;<span class="ident" id="6241517">p</span><span class="op" id="6241518">[</span><span class="ident" id="6241519">i</span><span class="op" id="6241520">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241525">e</span><span class="op" id="6241526">.</span><span class="ident" id="6241527">nbuf</span><span class="op" id="6241531">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241540">n</span>&nbsp;<span class="op" id="6241542">+=</span>&nbsp;<span class="ident" id="6241545">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241549">p</span>&nbsp;<span class="op" id="6241551">=</span>&nbsp;<span class="ident" id="6241553">p</span><span class="op" id="6241554">[</span><span class="ident" id="6241555">i</span><span class="op" id="6241556">:</span><span class="op" id="6241557">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241561">if</span>&nbsp;<span class="ident" id="6241564">e</span><span class="op" id="6241565">.</span><span class="ident" id="6241566">nbuf</span>&nbsp;<span class="op" id="6241571">&lt;</span>&nbsp;<span class="num" id="6241573">5</span>&nbsp;<span class="op" id="6241575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241580">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241593">e</span><span class="op" id="6241594">.</span><span class="ident" id="6241595">enc</span><span class="op" id="6241598">.</span><span class="ident" id="6241599">Encode</span><span class="op" id="6241605">(</span><span class="ident" id="6241606">e</span><span class="op" id="6241607">.</span><span class="ident" id="6241608">out</span><span class="op" id="6241611">[</span><span class="num" id="6241612">0</span><span class="op" id="6241613">:</span><span class="op" id="6241614">]</span><span class="op" id="6241615">,</span>&nbsp;<span class="ident" id="6241617">e</span><span class="op" id="6241618">.</span><span class="ident" id="6241619">buf</span><span class="op" id="6241622">[</span><span class="num" id="6241623">0</span><span class="op" id="6241624">:</span><span class="op" id="6241625">]</span><span class="op" id="6241626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241630">if</span>&nbsp;<span class="ident" id="6241633">_</span><span class="op" id="6241634">,</span>&nbsp;<span class="ident" id="6241636">e</span><span class="op" id="6241637">.</span><span class="ident" id="6241638">err</span>&nbsp;<span class="op" id="6241642">=</span>&nbsp;<span class="ident" id="6241644">e</span><span class="op" id="6241645">.</span><span class="ident" id="6241646">w</span><span class="op" id="6241647">.</span><span class="ident" id="6241648">Write</span><span class="op" id="6241653">(</span><span class="ident" id="6241654">e</span><span class="op" id="6241655">.</span><span class="ident" id="6241656">out</span><span class="op" id="6241659">[</span><span class="num" id="6241660">0</span><span class="op" id="6241661">:</span><span class="num" id="6241662">8</span><span class="op" id="6241663">]</span><span class="op" id="6241664">)</span><span class="op" id="6241665">;</span>&nbsp;<span class="ident" id="6241667">e</span><span class="op" id="6241668">.</span><span class="ident" id="6241669">err</span>&nbsp;<span class="op" id="6241673">!=</span>&nbsp;<span class="ident" id="6241676">nil</span>&nbsp;<span class="op" id="6241680">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241685">return</span>&nbsp;<span class="ident" id="6241692">n</span><span class="op" id="6241693">,</span>&nbsp;<span class="ident" id="6241695">e</span><span class="op" id="6241696">.</span><span class="ident" id="6241697">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241707">e</span><span class="op" id="6241708">.</span><span class="ident" id="6241709">nbuf</span>&nbsp;<span class="op" id="6241714">=</span>&nbsp;<span class="num" id="6241716">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241723">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241750">for</span>&nbsp;<span class="builtinfunc" id="6241754">len</span><span class="op" id="6241757">(</span><span class="ident" id="6241758">p</span><span class="op" id="6241759">)</span>&nbsp;<span class="op" id="6241761">&gt;=</span>&nbsp;<span class="num" id="6241764">5</span>&nbsp;<span class="op" id="6241766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241770">nn</span>&nbsp;<span class="op" id="6241773">:=</span>&nbsp;<span class="builtinfunc" id="6241776">len</span><span class="op" id="6241779">(</span><span class="ident" id="6241780">e</span><span class="op" id="6241781">.</span><span class="ident" id="6241782">out</span><span class="op" id="6241785">)</span>&nbsp;<span class="op" id="6241787">/</span>&nbsp;<span class="num" id="6241789">8</span>&nbsp;<span class="op" id="6241791">*</span>&nbsp;<span class="num" id="6241793">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241797">if</span>&nbsp;<span class="ident" id="6241800">nn</span>&nbsp;<span class="op" id="6241803">&gt;</span>&nbsp;<span class="builtinfunc" id="6241805">len</span><span class="op" id="6241808">(</span><span class="ident" id="6241809">p</span><span class="op" id="6241810">)</span>&nbsp;<span class="op" id="6241812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241817">nn</span>&nbsp;<span class="op" id="6241820">=</span>&nbsp;<span class="builtinfunc" id="6241822">len</span><span class="op" id="6241825">(</span><span class="ident" id="6241826">p</span><span class="op" id="6241827">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241832">nn</span>&nbsp;<span class="op" id="6241835">-=</span>&nbsp;<span class="ident" id="6241838">nn</span>&nbsp;<span class="op" id="6241841">%</span>&nbsp;<span class="num" id="6241843">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241851">e</span><span class="op" id="6241852">.</span><span class="ident" id="6241853">enc</span><span class="op" id="6241856">.</span><span class="ident" id="6241857">Encode</span><span class="op" id="6241863">(</span><span class="ident" id="6241864">e</span><span class="op" id="6241865">.</span><span class="ident" id="6241866">out</span><span class="op" id="6241869">[</span><span class="num" id="6241870">0</span><span class="op" id="6241871">:</span><span class="op" id="6241872">]</span><span class="op" id="6241873">,</span>&nbsp;<span class="ident" id="6241875">p</span><span class="op" id="6241876">[</span><span class="num" id="6241877">0</span><span class="op" id="6241878">:</span><span class="ident" id="6241879">nn</span><span class="op" id="6241881">]</span><span class="op" id="6241882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241886">if</span>&nbsp;<span class="ident" id="6241889">_</span><span class="op" id="6241890">,</span>&nbsp;<span class="ident" id="6241892">e</span><span class="op" id="6241893">.</span><span class="ident" id="6241894">err</span>&nbsp;<span class="op" id="6241898">=</span>&nbsp;<span class="ident" id="6241900">e</span><span class="op" id="6241901">.</span><span class="ident" id="6241902">w</span><span class="op" id="6241903">.</span><span class="ident" id="6241904">Write</span><span class="op" id="6241909">(</span><span class="ident" id="6241910">e</span><span class="op" id="6241911">.</span><span class="ident" id="6241912">out</span><span class="op" id="6241915">[</span><span class="num" id="6241916">0</span>&nbsp;<span class="op" id="6241918">:</span>&nbsp;<span class="ident" id="6241920">nn</span><span class="op" id="6241922">/</span><span class="num" id="6241923">5</span><span class="op" id="6241924">*</span><span class="num" id="6241925">8</span><span class="op" id="6241926">]</span><span class="op" id="6241927">)</span><span class="op" id="6241928">;</span>&nbsp;<span class="ident" id="6241930">e</span><span class="op" id="6241931">.</span><span class="ident" id="6241932">err</span>&nbsp;<span class="op" id="6241936">!=</span>&nbsp;<span class="ident" id="6241939">nil</span>&nbsp;<span class="op" id="6241943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241948">return</span>&nbsp;<span class="ident" id="6241955">n</span><span class="op" id="6241956">,</span>&nbsp;<span class="ident" id="6241958">e</span><span class="op" id="6241959">.</span><span class="ident" id="6241960">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241970">n</span>&nbsp;<span class="op" id="6241972">+=</span>&nbsp;<span class="ident" id="6241975">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241980">p</span>&nbsp;<span class="op" id="6241982">=</span>&nbsp;<span class="ident" id="6241984">p</span><span class="op" id="6241985">[</span><span class="ident" id="6241986">nn</span><span class="op" id="6241988">:</span><span class="op" id="6241989">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241996">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242017">for</span>&nbsp;<span class="ident" id="6242021">i</span>&nbsp;<span class="op" id="6242023">:=</span>&nbsp;<span class="num" id="6242026">0</span><span class="op" id="6242027">;</span>&nbsp;<span class="ident" id="6242029">i</span>&nbsp;<span class="op" id="6242031">&lt;</span>&nbsp;<span class="builtinfunc" id="6242033">len</span><span class="op" id="6242036">(</span><span class="ident" id="6242037">p</span><span class="op" id="6242038">)</span><span class="op" id="6242039">;</span>&nbsp;<span class="ident" id="6242041">i</span><span class="op" id="6242042">++</span>&nbsp;<span class="op" id="6242045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242049">e</span><span class="op" id="6242050">.</span><span class="ident" id="6242051">buf</span><span class="op" id="6242054">[</span><span class="ident" id="6242055">i</span><span class="op" id="6242056">]</span>&nbsp;<span class="op" id="6242058">=</span>&nbsp;<span class="ident" id="6242060">p</span><span class="op" id="6242061">[</span><span class="ident" id="6242062">i</span><span class="op" id="6242063">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242069">e</span><span class="op" id="6242070">.</span><span class="ident" id="6242071">nbuf</span>&nbsp;<span class="op" id="6242076">=</span>&nbsp;<span class="builtinfunc" id="6242078">len</span><span class="op" id="6242081">(</span><span class="ident" id="6242082">p</span><span class="op" id="6242083">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242086">n</span>&nbsp;<span class="op" id="6242088">+=</span>&nbsp;<span class="builtinfunc" id="6242091">len</span><span class="op" id="6242094">(</span><span class="ident" id="6242095">p</span><span class="op" id="6242096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242099">return</span><br>
<span class="lineno"></span><span class="op" id="6242106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6242109">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="6242163">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="6242216">func</span>&nbsp;<span class="op" id="6242221">(</span><span class="ident" id="6242222">e</span>&nbsp;<span class="op" id="6242224">*</span><span class="ident" id="6242225">encoder</span><span class="op" id="6242232">)</span>&nbsp;<span class="ident" id="6242234">Close</span><span class="op" id="6242239">(</span><span class="op" id="6242240">)</span>&nbsp;<span class="builtintype" id="6242242">error</span>&nbsp;<span class="op" id="6242248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242251">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242308">if</span>&nbsp;<span class="ident" id="6242311">e</span><span class="op" id="6242312">.</span><span class="ident" id="6242313">err</span>&nbsp;<span class="op" id="6242317">==</span>&nbsp;<span class="ident" id="6242320">nil</span>&nbsp;<span class="op" id="6242324">&amp;&amp;</span>&nbsp;<span class="ident" id="6242327">e</span><span class="op" id="6242328">.</span><span class="ident" id="6242329">nbuf</span>&nbsp;<span class="op" id="6242334">&gt;</span>&nbsp;<span class="num" id="6242336">0</span>&nbsp;<span class="op" id="6242338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242342">e</span><span class="op" id="6242343">.</span><span class="ident" id="6242344">enc</span><span class="op" id="6242347">.</span><span class="ident" id="6242348">Encode</span><span class="op" id="6242354">(</span><span class="ident" id="6242355">e</span><span class="op" id="6242356">.</span><span class="ident" id="6242357">out</span><span class="op" id="6242360">[</span><span class="num" id="6242361">0</span><span class="op" id="6242362">:</span><span class="op" id="6242363">]</span><span class="op" id="6242364">,</span>&nbsp;<span class="ident" id="6242366">e</span><span class="op" id="6242367">.</span><span class="ident" id="6242368">buf</span><span class="op" id="6242371">[</span><span class="num" id="6242372">0</span><span class="op" id="6242373">:</span><span class="ident" id="6242374">e</span><span class="op" id="6242375">.</span><span class="ident" id="6242376">nbuf</span><span class="op" id="6242380">]</span><span class="op" id="6242381">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242385">e</span><span class="op" id="6242386">.</span><span class="ident" id="6242387">nbuf</span>&nbsp;<span class="op" id="6242392">=</span>&nbsp;<span class="num" id="6242394">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242398">_</span><span class="op" id="6242399">,</span>&nbsp;<span class="ident" id="6242401">e</span><span class="op" id="6242402">.</span><span class="ident" id="6242403">err</span>&nbsp;<span class="op" id="6242407">=</span>&nbsp;<span class="ident" id="6242409">e</span><span class="op" id="6242410">.</span><span class="ident" id="6242411">w</span><span class="op" id="6242412">.</span><span class="ident" id="6242413">Write</span><span class="op" id="6242418">(</span><span class="ident" id="6242419">e</span><span class="op" id="6242420">.</span><span class="ident" id="6242421">out</span><span class="op" id="6242424">[</span><span class="num" id="6242425">0</span><span class="op" id="6242426">:</span><span class="num" id="6242427">8</span><span class="op" id="6242428">]</span><span class="op" id="6242429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242435">return</span>&nbsp;<span class="ident" id="6242442">e</span><span class="op" id="6242443">.</span><span class="ident" id="6242444">err</span><br>
<span class="lineno"></span><span class="op" id="6242448">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="6242451">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6242519">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="6242591">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="6242651">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="6242719">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="6242748">func</span>&nbsp;<span class="ident" id="6242753">NewEncoder</span><span class="op" id="6242763">(</span><span class="ident" id="6242764">enc</span>&nbsp;<span class="op" id="6242768">*</span><span class="ident" id="6242769">Encoding</span><span class="op" id="6242777">,</span>&nbsp;<span class="ident" id="6242779">w</span>&nbsp;<span class="ident" id="6242781">io</span><span class="op" id="6242783">.</span><span class="ident" id="6242784">Writer</span><span class="op" id="6242790">)</span>&nbsp;<span class="ident" id="6242792">io</span><span class="op" id="6242794">.</span><span class="ident" id="6242795">WriteCloser</span>&nbsp;<span class="op" id="6242807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242810">return</span>&nbsp;<span class="op" id="6242817">&amp;</span><span class="ident" id="6242818">encoder</span><span class="op" id="6242825">{</span><span class="ident" id="6242826">enc</span><span class="op" id="6242829">:</span>&nbsp;<span class="ident" id="6242831">enc</span><span class="op" id="6242834">,</span>&nbsp;<span class="ident" id="6242836">w</span><span class="op" id="6242837">:</span>&nbsp;<span class="ident" id="6242839">w</span><span class="op" id="6242840">}</span><br>
<span class="lineno"></span><span class="op" id="6242842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="6242845">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="6242910">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="6242945">func</span>&nbsp;<span class="op" id="6242950">(</span><span class="ident" id="6242951">enc</span>&nbsp;<span class="op" id="6242955">*</span><span class="ident" id="6242956">Encoding</span><span class="op" id="6242964">)</span>&nbsp;<span class="ident" id="6242966">EncodedLen</span><span class="op" id="6242976">(</span><span class="ident" id="6242977">n</span>&nbsp;<span class="builtintype" id="6242979">int</span><span class="op" id="6242982">)</span>&nbsp;<span class="builtintype" id="6242984">int</span>&nbsp;<span class="op" id="6242988">{</span>&nbsp;<span class="keyword" id="6242990">return</span>&nbsp;<span class="op" id="6242997">(</span><span class="ident" id="6242998">n</span>&nbsp;<span class="op" id="6243000">+</span>&nbsp;<span class="num" id="6243002">4</span><span class="op" id="6243003">)</span>&nbsp;<span class="op" id="6243005">/</span>&nbsp;<span class="num" id="6243007">5</span>&nbsp;<span class="op" id="6243009">*</span>&nbsp;<span class="num" id="6243011">8</span>&nbsp;<span class="op" id="6243013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6243016">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6243035">type</span>&nbsp;<span class="ident" id="6243040">CorruptInputError</span>&nbsp;<span class="ident" id="6243058">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="6243065">func</span>&nbsp;<span class="op" id="6243070">(</span><span class="ident" id="6243071">e</span>&nbsp;<span class="ident" id="6243073">CorruptInputError</span><span class="op" id="6243090">)</span>&nbsp;<span class="ident" id="6243092">Error</span><span class="op" id="6243097">(</span><span class="op" id="6243098">)</span>&nbsp;<span class="builtintype" id="6243100">string</span>&nbsp;<span class="op" id="6243107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243110">return</span>&nbsp;<span class="string" id="6243117">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="6243154">+</span>&nbsp;<span class="ident" id="6243156">strconv</span><span class="op" id="6243163">.</span><span class="ident" id="6243164">FormatInt</span><span class="op" id="6243173">(</span><span class="ident" id="6243174">int64</span><span class="op" id="6243179">(</span><span class="ident" id="6243180">e</span><span class="op" id="6243181">)</span><span class="op" id="6243182">,</span>&nbsp;<span class="num" id="6243184">10</span><span class="op" id="6243186">)</span><br>
<span class="lineno"></span><span class="op" id="6243188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6243191">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="6243261">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="6243329">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="6243399">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="6243456">func</span>&nbsp;<span class="op" id="6243461">(</span><span class="ident" id="6243462">enc</span>&nbsp;<span class="op" id="6243466">*</span><span class="ident" id="6243467">Encoding</span><span class="op" id="6243475">)</span>&nbsp;<span class="ident" id="6243477">decode</span><span class="op" id="6243483">(</span><span class="ident" id="6243484">dst</span><span class="op" id="6243487">,</span>&nbsp;<span class="ident" id="6243489">src</span>&nbsp;<span class="op" id="6243493">[</span><span class="op" id="6243494">]</span><span class="builtintype" id="6243495">byte</span><span class="op" id="6243499">)</span>&nbsp;<span class="op" id="6243501">(</span><span class="ident" id="6243502">n</span>&nbsp;<span class="builtintype" id="6243504">int</span><span class="op" id="6243507">,</span>&nbsp;<span class="ident" id="6243509">end</span>&nbsp;<span class="builtintype" id="6243513">bool</span><span class="op" id="6243517">,</span>&nbsp;<span class="ident" id="6243519">err</span>&nbsp;<span class="builtintype" id="6243523">error</span><span class="op" id="6243528">)</span>&nbsp;<span class="op" id="6243530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243533">olen</span>&nbsp;<span class="op" id="6243538">:=</span>&nbsp;<span class="builtinfunc" id="6243541">len</span><span class="op" id="6243544">(</span><span class="ident" id="6243545">src</span><span class="op" id="6243548">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243551">for</span>&nbsp;<span class="builtinfunc" id="6243555">len</span><span class="op" id="6243558">(</span><span class="ident" id="6243559">src</span><span class="op" id="6243562">)</span>&nbsp;<span class="op" id="6243564">&gt;</span>&nbsp;<span class="num" id="6243566">0</span>&nbsp;<span class="op" id="6243568">&amp;&amp;</span>&nbsp;<span class="op" id="6243571">!</span><span class="ident" id="6243572">end</span>&nbsp;<span class="op" id="6243576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6243580">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243626">var</span>&nbsp;<span class="ident" id="6243630">dbuf</span>&nbsp;<span class="op" id="6243635">[</span><span class="num" id="6243636">8</span><span class="op" id="6243637">]</span><span class="builtintype" id="6243638">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243645">dlen</span>&nbsp;<span class="op" id="6243650">:=</span>&nbsp;<span class="num" id="6243653">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243658">for</span>&nbsp;<span class="ident" id="6243662">j</span>&nbsp;<span class="op" id="6243664">:=</span>&nbsp;<span class="num" id="6243667">0</span><span class="op" id="6243668">;</span>&nbsp;<span class="ident" id="6243670">j</span>&nbsp;<span class="op" id="6243672">&lt;</span>&nbsp;<span class="num" id="6243674">8</span><span class="op" id="6243675">;</span>&nbsp;<span class="op" id="6243677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243682">if</span>&nbsp;<span class="builtinfunc" id="6243685">len</span><span class="op" id="6243688">(</span><span class="ident" id="6243689">src</span><span class="op" id="6243692">)</span>&nbsp;<span class="op" id="6243694">==</span>&nbsp;<span class="num" id="6243697">0</span>&nbsp;<span class="op" id="6243699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243705">return</span>&nbsp;<span class="ident" id="6243712">n</span><span class="op" id="6243713">,</span>&nbsp;<span class="builtintype" id="6243715">false</span><span class="op" id="6243720">,</span>&nbsp;<span class="ident" id="6243722">CorruptInputError</span><span class="op" id="6243739">(</span><span class="ident" id="6243740">olen</span>&nbsp;<span class="op" id="6243745">-</span>&nbsp;<span class="builtinfunc" id="6243747">len</span><span class="op" id="6243750">(</span><span class="ident" id="6243751">src</span><span class="op" id="6243754">)</span>&nbsp;<span class="op" id="6243756">-</span>&nbsp;<span class="ident" id="6243758">j</span><span class="op" id="6243759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243769">in</span>&nbsp;<span class="op" id="6243772">:=</span>&nbsp;<span class="ident" id="6243775">src</span><span class="op" id="6243778">[</span><span class="num" id="6243779">0</span><span class="op" id="6243780">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243785">src</span>&nbsp;<span class="op" id="6243789">=</span>&nbsp;<span class="ident" id="6243791">src</span><span class="op" id="6243794">[</span><span class="num" id="6243795">1</span><span class="op" id="6243796">:</span><span class="op" id="6243797">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243802">if</span>&nbsp;<span class="ident" id="6243805">in</span>&nbsp;<span class="op" id="6243808">==</span>&nbsp;<span class="string" id="6243811">&#39;=&#39;</span>&nbsp;<span class="op" id="6243815">&amp;&amp;</span>&nbsp;<span class="ident" id="6243818">j</span>&nbsp;<span class="op" id="6243820">&gt;=</span>&nbsp;<span class="num" id="6243823">2</span>&nbsp;<span class="op" id="6243825">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6243828">len</span><span class="op" id="6243831">(</span><span class="ident" id="6243832">src</span><span class="op" id="6243835">)</span>&nbsp;<span class="op" id="6243837">&lt;</span>&nbsp;<span class="num" id="6243839">8</span>&nbsp;<span class="op" id="6243841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6243847">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243896">if</span>&nbsp;<span class="builtinfunc" id="6243899">len</span><span class="op" id="6243902">(</span><span class="ident" id="6243903">src</span><span class="op" id="6243906">)</span><span class="op" id="6243907">+</span><span class="ident" id="6243908">j</span>&nbsp;<span class="op" id="6243910">&lt;</span>&nbsp;<span class="num" id="6243912">8</span><span class="op" id="6243913">-</span><span class="num" id="6243914">1</span>&nbsp;<span class="op" id="6243916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6243923">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243950">return</span>&nbsp;<span class="ident" id="6243957">n</span><span class="op" id="6243958">,</span>&nbsp;<span class="builtintype" id="6243960">false</span><span class="op" id="6243965">,</span>&nbsp;<span class="ident" id="6243967">CorruptInputError</span><span class="op" id="6243984">(</span><span class="ident" id="6243985">olen</span><span class="op" id="6243989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244001">for</span>&nbsp;<span class="ident" id="6244005">k</span>&nbsp;<span class="op" id="6244007">:=</span>&nbsp;<span class="num" id="6244010">0</span><span class="op" id="6244011">;</span>&nbsp;<span class="ident" id="6244013">k</span>&nbsp;<span class="op" id="6244015">&lt;</span>&nbsp;<span class="num" id="6244017">8</span><span class="op" id="6244018">-</span><span class="num" id="6244019">1</span><span class="op" id="6244020">-</span><span class="ident" id="6244021">j</span><span class="op" id="6244022">;</span>&nbsp;<span class="ident" id="6244024">k</span><span class="op" id="6244025">++</span>&nbsp;<span class="op" id="6244028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244035">if</span>&nbsp;<span class="builtinfunc" id="6244038">len</span><span class="op" id="6244041">(</span><span class="ident" id="6244042">src</span><span class="op" id="6244045">)</span>&nbsp;<span class="op" id="6244047">&gt;</span>&nbsp;<span class="ident" id="6244049">k</span>&nbsp;<span class="op" id="6244051">&amp;&amp;</span>&nbsp;<span class="ident" id="6244054">src</span><span class="op" id="6244057">[</span><span class="ident" id="6244058">k</span><span class="op" id="6244059">]</span>&nbsp;<span class="op" id="6244061">!=</span>&nbsp;<span class="string" id="6244064">&#39;=&#39;</span>&nbsp;<span class="op" id="6244068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244076">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244103">return</span>&nbsp;<span class="ident" id="6244110">n</span><span class="op" id="6244111">,</span>&nbsp;<span class="builtintype" id="6244113">false</span><span class="op" id="6244118">,</span>&nbsp;<span class="ident" id="6244120">CorruptInputError</span><span class="op" id="6244137">(</span><span class="ident" id="6244138">olen</span>&nbsp;<span class="op" id="6244143">-</span>&nbsp;<span class="builtinfunc" id="6244145">len</span><span class="op" id="6244148">(</span><span class="ident" id="6244149">src</span><span class="op" id="6244152">)</span>&nbsp;<span class="op" id="6244154">+</span>&nbsp;<span class="ident" id="6244156">k</span>&nbsp;<span class="op" id="6244158">-</span>&nbsp;<span class="num" id="6244160">1</span><span class="op" id="6244161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244180">dlen</span><span class="op" id="6244184">,</span>&nbsp;<span class="ident" id="6244186">end</span>&nbsp;<span class="op" id="6244190">=</span>&nbsp;<span class="ident" id="6244192">j</span><span class="op" id="6244193">,</span>&nbsp;<span class="builtintype" id="6244195">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244204">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244279">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244355">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244427">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244500">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244571">if</span>&nbsp;<span class="ident" id="6244574">dlen</span>&nbsp;<span class="op" id="6244579">==</span>&nbsp;<span class="num" id="6244582">1</span>&nbsp;<span class="op" id="6244584">||</span>&nbsp;<span class="ident" id="6244587">dlen</span>&nbsp;<span class="op" id="6244592">==</span>&nbsp;<span class="num" id="6244595">3</span>&nbsp;<span class="op" id="6244597">||</span>&nbsp;<span class="ident" id="6244600">dlen</span>&nbsp;<span class="op" id="6244605">==</span>&nbsp;<span class="num" id="6244608">6</span>&nbsp;<span class="op" id="6244610">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244617">return</span>&nbsp;<span class="ident" id="6244624">n</span><span class="op" id="6244625">,</span>&nbsp;<span class="builtintype" id="6244627">false</span><span class="op" id="6244632">,</span>&nbsp;<span class="ident" id="6244634">CorruptInputError</span><span class="op" id="6244651">(</span><span class="ident" id="6244652">olen</span>&nbsp;<span class="op" id="6244657">-</span>&nbsp;<span class="builtinfunc" id="6244659">len</span><span class="op" id="6244662">(</span><span class="ident" id="6244663">src</span><span class="op" id="6244666">)</span>&nbsp;<span class="op" id="6244668">-</span>&nbsp;<span class="num" id="6244670">1</span><span class="op" id="6244671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244683">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244697">dbuf</span><span class="op" id="6244701">[</span><span class="ident" id="6244702">j</span><span class="op" id="6244703">]</span>&nbsp;<span class="op" id="6244705">=</span>&nbsp;<span class="ident" id="6244707">enc</span><span class="op" id="6244710">.</span><span class="ident" id="6244711">decodeMap</span><span class="op" id="6244720">[</span><span class="ident" id="6244721">in</span><span class="op" id="6244723">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244728">if</span>&nbsp;<span class="ident" id="6244731">dbuf</span><span class="op" id="6244735">[</span><span class="ident" id="6244736">j</span><span class="op" id="6244737">]</span>&nbsp;<span class="op" id="6244739">==</span>&nbsp;<span class="num" id="6244742">0xFF</span>&nbsp;<span class="op" id="6244747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244753">return</span>&nbsp;<span class="ident" id="6244760">n</span><span class="op" id="6244761">,</span>&nbsp;<span class="builtintype" id="6244763">false</span><span class="op" id="6244768">,</span>&nbsp;<span class="ident" id="6244770">CorruptInputError</span><span class="op" id="6244787">(</span><span class="ident" id="6244788">olen</span>&nbsp;<span class="op" id="6244793">-</span>&nbsp;<span class="builtinfunc" id="6244795">len</span><span class="op" id="6244798">(</span><span class="ident" id="6244799">src</span><span class="op" id="6244802">)</span>&nbsp;<span class="op" id="6244804">-</span>&nbsp;<span class="num" id="6244806">1</span><span class="op" id="6244807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244817">j</span><span class="op" id="6244818">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244823">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244828">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244885">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244898">switch</span>&nbsp;<span class="ident" id="6244905">dlen</span>&nbsp;<span class="op" id="6244910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244914">case</span>&nbsp;<span class="num" id="6244919">8</span><span class="op" id="6244920">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244925">dst</span><span class="op" id="6244928">[</span><span class="num" id="6244929">4</span><span class="op" id="6244930">]</span>&nbsp;<span class="op" id="6244932">=</span>&nbsp;<span class="ident" id="6244934">dbuf</span><span class="op" id="6244938">[</span><span class="num" id="6244939">6</span><span class="op" id="6244940">]</span><span class="op" id="6244941">&lt;&lt;</span><span class="num" id="6244943">5</span>&nbsp;<span class="op" id="6244945">|</span>&nbsp;<span class="ident" id="6244947">dbuf</span><span class="op" id="6244951">[</span><span class="num" id="6244952">7</span><span class="op" id="6244953">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244958">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244972">case</span>&nbsp;<span class="num" id="6244977">7</span><span class="op" id="6244978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244983">dst</span><span class="op" id="6244986">[</span><span class="num" id="6244987">3</span><span class="op" id="6244988">]</span>&nbsp;<span class="op" id="6244990">=</span>&nbsp;<span class="ident" id="6244992">dbuf</span><span class="op" id="6244996">[</span><span class="num" id="6244997">4</span><span class="op" id="6244998">]</span><span class="op" id="6244999">&lt;&lt;</span><span class="num" id="6245001">7</span>&nbsp;<span class="op" id="6245003">|</span>&nbsp;<span class="ident" id="6245005">dbuf</span><span class="op" id="6245009">[</span><span class="num" id="6245010">5</span><span class="op" id="6245011">]</span><span class="op" id="6245012">&lt;&lt;</span><span class="num" id="6245014">2</span>&nbsp;<span class="op" id="6245016">|</span>&nbsp;<span class="ident" id="6245018">dbuf</span><span class="op" id="6245022">[</span><span class="num" id="6245023">6</span><span class="op" id="6245024">]</span><span class="op" id="6245025">&gt;&gt;</span><span class="num" id="6245027">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245032">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245046">case</span>&nbsp;<span class="num" id="6245051">5</span><span class="op" id="6245052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245057">dst</span><span class="op" id="6245060">[</span><span class="num" id="6245061">2</span><span class="op" id="6245062">]</span>&nbsp;<span class="op" id="6245064">=</span>&nbsp;<span class="ident" id="6245066">dbuf</span><span class="op" id="6245070">[</span><span class="num" id="6245071">3</span><span class="op" id="6245072">]</span><span class="op" id="6245073">&lt;&lt;</span><span class="num" id="6245075">4</span>&nbsp;<span class="op" id="6245077">|</span>&nbsp;<span class="ident" id="6245079">dbuf</span><span class="op" id="6245083">[</span><span class="num" id="6245084">4</span><span class="op" id="6245085">]</span><span class="op" id="6245086">&gt;&gt;</span><span class="num" id="6245088">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245093">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245107">case</span>&nbsp;<span class="num" id="6245112">4</span><span class="op" id="6245113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245118">dst</span><span class="op" id="6245121">[</span><span class="num" id="6245122">1</span><span class="op" id="6245123">]</span>&nbsp;<span class="op" id="6245125">=</span>&nbsp;<span class="ident" id="6245127">dbuf</span><span class="op" id="6245131">[</span><span class="num" id="6245132">1</span><span class="op" id="6245133">]</span><span class="op" id="6245134">&lt;&lt;</span><span class="num" id="6245136">6</span>&nbsp;<span class="op" id="6245138">|</span>&nbsp;<span class="ident" id="6245140">dbuf</span><span class="op" id="6245144">[</span><span class="num" id="6245145">2</span><span class="op" id="6245146">]</span><span class="op" id="6245147">&lt;&lt;</span><span class="num" id="6245149">1</span>&nbsp;<span class="op" id="6245151">|</span>&nbsp;<span class="ident" id="6245153">dbuf</span><span class="op" id="6245157">[</span><span class="num" id="6245158">3</span><span class="op" id="6245159">]</span><span class="op" id="6245160">&gt;&gt;</span><span class="num" id="6245162">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245167">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245181">case</span>&nbsp;<span class="num" id="6245186">2</span><span class="op" id="6245187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245192">dst</span><span class="op" id="6245195">[</span><span class="num" id="6245196">0</span><span class="op" id="6245197">]</span>&nbsp;<span class="op" id="6245199">=</span>&nbsp;<span class="ident" id="6245201">dbuf</span><span class="op" id="6245205">[</span><span class="num" id="6245206">0</span><span class="op" id="6245207">]</span><span class="op" id="6245208">&lt;&lt;</span><span class="num" id="6245210">3</span>&nbsp;<span class="op" id="6245212">|</span>&nbsp;<span class="ident" id="6245214">dbuf</span><span class="op" id="6245218">[</span><span class="num" id="6245219">1</span><span class="op" id="6245220">]</span><span class="op" id="6245221">&gt;&gt;</span><span class="num" id="6245223">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245231">dst</span>&nbsp;<span class="op" id="6245235">=</span>&nbsp;<span class="ident" id="6245237">dst</span><span class="op" id="6245240">[</span><span class="num" id="6245241">5</span><span class="op" id="6245242">:</span><span class="op" id="6245243">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245247">switch</span>&nbsp;<span class="ident" id="6245254">dlen</span>&nbsp;<span class="op" id="6245259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245263">case</span>&nbsp;<span class="num" id="6245268">2</span><span class="op" id="6245269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245274">n</span>&nbsp;<span class="op" id="6245276">+=</span>&nbsp;<span class="num" id="6245279">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245283">case</span>&nbsp;<span class="num" id="6245288">4</span><span class="op" id="6245289">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245294">n</span>&nbsp;<span class="op" id="6245296">+=</span>&nbsp;<span class="num" id="6245299">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245303">case</span>&nbsp;<span class="num" id="6245308">5</span><span class="op" id="6245309">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245314">n</span>&nbsp;<span class="op" id="6245316">+=</span>&nbsp;<span class="num" id="6245319">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245323">case</span>&nbsp;<span class="num" id="6245328">7</span><span class="op" id="6245329">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245334">n</span>&nbsp;<span class="op" id="6245336">+=</span>&nbsp;<span class="num" id="6245339">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245343">case</span>&nbsp;<span class="num" id="6245348">8</span><span class="op" id="6245349">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245354">n</span>&nbsp;<span class="op" id="6245356">+=</span>&nbsp;<span class="num" id="6245359">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245369">return</span>&nbsp;<span class="ident" id="6245376">n</span><span class="op" id="6245377">,</span>&nbsp;<span class="ident" id="6245379">end</span><span class="op" id="6245382">,</span>&nbsp;<span class="ident" id="6245384">nil</span><br>
<span class="lineno"></span><span class="op" id="6245388">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="6245391">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="6245456">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="6245525">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6245594">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="6245657">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="6245705">func</span>&nbsp;<span class="op" id="6245710">(</span><span class="ident" id="6245711">enc</span>&nbsp;<span class="op" id="6245715">*</span><span class="ident" id="6245716">Encoding</span><span class="op" id="6245724">)</span>&nbsp;<span class="ident" id="6245726">Decode</span><span class="op" id="6245732">(</span><span class="ident" id="6245733">dst</span><span class="op" id="6245736">,</span>&nbsp;<span class="ident" id="6245738">src</span>&nbsp;<span class="op" id="6245742">[</span><span class="op" id="6245743">]</span><span class="builtintype" id="6245744">byte</span><span class="op" id="6245748">)</span>&nbsp;<span class="op" id="6245750">(</span><span class="ident" id="6245751">n</span>&nbsp;<span class="builtintype" id="6245753">int</span><span class="op" id="6245756">,</span>&nbsp;<span class="ident" id="6245758">err</span>&nbsp;<span class="builtintype" id="6245762">error</span><span class="op" id="6245767">)</span>&nbsp;<span class="op" id="6245769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245772">src</span>&nbsp;<span class="op" id="6245776">=</span>&nbsp;<span class="ident" id="6245778">bytes</span><span class="op" id="6245783">.</span><span class="ident" id="6245784">Map</span><span class="op" id="6245787">(</span><span class="ident" id="6245788">removeNewlinesMapper</span><span class="op" id="6245808">,</span>&nbsp;<span class="ident" id="6245810">src</span><span class="op" id="6245813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245816">n</span><span class="op" id="6245817">,</span>&nbsp;<span class="ident" id="6245819">_</span><span class="op" id="6245820">,</span>&nbsp;<span class="ident" id="6245822">err</span>&nbsp;<span class="op" id="6245826">=</span>&nbsp;<span class="ident" id="6245828">enc</span><span class="op" id="6245831">.</span><span class="ident" id="6245832">decode</span><span class="op" id="6245838">(</span><span class="ident" id="6245839">dst</span><span class="op" id="6245842">,</span>&nbsp;<span class="ident" id="6245844">src</span><span class="op" id="6245847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245850">return</span><br>
<span class="lineno">325</span><span class="op" id="6245857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6245860">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="6245930">func</span>&nbsp;<span class="op" id="6245935">(</span><span class="ident" id="6245936">enc</span>&nbsp;<span class="op" id="6245940">*</span><span class="ident" id="6245941">Encoding</span><span class="op" id="6245949">)</span>&nbsp;<span class="ident" id="6245951">DecodeString</span><span class="op" id="6245963">(</span><span class="ident" id="6245964">s</span>&nbsp;<span class="builtintype" id="6245966">string</span><span class="op" id="6245972">)</span>&nbsp;<span class="op" id="6245974">(</span><span class="op" id="6245975">[</span><span class="op" id="6245976">]</span><span class="builtintype" id="6245977">byte</span><span class="op" id="6245981">,</span>&nbsp;<span class="builtintype" id="6245983">error</span><span class="op" id="6245988">)</span>&nbsp;<span class="op" id="6245990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245993">s</span>&nbsp;<span class="op" id="6245995">=</span>&nbsp;<span class="ident" id="6245997">strings</span><span class="op" id="6246004">.</span><span class="ident" id="6246005">Map</span><span class="op" id="6246008">(</span><span class="ident" id="6246009">removeNewlinesMapper</span><span class="op" id="6246029">,</span>&nbsp;<span class="ident" id="6246031">s</span><span class="op" id="6246032">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246035">dbuf</span>&nbsp;<span class="op" id="6246040">:=</span>&nbsp;<span class="builtinfunc" id="6246043">make</span><span class="op" id="6246047">(</span><span class="op" id="6246048">[</span><span class="op" id="6246049">]</span><span class="builtintype" id="6246050">byte</span><span class="op" id="6246054">,</span>&nbsp;<span class="ident" id="6246056">enc</span><span class="op" id="6246059">.</span><span class="ident" id="6246060">DecodedLen</span><span class="op" id="6246070">(</span><span class="builtinfunc" id="6246071">len</span><span class="op" id="6246074">(</span><span class="ident" id="6246075">s</span><span class="op" id="6246076">)</span><span class="op" id="6246077">)</span><span class="op" id="6246078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246081">n</span><span class="op" id="6246082">,</span>&nbsp;<span class="ident" id="6246084">_</span><span class="op" id="6246085">,</span>&nbsp;<span class="ident" id="6246087">err</span>&nbsp;<span class="op" id="6246091">:=</span>&nbsp;<span class="ident" id="6246094">enc</span><span class="op" id="6246097">.</span><span class="ident" id="6246098">decode</span><span class="op" id="6246104">(</span><span class="ident" id="6246105">dbuf</span><span class="op" id="6246109">,</span>&nbsp;<span class="op" id="6246111">[</span><span class="op" id="6246112">]</span><span class="builtintype" id="6246113">byte</span><span class="op" id="6246117">(</span><span class="ident" id="6246118">s</span><span class="op" id="6246119">)</span><span class="op" id="6246120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246123">return</span>&nbsp;<span class="ident" id="6246130">dbuf</span><span class="op" id="6246134">[</span><span class="op" id="6246135">:</span><span class="ident" id="6246136">n</span><span class="op" id="6246137">]</span><span class="op" id="6246138">,</span>&nbsp;<span class="ident" id="6246140">err</span><br>
<span class="lineno"></span><span class="op" id="6246144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6246147">type</span>&nbsp;<span class="ident" id="6246152">decoder</span>&nbsp;<span class="keyword" id="6246160">struct</span>&nbsp;<span class="op" id="6246167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246170">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246177">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246184">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6246191">*</span><span class="ident" id="6246192">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246202">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6246209">io</span><span class="op" id="6246211">.</span><span class="ident" id="6246212">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246220">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246227">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6246238">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246261">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6246268">[</span><span class="num" id="6246269">1024</span><span class="op" id="6246273">]</span><span class="builtintype" id="6246274">byte</span>&nbsp;<span class="comment" id="6246279">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246298">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246305">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246310">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6246317">[</span><span class="op" id="6246318">]</span><span class="builtintype" id="6246319">byte</span>&nbsp;<span class="comment" id="6246324">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246352">outbuf</span>&nbsp;<span class="op" id="6246359">[</span><span class="num" id="6246360">1024</span>&nbsp;<span class="op" id="6246365">/</span>&nbsp;<span class="num" id="6246367">8</span>&nbsp;<span class="op" id="6246369">*</span>&nbsp;<span class="num" id="6246371">5</span><span class="op" id="6246372">]</span><span class="builtintype" id="6246373">byte</span><br>
<span class="lineno"></span><span class="op" id="6246378">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="6246381">func</span>&nbsp;<span class="op" id="6246386">(</span><span class="ident" id="6246387">d</span>&nbsp;<span class="op" id="6246389">*</span><span class="ident" id="6246390">decoder</span><span class="op" id="6246397">)</span>&nbsp;<span class="ident" id="6246399">Read</span><span class="op" id="6246403">(</span><span class="ident" id="6246404">p</span>&nbsp;<span class="op" id="6246406">[</span><span class="op" id="6246407">]</span><span class="builtintype" id="6246408">byte</span><span class="op" id="6246412">)</span>&nbsp;<span class="op" id="6246414">(</span><span class="ident" id="6246415">n</span>&nbsp;<span class="builtintype" id="6246417">int</span><span class="op" id="6246420">,</span>&nbsp;<span class="ident" id="6246422">err</span>&nbsp;<span class="builtintype" id="6246426">error</span><span class="op" id="6246431">)</span>&nbsp;<span class="op" id="6246433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246436">if</span>&nbsp;<span class="ident" id="6246439">d</span><span class="op" id="6246440">.</span><span class="ident" id="6246441">err</span>&nbsp;<span class="op" id="6246445">!=</span>&nbsp;<span class="ident" id="6246448">nil</span>&nbsp;<span class="op" id="6246452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246456">return</span>&nbsp;<span class="num" id="6246463">0</span><span class="op" id="6246464">,</span>&nbsp;<span class="ident" id="6246466">d</span><span class="op" id="6246467">.</span><span class="ident" id="6246468">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246473">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6246477">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246525">if</span>&nbsp;<span class="builtinfunc" id="6246528">len</span><span class="op" id="6246531">(</span><span class="ident" id="6246532">d</span><span class="op" id="6246533">.</span><span class="ident" id="6246534">out</span><span class="op" id="6246537">)</span>&nbsp;<span class="op" id="6246539">&gt;</span>&nbsp;<span class="num" id="6246541">0</span>&nbsp;<span class="op" id="6246543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246547">n</span>&nbsp;<span class="op" id="6246549">=</span>&nbsp;<span class="builtinfunc" id="6246551">copy</span><span class="op" id="6246555">(</span><span class="ident" id="6246556">p</span><span class="op" id="6246557">,</span>&nbsp;<span class="ident" id="6246559">d</span><span class="op" id="6246560">.</span><span class="ident" id="6246561">out</span><span class="op" id="6246564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246568">d</span><span class="op" id="6246569">.</span><span class="ident" id="6246570">out</span>&nbsp;<span class="op" id="6246574">=</span>&nbsp;<span class="ident" id="6246576">d</span><span class="op" id="6246577">.</span><span class="ident" id="6246578">out</span><span class="op" id="6246581">[</span><span class="ident" id="6246582">n</span><span class="op" id="6246583">:</span><span class="op" id="6246584">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246588">return</span>&nbsp;<span class="ident" id="6246595">n</span><span class="op" id="6246596">,</span>&nbsp;<span class="ident" id="6246598">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6246607">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246625">nn</span>&nbsp;<span class="op" id="6246628">:=</span>&nbsp;<span class="builtinfunc" id="6246631">len</span><span class="op" id="6246634">(</span><span class="ident" id="6246635">p</span><span class="op" id="6246636">)</span>&nbsp;<span class="op" id="6246638">/</span>&nbsp;<span class="num" id="6246640">5</span>&nbsp;<span class="op" id="6246642">*</span>&nbsp;<span class="num" id="6246644">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246647">if</span>&nbsp;<span class="ident" id="6246650">nn</span>&nbsp;<span class="op" id="6246653">&lt;</span>&nbsp;<span class="num" id="6246655">8</span>&nbsp;<span class="op" id="6246657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246661">nn</span>&nbsp;<span class="op" id="6246664">=</span>&nbsp;<span class="num" id="6246666">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246672">if</span>&nbsp;<span class="ident" id="6246675">nn</span>&nbsp;<span class="op" id="6246678">&gt;</span>&nbsp;<span class="builtinfunc" id="6246680">len</span><span class="op" id="6246683">(</span><span class="ident" id="6246684">d</span><span class="op" id="6246685">.</span><span class="ident" id="6246686">buf</span><span class="op" id="6246689">)</span>&nbsp;<span class="op" id="6246691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246695">nn</span>&nbsp;<span class="op" id="6246698">=</span>&nbsp;<span class="builtinfunc" id="6246700">len</span><span class="op" id="6246703">(</span><span class="ident" id="6246704">d</span><span class="op" id="6246705">.</span><span class="ident" id="6246706">buf</span><span class="op" id="6246709">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246715">nn</span><span class="op" id="6246717">,</span>&nbsp;<span class="ident" id="6246719">d</span><span class="op" id="6246720">.</span><span class="ident" id="6246721">err</span>&nbsp;<span class="op" id="6246725">=</span>&nbsp;<span class="ident" id="6246727">io</span><span class="op" id="6246729">.</span><span class="ident" id="6246730">ReadAtLeast</span><span class="op" id="6246741">(</span><span class="ident" id="6246742">d</span><span class="op" id="6246743">.</span><span class="ident" id="6246744">r</span><span class="op" id="6246745">,</span>&nbsp;<span class="ident" id="6246747">d</span><span class="op" id="6246748">.</span><span class="ident" id="6246749">buf</span><span class="op" id="6246752">[</span><span class="ident" id="6246753">d</span><span class="op" id="6246754">.</span><span class="ident" id="6246755">nbuf</span><span class="op" id="6246759">:</span><span class="ident" id="6246760">nn</span><span class="op" id="6246762">]</span><span class="op" id="6246763">,</span>&nbsp;<span class="num" id="6246765">8</span><span class="op" id="6246766">-</span><span class="ident" id="6246767">d</span><span class="op" id="6246768">.</span><span class="ident" id="6246769">nbuf</span><span class="op" id="6246773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246776">d</span><span class="op" id="6246777">.</span><span class="ident" id="6246778">nbuf</span>&nbsp;<span class="op" id="6246783">+=</span>&nbsp;<span class="ident" id="6246786">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246790">if</span>&nbsp;<span class="ident" id="6246793">d</span><span class="op" id="6246794">.</span><span class="ident" id="6246795">nbuf</span>&nbsp;<span class="op" id="6246800">&lt;</span>&nbsp;<span class="num" id="6246802">8</span>&nbsp;<span class="op" id="6246804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246808">return</span>&nbsp;<span class="num" id="6246815">0</span><span class="op" id="6246816">,</span>&nbsp;<span class="ident" id="6246818">d</span><span class="op" id="6246819">.</span><span class="ident" id="6246820">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6246829">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246893">nr</span>&nbsp;<span class="op" id="6246896">:=</span>&nbsp;<span class="ident" id="6246899">d</span><span class="op" id="6246900">.</span><span class="ident" id="6246901">nbuf</span>&nbsp;<span class="op" id="6246906">/</span>&nbsp;<span class="num" id="6246908">8</span>&nbsp;<span class="op" id="6246910">*</span>&nbsp;<span class="num" id="6246912">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246915">nw</span>&nbsp;<span class="op" id="6246918">:=</span>&nbsp;<span class="ident" id="6246921">d</span><span class="op" id="6246922">.</span><span class="ident" id="6246923">nbuf</span>&nbsp;<span class="op" id="6246928">/</span>&nbsp;<span class="num" id="6246930">8</span>&nbsp;<span class="op" id="6246932">*</span>&nbsp;<span class="num" id="6246934">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246937">if</span>&nbsp;<span class="ident" id="6246940">nw</span>&nbsp;<span class="op" id="6246943">&gt;</span>&nbsp;<span class="builtinfunc" id="6246945">len</span><span class="op" id="6246948">(</span><span class="ident" id="6246949">p</span><span class="op" id="6246950">)</span>&nbsp;<span class="op" id="6246952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246956">nw</span><span class="op" id="6246958">,</span>&nbsp;<span class="ident" id="6246960">d</span><span class="op" id="6246961">.</span><span class="ident" id="6246962">end</span><span class="op" id="6246965">,</span>&nbsp;<span class="ident" id="6246967">d</span><span class="op" id="6246968">.</span><span class="ident" id="6246969">err</span>&nbsp;<span class="op" id="6246973">=</span>&nbsp;<span class="ident" id="6246975">d</span><span class="op" id="6246976">.</span><span class="ident" id="6246977">enc</span><span class="op" id="6246980">.</span><span class="ident" id="6246981">decode</span><span class="op" id="6246987">(</span><span class="ident" id="6246988">d</span><span class="op" id="6246989">.</span><span class="ident" id="6246990">outbuf</span><span class="op" id="6246996">[</span><span class="num" id="6246997">0</span><span class="op" id="6246998">:</span><span class="op" id="6246999">]</span><span class="op" id="6247000">,</span>&nbsp;<span class="ident" id="6247002">d</span><span class="op" id="6247003">.</span><span class="ident" id="6247004">buf</span><span class="op" id="6247007">[</span><span class="num" id="6247008">0</span><span class="op" id="6247009">:</span><span class="ident" id="6247010">nr</span><span class="op" id="6247012">]</span><span class="op" id="6247013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247017">d</span><span class="op" id="6247018">.</span><span class="ident" id="6247019">out</span>&nbsp;<span class="op" id="6247023">=</span>&nbsp;<span class="ident" id="6247025">d</span><span class="op" id="6247026">.</span><span class="ident" id="6247027">outbuf</span><span class="op" id="6247033">[</span><span class="num" id="6247034">0</span><span class="op" id="6247035">:</span><span class="ident" id="6247036">nw</span><span class="op" id="6247038">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247042">n</span>&nbsp;<span class="op" id="6247044">=</span>&nbsp;<span class="builtinfunc" id="6247046">copy</span><span class="op" id="6247050">(</span><span class="ident" id="6247051">p</span><span class="op" id="6247052">,</span>&nbsp;<span class="ident" id="6247054">d</span><span class="op" id="6247055">.</span><span class="ident" id="6247056">out</span><span class="op" id="6247059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247063">d</span><span class="op" id="6247064">.</span><span class="ident" id="6247065">out</span>&nbsp;<span class="op" id="6247069">=</span>&nbsp;<span class="ident" id="6247071">d</span><span class="op" id="6247072">.</span><span class="ident" id="6247073">out</span><span class="op" id="6247076">[</span><span class="ident" id="6247077">n</span><span class="op" id="6247078">:</span><span class="op" id="6247079">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247082">}</span>&nbsp;<span class="keyword" id="6247084">else</span>&nbsp;<span class="op" id="6247089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247093">n</span><span class="op" id="6247094">,</span>&nbsp;<span class="ident" id="6247096">d</span><span class="op" id="6247097">.</span><span class="ident" id="6247098">end</span><span class="op" id="6247101">,</span>&nbsp;<span class="ident" id="6247103">d</span><span class="op" id="6247104">.</span><span class="ident" id="6247105">err</span>&nbsp;<span class="op" id="6247109">=</span>&nbsp;<span class="ident" id="6247111">d</span><span class="op" id="6247112">.</span><span class="ident" id="6247113">enc</span><span class="op" id="6247116">.</span><span class="ident" id="6247117">decode</span><span class="op" id="6247123">(</span><span class="ident" id="6247124">p</span><span class="op" id="6247125">,</span>&nbsp;<span class="ident" id="6247127">d</span><span class="op" id="6247128">.</span><span class="ident" id="6247129">buf</span><span class="op" id="6247132">[</span><span class="num" id="6247133">0</span><span class="op" id="6247134">:</span><span class="ident" id="6247135">nr</span><span class="op" id="6247137">]</span><span class="op" id="6247138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247144">d</span><span class="op" id="6247145">.</span><span class="ident" id="6247146">nbuf</span>&nbsp;<span class="op" id="6247151">-=</span>&nbsp;<span class="ident" id="6247154">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247158">for</span>&nbsp;<span class="ident" id="6247162">i</span>&nbsp;<span class="op" id="6247164">:=</span>&nbsp;<span class="num" id="6247167">0</span><span class="op" id="6247168">;</span>&nbsp;<span class="ident" id="6247170">i</span>&nbsp;<span class="op" id="6247172">&lt;</span>&nbsp;<span class="ident" id="6247174">d</span><span class="op" id="6247175">.</span><span class="ident" id="6247176">nbuf</span><span class="op" id="6247180">;</span>&nbsp;<span class="ident" id="6247182">i</span><span class="op" id="6247183">++</span>&nbsp;<span class="op" id="6247186">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247190">d</span><span class="op" id="6247191">.</span><span class="ident" id="6247192">buf</span><span class="op" id="6247195">[</span><span class="ident" id="6247196">i</span><span class="op" id="6247197">]</span>&nbsp;<span class="op" id="6247199">=</span>&nbsp;<span class="ident" id="6247201">d</span><span class="op" id="6247202">.</span><span class="ident" id="6247203">buf</span><span class="op" id="6247206">[</span><span class="ident" id="6247207">i</span><span class="op" id="6247208">+</span><span class="ident" id="6247209">nr</span><span class="op" id="6247211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247218">if</span>&nbsp;<span class="ident" id="6247221">d</span><span class="op" id="6247222">.</span><span class="ident" id="6247223">err</span>&nbsp;<span class="op" id="6247227">==</span>&nbsp;<span class="ident" id="6247230">nil</span>&nbsp;<span class="op" id="6247234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247238">d</span><span class="op" id="6247239">.</span><span class="ident" id="6247240">err</span>&nbsp;<span class="op" id="6247244">=</span>&nbsp;<span class="ident" id="6247246">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247254">return</span>&nbsp;<span class="ident" id="6247261">n</span><span class="op" id="6247262">,</span>&nbsp;<span class="ident" id="6247264">d</span><span class="op" id="6247265">.</span><span class="ident" id="6247266">err</span><br>
<span class="lineno"></span><span class="op" id="6247270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6247273">type</span>&nbsp;<span class="ident" id="6247278">newlineFilteringReader</span>&nbsp;<span class="keyword" id="6247301">struct</span>&nbsp;<span class="op" id="6247308">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247311">wrapped</span>&nbsp;<span class="ident" id="6247319">io</span><span class="op" id="6247321">.</span><span class="ident" id="6247322">Reader</span><br>
<span class="lineno"></span><span class="op" id="6247329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6247332">func</span>&nbsp;<span class="op" id="6247337">(</span><span class="ident" id="6247338">r</span>&nbsp;<span class="op" id="6247340">*</span><span class="ident" id="6247341">newlineFilteringReader</span><span class="op" id="6247363">)</span>&nbsp;<span class="ident" id="6247365">Read</span><span class="op" id="6247369">(</span><span class="ident" id="6247370">p</span>&nbsp;<span class="op" id="6247372">[</span><span class="op" id="6247373">]</span><span class="builtintype" id="6247374">byte</span><span class="op" id="6247378">)</span>&nbsp;<span class="op" id="6247380">(</span><span class="builtintype" id="6247381">int</span><span class="op" id="6247384">,</span>&nbsp;<span class="builtintype" id="6247386">error</span><span class="op" id="6247391">)</span>&nbsp;<span class="op" id="6247393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247396">n</span><span class="op" id="6247397">,</span>&nbsp;<span class="ident" id="6247399">err</span>&nbsp;<span class="op" id="6247403">:=</span>&nbsp;<span class="ident" id="6247406">r</span><span class="op" id="6247407">.</span><span class="ident" id="6247408">wrapped</span><span class="op" id="6247415">.</span><span class="ident" id="6247416">Read</span><span class="op" id="6247420">(</span><span class="ident" id="6247421">p</span><span class="op" id="6247422">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247425">for</span>&nbsp;<span class="ident" id="6247429">n</span>&nbsp;<span class="op" id="6247431">&gt;</span>&nbsp;<span class="num" id="6247433">0</span>&nbsp;<span class="op" id="6247435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247439">offset</span>&nbsp;<span class="op" id="6247446">:=</span>&nbsp;<span class="num" id="6247449">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247453">for</span>&nbsp;<span class="ident" id="6247457">i</span><span class="op" id="6247458">,</span>&nbsp;<span class="ident" id="6247460">b</span>&nbsp;<span class="op" id="6247462">:=</span>&nbsp;<span class="keyword" id="6247465">range</span>&nbsp;<span class="ident" id="6247471">p</span><span class="op" id="6247472">[</span><span class="num" id="6247473">0</span><span class="op" id="6247474">:</span><span class="ident" id="6247475">n</span><span class="op" id="6247476">]</span>&nbsp;<span class="op" id="6247478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247483">if</span>&nbsp;<span class="ident" id="6247486">b</span>&nbsp;<span class="op" id="6247488">!=</span>&nbsp;<span class="string" id="6247491">&#39;\r&#39;</span>&nbsp;<span class="op" id="6247496">&amp;&amp;</span>&nbsp;<span class="ident" id="6247499">b</span>&nbsp;<span class="op" id="6247501">!=</span>&nbsp;<span class="string" id="6247504">&#39;\n&#39;</span>&nbsp;<span class="op" id="6247509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247515">if</span>&nbsp;<span class="ident" id="6247518">i</span>&nbsp;<span class="op" id="6247520">!=</span>&nbsp;<span class="ident" id="6247523">offset</span>&nbsp;<span class="op" id="6247530">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247537">p</span><span class="op" id="6247538">[</span><span class="ident" id="6247539">offset</span><span class="op" id="6247545">]</span>&nbsp;<span class="op" id="6247547">=</span>&nbsp;<span class="ident" id="6247549">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247561">offset</span><span class="op" id="6247567">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247577">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247581">if</span>&nbsp;<span class="ident" id="6247584">offset</span>&nbsp;<span class="op" id="6247591">&gt;</span>&nbsp;<span class="num" id="6247593">0</span>&nbsp;<span class="op" id="6247595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247600">return</span>&nbsp;<span class="ident" id="6247607">offset</span><span class="op" id="6247613">,</span>&nbsp;<span class="ident" id="6247615">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6247625">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247678">n</span><span class="op" id="6247679">,</span>&nbsp;<span class="ident" id="6247681">err</span>&nbsp;<span class="op" id="6247685">=</span>&nbsp;<span class="ident" id="6247687">r</span><span class="op" id="6247688">.</span><span class="ident" id="6247689">wrapped</span><span class="op" id="6247696">.</span><span class="ident" id="6247697">Read</span><span class="op" id="6247701">(</span><span class="ident" id="6247702">p</span><span class="op" id="6247703">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247709">return</span>&nbsp;<span class="ident" id="6247716">n</span><span class="op" id="6247717">,</span>&nbsp;<span class="ident" id="6247719">err</span><br>
<span class="lineno"></span><span class="op" id="6247723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6247726">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="6247780">func</span>&nbsp;<span class="ident" id="6247785">NewDecoder</span><span class="op" id="6247795">(</span><span class="ident" id="6247796">enc</span>&nbsp;<span class="op" id="6247800">*</span><span class="ident" id="6247801">Encoding</span><span class="op" id="6247809">,</span>&nbsp;<span class="ident" id="6247811">r</span>&nbsp;<span class="ident" id="6247813">io</span><span class="op" id="6247815">.</span><span class="ident" id="6247816">Reader</span><span class="op" id="6247822">)</span>&nbsp;<span class="ident" id="6247824">io</span><span class="op" id="6247826">.</span><span class="ident" id="6247827">Reader</span>&nbsp;<span class="op" id="6247834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247837">return</span>&nbsp;<span class="op" id="6247844">&amp;</span><span class="ident" id="6247845">decoder</span><span class="op" id="6247852">{</span><span class="ident" id="6247853">enc</span><span class="op" id="6247856">:</span>&nbsp;<span class="ident" id="6247858">enc</span><span class="op" id="6247861">,</span>&nbsp;<span class="ident" id="6247863">r</span><span class="op" id="6247864">:</span>&nbsp;<span class="op" id="6247866">&amp;</span><span class="ident" id="6247867">newlineFilteringReader</span><span class="op" id="6247889">{</span><span class="ident" id="6247890">r</span><span class="op" id="6247891">}</span><span class="op" id="6247892">}</span><br>
<span class="lineno"></span><span class="op" id="6247894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6247897">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="6247967">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="6248019">func</span>&nbsp;<span class="op" id="6248024">(</span><span class="ident" id="6248025">enc</span>&nbsp;<span class="op" id="6248029">*</span><span class="ident" id="6248030">Encoding</span><span class="op" id="6248038">)</span>&nbsp;<span class="ident" id="6248040">DecodedLen</span><span class="op" id="6248050">(</span><span class="ident" id="6248051">n</span>&nbsp;<span class="builtintype" id="6248053">int</span><span class="op" id="6248056">)</span>&nbsp;<span class="builtintype" id="6248058">int</span>&nbsp;<span class="op" id="6248062">{</span>&nbsp;<span class="keyword" id="6248064">return</span>&nbsp;<span class="ident" id="6248071">n</span>&nbsp;<span class="op" id="6248073">/</span>&nbsp;<span class="num" id="6248075">8</span>&nbsp;<span class="op" id="6248077">*</span>&nbsp;<span class="num" id="6248079">5</span>&nbsp;<span class="op" id="6248081">}</span>
</div>
</body>
</html>
