<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7646677">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7646732">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7646786">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7646837">package</span>&nbsp;<span class="ident" id="7646845">rpc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7646850">import</span>&nbsp;<span class="op" id="7646857">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646860">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646870">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646877">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646883">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646890">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646897">&#34;net/http/httptest&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646918">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646929">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646940">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646948">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646963">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7646974">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="7646981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7646984">var</span>&nbsp;<span class="op" id="7646988">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7646991">newServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7647017">*</span><span class="ident" id="7647018"><a href="/net/rpc/server.go.html#5794851">Server</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7647026">serverAddr</span><span class="op" id="7647036">,</span>&nbsp;<span class="ident" id="7647038">newServerAddr</span>&nbsp;<span class="builtintype" id="7647052">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7647060">httpServerAddr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7647086">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7647094">once</span><span class="op" id="7647098">,</span>&nbsp;<span class="ident" id="7647100">newOnce</span><span class="op" id="7647107">,</span>&nbsp;<span class="ident" id="7647109">httpOnce</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7647120"><a href="/net/rpc/server_test.go.html#7646940">sync</a></span><span class="op" id="7647124">.</span><span class="ident" id="7647125">Once</span><br>
<span class="lineno"></span><span class="op" id="7647130">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7647133">const</span>&nbsp;<span class="op" id="7647139">(</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7647142">newHttpPath</span>&nbsp;<span class="op" id="7647154">=</span>&nbsp;<span class="string" id="7647156">&#34;/foo&#34;</span><br>
<span class="lineno"></span><span class="op" id="7647163">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7647166">type</span>&nbsp;<span class="ident" id="7647171">Args</span>&nbsp;<span class="keyword" id="7647176">struct</span>&nbsp;<span class="op" id="7647183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7647186">A</span><span class="op" id="7647187">,</span>&nbsp;<span class="ident" id="7647189">B</span>&nbsp;<span class="builtintype" id="7647191">int</span><br>
<span class="lineno">35</span><span class="op" id="7647195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7647198">type</span>&nbsp;<span class="ident" id="7647203">Reply</span>&nbsp;<span class="keyword" id="7647209">struct</span>&nbsp;<span class="op" id="7647216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7647219">C</span>&nbsp;<span class="builtintype" id="7647221">int</span><br>
<span class="lineno"></span><span class="op" id="7647225">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="7647228">type</span>&nbsp;<span class="ident" id="7647233">Arith</span>&nbsp;<span class="builtintype" id="7647239">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7647244">//&nbsp;Some&nbsp;of&nbsp;Arith&#39;s&nbsp;methods&nbsp;have&nbsp;value&nbsp;args,&nbsp;some&nbsp;have&nbsp;pointer&nbsp;args.&nbsp;That&#39;s&nbsp;deliberate.</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7647332">func</span>&nbsp;<span class="op" id="7647337">(</span><span class="ident" id="7647338">t</span>&nbsp;<span class="op" id="7647340">*</span><span class="ident" id="7647341"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7647346">)</span>&nbsp;<span class="ident" id="7647348">Add</span><span class="op" id="7647351">(</span><span class="ident" id="7647352">args</span>&nbsp;<span class="ident" id="7647357"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7647361">,</span>&nbsp;<span class="ident" id="7647363">reply</span>&nbsp;<span class="op" id="7647369">*</span><span class="ident" id="7647370"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7647375">)</span>&nbsp;<span class="builtintype" id="7647377">error</span>&nbsp;<span class="op" id="7647383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7647386"><a href="/net/rpc/server_test.go.html#7647363">reply</a></span><span class="op" id="7647391">.</span><span class="ident" id="7647392">C</span>&nbsp;<span class="op" id="7647394">=</span>&nbsp;<span class="ident" id="7647396"><a href="/net/rpc/server_test.go.html#7647352">args</a></span><span class="op" id="7647400">.</span><span class="ident" id="7647401">A</span>&nbsp;<span class="op" id="7647403">+</span>&nbsp;<span class="ident" id="7647405"><a href="/net/rpc/server_test.go.html#7647352">args</a></span><span class="op" id="7647409">.</span><span class="ident" id="7647410">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7647413">return</span>&nbsp;<span class="ident" id="7647420">nil</span><br>
<span class="lineno"></span><span class="op" id="7647424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="7647427">func</span>&nbsp;<span class="op" id="7647432">(</span><span class="ident" id="7647433">t</span>&nbsp;<span class="op" id="7647435">*</span><span class="ident" id="7647436"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7647441">)</span>&nbsp;<span class="ident" id="7647443">Mul</span><span class="op" id="7647446">(</span><span class="ident" id="7647447">args</span>&nbsp;<span class="op" id="7647452">*</span><span class="ident" id="7647453"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7647457">,</span>&nbsp;<span class="ident" id="7647459">reply</span>&nbsp;<span class="op" id="7647465">*</span><span class="ident" id="7647466"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7647471">)</span>&nbsp;<span class="builtintype" id="7647473">error</span>&nbsp;<span class="op" id="7647479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7647482"><a href="/net/rpc/server_test.go.html#7647459">reply</a></span><span class="op" id="7647487">.</span><span class="ident" id="7647488">C</span>&nbsp;<span class="op" id="7647490">=</span>&nbsp;<span class="ident" id="7647492"><a href="/net/rpc/server_test.go.html#7647447">args</a></span><span class="op" id="7647496">.</span><span class="ident" id="7647497">A</span>&nbsp;<span class="op" id="7647499">*</span>&nbsp;<span class="ident" id="7647501"><a href="/net/rpc/server_test.go.html#7647447">args</a></span><span class="op" id="7647505">.</span><span class="ident" id="7647506">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7647509">return</span>&nbsp;<span class="ident" id="7647516">nil</span><br>
<span class="lineno"></span><span class="op" id="7647520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="7647523">func</span>&nbsp;<span class="op" id="7647528">(</span><span class="ident" id="7647529">t</span>&nbsp;<span class="op" id="7647531">*</span><span class="ident" id="7647532"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7647537">)</span>&nbsp;<span class="ident" id="7647539">Div</span><span class="op" id="7647542">(</span><span class="ident" id="7647543">args</span>&nbsp;<span class="ident" id="7647548"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7647552">,</span>&nbsp;<span class="ident" id="7647554">reply</span>&nbsp;<span class="op" id="7647560">*</span><span class="ident" id="7647561"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7647566">)</span>&nbsp;<span class="builtintype" id="7647568">error</span>&nbsp;<span class="op" id="7647574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7647577">if</span>&nbsp;<span class="ident" id="7647580"><a href="/net/rpc/server_test.go.html#7647543">args</a></span><span class="op" id="7647584">.</span><span class="ident" id="7647585">B</span>&nbsp;<span class="op" id="7647587">==</span>&nbsp;<span class="num" id="7647590">0</span>&nbsp;<span class="op" id="7647592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7647596">return</span>&nbsp;<span class="ident" id="7647603"><a href="/net/rpc/server_test.go.html#7646860">errors</a></span><span class="op" id="7647609">.</span><span class="ident" id="7647610">New</span><span class="op" id="7647613">(</span><span class="string" id="7647614">&#34;divide&nbsp;by&nbsp;zero&#34;</span><span class="op" id="7647630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7647633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7647636"><a href="/net/rpc/server_test.go.html#7647554">reply</a></span><span class="op" id="7647641">.</span><span class="ident" id="7647642">C</span>&nbsp;<span class="op" id="7647644">=</span>&nbsp;<span class="ident" id="7647646"><a href="/net/rpc/server_test.go.html#7647543">args</a></span><span class="op" id="7647650">.</span><span class="ident" id="7647651">A</span>&nbsp;<span class="op" id="7647653">/</span>&nbsp;<span class="ident" id="7647655"><a href="/net/rpc/server_test.go.html#7647543">args</a></span><span class="op" id="7647659">.</span><span class="ident" id="7647660">B</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7647663">return</span>&nbsp;<span class="ident" id="7647670">nil</span><br>
<span class="lineno"></span><span class="op" id="7647674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7647677">func</span>&nbsp;<span class="op" id="7647682">(</span><span class="ident" id="7647683">t</span>&nbsp;<span class="op" id="7647685">*</span><span class="ident" id="7647686"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7647691">)</span>&nbsp;<span class="ident" id="7647693">String</span><span class="op" id="7647699">(</span><span class="ident" id="7647700">args</span>&nbsp;<span class="op" id="7647705">*</span><span class="ident" id="7647706"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7647710">,</span>&nbsp;<span class="ident" id="7647712">reply</span>&nbsp;<span class="op" id="7647718">*</span><span class="builtintype" id="7647719">string</span><span class="op" id="7647725">)</span>&nbsp;<span class="builtintype" id="7647727">error</span>&nbsp;<span class="op" id="7647733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7647736">*</span><span class="ident" id="7647737"><a href="/net/rpc/server_test.go.html#7647712">reply</a></span>&nbsp;<span class="op" id="7647743">=</span>&nbsp;<span class="ident" id="7647745"><a href="/net/rpc/server_test.go.html#7646870">fmt</a></span><span class="op" id="7647748">.</span><span class="ident" id="7647749">Sprintf</span><span class="op" id="7647756">(</span><span class="string" id="7647757">&#34;%d+%d=%d&#34;</span><span class="op" id="7647767">,</span>&nbsp;<span class="ident" id="7647769"><a href="/net/rpc/server_test.go.html#7647700">args</a></span><span class="op" id="7647773">.</span><span class="ident" id="7647774">A</span><span class="op" id="7647775">,</span>&nbsp;<span class="ident" id="7647777"><a href="/net/rpc/server_test.go.html#7647700">args</a></span><span class="op" id="7647781">.</span><span class="ident" id="7647782">B</span><span class="op" id="7647783">,</span>&nbsp;<span class="ident" id="7647785"><a href="/net/rpc/server_test.go.html#7647700">args</a></span><span class="op" id="7647789">.</span><span class="ident" id="7647790">A</span><span class="op" id="7647791">+</span><span class="ident" id="7647792"><a href="/net/rpc/server_test.go.html#7647700">args</a></span><span class="op" id="7647796">.</span><span class="ident" id="7647797">B</span><span class="op" id="7647798">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7647801">return</span>&nbsp;<span class="ident" id="7647808">nil</span><br>
<span class="lineno"></span><span class="op" id="7647812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7647815">func</span>&nbsp;<span class="op" id="7647820">(</span><span class="ident" id="7647821">t</span>&nbsp;<span class="op" id="7647823">*</span><span class="ident" id="7647824"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7647829">)</span>&nbsp;<span class="ident" id="7647831">Scan</span><span class="op" id="7647835">(</span><span class="ident" id="7647836">args</span>&nbsp;<span class="builtintype" id="7647841">string</span><span class="op" id="7647847">,</span>&nbsp;<span class="ident" id="7647849">reply</span>&nbsp;<span class="op" id="7647855">*</span><span class="ident" id="7647856"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7647861">)</span>&nbsp;<span class="op" id="7647863">(</span><span class="ident" id="7647864">err</span>&nbsp;<span class="builtintype" id="7647868">error</span><span class="op" id="7647873">)</span>&nbsp;<span class="op" id="7647875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7647878">_</span><span class="op" id="7647879">,</span>&nbsp;<span class="ident" id="7647881"><a href="/net/rpc/server_test.go.html#7647864">err</a></span>&nbsp;<span class="op" id="7647885">=</span>&nbsp;<span class="ident" id="7647887"><a href="/net/rpc/server_test.go.html#7646870">fmt</a></span><span class="op" id="7647890">.</span><span class="ident" id="7647891">Sscan</span><span class="op" id="7647896">(</span><span class="ident" id="7647897"><a href="/net/rpc/server_test.go.html#7647836">args</a></span><span class="op" id="7647901">,</span>&nbsp;<span class="op" id="7647903">&amp;</span><span class="ident" id="7647904"><a href="/net/rpc/server_test.go.html#7647849">reply</a></span><span class="op" id="7647909">.</span><span class="ident" id="7647910">C</span><span class="op" id="7647911">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7647914">return</span><br>
<span class="lineno"></span><span class="op" id="7647921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7647924">func</span>&nbsp;<span class="op" id="7647929">(</span><span class="ident" id="7647930">t</span>&nbsp;<span class="op" id="7647932">*</span><span class="ident" id="7647933"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7647938">)</span>&nbsp;<span class="ident" id="7647940">Error</span><span class="op" id="7647945">(</span><span class="ident" id="7647946">args</span>&nbsp;<span class="op" id="7647951">*</span><span class="ident" id="7647952"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7647956">,</span>&nbsp;<span class="ident" id="7647958">reply</span>&nbsp;<span class="op" id="7647964">*</span><span class="ident" id="7647965"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7647970">)</span>&nbsp;<span class="builtintype" id="7647972">error</span>&nbsp;<span class="op" id="7647978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7647981">panic</span><span class="op" id="7647986">(</span><span class="string" id="7647987">&#34;ERROR&#34;</span><span class="op" id="7647994">)</span><br>
<span class="lineno">75</span><span class="op" id="7647996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7647999">func</span>&nbsp;<span class="ident" id="7648004">listenTCP</span><span class="op" id="7648013">(</span><span class="op" id="7648014">)</span>&nbsp;<span class="op" id="7648016">(</span><span class="ident" id="7648017"><a href="/net/rpc/server_test.go.html#7646890">net</a></span><span class="op" id="7648020">.</span><span class="ident" id="7648021">Listener</span><span class="op" id="7648029">,</span>&nbsp;<span class="builtintype" id="7648031">string</span><span class="op" id="7648037">)</span>&nbsp;<span class="op" id="7648039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648042">l</span><span class="op" id="7648043">,</span>&nbsp;<span class="ident" id="7648045">e</span>&nbsp;<span class="op" id="7648047">:=</span>&nbsp;<span class="ident" id="7648050"><a href="/net/rpc/server_test.go.html#7646890">net</a></span><span class="op" id="7648053">.</span><span class="ident" id="7648054">Listen</span><span class="op" id="7648060">(</span><span class="string" id="7648061">&#34;tcp&#34;</span><span class="op" id="7648066">,</span>&nbsp;<span class="string" id="7648068">&#34;127.0.0.1:0&#34;</span><span class="op" id="7648081">)</span>&nbsp;<span class="comment" id="7648083">//&nbsp;any&nbsp;available&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7648109">if</span>&nbsp;<span class="ident" id="7648112"><a href="/net/rpc/server_test.go.html#7648045">e</a></span>&nbsp;<span class="op" id="7648114">!=</span>&nbsp;<span class="ident" id="7648117">nil</span>&nbsp;<span class="op" id="7648121">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648125"><a href="/net/rpc/server_test.go.html#7646883">log</a></span><span class="op" id="7648128">.</span><span class="ident" id="7648129">Fatalf</span><span class="op" id="7648135">(</span><span class="string" id="7648136">&#34;net.Listen&nbsp;tcp&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="7648159">,</span>&nbsp;<span class="ident" id="7648161"><a href="/net/rpc/server_test.go.html#7648045">e</a></span><span class="op" id="7648162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7648165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7648168">return</span>&nbsp;<span class="ident" id="7648175"><a href="/net/rpc/server_test.go.html#7648042">l</a></span><span class="op" id="7648176">,</span>&nbsp;<span class="ident" id="7648178"><a href="/net/rpc/server_test.go.html#7648042">l</a></span><span class="op" id="7648179">.</span><span class="ident" id="7648180">Addr</span><span class="op" id="7648184">(</span><span class="op" id="7648185">)</span><span class="op" id="7648186">.</span><span class="ident" id="7648187">String</span><span class="op" id="7648193">(</span><span class="op" id="7648194">)</span><br>
<span class="lineno"></span><span class="op" id="7648196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="7648199">func</span>&nbsp;<span class="ident" id="7648204">startServer</span><span class="op" id="7648215">(</span><span class="op" id="7648216">)</span>&nbsp;<span class="op" id="7648218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648221"><a href="/net/rpc/server.go.html#5807380">Register</a></span><span class="op" id="7648229">(</span><span class="builtinfunc" id="7648230">new</span><span class="op" id="7648233">(</span><span class="ident" id="7648234"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7648239">)</span><span class="op" id="7648240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648243"><a href="/net/rpc/server.go.html#5807576">RegisterName</a></span><span class="op" id="7648255">(</span><span class="string" id="7648256">&#34;net.rpc.Arith&#34;</span><span class="op" id="7648271">,</span>&nbsp;<span class="builtinfunc" id="7648273">new</span><span class="op" id="7648276">(</span><span class="ident" id="7648277"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7648282">)</span><span class="op" id="7648283">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7648287">var</span>&nbsp;<span class="ident" id="7648291">l</span>&nbsp;<span class="ident" id="7648293"><a href="/net/rpc/server_test.go.html#7646890">net</a></span><span class="op" id="7648296">.</span><span class="ident" id="7648297">Listener</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648307"><a href="/net/rpc/server_test.go.html#7648291">l</a></span><span class="op" id="7648308">,</span>&nbsp;<span class="ident" id="7648310"><a href="/net/rpc/server_test.go.html#7647026">serverAddr</a></span>&nbsp;<span class="op" id="7648321">=</span>&nbsp;<span class="ident" id="7648323"><a href="/net/rpc/server_test.go.html#7648004">listenTCP</a></span><span class="op" id="7648332">(</span><span class="op" id="7648333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648336"><a href="/net/rpc/server_test.go.html#7646883">log</a></span><span class="op" id="7648339">.</span><span class="ident" id="7648340">Println</span><span class="op" id="7648347">(</span><span class="string" id="7648348">&#34;Test&nbsp;RPC&nbsp;server&nbsp;listening&nbsp;on&#34;</span><span class="op" id="7648378">,</span>&nbsp;<span class="ident" id="7648380"><a href="/net/rpc/server_test.go.html#7647026">serverAddr</a></span><span class="op" id="7648390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7648393">go</span>&nbsp;<span class="ident" id="7648396"><a href="/net/rpc/server.go.html#5809351">Accept</a></span><span class="op" id="7648402">(</span><span class="ident" id="7648403"><a href="/net/rpc/server_test.go.html#7648291">l</a></span><span class="op" id="7648404">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648408"><a href="/net/rpc/server.go.html#5810611">HandleHTTP</a></span><span class="op" id="7648418">(</span><span class="op" id="7648419">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648422"><a href="/net/rpc/server_test.go.html#7647109">httpOnce</a></span><span class="op" id="7648430">.</span><span class="ident" id="7648431">Do</span><span class="op" id="7648433">(</span><span class="ident" id="7648434"><a href="/net/rpc/server_test.go.html#7648872">startHttpServer</a></span><span class="op" id="7648449">)</span><br>
<span class="lineno"></span><span class="op" id="7648451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7648454">func</span>&nbsp;<span class="ident" id="7648459">startNewServer</span><span class="op" id="7648473">(</span><span class="op" id="7648474">)</span>&nbsp;<span class="op" id="7648476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648479"><a href="/net/rpc/server_test.go.html#7646991">newServer</a></span>&nbsp;<span class="op" id="7648489">=</span>&nbsp;<span class="ident" id="7648491"><a href="/net/rpc/server.go.html#5795124">NewServer</a></span><span class="op" id="7648500">(</span><span class="op" id="7648501">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648504"><a href="/net/rpc/server_test.go.html#7646991">newServer</a></span><span class="op" id="7648513">.</span><span class="ident" id="7648514">Register</span><span class="op" id="7648522">(</span><span class="builtinfunc" id="7648523">new</span><span class="op" id="7648526">(</span><span class="ident" id="7648527"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7648532">)</span><span class="op" id="7648533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648536"><a href="/net/rpc/server_test.go.html#7646991">newServer</a></span><span class="op" id="7648545">.</span><span class="ident" id="7648546">RegisterName</span><span class="op" id="7648558">(</span><span class="string" id="7648559">&#34;net.rpc.Arith&#34;</span><span class="op" id="7648574">,</span>&nbsp;<span class="builtinfunc" id="7648576">new</span><span class="op" id="7648579">(</span><span class="ident" id="7648580"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7648585">)</span><span class="op" id="7648586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648589"><a href="/net/rpc/server_test.go.html#7646991">newServer</a></span><span class="op" id="7648598">.</span><span class="ident" id="7648599">RegisterName</span><span class="op" id="7648611">(</span><span class="string" id="7648612">&#34;newServer.Arith&#34;</span><span class="op" id="7648629">,</span>&nbsp;<span class="builtinfunc" id="7648631">new</span><span class="op" id="7648634">(</span><span class="ident" id="7648635"><a href="/net/rpc/server_test.go.html#7647233">Arith</a></span><span class="op" id="7648640">)</span><span class="op" id="7648641">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7648645">var</span>&nbsp;<span class="ident" id="7648649">l</span>&nbsp;<span class="ident" id="7648651"><a href="/net/rpc/server_test.go.html#7646890">net</a></span><span class="op" id="7648654">.</span><span class="ident" id="7648655">Listener</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648665"><a href="/net/rpc/server_test.go.html#7648649">l</a></span><span class="op" id="7648666">,</span>&nbsp;<span class="ident" id="7648668"><a href="/net/rpc/server_test.go.html#7647038">newServerAddr</a></span>&nbsp;<span class="op" id="7648682">=</span>&nbsp;<span class="ident" id="7648684"><a href="/net/rpc/server_test.go.html#7648004">listenTCP</a></span><span class="op" id="7648693">(</span><span class="op" id="7648694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648697"><a href="/net/rpc/server_test.go.html#7646883">log</a></span><span class="op" id="7648700">.</span><span class="ident" id="7648701">Println</span><span class="op" id="7648708">(</span><span class="string" id="7648709">&#34;NewServer&nbsp;test&nbsp;RPC&nbsp;server&nbsp;listening&nbsp;on&#34;</span><span class="op" id="7648749">,</span>&nbsp;<span class="ident" id="7648751"><a href="/net/rpc/server_test.go.html#7647038">newServerAddr</a></span><span class="op" id="7648764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7648767">go</span>&nbsp;<span class="ident" id="7648770"><a href="/net/rpc/server_test.go.html#7646991">newServer</a></span><span class="op" id="7648779">.</span><span class="ident" id="7648780">Accept</span><span class="op" id="7648786">(</span><span class="ident" id="7648787"><a href="/net/rpc/server_test.go.html#7648649">l</a></span><span class="op" id="7648788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648792"><a href="/net/rpc/server_test.go.html#7646991">newServer</a></span><span class="op" id="7648801">.</span><span class="ident" id="7648802">HandleHTTP</span><span class="op" id="7648812">(</span><span class="ident" id="7648813"><a href="/net/rpc/server_test.go.html#7647142">newHttpPath</a></span><span class="op" id="7648824">,</span>&nbsp;<span class="string" id="7648826">&#34;/bar&#34;</span><span class="op" id="7648832">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648835"><a href="/net/rpc/server_test.go.html#7647109">httpOnce</a></span><span class="op" id="7648843">.</span><span class="ident" id="7648844">Do</span><span class="op" id="7648846">(</span><span class="ident" id="7648847"><a href="/net/rpc/server_test.go.html#7648872">startHttpServer</a></span><span class="op" id="7648862">)</span><br>
<span class="lineno"></span><span class="op" id="7648864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7648867">func</span>&nbsp;<span class="ident" id="7648872">startHttpServer</span><span class="op" id="7648887">(</span><span class="op" id="7648888">)</span>&nbsp;<span class="op" id="7648890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648893">server</span>&nbsp;<span class="op" id="7648900">:=</span>&nbsp;<span class="ident" id="7648903"><a href="/net/rpc/server_test.go.html#7646897">httptest</a></span><span class="op" id="7648911">.</span><span class="ident" id="7648912">NewServer</span><span class="op" id="7648921">(</span><span class="ident" id="7648922">nil</span><span class="op" id="7648925">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648928"><a href="/net/rpc/server_test.go.html#7647060">httpServerAddr</a></span>&nbsp;<span class="op" id="7648943">=</span>&nbsp;<span class="ident" id="7648945"><a href="/net/rpc/server_test.go.html#7648893">server</a></span><span class="op" id="7648951">.</span><span class="ident" id="7648952">Listener</span><span class="op" id="7648960">.</span><span class="ident" id="7648961">Addr</span><span class="op" id="7648965">(</span><span class="op" id="7648966">)</span><span class="op" id="7648967">.</span><span class="ident" id="7648968">String</span><span class="op" id="7648974">(</span><span class="op" id="7648975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7648978"><a href="/net/rpc/server_test.go.html#7646883">log</a></span><span class="op" id="7648981">.</span><span class="ident" id="7648982">Println</span><span class="op" id="7648989">(</span><span class="string" id="7648990">&#34;Test&nbsp;HTTP&nbsp;RPC&nbsp;server&nbsp;listening&nbsp;on&#34;</span><span class="op" id="7649025">,</span>&nbsp;<span class="ident" id="7649027"><a href="/net/rpc/server_test.go.html#7647060">httpServerAddr</a></span><span class="op" id="7649041">)</span><br>
<span class="lineno"></span><span class="op" id="7649043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7649046">func</span>&nbsp;<span class="ident" id="7649051">TestRPC</span><span class="op" id="7649058">(</span><span class="ident" id="7649059">t</span>&nbsp;<span class="op" id="7649061">*</span><span class="ident" id="7649062"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7649069">.</span><span class="ident" id="7649070">T</span><span class="op" id="7649071">)</span>&nbsp;<span class="op" id="7649073">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649076"><a href="/net/rpc/server_test.go.html#7647094">once</a></span><span class="op" id="7649080">.</span><span class="ident" id="7649081">Do</span><span class="op" id="7649083">(</span><span class="ident" id="7649084"><a href="/net/rpc/server_test.go.html#7648204">startServer</a></span><span class="op" id="7649095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649098"><a href="/net/rpc/server_test.go.html#7649220">testRPC</a></span><span class="op" id="7649105">(</span><span class="ident" id="7649106"><a href="/net/rpc/server_test.go.html#7649059">t</a></span><span class="op" id="7649107">,</span>&nbsp;<span class="ident" id="7649109"><a href="/net/rpc/server_test.go.html#7647026">serverAddr</a></span><span class="op" id="7649119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649122"><a href="/net/rpc/server_test.go.html#7647100">newOnce</a></span><span class="op" id="7649129">.</span><span class="ident" id="7649130">Do</span><span class="op" id="7649132">(</span><span class="ident" id="7649133"><a href="/net/rpc/server_test.go.html#7648459">startNewServer</a></span><span class="op" id="7649147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649150"><a href="/net/rpc/server_test.go.html#7649220">testRPC</a></span><span class="op" id="7649157">(</span><span class="ident" id="7649158"><a href="/net/rpc/server_test.go.html#7649059">t</a></span><span class="op" id="7649159">,</span>&nbsp;<span class="ident" id="7649161"><a href="/net/rpc/server_test.go.html#7647038">newServerAddr</a></span><span class="op" id="7649174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649177"><a href="/net/rpc/server_test.go.html#7652799">testNewServerRPC</a></span><span class="op" id="7649193">(</span><span class="ident" id="7649194"><a href="/net/rpc/server_test.go.html#7649059">t</a></span><span class="op" id="7649195">,</span>&nbsp;<span class="ident" id="7649197"><a href="/net/rpc/server_test.go.html#7647038">newServerAddr</a></span><span class="op" id="7649210">)</span><br>
<span class="lineno">125</span><span class="op" id="7649212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7649215">func</span>&nbsp;<span class="ident" id="7649220">testRPC</span><span class="op" id="7649227">(</span><span class="ident" id="7649228">t</span>&nbsp;<span class="op" id="7649230">*</span><span class="ident" id="7649231"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7649238">.</span><span class="ident" id="7649239">T</span><span class="op" id="7649240">,</span>&nbsp;<span class="ident" id="7649242">addr</span>&nbsp;<span class="builtintype" id="7649247">string</span><span class="op" id="7649253">)</span>&nbsp;<span class="op" id="7649255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649258">client</span><span class="op" id="7649264">,</span>&nbsp;<span class="ident" id="7649266">err</span>&nbsp;<span class="op" id="7649270">:=</span>&nbsp;<span class="ident" id="7649273"><a href="/net/rpc/client.go.html#5785360">Dial</a></span><span class="op" id="7649277">(</span><span class="string" id="7649278">&#34;tcp&#34;</span><span class="op" id="7649283">,</span>&nbsp;<span class="ident" id="7649285"><a href="/net/rpc/server_test.go.html#7649242">addr</a></span><span class="op" id="7649289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7649292">if</span>&nbsp;<span class="ident" id="7649295"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7649299">!=</span>&nbsp;<span class="ident" id="7649302">nil</span>&nbsp;<span class="op" id="7649306">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649310"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7649311">.</span><span class="ident" id="7649312">Fatal</span><span class="op" id="7649317">(</span><span class="string" id="7649318">&#34;dialing&#34;</span><span class="op" id="7649327">,</span>&nbsp;<span class="ident" id="7649329"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7649332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7649335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7649338">defer</span>&nbsp;<span class="ident" id="7649344"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7649350">.</span><span class="ident" id="7649351">Close</span><span class="op" id="7649356">(</span><span class="op" id="7649357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7649361">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649383">args</span>&nbsp;<span class="op" id="7649388">:=</span>&nbsp;<span class="op" id="7649391">&amp;</span><span class="ident" id="7649392"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7649396">{</span><span class="num" id="7649397">7</span><span class="op" id="7649398">,</span>&nbsp;<span class="num" id="7649400">8</span><span class="op" id="7649401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649404">reply</span>&nbsp;<span class="op" id="7649410">:=</span>&nbsp;<span class="builtinfunc" id="7649413">new</span><span class="op" id="7649416">(</span><span class="ident" id="7649417"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7649422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649425"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7649429">=</span>&nbsp;<span class="ident" id="7649431"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7649437">.</span><span class="ident" id="7649438">Call</span><span class="op" id="7649442">(</span><span class="string" id="7649443">&#34;Arith.Add&#34;</span><span class="op" id="7649454">,</span>&nbsp;<span class="ident" id="7649456"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7649460">,</span>&nbsp;<span class="ident" id="7649462"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7649467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7649470">if</span>&nbsp;<span class="ident" id="7649473"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7649477">!=</span>&nbsp;<span class="ident" id="7649480">nil</span>&nbsp;<span class="op" id="7649484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649488"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7649489">.</span><span class="ident" id="7649490">Errorf</span><span class="op" id="7649496">(</span><span class="string" id="7649497">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7649539">,</span>&nbsp;<span class="ident" id="7649541"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7649544">.</span><span class="ident" id="7649545">Error</span><span class="op" id="7649550">(</span><span class="op" id="7649551">)</span><span class="op" id="7649552">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7649555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7649558">if</span>&nbsp;<span class="ident" id="7649561"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7649566">.</span><span class="ident" id="7649567">C</span>&nbsp;<span class="op" id="7649569">!=</span>&nbsp;<span class="ident" id="7649572"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7649576">.</span><span class="ident" id="7649577">A</span><span class="op" id="7649578">+</span><span class="ident" id="7649579"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7649583">.</span><span class="ident" id="7649584">B</span>&nbsp;<span class="op" id="7649586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649590"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7649591">.</span><span class="ident" id="7649592">Errorf</span><span class="op" id="7649598">(</span><span class="string" id="7649599">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7649624">,</span>&nbsp;<span class="ident" id="7649626"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7649631">.</span><span class="ident" id="7649632">C</span><span class="op" id="7649633">,</span>&nbsp;<span class="ident" id="7649635"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7649639">.</span><span class="ident" id="7649640">A</span><span class="op" id="7649641">+</span><span class="ident" id="7649642"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7649646">.</span><span class="ident" id="7649647">B</span><span class="op" id="7649648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7649651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7649655">//&nbsp;Nonexistent&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649678"><a href="/net/rpc/server_test.go.html#7649383">args</a></span>&nbsp;<span class="op" id="7649683">=</span>&nbsp;<span class="op" id="7649685">&amp;</span><span class="ident" id="7649686"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7649690">{</span><span class="num" id="7649691">7</span><span class="op" id="7649692">,</span>&nbsp;<span class="num" id="7649694">0</span><span class="op" id="7649695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649698"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span>&nbsp;<span class="op" id="7649704">=</span>&nbsp;<span class="builtinfunc" id="7649706">new</span><span class="op" id="7649709">(</span><span class="ident" id="7649710"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7649715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649718"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7649722">=</span>&nbsp;<span class="ident" id="7649724"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7649730">.</span><span class="ident" id="7649731">Call</span><span class="op" id="7649735">(</span><span class="string" id="7649736">&#34;Arith.BadOperation&#34;</span><span class="op" id="7649756">,</span>&nbsp;<span class="ident" id="7649758"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7649762">,</span>&nbsp;<span class="ident" id="7649764"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7649769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7649772">//&nbsp;expect&nbsp;an&nbsp;error</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7649792">if</span>&nbsp;<span class="ident" id="7649795"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7649799">==</span>&nbsp;<span class="ident" id="7649802">nil</span>&nbsp;<span class="op" id="7649806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649810"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7649811">.</span><span class="ident" id="7649812">Error</span><span class="op" id="7649817">(</span><span class="string" id="7649818">&#34;BadOperation:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7649848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7649851">}</span>&nbsp;<span class="keyword" id="7649853">else</span>&nbsp;<span class="keyword" id="7649858">if</span>&nbsp;<span class="op" id="7649861">!</span><span class="ident" id="7649862"><a href="/net/rpc/server_test.go.html#7646929">strings</a></span><span class="op" id="7649869">.</span><span class="ident" id="7649870">HasPrefix</span><span class="op" id="7649879">(</span><span class="ident" id="7649880"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7649883">.</span><span class="ident" id="7649884">Error</span><span class="op" id="7649889">(</span><span class="op" id="7649890">)</span><span class="op" id="7649891">,</span>&nbsp;<span class="string" id="7649893">&#34;rpc:&nbsp;can&#39;t&nbsp;find&nbsp;method&nbsp;&#34;</span><span class="op" id="7649918">)</span>&nbsp;<span class="op" id="7649920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7649924"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7649925">.</span><span class="ident" id="7649926">Errorf</span><span class="op" id="7649932">(</span><span class="string" id="7649933">&#34;BadOperation:&nbsp;expected&nbsp;can&#39;t&nbsp;find&nbsp;method&nbsp;error;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7649989">,</span>&nbsp;<span class="ident" id="7649991"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7649994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7649997">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7650001">//&nbsp;Unknown&nbsp;service</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650021"><a href="/net/rpc/server_test.go.html#7649383">args</a></span>&nbsp;<span class="op" id="7650026">=</span>&nbsp;<span class="op" id="7650028">&amp;</span><span class="ident" id="7650029"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7650033">{</span><span class="num" id="7650034">7</span><span class="op" id="7650035">,</span>&nbsp;<span class="num" id="7650037">8</span><span class="op" id="7650038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650041"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span>&nbsp;<span class="op" id="7650047">=</span>&nbsp;<span class="builtinfunc" id="7650049">new</span><span class="op" id="7650052">(</span><span class="ident" id="7650053"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7650058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650061"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7650065">=</span>&nbsp;<span class="ident" id="7650067"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7650073">.</span><span class="ident" id="7650074">Call</span><span class="op" id="7650078">(</span><span class="string" id="7650079">&#34;Arith.Unknown&#34;</span><span class="op" id="7650094">,</span>&nbsp;<span class="ident" id="7650096"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650100">,</span>&nbsp;<span class="ident" id="7650102"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7650107">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7650110">if</span>&nbsp;<span class="ident" id="7650113"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7650117">==</span>&nbsp;<span class="ident" id="7650120">nil</span>&nbsp;<span class="op" id="7650124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650128"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7650129">.</span><span class="ident" id="7650130">Error</span><span class="op" id="7650135">(</span><span class="string" id="7650136">&#34;expected&nbsp;error&nbsp;calling&nbsp;unknown&nbsp;service&#34;</span><span class="op" id="7650176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7650179">}</span>&nbsp;<span class="keyword" id="7650181">else</span>&nbsp;<span class="keyword" id="7650186">if</span>&nbsp;<span class="ident" id="7650189"><a href="/net/rpc/server_test.go.html#7646929">strings</a></span><span class="op" id="7650196">.</span><span class="ident" id="7650197">Index</span><span class="op" id="7650202">(</span><span class="ident" id="7650203"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7650206">.</span><span class="ident" id="7650207">Error</span><span class="op" id="7650212">(</span><span class="op" id="7650213">)</span><span class="op" id="7650214">,</span>&nbsp;<span class="string" id="7650216">&#34;method&#34;</span><span class="op" id="7650224">)</span>&nbsp;<span class="op" id="7650226">&lt;</span>&nbsp;<span class="num" id="7650228">0</span>&nbsp;<span class="op" id="7650230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650234"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7650235">.</span><span class="ident" id="7650236">Error</span><span class="op" id="7650241">(</span><span class="string" id="7650242">&#34;expected&nbsp;error&nbsp;about&nbsp;method;&nbsp;got&#34;</span><span class="op" id="7650276">,</span>&nbsp;<span class="ident" id="7650278"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7650281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7650284">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7650288">//&nbsp;Out&nbsp;of&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650306"><a href="/net/rpc/server_test.go.html#7649383">args</a></span>&nbsp;<span class="op" id="7650311">=</span>&nbsp;<span class="op" id="7650313">&amp;</span><span class="ident" id="7650314"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7650318">{</span><span class="num" id="7650319">7</span><span class="op" id="7650320">,</span>&nbsp;<span class="num" id="7650322">8</span><span class="op" id="7650323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650326">mulReply</span>&nbsp;<span class="op" id="7650335">:=</span>&nbsp;<span class="builtinfunc" id="7650338">new</span><span class="op" id="7650341">(</span><span class="ident" id="7650342"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7650347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650350">mulCall</span>&nbsp;<span class="op" id="7650358">:=</span>&nbsp;<span class="ident" id="7650361"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7650367">.</span><span class="ident" id="7650368">Go</span><span class="op" id="7650370">(</span><span class="string" id="7650371">&#34;Arith.Mul&#34;</span><span class="op" id="7650382">,</span>&nbsp;<span class="ident" id="7650384"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650388">,</span>&nbsp;<span class="ident" id="7650390"><a href="/net/rpc/server_test.go.html#7650326">mulReply</a></span><span class="op" id="7650398">,</span>&nbsp;<span class="ident" id="7650400">nil</span><span class="op" id="7650403">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650406">addReply</span>&nbsp;<span class="op" id="7650415">:=</span>&nbsp;<span class="builtinfunc" id="7650418">new</span><span class="op" id="7650421">(</span><span class="ident" id="7650422"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7650427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650430">addCall</span>&nbsp;<span class="op" id="7650438">:=</span>&nbsp;<span class="ident" id="7650441"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7650447">.</span><span class="ident" id="7650448">Go</span><span class="op" id="7650450">(</span><span class="string" id="7650451">&#34;Arith.Add&#34;</span><span class="op" id="7650462">,</span>&nbsp;<span class="ident" id="7650464"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650468">,</span>&nbsp;<span class="ident" id="7650470"><a href="/net/rpc/server_test.go.html#7650406">addReply</a></span><span class="op" id="7650478">,</span>&nbsp;<span class="ident" id="7650480">nil</span><span class="op" id="7650483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650487"><a href="/net/rpc/server_test.go.html#7650430">addCall</a></span>&nbsp;<span class="op" id="7650495">=</span>&nbsp;<span class="op" id="7650497">&lt;-</span><span class="ident" id="7650499"><a href="/net/rpc/server_test.go.html#7650430">addCall</a></span><span class="op" id="7650506">.</span><span class="ident" id="7650507">Done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7650513">if</span>&nbsp;<span class="ident" id="7650516"><a href="/net/rpc/server_test.go.html#7650430">addCall</a></span><span class="op" id="7650523">.</span><span class="ident" id="7650524">Error</span>&nbsp;<span class="op" id="7650530">!=</span>&nbsp;<span class="ident" id="7650533">nil</span>&nbsp;<span class="op" id="7650537">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650541"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7650542">.</span><span class="ident" id="7650543">Errorf</span><span class="op" id="7650549">(</span><span class="string" id="7650550">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7650592">,</span>&nbsp;<span class="ident" id="7650594"><a href="/net/rpc/server_test.go.html#7650430">addCall</a></span><span class="op" id="7650601">.</span><span class="ident" id="7650602">Error</span><span class="op" id="7650607">.</span><span class="ident" id="7650608">Error</span><span class="op" id="7650613">(</span><span class="op" id="7650614">)</span><span class="op" id="7650615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7650618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7650621">if</span>&nbsp;<span class="ident" id="7650624"><a href="/net/rpc/server_test.go.html#7650406">addReply</a></span><span class="op" id="7650632">.</span><span class="ident" id="7650633">C</span>&nbsp;<span class="op" id="7650635">!=</span>&nbsp;<span class="ident" id="7650638"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650642">.</span><span class="ident" id="7650643">A</span><span class="op" id="7650644">+</span><span class="ident" id="7650645"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650649">.</span><span class="ident" id="7650650">B</span>&nbsp;<span class="op" id="7650652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650656"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7650657">.</span><span class="ident" id="7650658">Errorf</span><span class="op" id="7650664">(</span><span class="string" id="7650665">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7650690">,</span>&nbsp;<span class="ident" id="7650692"><a href="/net/rpc/server_test.go.html#7650406">addReply</a></span><span class="op" id="7650700">.</span><span class="ident" id="7650701">C</span><span class="op" id="7650702">,</span>&nbsp;<span class="ident" id="7650704"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650708">.</span><span class="ident" id="7650709">A</span><span class="op" id="7650710">+</span><span class="ident" id="7650711"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650715">.</span><span class="ident" id="7650716">B</span><span class="op" id="7650717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7650720">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650724"><a href="/net/rpc/server_test.go.html#7650350">mulCall</a></span>&nbsp;<span class="op" id="7650732">=</span>&nbsp;<span class="op" id="7650734">&lt;-</span><span class="ident" id="7650736"><a href="/net/rpc/server_test.go.html#7650350">mulCall</a></span><span class="op" id="7650743">.</span><span class="ident" id="7650744">Done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7650750">if</span>&nbsp;<span class="ident" id="7650753"><a href="/net/rpc/server_test.go.html#7650350">mulCall</a></span><span class="op" id="7650760">.</span><span class="ident" id="7650761">Error</span>&nbsp;<span class="op" id="7650767">!=</span>&nbsp;<span class="ident" id="7650770">nil</span>&nbsp;<span class="op" id="7650774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650778"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7650779">.</span><span class="ident" id="7650780">Errorf</span><span class="op" id="7650786">(</span><span class="string" id="7650787">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7650829">,</span>&nbsp;<span class="ident" id="7650831"><a href="/net/rpc/server_test.go.html#7650350">mulCall</a></span><span class="op" id="7650838">.</span><span class="ident" id="7650839">Error</span><span class="op" id="7650844">.</span><span class="ident" id="7650845">Error</span><span class="op" id="7650850">(</span><span class="op" id="7650851">)</span><span class="op" id="7650852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7650855">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7650858">if</span>&nbsp;<span class="ident" id="7650861"><a href="/net/rpc/server_test.go.html#7650326">mulReply</a></span><span class="op" id="7650869">.</span><span class="ident" id="7650870">C</span>&nbsp;<span class="op" id="7650872">!=</span>&nbsp;<span class="ident" id="7650875"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650879">.</span><span class="ident" id="7650880">A</span><span class="op" id="7650881">*</span><span class="ident" id="7650882"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650886">.</span><span class="ident" id="7650887">B</span>&nbsp;<span class="op" id="7650889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650893"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7650894">.</span><span class="ident" id="7650895">Errorf</span><span class="op" id="7650901">(</span><span class="string" id="7650902">&#34;Mul:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7650927">,</span>&nbsp;<span class="ident" id="7650929"><a href="/net/rpc/server_test.go.html#7650326">mulReply</a></span><span class="op" id="7650937">.</span><span class="ident" id="7650938">C</span><span class="op" id="7650939">,</span>&nbsp;<span class="ident" id="7650941"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650945">.</span><span class="ident" id="7650946">A</span><span class="op" id="7650947">*</span><span class="ident" id="7650948"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7650952">.</span><span class="ident" id="7650953">B</span><span class="op" id="7650954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7650957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7650961">//&nbsp;Error&nbsp;test</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650976"><a href="/net/rpc/server_test.go.html#7649383">args</a></span>&nbsp;<span class="op" id="7650981">=</span>&nbsp;<span class="op" id="7650983">&amp;</span><span class="ident" id="7650984"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7650988">{</span><span class="num" id="7650989">7</span><span class="op" id="7650990">,</span>&nbsp;<span class="num" id="7650992">0</span><span class="op" id="7650993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7650996"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span>&nbsp;<span class="op" id="7651002">=</span>&nbsp;<span class="builtinfunc" id="7651004">new</span><span class="op" id="7651007">(</span><span class="ident" id="7651008"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7651013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651016"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7651020">=</span>&nbsp;<span class="ident" id="7651022"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7651028">.</span><span class="ident" id="7651029">Call</span><span class="op" id="7651033">(</span><span class="string" id="7651034">&#34;Arith.Div&#34;</span><span class="op" id="7651045">,</span>&nbsp;<span class="ident" id="7651047"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7651051">,</span>&nbsp;<span class="ident" id="7651053"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7651058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7651061">//&nbsp;expect&nbsp;an&nbsp;error:&nbsp;zero&nbsp;divide</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7651094">if</span>&nbsp;<span class="ident" id="7651097"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7651101">==</span>&nbsp;<span class="ident" id="7651104">nil</span>&nbsp;<span class="op" id="7651108">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651112"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7651113">.</span><span class="ident" id="7651114">Error</span><span class="op" id="7651119">(</span><span class="string" id="7651120">&#34;Div:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7651141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7651144">}</span>&nbsp;<span class="keyword" id="7651146">else</span>&nbsp;<span class="keyword" id="7651151">if</span>&nbsp;<span class="ident" id="7651154"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7651157">.</span><span class="ident" id="7651158">Error</span><span class="op" id="7651163">(</span><span class="op" id="7651164">)</span>&nbsp;<span class="op" id="7651166">!=</span>&nbsp;<span class="string" id="7651169">&#34;divide&nbsp;by&nbsp;zero&#34;</span>&nbsp;<span class="op" id="7651186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651190"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7651191">.</span><span class="ident" id="7651192">Error</span><span class="op" id="7651197">(</span><span class="string" id="7651198">&#34;Div:&nbsp;expected&nbsp;divide&nbsp;by&nbsp;zero&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7651239">,</span>&nbsp;<span class="ident" id="7651241"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7651244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7651247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7651251">//&nbsp;Bad&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651265"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span>&nbsp;<span class="op" id="7651271">=</span>&nbsp;<span class="builtinfunc" id="7651273">new</span><span class="op" id="7651276">(</span><span class="ident" id="7651277"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7651282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651285"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7651289">=</span>&nbsp;<span class="ident" id="7651291"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7651297">.</span><span class="ident" id="7651298">Call</span><span class="op" id="7651302">(</span><span class="string" id="7651303">&#34;Arith.Add&#34;</span><span class="op" id="7651314">,</span>&nbsp;<span class="ident" id="7651316"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7651321">,</span>&nbsp;<span class="ident" id="7651323"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7651328">)</span>&nbsp;<span class="comment" id="7651330">//&nbsp;args,&nbsp;reply&nbsp;would&nbsp;be&nbsp;the&nbsp;correct&nbsp;thing&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7651380">if</span>&nbsp;<span class="ident" id="7651383"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7651387">==</span>&nbsp;<span class="ident" id="7651390">nil</span>&nbsp;<span class="op" id="7651394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651398"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7651399">.</span><span class="ident" id="7651400">Error</span><span class="op" id="7651405">(</span><span class="string" id="7651406">&#34;expected&nbsp;error&nbsp;calling&nbsp;Arith.Add&nbsp;with&nbsp;wrong&nbsp;arg&nbsp;type&#34;</span><span class="op" id="7651460">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7651463">}</span>&nbsp;<span class="keyword" id="7651465">else</span>&nbsp;<span class="keyword" id="7651470">if</span>&nbsp;<span class="ident" id="7651473"><a href="/net/rpc/server_test.go.html#7646929">strings</a></span><span class="op" id="7651480">.</span><span class="ident" id="7651481">Index</span><span class="op" id="7651486">(</span><span class="ident" id="7651487"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7651490">.</span><span class="ident" id="7651491">Error</span><span class="op" id="7651496">(</span><span class="op" id="7651497">)</span><span class="op" id="7651498">,</span>&nbsp;<span class="string" id="7651500">&#34;type&#34;</span><span class="op" id="7651506">)</span>&nbsp;<span class="op" id="7651508">&lt;</span>&nbsp;<span class="num" id="7651510">0</span>&nbsp;<span class="op" id="7651512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651516"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7651517">.</span><span class="ident" id="7651518">Error</span><span class="op" id="7651523">(</span><span class="string" id="7651524">&#34;expected&nbsp;error&nbsp;about&nbsp;type;&nbsp;got&#34;</span><span class="op" id="7651556">,</span>&nbsp;<span class="ident" id="7651558"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7651561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7651564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7651568">//&nbsp;Non-struct&nbsp;argument</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7651592">const</span>&nbsp;<span class="ident" id="7651598">Val</span>&nbsp;<span class="op" id="7651602">=</span>&nbsp;<span class="num" id="7651604">12345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651611">str</span>&nbsp;<span class="op" id="7651615">:=</span>&nbsp;<span class="ident" id="7651618"><a href="/net/rpc/server_test.go.html#7646870">fmt</a></span><span class="op" id="7651621">.</span><span class="ident" id="7651622">Sprint</span><span class="op" id="7651628">(</span><span class="ident" id="7651629"><a href="/net/rpc/server_test.go.html#7651598">Val</a></span><span class="op" id="7651632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651635"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span>&nbsp;<span class="op" id="7651641">=</span>&nbsp;<span class="builtinfunc" id="7651643">new</span><span class="op" id="7651646">(</span><span class="ident" id="7651647"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7651652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651655"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7651659">=</span>&nbsp;<span class="ident" id="7651661"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7651667">.</span><span class="ident" id="7651668">Call</span><span class="op" id="7651672">(</span><span class="string" id="7651673">&#34;Arith.Scan&#34;</span><span class="op" id="7651685">,</span>&nbsp;<span class="op" id="7651687">&amp;</span><span class="ident" id="7651688"><a href="/net/rpc/server_test.go.html#7651611">str</a></span><span class="op" id="7651691">,</span>&nbsp;<span class="ident" id="7651693"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7651698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7651701">if</span>&nbsp;<span class="ident" id="7651704"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7651708">!=</span>&nbsp;<span class="ident" id="7651711">nil</span>&nbsp;<span class="op" id="7651715">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651719"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7651720">.</span><span class="ident" id="7651721">Errorf</span><span class="op" id="7651727">(</span><span class="string" id="7651728">&#34;Scan:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7651771">,</span>&nbsp;<span class="ident" id="7651773"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7651776">.</span><span class="ident" id="7651777">Error</span><span class="op" id="7651782">(</span><span class="op" id="7651783">)</span><span class="op" id="7651784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7651787">}</span>&nbsp;<span class="keyword" id="7651789">else</span>&nbsp;<span class="keyword" id="7651794">if</span>&nbsp;<span class="ident" id="7651797"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7651802">.</span><span class="ident" id="7651803">C</span>&nbsp;<span class="op" id="7651805">!=</span>&nbsp;<span class="ident" id="7651808"><a href="/net/rpc/server_test.go.html#7651598">Val</a></span>&nbsp;<span class="op" id="7651812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651816"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7651817">.</span><span class="ident" id="7651818">Errorf</span><span class="op" id="7651824">(</span><span class="string" id="7651825">&#34;Scan:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7651851">,</span>&nbsp;<span class="ident" id="7651853"><a href="/net/rpc/server_test.go.html#7651598">Val</a></span><span class="op" id="7651856">,</span>&nbsp;<span class="ident" id="7651858"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7651863">.</span><span class="ident" id="7651864">C</span><span class="op" id="7651865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7651868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7651872">//&nbsp;Non-struct&nbsp;reply</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651893"><a href="/net/rpc/server_test.go.html#7649383">args</a></span>&nbsp;<span class="op" id="7651898">=</span>&nbsp;<span class="op" id="7651900">&amp;</span><span class="ident" id="7651901"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7651905">{</span><span class="num" id="7651906">27</span><span class="op" id="7651908">,</span>&nbsp;<span class="num" id="7651910">35</span><span class="op" id="7651912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651915"><a href="/net/rpc/server_test.go.html#7651611">str</a></span>&nbsp;<span class="op" id="7651919">=</span>&nbsp;<span class="string" id="7651921">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651925"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7651929">=</span>&nbsp;<span class="ident" id="7651931"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7651937">.</span><span class="ident" id="7651938">Call</span><span class="op" id="7651942">(</span><span class="string" id="7651943">&#34;Arith.String&#34;</span><span class="op" id="7651957">,</span>&nbsp;<span class="ident" id="7651959"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7651963">,</span>&nbsp;<span class="op" id="7651965">&amp;</span><span class="ident" id="7651966"><a href="/net/rpc/server_test.go.html#7651611">str</a></span><span class="op" id="7651969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7651972">if</span>&nbsp;<span class="ident" id="7651975"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7651979">!=</span>&nbsp;<span class="ident" id="7651982">nil</span>&nbsp;<span class="op" id="7651986">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7651990"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7651991">.</span><span class="ident" id="7651992">Errorf</span><span class="op" id="7651998">(</span><span class="string" id="7651999">&#34;String:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7652044">,</span>&nbsp;<span class="ident" id="7652046"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7652049">.</span><span class="ident" id="7652050">Error</span><span class="op" id="7652055">(</span><span class="op" id="7652056">)</span><span class="op" id="7652057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7652060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652063">expect</span>&nbsp;<span class="op" id="7652070">:=</span>&nbsp;<span class="ident" id="7652073"><a href="/net/rpc/server_test.go.html#7646870">fmt</a></span><span class="op" id="7652076">.</span><span class="ident" id="7652077">Sprintf</span><span class="op" id="7652084">(</span><span class="string" id="7652085">&#34;%d+%d=%d&#34;</span><span class="op" id="7652095">,</span>&nbsp;<span class="ident" id="7652097"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652101">.</span><span class="ident" id="7652102">A</span><span class="op" id="7652103">,</span>&nbsp;<span class="ident" id="7652105"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652109">.</span><span class="ident" id="7652110">B</span><span class="op" id="7652111">,</span>&nbsp;<span class="ident" id="7652113"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652117">.</span><span class="ident" id="7652118">A</span><span class="op" id="7652119">+</span><span class="ident" id="7652120"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652124">.</span><span class="ident" id="7652125">B</span><span class="op" id="7652126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7652129">if</span>&nbsp;<span class="ident" id="7652132"><a href="/net/rpc/server_test.go.html#7651611">str</a></span>&nbsp;<span class="op" id="7652136">!=</span>&nbsp;<span class="ident" id="7652139"><a href="/net/rpc/server_test.go.html#7652063">expect</a></span>&nbsp;<span class="op" id="7652146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652150"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7652151">.</span><span class="ident" id="7652152">Errorf</span><span class="op" id="7652158">(</span><span class="string" id="7652159">&#34;String:&nbsp;expected&nbsp;%s&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7652187">,</span>&nbsp;<span class="ident" id="7652189"><a href="/net/rpc/server_test.go.html#7652063">expect</a></span><span class="op" id="7652195">,</span>&nbsp;<span class="ident" id="7652197"><a href="/net/rpc/server_test.go.html#7651611">str</a></span><span class="op" id="7652200">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7652203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652207"><a href="/net/rpc/server_test.go.html#7649383">args</a></span>&nbsp;<span class="op" id="7652212">=</span>&nbsp;<span class="op" id="7652214">&amp;</span><span class="ident" id="7652215"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7652219">{</span><span class="num" id="7652220">7</span><span class="op" id="7652221">,</span>&nbsp;<span class="num" id="7652223">8</span><span class="op" id="7652224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652227"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span>&nbsp;<span class="op" id="7652233">=</span>&nbsp;<span class="builtinfunc" id="7652235">new</span><span class="op" id="7652238">(</span><span class="ident" id="7652239"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7652244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652247"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7652251">=</span>&nbsp;<span class="ident" id="7652253"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7652259">.</span><span class="ident" id="7652260">Call</span><span class="op" id="7652264">(</span><span class="string" id="7652265">&#34;Arith.Mul&#34;</span><span class="op" id="7652276">,</span>&nbsp;<span class="ident" id="7652278"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652282">,</span>&nbsp;<span class="ident" id="7652284"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7652289">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7652292">if</span>&nbsp;<span class="ident" id="7652295"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7652299">!=</span>&nbsp;<span class="ident" id="7652302">nil</span>&nbsp;<span class="op" id="7652306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652310"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7652311">.</span><span class="ident" id="7652312">Errorf</span><span class="op" id="7652318">(</span><span class="string" id="7652319">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7652361">,</span>&nbsp;<span class="ident" id="7652363"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7652366">.</span><span class="ident" id="7652367">Error</span><span class="op" id="7652372">(</span><span class="op" id="7652373">)</span><span class="op" id="7652374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7652377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7652380">if</span>&nbsp;<span class="ident" id="7652383"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7652388">.</span><span class="ident" id="7652389">C</span>&nbsp;<span class="op" id="7652391">!=</span>&nbsp;<span class="ident" id="7652394"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652398">.</span><span class="ident" id="7652399">A</span><span class="op" id="7652400">*</span><span class="ident" id="7652401"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652405">.</span><span class="ident" id="7652406">B</span>&nbsp;<span class="op" id="7652408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652412"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7652413">.</span><span class="ident" id="7652414">Errorf</span><span class="op" id="7652420">(</span><span class="string" id="7652421">&#34;Mul:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7652446">,</span>&nbsp;<span class="ident" id="7652448"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7652453">.</span><span class="ident" id="7652454">C</span><span class="op" id="7652455">,</span>&nbsp;<span class="ident" id="7652457"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652461">.</span><span class="ident" id="7652462">A</span><span class="op" id="7652463">*</span><span class="ident" id="7652464"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652468">.</span><span class="ident" id="7652469">B</span><span class="op" id="7652470">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7652473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7652477">//&nbsp;ServiceName&nbsp;contain&nbsp;&#34;.&#34;&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652515"><a href="/net/rpc/server_test.go.html#7649383">args</a></span>&nbsp;<span class="op" id="7652520">=</span>&nbsp;<span class="op" id="7652522">&amp;</span><span class="ident" id="7652523"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7652527">{</span><span class="num" id="7652528">7</span><span class="op" id="7652529">,</span>&nbsp;<span class="num" id="7652531">8</span><span class="op" id="7652532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652535"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span>&nbsp;<span class="op" id="7652541">=</span>&nbsp;<span class="builtinfunc" id="7652543">new</span><span class="op" id="7652546">(</span><span class="ident" id="7652547"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7652552">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652555"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7652559">=</span>&nbsp;<span class="ident" id="7652561"><a href="/net/rpc/server_test.go.html#7649258">client</a></span><span class="op" id="7652567">.</span><span class="ident" id="7652568">Call</span><span class="op" id="7652572">(</span><span class="string" id="7652573">&#34;net.rpc.Arith.Add&#34;</span><span class="op" id="7652592">,</span>&nbsp;<span class="ident" id="7652594"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652598">,</span>&nbsp;<span class="ident" id="7652600"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7652605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7652608">if</span>&nbsp;<span class="ident" id="7652611"><a href="/net/rpc/server_test.go.html#7649266">err</a></span>&nbsp;<span class="op" id="7652615">!=</span>&nbsp;<span class="ident" id="7652618">nil</span>&nbsp;<span class="op" id="7652622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652626"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7652627">.</span><span class="ident" id="7652628">Errorf</span><span class="op" id="7652634">(</span><span class="string" id="7652635">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7652677">,</span>&nbsp;<span class="ident" id="7652679"><a href="/net/rpc/server_test.go.html#7649266">err</a></span><span class="op" id="7652682">.</span><span class="ident" id="7652683">Error</span><span class="op" id="7652688">(</span><span class="op" id="7652689">)</span><span class="op" id="7652690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7652693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7652696">if</span>&nbsp;<span class="ident" id="7652699"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7652704">.</span><span class="ident" id="7652705">C</span>&nbsp;<span class="op" id="7652707">!=</span>&nbsp;<span class="ident" id="7652710"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652714">.</span><span class="ident" id="7652715">A</span><span class="op" id="7652716">+</span><span class="ident" id="7652717"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652721">.</span><span class="ident" id="7652722">B</span>&nbsp;<span class="op" id="7652724">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652728"><a href="/net/rpc/server_test.go.html#7649228">t</a></span><span class="op" id="7652729">.</span><span class="ident" id="7652730">Errorf</span><span class="op" id="7652736">(</span><span class="string" id="7652737">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7652762">,</span>&nbsp;<span class="ident" id="7652764"><a href="/net/rpc/server_test.go.html#7649404">reply</a></span><span class="op" id="7652769">.</span><span class="ident" id="7652770">C</span><span class="op" id="7652771">,</span>&nbsp;<span class="ident" id="7652773"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652777">.</span><span class="ident" id="7652778">A</span><span class="op" id="7652779">+</span><span class="ident" id="7652780"><a href="/net/rpc/server_test.go.html#7649383">args</a></span><span class="op" id="7652784">.</span><span class="ident" id="7652785">B</span><span class="op" id="7652786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7652789">}</span><br>
<span class="lineno"></span><span class="op" id="7652791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7652794">func</span>&nbsp;<span class="ident" id="7652799">testNewServerRPC</span><span class="op" id="7652815">(</span><span class="ident" id="7652816">t</span>&nbsp;<span class="op" id="7652818">*</span><span class="ident" id="7652819"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7652826">.</span><span class="ident" id="7652827">T</span><span class="op" id="7652828">,</span>&nbsp;<span class="ident" id="7652830">addr</span>&nbsp;<span class="builtintype" id="7652835">string</span><span class="op" id="7652841">)</span>&nbsp;<span class="op" id="7652843">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652846">client</span><span class="op" id="7652852">,</span>&nbsp;<span class="ident" id="7652854">err</span>&nbsp;<span class="op" id="7652858">:=</span>&nbsp;<span class="ident" id="7652861"><a href="/net/rpc/client.go.html#5785360">Dial</a></span><span class="op" id="7652865">(</span><span class="string" id="7652866">&#34;tcp&#34;</span><span class="op" id="7652871">,</span>&nbsp;<span class="ident" id="7652873"><a href="/net/rpc/server_test.go.html#7652830">addr</a></span><span class="op" id="7652877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7652880">if</span>&nbsp;<span class="ident" id="7652883"><a href="/net/rpc/server_test.go.html#7652854">err</a></span>&nbsp;<span class="op" id="7652887">!=</span>&nbsp;<span class="ident" id="7652890">nil</span>&nbsp;<span class="op" id="7652894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652898"><a href="/net/rpc/server_test.go.html#7652816">t</a></span><span class="op" id="7652899">.</span><span class="ident" id="7652900">Fatal</span><span class="op" id="7652905">(</span><span class="string" id="7652906">&#34;dialing&#34;</span><span class="op" id="7652915">,</span>&nbsp;<span class="ident" id="7652917"><a href="/net/rpc/server_test.go.html#7652854">err</a></span><span class="op" id="7652920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7652923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7652926">defer</span>&nbsp;<span class="ident" id="7652932"><a href="/net/rpc/server_test.go.html#7652846">client</a></span><span class="op" id="7652938">.</span><span class="ident" id="7652939">Close</span><span class="op" id="7652944">(</span><span class="op" id="7652945">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7652949">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652971">args</span>&nbsp;<span class="op" id="7652976">:=</span>&nbsp;<span class="op" id="7652979">&amp;</span><span class="ident" id="7652980"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7652984">{</span><span class="num" id="7652985">7</span><span class="op" id="7652986">,</span>&nbsp;<span class="num" id="7652988">8</span><span class="op" id="7652989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7652992">reply</span>&nbsp;<span class="op" id="7652998">:=</span>&nbsp;<span class="builtinfunc" id="7653001">new</span><span class="op" id="7653004">(</span><span class="ident" id="7653005"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7653010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653013"><a href="/net/rpc/server_test.go.html#7652854">err</a></span>&nbsp;<span class="op" id="7653017">=</span>&nbsp;<span class="ident" id="7653019"><a href="/net/rpc/server_test.go.html#7652846">client</a></span><span class="op" id="7653025">.</span><span class="ident" id="7653026">Call</span><span class="op" id="7653030">(</span><span class="string" id="7653031">&#34;newServer.Arith.Add&#34;</span><span class="op" id="7653052">,</span>&nbsp;<span class="ident" id="7653054"><a href="/net/rpc/server_test.go.html#7652971">args</a></span><span class="op" id="7653058">,</span>&nbsp;<span class="ident" id="7653060"><a href="/net/rpc/server_test.go.html#7652992">reply</a></span><span class="op" id="7653065">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7653068">if</span>&nbsp;<span class="ident" id="7653071"><a href="/net/rpc/server_test.go.html#7652854">err</a></span>&nbsp;<span class="op" id="7653075">!=</span>&nbsp;<span class="ident" id="7653078">nil</span>&nbsp;<span class="op" id="7653082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653086"><a href="/net/rpc/server_test.go.html#7652816">t</a></span><span class="op" id="7653087">.</span><span class="ident" id="7653088">Errorf</span><span class="op" id="7653094">(</span><span class="string" id="7653095">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7653137">,</span>&nbsp;<span class="ident" id="7653139"><a href="/net/rpc/server_test.go.html#7652854">err</a></span><span class="op" id="7653142">.</span><span class="ident" id="7653143">Error</span><span class="op" id="7653148">(</span><span class="op" id="7653149">)</span><span class="op" id="7653150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7653153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7653156">if</span>&nbsp;<span class="ident" id="7653159"><a href="/net/rpc/server_test.go.html#7652992">reply</a></span><span class="op" id="7653164">.</span><span class="ident" id="7653165">C</span>&nbsp;<span class="op" id="7653167">!=</span>&nbsp;<span class="ident" id="7653170"><a href="/net/rpc/server_test.go.html#7652971">args</a></span><span class="op" id="7653174">.</span><span class="ident" id="7653175">A</span><span class="op" id="7653176">+</span><span class="ident" id="7653177"><a href="/net/rpc/server_test.go.html#7652971">args</a></span><span class="op" id="7653181">.</span><span class="ident" id="7653182">B</span>&nbsp;<span class="op" id="7653184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653188"><a href="/net/rpc/server_test.go.html#7652816">t</a></span><span class="op" id="7653189">.</span><span class="ident" id="7653190">Errorf</span><span class="op" id="7653196">(</span><span class="string" id="7653197">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7653222">,</span>&nbsp;<span class="ident" id="7653224"><a href="/net/rpc/server_test.go.html#7652992">reply</a></span><span class="op" id="7653229">.</span><span class="ident" id="7653230">C</span><span class="op" id="7653231">,</span>&nbsp;<span class="ident" id="7653233"><a href="/net/rpc/server_test.go.html#7652971">args</a></span><span class="op" id="7653237">.</span><span class="ident" id="7653238">A</span><span class="op" id="7653239">+</span><span class="ident" id="7653240"><a href="/net/rpc/server_test.go.html#7652971">args</a></span><span class="op" id="7653244">.</span><span class="ident" id="7653245">B</span><span class="op" id="7653246">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7653249">}</span><br>
<span class="lineno"></span><span class="op" id="7653251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7653254">func</span>&nbsp;<span class="ident" id="7653259">TestHTTP</span><span class="op" id="7653267">(</span><span class="ident" id="7653268">t</span>&nbsp;<span class="op" id="7653270">*</span><span class="ident" id="7653271"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7653278">.</span><span class="ident" id="7653279">T</span><span class="op" id="7653280">)</span>&nbsp;<span class="op" id="7653282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653285"><a href="/net/rpc/server_test.go.html#7647094">once</a></span><span class="op" id="7653289">.</span><span class="ident" id="7653290">Do</span><span class="op" id="7653292">(</span><span class="ident" id="7653293"><a href="/net/rpc/server_test.go.html#7648204">startServer</a></span><span class="op" id="7653304">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653307"><a href="/net/rpc/server_test.go.html#7653391">testHTTPRPC</a></span><span class="op" id="7653318">(</span><span class="ident" id="7653319"><a href="/net/rpc/server_test.go.html#7653268">t</a></span><span class="op" id="7653320">,</span>&nbsp;<span class="string" id="7653322">&#34;&#34;</span><span class="op" id="7653324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653327"><a href="/net/rpc/server_test.go.html#7647100">newOnce</a></span><span class="op" id="7653334">.</span><span class="ident" id="7653335">Do</span><span class="op" id="7653337">(</span><span class="ident" id="7653338"><a href="/net/rpc/server_test.go.html#7648459">startNewServer</a></span><span class="op" id="7653352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653355"><a href="/net/rpc/server_test.go.html#7653391">testHTTPRPC</a></span><span class="op" id="7653366">(</span><span class="ident" id="7653367"><a href="/net/rpc/server_test.go.html#7653268">t</a></span><span class="op" id="7653368">,</span>&nbsp;<span class="ident" id="7653370"><a href="/net/rpc/server_test.go.html#7647142">newHttpPath</a></span><span class="op" id="7653381">)</span><br>
<span class="lineno"></span><span class="op" id="7653383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="7653386">func</span>&nbsp;<span class="ident" id="7653391">testHTTPRPC</span><span class="op" id="7653402">(</span><span class="ident" id="7653403">t</span>&nbsp;<span class="op" id="7653405">*</span><span class="ident" id="7653406"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7653413">.</span><span class="ident" id="7653414">T</span><span class="op" id="7653415">,</span>&nbsp;<span class="ident" id="7653417">path</span>&nbsp;<span class="builtintype" id="7653422">string</span><span class="op" id="7653428">)</span>&nbsp;<span class="op" id="7653430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7653433">var</span>&nbsp;<span class="ident" id="7653437">client</span>&nbsp;<span class="op" id="7653444">*</span><span class="ident" id="7653445"><a href="/net/rpc/client.go.html#5779222">Client</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7653453">var</span>&nbsp;<span class="ident" id="7653457">err</span>&nbsp;<span class="builtintype" id="7653461">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7653468">if</span>&nbsp;<span class="ident" id="7653471"><a href="/net/rpc/server_test.go.html#7653417">path</a></span>&nbsp;<span class="op" id="7653476">==</span>&nbsp;<span class="string" id="7653479">&#34;&#34;</span>&nbsp;<span class="op" id="7653482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653486"><a href="/net/rpc/server_test.go.html#7653437">client</a></span><span class="op" id="7653492">,</span>&nbsp;<span class="ident" id="7653494"><a href="/net/rpc/server_test.go.html#7653457">err</a></span>&nbsp;<span class="op" id="7653498">=</span>&nbsp;<span class="ident" id="7653500"><a href="/net/rpc/client.go.html#5784413">DialHTTP</a></span><span class="op" id="7653508">(</span><span class="string" id="7653509">&#34;tcp&#34;</span><span class="op" id="7653514">,</span>&nbsp;<span class="ident" id="7653516"><a href="/net/rpc/server_test.go.html#7647060">httpServerAddr</a></span><span class="op" id="7653530">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7653533">}</span>&nbsp;<span class="keyword" id="7653535">else</span>&nbsp;<span class="op" id="7653540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653544"><a href="/net/rpc/server_test.go.html#7653437">client</a></span><span class="op" id="7653550">,</span>&nbsp;<span class="ident" id="7653552"><a href="/net/rpc/server_test.go.html#7653457">err</a></span>&nbsp;<span class="op" id="7653556">=</span>&nbsp;<span class="ident" id="7653558"><a href="/net/rpc/client.go.html#5784622">DialHTTPPath</a></span><span class="op" id="7653570">(</span><span class="string" id="7653571">&#34;tcp&#34;</span><span class="op" id="7653576">,</span>&nbsp;<span class="ident" id="7653578"><a href="/net/rpc/server_test.go.html#7647060">httpServerAddr</a></span><span class="op" id="7653592">,</span>&nbsp;<span class="ident" id="7653594"><a href="/net/rpc/server_test.go.html#7653417">path</a></span><span class="op" id="7653598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7653601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7653604">if</span>&nbsp;<span class="ident" id="7653607"><a href="/net/rpc/server_test.go.html#7653457">err</a></span>&nbsp;<span class="op" id="7653611">!=</span>&nbsp;<span class="ident" id="7653614">nil</span>&nbsp;<span class="op" id="7653618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653622"><a href="/net/rpc/server_test.go.html#7653403">t</a></span><span class="op" id="7653623">.</span><span class="ident" id="7653624">Fatal</span><span class="op" id="7653629">(</span><span class="string" id="7653630">&#34;dialing&#34;</span><span class="op" id="7653639">,</span>&nbsp;<span class="ident" id="7653641"><a href="/net/rpc/server_test.go.html#7653457">err</a></span><span class="op" id="7653644">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7653647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7653650">defer</span>&nbsp;<span class="ident" id="7653656"><a href="/net/rpc/server_test.go.html#7653437">client</a></span><span class="op" id="7653662">.</span><span class="ident" id="7653663">Close</span><span class="op" id="7653668">(</span><span class="op" id="7653669">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7653673">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653695">args</span>&nbsp;<span class="op" id="7653700">:=</span>&nbsp;<span class="op" id="7653703">&amp;</span><span class="ident" id="7653704"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7653708">{</span><span class="num" id="7653709">7</span><span class="op" id="7653710">,</span>&nbsp;<span class="num" id="7653712">8</span><span class="op" id="7653713">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653716">reply</span>&nbsp;<span class="op" id="7653722">:=</span>&nbsp;<span class="builtinfunc" id="7653725">new</span><span class="op" id="7653728">(</span><span class="ident" id="7653729"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7653734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653737"><a href="/net/rpc/server_test.go.html#7653457">err</a></span>&nbsp;<span class="op" id="7653741">=</span>&nbsp;<span class="ident" id="7653743"><a href="/net/rpc/server_test.go.html#7653437">client</a></span><span class="op" id="7653749">.</span><span class="ident" id="7653750">Call</span><span class="op" id="7653754">(</span><span class="string" id="7653755">&#34;Arith.Add&#34;</span><span class="op" id="7653766">,</span>&nbsp;<span class="ident" id="7653768"><a href="/net/rpc/server_test.go.html#7653695">args</a></span><span class="op" id="7653772">,</span>&nbsp;<span class="ident" id="7653774"><a href="/net/rpc/server_test.go.html#7653716">reply</a></span><span class="op" id="7653779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7653782">if</span>&nbsp;<span class="ident" id="7653785"><a href="/net/rpc/server_test.go.html#7653457">err</a></span>&nbsp;<span class="op" id="7653789">!=</span>&nbsp;<span class="ident" id="7653792">nil</span>&nbsp;<span class="op" id="7653796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653800"><a href="/net/rpc/server_test.go.html#7653403">t</a></span><span class="op" id="7653801">.</span><span class="ident" id="7653802">Errorf</span><span class="op" id="7653808">(</span><span class="string" id="7653809">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7653851">,</span>&nbsp;<span class="ident" id="7653853"><a href="/net/rpc/server_test.go.html#7653457">err</a></span><span class="op" id="7653856">.</span><span class="ident" id="7653857">Error</span><span class="op" id="7653862">(</span><span class="op" id="7653863">)</span><span class="op" id="7653864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7653867">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7653870">if</span>&nbsp;<span class="ident" id="7653873"><a href="/net/rpc/server_test.go.html#7653716">reply</a></span><span class="op" id="7653878">.</span><span class="ident" id="7653879">C</span>&nbsp;<span class="op" id="7653881">!=</span>&nbsp;<span class="ident" id="7653884"><a href="/net/rpc/server_test.go.html#7653695">args</a></span><span class="op" id="7653888">.</span><span class="ident" id="7653889">A</span><span class="op" id="7653890">+</span><span class="ident" id="7653891"><a href="/net/rpc/server_test.go.html#7653695">args</a></span><span class="op" id="7653895">.</span><span class="ident" id="7653896">B</span>&nbsp;<span class="op" id="7653898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7653902"><a href="/net/rpc/server_test.go.html#7653403">t</a></span><span class="op" id="7653903">.</span><span class="ident" id="7653904">Errorf</span><span class="op" id="7653910">(</span><span class="string" id="7653911">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7653936">,</span>&nbsp;<span class="ident" id="7653938"><a href="/net/rpc/server_test.go.html#7653716">reply</a></span><span class="op" id="7653943">.</span><span class="ident" id="7653944">C</span><span class="op" id="7653945">,</span>&nbsp;<span class="ident" id="7653947"><a href="/net/rpc/server_test.go.html#7653695">args</a></span><span class="op" id="7653951">.</span><span class="ident" id="7653952">A</span><span class="op" id="7653953">+</span><span class="ident" id="7653954"><a href="/net/rpc/server_test.go.html#7653695">args</a></span><span class="op" id="7653958">.</span><span class="ident" id="7653959">B</span><span class="op" id="7653960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7653963">}</span><br>
<span class="lineno"></span><span class="op" id="7653965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span><span class="comment" id="7653968">//&nbsp;CodecEmulator&nbsp;provides&nbsp;a&nbsp;client-like&nbsp;api&nbsp;and&nbsp;a&nbsp;ServerCodec&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="7654041">//&nbsp;Can&nbsp;be&nbsp;used&nbsp;to&nbsp;test&nbsp;ServeRequest.</span><br>
<span class="lineno"></span><span class="keyword" id="7654078">type</span>&nbsp;<span class="ident" id="7654083">CodecEmulator</span>&nbsp;<span class="keyword" id="7654097">struct</span>&nbsp;<span class="op" id="7654104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654107">server</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654121">*</span><span class="ident" id="7654122"><a href="/net/rpc/server.go.html#5794851">Server</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654130">serviceMethod</span>&nbsp;<span class="builtintype" id="7654144">string</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654152">args</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654166">*</span><span class="ident" id="7654167"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654173">reply</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7654187">*</span><span class="ident" id="7654188"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654195">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7654209">error</span><br>
<span class="lineno"></span><span class="op" id="7654215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="keyword" id="7654218">func</span>&nbsp;<span class="op" id="7654223">(</span><span class="ident" id="7654224">codec</span>&nbsp;<span class="op" id="7654230">*</span><span class="ident" id="7654231"><a href="/net/rpc/server_test.go.html#7654083">CodecEmulator</a></span><span class="op" id="7654244">)</span>&nbsp;<span class="ident" id="7654246">Call</span><span class="op" id="7654250">(</span><span class="ident" id="7654251">serviceMethod</span>&nbsp;<span class="builtintype" id="7654265">string</span><span class="op" id="7654271">,</span>&nbsp;<span class="ident" id="7654273">args</span>&nbsp;<span class="op" id="7654278">*</span><span class="ident" id="7654279"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7654283">,</span>&nbsp;<span class="ident" id="7654285">reply</span>&nbsp;<span class="op" id="7654291">*</span><span class="ident" id="7654292"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7654297">)</span>&nbsp;<span class="builtintype" id="7654299">error</span>&nbsp;<span class="op" id="7654305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654308"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654313">.</span><span class="ident" id="7654314">serviceMethod</span>&nbsp;<span class="op" id="7654328">=</span>&nbsp;<span class="ident" id="7654330"><a href="/net/rpc/server_test.go.html#7654251">serviceMethod</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654345"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654350">.</span><span class="ident" id="7654351">args</span>&nbsp;<span class="op" id="7654356">=</span>&nbsp;<span class="ident" id="7654358"><a href="/net/rpc/server_test.go.html#7654273">args</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654364"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654369">.</span><span class="ident" id="7654370">reply</span>&nbsp;<span class="op" id="7654376">=</span>&nbsp;<span class="ident" id="7654378"><a href="/net/rpc/server_test.go.html#7654285">reply</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654385"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654390">.</span><span class="ident" id="7654391">err</span>&nbsp;<span class="op" id="7654395">=</span>&nbsp;<span class="ident" id="7654397">nil</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7654402">var</span>&nbsp;<span class="ident" id="7654406">serverError</span>&nbsp;<span class="builtintype" id="7654418">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7654425">if</span>&nbsp;<span class="ident" id="7654428"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654433">.</span><span class="ident" id="7654434">server</span>&nbsp;<span class="op" id="7654441">==</span>&nbsp;<span class="ident" id="7654444">nil</span>&nbsp;<span class="op" id="7654448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654452"><a href="/net/rpc/server_test.go.html#7654406">serverError</a></span>&nbsp;<span class="op" id="7654464">=</span>&nbsp;<span class="ident" id="7654466"><a href="/net/rpc/server.go.html#5809076">ServeRequest</a></span><span class="op" id="7654478">(</span><span class="ident" id="7654479"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7654487">}</span>&nbsp;<span class="keyword" id="7654489">else</span>&nbsp;<span class="op" id="7654494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654498"><a href="/net/rpc/server_test.go.html#7654406">serverError</a></span>&nbsp;<span class="op" id="7654510">=</span>&nbsp;<span class="ident" id="7654512"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654517">.</span><span class="ident" id="7654518">server</span><span class="op" id="7654524">.</span><span class="ident" id="7654525">ServeRequest</span><span class="op" id="7654537">(</span><span class="ident" id="7654538"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654543">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7654546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7654549">if</span>&nbsp;<span class="ident" id="7654552"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654557">.</span><span class="ident" id="7654558">err</span>&nbsp;<span class="op" id="7654562">==</span>&nbsp;<span class="ident" id="7654565">nil</span>&nbsp;<span class="op" id="7654569">&amp;&amp;</span>&nbsp;<span class="ident" id="7654572"><a href="/net/rpc/server_test.go.html#7654406">serverError</a></span>&nbsp;<span class="op" id="7654584">!=</span>&nbsp;<span class="ident" id="7654587">nil</span>&nbsp;<span class="op" id="7654591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654595"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654600">.</span><span class="ident" id="7654601">err</span>&nbsp;<span class="op" id="7654605">=</span>&nbsp;<span class="ident" id="7654607"><a href="/net/rpc/server_test.go.html#7654406">serverError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7654620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7654623">return</span>&nbsp;<span class="ident" id="7654630"><a href="/net/rpc/server_test.go.html#7654224">codec</a></span><span class="op" id="7654635">.</span><span class="ident" id="7654636">err</span><br>
<span class="lineno">330</span><span class="op" id="7654640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7654643">func</span>&nbsp;<span class="op" id="7654648">(</span><span class="ident" id="7654649">codec</span>&nbsp;<span class="op" id="7654655">*</span><span class="ident" id="7654656"><a href="/net/rpc/server_test.go.html#7654083">CodecEmulator</a></span><span class="op" id="7654669">)</span>&nbsp;<span class="ident" id="7654671">ReadRequestHeader</span><span class="op" id="7654688">(</span><span class="ident" id="7654689">req</span>&nbsp;<span class="op" id="7654693">*</span><span class="ident" id="7654694"><a href="/net/rpc/server.go.html#5794226">Request</a></span><span class="op" id="7654701">)</span>&nbsp;<span class="builtintype" id="7654703">error</span>&nbsp;<span class="op" id="7654709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654712"><a href="/net/rpc/server_test.go.html#7654689">req</a></span><span class="op" id="7654715">.</span><span class="ident" id="7654716">ServiceMethod</span>&nbsp;<span class="op" id="7654730">=</span>&nbsp;<span class="ident" id="7654732"><a href="/net/rpc/server_test.go.html#7654649">codec</a></span><span class="op" id="7654737">.</span><span class="ident" id="7654738">serviceMethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7654753"><a href="/net/rpc/server_test.go.html#7654689">req</a></span><span class="op" id="7654756">.</span><span class="ident" id="7654757">Seq</span>&nbsp;<span class="op" id="7654761">=</span>&nbsp;<span class="num" id="7654763">0</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7654766">return</span>&nbsp;<span class="ident" id="7654773">nil</span><br>
<span class="lineno"></span><span class="op" id="7654777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7654780">func</span>&nbsp;<span class="op" id="7654785">(</span><span class="ident" id="7654786">codec</span>&nbsp;<span class="op" id="7654792">*</span><span class="ident" id="7654793"><a href="/net/rpc/server_test.go.html#7654083">CodecEmulator</a></span><span class="op" id="7654806">)</span>&nbsp;<span class="ident" id="7654808">ReadRequestBody</span><span class="op" id="7654823">(</span><span class="ident" id="7654824">argv</span>&nbsp;<span class="keyword" id="7654829">interface</span><span class="op" id="7654838">{</span><span class="op" id="7654839">}</span><span class="op" id="7654840">)</span>&nbsp;<span class="builtintype" id="7654842">error</span>&nbsp;<span class="op" id="7654848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7654851">if</span>&nbsp;<span class="ident" id="7654854"><a href="/net/rpc/server_test.go.html#7654786">codec</a></span><span class="op" id="7654859">.</span><span class="ident" id="7654860">args</span>&nbsp;<span class="op" id="7654865">==</span>&nbsp;<span class="ident" id="7654868">nil</span>&nbsp;<span class="op" id="7654872">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7654876">return</span>&nbsp;<span class="ident" id="7654883"><a href="/net/rpc/server_test.go.html#7646877">io</a></span><span class="op" id="7654885">.</span><span class="ident" id="7654886">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7654904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7654907">*</span><span class="op" id="7654908">(</span><span class="ident" id="7654909"><a href="/net/rpc/server_test.go.html#7654824">argv</a></span><span class="op" id="7654913">.</span><span class="op" id="7654914">(</span><span class="op" id="7654915">*</span><span class="ident" id="7654916"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7654920">)</span><span class="op" id="7654921">)</span>&nbsp;<span class="op" id="7654923">=</span>&nbsp;<span class="op" id="7654925">*</span><span class="ident" id="7654926"><a href="/net/rpc/server_test.go.html#7654786">codec</a></span><span class="op" id="7654931">.</span><span class="ident" id="7654932">args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7654938">return</span>&nbsp;<span class="ident" id="7654945">nil</span><br>
<span class="lineno"></span><span class="op" id="7654949">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="7654952">func</span>&nbsp;<span class="op" id="7654957">(</span><span class="ident" id="7654958">codec</span>&nbsp;<span class="op" id="7654964">*</span><span class="ident" id="7654965"><a href="/net/rpc/server_test.go.html#7654083">CodecEmulator</a></span><span class="op" id="7654978">)</span>&nbsp;<span class="ident" id="7654980">WriteResponse</span><span class="op" id="7654993">(</span><span class="ident" id="7654994">resp</span>&nbsp;<span class="op" id="7654999">*</span><span class="ident" id="7655000"><a href="/net/rpc/server.go.html#5794584">Response</a></span><span class="op" id="7655008">,</span>&nbsp;<span class="ident" id="7655010">reply</span>&nbsp;<span class="keyword" id="7655016">interface</span><span class="op" id="7655025">{</span><span class="op" id="7655026">}</span><span class="op" id="7655027">)</span>&nbsp;<span class="builtintype" id="7655029">error</span>&nbsp;<span class="op" id="7655035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655038">if</span>&nbsp;<span class="ident" id="7655041"><a href="/net/rpc/server_test.go.html#7654994">resp</a></span><span class="op" id="7655045">.</span><span class="ident" id="7655046">Error</span>&nbsp;<span class="op" id="7655052">!=</span>&nbsp;<span class="string" id="7655055">&#34;&#34;</span>&nbsp;<span class="op" id="7655058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655062"><a href="/net/rpc/server_test.go.html#7654958">codec</a></span><span class="op" id="7655067">.</span><span class="ident" id="7655068">err</span>&nbsp;<span class="op" id="7655072">=</span>&nbsp;<span class="ident" id="7655074"><a href="/net/rpc/server_test.go.html#7646860">errors</a></span><span class="op" id="7655080">.</span><span class="ident" id="7655081">New</span><span class="op" id="7655084">(</span><span class="ident" id="7655085"><a href="/net/rpc/server_test.go.html#7654994">resp</a></span><span class="op" id="7655089">.</span><span class="ident" id="7655090">Error</span><span class="op" id="7655095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7655098">}</span>&nbsp;<span class="keyword" id="7655100">else</span>&nbsp;<span class="op" id="7655105">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7655109">*</span><span class="ident" id="7655110"><a href="/net/rpc/server_test.go.html#7654958">codec</a></span><span class="op" id="7655115">.</span><span class="ident" id="7655116">reply</span>&nbsp;<span class="op" id="7655122">=</span>&nbsp;<span class="op" id="7655124">*</span><span class="op" id="7655125">(</span><span class="ident" id="7655126"><a href="/net/rpc/server_test.go.html#7655010">reply</a></span><span class="op" id="7655131">.</span><span class="op" id="7655132">(</span><span class="op" id="7655133">*</span><span class="ident" id="7655134"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7655139">)</span><span class="op" id="7655140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7655143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655146">return</span>&nbsp;<span class="ident" id="7655153">nil</span><br>
<span class="lineno"></span><span class="op" id="7655157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="7655160">func</span>&nbsp;<span class="op" id="7655165">(</span><span class="ident" id="7655166">codec</span>&nbsp;<span class="op" id="7655172">*</span><span class="ident" id="7655173"><a href="/net/rpc/server_test.go.html#7654083">CodecEmulator</a></span><span class="op" id="7655186">)</span>&nbsp;<span class="ident" id="7655188">Close</span><span class="op" id="7655193">(</span><span class="op" id="7655194">)</span>&nbsp;<span class="builtintype" id="7655196">error</span>&nbsp;<span class="op" id="7655202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655205">return</span>&nbsp;<span class="ident" id="7655212">nil</span><br>
<span class="lineno"></span><span class="op" id="7655216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7655219">func</span>&nbsp;<span class="ident" id="7655224">TestServeRequest</span><span class="op" id="7655240">(</span><span class="ident" id="7655241">t</span>&nbsp;<span class="op" id="7655243">*</span><span class="ident" id="7655244"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7655251">.</span><span class="ident" id="7655252">T</span><span class="op" id="7655253">)</span>&nbsp;<span class="op" id="7655255">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655258"><a href="/net/rpc/server_test.go.html#7647094">once</a></span><span class="op" id="7655262">.</span><span class="ident" id="7655263">Do</span><span class="op" id="7655265">(</span><span class="ident" id="7655266"><a href="/net/rpc/server_test.go.html#7648204">startServer</a></span><span class="op" id="7655277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655280"><a href="/net/rpc/server_test.go.html#7655373">testServeRequest</a></span><span class="op" id="7655296">(</span><span class="ident" id="7655297"><a href="/net/rpc/server_test.go.html#7655241">t</a></span><span class="op" id="7655298">,</span>&nbsp;<span class="ident" id="7655300">nil</span><span class="op" id="7655303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655306"><a href="/net/rpc/server_test.go.html#7647100">newOnce</a></span><span class="op" id="7655313">.</span><span class="ident" id="7655314">Do</span><span class="op" id="7655316">(</span><span class="ident" id="7655317"><a href="/net/rpc/server_test.go.html#7648459">startNewServer</a></span><span class="op" id="7655331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655334"><a href="/net/rpc/server_test.go.html#7655373">testServeRequest</a></span><span class="op" id="7655350">(</span><span class="ident" id="7655351"><a href="/net/rpc/server_test.go.html#7655241">t</a></span><span class="op" id="7655352">,</span>&nbsp;<span class="ident" id="7655354"><a href="/net/rpc/server_test.go.html#7646991">newServer</a></span><span class="op" id="7655363">)</span><br>
<span class="lineno"></span><span class="op" id="7655365">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="7655368">func</span>&nbsp;<span class="ident" id="7655373">testServeRequest</span><span class="op" id="7655389">(</span><span class="ident" id="7655390">t</span>&nbsp;<span class="op" id="7655392">*</span><span class="ident" id="7655393"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7655400">.</span><span class="ident" id="7655401">T</span><span class="op" id="7655402">,</span>&nbsp;<span class="ident" id="7655404">server</span>&nbsp;<span class="op" id="7655411">*</span><span class="ident" id="7655412"><a href="/net/rpc/server.go.html#5794851">Server</a></span><span class="op" id="7655418">)</span>&nbsp;<span class="op" id="7655420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655423">client</span>&nbsp;<span class="op" id="7655430">:=</span>&nbsp;<span class="ident" id="7655433"><a href="/net/rpc/server_test.go.html#7654083">CodecEmulator</a></span><span class="op" id="7655446">{</span><span class="ident" id="7655447">server</span><span class="op" id="7655453">:</span>&nbsp;<span class="ident" id="7655455"><a href="/net/rpc/server_test.go.html#7655404">server</a></span><span class="op" id="7655461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655464">defer</span>&nbsp;<span class="ident" id="7655470"><a href="/net/rpc/server_test.go.html#7655423">client</a></span><span class="op" id="7655476">.</span><span class="ident" id="7655477">Close</span><span class="op" id="7655482">(</span><span class="op" id="7655483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655487">args</span>&nbsp;<span class="op" id="7655492">:=</span>&nbsp;<span class="op" id="7655495">&amp;</span><span class="ident" id="7655496"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7655500">{</span><span class="num" id="7655501">7</span><span class="op" id="7655502">,</span>&nbsp;<span class="num" id="7655504">8</span><span class="op" id="7655505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655508">reply</span>&nbsp;<span class="op" id="7655514">:=</span>&nbsp;<span class="builtinfunc" id="7655517">new</span><span class="op" id="7655520">(</span><span class="ident" id="7655521"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7655526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655529">err</span>&nbsp;<span class="op" id="7655533">:=</span>&nbsp;<span class="ident" id="7655536"><a href="/net/rpc/server_test.go.html#7655423">client</a></span><span class="op" id="7655542">.</span><span class="ident" id="7655543">Call</span><span class="op" id="7655547">(</span><span class="string" id="7655548">&#34;Arith.Add&#34;</span><span class="op" id="7655559">,</span>&nbsp;<span class="ident" id="7655561"><a href="/net/rpc/server_test.go.html#7655487">args</a></span><span class="op" id="7655565">,</span>&nbsp;<span class="ident" id="7655567"><a href="/net/rpc/server_test.go.html#7655508">reply</a></span><span class="op" id="7655572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655575">if</span>&nbsp;<span class="ident" id="7655578"><a href="/net/rpc/server_test.go.html#7655529">err</a></span>&nbsp;<span class="op" id="7655582">!=</span>&nbsp;<span class="ident" id="7655585">nil</span>&nbsp;<span class="op" id="7655589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655593"><a href="/net/rpc/server_test.go.html#7655390">t</a></span><span class="op" id="7655594">.</span><span class="ident" id="7655595">Errorf</span><span class="op" id="7655601">(</span><span class="string" id="7655602">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7655644">,</span>&nbsp;<span class="ident" id="7655646"><a href="/net/rpc/server_test.go.html#7655529">err</a></span><span class="op" id="7655649">.</span><span class="ident" id="7655650">Error</span><span class="op" id="7655655">(</span><span class="op" id="7655656">)</span><span class="op" id="7655657">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7655660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655663">if</span>&nbsp;<span class="ident" id="7655666"><a href="/net/rpc/server_test.go.html#7655508">reply</a></span><span class="op" id="7655671">.</span><span class="ident" id="7655672">C</span>&nbsp;<span class="op" id="7655674">!=</span>&nbsp;<span class="ident" id="7655677"><a href="/net/rpc/server_test.go.html#7655487">args</a></span><span class="op" id="7655681">.</span><span class="ident" id="7655682">A</span><span class="op" id="7655683">+</span><span class="ident" id="7655684"><a href="/net/rpc/server_test.go.html#7655487">args</a></span><span class="op" id="7655688">.</span><span class="ident" id="7655689">B</span>&nbsp;<span class="op" id="7655691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655695"><a href="/net/rpc/server_test.go.html#7655390">t</a></span><span class="op" id="7655696">.</span><span class="ident" id="7655697">Errorf</span><span class="op" id="7655703">(</span><span class="string" id="7655704">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7655729">,</span>&nbsp;<span class="ident" id="7655731"><a href="/net/rpc/server_test.go.html#7655508">reply</a></span><span class="op" id="7655736">.</span><span class="ident" id="7655737">C</span><span class="op" id="7655738">,</span>&nbsp;<span class="ident" id="7655740"><a href="/net/rpc/server_test.go.html#7655487">args</a></span><span class="op" id="7655744">.</span><span class="ident" id="7655745">A</span><span class="op" id="7655746">+</span><span class="ident" id="7655747"><a href="/net/rpc/server_test.go.html#7655487">args</a></span><span class="op" id="7655751">.</span><span class="ident" id="7655752">B</span><span class="op" id="7655753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7655756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655760"><a href="/net/rpc/server_test.go.html#7655529">err</a></span>&nbsp;<span class="op" id="7655764">=</span>&nbsp;<span class="ident" id="7655766"><a href="/net/rpc/server_test.go.html#7655423">client</a></span><span class="op" id="7655772">.</span><span class="ident" id="7655773">Call</span><span class="op" id="7655777">(</span><span class="string" id="7655778">&#34;Arith.Add&#34;</span><span class="op" id="7655789">,</span>&nbsp;<span class="ident" id="7655791">nil</span><span class="op" id="7655794">,</span>&nbsp;<span class="ident" id="7655796"><a href="/net/rpc/server_test.go.html#7655508">reply</a></span><span class="op" id="7655801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655804">if</span>&nbsp;<span class="ident" id="7655807"><a href="/net/rpc/server_test.go.html#7655529">err</a></span>&nbsp;<span class="op" id="7655811">==</span>&nbsp;<span class="ident" id="7655814">nil</span>&nbsp;<span class="op" id="7655818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655822"><a href="/net/rpc/server_test.go.html#7655390">t</a></span><span class="op" id="7655823">.</span><span class="ident" id="7655824">Errorf</span><span class="op" id="7655830">(</span><span class="string" id="7655831">&#34;expected&nbsp;error&nbsp;calling&nbsp;Arith.Add&nbsp;with&nbsp;nil&nbsp;arg&#34;</span><span class="op" id="7655878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7655881">}</span><br>
<span class="lineno"></span><span class="op" id="7655883">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="keyword" id="7655886">type</span>&nbsp;<span class="ident" id="7655891">ReplyNotPointer</span>&nbsp;<span class="builtintype" id="7655907">int</span><br>
<span class="lineno"></span><span class="keyword" id="7655911">type</span>&nbsp;<span class="ident" id="7655916">ArgNotPublic</span>&nbsp;<span class="builtintype" id="7655929">int</span><br>
<span class="lineno"></span><span class="keyword" id="7655933">type</span>&nbsp;<span class="ident" id="7655938">ReplyNotPublic</span>&nbsp;<span class="builtintype" id="7655953">int</span><br>
<span class="lineno"></span><span class="keyword" id="7655957">type</span>&nbsp;<span class="ident" id="7655962">NeedsPtrType</span>&nbsp;<span class="builtintype" id="7655975">int</span><br>
<span class="lineno">390</span><span class="keyword" id="7655979">type</span>&nbsp;<span class="ident" id="7655984">local</span>&nbsp;<span class="keyword" id="7655990">struct</span><span class="op" id="7655996">{</span><span class="op" id="7655997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7656000">func</span>&nbsp;<span class="op" id="7656005">(</span><span class="ident" id="7656006">t</span>&nbsp;<span class="op" id="7656008">*</span><span class="ident" id="7656009"><a href="/net/rpc/server_test.go.html#7655891">ReplyNotPointer</a></span><span class="op" id="7656024">)</span>&nbsp;<span class="ident" id="7656026">ReplyNotPointer</span><span class="op" id="7656041">(</span><span class="ident" id="7656042">args</span>&nbsp;<span class="op" id="7656047">*</span><span class="ident" id="7656048"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7656052">,</span>&nbsp;<span class="ident" id="7656054">reply</span>&nbsp;<span class="ident" id="7656060"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7656065">)</span>&nbsp;<span class="builtintype" id="7656067">error</span>&nbsp;<span class="op" id="7656073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656076">return</span>&nbsp;<span class="ident" id="7656083">nil</span><br>
<span class="lineno"></span><span class="op" id="7656087">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="7656090">func</span>&nbsp;<span class="op" id="7656095">(</span><span class="ident" id="7656096">t</span>&nbsp;<span class="op" id="7656098">*</span><span class="ident" id="7656099"><a href="/net/rpc/server_test.go.html#7655916">ArgNotPublic</a></span><span class="op" id="7656111">)</span>&nbsp;<span class="ident" id="7656113">ArgNotPublic</span><span class="op" id="7656125">(</span><span class="ident" id="7656126">args</span>&nbsp;<span class="op" id="7656131">*</span><span class="ident" id="7656132"><a href="/net/rpc/server_test.go.html#7655984">local</a></span><span class="op" id="7656137">,</span>&nbsp;<span class="ident" id="7656139">reply</span>&nbsp;<span class="op" id="7656145">*</span><span class="ident" id="7656146"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7656151">)</span>&nbsp;<span class="builtintype" id="7656153">error</span>&nbsp;<span class="op" id="7656159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656162">return</span>&nbsp;<span class="ident" id="7656169">nil</span><br>
<span class="lineno"></span><span class="op" id="7656173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="7656176">func</span>&nbsp;<span class="op" id="7656181">(</span><span class="ident" id="7656182">t</span>&nbsp;<span class="op" id="7656184">*</span><span class="ident" id="7656185"><a href="/net/rpc/server_test.go.html#7655938">ReplyNotPublic</a></span><span class="op" id="7656199">)</span>&nbsp;<span class="ident" id="7656201">ReplyNotPublic</span><span class="op" id="7656215">(</span><span class="ident" id="7656216">args</span>&nbsp;<span class="op" id="7656221">*</span><span class="ident" id="7656222"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7656226">,</span>&nbsp;<span class="ident" id="7656228">reply</span>&nbsp;<span class="op" id="7656234">*</span><span class="ident" id="7656235"><a href="/net/rpc/server_test.go.html#7655984">local</a></span><span class="op" id="7656240">)</span>&nbsp;<span class="builtintype" id="7656242">error</span>&nbsp;<span class="op" id="7656248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656251">return</span>&nbsp;<span class="ident" id="7656258">nil</span><br>
<span class="lineno"></span><span class="op" id="7656262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7656265">func</span>&nbsp;<span class="op" id="7656270">(</span><span class="ident" id="7656271">t</span>&nbsp;<span class="op" id="7656273">*</span><span class="ident" id="7656274"><a href="/net/rpc/server_test.go.html#7655962">NeedsPtrType</a></span><span class="op" id="7656286">)</span>&nbsp;<span class="ident" id="7656288">NeedsPtrType</span><span class="op" id="7656300">(</span><span class="ident" id="7656301">args</span>&nbsp;<span class="op" id="7656306">*</span><span class="ident" id="7656307"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7656311">,</span>&nbsp;<span class="ident" id="7656313">reply</span>&nbsp;<span class="op" id="7656319">*</span><span class="ident" id="7656320"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7656325">)</span>&nbsp;<span class="builtintype" id="7656327">error</span>&nbsp;<span class="op" id="7656333">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656336">return</span>&nbsp;<span class="ident" id="7656343">nil</span><br>
<span class="lineno"></span><span class="op" id="7656347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7656350">//&nbsp;Check&nbsp;that&nbsp;registration&nbsp;handles&nbsp;lots&nbsp;of&nbsp;bad&nbsp;methods&nbsp;and&nbsp;a&nbsp;type&nbsp;with&nbsp;no&nbsp;suitable&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="7656442">func</span>&nbsp;<span class="ident" id="7656447">TestRegistrationError</span><span class="op" id="7656468">(</span><span class="ident" id="7656469">t</span>&nbsp;<span class="op" id="7656471">*</span><span class="ident" id="7656472"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7656479">.</span><span class="ident" id="7656480">T</span><span class="op" id="7656481">)</span>&nbsp;<span class="op" id="7656483">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656486">err</span>&nbsp;<span class="op" id="7656490">:=</span>&nbsp;<span class="ident" id="7656493"><a href="/net/rpc/server.go.html#5807380">Register</a></span><span class="op" id="7656501">(</span><span class="builtinfunc" id="7656502">new</span><span class="op" id="7656505">(</span><span class="ident" id="7656506"><a href="/net/rpc/server_test.go.html#7655891">ReplyNotPointer</a></span><span class="op" id="7656521">)</span><span class="op" id="7656522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656525">if</span>&nbsp;<span class="ident" id="7656528"><a href="/net/rpc/server_test.go.html#7656486">err</a></span>&nbsp;<span class="op" id="7656532">==</span>&nbsp;<span class="ident" id="7656535">nil</span>&nbsp;<span class="op" id="7656539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656543"><a href="/net/rpc/server_test.go.html#7656469">t</a></span><span class="op" id="7656544">.</span><span class="ident" id="7656545">Error</span><span class="op" id="7656550">(</span><span class="string" id="7656551">&#34;expected&nbsp;error&nbsp;registering&nbsp;ReplyNotPointer&#34;</span><span class="op" id="7656595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656601"><a href="/net/rpc/server_test.go.html#7656486">err</a></span>&nbsp;<span class="op" id="7656605">=</span>&nbsp;<span class="ident" id="7656607"><a href="/net/rpc/server.go.html#5807380">Register</a></span><span class="op" id="7656615">(</span><span class="builtinfunc" id="7656616">new</span><span class="op" id="7656619">(</span><span class="ident" id="7656620"><a href="/net/rpc/server_test.go.html#7655916">ArgNotPublic</a></span><span class="op" id="7656632">)</span><span class="op" id="7656633">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656636">if</span>&nbsp;<span class="ident" id="7656639"><a href="/net/rpc/server_test.go.html#7656486">err</a></span>&nbsp;<span class="op" id="7656643">==</span>&nbsp;<span class="ident" id="7656646">nil</span>&nbsp;<span class="op" id="7656650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656654"><a href="/net/rpc/server_test.go.html#7656469">t</a></span><span class="op" id="7656655">.</span><span class="ident" id="7656656">Error</span><span class="op" id="7656661">(</span><span class="string" id="7656662">&#34;expected&nbsp;error&nbsp;registering&nbsp;ArgNotPublic&#34;</span><span class="op" id="7656703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656709"><a href="/net/rpc/server_test.go.html#7656486">err</a></span>&nbsp;<span class="op" id="7656713">=</span>&nbsp;<span class="ident" id="7656715"><a href="/net/rpc/server.go.html#5807380">Register</a></span><span class="op" id="7656723">(</span><span class="builtinfunc" id="7656724">new</span><span class="op" id="7656727">(</span><span class="ident" id="7656728"><a href="/net/rpc/server_test.go.html#7655938">ReplyNotPublic</a></span><span class="op" id="7656742">)</span><span class="op" id="7656743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656746">if</span>&nbsp;<span class="ident" id="7656749"><a href="/net/rpc/server_test.go.html#7656486">err</a></span>&nbsp;<span class="op" id="7656753">==</span>&nbsp;<span class="ident" id="7656756">nil</span>&nbsp;<span class="op" id="7656760">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656764"><a href="/net/rpc/server_test.go.html#7656469">t</a></span><span class="op" id="7656765">.</span><span class="ident" id="7656766">Error</span><span class="op" id="7656771">(</span><span class="string" id="7656772">&#34;expected&nbsp;error&nbsp;registering&nbsp;ReplyNotPublic&#34;</span><span class="op" id="7656815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656821"><a href="/net/rpc/server_test.go.html#7656486">err</a></span>&nbsp;<span class="op" id="7656825">=</span>&nbsp;<span class="ident" id="7656827"><a href="/net/rpc/server.go.html#5807380">Register</a></span><span class="op" id="7656835">(</span><span class="ident" id="7656836"><a href="/net/rpc/server_test.go.html#7655962">NeedsPtrType</a></span><span class="op" id="7656848">(</span><span class="num" id="7656849">0</span><span class="op" id="7656850">)</span><span class="op" id="7656851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656854">if</span>&nbsp;<span class="ident" id="7656857"><a href="/net/rpc/server_test.go.html#7656486">err</a></span>&nbsp;<span class="op" id="7656861">==</span>&nbsp;<span class="ident" id="7656864">nil</span>&nbsp;<span class="op" id="7656868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656872"><a href="/net/rpc/server_test.go.html#7656469">t</a></span><span class="op" id="7656873">.</span><span class="ident" id="7656874">Error</span><span class="op" id="7656879">(</span><span class="string" id="7656880">&#34;expected&nbsp;error&nbsp;registering&nbsp;NeedsPtrType&#34;</span><span class="op" id="7656921">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656924">}</span>&nbsp;<span class="keyword" id="7656926">else</span>&nbsp;<span class="keyword" id="7656931">if</span>&nbsp;<span class="op" id="7656934">!</span><span class="ident" id="7656935"><a href="/net/rpc/server_test.go.html#7646929">strings</a></span><span class="op" id="7656942">.</span><span class="ident" id="7656943">Contains</span><span class="op" id="7656951">(</span><span class="ident" id="7656952"><a href="/net/rpc/server_test.go.html#7656486">err</a></span><span class="op" id="7656955">.</span><span class="ident" id="7656956">Error</span><span class="op" id="7656961">(</span><span class="op" id="7656962">)</span><span class="op" id="7656963">,</span>&nbsp;<span class="string" id="7656965">&#34;pointer&#34;</span><span class="op" id="7656974">)</span>&nbsp;<span class="op" id="7656976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656980"><a href="/net/rpc/server_test.go.html#7656469">t</a></span><span class="op" id="7656981">.</span><span class="ident" id="7656982">Error</span><span class="op" id="7656987">(</span><span class="string" id="7656988">&#34;expected&nbsp;hint&nbsp;when&nbsp;registering&nbsp;NeedsPtrType&#34;</span><span class="op" id="7657033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657036">}</span><br>
<span class="lineno"></span><span class="op" id="7657038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="keyword" id="7657041">type</span>&nbsp;<span class="ident" id="7657046">WriteFailCodec</span>&nbsp;<span class="builtintype" id="7657061">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7657066">func</span>&nbsp;<span class="op" id="7657071">(</span><span class="ident" id="7657072"><a href="/net/rpc/server_test.go.html#7657046">WriteFailCodec</a></span><span class="op" id="7657086">)</span>&nbsp;<span class="ident" id="7657088">WriteRequest</span><span class="op" id="7657100">(</span><span class="op" id="7657101">*</span><span class="ident" id="7657102"><a href="/net/rpc/server.go.html#5794226">Request</a></span><span class="op" id="7657109">,</span>&nbsp;<span class="keyword" id="7657111">interface</span><span class="op" id="7657120">{</span><span class="op" id="7657121">}</span><span class="op" id="7657122">)</span>&nbsp;<span class="builtintype" id="7657124">error</span>&nbsp;<span class="op" id="7657130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7657133">//&nbsp;the&nbsp;panic&nbsp;caused&nbsp;by&nbsp;this&nbsp;error&nbsp;used&nbsp;to&nbsp;not&nbsp;unlock&nbsp;a&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657195">return</span>&nbsp;<span class="ident" id="7657202"><a href="/net/rpc/server_test.go.html#7646860">errors</a></span><span class="op" id="7657208">.</span><span class="ident" id="7657209">New</span><span class="op" id="7657212">(</span><span class="string" id="7657213">&#34;fail&#34;</span><span class="op" id="7657219">)</span><br>
<span class="lineno">435</span><span class="op" id="7657221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7657224">func</span>&nbsp;<span class="op" id="7657229">(</span><span class="ident" id="7657230"><a href="/net/rpc/server_test.go.html#7657046">WriteFailCodec</a></span><span class="op" id="7657244">)</span>&nbsp;<span class="ident" id="7657246">ReadResponseHeader</span><span class="op" id="7657264">(</span><span class="op" id="7657265">*</span><span class="ident" id="7657266"><a href="/net/rpc/server.go.html#5794584">Response</a></span><span class="op" id="7657274">)</span>&nbsp;<span class="builtintype" id="7657276">error</span>&nbsp;<span class="op" id="7657282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657285">select</span>&nbsp;<span class="op" id="7657292">{</span><span class="op" id="7657293">}</span><br>
<span class="lineno"></span><span class="op" id="7657295">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="keyword" id="7657298">func</span>&nbsp;<span class="op" id="7657303">(</span><span class="ident" id="7657304"><a href="/net/rpc/server_test.go.html#7657046">WriteFailCodec</a></span><span class="op" id="7657318">)</span>&nbsp;<span class="ident" id="7657320">ReadResponseBody</span><span class="op" id="7657336">(</span><span class="keyword" id="7657337">interface</span><span class="op" id="7657346">{</span><span class="op" id="7657347">}</span><span class="op" id="7657348">)</span>&nbsp;<span class="builtintype" id="7657350">error</span>&nbsp;<span class="op" id="7657356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657359">select</span>&nbsp;<span class="op" id="7657366">{</span><span class="op" id="7657367">}</span><br>
<span class="lineno"></span><span class="op" id="7657369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="7657372">func</span>&nbsp;<span class="op" id="7657377">(</span><span class="ident" id="7657378"><a href="/net/rpc/server_test.go.html#7657046">WriteFailCodec</a></span><span class="op" id="7657392">)</span>&nbsp;<span class="ident" id="7657394">Close</span><span class="op" id="7657399">(</span><span class="op" id="7657400">)</span>&nbsp;<span class="builtintype" id="7657402">error</span>&nbsp;<span class="op" id="7657408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657411">return</span>&nbsp;<span class="ident" id="7657418">nil</span><br>
<span class="lineno"></span><span class="op" id="7657422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7657425">func</span>&nbsp;<span class="ident" id="7657430">TestSendDeadlock</span><span class="op" id="7657446">(</span><span class="ident" id="7657447">t</span>&nbsp;<span class="op" id="7657449">*</span><span class="ident" id="7657450"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7657457">.</span><span class="ident" id="7657458">T</span><span class="op" id="7657459">)</span>&nbsp;<span class="op" id="7657461">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657464">client</span>&nbsp;<span class="op" id="7657471">:=</span>&nbsp;<span class="ident" id="7657474"><a href="/net/rpc/client.go.html#5783532">NewClientWithCodec</a></span><span class="op" id="7657492">(</span><span class="ident" id="7657493"><a href="/net/rpc/server_test.go.html#7657046">WriteFailCodec</a></span><span class="op" id="7657507">(</span><span class="num" id="7657508">0</span><span class="op" id="7657509">)</span><span class="op" id="7657510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657513">defer</span>&nbsp;<span class="ident" id="7657519"><a href="/net/rpc/server_test.go.html#7657464">client</a></span><span class="op" id="7657525">.</span><span class="ident" id="7657526">Close</span><span class="op" id="7657531">(</span><span class="op" id="7657532">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657536">done</span>&nbsp;<span class="op" id="7657541">:=</span>&nbsp;<span class="builtinfunc" id="7657544">make</span><span class="op" id="7657548">(</span><span class="keyword" id="7657549">chan</span>&nbsp;<span class="builtintype" id="7657554">bool</span><span class="op" id="7657558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657561">go</span>&nbsp;<span class="keyword" id="7657564">func</span><span class="op" id="7657568">(</span><span class="op" id="7657569">)</span>&nbsp;<span class="op" id="7657571">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657575"><a href="/net/rpc/server_test.go.html#7657750">testSendDeadlock</a></span><span class="op" id="7657591">(</span><span class="ident" id="7657592"><a href="/net/rpc/server_test.go.html#7657464">client</a></span><span class="op" id="7657598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657602"><a href="/net/rpc/server_test.go.html#7657750">testSendDeadlock</a></span><span class="op" id="7657618">(</span><span class="ident" id="7657619"><a href="/net/rpc/server_test.go.html#7657464">client</a></span><span class="op" id="7657625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657629"><a href="/net/rpc/server_test.go.html#7657536">done</a></span>&nbsp;<span class="op" id="7657634">&lt;-</span>&nbsp;<span class="builtintype" id="7657637">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657643">}</span><span class="op" id="7657644">(</span><span class="op" id="7657645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657648">select</span>&nbsp;<span class="op" id="7657655">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657658">case</span>&nbsp;<span class="op" id="7657663">&lt;-</span><span class="ident" id="7657665"><a href="/net/rpc/server_test.go.html#7657536">done</a></span><span class="op" id="7657669">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657673">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657681">case</span>&nbsp;<span class="op" id="7657686">&lt;-</span><span class="ident" id="7657688"><a href="/net/rpc/server_test.go.html#7646974">time</a></span><span class="op" id="7657692">.</span><span class="ident" id="7657693">After</span><span class="op" id="7657698">(</span><span class="num" id="7657699">5</span>&nbsp;<span class="op" id="7657701">*</span>&nbsp;<span class="ident" id="7657703"><a href="/net/rpc/server_test.go.html#7646974">time</a></span><span class="op" id="7657707">.</span><span class="ident" id="7657708">Second</span><span class="op" id="7657714">)</span><span class="op" id="7657715">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657719"><a href="/net/rpc/server_test.go.html#7657447">t</a></span><span class="op" id="7657720">.</span><span class="ident" id="7657721">Fatal</span><span class="op" id="7657726">(</span><span class="string" id="7657727">&#34;deadlock&#34;</span><span class="op" id="7657737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657740">}</span><br>
<span class="lineno">465</span><span class="op" id="7657742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7657745">func</span>&nbsp;<span class="ident" id="7657750">testSendDeadlock</span><span class="op" id="7657766">(</span><span class="ident" id="7657767">client</span>&nbsp;<span class="op" id="7657774">*</span><span class="ident" id="7657775"><a href="/net/rpc/client.go.html#5779222">Client</a></span><span class="op" id="7657781">)</span>&nbsp;<span class="op" id="7657783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657786">defer</span>&nbsp;<span class="keyword" id="7657792">func</span><span class="op" id="7657796">(</span><span class="op" id="7657797">)</span>&nbsp;<span class="op" id="7657799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7657803">recover</span><span class="op" id="7657810">(</span><span class="op" id="7657811">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657814">}</span><span class="op" id="7657815">(</span><span class="op" id="7657816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657819">args</span>&nbsp;<span class="op" id="7657824">:=</span>&nbsp;<span class="op" id="7657827">&amp;</span><span class="ident" id="7657828"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7657832">{</span><span class="num" id="7657833">7</span><span class="op" id="7657834">,</span>&nbsp;<span class="num" id="7657836">8</span><span class="op" id="7657837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657840">reply</span>&nbsp;<span class="op" id="7657846">:=</span>&nbsp;<span class="builtinfunc" id="7657849">new</span><span class="op" id="7657852">(</span><span class="ident" id="7657853"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7657858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657861"><a href="/net/rpc/server_test.go.html#7657767">client</a></span><span class="op" id="7657867">.</span><span class="ident" id="7657868">Call</span><span class="op" id="7657872">(</span><span class="string" id="7657873">&#34;Arith.Add&#34;</span><span class="op" id="7657884">,</span>&nbsp;<span class="ident" id="7657886"><a href="/net/rpc/server_test.go.html#7657819">args</a></span><span class="op" id="7657890">,</span>&nbsp;<span class="ident" id="7657892"><a href="/net/rpc/server_test.go.html#7657840">reply</a></span><span class="op" id="7657897">)</span><br>
<span class="lineno"></span><span class="op" id="7657899">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="keyword" id="7657902">func</span>&nbsp;<span class="ident" id="7657907">dialDirect</span><span class="op" id="7657917">(</span><span class="op" id="7657918">)</span>&nbsp;<span class="op" id="7657920">(</span><span class="op" id="7657921">*</span><span class="ident" id="7657922"><a href="/net/rpc/client.go.html#5779222">Client</a></span><span class="op" id="7657928">,</span>&nbsp;<span class="builtintype" id="7657930">error</span><span class="op" id="7657935">)</span>&nbsp;<span class="op" id="7657937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657940">return</span>&nbsp;<span class="ident" id="7657947"><a href="/net/rpc/client.go.html#5785360">Dial</a></span><span class="op" id="7657951">(</span><span class="string" id="7657952">&#34;tcp&#34;</span><span class="op" id="7657957">,</span>&nbsp;<span class="ident" id="7657959"><a href="/net/rpc/server_test.go.html#7647026">serverAddr</a></span><span class="op" id="7657969">)</span><br>
<span class="lineno"></span><span class="op" id="7657971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="7657974">func</span>&nbsp;<span class="ident" id="7657979">dialHTTP</span><span class="op" id="7657987">(</span><span class="op" id="7657988">)</span>&nbsp;<span class="op" id="7657990">(</span><span class="op" id="7657991">*</span><span class="ident" id="7657992"><a href="/net/rpc/client.go.html#5779222">Client</a></span><span class="op" id="7657998">,</span>&nbsp;<span class="builtintype" id="7658000">error</span><span class="op" id="7658005">)</span>&nbsp;<span class="op" id="7658007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658010">return</span>&nbsp;<span class="ident" id="7658017"><a href="/net/rpc/client.go.html#5784413">DialHTTP</a></span><span class="op" id="7658025">(</span><span class="string" id="7658026">&#34;tcp&#34;</span><span class="op" id="7658031">,</span>&nbsp;<span class="ident" id="7658033"><a href="/net/rpc/server_test.go.html#7647060">httpServerAddr</a></span><span class="op" id="7658047">)</span><br>
<span class="lineno"></span><span class="op" id="7658049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7658052">func</span>&nbsp;<span class="ident" id="7658057">countMallocs</span><span class="op" id="7658069">(</span><span class="ident" id="7658070">dial</span>&nbsp;<span class="keyword" id="7658075">func</span><span class="op" id="7658079">(</span><span class="op" id="7658080">)</span>&nbsp;<span class="op" id="7658082">(</span><span class="op" id="7658083">*</span><span class="ident" id="7658084"><a href="/net/rpc/client.go.html#5779222">Client</a></span><span class="op" id="7658090">,</span>&nbsp;<span class="builtintype" id="7658092">error</span><span class="op" id="7658097">)</span><span class="op" id="7658098">,</span>&nbsp;<span class="ident" id="7658100">t</span>&nbsp;<span class="op" id="7658102">*</span><span class="ident" id="7658103"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7658110">.</span><span class="ident" id="7658111">T</span><span class="op" id="7658112">)</span>&nbsp;<span class="builtintype" id="7658114">float64</span>&nbsp;<span class="op" id="7658122">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658125"><a href="/net/rpc/server_test.go.html#7647094">once</a></span><span class="op" id="7658129">.</span><span class="ident" id="7658130">Do</span><span class="op" id="7658132">(</span><span class="ident" id="7658133"><a href="/net/rpc/server_test.go.html#7648204">startServer</a></span><span class="op" id="7658144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658147">client</span><span class="op" id="7658153">,</span>&nbsp;<span class="ident" id="7658155">err</span>&nbsp;<span class="op" id="7658159">:=</span>&nbsp;<span class="ident" id="7658162"><a href="/net/rpc/server_test.go.html#7658070">dial</a></span><span class="op" id="7658166">(</span><span class="op" id="7658167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658170">if</span>&nbsp;<span class="ident" id="7658173"><a href="/net/rpc/server_test.go.html#7658155">err</a></span>&nbsp;<span class="op" id="7658177">!=</span>&nbsp;<span class="ident" id="7658180">nil</span>&nbsp;<span class="op" id="7658184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658188"><a href="/net/rpc/server_test.go.html#7658100">t</a></span><span class="op" id="7658189">.</span><span class="ident" id="7658190">Fatal</span><span class="op" id="7658195">(</span><span class="string" id="7658196">&#34;error&nbsp;dialing&#34;</span><span class="op" id="7658211">,</span>&nbsp;<span class="ident" id="7658213"><a href="/net/rpc/server_test.go.html#7658155">err</a></span><span class="op" id="7658216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658219">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658222">defer</span>&nbsp;<span class="ident" id="7658228"><a href="/net/rpc/server_test.go.html#7658147">client</a></span><span class="op" id="7658234">.</span><span class="ident" id="7658235">Close</span><span class="op" id="7658240">(</span><span class="op" id="7658241">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658245">args</span>&nbsp;<span class="op" id="7658250">:=</span>&nbsp;<span class="op" id="7658253">&amp;</span><span class="ident" id="7658254"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7658258">{</span><span class="num" id="7658259">7</span><span class="op" id="7658260">,</span>&nbsp;<span class="num" id="7658262">8</span><span class="op" id="7658263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658266">reply</span>&nbsp;<span class="op" id="7658272">:=</span>&nbsp;<span class="builtinfunc" id="7658275">new</span><span class="op" id="7658278">(</span><span class="ident" id="7658279"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7658284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658287">return</span>&nbsp;<span class="ident" id="7658294"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7658301">.</span><span class="ident" id="7658302">AllocsPerRun</span><span class="op" id="7658314">(</span><span class="num" id="7658315">100</span><span class="op" id="7658318">,</span>&nbsp;<span class="keyword" id="7658320">func</span><span class="op" id="7658324">(</span><span class="op" id="7658325">)</span>&nbsp;<span class="op" id="7658327">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658331">err</span>&nbsp;<span class="op" id="7658335">:=</span>&nbsp;<span class="ident" id="7658338"><a href="/net/rpc/server_test.go.html#7658147">client</a></span><span class="op" id="7658344">.</span><span class="ident" id="7658345">Call</span><span class="op" id="7658349">(</span><span class="string" id="7658350">&#34;Arith.Add&#34;</span><span class="op" id="7658361">,</span>&nbsp;<span class="ident" id="7658363"><a href="/net/rpc/server_test.go.html#7658245">args</a></span><span class="op" id="7658367">,</span>&nbsp;<span class="ident" id="7658369"><a href="/net/rpc/server_test.go.html#7658266">reply</a></span><span class="op" id="7658374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658378">if</span>&nbsp;<span class="ident" id="7658381"><a href="/net/rpc/server_test.go.html#7658331">err</a></span>&nbsp;<span class="op" id="7658385">!=</span>&nbsp;<span class="ident" id="7658388">nil</span>&nbsp;<span class="op" id="7658392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658397"><a href="/net/rpc/server_test.go.html#7658100">t</a></span><span class="op" id="7658398">.</span><span class="ident" id="7658399">Errorf</span><span class="op" id="7658405">(</span><span class="string" id="7658406">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7658448">,</span>&nbsp;<span class="ident" id="7658450"><a href="/net/rpc/server_test.go.html#7658331">err</a></span><span class="op" id="7658453">.</span><span class="ident" id="7658454">Error</span><span class="op" id="7658459">(</span><span class="op" id="7658460">)</span><span class="op" id="7658461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658469">if</span>&nbsp;<span class="ident" id="7658472"><a href="/net/rpc/server_test.go.html#7658266">reply</a></span><span class="op" id="7658477">.</span><span class="ident" id="7658478">C</span>&nbsp;<span class="op" id="7658480">!=</span>&nbsp;<span class="ident" id="7658483"><a href="/net/rpc/server_test.go.html#7658245">args</a></span><span class="op" id="7658487">.</span><span class="ident" id="7658488">A</span><span class="op" id="7658489">+</span><span class="ident" id="7658490"><a href="/net/rpc/server_test.go.html#7658245">args</a></span><span class="op" id="7658494">.</span><span class="ident" id="7658495">B</span>&nbsp;<span class="op" id="7658497">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658502"><a href="/net/rpc/server_test.go.html#7658100">t</a></span><span class="op" id="7658503">.</span><span class="ident" id="7658504">Errorf</span><span class="op" id="7658510">(</span><span class="string" id="7658511">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7658536">,</span>&nbsp;<span class="ident" id="7658538"><a href="/net/rpc/server_test.go.html#7658266">reply</a></span><span class="op" id="7658543">.</span><span class="ident" id="7658544">C</span><span class="op" id="7658545">,</span>&nbsp;<span class="ident" id="7658547"><a href="/net/rpc/server_test.go.html#7658245">args</a></span><span class="op" id="7658551">.</span><span class="ident" id="7658552">A</span><span class="op" id="7658553">+</span><span class="ident" id="7658554"><a href="/net/rpc/server_test.go.html#7658245">args</a></span><span class="op" id="7658558">.</span><span class="ident" id="7658559">B</span><span class="op" id="7658560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658567">}</span><span class="op" id="7658568">)</span><br>
<span class="lineno"></span><span class="op" id="7658570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">505</span><span class="keyword" id="7658573">func</span>&nbsp;<span class="ident" id="7658578">TestCountMallocs</span><span class="op" id="7658594">(</span><span class="ident" id="7658595">t</span>&nbsp;<span class="op" id="7658597">*</span><span class="ident" id="7658598"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7658605">.</span><span class="ident" id="7658606">T</span><span class="op" id="7658607">)</span>&nbsp;<span class="op" id="7658609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658612">if</span>&nbsp;<span class="ident" id="7658615"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7658622">.</span><span class="ident" id="7658623">Short</span><span class="op" id="7658628">(</span><span class="op" id="7658629">)</span>&nbsp;<span class="op" id="7658631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658635"><a href="/net/rpc/server_test.go.html#7658595">t</a></span><span class="op" id="7658636">.</span><span class="ident" id="7658637">Skip</span><span class="op" id="7658641">(</span><span class="string" id="7658642">&#34;skipping&nbsp;malloc&nbsp;count&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7658679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658685">if</span>&nbsp;<span class="ident" id="7658688"><a href="/net/rpc/server_test.go.html#7646918">runtime</a></span><span class="op" id="7658695">.</span><span class="ident" id="7658696">GOMAXPROCS</span><span class="op" id="7658706">(</span><span class="num" id="7658707">0</span><span class="op" id="7658708">)</span>&nbsp;<span class="op" id="7658710">&gt;</span>&nbsp;<span class="num" id="7658712">1</span>&nbsp;<span class="op" id="7658714">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658718"><a href="/net/rpc/server_test.go.html#7658595">t</a></span><span class="op" id="7658719">.</span><span class="ident" id="7658720">Skip</span><span class="op" id="7658724">(</span><span class="string" id="7658725">&#34;skipping;&nbsp;GOMAXPROCS&gt;1&#34;</span><span class="op" id="7658749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658755"><a href="/net/rpc/server_test.go.html#7646870">fmt</a></span><span class="op" id="7658758">.</span><span class="ident" id="7658759">Printf</span><span class="op" id="7658765">(</span><span class="string" id="7658766">&#34;mallocs&nbsp;per&nbsp;rpc&nbsp;round&nbsp;trip:&nbsp;%v\n&#34;</span><span class="op" id="7658800">,</span>&nbsp;<span class="ident" id="7658802"><a href="/net/rpc/server_test.go.html#7658057">countMallocs</a></span><span class="op" id="7658814">(</span><span class="ident" id="7658815"><a href="/net/rpc/server_test.go.html#7657907">dialDirect</a></span><span class="op" id="7658825">,</span>&nbsp;<span class="ident" id="7658827"><a href="/net/rpc/server_test.go.html#7658595">t</a></span><span class="op" id="7658828">)</span><span class="op" id="7658829">)</span><br>
<span class="lineno"></span><span class="op" id="7658831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7658834">func</span>&nbsp;<span class="ident" id="7658839">TestCountMallocsOverHTTP</span><span class="op" id="7658863">(</span><span class="ident" id="7658864">t</span>&nbsp;<span class="op" id="7658866">*</span><span class="ident" id="7658867"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7658874">.</span><span class="ident" id="7658875">T</span><span class="op" id="7658876">)</span>&nbsp;<span class="op" id="7658878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658881">if</span>&nbsp;<span class="ident" id="7658884"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7658891">.</span><span class="ident" id="7658892">Short</span><span class="op" id="7658897">(</span><span class="op" id="7658898">)</span>&nbsp;<span class="op" id="7658900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658904"><a href="/net/rpc/server_test.go.html#7658864">t</a></span><span class="op" id="7658905">.</span><span class="ident" id="7658906">Skip</span><span class="op" id="7658910">(</span><span class="string" id="7658911">&#34;skipping&nbsp;malloc&nbsp;count&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7658948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658954">if</span>&nbsp;<span class="ident" id="7658957"><a href="/net/rpc/server_test.go.html#7646918">runtime</a></span><span class="op" id="7658964">.</span><span class="ident" id="7658965">GOMAXPROCS</span><span class="op" id="7658975">(</span><span class="num" id="7658976">0</span><span class="op" id="7658977">)</span>&nbsp;<span class="op" id="7658979">&gt;</span>&nbsp;<span class="num" id="7658981">1</span>&nbsp;<span class="op" id="7658983">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658987"><a href="/net/rpc/server_test.go.html#7658864">t</a></span><span class="op" id="7658988">.</span><span class="ident" id="7658989">Skip</span><span class="op" id="7658993">(</span><span class="string" id="7658994">&#34;skipping;&nbsp;GOMAXPROCS&gt;1&#34;</span><span class="op" id="7659018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659024"><a href="/net/rpc/server_test.go.html#7646870">fmt</a></span><span class="op" id="7659027">.</span><span class="ident" id="7659028">Printf</span><span class="op" id="7659034">(</span><span class="string" id="7659035">&#34;mallocs&nbsp;per&nbsp;HTTP&nbsp;rpc&nbsp;round&nbsp;trip:&nbsp;%v\n&#34;</span><span class="op" id="7659074">,</span>&nbsp;<span class="ident" id="7659076"><a href="/net/rpc/server_test.go.html#7658057">countMallocs</a></span><span class="op" id="7659088">(</span><span class="ident" id="7659089"><a href="/net/rpc/server_test.go.html#7657979">dialHTTP</a></span><span class="op" id="7659097">,</span>&nbsp;<span class="ident" id="7659099"><a href="/net/rpc/server_test.go.html#7658864">t</a></span><span class="op" id="7659100">)</span><span class="op" id="7659101">)</span><br>
<span class="lineno"></span><span class="op" id="7659103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="7659106">type</span>&nbsp;<span class="ident" id="7659111">writeCrasher</span>&nbsp;<span class="keyword" id="7659124">struct</span>&nbsp;<span class="op" id="7659131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659134">done</span>&nbsp;<span class="keyword" id="7659139">chan</span>&nbsp;<span class="builtintype" id="7659144">bool</span><br>
<span class="lineno"></span><span class="op" id="7659149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7659152">func</span>&nbsp;<span class="op" id="7659157">(</span><span class="ident" id="7659158"><a href="/net/rpc/server_test.go.html#7659111">writeCrasher</a></span><span class="op" id="7659170">)</span>&nbsp;<span class="ident" id="7659172">Close</span><span class="op" id="7659177">(</span><span class="op" id="7659178">)</span>&nbsp;<span class="builtintype" id="7659180">error</span>&nbsp;<span class="op" id="7659186">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659189">return</span>&nbsp;<span class="ident" id="7659196">nil</span><br>
<span class="lineno"></span><span class="op" id="7659200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7659203">func</span>&nbsp;<span class="op" id="7659208">(</span><span class="ident" id="7659209">w</span>&nbsp;<span class="op" id="7659211">*</span><span class="ident" id="7659212"><a href="/net/rpc/server_test.go.html#7659111">writeCrasher</a></span><span class="op" id="7659224">)</span>&nbsp;<span class="ident" id="7659226">Read</span><span class="op" id="7659230">(</span><span class="ident" id="7659231">p</span>&nbsp;<span class="op" id="7659233">[</span><span class="op" id="7659234">]</span><span class="builtintype" id="7659235">byte</span><span class="op" id="7659239">)</span>&nbsp;<span class="op" id="7659241">(</span><span class="builtintype" id="7659242">int</span><span class="op" id="7659245">,</span>&nbsp;<span class="builtintype" id="7659247">error</span><span class="op" id="7659252">)</span>&nbsp;<span class="op" id="7659254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659257">&lt;-</span><span class="ident" id="7659259"><a href="/net/rpc/server_test.go.html#7659209">w</a></span><span class="op" id="7659260">.</span><span class="ident" id="7659261">done</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659267">return</span>&nbsp;<span class="num" id="7659274">0</span><span class="op" id="7659275">,</span>&nbsp;<span class="ident" id="7659277"><a href="/net/rpc/server_test.go.html#7646877">io</a></span><span class="op" id="7659279">.</span><span class="ident" id="7659280">EOF</span><br>
<span class="lineno"></span><span class="op" id="7659284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7659287">func</span>&nbsp;<span class="op" id="7659292">(</span><span class="ident" id="7659293"><a href="/net/rpc/server_test.go.html#7659111">writeCrasher</a></span><span class="op" id="7659305">)</span>&nbsp;<span class="ident" id="7659307">Write</span><span class="op" id="7659312">(</span><span class="ident" id="7659313">p</span>&nbsp;<span class="op" id="7659315">[</span><span class="op" id="7659316">]</span><span class="builtintype" id="7659317">byte</span><span class="op" id="7659321">)</span>&nbsp;<span class="op" id="7659323">(</span><span class="builtintype" id="7659324">int</span><span class="op" id="7659327">,</span>&nbsp;<span class="builtintype" id="7659329">error</span><span class="op" id="7659334">)</span>&nbsp;<span class="op" id="7659336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659339">return</span>&nbsp;<span class="num" id="7659346">0</span><span class="op" id="7659347">,</span>&nbsp;<span class="ident" id="7659349"><a href="/net/rpc/server_test.go.html#7646860">errors</a></span><span class="op" id="7659355">.</span><span class="ident" id="7659356">New</span><span class="op" id="7659359">(</span><span class="string" id="7659360">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="7659380">)</span><br>
<span class="lineno">540</span><span class="op" id="7659382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7659385">func</span>&nbsp;<span class="ident" id="7659390">TestClientWriteError</span><span class="op" id="7659410">(</span><span class="ident" id="7659411">t</span>&nbsp;<span class="op" id="7659413">*</span><span class="ident" id="7659414"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7659421">.</span><span class="ident" id="7659422">T</span><span class="op" id="7659423">)</span>&nbsp;<span class="op" id="7659425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659428">w</span>&nbsp;<span class="op" id="7659430">:=</span>&nbsp;<span class="op" id="7659433">&amp;</span><span class="ident" id="7659434"><a href="/net/rpc/server_test.go.html#7659111">writeCrasher</a></span><span class="op" id="7659446">{</span><span class="ident" id="7659447">done</span><span class="op" id="7659451">:</span>&nbsp;<span class="builtinfunc" id="7659453">make</span><span class="op" id="7659457">(</span><span class="keyword" id="7659458">chan</span>&nbsp;<span class="builtintype" id="7659463">bool</span><span class="op" id="7659467">)</span><span class="op" id="7659468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659471">c</span>&nbsp;<span class="op" id="7659473">:=</span>&nbsp;<span class="ident" id="7659476"><a href="/net/rpc/client.go.html#5783211">NewClient</a></span><span class="op" id="7659485">(</span><span class="ident" id="7659486"><a href="/net/rpc/server_test.go.html#7659428">w</a></span><span class="op" id="7659487">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659490">defer</span>&nbsp;<span class="ident" id="7659496"><a href="/net/rpc/server_test.go.html#7659471">c</a></span><span class="op" id="7659497">.</span><span class="ident" id="7659498">Close</span><span class="op" id="7659503">(</span><span class="op" id="7659504">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659508">res</span>&nbsp;<span class="op" id="7659512">:=</span>&nbsp;<span class="builtintype" id="7659515">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659522">err</span>&nbsp;<span class="op" id="7659526">:=</span>&nbsp;<span class="ident" id="7659529"><a href="/net/rpc/server_test.go.html#7659471">c</a></span><span class="op" id="7659530">.</span><span class="ident" id="7659531">Call</span><span class="op" id="7659535">(</span><span class="string" id="7659536">&#34;foo&#34;</span><span class="op" id="7659541">,</span>&nbsp;<span class="num" id="7659543">1</span><span class="op" id="7659544">,</span>&nbsp;<span class="op" id="7659546">&amp;</span><span class="ident" id="7659547"><a href="/net/rpc/server_test.go.html#7659508">res</a></span><span class="op" id="7659550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659553">if</span>&nbsp;<span class="ident" id="7659556"><a href="/net/rpc/server_test.go.html#7659522">err</a></span>&nbsp;<span class="op" id="7659560">==</span>&nbsp;<span class="ident" id="7659563">nil</span>&nbsp;<span class="op" id="7659567">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659571"><a href="/net/rpc/server_test.go.html#7659411">t</a></span><span class="op" id="7659572">.</span><span class="ident" id="7659573">Fatal</span><span class="op" id="7659578">(</span><span class="string" id="7659579">&#34;expected&nbsp;error&#34;</span><span class="op" id="7659595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659601">if</span>&nbsp;<span class="ident" id="7659604"><a href="/net/rpc/server_test.go.html#7659522">err</a></span><span class="op" id="7659607">.</span><span class="ident" id="7659608">Error</span><span class="op" id="7659613">(</span><span class="op" id="7659614">)</span>&nbsp;<span class="op" id="7659616">!=</span>&nbsp;<span class="string" id="7659619">&#34;fake&nbsp;write&nbsp;failure&#34;</span>&nbsp;<span class="op" id="7659640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659644"><a href="/net/rpc/server_test.go.html#7659411">t</a></span><span class="op" id="7659645">.</span><span class="ident" id="7659646">Error</span><span class="op" id="7659651">(</span><span class="string" id="7659652">&#34;unexpected&nbsp;value&nbsp;of&nbsp;error:&#34;</span><span class="op" id="7659680">,</span>&nbsp;<span class="ident" id="7659682"><a href="/net/rpc/server_test.go.html#7659522">err</a></span><span class="op" id="7659685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659688">}</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659691"><a href="/net/rpc/server_test.go.html#7659428">w</a></span><span class="op" id="7659692">.</span><span class="ident" id="7659693">done</span>&nbsp;<span class="op" id="7659698">&lt;-</span>&nbsp;<span class="builtintype" id="7659701">true</span><br>
<span class="lineno"></span><span class="op" id="7659706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7659709">func</span>&nbsp;<span class="ident" id="7659714">TestTCPClose</span><span class="op" id="7659726">(</span><span class="ident" id="7659727">t</span>&nbsp;<span class="op" id="7659729">*</span><span class="ident" id="7659730"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7659737">.</span><span class="ident" id="7659738">T</span><span class="op" id="7659739">)</span>&nbsp;<span class="op" id="7659741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659744"><a href="/net/rpc/server_test.go.html#7647094">once</a></span><span class="op" id="7659748">.</span><span class="ident" id="7659749">Do</span><span class="op" id="7659751">(</span><span class="ident" id="7659752"><a href="/net/rpc/server_test.go.html#7648204">startServer</a></span><span class="op" id="7659763">)</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659767">client</span><span class="op" id="7659773">,</span>&nbsp;<span class="ident" id="7659775">err</span>&nbsp;<span class="op" id="7659779">:=</span>&nbsp;<span class="ident" id="7659782"><a href="/net/rpc/server_test.go.html#7657979">dialHTTP</a></span><span class="op" id="7659790">(</span><span class="op" id="7659791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659794">if</span>&nbsp;<span class="ident" id="7659797"><a href="/net/rpc/server_test.go.html#7659775">err</a></span>&nbsp;<span class="op" id="7659801">!=</span>&nbsp;<span class="ident" id="7659804">nil</span>&nbsp;<span class="op" id="7659808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659812"><a href="/net/rpc/server_test.go.html#7659727">t</a></span><span class="op" id="7659813">.</span><span class="ident" id="7659814">Fatalf</span><span class="op" id="7659820">(</span><span class="string" id="7659821">&#34;dialing:&nbsp;%v&#34;</span><span class="op" id="7659834">,</span>&nbsp;<span class="ident" id="7659836"><a href="/net/rpc/server_test.go.html#7659775">err</a></span><span class="op" id="7659839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659842">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659845">defer</span>&nbsp;<span class="ident" id="7659851"><a href="/net/rpc/server_test.go.html#7659767">client</a></span><span class="op" id="7659857">.</span><span class="ident" id="7659858">Close</span><span class="op" id="7659863">(</span><span class="op" id="7659864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659868">args</span>&nbsp;<span class="op" id="7659873">:=</span>&nbsp;<span class="ident" id="7659876"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7659880">{</span><span class="num" id="7659881">17</span><span class="op" id="7659883">,</span>&nbsp;<span class="num" id="7659885">8</span><span class="op" id="7659886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659889">var</span>&nbsp;<span class="ident" id="7659893">reply</span>&nbsp;<span class="ident" id="7659899"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659906"><a href="/net/rpc/server_test.go.html#7659775">err</a></span>&nbsp;<span class="op" id="7659910">=</span>&nbsp;<span class="ident" id="7659912"><a href="/net/rpc/server_test.go.html#7659767">client</a></span><span class="op" id="7659918">.</span><span class="ident" id="7659919">Call</span><span class="op" id="7659923">(</span><span class="string" id="7659924">&#34;Arith.Mul&#34;</span><span class="op" id="7659935">,</span>&nbsp;<span class="ident" id="7659937"><a href="/net/rpc/server_test.go.html#7659868">args</a></span><span class="op" id="7659941">,</span>&nbsp;<span class="op" id="7659943">&amp;</span><span class="ident" id="7659944"><a href="/net/rpc/server_test.go.html#7659893">reply</a></span><span class="op" id="7659949">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659952">if</span>&nbsp;<span class="ident" id="7659955"><a href="/net/rpc/server_test.go.html#7659775">err</a></span>&nbsp;<span class="op" id="7659959">!=</span>&nbsp;<span class="ident" id="7659962">nil</span>&nbsp;<span class="op" id="7659966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659970"><a href="/net/rpc/server_test.go.html#7659727">t</a></span><span class="op" id="7659971">.</span><span class="ident" id="7659972">Fatal</span><span class="op" id="7659977">(</span><span class="string" id="7659978">&#34;arith&nbsp;error:&#34;</span><span class="op" id="7659992">,</span>&nbsp;<span class="ident" id="7659994"><a href="/net/rpc/server_test.go.html#7659775">err</a></span><span class="op" id="7659997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660003"><a href="/net/rpc/server_test.go.html#7659727">t</a></span><span class="op" id="7660004">.</span><span class="ident" id="7660005">Logf</span><span class="op" id="7660009">(</span><span class="string" id="7660010">&#34;Arith:&nbsp;%d*%d=%d\n&#34;</span><span class="op" id="7660029">,</span>&nbsp;<span class="ident" id="7660031"><a href="/net/rpc/server_test.go.html#7659868">args</a></span><span class="op" id="7660035">.</span><span class="ident" id="7660036">A</span><span class="op" id="7660037">,</span>&nbsp;<span class="ident" id="7660039"><a href="/net/rpc/server_test.go.html#7659868">args</a></span><span class="op" id="7660043">.</span><span class="ident" id="7660044">B</span><span class="op" id="7660045">,</span>&nbsp;<span class="ident" id="7660047"><a href="/net/rpc/server_test.go.html#7659893">reply</a></span><span class="op" id="7660052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660055">if</span>&nbsp;<span class="ident" id="7660058"><a href="/net/rpc/server_test.go.html#7659893">reply</a></span><span class="op" id="7660063">.</span><span class="ident" id="7660064">C</span>&nbsp;<span class="op" id="7660066">!=</span>&nbsp;<span class="ident" id="7660069"><a href="/net/rpc/server_test.go.html#7659868">args</a></span><span class="op" id="7660073">.</span><span class="ident" id="7660074">A</span><span class="op" id="7660075">*</span><span class="ident" id="7660076"><a href="/net/rpc/server_test.go.html#7659868">args</a></span><span class="op" id="7660080">.</span><span class="ident" id="7660081">B</span>&nbsp;<span class="op" id="7660083">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660087"><a href="/net/rpc/server_test.go.html#7659727">t</a></span><span class="op" id="7660088">.</span><span class="ident" id="7660089">Errorf</span><span class="op" id="7660095">(</span><span class="string" id="7660096">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7660121">,</span>&nbsp;<span class="ident" id="7660123"><a href="/net/rpc/server_test.go.html#7659893">reply</a></span><span class="op" id="7660128">.</span><span class="ident" id="7660129">C</span><span class="op" id="7660130">,</span>&nbsp;<span class="ident" id="7660132"><a href="/net/rpc/server_test.go.html#7659868">args</a></span><span class="op" id="7660136">.</span><span class="ident" id="7660137">A</span><span class="op" id="7660138">*</span><span class="ident" id="7660139"><a href="/net/rpc/server_test.go.html#7659868">args</a></span><span class="op" id="7660143">.</span><span class="ident" id="7660144">B</span><span class="op" id="7660145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660148">}</span><br>
<span class="lineno"></span><span class="op" id="7660150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7660153">func</span>&nbsp;<span class="ident" id="7660158">TestErrorAfterClientClose</span><span class="op" id="7660183">(</span><span class="ident" id="7660184">t</span>&nbsp;<span class="op" id="7660186">*</span><span class="ident" id="7660187"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7660194">.</span><span class="ident" id="7660195">T</span><span class="op" id="7660196">)</span>&nbsp;<span class="op" id="7660198">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660201"><a href="/net/rpc/server_test.go.html#7647094">once</a></span><span class="op" id="7660205">.</span><span class="ident" id="7660206">Do</span><span class="op" id="7660208">(</span><span class="ident" id="7660209"><a href="/net/rpc/server_test.go.html#7648204">startServer</a></span><span class="op" id="7660220">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660224">client</span><span class="op" id="7660230">,</span>&nbsp;<span class="ident" id="7660232">err</span>&nbsp;<span class="op" id="7660236">:=</span>&nbsp;<span class="ident" id="7660239"><a href="/net/rpc/server_test.go.html#7657979">dialHTTP</a></span><span class="op" id="7660247">(</span><span class="op" id="7660248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660251">if</span>&nbsp;<span class="ident" id="7660254"><a href="/net/rpc/server_test.go.html#7660232">err</a></span>&nbsp;<span class="op" id="7660258">!=</span>&nbsp;<span class="ident" id="7660261">nil</span>&nbsp;<span class="op" id="7660265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660269"><a href="/net/rpc/server_test.go.html#7660184">t</a></span><span class="op" id="7660270">.</span><span class="ident" id="7660271">Fatalf</span><span class="op" id="7660277">(</span><span class="string" id="7660278">&#34;dialing:&nbsp;%v&#34;</span><span class="op" id="7660291">,</span>&nbsp;<span class="ident" id="7660293"><a href="/net/rpc/server_test.go.html#7660232">err</a></span><span class="op" id="7660296">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660302"><a href="/net/rpc/server_test.go.html#7660232">err</a></span>&nbsp;<span class="op" id="7660306">=</span>&nbsp;<span class="ident" id="7660308"><a href="/net/rpc/server_test.go.html#7660224">client</a></span><span class="op" id="7660314">.</span><span class="ident" id="7660315">Close</span><span class="op" id="7660320">(</span><span class="op" id="7660321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660324">if</span>&nbsp;<span class="ident" id="7660327"><a href="/net/rpc/server_test.go.html#7660232">err</a></span>&nbsp;<span class="op" id="7660331">!=</span>&nbsp;<span class="ident" id="7660334">nil</span>&nbsp;<span class="op" id="7660338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660342"><a href="/net/rpc/server_test.go.html#7660184">t</a></span><span class="op" id="7660343">.</span><span class="ident" id="7660344">Fatal</span><span class="op" id="7660349">(</span><span class="string" id="7660350">&#34;close&nbsp;error:&#34;</span><span class="op" id="7660364">,</span>&nbsp;<span class="ident" id="7660366"><a href="/net/rpc/server_test.go.html#7660232">err</a></span><span class="op" id="7660369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660372">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660375"><a href="/net/rpc/server_test.go.html#7660232">err</a></span>&nbsp;<span class="op" id="7660379">=</span>&nbsp;<span class="ident" id="7660381"><a href="/net/rpc/server_test.go.html#7660224">client</a></span><span class="op" id="7660387">.</span><span class="ident" id="7660388">Call</span><span class="op" id="7660392">(</span><span class="string" id="7660393">&#34;Arith.Add&#34;</span><span class="op" id="7660404">,</span>&nbsp;<span class="op" id="7660406">&amp;</span><span class="ident" id="7660407"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7660411">{</span><span class="num" id="7660412">7</span><span class="op" id="7660413">,</span>&nbsp;<span class="num" id="7660415">9</span><span class="op" id="7660416">}</span><span class="op" id="7660417">,</span>&nbsp;<span class="builtinfunc" id="7660419">new</span><span class="op" id="7660422">(</span><span class="ident" id="7660423"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7660428">)</span><span class="op" id="7660429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660432">if</span>&nbsp;<span class="ident" id="7660435"><a href="/net/rpc/server_test.go.html#7660232">err</a></span>&nbsp;<span class="op" id="7660439">!=</span>&nbsp;<span class="ident" id="7660442"><a href="/net/rpc/client.go.html#5778586">ErrShutdown</a></span>&nbsp;<span class="op" id="7660454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660458"><a href="/net/rpc/server_test.go.html#7660184">t</a></span><span class="op" id="7660459">.</span><span class="ident" id="7660460">Errorf</span><span class="op" id="7660466">(</span><span class="string" id="7660467">&#34;Forever:&nbsp;expected&nbsp;ErrShutdown&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7660505">,</span>&nbsp;<span class="ident" id="7660507"><a href="/net/rpc/server_test.go.html#7660232">err</a></span><span class="op" id="7660510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660513">}</span><br>
<span class="lineno"></span><span class="op" id="7660515">}</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span><span class="keyword" id="7660518">func</span>&nbsp;<span class="ident" id="7660523">benchmarkEndToEnd</span><span class="op" id="7660540">(</span><span class="ident" id="7660541">dial</span>&nbsp;<span class="keyword" id="7660546">func</span><span class="op" id="7660550">(</span><span class="op" id="7660551">)</span>&nbsp;<span class="op" id="7660553">(</span><span class="op" id="7660554">*</span><span class="ident" id="7660555"><a href="/net/rpc/client.go.html#5779222">Client</a></span><span class="op" id="7660561">,</span>&nbsp;<span class="builtintype" id="7660563">error</span><span class="op" id="7660568">)</span><span class="op" id="7660569">,</span>&nbsp;<span class="ident" id="7660571">b</span>&nbsp;<span class="op" id="7660573">*</span><span class="ident" id="7660574"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7660581">.</span><span class="ident" id="7660582">B</span><span class="op" id="7660583">)</span>&nbsp;<span class="op" id="7660585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660588"><a href="/net/rpc/server_test.go.html#7647094">once</a></span><span class="op" id="7660592">.</span><span class="ident" id="7660593">Do</span><span class="op" id="7660595">(</span><span class="ident" id="7660596"><a href="/net/rpc/server_test.go.html#7648204">startServer</a></span><span class="op" id="7660607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660610">client</span><span class="op" id="7660616">,</span>&nbsp;<span class="ident" id="7660618">err</span>&nbsp;<span class="op" id="7660622">:=</span>&nbsp;<span class="ident" id="7660625"><a href="/net/rpc/server_test.go.html#7660541">dial</a></span><span class="op" id="7660629">(</span><span class="op" id="7660630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660633">if</span>&nbsp;<span class="ident" id="7660636"><a href="/net/rpc/server_test.go.html#7660618">err</a></span>&nbsp;<span class="op" id="7660640">!=</span>&nbsp;<span class="ident" id="7660643">nil</span>&nbsp;<span class="op" id="7660647">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660651"><a href="/net/rpc/server_test.go.html#7660571">b</a></span><span class="op" id="7660652">.</span><span class="ident" id="7660653">Fatal</span><span class="op" id="7660658">(</span><span class="string" id="7660659">&#34;error&nbsp;dialing:&#34;</span><span class="op" id="7660675">,</span>&nbsp;<span class="ident" id="7660677"><a href="/net/rpc/server_test.go.html#7660618">err</a></span><span class="op" id="7660680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660686">defer</span>&nbsp;<span class="ident" id="7660692"><a href="/net/rpc/server_test.go.html#7660610">client</a></span><span class="op" id="7660698">.</span><span class="ident" id="7660699">Close</span><span class="op" id="7660704">(</span><span class="op" id="7660705">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7660709">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660731">args</span>&nbsp;<span class="op" id="7660736">:=</span>&nbsp;<span class="op" id="7660739">&amp;</span><span class="ident" id="7660740"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7660744">{</span><span class="num" id="7660745">7</span><span class="op" id="7660746">,</span>&nbsp;<span class="num" id="7660748">8</span><span class="op" id="7660749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660752"><a href="/net/rpc/server_test.go.html#7660571">b</a></span><span class="op" id="7660753">.</span><span class="ident" id="7660754">ResetTimer</span><span class="op" id="7660764">(</span><span class="op" id="7660765">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660769"><a href="/net/rpc/server_test.go.html#7660571">b</a></span><span class="op" id="7660770">.</span><span class="ident" id="7660771">RunParallel</span><span class="op" id="7660782">(</span><span class="keyword" id="7660783">func</span><span class="op" id="7660787">(</span><span class="ident" id="7660788">pb</span>&nbsp;<span class="op" id="7660791">*</span><span class="ident" id="7660792"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7660799">.</span><span class="ident" id="7660800">PB</span><span class="op" id="7660802">)</span>&nbsp;<span class="op" id="7660804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660808">reply</span>&nbsp;<span class="op" id="7660814">:=</span>&nbsp;<span class="builtinfunc" id="7660817">new</span><span class="op" id="7660820">(</span><span class="ident" id="7660821"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7660826">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660830">for</span>&nbsp;<span class="ident" id="7660834"><a href="/net/rpc/server_test.go.html#7660788">pb</a></span><span class="op" id="7660836">.</span><span class="ident" id="7660837">Next</span><span class="op" id="7660841">(</span><span class="op" id="7660842">)</span>&nbsp;<span class="op" id="7660844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660849">err</span>&nbsp;<span class="op" id="7660853">:=</span>&nbsp;<span class="ident" id="7660856"><a href="/net/rpc/server_test.go.html#7660610">client</a></span><span class="op" id="7660862">.</span><span class="ident" id="7660863">Call</span><span class="op" id="7660867">(</span><span class="string" id="7660868">&#34;Arith.Add&#34;</span><span class="op" id="7660879">,</span>&nbsp;<span class="ident" id="7660881"><a href="/net/rpc/server_test.go.html#7660731">args</a></span><span class="op" id="7660885">,</span>&nbsp;<span class="ident" id="7660887"><a href="/net/rpc/server_test.go.html#7660808">reply</a></span><span class="op" id="7660892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660897">if</span>&nbsp;<span class="ident" id="7660900"><a href="/net/rpc/server_test.go.html#7660849">err</a></span>&nbsp;<span class="op" id="7660904">!=</span>&nbsp;<span class="ident" id="7660907">nil</span>&nbsp;<span class="op" id="7660911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660917"><a href="/net/rpc/server_test.go.html#7660571">b</a></span><span class="op" id="7660918">.</span><span class="ident" id="7660919">Fatalf</span><span class="op" id="7660925">(</span><span class="string" id="7660926">&#34;rpc&nbsp;error:&nbsp;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7660979">,</span>&nbsp;<span class="ident" id="7660981"><a href="/net/rpc/server_test.go.html#7660849">err</a></span><span class="op" id="7660984">.</span><span class="ident" id="7660985">Error</span><span class="op" id="7660990">(</span><span class="op" id="7660991">)</span><span class="op" id="7660992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660997">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661002">if</span>&nbsp;<span class="ident" id="7661005"><a href="/net/rpc/server_test.go.html#7660808">reply</a></span><span class="op" id="7661010">.</span><span class="ident" id="7661011">C</span>&nbsp;<span class="op" id="7661013">!=</span>&nbsp;<span class="ident" id="7661016"><a href="/net/rpc/server_test.go.html#7660731">args</a></span><span class="op" id="7661020">.</span><span class="ident" id="7661021">A</span><span class="op" id="7661022">+</span><span class="ident" id="7661023"><a href="/net/rpc/server_test.go.html#7660731">args</a></span><span class="op" id="7661027">.</span><span class="ident" id="7661028">B</span>&nbsp;<span class="op" id="7661030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661036"><a href="/net/rpc/server_test.go.html#7660571">b</a></span><span class="op" id="7661037">.</span><span class="ident" id="7661038">Fatalf</span><span class="op" id="7661044">(</span><span class="string" id="7661045">&#34;rpc&nbsp;error:&nbsp;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7661081">,</span>&nbsp;<span class="ident" id="7661083"><a href="/net/rpc/server_test.go.html#7660808">reply</a></span><span class="op" id="7661088">.</span><span class="ident" id="7661089">C</span><span class="op" id="7661090">,</span>&nbsp;<span class="ident" id="7661092"><a href="/net/rpc/server_test.go.html#7660731">args</a></span><span class="op" id="7661096">.</span><span class="ident" id="7661097">A</span><span class="op" id="7661098">+</span><span class="ident" id="7661099"><a href="/net/rpc/server_test.go.html#7660731">args</a></span><span class="op" id="7661103">.</span><span class="ident" id="7661104">B</span><span class="op" id="7661105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661117">}</span><span class="op" id="7661118">)</span><br>
<span class="lineno">620</span><span class="op" id="7661120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7661123">func</span>&nbsp;<span class="ident" id="7661128">benchmarkEndToEndAsync</span><span class="op" id="7661150">(</span><span class="ident" id="7661151">dial</span>&nbsp;<span class="keyword" id="7661156">func</span><span class="op" id="7661160">(</span><span class="op" id="7661161">)</span>&nbsp;<span class="op" id="7661163">(</span><span class="op" id="7661164">*</span><span class="ident" id="7661165"><a href="/net/rpc/client.go.html#5779222">Client</a></span><span class="op" id="7661171">,</span>&nbsp;<span class="builtintype" id="7661173">error</span><span class="op" id="7661178">)</span><span class="op" id="7661179">,</span>&nbsp;<span class="ident" id="7661181">b</span>&nbsp;<span class="op" id="7661183">*</span><span class="ident" id="7661184"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7661191">.</span><span class="ident" id="7661192">B</span><span class="op" id="7661193">)</span>&nbsp;<span class="op" id="7661195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661198">const</span>&nbsp;<span class="ident" id="7661204">MaxConcurrentCalls</span>&nbsp;<span class="op" id="7661223">=</span>&nbsp;<span class="num" id="7661225">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661230"><a href="/net/rpc/server_test.go.html#7647094">once</a></span><span class="op" id="7661234">.</span><span class="ident" id="7661235">Do</span><span class="op" id="7661237">(</span><span class="ident" id="7661238"><a href="/net/rpc/server_test.go.html#7648204">startServer</a></span><span class="op" id="7661249">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661252">client</span><span class="op" id="7661258">,</span>&nbsp;<span class="ident" id="7661260">err</span>&nbsp;<span class="op" id="7661264">:=</span>&nbsp;<span class="ident" id="7661267"><a href="/net/rpc/server_test.go.html#7661151">dial</a></span><span class="op" id="7661271">(</span><span class="op" id="7661272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661275">if</span>&nbsp;<span class="ident" id="7661278"><a href="/net/rpc/server_test.go.html#7661260">err</a></span>&nbsp;<span class="op" id="7661282">!=</span>&nbsp;<span class="ident" id="7661285">nil</span>&nbsp;<span class="op" id="7661289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661293"><a href="/net/rpc/server_test.go.html#7661181">b</a></span><span class="op" id="7661294">.</span><span class="ident" id="7661295">Fatal</span><span class="op" id="7661300">(</span><span class="string" id="7661301">&#34;error&nbsp;dialing:&#34;</span><span class="op" id="7661317">,</span>&nbsp;<span class="ident" id="7661319"><a href="/net/rpc/server_test.go.html#7661260">err</a></span><span class="op" id="7661322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661328">defer</span>&nbsp;<span class="ident" id="7661334"><a href="/net/rpc/server_test.go.html#7661252">client</a></span><span class="op" id="7661340">.</span><span class="ident" id="7661341">Close</span><span class="op" id="7661346">(</span><span class="op" id="7661347">)</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7661351">//&nbsp;Asynchronous&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661374">args</span>&nbsp;<span class="op" id="7661379">:=</span>&nbsp;<span class="op" id="7661382">&amp;</span><span class="ident" id="7661383"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7661387">{</span><span class="num" id="7661388">7</span><span class="op" id="7661389">,</span>&nbsp;<span class="num" id="7661391">8</span><span class="op" id="7661392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661395">procs</span>&nbsp;<span class="op" id="7661401">:=</span>&nbsp;<span class="num" id="7661404">4</span>&nbsp;<span class="op" id="7661406">*</span>&nbsp;<span class="ident" id="7661408"><a href="/net/rpc/server_test.go.html#7646918">runtime</a></span><span class="op" id="7661415">.</span><span class="ident" id="7661416">GOMAXPROCS</span><span class="op" id="7661426">(</span><span class="op" id="7661427">-</span><span class="num" id="7661428">1</span><span class="op" id="7661429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661432">send</span>&nbsp;<span class="op" id="7661437">:=</span>&nbsp;<span class="builtintype" id="7661440">int32</span><span class="op" id="7661445">(</span><span class="ident" id="7661446"><a href="/net/rpc/server_test.go.html#7661181">b</a></span><span class="op" id="7661447">.</span><span class="ident" id="7661448">N</span><span class="op" id="7661449">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661452">recv</span>&nbsp;<span class="op" id="7661457">:=</span>&nbsp;<span class="builtintype" id="7661460">int32</span><span class="op" id="7661465">(</span><span class="ident" id="7661466"><a href="/net/rpc/server_test.go.html#7661181">b</a></span><span class="op" id="7661467">.</span><span class="ident" id="7661468">N</span><span class="op" id="7661469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661472">var</span>&nbsp;<span class="ident" id="7661476">wg</span>&nbsp;<span class="ident" id="7661479"><a href="/net/rpc/server_test.go.html#7646940">sync</a></span><span class="op" id="7661483">.</span><span class="ident" id="7661484">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661495"><a href="/net/rpc/server_test.go.html#7661476">wg</a></span><span class="op" id="7661497">.</span><span class="ident" id="7661498">Add</span><span class="op" id="7661501">(</span><span class="ident" id="7661502"><a href="/net/rpc/server_test.go.html#7661395">procs</a></span><span class="op" id="7661507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661510">gate</span>&nbsp;<span class="op" id="7661515">:=</span>&nbsp;<span class="builtinfunc" id="7661518">make</span><span class="op" id="7661522">(</span><span class="keyword" id="7661523">chan</span>&nbsp;<span class="builtintype" id="7661528">bool</span><span class="op" id="7661532">,</span>&nbsp;<span class="ident" id="7661534"><a href="/net/rpc/server_test.go.html#7661204">MaxConcurrentCalls</a></span><span class="op" id="7661552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661555">res</span>&nbsp;<span class="op" id="7661559">:=</span>&nbsp;<span class="builtinfunc" id="7661562">make</span><span class="op" id="7661566">(</span><span class="keyword" id="7661567">chan</span>&nbsp;<span class="op" id="7661572">*</span><span class="ident" id="7661573"><a href="/net/rpc/client.go.html#5778678">Call</a></span><span class="op" id="7661577">,</span>&nbsp;<span class="ident" id="7661579"><a href="/net/rpc/server_test.go.html#7661204">MaxConcurrentCalls</a></span><span class="op" id="7661597">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661600"><a href="/net/rpc/server_test.go.html#7661181">b</a></span><span class="op" id="7661601">.</span><span class="ident" id="7661602">ResetTimer</span><span class="op" id="7661612">(</span><span class="op" id="7661613">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661617">for</span>&nbsp;<span class="ident" id="7661621">p</span>&nbsp;<span class="op" id="7661623">:=</span>&nbsp;<span class="num" id="7661626">0</span><span class="op" id="7661627">;</span>&nbsp;<span class="ident" id="7661629"><a href="/net/rpc/server_test.go.html#7661621">p</a></span>&nbsp;<span class="op" id="7661631">&lt;</span>&nbsp;<span class="ident" id="7661633"><a href="/net/rpc/server_test.go.html#7661395">procs</a></span><span class="op" id="7661638">;</span>&nbsp;<span class="ident" id="7661640"><a href="/net/rpc/server_test.go.html#7661621">p</a></span><span class="op" id="7661641">++</span>&nbsp;<span class="op" id="7661644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661648">go</span>&nbsp;<span class="keyword" id="7661651">func</span><span class="op" id="7661655">(</span><span class="op" id="7661656">)</span>&nbsp;<span class="op" id="7661658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661663">for</span>&nbsp;<span class="ident" id="7661667"><a href="/net/rpc/server_test.go.html#7646948">atomic</a></span><span class="op" id="7661673">.</span><span class="ident" id="7661674">AddInt32</span><span class="op" id="7661682">(</span><span class="op" id="7661683">&amp;</span><span class="ident" id="7661684"><a href="/net/rpc/server_test.go.html#7661432">send</a></span><span class="op" id="7661688">,</span>&nbsp;<span class="op" id="7661690">-</span><span class="num" id="7661691">1</span><span class="op" id="7661692">)</span>&nbsp;<span class="op" id="7661694">&gt;=</span>&nbsp;<span class="num" id="7661697">0</span>&nbsp;<span class="op" id="7661699">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661705"><a href="/net/rpc/server_test.go.html#7661510">gate</a></span>&nbsp;<span class="op" id="7661710">&lt;-</span>&nbsp;<span class="builtintype" id="7661713">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661722">reply</span>&nbsp;<span class="op" id="7661728">:=</span>&nbsp;<span class="builtinfunc" id="7661731">new</span><span class="op" id="7661734">(</span><span class="ident" id="7661735"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7661740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661746"><a href="/net/rpc/server_test.go.html#7661252">client</a></span><span class="op" id="7661752">.</span><span class="ident" id="7661753">Go</span><span class="op" id="7661755">(</span><span class="string" id="7661756">&#34;Arith.Add&#34;</span><span class="op" id="7661767">,</span>&nbsp;<span class="ident" id="7661769"><a href="/net/rpc/server_test.go.html#7661374">args</a></span><span class="op" id="7661773">,</span>&nbsp;<span class="ident" id="7661775"><a href="/net/rpc/server_test.go.html#7661722">reply</a></span><span class="op" id="7661780">,</span>&nbsp;<span class="ident" id="7661782"><a href="/net/rpc/server_test.go.html#7661555">res</a></span><span class="op" id="7661785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661794">}</span><span class="op" id="7661795">(</span><span class="op" id="7661796">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661800">go</span>&nbsp;<span class="keyword" id="7661803">func</span><span class="op" id="7661807">(</span><span class="op" id="7661808">)</span>&nbsp;<span class="op" id="7661810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661815">for</span>&nbsp;<span class="ident" id="7661819">call</span>&nbsp;<span class="op" id="7661824">:=</span>&nbsp;<span class="keyword" id="7661827">range</span>&nbsp;<span class="ident" id="7661833"><a href="/net/rpc/server_test.go.html#7661555">res</a></span>&nbsp;<span class="op" id="7661837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661843">A</span>&nbsp;<span class="op" id="7661845">:=</span>&nbsp;<span class="ident" id="7661848"><a href="/net/rpc/server_test.go.html#7661819">call</a></span><span class="op" id="7661852">.</span><span class="ident" id="7661853">Args</span><span class="op" id="7661857">.</span><span class="op" id="7661858">(</span><span class="op" id="7661859">*</span><span class="ident" id="7661860"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7661864">)</span><span class="op" id="7661865">.</span><span class="ident" id="7661866">A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661872">B</span>&nbsp;<span class="op" id="7661874">:=</span>&nbsp;<span class="ident" id="7661877"><a href="/net/rpc/server_test.go.html#7661819">call</a></span><span class="op" id="7661881">.</span><span class="ident" id="7661882">Args</span><span class="op" id="7661886">.</span><span class="op" id="7661887">(</span><span class="op" id="7661888">*</span><span class="ident" id="7661889"><a href="/net/rpc/server_test.go.html#7647171">Args</a></span><span class="op" id="7661893">)</span><span class="op" id="7661894">.</span><span class="ident" id="7661895">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661901">C</span>&nbsp;<span class="op" id="7661903">:=</span>&nbsp;<span class="ident" id="7661906"><a href="/net/rpc/server_test.go.html#7661819">call</a></span><span class="op" id="7661910">.</span><span class="ident" id="7661911">Reply</span><span class="op" id="7661916">.</span><span class="op" id="7661917">(</span><span class="op" id="7661918">*</span><span class="ident" id="7661919"><a href="/net/rpc/server_test.go.html#7647203">Reply</a></span><span class="op" id="7661924">)</span><span class="op" id="7661925">.</span><span class="ident" id="7661926">C</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661932">if</span>&nbsp;<span class="ident" id="7661935"><a href="/net/rpc/server_test.go.html#7661843">A</a></span><span class="op" id="7661936">+</span><span class="ident" id="7661937"><a href="/net/rpc/server_test.go.html#7661872">B</a></span>&nbsp;<span class="op" id="7661939">!=</span>&nbsp;<span class="ident" id="7661942"><a href="/net/rpc/server_test.go.html#7661901">C</a></span>&nbsp;<span class="op" id="7661944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661951"><a href="/net/rpc/server_test.go.html#7661181">b</a></span><span class="op" id="7661952">.</span><span class="ident" id="7661953">Fatalf</span><span class="op" id="7661959">(</span><span class="string" id="7661960">&#34;incorrect&nbsp;reply:&nbsp;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7662002">,</span>&nbsp;<span class="ident" id="7662004"><a href="/net/rpc/server_test.go.html#7661843">A</a></span><span class="op" id="7662005">+</span><span class="ident" id="7662006"><a href="/net/rpc/server_test.go.html#7661872">B</a></span><span class="op" id="7662007">,</span>&nbsp;<span class="ident" id="7662009"><a href="/net/rpc/server_test.go.html#7661901">C</a></span><span class="op" id="7662010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662022">&lt;-</span><span class="ident" id="7662024"><a href="/net/rpc/server_test.go.html#7661510">gate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662033">if</span>&nbsp;<span class="ident" id="7662036"><a href="/net/rpc/server_test.go.html#7646948">atomic</a></span><span class="op" id="7662042">.</span><span class="ident" id="7662043">AddInt32</span><span class="op" id="7662051">(</span><span class="op" id="7662052">&amp;</span><span class="ident" id="7662053"><a href="/net/rpc/server_test.go.html#7661452">recv</a></span><span class="op" id="7662057">,</span>&nbsp;<span class="op" id="7662059">-</span><span class="num" id="7662060">1</span><span class="op" id="7662061">)</span>&nbsp;<span class="op" id="7662063">==</span>&nbsp;<span class="num" id="7662066">0</span>&nbsp;<span class="op" id="7662068">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7662075">close</span><span class="op" id="7662080">(</span><span class="ident" id="7662081"><a href="/net/rpc/server_test.go.html#7661555">res</a></span><span class="op" id="7662084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662100"><a href="/net/rpc/server_test.go.html#7661476">wg</a></span><span class="op" id="7662102">.</span><span class="ident" id="7662103">Done</span><span class="op" id="7662107">(</span><span class="op" id="7662108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662112">}</span><span class="op" id="7662113">(</span><span class="op" id="7662114">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662120"><a href="/net/rpc/server_test.go.html#7661476">wg</a></span><span class="op" id="7662122">.</span><span class="ident" id="7662123">Wait</span><span class="op" id="7662127">(</span><span class="op" id="7662128">)</span><br>
<span class="lineno"></span><span class="op" id="7662130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7662133">func</span>&nbsp;<span class="ident" id="7662138">BenchmarkEndToEnd</span><span class="op" id="7662155">(</span><span class="ident" id="7662156">b</span>&nbsp;<span class="op" id="7662158">*</span><span class="ident" id="7662159"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7662166">.</span><span class="ident" id="7662167">B</span><span class="op" id="7662168">)</span>&nbsp;<span class="op" id="7662170">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662173"><a href="/net/rpc/server_test.go.html#7660523">benchmarkEndToEnd</a></span><span class="op" id="7662190">(</span><span class="ident" id="7662191"><a href="/net/rpc/server_test.go.html#7657907">dialDirect</a></span><span class="op" id="7662201">,</span>&nbsp;<span class="ident" id="7662203"><a href="/net/rpc/server_test.go.html#7662156">b</a></span><span class="op" id="7662204">)</span><br>
<span class="lineno"></span><span class="op" id="7662206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7662209">func</span>&nbsp;<span class="ident" id="7662214">BenchmarkEndToEndHTTP</span><span class="op" id="7662235">(</span><span class="ident" id="7662236">b</span>&nbsp;<span class="op" id="7662238">*</span><span class="ident" id="7662239"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7662246">.</span><span class="ident" id="7662247">B</span><span class="op" id="7662248">)</span>&nbsp;<span class="op" id="7662250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662253"><a href="/net/rpc/server_test.go.html#7660523">benchmarkEndToEnd</a></span><span class="op" id="7662270">(</span><span class="ident" id="7662271"><a href="/net/rpc/server_test.go.html#7657979">dialHTTP</a></span><span class="op" id="7662279">,</span>&nbsp;<span class="ident" id="7662281"><a href="/net/rpc/server_test.go.html#7662236">b</a></span><span class="op" id="7662282">)</span><br>
<span class="lineno">675</span><span class="op" id="7662284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7662287">func</span>&nbsp;<span class="ident" id="7662292">BenchmarkEndToEndAsync</span><span class="op" id="7662314">(</span><span class="ident" id="7662315">b</span>&nbsp;<span class="op" id="7662317">*</span><span class="ident" id="7662318"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7662325">.</span><span class="ident" id="7662326">B</span><span class="op" id="7662327">)</span>&nbsp;<span class="op" id="7662329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662332"><a href="/net/rpc/server_test.go.html#7661128">benchmarkEndToEndAsync</a></span><span class="op" id="7662354">(</span><span class="ident" id="7662355"><a href="/net/rpc/server_test.go.html#7657907">dialDirect</a></span><span class="op" id="7662365">,</span>&nbsp;<span class="ident" id="7662367"><a href="/net/rpc/server_test.go.html#7662315">b</a></span><span class="op" id="7662368">)</span><br>
<span class="lineno"></span><span class="op" id="7662370">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7662373">func</span>&nbsp;<span class="ident" id="7662378">BenchmarkEndToEndAsyncHTTP</span><span class="op" id="7662404">(</span><span class="ident" id="7662405">b</span>&nbsp;<span class="op" id="7662407">*</span><span class="ident" id="7662408"><a href="/net/rpc/server_test.go.html#7646963">testing</a></span><span class="op" id="7662415">.</span><span class="ident" id="7662416">B</span><span class="op" id="7662417">)</span>&nbsp;<span class="op" id="7662419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662422"><a href="/net/rpc/server_test.go.html#7661128">benchmarkEndToEndAsync</a></span><span class="op" id="7662444">(</span><span class="ident" id="7662445"><a href="/net/rpc/server_test.go.html#7657979">dialHTTP</a></span><span class="op" id="7662453">,</span>&nbsp;<span class="ident" id="7662455"><a href="/net/rpc/server_test.go.html#7662405">b</a></span><span class="op" id="7662456">)</span><br>
<span class="lineno"></span><span class="op" id="7662458">}</span>
</div>
</body>
</html>
