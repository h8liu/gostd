<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>index/suffixarray</h2>
<ul>
<li><a href="/gostd/index/suffixarray/qsufsort.go.html">qsufsort.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray.go.html">suffixarray.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray_test.go.html">suffixarray_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7292093">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7292148">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7292202">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7292253">package</span>&nbsp;<span class="ident" id="7292261">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7292274">import</span>&nbsp;<span class="op" id="7292281">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292284">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292293">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292306">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292316">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292324">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292335">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7292345">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7292348">type</span>&nbsp;<span class="ident" id="7292353">testCase</span>&nbsp;<span class="keyword" id="7292362">struct</span>&nbsp;<span class="op" id="7292369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292372">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7292381">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7292390">//&nbsp;name&nbsp;of&nbsp;test&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292412">source</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7292421">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7292430">//&nbsp;source&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292450">patterns</span>&nbsp;<span class="op" id="7292459">[</span><span class="op" id="7292460">]</span><span class="builtintype" id="7292461">string</span>&nbsp;<span class="comment" id="7292468">//&nbsp;patterns&nbsp;to&nbsp;lookup</span><br>
<span class="lineno">20</span><span class="op" id="7292490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7292493">var</span>&nbsp;<span class="ident" id="7292497">testCases</span>&nbsp;<span class="op" id="7292507">=</span>&nbsp;<span class="op" id="7292509">[</span><span class="op" id="7292510">]</span><span class="ident" id="7292511">testCase</span><span class="op" id="7292519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292526">&#34;empty&nbsp;string&#34;</span><span class="op" id="7292540">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292544">&#34;&#34;</span><span class="op" id="7292546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292550">[</span><span class="op" id="7292551">]</span><span class="builtintype" id="7292552">string</span><span class="op" id="7292558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292563">&#34;&#34;</span><span class="op" id="7292565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292570">&#34;foo&#34;</span><span class="op" id="7292575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292580">&#34;(foo)&#34;</span><span class="op" id="7292587">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292592">&#34;.*&#34;</span><span class="op" id="7292596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292601">&#34;a*&#34;</span><span class="op" id="7292605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292609">}</span><span class="op" id="7292610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292613">}</span><span class="op" id="7292614">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292622">&#34;all&nbsp;a&#39;s&#34;</span><span class="op" id="7292631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292635">&#34;aaaaaaaaaa&#34;</span><span class="op" id="7292647">,</span>&nbsp;<span class="comment" id="7292649">//&nbsp;10&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292661">[</span><span class="op" id="7292662">]</span><span class="builtintype" id="7292663">string</span><span class="op" id="7292669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292674">&#34;&#34;</span><span class="op" id="7292676">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292681">&#34;a&#34;</span><span class="op" id="7292684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292689">&#34;aa&#34;</span><span class="op" id="7292693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292698">&#34;aaa&#34;</span><span class="op" id="7292703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292708">&#34;aaaa&#34;</span><span class="op" id="7292714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292719">&#34;aaaaa&#34;</span><span class="op" id="7292726">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292731">&#34;aaaaaa&#34;</span><span class="op" id="7292739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292744">&#34;aaaaaaa&#34;</span><span class="op" id="7292753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292758">&#34;aaaaaaaa&#34;</span><span class="op" id="7292768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292773">&#34;aaaaaaaaa&#34;</span><span class="op" id="7292784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292789">&#34;aaaaaaaaaa&#34;</span><span class="op" id="7292801">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292806">&#34;aaaaaaaaaaa&#34;</span><span class="op" id="7292819">,</span>&nbsp;<span class="comment" id="7292821">//&nbsp;11&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292834">&#34;.&#34;</span><span class="op" id="7292837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292842">&#34;.*&#34;</span><span class="op" id="7292846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292851">&#34;a+&#34;</span><span class="op" id="7292855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292860">&#34;aa+&#34;</span><span class="op" id="7292865">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292870">&#34;aaaa[b]?&#34;</span><span class="op" id="7292880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292885">&#34;aaa*&#34;</span><span class="op" id="7292891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292895">}</span><span class="op" id="7292896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292899">}</span><span class="op" id="7292900">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292908">&#34;abc&#34;</span><span class="op" id="7292913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292917">&#34;abc&#34;</span><span class="op" id="7292922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292926">[</span><span class="op" id="7292927">]</span><span class="builtintype" id="7292928">string</span><span class="op" id="7292934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292939">&#34;a&#34;</span><span class="op" id="7292942">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292947">&#34;b&#34;</span><span class="op" id="7292950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292955">&#34;c&#34;</span><span class="op" id="7292958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292963">&#34;ab&#34;</span><span class="op" id="7292967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292972">&#34;bc&#34;</span><span class="op" id="7292976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292981">&#34;abc&#34;</span><span class="op" id="7292986">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292991">&#34;a.c&#34;</span><span class="op" id="7292996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293001">&#34;a(b|c)&#34;</span><span class="op" id="7293009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293014">&#34;abc?&#34;</span><span class="op" id="7293020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293024">}</span><span class="op" id="7293025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293028">}</span><span class="op" id="7293029">,</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293037">&#34;barbara*3&#34;</span><span class="op" id="7293048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293052">&#34;barbarabarbarabarbara&#34;</span><span class="op" id="7293075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293079">[</span><span class="op" id="7293080">]</span><span class="builtintype" id="7293081">string</span><span class="op" id="7293087">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293092">&#34;a&#34;</span><span class="op" id="7293095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293100">&#34;bar&#34;</span><span class="op" id="7293105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293110">&#34;rab&#34;</span><span class="op" id="7293115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293120">&#34;arab&#34;</span><span class="op" id="7293126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293131">&#34;barbar&#34;</span><span class="op" id="7293139">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293144">&#34;bara?bar&#34;</span><span class="op" id="7293154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293158">}</span><span class="op" id="7293159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293162">}</span><span class="op" id="7293163">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293167">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293171">&#34;typing&nbsp;drill&#34;</span><span class="op" id="7293185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293189">&#34;Now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7293260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293264">[</span><span class="op" id="7293265">]</span><span class="builtintype" id="7293266">string</span><span class="op" id="7293272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293277">&#34;Now&#34;</span><span class="op" id="7293282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293287">&#34;the&nbsp;time&#34;</span><span class="op" id="7293297">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293302">&#34;to&nbsp;come&nbsp;the&nbsp;aid&#34;</span><span class="op" id="7293319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293324">&#34;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&#34;</span><span class="op" id="7293382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293387">&#34;to&nbsp;(come|the)?&#34;</span><span class="op" id="7293403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293407">}</span><span class="op" id="7293408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293411">}</span><span class="op" id="7293412">,</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293420">&#34;godoc&nbsp;simulation&#34;</span><span class="op" id="7293438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293442">&#34;package&nbsp;main\n\nimport(\n&nbsp;&nbsp;&nbsp;&nbsp;\&#34;rand\&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7293487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293491">[</span><span class="op" id="7293492">]</span><span class="builtintype" id="7293493">string</span><span class="op" id="7293499">{</span><span class="op" id="7293500">}</span><span class="op" id="7293501">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293504">}</span><span class="op" id="7293505">,</span><br>
<span class="lineno"></span><span class="op" id="7293507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7293510">//&nbsp;find&nbsp;all&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;source;&nbsp;report&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences</span><br>
<span class="lineno"></span><span class="keyword" id="7293579">func</span>&nbsp;<span class="ident" id="7293584">find</span><span class="op" id="7293588">(</span><span class="ident" id="7293589">src</span><span class="op" id="7293592">,</span>&nbsp;<span class="ident" id="7293594">s</span>&nbsp;<span class="builtintype" id="7293596">string</span><span class="op" id="7293602">,</span>&nbsp;<span class="ident" id="7293604">n</span>&nbsp;<span class="builtintype" id="7293606">int</span><span class="op" id="7293609">)</span>&nbsp;<span class="op" id="7293611">[</span><span class="op" id="7293612">]</span><span class="builtintype" id="7293613">int</span>&nbsp;<span class="op" id="7293617">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293620">var</span>&nbsp;<span class="ident" id="7293624">res</span>&nbsp;<span class="op" id="7293628">[</span><span class="op" id="7293629">]</span><span class="builtintype" id="7293630">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293635">if</span>&nbsp;<span class="ident" id="7293638">s</span>&nbsp;<span class="op" id="7293640">!=</span>&nbsp;<span class="string" id="7293643">&#34;&#34;</span>&nbsp;<span class="op" id="7293646">&amp;&amp;</span>&nbsp;<span class="ident" id="7293649">n</span>&nbsp;<span class="op" id="7293651">!=</span>&nbsp;<span class="num" id="7293654">0</span>&nbsp;<span class="op" id="7293656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7293660">//&nbsp;find&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293704">for</span>&nbsp;<span class="ident" id="7293708">i</span>&nbsp;<span class="op" id="7293710">:=</span>&nbsp;<span class="op" id="7293713">-</span><span class="num" id="7293714">1</span><span class="op" id="7293715">;</span>&nbsp;<span class="ident" id="7293717">n</span>&nbsp;<span class="op" id="7293719">&lt;</span>&nbsp;<span class="num" id="7293721">0</span>&nbsp;<span class="op" id="7293723">||</span>&nbsp;<span class="builtinfunc" id="7293726">len</span><span class="op" id="7293729">(</span><span class="ident" id="7293730">res</span><span class="op" id="7293733">)</span>&nbsp;<span class="op" id="7293735">&lt;</span>&nbsp;<span class="ident" id="7293737">n</span><span class="op" id="7293738">;</span>&nbsp;<span class="op" id="7293740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293745">j</span>&nbsp;<span class="op" id="7293747">:=</span>&nbsp;<span class="ident" id="7293750">strings</span><span class="op" id="7293757">.</span><span class="ident" id="7293758">Index</span><span class="op" id="7293763">(</span><span class="ident" id="7293764">src</span><span class="op" id="7293767">[</span><span class="ident" id="7293768">i</span><span class="op" id="7293769">+</span><span class="num" id="7293770">1</span><span class="op" id="7293771">:</span><span class="op" id="7293772">]</span><span class="op" id="7293773">,</span>&nbsp;<span class="ident" id="7293775">s</span><span class="op" id="7293776">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293781">if</span>&nbsp;<span class="ident" id="7293784">j</span>&nbsp;<span class="op" id="7293786">&lt;</span>&nbsp;<span class="num" id="7293788">0</span>&nbsp;<span class="op" id="7293790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293796">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293810">i</span>&nbsp;<span class="op" id="7293812">+=</span>&nbsp;<span class="ident" id="7293815">j</span>&nbsp;<span class="op" id="7293817">+</span>&nbsp;<span class="num" id="7293819">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293824">res</span>&nbsp;<span class="op" id="7293828">=</span>&nbsp;<span class="builtinfunc" id="7293830">append</span><span class="op" id="7293836">(</span><span class="ident" id="7293837">res</span><span class="op" id="7293840">,</span>&nbsp;<span class="ident" id="7293842">i</span><span class="op" id="7293843">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293853">return</span>&nbsp;<span class="ident" id="7293860">res</span><br>
<span class="lineno"></span><span class="op" id="7293864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="7293867">func</span>&nbsp;<span class="ident" id="7293872">testLookup</span><span class="op" id="7293882">(</span><span class="ident" id="7293883">t</span>&nbsp;<span class="op" id="7293885">*</span><span class="ident" id="7293886">testing</span><span class="op" id="7293893">.</span><span class="ident" id="7293894">T</span><span class="op" id="7293895">,</span>&nbsp;<span class="ident" id="7293897">tc</span>&nbsp;<span class="op" id="7293900">*</span><span class="ident" id="7293901">testCase</span><span class="op" id="7293909">,</span>&nbsp;<span class="ident" id="7293911">x</span>&nbsp;<span class="op" id="7293913">*</span><span class="ident" id="7293914">Index</span><span class="op" id="7293919">,</span>&nbsp;<span class="ident" id="7293921">s</span>&nbsp;<span class="builtintype" id="7293923">string</span><span class="op" id="7293929">,</span>&nbsp;<span class="ident" id="7293931">n</span>&nbsp;<span class="builtintype" id="7293933">int</span><span class="op" id="7293936">)</span>&nbsp;<span class="op" id="7293938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293941">res</span>&nbsp;<span class="op" id="7293945">:=</span>&nbsp;<span class="ident" id="7293948">x</span><span class="op" id="7293949">.</span><span class="ident" id="7293950">Lookup</span><span class="op" id="7293956">(</span><span class="op" id="7293957">[</span><span class="op" id="7293958">]</span><span class="builtintype" id="7293959">byte</span><span class="op" id="7293963">(</span><span class="ident" id="7293964">s</span><span class="op" id="7293965">)</span><span class="op" id="7293966">,</span>&nbsp;<span class="ident" id="7293968">n</span><span class="op" id="7293969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293972">exp</span>&nbsp;<span class="op" id="7293976">:=</span>&nbsp;<span class="ident" id="7293979">find</span><span class="op" id="7293983">(</span><span class="ident" id="7293984">tc</span><span class="op" id="7293986">.</span><span class="ident" id="7293987">source</span><span class="op" id="7293993">,</span>&nbsp;<span class="ident" id="7293995">s</span><span class="op" id="7293996">,</span>&nbsp;<span class="ident" id="7293998">n</span><span class="op" id="7293999">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7294003">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294036">if</span>&nbsp;<span class="builtinfunc" id="7294039">len</span><span class="op" id="7294042">(</span><span class="ident" id="7294043">res</span><span class="op" id="7294046">)</span>&nbsp;<span class="op" id="7294048">!=</span>&nbsp;<span class="builtinfunc" id="7294051">len</span><span class="op" id="7294054">(</span><span class="ident" id="7294055">exp</span><span class="op" id="7294058">)</span>&nbsp;<span class="op" id="7294060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294064">t</span><span class="op" id="7294065">.</span><span class="ident" id="7294066">Errorf</span><span class="op" id="7294072">(</span><span class="string" id="7294073">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7294131">,</span>&nbsp;<span class="ident" id="7294133">tc</span><span class="op" id="7294135">.</span><span class="ident" id="7294136">name</span><span class="op" id="7294140">,</span>&nbsp;<span class="ident" id="7294142">s</span><span class="op" id="7294143">,</span>&nbsp;<span class="ident" id="7294145">n</span><span class="op" id="7294146">,</span>&nbsp;<span class="builtinfunc" id="7294148">len</span><span class="op" id="7294151">(</span><span class="ident" id="7294152">exp</span><span class="op" id="7294155">)</span><span class="op" id="7294156">,</span>&nbsp;<span class="builtinfunc" id="7294158">len</span><span class="op" id="7294161">(</span><span class="ident" id="7294162">res</span><span class="op" id="7294165">)</span><span class="op" id="7294166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7294173">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7294249">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;find&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7294325">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;find)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7294401">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7294466">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;duplicates</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294548">sort</span><span class="op" id="7294552">.</span><span class="ident" id="7294553">Ints</span><span class="op" id="7294557">(</span><span class="ident" id="7294558">res</span><span class="op" id="7294561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294564">for</span>&nbsp;<span class="ident" id="7294568">i</span><span class="op" id="7294569">,</span>&nbsp;<span class="ident" id="7294571">r</span>&nbsp;<span class="op" id="7294573">:=</span>&nbsp;<span class="keyword" id="7294576">range</span>&nbsp;<span class="ident" id="7294582">res</span>&nbsp;<span class="op" id="7294586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294590">if</span>&nbsp;<span class="ident" id="7294593">r</span>&nbsp;<span class="op" id="7294595">&lt;</span>&nbsp;<span class="num" id="7294597">0</span>&nbsp;<span class="op" id="7294599">||</span>&nbsp;<span class="builtinfunc" id="7294602">len</span><span class="op" id="7294605">(</span><span class="ident" id="7294606">tc</span><span class="op" id="7294608">.</span><span class="ident" id="7294609">source</span><span class="op" id="7294615">)</span>&nbsp;<span class="op" id="7294617">&lt;=</span>&nbsp;<span class="ident" id="7294620">r</span>&nbsp;<span class="op" id="7294622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294627">t</span><span class="op" id="7294628">.</span><span class="ident" id="7294629">Errorf</span><span class="op" id="7294635">(</span><span class="string" id="7294636">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;out&nbsp;of&nbsp;range&nbsp;[0,&nbsp;%d[&#34;</span><span class="op" id="7294707">,</span>&nbsp;<span class="ident" id="7294709">tc</span><span class="op" id="7294711">.</span><span class="ident" id="7294712">name</span><span class="op" id="7294716">,</span>&nbsp;<span class="ident" id="7294718">s</span><span class="op" id="7294719">,</span>&nbsp;<span class="ident" id="7294721">i</span><span class="op" id="7294722">,</span>&nbsp;<span class="ident" id="7294724">n</span><span class="op" id="7294725">,</span>&nbsp;<span class="ident" id="7294727">r</span><span class="op" id="7294728">,</span>&nbsp;<span class="builtinfunc" id="7294730">len</span><span class="op" id="7294733">(</span><span class="ident" id="7294734">tc</span><span class="op" id="7294736">.</span><span class="ident" id="7294737">source</span><span class="op" id="7294743">)</span><span class="op" id="7294744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294748">}</span>&nbsp;<span class="keyword" id="7294750">else</span>&nbsp;<span class="keyword" id="7294755">if</span>&nbsp;<span class="op" id="7294758">!</span><span class="ident" id="7294759">strings</span><span class="op" id="7294766">.</span><span class="ident" id="7294767">HasPrefix</span><span class="op" id="7294776">(</span><span class="ident" id="7294777">tc</span><span class="op" id="7294779">.</span><span class="ident" id="7294780">source</span><span class="op" id="7294786">[</span><span class="ident" id="7294787">r</span><span class="op" id="7294788">:</span><span class="op" id="7294789">]</span><span class="op" id="7294790">,</span>&nbsp;<span class="ident" id="7294792">s</span><span class="op" id="7294793">)</span>&nbsp;<span class="op" id="7294795">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294800">t</span><span class="op" id="7294801">.</span><span class="ident" id="7294802">Errorf</span><span class="op" id="7294808">(</span><span class="string" id="7294809">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="7294871">,</span>&nbsp;<span class="ident" id="7294873">tc</span><span class="op" id="7294875">.</span><span class="ident" id="7294876">name</span><span class="op" id="7294880">,</span>&nbsp;<span class="ident" id="7294882">s</span><span class="op" id="7294883">,</span>&nbsp;<span class="ident" id="7294885">i</span><span class="op" id="7294886">,</span>&nbsp;<span class="ident" id="7294888">n</span><span class="op" id="7294889">,</span>&nbsp;<span class="ident" id="7294891">r</span><span class="op" id="7294892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294900">if</span>&nbsp;<span class="ident" id="7294903">i</span>&nbsp;<span class="op" id="7294905">&gt;</span>&nbsp;<span class="num" id="7294907">0</span>&nbsp;<span class="op" id="7294909">&amp;&amp;</span>&nbsp;<span class="ident" id="7294912">res</span><span class="op" id="7294915">[</span><span class="ident" id="7294916">i</span><span class="op" id="7294917">-</span><span class="num" id="7294918">1</span><span class="op" id="7294919">]</span>&nbsp;<span class="op" id="7294921">==</span>&nbsp;<span class="ident" id="7294924">r</span>&nbsp;<span class="op" id="7294926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294931">t</span><span class="op" id="7294932">.</span><span class="ident" id="7294933">Errorf</span><span class="op" id="7294939">(</span><span class="string" id="7294940">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;found&nbsp;duplicate&nbsp;index&nbsp;%d&#34;</span><span class="op" id="7295006">,</span>&nbsp;<span class="ident" id="7295008">tc</span><span class="op" id="7295010">.</span><span class="ident" id="7295011">name</span><span class="op" id="7295015">,</span>&nbsp;<span class="ident" id="7295017">s</span><span class="op" id="7295018">,</span>&nbsp;<span class="ident" id="7295020">i</span><span class="op" id="7295021">,</span>&nbsp;<span class="ident" id="7295023">n</span><span class="op" id="7295024">,</span>&nbsp;<span class="ident" id="7295026">r</span><span class="op" id="7295027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295031">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295038">if</span>&nbsp;<span class="ident" id="7295041">n</span>&nbsp;<span class="op" id="7295043">&lt;</span>&nbsp;<span class="num" id="7295045">0</span>&nbsp;<span class="op" id="7295047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295051">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295112">for</span>&nbsp;<span class="ident" id="7295116">i</span><span class="op" id="7295117">,</span>&nbsp;<span class="ident" id="7295119">r</span>&nbsp;<span class="op" id="7295121">:=</span>&nbsp;<span class="keyword" id="7295124">range</span>&nbsp;<span class="ident" id="7295130">res</span>&nbsp;<span class="op" id="7295134">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295139">e</span>&nbsp;<span class="op" id="7295141">:=</span>&nbsp;<span class="ident" id="7295144">exp</span><span class="op" id="7295147">[</span><span class="ident" id="7295148">i</span><span class="op" id="7295149">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295154">if</span>&nbsp;<span class="ident" id="7295157">r</span>&nbsp;<span class="op" id="7295159">!=</span>&nbsp;<span class="ident" id="7295162">e</span>&nbsp;<span class="op" id="7295164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295170">t</span><span class="op" id="7295171">.</span><span class="ident" id="7295172">Errorf</span><span class="op" id="7295178">(</span><span class="string" id="7295179">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;index&nbsp;%d;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7295237">,</span>&nbsp;<span class="ident" id="7295239">tc</span><span class="op" id="7295241">.</span><span class="ident" id="7295242">name</span><span class="op" id="7295246">,</span>&nbsp;<span class="ident" id="7295248">s</span><span class="op" id="7295249">,</span>&nbsp;<span class="ident" id="7295251">i</span><span class="op" id="7295252">,</span>&nbsp;<span class="ident" id="7295254">e</span><span class="op" id="7295255">,</span>&nbsp;<span class="ident" id="7295257">r</span><span class="op" id="7295258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295267">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295270">}</span><br>
<span class="lineno"></span><span class="op" id="7295272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7295275">func</span>&nbsp;<span class="ident" id="7295280">testFindAllIndex</span><span class="op" id="7295296">(</span><span class="ident" id="7295297">t</span>&nbsp;<span class="op" id="7295299">*</span><span class="ident" id="7295300">testing</span><span class="op" id="7295307">.</span><span class="ident" id="7295308">T</span><span class="op" id="7295309">,</span>&nbsp;<span class="ident" id="7295311">tc</span>&nbsp;<span class="op" id="7295314">*</span><span class="ident" id="7295315">testCase</span><span class="op" id="7295323">,</span>&nbsp;<span class="ident" id="7295325">x</span>&nbsp;<span class="op" id="7295327">*</span><span class="ident" id="7295328">Index</span><span class="op" id="7295333">,</span>&nbsp;<span class="ident" id="7295335">rx</span>&nbsp;<span class="op" id="7295338">*</span><span class="ident" id="7295339">regexp</span><span class="op" id="7295345">.</span><span class="ident" id="7295346">Regexp</span><span class="op" id="7295352">,</span>&nbsp;<span class="ident" id="7295354">n</span>&nbsp;<span class="builtintype" id="7295356">int</span><span class="op" id="7295359">)</span>&nbsp;<span class="op" id="7295361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295364">res</span>&nbsp;<span class="op" id="7295368">:=</span>&nbsp;<span class="ident" id="7295371">x</span><span class="op" id="7295372">.</span><span class="ident" id="7295373">FindAllIndex</span><span class="op" id="7295385">(</span><span class="ident" id="7295386">rx</span><span class="op" id="7295388">,</span>&nbsp;<span class="ident" id="7295390">n</span><span class="op" id="7295391">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295394">exp</span>&nbsp;<span class="op" id="7295398">:=</span>&nbsp;<span class="ident" id="7295401">rx</span><span class="op" id="7295403">.</span><span class="ident" id="7295404">FindAllStringIndex</span><span class="op" id="7295422">(</span><span class="ident" id="7295423">tc</span><span class="op" id="7295425">.</span><span class="ident" id="7295426">source</span><span class="op" id="7295432">,</span>&nbsp;<span class="ident" id="7295434">n</span><span class="op" id="7295435">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295439">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295472">if</span>&nbsp;<span class="builtinfunc" id="7295475">len</span><span class="op" id="7295478">(</span><span class="ident" id="7295479">res</span><span class="op" id="7295482">)</span>&nbsp;<span class="op" id="7295484">!=</span>&nbsp;<span class="builtinfunc" id="7295487">len</span><span class="op" id="7295490">(</span><span class="ident" id="7295491">exp</span><span class="op" id="7295494">)</span>&nbsp;<span class="op" id="7295496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295500">t</span><span class="op" id="7295501">.</span><span class="ident" id="7295502">Errorf</span><span class="op" id="7295508">(</span><span class="string" id="7295509">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7295573">,</span>&nbsp;<span class="ident" id="7295575">tc</span><span class="op" id="7295577">.</span><span class="ident" id="7295578">name</span><span class="op" id="7295582">,</span>&nbsp;<span class="ident" id="7295584">rx</span><span class="op" id="7295586">,</span>&nbsp;<span class="ident" id="7295588">n</span><span class="op" id="7295589">,</span>&nbsp;<span class="builtinfunc" id="7295591">len</span><span class="op" id="7295594">(</span><span class="ident" id="7295595">exp</span><span class="op" id="7295598">)</span><span class="op" id="7295599">,</span>&nbsp;<span class="builtinfunc" id="7295601">len</span><span class="op" id="7295604">(</span><span class="ident" id="7295605">res</span><span class="op" id="7295608">)</span><span class="op" id="7295609">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295616">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295692">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;regexp&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295770">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;regexp)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295848">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295913">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;sorted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295992">for</span>&nbsp;<span class="ident" id="7295996">i</span><span class="op" id="7295997">,</span>&nbsp;<span class="ident" id="7295999">r</span>&nbsp;<span class="op" id="7296001">:=</span>&nbsp;<span class="keyword" id="7296004">range</span>&nbsp;<span class="ident" id="7296010">res</span>&nbsp;<span class="op" id="7296014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296018">if</span>&nbsp;<span class="ident" id="7296021">r</span><span class="op" id="7296022">[</span><span class="num" id="7296023">0</span><span class="op" id="7296024">]</span>&nbsp;<span class="op" id="7296026">&lt;</span>&nbsp;<span class="num" id="7296028">0</span>&nbsp;<span class="op" id="7296030">||</span>&nbsp;<span class="ident" id="7296033">r</span><span class="op" id="7296034">[</span><span class="num" id="7296035">0</span><span class="op" id="7296036">]</span>&nbsp;<span class="op" id="7296038">&gt;</span>&nbsp;<span class="ident" id="7296040">r</span><span class="op" id="7296041">[</span><span class="num" id="7296042">1</span><span class="op" id="7296043">]</span>&nbsp;<span class="op" id="7296045">||</span>&nbsp;<span class="builtinfunc" id="7296048">len</span><span class="op" id="7296051">(</span><span class="ident" id="7296052">tc</span><span class="op" id="7296054">.</span><span class="ident" id="7296055">source</span><span class="op" id="7296061">)</span>&nbsp;<span class="op" id="7296063">&lt;</span>&nbsp;<span class="ident" id="7296065">r</span><span class="op" id="7296066">[</span><span class="num" id="7296067">1</span><span class="op" id="7296068">]</span>&nbsp;<span class="op" id="7296070">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296075">t</span><span class="op" id="7296076">.</span><span class="ident" id="7296077">Errorf</span><span class="op" id="7296083">(</span><span class="string" id="7296084">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;==&nbsp;%d):&nbsp;illegal&nbsp;match&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="7296155">,</span>&nbsp;<span class="ident" id="7296157">tc</span><span class="op" id="7296159">.</span><span class="ident" id="7296160">name</span><span class="op" id="7296164">,</span>&nbsp;<span class="ident" id="7296166">rx</span><span class="op" id="7296168">,</span>&nbsp;<span class="ident" id="7296170">i</span><span class="op" id="7296171">,</span>&nbsp;<span class="ident" id="7296173">n</span><span class="op" id="7296174">,</span>&nbsp;<span class="ident" id="7296176">r</span><span class="op" id="7296177">[</span><span class="num" id="7296178">0</span><span class="op" id="7296179">]</span><span class="op" id="7296180">,</span>&nbsp;<span class="ident" id="7296182">r</span><span class="op" id="7296183">[</span><span class="num" id="7296184">1</span><span class="op" id="7296185">]</span><span class="op" id="7296186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296190">}</span>&nbsp;<span class="keyword" id="7296192">else</span>&nbsp;<span class="keyword" id="7296197">if</span>&nbsp;<span class="op" id="7296200">!</span><span class="ident" id="7296201">rx</span><span class="op" id="7296203">.</span><span class="ident" id="7296204">MatchString</span><span class="op" id="7296215">(</span><span class="ident" id="7296216">tc</span><span class="op" id="7296218">.</span><span class="ident" id="7296219">source</span><span class="op" id="7296225">[</span><span class="ident" id="7296226">r</span><span class="op" id="7296227">[</span><span class="num" id="7296228">0</span><span class="op" id="7296229">]</span><span class="op" id="7296230">:</span><span class="ident" id="7296231">r</span><span class="op" id="7296232">[</span><span class="num" id="7296233">1</span><span class="op" id="7296234">]</span><span class="op" id="7296235">]</span><span class="op" id="7296236">)</span>&nbsp;<span class="op" id="7296238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296243">t</span><span class="op" id="7296244">.</span><span class="ident" id="7296245">Errorf</span><span class="op" id="7296251">(</span><span class="string" id="7296252">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;[%d,&nbsp;%d]&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="7296320">,</span>&nbsp;<span class="ident" id="7296322">tc</span><span class="op" id="7296324">.</span><span class="ident" id="7296325">name</span><span class="op" id="7296329">,</span>&nbsp;<span class="ident" id="7296331">rx</span><span class="op" id="7296333">,</span>&nbsp;<span class="ident" id="7296335">i</span><span class="op" id="7296336">,</span>&nbsp;<span class="ident" id="7296338">n</span><span class="op" id="7296339">,</span>&nbsp;<span class="ident" id="7296341">r</span><span class="op" id="7296342">[</span><span class="num" id="7296343">0</span><span class="op" id="7296344">]</span><span class="op" id="7296345">,</span>&nbsp;<span class="ident" id="7296347">r</span><span class="op" id="7296348">[</span><span class="num" id="7296349">1</span><span class="op" id="7296350">]</span><span class="op" id="7296351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296358">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296362">if</span>&nbsp;<span class="ident" id="7296365">n</span>&nbsp;<span class="op" id="7296367">&lt;</span>&nbsp;<span class="num" id="7296369">0</span>&nbsp;<span class="op" id="7296371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7296375">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296436">for</span>&nbsp;<span class="ident" id="7296440">i</span><span class="op" id="7296441">,</span>&nbsp;<span class="ident" id="7296443">r</span>&nbsp;<span class="op" id="7296445">:=</span>&nbsp;<span class="keyword" id="7296448">range</span>&nbsp;<span class="ident" id="7296454">res</span>&nbsp;<span class="op" id="7296458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296463">e</span>&nbsp;<span class="op" id="7296465">:=</span>&nbsp;<span class="ident" id="7296468">exp</span><span class="op" id="7296471">[</span><span class="ident" id="7296472">i</span><span class="op" id="7296473">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296478">if</span>&nbsp;<span class="ident" id="7296481">r</span><span class="op" id="7296482">[</span><span class="num" id="7296483">0</span><span class="op" id="7296484">]</span>&nbsp;<span class="op" id="7296486">!=</span>&nbsp;<span class="ident" id="7296489">e</span><span class="op" id="7296490">[</span><span class="num" id="7296491">0</span><span class="op" id="7296492">]</span>&nbsp;<span class="op" id="7296494">||</span>&nbsp;<span class="ident" id="7296497">r</span><span class="op" id="7296498">[</span><span class="num" id="7296499">1</span><span class="op" id="7296500">]</span>&nbsp;<span class="op" id="7296502">!=</span>&nbsp;<span class="ident" id="7296505">e</span><span class="op" id="7296506">[</span><span class="num" id="7296507">1</span><span class="op" id="7296508">]</span>&nbsp;<span class="op" id="7296510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296516">t</span><span class="op" id="7296517">.</span><span class="ident" id="7296518">Errorf</span><span class="op" id="7296524">(</span><span class="string" id="7296525">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;match&nbsp;[%d,&nbsp;%d];&nbsp;got&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="7296601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296608">tc</span><span class="op" id="7296610">.</span><span class="ident" id="7296611">name</span><span class="op" id="7296615">,</span>&nbsp;<span class="ident" id="7296617">rx</span><span class="op" id="7296619">,</span>&nbsp;<span class="ident" id="7296621">i</span><span class="op" id="7296622">,</span>&nbsp;<span class="ident" id="7296624">e</span><span class="op" id="7296625">[</span><span class="num" id="7296626">0</span><span class="op" id="7296627">]</span><span class="op" id="7296628">,</span>&nbsp;<span class="ident" id="7296630">e</span><span class="op" id="7296631">[</span><span class="num" id="7296632">1</span><span class="op" id="7296633">]</span><span class="op" id="7296634">,</span>&nbsp;<span class="ident" id="7296636">r</span><span class="op" id="7296637">[</span><span class="num" id="7296638">0</span><span class="op" id="7296639">]</span><span class="op" id="7296640">,</span>&nbsp;<span class="ident" id="7296642">r</span><span class="op" id="7296643">[</span><span class="num" id="7296644">1</span><span class="op" id="7296645">]</span><span class="op" id="7296646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296655">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296658">}</span><br>
<span class="lineno"></span><span class="op" id="7296660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7296663">func</span>&nbsp;<span class="ident" id="7296668">testLookups</span><span class="op" id="7296679">(</span><span class="ident" id="7296680">t</span>&nbsp;<span class="op" id="7296682">*</span><span class="ident" id="7296683">testing</span><span class="op" id="7296690">.</span><span class="ident" id="7296691">T</span><span class="op" id="7296692">,</span>&nbsp;<span class="ident" id="7296694">tc</span>&nbsp;<span class="op" id="7296697">*</span><span class="ident" id="7296698">testCase</span><span class="op" id="7296706">,</span>&nbsp;<span class="ident" id="7296708">x</span>&nbsp;<span class="op" id="7296710">*</span><span class="ident" id="7296711">Index</span><span class="op" id="7296716">,</span>&nbsp;<span class="ident" id="7296718">n</span>&nbsp;<span class="builtintype" id="7296720">int</span><span class="op" id="7296723">)</span>&nbsp;<span class="op" id="7296725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296728">for</span>&nbsp;<span class="ident" id="7296732">_</span><span class="op" id="7296733">,</span>&nbsp;<span class="ident" id="7296735">pat</span>&nbsp;<span class="op" id="7296739">:=</span>&nbsp;<span class="keyword" id="7296742">range</span>&nbsp;<span class="ident" id="7296748">tc</span><span class="op" id="7296750">.</span><span class="ident" id="7296751">patterns</span>&nbsp;<span class="op" id="7296760">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296764">testLookup</span><span class="op" id="7296774">(</span><span class="ident" id="7296775">t</span><span class="op" id="7296776">,</span>&nbsp;<span class="ident" id="7296778">tc</span><span class="op" id="7296780">,</span>&nbsp;<span class="ident" id="7296782">x</span><span class="op" id="7296783">,</span>&nbsp;<span class="ident" id="7296785">pat</span><span class="op" id="7296788">,</span>&nbsp;<span class="ident" id="7296790">n</span><span class="op" id="7296791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296795">if</span>&nbsp;<span class="ident" id="7296798">rx</span><span class="op" id="7296800">,</span>&nbsp;<span class="ident" id="7296802">err</span>&nbsp;<span class="op" id="7296806">:=</span>&nbsp;<span class="ident" id="7296809">regexp</span><span class="op" id="7296815">.</span><span class="ident" id="7296816">Compile</span><span class="op" id="7296823">(</span><span class="ident" id="7296824">pat</span><span class="op" id="7296827">)</span><span class="op" id="7296828">;</span>&nbsp;<span class="ident" id="7296830">err</span>&nbsp;<span class="op" id="7296834">==</span>&nbsp;<span class="ident" id="7296837">nil</span>&nbsp;<span class="op" id="7296841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296846">testFindAllIndex</span><span class="op" id="7296862">(</span><span class="ident" id="7296863">t</span><span class="op" id="7296864">,</span>&nbsp;<span class="ident" id="7296866">tc</span><span class="op" id="7296868">,</span>&nbsp;<span class="ident" id="7296870">x</span><span class="op" id="7296871">,</span>&nbsp;<span class="ident" id="7296873">rx</span><span class="op" id="7296875">,</span>&nbsp;<span class="ident" id="7296877">n</span><span class="op" id="7296878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296885">}</span><br>
<span class="lineno">205</span><span class="op" id="7296887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7296890">//&nbsp;index&nbsp;is&nbsp;used&nbsp;to&nbsp;hide&nbsp;the&nbsp;sort.Interface</span><br>
<span class="lineno"></span><span class="keyword" id="7296934">type</span>&nbsp;<span class="ident" id="7296939">index</span>&nbsp;<span class="ident" id="7296945">Index</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="7296952">func</span>&nbsp;<span class="op" id="7296957">(</span><span class="ident" id="7296958">x</span>&nbsp;<span class="op" id="7296960">*</span><span class="ident" id="7296961">index</span><span class="op" id="7296966">)</span>&nbsp;<span class="ident" id="7296968">Len</span><span class="op" id="7296971">(</span><span class="op" id="7296972">)</span>&nbsp;<span class="builtintype" id="7296974">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7296988">{</span>&nbsp;<span class="keyword" id="7296990">return</span>&nbsp;<span class="builtinfunc" id="7296997">len</span><span class="op" id="7297000">(</span><span class="ident" id="7297001">x</span><span class="op" id="7297002">.</span><span class="ident" id="7297003">sa</span><span class="op" id="7297005">)</span>&nbsp;<span class="op" id="7297007">}</span><br>
<span class="lineno"></span><span class="keyword" id="7297009">func</span>&nbsp;<span class="op" id="7297014">(</span><span class="ident" id="7297015">x</span>&nbsp;<span class="op" id="7297017">*</span><span class="ident" id="7297018">index</span><span class="op" id="7297023">)</span>&nbsp;<span class="ident" id="7297025">Less</span><span class="op" id="7297029">(</span><span class="ident" id="7297030">i</span><span class="op" id="7297031">,</span>&nbsp;<span class="ident" id="7297033">j</span>&nbsp;<span class="builtintype" id="7297035">int</span><span class="op" id="7297038">)</span>&nbsp;<span class="builtintype" id="7297040">bool</span>&nbsp;<span class="op" id="7297045">{</span>&nbsp;<span class="keyword" id="7297047">return</span>&nbsp;<span class="ident" id="7297054">bytes</span><span class="op" id="7297059">.</span><span class="ident" id="7297060">Compare</span><span class="op" id="7297067">(</span><span class="ident" id="7297068">x</span><span class="op" id="7297069">.</span><span class="ident" id="7297070">at</span><span class="op" id="7297072">(</span><span class="ident" id="7297073">i</span><span class="op" id="7297074">)</span><span class="op" id="7297075">,</span>&nbsp;<span class="ident" id="7297077">x</span><span class="op" id="7297078">.</span><span class="ident" id="7297079">at</span><span class="op" id="7297081">(</span><span class="ident" id="7297082">j</span><span class="op" id="7297083">)</span><span class="op" id="7297084">)</span>&nbsp;<span class="op" id="7297086">&lt;</span>&nbsp;<span class="num" id="7297088">0</span>&nbsp;<span class="op" id="7297090">}</span><br>
<span class="lineno"></span><span class="keyword" id="7297092">func</span>&nbsp;<span class="op" id="7297097">(</span><span class="ident" id="7297098">x</span>&nbsp;<span class="op" id="7297100">*</span><span class="ident" id="7297101">index</span><span class="op" id="7297106">)</span>&nbsp;<span class="ident" id="7297108">Swap</span><span class="op" id="7297112">(</span><span class="ident" id="7297113">i</span><span class="op" id="7297114">,</span>&nbsp;<span class="ident" id="7297116">j</span>&nbsp;<span class="builtintype" id="7297118">int</span><span class="op" id="7297121">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7297128">{</span>&nbsp;<span class="ident" id="7297130">x</span><span class="op" id="7297131">.</span><span class="ident" id="7297132">sa</span><span class="op" id="7297134">[</span><span class="ident" id="7297135">i</span><span class="op" id="7297136">]</span><span class="op" id="7297137">,</span>&nbsp;<span class="ident" id="7297139">x</span><span class="op" id="7297140">.</span><span class="ident" id="7297141">sa</span><span class="op" id="7297143">[</span><span class="ident" id="7297144">j</span><span class="op" id="7297145">]</span>&nbsp;<span class="op" id="7297147">=</span>&nbsp;<span class="ident" id="7297149">x</span><span class="op" id="7297150">.</span><span class="ident" id="7297151">sa</span><span class="op" id="7297153">[</span><span class="ident" id="7297154">j</span><span class="op" id="7297155">]</span><span class="op" id="7297156">,</span>&nbsp;<span class="ident" id="7297158">x</span><span class="op" id="7297159">.</span><span class="ident" id="7297160">sa</span><span class="op" id="7297162">[</span><span class="ident" id="7297163">i</span><span class="op" id="7297164">]</span>&nbsp;<span class="op" id="7297166">}</span><br>
<span class="lineno"></span><span class="keyword" id="7297168">func</span>&nbsp;<span class="op" id="7297173">(</span><span class="ident" id="7297174">a</span>&nbsp;<span class="op" id="7297176">*</span><span class="ident" id="7297177">index</span><span class="op" id="7297182">)</span>&nbsp;<span class="ident" id="7297184">at</span><span class="op" id="7297186">(</span><span class="ident" id="7297187">i</span>&nbsp;<span class="builtintype" id="7297189">int</span><span class="op" id="7297192">)</span>&nbsp;<span class="op" id="7297194">[</span><span class="op" id="7297195">]</span><span class="builtintype" id="7297196">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7297204">{</span>&nbsp;<span class="keyword" id="7297206">return</span>&nbsp;<span class="ident" id="7297213">a</span><span class="op" id="7297214">.</span><span class="ident" id="7297215">data</span><span class="op" id="7297219">[</span><span class="ident" id="7297220">a</span><span class="op" id="7297221">.</span><span class="ident" id="7297222">sa</span><span class="op" id="7297224">[</span><span class="ident" id="7297225">i</span><span class="op" id="7297226">]</span><span class="op" id="7297227">:</span><span class="op" id="7297228">]</span>&nbsp;<span class="op" id="7297230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="7297233">func</span>&nbsp;<span class="ident" id="7297238">testConstruction</span><span class="op" id="7297254">(</span><span class="ident" id="7297255">t</span>&nbsp;<span class="op" id="7297257">*</span><span class="ident" id="7297258">testing</span><span class="op" id="7297265">.</span><span class="ident" id="7297266">T</span><span class="op" id="7297267">,</span>&nbsp;<span class="ident" id="7297269">tc</span>&nbsp;<span class="op" id="7297272">*</span><span class="ident" id="7297273">testCase</span><span class="op" id="7297281">,</span>&nbsp;<span class="ident" id="7297283">x</span>&nbsp;<span class="op" id="7297285">*</span><span class="ident" id="7297286">Index</span><span class="op" id="7297291">)</span>&nbsp;<span class="op" id="7297293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297296">if</span>&nbsp;<span class="op" id="7297299">!</span><span class="ident" id="7297300">sort</span><span class="op" id="7297304">.</span><span class="ident" id="7297305">IsSorted</span><span class="op" id="7297313">(</span><span class="op" id="7297314">(</span><span class="op" id="7297315">*</span><span class="ident" id="7297316">index</span><span class="op" id="7297321">)</span><span class="op" id="7297322">(</span><span class="ident" id="7297323">x</span><span class="op" id="7297324">)</span><span class="op" id="7297325">)</span>&nbsp;<span class="op" id="7297327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297331">t</span><span class="op" id="7297332">.</span><span class="ident" id="7297333">Errorf</span><span class="op" id="7297339">(</span><span class="string" id="7297340">&#34;failed&nbsp;testConstruction&nbsp;%s&#34;</span><span class="op" id="7297368">,</span>&nbsp;<span class="ident" id="7297370">tc</span><span class="op" id="7297372">.</span><span class="ident" id="7297373">name</span><span class="op" id="7297377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297380">}</span><br>
<span class="lineno"></span><span class="op" id="7297382">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="7297385">func</span>&nbsp;<span class="ident" id="7297390">equal</span><span class="op" id="7297395">(</span><span class="ident" id="7297396">x</span><span class="op" id="7297397">,</span>&nbsp;<span class="ident" id="7297399">y</span>&nbsp;<span class="op" id="7297401">*</span><span class="ident" id="7297402">Index</span><span class="op" id="7297407">)</span>&nbsp;<span class="builtintype" id="7297409">bool</span>&nbsp;<span class="op" id="7297414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297417">if</span>&nbsp;<span class="op" id="7297420">!</span><span class="ident" id="7297421">bytes</span><span class="op" id="7297426">.</span><span class="ident" id="7297427">Equal</span><span class="op" id="7297432">(</span><span class="ident" id="7297433">x</span><span class="op" id="7297434">.</span><span class="ident" id="7297435">data</span><span class="op" id="7297439">,</span>&nbsp;<span class="ident" id="7297441">y</span><span class="op" id="7297442">.</span><span class="ident" id="7297443">data</span><span class="op" id="7297447">)</span>&nbsp;<span class="op" id="7297449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297453">return</span>&nbsp;<span class="builtintype" id="7297460">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297467">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297470">for</span>&nbsp;<span class="ident" id="7297474">i</span><span class="op" id="7297475">,</span>&nbsp;<span class="ident" id="7297477">j</span>&nbsp;<span class="op" id="7297479">:=</span>&nbsp;<span class="keyword" id="7297482">range</span>&nbsp;<span class="ident" id="7297488">x</span><span class="op" id="7297489">.</span><span class="ident" id="7297490">sa</span>&nbsp;<span class="op" id="7297493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297497">if</span>&nbsp;<span class="ident" id="7297500">j</span>&nbsp;<span class="op" id="7297502">!=</span>&nbsp;<span class="ident" id="7297505">y</span><span class="op" id="7297506">.</span><span class="ident" id="7297507">sa</span><span class="op" id="7297509">[</span><span class="ident" id="7297510">i</span><span class="op" id="7297511">]</span>&nbsp;<span class="op" id="7297513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297518">return</span>&nbsp;<span class="builtintype" id="7297525">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297536">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297539">return</span>&nbsp;<span class="builtintype" id="7297546">true</span><br>
<span class="lineno"></span><span class="op" id="7297551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7297554">//&nbsp;returns&nbsp;the&nbsp;serialized&nbsp;index&nbsp;size</span><br>
<span class="lineno"></span><span class="keyword" id="7297591">func</span>&nbsp;<span class="ident" id="7297596">testSaveRestore</span><span class="op" id="7297611">(</span><span class="ident" id="7297612">t</span>&nbsp;<span class="op" id="7297614">*</span><span class="ident" id="7297615">testing</span><span class="op" id="7297622">.</span><span class="ident" id="7297623">T</span><span class="op" id="7297624">,</span>&nbsp;<span class="ident" id="7297626">tc</span>&nbsp;<span class="op" id="7297629">*</span><span class="ident" id="7297630">testCase</span><span class="op" id="7297638">,</span>&nbsp;<span class="ident" id="7297640">x</span>&nbsp;<span class="op" id="7297642">*</span><span class="ident" id="7297643">Index</span><span class="op" id="7297648">)</span>&nbsp;<span class="builtintype" id="7297650">int</span>&nbsp;<span class="op" id="7297654">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297657">var</span>&nbsp;<span class="ident" id="7297661">buf</span>&nbsp;<span class="ident" id="7297665">bytes</span><span class="op" id="7297670">.</span><span class="ident" id="7297671">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297679">if</span>&nbsp;<span class="ident" id="7297682">err</span>&nbsp;<span class="op" id="7297686">:=</span>&nbsp;<span class="ident" id="7297689">x</span><span class="op" id="7297690">.</span><span class="ident" id="7297691">Write</span><span class="op" id="7297696">(</span><span class="op" id="7297697">&amp;</span><span class="ident" id="7297698">buf</span><span class="op" id="7297701">)</span><span class="op" id="7297702">;</span>&nbsp;<span class="ident" id="7297704">err</span>&nbsp;<span class="op" id="7297708">!=</span>&nbsp;<span class="ident" id="7297711">nil</span>&nbsp;<span class="op" id="7297715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297719">t</span><span class="op" id="7297720">.</span><span class="ident" id="7297721">Errorf</span><span class="op" id="7297727">(</span><span class="string" id="7297728">&#34;failed&nbsp;writing&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="7297758">,</span>&nbsp;<span class="ident" id="7297760">tc</span><span class="op" id="7297762">.</span><span class="ident" id="7297763">name</span><span class="op" id="7297767">,</span>&nbsp;<span class="ident" id="7297769">err</span><span class="op" id="7297772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297778">size</span>&nbsp;<span class="op" id="7297783">:=</span>&nbsp;<span class="ident" id="7297786">buf</span><span class="op" id="7297789">.</span><span class="ident" id="7297790">Len</span><span class="op" id="7297793">(</span><span class="op" id="7297794">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297797">var</span>&nbsp;<span class="ident" id="7297801">y</span>&nbsp;<span class="ident" id="7297803">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297810">if</span>&nbsp;<span class="ident" id="7297813">err</span>&nbsp;<span class="op" id="7297817">:=</span>&nbsp;<span class="ident" id="7297820">y</span><span class="op" id="7297821">.</span><span class="ident" id="7297822">Read</span><span class="op" id="7297826">(</span><span class="op" id="7297827">&amp;</span><span class="ident" id="7297828">buf</span><span class="op" id="7297831">)</span><span class="op" id="7297832">;</span>&nbsp;<span class="ident" id="7297834">err</span>&nbsp;<span class="op" id="7297838">!=</span>&nbsp;<span class="ident" id="7297841">nil</span>&nbsp;<span class="op" id="7297845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297849">t</span><span class="op" id="7297850">.</span><span class="ident" id="7297851">Errorf</span><span class="op" id="7297857">(</span><span class="string" id="7297858">&#34;failed&nbsp;reading&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="7297888">,</span>&nbsp;<span class="ident" id="7297890">tc</span><span class="op" id="7297892">.</span><span class="ident" id="7297893">name</span><span class="op" id="7297897">,</span>&nbsp;<span class="ident" id="7297899">err</span><span class="op" id="7297902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297908">if</span>&nbsp;<span class="op" id="7297911">!</span><span class="ident" id="7297912">equal</span><span class="op" id="7297917">(</span><span class="ident" id="7297918">x</span><span class="op" id="7297919">,</span>&nbsp;<span class="op" id="7297921">&amp;</span><span class="ident" id="7297922">y</span><span class="op" id="7297923">)</span>&nbsp;<span class="op" id="7297925">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297929">t</span><span class="op" id="7297930">.</span><span class="ident" id="7297931">Errorf</span><span class="op" id="7297937">(</span><span class="string" id="7297938">&#34;restored&nbsp;index&nbsp;doesn&#39;t&nbsp;match&nbsp;saved&nbsp;index&nbsp;%s&#34;</span><span class="op" id="7297983">,</span>&nbsp;<span class="ident" id="7297985">tc</span><span class="op" id="7297987">.</span><span class="ident" id="7297988">name</span><span class="op" id="7297992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297998">return</span>&nbsp;<span class="ident" id="7298005">size</span><br>
<span class="lineno"></span><span class="op" id="7298010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="7298013">func</span>&nbsp;<span class="ident" id="7298018">TestIndex</span><span class="op" id="7298027">(</span><span class="ident" id="7298028">t</span>&nbsp;<span class="op" id="7298030">*</span><span class="ident" id="7298031">testing</span><span class="op" id="7298038">.</span><span class="ident" id="7298039">T</span><span class="op" id="7298040">)</span>&nbsp;<span class="op" id="7298042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298045">for</span>&nbsp;<span class="ident" id="7298049">_</span><span class="op" id="7298050">,</span>&nbsp;<span class="ident" id="7298052">tc</span>&nbsp;<span class="op" id="7298055">:=</span>&nbsp;<span class="keyword" id="7298058">range</span>&nbsp;<span class="ident" id="7298064">testCases</span>&nbsp;<span class="op" id="7298074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298078">x</span>&nbsp;<span class="op" id="7298080">:=</span>&nbsp;<span class="ident" id="7298083">New</span><span class="op" id="7298086">(</span><span class="op" id="7298087">[</span><span class="op" id="7298088">]</span><span class="builtintype" id="7298089">byte</span><span class="op" id="7298093">(</span><span class="ident" id="7298094">tc</span><span class="op" id="7298096">.</span><span class="ident" id="7298097">source</span><span class="op" id="7298103">)</span><span class="op" id="7298104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298108">testConstruction</span><span class="op" id="7298124">(</span><span class="ident" id="7298125">t</span><span class="op" id="7298126">,</span>&nbsp;<span class="op" id="7298128">&amp;</span><span class="ident" id="7298129">tc</span><span class="op" id="7298131">,</span>&nbsp;<span class="ident" id="7298133">x</span><span class="op" id="7298134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298138">testSaveRestore</span><span class="op" id="7298153">(</span><span class="ident" id="7298154">t</span><span class="op" id="7298155">,</span>&nbsp;<span class="op" id="7298157">&amp;</span><span class="ident" id="7298158">tc</span><span class="op" id="7298160">,</span>&nbsp;<span class="ident" id="7298162">x</span><span class="op" id="7298163">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298167">testLookups</span><span class="op" id="7298178">(</span><span class="ident" id="7298179">t</span><span class="op" id="7298180">,</span>&nbsp;<span class="op" id="7298182">&amp;</span><span class="ident" id="7298183">tc</span><span class="op" id="7298185">,</span>&nbsp;<span class="ident" id="7298187">x</span><span class="op" id="7298188">,</span>&nbsp;<span class="num" id="7298190">0</span><span class="op" id="7298191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298195">testLookups</span><span class="op" id="7298206">(</span><span class="ident" id="7298207">t</span><span class="op" id="7298208">,</span>&nbsp;<span class="op" id="7298210">&amp;</span><span class="ident" id="7298211">tc</span><span class="op" id="7298213">,</span>&nbsp;<span class="ident" id="7298215">x</span><span class="op" id="7298216">,</span>&nbsp;<span class="num" id="7298218">1</span><span class="op" id="7298219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298223">testLookups</span><span class="op" id="7298234">(</span><span class="ident" id="7298235">t</span><span class="op" id="7298236">,</span>&nbsp;<span class="op" id="7298238">&amp;</span><span class="ident" id="7298239">tc</span><span class="op" id="7298241">,</span>&nbsp;<span class="ident" id="7298243">x</span><span class="op" id="7298244">,</span>&nbsp;<span class="num" id="7298246">10</span><span class="op" id="7298248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298252">testLookups</span><span class="op" id="7298263">(</span><span class="ident" id="7298264">t</span><span class="op" id="7298265">,</span>&nbsp;<span class="op" id="7298267">&amp;</span><span class="ident" id="7298268">tc</span><span class="op" id="7298270">,</span>&nbsp;<span class="ident" id="7298272">x</span><span class="op" id="7298273">,</span>&nbsp;<span class="num" id="7298275">2e9</span><span class="op" id="7298278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298282">testLookups</span><span class="op" id="7298293">(</span><span class="ident" id="7298294">t</span><span class="op" id="7298295">,</span>&nbsp;<span class="op" id="7298297">&amp;</span><span class="ident" id="7298298">tc</span><span class="op" id="7298300">,</span>&nbsp;<span class="ident" id="7298302">x</span><span class="op" id="7298303">,</span>&nbsp;<span class="op" id="7298305">-</span><span class="num" id="7298306">1</span><span class="op" id="7298307">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298310">}</span><br>
<span class="lineno"></span><span class="op" id="7298312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7298315">//&nbsp;Of&nbsp;all&nbsp;possible&nbsp;inputs,&nbsp;the&nbsp;random&nbsp;bytes&nbsp;have&nbsp;the&nbsp;least&nbsp;amount&nbsp;of&nbsp;substring</span><br>
<span class="lineno"></span><span class="comment" id="7298394">//&nbsp;repetition,&nbsp;and&nbsp;the&nbsp;repeated&nbsp;bytes&nbsp;have&nbsp;the&nbsp;most.&nbsp;For&nbsp;most&nbsp;algorithms,</span><br>
<span class="lineno">265</span><span class="comment" id="7298468">//&nbsp;the&nbsp;running&nbsp;time&nbsp;of&nbsp;every&nbsp;input&nbsp;will&nbsp;be&nbsp;between&nbsp;these&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="7298530">func</span>&nbsp;<span class="ident" id="7298535">benchmarkNew</span><span class="op" id="7298547">(</span><span class="ident" id="7298548">b</span>&nbsp;<span class="op" id="7298550">*</span><span class="ident" id="7298551">testing</span><span class="op" id="7298558">.</span><span class="ident" id="7298559">B</span><span class="op" id="7298560">,</span>&nbsp;<span class="ident" id="7298562">random</span>&nbsp;<span class="builtintype" id="7298569">bool</span><span class="op" id="7298573">)</span>&nbsp;<span class="op" id="7298575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298578">b</span><span class="op" id="7298579">.</span><span class="ident" id="7298580">StopTimer</span><span class="op" id="7298589">(</span><span class="op" id="7298590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298593">data</span>&nbsp;<span class="op" id="7298598">:=</span>&nbsp;<span class="builtinfunc" id="7298601">make</span><span class="op" id="7298605">(</span><span class="op" id="7298606">[</span><span class="op" id="7298607">]</span><span class="builtintype" id="7298608">byte</span><span class="op" id="7298612">,</span>&nbsp;<span class="num" id="7298614">1e6</span><span class="op" id="7298617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298620">if</span>&nbsp;<span class="ident" id="7298623">random</span>&nbsp;<span class="op" id="7298630">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298634">for</span>&nbsp;<span class="ident" id="7298638">i</span>&nbsp;<span class="op" id="7298640">:=</span>&nbsp;<span class="keyword" id="7298643">range</span>&nbsp;<span class="ident" id="7298649">data</span>&nbsp;<span class="op" id="7298654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298659">data</span><span class="op" id="7298663">[</span><span class="ident" id="7298664">i</span><span class="op" id="7298665">]</span>&nbsp;<span class="op" id="7298667">=</span>&nbsp;<span class="builtintype" id="7298669">byte</span><span class="op" id="7298673">(</span><span class="ident" id="7298674">rand</span><span class="op" id="7298678">.</span><span class="ident" id="7298679">Intn</span><span class="op" id="7298683">(</span><span class="num" id="7298684">256</span><span class="op" id="7298687">)</span><span class="op" id="7298688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298698">b</span><span class="op" id="7298699">.</span><span class="ident" id="7298700">StartTimer</span><span class="op" id="7298710">(</span><span class="op" id="7298711">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298714">for</span>&nbsp;<span class="ident" id="7298718">i</span>&nbsp;<span class="op" id="7298720">:=</span>&nbsp;<span class="num" id="7298723">0</span><span class="op" id="7298724">;</span>&nbsp;<span class="ident" id="7298726">i</span>&nbsp;<span class="op" id="7298728">&lt;</span>&nbsp;<span class="ident" id="7298730">b</span><span class="op" id="7298731">.</span><span class="ident" id="7298732">N</span><span class="op" id="7298733">;</span>&nbsp;<span class="ident" id="7298735">i</span><span class="op" id="7298736">++</span>&nbsp;<span class="op" id="7298739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298743">New</span><span class="op" id="7298746">(</span><span class="ident" id="7298747">data</span><span class="op" id="7298751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298754">}</span><br>
<span class="lineno"></span><span class="op" id="7298756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="7298759">func</span>&nbsp;<span class="ident" id="7298764">BenchmarkNewIndexRandom</span><span class="op" id="7298787">(</span><span class="ident" id="7298788">b</span>&nbsp;<span class="op" id="7298790">*</span><span class="ident" id="7298791">testing</span><span class="op" id="7298798">.</span><span class="ident" id="7298799">B</span><span class="op" id="7298800">)</span>&nbsp;<span class="op" id="7298802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298805">benchmarkNew</span><span class="op" id="7298817">(</span><span class="ident" id="7298818">b</span><span class="op" id="7298819">,</span>&nbsp;<span class="builtintype" id="7298821">true</span><span class="op" id="7298825">)</span><br>
<span class="lineno"></span><span class="op" id="7298827">}</span><br>
<span class="lineno"></span><span class="keyword" id="7298829">func</span>&nbsp;<span class="ident" id="7298834">BenchmarkNewIndexRepeat</span><span class="op" id="7298857">(</span><span class="ident" id="7298858">b</span>&nbsp;<span class="op" id="7298860">*</span><span class="ident" id="7298861">testing</span><span class="op" id="7298868">.</span><span class="ident" id="7298869">B</span><span class="op" id="7298870">)</span>&nbsp;<span class="op" id="7298872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298875">benchmarkNew</span><span class="op" id="7298887">(</span><span class="ident" id="7298888">b</span><span class="op" id="7298889">,</span>&nbsp;<span class="builtintype" id="7298891">false</span><span class="op" id="7298896">)</span><br>
<span class="lineno">285</span><span class="op" id="7298898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7298901">func</span>&nbsp;<span class="ident" id="7298906">BenchmarkSaveRestore</span><span class="op" id="7298926">(</span><span class="ident" id="7298927">b</span>&nbsp;<span class="op" id="7298929">*</span><span class="ident" id="7298930">testing</span><span class="op" id="7298937">.</span><span class="ident" id="7298938">B</span><span class="op" id="7298939">)</span>&nbsp;<span class="op" id="7298941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298944">b</span><span class="op" id="7298945">.</span><span class="ident" id="7298946">StopTimer</span><span class="op" id="7298955">(</span><span class="op" id="7298956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298959">r</span>&nbsp;<span class="op" id="7298961">:=</span>&nbsp;<span class="ident" id="7298964">rand</span><span class="op" id="7298968">.</span><span class="ident" id="7298969">New</span><span class="op" id="7298972">(</span><span class="ident" id="7298973">rand</span><span class="op" id="7298977">.</span><span class="ident" id="7298978">NewSource</span><span class="op" id="7298987">(</span><span class="num" id="7298988">0x5a77a1</span><span class="op" id="7298996">)</span><span class="op" id="7298997">)</span>&nbsp;<span class="comment" id="7298999">//&nbsp;guarantee&nbsp;always&nbsp;same&nbsp;sequence</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299034">data</span>&nbsp;<span class="op" id="7299039">:=</span>&nbsp;<span class="builtinfunc" id="7299042">make</span><span class="op" id="7299046">(</span><span class="op" id="7299047">[</span><span class="op" id="7299048">]</span><span class="builtintype" id="7299049">byte</span><span class="op" id="7299053">,</span>&nbsp;<span class="num" id="7299055">1</span><span class="op" id="7299056">&lt;&lt;</span><span class="num" id="7299058">20</span><span class="op" id="7299060">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7299074">//&nbsp;1MB&nbsp;of&nbsp;data&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299099">for</span>&nbsp;<span class="ident" id="7299103">i</span>&nbsp;<span class="op" id="7299105">:=</span>&nbsp;<span class="keyword" id="7299108">range</span>&nbsp;<span class="ident" id="7299114">data</span>&nbsp;<span class="op" id="7299119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299123">data</span><span class="op" id="7299127">[</span><span class="ident" id="7299128">i</span><span class="op" id="7299129">]</span>&nbsp;<span class="op" id="7299131">=</span>&nbsp;<span class="builtintype" id="7299133">byte</span><span class="op" id="7299137">(</span><span class="ident" id="7299138">r</span><span class="op" id="7299139">.</span><span class="ident" id="7299140">Intn</span><span class="op" id="7299144">(</span><span class="num" id="7299145">256</span><span class="op" id="7299148">)</span><span class="op" id="7299149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299155">x</span>&nbsp;<span class="op" id="7299157">:=</span>&nbsp;<span class="ident" id="7299160">New</span><span class="op" id="7299163">(</span><span class="ident" id="7299164">data</span><span class="op" id="7299168">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299171">size</span>&nbsp;<span class="op" id="7299176">:=</span>&nbsp;<span class="ident" id="7299179">testSaveRestore</span><span class="op" id="7299194">(</span><span class="ident" id="7299195">nil</span><span class="op" id="7299198">,</span>&nbsp;<span class="ident" id="7299200">nil</span><span class="op" id="7299203">,</span>&nbsp;<span class="ident" id="7299205">x</span><span class="op" id="7299206">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7299214">//&nbsp;verify&nbsp;correctness</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299237">buf</span>&nbsp;<span class="op" id="7299241">:=</span>&nbsp;<span class="ident" id="7299244">bytes</span><span class="op" id="7299249">.</span><span class="ident" id="7299250">NewBuffer</span><span class="op" id="7299259">(</span><span class="builtinfunc" id="7299260">make</span><span class="op" id="7299264">(</span><span class="op" id="7299265">[</span><span class="op" id="7299266">]</span><span class="builtintype" id="7299267">byte</span><span class="op" id="7299271">,</span>&nbsp;<span class="ident" id="7299273">size</span><span class="op" id="7299277">)</span><span class="op" id="7299278">)</span>&nbsp;<span class="comment" id="7299280">//&nbsp;avoid&nbsp;growing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299298">b</span><span class="op" id="7299299">.</span><span class="ident" id="7299300">SetBytes</span><span class="op" id="7299308">(</span><span class="ident" id="7299309">int64</span><span class="op" id="7299314">(</span><span class="ident" id="7299315">size</span><span class="op" id="7299319">)</span><span class="op" id="7299320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299323">b</span><span class="op" id="7299324">.</span><span class="ident" id="7299325">StartTimer</span><span class="op" id="7299335">(</span><span class="op" id="7299336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299339">for</span>&nbsp;<span class="ident" id="7299343">i</span>&nbsp;<span class="op" id="7299345">:=</span>&nbsp;<span class="num" id="7299348">0</span><span class="op" id="7299349">;</span>&nbsp;<span class="ident" id="7299351">i</span>&nbsp;<span class="op" id="7299353">&lt;</span>&nbsp;<span class="ident" id="7299355">b</span><span class="op" id="7299356">.</span><span class="ident" id="7299357">N</span><span class="op" id="7299358">;</span>&nbsp;<span class="ident" id="7299360">i</span><span class="op" id="7299361">++</span>&nbsp;<span class="op" id="7299364">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299368">x</span><span class="op" id="7299369">.</span><span class="ident" id="7299370">Write</span><span class="op" id="7299375">(</span><span class="ident" id="7299376">buf</span><span class="op" id="7299379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299383">var</span>&nbsp;<span class="ident" id="7299387">y</span>&nbsp;<span class="ident" id="7299389">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299397">y</span><span class="op" id="7299398">.</span><span class="ident" id="7299399">Read</span><span class="op" id="7299403">(</span><span class="ident" id="7299404">buf</span><span class="op" id="7299407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299410">}</span><br>
<span class="lineno"></span><span class="op" id="7299412">}</span>
</div>
</body>
</html>
