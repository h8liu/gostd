<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2881764">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2881819">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2881873">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2881924">//&nbsp;Package&nbsp;bytes&nbsp;implements&nbsp;functions&nbsp;for&nbsp;the&nbsp;manipulation&nbsp;of&nbsp;byte&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="2881999">//&nbsp;It&nbsp;is&nbsp;analogous&nbsp;to&nbsp;the&nbsp;facilities&nbsp;of&nbsp;the&nbsp;strings&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="2882060">package</span>&nbsp;<span class="ident" id="2882068">bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2882075">import</span>&nbsp;<span class="op" id="2882082">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2882085">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2882096">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2882111">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2882114">func</span>&nbsp;<span class="ident" id="2882119">equalPortable</span><span class="op" id="2882132">(</span><span class="ident" id="2882133">a</span><span class="op" id="2882134">,</span>&nbsp;<span class="ident" id="2882136">b</span>&nbsp;<span class="op" id="2882138">[</span><span class="op" id="2882139">]</span><span class="builtintype" id="2882140">byte</span><span class="op" id="2882144">)</span>&nbsp;<span class="builtintype" id="2882146">bool</span>&nbsp;<span class="op" id="2882151">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882154">if</span>&nbsp;<span class="builtinfunc" id="2882157">len</span><span class="op" id="2882160">(</span><span class="ident" id="2882161">a</span><span class="op" id="2882162">)</span>&nbsp;<span class="op" id="2882164">!=</span>&nbsp;<span class="builtinfunc" id="2882167">len</span><span class="op" id="2882170">(</span><span class="ident" id="2882171">b</span><span class="op" id="2882172">)</span>&nbsp;<span class="op" id="2882174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882178">return</span>&nbsp;<span class="builtintype" id="2882185">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882195">for</span>&nbsp;<span class="ident" id="2882199">i</span><span class="op" id="2882200">,</span>&nbsp;<span class="ident" id="2882202">c</span>&nbsp;<span class="op" id="2882204">:=</span>&nbsp;<span class="keyword" id="2882207">range</span>&nbsp;<span class="ident" id="2882213">a</span>&nbsp;<span class="op" id="2882215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882219">if</span>&nbsp;<span class="ident" id="2882222">c</span>&nbsp;<span class="op" id="2882224">!=</span>&nbsp;<span class="ident" id="2882227">b</span><span class="op" id="2882228">[</span><span class="ident" id="2882229">i</span><span class="op" id="2882230">]</span>&nbsp;<span class="op" id="2882232">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882237">return</span>&nbsp;<span class="builtintype" id="2882244">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882258">return</span>&nbsp;<span class="builtintype" id="2882265">true</span><br>
<span class="lineno"></span><span class="op" id="2882270">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2882273">//&nbsp;explode&nbsp;splits&nbsp;s&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;UTF-8&nbsp;sequences,&nbsp;one&nbsp;per&nbsp;Unicode&nbsp;character&nbsp;(still&nbsp;slices&nbsp;of&nbsp;bytes),</span><br>
<span class="lineno"></span><span class="comment" id="2882377">//&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;n&nbsp;byte&nbsp;slices.&nbsp;Invalid&nbsp;UTF-8&nbsp;sequences&nbsp;are&nbsp;chopped&nbsp;into&nbsp;individual&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2882473">func</span>&nbsp;<span class="ident" id="2882478">explode</span><span class="op" id="2882485">(</span><span class="ident" id="2882486">s</span>&nbsp;<span class="op" id="2882488">[</span><span class="op" id="2882489">]</span><span class="builtintype" id="2882490">byte</span><span class="op" id="2882494">,</span>&nbsp;<span class="ident" id="2882496">n</span>&nbsp;<span class="builtintype" id="2882498">int</span><span class="op" id="2882501">)</span>&nbsp;<span class="op" id="2882503">[</span><span class="op" id="2882504">]</span><span class="op" id="2882505">[</span><span class="op" id="2882506">]</span><span class="builtintype" id="2882507">byte</span>&nbsp;<span class="op" id="2882512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882515">if</span>&nbsp;<span class="ident" id="2882518">n</span>&nbsp;<span class="op" id="2882520">&lt;=</span>&nbsp;<span class="num" id="2882523">0</span>&nbsp;<span class="op" id="2882525">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882529">n</span>&nbsp;<span class="op" id="2882531">=</span>&nbsp;<span class="builtinfunc" id="2882533">len</span><span class="op" id="2882536">(</span><span class="ident" id="2882537">s</span><span class="op" id="2882538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882544">a</span>&nbsp;<span class="op" id="2882546">:=</span>&nbsp;<span class="builtinfunc" id="2882549">make</span><span class="op" id="2882553">(</span><span class="op" id="2882554">[</span><span class="op" id="2882555">]</span><span class="op" id="2882556">[</span><span class="op" id="2882557">]</span><span class="builtintype" id="2882558">byte</span><span class="op" id="2882562">,</span>&nbsp;<span class="ident" id="2882564">n</span><span class="op" id="2882565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882568">var</span>&nbsp;<span class="ident" id="2882572">size</span>&nbsp;<span class="builtintype" id="2882577">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882582">na</span>&nbsp;<span class="op" id="2882585">:=</span>&nbsp;<span class="num" id="2882588">0</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882591">for</span>&nbsp;<span class="builtinfunc" id="2882595">len</span><span class="op" id="2882598">(</span><span class="ident" id="2882599">s</span><span class="op" id="2882600">)</span>&nbsp;<span class="op" id="2882602">&gt;</span>&nbsp;<span class="num" id="2882604">0</span>&nbsp;<span class="op" id="2882606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882610">if</span>&nbsp;<span class="ident" id="2882613">na</span><span class="op" id="2882615">+</span><span class="num" id="2882616">1</span>&nbsp;<span class="op" id="2882618">&gt;=</span>&nbsp;<span class="ident" id="2882621">n</span>&nbsp;<span class="op" id="2882623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882628">a</span><span class="op" id="2882629">[</span><span class="ident" id="2882630">na</span><span class="op" id="2882632">]</span>&nbsp;<span class="op" id="2882634">=</span>&nbsp;<span class="ident" id="2882636">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882641">na</span><span class="op" id="2882643">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882649">break</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882661">_</span><span class="op" id="2882662">,</span>&nbsp;<span class="ident" id="2882664">size</span>&nbsp;<span class="op" id="2882669">=</span>&nbsp;<span class="ident" id="2882671">utf8</span><span class="op" id="2882675">.</span><span class="ident" id="2882676">DecodeRune</span><span class="op" id="2882686">(</span><span class="ident" id="2882687">s</span><span class="op" id="2882688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882692">a</span><span class="op" id="2882693">[</span><span class="ident" id="2882694">na</span><span class="op" id="2882696">]</span>&nbsp;<span class="op" id="2882698">=</span>&nbsp;<span class="ident" id="2882700">s</span><span class="op" id="2882701">[</span><span class="num" id="2882702">0</span><span class="op" id="2882703">:</span><span class="ident" id="2882704">size</span><span class="op" id="2882708">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882712">s</span>&nbsp;<span class="op" id="2882714">=</span>&nbsp;<span class="ident" id="2882716">s</span><span class="op" id="2882717">[</span><span class="ident" id="2882718">size</span><span class="op" id="2882722">:</span><span class="op" id="2882723">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882727">na</span><span class="op" id="2882729">++</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882736">return</span>&nbsp;<span class="ident" id="2882743">a</span><span class="op" id="2882744">[</span><span class="num" id="2882745">0</span><span class="op" id="2882746">:</span><span class="ident" id="2882747">na</span><span class="op" id="2882749">]</span><br>
<span class="lineno"></span><span class="op" id="2882751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2882754">//&nbsp;Count&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;sep&nbsp;in&nbsp;s.</span><br>
<span class="lineno">50</span><span class="keyword" id="2882823">func</span>&nbsp;<span class="ident" id="2882828">Count</span><span class="op" id="2882833">(</span><span class="ident" id="2882834">s</span><span class="op" id="2882835">,</span>&nbsp;<span class="ident" id="2882837">sep</span>&nbsp;<span class="op" id="2882841">[</span><span class="op" id="2882842">]</span><span class="builtintype" id="2882843">byte</span><span class="op" id="2882847">)</span>&nbsp;<span class="builtintype" id="2882849">int</span>&nbsp;<span class="op" id="2882853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882856">n</span>&nbsp;<span class="op" id="2882858">:=</span>&nbsp;<span class="builtinfunc" id="2882861">len</span><span class="op" id="2882864">(</span><span class="ident" id="2882865">sep</span><span class="op" id="2882868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882871">if</span>&nbsp;<span class="ident" id="2882874">n</span>&nbsp;<span class="op" id="2882876">==</span>&nbsp;<span class="num" id="2882879">0</span>&nbsp;<span class="op" id="2882881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882885">return</span>&nbsp;<span class="ident" id="2882892">utf8</span><span class="op" id="2882896">.</span><span class="ident" id="2882897">RuneCount</span><span class="op" id="2882906">(</span><span class="ident" id="2882907">s</span><span class="op" id="2882908">)</span>&nbsp;<span class="op" id="2882910">+</span>&nbsp;<span class="num" id="2882912">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882915">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882918">if</span>&nbsp;<span class="ident" id="2882921">n</span>&nbsp;<span class="op" id="2882923">&gt;</span>&nbsp;<span class="builtinfunc" id="2882925">len</span><span class="op" id="2882928">(</span><span class="ident" id="2882929">s</span><span class="op" id="2882930">)</span>&nbsp;<span class="op" id="2882932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2882936">return</span>&nbsp;<span class="num" id="2882943">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2882946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882949">count</span>&nbsp;<span class="op" id="2882955">:=</span>&nbsp;<span class="num" id="2882958">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882961">c</span>&nbsp;<span class="op" id="2882963">:=</span>&nbsp;<span class="ident" id="2882966">sep</span><span class="op" id="2882969">[</span><span class="num" id="2882970">0</span><span class="op" id="2882971">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882974">i</span>&nbsp;<span class="op" id="2882976">:=</span>&nbsp;<span class="num" id="2882979">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2882982">t</span>&nbsp;<span class="op" id="2882984">:=</span>&nbsp;<span class="ident" id="2882987">s</span><span class="op" id="2882988">[</span><span class="op" id="2882989">:</span><span class="builtinfunc" id="2882990">len</span><span class="op" id="2882993">(</span><span class="ident" id="2882994">s</span><span class="op" id="2882995">)</span><span class="op" id="2882996">-</span><span class="ident" id="2882997">n</span><span class="op" id="2882998">+</span><span class="num" id="2882999">1</span><span class="op" id="2883000">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883003">for</span>&nbsp;<span class="ident" id="2883007">i</span>&nbsp;<span class="op" id="2883009">&lt;</span>&nbsp;<span class="builtinfunc" id="2883011">len</span><span class="op" id="2883014">(</span><span class="ident" id="2883015">t</span><span class="op" id="2883016">)</span>&nbsp;<span class="op" id="2883018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883022">if</span>&nbsp;<span class="ident" id="2883025">t</span><span class="op" id="2883026">[</span><span class="ident" id="2883027">i</span><span class="op" id="2883028">]</span>&nbsp;<span class="op" id="2883030">!=</span>&nbsp;<span class="ident" id="2883033">c</span>&nbsp;<span class="op" id="2883035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883040">o</span>&nbsp;<span class="op" id="2883042">:=</span>&nbsp;<span class="ident" id="2883045">IndexByte</span><span class="op" id="2883054">(</span><span class="ident" id="2883055">t</span><span class="op" id="2883056">[</span><span class="ident" id="2883057">i</span><span class="op" id="2883058">:</span><span class="op" id="2883059">]</span><span class="op" id="2883060">,</span>&nbsp;<span class="ident" id="2883062">c</span><span class="op" id="2883063">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883068">if</span>&nbsp;<span class="ident" id="2883071">o</span>&nbsp;<span class="op" id="2883073">&lt;</span>&nbsp;<span class="num" id="2883075">0</span>&nbsp;<span class="op" id="2883077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883083">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883097">i</span>&nbsp;<span class="op" id="2883099">+=</span>&nbsp;<span class="ident" id="2883102">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883106">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883110">if</span>&nbsp;<span class="ident" id="2883113">n</span>&nbsp;<span class="op" id="2883115">==</span>&nbsp;<span class="num" id="2883118">1</span>&nbsp;<span class="op" id="2883120">||</span>&nbsp;<span class="ident" id="2883123">Equal</span><span class="op" id="2883128">(</span><span class="ident" id="2883129">s</span><span class="op" id="2883130">[</span><span class="ident" id="2883131">i</span><span class="op" id="2883132">:</span><span class="ident" id="2883133">i</span><span class="op" id="2883134">+</span><span class="ident" id="2883135">n</span><span class="op" id="2883136">]</span><span class="op" id="2883137">,</span>&nbsp;<span class="ident" id="2883139">sep</span><span class="op" id="2883142">)</span>&nbsp;<span class="op" id="2883144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883149">count</span><span class="op" id="2883154">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883160">i</span>&nbsp;<span class="op" id="2883162">+=</span>&nbsp;<span class="ident" id="2883165">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883170">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883181">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883185">i</span><span class="op" id="2883186">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883193">return</span>&nbsp;<span class="ident" id="2883200">count</span><br>
<span class="lineno"></span><span class="op" id="2883206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2883209">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;subslice&nbsp;is&nbsp;within&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="2883259">func</span>&nbsp;<span class="ident" id="2883264">Contains</span><span class="op" id="2883272">(</span><span class="ident" id="2883273">b</span><span class="op" id="2883274">,</span>&nbsp;<span class="ident" id="2883276">subslice</span>&nbsp;<span class="op" id="2883285">[</span><span class="op" id="2883286">]</span><span class="builtintype" id="2883287">byte</span><span class="op" id="2883291">)</span>&nbsp;<span class="builtintype" id="2883293">bool</span>&nbsp;<span class="op" id="2883298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883301">return</span>&nbsp;<span class="ident" id="2883308">Index</span><span class="op" id="2883313">(</span><span class="ident" id="2883314">b</span><span class="op" id="2883315">,</span>&nbsp;<span class="ident" id="2883317">subslice</span><span class="op" id="2883325">)</span>&nbsp;<span class="op" id="2883327">!=</span>&nbsp;<span class="op" id="2883330">-</span><span class="num" id="2883331">1</span><br>
<span class="lineno"></span><span class="op" id="2883333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="2883336">//&nbsp;Index&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="2883432">func</span>&nbsp;<span class="ident" id="2883437">Index</span><span class="op" id="2883442">(</span><span class="ident" id="2883443">s</span><span class="op" id="2883444">,</span>&nbsp;<span class="ident" id="2883446">sep</span>&nbsp;<span class="op" id="2883450">[</span><span class="op" id="2883451">]</span><span class="builtintype" id="2883452">byte</span><span class="op" id="2883456">)</span>&nbsp;<span class="builtintype" id="2883458">int</span>&nbsp;<span class="op" id="2883462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883465">n</span>&nbsp;<span class="op" id="2883467">:=</span>&nbsp;<span class="builtinfunc" id="2883470">len</span><span class="op" id="2883473">(</span><span class="ident" id="2883474">sep</span><span class="op" id="2883477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883480">if</span>&nbsp;<span class="ident" id="2883483">n</span>&nbsp;<span class="op" id="2883485">==</span>&nbsp;<span class="num" id="2883488">0</span>&nbsp;<span class="op" id="2883490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883494">return</span>&nbsp;<span class="num" id="2883501">0</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883507">if</span>&nbsp;<span class="ident" id="2883510">n</span>&nbsp;<span class="op" id="2883512">&gt;</span>&nbsp;<span class="builtinfunc" id="2883514">len</span><span class="op" id="2883517">(</span><span class="ident" id="2883518">s</span><span class="op" id="2883519">)</span>&nbsp;<span class="op" id="2883521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883525">return</span>&nbsp;<span class="op" id="2883532">-</span><span class="num" id="2883533">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883539">c</span>&nbsp;<span class="op" id="2883541">:=</span>&nbsp;<span class="ident" id="2883544">sep</span><span class="op" id="2883547">[</span><span class="num" id="2883548">0</span><span class="op" id="2883549">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883552">if</span>&nbsp;<span class="ident" id="2883555">n</span>&nbsp;<span class="op" id="2883557">==</span>&nbsp;<span class="num" id="2883560">1</span>&nbsp;<span class="op" id="2883562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883566">return</span>&nbsp;<span class="ident" id="2883573">IndexByte</span><span class="op" id="2883582">(</span><span class="ident" id="2883583">s</span><span class="op" id="2883584">,</span>&nbsp;<span class="ident" id="2883586">c</span><span class="op" id="2883587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883593">i</span>&nbsp;<span class="op" id="2883595">:=</span>&nbsp;<span class="num" id="2883598">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883601">t</span>&nbsp;<span class="op" id="2883603">:=</span>&nbsp;<span class="ident" id="2883606">s</span><span class="op" id="2883607">[</span><span class="op" id="2883608">:</span><span class="builtinfunc" id="2883609">len</span><span class="op" id="2883612">(</span><span class="ident" id="2883613">s</span><span class="op" id="2883614">)</span><span class="op" id="2883615">-</span><span class="ident" id="2883616">n</span><span class="op" id="2883617">+</span><span class="num" id="2883618">1</span><span class="op" id="2883619">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883622">for</span>&nbsp;<span class="ident" id="2883626">i</span>&nbsp;<span class="op" id="2883628">&lt;</span>&nbsp;<span class="builtinfunc" id="2883630">len</span><span class="op" id="2883633">(</span><span class="ident" id="2883634">t</span><span class="op" id="2883635">)</span>&nbsp;<span class="op" id="2883637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883641">if</span>&nbsp;<span class="ident" id="2883644">t</span><span class="op" id="2883645">[</span><span class="ident" id="2883646">i</span><span class="op" id="2883647">]</span>&nbsp;<span class="op" id="2883649">!=</span>&nbsp;<span class="ident" id="2883652">c</span>&nbsp;<span class="op" id="2883654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883659">o</span>&nbsp;<span class="op" id="2883661">:=</span>&nbsp;<span class="ident" id="2883664">IndexByte</span><span class="op" id="2883673">(</span><span class="ident" id="2883674">t</span><span class="op" id="2883675">[</span><span class="ident" id="2883676">i</span><span class="op" id="2883677">:</span><span class="op" id="2883678">]</span><span class="op" id="2883679">,</span>&nbsp;<span class="ident" id="2883681">c</span><span class="op" id="2883682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883687">if</span>&nbsp;<span class="ident" id="2883690">o</span>&nbsp;<span class="op" id="2883692">&lt;</span>&nbsp;<span class="num" id="2883694">0</span>&nbsp;<span class="op" id="2883696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883702">break</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883716">i</span>&nbsp;<span class="op" id="2883718">+=</span>&nbsp;<span class="ident" id="2883721">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883729">if</span>&nbsp;<span class="ident" id="2883732">Equal</span><span class="op" id="2883737">(</span><span class="ident" id="2883738">s</span><span class="op" id="2883739">[</span><span class="ident" id="2883740">i</span><span class="op" id="2883741">:</span><span class="ident" id="2883742">i</span><span class="op" id="2883743">+</span><span class="ident" id="2883744">n</span><span class="op" id="2883745">]</span><span class="op" id="2883746">,</span>&nbsp;<span class="ident" id="2883748">sep</span><span class="op" id="2883751">)</span>&nbsp;<span class="op" id="2883753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883758">return</span>&nbsp;<span class="ident" id="2883765">i</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2883773">i</span><span class="op" id="2883774">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883781">return</span>&nbsp;<span class="op" id="2883788">-</span><span class="num" id="2883789">1</span><br>
<span class="lineno"></span><span class="op" id="2883791">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="2883794">func</span>&nbsp;<span class="ident" id="2883799">indexBytePortable</span><span class="op" id="2883816">(</span><span class="ident" id="2883817">s</span>&nbsp;<span class="op" id="2883819">[</span><span class="op" id="2883820">]</span><span class="builtintype" id="2883821">byte</span><span class="op" id="2883825">,</span>&nbsp;<span class="ident" id="2883827">c</span>&nbsp;<span class="builtintype" id="2883829">byte</span><span class="op" id="2883833">)</span>&nbsp;<span class="builtintype" id="2883835">int</span>&nbsp;<span class="op" id="2883839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883842">for</span>&nbsp;<span class="ident" id="2883846">i</span><span class="op" id="2883847">,</span>&nbsp;<span class="ident" id="2883849">b</span>&nbsp;<span class="op" id="2883851">:=</span>&nbsp;<span class="keyword" id="2883854">range</span>&nbsp;<span class="ident" id="2883860">s</span>&nbsp;<span class="op" id="2883862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883866">if</span>&nbsp;<span class="ident" id="2883869">b</span>&nbsp;<span class="op" id="2883871">==</span>&nbsp;<span class="ident" id="2883874">c</span>&nbsp;<span class="op" id="2883876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883881">return</span>&nbsp;<span class="ident" id="2883888">i</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2883895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2883898">return</span>&nbsp;<span class="op" id="2883905">-</span><span class="num" id="2883906">1</span><br>
<span class="lineno"></span><span class="op" id="2883908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2883911">//&nbsp;LastIndex&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="2884010">func</span>&nbsp;<span class="ident" id="2884015">LastIndex</span><span class="op" id="2884024">(</span><span class="ident" id="2884025">s</span><span class="op" id="2884026">,</span>&nbsp;<span class="ident" id="2884028">sep</span>&nbsp;<span class="op" id="2884032">[</span><span class="op" id="2884033">]</span><span class="builtintype" id="2884034">byte</span><span class="op" id="2884038">)</span>&nbsp;<span class="builtintype" id="2884040">int</span>&nbsp;<span class="op" id="2884044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884047">n</span>&nbsp;<span class="op" id="2884049">:=</span>&nbsp;<span class="builtinfunc" id="2884052">len</span><span class="op" id="2884055">(</span><span class="ident" id="2884056">sep</span><span class="op" id="2884059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884062">if</span>&nbsp;<span class="ident" id="2884065">n</span>&nbsp;<span class="op" id="2884067">==</span>&nbsp;<span class="num" id="2884070">0</span>&nbsp;<span class="op" id="2884072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884076">return</span>&nbsp;<span class="builtinfunc" id="2884083">len</span><span class="op" id="2884086">(</span><span class="ident" id="2884087">s</span><span class="op" id="2884088">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2884091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884094">c</span>&nbsp;<span class="op" id="2884096">:=</span>&nbsp;<span class="ident" id="2884099">sep</span><span class="op" id="2884102">[</span><span class="num" id="2884103">0</span><span class="op" id="2884104">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884107">for</span>&nbsp;<span class="ident" id="2884111">i</span>&nbsp;<span class="op" id="2884113">:=</span>&nbsp;<span class="builtinfunc" id="2884116">len</span><span class="op" id="2884119">(</span><span class="ident" id="2884120">s</span><span class="op" id="2884121">)</span>&nbsp;<span class="op" id="2884123">-</span>&nbsp;<span class="ident" id="2884125">n</span><span class="op" id="2884126">;</span>&nbsp;<span class="ident" id="2884128">i</span>&nbsp;<span class="op" id="2884130">&gt;=</span>&nbsp;<span class="num" id="2884133">0</span><span class="op" id="2884134">;</span>&nbsp;<span class="ident" id="2884136">i</span><span class="op" id="2884137">--</span>&nbsp;<span class="op" id="2884140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884144">if</span>&nbsp;<span class="ident" id="2884147">s</span><span class="op" id="2884148">[</span><span class="ident" id="2884149">i</span><span class="op" id="2884150">]</span>&nbsp;<span class="op" id="2884152">==</span>&nbsp;<span class="ident" id="2884155">c</span>&nbsp;<span class="op" id="2884157">&amp;&amp;</span>&nbsp;<span class="op" id="2884160">(</span><span class="ident" id="2884161">n</span>&nbsp;<span class="op" id="2884163">==</span>&nbsp;<span class="num" id="2884166">1</span>&nbsp;<span class="op" id="2884168">||</span>&nbsp;<span class="ident" id="2884171">Equal</span><span class="op" id="2884176">(</span><span class="ident" id="2884177">s</span><span class="op" id="2884178">[</span><span class="ident" id="2884179">i</span><span class="op" id="2884180">:</span><span class="ident" id="2884181">i</span><span class="op" id="2884182">+</span><span class="ident" id="2884183">n</span><span class="op" id="2884184">]</span><span class="op" id="2884185">,</span>&nbsp;<span class="ident" id="2884187">sep</span><span class="op" id="2884190">)</span><span class="op" id="2884191">)</span>&nbsp;<span class="op" id="2884193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884198">return</span>&nbsp;<span class="ident" id="2884205">i</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2884209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2884212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884215">return</span>&nbsp;<span class="op" id="2884222">-</span><span class="num" id="2884223">1</span><br>
<span class="lineno"></span><span class="op" id="2884225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="2884228">//&nbsp;IndexRune&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="2884306">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="2884383">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;rune&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="2884429">func</span>&nbsp;<span class="ident" id="2884434">IndexRune</span><span class="op" id="2884443">(</span><span class="ident" id="2884444">s</span>&nbsp;<span class="op" id="2884446">[</span><span class="op" id="2884447">]</span><span class="builtintype" id="2884448">byte</span><span class="op" id="2884452">,</span>&nbsp;<span class="ident" id="2884454">r</span>&nbsp;<span class="builtintype" id="2884456">rune</span><span class="op" id="2884460">)</span>&nbsp;<span class="builtintype" id="2884462">int</span>&nbsp;<span class="op" id="2884466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884469">for</span>&nbsp;<span class="ident" id="2884473">i</span>&nbsp;<span class="op" id="2884475">:=</span>&nbsp;<span class="num" id="2884478">0</span><span class="op" id="2884479">;</span>&nbsp;<span class="ident" id="2884481">i</span>&nbsp;<span class="op" id="2884483">&lt;</span>&nbsp;<span class="builtinfunc" id="2884485">len</span><span class="op" id="2884488">(</span><span class="ident" id="2884489">s</span><span class="op" id="2884490">)</span><span class="op" id="2884491">;</span>&nbsp;<span class="op" id="2884493">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884497">r1</span><span class="op" id="2884499">,</span>&nbsp;<span class="ident" id="2884501">size</span>&nbsp;<span class="op" id="2884506">:=</span>&nbsp;<span class="ident" id="2884509">utf8</span><span class="op" id="2884513">.</span><span class="ident" id="2884514">DecodeRune</span><span class="op" id="2884524">(</span><span class="ident" id="2884525">s</span><span class="op" id="2884526">[</span><span class="ident" id="2884527">i</span><span class="op" id="2884528">:</span><span class="op" id="2884529">]</span><span class="op" id="2884530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884534">if</span>&nbsp;<span class="ident" id="2884537">r</span>&nbsp;<span class="op" id="2884539">==</span>&nbsp;<span class="ident" id="2884542">r1</span>&nbsp;<span class="op" id="2884545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884550">return</span>&nbsp;<span class="ident" id="2884557">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2884561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884565">i</span>&nbsp;<span class="op" id="2884567">+=</span>&nbsp;<span class="ident" id="2884570">size</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2884576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884579">return</span>&nbsp;<span class="op" id="2884586">-</span><span class="num" id="2884587">1</span><br>
<span class="lineno"></span><span class="op" id="2884589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2884592">//&nbsp;IndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno">155</span><span class="comment" id="2884669">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of&nbsp;the&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="2884749">//&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="2884830">//&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="2884850">func</span>&nbsp;<span class="ident" id="2884855">IndexAny</span><span class="op" id="2884863">(</span><span class="ident" id="2884864">s</span>&nbsp;<span class="op" id="2884866">[</span><span class="op" id="2884867">]</span><span class="builtintype" id="2884868">byte</span><span class="op" id="2884872">,</span>&nbsp;<span class="ident" id="2884874">chars</span>&nbsp;<span class="builtintype" id="2884880">string</span><span class="op" id="2884886">)</span>&nbsp;<span class="builtintype" id="2884888">int</span>&nbsp;<span class="op" id="2884892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884895">if</span>&nbsp;<span class="builtinfunc" id="2884898">len</span><span class="op" id="2884901">(</span><span class="ident" id="2884902">chars</span><span class="op" id="2884907">)</span>&nbsp;<span class="op" id="2884909">&gt;</span>&nbsp;<span class="num" id="2884911">0</span>&nbsp;<span class="op" id="2884913">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884917">var</span>&nbsp;<span class="ident" id="2884921">r</span>&nbsp;<span class="builtintype" id="2884923">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884930">var</span>&nbsp;<span class="ident" id="2884934">width</span>&nbsp;<span class="builtintype" id="2884940">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2884946">for</span>&nbsp;<span class="ident" id="2884950">i</span>&nbsp;<span class="op" id="2884952">:=</span>&nbsp;<span class="num" id="2884955">0</span><span class="op" id="2884956">;</span>&nbsp;<span class="ident" id="2884958">i</span>&nbsp;<span class="op" id="2884960">&lt;</span>&nbsp;<span class="builtinfunc" id="2884962">len</span><span class="op" id="2884965">(</span><span class="ident" id="2884966">s</span><span class="op" id="2884967">)</span><span class="op" id="2884968">;</span>&nbsp;<span class="ident" id="2884970">i</span>&nbsp;<span class="op" id="2884972">+=</span>&nbsp;<span class="ident" id="2884975">width</span>&nbsp;<span class="op" id="2884981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2884986">r</span>&nbsp;<span class="op" id="2884988">=</span>&nbsp;<span class="builtintype" id="2884990">rune</span><span class="op" id="2884994">(</span><span class="ident" id="2884995">s</span><span class="op" id="2884996">[</span><span class="ident" id="2884997">i</span><span class="op" id="2884998">]</span><span class="op" id="2884999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885004">if</span>&nbsp;<span class="ident" id="2885007">r</span>&nbsp;<span class="op" id="2885009">&lt;</span>&nbsp;<span class="ident" id="2885011">utf8</span><span class="op" id="2885015">.</span><span class="ident" id="2885016">RuneSelf</span>&nbsp;<span class="op" id="2885025">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885031">width</span>&nbsp;<span class="op" id="2885037">=</span>&nbsp;<span class="num" id="2885039">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885044">}</span>&nbsp;<span class="keyword" id="2885046">else</span>&nbsp;<span class="op" id="2885051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885057">r</span><span class="op" id="2885058">,</span>&nbsp;<span class="ident" id="2885060">width</span>&nbsp;<span class="op" id="2885066">=</span>&nbsp;<span class="ident" id="2885068">utf8</span><span class="op" id="2885072">.</span><span class="ident" id="2885073">DecodeRune</span><span class="op" id="2885083">(</span><span class="ident" id="2885084">s</span><span class="op" id="2885085">[</span><span class="ident" id="2885086">i</span><span class="op" id="2885087">:</span><span class="op" id="2885088">]</span><span class="op" id="2885089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885099">for</span>&nbsp;<span class="ident" id="2885103">_</span><span class="op" id="2885104">,</span>&nbsp;<span class="ident" id="2885106">ch</span>&nbsp;<span class="op" id="2885109">:=</span>&nbsp;<span class="keyword" id="2885112">range</span>&nbsp;<span class="ident" id="2885118">chars</span>&nbsp;<span class="op" id="2885124">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885130">if</span>&nbsp;<span class="ident" id="2885133">r</span>&nbsp;<span class="op" id="2885135">==</span>&nbsp;<span class="ident" id="2885138">ch</span>&nbsp;<span class="op" id="2885141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885148">return</span>&nbsp;<span class="ident" id="2885155">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885170">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885176">return</span>&nbsp;<span class="op" id="2885183">-</span><span class="num" id="2885184">1</span><br>
<span class="lineno"></span><span class="op" id="2885186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2885189">//&nbsp;LastIndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code</span><br>
<span class="lineno">180</span><span class="comment" id="2885262">//&nbsp;points.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2885338">//&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2885414">//&nbsp;there&nbsp;is&nbsp;no&nbsp;code&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="2885451">func</span>&nbsp;<span class="ident" id="2885456">LastIndexAny</span><span class="op" id="2885468">(</span><span class="ident" id="2885469">s</span>&nbsp;<span class="op" id="2885471">[</span><span class="op" id="2885472">]</span><span class="builtintype" id="2885473">byte</span><span class="op" id="2885477">,</span>&nbsp;<span class="ident" id="2885479">chars</span>&nbsp;<span class="builtintype" id="2885485">string</span><span class="op" id="2885491">)</span>&nbsp;<span class="builtintype" id="2885493">int</span>&nbsp;<span class="op" id="2885497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885500">if</span>&nbsp;<span class="builtinfunc" id="2885503">len</span><span class="op" id="2885506">(</span><span class="ident" id="2885507">chars</span><span class="op" id="2885512">)</span>&nbsp;<span class="op" id="2885514">&gt;</span>&nbsp;<span class="num" id="2885516">0</span>&nbsp;<span class="op" id="2885518">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885522">for</span>&nbsp;<span class="ident" id="2885526">i</span>&nbsp;<span class="op" id="2885528">:=</span>&nbsp;<span class="builtinfunc" id="2885531">len</span><span class="op" id="2885534">(</span><span class="ident" id="2885535">s</span><span class="op" id="2885536">)</span><span class="op" id="2885537">;</span>&nbsp;<span class="ident" id="2885539">i</span>&nbsp;<span class="op" id="2885541">&gt;</span>&nbsp;<span class="num" id="2885543">0</span><span class="op" id="2885544">;</span>&nbsp;<span class="op" id="2885546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885551">r</span><span class="op" id="2885552">,</span>&nbsp;<span class="ident" id="2885554">size</span>&nbsp;<span class="op" id="2885559">:=</span>&nbsp;<span class="ident" id="2885562">utf8</span><span class="op" id="2885566">.</span><span class="ident" id="2885567">DecodeLastRune</span><span class="op" id="2885581">(</span><span class="ident" id="2885582">s</span><span class="op" id="2885583">[</span><span class="num" id="2885584">0</span><span class="op" id="2885585">:</span><span class="ident" id="2885586">i</span><span class="op" id="2885587">]</span><span class="op" id="2885588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885593">i</span>&nbsp;<span class="op" id="2885595">-=</span>&nbsp;<span class="ident" id="2885598">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885606">for</span>&nbsp;<span class="ident" id="2885610">_</span><span class="op" id="2885611">,</span>&nbsp;<span class="ident" id="2885613">ch</span>&nbsp;<span class="op" id="2885616">:=</span>&nbsp;<span class="keyword" id="2885619">range</span>&nbsp;<span class="ident" id="2885625">chars</span>&nbsp;<span class="op" id="2885631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885637">if</span>&nbsp;<span class="ident" id="2885640">r</span>&nbsp;<span class="op" id="2885642">==</span>&nbsp;<span class="ident" id="2885645">ch</span>&nbsp;<span class="op" id="2885648">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885655">return</span>&nbsp;<span class="ident" id="2885662">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885680">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885683">return</span>&nbsp;<span class="op" id="2885690">-</span><span class="num" id="2885691">1</span><br>
<span class="lineno"></span><span class="op" id="2885693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2885696">//&nbsp;Generic&nbsp;split:&nbsp;splits&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep,</span><br>
<span class="lineno"></span><span class="comment" id="2885749">//&nbsp;including&nbsp;sepSave&nbsp;bytes&nbsp;of&nbsp;sep&nbsp;in&nbsp;the&nbsp;subslices.</span><br>
<span class="lineno">200</span><span class="keyword" id="2885801">func</span>&nbsp;<span class="ident" id="2885806">genSplit</span><span class="op" id="2885814">(</span><span class="ident" id="2885815">s</span><span class="op" id="2885816">,</span>&nbsp;<span class="ident" id="2885818">sep</span>&nbsp;<span class="op" id="2885822">[</span><span class="op" id="2885823">]</span><span class="builtintype" id="2885824">byte</span><span class="op" id="2885828">,</span>&nbsp;<span class="ident" id="2885830">sepSave</span><span class="op" id="2885837">,</span>&nbsp;<span class="ident" id="2885839">n</span>&nbsp;<span class="builtintype" id="2885841">int</span><span class="op" id="2885844">)</span>&nbsp;<span class="op" id="2885846">[</span><span class="op" id="2885847">]</span><span class="op" id="2885848">[</span><span class="op" id="2885849">]</span><span class="builtintype" id="2885850">byte</span>&nbsp;<span class="op" id="2885855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885858">if</span>&nbsp;<span class="ident" id="2885861">n</span>&nbsp;<span class="op" id="2885863">==</span>&nbsp;<span class="num" id="2885866">0</span>&nbsp;<span class="op" id="2885868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885872">return</span>&nbsp;<span class="ident" id="2885879">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885887">if</span>&nbsp;<span class="builtinfunc" id="2885890">len</span><span class="op" id="2885893">(</span><span class="ident" id="2885894">sep</span><span class="op" id="2885897">)</span>&nbsp;<span class="op" id="2885899">==</span>&nbsp;<span class="num" id="2885902">0</span>&nbsp;<span class="op" id="2885904">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885908">return</span>&nbsp;<span class="ident" id="2885915">explode</span><span class="op" id="2885922">(</span><span class="ident" id="2885923">s</span><span class="op" id="2885924">,</span>&nbsp;<span class="ident" id="2885926">n</span><span class="op" id="2885927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2885933">if</span>&nbsp;<span class="ident" id="2885936">n</span>&nbsp;<span class="op" id="2885938">&lt;</span>&nbsp;<span class="num" id="2885940">0</span>&nbsp;<span class="op" id="2885942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885946">n</span>&nbsp;<span class="op" id="2885948">=</span>&nbsp;<span class="ident" id="2885950">Count</span><span class="op" id="2885955">(</span><span class="ident" id="2885956">s</span><span class="op" id="2885957">,</span>&nbsp;<span class="ident" id="2885959">sep</span><span class="op" id="2885962">)</span>&nbsp;<span class="op" id="2885964">+</span>&nbsp;<span class="num" id="2885966">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2885969">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885972">c</span>&nbsp;<span class="op" id="2885974">:=</span>&nbsp;<span class="ident" id="2885977">sep</span><span class="op" id="2885980">[</span><span class="num" id="2885981">0</span><span class="op" id="2885982">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885985">start</span>&nbsp;<span class="op" id="2885991">:=</span>&nbsp;<span class="num" id="2885994">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2885997">a</span>&nbsp;<span class="op" id="2885999">:=</span>&nbsp;<span class="builtinfunc" id="2886002">make</span><span class="op" id="2886006">(</span><span class="op" id="2886007">[</span><span class="op" id="2886008">]</span><span class="op" id="2886009">[</span><span class="op" id="2886010">]</span><span class="builtintype" id="2886011">byte</span><span class="op" id="2886015">,</span>&nbsp;<span class="ident" id="2886017">n</span><span class="op" id="2886018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886021">na</span>&nbsp;<span class="op" id="2886024">:=</span>&nbsp;<span class="num" id="2886027">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2886030">for</span>&nbsp;<span class="ident" id="2886034">i</span>&nbsp;<span class="op" id="2886036">:=</span>&nbsp;<span class="num" id="2886039">0</span><span class="op" id="2886040">;</span>&nbsp;<span class="ident" id="2886042">i</span><span class="op" id="2886043">+</span><span class="builtinfunc" id="2886044">len</span><span class="op" id="2886047">(</span><span class="ident" id="2886048">sep</span><span class="op" id="2886051">)</span>&nbsp;<span class="op" id="2886053">&lt;=</span>&nbsp;<span class="builtinfunc" id="2886056">len</span><span class="op" id="2886059">(</span><span class="ident" id="2886060">s</span><span class="op" id="2886061">)</span>&nbsp;<span class="op" id="2886063">&amp;&amp;</span>&nbsp;<span class="ident" id="2886066">na</span><span class="op" id="2886068">+</span><span class="num" id="2886069">1</span>&nbsp;<span class="op" id="2886071">&lt;</span>&nbsp;<span class="ident" id="2886073">n</span><span class="op" id="2886074">;</span>&nbsp;<span class="ident" id="2886076">i</span><span class="op" id="2886077">++</span>&nbsp;<span class="op" id="2886080">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2886084">if</span>&nbsp;<span class="ident" id="2886087">s</span><span class="op" id="2886088">[</span><span class="ident" id="2886089">i</span><span class="op" id="2886090">]</span>&nbsp;<span class="op" id="2886092">==</span>&nbsp;<span class="ident" id="2886095">c</span>&nbsp;<span class="op" id="2886097">&amp;&amp;</span>&nbsp;<span class="op" id="2886100">(</span><span class="builtinfunc" id="2886101">len</span><span class="op" id="2886104">(</span><span class="ident" id="2886105">sep</span><span class="op" id="2886108">)</span>&nbsp;<span class="op" id="2886110">==</span>&nbsp;<span class="num" id="2886113">1</span>&nbsp;<span class="op" id="2886115">||</span>&nbsp;<span class="ident" id="2886118">Equal</span><span class="op" id="2886123">(</span><span class="ident" id="2886124">s</span><span class="op" id="2886125">[</span><span class="ident" id="2886126">i</span><span class="op" id="2886127">:</span><span class="ident" id="2886128">i</span><span class="op" id="2886129">+</span><span class="builtinfunc" id="2886130">len</span><span class="op" id="2886133">(</span><span class="ident" id="2886134">sep</span><span class="op" id="2886137">)</span><span class="op" id="2886138">]</span><span class="op" id="2886139">,</span>&nbsp;<span class="ident" id="2886141">sep</span><span class="op" id="2886144">)</span><span class="op" id="2886145">)</span>&nbsp;<span class="op" id="2886147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886152">a</span><span class="op" id="2886153">[</span><span class="ident" id="2886154">na</span><span class="op" id="2886156">]</span>&nbsp;<span class="op" id="2886158">=</span>&nbsp;<span class="ident" id="2886160">s</span><span class="op" id="2886161">[</span><span class="ident" id="2886162">start</span>&nbsp;<span class="op" id="2886168">:</span>&nbsp;<span class="ident" id="2886170">i</span><span class="op" id="2886171">+</span><span class="ident" id="2886172">sepSave</span><span class="op" id="2886179">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886184">na</span><span class="op" id="2886186">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886192">start</span>&nbsp;<span class="op" id="2886198">=</span>&nbsp;<span class="ident" id="2886200">i</span>&nbsp;<span class="op" id="2886202">+</span>&nbsp;<span class="builtinfunc" id="2886204">len</span><span class="op" id="2886207">(</span><span class="ident" id="2886208">sep</span><span class="op" id="2886211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886216">i</span>&nbsp;<span class="op" id="2886218">+=</span>&nbsp;<span class="builtinfunc" id="2886221">len</span><span class="op" id="2886224">(</span><span class="ident" id="2886225">sep</span><span class="op" id="2886228">)</span>&nbsp;<span class="op" id="2886230">-</span>&nbsp;<span class="num" id="2886232">1</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2886236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2886239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2886242">a</span><span class="op" id="2886243">[</span><span class="ident" id="2886244">na</span><span class="op" id="2886246">]</span>&nbsp;<span class="op" id="2886248">=</span>&nbsp;<span class="ident" id="2886250">s</span><span class="op" id="2886251">[</span><span class="ident" id="2886252">start</span><span class="op" id="2886257">:</span><span class="op" id="2886258">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2886261">return</span>&nbsp;<span class="ident" id="2886268">a</span><span class="op" id="2886269">[</span><span class="num" id="2886270">0</span>&nbsp;<span class="op" id="2886272">:</span>&nbsp;<span class="ident" id="2886274">na</span><span class="op" id="2886276">+</span><span class="num" id="2886277">1</span><span class="op" id="2886278">]</span><br>
<span class="lineno"></span><span class="op" id="2886280">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="2886283">//&nbsp;SplitN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2886357">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="2886400">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="2886461">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno">230</span><span class="comment" id="2886520">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="2886602">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="2886650">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="2886676">func</span>&nbsp;<span class="ident" id="2886681">SplitN</span><span class="op" id="2886687">(</span><span class="ident" id="2886688">s</span><span class="op" id="2886689">,</span>&nbsp;<span class="ident" id="2886691">sep</span>&nbsp;<span class="op" id="2886695">[</span><span class="op" id="2886696">]</span><span class="builtintype" id="2886697">byte</span><span class="op" id="2886701">,</span>&nbsp;<span class="ident" id="2886703">n</span>&nbsp;<span class="builtintype" id="2886705">int</span><span class="op" id="2886708">)</span>&nbsp;<span class="op" id="2886710">[</span><span class="op" id="2886711">]</span><span class="op" id="2886712">[</span><span class="op" id="2886713">]</span><span class="builtintype" id="2886714">byte</span>&nbsp;<span class="op" id="2886719">{</span>&nbsp;<span class="keyword" id="2886721">return</span>&nbsp;<span class="ident" id="2886728">genSplit</span><span class="op" id="2886736">(</span><span class="ident" id="2886737">s</span><span class="op" id="2886738">,</span>&nbsp;<span class="ident" id="2886740">sep</span><span class="op" id="2886743">,</span>&nbsp;<span class="num" id="2886745">0</span><span class="op" id="2886746">,</span>&nbsp;<span class="ident" id="2886748">n</span><span class="op" id="2886749">)</span>&nbsp;<span class="op" id="2886751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="2886754">//&nbsp;SplitAfterN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2886824">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="2886863">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfterN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="2886929">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno"></span><span class="comment" id="2886988">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno">240</span><span class="comment" id="2887070">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="2887118">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="2887144">func</span>&nbsp;<span class="ident" id="2887149">SplitAfterN</span><span class="op" id="2887160">(</span><span class="ident" id="2887161">s</span><span class="op" id="2887162">,</span>&nbsp;<span class="ident" id="2887164">sep</span>&nbsp;<span class="op" id="2887168">[</span><span class="op" id="2887169">]</span><span class="builtintype" id="2887170">byte</span><span class="op" id="2887174">,</span>&nbsp;<span class="ident" id="2887176">n</span>&nbsp;<span class="builtintype" id="2887178">int</span><span class="op" id="2887181">)</span>&nbsp;<span class="op" id="2887183">[</span><span class="op" id="2887184">]</span><span class="op" id="2887185">[</span><span class="op" id="2887186">]</span><span class="builtintype" id="2887187">byte</span>&nbsp;<span class="op" id="2887192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887195">return</span>&nbsp;<span class="ident" id="2887202">genSplit</span><span class="op" id="2887210">(</span><span class="ident" id="2887211">s</span><span class="op" id="2887212">,</span>&nbsp;<span class="ident" id="2887214">sep</span><span class="op" id="2887217">,</span>&nbsp;<span class="builtinfunc" id="2887219">len</span><span class="op" id="2887222">(</span><span class="ident" id="2887223">sep</span><span class="op" id="2887226">)</span><span class="op" id="2887227">,</span>&nbsp;<span class="ident" id="2887229">n</span><span class="op" id="2887230">)</span><br>
<span class="lineno"></span><span class="op" id="2887232">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="2887235">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2887312">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="2887355">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;Split&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="2887415">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno">250</span><span class="keyword" id="2887465">func</span>&nbsp;<span class="ident" id="2887470">Split</span><span class="op" id="2887475">(</span><span class="ident" id="2887476">s</span><span class="op" id="2887477">,</span>&nbsp;<span class="ident" id="2887479">sep</span>&nbsp;<span class="op" id="2887483">[</span><span class="op" id="2887484">]</span><span class="builtintype" id="2887485">byte</span><span class="op" id="2887489">)</span>&nbsp;<span class="op" id="2887491">[</span><span class="op" id="2887492">]</span><span class="op" id="2887493">[</span><span class="op" id="2887494">]</span><span class="builtintype" id="2887495">byte</span>&nbsp;<span class="op" id="2887500">{</span>&nbsp;<span class="keyword" id="2887502">return</span>&nbsp;<span class="ident" id="2887509">genSplit</span><span class="op" id="2887517">(</span><span class="ident" id="2887518">s</span><span class="op" id="2887519">,</span>&nbsp;<span class="ident" id="2887521">sep</span><span class="op" id="2887524">,</span>&nbsp;<span class="num" id="2887526">0</span><span class="op" id="2887527">,</span>&nbsp;<span class="op" id="2887529">-</span><span class="num" id="2887530">1</span><span class="op" id="2887531">)</span>&nbsp;<span class="op" id="2887533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2887536">//&nbsp;SplitAfter&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2887609">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="2887648">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfter&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno">255</span><span class="comment" id="2887713">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitAfterN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="2887768">func</span>&nbsp;<span class="ident" id="2887773">SplitAfter</span><span class="op" id="2887783">(</span><span class="ident" id="2887784">s</span><span class="op" id="2887785">,</span>&nbsp;<span class="ident" id="2887787">sep</span>&nbsp;<span class="op" id="2887791">[</span><span class="op" id="2887792">]</span><span class="builtintype" id="2887793">byte</span><span class="op" id="2887797">)</span>&nbsp;<span class="op" id="2887799">[</span><span class="op" id="2887800">]</span><span class="op" id="2887801">[</span><span class="op" id="2887802">]</span><span class="builtintype" id="2887803">byte</span>&nbsp;<span class="op" id="2887808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2887811">return</span>&nbsp;<span class="ident" id="2887818">genSplit</span><span class="op" id="2887826">(</span><span class="ident" id="2887827">s</span><span class="op" id="2887828">,</span>&nbsp;<span class="ident" id="2887830">sep</span><span class="op" id="2887833">,</span>&nbsp;<span class="builtinfunc" id="2887835">len</span><span class="op" id="2887838">(</span><span class="ident" id="2887839">sep</span><span class="op" id="2887842">)</span><span class="op" id="2887843">,</span>&nbsp;<span class="op" id="2887845">-</span><span class="num" id="2887846">1</span><span class="op" id="2887847">)</span><br>
<span class="lineno"></span><span class="op" id="2887849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="2887852">//&nbsp;Fields&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="2887941">//&nbsp;characters,&nbsp;returning&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="2888041">func</span>&nbsp;<span class="ident" id="2888046">Fields</span><span class="op" id="2888052">(</span><span class="ident" id="2888053">s</span>&nbsp;<span class="op" id="2888055">[</span><span class="op" id="2888056">]</span><span class="builtintype" id="2888057">byte</span><span class="op" id="2888061">)</span>&nbsp;<span class="op" id="2888063">[</span><span class="op" id="2888064">]</span><span class="op" id="2888065">[</span><span class="op" id="2888066">]</span><span class="builtintype" id="2888067">byte</span>&nbsp;<span class="op" id="2888072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888075">return</span>&nbsp;<span class="ident" id="2888082">FieldsFunc</span><span class="op" id="2888092">(</span><span class="ident" id="2888093">s</span><span class="op" id="2888094">,</span>&nbsp;<span class="ident" id="2888096">unicode</span><span class="op" id="2888103">.</span><span class="ident" id="2888104">IsSpace</span><span class="op" id="2888111">)</span><br>
<span class="lineno"></span><span class="op" id="2888113">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="comment" id="2888116">//&nbsp;FieldsFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="2888195">//&nbsp;It&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;at&nbsp;each&nbsp;run&nbsp;of&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2888269">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;all&nbsp;code&nbsp;points&nbsp;in&nbsp;s&nbsp;satisfy&nbsp;f(c),&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2888349">//&nbsp;len(s)&nbsp;==&nbsp;0,&nbsp;an&nbsp;empty&nbsp;slice&nbsp;is&nbsp;returned.</span><br>
<span class="lineno">270</span><span class="comment" id="2888393">//&nbsp;FieldsFunc&nbsp;makes&nbsp;no&nbsp;guarantees&nbsp;about&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;it&nbsp;calls&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="comment" id="2888467">//&nbsp;If&nbsp;f&nbsp;does&nbsp;not&nbsp;return&nbsp;consistent&nbsp;results&nbsp;for&nbsp;a&nbsp;given&nbsp;c,&nbsp;FieldsFunc&nbsp;may&nbsp;crash.</span><br>
<span class="lineno"></span><span class="keyword" id="2888547">func</span>&nbsp;<span class="ident" id="2888552">FieldsFunc</span><span class="op" id="2888562">(</span><span class="ident" id="2888563">s</span>&nbsp;<span class="op" id="2888565">[</span><span class="op" id="2888566">]</span><span class="builtintype" id="2888567">byte</span><span class="op" id="2888571">,</span>&nbsp;<span class="ident" id="2888573">f</span>&nbsp;<span class="keyword" id="2888575">func</span><span class="op" id="2888579">(</span><span class="builtintype" id="2888580">rune</span><span class="op" id="2888584">)</span>&nbsp;<span class="builtintype" id="2888586">bool</span><span class="op" id="2888590">)</span>&nbsp;<span class="op" id="2888592">[</span><span class="op" id="2888593">]</span><span class="op" id="2888594">[</span><span class="op" id="2888595">]</span><span class="builtintype" id="2888596">byte</span>&nbsp;<span class="op" id="2888601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888604">n</span>&nbsp;<span class="op" id="2888606">:=</span>&nbsp;<span class="num" id="2888609">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888612">inField</span>&nbsp;<span class="op" id="2888620">:=</span>&nbsp;<span class="builtintype" id="2888623">false</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888630">for</span>&nbsp;<span class="ident" id="2888634">i</span>&nbsp;<span class="op" id="2888636">:=</span>&nbsp;<span class="num" id="2888639">0</span><span class="op" id="2888640">;</span>&nbsp;<span class="ident" id="2888642">i</span>&nbsp;<span class="op" id="2888644">&lt;</span>&nbsp;<span class="builtinfunc" id="2888646">len</span><span class="op" id="2888649">(</span><span class="ident" id="2888650">s</span><span class="op" id="2888651">)</span><span class="op" id="2888652">;</span>&nbsp;<span class="op" id="2888654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888658">r</span><span class="op" id="2888659">,</span>&nbsp;<span class="ident" id="2888661">size</span>&nbsp;<span class="op" id="2888666">:=</span>&nbsp;<span class="ident" id="2888669">utf8</span><span class="op" id="2888673">.</span><span class="ident" id="2888674">DecodeRune</span><span class="op" id="2888684">(</span><span class="ident" id="2888685">s</span><span class="op" id="2888686">[</span><span class="ident" id="2888687">i</span><span class="op" id="2888688">:</span><span class="op" id="2888689">]</span><span class="op" id="2888690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888694">wasInField</span>&nbsp;<span class="op" id="2888705">:=</span>&nbsp;<span class="ident" id="2888708">inField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888718">inField</span>&nbsp;<span class="op" id="2888726">=</span>&nbsp;<span class="op" id="2888728">!</span><span class="ident" id="2888729">f</span><span class="op" id="2888730">(</span><span class="ident" id="2888731">r</span><span class="op" id="2888732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888736">if</span>&nbsp;<span class="ident" id="2888739">inField</span>&nbsp;<span class="op" id="2888747">&amp;&amp;</span>&nbsp;<span class="op" id="2888750">!</span><span class="ident" id="2888751">wasInField</span>&nbsp;<span class="op" id="2888762">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888767">n</span><span class="op" id="2888768">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2888773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888777">i</span>&nbsp;<span class="op" id="2888779">+=</span>&nbsp;<span class="ident" id="2888782">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2888788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888792">a</span>&nbsp;<span class="op" id="2888794">:=</span>&nbsp;<span class="builtinfunc" id="2888797">make</span><span class="op" id="2888801">(</span><span class="op" id="2888802">[</span><span class="op" id="2888803">]</span><span class="op" id="2888804">[</span><span class="op" id="2888805">]</span><span class="builtintype" id="2888806">byte</span><span class="op" id="2888810">,</span>&nbsp;<span class="ident" id="2888812">n</span><span class="op" id="2888813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888816">na</span>&nbsp;<span class="op" id="2888819">:=</span>&nbsp;<span class="num" id="2888822">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888825">fieldStart</span>&nbsp;<span class="op" id="2888836">:=</span>&nbsp;<span class="op" id="2888839">-</span><span class="num" id="2888840">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888843">for</span>&nbsp;<span class="ident" id="2888847">i</span>&nbsp;<span class="op" id="2888849">:=</span>&nbsp;<span class="num" id="2888852">0</span><span class="op" id="2888853">;</span>&nbsp;<span class="ident" id="2888855">i</span>&nbsp;<span class="op" id="2888857">&lt;=</span>&nbsp;<span class="builtinfunc" id="2888860">len</span><span class="op" id="2888863">(</span><span class="ident" id="2888864">s</span><span class="op" id="2888865">)</span>&nbsp;<span class="op" id="2888867">&amp;&amp;</span>&nbsp;<span class="ident" id="2888870">na</span>&nbsp;<span class="op" id="2888873">&lt;</span>&nbsp;<span class="ident" id="2888875">n</span><span class="op" id="2888876">;</span>&nbsp;<span class="op" id="2888878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888882">r</span><span class="op" id="2888883">,</span>&nbsp;<span class="ident" id="2888885">size</span>&nbsp;<span class="op" id="2888890">:=</span>&nbsp;<span class="ident" id="2888893">utf8</span><span class="op" id="2888897">.</span><span class="ident" id="2888898">DecodeRune</span><span class="op" id="2888908">(</span><span class="ident" id="2888909">s</span><span class="op" id="2888910">[</span><span class="ident" id="2888911">i</span><span class="op" id="2888912">:</span><span class="op" id="2888913">]</span><span class="op" id="2888914">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888918">if</span>&nbsp;<span class="ident" id="2888921">fieldStart</span>&nbsp;<span class="op" id="2888932">&lt;</span>&nbsp;<span class="num" id="2888934">0</span>&nbsp;<span class="op" id="2888936">&amp;&amp;</span>&nbsp;<span class="ident" id="2888939">size</span>&nbsp;<span class="op" id="2888944">&gt;</span>&nbsp;<span class="num" id="2888946">0</span>&nbsp;<span class="op" id="2888948">&amp;&amp;</span>&nbsp;<span class="op" id="2888951">!</span><span class="ident" id="2888952">f</span><span class="op" id="2888953">(</span><span class="ident" id="2888954">r</span><span class="op" id="2888955">)</span>&nbsp;<span class="op" id="2888957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888962">fieldStart</span>&nbsp;<span class="op" id="2888973">=</span>&nbsp;<span class="ident" id="2888975">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2888980">i</span>&nbsp;<span class="op" id="2888982">+=</span>&nbsp;<span class="ident" id="2888985">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2888993">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2889004">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889008">if</span>&nbsp;<span class="ident" id="2889011">fieldStart</span>&nbsp;<span class="op" id="2889022">&gt;=</span>&nbsp;<span class="num" id="2889025">0</span>&nbsp;<span class="op" id="2889027">&amp;&amp;</span>&nbsp;<span class="op" id="2889030">(</span><span class="ident" id="2889031">size</span>&nbsp;<span class="op" id="2889036">==</span>&nbsp;<span class="num" id="2889039">0</span>&nbsp;<span class="op" id="2889041">||</span>&nbsp;<span class="ident" id="2889044">f</span><span class="op" id="2889045">(</span><span class="ident" id="2889046">r</span><span class="op" id="2889047">)</span><span class="op" id="2889048">)</span>&nbsp;<span class="op" id="2889050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889055">a</span><span class="op" id="2889056">[</span><span class="ident" id="2889057">na</span><span class="op" id="2889059">]</span>&nbsp;<span class="op" id="2889061">=</span>&nbsp;<span class="ident" id="2889063">s</span><span class="op" id="2889064">[</span><span class="ident" id="2889065">fieldStart</span><span class="op" id="2889075">:</span><span class="ident" id="2889076">i</span><span class="op" id="2889077">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889082">na</span><span class="op" id="2889084">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889090">fieldStart</span>&nbsp;<span class="op" id="2889101">=</span>&nbsp;<span class="op" id="2889103">-</span><span class="num" id="2889104">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2889108">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889112">if</span>&nbsp;<span class="ident" id="2889115">size</span>&nbsp;<span class="op" id="2889120">==</span>&nbsp;<span class="num" id="2889123">0</span>&nbsp;<span class="op" id="2889125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889130">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2889138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889142">i</span>&nbsp;<span class="op" id="2889144">+=</span>&nbsp;<span class="ident" id="2889147">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2889153">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889156">return</span>&nbsp;<span class="ident" id="2889163">a</span><span class="op" id="2889164">[</span><span class="num" id="2889165">0</span><span class="op" id="2889166">:</span><span class="ident" id="2889167">na</span><span class="op" id="2889169">]</span><br>
<span class="lineno"></span><span class="op" id="2889171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2889174">//&nbsp;Join&nbsp;concatenates&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice.&nbsp;The&nbsp;separator</span><br>
<span class="lineno"></span><span class="comment" id="2889255">//&nbsp;sep&nbsp;is&nbsp;placed&nbsp;between&nbsp;elements&nbsp;in&nbsp;the&nbsp;resulting&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="2889313">func</span>&nbsp;<span class="ident" id="2889318">Join</span><span class="op" id="2889322">(</span><span class="ident" id="2889323">s</span>&nbsp;<span class="op" id="2889325">[</span><span class="op" id="2889326">]</span><span class="op" id="2889327">[</span><span class="op" id="2889328">]</span><span class="builtintype" id="2889329">byte</span><span class="op" id="2889333">,</span>&nbsp;<span class="ident" id="2889335">sep</span>&nbsp;<span class="op" id="2889339">[</span><span class="op" id="2889340">]</span><span class="builtintype" id="2889341">byte</span><span class="op" id="2889345">)</span>&nbsp;<span class="op" id="2889347">[</span><span class="op" id="2889348">]</span><span class="builtintype" id="2889349">byte</span>&nbsp;<span class="op" id="2889354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889357">if</span>&nbsp;<span class="builtinfunc" id="2889360">len</span><span class="op" id="2889363">(</span><span class="ident" id="2889364">s</span><span class="op" id="2889365">)</span>&nbsp;<span class="op" id="2889367">==</span>&nbsp;<span class="num" id="2889370">0</span>&nbsp;<span class="op" id="2889372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889376">return</span>&nbsp;<span class="op" id="2889383">[</span><span class="op" id="2889384">]</span><span class="builtintype" id="2889385">byte</span><span class="op" id="2889389">{</span><span class="op" id="2889390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2889393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889396">if</span>&nbsp;<span class="builtinfunc" id="2889399">len</span><span class="op" id="2889402">(</span><span class="ident" id="2889403">s</span><span class="op" id="2889404">)</span>&nbsp;<span class="op" id="2889406">==</span>&nbsp;<span class="num" id="2889409">1</span>&nbsp;<span class="op" id="2889411">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2889415">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889440">return</span>&nbsp;<span class="builtinfunc" id="2889447">append</span><span class="op" id="2889453">(</span><span class="op" id="2889454">[</span><span class="op" id="2889455">]</span><span class="builtintype" id="2889456">byte</span><span class="op" id="2889460">(</span><span class="ident" id="2889461">nil</span><span class="op" id="2889464">)</span><span class="op" id="2889465">,</span>&nbsp;<span class="ident" id="2889467">s</span><span class="op" id="2889468">[</span><span class="num" id="2889469">0</span><span class="op" id="2889470">]</span><span class="op" id="2889471">...</span><span class="op" id="2889474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2889477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889480">n</span>&nbsp;<span class="op" id="2889482">:=</span>&nbsp;<span class="builtinfunc" id="2889485">len</span><span class="op" id="2889488">(</span><span class="ident" id="2889489">sep</span><span class="op" id="2889492">)</span>&nbsp;<span class="op" id="2889494">*</span>&nbsp;<span class="op" id="2889496">(</span><span class="builtinfunc" id="2889497">len</span><span class="op" id="2889500">(</span><span class="ident" id="2889501">s</span><span class="op" id="2889502">)</span>&nbsp;<span class="op" id="2889504">-</span>&nbsp;<span class="num" id="2889506">1</span><span class="op" id="2889507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889510">for</span>&nbsp;<span class="ident" id="2889514">_</span><span class="op" id="2889515">,</span>&nbsp;<span class="ident" id="2889517">v</span>&nbsp;<span class="op" id="2889519">:=</span>&nbsp;<span class="keyword" id="2889522">range</span>&nbsp;<span class="ident" id="2889528">s</span>&nbsp;<span class="op" id="2889530">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889534">n</span>&nbsp;<span class="op" id="2889536">+=</span>&nbsp;<span class="builtinfunc" id="2889539">len</span><span class="op" id="2889542">(</span><span class="ident" id="2889543">v</span><span class="op" id="2889544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2889547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889551">b</span>&nbsp;<span class="op" id="2889553">:=</span>&nbsp;<span class="builtinfunc" id="2889556">make</span><span class="op" id="2889560">(</span><span class="op" id="2889561">[</span><span class="op" id="2889562">]</span><span class="builtintype" id="2889563">byte</span><span class="op" id="2889567">,</span>&nbsp;<span class="ident" id="2889569">n</span><span class="op" id="2889570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889573">bp</span>&nbsp;<span class="op" id="2889576">:=</span>&nbsp;<span class="builtinfunc" id="2889579">copy</span><span class="op" id="2889583">(</span><span class="ident" id="2889584">b</span><span class="op" id="2889585">,</span>&nbsp;<span class="ident" id="2889587">s</span><span class="op" id="2889588">[</span><span class="num" id="2889589">0</span><span class="op" id="2889590">]</span><span class="op" id="2889591">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889594">for</span>&nbsp;<span class="ident" id="2889598">_</span><span class="op" id="2889599">,</span>&nbsp;<span class="ident" id="2889601">v</span>&nbsp;<span class="op" id="2889603">:=</span>&nbsp;<span class="keyword" id="2889606">range</span>&nbsp;<span class="ident" id="2889612">s</span><span class="op" id="2889613">[</span><span class="num" id="2889614">1</span><span class="op" id="2889615">:</span><span class="op" id="2889616">]</span>&nbsp;<span class="op" id="2889618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889622">bp</span>&nbsp;<span class="op" id="2889625">+=</span>&nbsp;<span class="builtinfunc" id="2889628">copy</span><span class="op" id="2889632">(</span><span class="ident" id="2889633">b</span><span class="op" id="2889634">[</span><span class="ident" id="2889635">bp</span><span class="op" id="2889637">:</span><span class="op" id="2889638">]</span><span class="op" id="2889639">,</span>&nbsp;<span class="ident" id="2889641">sep</span><span class="op" id="2889644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2889648">bp</span>&nbsp;<span class="op" id="2889651">+=</span>&nbsp;<span class="builtinfunc" id="2889654">copy</span><span class="op" id="2889658">(</span><span class="ident" id="2889659">b</span><span class="op" id="2889660">[</span><span class="ident" id="2889661">bp</span><span class="op" id="2889663">:</span><span class="op" id="2889664">]</span><span class="op" id="2889665">,</span>&nbsp;<span class="ident" id="2889667">v</span><span class="op" id="2889668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2889671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889674">return</span>&nbsp;<span class="ident" id="2889681">b</span><br>
<span class="lineno">330</span><span class="op" id="2889683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2889686">//&nbsp;HasPrefix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;begins&nbsp;with&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="2889750">func</span>&nbsp;<span class="ident" id="2889755">HasPrefix</span><span class="op" id="2889764">(</span><span class="ident" id="2889765">s</span><span class="op" id="2889766">,</span>&nbsp;<span class="ident" id="2889768">prefix</span>&nbsp;<span class="op" id="2889775">[</span><span class="op" id="2889776">]</span><span class="builtintype" id="2889777">byte</span><span class="op" id="2889781">)</span>&nbsp;<span class="builtintype" id="2889783">bool</span>&nbsp;<span class="op" id="2889788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889791">return</span>&nbsp;<span class="builtinfunc" id="2889798">len</span><span class="op" id="2889801">(</span><span class="ident" id="2889802">s</span><span class="op" id="2889803">)</span>&nbsp;<span class="op" id="2889805">&gt;=</span>&nbsp;<span class="builtinfunc" id="2889808">len</span><span class="op" id="2889811">(</span><span class="ident" id="2889812">prefix</span><span class="op" id="2889818">)</span>&nbsp;<span class="op" id="2889820">&amp;&amp;</span>&nbsp;<span class="ident" id="2889823">Equal</span><span class="op" id="2889828">(</span><span class="ident" id="2889829">s</span><span class="op" id="2889830">[</span><span class="num" id="2889831">0</span><span class="op" id="2889832">:</span><span class="builtinfunc" id="2889833">len</span><span class="op" id="2889836">(</span><span class="ident" id="2889837">prefix</span><span class="op" id="2889843">)</span><span class="op" id="2889844">]</span><span class="op" id="2889845">,</span>&nbsp;<span class="ident" id="2889847">prefix</span><span class="op" id="2889853">)</span><br>
<span class="lineno">335</span><span class="op" id="2889855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2889858">//&nbsp;HasSuffix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;ends&nbsp;with&nbsp;suffix.</span><br>
<span class="lineno"></span><span class="keyword" id="2889920">func</span>&nbsp;<span class="ident" id="2889925">HasSuffix</span><span class="op" id="2889934">(</span><span class="ident" id="2889935">s</span><span class="op" id="2889936">,</span>&nbsp;<span class="ident" id="2889938">suffix</span>&nbsp;<span class="op" id="2889945">[</span><span class="op" id="2889946">]</span><span class="builtintype" id="2889947">byte</span><span class="op" id="2889951">)</span>&nbsp;<span class="builtintype" id="2889953">bool</span>&nbsp;<span class="op" id="2889958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2889961">return</span>&nbsp;<span class="builtinfunc" id="2889968">len</span><span class="op" id="2889971">(</span><span class="ident" id="2889972">s</span><span class="op" id="2889973">)</span>&nbsp;<span class="op" id="2889975">&gt;=</span>&nbsp;<span class="builtinfunc" id="2889978">len</span><span class="op" id="2889981">(</span><span class="ident" id="2889982">suffix</span><span class="op" id="2889988">)</span>&nbsp;<span class="op" id="2889990">&amp;&amp;</span>&nbsp;<span class="ident" id="2889993">Equal</span><span class="op" id="2889998">(</span><span class="ident" id="2889999">s</span><span class="op" id="2890000">[</span><span class="builtinfunc" id="2890001">len</span><span class="op" id="2890004">(</span><span class="ident" id="2890005">s</span><span class="op" id="2890006">)</span><span class="op" id="2890007">-</span><span class="builtinfunc" id="2890008">len</span><span class="op" id="2890011">(</span><span class="ident" id="2890012">suffix</span><span class="op" id="2890018">)</span><span class="op" id="2890019">:</span><span class="op" id="2890020">]</span><span class="op" id="2890021">,</span>&nbsp;<span class="ident" id="2890023">suffix</span><span class="op" id="2890029">)</span><br>
<span class="lineno">340</span><span class="op" id="2890031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2890034">//&nbsp;Map&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;its&nbsp;characters&nbsp;modified</span><br>
<span class="lineno"></span><span class="comment" id="2890109">//&nbsp;according&nbsp;to&nbsp;the&nbsp;mapping&nbsp;function.&nbsp;If&nbsp;mapping&nbsp;returns&nbsp;a&nbsp;negative&nbsp;value,&nbsp;the&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2890201">//&nbsp;dropped&nbsp;from&nbsp;the&nbsp;string&nbsp;with&nbsp;no&nbsp;replacement.&nbsp;&nbsp;The&nbsp;characters&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno">345</span><span class="comment" id="2890278">//&nbsp;output&nbsp;are&nbsp;interpreted&nbsp;as&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="2890342">func</span>&nbsp;<span class="ident" id="2890347">Map</span><span class="op" id="2890350">(</span><span class="ident" id="2890351">mapping</span>&nbsp;<span class="keyword" id="2890359">func</span><span class="op" id="2890363">(</span><span class="ident" id="2890364">r</span>&nbsp;<span class="builtintype" id="2890366">rune</span><span class="op" id="2890370">)</span>&nbsp;<span class="builtintype" id="2890372">rune</span><span class="op" id="2890376">,</span>&nbsp;<span class="ident" id="2890378">s</span>&nbsp;<span class="op" id="2890380">[</span><span class="op" id="2890381">]</span><span class="builtintype" id="2890382">byte</span><span class="op" id="2890386">)</span>&nbsp;<span class="op" id="2890388">[</span><span class="op" id="2890389">]</span><span class="builtintype" id="2890390">byte</span>&nbsp;<span class="op" id="2890395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890398">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;the&nbsp;slice&nbsp;can&nbsp;grow&nbsp;when&nbsp;mapped,&nbsp;making</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890460">//&nbsp;things&nbsp;unpleasant.&nbsp;&nbsp;But&nbsp;it&#39;s&nbsp;so&nbsp;rare&nbsp;we&nbsp;barge&nbsp;in&nbsp;assuming&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890527">//&nbsp;fine.&nbsp;&nbsp;It&nbsp;could&nbsp;also&nbsp;shrink&nbsp;but&nbsp;that&nbsp;falls&nbsp;out&nbsp;naturally.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890589">maxbytes</span>&nbsp;<span class="op" id="2890598">:=</span>&nbsp;<span class="builtinfunc" id="2890601">len</span><span class="op" id="2890604">(</span><span class="ident" id="2890605">s</span><span class="op" id="2890606">)</span>&nbsp;<span class="comment" id="2890608">//&nbsp;length&nbsp;of&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890624">nbytes</span>&nbsp;<span class="op" id="2890631">:=</span>&nbsp;<span class="num" id="2890634">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2890643">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;encoded&nbsp;in&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890676">b</span>&nbsp;<span class="op" id="2890678">:=</span>&nbsp;<span class="builtinfunc" id="2890681">make</span><span class="op" id="2890685">(</span><span class="op" id="2890686">[</span><span class="op" id="2890687">]</span><span class="builtintype" id="2890688">byte</span><span class="op" id="2890692">,</span>&nbsp;<span class="ident" id="2890694">maxbytes</span><span class="op" id="2890702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2890705">for</span>&nbsp;<span class="ident" id="2890709">i</span>&nbsp;<span class="op" id="2890711">:=</span>&nbsp;<span class="num" id="2890714">0</span><span class="op" id="2890715">;</span>&nbsp;<span class="ident" id="2890717">i</span>&nbsp;<span class="op" id="2890719">&lt;</span>&nbsp;<span class="builtinfunc" id="2890721">len</span><span class="op" id="2890724">(</span><span class="ident" id="2890725">s</span><span class="op" id="2890726">)</span><span class="op" id="2890727">;</span>&nbsp;<span class="op" id="2890729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890733">wid</span>&nbsp;<span class="op" id="2890737">:=</span>&nbsp;<span class="num" id="2890740">1</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890744">r</span>&nbsp;<span class="op" id="2890746">:=</span>&nbsp;<span class="builtintype" id="2890749">rune</span><span class="op" id="2890753">(</span><span class="ident" id="2890754">s</span><span class="op" id="2890755">[</span><span class="ident" id="2890756">i</span><span class="op" id="2890757">]</span><span class="op" id="2890758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2890762">if</span>&nbsp;<span class="ident" id="2890765">r</span>&nbsp;<span class="op" id="2890767">&gt;=</span>&nbsp;<span class="ident" id="2890770">utf8</span><span class="op" id="2890774">.</span><span class="ident" id="2890775">RuneSelf</span>&nbsp;<span class="op" id="2890784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890789">r</span><span class="op" id="2890790">,</span>&nbsp;<span class="ident" id="2890792">wid</span>&nbsp;<span class="op" id="2890796">=</span>&nbsp;<span class="ident" id="2890798">utf8</span><span class="op" id="2890802">.</span><span class="ident" id="2890803">DecodeRune</span><span class="op" id="2890813">(</span><span class="ident" id="2890814">s</span><span class="op" id="2890815">[</span><span class="ident" id="2890816">i</span><span class="op" id="2890817">:</span><span class="op" id="2890818">]</span><span class="op" id="2890819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2890823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890827">r</span>&nbsp;<span class="op" id="2890829">=</span>&nbsp;<span class="ident" id="2890831">mapping</span><span class="op" id="2890838">(</span><span class="ident" id="2890839">r</span><span class="op" id="2890840">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2890844">if</span>&nbsp;<span class="ident" id="2890847">r</span>&nbsp;<span class="op" id="2890849">&gt;=</span>&nbsp;<span class="num" id="2890852">0</span>&nbsp;<span class="op" id="2890854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890859">rl</span>&nbsp;<span class="op" id="2890862">:=</span>&nbsp;<span class="ident" id="2890865">utf8</span><span class="op" id="2890869">.</span><span class="ident" id="2890870">RuneLen</span><span class="op" id="2890877">(</span><span class="ident" id="2890878">r</span><span class="op" id="2890879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2890884">if</span>&nbsp;<span class="ident" id="2890887">rl</span>&nbsp;<span class="op" id="2890890">&lt;</span>&nbsp;<span class="num" id="2890892">0</span>&nbsp;<span class="op" id="2890894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890900">rl</span>&nbsp;<span class="op" id="2890903">=</span>&nbsp;<span class="builtinfunc" id="2890905">len</span><span class="op" id="2890908">(</span><span class="builtintype" id="2890909">string</span><span class="op" id="2890915">(</span><span class="ident" id="2890916">utf8</span><span class="op" id="2890920">.</span><span class="ident" id="2890921">RuneError</span><span class="op" id="2890930">)</span><span class="op" id="2890931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2890936">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2890941">if</span>&nbsp;<span class="ident" id="2890944">nbytes</span><span class="op" id="2890950">+</span><span class="ident" id="2890951">rl</span>&nbsp;<span class="op" id="2890954">&gt;</span>&nbsp;<span class="ident" id="2890956">maxbytes</span>&nbsp;<span class="op" id="2890965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2890971">//&nbsp;Grow&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2890995">maxbytes</span>&nbsp;<span class="op" id="2891004">=</span>&nbsp;<span class="ident" id="2891006">maxbytes</span><span class="op" id="2891014">*</span><span class="num" id="2891015">2</span>&nbsp;<span class="op" id="2891017">+</span>&nbsp;<span class="ident" id="2891019">utf8</span><span class="op" id="2891023">.</span><span class="ident" id="2891024">UTFMax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891035">nb</span>&nbsp;<span class="op" id="2891038">:=</span>&nbsp;<span class="builtinfunc" id="2891041">make</span><span class="op" id="2891045">(</span><span class="op" id="2891046">[</span><span class="op" id="2891047">]</span><span class="builtintype" id="2891048">byte</span><span class="op" id="2891052">,</span>&nbsp;<span class="ident" id="2891054">maxbytes</span><span class="op" id="2891062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2891068">copy</span><span class="op" id="2891072">(</span><span class="ident" id="2891073">nb</span><span class="op" id="2891075">,</span>&nbsp;<span class="ident" id="2891077">b</span><span class="op" id="2891078">[</span><span class="num" id="2891079">0</span><span class="op" id="2891080">:</span><span class="ident" id="2891081">nbytes</span><span class="op" id="2891087">]</span><span class="op" id="2891088">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891094">b</span>&nbsp;<span class="op" id="2891096">=</span>&nbsp;<span class="ident" id="2891098">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2891104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891109">nbytes</span>&nbsp;<span class="op" id="2891116">+=</span>&nbsp;<span class="ident" id="2891119">utf8</span><span class="op" id="2891123">.</span><span class="ident" id="2891124">EncodeRune</span><span class="op" id="2891134">(</span><span class="ident" id="2891135">b</span><span class="op" id="2891136">[</span><span class="ident" id="2891137">nbytes</span><span class="op" id="2891143">:</span><span class="ident" id="2891144">maxbytes</span><span class="op" id="2891152">]</span><span class="op" id="2891153">,</span>&nbsp;<span class="ident" id="2891155">r</span><span class="op" id="2891156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2891160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891164">i</span>&nbsp;<span class="op" id="2891166">+=</span>&nbsp;<span class="ident" id="2891169">wid</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2891174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2891177">return</span>&nbsp;<span class="ident" id="2891184">b</span><span class="op" id="2891185">[</span><span class="num" id="2891186">0</span><span class="op" id="2891187">:</span><span class="ident" id="2891188">nbytes</span><span class="op" id="2891194">]</span><br>
<span class="lineno"></span><span class="op" id="2891196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2891199">//&nbsp;Repeat&nbsp;returns&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice&nbsp;consisting&nbsp;of&nbsp;count&nbsp;copies&nbsp;of&nbsp;b.</span><br>
<span class="lineno">380</span><span class="keyword" id="2891267">func</span>&nbsp;<span class="ident" id="2891272">Repeat</span><span class="op" id="2891278">(</span><span class="ident" id="2891279">b</span>&nbsp;<span class="op" id="2891281">[</span><span class="op" id="2891282">]</span><span class="builtintype" id="2891283">byte</span><span class="op" id="2891287">,</span>&nbsp;<span class="ident" id="2891289">count</span>&nbsp;<span class="builtintype" id="2891295">int</span><span class="op" id="2891298">)</span>&nbsp;<span class="op" id="2891300">[</span><span class="op" id="2891301">]</span><span class="builtintype" id="2891302">byte</span>&nbsp;<span class="op" id="2891307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891310">nb</span>&nbsp;<span class="op" id="2891313">:=</span>&nbsp;<span class="builtinfunc" id="2891316">make</span><span class="op" id="2891320">(</span><span class="op" id="2891321">[</span><span class="op" id="2891322">]</span><span class="builtintype" id="2891323">byte</span><span class="op" id="2891327">,</span>&nbsp;<span class="builtinfunc" id="2891329">len</span><span class="op" id="2891332">(</span><span class="ident" id="2891333">b</span><span class="op" id="2891334">)</span><span class="op" id="2891335">*</span><span class="ident" id="2891336">count</span><span class="op" id="2891341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891344">bp</span>&nbsp;<span class="op" id="2891347">:=</span>&nbsp;<span class="builtinfunc" id="2891350">copy</span><span class="op" id="2891354">(</span><span class="ident" id="2891355">nb</span><span class="op" id="2891357">,</span>&nbsp;<span class="ident" id="2891359">b</span><span class="op" id="2891360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2891363">for</span>&nbsp;<span class="ident" id="2891367">bp</span>&nbsp;<span class="op" id="2891370">&lt;</span>&nbsp;<span class="builtinfunc" id="2891372">len</span><span class="op" id="2891375">(</span><span class="ident" id="2891376">nb</span><span class="op" id="2891378">)</span>&nbsp;<span class="op" id="2891380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2891384">copy</span><span class="op" id="2891388">(</span><span class="ident" id="2891389">nb</span><span class="op" id="2891391">[</span><span class="ident" id="2891392">bp</span><span class="op" id="2891394">:</span><span class="op" id="2891395">]</span><span class="op" id="2891396">,</span>&nbsp;<span class="ident" id="2891398">nb</span><span class="op" id="2891400">[</span><span class="op" id="2891401">:</span><span class="ident" id="2891402">bp</span><span class="op" id="2891404">]</span><span class="op" id="2891405">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2891409">bp</span>&nbsp;<span class="op" id="2891412">*=</span>&nbsp;<span class="num" id="2891415">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2891418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2891421">return</span>&nbsp;<span class="ident" id="2891428">nb</span><br>
<span class="lineno"></span><span class="op" id="2891431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="2891434">//&nbsp;ToUpper&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="2891533">func</span>&nbsp;<span class="ident" id="2891538">ToUpper</span><span class="op" id="2891545">(</span><span class="ident" id="2891546">s</span>&nbsp;<span class="op" id="2891548">[</span><span class="op" id="2891549">]</span><span class="builtintype" id="2891550">byte</span><span class="op" id="2891554">)</span>&nbsp;<span class="op" id="2891556">[</span><span class="op" id="2891557">]</span><span class="builtintype" id="2891558">byte</span>&nbsp;<span class="op" id="2891563">{</span>&nbsp;<span class="keyword" id="2891565">return</span>&nbsp;<span class="ident" id="2891572">Map</span><span class="op" id="2891575">(</span><span class="ident" id="2891576">unicode</span><span class="op" id="2891583">.</span><span class="ident" id="2891584">ToUpper</span><span class="op" id="2891591">,</span>&nbsp;<span class="ident" id="2891593">s</span><span class="op" id="2891594">)</span>&nbsp;<span class="op" id="2891596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2891599">//&nbsp;ToLower&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="2891698">func</span>&nbsp;<span class="ident" id="2891703">ToLower</span><span class="op" id="2891710">(</span><span class="ident" id="2891711">s</span>&nbsp;<span class="op" id="2891713">[</span><span class="op" id="2891714">]</span><span class="builtintype" id="2891715">byte</span><span class="op" id="2891719">)</span>&nbsp;<span class="op" id="2891721">[</span><span class="op" id="2891722">]</span><span class="builtintype" id="2891723">byte</span>&nbsp;<span class="op" id="2891728">{</span>&nbsp;<span class="keyword" id="2891730">return</span>&nbsp;<span class="ident" id="2891737">Map</span><span class="op" id="2891740">(</span><span class="ident" id="2891741">unicode</span><span class="op" id="2891748">.</span><span class="ident" id="2891749">ToLower</span><span class="op" id="2891756">,</span>&nbsp;<span class="ident" id="2891758">s</span><span class="op" id="2891759">)</span>&nbsp;<span class="op" id="2891761">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="2891764">//&nbsp;ToTitle&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="2891863">func</span>&nbsp;<span class="ident" id="2891868">ToTitle</span><span class="op" id="2891875">(</span><span class="ident" id="2891876">s</span>&nbsp;<span class="op" id="2891878">[</span><span class="op" id="2891879">]</span><span class="builtintype" id="2891880">byte</span><span class="op" id="2891884">)</span>&nbsp;<span class="op" id="2891886">[</span><span class="op" id="2891887">]</span><span class="builtintype" id="2891888">byte</span>&nbsp;<span class="op" id="2891893">{</span>&nbsp;<span class="keyword" id="2891895">return</span>&nbsp;<span class="ident" id="2891902">Map</span><span class="op" id="2891905">(</span><span class="ident" id="2891906">unicode</span><span class="op" id="2891913">.</span><span class="ident" id="2891914">ToTitle</span><span class="op" id="2891921">,</span>&nbsp;<span class="ident" id="2891923">s</span><span class="op" id="2891924">)</span>&nbsp;<span class="op" id="2891926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2891929">//&nbsp;ToUpperSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno">400</span><span class="comment" id="2892023">//&nbsp;upper&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="2892083">func</span>&nbsp;<span class="ident" id="2892088">ToUpperSpecial</span><span class="op" id="2892102">(</span><span class="ident" id="2892103">_case</span>&nbsp;<span class="ident" id="2892109">unicode</span><span class="op" id="2892116">.</span><span class="ident" id="2892117">SpecialCase</span><span class="op" id="2892128">,</span>&nbsp;<span class="ident" id="2892130">s</span>&nbsp;<span class="op" id="2892132">[</span><span class="op" id="2892133">]</span><span class="builtintype" id="2892134">byte</span><span class="op" id="2892138">)</span>&nbsp;<span class="op" id="2892140">[</span><span class="op" id="2892141">]</span><span class="builtintype" id="2892142">byte</span>&nbsp;<span class="op" id="2892147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2892150">return</span>&nbsp;<span class="ident" id="2892157">Map</span><span class="op" id="2892160">(</span><span class="keyword" id="2892161">func</span><span class="op" id="2892165">(</span><span class="ident" id="2892166">r</span>&nbsp;<span class="builtintype" id="2892168">rune</span><span class="op" id="2892172">)</span>&nbsp;<span class="builtintype" id="2892174">rune</span>&nbsp;<span class="op" id="2892179">{</span>&nbsp;<span class="keyword" id="2892181">return</span>&nbsp;<span class="ident" id="2892188">_case</span><span class="op" id="2892193">.</span><span class="ident" id="2892194">ToUpper</span><span class="op" id="2892201">(</span><span class="ident" id="2892202">r</span><span class="op" id="2892203">)</span>&nbsp;<span class="op" id="2892205">}</span><span class="op" id="2892206">,</span>&nbsp;<span class="ident" id="2892208">s</span><span class="op" id="2892209">)</span><br>
<span class="lineno"></span><span class="op" id="2892211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="2892214">//&nbsp;ToLowerSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="2892308">//&nbsp;lower&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="2892368">func</span>&nbsp;<span class="ident" id="2892373">ToLowerSpecial</span><span class="op" id="2892387">(</span><span class="ident" id="2892388">_case</span>&nbsp;<span class="ident" id="2892394">unicode</span><span class="op" id="2892401">.</span><span class="ident" id="2892402">SpecialCase</span><span class="op" id="2892413">,</span>&nbsp;<span class="ident" id="2892415">s</span>&nbsp;<span class="op" id="2892417">[</span><span class="op" id="2892418">]</span><span class="builtintype" id="2892419">byte</span><span class="op" id="2892423">)</span>&nbsp;<span class="op" id="2892425">[</span><span class="op" id="2892426">]</span><span class="builtintype" id="2892427">byte</span>&nbsp;<span class="op" id="2892432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2892435">return</span>&nbsp;<span class="ident" id="2892442">Map</span><span class="op" id="2892445">(</span><span class="keyword" id="2892446">func</span><span class="op" id="2892450">(</span><span class="ident" id="2892451">r</span>&nbsp;<span class="builtintype" id="2892453">rune</span><span class="op" id="2892457">)</span>&nbsp;<span class="builtintype" id="2892459">rune</span>&nbsp;<span class="op" id="2892464">{</span>&nbsp;<span class="keyword" id="2892466">return</span>&nbsp;<span class="ident" id="2892473">_case</span><span class="op" id="2892478">.</span><span class="ident" id="2892479">ToLower</span><span class="op" id="2892486">(</span><span class="ident" id="2892487">r</span><span class="op" id="2892488">)</span>&nbsp;<span class="op" id="2892490">}</span><span class="op" id="2892491">,</span>&nbsp;<span class="ident" id="2892493">s</span><span class="op" id="2892494">)</span><br>
<span class="lineno"></span><span class="op" id="2892496">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="2892499">//&nbsp;ToTitleSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="2892593">//&nbsp;title&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="2892653">func</span>&nbsp;<span class="ident" id="2892658">ToTitleSpecial</span><span class="op" id="2892672">(</span><span class="ident" id="2892673">_case</span>&nbsp;<span class="ident" id="2892679">unicode</span><span class="op" id="2892686">.</span><span class="ident" id="2892687">SpecialCase</span><span class="op" id="2892698">,</span>&nbsp;<span class="ident" id="2892700">s</span>&nbsp;<span class="op" id="2892702">[</span><span class="op" id="2892703">]</span><span class="builtintype" id="2892704">byte</span><span class="op" id="2892708">)</span>&nbsp;<span class="op" id="2892710">[</span><span class="op" id="2892711">]</span><span class="builtintype" id="2892712">byte</span>&nbsp;<span class="op" id="2892717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2892720">return</span>&nbsp;<span class="ident" id="2892727">Map</span><span class="op" id="2892730">(</span><span class="keyword" id="2892731">func</span><span class="op" id="2892735">(</span><span class="ident" id="2892736">r</span>&nbsp;<span class="builtintype" id="2892738">rune</span><span class="op" id="2892742">)</span>&nbsp;<span class="builtintype" id="2892744">rune</span>&nbsp;<span class="op" id="2892749">{</span>&nbsp;<span class="keyword" id="2892751">return</span>&nbsp;<span class="ident" id="2892758">_case</span><span class="op" id="2892763">.</span><span class="ident" id="2892764">ToTitle</span><span class="op" id="2892771">(</span><span class="ident" id="2892772">r</span><span class="op" id="2892773">)</span>&nbsp;<span class="op" id="2892775">}</span><span class="op" id="2892776">,</span>&nbsp;<span class="ident" id="2892778">s</span><span class="op" id="2892779">)</span><br>
<span class="lineno">415</span><span class="op" id="2892781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2892784">//&nbsp;isSeparator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;could&nbsp;mark&nbsp;a&nbsp;word&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="comment" id="2892852">//&nbsp;TODO:&nbsp;update&nbsp;when&nbsp;package&nbsp;unicode&nbsp;captures&nbsp;more&nbsp;of&nbsp;the&nbsp;properties.</span><br>
<span class="lineno"></span><span class="keyword" id="2892922">func</span>&nbsp;<span class="ident" id="2892927">isSeparator</span><span class="op" id="2892938">(</span><span class="ident" id="2892939">r</span>&nbsp;<span class="builtintype" id="2892941">rune</span><span class="op" id="2892945">)</span>&nbsp;<span class="builtintype" id="2892947">bool</span>&nbsp;<span class="op" id="2892952">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2892955">//&nbsp;ASCII&nbsp;alphanumerics&nbsp;and&nbsp;underscore&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893013">if</span>&nbsp;<span class="ident" id="2893016">r</span>&nbsp;<span class="op" id="2893018">&lt;=</span>&nbsp;<span class="num" id="2893021">0x7F</span>&nbsp;<span class="op" id="2893026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893030">switch</span>&nbsp;<span class="op" id="2893037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893041">case</span>&nbsp;<span class="string" id="2893046">&#39;0&#39;</span>&nbsp;<span class="op" id="2893050">&lt;=</span>&nbsp;<span class="ident" id="2893053">r</span>&nbsp;<span class="op" id="2893055">&amp;&amp;</span>&nbsp;<span class="ident" id="2893058">r</span>&nbsp;<span class="op" id="2893060">&lt;=</span>&nbsp;<span class="string" id="2893063">&#39;9&#39;</span><span class="op" id="2893066">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893071">return</span>&nbsp;<span class="builtintype" id="2893078">false</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893086">case</span>&nbsp;<span class="string" id="2893091">&#39;a&#39;</span>&nbsp;<span class="op" id="2893095">&lt;=</span>&nbsp;<span class="ident" id="2893098">r</span>&nbsp;<span class="op" id="2893100">&amp;&amp;</span>&nbsp;<span class="ident" id="2893103">r</span>&nbsp;<span class="op" id="2893105">&lt;=</span>&nbsp;<span class="string" id="2893108">&#39;z&#39;</span><span class="op" id="2893111">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893116">return</span>&nbsp;<span class="builtintype" id="2893123">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893131">case</span>&nbsp;<span class="string" id="2893136">&#39;A&#39;</span>&nbsp;<span class="op" id="2893140">&lt;=</span>&nbsp;<span class="ident" id="2893143">r</span>&nbsp;<span class="op" id="2893145">&amp;&amp;</span>&nbsp;<span class="ident" id="2893148">r</span>&nbsp;<span class="op" id="2893150">&lt;=</span>&nbsp;<span class="string" id="2893153">&#39;Z&#39;</span><span class="op" id="2893156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893161">return</span>&nbsp;<span class="builtintype" id="2893168">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893176">case</span>&nbsp;<span class="ident" id="2893181">r</span>&nbsp;<span class="op" id="2893183">==</span>&nbsp;<span class="string" id="2893186">&#39;_&#39;</span><span class="op" id="2893189">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893194">return</span>&nbsp;<span class="builtintype" id="2893201">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2893209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893213">return</span>&nbsp;<span class="builtintype" id="2893220">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2893226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2893229">//&nbsp;Letters&nbsp;and&nbsp;digits&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893271">if</span>&nbsp;<span class="ident" id="2893274">unicode</span><span class="op" id="2893281">.</span><span class="ident" id="2893282">IsLetter</span><span class="op" id="2893290">(</span><span class="ident" id="2893291">r</span><span class="op" id="2893292">)</span>&nbsp;<span class="op" id="2893294">||</span>&nbsp;<span class="ident" id="2893297">unicode</span><span class="op" id="2893304">.</span><span class="ident" id="2893305">IsDigit</span><span class="op" id="2893312">(</span><span class="ident" id="2893313">r</span><span class="op" id="2893314">)</span>&nbsp;<span class="op" id="2893316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893320">return</span>&nbsp;<span class="builtintype" id="2893327">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2893334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2893337">//&nbsp;Otherwise,&nbsp;all&nbsp;we&nbsp;can&nbsp;do&nbsp;for&nbsp;now&nbsp;is&nbsp;treat&nbsp;spaces&nbsp;as&nbsp;separators.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893405">return</span>&nbsp;<span class="ident" id="2893412">unicode</span><span class="op" id="2893419">.</span><span class="ident" id="2893420">IsSpace</span><span class="op" id="2893427">(</span><span class="ident" id="2893428">r</span><span class="op" id="2893429">)</span><br>
<span class="lineno">440</span><span class="op" id="2893431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2893434">//&nbsp;Title&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;that&nbsp;begin&nbsp;words</span><br>
<span class="lineno"></span><span class="comment" id="2893505">//&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="comment" id="2893536">//</span><br>
<span class="lineno">445</span><span class="comment" id="2893539">//&nbsp;BUG:&nbsp;The&nbsp;rule&nbsp;Title&nbsp;uses&nbsp;for&nbsp;word&nbsp;boundaries&nbsp;does&nbsp;not&nbsp;handle&nbsp;Unicode&nbsp;punctuation&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="2893633">func</span>&nbsp;<span class="ident" id="2893638">Title</span><span class="op" id="2893643">(</span><span class="ident" id="2893644">s</span>&nbsp;<span class="op" id="2893646">[</span><span class="op" id="2893647">]</span><span class="builtintype" id="2893648">byte</span><span class="op" id="2893652">)</span>&nbsp;<span class="op" id="2893654">[</span><span class="op" id="2893655">]</span><span class="builtintype" id="2893656">byte</span>&nbsp;<span class="op" id="2893661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2893664">//&nbsp;Use&nbsp;a&nbsp;closure&nbsp;here&nbsp;to&nbsp;remember&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2893706">//&nbsp;Hackish&nbsp;but&nbsp;effective.&nbsp;Depends&nbsp;on&nbsp;Map&nbsp;scanning&nbsp;in&nbsp;order&nbsp;and&nbsp;calling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2893778">//&nbsp;the&nbsp;closure&nbsp;once&nbsp;per&nbsp;rune.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893809">prev</span>&nbsp;<span class="op" id="2893814">:=</span>&nbsp;<span class="string" id="2893817">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893822">return</span>&nbsp;<span class="ident" id="2893829">Map</span><span class="op" id="2893832">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893836">func</span><span class="op" id="2893840">(</span><span class="ident" id="2893841">r</span>&nbsp;<span class="builtintype" id="2893843">rune</span><span class="op" id="2893847">)</span>&nbsp;<span class="builtintype" id="2893849">rune</span>&nbsp;<span class="op" id="2893854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893859">if</span>&nbsp;<span class="ident" id="2893862">isSeparator</span><span class="op" id="2893873">(</span><span class="ident" id="2893874">prev</span><span class="op" id="2893878">)</span>&nbsp;<span class="op" id="2893880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893886">prev</span>&nbsp;<span class="op" id="2893891">=</span>&nbsp;<span class="ident" id="2893893">r</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893899">return</span>&nbsp;<span class="ident" id="2893906">unicode</span><span class="op" id="2893913">.</span><span class="ident" id="2893914">ToTitle</span><span class="op" id="2893921">(</span><span class="ident" id="2893922">r</span><span class="op" id="2893923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2893928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893933">prev</span>&nbsp;<span class="op" id="2893938">=</span>&nbsp;<span class="ident" id="2893940">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2893945">return</span>&nbsp;<span class="ident" id="2893952">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2893956">}</span><span class="op" id="2893957">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2893961">s</span><span class="op" id="2893962">)</span><br>
<span class="lineno"></span><span class="op" id="2893964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2893967">//&nbsp;TrimLeftFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;UTF-8-encoded</span><br>
<span class="lineno"></span><span class="comment" id="2894048">//&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">465</span><span class="keyword" id="2894092">func</span>&nbsp;<span class="ident" id="2894097">TrimLeftFunc</span><span class="op" id="2894109">(</span><span class="ident" id="2894110">s</span>&nbsp;<span class="op" id="2894112">[</span><span class="op" id="2894113">]</span><span class="builtintype" id="2894114">byte</span><span class="op" id="2894118">,</span>&nbsp;<span class="ident" id="2894120">f</span>&nbsp;<span class="keyword" id="2894122">func</span><span class="op" id="2894126">(</span><span class="ident" id="2894127">r</span>&nbsp;<span class="builtintype" id="2894129">rune</span><span class="op" id="2894133">)</span>&nbsp;<span class="builtintype" id="2894135">bool</span><span class="op" id="2894139">)</span>&nbsp;<span class="op" id="2894141">[</span><span class="op" id="2894142">]</span><span class="builtintype" id="2894143">byte</span>&nbsp;<span class="op" id="2894148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894151">i</span>&nbsp;<span class="op" id="2894153">:=</span>&nbsp;<span class="ident" id="2894156">indexFunc</span><span class="op" id="2894165">(</span><span class="ident" id="2894166">s</span><span class="op" id="2894167">,</span>&nbsp;<span class="ident" id="2894169">f</span><span class="op" id="2894170">,</span>&nbsp;<span class="builtintype" id="2894172">false</span><span class="op" id="2894177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894180">if</span>&nbsp;<span class="ident" id="2894183">i</span>&nbsp;<span class="op" id="2894185">==</span>&nbsp;<span class="op" id="2894188">-</span><span class="num" id="2894189">1</span>&nbsp;<span class="op" id="2894191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894195">return</span>&nbsp;<span class="ident" id="2894202">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2894207">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894210">return</span>&nbsp;<span class="ident" id="2894217">s</span><span class="op" id="2894218">[</span><span class="ident" id="2894219">i</span><span class="op" id="2894220">:</span><span class="op" id="2894221">]</span><br>
<span class="lineno"></span><span class="op" id="2894223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2894226">//&nbsp;TrimRightFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing&nbsp;UTF-8</span><br>
<span class="lineno"></span><span class="comment" id="2894301">//&nbsp;encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">475</span><span class="keyword" id="2894353">func</span>&nbsp;<span class="ident" id="2894358">TrimRightFunc</span><span class="op" id="2894371">(</span><span class="ident" id="2894372">s</span>&nbsp;<span class="op" id="2894374">[</span><span class="op" id="2894375">]</span><span class="builtintype" id="2894376">byte</span><span class="op" id="2894380">,</span>&nbsp;<span class="ident" id="2894382">f</span>&nbsp;<span class="keyword" id="2894384">func</span><span class="op" id="2894388">(</span><span class="ident" id="2894389">r</span>&nbsp;<span class="builtintype" id="2894391">rune</span><span class="op" id="2894395">)</span>&nbsp;<span class="builtintype" id="2894397">bool</span><span class="op" id="2894401">)</span>&nbsp;<span class="op" id="2894403">[</span><span class="op" id="2894404">]</span><span class="builtintype" id="2894405">byte</span>&nbsp;<span class="op" id="2894410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894413">i</span>&nbsp;<span class="op" id="2894415">:=</span>&nbsp;<span class="ident" id="2894418">lastIndexFunc</span><span class="op" id="2894431">(</span><span class="ident" id="2894432">s</span><span class="op" id="2894433">,</span>&nbsp;<span class="ident" id="2894435">f</span><span class="op" id="2894436">,</span>&nbsp;<span class="builtintype" id="2894438">false</span><span class="op" id="2894443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894446">if</span>&nbsp;<span class="ident" id="2894449">i</span>&nbsp;<span class="op" id="2894451">&gt;=</span>&nbsp;<span class="num" id="2894454">0</span>&nbsp;<span class="op" id="2894456">&amp;&amp;</span>&nbsp;<span class="ident" id="2894459">s</span><span class="op" id="2894460">[</span><span class="ident" id="2894461">i</span><span class="op" id="2894462">]</span>&nbsp;<span class="op" id="2894464">&gt;=</span>&nbsp;<span class="ident" id="2894467">utf8</span><span class="op" id="2894471">.</span><span class="ident" id="2894472">RuneSelf</span>&nbsp;<span class="op" id="2894481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894485">_</span><span class="op" id="2894486">,</span>&nbsp;<span class="ident" id="2894488">wid</span>&nbsp;<span class="op" id="2894492">:=</span>&nbsp;<span class="ident" id="2894495">utf8</span><span class="op" id="2894499">.</span><span class="ident" id="2894500">DecodeRune</span><span class="op" id="2894510">(</span><span class="ident" id="2894511">s</span><span class="op" id="2894512">[</span><span class="ident" id="2894513">i</span><span class="op" id="2894514">:</span><span class="op" id="2894515">]</span><span class="op" id="2894516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894520">i</span>&nbsp;<span class="op" id="2894522">+=</span>&nbsp;<span class="ident" id="2894525">wid</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2894530">}</span>&nbsp;<span class="keyword" id="2894532">else</span>&nbsp;<span class="op" id="2894537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2894541">i</span><span class="op" id="2894542">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2894546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894549">return</span>&nbsp;<span class="ident" id="2894556">s</span><span class="op" id="2894557">[</span><span class="num" id="2894558">0</span><span class="op" id="2894559">:</span><span class="ident" id="2894560">i</span><span class="op" id="2894561">]</span><br>
<span class="lineno"></span><span class="op" id="2894563">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="comment" id="2894566">//&nbsp;TrimFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="2894642">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="keyword" id="2894700">func</span>&nbsp;<span class="ident" id="2894705">TrimFunc</span><span class="op" id="2894713">(</span><span class="ident" id="2894714">s</span>&nbsp;<span class="op" id="2894716">[</span><span class="op" id="2894717">]</span><span class="builtintype" id="2894718">byte</span><span class="op" id="2894722">,</span>&nbsp;<span class="ident" id="2894724">f</span>&nbsp;<span class="keyword" id="2894726">func</span><span class="op" id="2894730">(</span><span class="ident" id="2894731">r</span>&nbsp;<span class="builtintype" id="2894733">rune</span><span class="op" id="2894737">)</span>&nbsp;<span class="builtintype" id="2894739">bool</span><span class="op" id="2894743">)</span>&nbsp;<span class="op" id="2894745">[</span><span class="op" id="2894746">]</span><span class="builtintype" id="2894747">byte</span>&nbsp;<span class="op" id="2894752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894755">return</span>&nbsp;<span class="ident" id="2894762">TrimRightFunc</span><span class="op" id="2894775">(</span><span class="ident" id="2894776">TrimLeftFunc</span><span class="op" id="2894788">(</span><span class="ident" id="2894789">s</span><span class="op" id="2894790">,</span>&nbsp;<span class="ident" id="2894792">f</span><span class="op" id="2894793">)</span><span class="op" id="2894794">,</span>&nbsp;<span class="ident" id="2894796">f</span><span class="op" id="2894797">)</span><br>
<span class="lineno">490</span><span class="op" id="2894799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2894802">//&nbsp;TrimPrefix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;leading&nbsp;prefix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2894870">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;start&nbsp;with&nbsp;prefix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2894930">func</span>&nbsp;<span class="ident" id="2894935">TrimPrefix</span><span class="op" id="2894945">(</span><span class="ident" id="2894946">s</span><span class="op" id="2894947">,</span>&nbsp;<span class="ident" id="2894949">prefix</span>&nbsp;<span class="op" id="2894956">[</span><span class="op" id="2894957">]</span><span class="builtintype" id="2894958">byte</span><span class="op" id="2894962">)</span>&nbsp;<span class="op" id="2894964">[</span><span class="op" id="2894965">]</span><span class="builtintype" id="2894966">byte</span>&nbsp;<span class="op" id="2894971">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2894974">if</span>&nbsp;<span class="ident" id="2894977">HasPrefix</span><span class="op" id="2894986">(</span><span class="ident" id="2894987">s</span><span class="op" id="2894988">,</span>&nbsp;<span class="ident" id="2894990">prefix</span><span class="op" id="2894996">)</span>&nbsp;<span class="op" id="2894998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895002">return</span>&nbsp;<span class="ident" id="2895009">s</span><span class="op" id="2895010">[</span><span class="builtinfunc" id="2895011">len</span><span class="op" id="2895014">(</span><span class="ident" id="2895015">prefix</span><span class="op" id="2895021">)</span><span class="op" id="2895022">:</span><span class="op" id="2895023">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2895026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895029">return</span>&nbsp;<span class="ident" id="2895036">s</span><br>
<span class="lineno"></span><span class="op" id="2895038">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="comment" id="2895041">//&nbsp;TrimSuffix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;trailing&nbsp;suffix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2895110">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;end&nbsp;with&nbsp;suffix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2895168">func</span>&nbsp;<span class="ident" id="2895173">TrimSuffix</span><span class="op" id="2895183">(</span><span class="ident" id="2895184">s</span><span class="op" id="2895185">,</span>&nbsp;<span class="ident" id="2895187">suffix</span>&nbsp;<span class="op" id="2895194">[</span><span class="op" id="2895195">]</span><span class="builtintype" id="2895196">byte</span><span class="op" id="2895200">)</span>&nbsp;<span class="op" id="2895202">[</span><span class="op" id="2895203">]</span><span class="builtintype" id="2895204">byte</span>&nbsp;<span class="op" id="2895209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895212">if</span>&nbsp;<span class="ident" id="2895215">HasSuffix</span><span class="op" id="2895224">(</span><span class="ident" id="2895225">s</span><span class="op" id="2895226">,</span>&nbsp;<span class="ident" id="2895228">suffix</span><span class="op" id="2895234">)</span>&nbsp;<span class="op" id="2895236">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895240">return</span>&nbsp;<span class="ident" id="2895247">s</span><span class="op" id="2895248">[</span><span class="op" id="2895249">:</span><span class="builtinfunc" id="2895250">len</span><span class="op" id="2895253">(</span><span class="ident" id="2895254">s</span><span class="op" id="2895255">)</span><span class="op" id="2895256">-</span><span class="builtinfunc" id="2895257">len</span><span class="op" id="2895260">(</span><span class="ident" id="2895261">suffix</span><span class="op" id="2895267">)</span><span class="op" id="2895268">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2895271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895274">return</span>&nbsp;<span class="ident" id="2895281">s</span><br>
<span class="lineno"></span><span class="op" id="2895283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="comment" id="2895286">//&nbsp;IndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="2895364">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;first&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="2895419">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno"></span><span class="keyword" id="2895468">func</span>&nbsp;<span class="ident" id="2895473">IndexFunc</span><span class="op" id="2895482">(</span><span class="ident" id="2895483">s</span>&nbsp;<span class="op" id="2895485">[</span><span class="op" id="2895486">]</span><span class="builtintype" id="2895487">byte</span><span class="op" id="2895491">,</span>&nbsp;<span class="ident" id="2895493">f</span>&nbsp;<span class="keyword" id="2895495">func</span><span class="op" id="2895499">(</span><span class="ident" id="2895500">r</span>&nbsp;<span class="builtintype" id="2895502">rune</span><span class="op" id="2895506">)</span>&nbsp;<span class="builtintype" id="2895508">bool</span><span class="op" id="2895512">)</span>&nbsp;<span class="builtintype" id="2895514">int</span>&nbsp;<span class="op" id="2895518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895521">return</span>&nbsp;<span class="ident" id="2895528">indexFunc</span><span class="op" id="2895537">(</span><span class="ident" id="2895538">s</span><span class="op" id="2895539">,</span>&nbsp;<span class="ident" id="2895541">f</span><span class="op" id="2895542">,</span>&nbsp;<span class="builtintype" id="2895544">true</span><span class="op" id="2895548">)</span><br>
<span class="lineno">515</span><span class="op" id="2895550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2895553">//&nbsp;LastIndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="2895635">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;last&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="2895689">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno">520</span><span class="keyword" id="2895738">func</span>&nbsp;<span class="ident" id="2895743">LastIndexFunc</span><span class="op" id="2895756">(</span><span class="ident" id="2895757">s</span>&nbsp;<span class="op" id="2895759">[</span><span class="op" id="2895760">]</span><span class="builtintype" id="2895761">byte</span><span class="op" id="2895765">,</span>&nbsp;<span class="ident" id="2895767">f</span>&nbsp;<span class="keyword" id="2895769">func</span><span class="op" id="2895773">(</span><span class="ident" id="2895774">r</span>&nbsp;<span class="builtintype" id="2895776">rune</span><span class="op" id="2895780">)</span>&nbsp;<span class="builtintype" id="2895782">bool</span><span class="op" id="2895786">)</span>&nbsp;<span class="builtintype" id="2895788">int</span>&nbsp;<span class="op" id="2895792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2895795">return</span>&nbsp;<span class="ident" id="2895802">lastIndexFunc</span><span class="op" id="2895815">(</span><span class="ident" id="2895816">s</span><span class="op" id="2895817">,</span>&nbsp;<span class="ident" id="2895819">f</span><span class="op" id="2895820">,</span>&nbsp;<span class="builtintype" id="2895822">true</span><span class="op" id="2895826">)</span><br>
<span class="lineno"></span><span class="op" id="2895828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2895831">//&nbsp;indexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;IndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno">525</span><span class="comment" id="2895884">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2895940">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="2895953">func</span>&nbsp;<span class="ident" id="2895958">indexFunc</span><span class="op" id="2895967">(</span><span class="ident" id="2895968">s</span>&nbsp;<span class="op" id="2895970">[</span><span class="op" id="2895971">]</span><span class="builtintype" id="2895972">byte</span><span class="op" id="2895976">,</span>&nbsp;<span class="ident" id="2895978">f</span>&nbsp;<span class="keyword" id="2895980">func</span><span class="op" id="2895984">(</span><span class="ident" id="2895985">r</span>&nbsp;<span class="builtintype" id="2895987">rune</span><span class="op" id="2895991">)</span>&nbsp;<span class="builtintype" id="2895993">bool</span><span class="op" id="2895997">,</span>&nbsp;<span class="ident" id="2895999">truth</span>&nbsp;<span class="builtintype" id="2896005">bool</span><span class="op" id="2896009">)</span>&nbsp;<span class="builtintype" id="2896011">int</span>&nbsp;<span class="op" id="2896015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896018">start</span>&nbsp;<span class="op" id="2896024">:=</span>&nbsp;<span class="num" id="2896027">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896030">for</span>&nbsp;<span class="ident" id="2896034">start</span>&nbsp;<span class="op" id="2896040">&lt;</span>&nbsp;<span class="builtinfunc" id="2896042">len</span><span class="op" id="2896045">(</span><span class="ident" id="2896046">s</span><span class="op" id="2896047">)</span>&nbsp;<span class="op" id="2896049">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896053">wid</span>&nbsp;<span class="op" id="2896057">:=</span>&nbsp;<span class="num" id="2896060">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896064">r</span>&nbsp;<span class="op" id="2896066">:=</span>&nbsp;<span class="builtintype" id="2896069">rune</span><span class="op" id="2896073">(</span><span class="ident" id="2896074">s</span><span class="op" id="2896075">[</span><span class="ident" id="2896076">start</span><span class="op" id="2896081">]</span><span class="op" id="2896082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896086">if</span>&nbsp;<span class="ident" id="2896089">r</span>&nbsp;<span class="op" id="2896091">&gt;=</span>&nbsp;<span class="ident" id="2896094">utf8</span><span class="op" id="2896098">.</span><span class="ident" id="2896099">RuneSelf</span>&nbsp;<span class="op" id="2896108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896113">r</span><span class="op" id="2896114">,</span>&nbsp;<span class="ident" id="2896116">wid</span>&nbsp;<span class="op" id="2896120">=</span>&nbsp;<span class="ident" id="2896122">utf8</span><span class="op" id="2896126">.</span><span class="ident" id="2896127">DecodeRune</span><span class="op" id="2896137">(</span><span class="ident" id="2896138">s</span><span class="op" id="2896139">[</span><span class="ident" id="2896140">start</span><span class="op" id="2896145">:</span><span class="op" id="2896146">]</span><span class="op" id="2896147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896151">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896155">if</span>&nbsp;<span class="ident" id="2896158">f</span><span class="op" id="2896159">(</span><span class="ident" id="2896160">r</span><span class="op" id="2896161">)</span>&nbsp;<span class="op" id="2896163">==</span>&nbsp;<span class="ident" id="2896166">truth</span>&nbsp;<span class="op" id="2896172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896177">return</span>&nbsp;<span class="ident" id="2896184">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896196">start</span>&nbsp;<span class="op" id="2896202">+=</span>&nbsp;<span class="ident" id="2896205">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896210">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896213">return</span>&nbsp;<span class="op" id="2896220">-</span><span class="num" id="2896221">1</span><br>
<span class="lineno"></span><span class="op" id="2896223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2896226">//&nbsp;lastIndexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;LastIndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2896287">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno">545</span><span class="comment" id="2896343">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="2896356">func</span>&nbsp;<span class="ident" id="2896361">lastIndexFunc</span><span class="op" id="2896374">(</span><span class="ident" id="2896375">s</span>&nbsp;<span class="op" id="2896377">[</span><span class="op" id="2896378">]</span><span class="builtintype" id="2896379">byte</span><span class="op" id="2896383">,</span>&nbsp;<span class="ident" id="2896385">f</span>&nbsp;<span class="keyword" id="2896387">func</span><span class="op" id="2896391">(</span><span class="ident" id="2896392">r</span>&nbsp;<span class="builtintype" id="2896394">rune</span><span class="op" id="2896398">)</span>&nbsp;<span class="builtintype" id="2896400">bool</span><span class="op" id="2896404">,</span>&nbsp;<span class="ident" id="2896406">truth</span>&nbsp;<span class="builtintype" id="2896412">bool</span><span class="op" id="2896416">)</span>&nbsp;<span class="builtintype" id="2896418">int</span>&nbsp;<span class="op" id="2896422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896425">for</span>&nbsp;<span class="ident" id="2896429">i</span>&nbsp;<span class="op" id="2896431">:=</span>&nbsp;<span class="builtinfunc" id="2896434">len</span><span class="op" id="2896437">(</span><span class="ident" id="2896438">s</span><span class="op" id="2896439">)</span><span class="op" id="2896440">;</span>&nbsp;<span class="ident" id="2896442">i</span>&nbsp;<span class="op" id="2896444">&gt;</span>&nbsp;<span class="num" id="2896446">0</span><span class="op" id="2896447">;</span>&nbsp;<span class="op" id="2896449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896453">r</span><span class="op" id="2896454">,</span>&nbsp;<span class="ident" id="2896456">size</span>&nbsp;<span class="op" id="2896461">:=</span>&nbsp;<span class="builtintype" id="2896464">rune</span><span class="op" id="2896468">(</span><span class="ident" id="2896469">s</span><span class="op" id="2896470">[</span><span class="ident" id="2896471">i</span><span class="op" id="2896472">-</span><span class="num" id="2896473">1</span><span class="op" id="2896474">]</span><span class="op" id="2896475">)</span><span class="op" id="2896476">,</span>&nbsp;<span class="num" id="2896478">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896482">if</span>&nbsp;<span class="ident" id="2896485">r</span>&nbsp;<span class="op" id="2896487">&gt;=</span>&nbsp;<span class="ident" id="2896490">utf8</span><span class="op" id="2896494">.</span><span class="ident" id="2896495">RuneSelf</span>&nbsp;<span class="op" id="2896504">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896509">r</span><span class="op" id="2896510">,</span>&nbsp;<span class="ident" id="2896512">size</span>&nbsp;<span class="op" id="2896517">=</span>&nbsp;<span class="ident" id="2896519">utf8</span><span class="op" id="2896523">.</span><span class="ident" id="2896524">DecodeLastRune</span><span class="op" id="2896538">(</span><span class="ident" id="2896539">s</span><span class="op" id="2896540">[</span><span class="num" id="2896541">0</span><span class="op" id="2896542">:</span><span class="ident" id="2896543">i</span><span class="op" id="2896544">]</span><span class="op" id="2896545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2896553">i</span>&nbsp;<span class="op" id="2896555">-=</span>&nbsp;<span class="ident" id="2896558">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896565">if</span>&nbsp;<span class="ident" id="2896568">f</span><span class="op" id="2896569">(</span><span class="ident" id="2896570">r</span><span class="op" id="2896571">)</span>&nbsp;<span class="op" id="2896573">==</span>&nbsp;<span class="ident" id="2896576">truth</span>&nbsp;<span class="op" id="2896582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896587">return</span>&nbsp;<span class="ident" id="2896594">i</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896604">return</span>&nbsp;<span class="op" id="2896611">-</span><span class="num" id="2896612">1</span><br>
<span class="lineno"></span><span class="op" id="2896614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="2896617">func</span>&nbsp;<span class="ident" id="2896622">makeCutsetFunc</span><span class="op" id="2896636">(</span><span class="ident" id="2896637">cutset</span>&nbsp;<span class="builtintype" id="2896644">string</span><span class="op" id="2896650">)</span>&nbsp;<span class="keyword" id="2896652">func</span><span class="op" id="2896656">(</span><span class="ident" id="2896657">r</span>&nbsp;<span class="builtintype" id="2896659">rune</span><span class="op" id="2896663">)</span>&nbsp;<span class="builtintype" id="2896665">bool</span>&nbsp;<span class="op" id="2896670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896673">return</span>&nbsp;<span class="keyword" id="2896680">func</span><span class="op" id="2896684">(</span><span class="ident" id="2896685">r</span>&nbsp;<span class="builtintype" id="2896687">rune</span><span class="op" id="2896691">)</span>&nbsp;<span class="builtintype" id="2896693">bool</span>&nbsp;<span class="op" id="2896698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896702">for</span>&nbsp;<span class="ident" id="2896706">_</span><span class="op" id="2896707">,</span>&nbsp;<span class="ident" id="2896709">c</span>&nbsp;<span class="op" id="2896711">:=</span>&nbsp;<span class="keyword" id="2896714">range</span>&nbsp;<span class="ident" id="2896720">cutset</span>&nbsp;<span class="op" id="2896727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896732">if</span>&nbsp;<span class="ident" id="2896735">c</span>&nbsp;<span class="op" id="2896737">==</span>&nbsp;<span class="ident" id="2896740">r</span>&nbsp;<span class="op" id="2896742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896748">return</span>&nbsp;<span class="builtintype" id="2896755">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896771">return</span>&nbsp;<span class="builtintype" id="2896778">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2896785">}</span><br>
<span class="lineno"></span><span class="op" id="2896787">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="2896790">//&nbsp;Trim&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2896853">//&nbsp;trailing&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="2896920">func</span>&nbsp;<span class="ident" id="2896925">Trim</span><span class="op" id="2896929">(</span><span class="ident" id="2896930">s</span>&nbsp;<span class="op" id="2896932">[</span><span class="op" id="2896933">]</span><span class="builtintype" id="2896934">byte</span><span class="op" id="2896938">,</span>&nbsp;<span class="ident" id="2896940">cutset</span>&nbsp;<span class="builtintype" id="2896947">string</span><span class="op" id="2896953">)</span>&nbsp;<span class="op" id="2896955">[</span><span class="op" id="2896956">]</span><span class="builtintype" id="2896957">byte</span>&nbsp;<span class="op" id="2896962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2896965">return</span>&nbsp;<span class="ident" id="2896972">TrimFunc</span><span class="op" id="2896980">(</span><span class="ident" id="2896981">s</span><span class="op" id="2896982">,</span>&nbsp;<span class="ident" id="2896984">makeCutsetFunc</span><span class="op" id="2896998">(</span><span class="ident" id="2896999">cutset</span><span class="op" id="2897005">)</span><span class="op" id="2897006">)</span><br>
<span class="lineno">575</span><span class="op" id="2897008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2897011">//&nbsp;TrimLeft&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="2897074">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="2897132">func</span>&nbsp;<span class="ident" id="2897137">TrimLeft</span><span class="op" id="2897145">(</span><span class="ident" id="2897146">s</span>&nbsp;<span class="op" id="2897148">[</span><span class="op" id="2897149">]</span><span class="builtintype" id="2897150">byte</span><span class="op" id="2897154">,</span>&nbsp;<span class="ident" id="2897156">cutset</span>&nbsp;<span class="builtintype" id="2897163">string</span><span class="op" id="2897169">)</span>&nbsp;<span class="op" id="2897171">[</span><span class="op" id="2897172">]</span><span class="builtintype" id="2897173">byte</span>&nbsp;<span class="op" id="2897178">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897181">return</span>&nbsp;<span class="ident" id="2897188">TrimLeftFunc</span><span class="op" id="2897200">(</span><span class="ident" id="2897201">s</span><span class="op" id="2897202">,</span>&nbsp;<span class="ident" id="2897204">makeCutsetFunc</span><span class="op" id="2897218">(</span><span class="ident" id="2897219">cutset</span><span class="op" id="2897225">)</span><span class="op" id="2897226">)</span><br>
<span class="lineno"></span><span class="op" id="2897228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2897231">//&nbsp;TrimRight&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="2897296">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno">585</span><span class="keyword" id="2897363">func</span>&nbsp;<span class="ident" id="2897368">TrimRight</span><span class="op" id="2897377">(</span><span class="ident" id="2897378">s</span>&nbsp;<span class="op" id="2897380">[</span><span class="op" id="2897381">]</span><span class="builtintype" id="2897382">byte</span><span class="op" id="2897386">,</span>&nbsp;<span class="ident" id="2897388">cutset</span>&nbsp;<span class="builtintype" id="2897395">string</span><span class="op" id="2897401">)</span>&nbsp;<span class="op" id="2897403">[</span><span class="op" id="2897404">]</span><span class="builtintype" id="2897405">byte</span>&nbsp;<span class="op" id="2897410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897413">return</span>&nbsp;<span class="ident" id="2897420">TrimRightFunc</span><span class="op" id="2897433">(</span><span class="ident" id="2897434">s</span><span class="op" id="2897435">,</span>&nbsp;<span class="ident" id="2897437">makeCutsetFunc</span><span class="op" id="2897451">(</span><span class="ident" id="2897452">cutset</span><span class="op" id="2897458">)</span><span class="op" id="2897459">)</span><br>
<span class="lineno"></span><span class="op" id="2897461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2897464">//&nbsp;TrimSpace&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno">590</span><span class="comment" id="2897532">//&nbsp;trailing&nbsp;white&nbsp;space,&nbsp;as&nbsp;defined&nbsp;by&nbsp;Unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="2897580">func</span>&nbsp;<span class="ident" id="2897585">TrimSpace</span><span class="op" id="2897594">(</span><span class="ident" id="2897595">s</span>&nbsp;<span class="op" id="2897597">[</span><span class="op" id="2897598">]</span><span class="builtintype" id="2897599">byte</span><span class="op" id="2897603">)</span>&nbsp;<span class="op" id="2897605">[</span><span class="op" id="2897606">]</span><span class="builtintype" id="2897607">byte</span>&nbsp;<span class="op" id="2897612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897615">return</span>&nbsp;<span class="ident" id="2897622">TrimFunc</span><span class="op" id="2897630">(</span><span class="ident" id="2897631">s</span><span class="op" id="2897632">,</span>&nbsp;<span class="ident" id="2897634">unicode</span><span class="op" id="2897641">.</span><span class="ident" id="2897642">IsSpace</span><span class="op" id="2897649">)</span><br>
<span class="lineno"></span><span class="op" id="2897651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="2897654">//&nbsp;Runes&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;runes&nbsp;(Unicode&nbsp;code&nbsp;points)&nbsp;equivalent&nbsp;to&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="2897727">func</span>&nbsp;<span class="ident" id="2897732">Runes</span><span class="op" id="2897737">(</span><span class="ident" id="2897738">s</span>&nbsp;<span class="op" id="2897740">[</span><span class="op" id="2897741">]</span><span class="builtintype" id="2897742">byte</span><span class="op" id="2897746">)</span>&nbsp;<span class="op" id="2897748">[</span><span class="op" id="2897749">]</span><span class="builtintype" id="2897750">rune</span>&nbsp;<span class="op" id="2897755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897758">t</span>&nbsp;<span class="op" id="2897760">:=</span>&nbsp;<span class="builtinfunc" id="2897763">make</span><span class="op" id="2897767">(</span><span class="op" id="2897768">[</span><span class="op" id="2897769">]</span><span class="builtintype" id="2897770">rune</span><span class="op" id="2897774">,</span>&nbsp;<span class="ident" id="2897776">utf8</span><span class="op" id="2897780">.</span><span class="ident" id="2897781">RuneCount</span><span class="op" id="2897790">(</span><span class="ident" id="2897791">s</span><span class="op" id="2897792">)</span><span class="op" id="2897793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897796">i</span>&nbsp;<span class="op" id="2897798">:=</span>&nbsp;<span class="num" id="2897801">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897804">for</span>&nbsp;<span class="builtinfunc" id="2897808">len</span><span class="op" id="2897811">(</span><span class="ident" id="2897812">s</span><span class="op" id="2897813">)</span>&nbsp;<span class="op" id="2897815">&gt;</span>&nbsp;<span class="num" id="2897817">0</span>&nbsp;<span class="op" id="2897819">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897823">r</span><span class="op" id="2897824">,</span>&nbsp;<span class="ident" id="2897826">l</span>&nbsp;<span class="op" id="2897828">:=</span>&nbsp;<span class="ident" id="2897831">utf8</span><span class="op" id="2897835">.</span><span class="ident" id="2897836">DecodeRune</span><span class="op" id="2897846">(</span><span class="ident" id="2897847">s</span><span class="op" id="2897848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897852">t</span><span class="op" id="2897853">[</span><span class="ident" id="2897854">i</span><span class="op" id="2897855">]</span>&nbsp;<span class="op" id="2897857">=</span>&nbsp;<span class="ident" id="2897859">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897863">i</span><span class="op" id="2897864">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2897869">s</span>&nbsp;<span class="op" id="2897871">=</span>&nbsp;<span class="ident" id="2897873">s</span><span class="op" id="2897874">[</span><span class="ident" id="2897875">l</span><span class="op" id="2897876">:</span><span class="op" id="2897877">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2897880">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2897883">return</span>&nbsp;<span class="ident" id="2897890">t</span><br>
<span class="lineno"></span><span class="op" id="2897892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2897895">//&nbsp;Replace&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;slice&nbsp;s&nbsp;with&nbsp;the&nbsp;first&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2897953">//&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;old&nbsp;replaced&nbsp;by&nbsp;new.</span><br>
<span class="lineno">610</span><span class="comment" id="2898006">//&nbsp;If&nbsp;old&nbsp;is&nbsp;empty,&nbsp;it&nbsp;matches&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="2898067">//&nbsp;and&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence,&nbsp;yielding&nbsp;up&nbsp;to&nbsp;k+1&nbsp;replacements</span><br>
<span class="lineno"></span><span class="comment" id="2898133">//&nbsp;for&nbsp;a&nbsp;k-rune&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="2898156">//&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;0,&nbsp;there&nbsp;is&nbsp;no&nbsp;limit&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span><span class="keyword" id="2898218">func</span>&nbsp;<span class="ident" id="2898223">Replace</span><span class="op" id="2898230">(</span><span class="ident" id="2898231">s</span><span class="op" id="2898232">,</span>&nbsp;<span class="ident" id="2898234">old</span><span class="op" id="2898237">,</span>&nbsp;<span class="builtinfunc" id="2898239">new</span>&nbsp;<span class="op" id="2898243">[</span><span class="op" id="2898244">]</span><span class="builtintype" id="2898245">byte</span><span class="op" id="2898249">,</span>&nbsp;<span class="ident" id="2898251">n</span>&nbsp;<span class="builtintype" id="2898253">int</span><span class="op" id="2898256">)</span>&nbsp;<span class="op" id="2898258">[</span><span class="op" id="2898259">]</span><span class="builtintype" id="2898260">byte</span>&nbsp;<span class="op" id="2898265">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898268">m</span>&nbsp;<span class="op" id="2898270">:=</span>&nbsp;<span class="num" id="2898273">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898276">if</span>&nbsp;<span class="ident" id="2898279">n</span>&nbsp;<span class="op" id="2898281">!=</span>&nbsp;<span class="num" id="2898284">0</span>&nbsp;<span class="op" id="2898286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898290">//&nbsp;Compute&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898327">m</span>&nbsp;<span class="op" id="2898329">=</span>&nbsp;<span class="ident" id="2898331">Count</span><span class="op" id="2898336">(</span><span class="ident" id="2898337">s</span><span class="op" id="2898338">,</span>&nbsp;<span class="ident" id="2898340">old</span><span class="op" id="2898343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898346">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898349">if</span>&nbsp;<span class="ident" id="2898352">m</span>&nbsp;<span class="op" id="2898354">==</span>&nbsp;<span class="num" id="2898357">0</span>&nbsp;<span class="op" id="2898359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898363">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898388">return</span>&nbsp;<span class="builtinfunc" id="2898395">append</span><span class="op" id="2898401">(</span><span class="op" id="2898402">[</span><span class="op" id="2898403">]</span><span class="builtintype" id="2898404">byte</span><span class="op" id="2898408">(</span><span class="ident" id="2898409">nil</span><span class="op" id="2898412">)</span><span class="op" id="2898413">,</span>&nbsp;<span class="ident" id="2898415">s</span><span class="op" id="2898416">...</span><span class="op" id="2898419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898425">if</span>&nbsp;<span class="ident" id="2898428">n</span>&nbsp;<span class="op" id="2898430">&lt;</span>&nbsp;<span class="num" id="2898432">0</span>&nbsp;<span class="op" id="2898434">||</span>&nbsp;<span class="ident" id="2898437">m</span>&nbsp;<span class="op" id="2898439">&lt;</span>&nbsp;<span class="ident" id="2898441">n</span>&nbsp;<span class="op" id="2898443">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898447">n</span>&nbsp;<span class="op" id="2898449">=</span>&nbsp;<span class="ident" id="2898451">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2898458">//&nbsp;Apply&nbsp;replacements&nbsp;to&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898492">t</span>&nbsp;<span class="op" id="2898494">:=</span>&nbsp;<span class="builtinfunc" id="2898497">make</span><span class="op" id="2898501">(</span><span class="op" id="2898502">[</span><span class="op" id="2898503">]</span><span class="builtintype" id="2898504">byte</span><span class="op" id="2898508">,</span>&nbsp;<span class="builtinfunc" id="2898510">len</span><span class="op" id="2898513">(</span><span class="ident" id="2898514">s</span><span class="op" id="2898515">)</span><span class="op" id="2898516">+</span><span class="ident" id="2898517">n</span><span class="op" id="2898518">*</span><span class="op" id="2898519">(</span><span class="builtinfunc" id="2898520">len</span><span class="op" id="2898523">(</span><span class="builtinfunc" id="2898524">new</span><span class="op" id="2898527">)</span><span class="op" id="2898528">-</span><span class="builtinfunc" id="2898529">len</span><span class="op" id="2898532">(</span><span class="ident" id="2898533">old</span><span class="op" id="2898536">)</span><span class="op" id="2898537">)</span><span class="op" id="2898538">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898541">w</span>&nbsp;<span class="op" id="2898543">:=</span>&nbsp;<span class="num" id="2898546">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898549">start</span>&nbsp;<span class="op" id="2898555">:=</span>&nbsp;<span class="num" id="2898558">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898561">for</span>&nbsp;<span class="ident" id="2898565">i</span>&nbsp;<span class="op" id="2898567">:=</span>&nbsp;<span class="num" id="2898570">0</span><span class="op" id="2898571">;</span>&nbsp;<span class="ident" id="2898573">i</span>&nbsp;<span class="op" id="2898575">&lt;</span>&nbsp;<span class="ident" id="2898577">n</span><span class="op" id="2898578">;</span>&nbsp;<span class="ident" id="2898580">i</span><span class="op" id="2898581">++</span>&nbsp;<span class="op" id="2898584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898588">j</span>&nbsp;<span class="op" id="2898590">:=</span>&nbsp;<span class="ident" id="2898593">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898601">if</span>&nbsp;<span class="builtinfunc" id="2898604">len</span><span class="op" id="2898607">(</span><span class="ident" id="2898608">old</span><span class="op" id="2898611">)</span>&nbsp;<span class="op" id="2898613">==</span>&nbsp;<span class="num" id="2898616">0</span>&nbsp;<span class="op" id="2898618">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898623">if</span>&nbsp;<span class="ident" id="2898626">i</span>&nbsp;<span class="op" id="2898628">&gt;</span>&nbsp;<span class="num" id="2898630">0</span>&nbsp;<span class="op" id="2898632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898638">_</span><span class="op" id="2898639">,</span>&nbsp;<span class="ident" id="2898641">wid</span>&nbsp;<span class="op" id="2898645">:=</span>&nbsp;<span class="ident" id="2898648">utf8</span><span class="op" id="2898652">.</span><span class="ident" id="2898653">DecodeRune</span><span class="op" id="2898663">(</span><span class="ident" id="2898664">s</span><span class="op" id="2898665">[</span><span class="ident" id="2898666">start</span><span class="op" id="2898671">:</span><span class="op" id="2898672">]</span><span class="op" id="2898673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898679">j</span>&nbsp;<span class="op" id="2898681">+=</span>&nbsp;<span class="ident" id="2898684">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898695">}</span>&nbsp;<span class="keyword" id="2898697">else</span>&nbsp;<span class="op" id="2898702">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898707">j</span>&nbsp;<span class="op" id="2898709">+=</span>&nbsp;<span class="ident" id="2898712">Index</span><span class="op" id="2898717">(</span><span class="ident" id="2898718">s</span><span class="op" id="2898719">[</span><span class="ident" id="2898720">start</span><span class="op" id="2898725">:</span><span class="op" id="2898726">]</span><span class="op" id="2898727">,</span>&nbsp;<span class="ident" id="2898729">old</span><span class="op" id="2898732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898740">w</span>&nbsp;<span class="op" id="2898742">+=</span>&nbsp;<span class="builtinfunc" id="2898745">copy</span><span class="op" id="2898749">(</span><span class="ident" id="2898750">t</span><span class="op" id="2898751">[</span><span class="ident" id="2898752">w</span><span class="op" id="2898753">:</span><span class="op" id="2898754">]</span><span class="op" id="2898755">,</span>&nbsp;<span class="ident" id="2898757">s</span><span class="op" id="2898758">[</span><span class="ident" id="2898759">start</span><span class="op" id="2898764">:</span><span class="ident" id="2898765">j</span><span class="op" id="2898766">]</span><span class="op" id="2898767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898771">w</span>&nbsp;<span class="op" id="2898773">+=</span>&nbsp;<span class="builtinfunc" id="2898776">copy</span><span class="op" id="2898780">(</span><span class="ident" id="2898781">t</span><span class="op" id="2898782">[</span><span class="ident" id="2898783">w</span><span class="op" id="2898784">:</span><span class="op" id="2898785">]</span><span class="op" id="2898786">,</span>&nbsp;<span class="builtinfunc" id="2898788">new</span><span class="op" id="2898791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898795">start</span>&nbsp;<span class="op" id="2898801">=</span>&nbsp;<span class="ident" id="2898803">j</span>&nbsp;<span class="op" id="2898805">+</span>&nbsp;<span class="builtinfunc" id="2898807">len</span><span class="op" id="2898810">(</span><span class="ident" id="2898811">old</span><span class="op" id="2898814">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2898817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2898820">w</span>&nbsp;<span class="op" id="2898822">+=</span>&nbsp;<span class="builtinfunc" id="2898825">copy</span><span class="op" id="2898829">(</span><span class="ident" id="2898830">t</span><span class="op" id="2898831">[</span><span class="ident" id="2898832">w</span><span class="op" id="2898833">:</span><span class="op" id="2898834">]</span><span class="op" id="2898835">,</span>&nbsp;<span class="ident" id="2898837">s</span><span class="op" id="2898838">[</span><span class="ident" id="2898839">start</span><span class="op" id="2898844">:</span><span class="op" id="2898845">]</span><span class="op" id="2898846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2898849">return</span>&nbsp;<span class="ident" id="2898856">t</span><span class="op" id="2898857">[</span><span class="num" id="2898858">0</span><span class="op" id="2898859">:</span><span class="ident" id="2898860">w</span><span class="op" id="2898861">]</span><br>
<span class="lineno"></span><span class="op" id="2898863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2898866">//&nbsp;EqualFold&nbsp;reports&nbsp;whether&nbsp;s&nbsp;and&nbsp;t,&nbsp;interpreted&nbsp;as&nbsp;UTF-8&nbsp;strings,</span><br>
<span class="lineno"></span><span class="comment" id="2898934">//&nbsp;are&nbsp;equal&nbsp;under&nbsp;Unicode&nbsp;case-folding.</span><br>
<span class="lineno"></span><span class="keyword" id="2898975">func</span>&nbsp;<span class="ident" id="2898980">EqualFold</span><span class="op" id="2898989">(</span><span class="ident" id="2898990">s</span><span class="op" id="2898991">,</span>&nbsp;<span class="ident" id="2898993">t</span>&nbsp;<span class="op" id="2898995">[</span><span class="op" id="2898996">]</span><span class="builtintype" id="2898997">byte</span><span class="op" id="2899001">)</span>&nbsp;<span class="builtintype" id="2899003">bool</span>&nbsp;<span class="op" id="2899008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899011">for</span>&nbsp;<span class="builtinfunc" id="2899015">len</span><span class="op" id="2899018">(</span><span class="ident" id="2899019">s</span><span class="op" id="2899020">)</span>&nbsp;<span class="op" id="2899022">!=</span>&nbsp;<span class="num" id="2899025">0</span>&nbsp;<span class="op" id="2899027">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2899030">len</span><span class="op" id="2899033">(</span><span class="ident" id="2899034">t</span><span class="op" id="2899035">)</span>&nbsp;<span class="op" id="2899037">!=</span>&nbsp;<span class="num" id="2899040">0</span>&nbsp;<span class="op" id="2899042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899046">//&nbsp;Extract&nbsp;first&nbsp;rune&nbsp;from&nbsp;each.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899081">var</span>&nbsp;<span class="ident" id="2899085">sr</span><span class="op" id="2899087">,</span>&nbsp;<span class="ident" id="2899089">tr</span>&nbsp;<span class="builtintype" id="2899092">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899099">if</span>&nbsp;<span class="ident" id="2899102">s</span><span class="op" id="2899103">[</span><span class="num" id="2899104">0</span><span class="op" id="2899105">]</span>&nbsp;<span class="op" id="2899107">&lt;</span>&nbsp;<span class="ident" id="2899109">utf8</span><span class="op" id="2899113">.</span><span class="ident" id="2899114">RuneSelf</span>&nbsp;<span class="op" id="2899123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899128">sr</span><span class="op" id="2899130">,</span>&nbsp;<span class="ident" id="2899132">s</span>&nbsp;<span class="op" id="2899134">=</span>&nbsp;<span class="builtintype" id="2899136">rune</span><span class="op" id="2899140">(</span><span class="ident" id="2899141">s</span><span class="op" id="2899142">[</span><span class="num" id="2899143">0</span><span class="op" id="2899144">]</span><span class="op" id="2899145">)</span><span class="op" id="2899146">,</span>&nbsp;<span class="ident" id="2899148">s</span><span class="op" id="2899149">[</span><span class="num" id="2899150">1</span><span class="op" id="2899151">:</span><span class="op" id="2899152">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899156">}</span>&nbsp;<span class="keyword" id="2899158">else</span>&nbsp;<span class="op" id="2899163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899168">r</span><span class="op" id="2899169">,</span>&nbsp;<span class="ident" id="2899171">size</span>&nbsp;<span class="op" id="2899176">:=</span>&nbsp;<span class="ident" id="2899179">utf8</span><span class="op" id="2899183">.</span><span class="ident" id="2899184">DecodeRune</span><span class="op" id="2899194">(</span><span class="ident" id="2899195">s</span><span class="op" id="2899196">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899201">sr</span><span class="op" id="2899203">,</span>&nbsp;<span class="ident" id="2899205">s</span>&nbsp;<span class="op" id="2899207">=</span>&nbsp;<span class="ident" id="2899209">r</span><span class="op" id="2899210">,</span>&nbsp;<span class="ident" id="2899212">s</span><span class="op" id="2899213">[</span><span class="ident" id="2899214">size</span><span class="op" id="2899218">:</span><span class="op" id="2899219">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899227">if</span>&nbsp;<span class="ident" id="2899230">t</span><span class="op" id="2899231">[</span><span class="num" id="2899232">0</span><span class="op" id="2899233">]</span>&nbsp;<span class="op" id="2899235">&lt;</span>&nbsp;<span class="ident" id="2899237">utf8</span><span class="op" id="2899241">.</span><span class="ident" id="2899242">RuneSelf</span>&nbsp;<span class="op" id="2899251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899256">tr</span><span class="op" id="2899258">,</span>&nbsp;<span class="ident" id="2899260">t</span>&nbsp;<span class="op" id="2899262">=</span>&nbsp;<span class="builtintype" id="2899264">rune</span><span class="op" id="2899268">(</span><span class="ident" id="2899269">t</span><span class="op" id="2899270">[</span><span class="num" id="2899271">0</span><span class="op" id="2899272">]</span><span class="op" id="2899273">)</span><span class="op" id="2899274">,</span>&nbsp;<span class="ident" id="2899276">t</span><span class="op" id="2899277">[</span><span class="num" id="2899278">1</span><span class="op" id="2899279">:</span><span class="op" id="2899280">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899284">}</span>&nbsp;<span class="keyword" id="2899286">else</span>&nbsp;<span class="op" id="2899291">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899296">r</span><span class="op" id="2899297">,</span>&nbsp;<span class="ident" id="2899299">size</span>&nbsp;<span class="op" id="2899304">:=</span>&nbsp;<span class="ident" id="2899307">utf8</span><span class="op" id="2899311">.</span><span class="ident" id="2899312">DecodeRune</span><span class="op" id="2899322">(</span><span class="ident" id="2899323">t</span><span class="op" id="2899324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899329">tr</span><span class="op" id="2899331">,</span>&nbsp;<span class="ident" id="2899333">t</span>&nbsp;<span class="op" id="2899335">=</span>&nbsp;<span class="ident" id="2899337">r</span><span class="op" id="2899338">,</span>&nbsp;<span class="ident" id="2899340">t</span><span class="op" id="2899341">[</span><span class="ident" id="2899342">size</span><span class="op" id="2899346">:</span><span class="op" id="2899347">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899356">//&nbsp;If&nbsp;they&nbsp;match,&nbsp;keep&nbsp;going;&nbsp;if&nbsp;not,&nbsp;return&nbsp;false.</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899411">//&nbsp;Easy&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899427">if</span>&nbsp;<span class="ident" id="2899430">tr</span>&nbsp;<span class="op" id="2899433">==</span>&nbsp;<span class="ident" id="2899436">sr</span>&nbsp;<span class="op" id="2899439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899444">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899455">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899460">//&nbsp;Make&nbsp;sr&nbsp;&lt;&nbsp;tr&nbsp;to&nbsp;simplify&nbsp;what&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899504">if</span>&nbsp;<span class="ident" id="2899507">tr</span>&nbsp;<span class="op" id="2899510">&lt;</span>&nbsp;<span class="ident" id="2899512">sr</span>&nbsp;<span class="op" id="2899515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899520">tr</span><span class="op" id="2899522">,</span>&nbsp;<span class="ident" id="2899524">sr</span>&nbsp;<span class="op" id="2899527">=</span>&nbsp;<span class="ident" id="2899529">sr</span><span class="op" id="2899531">,</span>&nbsp;<span class="ident" id="2899533">tr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899538">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899542">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;ASCII.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899569">if</span>&nbsp;<span class="ident" id="2899572">tr</span>&nbsp;<span class="op" id="2899575">&lt;</span>&nbsp;<span class="ident" id="2899577">utf8</span><span class="op" id="2899581">.</span><span class="ident" id="2899582">RuneSelf</span>&nbsp;<span class="op" id="2899591">&amp;&amp;</span>&nbsp;<span class="string" id="2899594">&#39;A&#39;</span>&nbsp;<span class="op" id="2899598">&lt;=</span>&nbsp;<span class="ident" id="2899601">sr</span>&nbsp;<span class="op" id="2899604">&amp;&amp;</span>&nbsp;<span class="ident" id="2899607">sr</span>&nbsp;<span class="op" id="2899610">&lt;=</span>&nbsp;<span class="string" id="2899613">&#39;Z&#39;</span>&nbsp;<span class="op" id="2899617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899622">//&nbsp;ASCII,&nbsp;and&nbsp;sr&nbsp;is&nbsp;upper&nbsp;case.&nbsp;&nbsp;tr&nbsp;must&nbsp;be&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899681">if</span>&nbsp;<span class="ident" id="2899684">tr</span>&nbsp;<span class="op" id="2899687">==</span>&nbsp;<span class="ident" id="2899690">sr</span><span class="op" id="2899692">+</span><span class="string" id="2899693">&#39;a&#39;</span><span class="op" id="2899696">-</span><span class="string" id="2899697">&#39;A&#39;</span>&nbsp;<span class="op" id="2899701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899707">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899724">return</span>&nbsp;<span class="builtintype" id="2899731">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899744">//&nbsp;General&nbsp;case.&nbsp;&nbsp;SimpleFold(x)&nbsp;returns&nbsp;the&nbsp;next&nbsp;equivalent&nbsp;rune&nbsp;&gt;&nbsp;x</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899815">//&nbsp;or&nbsp;wraps&nbsp;around&nbsp;to&nbsp;smaller&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899855">r</span>&nbsp;<span class="op" id="2899857">:=</span>&nbsp;<span class="ident" id="2899860">unicode</span><span class="op" id="2899867">.</span><span class="ident" id="2899868">SimpleFold</span><span class="op" id="2899878">(</span><span class="ident" id="2899879">sr</span><span class="op" id="2899881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899885">for</span>&nbsp;<span class="ident" id="2899889">r</span>&nbsp;<span class="op" id="2899891">!=</span>&nbsp;<span class="ident" id="2899894">sr</span>&nbsp;<span class="op" id="2899897">&amp;&amp;</span>&nbsp;<span class="ident" id="2899900">r</span>&nbsp;<span class="op" id="2899902">&lt;</span>&nbsp;<span class="ident" id="2899904">tr</span>&nbsp;<span class="op" id="2899907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2899912">r</span>&nbsp;<span class="op" id="2899914">=</span>&nbsp;<span class="ident" id="2899916">unicode</span><span class="op" id="2899923">.</span><span class="ident" id="2899924">SimpleFold</span><span class="op" id="2899934">(</span><span class="ident" id="2899935">r</span><span class="op" id="2899936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899940">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899944">if</span>&nbsp;<span class="ident" id="2899947">r</span>&nbsp;<span class="op" id="2899949">==</span>&nbsp;<span class="ident" id="2899952">tr</span>&nbsp;<span class="op" id="2899955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899960">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2899975">return</span>&nbsp;<span class="builtintype" id="2899982">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2899989">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2899993">//&nbsp;One&nbsp;string&nbsp;is&nbsp;empty.&nbsp;&nbsp;Are&nbsp;both?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2900029">return</span>&nbsp;<span class="builtinfunc" id="2900036">len</span><span class="op" id="2900039">(</span><span class="ident" id="2900040">s</span><span class="op" id="2900041">)</span>&nbsp;<span class="op" id="2900043">==</span>&nbsp;<span class="builtinfunc" id="2900046">len</span><span class="op" id="2900049">(</span><span class="ident" id="2900050">t</span><span class="op" id="2900051">)</span><br>
<span class="lineno"></span><span class="op" id="2900053">}</span>
</div>
</body>
</html>
