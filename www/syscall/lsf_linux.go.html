<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2269286">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2269342">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2269396">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2269447">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2269471">package</span>&nbsp;<span class="ident" id="2269479">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2269488">import</span>&nbsp;<span class="op" id="2269495">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2269498">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2269507">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2269510">func</span>&nbsp;<span class="ident" id="2269515">LsfStmt</span><span class="op" id="2269522">(</span><span class="ident" id="2269523">code</span><span class="op" id="2269527">,</span>&nbsp;<span class="ident" id="2269529">k</span>&nbsp;<span class="builtintype" id="2269531">int</span><span class="op" id="2269534">)</span>&nbsp;<span class="op" id="2269536">*</span><span class="ident" id="2269537">SockFilter</span>&nbsp;<span class="op" id="2269548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269551">return</span>&nbsp;<span class="op" id="2269558">&amp;</span><span class="ident" id="2269559">SockFilter</span><span class="op" id="2269569">{</span><span class="ident" id="2269570">Code</span><span class="op" id="2269574">:</span>&nbsp;<span class="builtintype" id="2269576">uint16</span><span class="op" id="2269582">(</span><span class="ident" id="2269583">code</span><span class="op" id="2269587">)</span><span class="op" id="2269588">,</span>&nbsp;<span class="ident" id="2269590">K</span><span class="op" id="2269591">:</span>&nbsp;<span class="builtintype" id="2269593">uint32</span><span class="op" id="2269599">(</span><span class="ident" id="2269600">k</span><span class="op" id="2269601">)</span><span class="op" id="2269602">}</span><br>
<span class="lineno">15</span><span class="op" id="2269604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2269607">func</span>&nbsp;<span class="ident" id="2269612">LsfJump</span><span class="op" id="2269619">(</span><span class="ident" id="2269620">code</span><span class="op" id="2269624">,</span>&nbsp;<span class="ident" id="2269626">k</span><span class="op" id="2269627">,</span>&nbsp;<span class="ident" id="2269629">jt</span><span class="op" id="2269631">,</span>&nbsp;<span class="ident" id="2269633">jf</span>&nbsp;<span class="builtintype" id="2269636">int</span><span class="op" id="2269639">)</span>&nbsp;<span class="op" id="2269641">*</span><span class="ident" id="2269642">SockFilter</span>&nbsp;<span class="op" id="2269653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269656">return</span>&nbsp;<span class="op" id="2269663">&amp;</span><span class="ident" id="2269664">SockFilter</span><span class="op" id="2269674">{</span><span class="ident" id="2269675">Code</span><span class="op" id="2269679">:</span>&nbsp;<span class="builtintype" id="2269681">uint16</span><span class="op" id="2269687">(</span><span class="ident" id="2269688">code</span><span class="op" id="2269692">)</span><span class="op" id="2269693">,</span>&nbsp;<span class="ident" id="2269695">Jt</span><span class="op" id="2269697">:</span>&nbsp;<span class="builtintype" id="2269699">uint8</span><span class="op" id="2269704">(</span><span class="ident" id="2269705">jt</span><span class="op" id="2269707">)</span><span class="op" id="2269708">,</span>&nbsp;<span class="ident" id="2269710">Jf</span><span class="op" id="2269712">:</span>&nbsp;<span class="builtintype" id="2269714">uint8</span><span class="op" id="2269719">(</span><span class="ident" id="2269720">jf</span><span class="op" id="2269722">)</span><span class="op" id="2269723">,</span>&nbsp;<span class="ident" id="2269725">K</span><span class="op" id="2269726">:</span>&nbsp;<span class="builtintype" id="2269728">uint32</span><span class="op" id="2269734">(</span><span class="ident" id="2269735">k</span><span class="op" id="2269736">)</span><span class="op" id="2269737">}</span><br>
<span class="lineno"></span><span class="op" id="2269739">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2269742">func</span>&nbsp;<span class="ident" id="2269747">LsfSocket</span><span class="op" id="2269756">(</span><span class="ident" id="2269757">ifindex</span><span class="op" id="2269764">,</span>&nbsp;<span class="ident" id="2269766">proto</span>&nbsp;<span class="builtintype" id="2269772">int</span><span class="op" id="2269775">)</span>&nbsp;<span class="op" id="2269777">(</span><span class="builtintype" id="2269778">int</span><span class="op" id="2269781">,</span>&nbsp;<span class="builtintype" id="2269783">error</span><span class="op" id="2269788">)</span>&nbsp;<span class="op" id="2269790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269793">var</span>&nbsp;<span class="ident" id="2269797">lsall</span>&nbsp;<span class="ident" id="2269803">SockaddrLinklayer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269822">s</span><span class="op" id="2269823">,</span>&nbsp;<span class="ident" id="2269825">e</span>&nbsp;<span class="op" id="2269827">:=</span>&nbsp;<span class="ident" id="2269830">Socket</span><span class="op" id="2269836">(</span><span class="ident" id="2269837">AF_PACKET</span><span class="op" id="2269846">,</span>&nbsp;<span class="ident" id="2269848">SOCK_RAW</span><span class="op" id="2269856">,</span>&nbsp;<span class="ident" id="2269858">proto</span><span class="op" id="2269863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269866">if</span>&nbsp;<span class="ident" id="2269869">e</span>&nbsp;<span class="op" id="2269871">!=</span>&nbsp;<span class="ident" id="2269874">nil</span>&nbsp;<span class="op" id="2269878">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269882">return</span>&nbsp;<span class="num" id="2269889">0</span><span class="op" id="2269890">,</span>&nbsp;<span class="ident" id="2269892">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269898">p</span>&nbsp;<span class="op" id="2269900">:=</span>&nbsp;<span class="op" id="2269903">(</span><span class="op" id="2269904">*</span><span class="op" id="2269905">[</span><span class="num" id="2269906">2</span><span class="op" id="2269907">]</span><span class="builtintype" id="2269908">byte</span><span class="op" id="2269912">)</span><span class="op" id="2269913">(</span><span class="ident" id="2269914">unsafe</span><span class="op" id="2269920">.</span><span class="ident" id="2269921">Pointer</span><span class="op" id="2269928">(</span><span class="op" id="2269929">&amp;</span><span class="ident" id="2269930">lsall</span><span class="op" id="2269935">.</span><span class="ident" id="2269936">Protocol</span><span class="op" id="2269944">)</span><span class="op" id="2269945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269948">p</span><span class="op" id="2269949">[</span><span class="num" id="2269950">0</span><span class="op" id="2269951">]</span>&nbsp;<span class="op" id="2269953">=</span>&nbsp;<span class="builtintype" id="2269955">byte</span><span class="op" id="2269959">(</span><span class="ident" id="2269960">proto</span>&nbsp;<span class="op" id="2269966">&gt;&gt;</span>&nbsp;<span class="num" id="2269969">8</span><span class="op" id="2269970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269973">p</span><span class="op" id="2269974">[</span><span class="num" id="2269975">1</span><span class="op" id="2269976">]</span>&nbsp;<span class="op" id="2269978">=</span>&nbsp;<span class="builtintype" id="2269980">byte</span><span class="op" id="2269984">(</span><span class="ident" id="2269985">proto</span><span class="op" id="2269990">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269993">lsall</span><span class="op" id="2269998">.</span><span class="ident" id="2269999">Ifindex</span>&nbsp;<span class="op" id="2270007">=</span>&nbsp;<span class="ident" id="2270009">ifindex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270018">e</span>&nbsp;<span class="op" id="2270020">=</span>&nbsp;<span class="ident" id="2270022">Bind</span><span class="op" id="2270026">(</span><span class="ident" id="2270027">s</span><span class="op" id="2270028">,</span>&nbsp;<span class="op" id="2270030">&amp;</span><span class="ident" id="2270031">lsall</span><span class="op" id="2270036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270039">if</span>&nbsp;<span class="ident" id="2270042">e</span>&nbsp;<span class="op" id="2270044">!=</span>&nbsp;<span class="ident" id="2270047">nil</span>&nbsp;<span class="op" id="2270051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270055">Close</span><span class="op" id="2270060">(</span><span class="ident" id="2270061">s</span><span class="op" id="2270062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270066">return</span>&nbsp;<span class="num" id="2270073">0</span><span class="op" id="2270074">,</span>&nbsp;<span class="ident" id="2270076">e</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270082">return</span>&nbsp;<span class="ident" id="2270089">s</span><span class="op" id="2270090">,</span>&nbsp;<span class="ident" id="2270092">nil</span><br>
<span class="lineno"></span><span class="op" id="2270096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2270099">type</span>&nbsp;<span class="ident" id="2270104">iflags</span>&nbsp;<span class="keyword" id="2270111">struct</span>&nbsp;<span class="op" id="2270118">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270121">name</span>&nbsp;&nbsp;<span class="op" id="2270127">[</span><span class="ident" id="2270128">IFNAMSIZ</span><span class="op" id="2270136">]</span><span class="builtintype" id="2270137">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270143">flags</span>&nbsp;<span class="builtintype" id="2270149">uint16</span><br>
<span class="lineno"></span><span class="op" id="2270156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2270159">func</span>&nbsp;<span class="ident" id="2270164">SetLsfPromisc</span><span class="op" id="2270177">(</span><span class="ident" id="2270178">name</span>&nbsp;<span class="builtintype" id="2270183">string</span><span class="op" id="2270189">,</span>&nbsp;<span class="ident" id="2270191">m</span>&nbsp;<span class="builtintype" id="2270193">bool</span><span class="op" id="2270197">)</span>&nbsp;<span class="builtintype" id="2270199">error</span>&nbsp;<span class="op" id="2270205">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270208">s</span><span class="op" id="2270209">,</span>&nbsp;<span class="ident" id="2270211">e</span>&nbsp;<span class="op" id="2270213">:=</span>&nbsp;<span class="ident" id="2270216">Socket</span><span class="op" id="2270222">(</span><span class="ident" id="2270223">AF_INET</span><span class="op" id="2270230">,</span>&nbsp;<span class="ident" id="2270232">SOCK_DGRAM</span><span class="op" id="2270242">,</span>&nbsp;<span class="num" id="2270244">0</span><span class="op" id="2270245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270248">if</span>&nbsp;<span class="ident" id="2270251">e</span>&nbsp;<span class="op" id="2270253">!=</span>&nbsp;<span class="ident" id="2270256">nil</span>&nbsp;<span class="op" id="2270260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270264">return</span>&nbsp;<span class="ident" id="2270271">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270277">defer</span>&nbsp;<span class="ident" id="2270283">Close</span><span class="op" id="2270288">(</span><span class="ident" id="2270289">s</span><span class="op" id="2270290">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270293">var</span>&nbsp;<span class="ident" id="2270297">ifl</span>&nbsp;<span class="ident" id="2270301">iflags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2270309">copy</span><span class="op" id="2270313">(</span><span class="ident" id="2270314">ifl</span><span class="op" id="2270317">.</span><span class="ident" id="2270318">name</span><span class="op" id="2270322">[</span><span class="op" id="2270323">:</span><span class="op" id="2270324">]</span><span class="op" id="2270325">,</span>&nbsp;<span class="op" id="2270327">[</span><span class="op" id="2270328">]</span><span class="builtintype" id="2270329">byte</span><span class="op" id="2270333">(</span><span class="ident" id="2270334">name</span><span class="op" id="2270338">)</span><span class="op" id="2270339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270342">_</span><span class="op" id="2270343">,</span>&nbsp;<span class="ident" id="2270345">_</span><span class="op" id="2270346">,</span>&nbsp;<span class="ident" id="2270348">ep</span>&nbsp;<span class="op" id="2270351">:=</span>&nbsp;<span class="ident" id="2270354">Syscall</span><span class="op" id="2270361">(</span><span class="ident" id="2270362">SYS_IOCTL</span><span class="op" id="2270371">,</span>&nbsp;<span class="builtintype" id="2270373">uintptr</span><span class="op" id="2270380">(</span><span class="ident" id="2270381">s</span><span class="op" id="2270382">)</span><span class="op" id="2270383">,</span>&nbsp;<span class="ident" id="2270385">SIOCGIFFLAGS</span><span class="op" id="2270397">,</span>&nbsp;<span class="builtintype" id="2270399">uintptr</span><span class="op" id="2270406">(</span><span class="ident" id="2270407">unsafe</span><span class="op" id="2270413">.</span><span class="ident" id="2270414">Pointer</span><span class="op" id="2270421">(</span><span class="op" id="2270422">&amp;</span><span class="ident" id="2270423">ifl</span><span class="op" id="2270426">)</span><span class="op" id="2270427">)</span><span class="op" id="2270428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270431">if</span>&nbsp;<span class="ident" id="2270434">ep</span>&nbsp;<span class="op" id="2270437">!=</span>&nbsp;<span class="num" id="2270440">0</span>&nbsp;<span class="op" id="2270442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270446">return</span>&nbsp;<span class="ident" id="2270453">Errno</span><span class="op" id="2270458">(</span><span class="ident" id="2270459">ep</span><span class="op" id="2270461">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270467">if</span>&nbsp;<span class="ident" id="2270470">m</span>&nbsp;<span class="op" id="2270472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270476">ifl</span><span class="op" id="2270479">.</span><span class="ident" id="2270480">flags</span>&nbsp;<span class="op" id="2270486">|=</span>&nbsp;<span class="builtintype" id="2270489">uint16</span><span class="op" id="2270495">(</span><span class="ident" id="2270496">IFF_PROMISC</span><span class="op" id="2270507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270510">}</span>&nbsp;<span class="keyword" id="2270512">else</span>&nbsp;<span class="op" id="2270517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270521">ifl</span><span class="op" id="2270524">.</span><span class="ident" id="2270525">flags</span>&nbsp;<span class="op" id="2270531">&amp;=</span>&nbsp;<span class="op" id="2270534">^</span><span class="builtintype" id="2270535">uint16</span><span class="op" id="2270541">(</span><span class="ident" id="2270542">IFF_PROMISC</span><span class="op" id="2270553">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270559">_</span><span class="op" id="2270560">,</span>&nbsp;<span class="ident" id="2270562">_</span><span class="op" id="2270563">,</span>&nbsp;<span class="ident" id="2270565">ep</span>&nbsp;<span class="op" id="2270568">=</span>&nbsp;<span class="ident" id="2270570">Syscall</span><span class="op" id="2270577">(</span><span class="ident" id="2270578">SYS_IOCTL</span><span class="op" id="2270587">,</span>&nbsp;<span class="builtintype" id="2270589">uintptr</span><span class="op" id="2270596">(</span><span class="ident" id="2270597">s</span><span class="op" id="2270598">)</span><span class="op" id="2270599">,</span>&nbsp;<span class="ident" id="2270601">SIOCSIFFLAGS</span><span class="op" id="2270613">,</span>&nbsp;<span class="builtintype" id="2270615">uintptr</span><span class="op" id="2270622">(</span><span class="ident" id="2270623">unsafe</span><span class="op" id="2270629">.</span><span class="ident" id="2270630">Pointer</span><span class="op" id="2270637">(</span><span class="op" id="2270638">&amp;</span><span class="ident" id="2270639">ifl</span><span class="op" id="2270642">)</span><span class="op" id="2270643">)</span><span class="op" id="2270644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270647">if</span>&nbsp;<span class="ident" id="2270650">ep</span>&nbsp;<span class="op" id="2270653">!=</span>&nbsp;<span class="num" id="2270656">0</span>&nbsp;<span class="op" id="2270658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270662">return</span>&nbsp;<span class="ident" id="2270669">Errno</span><span class="op" id="2270674">(</span><span class="ident" id="2270675">ep</span><span class="op" id="2270677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270680">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270683">return</span>&nbsp;<span class="ident" id="2270690">nil</span><br>
<span class="lineno"></span><span class="op" id="2270694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2270697">func</span>&nbsp;<span class="ident" id="2270702">AttachLsf</span><span class="op" id="2270711">(</span><span class="ident" id="2270712">fd</span>&nbsp;<span class="builtintype" id="2270715">int</span><span class="op" id="2270718">,</span>&nbsp;<span class="ident" id="2270720">i</span>&nbsp;<span class="op" id="2270722">[</span><span class="op" id="2270723">]</span><span class="ident" id="2270724">SockFilter</span><span class="op" id="2270734">)</span>&nbsp;<span class="builtintype" id="2270736">error</span>&nbsp;<span class="op" id="2270742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270745">var</span>&nbsp;<span class="ident" id="2270749">p</span>&nbsp;<span class="ident" id="2270751">SockFprog</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270762">p</span><span class="op" id="2270763">.</span><span class="ident" id="2270764">Len</span>&nbsp;<span class="op" id="2270768">=</span>&nbsp;<span class="builtintype" id="2270770">uint16</span><span class="op" id="2270776">(</span><span class="builtinfunc" id="2270777">len</span><span class="op" id="2270780">(</span><span class="ident" id="2270781">i</span><span class="op" id="2270782">)</span><span class="op" id="2270783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270786">p</span><span class="op" id="2270787">.</span><span class="ident" id="2270788">Filter</span>&nbsp;<span class="op" id="2270795">=</span>&nbsp;<span class="op" id="2270797">(</span><span class="op" id="2270798">*</span><span class="ident" id="2270799">SockFilter</span><span class="op" id="2270809">)</span><span class="op" id="2270810">(</span><span class="ident" id="2270811">unsafe</span><span class="op" id="2270817">.</span><span class="ident" id="2270818">Pointer</span><span class="op" id="2270825">(</span><span class="op" id="2270826">&amp;</span><span class="ident" id="2270827">i</span><span class="op" id="2270828">[</span><span class="num" id="2270829">0</span><span class="op" id="2270830">]</span><span class="op" id="2270831">)</span><span class="op" id="2270832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270835">return</span>&nbsp;<span class="ident" id="2270842">setsockopt</span><span class="op" id="2270852">(</span><span class="ident" id="2270853">fd</span><span class="op" id="2270855">,</span>&nbsp;<span class="ident" id="2270857">SOL_SOCKET</span><span class="op" id="2270867">,</span>&nbsp;<span class="ident" id="2270869">SO_ATTACH_FILTER</span><span class="op" id="2270885">,</span>&nbsp;<span class="ident" id="2270887">unsafe</span><span class="op" id="2270893">.</span><span class="ident" id="2270894">Pointer</span><span class="op" id="2270901">(</span><span class="op" id="2270902">&amp;</span><span class="ident" id="2270903">p</span><span class="op" id="2270904">)</span><span class="op" id="2270905">,</span>&nbsp;<span class="ident" id="2270907">unsafe</span><span class="op" id="2270913">.</span><span class="ident" id="2270914">Sizeof</span><span class="op" id="2270920">(</span><span class="ident" id="2270921">p</span><span class="op" id="2270922">)</span><span class="op" id="2270923">)</span><br>
<span class="lineno"></span><span class="op" id="2270925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="2270928">func</span>&nbsp;<span class="ident" id="2270933">DetachLsf</span><span class="op" id="2270942">(</span><span class="ident" id="2270943">fd</span>&nbsp;<span class="builtintype" id="2270946">int</span><span class="op" id="2270949">)</span>&nbsp;<span class="builtintype" id="2270951">error</span>&nbsp;<span class="op" id="2270957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270960">var</span>&nbsp;<span class="ident" id="2270964">dummy</span>&nbsp;<span class="builtintype" id="2270970">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270975">return</span>&nbsp;<span class="ident" id="2270982">setsockopt</span><span class="op" id="2270992">(</span><span class="ident" id="2270993">fd</span><span class="op" id="2270995">,</span>&nbsp;<span class="ident" id="2270997">SOL_SOCKET</span><span class="op" id="2271007">,</span>&nbsp;<span class="ident" id="2271009">SO_DETACH_FILTER</span><span class="op" id="2271025">,</span>&nbsp;<span class="ident" id="2271027">unsafe</span><span class="op" id="2271033">.</span><span class="ident" id="2271034">Pointer</span><span class="op" id="2271041">(</span><span class="op" id="2271042">&amp;</span><span class="ident" id="2271043">dummy</span><span class="op" id="2271048">)</span><span class="op" id="2271049">,</span>&nbsp;<span class="ident" id="2271051">unsafe</span><span class="op" id="2271057">.</span><span class="ident" id="2271058">Sizeof</span><span class="op" id="2271064">(</span><span class="ident" id="2271065">dummy</span><span class="op" id="2271070">)</span><span class="op" id="2271071">)</span><br>
<span class="lineno"></span><span class="op" id="2271073">}</span>
</div>
</body>
</html>
