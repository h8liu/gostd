<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html" class="current">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3974489">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3974545">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3974599">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3974650">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3974726">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3974779">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3974794">package</span>&nbsp;<span class="ident" id="3974802">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3974808">import</span>&nbsp;<span class="op" id="3974815">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3974818">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3974827">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3974841">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3974858">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3974864">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3974870">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3974881">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3974889">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3974896">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3974899">const</span>&nbsp;<span class="ident" id="3974905">urandomDevice</span>&nbsp;<span class="op" id="3974919">=</span>&nbsp;<span class="string" id="3974921">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3974937">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="3974985">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3975037">func</span>&nbsp;<span class="ident" id="3975042">init</span><span class="op" id="3975046">(</span><span class="op" id="3975047">)</span>&nbsp;<span class="op" id="3975049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975052">if</span>&nbsp;<span class="ident" id="3975055">runtime</span><span class="op" id="3975062">.</span><span class="ident" id="3975063">GOOS</span>&nbsp;<span class="op" id="3975068">==</span>&nbsp;<span class="string" id="3975071">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3975079">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975083">Reader</span>&nbsp;<span class="op" id="3975090">=</span>&nbsp;<span class="ident" id="3975092">newReader</span><span class="op" id="3975101">(</span><span class="builtintype" id="3975102">nil</span><span class="op" id="3975105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975108">}</span>&nbsp;<span class="keyword" id="3975110">else</span>&nbsp;<span class="op" id="3975115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975119">Reader</span>&nbsp;<span class="op" id="3975126">=</span>&nbsp;<span class="op" id="3975128">&amp;</span><span class="ident" id="3975129">devReader</span><span class="op" id="3975138">{</span><span class="ident" id="3975139">name</span><span class="op" id="3975143">:</span>&nbsp;<span class="ident" id="3975145">urandomDevice</span><span class="op" id="3975158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975161">}</span><br>
<span class="lineno"></span><span class="op" id="3975163">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3975166">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3975229">type</span>&nbsp;<span class="ident" id="3975234">devReader</span>&nbsp;<span class="keyword" id="3975244">struct</span>&nbsp;<span class="op" id="3975251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975254">name</span>&nbsp;<span class="builtintype" id="3975259">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975267">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975272">io</span><span class="op" id="3975274">.</span><span class="ident" id="3975275">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975283">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3975288">sync</span><span class="op" id="3975292">.</span><span class="ident" id="3975293">Mutex</span><br>
<span class="lineno"></span><span class="op" id="3975299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3975302">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="3975370">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="3975399">var</span>&nbsp;<span class="ident" id="3975403">altGetRandom</span>&nbsp;<span class="keyword" id="3975416">func</span><span class="op" id="3975420">(</span><span class="op" id="3975421">[</span><span class="op" id="3975422">]</span><span class="builtintype" id="3975423">byte</span><span class="op" id="3975427">)</span>&nbsp;<span class="op" id="3975429">(</span><span class="ident" id="3975430">ok</span>&nbsp;<span class="builtintype" id="3975433">bool</span><span class="op" id="3975437">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3975440">func</span>&nbsp;<span class="op" id="3975445">(</span><span class="ident" id="3975446">r</span>&nbsp;<span class="op" id="3975448">*</span><span class="ident" id="3975449">devReader</span><span class="op" id="3975458">)</span>&nbsp;<span class="ident" id="3975460">Read</span><span class="op" id="3975464">(</span><span class="ident" id="3975465">b</span>&nbsp;<span class="op" id="3975467">[</span><span class="op" id="3975468">]</span><span class="builtintype" id="3975469">byte</span><span class="op" id="3975473">)</span>&nbsp;<span class="op" id="3975475">(</span><span class="ident" id="3975476">n</span>&nbsp;<span class="builtintype" id="3975478">int</span><span class="op" id="3975481">,</span>&nbsp;<span class="ident" id="3975483">err</span>&nbsp;<span class="builtintype" id="3975487">error</span><span class="op" id="3975492">)</span>&nbsp;<span class="op" id="3975494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975497">if</span>&nbsp;<span class="ident" id="3975500">altGetRandom</span>&nbsp;<span class="op" id="3975513">!=</span>&nbsp;<span class="builtintype" id="3975516">nil</span>&nbsp;<span class="op" id="3975520">&amp;&amp;</span>&nbsp;<span class="ident" id="3975523">r</span><span class="op" id="3975524">.</span><span class="ident" id="3975525">name</span>&nbsp;<span class="op" id="3975530">==</span>&nbsp;<span class="ident" id="3975533">urandomDevice</span>&nbsp;<span class="op" id="3975547">&amp;&amp;</span>&nbsp;<span class="ident" id="3975550">altGetRandom</span><span class="op" id="3975562">(</span><span class="ident" id="3975563">b</span><span class="op" id="3975564">)</span>&nbsp;<span class="op" id="3975566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975570">return</span>&nbsp;<span class="builtinfunc" id="3975577">len</span><span class="op" id="3975580">(</span><span class="ident" id="3975581">b</span><span class="op" id="3975582">)</span><span class="op" id="3975583">,</span>&nbsp;<span class="builtintype" id="3975585">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975593">r</span><span class="op" id="3975594">.</span><span class="ident" id="3975595">mu</span><span class="op" id="3975597">.</span><span class="ident" id="3975598">Lock</span><span class="op" id="3975602">(</span><span class="op" id="3975603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975606">defer</span>&nbsp;<span class="ident" id="3975612">r</span><span class="op" id="3975613">.</span><span class="ident" id="3975614">mu</span><span class="op" id="3975616">.</span><span class="ident" id="3975617">Unlock</span><span class="op" id="3975623">(</span><span class="op" id="3975624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975627">if</span>&nbsp;<span class="ident" id="3975630">r</span><span class="op" id="3975631">.</span><span class="ident" id="3975632">f</span>&nbsp;<span class="op" id="3975634">==</span>&nbsp;<span class="builtintype" id="3975637">nil</span>&nbsp;<span class="op" id="3975641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975645">f</span><span class="op" id="3975646">,</span>&nbsp;<span class="ident" id="3975648">err</span>&nbsp;<span class="op" id="3975652">:=</span>&nbsp;<span class="ident" id="3975655">os</span><span class="op" id="3975657">.</span><span class="ident" id="3975658">Open</span><span class="op" id="3975662">(</span><span class="ident" id="3975663">r</span><span class="op" id="3975664">.</span><span class="ident" id="3975665">name</span><span class="op" id="3975669">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975673">if</span>&nbsp;<span class="ident" id="3975676">f</span>&nbsp;<span class="op" id="3975678">==</span>&nbsp;<span class="builtintype" id="3975681">nil</span>&nbsp;<span class="op" id="3975685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975690">return</span>&nbsp;<span class="num" id="3975697">0</span><span class="op" id="3975698">,</span>&nbsp;<span class="ident" id="3975700">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975710">if</span>&nbsp;<span class="ident" id="3975713">runtime</span><span class="op" id="3975720">.</span><span class="ident" id="3975721">GOOS</span>&nbsp;<span class="op" id="3975726">==</span>&nbsp;<span class="string" id="3975729">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3975737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975742">r</span><span class="op" id="3975743">.</span><span class="ident" id="3975744">f</span>&nbsp;<span class="op" id="3975746">=</span>&nbsp;<span class="ident" id="3975748">f</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975752">}</span>&nbsp;<span class="keyword" id="3975754">else</span>&nbsp;<span class="op" id="3975759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975764">r</span><span class="op" id="3975765">.</span><span class="ident" id="3975766">f</span>&nbsp;<span class="op" id="3975768">=</span>&nbsp;<span class="ident" id="3975770">bufio</span><span class="op" id="3975775">.</span><span class="ident" id="3975776">NewReader</span><span class="op" id="3975785">(</span><span class="ident" id="3975786">f</span><span class="op" id="3975787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975797">return</span>&nbsp;<span class="ident" id="3975804">r</span><span class="op" id="3975805">.</span><span class="ident" id="3975806">f</span><span class="op" id="3975807">.</span><span class="ident" id="3975808">Read</span><span class="op" id="3975812">(</span><span class="ident" id="3975813">b</span><span class="op" id="3975814">)</span><br>
<span class="lineno">65</span><span class="op" id="3975816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3975819">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3975872">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3975917">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3975972">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="3976033">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3976092">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="3976143">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="3976200">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3976259">//</span><br>
<span class="lineno"></span><span class="comment" id="3976262">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="3976318">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3976367">func</span>&nbsp;<span class="ident" id="3976372">newReader</span><span class="op" id="3976381">(</span><span class="ident" id="3976382">entropy</span>&nbsp;<span class="ident" id="3976390">io</span><span class="op" id="3976392">.</span><span class="ident" id="3976393">Reader</span><span class="op" id="3976399">)</span>&nbsp;<span class="ident" id="3976401">io</span><span class="op" id="3976403">.</span><span class="ident" id="3976404">Reader</span>&nbsp;<span class="op" id="3976411">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976414">if</span>&nbsp;<span class="ident" id="3976417">entropy</span>&nbsp;<span class="op" id="3976425">==</span>&nbsp;<span class="builtintype" id="3976428">nil</span>&nbsp;<span class="op" id="3976432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976436">entropy</span>&nbsp;<span class="op" id="3976444">=</span>&nbsp;<span class="op" id="3976446">&amp;</span><span class="ident" id="3976447">devReader</span><span class="op" id="3976456">{</span><span class="ident" id="3976457">name</span><span class="op" id="3976461">:</span>&nbsp;<span class="string" id="3976463">&#34;/dev/random&#34;</span><span class="op" id="3976476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3976479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976482">return</span>&nbsp;<span class="op" id="3976489">&amp;</span><span class="ident" id="3976490">reader</span><span class="op" id="3976496">{</span><span class="ident" id="3976497">entropy</span><span class="op" id="3976504">:</span>&nbsp;<span class="ident" id="3976506">entropy</span><span class="op" id="3976513">}</span><br>
<span class="lineno"></span><span class="op" id="3976515">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3976518">type</span>&nbsp;<span class="ident" id="3976523">reader</span>&nbsp;<span class="keyword" id="3976530">struct</span>&nbsp;<span class="op" id="3976537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976540">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976561">sync</span><span class="op" id="3976565">.</span><span class="ident" id="3976566">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976573">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3976594">int</span>&nbsp;<span class="comment" id="3976598">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976640">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976661">cipher</span><span class="op" id="3976667">.</span><span class="ident" id="3976668">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976675">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976696">io</span><span class="op" id="3976698">.</span><span class="ident" id="3976699">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976707">time</span><span class="op" id="3976711">,</span>&nbsp;<span class="ident" id="3976713">seed</span><span class="op" id="3976717">,</span>&nbsp;<span class="ident" id="3976719">dst</span><span class="op" id="3976722">,</span>&nbsp;<span class="ident" id="3976724">key</span>&nbsp;<span class="op" id="3976728">[</span><span class="ident" id="3976729">aes</span><span class="op" id="3976732">.</span><span class="ident" id="3976733">BlockSize</span><span class="op" id="3976742">]</span><span class="builtintype" id="3976743">byte</span><br>
<span class="lineno"></span><span class="op" id="3976748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3976751">func</span>&nbsp;<span class="op" id="3976756">(</span><span class="ident" id="3976757">r</span>&nbsp;<span class="op" id="3976759">*</span><span class="ident" id="3976760">reader</span><span class="op" id="3976766">)</span>&nbsp;<span class="ident" id="3976768">Read</span><span class="op" id="3976772">(</span><span class="ident" id="3976773">b</span>&nbsp;<span class="op" id="3976775">[</span><span class="op" id="3976776">]</span><span class="builtintype" id="3976777">byte</span><span class="op" id="3976781">)</span>&nbsp;<span class="op" id="3976783">(</span><span class="ident" id="3976784">n</span>&nbsp;<span class="builtintype" id="3976786">int</span><span class="op" id="3976789">,</span>&nbsp;<span class="ident" id="3976791">err</span>&nbsp;<span class="builtintype" id="3976795">error</span><span class="op" id="3976800">)</span>&nbsp;<span class="op" id="3976802">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976805">r</span><span class="op" id="3976806">.</span><span class="ident" id="3976807">mu</span><span class="op" id="3976809">.</span><span class="ident" id="3976810">Lock</span><span class="op" id="3976814">(</span><span class="op" id="3976815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976818">defer</span>&nbsp;<span class="ident" id="3976824">r</span><span class="op" id="3976825">.</span><span class="ident" id="3976826">mu</span><span class="op" id="3976828">.</span><span class="ident" id="3976829">Unlock</span><span class="op" id="3976835">(</span><span class="op" id="3976836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976839">n</span>&nbsp;<span class="op" id="3976841">=</span>&nbsp;<span class="builtinfunc" id="3976843">len</span><span class="op" id="3976846">(</span><span class="ident" id="3976847">b</span><span class="op" id="3976848">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976852">for</span>&nbsp;<span class="builtinfunc" id="3976856">len</span><span class="op" id="3976859">(</span><span class="ident" id="3976860">b</span><span class="op" id="3976861">)</span>&nbsp;<span class="op" id="3976863">&gt;</span>&nbsp;<span class="num" id="3976865">0</span>&nbsp;<span class="op" id="3976867">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976871">if</span>&nbsp;<span class="ident" id="3976874">r</span><span class="op" id="3976875">.</span><span class="ident" id="3976876">budget</span>&nbsp;<span class="op" id="3976883">==</span>&nbsp;<span class="num" id="3976886">0</span>&nbsp;<span class="op" id="3976888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976893">_</span><span class="op" id="3976894">,</span>&nbsp;<span class="ident" id="3976896">err</span>&nbsp;<span class="op" id="3976900">:=</span>&nbsp;<span class="ident" id="3976903">io</span><span class="op" id="3976905">.</span><span class="ident" id="3976906">ReadFull</span><span class="op" id="3976914">(</span><span class="ident" id="3976915">r</span><span class="op" id="3976916">.</span><span class="ident" id="3976917">entropy</span><span class="op" id="3976924">,</span>&nbsp;<span class="ident" id="3976926">r</span><span class="op" id="3976927">.</span><span class="ident" id="3976928">seed</span><span class="op" id="3976932">[</span><span class="num" id="3976933">0</span><span class="op" id="3976934">:</span><span class="op" id="3976935">]</span><span class="op" id="3976936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976941">if</span>&nbsp;<span class="ident" id="3976944">err</span>&nbsp;<span class="op" id="3976948">!=</span>&nbsp;<span class="builtintype" id="3976951">nil</span>&nbsp;<span class="op" id="3976955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976961">return</span>&nbsp;<span class="ident" id="3976968">n</span>&nbsp;<span class="op" id="3976970">-</span>&nbsp;<span class="builtinfunc" id="3976972">len</span><span class="op" id="3976975">(</span><span class="ident" id="3976976">b</span><span class="op" id="3976977">)</span><span class="op" id="3976978">,</span>&nbsp;<span class="ident" id="3976980">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3976987">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976992">_</span><span class="op" id="3976993">,</span>&nbsp;<span class="ident" id="3976995">err</span>&nbsp;<span class="op" id="3976999">=</span>&nbsp;<span class="ident" id="3977001">io</span><span class="op" id="3977003">.</span><span class="ident" id="3977004">ReadFull</span><span class="op" id="3977012">(</span><span class="ident" id="3977013">r</span><span class="op" id="3977014">.</span><span class="ident" id="3977015">entropy</span><span class="op" id="3977022">,</span>&nbsp;<span class="ident" id="3977024">r</span><span class="op" id="3977025">.</span><span class="ident" id="3977026">key</span><span class="op" id="3977029">[</span><span class="num" id="3977030">0</span><span class="op" id="3977031">:</span><span class="op" id="3977032">]</span><span class="op" id="3977033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977038">if</span>&nbsp;<span class="ident" id="3977041">err</span>&nbsp;<span class="op" id="3977045">!=</span>&nbsp;<span class="builtintype" id="3977048">nil</span>&nbsp;<span class="op" id="3977052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977058">return</span>&nbsp;<span class="ident" id="3977065">n</span>&nbsp;<span class="op" id="3977067">-</span>&nbsp;<span class="builtinfunc" id="3977069">len</span><span class="op" id="3977072">(</span><span class="ident" id="3977073">b</span><span class="op" id="3977074">)</span><span class="op" id="3977075">,</span>&nbsp;<span class="ident" id="3977077">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977089">r</span><span class="op" id="3977090">.</span><span class="ident" id="3977091">cipher</span><span class="op" id="3977097">,</span>&nbsp;<span class="ident" id="3977099">err</span>&nbsp;<span class="op" id="3977103">=</span>&nbsp;<span class="ident" id="3977105">aes</span><span class="op" id="3977108">.</span><span class="ident" id="3977109">NewCipher</span><span class="op" id="3977118">(</span><span class="ident" id="3977119">r</span><span class="op" id="3977120">.</span><span class="ident" id="3977121">key</span><span class="op" id="3977124">[</span><span class="num" id="3977125">0</span><span class="op" id="3977126">:</span><span class="op" id="3977127">]</span><span class="op" id="3977128">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977133">if</span>&nbsp;<span class="ident" id="3977136">err</span>&nbsp;<span class="op" id="3977140">!=</span>&nbsp;<span class="builtintype" id="3977143">nil</span>&nbsp;<span class="op" id="3977147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977153">return</span>&nbsp;<span class="ident" id="3977160">n</span>&nbsp;<span class="op" id="3977162">-</span>&nbsp;<span class="builtinfunc" id="3977164">len</span><span class="op" id="3977167">(</span><span class="ident" id="3977168">b</span><span class="op" id="3977169">)</span><span class="op" id="3977170">,</span>&nbsp;<span class="ident" id="3977172">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977184">r</span><span class="op" id="3977185">.</span><span class="ident" id="3977186">budget</span>&nbsp;<span class="op" id="3977193">=</span>&nbsp;<span class="num" id="3977195">1</span>&nbsp;<span class="op" id="3977197">&lt;&lt;</span>&nbsp;<span class="num" id="3977200">20</span>&nbsp;<span class="comment" id="3977203">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977236">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977240">r</span><span class="op" id="3977241">.</span><span class="ident" id="3977242">budget</span>&nbsp;<span class="op" id="3977249">-=</span>&nbsp;<span class="ident" id="3977252">aes</span><span class="op" id="3977255">.</span><span class="ident" id="3977256">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3977269">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3977339">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3977344">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3977363">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3977386">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3977413">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977440">ns</span>&nbsp;<span class="op" id="3977443">:=</span>&nbsp;<span class="ident" id="3977446">time</span><span class="op" id="3977450">.</span><span class="ident" id="3977451">Now</span><span class="op" id="3977454">(</span><span class="op" id="3977455">)</span><span class="op" id="3977456">.</span><span class="ident" id="3977457">UnixNano</span><span class="op" id="3977465">(</span><span class="op" id="3977466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977470">r</span><span class="op" id="3977471">.</span><span class="ident" id="3977472">time</span><span class="op" id="3977476">[</span><span class="num" id="3977477">0</span><span class="op" id="3977478">]</span>&nbsp;<span class="op" id="3977480">=</span>&nbsp;<span class="builtintype" id="3977482">byte</span><span class="op" id="3977486">(</span><span class="ident" id="3977487">ns</span>&nbsp;<span class="op" id="3977490">&gt;&gt;</span>&nbsp;<span class="num" id="3977493">56</span><span class="op" id="3977495">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977499">r</span><span class="op" id="3977500">.</span><span class="ident" id="3977501">time</span><span class="op" id="3977505">[</span><span class="num" id="3977506">1</span><span class="op" id="3977507">]</span>&nbsp;<span class="op" id="3977509">=</span>&nbsp;<span class="builtintype" id="3977511">byte</span><span class="op" id="3977515">(</span><span class="ident" id="3977516">ns</span>&nbsp;<span class="op" id="3977519">&gt;&gt;</span>&nbsp;<span class="num" id="3977522">48</span><span class="op" id="3977524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977528">r</span><span class="op" id="3977529">.</span><span class="ident" id="3977530">time</span><span class="op" id="3977534">[</span><span class="num" id="3977535">2</span><span class="op" id="3977536">]</span>&nbsp;<span class="op" id="3977538">=</span>&nbsp;<span class="builtintype" id="3977540">byte</span><span class="op" id="3977544">(</span><span class="ident" id="3977545">ns</span>&nbsp;<span class="op" id="3977548">&gt;&gt;</span>&nbsp;<span class="num" id="3977551">40</span><span class="op" id="3977553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977557">r</span><span class="op" id="3977558">.</span><span class="ident" id="3977559">time</span><span class="op" id="3977563">[</span><span class="num" id="3977564">3</span><span class="op" id="3977565">]</span>&nbsp;<span class="op" id="3977567">=</span>&nbsp;<span class="builtintype" id="3977569">byte</span><span class="op" id="3977573">(</span><span class="ident" id="3977574">ns</span>&nbsp;<span class="op" id="3977577">&gt;&gt;</span>&nbsp;<span class="num" id="3977580">32</span><span class="op" id="3977582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977586">r</span><span class="op" id="3977587">.</span><span class="ident" id="3977588">time</span><span class="op" id="3977592">[</span><span class="num" id="3977593">4</span><span class="op" id="3977594">]</span>&nbsp;<span class="op" id="3977596">=</span>&nbsp;<span class="builtintype" id="3977598">byte</span><span class="op" id="3977602">(</span><span class="ident" id="3977603">ns</span>&nbsp;<span class="op" id="3977606">&gt;&gt;</span>&nbsp;<span class="num" id="3977609">24</span><span class="op" id="3977611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977615">r</span><span class="op" id="3977616">.</span><span class="ident" id="3977617">time</span><span class="op" id="3977621">[</span><span class="num" id="3977622">5</span><span class="op" id="3977623">]</span>&nbsp;<span class="op" id="3977625">=</span>&nbsp;<span class="builtintype" id="3977627">byte</span><span class="op" id="3977631">(</span><span class="ident" id="3977632">ns</span>&nbsp;<span class="op" id="3977635">&gt;&gt;</span>&nbsp;<span class="num" id="3977638">16</span><span class="op" id="3977640">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977644">r</span><span class="op" id="3977645">.</span><span class="ident" id="3977646">time</span><span class="op" id="3977650">[</span><span class="num" id="3977651">6</span><span class="op" id="3977652">]</span>&nbsp;<span class="op" id="3977654">=</span>&nbsp;<span class="builtintype" id="3977656">byte</span><span class="op" id="3977660">(</span><span class="ident" id="3977661">ns</span>&nbsp;<span class="op" id="3977664">&gt;&gt;</span>&nbsp;<span class="num" id="3977667">8</span><span class="op" id="3977668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977672">r</span><span class="op" id="3977673">.</span><span class="ident" id="3977674">time</span><span class="op" id="3977678">[</span><span class="num" id="3977679">7</span><span class="op" id="3977680">]</span>&nbsp;<span class="op" id="3977682">=</span>&nbsp;<span class="builtintype" id="3977684">byte</span><span class="op" id="3977688">(</span><span class="ident" id="3977689">ns</span><span class="op" id="3977691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977695">r</span><span class="op" id="3977696">.</span><span class="ident" id="3977697">cipher</span><span class="op" id="3977703">.</span><span class="ident" id="3977704">Encrypt</span><span class="op" id="3977711">(</span><span class="ident" id="3977712">r</span><span class="op" id="3977713">.</span><span class="ident" id="3977714">time</span><span class="op" id="3977718">[</span><span class="num" id="3977719">0</span><span class="op" id="3977720">:</span><span class="op" id="3977721">]</span><span class="op" id="3977722">,</span>&nbsp;<span class="ident" id="3977724">r</span><span class="op" id="3977725">.</span><span class="ident" id="3977726">time</span><span class="op" id="3977730">[</span><span class="num" id="3977731">0</span><span class="op" id="3977732">:</span><span class="op" id="3977733">]</span><span class="op" id="3977734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977738">for</span>&nbsp;<span class="ident" id="3977742">i</span>&nbsp;<span class="op" id="3977744">:=</span>&nbsp;<span class="num" id="3977747">0</span><span class="op" id="3977748">;</span>&nbsp;<span class="ident" id="3977750">i</span>&nbsp;<span class="op" id="3977752">&lt;</span>&nbsp;<span class="ident" id="3977754">aes</span><span class="op" id="3977757">.</span><span class="ident" id="3977758">BlockSize</span><span class="op" id="3977767">;</span>&nbsp;<span class="ident" id="3977769">i</span><span class="op" id="3977770">++</span>&nbsp;<span class="op" id="3977773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977778">r</span><span class="op" id="3977779">.</span><span class="ident" id="3977780">dst</span><span class="op" id="3977783">[</span><span class="ident" id="3977784">i</span><span class="op" id="3977785">]</span>&nbsp;<span class="op" id="3977787">=</span>&nbsp;<span class="ident" id="3977789">r</span><span class="op" id="3977790">.</span><span class="ident" id="3977791">time</span><span class="op" id="3977795">[</span><span class="ident" id="3977796">i</span><span class="op" id="3977797">]</span>&nbsp;<span class="op" id="3977799">^</span>&nbsp;<span class="ident" id="3977801">r</span><span class="op" id="3977802">.</span><span class="ident" id="3977803">seed</span><span class="op" id="3977807">[</span><span class="ident" id="3977808">i</span><span class="op" id="3977809">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977817">r</span><span class="op" id="3977818">.</span><span class="ident" id="3977819">cipher</span><span class="op" id="3977825">.</span><span class="ident" id="3977826">Encrypt</span><span class="op" id="3977833">(</span><span class="ident" id="3977834">r</span><span class="op" id="3977835">.</span><span class="ident" id="3977836">dst</span><span class="op" id="3977839">[</span><span class="num" id="3977840">0</span><span class="op" id="3977841">:</span><span class="op" id="3977842">]</span><span class="op" id="3977843">,</span>&nbsp;<span class="ident" id="3977845">r</span><span class="op" id="3977846">.</span><span class="ident" id="3977847">dst</span><span class="op" id="3977850">[</span><span class="num" id="3977851">0</span><span class="op" id="3977852">:</span><span class="op" id="3977853">]</span><span class="op" id="3977854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977858">for</span>&nbsp;<span class="ident" id="3977862">i</span>&nbsp;<span class="op" id="3977864">:=</span>&nbsp;<span class="num" id="3977867">0</span><span class="op" id="3977868">;</span>&nbsp;<span class="ident" id="3977870">i</span>&nbsp;<span class="op" id="3977872">&lt;</span>&nbsp;<span class="ident" id="3977874">aes</span><span class="op" id="3977877">.</span><span class="ident" id="3977878">BlockSize</span><span class="op" id="3977887">;</span>&nbsp;<span class="ident" id="3977889">i</span><span class="op" id="3977890">++</span>&nbsp;<span class="op" id="3977893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977898">r</span><span class="op" id="3977899">.</span><span class="ident" id="3977900">seed</span><span class="op" id="3977904">[</span><span class="ident" id="3977905">i</span><span class="op" id="3977906">]</span>&nbsp;<span class="op" id="3977908">=</span>&nbsp;<span class="ident" id="3977910">r</span><span class="op" id="3977911">.</span><span class="ident" id="3977912">time</span><span class="op" id="3977916">[</span><span class="ident" id="3977917">i</span><span class="op" id="3977918">]</span>&nbsp;<span class="op" id="3977920">^</span>&nbsp;<span class="ident" id="3977922">r</span><span class="op" id="3977923">.</span><span class="ident" id="3977924">dst</span><span class="op" id="3977927">[</span><span class="ident" id="3977928">i</span><span class="op" id="3977929">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977933">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977937">r</span><span class="op" id="3977938">.</span><span class="ident" id="3977939">cipher</span><span class="op" id="3977945">.</span><span class="ident" id="3977946">Encrypt</span><span class="op" id="3977953">(</span><span class="ident" id="3977954">r</span><span class="op" id="3977955">.</span><span class="ident" id="3977956">seed</span><span class="op" id="3977960">[</span><span class="num" id="3977961">0</span><span class="op" id="3977962">:</span><span class="op" id="3977963">]</span><span class="op" id="3977964">,</span>&nbsp;<span class="ident" id="3977966">r</span><span class="op" id="3977967">.</span><span class="ident" id="3977968">seed</span><span class="op" id="3977972">[</span><span class="num" id="3977973">0</span><span class="op" id="3977974">:</span><span class="op" id="3977975">]</span><span class="op" id="3977976">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977981">m</span>&nbsp;<span class="op" id="3977983">:=</span>&nbsp;<span class="builtinfunc" id="3977986">copy</span><span class="op" id="3977990">(</span><span class="ident" id="3977991">b</span><span class="op" id="3977992">,</span>&nbsp;<span class="ident" id="3977994">r</span><span class="op" id="3977995">.</span><span class="ident" id="3977996">dst</span><span class="op" id="3977999">[</span><span class="num" id="3978000">0</span><span class="op" id="3978001">:</span><span class="op" id="3978002">]</span><span class="op" id="3978003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3978007">b</span>&nbsp;<span class="op" id="3978009">=</span>&nbsp;<span class="ident" id="3978011">b</span><span class="op" id="3978012">[</span><span class="ident" id="3978013">m</span><span class="op" id="3978014">:</span><span class="op" id="3978015">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3978018">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3978022">return</span>&nbsp;<span class="ident" id="3978029">n</span><span class="op" id="3978030">,</span>&nbsp;<span class="builtintype" id="3978032">nil</span><br>
<span class="lineno"></span><span class="op" id="3978036">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
