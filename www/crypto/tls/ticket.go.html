<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3959297">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3959352">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3959406">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3959457">package</span>&nbsp;<span class="ident" id="3959465">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3959470">import</span>&nbsp;<span class="op" id="3959477">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3959480">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3959489">&#34;crypto/aes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3959503">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3959520">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3959535">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3959552">&#34;crypto/subtle&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3959569">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3959579">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="3959584">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3959587">//&nbsp;sessionState&nbsp;contains&nbsp;the&nbsp;information&nbsp;that&nbsp;is&nbsp;serialized&nbsp;into&nbsp;a&nbsp;session</span><br>
<span class="lineno"></span><span class="comment" id="3959662">//&nbsp;ticket&nbsp;in&nbsp;order&nbsp;to&nbsp;later&nbsp;resume&nbsp;a&nbsp;connection.</span><br>
<span class="lineno">20</span><span class="keyword" id="3959711">type</span>&nbsp;<span class="ident" id="3959716">sessionState</span>&nbsp;<span class="keyword" id="3959729">struct</span>&nbsp;<span class="op" id="3959736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959739">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3959752">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959760">cipherSuite</span>&nbsp;&nbsp;<span class="builtintype" id="3959773">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959781">masterSecret</span>&nbsp;<span class="op" id="3959794">[</span><span class="op" id="3959795">]</span><span class="builtintype" id="3959796">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959802">certificates</span>&nbsp;<span class="op" id="3959815">[</span><span class="op" id="3959816">]</span><span class="op" id="3959817">[</span><span class="op" id="3959818">]</span><span class="builtintype" id="3959819">byte</span><br>
<span class="lineno">25</span><span class="op" id="3959824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3959827">func</span>&nbsp;<span class="op" id="3959832">(</span><span class="ident" id="3959833">s</span>&nbsp;<span class="op" id="3959835">*</span><span class="ident" id="3959836"><a href="/crypto/tls/ticket.go.html#3959716">sessionState</a></span><span class="op" id="3959848">)</span>&nbsp;<span class="ident" id="3959850">equal</span><span class="op" id="3959855">(</span><span class="ident" id="3959856">i</span>&nbsp;<span class="keyword" id="3959858">interface</span><span class="op" id="3959867">{</span><span class="op" id="3959868">}</span><span class="op" id="3959869">)</span>&nbsp;<span class="builtintype" id="3959871">bool</span>&nbsp;<span class="op" id="3959876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959879">s1</span><span class="op" id="3959881">,</span>&nbsp;<span class="ident" id="3959883">ok</span>&nbsp;<span class="op" id="3959886">:=</span>&nbsp;<span class="ident" id="3959889"><a href="/crypto/tls/ticket.go.html#3959856">i</a></span><span class="op" id="3959890">.</span><span class="op" id="3959891">(</span><span class="op" id="3959892">*</span><span class="ident" id="3959893"><a href="/crypto/tls/ticket.go.html#3959716">sessionState</a></span><span class="op" id="3959905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959908">if</span>&nbsp;<span class="op" id="3959911">!</span><span class="ident" id="3959912"><a href="/crypto/tls/ticket.go.html#3959883">ok</a></span>&nbsp;<span class="op" id="3959915">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959919">return</span>&nbsp;<span class="builtintype" id="3959926">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959937">if</span>&nbsp;<span class="ident" id="3959940"><a href="/crypto/tls/ticket.go.html#3959833">s</a></span><span class="op" id="3959941">.</span><span class="ident" id="3959942">vers</span>&nbsp;<span class="op" id="3959947">!=</span>&nbsp;<span class="ident" id="3959950"><a href="/crypto/tls/ticket.go.html#3959879">s1</a></span><span class="op" id="3959952">.</span><span class="ident" id="3959953">vers</span>&nbsp;<span class="op" id="3959958">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959963"><a href="/crypto/tls/ticket.go.html#3959833">s</a></span><span class="op" id="3959964">.</span><span class="ident" id="3959965">cipherSuite</span>&nbsp;<span class="op" id="3959977">!=</span>&nbsp;<span class="ident" id="3959980"><a href="/crypto/tls/ticket.go.html#3959879">s1</a></span><span class="op" id="3959982">.</span><span class="ident" id="3959983">cipherSuite</span>&nbsp;<span class="op" id="3959995">||</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960000">!</span><span class="ident" id="3960001"><a href="/crypto/tls/ticket.go.html#3959480">bytes</a></span><span class="op" id="3960006">.</span><span class="ident" id="3960007">Equal</span><span class="op" id="3960012">(</span><span class="ident" id="3960013"><a href="/crypto/tls/ticket.go.html#3959833">s</a></span><span class="op" id="3960014">.</span><span class="ident" id="3960015">masterSecret</span><span class="op" id="3960027">,</span>&nbsp;<span class="ident" id="3960029"><a href="/crypto/tls/ticket.go.html#3959879">s1</a></span><span class="op" id="3960031">.</span><span class="ident" id="3960032">masterSecret</span><span class="op" id="3960044">)</span>&nbsp;<span class="op" id="3960046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960050">return</span>&nbsp;<span class="builtintype" id="3960057">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960068">if</span>&nbsp;<span class="builtinfunc" id="3960071">len</span><span class="op" id="3960074">(</span><span class="ident" id="3960075"><a href="/crypto/tls/ticket.go.html#3959833">s</a></span><span class="op" id="3960076">.</span><span class="ident" id="3960077">certificates</span><span class="op" id="3960089">)</span>&nbsp;<span class="op" id="3960091">!=</span>&nbsp;<span class="builtinfunc" id="3960094">len</span><span class="op" id="3960097">(</span><span class="ident" id="3960098"><a href="/crypto/tls/ticket.go.html#3959879">s1</a></span><span class="op" id="3960100">.</span><span class="ident" id="3960101">certificates</span><span class="op" id="3960113">)</span>&nbsp;<span class="op" id="3960115">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960119">return</span>&nbsp;<span class="builtintype" id="3960126">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960137">for</span>&nbsp;<span class="ident" id="3960141">i</span>&nbsp;<span class="op" id="3960143">:=</span>&nbsp;<span class="keyword" id="3960146">range</span>&nbsp;<span class="ident" id="3960152"><a href="/crypto/tls/ticket.go.html#3959833">s</a></span><span class="op" id="3960153">.</span><span class="ident" id="3960154">certificates</span>&nbsp;<span class="op" id="3960167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960171">if</span>&nbsp;<span class="op" id="3960174">!</span><span class="ident" id="3960175"><a href="/crypto/tls/ticket.go.html#3959480">bytes</a></span><span class="op" id="3960180">.</span><span class="ident" id="3960181">Equal</span><span class="op" id="3960186">(</span><span class="ident" id="3960187"><a href="/crypto/tls/ticket.go.html#3959833">s</a></span><span class="op" id="3960188">.</span><span class="ident" id="3960189">certificates</span><span class="op" id="3960201">[</span><span class="ident" id="3960202"><a href="/crypto/tls/ticket.go.html#3960141">i</a></span><span class="op" id="3960203">]</span><span class="op" id="3960204">,</span>&nbsp;<span class="ident" id="3960206"><a href="/crypto/tls/ticket.go.html#3959879">s1</a></span><span class="op" id="3960208">.</span><span class="ident" id="3960209">certificates</span><span class="op" id="3960221">[</span><span class="ident" id="3960222"><a href="/crypto/tls/ticket.go.html#3960141">i</a></span><span class="op" id="3960223">]</span><span class="op" id="3960224">)</span>&nbsp;<span class="op" id="3960226">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960231">return</span>&nbsp;<span class="builtintype" id="3960238">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960253">return</span>&nbsp;<span class="builtintype" id="3960260">true</span><br>
<span class="lineno">50</span><span class="op" id="3960265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3960268">func</span>&nbsp;<span class="op" id="3960273">(</span><span class="ident" id="3960274">s</span>&nbsp;<span class="op" id="3960276">*</span><span class="ident" id="3960277"><a href="/crypto/tls/ticket.go.html#3959716">sessionState</a></span><span class="op" id="3960289">)</span>&nbsp;<span class="ident" id="3960291">marshal</span><span class="op" id="3960298">(</span><span class="op" id="3960299">)</span>&nbsp;<span class="op" id="3960301">[</span><span class="op" id="3960302">]</span><span class="builtintype" id="3960303">byte</span>&nbsp;<span class="op" id="3960308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960311">length</span>&nbsp;<span class="op" id="3960318">:=</span>&nbsp;<span class="num" id="3960321">2</span>&nbsp;<span class="op" id="3960323">+</span>&nbsp;<span class="num" id="3960325">2</span>&nbsp;<span class="op" id="3960327">+</span>&nbsp;<span class="num" id="3960329">2</span>&nbsp;<span class="op" id="3960331">+</span>&nbsp;<span class="builtinfunc" id="3960333">len</span><span class="op" id="3960336">(</span><span class="ident" id="3960337"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960338">.</span><span class="ident" id="3960339">masterSecret</span><span class="op" id="3960351">)</span>&nbsp;<span class="op" id="3960353">+</span>&nbsp;<span class="num" id="3960355">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960358">for</span>&nbsp;<span class="ident" id="3960362">_</span><span class="op" id="3960363">,</span>&nbsp;<span class="ident" id="3960365">cert</span>&nbsp;<span class="op" id="3960370">:=</span>&nbsp;<span class="keyword" id="3960373">range</span>&nbsp;<span class="ident" id="3960379"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960380">.</span><span class="ident" id="3960381">certificates</span>&nbsp;<span class="op" id="3960394">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960398"><a href="/crypto/tls/ticket.go.html#3960311">length</a></span>&nbsp;<span class="op" id="3960405">+=</span>&nbsp;<span class="num" id="3960408">4</span>&nbsp;<span class="op" id="3960410">+</span>&nbsp;<span class="builtinfunc" id="3960412">len</span><span class="op" id="3960415">(</span><span class="ident" id="3960416"><a href="/crypto/tls/ticket.go.html#3960365">cert</a></span><span class="op" id="3960420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960427">ret</span>&nbsp;<span class="op" id="3960431">:=</span>&nbsp;<span class="builtinfunc" id="3960434">make</span><span class="op" id="3960438">(</span><span class="op" id="3960439">[</span><span class="op" id="3960440">]</span><span class="builtintype" id="3960441">byte</span><span class="op" id="3960445">,</span>&nbsp;<span class="ident" id="3960447"><a href="/crypto/tls/ticket.go.html#3960311">length</a></span><span class="op" id="3960453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960456">x</span>&nbsp;<span class="op" id="3960458">:=</span>&nbsp;<span class="ident" id="3960461"><a href="/crypto/tls/ticket.go.html#3960427">ret</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960466"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960467">[</span><span class="num" id="3960468">0</span><span class="op" id="3960469">]</span>&nbsp;<span class="op" id="3960471">=</span>&nbsp;<span class="builtintype" id="3960473">byte</span><span class="op" id="3960477">(</span><span class="ident" id="3960478"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960479">.</span><span class="ident" id="3960480">vers</span>&nbsp;<span class="op" id="3960485">&gt;&gt;</span>&nbsp;<span class="num" id="3960488">8</span><span class="op" id="3960489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960492"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960493">[</span><span class="num" id="3960494">1</span><span class="op" id="3960495">]</span>&nbsp;<span class="op" id="3960497">=</span>&nbsp;<span class="builtintype" id="3960499">byte</span><span class="op" id="3960503">(</span><span class="ident" id="3960504"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960505">.</span><span class="ident" id="3960506">vers</span><span class="op" id="3960510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960513"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960514">[</span><span class="num" id="3960515">2</span><span class="op" id="3960516">]</span>&nbsp;<span class="op" id="3960518">=</span>&nbsp;<span class="builtintype" id="3960520">byte</span><span class="op" id="3960524">(</span><span class="ident" id="3960525"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960526">.</span><span class="ident" id="3960527">cipherSuite</span>&nbsp;<span class="op" id="3960539">&gt;&gt;</span>&nbsp;<span class="num" id="3960542">8</span><span class="op" id="3960543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960546"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960547">[</span><span class="num" id="3960548">3</span><span class="op" id="3960549">]</span>&nbsp;<span class="op" id="3960551">=</span>&nbsp;<span class="builtintype" id="3960553">byte</span><span class="op" id="3960557">(</span><span class="ident" id="3960558"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960559">.</span><span class="ident" id="3960560">cipherSuite</span><span class="op" id="3960571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960574"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960575">[</span><span class="num" id="3960576">4</span><span class="op" id="3960577">]</span>&nbsp;<span class="op" id="3960579">=</span>&nbsp;<span class="builtintype" id="3960581">byte</span><span class="op" id="3960585">(</span><span class="builtinfunc" id="3960586">len</span><span class="op" id="3960589">(</span><span class="ident" id="3960590"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960591">.</span><span class="ident" id="3960592">masterSecret</span><span class="op" id="3960604">)</span>&nbsp;<span class="op" id="3960606">&gt;&gt;</span>&nbsp;<span class="num" id="3960609">8</span><span class="op" id="3960610">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960613"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960614">[</span><span class="num" id="3960615">5</span><span class="op" id="3960616">]</span>&nbsp;<span class="op" id="3960618">=</span>&nbsp;<span class="builtintype" id="3960620">byte</span><span class="op" id="3960624">(</span><span class="builtinfunc" id="3960625">len</span><span class="op" id="3960628">(</span><span class="ident" id="3960629"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960630">.</span><span class="ident" id="3960631">masterSecret</span><span class="op" id="3960643">)</span><span class="op" id="3960644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960647"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span>&nbsp;<span class="op" id="3960649">=</span>&nbsp;<span class="ident" id="3960651"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960652">[</span><span class="num" id="3960653">6</span><span class="op" id="3960654">:</span><span class="op" id="3960655">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3960658">copy</span><span class="op" id="3960662">(</span><span class="ident" id="3960663"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960664">,</span>&nbsp;<span class="ident" id="3960666"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960667">.</span><span class="ident" id="3960668">masterSecret</span><span class="op" id="3960680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960683"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span>&nbsp;<span class="op" id="3960685">=</span>&nbsp;<span class="ident" id="3960687"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960688">[</span><span class="builtinfunc" id="3960689">len</span><span class="op" id="3960692">(</span><span class="ident" id="3960693"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960694">.</span><span class="ident" id="3960695">masterSecret</span><span class="op" id="3960707">)</span><span class="op" id="3960708">:</span><span class="op" id="3960709">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960713"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960714">[</span><span class="num" id="3960715">0</span><span class="op" id="3960716">]</span>&nbsp;<span class="op" id="3960718">=</span>&nbsp;<span class="builtintype" id="3960720">byte</span><span class="op" id="3960724">(</span><span class="builtinfunc" id="3960725">len</span><span class="op" id="3960728">(</span><span class="ident" id="3960729"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960730">.</span><span class="ident" id="3960731">certificates</span><span class="op" id="3960743">)</span>&nbsp;<span class="op" id="3960745">&gt;&gt;</span>&nbsp;<span class="num" id="3960748">8</span><span class="op" id="3960749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960752"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960753">[</span><span class="num" id="3960754">1</span><span class="op" id="3960755">]</span>&nbsp;<span class="op" id="3960757">=</span>&nbsp;<span class="builtintype" id="3960759">byte</span><span class="op" id="3960763">(</span><span class="builtinfunc" id="3960764">len</span><span class="op" id="3960767">(</span><span class="ident" id="3960768"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960769">.</span><span class="ident" id="3960770">certificates</span><span class="op" id="3960782">)</span><span class="op" id="3960783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960786"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span>&nbsp;<span class="op" id="3960788">=</span>&nbsp;<span class="ident" id="3960790"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960791">[</span><span class="num" id="3960792">2</span><span class="op" id="3960793">:</span><span class="op" id="3960794">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960798">for</span>&nbsp;<span class="ident" id="3960802">_</span><span class="op" id="3960803">,</span>&nbsp;<span class="ident" id="3960805">cert</span>&nbsp;<span class="op" id="3960810">:=</span>&nbsp;<span class="keyword" id="3960813">range</span>&nbsp;<span class="ident" id="3960819"><a href="/crypto/tls/ticket.go.html#3960274">s</a></span><span class="op" id="3960820">.</span><span class="ident" id="3960821">certificates</span>&nbsp;<span class="op" id="3960834">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960838"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960839">[</span><span class="num" id="3960840">0</span><span class="op" id="3960841">]</span>&nbsp;<span class="op" id="3960843">=</span>&nbsp;<span class="builtintype" id="3960845">byte</span><span class="op" id="3960849">(</span><span class="builtinfunc" id="3960850">len</span><span class="op" id="3960853">(</span><span class="ident" id="3960854"><a href="/crypto/tls/ticket.go.html#3960805">cert</a></span><span class="op" id="3960858">)</span>&nbsp;<span class="op" id="3960860">&gt;&gt;</span>&nbsp;<span class="num" id="3960863">24</span><span class="op" id="3960865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960869"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960870">[</span><span class="num" id="3960871">1</span><span class="op" id="3960872">]</span>&nbsp;<span class="op" id="3960874">=</span>&nbsp;<span class="builtintype" id="3960876">byte</span><span class="op" id="3960880">(</span><span class="builtinfunc" id="3960881">len</span><span class="op" id="3960884">(</span><span class="ident" id="3960885"><a href="/crypto/tls/ticket.go.html#3960805">cert</a></span><span class="op" id="3960889">)</span>&nbsp;<span class="op" id="3960891">&gt;&gt;</span>&nbsp;<span class="num" id="3960894">16</span><span class="op" id="3960896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960900"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960901">[</span><span class="num" id="3960902">2</span><span class="op" id="3960903">]</span>&nbsp;<span class="op" id="3960905">=</span>&nbsp;<span class="builtintype" id="3960907">byte</span><span class="op" id="3960911">(</span><span class="builtinfunc" id="3960912">len</span><span class="op" id="3960915">(</span><span class="ident" id="3960916"><a href="/crypto/tls/ticket.go.html#3960805">cert</a></span><span class="op" id="3960920">)</span>&nbsp;<span class="op" id="3960922">&gt;&gt;</span>&nbsp;<span class="num" id="3960925">8</span><span class="op" id="3960926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960930"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960931">[</span><span class="num" id="3960932">3</span><span class="op" id="3960933">]</span>&nbsp;<span class="op" id="3960935">=</span>&nbsp;<span class="builtintype" id="3960937">byte</span><span class="op" id="3960941">(</span><span class="builtinfunc" id="3960942">len</span><span class="op" id="3960945">(</span><span class="ident" id="3960946"><a href="/crypto/tls/ticket.go.html#3960805">cert</a></span><span class="op" id="3960950">)</span><span class="op" id="3960951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3960955">copy</span><span class="op" id="3960959">(</span><span class="ident" id="3960960"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960961">[</span><span class="num" id="3960962">4</span><span class="op" id="3960963">:</span><span class="op" id="3960964">]</span><span class="op" id="3960965">,</span>&nbsp;<span class="ident" id="3960967"><a href="/crypto/tls/ticket.go.html#3960805">cert</a></span><span class="op" id="3960971">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960975"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span>&nbsp;<span class="op" id="3960977">=</span>&nbsp;<span class="ident" id="3960979"><a href="/crypto/tls/ticket.go.html#3960456">x</a></span><span class="op" id="3960980">[</span><span class="num" id="3960981">4</span><span class="op" id="3960982">+</span><span class="builtinfunc" id="3960983">len</span><span class="op" id="3960986">(</span><span class="ident" id="3960987"><a href="/crypto/tls/ticket.go.html#3960805">cert</a></span><span class="op" id="3960991">)</span><span class="op" id="3960992">:</span><span class="op" id="3960993">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961000">return</span>&nbsp;<span class="ident" id="3961007"><a href="/crypto/tls/ticket.go.html#3960427">ret</a></span><br>
<span class="lineno"></span><span class="op" id="3961011">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3961014">func</span>&nbsp;<span class="op" id="3961019">(</span><span class="ident" id="3961020">s</span>&nbsp;<span class="op" id="3961022">*</span><span class="ident" id="3961023"><a href="/crypto/tls/ticket.go.html#3959716">sessionState</a></span><span class="op" id="3961035">)</span>&nbsp;<span class="ident" id="3961037">unmarshal</span><span class="op" id="3961046">(</span><span class="ident" id="3961047">data</span>&nbsp;<span class="op" id="3961052">[</span><span class="op" id="3961053">]</span><span class="builtintype" id="3961054">byte</span><span class="op" id="3961058">)</span>&nbsp;<span class="builtintype" id="3961060">bool</span>&nbsp;<span class="op" id="3961065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961068">if</span>&nbsp;<span class="builtinfunc" id="3961071">len</span><span class="op" id="3961074">(</span><span class="ident" id="3961075"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961079">)</span>&nbsp;<span class="op" id="3961081">&lt;</span>&nbsp;<span class="num" id="3961083">8</span>&nbsp;<span class="op" id="3961085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961089">return</span>&nbsp;<span class="builtintype" id="3961096">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961103">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961107"><a href="/crypto/tls/ticket.go.html#3961020">s</a></span><span class="op" id="3961108">.</span><span class="ident" id="3961109">vers</span>&nbsp;<span class="op" id="3961114">=</span>&nbsp;<span class="builtintype" id="3961116">uint16</span><span class="op" id="3961122">(</span><span class="ident" id="3961123"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961127">[</span><span class="num" id="3961128">0</span><span class="op" id="3961129">]</span><span class="op" id="3961130">)</span><span class="op" id="3961131">&lt;&lt;</span><span class="num" id="3961133">8</span>&nbsp;<span class="op" id="3961135">|</span>&nbsp;<span class="builtintype" id="3961137">uint16</span><span class="op" id="3961143">(</span><span class="ident" id="3961144"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961148">[</span><span class="num" id="3961149">1</span><span class="op" id="3961150">]</span><span class="op" id="3961151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961154"><a href="/crypto/tls/ticket.go.html#3961020">s</a></span><span class="op" id="3961155">.</span><span class="ident" id="3961156">cipherSuite</span>&nbsp;<span class="op" id="3961168">=</span>&nbsp;<span class="builtintype" id="3961170">uint16</span><span class="op" id="3961176">(</span><span class="ident" id="3961177"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961181">[</span><span class="num" id="3961182">2</span><span class="op" id="3961183">]</span><span class="op" id="3961184">)</span><span class="op" id="3961185">&lt;&lt;</span><span class="num" id="3961187">8</span>&nbsp;<span class="op" id="3961189">|</span>&nbsp;<span class="builtintype" id="3961191">uint16</span><span class="op" id="3961197">(</span><span class="ident" id="3961198"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961202">[</span><span class="num" id="3961203">3</span><span class="op" id="3961204">]</span><span class="op" id="3961205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961208">masterSecretLen</span>&nbsp;<span class="op" id="3961224">:=</span>&nbsp;<span class="builtintype" id="3961227">int</span><span class="op" id="3961230">(</span><span class="ident" id="3961231"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961235">[</span><span class="num" id="3961236">4</span><span class="op" id="3961237">]</span><span class="op" id="3961238">)</span><span class="op" id="3961239">&lt;&lt;</span><span class="num" id="3961241">8</span>&nbsp;<span class="op" id="3961243">|</span>&nbsp;<span class="builtintype" id="3961245">int</span><span class="op" id="3961248">(</span><span class="ident" id="3961249"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961253">[</span><span class="num" id="3961254">5</span><span class="op" id="3961255">]</span><span class="op" id="3961256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961259"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span>&nbsp;<span class="op" id="3961264">=</span>&nbsp;<span class="ident" id="3961266"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961270">[</span><span class="num" id="3961271">6</span><span class="op" id="3961272">:</span><span class="op" id="3961273">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961276">if</span>&nbsp;<span class="builtinfunc" id="3961279">len</span><span class="op" id="3961282">(</span><span class="ident" id="3961283"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961287">)</span>&nbsp;<span class="op" id="3961289">&lt;</span>&nbsp;<span class="ident" id="3961291"><a href="/crypto/tls/ticket.go.html#3961208">masterSecretLen</a></span>&nbsp;<span class="op" id="3961307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961311">return</span>&nbsp;<span class="builtintype" id="3961318">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961329"><a href="/crypto/tls/ticket.go.html#3961020">s</a></span><span class="op" id="3961330">.</span><span class="ident" id="3961331">masterSecret</span>&nbsp;<span class="op" id="3961344">=</span>&nbsp;<span class="ident" id="3961346"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961350">[</span><span class="op" id="3961351">:</span><span class="ident" id="3961352"><a href="/crypto/tls/ticket.go.html#3961208">masterSecretLen</a></span><span class="op" id="3961367">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961370"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span>&nbsp;<span class="op" id="3961375">=</span>&nbsp;<span class="ident" id="3961377"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961381">[</span><span class="ident" id="3961382"><a href="/crypto/tls/ticket.go.html#3961208">masterSecretLen</a></span><span class="op" id="3961397">:</span><span class="op" id="3961398">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961402">if</span>&nbsp;<span class="builtinfunc" id="3961405">len</span><span class="op" id="3961408">(</span><span class="ident" id="3961409"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961413">)</span>&nbsp;<span class="op" id="3961415">&lt;</span>&nbsp;<span class="num" id="3961417">2</span>&nbsp;<span class="op" id="3961419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961423">return</span>&nbsp;<span class="builtintype" id="3961430">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961437">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961441">numCerts</span>&nbsp;<span class="op" id="3961450">:=</span>&nbsp;<span class="builtintype" id="3961453">int</span><span class="op" id="3961456">(</span><span class="ident" id="3961457"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961461">[</span><span class="num" id="3961462">0</span><span class="op" id="3961463">]</span><span class="op" id="3961464">)</span><span class="op" id="3961465">&lt;&lt;</span><span class="num" id="3961467">8</span>&nbsp;<span class="op" id="3961469">|</span>&nbsp;<span class="builtintype" id="3961471">int</span><span class="op" id="3961474">(</span><span class="ident" id="3961475"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961479">[</span><span class="num" id="3961480">1</span><span class="op" id="3961481">]</span><span class="op" id="3961482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961485"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span>&nbsp;<span class="op" id="3961490">=</span>&nbsp;<span class="ident" id="3961492"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961496">[</span><span class="num" id="3961497">2</span><span class="op" id="3961498">:</span><span class="op" id="3961499">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961503"><a href="/crypto/tls/ticket.go.html#3961020">s</a></span><span class="op" id="3961504">.</span><span class="ident" id="3961505">certificates</span>&nbsp;<span class="op" id="3961518">=</span>&nbsp;<span class="builtinfunc" id="3961520">make</span><span class="op" id="3961524">(</span><span class="op" id="3961525">[</span><span class="op" id="3961526">]</span><span class="op" id="3961527">[</span><span class="op" id="3961528">]</span><span class="builtintype" id="3961529">byte</span><span class="op" id="3961533">,</span>&nbsp;<span class="ident" id="3961535"><a href="/crypto/tls/ticket.go.html#3961441">numCerts</a></span><span class="op" id="3961543">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961546">for</span>&nbsp;<span class="ident" id="3961550">i</span>&nbsp;<span class="op" id="3961552">:=</span>&nbsp;<span class="keyword" id="3961555">range</span>&nbsp;<span class="ident" id="3961561"><a href="/crypto/tls/ticket.go.html#3961020">s</a></span><span class="op" id="3961562">.</span><span class="ident" id="3961563">certificates</span>&nbsp;<span class="op" id="3961576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961580">if</span>&nbsp;<span class="builtinfunc" id="3961583">len</span><span class="op" id="3961586">(</span><span class="ident" id="3961587"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961591">)</span>&nbsp;<span class="op" id="3961593">&lt;</span>&nbsp;<span class="num" id="3961595">4</span>&nbsp;<span class="op" id="3961597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961602">return</span>&nbsp;<span class="builtintype" id="3961609">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961621">certLen</span>&nbsp;<span class="op" id="3961629">:=</span>&nbsp;<span class="builtintype" id="3961632">int</span><span class="op" id="3961635">(</span><span class="ident" id="3961636"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961640">[</span><span class="num" id="3961641">0</span><span class="op" id="3961642">]</span><span class="op" id="3961643">)</span><span class="op" id="3961644">&lt;&lt;</span><span class="num" id="3961646">24</span>&nbsp;<span class="op" id="3961649">|</span>&nbsp;<span class="builtintype" id="3961651">int</span><span class="op" id="3961654">(</span><span class="ident" id="3961655"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961659">[</span><span class="num" id="3961660">1</span><span class="op" id="3961661">]</span><span class="op" id="3961662">)</span><span class="op" id="3961663">&lt;&lt;</span><span class="num" id="3961665">16</span>&nbsp;<span class="op" id="3961668">|</span>&nbsp;<span class="builtintype" id="3961670">int</span><span class="op" id="3961673">(</span><span class="ident" id="3961674"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961678">[</span><span class="num" id="3961679">2</span><span class="op" id="3961680">]</span><span class="op" id="3961681">)</span><span class="op" id="3961682">&lt;&lt;</span><span class="num" id="3961684">8</span>&nbsp;<span class="op" id="3961686">|</span>&nbsp;<span class="builtintype" id="3961688">int</span><span class="op" id="3961691">(</span><span class="ident" id="3961692"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961696">[</span><span class="num" id="3961697">3</span><span class="op" id="3961698">]</span><span class="op" id="3961699">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961703"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span>&nbsp;<span class="op" id="3961708">=</span>&nbsp;<span class="ident" id="3961710"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961714">[</span><span class="num" id="3961715">4</span><span class="op" id="3961716">:</span><span class="op" id="3961717">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961721">if</span>&nbsp;<span class="ident" id="3961724"><a href="/crypto/tls/ticket.go.html#3961621">certLen</a></span>&nbsp;<span class="op" id="3961732">&lt;</span>&nbsp;<span class="num" id="3961734">0</span>&nbsp;<span class="op" id="3961736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961741">return</span>&nbsp;<span class="builtintype" id="3961748">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961760">if</span>&nbsp;<span class="builtinfunc" id="3961763">len</span><span class="op" id="3961766">(</span><span class="ident" id="3961767"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961771">)</span>&nbsp;<span class="op" id="3961773">&lt;</span>&nbsp;<span class="ident" id="3961775"><a href="/crypto/tls/ticket.go.html#3961621">certLen</a></span>&nbsp;<span class="op" id="3961783">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961788">return</span>&nbsp;<span class="builtintype" id="3961795">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961807"><a href="/crypto/tls/ticket.go.html#3961020">s</a></span><span class="op" id="3961808">.</span><span class="ident" id="3961809">certificates</span><span class="op" id="3961821">[</span><span class="ident" id="3961822"><a href="/crypto/tls/ticket.go.html#3961550">i</a></span><span class="op" id="3961823">]</span>&nbsp;<span class="op" id="3961825">=</span>&nbsp;<span class="ident" id="3961827"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961831">[</span><span class="op" id="3961832">:</span><span class="ident" id="3961833"><a href="/crypto/tls/ticket.go.html#3961621">certLen</a></span><span class="op" id="3961840">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961844"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span>&nbsp;<span class="op" id="3961849">=</span>&nbsp;<span class="ident" id="3961851"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961855">[</span><span class="ident" id="3961856"><a href="/crypto/tls/ticket.go.html#3961621">certLen</a></span><span class="op" id="3961863">:</span><span class="op" id="3961864">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961867">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961871">if</span>&nbsp;<span class="builtinfunc" id="3961874">len</span><span class="op" id="3961877">(</span><span class="ident" id="3961878"><a href="/crypto/tls/ticket.go.html#3961047">data</a></span><span class="op" id="3961882">)</span>&nbsp;<span class="op" id="3961884">&gt;</span>&nbsp;<span class="num" id="3961886">0</span>&nbsp;<span class="op" id="3961888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961892">return</span>&nbsp;<span class="builtintype" id="3961899">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961910">return</span>&nbsp;<span class="builtintype" id="3961917">true</span><br>
<span class="lineno"></span><span class="op" id="3961922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3961925">func</span>&nbsp;<span class="op" id="3961930">(</span><span class="ident" id="3961931">c</span>&nbsp;<span class="op" id="3961933">*</span><span class="ident" id="3961934"><a href="/crypto/tls/conn.go.html#3842235">Conn</a></span><span class="op" id="3961938">)</span>&nbsp;<span class="ident" id="3961940">encryptTicket</span><span class="op" id="3961953">(</span><span class="ident" id="3961954">state</span>&nbsp;<span class="op" id="3961960">*</span><span class="ident" id="3961961"><a href="/crypto/tls/ticket.go.html#3959716">sessionState</a></span><span class="op" id="3961973">)</span>&nbsp;<span class="op" id="3961975">(</span><span class="op" id="3961976">[</span><span class="op" id="3961977">]</span><span class="builtintype" id="3961978">byte</span><span class="op" id="3961982">,</span>&nbsp;<span class="builtintype" id="3961984">error</span><span class="op" id="3961989">)</span>&nbsp;<span class="op" id="3961991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961994">serialized</span>&nbsp;<span class="op" id="3962005">:=</span>&nbsp;<span class="ident" id="3962008"><a href="/crypto/tls/ticket.go.html#3961954">state</a></span><span class="op" id="3962013">.</span><span class="ident" id="3962014">marshal</span><span class="op" id="3962021">(</span><span class="op" id="3962022">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962025">encrypted</span>&nbsp;<span class="op" id="3962035">:=</span>&nbsp;<span class="builtinfunc" id="3962038">make</span><span class="op" id="3962042">(</span><span class="op" id="3962043">[</span><span class="op" id="3962044">]</span><span class="builtintype" id="3962045">byte</span><span class="op" id="3962049">,</span>&nbsp;<span class="ident" id="3962051"><a href="/crypto/tls/ticket.go.html#3959489">aes</a></span><span class="op" id="3962054">.</span><span class="ident" id="3962055">BlockSize</span><span class="op" id="3962064">+</span><span class="builtinfunc" id="3962065">len</span><span class="op" id="3962068">(</span><span class="ident" id="3962069"><a href="/crypto/tls/ticket.go.html#3961994">serialized</a></span><span class="op" id="3962079">)</span><span class="op" id="3962080">+</span><span class="ident" id="3962081"><a href="/crypto/tls/ticket.go.html#3959535">sha256</a></span><span class="op" id="3962087">.</span><span class="ident" id="3962088">Size</span><span class="op" id="3962092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962095">iv</span>&nbsp;<span class="op" id="3962098">:=</span>&nbsp;<span class="ident" id="3962101"><a href="/crypto/tls/ticket.go.html#3962025">encrypted</a></span><span class="op" id="3962110">[</span><span class="op" id="3962111">:</span><span class="ident" id="3962112"><a href="/crypto/tls/ticket.go.html#3959489">aes</a></span><span class="op" id="3962115">.</span><span class="ident" id="3962116">BlockSize</span><span class="op" id="3962125">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962128">macBytes</span>&nbsp;<span class="op" id="3962137">:=</span>&nbsp;<span class="ident" id="3962140"><a href="/crypto/tls/ticket.go.html#3962025">encrypted</a></span><span class="op" id="3962149">[</span><span class="builtinfunc" id="3962150">len</span><span class="op" id="3962153">(</span><span class="ident" id="3962154"><a href="/crypto/tls/ticket.go.html#3962025">encrypted</a></span><span class="op" id="3962163">)</span><span class="op" id="3962164">-</span><span class="ident" id="3962165"><a href="/crypto/tls/ticket.go.html#3959535">sha256</a></span><span class="op" id="3962171">.</span><span class="ident" id="3962172">Size</span><span class="op" id="3962176">:</span><span class="op" id="3962177">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962181">if</span>&nbsp;<span class="ident" id="3962184">_</span><span class="op" id="3962185">,</span>&nbsp;<span class="ident" id="3962187">err</span>&nbsp;<span class="op" id="3962191">:=</span>&nbsp;<span class="ident" id="3962194"><a href="/crypto/tls/ticket.go.html#3959579">io</a></span><span class="op" id="3962196">.</span><span class="ident" id="3962197">ReadFull</span><span class="op" id="3962205">(</span><span class="ident" id="3962206"><a href="/crypto/tls/ticket.go.html#3961931">c</a></span><span class="op" id="3962207">.</span><span class="ident" id="3962208">config</span><span class="op" id="3962214">.</span><span class="ident" id="3962215">rand</span><span class="op" id="3962219">(</span><span class="op" id="3962220">)</span><span class="op" id="3962221">,</span>&nbsp;<span class="ident" id="3962223"><a href="/crypto/tls/ticket.go.html#3962095">iv</a></span><span class="op" id="3962225">)</span><span class="op" id="3962226">;</span>&nbsp;<span class="ident" id="3962228"><a href="/crypto/tls/ticket.go.html#3962187">err</a></span>&nbsp;<span class="op" id="3962232">!=</span>&nbsp;<span class="ident" id="3962235">nil</span>&nbsp;<span class="op" id="3962239">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962243">return</span>&nbsp;<span class="ident" id="3962250">nil</span><span class="op" id="3962253">,</span>&nbsp;<span class="ident" id="3962255"><a href="/crypto/tls/ticket.go.html#3962187">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962263">block</span><span class="op" id="3962268">,</span>&nbsp;<span class="ident" id="3962270">err</span>&nbsp;<span class="op" id="3962274">:=</span>&nbsp;<span class="ident" id="3962277"><a href="/crypto/tls/ticket.go.html#3959489">aes</a></span><span class="op" id="3962280">.</span><span class="ident" id="3962281">NewCipher</span><span class="op" id="3962290">(</span><span class="ident" id="3962291"><a href="/crypto/tls/ticket.go.html#3961931">c</a></span><span class="op" id="3962292">.</span><span class="ident" id="3962293">config</span><span class="op" id="3962299">.</span><span class="ident" id="3962300">SessionTicketKey</span><span class="op" id="3962316">[</span><span class="op" id="3962317">:</span><span class="num" id="3962318">16</span><span class="op" id="3962320">]</span><span class="op" id="3962321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962324">if</span>&nbsp;<span class="ident" id="3962327"><a href="/crypto/tls/ticket.go.html#3962270">err</a></span>&nbsp;<span class="op" id="3962331">!=</span>&nbsp;<span class="ident" id="3962334">nil</span>&nbsp;<span class="op" id="3962338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962342">return</span>&nbsp;<span class="ident" id="3962349">nil</span><span class="op" id="3962352">,</span>&nbsp;<span class="ident" id="3962354"><a href="/crypto/tls/ticket.go.html#3959569">errors</a></span><span class="op" id="3962360">.</span><span class="ident" id="3962361">New</span><span class="op" id="3962364">(</span><span class="string" id="3962365">&#34;tls:&nbsp;failed&nbsp;to&nbsp;create&nbsp;cipher&nbsp;while&nbsp;encrypting&nbsp;ticket:&nbsp;&#34;</span>&nbsp;<span class="op" id="3962422">+</span>&nbsp;<span class="ident" id="3962424"><a href="/crypto/tls/ticket.go.html#3962270">err</a></span><span class="op" id="3962427">.</span><span class="ident" id="3962428">Error</span><span class="op" id="3962433">(</span><span class="op" id="3962434">)</span><span class="op" id="3962435">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962441"><a href="/crypto/tls/ticket.go.html#3959503">cipher</a></span><span class="op" id="3962447">.</span><span class="ident" id="3962448">NewCTR</span><span class="op" id="3962454">(</span><span class="ident" id="3962455"><a href="/crypto/tls/ticket.go.html#3962263">block</a></span><span class="op" id="3962460">,</span>&nbsp;<span class="ident" id="3962462"><a href="/crypto/tls/ticket.go.html#3962095">iv</a></span><span class="op" id="3962464">)</span><span class="op" id="3962465">.</span><span class="ident" id="3962466">XORKeyStream</span><span class="op" id="3962478">(</span><span class="ident" id="3962479"><a href="/crypto/tls/ticket.go.html#3962025">encrypted</a></span><span class="op" id="3962488">[</span><span class="ident" id="3962489"><a href="/crypto/tls/ticket.go.html#3959489">aes</a></span><span class="op" id="3962492">.</span><span class="ident" id="3962493">BlockSize</span><span class="op" id="3962502">:</span><span class="op" id="3962503">]</span><span class="op" id="3962504">,</span>&nbsp;<span class="ident" id="3962506"><a href="/crypto/tls/ticket.go.html#3961994">serialized</a></span><span class="op" id="3962516">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962520">mac</span>&nbsp;<span class="op" id="3962524">:=</span>&nbsp;<span class="ident" id="3962527"><a href="/crypto/tls/ticket.go.html#3959520">hmac</a></span><span class="op" id="3962531">.</span><span class="ident" id="3962532">New</span><span class="op" id="3962535">(</span><span class="ident" id="3962536"><a href="/crypto/tls/ticket.go.html#3959535">sha256</a></span><span class="op" id="3962542">.</span><span class="ident" id="3962543">New</span><span class="op" id="3962546">,</span>&nbsp;<span class="ident" id="3962548"><a href="/crypto/tls/ticket.go.html#3961931">c</a></span><span class="op" id="3962549">.</span><span class="ident" id="3962550">config</span><span class="op" id="3962556">.</span><span class="ident" id="3962557">SessionTicketKey</span><span class="op" id="3962573">[</span><span class="num" id="3962574">16</span><span class="op" id="3962576">:</span><span class="num" id="3962577">32</span><span class="op" id="3962579">]</span><span class="op" id="3962580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962583"><a href="/crypto/tls/ticket.go.html#3962520">mac</a></span><span class="op" id="3962586">.</span><span class="ident" id="3962587">Write</span><span class="op" id="3962592">(</span><span class="ident" id="3962593"><a href="/crypto/tls/ticket.go.html#3962025">encrypted</a></span><span class="op" id="3962602">[</span><span class="op" id="3962603">:</span><span class="builtinfunc" id="3962604">len</span><span class="op" id="3962607">(</span><span class="ident" id="3962608"><a href="/crypto/tls/ticket.go.html#3962025">encrypted</a></span><span class="op" id="3962617">)</span><span class="op" id="3962618">-</span><span class="ident" id="3962619"><a href="/crypto/tls/ticket.go.html#3959535">sha256</a></span><span class="op" id="3962625">.</span><span class="ident" id="3962626">Size</span><span class="op" id="3962630">]</span><span class="op" id="3962631">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962634"><a href="/crypto/tls/ticket.go.html#3962520">mac</a></span><span class="op" id="3962637">.</span><span class="ident" id="3962638">Sum</span><span class="op" id="3962641">(</span><span class="ident" id="3962642"><a href="/crypto/tls/ticket.go.html#3962128">macBytes</a></span><span class="op" id="3962650">[</span><span class="op" id="3962651">:</span><span class="num" id="3962652">0</span><span class="op" id="3962653">]</span><span class="op" id="3962654">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962658">return</span>&nbsp;<span class="ident" id="3962665"><a href="/crypto/tls/ticket.go.html#3962025">encrypted</a></span><span class="op" id="3962674">,</span>&nbsp;<span class="ident" id="3962676">nil</span><br>
<span class="lineno"></span><span class="op" id="3962680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="3962683">func</span>&nbsp;<span class="op" id="3962688">(</span><span class="ident" id="3962689">c</span>&nbsp;<span class="op" id="3962691">*</span><span class="ident" id="3962692"><a href="/crypto/tls/conn.go.html#3842235">Conn</a></span><span class="op" id="3962696">)</span>&nbsp;<span class="ident" id="3962698">decryptTicket</span><span class="op" id="3962711">(</span><span class="ident" id="3962712">encrypted</span>&nbsp;<span class="op" id="3962722">[</span><span class="op" id="3962723">]</span><span class="builtintype" id="3962724">byte</span><span class="op" id="3962728">)</span>&nbsp;<span class="op" id="3962730">(</span><span class="op" id="3962731">*</span><span class="ident" id="3962732"><a href="/crypto/tls/ticket.go.html#3959716">sessionState</a></span><span class="op" id="3962744">,</span>&nbsp;<span class="builtintype" id="3962746">bool</span><span class="op" id="3962750">)</span>&nbsp;<span class="op" id="3962752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962755">if</span>&nbsp;<span class="ident" id="3962758"><a href="/crypto/tls/ticket.go.html#3962689">c</a></span><span class="op" id="3962759">.</span><span class="ident" id="3962760">config</span><span class="op" id="3962766">.</span><span class="ident" id="3962767">SessionTicketsDisabled</span>&nbsp;<span class="op" id="3962790">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3962795">len</span><span class="op" id="3962798">(</span><span class="ident" id="3962799"><a href="/crypto/tls/ticket.go.html#3962712">encrypted</a></span><span class="op" id="3962808">)</span>&nbsp;<span class="op" id="3962810">&lt;</span>&nbsp;<span class="ident" id="3962812"><a href="/crypto/tls/ticket.go.html#3959489">aes</a></span><span class="op" id="3962815">.</span><span class="ident" id="3962816">BlockSize</span><span class="op" id="3962825">+</span><span class="ident" id="3962826"><a href="/crypto/tls/ticket.go.html#3959535">sha256</a></span><span class="op" id="3962832">.</span><span class="ident" id="3962833">Size</span>&nbsp;<span class="op" id="3962838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962842">return</span>&nbsp;<span class="ident" id="3962849">nil</span><span class="op" id="3962852">,</span>&nbsp;<span class="builtintype" id="3962854">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962861">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962865">iv</span>&nbsp;<span class="op" id="3962868">:=</span>&nbsp;<span class="ident" id="3962871"><a href="/crypto/tls/ticket.go.html#3962712">encrypted</a></span><span class="op" id="3962880">[</span><span class="op" id="3962881">:</span><span class="ident" id="3962882"><a href="/crypto/tls/ticket.go.html#3959489">aes</a></span><span class="op" id="3962885">.</span><span class="ident" id="3962886">BlockSize</span><span class="op" id="3962895">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962898">macBytes</span>&nbsp;<span class="op" id="3962907">:=</span>&nbsp;<span class="ident" id="3962910"><a href="/crypto/tls/ticket.go.html#3962712">encrypted</a></span><span class="op" id="3962919">[</span><span class="builtinfunc" id="3962920">len</span><span class="op" id="3962923">(</span><span class="ident" id="3962924"><a href="/crypto/tls/ticket.go.html#3962712">encrypted</a></span><span class="op" id="3962933">)</span><span class="op" id="3962934">-</span><span class="ident" id="3962935"><a href="/crypto/tls/ticket.go.html#3959535">sha256</a></span><span class="op" id="3962941">.</span><span class="ident" id="3962942">Size</span><span class="op" id="3962946">:</span><span class="op" id="3962947">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962951">mac</span>&nbsp;<span class="op" id="3962955">:=</span>&nbsp;<span class="ident" id="3962958"><a href="/crypto/tls/ticket.go.html#3959520">hmac</a></span><span class="op" id="3962962">.</span><span class="ident" id="3962963">New</span><span class="op" id="3962966">(</span><span class="ident" id="3962967"><a href="/crypto/tls/ticket.go.html#3959535">sha256</a></span><span class="op" id="3962973">.</span><span class="ident" id="3962974">New</span><span class="op" id="3962977">,</span>&nbsp;<span class="ident" id="3962979"><a href="/crypto/tls/ticket.go.html#3962689">c</a></span><span class="op" id="3962980">.</span><span class="ident" id="3962981">config</span><span class="op" id="3962987">.</span><span class="ident" id="3962988">SessionTicketKey</span><span class="op" id="3963004">[</span><span class="num" id="3963005">16</span><span class="op" id="3963007">:</span><span class="num" id="3963008">32</span><span class="op" id="3963010">]</span><span class="op" id="3963011">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963014"><a href="/crypto/tls/ticket.go.html#3962951">mac</a></span><span class="op" id="3963017">.</span><span class="ident" id="3963018">Write</span><span class="op" id="3963023">(</span><span class="ident" id="3963024"><a href="/crypto/tls/ticket.go.html#3962712">encrypted</a></span><span class="op" id="3963033">[</span><span class="op" id="3963034">:</span><span class="builtinfunc" id="3963035">len</span><span class="op" id="3963038">(</span><span class="ident" id="3963039"><a href="/crypto/tls/ticket.go.html#3962712">encrypted</a></span><span class="op" id="3963048">)</span><span class="op" id="3963049">-</span><span class="ident" id="3963050"><a href="/crypto/tls/ticket.go.html#3959535">sha256</a></span><span class="op" id="3963056">.</span><span class="ident" id="3963057">Size</span><span class="op" id="3963061">]</span><span class="op" id="3963062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963065">expected</span>&nbsp;<span class="op" id="3963074">:=</span>&nbsp;<span class="ident" id="3963077"><a href="/crypto/tls/ticket.go.html#3962951">mac</a></span><span class="op" id="3963080">.</span><span class="ident" id="3963081">Sum</span><span class="op" id="3963084">(</span><span class="ident" id="3963085">nil</span><span class="op" id="3963088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963092">if</span>&nbsp;<span class="ident" id="3963095"><a href="/crypto/tls/ticket.go.html#3959552">subtle</a></span><span class="op" id="3963101">.</span><span class="ident" id="3963102">ConstantTimeCompare</span><span class="op" id="3963121">(</span><span class="ident" id="3963122"><a href="/crypto/tls/ticket.go.html#3962898">macBytes</a></span><span class="op" id="3963130">,</span>&nbsp;<span class="ident" id="3963132"><a href="/crypto/tls/ticket.go.html#3963065">expected</a></span><span class="op" id="3963140">)</span>&nbsp;<span class="op" id="3963142">!=</span>&nbsp;<span class="num" id="3963145">1</span>&nbsp;<span class="op" id="3963147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963151">return</span>&nbsp;<span class="ident" id="3963158">nil</span><span class="op" id="3963161">,</span>&nbsp;<span class="builtintype" id="3963163">false</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963174">block</span><span class="op" id="3963179">,</span>&nbsp;<span class="ident" id="3963181">err</span>&nbsp;<span class="op" id="3963185">:=</span>&nbsp;<span class="ident" id="3963188"><a href="/crypto/tls/ticket.go.html#3959489">aes</a></span><span class="op" id="3963191">.</span><span class="ident" id="3963192">NewCipher</span><span class="op" id="3963201">(</span><span class="ident" id="3963202"><a href="/crypto/tls/ticket.go.html#3962689">c</a></span><span class="op" id="3963203">.</span><span class="ident" id="3963204">config</span><span class="op" id="3963210">.</span><span class="ident" id="3963211">SessionTicketKey</span><span class="op" id="3963227">[</span><span class="op" id="3963228">:</span><span class="num" id="3963229">16</span><span class="op" id="3963231">]</span><span class="op" id="3963232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963235">if</span>&nbsp;<span class="ident" id="3963238"><a href="/crypto/tls/ticket.go.html#3963181">err</a></span>&nbsp;<span class="op" id="3963242">!=</span>&nbsp;<span class="ident" id="3963245">nil</span>&nbsp;<span class="op" id="3963249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963253">return</span>&nbsp;<span class="ident" id="3963260">nil</span><span class="op" id="3963263">,</span>&nbsp;<span class="builtintype" id="3963265">false</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963275">ciphertext</span>&nbsp;<span class="op" id="3963286">:=</span>&nbsp;<span class="ident" id="3963289"><a href="/crypto/tls/ticket.go.html#3962712">encrypted</a></span><span class="op" id="3963298">[</span><span class="ident" id="3963299"><a href="/crypto/tls/ticket.go.html#3959489">aes</a></span><span class="op" id="3963302">.</span><span class="ident" id="3963303">BlockSize</span>&nbsp;<span class="op" id="3963313">:</span>&nbsp;<span class="builtinfunc" id="3963315">len</span><span class="op" id="3963318">(</span><span class="ident" id="3963319"><a href="/crypto/tls/ticket.go.html#3962712">encrypted</a></span><span class="op" id="3963328">)</span><span class="op" id="3963329">-</span><span class="ident" id="3963330"><a href="/crypto/tls/ticket.go.html#3959535">sha256</a></span><span class="op" id="3963336">.</span><span class="ident" id="3963337">Size</span><span class="op" id="3963341">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963344">plaintext</span>&nbsp;<span class="op" id="3963354">:=</span>&nbsp;<span class="ident" id="3963357"><a href="/crypto/tls/ticket.go.html#3963275">ciphertext</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963369"><a href="/crypto/tls/ticket.go.html#3959503">cipher</a></span><span class="op" id="3963375">.</span><span class="ident" id="3963376">NewCTR</span><span class="op" id="3963382">(</span><span class="ident" id="3963383"><a href="/crypto/tls/ticket.go.html#3963174">block</a></span><span class="op" id="3963388">,</span>&nbsp;<span class="ident" id="3963390"><a href="/crypto/tls/ticket.go.html#3962865">iv</a></span><span class="op" id="3963392">)</span><span class="op" id="3963393">.</span><span class="ident" id="3963394">XORKeyStream</span><span class="op" id="3963406">(</span><span class="ident" id="3963407"><a href="/crypto/tls/ticket.go.html#3963344">plaintext</a></span><span class="op" id="3963416">,</span>&nbsp;<span class="ident" id="3963418"><a href="/crypto/tls/ticket.go.html#3963275">ciphertext</a></span><span class="op" id="3963428">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963432">state</span>&nbsp;<span class="op" id="3963438">:=</span>&nbsp;<span class="builtinfunc" id="3963441">new</span><span class="op" id="3963444">(</span><span class="ident" id="3963445"><a href="/crypto/tls/ticket.go.html#3959716">sessionState</a></span><span class="op" id="3963457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963460">ok</span>&nbsp;<span class="op" id="3963463">:=</span>&nbsp;<span class="ident" id="3963466"><a href="/crypto/tls/ticket.go.html#3963432">state</a></span><span class="op" id="3963471">.</span><span class="ident" id="3963472">unmarshal</span><span class="op" id="3963481">(</span><span class="ident" id="3963482"><a href="/crypto/tls/ticket.go.html#3963344">plaintext</a></span><span class="op" id="3963491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963494">return</span>&nbsp;<span class="ident" id="3963501"><a href="/crypto/tls/ticket.go.html#3963432">state</a></span><span class="op" id="3963506">,</span>&nbsp;<span class="ident" id="3963508"><a href="/crypto/tls/ticket.go.html#3963460">ok</a></span><br>
<span class="lineno"></span><span class="op" id="3963511">}</span>
</div>
</body>
</html>
