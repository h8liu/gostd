<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4004389">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4004445">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4004499">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4004550">//&nbsp;Package&nbsp;textproto&nbsp;implements&nbsp;generic&nbsp;support&nbsp;for&nbsp;text-based&nbsp;request/response</span><br>
<span class="lineno"></span><span class="comment" id="4004630">//&nbsp;protocols&nbsp;in&nbsp;the&nbsp;style&nbsp;of&nbsp;HTTP,&nbsp;NNTP,&nbsp;and&nbsp;SMTP.</span><br>
<span class="lineno"></span><span class="comment" id="4004681">//</span><br>
<span class="lineno"></span><span class="comment" id="4004684">//&nbsp;The&nbsp;package&nbsp;provides:</span><br>
<span class="lineno"></span><span class="comment" id="4004709">//</span><br>
<span class="lineno">10</span><span class="comment" id="4004712">//&nbsp;Error,&nbsp;which&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4004769">//&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="4004782">//</span><br>
<span class="lineno"></span><span class="comment" id="4004785">//&nbsp;Pipeline,&nbsp;to&nbsp;manage&nbsp;pipelined&nbsp;requests&nbsp;and&nbsp;responses</span><br>
<span class="lineno"></span><span class="comment" id="4004841">//&nbsp;in&nbsp;a&nbsp;client.</span><br>
<span class="lineno">15</span><span class="comment" id="4004857">//</span><br>
<span class="lineno"></span><span class="comment" id="4004860">//&nbsp;Reader,&nbsp;to&nbsp;read&nbsp;numeric&nbsp;response&nbsp;code&nbsp;lines,</span><br>
<span class="lineno"></span><span class="comment" id="4004908">//&nbsp;key:&nbsp;value&nbsp;headers,&nbsp;lines&nbsp;wrapped&nbsp;with&nbsp;leading&nbsp;spaces</span><br>
<span class="lineno"></span><span class="comment" id="4004965">//&nbsp;on&nbsp;continuation&nbsp;lines,&nbsp;and&nbsp;whole&nbsp;text&nbsp;blocks&nbsp;ending</span><br>
<span class="lineno"></span><span class="comment" id="4005020">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself.</span><br>
<span class="lineno">20</span><span class="comment" id="4005055">//</span><br>
<span class="lineno"></span><span class="comment" id="4005058">//&nbsp;Writer,&nbsp;to&nbsp;write&nbsp;dot-encoded&nbsp;text&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="comment" id="4005103">//</span><br>
<span class="lineno"></span><span class="comment" id="4005106">//&nbsp;Conn,&nbsp;a&nbsp;convenient&nbsp;packaging&nbsp;of&nbsp;Reader,&nbsp;Writer,&nbsp;and&nbsp;Pipeline&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="4005178">//&nbsp;with&nbsp;a&nbsp;single&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">25</span><span class="comment" id="4005215">//</span><br>
<span class="lineno"></span><span class="keyword" id="4005218">package</span>&nbsp;<span class="ident" id="4005226">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4005237">import</span>&nbsp;<span class="op" id="4005244">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4005247">&#34;bufio&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4005256">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4005263">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4005269">&#34;net&#34;</span><br>
<span class="lineno"></span><span class="op" id="4005275">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4005278">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="4005341">type</span>&nbsp;<span class="ident" id="4005346">Error</span>&nbsp;<span class="keyword" id="4005352">struct</span>&nbsp;<span class="op" id="4005359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005362">Code</span>&nbsp;<span class="builtintype" id="4005367">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005372">Msg</span>&nbsp;&nbsp;<span class="builtintype" id="4005377">string</span><br>
<span class="lineno"></span><span class="op" id="4005384">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4005387">func</span>&nbsp;<span class="op" id="4005392">(</span><span class="ident" id="4005393">e</span>&nbsp;<span class="op" id="4005395">*</span><span class="ident" id="4005396"><a href="/net/textproto/textproto.go.html#4005346">Error</a></span><span class="op" id="4005401">)</span>&nbsp;<span class="ident" id="4005403">Error</span><span class="op" id="4005408">(</span><span class="op" id="4005409">)</span>&nbsp;<span class="builtintype" id="4005411">string</span>&nbsp;<span class="op" id="4005418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005421">return</span>&nbsp;<span class="ident" id="4005428"><a href="/net/textproto/textproto.go.html#4005256">fmt</a></span><span class="op" id="4005431">.</span><span class="ident" id="4005432">Sprintf</span><span class="op" id="4005439">(</span><span class="string" id="4005440">&#34;%03d&nbsp;%s&#34;</span><span class="op" id="4005449">,</span>&nbsp;<span class="ident" id="4005451"><a href="/net/textproto/textproto.go.html#4005393">e</a></span><span class="op" id="4005452">.</span><span class="ident" id="4005453">Code</span><span class="op" id="4005457">,</span>&nbsp;<span class="ident" id="4005459"><a href="/net/textproto/textproto.go.html#4005393">e</a></span><span class="op" id="4005460">.</span><span class="ident" id="4005461">Msg</span><span class="op" id="4005464">)</span><br>
<span class="lineno"></span><span class="op" id="4005466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4005469">//&nbsp;A&nbsp;ProtocolError&nbsp;describes&nbsp;a&nbsp;protocol&nbsp;violation&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4005524">//&nbsp;as&nbsp;an&nbsp;invalid&nbsp;response&nbsp;or&nbsp;a&nbsp;hung-up&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4005575">type</span>&nbsp;<span class="ident" id="4005580">ProtocolError</span>&nbsp;<span class="builtintype" id="4005594">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4005602">func</span>&nbsp;<span class="op" id="4005607">(</span><span class="ident" id="4005608">p</span>&nbsp;<span class="ident" id="4005610"><a href="/net/textproto/textproto.go.html#4005580">ProtocolError</a></span><span class="op" id="4005623">)</span>&nbsp;<span class="ident" id="4005625">Error</span><span class="op" id="4005630">(</span><span class="op" id="4005631">)</span>&nbsp;<span class="builtintype" id="4005633">string</span>&nbsp;<span class="op" id="4005640">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005643">return</span>&nbsp;<span class="builtintype" id="4005650">string</span><span class="op" id="4005656">(</span><span class="ident" id="4005657"><a href="/net/textproto/textproto.go.html#4005608">p</a></span><span class="op" id="4005658">)</span><br>
<span class="lineno"></span><span class="op" id="4005660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4005663">//&nbsp;A&nbsp;Conn&nbsp;represents&nbsp;a&nbsp;textual&nbsp;network&nbsp;protocol&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="4005723">//&nbsp;It&nbsp;consists&nbsp;of&nbsp;a&nbsp;Reader&nbsp;and&nbsp;Writer&nbsp;to&nbsp;manage&nbsp;I/O</span><br>
<span class="lineno">55</span><span class="comment" id="4005775">//&nbsp;and&nbsp;a&nbsp;Pipeline&nbsp;to&nbsp;sequence&nbsp;concurrent&nbsp;requests&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="4005844">//&nbsp;These&nbsp;embedded&nbsp;types&nbsp;carry&nbsp;methods&nbsp;with&nbsp;them;</span><br>
<span class="lineno"></span><span class="comment" id="4005893">//&nbsp;see&nbsp;the&nbsp;documentation&nbsp;of&nbsp;those&nbsp;types&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="4005946">type</span>&nbsp;<span class="ident" id="4005951">Conn</span>&nbsp;<span class="keyword" id="4005956">struct</span>&nbsp;<span class="op" id="4005963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005966"><a href="/net/textproto/reader.go.html#3988643">Reader</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005974"><a href="/net/textproto/writer.go.html#4008497">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005982"><a href="/net/textproto/pipeline.go.html#3985904">Pipeline</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005992">conn</span>&nbsp;<span class="ident" id="4005997"><a href="/net/textproto/textproto.go.html#4005263">io</a></span><span class="op" id="4005999">.</span><span class="ident" id="4006000">ReadWriteCloser</span><br>
<span class="lineno"></span><span class="op" id="4006016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="4006019">//&nbsp;NewConn&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;using&nbsp;conn&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="4006069">func</span>&nbsp;<span class="ident" id="4006074">NewConn</span><span class="op" id="4006081">(</span><span class="ident" id="4006082">conn</span>&nbsp;<span class="ident" id="4006087"><a href="/net/textproto/textproto.go.html#4005263">io</a></span><span class="op" id="4006089">.</span><span class="ident" id="4006090">ReadWriteCloser</span><span class="op" id="4006105">)</span>&nbsp;<span class="op" id="4006107">*</span><span class="ident" id="4006108"><a href="/net/textproto/textproto.go.html#4005951">Conn</a></span>&nbsp;<span class="op" id="4006113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006116">return</span>&nbsp;<span class="op" id="4006123">&amp;</span><span class="ident" id="4006124"><a href="/net/textproto/textproto.go.html#4005951">Conn</a></span><span class="op" id="4006128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006132">Reader</span><span class="op" id="4006138">:</span>&nbsp;<span class="ident" id="4006140"><a href="/net/textproto/reader.go.html#3988643">Reader</a></span><span class="op" id="4006146">{</span><span class="ident" id="4006147">R</span><span class="op" id="4006148">:</span>&nbsp;<span class="ident" id="4006150"><a href="/net/textproto/textproto.go.html#4005247">bufio</a></span><span class="op" id="4006155">.</span><span class="ident" id="4006156">NewReader</span><span class="op" id="4006165">(</span><span class="ident" id="4006166"><a href="/net/textproto/textproto.go.html#4006082">conn</a></span><span class="op" id="4006170">)</span><span class="op" id="4006171">}</span><span class="op" id="4006172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006176">Writer</span><span class="op" id="4006182">:</span>&nbsp;<span class="ident" id="4006184"><a href="/net/textproto/writer.go.html#4008497">Writer</a></span><span class="op" id="4006190">{</span><span class="ident" id="4006191">W</span><span class="op" id="4006192">:</span>&nbsp;<span class="ident" id="4006194"><a href="/net/textproto/textproto.go.html#4005247">bufio</a></span><span class="op" id="4006199">.</span><span class="ident" id="4006200">NewWriter</span><span class="op" id="4006209">(</span><span class="ident" id="4006210"><a href="/net/textproto/textproto.go.html#4006082">conn</a></span><span class="op" id="4006214">)</span><span class="op" id="4006215">}</span><span class="op" id="4006216">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006220">conn</span><span class="op" id="4006224">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4006228"><a href="/net/textproto/textproto.go.html#4006082">conn</a></span><span class="op" id="4006232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006235">}</span><br>
<span class="lineno"></span><span class="op" id="4006237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4006240">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">75</span><span class="keyword" id="4006272">func</span>&nbsp;<span class="op" id="4006277">(</span><span class="ident" id="4006278">c</span>&nbsp;<span class="op" id="4006280">*</span><span class="ident" id="4006281"><a href="/net/textproto/textproto.go.html#4005951">Conn</a></span><span class="op" id="4006285">)</span>&nbsp;<span class="ident" id="4006287">Close</span><span class="op" id="4006292">(</span><span class="op" id="4006293">)</span>&nbsp;<span class="builtintype" id="4006295">error</span>&nbsp;<span class="op" id="4006301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006304">return</span>&nbsp;<span class="ident" id="4006311"><a href="/net/textproto/textproto.go.html#4006278">c</a></span><span class="op" id="4006312">.</span><span class="ident" id="4006313">conn</span><span class="op" id="4006317">.</span><span class="ident" id="4006318">Close</span><span class="op" id="4006323">(</span><span class="op" id="4006324">)</span><br>
<span class="lineno"></span><span class="op" id="4006326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4006329">//&nbsp;Dial&nbsp;connects&nbsp;to&nbsp;the&nbsp;given&nbsp;address&nbsp;on&nbsp;the&nbsp;given&nbsp;network&nbsp;using&nbsp;net.Dial</span><br>
<span class="lineno">80</span><span class="comment" id="4006403">//&nbsp;and&nbsp;then&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4006454">func</span>&nbsp;<span class="ident" id="4006459">Dial</span><span class="op" id="4006463">(</span><span class="ident" id="4006464">network</span><span class="op" id="4006471">,</span>&nbsp;<span class="ident" id="4006473">addr</span>&nbsp;<span class="builtintype" id="4006478">string</span><span class="op" id="4006484">)</span>&nbsp;<span class="op" id="4006486">(</span><span class="op" id="4006487">*</span><span class="ident" id="4006488"><a href="/net/textproto/textproto.go.html#4005951">Conn</a></span><span class="op" id="4006492">,</span>&nbsp;<span class="builtintype" id="4006494">error</span><span class="op" id="4006499">)</span>&nbsp;<span class="op" id="4006501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006504">c</span><span class="op" id="4006505">,</span>&nbsp;<span class="ident" id="4006507">err</span>&nbsp;<span class="op" id="4006511">:=</span>&nbsp;<span class="ident" id="4006514"><a href="/net/textproto/textproto.go.html#4005269">net</a></span><span class="op" id="4006517">.</span><span class="ident" id="4006518">Dial</span><span class="op" id="4006522">(</span><span class="ident" id="4006523"><a href="/net/textproto/textproto.go.html#4006464">network</a></span><span class="op" id="4006530">,</span>&nbsp;<span class="ident" id="4006532"><a href="/net/textproto/textproto.go.html#4006473">addr</a></span><span class="op" id="4006536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006539">if</span>&nbsp;<span class="ident" id="4006542"><a href="/net/textproto/textproto.go.html#4006507">err</a></span>&nbsp;<span class="op" id="4006546">!=</span>&nbsp;<span class="ident" id="4006549">nil</span>&nbsp;<span class="op" id="4006553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006557">return</span>&nbsp;<span class="ident" id="4006564">nil</span><span class="op" id="4006567">,</span>&nbsp;<span class="ident" id="4006569"><a href="/net/textproto/textproto.go.html#4006507">err</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006577">return</span>&nbsp;<span class="ident" id="4006584"><a href="/net/textproto/textproto.go.html#4006074">NewConn</a></span><span class="op" id="4006591">(</span><span class="ident" id="4006592"><a href="/net/textproto/textproto.go.html#4006504">c</a></span><span class="op" id="4006593">)</span><span class="op" id="4006594">,</span>&nbsp;<span class="ident" id="4006596">nil</span><br>
<span class="lineno"></span><span class="op" id="4006600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4006603">//&nbsp;Cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;after</span><br>
<span class="lineno">90</span><span class="comment" id="4006661">//&nbsp;waiting&nbsp;its&nbsp;turn&nbsp;in&nbsp;the&nbsp;pipeline.&nbsp;&nbsp;The&nbsp;command&nbsp;text&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4006723">//&nbsp;result&nbsp;of&nbsp;formatting&nbsp;format&nbsp;with&nbsp;args&nbsp;and&nbsp;appending&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="comment" id="4006784">//&nbsp;Cmd&nbsp;returns&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;command,&nbsp;for&nbsp;use&nbsp;with&nbsp;StartResponse&nbsp;and&nbsp;EndResponse.</span><br>
<span class="lineno"></span><span class="comment" id="4006866">//</span><br>
<span class="lineno"></span><span class="comment" id="4006869">//&nbsp;For&nbsp;example,&nbsp;a&nbsp;client&nbsp;might&nbsp;run&nbsp;a&nbsp;HELP&nbsp;command&nbsp;that&nbsp;returns&nbsp;a&nbsp;dot-body</span><br>
<span class="lineno">95</span><span class="comment" id="4006943">//&nbsp;by&nbsp;using:</span><br>
<span class="lineno"></span><span class="comment" id="4006956">//</span><br>
<span class="lineno"></span><span class="comment" id="4006959">//&nbsp;&nbsp;&nbsp;&nbspid,&nbsp;err&nbsp;:=&nbsp;c.Cmd(&#34;HELP&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="4006987">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4007006">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno">100</span><span class="comment" id="4007026">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="4007031">//</span><br>
<span class="lineno"></span><span class="comment" id="4007034">//&nbsp;&nbsp;&nbsp;&nbspc.StartResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="4007057">//&nbsp;&nbsp;&nbsp;&nbspdefer&nbsp;c.EndResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="4007084">//</span><br>
<span class="lineno">105</span><span class="comment" id="4007087">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;_,&nbsp;_,&nbsp;err&nbsp;=&nbsp;c.ReadCodeLine(110);&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4007139">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="4007159">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="4007164">//&nbsp;&nbsp;&nbsp;&nbsptext,&nbsp;err&nbsp;:=&nbsp;c.ReadDotBytes()</span><br>
<span class="lineno"></span><span class="comment" id="4007197">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno">110</span><span class="comment" id="4007216">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="4007236">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="4007241">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;c.ReadCodeLine(250)</span><br>
<span class="lineno"></span><span class="comment" id="4007271">//</span><br>
<span class="lineno"></span><span class="keyword" id="4007274">func</span>&nbsp;<span class="op" id="4007279">(</span><span class="ident" id="4007280">c</span>&nbsp;<span class="op" id="4007282">*</span><span class="ident" id="4007283"><a href="/net/textproto/textproto.go.html#4005951">Conn</a></span><span class="op" id="4007287">)</span>&nbsp;<span class="ident" id="4007289">Cmd</span><span class="op" id="4007292">(</span><span class="ident" id="4007293">format</span>&nbsp;<span class="builtintype" id="4007300">string</span><span class="op" id="4007306">,</span>&nbsp;<span class="ident" id="4007308">args</span>&nbsp;<span class="op" id="4007313">...</span><span class="keyword" id="4007316">interface</span><span class="op" id="4007325">{</span><span class="op" id="4007326">}</span><span class="op" id="4007327">)</span>&nbsp;<span class="op" id="4007329">(</span><span class="ident" id="4007330">id</span>&nbsp;<span class="builtintype" id="4007333">uint</span><span class="op" id="4007337">,</span>&nbsp;<span class="ident" id="4007339">err</span>&nbsp;<span class="builtintype" id="4007343">error</span><span class="op" id="4007348">)</span>&nbsp;<span class="op" id="4007350">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007353"><a href="/net/textproto/textproto.go.html#4007330">id</a></span>&nbsp;<span class="op" id="4007356">=</span>&nbsp;<span class="ident" id="4007358"><a href="/net/textproto/textproto.go.html#4007280">c</a></span><span class="op" id="4007359">.</span><span class="ident" id="4007360">Next</span><span class="op" id="4007364">(</span><span class="op" id="4007365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007368"><a href="/net/textproto/textproto.go.html#4007280">c</a></span><span class="op" id="4007369">.</span><span class="ident" id="4007370">StartRequest</span><span class="op" id="4007382">(</span><span class="ident" id="4007383"><a href="/net/textproto/textproto.go.html#4007330">id</a></span><span class="op" id="4007385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007388"><a href="/net/textproto/textproto.go.html#4007339">err</a></span>&nbsp;<span class="op" id="4007392">=</span>&nbsp;<span class="ident" id="4007394"><a href="/net/textproto/textproto.go.html#4007280">c</a></span><span class="op" id="4007395">.</span><span class="ident" id="4007396">PrintfLine</span><span class="op" id="4007406">(</span><span class="ident" id="4007407"><a href="/net/textproto/textproto.go.html#4007293">format</a></span><span class="op" id="4007413">,</span>&nbsp;<span class="ident" id="4007415"><a href="/net/textproto/textproto.go.html#4007308">args</a></span><span class="op" id="4007419">...</span><span class="op" id="4007422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007425"><a href="/net/textproto/textproto.go.html#4007280">c</a></span><span class="op" id="4007426">.</span><span class="ident" id="4007427">EndRequest</span><span class="op" id="4007437">(</span><span class="ident" id="4007438"><a href="/net/textproto/textproto.go.html#4007330">id</a></span><span class="op" id="4007440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007443">if</span>&nbsp;<span class="ident" id="4007446"><a href="/net/textproto/textproto.go.html#4007339">err</a></span>&nbsp;<span class="op" id="4007450">!=</span>&nbsp;<span class="ident" id="4007453">nil</span>&nbsp;<span class="op" id="4007457">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007461">return</span>&nbsp;<span class="num" id="4007468">0</span><span class="op" id="4007469">,</span>&nbsp;<span class="ident" id="4007471"><a href="/net/textproto/textproto.go.html#4007339">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007479">return</span>&nbsp;<span class="ident" id="4007486"><a href="/net/textproto/textproto.go.html#4007330">id</a></span><span class="op" id="4007488">,</span>&nbsp;<span class="ident" id="4007490">nil</span><br>
<span class="lineno"></span><span class="op" id="4007494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4007497">//&nbsp;TrimString&nbsp;returns&nbsp;s&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="4007563">func</span>&nbsp;<span class="ident" id="4007568">TrimString</span><span class="op" id="4007578">(</span><span class="ident" id="4007579">s</span>&nbsp;<span class="builtintype" id="4007581">string</span><span class="op" id="4007587">)</span>&nbsp;<span class="builtintype" id="4007589">string</span>&nbsp;<span class="op" id="4007596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007599">for</span>&nbsp;<span class="builtinfunc" id="4007603">len</span><span class="op" id="4007606">(</span><span class="ident" id="4007607"><a href="/net/textproto/textproto.go.html#4007579">s</a></span><span class="op" id="4007608">)</span>&nbsp;<span class="op" id="4007610">&gt;</span>&nbsp;<span class="num" id="4007612">0</span>&nbsp;<span class="op" id="4007614">&amp;&amp;</span>&nbsp;<span class="ident" id="4007617"><a href="/net/textproto/textproto.go.html#4007976">isASCIISpace</a></span><span class="op" id="4007629">(</span><span class="ident" id="4007630"><a href="/net/textproto/textproto.go.html#4007579">s</a></span><span class="op" id="4007631">[</span><span class="num" id="4007632">0</span><span class="op" id="4007633">]</span><span class="op" id="4007634">)</span>&nbsp;<span class="op" id="4007636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007640"><a href="/net/textproto/textproto.go.html#4007579">s</a></span>&nbsp;<span class="op" id="4007642">=</span>&nbsp;<span class="ident" id="4007644"><a href="/net/textproto/textproto.go.html#4007579">s</a></span><span class="op" id="4007645">[</span><span class="num" id="4007646">1</span><span class="op" id="4007647">:</span><span class="op" id="4007648">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007651">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007654">for</span>&nbsp;<span class="builtinfunc" id="4007658">len</span><span class="op" id="4007661">(</span><span class="ident" id="4007662"><a href="/net/textproto/textproto.go.html#4007579">s</a></span><span class="op" id="4007663">)</span>&nbsp;<span class="op" id="4007665">&gt;</span>&nbsp;<span class="num" id="4007667">0</span>&nbsp;<span class="op" id="4007669">&amp;&amp;</span>&nbsp;<span class="ident" id="4007672"><a href="/net/textproto/textproto.go.html#4007976">isASCIISpace</a></span><span class="op" id="4007684">(</span><span class="ident" id="4007685"><a href="/net/textproto/textproto.go.html#4007579">s</a></span><span class="op" id="4007686">[</span><span class="builtinfunc" id="4007687">len</span><span class="op" id="4007690">(</span><span class="ident" id="4007691"><a href="/net/textproto/textproto.go.html#4007579">s</a></span><span class="op" id="4007692">)</span><span class="op" id="4007693">-</span><span class="num" id="4007694">1</span><span class="op" id="4007695">]</span><span class="op" id="4007696">)</span>&nbsp;<span class="op" id="4007698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007702"><a href="/net/textproto/textproto.go.html#4007579">s</a></span>&nbsp;<span class="op" id="4007704">=</span>&nbsp;<span class="ident" id="4007706"><a href="/net/textproto/textproto.go.html#4007579">s</a></span><span class="op" id="4007707">[</span><span class="op" id="4007708">:</span><span class="builtinfunc" id="4007709">len</span><span class="op" id="4007712">(</span><span class="ident" id="4007713"><a href="/net/textproto/textproto.go.html#4007579">s</a></span><span class="op" id="4007714">)</span><span class="op" id="4007715">-</span><span class="num" id="4007716">1</span><span class="op" id="4007717">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007723">return</span>&nbsp;<span class="ident" id="4007730"><a href="/net/textproto/textproto.go.html#4007579">s</a></span><br>
<span class="lineno"></span><span class="op" id="4007732">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="4007735">//&nbsp;TrimBytes&nbsp;returns&nbsp;b&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="4007800">func</span>&nbsp;<span class="ident" id="4007805">TrimBytes</span><span class="op" id="4007814">(</span><span class="ident" id="4007815">b</span>&nbsp;<span class="op" id="4007817">[</span><span class="op" id="4007818">]</span><span class="builtintype" id="4007819">byte</span><span class="op" id="4007823">)</span>&nbsp;<span class="op" id="4007825">[</span><span class="op" id="4007826">]</span><span class="builtintype" id="4007827">byte</span>&nbsp;<span class="op" id="4007832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007835">for</span>&nbsp;<span class="builtinfunc" id="4007839">len</span><span class="op" id="4007842">(</span><span class="ident" id="4007843"><a href="/net/textproto/textproto.go.html#4007815">b</a></span><span class="op" id="4007844">)</span>&nbsp;<span class="op" id="4007846">&gt;</span>&nbsp;<span class="num" id="4007848">0</span>&nbsp;<span class="op" id="4007850">&amp;&amp;</span>&nbsp;<span class="ident" id="4007853"><a href="/net/textproto/textproto.go.html#4007976">isASCIISpace</a></span><span class="op" id="4007865">(</span><span class="ident" id="4007866"><a href="/net/textproto/textproto.go.html#4007815">b</a></span><span class="op" id="4007867">[</span><span class="num" id="4007868">0</span><span class="op" id="4007869">]</span><span class="op" id="4007870">)</span>&nbsp;<span class="op" id="4007872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007876"><a href="/net/textproto/textproto.go.html#4007815">b</a></span>&nbsp;<span class="op" id="4007878">=</span>&nbsp;<span class="ident" id="4007880"><a href="/net/textproto/textproto.go.html#4007815">b</a></span><span class="op" id="4007881">[</span><span class="num" id="4007882">1</span><span class="op" id="4007883">:</span><span class="op" id="4007884">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007890">for</span>&nbsp;<span class="builtinfunc" id="4007894">len</span><span class="op" id="4007897">(</span><span class="ident" id="4007898"><a href="/net/textproto/textproto.go.html#4007815">b</a></span><span class="op" id="4007899">)</span>&nbsp;<span class="op" id="4007901">&gt;</span>&nbsp;<span class="num" id="4007903">0</span>&nbsp;<span class="op" id="4007905">&amp;&amp;</span>&nbsp;<span class="ident" id="4007908"><a href="/net/textproto/textproto.go.html#4007976">isASCIISpace</a></span><span class="op" id="4007920">(</span><span class="ident" id="4007921"><a href="/net/textproto/textproto.go.html#4007815">b</a></span><span class="op" id="4007922">[</span><span class="builtinfunc" id="4007923">len</span><span class="op" id="4007926">(</span><span class="ident" id="4007927"><a href="/net/textproto/textproto.go.html#4007815">b</a></span><span class="op" id="4007928">)</span><span class="op" id="4007929">-</span><span class="num" id="4007930">1</span><span class="op" id="4007931">]</span><span class="op" id="4007932">)</span>&nbsp;<span class="op" id="4007934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007938"><a href="/net/textproto/textproto.go.html#4007815">b</a></span>&nbsp;<span class="op" id="4007940">=</span>&nbsp;<span class="ident" id="4007942"><a href="/net/textproto/textproto.go.html#4007815">b</a></span><span class="op" id="4007943">[</span><span class="op" id="4007944">:</span><span class="builtinfunc" id="4007945">len</span><span class="op" id="4007948">(</span><span class="ident" id="4007949"><a href="/net/textproto/textproto.go.html#4007815">b</a></span><span class="op" id="4007950">)</span><span class="op" id="4007951">-</span><span class="num" id="4007952">1</span><span class="op" id="4007953">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007959">return</span>&nbsp;<span class="ident" id="4007966"><a href="/net/textproto/textproto.go.html#4007815">b</a></span><br>
<span class="lineno">145</span><span class="op" id="4007968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4007971">func</span>&nbsp;<span class="ident" id="4007976">isASCIISpace</span><span class="op" id="4007988">(</span><span class="ident" id="4007989">b</span>&nbsp;<span class="builtintype" id="4007991">byte</span><span class="op" id="4007995">)</span>&nbsp;<span class="builtintype" id="4007997">bool</span>&nbsp;<span class="op" id="4008002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008005">return</span>&nbsp;<span class="ident" id="4008012"><a href="/net/textproto/textproto.go.html#4007989">b</a></span>&nbsp;<span class="op" id="4008014">==</span>&nbsp;<span class="string" id="4008017">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4008021">||</span>&nbsp;<span class="ident" id="4008024"><a href="/net/textproto/textproto.go.html#4007989">b</a></span>&nbsp;<span class="op" id="4008026">==</span>&nbsp;<span class="string" id="4008029">&#39;\t&#39;</span>&nbsp;<span class="op" id="4008034">||</span>&nbsp;<span class="ident" id="4008037"><a href="/net/textproto/textproto.go.html#4007989">b</a></span>&nbsp;<span class="op" id="4008039">==</span>&nbsp;<span class="string" id="4008042">&#39;\n&#39;</span>&nbsp;<span class="op" id="4008047">||</span>&nbsp;<span class="ident" id="4008050"><a href="/net/textproto/textproto.go.html#4007989">b</a></span>&nbsp;<span class="op" id="4008052">==</span>&nbsp;<span class="string" id="4008055">&#39;\r&#39;</span><br>
<span class="lineno"></span><span class="op" id="4008060">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="4008063">func</span>&nbsp;<span class="ident" id="4008068">isASCIILetter</span><span class="op" id="4008081">(</span><span class="ident" id="4008082">b</span>&nbsp;<span class="builtintype" id="4008084">byte</span><span class="op" id="4008088">)</span>&nbsp;<span class="builtintype" id="4008090">bool</span>&nbsp;<span class="op" id="4008095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008098"><a href="/net/textproto/textproto.go.html#4008082">b</a></span>&nbsp;<span class="op" id="4008100">|=</span>&nbsp;<span class="num" id="4008103">0x20</span>&nbsp;<span class="comment" id="4008108">//&nbsp;make&nbsp;lower&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008128">return</span>&nbsp;<span class="string" id="4008135">&#39;a&#39;</span>&nbsp;<span class="op" id="4008139">&lt;=</span>&nbsp;<span class="ident" id="4008142"><a href="/net/textproto/textproto.go.html#4008082">b</a></span>&nbsp;<span class="op" id="4008144">&amp;&amp;</span>&nbsp;<span class="ident" id="4008147"><a href="/net/textproto/textproto.go.html#4008082">b</a></span>&nbsp;<span class="op" id="4008149">&lt;=</span>&nbsp;<span class="string" id="4008152">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="4008156">}</span>
</div>
</body>
</html>
