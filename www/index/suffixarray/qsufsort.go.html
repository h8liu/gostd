<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5361984">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5362039">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5362093">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5362144">//&nbsp;This&nbsp;algorithm&nbsp;is&nbsp;based&nbsp;on&nbsp;&#34;Faster&nbsp;Suffix&nbsp;Sorting&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5362198">//&nbsp;&nbsp;&nbsp;by&nbsp;N.&nbsp;Jesper&nbsp;Larsson&nbsp;and&nbsp;Kunihiko&nbsp;Sadakane</span><br>
<span class="lineno"></span><span class="comment" id="5362246">//&nbsp;paper:&nbsp;http://www.larsson.dogma.net/ssrev-tr.pdf</span><br>
<span class="lineno"></span><span class="comment" id="5362298">//&nbsp;code:&nbsp;&nbsp;http://www.larsson.dogma.net/qsufsort.c</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="5362349">//&nbsp;This&nbsp;algorithm&nbsp;computes&nbsp;the&nbsp;suffix&nbsp;array&nbsp;sa&nbsp;by&nbsp;computing&nbsp;its&nbsp;inverse.</span><br>
<span class="lineno"></span><span class="comment" id="5362422">//&nbsp;Consecutive&nbsp;groups&nbsp;of&nbsp;suffixes&nbsp;in&nbsp;sa&nbsp;are&nbsp;labeled&nbsp;as&nbsp;sorted&nbsp;groups&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5362494">//&nbsp;unsorted&nbsp;groups.&nbsp;For&nbsp;a&nbsp;given&nbsp;pass&nbsp;of&nbsp;the&nbsp;sorter,&nbsp;all&nbsp;suffixes&nbsp;are&nbsp;ordered</span><br>
<span class="lineno"></span><span class="comment" id="5362571">//&nbsp;up&nbsp;to&nbsp;their&nbsp;first&nbsp;h&nbsp;characters,&nbsp;and&nbsp;sa&nbsp;is&nbsp;h-ordered.&nbsp;Suffixes&nbsp;in&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="5362645">//&nbsp;final&nbsp;positions&nbsp;and&nbsp;unambiguously&nbsp;sorted&nbsp;in&nbsp;h-order&nbsp;are&nbsp;in&nbsp;a&nbsp;sorted&nbsp;group.</span><br>
<span class="lineno">15</span><span class="comment" id="5362723">//&nbsp;Consecutive&nbsp;groups&nbsp;of&nbsp;suffixes&nbsp;with&nbsp;identical&nbsp;first&nbsp;h&nbsp;characters&nbsp;are&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5362798">//&nbsp;unsorted&nbsp;group.&nbsp;In&nbsp;each&nbsp;pass&nbsp;of&nbsp;the&nbsp;algorithm,&nbsp;unsorted&nbsp;groups&nbsp;are&nbsp;sorted</span><br>
<span class="lineno"></span><span class="comment" id="5362875">//&nbsp;according&nbsp;to&nbsp;the&nbsp;group&nbsp;number&nbsp;of&nbsp;their&nbsp;following&nbsp;suffix.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5362936">//&nbsp;In&nbsp;the&nbsp;implementation,&nbsp;if&nbsp;sa[i]&nbsp;is&nbsp;negative,&nbsp;it&nbsp;indicates&nbsp;that&nbsp;i&nbsp;is</span><br>
<span class="lineno">20</span><span class="comment" id="5363007">//&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;a&nbsp;sorted&nbsp;group&nbsp;of&nbsp;length&nbsp;-sa[i],&nbsp;and&nbsp;can&nbsp;be&nbsp;skipped.</span><br>
<span class="lineno"></span><span class="comment" id="5363084">//&nbsp;An&nbsp;unsorted&nbsp;group&nbsp;sa[i:k]&nbsp;is&nbsp;given&nbsp;the&nbsp;group&nbsp;number&nbsp;of&nbsp;the&nbsp;index&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5363159">//&nbsp;last&nbsp;element,&nbsp;k-1.&nbsp;The&nbsp;group&nbsp;numbers&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;inverse&nbsp;slice&nbsp;(inv),</span><br>
<span class="lineno"></span><span class="comment" id="5363238">//&nbsp;and&nbsp;when&nbsp;all&nbsp;groups&nbsp;are&nbsp;sorted,&nbsp;this&nbsp;slice&nbsp;is&nbsp;the&nbsp;inverse&nbsp;suffix&nbsp;array.</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="5363314">package</span>&nbsp;<span class="ident" id="5363322">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5363335">import</span>&nbsp;<span class="string" id="5363342">&#34;sort&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5363350">func</span>&nbsp;<span class="ident" id="5363355">qsufsort</span><span class="op" id="5363363">(</span><span class="ident" id="5363364">data</span>&nbsp;<span class="op" id="5363369">[</span><span class="op" id="5363370">]</span><span class="builtintype" id="5363371">byte</span><span class="op" id="5363375">)</span>&nbsp;<span class="op" id="5363377">[</span><span class="op" id="5363378">]</span><span class="builtintype" id="5363379">int</span>&nbsp;<span class="op" id="5363383">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5363386">//&nbsp;initial&nbsp;sorting&nbsp;by&nbsp;first&nbsp;byte&nbsp;of&nbsp;suffix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5363430">sa</span>&nbsp;<span class="op" id="5363433">:=</span>&nbsp;<span class="ident" id="5363436"><a href="/index/suffixarray/qsufsort.go.html#5364695">sortedByFirstByte</a></span><span class="op" id="5363453">(</span><span class="ident" id="5363454"><a href="/index/suffixarray/qsufsort.go.html#5363364">data</a></span><span class="op" id="5363458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363461">if</span>&nbsp;<span class="builtinfunc" id="5363464">len</span><span class="op" id="5363467">(</span><span class="ident" id="5363468"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5363470">)</span>&nbsp;<span class="op" id="5363472">&lt;</span>&nbsp;<span class="num" id="5363474">2</span>&nbsp;<span class="op" id="5363476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363480">return</span>&nbsp;<span class="ident" id="5363487"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5363491">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5363494">//&nbsp;initialize&nbsp;the&nbsp;group&nbsp;lookup&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5363532">//&nbsp;this&nbsp;becomes&nbsp;the&nbsp;inverse&nbsp;of&nbsp;the&nbsp;suffix&nbsp;array&nbsp;when&nbsp;all&nbsp;groups&nbsp;are&nbsp;sorted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5363608">inv</span>&nbsp;<span class="op" id="5363612">:=</span>&nbsp;<span class="ident" id="5363615"><a href="/index/suffixarray/qsufsort.go.html#5365141">initGroups</a></span><span class="op" id="5363625">(</span><span class="ident" id="5363626"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5363628">,</span>&nbsp;<span class="ident" id="5363630"><a href="/index/suffixarray/qsufsort.go.html#5363364">data</a></span><span class="op" id="5363634">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5363638">//&nbsp;the&nbsp;index&nbsp;starts&nbsp;1-ordered</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5363669">sufSortable</span>&nbsp;<span class="op" id="5363681">:=</span>&nbsp;<span class="op" id="5363684">&amp;</span><span class="ident" id="5363685"><a href="/index/suffixarray/qsufsort.go.html#5366049">suffixSortable</a></span><span class="op" id="5363699">{</span><span class="ident" id="5363700">sa</span><span class="op" id="5363702">:</span>&nbsp;<span class="ident" id="5363704"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5363706">,</span>&nbsp;<span class="ident" id="5363708">inv</span><span class="op" id="5363711">:</span>&nbsp;<span class="ident" id="5363713"><a href="/index/suffixarray/qsufsort.go.html#5363608">inv</a></span><span class="op" id="5363716">,</span>&nbsp;<span class="ident" id="5363718">h</span><span class="op" id="5363719">:</span>&nbsp;<span class="num" id="5363721">1</span><span class="op" id="5363722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363726">for</span>&nbsp;<span class="ident" id="5363730"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5363732">[</span><span class="num" id="5363733">0</span><span class="op" id="5363734">]</span>&nbsp;<span class="op" id="5363736">&gt;</span>&nbsp;<span class="op" id="5363738">-</span><span class="builtinfunc" id="5363739">len</span><span class="op" id="5363742">(</span><span class="ident" id="5363743"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5363745">)</span>&nbsp;<span class="op" id="5363747">{</span>&nbsp;<span class="comment" id="5363749">//&nbsp;until&nbsp;all&nbsp;suffixes&nbsp;are&nbsp;one&nbsp;big&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5363798">//&nbsp;The&nbsp;suffixes&nbsp;are&nbsp;h-ordered,&nbsp;make&nbsp;them&nbsp;2*h-ordered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5363853">pi</span>&nbsp;<span class="op" id="5363856">:=</span>&nbsp;<span class="num" id="5363859">0</span>&nbsp;<span class="comment" id="5363861">//&nbsp;pi&nbsp;is&nbsp;first&nbsp;position&nbsp;of&nbsp;first&nbsp;group</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5363902">sl</span>&nbsp;<span class="op" id="5363905">:=</span>&nbsp;<span class="num" id="5363908">0</span>&nbsp;<span class="comment" id="5363910">//&nbsp;sl&nbsp;is&nbsp;negated&nbsp;length&nbsp;of&nbsp;sorted&nbsp;groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363953">for</span>&nbsp;<span class="ident" id="5363957"><a href="/index/suffixarray/qsufsort.go.html#5363853">pi</a></span>&nbsp;<span class="op" id="5363960">&lt;</span>&nbsp;<span class="builtinfunc" id="5363962">len</span><span class="op" id="5363965">(</span><span class="ident" id="5363966"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5363968">)</span>&nbsp;<span class="op" id="5363970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363975">if</span>&nbsp;<span class="ident" id="5363978">s</span>&nbsp;<span class="op" id="5363980">:=</span>&nbsp;<span class="ident" id="5363983"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5363985">[</span><span class="ident" id="5363986"><a href="/index/suffixarray/qsufsort.go.html#5363853">pi</a></span><span class="op" id="5363988">]</span><span class="op" id="5363989">;</span>&nbsp;<span class="ident" id="5363991"><a href="/index/suffixarray/qsufsort.go.html#5363978">s</a></span>&nbsp;<span class="op" id="5363993">&lt;</span>&nbsp;<span class="num" id="5363995">0</span>&nbsp;<span class="op" id="5363997">{</span>&nbsp;<span class="comment" id="5363999">//&nbsp;if&nbsp;pi&nbsp;starts&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364032"><a href="/index/suffixarray/qsufsort.go.html#5363853">pi</a></span>&nbsp;<span class="op" id="5364035">-=</span>&nbsp;<span class="ident" id="5364038"><a href="/index/suffixarray/qsufsort.go.html#5363978">s</a></span>&nbsp;<span class="comment" id="5364040">//&nbsp;skip&nbsp;over&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364070"><a href="/index/suffixarray/qsufsort.go.html#5363902">sl</a></span>&nbsp;<span class="op" id="5364073">+=</span>&nbsp;<span class="ident" id="5364076"><a href="/index/suffixarray/qsufsort.go.html#5363978">s</a></span>&nbsp;<span class="comment" id="5364078">//&nbsp;add&nbsp;negated&nbsp;length&nbsp;to&nbsp;sl</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364109">}</span>&nbsp;<span class="keyword" id="5364111">else</span>&nbsp;<span class="op" id="5364116">{</span>&nbsp;<span class="comment" id="5364118">//&nbsp;if&nbsp;pi&nbsp;starts&nbsp;unsorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364153">if</span>&nbsp;<span class="ident" id="5364156"><a href="/index/suffixarray/qsufsort.go.html#5363902">sl</a></span>&nbsp;<span class="op" id="5364159">!=</span>&nbsp;<span class="num" id="5364162">0</span>&nbsp;<span class="op" id="5364164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364171"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5364173">[</span><span class="ident" id="5364174"><a href="/index/suffixarray/qsufsort.go.html#5363853">pi</a></span><span class="op" id="5364176">+</span><span class="ident" id="5364177"><a href="/index/suffixarray/qsufsort.go.html#5363902">sl</a></span><span class="op" id="5364179">]</span>&nbsp;<span class="op" id="5364181">=</span>&nbsp;<span class="ident" id="5364183"><a href="/index/suffixarray/qsufsort.go.html#5363902">sl</a></span>&nbsp;<span class="comment" id="5364186">//&nbsp;combine&nbsp;sorted&nbsp;groups&nbsp;before&nbsp;pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364226"><a href="/index/suffixarray/qsufsort.go.html#5363902">sl</a></span>&nbsp;<span class="op" id="5364229">=</span>&nbsp;<span class="num" id="5364231">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364237">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364243">pk</span>&nbsp;<span class="op" id="5364246">:=</span>&nbsp;<span class="ident" id="5364249"><a href="/index/suffixarray/qsufsort.go.html#5363608">inv</a></span><span class="op" id="5364252">[</span><span class="ident" id="5364253"><a href="/index/suffixarray/qsufsort.go.html#5363978">s</a></span><span class="op" id="5364254">]</span>&nbsp;<span class="op" id="5364256">+</span>&nbsp;<span class="num" id="5364258">1</span>&nbsp;<span class="comment" id="5364260">//&nbsp;pk-1&nbsp;is&nbsp;last&nbsp;position&nbsp;of&nbsp;unsorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364307"><a href="/index/suffixarray/qsufsort.go.html#5363669">sufSortable</a></span><span class="op" id="5364318">.</span><span class="ident" id="5364319">sa</span>&nbsp;<span class="op" id="5364322">=</span>&nbsp;<span class="ident" id="5364324"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5364326">[</span><span class="ident" id="5364327"><a href="/index/suffixarray/qsufsort.go.html#5363853">pi</a></span><span class="op" id="5364329">:</span><span class="ident" id="5364330"><a href="/index/suffixarray/qsufsort.go.html#5364243">pk</a></span><span class="op" id="5364332">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364338"><a href="/index/suffixarray/qsufsort.go.html#5363342">sort</a></span><span class="op" id="5364342">.</span><span class="ident" id="5364343">Sort</span><span class="op" id="5364347">(</span><span class="ident" id="5364348"><a href="/index/suffixarray/qsufsort.go.html#5363669">sufSortable</a></span><span class="op" id="5364359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364365"><a href="/index/suffixarray/qsufsort.go.html#5363669">sufSortable</a></span><span class="op" id="5364376">.</span><span class="ident" id="5364377">updateGroups</span><span class="op" id="5364389">(</span><span class="ident" id="5364390"><a href="/index/suffixarray/qsufsort.go.html#5363853">pi</a></span><span class="op" id="5364392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364398"><a href="/index/suffixarray/qsufsort.go.html#5363853">pi</a></span>&nbsp;<span class="op" id="5364401">=</span>&nbsp;<span class="ident" id="5364403"><a href="/index/suffixarray/qsufsort.go.html#5364243">pk</a></span>&nbsp;<span class="comment" id="5364406">//&nbsp;next&nbsp;group</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364431">if</span>&nbsp;<span class="ident" id="5364434"><a href="/index/suffixarray/qsufsort.go.html#5363902">sl</a></span>&nbsp;<span class="op" id="5364437">!=</span>&nbsp;<span class="num" id="5364440">0</span>&nbsp;<span class="op" id="5364442">{</span>&nbsp;<span class="comment" id="5364444">//&nbsp;if&nbsp;the&nbsp;array&nbsp;ends&nbsp;with&nbsp;a&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364488"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5364490">[</span><span class="ident" id="5364491"><a href="/index/suffixarray/qsufsort.go.html#5363853">pi</a></span><span class="op" id="5364493">+</span><span class="ident" id="5364494"><a href="/index/suffixarray/qsufsort.go.html#5363902">sl</a></span><span class="op" id="5364496">]</span>&nbsp;<span class="op" id="5364498">=</span>&nbsp;<span class="ident" id="5364500"><a href="/index/suffixarray/qsufsort.go.html#5363902">sl</a></span>&nbsp;<span class="comment" id="5364503">//&nbsp;combine&nbsp;sorted&nbsp;groups&nbsp;at&nbsp;end&nbsp;of&nbsp;sa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364543">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364548"><a href="/index/suffixarray/qsufsort.go.html#5363669">sufSortable</a></span><span class="op" id="5364559">.</span><span class="ident" id="5364560">h</span>&nbsp;<span class="op" id="5364562">*=</span>&nbsp;<span class="num" id="5364565">2</span>&nbsp;<span class="comment" id="5364567">//&nbsp;double&nbsp;sorted&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364595">for</span>&nbsp;<span class="ident" id="5364599">i</span>&nbsp;<span class="op" id="5364601">:=</span>&nbsp;<span class="keyword" id="5364604">range</span>&nbsp;<span class="ident" id="5364610"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span>&nbsp;<span class="op" id="5364613">{</span>&nbsp;<span class="comment" id="5364615">//&nbsp;reconstruct&nbsp;suffix&nbsp;array&nbsp;from&nbsp;inverse</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364658"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><span class="op" id="5364660">[</span><span class="ident" id="5364661"><a href="/index/suffixarray/qsufsort.go.html#5363608">inv</a></span><span class="op" id="5364664">[</span><span class="ident" id="5364665"><a href="/index/suffixarray/qsufsort.go.html#5364599">i</a></span><span class="op" id="5364666">]</span><span class="op" id="5364667">]</span>&nbsp;<span class="op" id="5364669">=</span>&nbsp;<span class="ident" id="5364671"><a href="/index/suffixarray/qsufsort.go.html#5364599">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364677">return</span>&nbsp;<span class="ident" id="5364684"><a href="/index/suffixarray/qsufsort.go.html#5363430">sa</a></span><br>
<span class="lineno"></span><span class="op" id="5364687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="5364690">func</span>&nbsp;<span class="ident" id="5364695">sortedByFirstByte</span><span class="op" id="5364712">(</span><span class="ident" id="5364713">data</span>&nbsp;<span class="op" id="5364718">[</span><span class="op" id="5364719">]</span><span class="builtintype" id="5364720">byte</span><span class="op" id="5364724">)</span>&nbsp;<span class="op" id="5364726">[</span><span class="op" id="5364727">]</span><span class="builtintype" id="5364728">int</span>&nbsp;<span class="op" id="5364732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5364735">//&nbsp;total&nbsp;byte&nbsp;counts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364757">var</span>&nbsp;<span class="ident" id="5364761">count</span>&nbsp;<span class="op" id="5364767">[</span><span class="num" id="5364768">256</span><span class="op" id="5364771">]</span><span class="builtintype" id="5364772">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364777">for</span>&nbsp;<span class="ident" id="5364781">_</span><span class="op" id="5364782">,</span>&nbsp;<span class="ident" id="5364784">b</span>&nbsp;<span class="op" id="5364786">:=</span>&nbsp;<span class="keyword" id="5364789">range</span>&nbsp;<span class="ident" id="5364795"><a href="/index/suffixarray/qsufsort.go.html#5364713">data</a></span>&nbsp;<span class="op" id="5364800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364804"><a href="/index/suffixarray/qsufsort.go.html#5364761">count</a></span><span class="op" id="5364809">[</span><span class="ident" id="5364810"><a href="/index/suffixarray/qsufsort.go.html#5364784">b</a></span><span class="op" id="5364811">]</span><span class="op" id="5364812">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5364819">//&nbsp;make&nbsp;count[b]&nbsp;equal&nbsp;index&nbsp;of&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;b&nbsp;in&nbsp;sorted&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364890">sum</span>&nbsp;<span class="op" id="5364894">:=</span>&nbsp;<span class="num" id="5364897">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364900">for</span>&nbsp;<span class="ident" id="5364904">b</span>&nbsp;<span class="op" id="5364906">:=</span>&nbsp;<span class="keyword" id="5364909">range</span>&nbsp;<span class="ident" id="5364915"><a href="/index/suffixarray/qsufsort.go.html#5364761">count</a></span>&nbsp;<span class="op" id="5364921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364925"><a href="/index/suffixarray/qsufsort.go.html#5364761">count</a></span><span class="op" id="5364930">[</span><span class="ident" id="5364931"><a href="/index/suffixarray/qsufsort.go.html#5364904">b</a></span><span class="op" id="5364932">]</span><span class="op" id="5364933">,</span>&nbsp;<span class="ident" id="5364935"><a href="/index/suffixarray/qsufsort.go.html#5364890">sum</a></span>&nbsp;<span class="op" id="5364939">=</span>&nbsp;<span class="ident" id="5364941"><a href="/index/suffixarray/qsufsort.go.html#5364890">sum</a></span><span class="op" id="5364944">,</span>&nbsp;<span class="ident" id="5364946"><a href="/index/suffixarray/qsufsort.go.html#5364761">count</a></span><span class="op" id="5364951">[</span><span class="ident" id="5364952"><a href="/index/suffixarray/qsufsort.go.html#5364904">b</a></span><span class="op" id="5364953">]</span><span class="op" id="5364954">+</span><span class="ident" id="5364955"><a href="/index/suffixarray/qsufsort.go.html#5364890">sum</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5364963">//&nbsp;iterate&nbsp;through&nbsp;bytes,&nbsp;placing&nbsp;index&nbsp;into&nbsp;the&nbsp;correct&nbsp;spot&nbsp;in&nbsp;sa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365032">sa</span>&nbsp;<span class="op" id="5365035">:=</span>&nbsp;<span class="builtinfunc" id="5365038">make</span><span class="op" id="5365042">(</span><span class="op" id="5365043">[</span><span class="op" id="5365044">]</span><span class="builtintype" id="5365045">int</span><span class="op" id="5365048">,</span>&nbsp;<span class="builtinfunc" id="5365050">len</span><span class="op" id="5365053">(</span><span class="ident" id="5365054"><a href="/index/suffixarray/qsufsort.go.html#5364713">data</a></span><span class="op" id="5365058">)</span><span class="op" id="5365059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365062">for</span>&nbsp;<span class="ident" id="5365066">i</span><span class="op" id="5365067">,</span>&nbsp;<span class="ident" id="5365069">b</span>&nbsp;<span class="op" id="5365071">:=</span>&nbsp;<span class="keyword" id="5365074">range</span>&nbsp;<span class="ident" id="5365080"><a href="/index/suffixarray/qsufsort.go.html#5364713">data</a></span>&nbsp;<span class="op" id="5365085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365089"><a href="/index/suffixarray/qsufsort.go.html#5365032">sa</a></span><span class="op" id="5365091">[</span><span class="ident" id="5365092"><a href="/index/suffixarray/qsufsort.go.html#5364761">count</a></span><span class="op" id="5365097">[</span><span class="ident" id="5365098"><a href="/index/suffixarray/qsufsort.go.html#5365069">b</a></span><span class="op" id="5365099">]</span><span class="op" id="5365100">]</span>&nbsp;<span class="op" id="5365102">=</span>&nbsp;<span class="ident" id="5365104"><a href="/index/suffixarray/qsufsort.go.html#5365066">i</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365108"><a href="/index/suffixarray/qsufsort.go.html#5364761">count</a></span><span class="op" id="5365113">[</span><span class="ident" id="5365114"><a href="/index/suffixarray/qsufsort.go.html#5365069">b</a></span><span class="op" id="5365115">]</span><span class="op" id="5365116">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365123">return</span>&nbsp;<span class="ident" id="5365130"><a href="/index/suffixarray/qsufsort.go.html#5365032">sa</a></span><br>
<span class="lineno"></span><span class="op" id="5365133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="5365136">func</span>&nbsp;<span class="ident" id="5365141">initGroups</span><span class="op" id="5365151">(</span><span class="ident" id="5365152">sa</span>&nbsp;<span class="op" id="5365155">[</span><span class="op" id="5365156">]</span><span class="builtintype" id="5365157">int</span><span class="op" id="5365160">,</span>&nbsp;<span class="ident" id="5365162">data</span>&nbsp;<span class="op" id="5365167">[</span><span class="op" id="5365168">]</span><span class="builtintype" id="5365169">byte</span><span class="op" id="5365173">)</span>&nbsp;<span class="op" id="5365175">[</span><span class="op" id="5365176">]</span><span class="builtintype" id="5365177">int</span>&nbsp;<span class="op" id="5365181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5365184">//&nbsp;label&nbsp;contiguous&nbsp;same-letter&nbsp;groups&nbsp;with&nbsp;the&nbsp;same&nbsp;group&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365251">inv</span>&nbsp;<span class="op" id="5365255">:=</span>&nbsp;<span class="builtinfunc" id="5365258">make</span><span class="op" id="5365262">(</span><span class="op" id="5365263">[</span><span class="op" id="5365264">]</span><span class="builtintype" id="5365265">int</span><span class="op" id="5365268">,</span>&nbsp;<span class="builtinfunc" id="5365270">len</span><span class="op" id="5365273">(</span><span class="ident" id="5365274"><a href="/index/suffixarray/qsufsort.go.html#5365162">data</a></span><span class="op" id="5365278">)</span><span class="op" id="5365279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365282">prevGroup</span>&nbsp;<span class="op" id="5365292">:=</span>&nbsp;<span class="builtinfunc" id="5365295">len</span><span class="op" id="5365298">(</span><span class="ident" id="5365299"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365301">)</span>&nbsp;<span class="op" id="5365303">-</span>&nbsp;<span class="num" id="5365305">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365308">groupByte</span>&nbsp;<span class="op" id="5365318">:=</span>&nbsp;<span class="ident" id="5365321"><a href="/index/suffixarray/qsufsort.go.html#5365162">data</a></span><span class="op" id="5365325">[</span><span class="ident" id="5365326"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365328">[</span><span class="ident" id="5365329"><a href="/index/suffixarray/qsufsort.go.html#5365282">prevGroup</a></span><span class="op" id="5365338">]</span><span class="op" id="5365339">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365342">for</span>&nbsp;<span class="ident" id="5365346">i</span>&nbsp;<span class="op" id="5365348">:=</span>&nbsp;<span class="builtinfunc" id="5365351">len</span><span class="op" id="5365354">(</span><span class="ident" id="5365355"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365357">)</span>&nbsp;<span class="op" id="5365359">-</span>&nbsp;<span class="num" id="5365361">1</span><span class="op" id="5365362">;</span>&nbsp;<span class="ident" id="5365364"><a href="/index/suffixarray/qsufsort.go.html#5365346">i</a></span>&nbsp;<span class="op" id="5365366">&gt;=</span>&nbsp;<span class="num" id="5365369">0</span><span class="op" id="5365370">;</span>&nbsp;<span class="ident" id="5365372"><a href="/index/suffixarray/qsufsort.go.html#5365346">i</a></span><span class="op" id="5365373">--</span>&nbsp;<span class="op" id="5365376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365380">if</span>&nbsp;<span class="ident" id="5365383">b</span>&nbsp;<span class="op" id="5365385">:=</span>&nbsp;<span class="ident" id="5365388"><a href="/index/suffixarray/qsufsort.go.html#5365162">data</a></span><span class="op" id="5365392">[</span><span class="ident" id="5365393"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365395">[</span><span class="ident" id="5365396"><a href="/index/suffixarray/qsufsort.go.html#5365346">i</a></span><span class="op" id="5365397">]</span><span class="op" id="5365398">]</span><span class="op" id="5365399">;</span>&nbsp;<span class="ident" id="5365401"><a href="/index/suffixarray/qsufsort.go.html#5365383">b</a></span>&nbsp;<span class="op" id="5365403">&lt;</span>&nbsp;<span class="ident" id="5365405"><a href="/index/suffixarray/qsufsort.go.html#5365308">groupByte</a></span>&nbsp;<span class="op" id="5365415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365420">if</span>&nbsp;<span class="ident" id="5365423"><a href="/index/suffixarray/qsufsort.go.html#5365282">prevGroup</a></span>&nbsp;<span class="op" id="5365433">==</span>&nbsp;<span class="ident" id="5365436"><a href="/index/suffixarray/qsufsort.go.html#5365346">i</a></span><span class="op" id="5365437">+</span><span class="num" id="5365438">1</span>&nbsp;<span class="op" id="5365440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365446"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365448">[</span><span class="ident" id="5365449"><a href="/index/suffixarray/qsufsort.go.html#5365346">i</a></span><span class="op" id="5365450">+</span><span class="num" id="5365451">1</span><span class="op" id="5365452">]</span>&nbsp;<span class="op" id="5365454">=</span>&nbsp;<span class="op" id="5365456">-</span><span class="num" id="5365457">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365462">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365467"><a href="/index/suffixarray/qsufsort.go.html#5365308">groupByte</a></span>&nbsp;<span class="op" id="5365477">=</span>&nbsp;<span class="ident" id="5365479"><a href="/index/suffixarray/qsufsort.go.html#5365383">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365484"><a href="/index/suffixarray/qsufsort.go.html#5365282">prevGroup</a></span>&nbsp;<span class="op" id="5365494">=</span>&nbsp;<span class="ident" id="5365496"><a href="/index/suffixarray/qsufsort.go.html#5365346">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365504"><a href="/index/suffixarray/qsufsort.go.html#5365251">inv</a></span><span class="op" id="5365507">[</span><span class="ident" id="5365508"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365510">[</span><span class="ident" id="5365511"><a href="/index/suffixarray/qsufsort.go.html#5365346">i</a></span><span class="op" id="5365512">]</span><span class="op" id="5365513">]</span>&nbsp;<span class="op" id="5365515">=</span>&nbsp;<span class="ident" id="5365517"><a href="/index/suffixarray/qsufsort.go.html#5365282">prevGroup</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365529">if</span>&nbsp;<span class="ident" id="5365532"><a href="/index/suffixarray/qsufsort.go.html#5365282">prevGroup</a></span>&nbsp;<span class="op" id="5365542">==</span>&nbsp;<span class="num" id="5365545">0</span>&nbsp;<span class="op" id="5365547">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365552"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365554">[</span><span class="num" id="5365555">0</span><span class="op" id="5365556">]</span>&nbsp;<span class="op" id="5365558">=</span>&nbsp;<span class="op" id="5365560">-</span><span class="num" id="5365561">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5365571">//&nbsp;Separate&nbsp;out&nbsp;the&nbsp;final&nbsp;suffix&nbsp;to&nbsp;the&nbsp;start&nbsp;of&nbsp;its&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5365632">//&nbsp;This&nbsp;is&nbsp;necessary&nbsp;to&nbsp;ensure&nbsp;the&nbsp;suffix&nbsp;&#34;a&#34;&nbsp;is&nbsp;before&nbsp;&#34;aba&#34;</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5365695">//&nbsp;when&nbsp;using&nbsp;a&nbsp;potentially&nbsp;unstable&nbsp;sort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365739">lastByte</span>&nbsp;<span class="op" id="5365748">:=</span>&nbsp;<span class="ident" id="5365751"><a href="/index/suffixarray/qsufsort.go.html#5365162">data</a></span><span class="op" id="5365755">[</span><span class="builtinfunc" id="5365756">len</span><span class="op" id="5365759">(</span><span class="ident" id="5365760"><a href="/index/suffixarray/qsufsort.go.html#5365162">data</a></span><span class="op" id="5365764">)</span><span class="op" id="5365765">-</span><span class="num" id="5365766">1</span><span class="op" id="5365767">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365770">s</span>&nbsp;<span class="op" id="5365772">:=</span>&nbsp;<span class="op" id="5365775">-</span><span class="num" id="5365776">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365779">for</span>&nbsp;<span class="ident" id="5365783">i</span>&nbsp;<span class="op" id="5365785">:=</span>&nbsp;<span class="keyword" id="5365788">range</span>&nbsp;<span class="ident" id="5365794"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span>&nbsp;<span class="op" id="5365797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365801">if</span>&nbsp;<span class="ident" id="5365804"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365806">[</span><span class="ident" id="5365807"><a href="/index/suffixarray/qsufsort.go.html#5365783">i</a></span><span class="op" id="5365808">]</span>&nbsp;<span class="op" id="5365810">&gt;=</span>&nbsp;<span class="num" id="5365813">0</span>&nbsp;<span class="op" id="5365815">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365820">if</span>&nbsp;<span class="ident" id="5365823"><a href="/index/suffixarray/qsufsort.go.html#5365162">data</a></span><span class="op" id="5365827">[</span><span class="ident" id="5365828"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365830">[</span><span class="ident" id="5365831"><a href="/index/suffixarray/qsufsort.go.html#5365783">i</a></span><span class="op" id="5365832">]</span><span class="op" id="5365833">]</span>&nbsp;<span class="op" id="5365835">==</span>&nbsp;<span class="ident" id="5365838"><a href="/index/suffixarray/qsufsort.go.html#5365739">lastByte</a></span>&nbsp;<span class="op" id="5365847">&amp;&amp;</span>&nbsp;<span class="ident" id="5365850"><a href="/index/suffixarray/qsufsort.go.html#5365770">s</a></span>&nbsp;<span class="op" id="5365852">==</span>&nbsp;<span class="op" id="5365855">-</span><span class="num" id="5365856">1</span>&nbsp;<span class="op" id="5365858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365864"><a href="/index/suffixarray/qsufsort.go.html#5365770">s</a></span>&nbsp;<span class="op" id="5365866">=</span>&nbsp;<span class="ident" id="5365868"><a href="/index/suffixarray/qsufsort.go.html#5365783">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365878">if</span>&nbsp;<span class="ident" id="5365881"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365883">[</span><span class="ident" id="5365884"><a href="/index/suffixarray/qsufsort.go.html#5365783">i</a></span><span class="op" id="5365885">]</span>&nbsp;<span class="op" id="5365887">==</span>&nbsp;<span class="builtinfunc" id="5365890">len</span><span class="op" id="5365893">(</span><span class="ident" id="5365894"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365896">)</span><span class="op" id="5365897">-</span><span class="num" id="5365898">1</span>&nbsp;<span class="op" id="5365900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365906"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365908">[</span><span class="ident" id="5365909"><a href="/index/suffixarray/qsufsort.go.html#5365783">i</a></span><span class="op" id="5365910">]</span><span class="op" id="5365911">,</span>&nbsp;<span class="ident" id="5365913"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365915">[</span><span class="ident" id="5365916"><a href="/index/suffixarray/qsufsort.go.html#5365770">s</a></span><span class="op" id="5365917">]</span>&nbsp;<span class="op" id="5365919">=</span>&nbsp;<span class="ident" id="5365921"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365923">[</span><span class="ident" id="5365924"><a href="/index/suffixarray/qsufsort.go.html#5365770">s</a></span><span class="op" id="5365925">]</span><span class="op" id="5365926">,</span>&nbsp;<span class="ident" id="5365928"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365930">[</span><span class="ident" id="5365931"><a href="/index/suffixarray/qsufsort.go.html#5365783">i</a></span><span class="op" id="5365932">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365938"><a href="/index/suffixarray/qsufsort.go.html#5365251">inv</a></span><span class="op" id="5365941">[</span><span class="ident" id="5365942"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365944">[</span><span class="ident" id="5365945"><a href="/index/suffixarray/qsufsort.go.html#5365770">s</a></span><span class="op" id="5365946">]</span><span class="op" id="5365947">]</span>&nbsp;<span class="op" id="5365949">=</span>&nbsp;<span class="ident" id="5365951"><a href="/index/suffixarray/qsufsort.go.html#5365770">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365957"><a href="/index/suffixarray/qsufsort.go.html#5365152">sa</a></span><span class="op" id="5365959">[</span><span class="ident" id="5365960"><a href="/index/suffixarray/qsufsort.go.html#5365770">s</a></span><span class="op" id="5365961">]</span>&nbsp;<span class="op" id="5365963">=</span>&nbsp;<span class="op" id="5365965">-</span><span class="num" id="5365966">1</span>&nbsp;<span class="comment" id="5365968">//&nbsp;mark&nbsp;it&nbsp;as&nbsp;an&nbsp;isolated&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366011">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366024">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366030">return</span>&nbsp;<span class="ident" id="5366037"><a href="/index/suffixarray/qsufsort.go.html#5365251">inv</a></span><br>
<span class="lineno"></span><span class="op" id="5366041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5366044">type</span>&nbsp;<span class="ident" id="5366049">suffixSortable</span>&nbsp;<span class="keyword" id="5366064">struct</span>&nbsp;<span class="op" id="5366071">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366074">sa</span>&nbsp;&nbsp;<span class="op" id="5366078">[</span><span class="op" id="5366079">]</span><span class="builtintype" id="5366080">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366085">inv</span>&nbsp;<span class="op" id="5366089">[</span><span class="op" id="5366090">]</span><span class="builtintype" id="5366091">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366096">h</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5366100">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366105">buf</span>&nbsp;<span class="op" id="5366109">[</span><span class="op" id="5366110">]</span><span class="builtintype" id="5366111">int</span>&nbsp;<span class="comment" id="5366115">//&nbsp;common&nbsp;scratch&nbsp;space</span><br>
<span class="lineno"></span><span class="op" id="5366139">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="5366142">func</span>&nbsp;<span class="op" id="5366147">(</span><span class="ident" id="5366148">x</span>&nbsp;<span class="op" id="5366150">*</span><span class="ident" id="5366151"><a href="/index/suffixarray/qsufsort.go.html#5366049">suffixSortable</a></span><span class="op" id="5366165">)</span>&nbsp;<span class="ident" id="5366167">Len</span><span class="op" id="5366170">(</span><span class="op" id="5366171">)</span>&nbsp;<span class="builtintype" id="5366173">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5366187">{</span>&nbsp;<span class="keyword" id="5366189">return</span>&nbsp;<span class="builtinfunc" id="5366196">len</span><span class="op" id="5366199">(</span><span class="ident" id="5366200"><a href="/index/suffixarray/qsufsort.go.html#5366148">x</a></span><span class="op" id="5366201">.</span><span class="ident" id="5366202">sa</span><span class="op" id="5366204">)</span>&nbsp;<span class="op" id="5366206">}</span><br>
<span class="lineno"></span><span class="keyword" id="5366208">func</span>&nbsp;<span class="op" id="5366213">(</span><span class="ident" id="5366214">x</span>&nbsp;<span class="op" id="5366216">*</span><span class="ident" id="5366217"><a href="/index/suffixarray/qsufsort.go.html#5366049">suffixSortable</a></span><span class="op" id="5366231">)</span>&nbsp;<span class="ident" id="5366233">Less</span><span class="op" id="5366237">(</span><span class="ident" id="5366238">i</span><span class="op" id="5366239">,</span>&nbsp;<span class="ident" id="5366241">j</span>&nbsp;<span class="builtintype" id="5366243">int</span><span class="op" id="5366246">)</span>&nbsp;<span class="builtintype" id="5366248">bool</span>&nbsp;<span class="op" id="5366253">{</span>&nbsp;<span class="keyword" id="5366255">return</span>&nbsp;<span class="ident" id="5366262"><a href="/index/suffixarray/qsufsort.go.html#5366214">x</a></span><span class="op" id="5366263">.</span><span class="ident" id="5366264">inv</span><span class="op" id="5366267">[</span><span class="ident" id="5366268"><a href="/index/suffixarray/qsufsort.go.html#5366214">x</a></span><span class="op" id="5366269">.</span><span class="ident" id="5366270">sa</span><span class="op" id="5366272">[</span><span class="ident" id="5366273"><a href="/index/suffixarray/qsufsort.go.html#5366238">i</a></span><span class="op" id="5366274">]</span><span class="op" id="5366275">+</span><span class="ident" id="5366276"><a href="/index/suffixarray/qsufsort.go.html#5366214">x</a></span><span class="op" id="5366277">.</span><span class="ident" id="5366278">h</span><span class="op" id="5366279">]</span>&nbsp;<span class="op" id="5366281">&lt;</span>&nbsp;<span class="ident" id="5366283"><a href="/index/suffixarray/qsufsort.go.html#5366214">x</a></span><span class="op" id="5366284">.</span><span class="ident" id="5366285">inv</span><span class="op" id="5366288">[</span><span class="ident" id="5366289"><a href="/index/suffixarray/qsufsort.go.html#5366214">x</a></span><span class="op" id="5366290">.</span><span class="ident" id="5366291">sa</span><span class="op" id="5366293">[</span><span class="ident" id="5366294"><a href="/index/suffixarray/qsufsort.go.html#5366241">j</a></span><span class="op" id="5366295">]</span><span class="op" id="5366296">+</span><span class="ident" id="5366297"><a href="/index/suffixarray/qsufsort.go.html#5366214">x</a></span><span class="op" id="5366298">.</span><span class="ident" id="5366299">h</span><span class="op" id="5366300">]</span>&nbsp;<span class="op" id="5366302">}</span><br>
<span class="lineno"></span><span class="keyword" id="5366304">func</span>&nbsp;<span class="op" id="5366309">(</span><span class="ident" id="5366310">x</span>&nbsp;<span class="op" id="5366312">*</span><span class="ident" id="5366313"><a href="/index/suffixarray/qsufsort.go.html#5366049">suffixSortable</a></span><span class="op" id="5366327">)</span>&nbsp;<span class="ident" id="5366329">Swap</span><span class="op" id="5366333">(</span><span class="ident" id="5366334">i</span><span class="op" id="5366335">,</span>&nbsp;<span class="ident" id="5366337">j</span>&nbsp;<span class="builtintype" id="5366339">int</span><span class="op" id="5366342">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5366349">{</span>&nbsp;<span class="ident" id="5366351"><a href="/index/suffixarray/qsufsort.go.html#5366310">x</a></span><span class="op" id="5366352">.</span><span class="ident" id="5366353">sa</span><span class="op" id="5366355">[</span><span class="ident" id="5366356"><a href="/index/suffixarray/qsufsort.go.html#5366334">i</a></span><span class="op" id="5366357">]</span><span class="op" id="5366358">,</span>&nbsp;<span class="ident" id="5366360"><a href="/index/suffixarray/qsufsort.go.html#5366310">x</a></span><span class="op" id="5366361">.</span><span class="ident" id="5366362">sa</span><span class="op" id="5366364">[</span><span class="ident" id="5366365"><a href="/index/suffixarray/qsufsort.go.html#5366337">j</a></span><span class="op" id="5366366">]</span>&nbsp;<span class="op" id="5366368">=</span>&nbsp;<span class="ident" id="5366370"><a href="/index/suffixarray/qsufsort.go.html#5366310">x</a></span><span class="op" id="5366371">.</span><span class="ident" id="5366372">sa</span><span class="op" id="5366374">[</span><span class="ident" id="5366375"><a href="/index/suffixarray/qsufsort.go.html#5366337">j</a></span><span class="op" id="5366376">]</span><span class="op" id="5366377">,</span>&nbsp;<span class="ident" id="5366379"><a href="/index/suffixarray/qsufsort.go.html#5366310">x</a></span><span class="op" id="5366380">.</span><span class="ident" id="5366381">sa</span><span class="op" id="5366383">[</span><span class="ident" id="5366384"><a href="/index/suffixarray/qsufsort.go.html#5366334">i</a></span><span class="op" id="5366385">]</span>&nbsp;<span class="op" id="5366387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="5366390">func</span>&nbsp;<span class="op" id="5366395">(</span><span class="ident" id="5366396">x</span>&nbsp;<span class="op" id="5366398">*</span><span class="ident" id="5366399"><a href="/index/suffixarray/qsufsort.go.html#5366049">suffixSortable</a></span><span class="op" id="5366413">)</span>&nbsp;<span class="ident" id="5366415">updateGroups</span><span class="op" id="5366427">(</span><span class="ident" id="5366428">offset</span>&nbsp;<span class="builtintype" id="5366435">int</span><span class="op" id="5366438">)</span>&nbsp;<span class="op" id="5366440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366443">bounds</span>&nbsp;<span class="op" id="5366450">:=</span>&nbsp;<span class="ident" id="5366453"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366454">.</span><span class="ident" id="5366455">buf</span><span class="op" id="5366458">[</span><span class="num" id="5366459">0</span><span class="op" id="5366460">:</span><span class="num" id="5366461">0</span><span class="op" id="5366462">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366465">group</span>&nbsp;<span class="op" id="5366471">:=</span>&nbsp;<span class="ident" id="5366474"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366475">.</span><span class="ident" id="5366476">inv</span><span class="op" id="5366479">[</span><span class="ident" id="5366480"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366481">.</span><span class="ident" id="5366482">sa</span><span class="op" id="5366484">[</span><span class="num" id="5366485">0</span><span class="op" id="5366486">]</span><span class="op" id="5366487">+</span><span class="ident" id="5366488"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366489">.</span><span class="ident" id="5366490">h</span><span class="op" id="5366491">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366494">for</span>&nbsp;<span class="ident" id="5366498">i</span>&nbsp;<span class="op" id="5366500">:=</span>&nbsp;<span class="num" id="5366503">1</span><span class="op" id="5366504">;</span>&nbsp;<span class="ident" id="5366506"><a href="/index/suffixarray/qsufsort.go.html#5366498">i</a></span>&nbsp;<span class="op" id="5366508">&lt;</span>&nbsp;<span class="builtinfunc" id="5366510">len</span><span class="op" id="5366513">(</span><span class="ident" id="5366514"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366515">.</span><span class="ident" id="5366516">sa</span><span class="op" id="5366518">)</span><span class="op" id="5366519">;</span>&nbsp;<span class="ident" id="5366521"><a href="/index/suffixarray/qsufsort.go.html#5366498">i</a></span><span class="op" id="5366522">++</span>&nbsp;<span class="op" id="5366525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366529">if</span>&nbsp;<span class="ident" id="5366532">g</span>&nbsp;<span class="op" id="5366534">:=</span>&nbsp;<span class="ident" id="5366537"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366538">.</span><span class="ident" id="5366539">inv</span><span class="op" id="5366542">[</span><span class="ident" id="5366543"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366544">.</span><span class="ident" id="5366545">sa</span><span class="op" id="5366547">[</span><span class="ident" id="5366548"><a href="/index/suffixarray/qsufsort.go.html#5366498">i</a></span><span class="op" id="5366549">]</span><span class="op" id="5366550">+</span><span class="ident" id="5366551"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366552">.</span><span class="ident" id="5366553">h</span><span class="op" id="5366554">]</span><span class="op" id="5366555">;</span>&nbsp;<span class="ident" id="5366557"><a href="/index/suffixarray/qsufsort.go.html#5366532">g</a></span>&nbsp;<span class="op" id="5366559">&gt;</span>&nbsp;<span class="ident" id="5366561"><a href="/index/suffixarray/qsufsort.go.html#5366465">group</a></span>&nbsp;<span class="op" id="5366567">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366572"><a href="/index/suffixarray/qsufsort.go.html#5366443">bounds</a></span>&nbsp;<span class="op" id="5366579">=</span>&nbsp;<span class="builtinfunc" id="5366581">append</span><span class="op" id="5366587">(</span><span class="ident" id="5366588"><a href="/index/suffixarray/qsufsort.go.html#5366443">bounds</a></span><span class="op" id="5366594">,</span>&nbsp;<span class="ident" id="5366596"><a href="/index/suffixarray/qsufsort.go.html#5366498">i</a></span><span class="op" id="5366597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366602"><a href="/index/suffixarray/qsufsort.go.html#5366465">group</a></span>&nbsp;<span class="op" id="5366608">=</span>&nbsp;<span class="ident" id="5366610"><a href="/index/suffixarray/qsufsort.go.html#5366532">g</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366620"><a href="/index/suffixarray/qsufsort.go.html#5366443">bounds</a></span>&nbsp;<span class="op" id="5366627">=</span>&nbsp;<span class="builtinfunc" id="5366629">append</span><span class="op" id="5366635">(</span><span class="ident" id="5366636"><a href="/index/suffixarray/qsufsort.go.html#5366443">bounds</a></span><span class="op" id="5366642">,</span>&nbsp;<span class="builtinfunc" id="5366644">len</span><span class="op" id="5366647">(</span><span class="ident" id="5366648"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366649">.</span><span class="ident" id="5366650">sa</span><span class="op" id="5366652">)</span><span class="op" id="5366653">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366656"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366657">.</span><span class="ident" id="5366658">buf</span>&nbsp;<span class="op" id="5366662">=</span>&nbsp;<span class="ident" id="5366664"><a href="/index/suffixarray/qsufsort.go.html#5366443">bounds</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5366673">//&nbsp;update&nbsp;the&nbsp;group&nbsp;numberings&nbsp;after&nbsp;all&nbsp;new&nbsp;groups&nbsp;are&nbsp;determined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366741">prev</span>&nbsp;<span class="op" id="5366746">:=</span>&nbsp;<span class="num" id="5366749">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366752">for</span>&nbsp;<span class="ident" id="5366756">_</span><span class="op" id="5366757">,</span>&nbsp;<span class="ident" id="5366759">b</span>&nbsp;<span class="op" id="5366761">:=</span>&nbsp;<span class="keyword" id="5366764">range</span>&nbsp;<span class="ident" id="5366770"><a href="/index/suffixarray/qsufsort.go.html#5366443">bounds</a></span>&nbsp;<span class="op" id="5366777">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366781">for</span>&nbsp;<span class="ident" id="5366785">i</span>&nbsp;<span class="op" id="5366787">:=</span>&nbsp;<span class="ident" id="5366790"><a href="/index/suffixarray/qsufsort.go.html#5366741">prev</a></span><span class="op" id="5366794">;</span>&nbsp;<span class="ident" id="5366796"><a href="/index/suffixarray/qsufsort.go.html#5366785">i</a></span>&nbsp;<span class="op" id="5366798">&lt;</span>&nbsp;<span class="ident" id="5366800"><a href="/index/suffixarray/qsufsort.go.html#5366759">b</a></span><span class="op" id="5366801">;</span>&nbsp;<span class="ident" id="5366803"><a href="/index/suffixarray/qsufsort.go.html#5366785">i</a></span><span class="op" id="5366804">++</span>&nbsp;<span class="op" id="5366807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366812"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366813">.</span><span class="ident" id="5366814">inv</span><span class="op" id="5366817">[</span><span class="ident" id="5366818"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366819">.</span><span class="ident" id="5366820">sa</span><span class="op" id="5366822">[</span><span class="ident" id="5366823"><a href="/index/suffixarray/qsufsort.go.html#5366785">i</a></span><span class="op" id="5366824">]</span><span class="op" id="5366825">]</span>&nbsp;<span class="op" id="5366827">=</span>&nbsp;<span class="ident" id="5366829"><a href="/index/suffixarray/qsufsort.go.html#5366428">offset</a></span>&nbsp;<span class="op" id="5366836">+</span>&nbsp;<span class="ident" id="5366838"><a href="/index/suffixarray/qsufsort.go.html#5366759">b</a></span>&nbsp;<span class="op" id="5366840">-</span>&nbsp;<span class="num" id="5366842">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366850">if</span>&nbsp;<span class="ident" id="5366853"><a href="/index/suffixarray/qsufsort.go.html#5366759">b</a></span><span class="op" id="5366854">-</span><span class="ident" id="5366855"><a href="/index/suffixarray/qsufsort.go.html#5366741">prev</a></span>&nbsp;<span class="op" id="5366860">==</span>&nbsp;<span class="num" id="5366863">1</span>&nbsp;<span class="op" id="5366865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366870"><a href="/index/suffixarray/qsufsort.go.html#5366396">x</a></span><span class="op" id="5366871">.</span><span class="ident" id="5366872">sa</span><span class="op" id="5366874">[</span><span class="ident" id="5366875"><a href="/index/suffixarray/qsufsort.go.html#5366741">prev</a></span><span class="op" id="5366879">]</span>&nbsp;<span class="op" id="5366881">=</span>&nbsp;<span class="op" id="5366883">-</span><span class="num" id="5366884">1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366892"><a href="/index/suffixarray/qsufsort.go.html#5366741">prev</a></span>&nbsp;<span class="op" id="5366897">=</span>&nbsp;<span class="ident" id="5366899"><a href="/index/suffixarray/qsufsort.go.html#5366759">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366902">}</span><br>
<span class="lineno"></span><span class="op" id="5366904">}</span>
</div>
</body>
</html>
