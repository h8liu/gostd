<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3950111">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3950166">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3950220">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3950271">package</span>&nbsp;<span class="ident" id="3950279">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3950285">import</span>&nbsp;<span class="op" id="3950292">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3950295">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3950304">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3950314">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3950321">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3950329">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3950340">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="3950350">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3950353">//&nbsp;FormatMediaType&nbsp;serializes&nbsp;mediatype&nbsp;t&nbsp;and&nbsp;the&nbsp;parameters</span><br>
<span class="lineno"></span><span class="comment" id="3950414">//&nbsp;param&nbsp;as&nbsp;a&nbsp;media&nbsp;type&nbsp;conforming&nbsp;to&nbsp;RFC&nbsp;2045&nbsp;and&nbsp;RFC&nbsp;2616.</span><br>
<span class="lineno"></span><span class="comment" id="3950476">//&nbsp;The&nbsp;type&nbsp;and&nbsp;parameter&nbsp;names&nbsp;are&nbsp;written&nbsp;in&nbsp;lower-case.</span><br>
<span class="lineno"></span><span class="comment" id="3950535">//&nbsp;When&nbsp;any&nbsp;of&nbsp;the&nbsp;arguments&nbsp;result&nbsp;in&nbsp;a&nbsp;standard&nbsp;violation&nbsp;then</span><br>
<span class="lineno">20</span><span class="comment" id="3950600">//&nbsp;FormatMediaType&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3950645">func</span>&nbsp;<span class="ident" id="3950650">FormatMediaType</span><span class="op" id="3950665">(</span><span class="ident" id="3950666">t</span>&nbsp;<span class="builtintype" id="3950668">string</span><span class="op" id="3950674">,</span>&nbsp;<span class="ident" id="3950676">param</span>&nbsp;<span class="keyword" id="3950682">map</span><span class="op" id="3950685">[</span><span class="builtintype" id="3950686">string</span><span class="op" id="3950692">]</span><span class="builtintype" id="3950693">string</span><span class="op" id="3950699">)</span>&nbsp;<span class="builtintype" id="3950701">string</span>&nbsp;<span class="op" id="3950708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950711">slash</span>&nbsp;<span class="op" id="3950717">:=</span>&nbsp;<span class="ident" id="3950720"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3950727">.</span><span class="ident" id="3950728">Index</span><span class="op" id="3950733">(</span><span class="ident" id="3950734"><a href="/mime/mediatype.go.html#3950666">t</a></span><span class="op" id="3950735">,</span>&nbsp;<span class="string" id="3950737">&#34;/&#34;</span><span class="op" id="3950740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950743">if</span>&nbsp;<span class="ident" id="3950746"><a href="/mime/mediatype.go.html#3950711">slash</a></span>&nbsp;<span class="op" id="3950752">==</span>&nbsp;<span class="op" id="3950755">-</span><span class="num" id="3950756">1</span>&nbsp;<span class="op" id="3950758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950762">return</span>&nbsp;<span class="string" id="3950769">&#34;&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950776">major</span><span class="op" id="3950781">,</span>&nbsp;<span class="ident" id="3950783">sub</span>&nbsp;<span class="op" id="3950787">:=</span>&nbsp;<span class="ident" id="3950790"><a href="/mime/mediatype.go.html#3950666">t</a></span><span class="op" id="3950791">[</span><span class="op" id="3950792">:</span><span class="ident" id="3950793"><a href="/mime/mediatype.go.html#3950711">slash</a></span><span class="op" id="3950798">]</span><span class="op" id="3950799">,</span>&nbsp;<span class="ident" id="3950801"><a href="/mime/mediatype.go.html#3950666">t</a></span><span class="op" id="3950802">[</span><span class="ident" id="3950803"><a href="/mime/mediatype.go.html#3950711">slash</a></span><span class="op" id="3950808">+</span><span class="num" id="3950809">1</span><span class="op" id="3950810">:</span><span class="op" id="3950811">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950814">if</span>&nbsp;<span class="op" id="3950817">!</span><span class="ident" id="3950818"><a href="/mime/grammar.go.html#3950002">isToken</a></span><span class="op" id="3950825">(</span><span class="ident" id="3950826"><a href="/mime/mediatype.go.html#3950776">major</a></span><span class="op" id="3950831">)</span>&nbsp;<span class="op" id="3950833">||</span>&nbsp;<span class="op" id="3950836">!</span><span class="ident" id="3950837"><a href="/mime/grammar.go.html#3950002">isToken</a></span><span class="op" id="3950844">(</span><span class="ident" id="3950845"><a href="/mime/mediatype.go.html#3950783">sub</a></span><span class="op" id="3950848">)</span>&nbsp;<span class="op" id="3950850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950854">return</span>&nbsp;<span class="string" id="3950861">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950865">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950868">var</span>&nbsp;<span class="ident" id="3950872">b</span>&nbsp;<span class="ident" id="3950874"><a href="/mime/mediatype.go.html#3950295">bytes</a></span><span class="op" id="3950879">.</span><span class="ident" id="3950880">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950888"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3950889">.</span><span class="ident" id="3950890">WriteString</span><span class="op" id="3950901">(</span><span class="ident" id="3950902"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3950909">.</span><span class="ident" id="3950910">ToLower</span><span class="op" id="3950917">(</span><span class="ident" id="3950918"><a href="/mime/mediatype.go.html#3950776">major</a></span><span class="op" id="3950923">)</span><span class="op" id="3950924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950927"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3950928">.</span><span class="ident" id="3950929">WriteByte</span><span class="op" id="3950938">(</span><span class="string" id="3950939">&#39;/&#39;</span><span class="op" id="3950942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950945"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3950946">.</span><span class="ident" id="3950947">WriteString</span><span class="op" id="3950958">(</span><span class="ident" id="3950959"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3950966">.</span><span class="ident" id="3950967">ToLower</span><span class="op" id="3950974">(</span><span class="ident" id="3950975"><a href="/mime/mediatype.go.html#3950783">sub</a></span><span class="op" id="3950978">)</span><span class="op" id="3950979">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950983">attrs</span>&nbsp;<span class="op" id="3950989">:=</span>&nbsp;<span class="builtinfunc" id="3950992">make</span><span class="op" id="3950996">(</span><span class="op" id="3950997">[</span><span class="op" id="3950998">]</span><span class="builtintype" id="3950999">string</span><span class="op" id="3951005">,</span>&nbsp;<span class="num" id="3951007">0</span><span class="op" id="3951008">,</span>&nbsp;<span class="builtinfunc" id="3951010">len</span><span class="op" id="3951013">(</span><span class="ident" id="3951014"><a href="/mime/mediatype.go.html#3950676">param</a></span><span class="op" id="3951019">)</span><span class="op" id="3951020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951023">for</span>&nbsp;<span class="ident" id="3951027">a</span>&nbsp;<span class="op" id="3951029">:=</span>&nbsp;<span class="keyword" id="3951032">range</span>&nbsp;<span class="ident" id="3951038"><a href="/mime/mediatype.go.html#3950676">param</a></span>&nbsp;<span class="op" id="3951044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951048"><a href="/mime/mediatype.go.html#3950983">attrs</a></span>&nbsp;<span class="op" id="3951054">=</span>&nbsp;<span class="builtinfunc" id="3951056">append</span><span class="op" id="3951062">(</span><span class="ident" id="3951063"><a href="/mime/mediatype.go.html#3950983">attrs</a></span><span class="op" id="3951068">,</span>&nbsp;<span class="ident" id="3951070"><a href="/mime/mediatype.go.html#3951027">a</a></span><span class="op" id="3951071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951077"><a href="/mime/mediatype.go.html#3950321">sort</a></span><span class="op" id="3951081">.</span><span class="ident" id="3951082">Strings</span><span class="op" id="3951089">(</span><span class="ident" id="3951090"><a href="/mime/mediatype.go.html#3950983">attrs</a></span><span class="op" id="3951095">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951099">for</span>&nbsp;<span class="ident" id="3951103">_</span><span class="op" id="3951104">,</span>&nbsp;<span class="ident" id="3951106">attribute</span>&nbsp;<span class="op" id="3951116">:=</span>&nbsp;<span class="keyword" id="3951119">range</span>&nbsp;<span class="ident" id="3951125"><a href="/mime/mediatype.go.html#3950983">attrs</a></span>&nbsp;<span class="op" id="3951131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951135">value</span>&nbsp;<span class="op" id="3951141">:=</span>&nbsp;<span class="ident" id="3951144"><a href="/mime/mediatype.go.html#3950676">param</a></span><span class="op" id="3951149">[</span><span class="ident" id="3951150"><a href="/mime/mediatype.go.html#3951106">attribute</a></span><span class="op" id="3951159">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951163"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951164">.</span><span class="ident" id="3951165">WriteByte</span><span class="op" id="3951174">(</span><span class="string" id="3951175">&#39;;&#39;</span><span class="op" id="3951178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951182"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951183">.</span><span class="ident" id="3951184">WriteByte</span><span class="op" id="3951193">(</span><span class="string" id="3951194">&#39;&nbsp;&#39;</span><span class="op" id="3951197">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951201">if</span>&nbsp;<span class="op" id="3951204">!</span><span class="ident" id="3951205"><a href="/mime/grammar.go.html#3950002">isToken</a></span><span class="op" id="3951212">(</span><span class="ident" id="3951213"><a href="/mime/mediatype.go.html#3951106">attribute</a></span><span class="op" id="3951222">)</span>&nbsp;<span class="op" id="3951224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951229">return</span>&nbsp;<span class="string" id="3951236">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951245"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951246">.</span><span class="ident" id="3951247">WriteString</span><span class="op" id="3951258">(</span><span class="ident" id="3951259"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3951266">.</span><span class="ident" id="3951267">ToLower</span><span class="op" id="3951274">(</span><span class="ident" id="3951275"><a href="/mime/mediatype.go.html#3951106">attribute</a></span><span class="op" id="3951284">)</span><span class="op" id="3951285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951289"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951290">.</span><span class="ident" id="3951291">WriteByte</span><span class="op" id="3951300">(</span><span class="string" id="3951301">&#39;=&#39;</span><span class="op" id="3951304">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951308">if</span>&nbsp;<span class="ident" id="3951311"><a href="/mime/grammar.go.html#3950002">isToken</a></span><span class="op" id="3951318">(</span><span class="ident" id="3951319"><a href="/mime/mediatype.go.html#3951135">value</a></span><span class="op" id="3951324">)</span>&nbsp;<span class="op" id="3951326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951331"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951332">.</span><span class="ident" id="3951333">WriteString</span><span class="op" id="3951344">(</span><span class="ident" id="3951345"><a href="/mime/mediatype.go.html#3951135">value</a></span><span class="op" id="3951350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951355">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951371"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951372">.</span><span class="ident" id="3951373">WriteByte</span><span class="op" id="3951382">(</span><span class="string" id="3951383">&#39;&#34;&#39;</span><span class="op" id="3951386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951390">offset</span>&nbsp;<span class="op" id="3951397">:=</span>&nbsp;<span class="num" id="3951400">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951404">for</span>&nbsp;<span class="ident" id="3951408">index</span><span class="op" id="3951413">,</span>&nbsp;<span class="ident" id="3951415">character</span>&nbsp;<span class="op" id="3951425">:=</span>&nbsp;<span class="keyword" id="3951428">range</span>&nbsp;<span class="ident" id="3951434"><a href="/mime/mediatype.go.html#3951135">value</a></span>&nbsp;<span class="op" id="3951440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951445">if</span>&nbsp;<span class="ident" id="3951448"><a href="/mime/mediatype.go.html#3951415">character</a></span>&nbsp;<span class="op" id="3951458">==</span>&nbsp;<span class="string" id="3951461">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3951465">||</span>&nbsp;<span class="ident" id="3951468"><a href="/mime/mediatype.go.html#3951415">character</a></span>&nbsp;<span class="op" id="3951478">==</span>&nbsp;<span class="string" id="3951481">&#39;\\&#39;</span>&nbsp;<span class="op" id="3951486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951492"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951493">.</span><span class="ident" id="3951494">WriteString</span><span class="op" id="3951505">(</span><span class="ident" id="3951506"><a href="/mime/mediatype.go.html#3951135">value</a></span><span class="op" id="3951511">[</span><span class="ident" id="3951512"><a href="/mime/mediatype.go.html#3951390">offset</a></span><span class="op" id="3951518">:</span><span class="ident" id="3951519"><a href="/mime/mediatype.go.html#3951408">index</a></span><span class="op" id="3951524">]</span><span class="op" id="3951525">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951531"><a href="/mime/mediatype.go.html#3951390">offset</a></span>&nbsp;<span class="op" id="3951538">=</span>&nbsp;<span class="ident" id="3951540"><a href="/mime/mediatype.go.html#3951408">index</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951550"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951551">.</span><span class="ident" id="3951552">WriteByte</span><span class="op" id="3951561">(</span><span class="string" id="3951562">&#39;\\&#39;</span><span class="op" id="3951566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951576">if</span>&nbsp;<span class="ident" id="3951579"><a href="/mime/mediatype.go.html#3951415">character</a></span><span class="op" id="3951588">&amp;</span><span class="num" id="3951589">0x80</span>&nbsp;<span class="op" id="3951594">!=</span>&nbsp;<span class="num" id="3951597">0</span>&nbsp;<span class="op" id="3951599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951605">return</span>&nbsp;<span class="string" id="3951612">&#34;&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951626"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951627">.</span><span class="ident" id="3951628">WriteString</span><span class="op" id="3951639">(</span><span class="ident" id="3951640"><a href="/mime/mediatype.go.html#3951135">value</a></span><span class="op" id="3951645">[</span><span class="ident" id="3951646"><a href="/mime/mediatype.go.html#3951390">offset</a></span><span class="op" id="3951652">:</span><span class="op" id="3951653">]</span><span class="op" id="3951654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951658"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951659">.</span><span class="ident" id="3951660">WriteByte</span><span class="op" id="3951669">(</span><span class="string" id="3951670">&#39;&#34;&#39;</span><span class="op" id="3951673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951676">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951679">return</span>&nbsp;<span class="ident" id="3951686"><a href="/mime/mediatype.go.html#3950872">b</a></span><span class="op" id="3951687">.</span><span class="ident" id="3951688">String</span><span class="op" id="3951694">(</span><span class="op" id="3951695">)</span><br>
<span class="lineno"></span><span class="op" id="3951697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3951700">func</span>&nbsp;<span class="ident" id="3951705">checkMediaTypeDisposition</span><span class="op" id="3951730">(</span><span class="ident" id="3951731">s</span>&nbsp;<span class="builtintype" id="3951733">string</span><span class="op" id="3951739">)</span>&nbsp;<span class="builtintype" id="3951741">error</span>&nbsp;<span class="op" id="3951747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951750">typ</span><span class="op" id="3951753">,</span>&nbsp;<span class="ident" id="3951755">rest</span>&nbsp;<span class="op" id="3951760">:=</span>&nbsp;<span class="ident" id="3951763"><a href="/mime/mediatype.go.html#3955626">consumeToken</a></span><span class="op" id="3951775">(</span><span class="ident" id="3951776"><a href="/mime/mediatype.go.html#3951731">s</a></span><span class="op" id="3951777">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951780">if</span>&nbsp;<span class="ident" id="3951783"><a href="/mime/mediatype.go.html#3951750">typ</a></span>&nbsp;<span class="op" id="3951787">==</span>&nbsp;<span class="string" id="3951790">&#34;&#34;</span>&nbsp;<span class="op" id="3951793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951797">return</span>&nbsp;<span class="ident" id="3951804"><a href="/mime/mediatype.go.html#3950304">errors</a></span><span class="op" id="3951810">.</span><span class="ident" id="3951811">New</span><span class="op" id="3951814">(</span><span class="string" id="3951815">&#34;mime:&nbsp;no&nbsp;media&nbsp;type&#34;</span><span class="op" id="3951836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951842">if</span>&nbsp;<span class="ident" id="3951845"><a href="/mime/mediatype.go.html#3951755">rest</a></span>&nbsp;<span class="op" id="3951850">==</span>&nbsp;<span class="string" id="3951853">&#34;&#34;</span>&nbsp;<span class="op" id="3951856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951860">return</span>&nbsp;<span class="ident" id="3951867">nil</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951875">if</span>&nbsp;<span class="op" id="3951878">!</span><span class="ident" id="3951879"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3951886">.</span><span class="ident" id="3951887">HasPrefix</span><span class="op" id="3951896">(</span><span class="ident" id="3951897"><a href="/mime/mediatype.go.html#3951755">rest</a></span><span class="op" id="3951901">,</span>&nbsp;<span class="string" id="3951903">&#34;/&#34;</span><span class="op" id="3951906">)</span>&nbsp;<span class="op" id="3951908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951912">return</span>&nbsp;<span class="ident" id="3951919"><a href="/mime/mediatype.go.html#3950304">errors</a></span><span class="op" id="3951925">.</span><span class="ident" id="3951926">New</span><span class="op" id="3951929">(</span><span class="string" id="3951930">&#34;mime:&nbsp;expected&nbsp;slash&nbsp;after&nbsp;first&nbsp;token&#34;</span><span class="op" id="3951970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951976">subtype</span><span class="op" id="3951983">,</span>&nbsp;<span class="ident" id="3951985"><a href="/mime/mediatype.go.html#3951755">rest</a></span>&nbsp;<span class="op" id="3951990">:=</span>&nbsp;<span class="ident" id="3951993"><a href="/mime/mediatype.go.html#3955626">consumeToken</a></span><span class="op" id="3952005">(</span><span class="ident" id="3952006"><a href="/mime/mediatype.go.html#3951755">rest</a></span><span class="op" id="3952010">[</span><span class="num" id="3952011">1</span><span class="op" id="3952012">:</span><span class="op" id="3952013">]</span><span class="op" id="3952014">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952017">if</span>&nbsp;<span class="ident" id="3952020"><a href="/mime/mediatype.go.html#3951976">subtype</a></span>&nbsp;<span class="op" id="3952028">==</span>&nbsp;<span class="string" id="3952031">&#34;&#34;</span>&nbsp;<span class="op" id="3952034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952038">return</span>&nbsp;<span class="ident" id="3952045"><a href="/mime/mediatype.go.html#3950304">errors</a></span><span class="op" id="3952051">.</span><span class="ident" id="3952052">New</span><span class="op" id="3952055">(</span><span class="string" id="3952056">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="3952090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952096">if</span>&nbsp;<span class="ident" id="3952099"><a href="/mime/mediatype.go.html#3951755">rest</a></span>&nbsp;<span class="op" id="3952104">!=</span>&nbsp;<span class="string" id="3952107">&#34;&#34;</span>&nbsp;<span class="op" id="3952110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952114">return</span>&nbsp;<span class="ident" id="3952121"><a href="/mime/mediatype.go.html#3950304">errors</a></span><span class="op" id="3952127">.</span><span class="ident" id="3952128">New</span><span class="op" id="3952131">(</span><span class="string" id="3952132">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="3952178">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952184">return</span>&nbsp;<span class="ident" id="3952191">nil</span><br>
<span class="lineno"></span><span class="op" id="3952195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3952198">//&nbsp;ParseMediaType&nbsp;parses&nbsp;a&nbsp;media&nbsp;type&nbsp;value&nbsp;and&nbsp;any&nbsp;optional</span><br>
<span class="lineno">95</span><span class="comment" id="3952259">//&nbsp;parameters,&nbsp;per&nbsp;RFC&nbsp;1521.&nbsp;&nbsp;Media&nbsp;types&nbsp;are&nbsp;the&nbsp;values&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3952319">//&nbsp;Content-Type&nbsp;and&nbsp;Content-Disposition&nbsp;headers&nbsp;(RFC&nbsp;2183).</span><br>
<span class="lineno"></span><span class="comment" id="3952379">//&nbsp;On&nbsp;success,&nbsp;ParseMediaType&nbsp;returns&nbsp;the&nbsp;media&nbsp;type&nbsp;converted</span><br>
<span class="lineno"></span><span class="comment" id="3952442">//&nbsp;to&nbsp;lowercase&nbsp;and&nbsp;trimmed&nbsp;of&nbsp;white&nbsp;space&nbsp;and&nbsp;a&nbsp;non-nil&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="3952504">//&nbsp;The&nbsp;returned&nbsp;map,&nbsp;params,&nbsp;maps&nbsp;from&nbsp;the&nbsp;lowercase</span><br>
<span class="lineno">100</span><span class="comment" id="3952557">//&nbsp;attribute&nbsp;to&nbsp;the&nbsp;attribute&nbsp;value&nbsp;with&nbsp;its&nbsp;case&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="keyword" id="3952618">func</span>&nbsp;<span class="ident" id="3952623">ParseMediaType</span><span class="op" id="3952637">(</span><span class="ident" id="3952638">v</span>&nbsp;<span class="builtintype" id="3952640">string</span><span class="op" id="3952646">)</span>&nbsp;<span class="op" id="3952648">(</span><span class="ident" id="3952649">mediatype</span>&nbsp;<span class="builtintype" id="3952659">string</span><span class="op" id="3952665">,</span>&nbsp;<span class="ident" id="3952667">params</span>&nbsp;<span class="keyword" id="3952674">map</span><span class="op" id="3952677">[</span><span class="builtintype" id="3952678">string</span><span class="op" id="3952684">]</span><span class="builtintype" id="3952685">string</span><span class="op" id="3952691">,</span>&nbsp;<span class="ident" id="3952693">err</span>&nbsp;<span class="builtintype" id="3952697">error</span><span class="op" id="3952702">)</span>&nbsp;<span class="op" id="3952704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952707">i</span>&nbsp;<span class="op" id="3952709">:=</span>&nbsp;<span class="ident" id="3952712"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3952719">.</span><span class="ident" id="3952720">Index</span><span class="op" id="3952725">(</span><span class="ident" id="3952726"><a href="/mime/mediatype.go.html#3952638">v</a></span><span class="op" id="3952727">,</span>&nbsp;<span class="string" id="3952729">&#34;;&#34;</span><span class="op" id="3952732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952735">if</span>&nbsp;<span class="ident" id="3952738"><a href="/mime/mediatype.go.html#3952707">i</a></span>&nbsp;<span class="op" id="3952740">==</span>&nbsp;<span class="op" id="3952743">-</span><span class="num" id="3952744">1</span>&nbsp;<span class="op" id="3952746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952750"><a href="/mime/mediatype.go.html#3952707">i</a></span>&nbsp;<span class="op" id="3952752">=</span>&nbsp;<span class="builtinfunc" id="3952754">len</span><span class="op" id="3952757">(</span><span class="ident" id="3952758"><a href="/mime/mediatype.go.html#3952638">v</a></span><span class="op" id="3952759">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952765"><a href="/mime/mediatype.go.html#3952649">mediatype</a></span>&nbsp;<span class="op" id="3952775">=</span>&nbsp;<span class="ident" id="3952777"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3952784">.</span><span class="ident" id="3952785">TrimSpace</span><span class="op" id="3952794">(</span><span class="ident" id="3952795"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3952802">.</span><span class="ident" id="3952803">ToLower</span><span class="op" id="3952810">(</span><span class="ident" id="3952811"><a href="/mime/mediatype.go.html#3952638">v</a></span><span class="op" id="3952812">[</span><span class="num" id="3952813">0</span><span class="op" id="3952814">:</span><span class="ident" id="3952815"><a href="/mime/mediatype.go.html#3952707">i</a></span><span class="op" id="3952816">]</span><span class="op" id="3952817">)</span><span class="op" id="3952818">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952822"><a href="/mime/mediatype.go.html#3952693">err</a></span>&nbsp;<span class="op" id="3952826">=</span>&nbsp;<span class="ident" id="3952828"><a href="/mime/mediatype.go.html#3951705">checkMediaTypeDisposition</a></span><span class="op" id="3952853">(</span><span class="ident" id="3952854"><a href="/mime/mediatype.go.html#3952649">mediatype</a></span><span class="op" id="3952863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952866">if</span>&nbsp;<span class="ident" id="3952869"><a href="/mime/mediatype.go.html#3952693">err</a></span>&nbsp;<span class="op" id="3952873">!=</span>&nbsp;<span class="ident" id="3952876">nil</span>&nbsp;<span class="op" id="3952880">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952884">return</span>&nbsp;<span class="string" id="3952891">&#34;&#34;</span><span class="op" id="3952893">,</span>&nbsp;<span class="ident" id="3952895">nil</span><span class="op" id="3952898">,</span>&nbsp;<span class="ident" id="3952900"><a href="/mime/mediatype.go.html#3952693">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952909"><a href="/mime/mediatype.go.html#3952667">params</a></span>&nbsp;<span class="op" id="3952916">=</span>&nbsp;<span class="builtinfunc" id="3952918">make</span><span class="op" id="3952922">(</span><span class="keyword" id="3952923">map</span><span class="op" id="3952926">[</span><span class="builtintype" id="3952927">string</span><span class="op" id="3952933">]</span><span class="builtintype" id="3952934">string</span><span class="op" id="3952940">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952944">//&nbsp;Map&nbsp;of&nbsp;base&nbsp;parameter&nbsp;name&nbsp;-&gt;&nbsp;parameter&nbsp;name&nbsp;-&gt;&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953002">//&nbsp;for&nbsp;parameters&nbsp;containing&nbsp;a&nbsp;&#39;*&#39;&nbsp;character.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953049">//&nbsp;Lazily&nbsp;initialized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953073">var</span>&nbsp;<span class="ident" id="3953077">continuation</span>&nbsp;<span class="keyword" id="3953090">map</span><span class="op" id="3953093">[</span><span class="builtintype" id="3953094">string</span><span class="op" id="3953100">]</span><span class="keyword" id="3953101">map</span><span class="op" id="3953104">[</span><span class="builtintype" id="3953105">string</span><span class="op" id="3953111">]</span><span class="builtintype" id="3953112">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953121"><a href="/mime/mediatype.go.html#3952638">v</a></span>&nbsp;<span class="op" id="3953123">=</span>&nbsp;<span class="ident" id="3953125"><a href="/mime/mediatype.go.html#3952638">v</a></span><span class="op" id="3953126">[</span><span class="ident" id="3953127"><a href="/mime/mediatype.go.html#3952707">i</a></span><span class="op" id="3953128">:</span><span class="op" id="3953129">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953132">for</span>&nbsp;<span class="builtinfunc" id="3953136">len</span><span class="op" id="3953139">(</span><span class="ident" id="3953140"><a href="/mime/mediatype.go.html#3952638">v</a></span><span class="op" id="3953141">)</span>&nbsp;<span class="op" id="3953143">&gt;</span>&nbsp;<span class="num" id="3953145">0</span>&nbsp;<span class="op" id="3953147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953151"><a href="/mime/mediatype.go.html#3952638">v</a></span>&nbsp;<span class="op" id="3953153">=</span>&nbsp;<span class="ident" id="3953155"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3953162">.</span><span class="ident" id="3953163">TrimLeftFunc</span><span class="op" id="3953175">(</span><span class="ident" id="3953176"><a href="/mime/mediatype.go.html#3952638">v</a></span><span class="op" id="3953177">,</span>&nbsp;<span class="ident" id="3953179"><a href="/mime/mediatype.go.html#3950340">unicode</a></span><span class="op" id="3953186">.</span><span class="ident" id="3953187">IsSpace</span><span class="op" id="3953194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953198">if</span>&nbsp;<span class="builtinfunc" id="3953201">len</span><span class="op" id="3953204">(</span><span class="ident" id="3953205"><a href="/mime/mediatype.go.html#3952638">v</a></span><span class="op" id="3953206">)</span>&nbsp;<span class="op" id="3953208">==</span>&nbsp;<span class="num" id="3953211">0</span>&nbsp;<span class="op" id="3953213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953218">break</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953230">key</span><span class="op" id="3953233">,</span>&nbsp;<span class="ident" id="3953235">value</span><span class="op" id="3953240">,</span>&nbsp;<span class="ident" id="3953242">rest</span>&nbsp;<span class="op" id="3953247">:=</span>&nbsp;<span class="ident" id="3953250"><a href="/mime/mediatype.go.html#3956739">consumeMediaParam</a></span><span class="op" id="3953267">(</span><span class="ident" id="3953268"><a href="/mime/mediatype.go.html#3952638">v</a></span><span class="op" id="3953269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953273">if</span>&nbsp;<span class="ident" id="3953276"><a href="/mime/mediatype.go.html#3953230">key</a></span>&nbsp;<span class="op" id="3953280">==</span>&nbsp;<span class="string" id="3953283">&#34;&#34;</span>&nbsp;<span class="op" id="3953286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953291">if</span>&nbsp;<span class="ident" id="3953294"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3953301">.</span><span class="ident" id="3953302">TrimSpace</span><span class="op" id="3953311">(</span><span class="ident" id="3953312"><a href="/mime/mediatype.go.html#3953242">rest</a></span><span class="op" id="3953316">)</span>&nbsp;<span class="op" id="3953318">==</span>&nbsp;<span class="string" id="3953321">&#34;;&#34;</span>&nbsp;<span class="op" id="3953325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953331">//&nbsp;Ignore&nbsp;trailing&nbsp;semicolons.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953366">//&nbsp;Not&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953387">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953402">//&nbsp;Parse&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953421">return</span>&nbsp;<span class="string" id="3953428">&#34;&#34;</span><span class="op" id="3953430">,</span>&nbsp;<span class="ident" id="3953432">nil</span><span class="op" id="3953435">,</span>&nbsp;<span class="ident" id="3953437"><a href="/mime/mediatype.go.html#3950304">errors</a></span><span class="op" id="3953443">.</span><span class="ident" id="3953444">New</span><span class="op" id="3953447">(</span><span class="string" id="3953448">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="3953479">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953488">pmap</span>&nbsp;<span class="op" id="3953493">:=</span>&nbsp;<span class="ident" id="3953496"><a href="/mime/mediatype.go.html#3952667">params</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953505">if</span>&nbsp;<span class="ident" id="3953508">idx</span>&nbsp;<span class="op" id="3953512">:=</span>&nbsp;<span class="ident" id="3953515"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3953522">.</span><span class="ident" id="3953523">Index</span><span class="op" id="3953528">(</span><span class="ident" id="3953529"><a href="/mime/mediatype.go.html#3953230">key</a></span><span class="op" id="3953532">,</span>&nbsp;<span class="string" id="3953534">&#34;*&#34;</span><span class="op" id="3953537">)</span><span class="op" id="3953538">;</span>&nbsp;<span class="ident" id="3953540"><a href="/mime/mediatype.go.html#3953508">idx</a></span>&nbsp;<span class="op" id="3953544">!=</span>&nbsp;<span class="op" id="3953547">-</span><span class="num" id="3953548">1</span>&nbsp;<span class="op" id="3953550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953555">baseName</span>&nbsp;<span class="op" id="3953564">:=</span>&nbsp;<span class="ident" id="3953567"><a href="/mime/mediatype.go.html#3953230">key</a></span><span class="op" id="3953570">[</span><span class="op" id="3953571">:</span><span class="ident" id="3953572"><a href="/mime/mediatype.go.html#3953508">idx</a></span><span class="op" id="3953575">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953580">if</span>&nbsp;<span class="ident" id="3953583"><a href="/mime/mediatype.go.html#3953077">continuation</a></span>&nbsp;<span class="op" id="3953596">==</span>&nbsp;<span class="ident" id="3953599">nil</span>&nbsp;<span class="op" id="3953603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953609"><a href="/mime/mediatype.go.html#3953077">continuation</a></span>&nbsp;<span class="op" id="3953622">=</span>&nbsp;<span class="builtinfunc" id="3953624">make</span><span class="op" id="3953628">(</span><span class="keyword" id="3953629">map</span><span class="op" id="3953632">[</span><span class="builtintype" id="3953633">string</span><span class="op" id="3953639">]</span><span class="keyword" id="3953640">map</span><span class="op" id="3953643">[</span><span class="builtintype" id="3953644">string</span><span class="op" id="3953650">]</span><span class="builtintype" id="3953651">string</span><span class="op" id="3953657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953667">var</span>&nbsp;<span class="ident" id="3953671">ok</span>&nbsp;<span class="builtintype" id="3953674">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953682">if</span>&nbsp;<span class="ident" id="3953685"><a href="/mime/mediatype.go.html#3953488">pmap</a></span><span class="op" id="3953689">,</span>&nbsp;<span class="ident" id="3953691"><a href="/mime/mediatype.go.html#3953671">ok</a></span>&nbsp;<span class="op" id="3953694">=</span>&nbsp;<span class="ident" id="3953696"><a href="/mime/mediatype.go.html#3953077">continuation</a></span><span class="op" id="3953708">[</span><span class="ident" id="3953709"><a href="/mime/mediatype.go.html#3953555">baseName</a></span><span class="op" id="3953717">]</span><span class="op" id="3953718">;</span>&nbsp;<span class="op" id="3953720">!</span><span class="ident" id="3953721"><a href="/mime/mediatype.go.html#3953671">ok</a></span>&nbsp;<span class="op" id="3953724">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953730"><a href="/mime/mediatype.go.html#3953077">continuation</a></span><span class="op" id="3953742">[</span><span class="ident" id="3953743"><a href="/mime/mediatype.go.html#3953555">baseName</a></span><span class="op" id="3953751">]</span>&nbsp;<span class="op" id="3953753">=</span>&nbsp;<span class="builtinfunc" id="3953755">make</span><span class="op" id="3953759">(</span><span class="keyword" id="3953760">map</span><span class="op" id="3953763">[</span><span class="builtintype" id="3953764">string</span><span class="op" id="3953770">]</span><span class="builtintype" id="3953771">string</span><span class="op" id="3953777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953783"><a href="/mime/mediatype.go.html#3953488">pmap</a></span>&nbsp;<span class="op" id="3953788">=</span>&nbsp;<span class="ident" id="3953790"><a href="/mime/mediatype.go.html#3953077">continuation</a></span><span class="op" id="3953802">[</span><span class="ident" id="3953803"><a href="/mime/mediatype.go.html#3953555">baseName</a></span><span class="op" id="3953811">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953824">if</span>&nbsp;<span class="ident" id="3953827">_</span><span class="op" id="3953828">,</span>&nbsp;<span class="ident" id="3953830">exists</span>&nbsp;<span class="op" id="3953837">:=</span>&nbsp;<span class="ident" id="3953840"><a href="/mime/mediatype.go.html#3953488">pmap</a></span><span class="op" id="3953844">[</span><span class="ident" id="3953845"><a href="/mime/mediatype.go.html#3953230">key</a></span><span class="op" id="3953848">]</span><span class="op" id="3953849">;</span>&nbsp;<span class="ident" id="3953851"><a href="/mime/mediatype.go.html#3953830">exists</a></span>&nbsp;<span class="op" id="3953858">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953863">//&nbsp;Duplicate&nbsp;parameter&nbsp;name&nbsp;is&nbsp;bogus.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953904">return</span>&nbsp;<span class="string" id="3953911">&#34;&#34;</span><span class="op" id="3953913">,</span>&nbsp;<span class="ident" id="3953915">nil</span><span class="op" id="3953918">,</span>&nbsp;<span class="ident" id="3953920"><a href="/mime/mediatype.go.html#3950304">errors</a></span><span class="op" id="3953926">.</span><span class="ident" id="3953927">New</span><span class="op" id="3953930">(</span><span class="string" id="3953931">&#34;mime:&nbsp;duplicate&nbsp;parameter&nbsp;name&#34;</span><span class="op" id="3953963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953971"><a href="/mime/mediatype.go.html#3953488">pmap</a></span><span class="op" id="3953975">[</span><span class="ident" id="3953976"><a href="/mime/mediatype.go.html#3953230">key</a></span><span class="op" id="3953979">]</span>&nbsp;<span class="op" id="3953981">=</span>&nbsp;<span class="ident" id="3953983"><a href="/mime/mediatype.go.html#3953235">value</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953991"><a href="/mime/mediatype.go.html#3952638">v</a></span>&nbsp;<span class="op" id="3953993">=</span>&nbsp;<span class="ident" id="3953995"><a href="/mime/mediatype.go.html#3953242">rest</a></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3954005">//&nbsp;Stitch&nbsp;together&nbsp;any&nbsp;continuations&nbsp;or&nbsp;things&nbsp;with&nbsp;stars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3954064">//&nbsp;(i.e.&nbsp;RFC&nbsp;2231&nbsp;things&nbsp;with&nbsp;stars:&nbsp;&#34;foo*0&#34;&nbsp;or&nbsp;&#34;foo*&#34;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954121">var</span>&nbsp;<span class="ident" id="3954125">buf</span>&nbsp;<span class="ident" id="3954129"><a href="/mime/mediatype.go.html#3950295">bytes</a></span><span class="op" id="3954134">.</span><span class="ident" id="3954135">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954143">for</span>&nbsp;<span class="ident" id="3954147">key</span><span class="op" id="3954150">,</span>&nbsp;<span class="ident" id="3954152">pieceMap</span>&nbsp;<span class="op" id="3954161">:=</span>&nbsp;<span class="keyword" id="3954164">range</span>&nbsp;<span class="ident" id="3954170"><a href="/mime/mediatype.go.html#3953077">continuation</a></span>&nbsp;<span class="op" id="3954183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954187">singlePartKey</span>&nbsp;<span class="op" id="3954201">:=</span>&nbsp;<span class="ident" id="3954204"><a href="/mime/mediatype.go.html#3954147">key</a></span>&nbsp;<span class="op" id="3954208">+</span>&nbsp;<span class="string" id="3954210">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954216">if</span>&nbsp;<span class="ident" id="3954219">v</span><span class="op" id="3954220">,</span>&nbsp;<span class="ident" id="3954222">ok</span>&nbsp;<span class="op" id="3954225">:=</span>&nbsp;<span class="ident" id="3954228"><a href="/mime/mediatype.go.html#3954152">pieceMap</a></span><span class="op" id="3954236">[</span><span class="ident" id="3954237"><a href="/mime/mediatype.go.html#3954187">singlePartKey</a></span><span class="op" id="3954250">]</span><span class="op" id="3954251">;</span>&nbsp;<span class="ident" id="3954253"><a href="/mime/mediatype.go.html#3954222">ok</a></span>&nbsp;<span class="op" id="3954256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954261">decv</span>&nbsp;<span class="op" id="3954266">:=</span>&nbsp;<span class="ident" id="3954269"><a href="/mime/mediatype.go.html#3954856">decode2231Enc</a></span><span class="op" id="3954282">(</span><span class="ident" id="3954283"><a href="/mime/mediatype.go.html#3954219">v</a></span><span class="op" id="3954284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954289"><a href="/mime/mediatype.go.html#3952667">params</a></span><span class="op" id="3954295">[</span><span class="ident" id="3954296"><a href="/mime/mediatype.go.html#3954147">key</a></span><span class="op" id="3954299">]</span>&nbsp;<span class="op" id="3954301">=</span>&nbsp;<span class="ident" id="3954303"><a href="/mime/mediatype.go.html#3954261">decv</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954311">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954327"><a href="/mime/mediatype.go.html#3954125">buf</a></span><span class="op" id="3954330">.</span><span class="ident" id="3954331">Reset</span><span class="op" id="3954336">(</span><span class="op" id="3954337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954341">valid</span>&nbsp;<span class="op" id="3954347">:=</span>&nbsp;<span class="ident" id="3954350">false</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954358">for</span>&nbsp;<span class="ident" id="3954362">n</span>&nbsp;<span class="op" id="3954364">:=</span>&nbsp;<span class="num" id="3954367">0</span><span class="op" id="3954368">;</span>&nbsp;<span class="op" id="3954370">;</span>&nbsp;<span class="ident" id="3954372"><a href="/mime/mediatype.go.html#3954362">n</a></span><span class="op" id="3954373">++</span>&nbsp;<span class="op" id="3954376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954381">simplePart</span>&nbsp;<span class="op" id="3954392">:=</span>&nbsp;<span class="ident" id="3954395"><a href="/mime/mediatype.go.html#3950314">fmt</a></span><span class="op" id="3954398">.</span><span class="ident" id="3954399">Sprintf</span><span class="op" id="3954406">(</span><span class="string" id="3954407">&#34;%s*%d&#34;</span><span class="op" id="3954414">,</span>&nbsp;<span class="ident" id="3954416"><a href="/mime/mediatype.go.html#3954147">key</a></span><span class="op" id="3954419">,</span>&nbsp;<span class="ident" id="3954421"><a href="/mime/mediatype.go.html#3954362">n</a></span><span class="op" id="3954422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954427">if</span>&nbsp;<span class="ident" id="3954430">v</span><span class="op" id="3954431">,</span>&nbsp;<span class="ident" id="3954433">ok</span>&nbsp;<span class="op" id="3954436">:=</span>&nbsp;<span class="ident" id="3954439"><a href="/mime/mediatype.go.html#3954152">pieceMap</a></span><span class="op" id="3954447">[</span><span class="ident" id="3954448"><a href="/mime/mediatype.go.html#3954381">simplePart</a></span><span class="op" id="3954458">]</span><span class="op" id="3954459">;</span>&nbsp;<span class="ident" id="3954461"><a href="/mime/mediatype.go.html#3954433">ok</a></span>&nbsp;<span class="op" id="3954464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954470"><a href="/mime/mediatype.go.html#3954341">valid</a></span>&nbsp;<span class="op" id="3954476">=</span>&nbsp;<span class="ident" id="3954478">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954487"><a href="/mime/mediatype.go.html#3954125">buf</a></span><span class="op" id="3954490">.</span><span class="ident" id="3954491">WriteString</span><span class="op" id="3954502">(</span><span class="ident" id="3954503"><a href="/mime/mediatype.go.html#3954430">v</a></span><span class="op" id="3954504">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954510">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954527">encodedPart</span>&nbsp;<span class="op" id="3954539">:=</span>&nbsp;<span class="ident" id="3954542"><a href="/mime/mediatype.go.html#3954381">simplePart</a></span>&nbsp;<span class="op" id="3954553">+</span>&nbsp;<span class="string" id="3954555">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954562">if</span>&nbsp;<span class="ident" id="3954565">v</span><span class="op" id="3954566">,</span>&nbsp;<span class="ident" id="3954568">ok</span>&nbsp;<span class="op" id="3954571">:=</span>&nbsp;<span class="ident" id="3954574"><a href="/mime/mediatype.go.html#3954152">pieceMap</a></span><span class="op" id="3954582">[</span><span class="ident" id="3954583"><a href="/mime/mediatype.go.html#3954527">encodedPart</a></span><span class="op" id="3954594">]</span><span class="op" id="3954595">;</span>&nbsp;<span class="ident" id="3954597"><a href="/mime/mediatype.go.html#3954568">ok</a></span>&nbsp;<span class="op" id="3954600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954606"><a href="/mime/mediatype.go.html#3954341">valid</a></span>&nbsp;<span class="op" id="3954612">=</span>&nbsp;<span class="ident" id="3954614">true</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954623">if</span>&nbsp;<span class="ident" id="3954626"><a href="/mime/mediatype.go.html#3954362">n</a></span>&nbsp;<span class="op" id="3954628">==</span>&nbsp;<span class="num" id="3954631">0</span>&nbsp;<span class="op" id="3954633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954640"><a href="/mime/mediatype.go.html#3954125">buf</a></span><span class="op" id="3954643">.</span><span class="ident" id="3954644">WriteString</span><span class="op" id="3954655">(</span><span class="ident" id="3954656"><a href="/mime/mediatype.go.html#3954856">decode2231Enc</a></span><span class="op" id="3954669">(</span><span class="ident" id="3954670"><a href="/mime/mediatype.go.html#3954565">v</a></span><span class="op" id="3954671">)</span><span class="op" id="3954672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954678">}</span>&nbsp;<span class="keyword" id="3954680">else</span>&nbsp;<span class="op" id="3954685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954692">decv</span><span class="op" id="3954696">,</span>&nbsp;<span class="ident" id="3954698">_</span>&nbsp;<span class="op" id="3954700">:=</span>&nbsp;<span class="ident" id="3954703"><a href="/mime/mediatype.go.html#3957413">percentHexUnescape</a></span><span class="op" id="3954721">(</span><span class="ident" id="3954722"><a href="/mime/mediatype.go.html#3954565">v</a></span><span class="op" id="3954723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954730"><a href="/mime/mediatype.go.html#3954125">buf</a></span><span class="op" id="3954733">.</span><span class="ident" id="3954734">WriteString</span><span class="op" id="3954745">(</span><span class="ident" id="3954746"><a href="/mime/mediatype.go.html#3954692">decv</a></span><span class="op" id="3954750">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954761">}</span>&nbsp;<span class="keyword" id="3954763">else</span>&nbsp;<span class="op" id="3954768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954774">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954787">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954791">if</span>&nbsp;<span class="ident" id="3954794"><a href="/mime/mediatype.go.html#3954341">valid</a></span>&nbsp;<span class="op" id="3954800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954805"><a href="/mime/mediatype.go.html#3952667">params</a></span><span class="op" id="3954811">[</span><span class="ident" id="3954812"><a href="/mime/mediatype.go.html#3954147">key</a></span><span class="op" id="3954815">]</span>&nbsp;<span class="op" id="3954817">=</span>&nbsp;<span class="ident" id="3954819"><a href="/mime/mediatype.go.html#3954125">buf</a></span><span class="op" id="3954822">.</span><span class="ident" id="3954823">String</span><span class="op" id="3954829">(</span><span class="op" id="3954830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954841">return</span><br>
<span class="lineno"></span><span class="op" id="3954848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3954851">func</span>&nbsp;<span class="ident" id="3954856">decode2231Enc</span><span class="op" id="3954869">(</span><span class="ident" id="3954870">v</span>&nbsp;<span class="builtintype" id="3954872">string</span><span class="op" id="3954878">)</span>&nbsp;<span class="builtintype" id="3954880">string</span>&nbsp;<span class="op" id="3954887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954890">sv</span>&nbsp;<span class="op" id="3954893">:=</span>&nbsp;<span class="ident" id="3954896"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3954903">.</span><span class="ident" id="3954904">SplitN</span><span class="op" id="3954910">(</span><span class="ident" id="3954911"><a href="/mime/mediatype.go.html#3954870">v</a></span><span class="op" id="3954912">,</span>&nbsp;<span class="string" id="3954914">&#34;&#39;&#34;</span><span class="op" id="3954917">,</span>&nbsp;<span class="num" id="3954919">3</span><span class="op" id="3954920">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954923">if</span>&nbsp;<span class="builtinfunc" id="3954926">len</span><span class="op" id="3954929">(</span><span class="ident" id="3954930"><a href="/mime/mediatype.go.html#3954890">sv</a></span><span class="op" id="3954932">)</span>&nbsp;<span class="op" id="3954934">!=</span>&nbsp;<span class="num" id="3954937">3</span>&nbsp;<span class="op" id="3954939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954943">return</span>&nbsp;<span class="string" id="3954950">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3954957">//&nbsp;TODO:&nbsp;ignoring&nbsp;lang&nbsp;in&nbsp;sv[1]&nbsp;for&nbsp;now.&nbsp;If&nbsp;anybody&nbsp;needs&nbsp;it&nbsp;we&#39;ll</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3955025">//&nbsp;need&nbsp;to&nbsp;decide&nbsp;how&nbsp;to&nbsp;expose&nbsp;it&nbsp;in&nbsp;the&nbsp;API.&nbsp;But&nbsp;I&#39;m&nbsp;not&nbsp;sure</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3955090">//&nbsp;anybody&nbsp;uses&nbsp;it&nbsp;in&nbsp;practice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955123">charset</span>&nbsp;<span class="op" id="3955131">:=</span>&nbsp;<span class="ident" id="3955134"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3955141">.</span><span class="ident" id="3955142">ToLower</span><span class="op" id="3955149">(</span><span class="ident" id="3955150"><a href="/mime/mediatype.go.html#3954890">sv</a></span><span class="op" id="3955152">[</span><span class="num" id="3955153">0</span><span class="op" id="3955154">]</span><span class="op" id="3955155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955158">if</span>&nbsp;<span class="ident" id="3955161"><a href="/mime/mediatype.go.html#3955123">charset</a></span>&nbsp;<span class="op" id="3955169">!=</span>&nbsp;<span class="string" id="3955172">&#34;us-ascii&#34;</span>&nbsp;<span class="op" id="3955183">&amp;&amp;</span>&nbsp;<span class="ident" id="3955186"><a href="/mime/mediatype.go.html#3955123">charset</a></span>&nbsp;<span class="op" id="3955194">!=</span>&nbsp;<span class="string" id="3955197">&#34;utf-8&#34;</span>&nbsp;<span class="op" id="3955205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3955209">//&nbsp;TODO:&nbsp;unsupported&nbsp;encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955241">return</span>&nbsp;<span class="string" id="3955248">&#34;&#34;</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955255">encv</span><span class="op" id="3955259">,</span>&nbsp;<span class="ident" id="3955261">_</span>&nbsp;<span class="op" id="3955263">:=</span>&nbsp;<span class="ident" id="3955266"><a href="/mime/mediatype.go.html#3957413">percentHexUnescape</a></span><span class="op" id="3955284">(</span><span class="ident" id="3955285"><a href="/mime/mediatype.go.html#3954890">sv</a></span><span class="op" id="3955287">[</span><span class="num" id="3955288">2</span><span class="op" id="3955289">]</span><span class="op" id="3955290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955293">return</span>&nbsp;<span class="ident" id="3955300"><a href="/mime/mediatype.go.html#3955255">encv</a></span><br>
<span class="lineno"></span><span class="op" id="3955305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="3955308">func</span>&nbsp;<span class="ident" id="3955313">isNotTokenChar</span><span class="op" id="3955327">(</span><span class="ident" id="3955328">r</span>&nbsp;<span class="builtintype" id="3955330">rune</span><span class="op" id="3955334">)</span>&nbsp;<span class="builtintype" id="3955336">bool</span>&nbsp;<span class="op" id="3955341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955344">return</span>&nbsp;<span class="op" id="3955351">!</span><span class="ident" id="3955352"><a href="/mime/grammar.go.html#3949752">isTokenChar</a></span><span class="op" id="3955363">(</span><span class="ident" id="3955364"><a href="/mime/mediatype.go.html#3955328">r</a></span><span class="op" id="3955365">)</span><br>
<span class="lineno"></span><span class="op" id="3955367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3955370">//&nbsp;consumeToken&nbsp;consumes&nbsp;a&nbsp;token&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;provided</span><br>
<span class="lineno">220</span><span class="comment" id="3955434">//&nbsp;string,&nbsp;per&nbsp;RFC&nbsp;2045&nbsp;section&nbsp;5.1&nbsp;(referenced&nbsp;from&nbsp;2183),&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3955505">//&nbsp;the&nbsp;token&nbsp;consumed&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;Returns&nbsp;(&#34;&#34;,&nbsp;v)&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3955575">//&nbsp;failure&nbsp;to&nbsp;consume&nbsp;at&nbsp;least&nbsp;one&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3955621">func</span>&nbsp;<span class="ident" id="3955626">consumeToken</span><span class="op" id="3955638">(</span><span class="ident" id="3955639">v</span>&nbsp;<span class="builtintype" id="3955641">string</span><span class="op" id="3955647">)</span>&nbsp;<span class="op" id="3955649">(</span><span class="ident" id="3955650">token</span><span class="op" id="3955655">,</span>&nbsp;<span class="ident" id="3955657">rest</span>&nbsp;<span class="builtintype" id="3955662">string</span><span class="op" id="3955668">)</span>&nbsp;<span class="op" id="3955670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955673">notPos</span>&nbsp;<span class="op" id="3955680">:=</span>&nbsp;<span class="ident" id="3955683"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3955690">.</span><span class="ident" id="3955691">IndexFunc</span><span class="op" id="3955700">(</span><span class="ident" id="3955701"><a href="/mime/mediatype.go.html#3955639">v</a></span><span class="op" id="3955702">,</span>&nbsp;<span class="ident" id="3955704"><a href="/mime/mediatype.go.html#3955313">isNotTokenChar</a></span><span class="op" id="3955718">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955721">if</span>&nbsp;<span class="ident" id="3955724"><a href="/mime/mediatype.go.html#3955673">notPos</a></span>&nbsp;<span class="op" id="3955731">==</span>&nbsp;<span class="op" id="3955734">-</span><span class="num" id="3955735">1</span>&nbsp;<span class="op" id="3955737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955741">return</span>&nbsp;<span class="ident" id="3955748"><a href="/mime/mediatype.go.html#3955639">v</a></span><span class="op" id="3955749">,</span>&nbsp;<span class="string" id="3955751">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955758">if</span>&nbsp;<span class="ident" id="3955761"><a href="/mime/mediatype.go.html#3955673">notPos</a></span>&nbsp;<span class="op" id="3955768">==</span>&nbsp;<span class="num" id="3955771">0</span>&nbsp;<span class="op" id="3955773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955777">return</span>&nbsp;<span class="string" id="3955784">&#34;&#34;</span><span class="op" id="3955786">,</span>&nbsp;<span class="ident" id="3955788"><a href="/mime/mediatype.go.html#3955639">v</a></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955794">return</span>&nbsp;<span class="ident" id="3955801"><a href="/mime/mediatype.go.html#3955639">v</a></span><span class="op" id="3955802">[</span><span class="num" id="3955803">0</span><span class="op" id="3955804">:</span><span class="ident" id="3955805"><a href="/mime/mediatype.go.html#3955673">notPos</a></span><span class="op" id="3955811">]</span><span class="op" id="3955812">,</span>&nbsp;<span class="ident" id="3955814"><a href="/mime/mediatype.go.html#3955639">v</a></span><span class="op" id="3955815">[</span><span class="ident" id="3955816"><a href="/mime/mediatype.go.html#3955673">notPos</a></span><span class="op" id="3955822">:</span><span class="op" id="3955823">]</span><br>
<span class="lineno"></span><span class="op" id="3955825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3955828">//&nbsp;consumeValue&nbsp;consumes&nbsp;a&nbsp;&#34;value&#34;&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;where&nbsp;a&nbsp;value&nbsp;is</span><br>
<span class="lineno">235</span><span class="comment" id="3955894">//&nbsp;either&nbsp;a&nbsp;&#39;token&#39;&nbsp;or&nbsp;a&nbsp;&#39;quoted-string&#39;.&nbsp;&nbsp;On&nbsp;success,&nbsp;consumeValue</span><br>
<span class="lineno"></span><span class="comment" id="3955962">//&nbsp;returns&nbsp;the&nbsp;value&nbsp;consumed&nbsp;(and&nbsp;de-quoted/escaped,&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3956021">//&nbsp;quoted-string)&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;On&nbsp;failure,&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3956088">//&nbsp;(&#34;&#34;,&nbsp;v).</span><br>
<span class="lineno"></span><span class="keyword" id="3956100">func</span>&nbsp;<span class="ident" id="3956105">consumeValue</span><span class="op" id="3956117">(</span><span class="ident" id="3956118">v</span>&nbsp;<span class="builtintype" id="3956120">string</span><span class="op" id="3956126">)</span>&nbsp;<span class="op" id="3956128">(</span><span class="ident" id="3956129">value</span><span class="op" id="3956134">,</span>&nbsp;<span class="ident" id="3956136">rest</span>&nbsp;<span class="builtintype" id="3956141">string</span><span class="op" id="3956147">)</span>&nbsp;<span class="op" id="3956149">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956152">if</span>&nbsp;<span class="op" id="3956155">!</span><span class="ident" id="3956156"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3956163">.</span><span class="ident" id="3956164">HasPrefix</span><span class="op" id="3956173">(</span><span class="ident" id="3956174"><a href="/mime/mediatype.go.html#3956118">v</a></span><span class="op" id="3956175">,</span>&nbsp;<span class="string" id="3956177">`&#34;`</span><span class="op" id="3956180">)</span>&nbsp;<span class="op" id="3956182">&amp;&amp;</span>&nbsp;<span class="op" id="3956185">!</span><span class="ident" id="3956186"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3956193">.</span><span class="ident" id="3956194">HasPrefix</span><span class="op" id="3956203">(</span><span class="ident" id="3956204"><a href="/mime/mediatype.go.html#3956118">v</a></span><span class="op" id="3956205">,</span>&nbsp;<span class="string" id="3956207">`&#39;`</span><span class="op" id="3956210">)</span>&nbsp;<span class="op" id="3956212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956216">return</span>&nbsp;<span class="ident" id="3956223"><a href="/mime/mediatype.go.html#3955626">consumeToken</a></span><span class="op" id="3956235">(</span><span class="ident" id="3956236"><a href="/mime/mediatype.go.html#3956118">v</a></span><span class="op" id="3956237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956244">leadQuote</span>&nbsp;<span class="op" id="3956254">:=</span>&nbsp;<span class="builtintype" id="3956257">rune</span><span class="op" id="3956261">(</span><span class="ident" id="3956262"><a href="/mime/mediatype.go.html#3956118">v</a></span><span class="op" id="3956263">[</span><span class="num" id="3956264">0</span><span class="op" id="3956265">]</span><span class="op" id="3956266">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3956270">//&nbsp;parse&nbsp;a&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956296"><a href="/mime/mediatype.go.html#3956136">rest</a></span>&nbsp;<span class="op" id="3956301">=</span>&nbsp;<span class="ident" id="3956303"><a href="/mime/mediatype.go.html#3956118">v</a></span><span class="op" id="3956304">[</span><span class="num" id="3956305">1</span><span class="op" id="3956306">:</span><span class="op" id="3956307">]</span>&nbsp;<span class="comment" id="3956309">//&nbsp;consume&nbsp;the&nbsp;leading&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956339">buffer</span>&nbsp;<span class="op" id="3956346">:=</span>&nbsp;<span class="builtinfunc" id="3956349">new</span><span class="op" id="3956352">(</span><span class="ident" id="3956353"><a href="/mime/mediatype.go.html#3950295">bytes</a></span><span class="op" id="3956358">.</span><span class="ident" id="3956359">Buffer</span><span class="op" id="3956365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956368">var</span>&nbsp;<span class="ident" id="3956372">idx</span>&nbsp;<span class="builtintype" id="3956376">int</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956381">var</span>&nbsp;<span class="ident" id="3956385">r</span>&nbsp;<span class="builtintype" id="3956387">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956393">var</span>&nbsp;<span class="ident" id="3956397">nextIsLiteral</span>&nbsp;<span class="builtintype" id="3956411">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956417">for</span>&nbsp;<span class="ident" id="3956421"><a href="/mime/mediatype.go.html#3956372">idx</a></span><span class="op" id="3956424">,</span>&nbsp;<span class="ident" id="3956426"><a href="/mime/mediatype.go.html#3956385">r</a></span>&nbsp;<span class="op" id="3956428">=</span>&nbsp;<span class="keyword" id="3956430">range</span>&nbsp;<span class="ident" id="3956436"><a href="/mime/mediatype.go.html#3956136">rest</a></span>&nbsp;<span class="op" id="3956441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956445">switch</span>&nbsp;<span class="op" id="3956452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956456">case</span>&nbsp;<span class="ident" id="3956461"><a href="/mime/mediatype.go.html#3956397">nextIsLiteral</a></span><span class="op" id="3956474">:</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956479"><a href="/mime/mediatype.go.html#3956339">buffer</a></span><span class="op" id="3956485">.</span><span class="ident" id="3956486">WriteRune</span><span class="op" id="3956495">(</span><span class="ident" id="3956496"><a href="/mime/mediatype.go.html#3956385">r</a></span><span class="op" id="3956497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956502"><a href="/mime/mediatype.go.html#3956397">nextIsLiteral</a></span>&nbsp;<span class="op" id="3956516">=</span>&nbsp;<span class="ident" id="3956518">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956526">case</span>&nbsp;<span class="ident" id="3956531"><a href="/mime/mediatype.go.html#3956385">r</a></span>&nbsp;<span class="op" id="3956533">==</span>&nbsp;<span class="ident" id="3956536"><a href="/mime/mediatype.go.html#3956244">leadQuote</a></span><span class="op" id="3956545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956550">return</span>&nbsp;<span class="ident" id="3956557"><a href="/mime/mediatype.go.html#3956339">buffer</a></span><span class="op" id="3956563">.</span><span class="ident" id="3956564">String</span><span class="op" id="3956570">(</span><span class="op" id="3956571">)</span><span class="op" id="3956572">,</span>&nbsp;<span class="ident" id="3956574"><a href="/mime/mediatype.go.html#3956136">rest</a></span><span class="op" id="3956578">[</span><span class="ident" id="3956579"><a href="/mime/mediatype.go.html#3956372">idx</a></span><span class="op" id="3956582">+</span><span class="num" id="3956583">1</span><span class="op" id="3956584">:</span><span class="op" id="3956585">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956589">case</span>&nbsp;<span class="ident" id="3956594"><a href="/mime/mediatype.go.html#3956385">r</a></span>&nbsp;<span class="op" id="3956596">==</span>&nbsp;<span class="string" id="3956599">&#39;\\&#39;</span><span class="op" id="3956603">:</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956608"><a href="/mime/mediatype.go.html#3956397">nextIsLiteral</a></span>&nbsp;<span class="op" id="3956622">=</span>&nbsp;<span class="ident" id="3956624">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956631">case</span>&nbsp;<span class="ident" id="3956636"><a href="/mime/mediatype.go.html#3956385">r</a></span>&nbsp;<span class="op" id="3956638">!=</span>&nbsp;<span class="string" id="3956641">&#39;\r&#39;</span>&nbsp;<span class="op" id="3956646">&amp;&amp;</span>&nbsp;<span class="ident" id="3956649"><a href="/mime/mediatype.go.html#3956385">r</a></span>&nbsp;<span class="op" id="3956651">!=</span>&nbsp;<span class="string" id="3956654">&#39;\n&#39;</span><span class="op" id="3956658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956663"><a href="/mime/mediatype.go.html#3956339">buffer</a></span><span class="op" id="3956669">.</span><span class="ident" id="3956670">WriteRune</span><span class="op" id="3956679">(</span><span class="ident" id="3956680"><a href="/mime/mediatype.go.html#3956385">r</a></span><span class="op" id="3956681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956685">default</span><span class="op" id="3956692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956697">return</span>&nbsp;<span class="string" id="3956704">&#34;&#34;</span><span class="op" id="3956706">,</span>&nbsp;<span class="ident" id="3956708"><a href="/mime/mediatype.go.html#3956118">v</a></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956718">return</span>&nbsp;<span class="string" id="3956725">&#34;&#34;</span><span class="op" id="3956727">,</span>&nbsp;<span class="ident" id="3956729"><a href="/mime/mediatype.go.html#3956118">v</a></span><br>
<span class="lineno"></span><span class="op" id="3956731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="keyword" id="3956734">func</span>&nbsp;<span class="ident" id="3956739">consumeMediaParam</span><span class="op" id="3956756">(</span><span class="ident" id="3956757">v</span>&nbsp;<span class="builtintype" id="3956759">string</span><span class="op" id="3956765">)</span>&nbsp;<span class="op" id="3956767">(</span><span class="ident" id="3956768">param</span><span class="op" id="3956773">,</span>&nbsp;<span class="ident" id="3956775">value</span><span class="op" id="3956780">,</span>&nbsp;<span class="ident" id="3956782">rest</span>&nbsp;<span class="builtintype" id="3956787">string</span><span class="op" id="3956793">)</span>&nbsp;<span class="op" id="3956795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956798"><a href="/mime/mediatype.go.html#3956782">rest</a></span>&nbsp;<span class="op" id="3956803">=</span>&nbsp;<span class="ident" id="3956805"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3956812">.</span><span class="ident" id="3956813">TrimLeftFunc</span><span class="op" id="3956825">(</span><span class="ident" id="3956826"><a href="/mime/mediatype.go.html#3956757">v</a></span><span class="op" id="3956827">,</span>&nbsp;<span class="ident" id="3956829"><a href="/mime/mediatype.go.html#3950340">unicode</a></span><span class="op" id="3956836">.</span><span class="ident" id="3956837">IsSpace</span><span class="op" id="3956844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956847">if</span>&nbsp;<span class="op" id="3956850">!</span><span class="ident" id="3956851"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3956858">.</span><span class="ident" id="3956859">HasPrefix</span><span class="op" id="3956868">(</span><span class="ident" id="3956869"><a href="/mime/mediatype.go.html#3956782">rest</a></span><span class="op" id="3956873">,</span>&nbsp;<span class="string" id="3956875">&#34;;&#34;</span><span class="op" id="3956878">)</span>&nbsp;<span class="op" id="3956880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956884">return</span>&nbsp;<span class="string" id="3956891">&#34;&#34;</span><span class="op" id="3956893">,</span>&nbsp;<span class="string" id="3956895">&#34;&#34;</span><span class="op" id="3956897">,</span>&nbsp;<span class="ident" id="3956899"><a href="/mime/mediatype.go.html#3956757">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956902">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956906"><a href="/mime/mediatype.go.html#3956782">rest</a></span>&nbsp;<span class="op" id="3956911">=</span>&nbsp;<span class="ident" id="3956913"><a href="/mime/mediatype.go.html#3956782">rest</a></span><span class="op" id="3956917">[</span><span class="num" id="3956918">1</span><span class="op" id="3956919">:</span><span class="op" id="3956920">]</span>&nbsp;<span class="comment" id="3956922">//&nbsp;consume&nbsp;semicolon</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956944"><a href="/mime/mediatype.go.html#3956782">rest</a></span>&nbsp;<span class="op" id="3956949">=</span>&nbsp;<span class="ident" id="3956951"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3956958">.</span><span class="ident" id="3956959">TrimLeftFunc</span><span class="op" id="3956971">(</span><span class="ident" id="3956972"><a href="/mime/mediatype.go.html#3956782">rest</a></span><span class="op" id="3956976">,</span>&nbsp;<span class="ident" id="3956978"><a href="/mime/mediatype.go.html#3950340">unicode</a></span><span class="op" id="3956985">.</span><span class="ident" id="3956986">IsSpace</span><span class="op" id="3956993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956996"><a href="/mime/mediatype.go.html#3956768">param</a></span><span class="op" id="3957001">,</span>&nbsp;<span class="ident" id="3957003"><a href="/mime/mediatype.go.html#3956782">rest</a></span>&nbsp;<span class="op" id="3957008">=</span>&nbsp;<span class="ident" id="3957010"><a href="/mime/mediatype.go.html#3955626">consumeToken</a></span><span class="op" id="3957022">(</span><span class="ident" id="3957023"><a href="/mime/mediatype.go.html#3956782">rest</a></span><span class="op" id="3957027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957030"><a href="/mime/mediatype.go.html#3956768">param</a></span>&nbsp;<span class="op" id="3957036">=</span>&nbsp;<span class="ident" id="3957038"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3957045">.</span><span class="ident" id="3957046">ToLower</span><span class="op" id="3957053">(</span><span class="ident" id="3957054"><a href="/mime/mediatype.go.html#3956768">param</a></span><span class="op" id="3957059">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957062">if</span>&nbsp;<span class="ident" id="3957065"><a href="/mime/mediatype.go.html#3956768">param</a></span>&nbsp;<span class="op" id="3957071">==</span>&nbsp;<span class="string" id="3957074">&#34;&#34;</span>&nbsp;<span class="op" id="3957077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957081">return</span>&nbsp;<span class="string" id="3957088">&#34;&#34;</span><span class="op" id="3957090">,</span>&nbsp;<span class="string" id="3957092">&#34;&#34;</span><span class="op" id="3957094">,</span>&nbsp;<span class="ident" id="3957096"><a href="/mime/mediatype.go.html#3956757">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957103"><a href="/mime/mediatype.go.html#3956782">rest</a></span>&nbsp;<span class="op" id="3957108">=</span>&nbsp;<span class="ident" id="3957110"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3957117">.</span><span class="ident" id="3957118">TrimLeftFunc</span><span class="op" id="3957130">(</span><span class="ident" id="3957131"><a href="/mime/mediatype.go.html#3956782">rest</a></span><span class="op" id="3957135">,</span>&nbsp;<span class="ident" id="3957137"><a href="/mime/mediatype.go.html#3950340">unicode</a></span><span class="op" id="3957144">.</span><span class="ident" id="3957145">IsSpace</span><span class="op" id="3957152">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957155">if</span>&nbsp;<span class="op" id="3957158">!</span><span class="ident" id="3957159"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3957166">.</span><span class="ident" id="3957167">HasPrefix</span><span class="op" id="3957176">(</span><span class="ident" id="3957177"><a href="/mime/mediatype.go.html#3956782">rest</a></span><span class="op" id="3957181">,</span>&nbsp;<span class="string" id="3957183">&#34;=&#34;</span><span class="op" id="3957186">)</span>&nbsp;<span class="op" id="3957188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957192">return</span>&nbsp;<span class="string" id="3957199">&#34;&#34;</span><span class="op" id="3957201">,</span>&nbsp;<span class="string" id="3957203">&#34;&#34;</span><span class="op" id="3957205">,</span>&nbsp;<span class="ident" id="3957207"><a href="/mime/mediatype.go.html#3956757">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957213"><a href="/mime/mediatype.go.html#3956782">rest</a></span>&nbsp;<span class="op" id="3957218">=</span>&nbsp;<span class="ident" id="3957220"><a href="/mime/mediatype.go.html#3956782">rest</a></span><span class="op" id="3957224">[</span><span class="num" id="3957225">1</span><span class="op" id="3957226">:</span><span class="op" id="3957227">]</span>&nbsp;<span class="comment" id="3957229">//&nbsp;consume&nbsp;equals&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957253"><a href="/mime/mediatype.go.html#3956782">rest</a></span>&nbsp;<span class="op" id="3957258">=</span>&nbsp;<span class="ident" id="3957260"><a href="/mime/mediatype.go.html#3950329">strings</a></span><span class="op" id="3957267">.</span><span class="ident" id="3957268">TrimLeftFunc</span><span class="op" id="3957280">(</span><span class="ident" id="3957281"><a href="/mime/mediatype.go.html#3956782">rest</a></span><span class="op" id="3957285">,</span>&nbsp;<span class="ident" id="3957287"><a href="/mime/mediatype.go.html#3950340">unicode</a></span><span class="op" id="3957294">.</span><span class="ident" id="3957295">IsSpace</span><span class="op" id="3957302">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957305"><a href="/mime/mediatype.go.html#3956775">value</a></span><span class="op" id="3957310">,</span>&nbsp;<span class="ident" id="3957312"><a href="/mime/mediatype.go.html#3956782">rest</a></span>&nbsp;<span class="op" id="3957317">=</span>&nbsp;<span class="ident" id="3957319"><a href="/mime/mediatype.go.html#3956105">consumeValue</a></span><span class="op" id="3957331">(</span><span class="ident" id="3957332"><a href="/mime/mediatype.go.html#3956782">rest</a></span><span class="op" id="3957336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957339">if</span>&nbsp;<span class="ident" id="3957342"><a href="/mime/mediatype.go.html#3956775">value</a></span>&nbsp;<span class="op" id="3957348">==</span>&nbsp;<span class="string" id="3957351">&#34;&#34;</span>&nbsp;<span class="op" id="3957354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957358">return</span>&nbsp;<span class="string" id="3957365">&#34;&#34;</span><span class="op" id="3957367">,</span>&nbsp;<span class="string" id="3957369">&#34;&#34;</span><span class="op" id="3957371">,</span>&nbsp;<span class="ident" id="3957373"><a href="/mime/mediatype.go.html#3956757">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957379">return</span>&nbsp;<span class="ident" id="3957386"><a href="/mime/mediatype.go.html#3956768">param</a></span><span class="op" id="3957391">,</span>&nbsp;<span class="ident" id="3957393"><a href="/mime/mediatype.go.html#3956775">value</a></span><span class="op" id="3957398">,</span>&nbsp;<span class="ident" id="3957400"><a href="/mime/mediatype.go.html#3956782">rest</a></span><br>
<span class="lineno">295</span><span class="op" id="3957405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3957408">func</span>&nbsp;<span class="ident" id="3957413">percentHexUnescape</span><span class="op" id="3957431">(</span><span class="ident" id="3957432">s</span>&nbsp;<span class="builtintype" id="3957434">string</span><span class="op" id="3957440">)</span>&nbsp;<span class="op" id="3957442">(</span><span class="builtintype" id="3957443">string</span><span class="op" id="3957449">,</span>&nbsp;<span class="builtintype" id="3957451">error</span><span class="op" id="3957456">)</span>&nbsp;<span class="op" id="3957458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3957461">//&nbsp;Count&nbsp;%,&nbsp;check&nbsp;that&nbsp;they&#39;re&nbsp;well-formed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957506">percents</span>&nbsp;<span class="op" id="3957515">:=</span>&nbsp;<span class="num" id="3957518">0</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957521">for</span>&nbsp;<span class="ident" id="3957525">i</span>&nbsp;<span class="op" id="3957527">:=</span>&nbsp;<span class="num" id="3957530">0</span><span class="op" id="3957531">;</span>&nbsp;<span class="ident" id="3957533"><a href="/mime/mediatype.go.html#3957525">i</a></span>&nbsp;<span class="op" id="3957535">&lt;</span>&nbsp;<span class="builtinfunc" id="3957537">len</span><span class="op" id="3957540">(</span><span class="ident" id="3957541"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957542">)</span><span class="op" id="3957543">;</span>&nbsp;<span class="op" id="3957545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957549">if</span>&nbsp;<span class="ident" id="3957552"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957553">[</span><span class="ident" id="3957554"><a href="/mime/mediatype.go.html#3957525">i</a></span><span class="op" id="3957555">]</span>&nbsp;<span class="op" id="3957557">!=</span>&nbsp;<span class="string" id="3957560">&#39;%&#39;</span>&nbsp;<span class="op" id="3957564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957569"><a href="/mime/mediatype.go.html#3957525">i</a></span><span class="op" id="3957570">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957576">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957587">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957591"><a href="/mime/mediatype.go.html#3957506">percents</a></span><span class="op" id="3957599">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957604">if</span>&nbsp;<span class="ident" id="3957607"><a href="/mime/mediatype.go.html#3957525">i</a></span><span class="op" id="3957608">+</span><span class="num" id="3957609">2</span>&nbsp;<span class="op" id="3957611">&gt;=</span>&nbsp;<span class="builtinfunc" id="3957614">len</span><span class="op" id="3957617">(</span><span class="ident" id="3957618"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957619">)</span>&nbsp;<span class="op" id="3957621">||</span>&nbsp;<span class="op" id="3957624">!</span><span class="ident" id="3957625"><a href="/mime/mediatype.go.html#3958073">ishex</a></span><span class="op" id="3957630">(</span><span class="ident" id="3957631"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957632">[</span><span class="ident" id="3957633"><a href="/mime/mediatype.go.html#3957525">i</a></span><span class="op" id="3957634">+</span><span class="num" id="3957635">1</span><span class="op" id="3957636">]</span><span class="op" id="3957637">)</span>&nbsp;<span class="op" id="3957639">||</span>&nbsp;<span class="op" id="3957642">!</span><span class="ident" id="3957643"><a href="/mime/mediatype.go.html#3958073">ishex</a></span><span class="op" id="3957648">(</span><span class="ident" id="3957649"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957650">[</span><span class="ident" id="3957651"><a href="/mime/mediatype.go.html#3957525">i</a></span><span class="op" id="3957652">+</span><span class="num" id="3957653">2</span><span class="op" id="3957654">]</span><span class="op" id="3957655">)</span>&nbsp;<span class="op" id="3957657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957662"><a href="/mime/mediatype.go.html#3957432">s</a></span>&nbsp;<span class="op" id="3957664">=</span>&nbsp;<span class="ident" id="3957666"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957667">[</span><span class="ident" id="3957668"><a href="/mime/mediatype.go.html#3957525">i</a></span><span class="op" id="3957669">:</span><span class="op" id="3957670">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957675">if</span>&nbsp;<span class="builtinfunc" id="3957678">len</span><span class="op" id="3957681">(</span><span class="ident" id="3957682"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957683">)</span>&nbsp;<span class="op" id="3957685">&gt;</span>&nbsp;<span class="num" id="3957687">3</span>&nbsp;<span class="op" id="3957689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957695"><a href="/mime/mediatype.go.html#3957432">s</a></span>&nbsp;<span class="op" id="3957697">=</span>&nbsp;<span class="ident" id="3957699"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957700">[</span><span class="num" id="3957701">0</span><span class="op" id="3957702">:</span><span class="num" id="3957703">3</span><span class="op" id="3957704">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957714">return</span>&nbsp;<span class="string" id="3957721">&#34;&#34;</span><span class="op" id="3957723">,</span>&nbsp;<span class="ident" id="3957725"><a href="/mime/mediatype.go.html#3950314">fmt</a></span><span class="op" id="3957728">.</span><span class="ident" id="3957729">Errorf</span><span class="op" id="3957735">(</span><span class="string" id="3957736">&#34;mime:&nbsp;bogus&nbsp;characters&nbsp;after&nbsp;%%:&nbsp;%q&#34;</span><span class="op" id="3957773">,</span>&nbsp;<span class="ident" id="3957775"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957784"><a href="/mime/mediatype.go.html#3957525">i</a></span>&nbsp;<span class="op" id="3957786">+=</span>&nbsp;<span class="num" id="3957789">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957792">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957795">if</span>&nbsp;<span class="ident" id="3957798"><a href="/mime/mediatype.go.html#3957506">percents</a></span>&nbsp;<span class="op" id="3957807">==</span>&nbsp;<span class="num" id="3957810">0</span>&nbsp;<span class="op" id="3957812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957816">return</span>&nbsp;<span class="ident" id="3957823"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957824">,</span>&nbsp;<span class="ident" id="3957826">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957835">t</span>&nbsp;<span class="op" id="3957837">:=</span>&nbsp;<span class="builtinfunc" id="3957840">make</span><span class="op" id="3957844">(</span><span class="op" id="3957845">[</span><span class="op" id="3957846">]</span><span class="builtintype" id="3957847">byte</span><span class="op" id="3957851">,</span>&nbsp;<span class="builtinfunc" id="3957853">len</span><span class="op" id="3957856">(</span><span class="ident" id="3957857"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957858">)</span><span class="op" id="3957859">-</span><span class="num" id="3957860">2</span><span class="op" id="3957861">*</span><span class="ident" id="3957862"><a href="/mime/mediatype.go.html#3957506">percents</a></span><span class="op" id="3957870">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957873">j</span>&nbsp;<span class="op" id="3957875">:=</span>&nbsp;<span class="num" id="3957878">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957881">for</span>&nbsp;<span class="ident" id="3957885">i</span>&nbsp;<span class="op" id="3957887">:=</span>&nbsp;<span class="num" id="3957890">0</span><span class="op" id="3957891">;</span>&nbsp;<span class="ident" id="3957893"><a href="/mime/mediatype.go.html#3957885">i</a></span>&nbsp;<span class="op" id="3957895">&lt;</span>&nbsp;<span class="builtinfunc" id="3957897">len</span><span class="op" id="3957900">(</span><span class="ident" id="3957901"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957902">)</span><span class="op" id="3957903">;</span>&nbsp;<span class="op" id="3957905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957909">switch</span>&nbsp;<span class="ident" id="3957916"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957917">[</span><span class="ident" id="3957918"><a href="/mime/mediatype.go.html#3957885">i</a></span><span class="op" id="3957919">]</span>&nbsp;<span class="op" id="3957921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957925">case</span>&nbsp;<span class="string" id="3957930">&#39;%&#39;</span><span class="op" id="3957933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957938"><a href="/mime/mediatype.go.html#3957835">t</a></span><span class="op" id="3957939">[</span><span class="ident" id="3957940"><a href="/mime/mediatype.go.html#3957873">j</a></span><span class="op" id="3957941">]</span>&nbsp;<span class="op" id="3957943">=</span>&nbsp;<span class="ident" id="3957945"><a href="/mime/mediatype.go.html#3958255">unhex</a></span><span class="op" id="3957950">(</span><span class="ident" id="3957951"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957952">[</span><span class="ident" id="3957953"><a href="/mime/mediatype.go.html#3957885">i</a></span><span class="op" id="3957954">+</span><span class="num" id="3957955">1</span><span class="op" id="3957956">]</span><span class="op" id="3957957">)</span><span class="op" id="3957958">&lt;&lt;</span><span class="num" id="3957960">4</span>&nbsp;<span class="op" id="3957962">|</span>&nbsp;<span class="ident" id="3957964"><a href="/mime/mediatype.go.html#3958255">unhex</a></span><span class="op" id="3957969">(</span><span class="ident" id="3957970"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3957971">[</span><span class="ident" id="3957972"><a href="/mime/mediatype.go.html#3957885">i</a></span><span class="op" id="3957973">+</span><span class="num" id="3957974">2</span><span class="op" id="3957975">]</span><span class="op" id="3957976">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957981"><a href="/mime/mediatype.go.html#3957873">j</a></span><span class="op" id="3957982">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957988"><a href="/mime/mediatype.go.html#3957885">i</a></span>&nbsp;<span class="op" id="3957990">+=</span>&nbsp;<span class="num" id="3957993">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957997">default</span><span class="op" id="3958004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958009"><a href="/mime/mediatype.go.html#3957835">t</a></span><span class="op" id="3958010">[</span><span class="ident" id="3958011"><a href="/mime/mediatype.go.html#3957873">j</a></span><span class="op" id="3958012">]</span>&nbsp;<span class="op" id="3958014">=</span>&nbsp;<span class="ident" id="3958016"><a href="/mime/mediatype.go.html#3957432">s</a></span><span class="op" id="3958017">[</span><span class="ident" id="3958018"><a href="/mime/mediatype.go.html#3957885">i</a></span><span class="op" id="3958019">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958024"><a href="/mime/mediatype.go.html#3957873">j</a></span><span class="op" id="3958025">++</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958031"><a href="/mime/mediatype.go.html#3957885">i</a></span><span class="op" id="3958032">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958043">return</span>&nbsp;<span class="builtintype" id="3958050">string</span><span class="op" id="3958056">(</span><span class="ident" id="3958057"><a href="/mime/mediatype.go.html#3957835">t</a></span><span class="op" id="3958058">)</span><span class="op" id="3958059">,</span>&nbsp;<span class="ident" id="3958061">nil</span><br>
<span class="lineno"></span><span class="op" id="3958065">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="keyword" id="3958068">func</span>&nbsp;<span class="ident" id="3958073">ishex</span><span class="op" id="3958078">(</span><span class="ident" id="3958079">c</span>&nbsp;<span class="builtintype" id="3958081">byte</span><span class="op" id="3958085">)</span>&nbsp;<span class="builtintype" id="3958087">bool</span>&nbsp;<span class="op" id="3958092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958095">switch</span>&nbsp;<span class="op" id="3958102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958105">case</span>&nbsp;<span class="string" id="3958110">&#39;0&#39;</span>&nbsp;<span class="op" id="3958114">&lt;=</span>&nbsp;<span class="ident" id="3958117"><a href="/mime/mediatype.go.html#3958079">c</a></span>&nbsp;<span class="op" id="3958119">&amp;&amp;</span>&nbsp;<span class="ident" id="3958122"><a href="/mime/mediatype.go.html#3958079">c</a></span>&nbsp;<span class="op" id="3958124">&lt;=</span>&nbsp;<span class="string" id="3958127">&#39;9&#39;</span><span class="op" id="3958130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958134">return</span>&nbsp;<span class="ident" id="3958141">true</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958147">case</span>&nbsp;<span class="string" id="3958152">&#39;a&#39;</span>&nbsp;<span class="op" id="3958156">&lt;=</span>&nbsp;<span class="ident" id="3958159"><a href="/mime/mediatype.go.html#3958079">c</a></span>&nbsp;<span class="op" id="3958161">&amp;&amp;</span>&nbsp;<span class="ident" id="3958164"><a href="/mime/mediatype.go.html#3958079">c</a></span>&nbsp;<span class="op" id="3958166">&lt;=</span>&nbsp;<span class="string" id="3958169">&#39;f&#39;</span><span class="op" id="3958172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958176">return</span>&nbsp;<span class="ident" id="3958183">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958189">case</span>&nbsp;<span class="string" id="3958194">&#39;A&#39;</span>&nbsp;<span class="op" id="3958198">&lt;=</span>&nbsp;<span class="ident" id="3958201"><a href="/mime/mediatype.go.html#3958079">c</a></span>&nbsp;<span class="op" id="3958203">&amp;&amp;</span>&nbsp;<span class="ident" id="3958206"><a href="/mime/mediatype.go.html#3958079">c</a></span>&nbsp;<span class="op" id="3958208">&lt;=</span>&nbsp;<span class="string" id="3958211">&#39;F&#39;</span><span class="op" id="3958214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958218">return</span>&nbsp;<span class="ident" id="3958225">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958231">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958234">return</span>&nbsp;<span class="ident" id="3958241">false</span><br>
<span class="lineno"></span><span class="op" id="3958247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3958250">func</span>&nbsp;<span class="ident" id="3958255">unhex</span><span class="op" id="3958260">(</span><span class="ident" id="3958261">c</span>&nbsp;<span class="builtintype" id="3958263">byte</span><span class="op" id="3958267">)</span>&nbsp;<span class="builtintype" id="3958269">byte</span>&nbsp;<span class="op" id="3958274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958277">switch</span>&nbsp;<span class="op" id="3958284">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958287">case</span>&nbsp;<span class="string" id="3958292">&#39;0&#39;</span>&nbsp;<span class="op" id="3958296">&lt;=</span>&nbsp;<span class="ident" id="3958299"><a href="/mime/mediatype.go.html#3958261">c</a></span>&nbsp;<span class="op" id="3958301">&amp;&amp;</span>&nbsp;<span class="ident" id="3958304"><a href="/mime/mediatype.go.html#3958261">c</a></span>&nbsp;<span class="op" id="3958306">&lt;=</span>&nbsp;<span class="string" id="3958309">&#39;9&#39;</span><span class="op" id="3958312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958316">return</span>&nbsp;<span class="ident" id="3958323"><a href="/mime/mediatype.go.html#3958261">c</a></span>&nbsp;<span class="op" id="3958325">-</span>&nbsp;<span class="string" id="3958327">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958332">case</span>&nbsp;<span class="string" id="3958337">&#39;a&#39;</span>&nbsp;<span class="op" id="3958341">&lt;=</span>&nbsp;<span class="ident" id="3958344"><a href="/mime/mediatype.go.html#3958261">c</a></span>&nbsp;<span class="op" id="3958346">&amp;&amp;</span>&nbsp;<span class="ident" id="3958349"><a href="/mime/mediatype.go.html#3958261">c</a></span>&nbsp;<span class="op" id="3958351">&lt;=</span>&nbsp;<span class="string" id="3958354">&#39;f&#39;</span><span class="op" id="3958357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958361">return</span>&nbsp;<span class="ident" id="3958368"><a href="/mime/mediatype.go.html#3958261">c</a></span>&nbsp;<span class="op" id="3958370">-</span>&nbsp;<span class="string" id="3958372">&#39;a&#39;</span>&nbsp;<span class="op" id="3958376">+</span>&nbsp;<span class="num" id="3958378">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958382">case</span>&nbsp;<span class="string" id="3958387">&#39;A&#39;</span>&nbsp;<span class="op" id="3958391">&lt;=</span>&nbsp;<span class="ident" id="3958394"><a href="/mime/mediatype.go.html#3958261">c</a></span>&nbsp;<span class="op" id="3958396">&amp;&amp;</span>&nbsp;<span class="ident" id="3958399"><a href="/mime/mediatype.go.html#3958261">c</a></span>&nbsp;<span class="op" id="3958401">&lt;=</span>&nbsp;<span class="string" id="3958404">&#39;F&#39;</span><span class="op" id="3958407">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958411">return</span>&nbsp;<span class="ident" id="3958418"><a href="/mime/mediatype.go.html#3958261">c</a></span>&nbsp;<span class="op" id="3958420">-</span>&nbsp;<span class="string" id="3958422">&#39;A&#39;</span>&nbsp;<span class="op" id="3958426">+</span>&nbsp;<span class="num" id="3958428">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958435">return</span>&nbsp;<span class="num" id="3958442">0</span><br>
<span class="lineno"></span><span class="op" id="3958444">}</span>
</div>
</body>
</html>
