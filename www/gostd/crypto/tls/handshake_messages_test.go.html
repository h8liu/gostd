<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7183454">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7183509">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7183563">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7183614">package</span>&nbsp;<span class="ident" id="7183622">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7183627">import</span>&nbsp;<span class="op" id="7183634">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7183637">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7183650">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7183661">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7183672">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="7183688">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7183691">var</span>&nbsp;<span class="ident" id="7183695">tests</span>&nbsp;<span class="op" id="7183701">=</span>&nbsp;<span class="op" id="7183703">[</span><span class="op" id="7183704">]</span><span class="keyword" id="7183705">interface</span><span class="op" id="7183714">{</span><span class="op" id="7183715">}</span><span class="op" id="7183716">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183719">&amp;</span><span class="ident" id="7183720">clientHelloMsg</span><span class="op" id="7183734">{</span><span class="op" id="7183735">}</span><span class="op" id="7183736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183739">&amp;</span><span class="ident" id="7183740">serverHelloMsg</span><span class="op" id="7183754">{</span><span class="op" id="7183755">}</span><span class="op" id="7183756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183759">&amp;</span><span class="ident" id="7183760">finishedMsg</span><span class="op" id="7183771">{</span><span class="op" id="7183772">}</span><span class="op" id="7183773">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183777">&amp;</span><span class="ident" id="7183778">certificateMsg</span><span class="op" id="7183792">{</span><span class="op" id="7183793">}</span><span class="op" id="7183794">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183797">&amp;</span><span class="ident" id="7183798">certificateRequestMsg</span><span class="op" id="7183819">{</span><span class="op" id="7183820">}</span><span class="op" id="7183821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183824">&amp;</span><span class="ident" id="7183825">certificateVerifyMsg</span><span class="op" id="7183845">{</span><span class="op" id="7183846">}</span><span class="op" id="7183847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183850">&amp;</span><span class="ident" id="7183851">certificateStatusMsg</span><span class="op" id="7183871">{</span><span class="op" id="7183872">}</span><span class="op" id="7183873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183876">&amp;</span><span class="ident" id="7183877">clientKeyExchangeMsg</span><span class="op" id="7183897">{</span><span class="op" id="7183898">}</span><span class="op" id="7183899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183902">&amp;</span><span class="ident" id="7183903">nextProtoMsg</span><span class="op" id="7183915">{</span><span class="op" id="7183916">}</span><span class="op" id="7183917">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183920">&amp;</span><span class="ident" id="7183921">newSessionTicketMsg</span><span class="op" id="7183940">{</span><span class="op" id="7183941">}</span><span class="op" id="7183942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7183945">&amp;</span><span class="ident" id="7183946">sessionState</span><span class="op" id="7183958">{</span><span class="op" id="7183959">}</span><span class="op" id="7183960">,</span><br>
<span class="lineno"></span><span class="op" id="7183962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7183965">type</span>&nbsp;<span class="ident" id="7183970">testMessage</span>&nbsp;<span class="keyword" id="7183982">interface</span>&nbsp;<span class="op" id="7183992">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7183995">marshal</span><span class="op" id="7184002">(</span><span class="op" id="7184003">)</span>&nbsp;<span class="op" id="7184005">[</span><span class="op" id="7184006">]</span><span class="builtintype" id="7184007">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184013">unmarshal</span><span class="op" id="7184022">(</span><span class="op" id="7184023">[</span><span class="op" id="7184024">]</span><span class="builtintype" id="7184025">byte</span><span class="op" id="7184029">)</span>&nbsp;<span class="builtintype" id="7184031">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184037">equal</span><span class="op" id="7184042">(</span><span class="keyword" id="7184043">interface</span><span class="op" id="7184052">{</span><span class="op" id="7184053">}</span><span class="op" id="7184054">)</span>&nbsp;<span class="builtintype" id="7184056">bool</span><br>
<span class="lineno"></span><span class="op" id="7184061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7184064">func</span>&nbsp;<span class="ident" id="7184069">TestMarshalUnmarshal</span><span class="op" id="7184089">(</span><span class="ident" id="7184090">t</span>&nbsp;<span class="op" id="7184092">*</span><span class="ident" id="7184093">testing</span><span class="op" id="7184100">.</span><span class="ident" id="7184101">T</span><span class="op" id="7184102">)</span>&nbsp;<span class="op" id="7184104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184107">rand</span>&nbsp;<span class="op" id="7184112">:=</span>&nbsp;<span class="ident" id="7184115">rand</span><span class="op" id="7184119">.</span><span class="ident" id="7184120">New</span><span class="op" id="7184123">(</span><span class="ident" id="7184124">rand</span><span class="op" id="7184128">.</span><span class="ident" id="7184129">NewSource</span><span class="op" id="7184138">(</span><span class="num" id="7184139">0</span><span class="op" id="7184140">)</span><span class="op" id="7184141">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7184145">for</span>&nbsp;<span class="ident" id="7184149">i</span><span class="op" id="7184150">,</span>&nbsp;<span class="ident" id="7184152">iface</span>&nbsp;<span class="op" id="7184158">:=</span>&nbsp;<span class="keyword" id="7184161">range</span>&nbsp;<span class="ident" id="7184167">tests</span>&nbsp;<span class="op" id="7184173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184177">ty</span>&nbsp;<span class="op" id="7184180">:=</span>&nbsp;<span class="ident" id="7184183">reflect</span><span class="op" id="7184190">.</span><span class="ident" id="7184191">ValueOf</span><span class="op" id="7184198">(</span><span class="ident" id="7184199">iface</span><span class="op" id="7184204">)</span><span class="op" id="7184205">.</span><span class="ident" id="7184206">Type</span><span class="op" id="7184210">(</span><span class="op" id="7184211">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184216">n</span>&nbsp;<span class="op" id="7184218">:=</span>&nbsp;<span class="num" id="7184221">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7184227">if</span>&nbsp;<span class="ident" id="7184230">testing</span><span class="op" id="7184237">.</span><span class="ident" id="7184238">Short</span><span class="op" id="7184243">(</span><span class="op" id="7184244">)</span>&nbsp;<span class="op" id="7184246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184251">n</span>&nbsp;<span class="op" id="7184253">=</span>&nbsp;<span class="num" id="7184255">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7184259">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7184263">for</span>&nbsp;<span class="ident" id="7184267">j</span>&nbsp;<span class="op" id="7184269">:=</span>&nbsp;<span class="num" id="7184272">0</span><span class="op" id="7184273">;</span>&nbsp;<span class="ident" id="7184275">j</span>&nbsp;<span class="op" id="7184277">&lt;</span>&nbsp;<span class="ident" id="7184279">n</span><span class="op" id="7184280">;</span>&nbsp;<span class="ident" id="7184282">j</span><span class="op" id="7184283">++</span>&nbsp;<span class="op" id="7184286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184291">v</span><span class="op" id="7184292">,</span>&nbsp;<span class="ident" id="7184294">ok</span>&nbsp;<span class="op" id="7184297">:=</span>&nbsp;<span class="ident" id="7184300">quick</span><span class="op" id="7184305">.</span><span class="ident" id="7184306">Value</span><span class="op" id="7184311">(</span><span class="ident" id="7184312">ty</span><span class="op" id="7184314">,</span>&nbsp;<span class="ident" id="7184316">rand</span><span class="op" id="7184320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7184325">if</span>&nbsp;<span class="op" id="7184328">!</span><span class="ident" id="7184329">ok</span>&nbsp;<span class="op" id="7184332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184338">t</span><span class="op" id="7184339">.</span><span class="ident" id="7184340">Errorf</span><span class="op" id="7184346">(</span><span class="string" id="7184347">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="7184376">,</span>&nbsp;<span class="ident" id="7184378">i</span><span class="op" id="7184379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7184385">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7184394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184400">m1</span>&nbsp;<span class="op" id="7184403">:=</span>&nbsp;<span class="ident" id="7184406">v</span><span class="op" id="7184407">.</span><span class="ident" id="7184408">Interface</span><span class="op" id="7184417">(</span><span class="op" id="7184418">)</span><span class="op" id="7184419">.</span><span class="op" id="7184420">(</span><span class="ident" id="7184421">testMessage</span><span class="op" id="7184432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184437">marshaled</span>&nbsp;<span class="op" id="7184447">:=</span>&nbsp;<span class="ident" id="7184450">m1</span><span class="op" id="7184452">.</span><span class="ident" id="7184453">marshal</span><span class="op" id="7184460">(</span><span class="op" id="7184461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184466">m2</span>&nbsp;<span class="op" id="7184469">:=</span>&nbsp;<span class="ident" id="7184472">iface</span><span class="op" id="7184477">.</span><span class="op" id="7184478">(</span><span class="ident" id="7184479">testMessage</span><span class="op" id="7184490">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7184495">if</span>&nbsp;<span class="op" id="7184498">!</span><span class="ident" id="7184499">m2</span><span class="op" id="7184501">.</span><span class="ident" id="7184502">unmarshal</span><span class="op" id="7184511">(</span><span class="ident" id="7184512">marshaled</span><span class="op" id="7184521">)</span>&nbsp;<span class="op" id="7184523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184529">t</span><span class="op" id="7184530">.</span><span class="ident" id="7184531">Errorf</span><span class="op" id="7184537">(</span><span class="string" id="7184538">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="7184570">,</span>&nbsp;<span class="ident" id="7184572">i</span><span class="op" id="7184573">,</span>&nbsp;<span class="ident" id="7184575">m1</span><span class="op" id="7184577">,</span>&nbsp;<span class="ident" id="7184579">marshaled</span><span class="op" id="7184588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7184594">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7184603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184608">m2</span><span class="op" id="7184610">.</span><span class="ident" id="7184611">marshal</span><span class="op" id="7184618">(</span><span class="op" id="7184619">)</span>&nbsp;<span class="comment" id="7184621">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7184669">if</span>&nbsp;<span class="op" id="7184672">!</span><span class="ident" id="7184673">m1</span><span class="op" id="7184675">.</span><span class="ident" id="7184676">equal</span><span class="op" id="7184681">(</span><span class="ident" id="7184682">m2</span><span class="op" id="7184684">)</span>&nbsp;<span class="op" id="7184686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184692">t</span><span class="op" id="7184693">.</span><span class="ident" id="7184694">Errorf</span><span class="op" id="7184700">(</span><span class="string" id="7184701">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="7184726">,</span>&nbsp;<span class="ident" id="7184728">i</span><span class="op" id="7184729">,</span>&nbsp;<span class="ident" id="7184731">m2</span><span class="op" id="7184733">,</span>&nbsp;<span class="ident" id="7184735">m1</span><span class="op" id="7184737">,</span>&nbsp;<span class="ident" id="7184739">marshaled</span><span class="op" id="7184748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7184754">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7184763">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7184769">if</span>&nbsp;<span class="ident" id="7184772">i</span>&nbsp;<span class="op" id="7184774">&gt;=</span>&nbsp;<span class="num" id="7184777">3</span>&nbsp;<span class="op" id="7184779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7184785">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7184836">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7184884">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7184936">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7184982">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7185022">for</span>&nbsp;<span class="ident" id="7185026">j</span>&nbsp;<span class="op" id="7185028">:=</span>&nbsp;<span class="num" id="7185031">0</span><span class="op" id="7185032">;</span>&nbsp;<span class="ident" id="7185034">j</span>&nbsp;<span class="op" id="7185036">&lt;</span>&nbsp;<span class="builtinfunc" id="7185038">len</span><span class="op" id="7185041">(</span><span class="ident" id="7185042">marshaled</span><span class="op" id="7185051">)</span><span class="op" id="7185052">;</span>&nbsp;<span class="ident" id="7185054">j</span><span class="op" id="7185055">++</span>&nbsp;<span class="op" id="7185058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7185065">if</span>&nbsp;<span class="ident" id="7185068">m2</span><span class="op" id="7185070">.</span><span class="ident" id="7185071">unmarshal</span><span class="op" id="7185080">(</span><span class="ident" id="7185081">marshaled</span><span class="op" id="7185090">[</span><span class="num" id="7185091">0</span><span class="op" id="7185092">:</span><span class="ident" id="7185093">j</span><span class="op" id="7185094">]</span><span class="op" id="7185095">)</span>&nbsp;<span class="op" id="7185097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185105">t</span><span class="op" id="7185106">.</span><span class="ident" id="7185107">Errorf</span><span class="op" id="7185113">(</span><span class="string" id="7185114">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="7185160">,</span>&nbsp;<span class="ident" id="7185162">i</span><span class="op" id="7185163">,</span>&nbsp;<span class="ident" id="7185165">j</span><span class="op" id="7185166">,</span>&nbsp;<span class="ident" id="7185168">m1</span><span class="op" id="7185170">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7185178">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185204">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185207">}</span><br>
<span class="lineno"></span><span class="op" id="7185209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7185212">func</span>&nbsp;<span class="ident" id="7185217">TestFuzz</span><span class="op" id="7185225">(</span><span class="ident" id="7185226">t</span>&nbsp;<span class="op" id="7185228">*</span><span class="ident" id="7185229">testing</span><span class="op" id="7185236">.</span><span class="ident" id="7185237">T</span><span class="op" id="7185238">)</span>&nbsp;<span class="op" id="7185240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185243">rand</span>&nbsp;<span class="op" id="7185248">:=</span>&nbsp;<span class="ident" id="7185251">rand</span><span class="op" id="7185255">.</span><span class="ident" id="7185256">New</span><span class="op" id="7185259">(</span><span class="ident" id="7185260">rand</span><span class="op" id="7185264">.</span><span class="ident" id="7185265">NewSource</span><span class="op" id="7185274">(</span><span class="num" id="7185275">0</span><span class="op" id="7185276">)</span><span class="op" id="7185277">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7185280">for</span>&nbsp;<span class="ident" id="7185284">_</span><span class="op" id="7185285">,</span>&nbsp;<span class="ident" id="7185287">iface</span>&nbsp;<span class="op" id="7185293">:=</span>&nbsp;<span class="keyword" id="7185296">range</span>&nbsp;<span class="ident" id="7185302">tests</span>&nbsp;<span class="op" id="7185308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185312">m</span>&nbsp;<span class="op" id="7185314">:=</span>&nbsp;<span class="ident" id="7185317">iface</span><span class="op" id="7185322">.</span><span class="op" id="7185323">(</span><span class="ident" id="7185324">testMessage</span><span class="op" id="7185335">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7185340">for</span>&nbsp;<span class="ident" id="7185344">j</span>&nbsp;<span class="op" id="7185346">:=</span>&nbsp;<span class="num" id="7185349">0</span><span class="op" id="7185350">;</span>&nbsp;<span class="ident" id="7185352">j</span>&nbsp;<span class="op" id="7185354">&lt;</span>&nbsp;<span class="num" id="7185356">1000</span><span class="op" id="7185360">;</span>&nbsp;<span class="ident" id="7185362">j</span><span class="op" id="7185363">++</span>&nbsp;<span class="op" id="7185366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7185371">len</span>&nbsp;<span class="op" id="7185375">:=</span>&nbsp;<span class="ident" id="7185378">rand</span><span class="op" id="7185382">.</span><span class="ident" id="7185383">Intn</span><span class="op" id="7185387">(</span><span class="num" id="7185388">100</span><span class="op" id="7185391">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185396">bytes</span>&nbsp;<span class="op" id="7185402">:=</span>&nbsp;<span class="ident" id="7185405">randomBytes</span><span class="op" id="7185416">(</span><span class="builtinfunc" id="7185417">len</span><span class="op" id="7185420">,</span>&nbsp;<span class="ident" id="7185422">rand</span><span class="op" id="7185426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7185431">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185491">m</span><span class="op" id="7185492">.</span><span class="ident" id="7185493">unmarshal</span><span class="op" id="7185502">(</span><span class="ident" id="7185503">bytes</span><span class="op" id="7185508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185515">}</span><br>
<span class="lineno">95</span><span class="op" id="7185517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7185520">func</span>&nbsp;<span class="ident" id="7185525">randomBytes</span><span class="op" id="7185536">(</span><span class="ident" id="7185537">n</span>&nbsp;<span class="builtintype" id="7185539">int</span><span class="op" id="7185542">,</span>&nbsp;<span class="ident" id="7185544">rand</span>&nbsp;<span class="op" id="7185549">*</span><span class="ident" id="7185550">rand</span><span class="op" id="7185554">.</span><span class="ident" id="7185555">Rand</span><span class="op" id="7185559">)</span>&nbsp;<span class="op" id="7185561">[</span><span class="op" id="7185562">]</span><span class="builtintype" id="7185563">byte</span>&nbsp;<span class="op" id="7185568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185571">r</span>&nbsp;<span class="op" id="7185573">:=</span>&nbsp;<span class="builtinfunc" id="7185576">make</span><span class="op" id="7185580">(</span><span class="op" id="7185581">[</span><span class="op" id="7185582">]</span><span class="builtintype" id="7185583">byte</span><span class="op" id="7185587">,</span>&nbsp;<span class="ident" id="7185589">n</span><span class="op" id="7185590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7185593">for</span>&nbsp;<span class="ident" id="7185597">i</span>&nbsp;<span class="op" id="7185599">:=</span>&nbsp;<span class="num" id="7185602">0</span><span class="op" id="7185603">;</span>&nbsp;<span class="ident" id="7185605">i</span>&nbsp;<span class="op" id="7185607">&lt;</span>&nbsp;<span class="ident" id="7185609">n</span><span class="op" id="7185610">;</span>&nbsp;<span class="ident" id="7185612">i</span><span class="op" id="7185613">++</span>&nbsp;<span class="op" id="7185616">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185620">r</span><span class="op" id="7185621">[</span><span class="ident" id="7185622">i</span><span class="op" id="7185623">]</span>&nbsp;<span class="op" id="7185625">=</span>&nbsp;<span class="builtintype" id="7185627">byte</span><span class="op" id="7185631">(</span><span class="ident" id="7185632">rand</span><span class="op" id="7185636">.</span><span class="ident" id="7185637">Int31</span><span class="op" id="7185642">(</span><span class="op" id="7185643">)</span><span class="op" id="7185644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7185650">return</span>&nbsp;<span class="ident" id="7185657">r</span><br>
<span class="lineno"></span><span class="op" id="7185659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="7185662">func</span>&nbsp;<span class="ident" id="7185667">randomString</span><span class="op" id="7185679">(</span><span class="ident" id="7185680">n</span>&nbsp;<span class="builtintype" id="7185682">int</span><span class="op" id="7185685">,</span>&nbsp;<span class="ident" id="7185687">rand</span>&nbsp;<span class="op" id="7185692">*</span><span class="ident" id="7185693">rand</span><span class="op" id="7185697">.</span><span class="ident" id="7185698">Rand</span><span class="op" id="7185702">)</span>&nbsp;<span class="builtintype" id="7185704">string</span>&nbsp;<span class="op" id="7185711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185714">b</span>&nbsp;<span class="op" id="7185716">:=</span>&nbsp;<span class="ident" id="7185719">randomBytes</span><span class="op" id="7185730">(</span><span class="ident" id="7185731">n</span><span class="op" id="7185732">,</span>&nbsp;<span class="ident" id="7185734">rand</span><span class="op" id="7185738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7185741">return</span>&nbsp;<span class="builtintype" id="7185748">string</span><span class="op" id="7185754">(</span><span class="ident" id="7185755">b</span><span class="op" id="7185756">)</span><br>
<span class="lineno"></span><span class="op" id="7185758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7185761">func</span>&nbsp;<span class="op" id="7185766">(</span><span class="op" id="7185767">*</span><span class="ident" id="7185768">clientHelloMsg</span><span class="op" id="7185782">)</span>&nbsp;<span class="ident" id="7185784">Generate</span><span class="op" id="7185792">(</span><span class="ident" id="7185793">rand</span>&nbsp;<span class="op" id="7185798">*</span><span class="ident" id="7185799">rand</span><span class="op" id="7185803">.</span><span class="ident" id="7185804">Rand</span><span class="op" id="7185808">,</span>&nbsp;<span class="ident" id="7185810">size</span>&nbsp;<span class="builtintype" id="7185815">int</span><span class="op" id="7185818">)</span>&nbsp;<span class="ident" id="7185820">reflect</span><span class="op" id="7185827">.</span><span class="ident" id="7185828">Value</span>&nbsp;<span class="op" id="7185834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185837">m</span>&nbsp;<span class="op" id="7185839">:=</span>&nbsp;<span class="op" id="7185842">&amp;</span><span class="ident" id="7185843">clientHelloMsg</span><span class="op" id="7185857">{</span><span class="op" id="7185858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185861">m</span><span class="op" id="7185862">.</span><span class="ident" id="7185863">vers</span>&nbsp;<span class="op" id="7185868">=</span>&nbsp;<span class="builtintype" id="7185870">uint16</span><span class="op" id="7185876">(</span><span class="ident" id="7185877">rand</span><span class="op" id="7185881">.</span><span class="ident" id="7185882">Intn</span><span class="op" id="7185886">(</span><span class="num" id="7185887">65536</span><span class="op" id="7185892">)</span><span class="op" id="7185893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185896">m</span><span class="op" id="7185897">.</span><span class="ident" id="7185898">random</span>&nbsp;<span class="op" id="7185905">=</span>&nbsp;<span class="ident" id="7185907">randomBytes</span><span class="op" id="7185918">(</span><span class="num" id="7185919">32</span><span class="op" id="7185921">,</span>&nbsp;<span class="ident" id="7185923">rand</span><span class="op" id="7185927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185930">m</span><span class="op" id="7185931">.</span><span class="ident" id="7185932">sessionId</span>&nbsp;<span class="op" id="7185942">=</span>&nbsp;<span class="ident" id="7185944">randomBytes</span><span class="op" id="7185955">(</span><span class="ident" id="7185956">rand</span><span class="op" id="7185960">.</span><span class="ident" id="7185961">Intn</span><span class="op" id="7185965">(</span><span class="num" id="7185966">32</span><span class="op" id="7185968">)</span><span class="op" id="7185969">,</span>&nbsp;<span class="ident" id="7185971">rand</span><span class="op" id="7185975">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185978">m</span><span class="op" id="7185979">.</span><span class="ident" id="7185980">cipherSuites</span>&nbsp;<span class="op" id="7185993">=</span>&nbsp;<span class="builtinfunc" id="7185995">make</span><span class="op" id="7185999">(</span><span class="op" id="7186000">[</span><span class="op" id="7186001">]</span><span class="builtintype" id="7186002">uint16</span><span class="op" id="7186008">,</span>&nbsp;<span class="ident" id="7186010">rand</span><span class="op" id="7186014">.</span><span class="ident" id="7186015">Intn</span><span class="op" id="7186019">(</span><span class="num" id="7186020">63</span><span class="op" id="7186022">)</span><span class="op" id="7186023">+</span><span class="num" id="7186024">1</span><span class="op" id="7186025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7186028">for</span>&nbsp;<span class="ident" id="7186032">i</span>&nbsp;<span class="op" id="7186034">:=</span>&nbsp;<span class="num" id="7186037">0</span><span class="op" id="7186038">;</span>&nbsp;<span class="ident" id="7186040">i</span>&nbsp;<span class="op" id="7186042">&lt;</span>&nbsp;<span class="builtinfunc" id="7186044">len</span><span class="op" id="7186047">(</span><span class="ident" id="7186048">m</span><span class="op" id="7186049">.</span><span class="ident" id="7186050">cipherSuites</span><span class="op" id="7186062">)</span><span class="op" id="7186063">;</span>&nbsp;<span class="ident" id="7186065">i</span><span class="op" id="7186066">++</span>&nbsp;<span class="op" id="7186069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186073">m</span><span class="op" id="7186074">.</span><span class="ident" id="7186075">cipherSuites</span><span class="op" id="7186087">[</span><span class="ident" id="7186088">i</span><span class="op" id="7186089">]</span>&nbsp;<span class="op" id="7186091">=</span>&nbsp;<span class="builtintype" id="7186093">uint16</span><span class="op" id="7186099">(</span><span class="ident" id="7186100">rand</span><span class="op" id="7186104">.</span><span class="ident" id="7186105">Int31</span><span class="op" id="7186110">(</span><span class="op" id="7186111">)</span><span class="op" id="7186112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186118">m</span><span class="op" id="7186119">.</span><span class="ident" id="7186120">compressionMethods</span>&nbsp;<span class="op" id="7186139">=</span>&nbsp;<span class="ident" id="7186141">randomBytes</span><span class="op" id="7186152">(</span><span class="ident" id="7186153">rand</span><span class="op" id="7186157">.</span><span class="ident" id="7186158">Intn</span><span class="op" id="7186162">(</span><span class="num" id="7186163">63</span><span class="op" id="7186165">)</span><span class="op" id="7186166">+</span><span class="num" id="7186167">1</span><span class="op" id="7186168">,</span>&nbsp;<span class="ident" id="7186170">rand</span><span class="op" id="7186174">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7186177">if</span>&nbsp;<span class="ident" id="7186180">rand</span><span class="op" id="7186184">.</span><span class="ident" id="7186185">Intn</span><span class="op" id="7186189">(</span><span class="num" id="7186190">10</span><span class="op" id="7186192">)</span>&nbsp;<span class="op" id="7186194">&gt;</span>&nbsp;<span class="num" id="7186196">5</span>&nbsp;<span class="op" id="7186198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186202">m</span><span class="op" id="7186203">.</span><span class="ident" id="7186204">nextProtoNeg</span>&nbsp;<span class="op" id="7186217">=</span>&nbsp;<span class="builtintype" id="7186219">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7186228">if</span>&nbsp;<span class="ident" id="7186231">rand</span><span class="op" id="7186235">.</span><span class="ident" id="7186236">Intn</span><span class="op" id="7186240">(</span><span class="num" id="7186241">10</span><span class="op" id="7186243">)</span>&nbsp;<span class="op" id="7186245">&gt;</span>&nbsp;<span class="num" id="7186247">5</span>&nbsp;<span class="op" id="7186249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186253">m</span><span class="op" id="7186254">.</span><span class="ident" id="7186255">serverName</span>&nbsp;<span class="op" id="7186266">=</span>&nbsp;<span class="ident" id="7186268">randomString</span><span class="op" id="7186280">(</span><span class="ident" id="7186281">rand</span><span class="op" id="7186285">.</span><span class="ident" id="7186286">Intn</span><span class="op" id="7186290">(</span><span class="num" id="7186291">255</span><span class="op" id="7186294">)</span><span class="op" id="7186295">,</span>&nbsp;<span class="ident" id="7186297">rand</span><span class="op" id="7186301">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186307">m</span><span class="op" id="7186308">.</span><span class="ident" id="7186309">ocspStapling</span>&nbsp;<span class="op" id="7186322">=</span>&nbsp;<span class="ident" id="7186324">rand</span><span class="op" id="7186328">.</span><span class="ident" id="7186329">Intn</span><span class="op" id="7186333">(</span><span class="num" id="7186334">10</span><span class="op" id="7186336">)</span>&nbsp;<span class="op" id="7186338">&gt;</span>&nbsp;<span class="num" id="7186340">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186343">m</span><span class="op" id="7186344">.</span><span class="ident" id="7186345">supportedPoints</span>&nbsp;<span class="op" id="7186361">=</span>&nbsp;<span class="ident" id="7186363">randomBytes</span><span class="op" id="7186374">(</span><span class="ident" id="7186375">rand</span><span class="op" id="7186379">.</span><span class="ident" id="7186380">Intn</span><span class="op" id="7186384">(</span><span class="num" id="7186385">5</span><span class="op" id="7186386">)</span><span class="op" id="7186387">+</span><span class="num" id="7186388">1</span><span class="op" id="7186389">,</span>&nbsp;<span class="ident" id="7186391">rand</span><span class="op" id="7186395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186398">m</span><span class="op" id="7186399">.</span><span class="ident" id="7186400">supportedCurves</span>&nbsp;<span class="op" id="7186416">=</span>&nbsp;<span class="builtinfunc" id="7186418">make</span><span class="op" id="7186422">(</span><span class="op" id="7186423">[</span><span class="op" id="7186424">]</span><span class="ident" id="7186425">CurveID</span><span class="op" id="7186432">,</span>&nbsp;<span class="ident" id="7186434">rand</span><span class="op" id="7186438">.</span><span class="ident" id="7186439">Intn</span><span class="op" id="7186443">(</span><span class="num" id="7186444">5</span><span class="op" id="7186445">)</span><span class="op" id="7186446">+</span><span class="num" id="7186447">1</span><span class="op" id="7186448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7186451">for</span>&nbsp;<span class="ident" id="7186455">i</span>&nbsp;<span class="op" id="7186457">:=</span>&nbsp;<span class="keyword" id="7186460">range</span>&nbsp;<span class="ident" id="7186466">m</span><span class="op" id="7186467">.</span><span class="ident" id="7186468">supportedCurves</span>&nbsp;<span class="op" id="7186484">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186488">m</span><span class="op" id="7186489">.</span><span class="ident" id="7186490">supportedCurves</span><span class="op" id="7186505">[</span><span class="ident" id="7186506">i</span><span class="op" id="7186507">]</span>&nbsp;<span class="op" id="7186509">=</span>&nbsp;<span class="ident" id="7186511">CurveID</span><span class="op" id="7186518">(</span><span class="ident" id="7186519">rand</span><span class="op" id="7186523">.</span><span class="ident" id="7186524">Intn</span><span class="op" id="7186528">(</span><span class="num" id="7186529">30000</span><span class="op" id="7186534">)</span><span class="op" id="7186535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7186541">if</span>&nbsp;<span class="ident" id="7186544">rand</span><span class="op" id="7186548">.</span><span class="ident" id="7186549">Intn</span><span class="op" id="7186553">(</span><span class="num" id="7186554">10</span><span class="op" id="7186556">)</span>&nbsp;<span class="op" id="7186558">&gt;</span>&nbsp;<span class="num" id="7186560">5</span>&nbsp;<span class="op" id="7186562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186566">m</span><span class="op" id="7186567">.</span><span class="ident" id="7186568">ticketSupported</span>&nbsp;<span class="op" id="7186584">=</span>&nbsp;<span class="builtintype" id="7186586">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7186593">if</span>&nbsp;<span class="ident" id="7186596">rand</span><span class="op" id="7186600">.</span><span class="ident" id="7186601">Intn</span><span class="op" id="7186605">(</span><span class="num" id="7186606">10</span><span class="op" id="7186608">)</span>&nbsp;<span class="op" id="7186610">&gt;</span>&nbsp;<span class="num" id="7186612">5</span>&nbsp;<span class="op" id="7186614">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186619">m</span><span class="op" id="7186620">.</span><span class="ident" id="7186621">sessionTicket</span>&nbsp;<span class="op" id="7186635">=</span>&nbsp;<span class="ident" id="7186637">randomBytes</span><span class="op" id="7186648">(</span><span class="ident" id="7186649">rand</span><span class="op" id="7186653">.</span><span class="ident" id="7186654">Intn</span><span class="op" id="7186658">(</span><span class="num" id="7186659">300</span><span class="op" id="7186662">)</span><span class="op" id="7186663">,</span>&nbsp;<span class="ident" id="7186665">rand</span><span class="op" id="7186669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7186679">if</span>&nbsp;<span class="ident" id="7186682">rand</span><span class="op" id="7186686">.</span><span class="ident" id="7186687">Intn</span><span class="op" id="7186691">(</span><span class="num" id="7186692">10</span><span class="op" id="7186694">)</span>&nbsp;<span class="op" id="7186696">&gt;</span>&nbsp;<span class="num" id="7186698">5</span>&nbsp;<span class="op" id="7186700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186704">m</span><span class="op" id="7186705">.</span><span class="ident" id="7186706">signatureAndHashes</span>&nbsp;<span class="op" id="7186725">=</span>&nbsp;<span class="ident" id="7186727">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186763">m</span><span class="op" id="7186764">.</span><span class="ident" id="7186765">alpnProtocols</span>&nbsp;<span class="op" id="7186779">=</span>&nbsp;<span class="builtinfunc" id="7186781">make</span><span class="op" id="7186785">(</span><span class="op" id="7186786">[</span><span class="op" id="7186787">]</span><span class="builtintype" id="7186788">string</span><span class="op" id="7186794">,</span>&nbsp;<span class="ident" id="7186796">rand</span><span class="op" id="7186800">.</span><span class="ident" id="7186801">Intn</span><span class="op" id="7186805">(</span><span class="num" id="7186806">5</span><span class="op" id="7186807">)</span><span class="op" id="7186808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7186811">for</span>&nbsp;<span class="ident" id="7186815">i</span>&nbsp;<span class="op" id="7186817">:=</span>&nbsp;<span class="keyword" id="7186820">range</span>&nbsp;<span class="ident" id="7186826">m</span><span class="op" id="7186827">.</span><span class="ident" id="7186828">alpnProtocols</span>&nbsp;<span class="op" id="7186842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186846">m</span><span class="op" id="7186847">.</span><span class="ident" id="7186848">alpnProtocols</span><span class="op" id="7186861">[</span><span class="ident" id="7186862">i</span><span class="op" id="7186863">]</span>&nbsp;<span class="op" id="7186865">=</span>&nbsp;<span class="ident" id="7186867">randomString</span><span class="op" id="7186879">(</span><span class="ident" id="7186880">rand</span><span class="op" id="7186884">.</span><span class="ident" id="7186885">Intn</span><span class="op" id="7186889">(</span><span class="num" id="7186890">20</span><span class="op" id="7186892">)</span><span class="op" id="7186893">+</span><span class="num" id="7186894">1</span><span class="op" id="7186895">,</span>&nbsp;<span class="ident" id="7186897">rand</span><span class="op" id="7186901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186904">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7186908">return</span>&nbsp;<span class="ident" id="7186915">reflect</span><span class="op" id="7186922">.</span><span class="ident" id="7186923">ValueOf</span><span class="op" id="7186930">(</span><span class="ident" id="7186931">m</span><span class="op" id="7186932">)</span><br>
<span class="lineno"></span><span class="op" id="7186934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7186937">func</span>&nbsp;<span class="op" id="7186942">(</span><span class="op" id="7186943">*</span><span class="ident" id="7186944">serverHelloMsg</span><span class="op" id="7186958">)</span>&nbsp;<span class="ident" id="7186960">Generate</span><span class="op" id="7186968">(</span><span class="ident" id="7186969">rand</span>&nbsp;<span class="op" id="7186974">*</span><span class="ident" id="7186975">rand</span><span class="op" id="7186979">.</span><span class="ident" id="7186980">Rand</span><span class="op" id="7186984">,</span>&nbsp;<span class="ident" id="7186986">size</span>&nbsp;<span class="builtintype" id="7186991">int</span><span class="op" id="7186994">)</span>&nbsp;<span class="ident" id="7186996">reflect</span><span class="op" id="7187003">.</span><span class="ident" id="7187004">Value</span>&nbsp;<span class="op" id="7187010">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187013">m</span>&nbsp;<span class="op" id="7187015">:=</span>&nbsp;<span class="op" id="7187018">&amp;</span><span class="ident" id="7187019">serverHelloMsg</span><span class="op" id="7187033">{</span><span class="op" id="7187034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187037">m</span><span class="op" id="7187038">.</span><span class="ident" id="7187039">vers</span>&nbsp;<span class="op" id="7187044">=</span>&nbsp;<span class="builtintype" id="7187046">uint16</span><span class="op" id="7187052">(</span><span class="ident" id="7187053">rand</span><span class="op" id="7187057">.</span><span class="ident" id="7187058">Intn</span><span class="op" id="7187062">(</span><span class="num" id="7187063">65536</span><span class="op" id="7187068">)</span><span class="op" id="7187069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187072">m</span><span class="op" id="7187073">.</span><span class="ident" id="7187074">random</span>&nbsp;<span class="op" id="7187081">=</span>&nbsp;<span class="ident" id="7187083">randomBytes</span><span class="op" id="7187094">(</span><span class="num" id="7187095">32</span><span class="op" id="7187097">,</span>&nbsp;<span class="ident" id="7187099">rand</span><span class="op" id="7187103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187106">m</span><span class="op" id="7187107">.</span><span class="ident" id="7187108">sessionId</span>&nbsp;<span class="op" id="7187118">=</span>&nbsp;<span class="ident" id="7187120">randomBytes</span><span class="op" id="7187131">(</span><span class="ident" id="7187132">rand</span><span class="op" id="7187136">.</span><span class="ident" id="7187137">Intn</span><span class="op" id="7187141">(</span><span class="num" id="7187142">32</span><span class="op" id="7187144">)</span><span class="op" id="7187145">,</span>&nbsp;<span class="ident" id="7187147">rand</span><span class="op" id="7187151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187154">m</span><span class="op" id="7187155">.</span><span class="ident" id="7187156">cipherSuite</span>&nbsp;<span class="op" id="7187168">=</span>&nbsp;<span class="builtintype" id="7187170">uint16</span><span class="op" id="7187176">(</span><span class="ident" id="7187177">rand</span><span class="op" id="7187181">.</span><span class="ident" id="7187182">Int31</span><span class="op" id="7187187">(</span><span class="op" id="7187188">)</span><span class="op" id="7187189">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187192">m</span><span class="op" id="7187193">.</span><span class="ident" id="7187194">compressionMethod</span>&nbsp;<span class="op" id="7187212">=</span>&nbsp;<span class="builtintype" id="7187214">uint8</span><span class="op" id="7187219">(</span><span class="ident" id="7187220">rand</span><span class="op" id="7187224">.</span><span class="ident" id="7187225">Intn</span><span class="op" id="7187229">(</span><span class="num" id="7187230">256</span><span class="op" id="7187233">)</span><span class="op" id="7187234">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187238">if</span>&nbsp;<span class="ident" id="7187241">rand</span><span class="op" id="7187245">.</span><span class="ident" id="7187246">Intn</span><span class="op" id="7187250">(</span><span class="num" id="7187251">10</span><span class="op" id="7187253">)</span>&nbsp;<span class="op" id="7187255">&gt;</span>&nbsp;<span class="num" id="7187257">5</span>&nbsp;<span class="op" id="7187259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187263">m</span><span class="op" id="7187264">.</span><span class="ident" id="7187265">nextProtoNeg</span>&nbsp;<span class="op" id="7187278">=</span>&nbsp;<span class="builtintype" id="7187280">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187288">n</span>&nbsp;<span class="op" id="7187290">:=</span>&nbsp;<span class="ident" id="7187293">rand</span><span class="op" id="7187297">.</span><span class="ident" id="7187298">Intn</span><span class="op" id="7187302">(</span><span class="num" id="7187303">10</span><span class="op" id="7187305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187309">m</span><span class="op" id="7187310">.</span><span class="ident" id="7187311">nextProtos</span>&nbsp;<span class="op" id="7187322">=</span>&nbsp;<span class="builtinfunc" id="7187324">make</span><span class="op" id="7187328">(</span><span class="op" id="7187329">[</span><span class="op" id="7187330">]</span><span class="builtintype" id="7187331">string</span><span class="op" id="7187337">,</span>&nbsp;<span class="ident" id="7187339">n</span><span class="op" id="7187340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187344">for</span>&nbsp;<span class="ident" id="7187348">i</span>&nbsp;<span class="op" id="7187350">:=</span>&nbsp;<span class="num" id="7187353">0</span><span class="op" id="7187354">;</span>&nbsp;<span class="ident" id="7187356">i</span>&nbsp;<span class="op" id="7187358">&lt;</span>&nbsp;<span class="ident" id="7187360">n</span><span class="op" id="7187361">;</span>&nbsp;<span class="ident" id="7187363">i</span><span class="op" id="7187364">++</span>&nbsp;<span class="op" id="7187367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187372">m</span><span class="op" id="7187373">.</span><span class="ident" id="7187374">nextProtos</span><span class="op" id="7187384">[</span><span class="ident" id="7187385">i</span><span class="op" id="7187386">]</span>&nbsp;<span class="op" id="7187388">=</span>&nbsp;<span class="ident" id="7187390">randomString</span><span class="op" id="7187402">(</span><span class="num" id="7187403">20</span><span class="op" id="7187405">,</span>&nbsp;<span class="ident" id="7187407">rand</span><span class="op" id="7187411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187415">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187422">if</span>&nbsp;<span class="ident" id="7187425">rand</span><span class="op" id="7187429">.</span><span class="ident" id="7187430">Intn</span><span class="op" id="7187434">(</span><span class="num" id="7187435">10</span><span class="op" id="7187437">)</span>&nbsp;<span class="op" id="7187439">&gt;</span>&nbsp;<span class="num" id="7187441">5</span>&nbsp;<span class="op" id="7187443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187447">m</span><span class="op" id="7187448">.</span><span class="ident" id="7187449">ocspStapling</span>&nbsp;<span class="op" id="7187462">=</span>&nbsp;<span class="builtintype" id="7187464">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187470">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187473">if</span>&nbsp;<span class="ident" id="7187476">rand</span><span class="op" id="7187480">.</span><span class="ident" id="7187481">Intn</span><span class="op" id="7187485">(</span><span class="num" id="7187486">10</span><span class="op" id="7187488">)</span>&nbsp;<span class="op" id="7187490">&gt;</span>&nbsp;<span class="num" id="7187492">5</span>&nbsp;<span class="op" id="7187494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187498">m</span><span class="op" id="7187499">.</span><span class="ident" id="7187500">ticketSupported</span>&nbsp;<span class="op" id="7187516">=</span>&nbsp;<span class="builtintype" id="7187518">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187527">m</span><span class="op" id="7187528">.</span><span class="ident" id="7187529">alpnProtocol</span>&nbsp;<span class="op" id="7187542">=</span>&nbsp;<span class="ident" id="7187544">randomString</span><span class="op" id="7187556">(</span><span class="ident" id="7187557">rand</span><span class="op" id="7187561">.</span><span class="ident" id="7187562">Intn</span><span class="op" id="7187566">(</span><span class="num" id="7187567">32</span><span class="op" id="7187569">)</span><span class="op" id="7187570">+</span><span class="num" id="7187571">1</span><span class="op" id="7187572">,</span>&nbsp;<span class="ident" id="7187574">rand</span><span class="op" id="7187578">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187582">return</span>&nbsp;<span class="ident" id="7187589">reflect</span><span class="op" id="7187596">.</span><span class="ident" id="7187597">ValueOf</span><span class="op" id="7187604">(</span><span class="ident" id="7187605">m</span><span class="op" id="7187606">)</span><br>
<span class="lineno"></span><span class="op" id="7187608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7187611">func</span>&nbsp;<span class="op" id="7187616">(</span><span class="op" id="7187617">*</span><span class="ident" id="7187618">certificateMsg</span><span class="op" id="7187632">)</span>&nbsp;<span class="ident" id="7187634">Generate</span><span class="op" id="7187642">(</span><span class="ident" id="7187643">rand</span>&nbsp;<span class="op" id="7187648">*</span><span class="ident" id="7187649">rand</span><span class="op" id="7187653">.</span><span class="ident" id="7187654">Rand</span><span class="op" id="7187658">,</span>&nbsp;<span class="ident" id="7187660">size</span>&nbsp;<span class="builtintype" id="7187665">int</span><span class="op" id="7187668">)</span>&nbsp;<span class="ident" id="7187670">reflect</span><span class="op" id="7187677">.</span><span class="ident" id="7187678">Value</span>&nbsp;<span class="op" id="7187684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187687">m</span>&nbsp;<span class="op" id="7187689">:=</span>&nbsp;<span class="op" id="7187692">&amp;</span><span class="ident" id="7187693">certificateMsg</span><span class="op" id="7187707">{</span><span class="op" id="7187708">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187711">numCerts</span>&nbsp;<span class="op" id="7187720">:=</span>&nbsp;<span class="ident" id="7187723">rand</span><span class="op" id="7187727">.</span><span class="ident" id="7187728">Intn</span><span class="op" id="7187732">(</span><span class="num" id="7187733">20</span><span class="op" id="7187735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187738">m</span><span class="op" id="7187739">.</span><span class="ident" id="7187740">certificates</span>&nbsp;<span class="op" id="7187753">=</span>&nbsp;<span class="builtinfunc" id="7187755">make</span><span class="op" id="7187759">(</span><span class="op" id="7187760">[</span><span class="op" id="7187761">]</span><span class="op" id="7187762">[</span><span class="op" id="7187763">]</span><span class="builtintype" id="7187764">byte</span><span class="op" id="7187768">,</span>&nbsp;<span class="ident" id="7187770">numCerts</span><span class="op" id="7187778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187781">for</span>&nbsp;<span class="ident" id="7187785">i</span>&nbsp;<span class="op" id="7187787">:=</span>&nbsp;<span class="num" id="7187790">0</span><span class="op" id="7187791">;</span>&nbsp;<span class="ident" id="7187793">i</span>&nbsp;<span class="op" id="7187795">&lt;</span>&nbsp;<span class="ident" id="7187797">numCerts</span><span class="op" id="7187805">;</span>&nbsp;<span class="ident" id="7187807">i</span><span class="op" id="7187808">++</span>&nbsp;<span class="op" id="7187811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187815">m</span><span class="op" id="7187816">.</span><span class="ident" id="7187817">certificates</span><span class="op" id="7187829">[</span><span class="ident" id="7187830">i</span><span class="op" id="7187831">]</span>&nbsp;<span class="op" id="7187833">=</span>&nbsp;<span class="ident" id="7187835">randomBytes</span><span class="op" id="7187846">(</span><span class="ident" id="7187847">rand</span><span class="op" id="7187851">.</span><span class="ident" id="7187852">Intn</span><span class="op" id="7187856">(</span><span class="num" id="7187857">10</span><span class="op" id="7187859">)</span><span class="op" id="7187860">+</span><span class="num" id="7187861">1</span><span class="op" id="7187862">,</span>&nbsp;<span class="ident" id="7187864">rand</span><span class="op" id="7187868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187871">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187874">return</span>&nbsp;<span class="ident" id="7187881">reflect</span><span class="op" id="7187888">.</span><span class="ident" id="7187889">ValueOf</span><span class="op" id="7187896">(</span><span class="ident" id="7187897">m</span><span class="op" id="7187898">)</span><br>
<span class="lineno"></span><span class="op" id="7187900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7187903">func</span>&nbsp;<span class="op" id="7187908">(</span><span class="op" id="7187909">*</span><span class="ident" id="7187910">certificateRequestMsg</span><span class="op" id="7187931">)</span>&nbsp;<span class="ident" id="7187933">Generate</span><span class="op" id="7187941">(</span><span class="ident" id="7187942">rand</span>&nbsp;<span class="op" id="7187947">*</span><span class="ident" id="7187948">rand</span><span class="op" id="7187952">.</span><span class="ident" id="7187953">Rand</span><span class="op" id="7187957">,</span>&nbsp;<span class="ident" id="7187959">size</span>&nbsp;<span class="builtintype" id="7187964">int</span><span class="op" id="7187967">)</span>&nbsp;<span class="ident" id="7187969">reflect</span><span class="op" id="7187976">.</span><span class="ident" id="7187977">Value</span>&nbsp;<span class="op" id="7187983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187986">m</span>&nbsp;<span class="op" id="7187988">:=</span>&nbsp;<span class="op" id="7187991">&amp;</span><span class="ident" id="7187992">certificateRequestMsg</span><span class="op" id="7188013">{</span><span class="op" id="7188014">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188017">m</span><span class="op" id="7188018">.</span><span class="ident" id="7188019">certificateTypes</span>&nbsp;<span class="op" id="7188036">=</span>&nbsp;<span class="ident" id="7188038">randomBytes</span><span class="op" id="7188049">(</span><span class="ident" id="7188050">rand</span><span class="op" id="7188054">.</span><span class="ident" id="7188055">Intn</span><span class="op" id="7188059">(</span><span class="num" id="7188060">5</span><span class="op" id="7188061">)</span><span class="op" id="7188062">+</span><span class="num" id="7188063">1</span><span class="op" id="7188064">,</span>&nbsp;<span class="ident" id="7188066">rand</span><span class="op" id="7188070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188073">numCAs</span>&nbsp;<span class="op" id="7188080">:=</span>&nbsp;<span class="ident" id="7188083">rand</span><span class="op" id="7188087">.</span><span class="ident" id="7188088">Intn</span><span class="op" id="7188092">(</span><span class="num" id="7188093">100</span><span class="op" id="7188096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188099">m</span><span class="op" id="7188100">.</span><span class="ident" id="7188101">certificateAuthorities</span>&nbsp;<span class="op" id="7188124">=</span>&nbsp;<span class="builtinfunc" id="7188126">make</span><span class="op" id="7188130">(</span><span class="op" id="7188131">[</span><span class="op" id="7188132">]</span><span class="op" id="7188133">[</span><span class="op" id="7188134">]</span><span class="builtintype" id="7188135">byte</span><span class="op" id="7188139">,</span>&nbsp;<span class="ident" id="7188141">numCAs</span><span class="op" id="7188147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188150">for</span>&nbsp;<span class="ident" id="7188154">i</span>&nbsp;<span class="op" id="7188156">:=</span>&nbsp;<span class="num" id="7188159">0</span><span class="op" id="7188160">;</span>&nbsp;<span class="ident" id="7188162">i</span>&nbsp;<span class="op" id="7188164">&lt;</span>&nbsp;<span class="ident" id="7188166">numCAs</span><span class="op" id="7188172">;</span>&nbsp;<span class="ident" id="7188174">i</span><span class="op" id="7188175">++</span>&nbsp;<span class="op" id="7188178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188182">m</span><span class="op" id="7188183">.</span><span class="ident" id="7188184">certificateAuthorities</span><span class="op" id="7188206">[</span><span class="ident" id="7188207">i</span><span class="op" id="7188208">]</span>&nbsp;<span class="op" id="7188210">=</span>&nbsp;<span class="ident" id="7188212">randomBytes</span><span class="op" id="7188223">(</span><span class="ident" id="7188224">rand</span><span class="op" id="7188228">.</span><span class="ident" id="7188229">Intn</span><span class="op" id="7188233">(</span><span class="num" id="7188234">15</span><span class="op" id="7188236">)</span><span class="op" id="7188237">+</span><span class="num" id="7188238">1</span><span class="op" id="7188239">,</span>&nbsp;<span class="ident" id="7188241">rand</span><span class="op" id="7188245">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188251">return</span>&nbsp;<span class="ident" id="7188258">reflect</span><span class="op" id="7188265">.</span><span class="ident" id="7188266">ValueOf</span><span class="op" id="7188273">(</span><span class="ident" id="7188274">m</span><span class="op" id="7188275">)</span><br>
<span class="lineno"></span><span class="op" id="7188277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7188280">func</span>&nbsp;<span class="op" id="7188285">(</span><span class="op" id="7188286">*</span><span class="ident" id="7188287">certificateVerifyMsg</span><span class="op" id="7188307">)</span>&nbsp;<span class="ident" id="7188309">Generate</span><span class="op" id="7188317">(</span><span class="ident" id="7188318">rand</span>&nbsp;<span class="op" id="7188323">*</span><span class="ident" id="7188324">rand</span><span class="op" id="7188328">.</span><span class="ident" id="7188329">Rand</span><span class="op" id="7188333">,</span>&nbsp;<span class="ident" id="7188335">size</span>&nbsp;<span class="builtintype" id="7188340">int</span><span class="op" id="7188343">)</span>&nbsp;<span class="ident" id="7188345">reflect</span><span class="op" id="7188352">.</span><span class="ident" id="7188353">Value</span>&nbsp;<span class="op" id="7188359">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188362">m</span>&nbsp;<span class="op" id="7188364">:=</span>&nbsp;<span class="op" id="7188367">&amp;</span><span class="ident" id="7188368">certificateVerifyMsg</span><span class="op" id="7188388">{</span><span class="op" id="7188389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188392">m</span><span class="op" id="7188393">.</span><span class="ident" id="7188394">signature</span>&nbsp;<span class="op" id="7188404">=</span>&nbsp;<span class="ident" id="7188406">randomBytes</span><span class="op" id="7188417">(</span><span class="ident" id="7188418">rand</span><span class="op" id="7188422">.</span><span class="ident" id="7188423">Intn</span><span class="op" id="7188427">(</span><span class="num" id="7188428">15</span><span class="op" id="7188430">)</span><span class="op" id="7188431">+</span><span class="num" id="7188432">1</span><span class="op" id="7188433">,</span>&nbsp;<span class="ident" id="7188435">rand</span><span class="op" id="7188439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188442">return</span>&nbsp;<span class="ident" id="7188449">reflect</span><span class="op" id="7188456">.</span><span class="ident" id="7188457">ValueOf</span><span class="op" id="7188464">(</span><span class="ident" id="7188465">m</span><span class="op" id="7188466">)</span><br>
<span class="lineno"></span><span class="op" id="7188468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="7188471">func</span>&nbsp;<span class="op" id="7188476">(</span><span class="op" id="7188477">*</span><span class="ident" id="7188478">certificateStatusMsg</span><span class="op" id="7188498">)</span>&nbsp;<span class="ident" id="7188500">Generate</span><span class="op" id="7188508">(</span><span class="ident" id="7188509">rand</span>&nbsp;<span class="op" id="7188514">*</span><span class="ident" id="7188515">rand</span><span class="op" id="7188519">.</span><span class="ident" id="7188520">Rand</span><span class="op" id="7188524">,</span>&nbsp;<span class="ident" id="7188526">size</span>&nbsp;<span class="builtintype" id="7188531">int</span><span class="op" id="7188534">)</span>&nbsp;<span class="ident" id="7188536">reflect</span><span class="op" id="7188543">.</span><span class="ident" id="7188544">Value</span>&nbsp;<span class="op" id="7188550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188553">m</span>&nbsp;<span class="op" id="7188555">:=</span>&nbsp;<span class="op" id="7188558">&amp;</span><span class="ident" id="7188559">certificateStatusMsg</span><span class="op" id="7188579">{</span><span class="op" id="7188580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188583">if</span>&nbsp;<span class="ident" id="7188586">rand</span><span class="op" id="7188590">.</span><span class="ident" id="7188591">Intn</span><span class="op" id="7188595">(</span><span class="num" id="7188596">10</span><span class="op" id="7188598">)</span>&nbsp;<span class="op" id="7188600">&gt;</span>&nbsp;<span class="num" id="7188602">5</span>&nbsp;<span class="op" id="7188604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188608">m</span><span class="op" id="7188609">.</span><span class="ident" id="7188610">statusType</span>&nbsp;<span class="op" id="7188621">=</span>&nbsp;<span class="ident" id="7188623">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188640">m</span><span class="op" id="7188641">.</span><span class="ident" id="7188642">response</span>&nbsp;<span class="op" id="7188651">=</span>&nbsp;<span class="ident" id="7188653">randomBytes</span><span class="op" id="7188664">(</span><span class="ident" id="7188665">rand</span><span class="op" id="7188669">.</span><span class="ident" id="7188670">Intn</span><span class="op" id="7188674">(</span><span class="num" id="7188675">10</span><span class="op" id="7188677">)</span><span class="op" id="7188678">+</span><span class="num" id="7188679">1</span><span class="op" id="7188680">,</span>&nbsp;<span class="ident" id="7188682">rand</span><span class="op" id="7188686">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188689">}</span>&nbsp;<span class="keyword" id="7188691">else</span>&nbsp;<span class="op" id="7188696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188700">m</span><span class="op" id="7188701">.</span><span class="ident" id="7188702">statusType</span>&nbsp;<span class="op" id="7188713">=</span>&nbsp;<span class="num" id="7188715">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188722">return</span>&nbsp;<span class="ident" id="7188729">reflect</span><span class="op" id="7188736">.</span><span class="ident" id="7188737">ValueOf</span><span class="op" id="7188744">(</span><span class="ident" id="7188745">m</span><span class="op" id="7188746">)</span><br>
<span class="lineno"></span><span class="op" id="7188748">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7188751">func</span>&nbsp;<span class="op" id="7188756">(</span><span class="op" id="7188757">*</span><span class="ident" id="7188758">clientKeyExchangeMsg</span><span class="op" id="7188778">)</span>&nbsp;<span class="ident" id="7188780">Generate</span><span class="op" id="7188788">(</span><span class="ident" id="7188789">rand</span>&nbsp;<span class="op" id="7188794">*</span><span class="ident" id="7188795">rand</span><span class="op" id="7188799">.</span><span class="ident" id="7188800">Rand</span><span class="op" id="7188804">,</span>&nbsp;<span class="ident" id="7188806">size</span>&nbsp;<span class="builtintype" id="7188811">int</span><span class="op" id="7188814">)</span>&nbsp;<span class="ident" id="7188816">reflect</span><span class="op" id="7188823">.</span><span class="ident" id="7188824">Value</span>&nbsp;<span class="op" id="7188830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188833">m</span>&nbsp;<span class="op" id="7188835">:=</span>&nbsp;<span class="op" id="7188838">&amp;</span><span class="ident" id="7188839">clientKeyExchangeMsg</span><span class="op" id="7188859">{</span><span class="op" id="7188860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188863">m</span><span class="op" id="7188864">.</span><span class="ident" id="7188865">ciphertext</span>&nbsp;<span class="op" id="7188876">=</span>&nbsp;<span class="ident" id="7188878">randomBytes</span><span class="op" id="7188889">(</span><span class="ident" id="7188890">rand</span><span class="op" id="7188894">.</span><span class="ident" id="7188895">Intn</span><span class="op" id="7188899">(</span><span class="num" id="7188900">1000</span><span class="op" id="7188904">)</span><span class="op" id="7188905">+</span><span class="num" id="7188906">1</span><span class="op" id="7188907">,</span>&nbsp;<span class="ident" id="7188909">rand</span><span class="op" id="7188913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188916">return</span>&nbsp;<span class="ident" id="7188923">reflect</span><span class="op" id="7188930">.</span><span class="ident" id="7188931">ValueOf</span><span class="op" id="7188938">(</span><span class="ident" id="7188939">m</span><span class="op" id="7188940">)</span><br>
<span class="lineno">220</span><span class="op" id="7188942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7188945">func</span>&nbsp;<span class="op" id="7188950">(</span><span class="op" id="7188951">*</span><span class="ident" id="7188952">finishedMsg</span><span class="op" id="7188963">)</span>&nbsp;<span class="ident" id="7188965">Generate</span><span class="op" id="7188973">(</span><span class="ident" id="7188974">rand</span>&nbsp;<span class="op" id="7188979">*</span><span class="ident" id="7188980">rand</span><span class="op" id="7188984">.</span><span class="ident" id="7188985">Rand</span><span class="op" id="7188989">,</span>&nbsp;<span class="ident" id="7188991">size</span>&nbsp;<span class="builtintype" id="7188996">int</span><span class="op" id="7188999">)</span>&nbsp;<span class="ident" id="7189001">reflect</span><span class="op" id="7189008">.</span><span class="ident" id="7189009">Value</span>&nbsp;<span class="op" id="7189015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189018">m</span>&nbsp;<span class="op" id="7189020">:=</span>&nbsp;<span class="op" id="7189023">&amp;</span><span class="ident" id="7189024">finishedMsg</span><span class="op" id="7189035">{</span><span class="op" id="7189036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189039">m</span><span class="op" id="7189040">.</span><span class="ident" id="7189041">verifyData</span>&nbsp;<span class="op" id="7189052">=</span>&nbsp;<span class="ident" id="7189054">randomBytes</span><span class="op" id="7189065">(</span><span class="num" id="7189066">12</span><span class="op" id="7189068">,</span>&nbsp;<span class="ident" id="7189070">rand</span><span class="op" id="7189074">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7189077">return</span>&nbsp;<span class="ident" id="7189084">reflect</span><span class="op" id="7189091">.</span><span class="ident" id="7189092">ValueOf</span><span class="op" id="7189099">(</span><span class="ident" id="7189100">m</span><span class="op" id="7189101">)</span><br>
<span class="lineno"></span><span class="op" id="7189103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7189106">func</span>&nbsp;<span class="op" id="7189111">(</span><span class="op" id="7189112">*</span><span class="ident" id="7189113">nextProtoMsg</span><span class="op" id="7189125">)</span>&nbsp;<span class="ident" id="7189127">Generate</span><span class="op" id="7189135">(</span><span class="ident" id="7189136">rand</span>&nbsp;<span class="op" id="7189141">*</span><span class="ident" id="7189142">rand</span><span class="op" id="7189146">.</span><span class="ident" id="7189147">Rand</span><span class="op" id="7189151">,</span>&nbsp;<span class="ident" id="7189153">size</span>&nbsp;<span class="builtintype" id="7189158">int</span><span class="op" id="7189161">)</span>&nbsp;<span class="ident" id="7189163">reflect</span><span class="op" id="7189170">.</span><span class="ident" id="7189171">Value</span>&nbsp;<span class="op" id="7189177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189180">m</span>&nbsp;<span class="op" id="7189182">:=</span>&nbsp;<span class="op" id="7189185">&amp;</span><span class="ident" id="7189186">nextProtoMsg</span><span class="op" id="7189198">{</span><span class="op" id="7189199">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189202">m</span><span class="op" id="7189203">.</span><span class="ident" id="7189204">proto</span>&nbsp;<span class="op" id="7189210">=</span>&nbsp;<span class="ident" id="7189212">randomString</span><span class="op" id="7189224">(</span><span class="ident" id="7189225">rand</span><span class="op" id="7189229">.</span><span class="ident" id="7189230">Intn</span><span class="op" id="7189234">(</span><span class="num" id="7189235">255</span><span class="op" id="7189238">)</span><span class="op" id="7189239">,</span>&nbsp;<span class="ident" id="7189241">rand</span><span class="op" id="7189245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7189248">return</span>&nbsp;<span class="ident" id="7189255">reflect</span><span class="op" id="7189262">.</span><span class="ident" id="7189263">ValueOf</span><span class="op" id="7189270">(</span><span class="ident" id="7189271">m</span><span class="op" id="7189272">)</span><br>
<span class="lineno"></span><span class="op" id="7189274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7189277">func</span>&nbsp;<span class="op" id="7189282">(</span><span class="op" id="7189283">*</span><span class="ident" id="7189284">newSessionTicketMsg</span><span class="op" id="7189303">)</span>&nbsp;<span class="ident" id="7189305">Generate</span><span class="op" id="7189313">(</span><span class="ident" id="7189314">rand</span>&nbsp;<span class="op" id="7189319">*</span><span class="ident" id="7189320">rand</span><span class="op" id="7189324">.</span><span class="ident" id="7189325">Rand</span><span class="op" id="7189329">,</span>&nbsp;<span class="ident" id="7189331">size</span>&nbsp;<span class="builtintype" id="7189336">int</span><span class="op" id="7189339">)</span>&nbsp;<span class="ident" id="7189341">reflect</span><span class="op" id="7189348">.</span><span class="ident" id="7189349">Value</span>&nbsp;<span class="op" id="7189355">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189358">m</span>&nbsp;<span class="op" id="7189360">:=</span>&nbsp;<span class="op" id="7189363">&amp;</span><span class="ident" id="7189364">newSessionTicketMsg</span><span class="op" id="7189383">{</span><span class="op" id="7189384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189387">m</span><span class="op" id="7189388">.</span><span class="ident" id="7189389">ticket</span>&nbsp;<span class="op" id="7189396">=</span>&nbsp;<span class="ident" id="7189398">randomBytes</span><span class="op" id="7189409">(</span><span class="ident" id="7189410">rand</span><span class="op" id="7189414">.</span><span class="ident" id="7189415">Intn</span><span class="op" id="7189419">(</span><span class="num" id="7189420">4</span><span class="op" id="7189421">)</span><span class="op" id="7189422">,</span>&nbsp;<span class="ident" id="7189424">rand</span><span class="op" id="7189428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7189431">return</span>&nbsp;<span class="ident" id="7189438">reflect</span><span class="op" id="7189445">.</span><span class="ident" id="7189446">ValueOf</span><span class="op" id="7189453">(</span><span class="ident" id="7189454">m</span><span class="op" id="7189455">)</span><br>
<span class="lineno"></span><span class="op" id="7189457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7189460">func</span>&nbsp;<span class="op" id="7189465">(</span><span class="op" id="7189466">*</span><span class="ident" id="7189467">sessionState</span><span class="op" id="7189479">)</span>&nbsp;<span class="ident" id="7189481">Generate</span><span class="op" id="7189489">(</span><span class="ident" id="7189490">rand</span>&nbsp;<span class="op" id="7189495">*</span><span class="ident" id="7189496">rand</span><span class="op" id="7189500">.</span><span class="ident" id="7189501">Rand</span><span class="op" id="7189505">,</span>&nbsp;<span class="ident" id="7189507">size</span>&nbsp;<span class="builtintype" id="7189512">int</span><span class="op" id="7189515">)</span>&nbsp;<span class="ident" id="7189517">reflect</span><span class="op" id="7189524">.</span><span class="ident" id="7189525">Value</span>&nbsp;<span class="op" id="7189531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189534">s</span>&nbsp;<span class="op" id="7189536">:=</span>&nbsp;<span class="op" id="7189539">&amp;</span><span class="ident" id="7189540">sessionState</span><span class="op" id="7189552">{</span><span class="op" id="7189553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189556">s</span><span class="op" id="7189557">.</span><span class="ident" id="7189558">vers</span>&nbsp;<span class="op" id="7189563">=</span>&nbsp;<span class="builtintype" id="7189565">uint16</span><span class="op" id="7189571">(</span><span class="ident" id="7189572">rand</span><span class="op" id="7189576">.</span><span class="ident" id="7189577">Intn</span><span class="op" id="7189581">(</span><span class="num" id="7189582">10000</span><span class="op" id="7189587">)</span><span class="op" id="7189588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189591">s</span><span class="op" id="7189592">.</span><span class="ident" id="7189593">cipherSuite</span>&nbsp;<span class="op" id="7189605">=</span>&nbsp;<span class="builtintype" id="7189607">uint16</span><span class="op" id="7189613">(</span><span class="ident" id="7189614">rand</span><span class="op" id="7189618">.</span><span class="ident" id="7189619">Intn</span><span class="op" id="7189623">(</span><span class="num" id="7189624">10000</span><span class="op" id="7189629">)</span><span class="op" id="7189630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189633">s</span><span class="op" id="7189634">.</span><span class="ident" id="7189635">masterSecret</span>&nbsp;<span class="op" id="7189648">=</span>&nbsp;<span class="ident" id="7189650">randomBytes</span><span class="op" id="7189661">(</span><span class="ident" id="7189662">rand</span><span class="op" id="7189666">.</span><span class="ident" id="7189667">Intn</span><span class="op" id="7189671">(</span><span class="num" id="7189672">100</span><span class="op" id="7189675">)</span><span class="op" id="7189676">,</span>&nbsp;<span class="ident" id="7189678">rand</span><span class="op" id="7189682">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189685">numCerts</span>&nbsp;<span class="op" id="7189694">:=</span>&nbsp;<span class="ident" id="7189697">rand</span><span class="op" id="7189701">.</span><span class="ident" id="7189702">Intn</span><span class="op" id="7189706">(</span><span class="num" id="7189707">20</span><span class="op" id="7189709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189712">s</span><span class="op" id="7189713">.</span><span class="ident" id="7189714">certificates</span>&nbsp;<span class="op" id="7189727">=</span>&nbsp;<span class="builtinfunc" id="7189729">make</span><span class="op" id="7189733">(</span><span class="op" id="7189734">[</span><span class="op" id="7189735">]</span><span class="op" id="7189736">[</span><span class="op" id="7189737">]</span><span class="builtintype" id="7189738">byte</span><span class="op" id="7189742">,</span>&nbsp;<span class="ident" id="7189744">numCerts</span><span class="op" id="7189752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7189755">for</span>&nbsp;<span class="ident" id="7189759">i</span>&nbsp;<span class="op" id="7189761">:=</span>&nbsp;<span class="num" id="7189764">0</span><span class="op" id="7189765">;</span>&nbsp;<span class="ident" id="7189767">i</span>&nbsp;<span class="op" id="7189769">&lt;</span>&nbsp;<span class="ident" id="7189771">numCerts</span><span class="op" id="7189779">;</span>&nbsp;<span class="ident" id="7189781">i</span><span class="op" id="7189782">++</span>&nbsp;<span class="op" id="7189785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189789">s</span><span class="op" id="7189790">.</span><span class="ident" id="7189791">certificates</span><span class="op" id="7189803">[</span><span class="ident" id="7189804">i</span><span class="op" id="7189805">]</span>&nbsp;<span class="op" id="7189807">=</span>&nbsp;<span class="ident" id="7189809">randomBytes</span><span class="op" id="7189820">(</span><span class="ident" id="7189821">rand</span><span class="op" id="7189825">.</span><span class="ident" id="7189826">Intn</span><span class="op" id="7189830">(</span><span class="num" id="7189831">10</span><span class="op" id="7189833">)</span><span class="op" id="7189834">+</span><span class="num" id="7189835">1</span><span class="op" id="7189836">,</span>&nbsp;<span class="ident" id="7189838">rand</span><span class="op" id="7189842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7189845">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7189848">return</span>&nbsp;<span class="ident" id="7189855">reflect</span><span class="op" id="7189862">.</span><span class="ident" id="7189863">ValueOf</span><span class="op" id="7189870">(</span><span class="ident" id="7189871">s</span><span class="op" id="7189872">)</span><br>
<span class="lineno"></span><span class="op" id="7189874">}</span>
</div>
</body>
</html>
