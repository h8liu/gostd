<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2637417">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2637472">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2637526">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2637577">package</span>&nbsp;<span class="ident" id="2637585">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2637591">import</span>&nbsp;<span class="op" id="2637598">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2637601">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2637609">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2637619">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2637622">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2637688">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2637757">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2637832">type</span>&nbsp;<span class="ident" id="2637837">Location</span>&nbsp;<span class="keyword" id="2637846">struct</span>&nbsp;<span class="op" id="2637853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637856">name</span>&nbsp;<span class="builtintype" id="2637861">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637869">zone</span>&nbsp;<span class="op" id="2637874">[</span><span class="op" id="2637875">]</span><span class="ident" id="2637876">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637882">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2637887">[</span><span class="op" id="2637888">]</span><span class="ident" id="2637889">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2637901">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2637948">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2637998">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638050">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638103">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638139">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638172">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638226">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638279">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638294">cacheStart</span>&nbsp;<span class="ident" id="2638305">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638312">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2638323">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638330">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2638341">*</span><span class="ident" id="2638342">zone</span><br>
<span class="lineno"></span><span class="op" id="2638347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2638350">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2638411">type</span>&nbsp;<span class="ident" id="2638416">zone</span>&nbsp;<span class="keyword" id="2638421">struct</span>&nbsp;<span class="op" id="2638428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638431">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2638438">string</span>&nbsp;<span class="comment" id="2638445">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638473">offset</span>&nbsp;<span class="builtintype" id="2638480">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2638487">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638511">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2638518">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2638525">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2638564">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2638567">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2638624">type</span>&nbsp;<span class="ident" id="2638629">zoneTrans</span>&nbsp;<span class="keyword" id="2638639">struct</span>&nbsp;<span class="op" id="2638646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638649">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2638662">int64</span>&nbsp;<span class="comment" id="2638668">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638715">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2638728">uint8</span>&nbsp;<span class="comment" id="2638734">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638795">isstd</span><span class="op" id="2638800">,</span>&nbsp;<span class="ident" id="2638802">isutc</span>&nbsp;<span class="builtintype" id="2638808">bool</span>&nbsp;&nbsp;<span class="comment" id="2638814">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2638851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2638854">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2638916">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2638932">const</span>&nbsp;<span class="op" id="2638938">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638941">alpha</span>&nbsp;<span class="op" id="2638947">=</span>&nbsp;<span class="op" id="2638949">-</span><span class="num" id="2638950">1</span>&nbsp;<span class="op" id="2638952">&lt;&lt;</span>&nbsp;<span class="num" id="2638955">63</span>&nbsp;&nbsp;<span class="comment" id="2638959">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638977">omega</span>&nbsp;<span class="op" id="2638983">=</span>&nbsp;<span class="num" id="2638985">1</span><span class="op" id="2638986">&lt;&lt;</span><span class="num" id="2638988">63</span>&nbsp;<span class="op" id="2638991">-</span>&nbsp;<span class="num" id="2638993">1</span>&nbsp;<span class="comment" id="2638995">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2639012">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2639015">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2639067">var</span>&nbsp;<span class="ident" id="2639071">UTC</span>&nbsp;<span class="op" id="2639075">*</span><span class="ident" id="2639076">Location</span>&nbsp;<span class="op" id="2639085">=</span>&nbsp;<span class="op" id="2639087">&amp;</span><span class="ident" id="2639088">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2639096">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2639151">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2639204">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2639255">var</span>&nbsp;<span class="ident" id="2639259">utcLoc</span>&nbsp;<span class="op" id="2639266">=</span>&nbsp;<span class="ident" id="2639268">Location</span><span class="op" id="2639276">{</span><span class="ident" id="2639277">name</span><span class="op" id="2639281">:</span>&nbsp;<span class="string" id="2639283">&#34;UTC&#34;</span><span class="op" id="2639288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2639291">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2639341">var</span>&nbsp;<span class="ident" id="2639345">Local</span>&nbsp;<span class="op" id="2639351">*</span><span class="ident" id="2639352">Location</span>&nbsp;<span class="op" id="2639361">=</span>&nbsp;<span class="op" id="2639363">&amp;</span><span class="ident" id="2639364">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2639374">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2639431">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2639473">var</span>&nbsp;<span class="ident" id="2639477">localLoc</span>&nbsp;<span class="ident" id="2639486">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2639495">var</span>&nbsp;<span class="ident" id="2639499">localOnce</span>&nbsp;<span class="ident" id="2639509">sync</span><span class="op" id="2639513">.</span><span class="ident" id="2639514">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2639520">func</span>&nbsp;<span class="op" id="2639525">(</span><span class="ident" id="2639526">l</span>&nbsp;<span class="op" id="2639528">*</span><span class="ident" id="2639529">Location</span><span class="op" id="2639537">)</span>&nbsp;<span class="ident" id="2639539">get</span><span class="op" id="2639542">(</span><span class="op" id="2639543">)</span>&nbsp;<span class="op" id="2639545">*</span><span class="ident" id="2639546">Location</span>&nbsp;<span class="op" id="2639555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639558">if</span>&nbsp;<span class="ident" id="2639561">l</span>&nbsp;<span class="op" id="2639563">==</span>&nbsp;<span class="ident" id="2639566">nil</span>&nbsp;<span class="op" id="2639570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639574">return</span>&nbsp;<span class="op" id="2639581">&amp;</span><span class="ident" id="2639582">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2639590">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639593">if</span>&nbsp;<span class="ident" id="2639596">l</span>&nbsp;<span class="op" id="2639598">==</span>&nbsp;<span class="op" id="2639601">&amp;</span><span class="ident" id="2639602">localLoc</span>&nbsp;<span class="op" id="2639611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639615">localOnce</span><span class="op" id="2639624">.</span><span class="ident" id="2639625">Do</span><span class="op" id="2639627">(</span><span class="ident" id="2639628">initLocal</span><span class="op" id="2639637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2639640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639643">return</span>&nbsp;<span class="ident" id="2639650">l</span><br>
<span class="lineno"></span><span class="op" id="2639652">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2639655">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2639723">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2639773">func</span>&nbsp;<span class="op" id="2639778">(</span><span class="ident" id="2639779">l</span>&nbsp;<span class="op" id="2639781">*</span><span class="ident" id="2639782">Location</span><span class="op" id="2639790">)</span>&nbsp;<span class="ident" id="2639792">String</span><span class="op" id="2639798">(</span><span class="op" id="2639799">)</span>&nbsp;<span class="builtintype" id="2639801">string</span>&nbsp;<span class="op" id="2639808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639811">return</span>&nbsp;<span class="ident" id="2639818">l</span><span class="op" id="2639819">.</span><span class="ident" id="2639820">get</span><span class="op" id="2639823">(</span><span class="op" id="2639824">)</span><span class="op" id="2639825">.</span><span class="ident" id="2639826">name</span><br>
<span class="lineno">85</span><span class="op" id="2639831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2639834">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2639883">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2639940">func</span>&nbsp;<span class="ident" id="2639945">FixedZone</span><span class="op" id="2639954">(</span><span class="ident" id="2639955">name</span>&nbsp;<span class="builtintype" id="2639960">string</span><span class="op" id="2639966">,</span>&nbsp;<span class="ident" id="2639968">offset</span>&nbsp;<span class="builtintype" id="2639975">int</span><span class="op" id="2639978">)</span>&nbsp;<span class="op" id="2639980">*</span><span class="ident" id="2639981">Location</span>&nbsp;<span class="op" id="2639990">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639993">l</span>&nbsp;<span class="op" id="2639995">:=</span>&nbsp;<span class="op" id="2639998">&amp;</span><span class="ident" id="2639999">Location</span><span class="op" id="2640007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640011">name</span><span class="op" id="2640015">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2640023">name</span><span class="op" id="2640027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640031">zone</span><span class="op" id="2640035">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2640043">[</span><span class="op" id="2640044">]</span><span class="ident" id="2640045">zone</span><span class="op" id="2640049">{</span><span class="op" id="2640050">{</span><span class="ident" id="2640051">name</span><span class="op" id="2640055">,</span>&nbsp;<span class="ident" id="2640057">offset</span><span class="op" id="2640063">,</span>&nbsp;<span class="builtintype" id="2640065">false</span><span class="op" id="2640070">}</span><span class="op" id="2640071">}</span><span class="op" id="2640072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640076">tx</span><span class="op" id="2640078">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2640088">[</span><span class="op" id="2640089">]</span><span class="ident" id="2640090">zoneTrans</span><span class="op" id="2640099">{</span><span class="op" id="2640100">{</span><span class="ident" id="2640101">alpha</span><span class="op" id="2640106">,</span>&nbsp;<span class="num" id="2640108">0</span><span class="op" id="2640109">,</span>&nbsp;<span class="builtintype" id="2640111">false</span><span class="op" id="2640116">,</span>&nbsp;<span class="builtintype" id="2640118">false</span><span class="op" id="2640123">}</span><span class="op" id="2640124">}</span><span class="op" id="2640125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640129">cacheStart</span><span class="op" id="2640139">:</span>&nbsp;<span class="ident" id="2640141">alpha</span><span class="op" id="2640146">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640150">cacheEnd</span><span class="op" id="2640158">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2640162">omega</span><span class="op" id="2640167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2640170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640173">l</span><span class="op" id="2640174">.</span><span class="ident" id="2640175">cacheZone</span>&nbsp;<span class="op" id="2640185">=</span>&nbsp;<span class="op" id="2640187">&amp;</span><span class="ident" id="2640188">l</span><span class="op" id="2640189">.</span><span class="ident" id="2640190">zone</span><span class="op" id="2640194">[</span><span class="num" id="2640195">0</span><span class="op" id="2640196">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2640199">return</span>&nbsp;<span class="ident" id="2640206">l</span><br>
<span class="lineno"></span><span class="op" id="2640208">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2640211">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2640274">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2640350">//</span><br>
<span class="lineno"></span><span class="comment" id="2640353">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2640425">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2640496">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2640565">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2640621">func</span>&nbsp;<span class="op" id="2640626">(</span><span class="ident" id="2640627">l</span>&nbsp;<span class="op" id="2640629">*</span><span class="ident" id="2640630">Location</span><span class="op" id="2640638">)</span>&nbsp;<span class="ident" id="2640640">lookup</span><span class="op" id="2640646">(</span><span class="ident" id="2640647">sec</span>&nbsp;<span class="ident" id="2640651">int64</span><span class="op" id="2640656">)</span>&nbsp;<span class="op" id="2640658">(</span><span class="ident" id="2640659">name</span>&nbsp;<span class="builtintype" id="2640664">string</span><span class="op" id="2640670">,</span>&nbsp;<span class="ident" id="2640672">offset</span>&nbsp;<span class="builtintype" id="2640679">int</span><span class="op" id="2640682">,</span>&nbsp;<span class="ident" id="2640684">isDST</span>&nbsp;<span class="builtintype" id="2640690">bool</span><span class="op" id="2640694">,</span>&nbsp;<span class="ident" id="2640696">start</span><span class="op" id="2640701">,</span>&nbsp;<span class="ident" id="2640703">end</span>&nbsp;<span class="ident" id="2640707">int64</span><span class="op" id="2640712">)</span>&nbsp;<span class="op" id="2640714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640717">l</span>&nbsp;<span class="op" id="2640719">=</span>&nbsp;<span class="ident" id="2640721">l</span><span class="op" id="2640722">.</span><span class="ident" id="2640723">get</span><span class="op" id="2640726">(</span><span class="op" id="2640727">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2640731">if</span>&nbsp;<span class="builtinfunc" id="2640734">len</span><span class="op" id="2640737">(</span><span class="ident" id="2640738">l</span><span class="op" id="2640739">.</span><span class="ident" id="2640740">zone</span><span class="op" id="2640744">)</span>&nbsp;<span class="op" id="2640746">==</span>&nbsp;<span class="num" id="2640749">0</span>&nbsp;<span class="op" id="2640751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640755">name</span>&nbsp;<span class="op" id="2640760">=</span>&nbsp;<span class="string" id="2640762">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640770">offset</span>&nbsp;<span class="op" id="2640777">=</span>&nbsp;<span class="num" id="2640779">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640783">isDST</span>&nbsp;<span class="op" id="2640789">=</span>&nbsp;<span class="builtintype" id="2640791">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640799">start</span>&nbsp;<span class="op" id="2640805">=</span>&nbsp;<span class="ident" id="2640807">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640815">end</span>&nbsp;<span class="op" id="2640819">=</span>&nbsp;<span class="ident" id="2640821">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2640829">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2640837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2640841">if</span>&nbsp;<span class="ident" id="2640844">zone</span>&nbsp;<span class="op" id="2640849">:=</span>&nbsp;<span class="ident" id="2640852">l</span><span class="op" id="2640853">.</span><span class="ident" id="2640854">cacheZone</span><span class="op" id="2640863">;</span>&nbsp;<span class="ident" id="2640865">zone</span>&nbsp;<span class="op" id="2640870">!=</span>&nbsp;<span class="ident" id="2640873">nil</span>&nbsp;<span class="op" id="2640877">&amp;&amp;</span>&nbsp;<span class="ident" id="2640880">l</span><span class="op" id="2640881">.</span><span class="ident" id="2640882">cacheStart</span>&nbsp;<span class="op" id="2640893">&lt;=</span>&nbsp;<span class="ident" id="2640896">sec</span>&nbsp;<span class="op" id="2640900">&amp;&amp;</span>&nbsp;<span class="ident" id="2640903">sec</span>&nbsp;<span class="op" id="2640907">&lt;</span>&nbsp;<span class="ident" id="2640909">l</span><span class="op" id="2640910">.</span><span class="ident" id="2640911">cacheEnd</span>&nbsp;<span class="op" id="2640920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640924">name</span>&nbsp;<span class="op" id="2640929">=</span>&nbsp;<span class="ident" id="2640931">zone</span><span class="op" id="2640935">.</span><span class="ident" id="2640936">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640943">offset</span>&nbsp;<span class="op" id="2640950">=</span>&nbsp;<span class="ident" id="2640952">zone</span><span class="op" id="2640956">.</span><span class="ident" id="2640957">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640966">isDST</span>&nbsp;<span class="op" id="2640972">=</span>&nbsp;<span class="ident" id="2640974">zone</span><span class="op" id="2640978">.</span><span class="ident" id="2640979">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640987">start</span>&nbsp;<span class="op" id="2640993">=</span>&nbsp;<span class="ident" id="2640995">l</span><span class="op" id="2640996">.</span><span class="ident" id="2640997">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641010">end</span>&nbsp;<span class="op" id="2641014">=</span>&nbsp;<span class="ident" id="2641016">l</span><span class="op" id="2641017">.</span><span class="ident" id="2641018">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641029">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2641037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641041">if</span>&nbsp;<span class="builtinfunc" id="2641044">len</span><span class="op" id="2641047">(</span><span class="ident" id="2641048">l</span><span class="op" id="2641049">.</span><span class="ident" id="2641050">tx</span><span class="op" id="2641052">)</span>&nbsp;<span class="op" id="2641054">==</span>&nbsp;<span class="num" id="2641057">0</span>&nbsp;<span class="op" id="2641059">||</span>&nbsp;<span class="ident" id="2641062">sec</span>&nbsp;<span class="op" id="2641066">&lt;</span>&nbsp;<span class="ident" id="2641068">l</span><span class="op" id="2641069">.</span><span class="ident" id="2641070">tx</span><span class="op" id="2641072">[</span><span class="num" id="2641073">0</span><span class="op" id="2641074">]</span><span class="op" id="2641075">.</span><span class="ident" id="2641076">when</span>&nbsp;<span class="op" id="2641081">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641085">zone</span>&nbsp;<span class="op" id="2641090">:=</span>&nbsp;<span class="op" id="2641093">&amp;</span><span class="ident" id="2641094">l</span><span class="op" id="2641095">.</span><span class="ident" id="2641096">zone</span><span class="op" id="2641100">[</span><span class="ident" id="2641101">l</span><span class="op" id="2641102">.</span><span class="ident" id="2641103">lookupFirstZone</span><span class="op" id="2641118">(</span><span class="op" id="2641119">)</span><span class="op" id="2641120">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641124">name</span>&nbsp;<span class="op" id="2641129">=</span>&nbsp;<span class="ident" id="2641131">zone</span><span class="op" id="2641135">.</span><span class="ident" id="2641136">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641143">offset</span>&nbsp;<span class="op" id="2641150">=</span>&nbsp;<span class="ident" id="2641152">zone</span><span class="op" id="2641156">.</span><span class="ident" id="2641157">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641166">isDST</span>&nbsp;<span class="op" id="2641172">=</span>&nbsp;<span class="ident" id="2641174">zone</span><span class="op" id="2641178">.</span><span class="ident" id="2641179">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641187">start</span>&nbsp;<span class="op" id="2641193">=</span>&nbsp;<span class="ident" id="2641195">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641203">if</span>&nbsp;<span class="builtinfunc" id="2641206">len</span><span class="op" id="2641209">(</span><span class="ident" id="2641210">l</span><span class="op" id="2641211">.</span><span class="ident" id="2641212">tx</span><span class="op" id="2641214">)</span>&nbsp;<span class="op" id="2641216">&gt;</span>&nbsp;<span class="num" id="2641218">0</span>&nbsp;<span class="op" id="2641220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641225">end</span>&nbsp;<span class="op" id="2641229">=</span>&nbsp;<span class="ident" id="2641231">l</span><span class="op" id="2641232">.</span><span class="ident" id="2641233">tx</span><span class="op" id="2641235">[</span><span class="num" id="2641236">0</span><span class="op" id="2641237">]</span><span class="op" id="2641238">.</span><span class="ident" id="2641239">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2641246">}</span>&nbsp;<span class="keyword" id="2641248">else</span>&nbsp;<span class="op" id="2641253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641258">end</span>&nbsp;<span class="op" id="2641262">=</span>&nbsp;<span class="ident" id="2641264">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2641272">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641276">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2641284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2641288">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2641342">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641391">tx</span>&nbsp;<span class="op" id="2641394">:=</span>&nbsp;<span class="ident" id="2641397">l</span><span class="op" id="2641398">.</span><span class="ident" id="2641399">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641403">end</span>&nbsp;<span class="op" id="2641407">=</span>&nbsp;<span class="ident" id="2641409">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641416">lo</span>&nbsp;<span class="op" id="2641419">:=</span>&nbsp;<span class="num" id="2641422">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641425">hi</span>&nbsp;<span class="op" id="2641428">:=</span>&nbsp;<span class="builtinfunc" id="2641431">len</span><span class="op" id="2641434">(</span><span class="ident" id="2641435">tx</span><span class="op" id="2641437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641440">for</span>&nbsp;<span class="ident" id="2641444">hi</span><span class="op" id="2641446">-</span><span class="ident" id="2641447">lo</span>&nbsp;<span class="op" id="2641450">&gt;</span>&nbsp;<span class="num" id="2641452">1</span>&nbsp;<span class="op" id="2641454">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641458">m</span>&nbsp;<span class="op" id="2641460">:=</span>&nbsp;<span class="ident" id="2641463">lo</span>&nbsp;<span class="op" id="2641466">+</span>&nbsp;<span class="op" id="2641468">(</span><span class="ident" id="2641469">hi</span><span class="op" id="2641471">-</span><span class="ident" id="2641472">lo</span><span class="op" id="2641474">)</span><span class="op" id="2641475">/</span><span class="num" id="2641476">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641480">lim</span>&nbsp;<span class="op" id="2641484">:=</span>&nbsp;<span class="ident" id="2641487">tx</span><span class="op" id="2641489">[</span><span class="ident" id="2641490">m</span><span class="op" id="2641491">]</span><span class="op" id="2641492">.</span><span class="ident" id="2641493">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641500">if</span>&nbsp;<span class="ident" id="2641503">sec</span>&nbsp;<span class="op" id="2641507">&lt;</span>&nbsp;<span class="ident" id="2641509">lim</span>&nbsp;<span class="op" id="2641513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641518">end</span>&nbsp;<span class="op" id="2641522">=</span>&nbsp;<span class="ident" id="2641524">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641531">hi</span>&nbsp;<span class="op" id="2641534">=</span>&nbsp;<span class="ident" id="2641536">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2641540">}</span>&nbsp;<span class="keyword" id="2641542">else</span>&nbsp;<span class="op" id="2641547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641552">lo</span>&nbsp;<span class="op" id="2641555">=</span>&nbsp;<span class="ident" id="2641557">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2641561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2641564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641567">zone</span>&nbsp;<span class="op" id="2641572">:=</span>&nbsp;<span class="op" id="2641575">&amp;</span><span class="ident" id="2641576">l</span><span class="op" id="2641577">.</span><span class="ident" id="2641578">zone</span><span class="op" id="2641582">[</span><span class="ident" id="2641583">tx</span><span class="op" id="2641585">[</span><span class="ident" id="2641586">lo</span><span class="op" id="2641588">]</span><span class="op" id="2641589">.</span><span class="ident" id="2641590">index</span><span class="op" id="2641595">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641598">name</span>&nbsp;<span class="op" id="2641603">=</span>&nbsp;<span class="ident" id="2641605">zone</span><span class="op" id="2641609">.</span><span class="ident" id="2641610">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641616">offset</span>&nbsp;<span class="op" id="2641623">=</span>&nbsp;<span class="ident" id="2641625">zone</span><span class="op" id="2641629">.</span><span class="ident" id="2641630">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641638">isDST</span>&nbsp;<span class="op" id="2641644">=</span>&nbsp;<span class="ident" id="2641646">zone</span><span class="op" id="2641650">.</span><span class="ident" id="2641651">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2641658">start</span>&nbsp;<span class="op" id="2641664">=</span>&nbsp;<span class="ident" id="2641666">tx</span><span class="op" id="2641668">[</span><span class="ident" id="2641669">lo</span><span class="op" id="2641671">]</span><span class="op" id="2641672">.</span><span class="ident" id="2641673">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2641679">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2641718">return</span><br>
<span class="lineno"></span><span class="op" id="2641725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2641728">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2641799">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2641868">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2641878">//</span><br>
<span class="lineno"></span><span class="comment" id="2641881">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2641933">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2642006">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2642061">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2642123">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2642185">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2642248">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2642320">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2642332">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2642398">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2642418">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2642455">func</span>&nbsp;<span class="op" id="2642460">(</span><span class="ident" id="2642461">l</span>&nbsp;<span class="op" id="2642463">*</span><span class="ident" id="2642464">Location</span><span class="op" id="2642472">)</span>&nbsp;<span class="ident" id="2642474">lookupFirstZone</span><span class="op" id="2642489">(</span><span class="op" id="2642490">)</span>&nbsp;<span class="builtintype" id="2642492">int</span>&nbsp;<span class="op" id="2642496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2642499">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642511">if</span>&nbsp;<span class="op" id="2642514">!</span><span class="ident" id="2642515">l</span><span class="op" id="2642516">.</span><span class="ident" id="2642517">firstZoneUsed</span><span class="op" id="2642530">(</span><span class="op" id="2642531">)</span>&nbsp;<span class="op" id="2642533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642537">return</span>&nbsp;<span class="num" id="2642544">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2642547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2642551">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642563">if</span>&nbsp;<span class="builtinfunc" id="2642566">len</span><span class="op" id="2642569">(</span><span class="ident" id="2642570">l</span><span class="op" id="2642571">.</span><span class="ident" id="2642572">tx</span><span class="op" id="2642574">)</span>&nbsp;<span class="op" id="2642576">&gt;</span>&nbsp;<span class="num" id="2642578">0</span>&nbsp;<span class="op" id="2642580">&amp;&amp;</span>&nbsp;<span class="ident" id="2642583">l</span><span class="op" id="2642584">.</span><span class="ident" id="2642585">zone</span><span class="op" id="2642589">[</span><span class="ident" id="2642590">l</span><span class="op" id="2642591">.</span><span class="ident" id="2642592">tx</span><span class="op" id="2642594">[</span><span class="num" id="2642595">0</span><span class="op" id="2642596">]</span><span class="op" id="2642597">.</span><span class="ident" id="2642598">index</span><span class="op" id="2642603">]</span><span class="op" id="2642604">.</span><span class="ident" id="2642605">isDST</span>&nbsp;<span class="op" id="2642611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642615">for</span>&nbsp;<span class="ident" id="2642619">zi</span>&nbsp;<span class="op" id="2642622">:=</span>&nbsp;<span class="builtintype" id="2642625">int</span><span class="op" id="2642628">(</span><span class="ident" id="2642629">l</span><span class="op" id="2642630">.</span><span class="ident" id="2642631">tx</span><span class="op" id="2642633">[</span><span class="num" id="2642634">0</span><span class="op" id="2642635">]</span><span class="op" id="2642636">.</span><span class="ident" id="2642637">index</span><span class="op" id="2642642">)</span>&nbsp;<span class="op" id="2642644">-</span>&nbsp;<span class="num" id="2642646">1</span><span class="op" id="2642647">;</span>&nbsp;<span class="ident" id="2642649">zi</span>&nbsp;<span class="op" id="2642652">&gt;=</span>&nbsp;<span class="num" id="2642655">0</span><span class="op" id="2642656">;</span>&nbsp;<span class="ident" id="2642658">zi</span><span class="op" id="2642660">--</span>&nbsp;<span class="op" id="2642663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642668">if</span>&nbsp;<span class="op" id="2642671">!</span><span class="ident" id="2642672">l</span><span class="op" id="2642673">.</span><span class="ident" id="2642674">zone</span><span class="op" id="2642678">[</span><span class="ident" id="2642679">zi</span><span class="op" id="2642681">]</span><span class="op" id="2642682">.</span><span class="ident" id="2642683">isDST</span>&nbsp;<span class="op" id="2642689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642695">return</span>&nbsp;<span class="ident" id="2642702">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2642708">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2642712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2642715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2642719">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642731">for</span>&nbsp;<span class="ident" id="2642735">zi</span>&nbsp;<span class="op" id="2642738">:=</span>&nbsp;<span class="keyword" id="2642741">range</span>&nbsp;<span class="ident" id="2642747">l</span><span class="op" id="2642748">.</span><span class="ident" id="2642749">zone</span>&nbsp;<span class="op" id="2642754">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642758">if</span>&nbsp;<span class="op" id="2642761">!</span><span class="ident" id="2642762">l</span><span class="op" id="2642763">.</span><span class="ident" id="2642764">zone</span><span class="op" id="2642768">[</span><span class="ident" id="2642769">zi</span><span class="op" id="2642771">]</span><span class="op" id="2642772">.</span><span class="ident" id="2642773">isDST</span>&nbsp;<span class="op" id="2642779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642784">return</span>&nbsp;<span class="ident" id="2642791">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2642796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2642799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2642803">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642815">return</span>&nbsp;<span class="num" id="2642822">0</span><br>
<span class="lineno"></span><span class="op" id="2642824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2642827">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2642891">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2642906">func</span>&nbsp;<span class="op" id="2642911">(</span><span class="ident" id="2642912">l</span>&nbsp;<span class="op" id="2642914">*</span><span class="ident" id="2642915">Location</span><span class="op" id="2642923">)</span>&nbsp;<span class="ident" id="2642925">firstZoneUsed</span><span class="op" id="2642938">(</span><span class="op" id="2642939">)</span>&nbsp;<span class="builtintype" id="2642941">bool</span>&nbsp;<span class="op" id="2642946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642949">for</span>&nbsp;<span class="ident" id="2642953">_</span><span class="op" id="2642954">,</span>&nbsp;<span class="ident" id="2642956">tx</span>&nbsp;<span class="op" id="2642959">:=</span>&nbsp;<span class="keyword" id="2642962">range</span>&nbsp;<span class="ident" id="2642968">l</span><span class="op" id="2642969">.</span><span class="ident" id="2642970">tx</span>&nbsp;<span class="op" id="2642973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642977">if</span>&nbsp;<span class="ident" id="2642980">tx</span><span class="op" id="2642982">.</span><span class="ident" id="2642983">index</span>&nbsp;<span class="op" id="2642989">==</span>&nbsp;<span class="num" id="2642992">0</span>&nbsp;<span class="op" id="2642994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2642999">return</span>&nbsp;<span class="builtintype" id="2643006">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2643013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2643016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643019">return</span>&nbsp;<span class="builtintype" id="2643026">false</span><br>
<span class="lineno"></span><span class="op" id="2643032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2643035">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2643094">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2643158">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2643207">func</span>&nbsp;<span class="op" id="2643212">(</span><span class="ident" id="2643213">l</span>&nbsp;<span class="op" id="2643215">*</span><span class="ident" id="2643216">Location</span><span class="op" id="2643224">)</span>&nbsp;<span class="ident" id="2643226">lookupName</span><span class="op" id="2643236">(</span><span class="ident" id="2643237">name</span>&nbsp;<span class="builtintype" id="2643242">string</span><span class="op" id="2643248">,</span>&nbsp;<span class="ident" id="2643250">unix</span>&nbsp;<span class="ident" id="2643255">int64</span><span class="op" id="2643260">)</span>&nbsp;<span class="op" id="2643262">(</span><span class="ident" id="2643263">offset</span>&nbsp;<span class="builtintype" id="2643270">int</span><span class="op" id="2643273">,</span>&nbsp;<span class="ident" id="2643275">isDST</span>&nbsp;<span class="builtintype" id="2643281">bool</span><span class="op" id="2643285">,</span>&nbsp;<span class="ident" id="2643287">ok</span>&nbsp;<span class="builtintype" id="2643290">bool</span><span class="op" id="2643294">)</span>&nbsp;<span class="op" id="2643296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643299">l</span>&nbsp;<span class="op" id="2643301">=</span>&nbsp;<span class="ident" id="2643303">l</span><span class="op" id="2643304">.</span><span class="ident" id="2643305">get</span><span class="op" id="2643308">(</span><span class="op" id="2643309">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2643313">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2643376">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2643446">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2643509">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2643568">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2643635">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643652">for</span>&nbsp;<span class="ident" id="2643656">i</span>&nbsp;<span class="op" id="2643658">:=</span>&nbsp;<span class="keyword" id="2643661">range</span>&nbsp;<span class="ident" id="2643667">l</span><span class="op" id="2643668">.</span><span class="ident" id="2643669">zone</span>&nbsp;<span class="op" id="2643674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643678">zone</span>&nbsp;<span class="op" id="2643683">:=</span>&nbsp;<span class="op" id="2643686">&amp;</span><span class="ident" id="2643687">l</span><span class="op" id="2643688">.</span><span class="ident" id="2643689">zone</span><span class="op" id="2643693">[</span><span class="ident" id="2643694">i</span><span class="op" id="2643695">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643699">if</span>&nbsp;<span class="ident" id="2643702">zone</span><span class="op" id="2643706">.</span><span class="ident" id="2643707">name</span>&nbsp;<span class="op" id="2643712">==</span>&nbsp;<span class="ident" id="2643715">name</span>&nbsp;<span class="op" id="2643720">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643725">nam</span><span class="op" id="2643728">,</span>&nbsp;<span class="ident" id="2643730">offset</span><span class="op" id="2643736">,</span>&nbsp;<span class="ident" id="2643738">isDST</span><span class="op" id="2643743">,</span>&nbsp;<span class="ident" id="2643745">_</span><span class="op" id="2643746">,</span>&nbsp;<span class="ident" id="2643748">_</span>&nbsp;<span class="op" id="2643750">:=</span>&nbsp;<span class="ident" id="2643753">l</span><span class="op" id="2643754">.</span><span class="ident" id="2643755">lookup</span><span class="op" id="2643761">(</span><span class="ident" id="2643762">unix</span>&nbsp;<span class="op" id="2643767">-</span>&nbsp;<span class="ident" id="2643769">int64</span><span class="op" id="2643774">(</span><span class="ident" id="2643775">zone</span><span class="op" id="2643779">.</span><span class="ident" id="2643780">offset</span><span class="op" id="2643786">)</span><span class="op" id="2643787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643792">if</span>&nbsp;<span class="ident" id="2643795">nam</span>&nbsp;<span class="op" id="2643799">==</span>&nbsp;<span class="ident" id="2643802">zone</span><span class="op" id="2643806">.</span><span class="ident" id="2643807">name</span>&nbsp;<span class="op" id="2643812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643818">return</span>&nbsp;<span class="ident" id="2643825">offset</span><span class="op" id="2643831">,</span>&nbsp;<span class="ident" id="2643833">isDST</span><span class="op" id="2643838">,</span>&nbsp;<span class="builtintype" id="2643840">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2643848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2643852">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2643855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2643859">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643910">for</span>&nbsp;<span class="ident" id="2643914">i</span>&nbsp;<span class="op" id="2643916">:=</span>&nbsp;<span class="keyword" id="2643919">range</span>&nbsp;<span class="ident" id="2643925">l</span><span class="op" id="2643926">.</span><span class="ident" id="2643927">zone</span>&nbsp;<span class="op" id="2643932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2643936">zone</span>&nbsp;<span class="op" id="2643941">:=</span>&nbsp;<span class="op" id="2643944">&amp;</span><span class="ident" id="2643945">l</span><span class="op" id="2643946">.</span><span class="ident" id="2643947">zone</span><span class="op" id="2643951">[</span><span class="ident" id="2643952">i</span><span class="op" id="2643953">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643957">if</span>&nbsp;<span class="ident" id="2643960">zone</span><span class="op" id="2643964">.</span><span class="ident" id="2643965">name</span>&nbsp;<span class="op" id="2643970">==</span>&nbsp;<span class="ident" id="2643973">name</span>&nbsp;<span class="op" id="2643978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2643983">return</span>&nbsp;<span class="ident" id="2643990">zone</span><span class="op" id="2643994">.</span><span class="ident" id="2643995">offset</span><span class="op" id="2644001">,</span>&nbsp;<span class="ident" id="2644003">zone</span><span class="op" id="2644007">.</span><span class="ident" id="2644008">isDST</span><span class="op" id="2644013">,</span>&nbsp;<span class="builtintype" id="2644015">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2644022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2644025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2644029">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644053">return</span><br>
<span class="lineno"></span><span class="op" id="2644060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2644063">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2644136">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2644197">var</span>&nbsp;<span class="ident" id="2644201">zoneinfo</span><span class="op" id="2644209">,</span>&nbsp;<span class="ident" id="2644211">_</span>&nbsp;<span class="op" id="2644213">=</span>&nbsp;<span class="ident" id="2644215">syscall</span><span class="op" id="2644222">.</span><span class="ident" id="2644223">Getenv</span><span class="op" id="2644229">(</span><span class="string" id="2644230">&#34;ZONEINFO&#34;</span><span class="op" id="2644240">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2644243">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2644301">//</span><br>
<span class="lineno"></span><span class="comment" id="2644304">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2644361">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2644416">//</span><br>
<span class="lineno"></span><span class="comment" id="2644419">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2644497">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2644560">//</span><br>
<span class="lineno"></span><span class="comment" id="2644563">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2644623">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2644679">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2644743">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2644812">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2644861">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2644916">func</span>&nbsp;<span class="ident" id="2644921">LoadLocation</span><span class="op" id="2644933">(</span><span class="ident" id="2644934">name</span>&nbsp;<span class="builtintype" id="2644939">string</span><span class="op" id="2644945">)</span>&nbsp;<span class="op" id="2644947">(</span><span class="op" id="2644948">*</span><span class="ident" id="2644949">Location</span><span class="op" id="2644957">,</span>&nbsp;<span class="builtintype" id="2644959">error</span><span class="op" id="2644964">)</span>&nbsp;<span class="op" id="2644966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2644969">if</span>&nbsp;<span class="ident" id="2644972">name</span>&nbsp;<span class="op" id="2644977">==</span>&nbsp;<span class="string" id="2644980">&#34;&#34;</span>&nbsp;<span class="op" id="2644983">||</span>&nbsp;<span class="ident" id="2644986">name</span>&nbsp;<span class="op" id="2644991">==</span>&nbsp;<span class="string" id="2644994">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2645000">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645004">return</span>&nbsp;<span class="ident" id="2645011">UTC</span><span class="op" id="2645014">,</span>&nbsp;<span class="ident" id="2645016">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645024">if</span>&nbsp;<span class="ident" id="2645027">name</span>&nbsp;<span class="op" id="2645032">==</span>&nbsp;<span class="string" id="2645035">&#34;Local&#34;</span>&nbsp;<span class="op" id="2645043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645047">return</span>&nbsp;<span class="ident" id="2645054">Local</span><span class="op" id="2645059">,</span>&nbsp;<span class="ident" id="2645061">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645066">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645069">if</span>&nbsp;<span class="ident" id="2645072">zoneinfo</span>&nbsp;<span class="op" id="2645081">!=</span>&nbsp;<span class="string" id="2645084">&#34;&#34;</span>&nbsp;<span class="op" id="2645087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645091">if</span>&nbsp;<span class="ident" id="2645094">z</span><span class="op" id="2645095">,</span>&nbsp;<span class="ident" id="2645097">err</span>&nbsp;<span class="op" id="2645101">:=</span>&nbsp;<span class="ident" id="2645104">loadZoneFile</span><span class="op" id="2645116">(</span><span class="ident" id="2645117">zoneinfo</span><span class="op" id="2645125">,</span>&nbsp;<span class="ident" id="2645127">name</span><span class="op" id="2645131">)</span><span class="op" id="2645132">;</span>&nbsp;<span class="ident" id="2645134">err</span>&nbsp;<span class="op" id="2645138">==</span>&nbsp;<span class="ident" id="2645141">nil</span>&nbsp;<span class="op" id="2645145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645150">z</span><span class="op" id="2645151">.</span><span class="ident" id="2645152">name</span>&nbsp;<span class="op" id="2645157">=</span>&nbsp;<span class="ident" id="2645159">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645167">return</span>&nbsp;<span class="ident" id="2645174">z</span><span class="op" id="2645175">,</span>&nbsp;<span class="ident" id="2645177">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645183">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2645186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2645189">return</span>&nbsp;<span class="ident" id="2645196">loadLocation</span><span class="op" id="2645208">(</span><span class="ident" id="2645209">name</span><span class="op" id="2645213">)</span><br>
<span class="lineno"></span><span class="op" id="2645215">}</span>
</div>
</body>
</html>
