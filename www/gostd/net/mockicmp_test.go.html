<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7839362">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7839418">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7839472">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7839523">package</span>&nbsp;<span class="ident" id="7839531">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7839536">import</span>&nbsp;<span class="string" id="7839543">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7839553">const</span>&nbsp;<span class="op" id="7839559">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839562">icmpv4EchoRequest</span>&nbsp;<span class="op" id="7839580">=</span>&nbsp;<span class="num" id="7839582">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839585">icmpv4EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7839603">=</span>&nbsp;<span class="num" id="7839605">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839608">icmpv6EchoRequest</span>&nbsp;<span class="op" id="7839626">=</span>&nbsp;<span class="num" id="7839628">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839633">icmpv6EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7839651">=</span>&nbsp;<span class="num" id="7839653">129</span><br>
<span class="lineno"></span><span class="op" id="7839657">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7839660">//&nbsp;icmpMessage&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="7839703">type</span>&nbsp;<span class="ident" id="7839708">icmpMessage</span>&nbsp;<span class="keyword" id="7839720">struct</span>&nbsp;<span class="op" id="7839727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839730">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7839739">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7839755">//&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839764">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7839773">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7839789">//&nbsp;code</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839798">Checksum</span>&nbsp;<span class="builtintype" id="7839807">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7839823">//&nbsp;checksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839836">Body</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839845">icmpMessageBody</span>&nbsp;<span class="comment" id="7839861">//&nbsp;body</span><br>
<span class="lineno"></span><span class="op" id="7839869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7839872">//&nbsp;icmpMessageBody&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message&nbsp;body.</span><br>
<span class="lineno">25</span><span class="keyword" id="7839924">type</span>&nbsp;<span class="ident" id="7839929">icmpMessageBody</span>&nbsp;<span class="keyword" id="7839945">interface</span>&nbsp;<span class="op" id="7839955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839958">Len</span><span class="op" id="7839961">(</span><span class="op" id="7839962">)</span>&nbsp;<span class="builtintype" id="7839964">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7839969">Marshal</span><span class="op" id="7839976">(</span><span class="op" id="7839977">)</span>&nbsp;<span class="op" id="7839979">(</span><span class="op" id="7839980">[</span><span class="op" id="7839981">]</span><span class="builtintype" id="7839982">byte</span><span class="op" id="7839986">,</span>&nbsp;<span class="builtintype" id="7839988">error</span><span class="op" id="7839993">)</span><br>
<span class="lineno"></span><span class="op" id="7839995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="7839998">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="7840066">//&nbsp;reply&nbsp;message&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="7840086">func</span>&nbsp;<span class="op" id="7840091">(</span><span class="ident" id="7840092">m</span>&nbsp;<span class="op" id="7840094">*</span><span class="ident" id="7840095">icmpMessage</span><span class="op" id="7840106">)</span>&nbsp;<span class="ident" id="7840108">Marshal</span><span class="op" id="7840115">(</span><span class="op" id="7840116">)</span>&nbsp;<span class="op" id="7840118">(</span><span class="op" id="7840119">[</span><span class="op" id="7840120">]</span><span class="builtintype" id="7840121">byte</span><span class="op" id="7840125">,</span>&nbsp;<span class="builtintype" id="7840127">error</span><span class="op" id="7840132">)</span>&nbsp;<span class="op" id="7840134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840137">b</span>&nbsp;<span class="op" id="7840139">:=</span>&nbsp;<span class="op" id="7840142">[</span><span class="op" id="7840143">]</span><span class="builtintype" id="7840144">byte</span><span class="op" id="7840148">{</span><span class="builtintype" id="7840149">byte</span><span class="op" id="7840153">(</span><span class="ident" id="7840154">m</span><span class="op" id="7840155">.</span><span class="ident" id="7840156">Type</span><span class="op" id="7840160">)</span><span class="op" id="7840161">,</span>&nbsp;<span class="builtintype" id="7840163">byte</span><span class="op" id="7840167">(</span><span class="ident" id="7840168">m</span><span class="op" id="7840169">.</span><span class="ident" id="7840170">Code</span><span class="op" id="7840174">)</span><span class="op" id="7840175">,</span>&nbsp;<span class="num" id="7840177">0</span><span class="op" id="7840178">,</span>&nbsp;<span class="num" id="7840180">0</span><span class="op" id="7840181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840184">if</span>&nbsp;<span class="ident" id="7840187">m</span><span class="op" id="7840188">.</span><span class="ident" id="7840189">Body</span>&nbsp;<span class="op" id="7840194">!=</span>&nbsp;<span class="ident" id="7840197">nil</span>&nbsp;<span class="op" id="7840201">&amp;&amp;</span>&nbsp;<span class="ident" id="7840204">m</span><span class="op" id="7840205">.</span><span class="ident" id="7840206">Body</span><span class="op" id="7840210">.</span><span class="ident" id="7840211">Len</span><span class="op" id="7840214">(</span><span class="op" id="7840215">)</span>&nbsp;<span class="op" id="7840217">!=</span>&nbsp;<span class="num" id="7840220">0</span>&nbsp;<span class="op" id="7840222">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840226">mb</span><span class="op" id="7840228">,</span>&nbsp;<span class="ident" id="7840230">err</span>&nbsp;<span class="op" id="7840234">:=</span>&nbsp;<span class="ident" id="7840237">m</span><span class="op" id="7840238">.</span><span class="ident" id="7840239">Body</span><span class="op" id="7840243">.</span><span class="ident" id="7840244">Marshal</span><span class="op" id="7840251">(</span><span class="op" id="7840252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840256">if</span>&nbsp;<span class="ident" id="7840259">err</span>&nbsp;<span class="op" id="7840263">!=</span>&nbsp;<span class="ident" id="7840266">nil</span>&nbsp;<span class="op" id="7840270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840275">return</span>&nbsp;<span class="ident" id="7840282">nil</span><span class="op" id="7840285">,</span>&nbsp;<span class="ident" id="7840287">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840297">b</span>&nbsp;<span class="op" id="7840299">=</span>&nbsp;<span class="builtinfunc" id="7840301">append</span><span class="op" id="7840307">(</span><span class="ident" id="7840308">b</span><span class="op" id="7840309">,</span>&nbsp;<span class="ident" id="7840311">mb</span><span class="op" id="7840313">...</span><span class="op" id="7840316">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840322">switch</span>&nbsp;<span class="ident" id="7840329">m</span><span class="op" id="7840330">.</span><span class="ident" id="7840331">Type</span>&nbsp;<span class="op" id="7840336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840339">case</span>&nbsp;<span class="ident" id="7840344">icmpv6EchoRequest</span><span class="op" id="7840361">,</span>&nbsp;<span class="ident" id="7840363">icmpv6EchoReply</span><span class="op" id="7840378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840382">return</span>&nbsp;<span class="ident" id="7840389">b</span><span class="op" id="7840390">,</span>&nbsp;<span class="ident" id="7840392">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840397">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840400">csumcv</span>&nbsp;<span class="op" id="7840407">:=</span>&nbsp;<span class="builtinfunc" id="7840410">len</span><span class="op" id="7840413">(</span><span class="ident" id="7840414">b</span><span class="op" id="7840415">)</span>&nbsp;<span class="op" id="7840417">-</span>&nbsp;<span class="num" id="7840419">1</span>&nbsp;<span class="comment" id="7840421">//&nbsp;checksum&nbsp;coverage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840443">s</span>&nbsp;<span class="op" id="7840445">:=</span>&nbsp;<span class="builtintype" id="7840448">uint32</span><span class="op" id="7840454">(</span><span class="num" id="7840455">0</span><span class="op" id="7840456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840459">for</span>&nbsp;<span class="ident" id="7840463">i</span>&nbsp;<span class="op" id="7840465">:=</span>&nbsp;<span class="num" id="7840468">0</span><span class="op" id="7840469">;</span>&nbsp;<span class="ident" id="7840471">i</span>&nbsp;<span class="op" id="7840473">&lt;</span>&nbsp;<span class="ident" id="7840475">csumcv</span><span class="op" id="7840481">;</span>&nbsp;<span class="ident" id="7840483">i</span>&nbsp;<span class="op" id="7840485">+=</span>&nbsp;<span class="num" id="7840488">2</span>&nbsp;<span class="op" id="7840490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840494">s</span>&nbsp;<span class="op" id="7840496">+=</span>&nbsp;<span class="builtintype" id="7840499">uint32</span><span class="op" id="7840505">(</span><span class="ident" id="7840506">b</span><span class="op" id="7840507">[</span><span class="ident" id="7840508">i</span><span class="op" id="7840509">+</span><span class="num" id="7840510">1</span><span class="op" id="7840511">]</span><span class="op" id="7840512">)</span><span class="op" id="7840513">&lt;&lt;</span><span class="num" id="7840515">8</span>&nbsp;<span class="op" id="7840517">|</span>&nbsp;<span class="builtintype" id="7840519">uint32</span><span class="op" id="7840525">(</span><span class="ident" id="7840526">b</span><span class="op" id="7840527">[</span><span class="ident" id="7840528">i</span><span class="op" id="7840529">]</span><span class="op" id="7840530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840533">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840536">if</span>&nbsp;<span class="ident" id="7840539">csumcv</span><span class="op" id="7840545">&amp;</span><span class="num" id="7840546">1</span>&nbsp;<span class="op" id="7840548">==</span>&nbsp;<span class="num" id="7840551">0</span>&nbsp;<span class="op" id="7840553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840557">s</span>&nbsp;<span class="op" id="7840559">+=</span>&nbsp;<span class="builtintype" id="7840562">uint32</span><span class="op" id="7840568">(</span><span class="ident" id="7840569">b</span><span class="op" id="7840570">[</span><span class="ident" id="7840571">csumcv</span><span class="op" id="7840577">]</span><span class="op" id="7840578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840584">s</span>&nbsp;<span class="op" id="7840586">=</span>&nbsp;<span class="ident" id="7840588">s</span><span class="op" id="7840589">&gt;&gt;</span><span class="num" id="7840591">16</span>&nbsp;<span class="op" id="7840594">+</span>&nbsp;<span class="ident" id="7840596">s</span><span class="op" id="7840597">&amp;</span><span class="num" id="7840598">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840606">s</span>&nbsp;<span class="op" id="7840608">=</span>&nbsp;<span class="ident" id="7840610">s</span>&nbsp;<span class="op" id="7840612">+</span>&nbsp;<span class="ident" id="7840614">s</span><span class="op" id="7840615">&gt;&gt;</span><span class="num" id="7840617">16</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7840621">//&nbsp;Place&nbsp;checksum&nbsp;back&nbsp;in&nbsp;header;&nbsp;using&nbsp;^=&nbsp;avoids&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7840676">//&nbsp;assumption&nbsp;the&nbsp;checksum&nbsp;bytes&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840720">b</span><span class="op" id="7840721">[</span><span class="num" id="7840722">2</span><span class="op" id="7840723">]</span>&nbsp;<span class="op" id="7840725">^=</span>&nbsp;<span class="builtintype" id="7840728">byte</span><span class="op" id="7840732">(</span><span class="op" id="7840733">^</span><span class="ident" id="7840734">s</span><span class="op" id="7840735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840738">b</span><span class="op" id="7840739">[</span><span class="num" id="7840740">3</span><span class="op" id="7840741">]</span>&nbsp;<span class="op" id="7840743">^=</span>&nbsp;<span class="builtintype" id="7840746">byte</span><span class="op" id="7840750">(</span><span class="op" id="7840751">^</span><span class="ident" id="7840752">s</span>&nbsp;<span class="op" id="7840754">&gt;&gt;</span>&nbsp;<span class="num" id="7840757">8</span><span class="op" id="7840758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840761">return</span>&nbsp;<span class="ident" id="7840768">b</span><span class="op" id="7840769">,</span>&nbsp;<span class="ident" id="7840771">nil</span><br>
<span class="lineno">60</span><span class="op" id="7840775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7840778">//&nbsp;parseICMPMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="7840827">func</span>&nbsp;<span class="ident" id="7840832">parseICMPMessage</span><span class="op" id="7840848">(</span><span class="ident" id="7840849">b</span>&nbsp;<span class="op" id="7840851">[</span><span class="op" id="7840852">]</span><span class="builtintype" id="7840853">byte</span><span class="op" id="7840857">)</span>&nbsp;<span class="op" id="7840859">(</span><span class="op" id="7840860">*</span><span class="ident" id="7840861">icmpMessage</span><span class="op" id="7840872">,</span>&nbsp;<span class="builtintype" id="7840874">error</span><span class="op" id="7840879">)</span>&nbsp;<span class="op" id="7840881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840884">msglen</span>&nbsp;<span class="op" id="7840891">:=</span>&nbsp;<span class="builtinfunc" id="7840894">len</span><span class="op" id="7840897">(</span><span class="ident" id="7840898">b</span><span class="op" id="7840899">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840902">if</span>&nbsp;<span class="ident" id="7840905">msglen</span>&nbsp;<span class="op" id="7840912">&lt;</span>&nbsp;<span class="num" id="7840914">4</span>&nbsp;<span class="op" id="7840916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7840920">return</span>&nbsp;<span class="ident" id="7840927">nil</span><span class="op" id="7840930">,</span>&nbsp;<span class="ident" id="7840932">errors</span><span class="op" id="7840938">.</span><span class="ident" id="7840939">New</span><span class="op" id="7840942">(</span><span class="string" id="7840943">&#34;message&nbsp;too&nbsp;short&#34;</span><span class="op" id="7840962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7840965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7840968">m</span>&nbsp;<span class="op" id="7840970">:=</span>&nbsp;<span class="op" id="7840973">&amp;</span><span class="ident" id="7840974">icmpMessage</span><span class="op" id="7840985">{</span><span class="ident" id="7840986">Type</span><span class="op" id="7840990">:</span>&nbsp;<span class="builtintype" id="7840992">int</span><span class="op" id="7840995">(</span><span class="ident" id="7840996">b</span><span class="op" id="7840997">[</span><span class="num" id="7840998">0</span><span class="op" id="7840999">]</span><span class="op" id="7841000">)</span><span class="op" id="7841001">,</span>&nbsp;<span class="ident" id="7841003">Code</span><span class="op" id="7841007">:</span>&nbsp;<span class="builtintype" id="7841009">int</span><span class="op" id="7841012">(</span><span class="ident" id="7841013">b</span><span class="op" id="7841014">[</span><span class="num" id="7841015">1</span><span class="op" id="7841016">]</span><span class="op" id="7841017">)</span><span class="op" id="7841018">,</span>&nbsp;<span class="ident" id="7841020">Checksum</span><span class="op" id="7841028">:</span>&nbsp;<span class="builtintype" id="7841030">int</span><span class="op" id="7841033">(</span><span class="ident" id="7841034">b</span><span class="op" id="7841035">[</span><span class="num" id="7841036">2</span><span class="op" id="7841037">]</span><span class="op" id="7841038">)</span><span class="op" id="7841039">&lt;&lt;</span><span class="num" id="7841041">8</span>&nbsp;<span class="op" id="7841043">|</span>&nbsp;<span class="builtintype" id="7841045">int</span><span class="op" id="7841048">(</span><span class="ident" id="7841049">b</span><span class="op" id="7841050">[</span><span class="num" id="7841051">3</span><span class="op" id="7841052">]</span><span class="op" id="7841053">)</span><span class="op" id="7841054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841057">if</span>&nbsp;<span class="ident" id="7841060">msglen</span>&nbsp;<span class="op" id="7841067">&gt;</span>&nbsp;<span class="num" id="7841069">4</span>&nbsp;<span class="op" id="7841071">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841075">var</span>&nbsp;<span class="ident" id="7841079">err</span>&nbsp;<span class="builtintype" id="7841083">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841091">switch</span>&nbsp;<span class="ident" id="7841098">m</span><span class="op" id="7841099">.</span><span class="ident" id="7841100">Type</span>&nbsp;<span class="op" id="7841105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841109">case</span>&nbsp;<span class="ident" id="7841114">icmpv4EchoRequest</span><span class="op" id="7841131">,</span>&nbsp;<span class="ident" id="7841133">icmpv4EchoReply</span><span class="op" id="7841148">,</span>&nbsp;<span class="ident" id="7841150">icmpv6EchoRequest</span><span class="op" id="7841167">,</span>&nbsp;<span class="ident" id="7841169">icmpv6EchoReply</span><span class="op" id="7841184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841189">m</span><span class="op" id="7841190">.</span><span class="ident" id="7841191">Body</span><span class="op" id="7841195">,</span>&nbsp;<span class="ident" id="7841197">err</span>&nbsp;<span class="op" id="7841201">=</span>&nbsp;<span class="ident" id="7841203">parseICMPEcho</span><span class="op" id="7841216">(</span><span class="ident" id="7841217">b</span><span class="op" id="7841218">[</span><span class="num" id="7841219">4</span><span class="op" id="7841220">:</span><span class="op" id="7841221">]</span><span class="op" id="7841222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841227">if</span>&nbsp;<span class="ident" id="7841230">err</span>&nbsp;<span class="op" id="7841234">!=</span>&nbsp;<span class="ident" id="7841237">nil</span>&nbsp;<span class="op" id="7841241">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841247">return</span>&nbsp;<span class="ident" id="7841254">nil</span><span class="op" id="7841257">,</span>&nbsp;<span class="ident" id="7841259">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841276">return</span>&nbsp;<span class="ident" id="7841283">m</span><span class="op" id="7841284">,</span>&nbsp;<span class="ident" id="7841286">nil</span><br>
<span class="lineno">80</span><span class="op" id="7841290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7841293">//&nbsp;imcpEcho&nbsp;represenets&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="7841361">type</span>&nbsp;<span class="ident" id="7841366">icmpEcho</span>&nbsp;<span class="keyword" id="7841375">struct</span>&nbsp;<span class="op" id="7841382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841385">ID</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7841390">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7841397">//&nbsp;identifier</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841412">Seq</span>&nbsp;&nbsp;<span class="builtintype" id="7841417">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7841424">//&nbsp;sequence&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841444">Data</span>&nbsp;<span class="op" id="7841449">[</span><span class="op" id="7841450">]</span><span class="builtintype" id="7841451">byte</span>&nbsp;<span class="comment" id="7841456">//&nbsp;data</span><br>
<span class="lineno"></span><span class="op" id="7841464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7841467">func</span>&nbsp;<span class="op" id="7841472">(</span><span class="ident" id="7841473">p</span>&nbsp;<span class="op" id="7841475">*</span><span class="ident" id="7841476">icmpEcho</span><span class="op" id="7841484">)</span>&nbsp;<span class="ident" id="7841486">Len</span><span class="op" id="7841489">(</span><span class="op" id="7841490">)</span>&nbsp;<span class="builtintype" id="7841492">int</span>&nbsp;<span class="op" id="7841496">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841499">if</span>&nbsp;<span class="ident" id="7841502">p</span>&nbsp;<span class="op" id="7841504">==</span>&nbsp;<span class="ident" id="7841507">nil</span>&nbsp;<span class="op" id="7841511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841515">return</span>&nbsp;<span class="num" id="7841522">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841528">return</span>&nbsp;<span class="num" id="7841535">4</span>&nbsp;<span class="op" id="7841537">+</span>&nbsp;<span class="builtinfunc" id="7841539">len</span><span class="op" id="7841542">(</span><span class="ident" id="7841543">p</span><span class="op" id="7841544">.</span><span class="ident" id="7841545">Data</span><span class="op" id="7841549">)</span><br>
<span class="lineno"></span><span class="op" id="7841551">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="7841554">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="7841622">//&nbsp;reply&nbsp;message&nbsp;body&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="7841647">func</span>&nbsp;<span class="op" id="7841652">(</span><span class="ident" id="7841653">p</span>&nbsp;<span class="op" id="7841655">*</span><span class="ident" id="7841656">icmpEcho</span><span class="op" id="7841664">)</span>&nbsp;<span class="ident" id="7841666">Marshal</span><span class="op" id="7841673">(</span><span class="op" id="7841674">)</span>&nbsp;<span class="op" id="7841676">(</span><span class="op" id="7841677">[</span><span class="op" id="7841678">]</span><span class="builtintype" id="7841679">byte</span><span class="op" id="7841683">,</span>&nbsp;<span class="builtintype" id="7841685">error</span><span class="op" id="7841690">)</span>&nbsp;<span class="op" id="7841692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841695">b</span>&nbsp;<span class="op" id="7841697">:=</span>&nbsp;<span class="builtinfunc" id="7841700">make</span><span class="op" id="7841704">(</span><span class="op" id="7841705">[</span><span class="op" id="7841706">]</span><span class="builtintype" id="7841707">byte</span><span class="op" id="7841711">,</span>&nbsp;<span class="num" id="7841713">4</span><span class="op" id="7841714">+</span><span class="builtinfunc" id="7841715">len</span><span class="op" id="7841718">(</span><span class="ident" id="7841719">p</span><span class="op" id="7841720">.</span><span class="ident" id="7841721">Data</span><span class="op" id="7841725">)</span><span class="op" id="7841726">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841729">b</span><span class="op" id="7841730">[</span><span class="num" id="7841731">0</span><span class="op" id="7841732">]</span><span class="op" id="7841733">,</span>&nbsp;<span class="ident" id="7841735">b</span><span class="op" id="7841736">[</span><span class="num" id="7841737">1</span><span class="op" id="7841738">]</span>&nbsp;<span class="op" id="7841740">=</span>&nbsp;<span class="builtintype" id="7841742">byte</span><span class="op" id="7841746">(</span><span class="ident" id="7841747">p</span><span class="op" id="7841748">.</span><span class="ident" id="7841749">ID</span><span class="op" id="7841751">&gt;&gt;</span><span class="num" id="7841753">8</span><span class="op" id="7841754">)</span><span class="op" id="7841755">,</span>&nbsp;<span class="builtintype" id="7841757">byte</span><span class="op" id="7841761">(</span><span class="ident" id="7841762">p</span><span class="op" id="7841763">.</span><span class="ident" id="7841764">ID</span><span class="op" id="7841766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841769">b</span><span class="op" id="7841770">[</span><span class="num" id="7841771">2</span><span class="op" id="7841772">]</span><span class="op" id="7841773">,</span>&nbsp;<span class="ident" id="7841775">b</span><span class="op" id="7841776">[</span><span class="num" id="7841777">3</span><span class="op" id="7841778">]</span>&nbsp;<span class="op" id="7841780">=</span>&nbsp;<span class="builtintype" id="7841782">byte</span><span class="op" id="7841786">(</span><span class="ident" id="7841787">p</span><span class="op" id="7841788">.</span><span class="ident" id="7841789">Seq</span><span class="op" id="7841792">&gt;&gt;</span><span class="num" id="7841794">8</span><span class="op" id="7841795">)</span><span class="op" id="7841796">,</span>&nbsp;<span class="builtintype" id="7841798">byte</span><span class="op" id="7841802">(</span><span class="ident" id="7841803">p</span><span class="op" id="7841804">.</span><span class="ident" id="7841805">Seq</span><span class="op" id="7841808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7841811">copy</span><span class="op" id="7841815">(</span><span class="ident" id="7841816">b</span><span class="op" id="7841817">[</span><span class="num" id="7841818">4</span><span class="op" id="7841819">:</span><span class="op" id="7841820">]</span><span class="op" id="7841821">,</span>&nbsp;<span class="ident" id="7841823">p</span><span class="op" id="7841824">.</span><span class="ident" id="7841825">Data</span><span class="op" id="7841829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841832">return</span>&nbsp;<span class="ident" id="7841839">b</span><span class="op" id="7841840">,</span>&nbsp;<span class="ident" id="7841842">nil</span><br>
<span class="lineno"></span><span class="op" id="7841846">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="7841849">//&nbsp;parseICMPEcho&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="7841916">//&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="7841925">func</span>&nbsp;<span class="ident" id="7841930">parseICMPEcho</span><span class="op" id="7841943">(</span><span class="ident" id="7841944">b</span>&nbsp;<span class="op" id="7841946">[</span><span class="op" id="7841947">]</span><span class="builtintype" id="7841948">byte</span><span class="op" id="7841952">)</span>&nbsp;<span class="op" id="7841954">(</span><span class="op" id="7841955">*</span><span class="ident" id="7841956">icmpEcho</span><span class="op" id="7841964">,</span>&nbsp;<span class="builtintype" id="7841966">error</span><span class="op" id="7841971">)</span>&nbsp;<span class="op" id="7841973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841976">bodylen</span>&nbsp;<span class="op" id="7841984">:=</span>&nbsp;<span class="builtinfunc" id="7841987">len</span><span class="op" id="7841990">(</span><span class="ident" id="7841991">b</span><span class="op" id="7841992">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841995">p</span>&nbsp;<span class="op" id="7841997">:=</span>&nbsp;<span class="op" id="7842000">&amp;</span><span class="ident" id="7842001">icmpEcho</span><span class="op" id="7842009">{</span><span class="ident" id="7842010">ID</span><span class="op" id="7842012">:</span>&nbsp;<span class="builtintype" id="7842014">int</span><span class="op" id="7842017">(</span><span class="ident" id="7842018">b</span><span class="op" id="7842019">[</span><span class="num" id="7842020">0</span><span class="op" id="7842021">]</span><span class="op" id="7842022">)</span><span class="op" id="7842023">&lt;&lt;</span><span class="num" id="7842025">8</span>&nbsp;<span class="op" id="7842027">|</span>&nbsp;<span class="builtintype" id="7842029">int</span><span class="op" id="7842032">(</span><span class="ident" id="7842033">b</span><span class="op" id="7842034">[</span><span class="num" id="7842035">1</span><span class="op" id="7842036">]</span><span class="op" id="7842037">)</span><span class="op" id="7842038">,</span>&nbsp;<span class="ident" id="7842040">Seq</span><span class="op" id="7842043">:</span>&nbsp;<span class="builtintype" id="7842045">int</span><span class="op" id="7842048">(</span><span class="ident" id="7842049">b</span><span class="op" id="7842050">[</span><span class="num" id="7842051">2</span><span class="op" id="7842052">]</span><span class="op" id="7842053">)</span><span class="op" id="7842054">&lt;&lt;</span><span class="num" id="7842056">8</span>&nbsp;<span class="op" id="7842058">|</span>&nbsp;<span class="builtintype" id="7842060">int</span><span class="op" id="7842063">(</span><span class="ident" id="7842064">b</span><span class="op" id="7842065">[</span><span class="num" id="7842066">3</span><span class="op" id="7842067">]</span><span class="op" id="7842068">)</span><span class="op" id="7842069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842072">if</span>&nbsp;<span class="ident" id="7842075">bodylen</span>&nbsp;<span class="op" id="7842083">&gt;</span>&nbsp;<span class="num" id="7842085">4</span>&nbsp;<span class="op" id="7842087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842091">p</span><span class="op" id="7842092">.</span><span class="ident" id="7842093">Data</span>&nbsp;<span class="op" id="7842098">=</span>&nbsp;<span class="builtinfunc" id="7842100">make</span><span class="op" id="7842104">(</span><span class="op" id="7842105">[</span><span class="op" id="7842106">]</span><span class="builtintype" id="7842107">byte</span><span class="op" id="7842111">,</span>&nbsp;<span class="ident" id="7842113">bodylen</span><span class="op" id="7842120">-</span><span class="num" id="7842121">4</span><span class="op" id="7842122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7842126">copy</span><span class="op" id="7842130">(</span><span class="ident" id="7842131">p</span><span class="op" id="7842132">.</span><span class="ident" id="7842133">Data</span><span class="op" id="7842137">,</span>&nbsp;<span class="ident" id="7842139">b</span><span class="op" id="7842140">[</span><span class="num" id="7842141">4</span><span class="op" id="7842142">:</span><span class="op" id="7842143">]</span><span class="op" id="7842144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842147">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842150">return</span>&nbsp;<span class="ident" id="7842157">p</span><span class="op" id="7842158">,</span>&nbsp;<span class="ident" id="7842160">nil</span><br>
<span class="lineno"></span><span class="op" id="7842164">}</span>
</div>
</body>
</html>
