<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html" class="current">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6488708">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6488763">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6488817">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6488868">package</span>&nbsp;<span class="ident" id="6488876">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6488881">import</span>&nbsp;<span class="op" id="6488888">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6488891">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6488901">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="6488904">func</span>&nbsp;<span class="ident" id="6488909">TestRoundUp</span><span class="op" id="6488920">(</span><span class="ident" id="6488921">t</span>&nbsp;<span class="op" id="6488923">*</span><span class="ident" id="6488924">testing</span><span class="op" id="6488931">.</span><span class="ident" id="6488932">T</span><span class="op" id="6488933">)</span>&nbsp;<span class="op" id="6488935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6488938">if</span>&nbsp;<span class="ident" id="6488941">roundUp</span><span class="op" id="6488948">(</span><span class="num" id="6488949">0</span><span class="op" id="6488950">,</span>&nbsp;<span class="num" id="6488952">16</span><span class="op" id="6488954">)</span>&nbsp;<span class="op" id="6488956">!=</span>&nbsp;<span class="num" id="6488959">0</span>&nbsp;<span class="op" id="6488961">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488966">roundUp</span><span class="op" id="6488973">(</span><span class="num" id="6488974">1</span><span class="op" id="6488975">,</span>&nbsp;<span class="num" id="6488977">16</span><span class="op" id="6488979">)</span>&nbsp;<span class="op" id="6488981">!=</span>&nbsp;<span class="num" id="6488984">16</span>&nbsp;<span class="op" id="6488987">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488992">roundUp</span><span class="op" id="6488999">(</span><span class="num" id="6489000">15</span><span class="op" id="6489002">,</span>&nbsp;<span class="num" id="6489004">16</span><span class="op" id="6489006">)</span>&nbsp;<span class="op" id="6489008">!=</span>&nbsp;<span class="num" id="6489011">16</span>&nbsp;<span class="op" id="6489014">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489019">roundUp</span><span class="op" id="6489026">(</span><span class="num" id="6489027">16</span><span class="op" id="6489029">,</span>&nbsp;<span class="num" id="6489031">16</span><span class="op" id="6489033">)</span>&nbsp;<span class="op" id="6489035">!=</span>&nbsp;<span class="num" id="6489038">16</span>&nbsp;<span class="op" id="6489041">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489046">roundUp</span><span class="op" id="6489053">(</span><span class="num" id="6489054">17</span><span class="op" id="6489056">,</span>&nbsp;<span class="num" id="6489058">16</span><span class="op" id="6489060">)</span>&nbsp;<span class="op" id="6489062">!=</span>&nbsp;<span class="num" id="6489065">32</span>&nbsp;<span class="op" id="6489068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489072">t</span><span class="op" id="6489073">.</span><span class="ident" id="6489074">Error</span><span class="op" id="6489079">(</span><span class="string" id="6489080">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="6489096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489099">}</span><br>
<span class="lineno"></span><span class="op" id="6489101">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6489104">var</span>&nbsp;<span class="ident" id="6489108">paddingTests</span>&nbsp;<span class="op" id="6489121">=</span>&nbsp;<span class="op" id="6489123">[</span><span class="op" id="6489124">]</span><span class="keyword" id="6489125">struct</span>&nbsp;<span class="op" id="6489132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489135">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489147">[</span><span class="op" id="6489148">]</span><span class="builtintype" id="6489149">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489155">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6489167">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489173">expectedLen</span>&nbsp;<span class="builtintype" id="6489185">int</span><br>
<span class="lineno">25</span><span class="op" id="6489189">}</span><span class="op" id="6489190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489193">{</span><span class="op" id="6489194">[</span><span class="op" id="6489195">]</span><span class="builtintype" id="6489196">byte</span><span class="op" id="6489200">{</span><span class="num" id="6489201">1</span><span class="op" id="6489202">,</span>&nbsp;<span class="num" id="6489204">2</span><span class="op" id="6489205">,</span>&nbsp;<span class="num" id="6489207">3</span><span class="op" id="6489208">,</span>&nbsp;<span class="num" id="6489210">4</span><span class="op" id="6489211">,</span>&nbsp;<span class="num" id="6489213">0</span><span class="op" id="6489214">}</span><span class="op" id="6489215">,</span>&nbsp;<span class="builtintype" id="6489217">true</span><span class="op" id="6489221">,</span>&nbsp;<span class="num" id="6489223">4</span><span class="op" id="6489224">}</span><span class="op" id="6489225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489228">{</span><span class="op" id="6489229">[</span><span class="op" id="6489230">]</span><span class="builtintype" id="6489231">byte</span><span class="op" id="6489235">{</span><span class="num" id="6489236">1</span><span class="op" id="6489237">,</span>&nbsp;<span class="num" id="6489239">2</span><span class="op" id="6489240">,</span>&nbsp;<span class="num" id="6489242">3</span><span class="op" id="6489243">,</span>&nbsp;<span class="num" id="6489245">4</span><span class="op" id="6489246">,</span>&nbsp;<span class="num" id="6489248">0</span><span class="op" id="6489249">,</span>&nbsp;<span class="num" id="6489251">1</span><span class="op" id="6489252">}</span><span class="op" id="6489253">,</span>&nbsp;<span class="builtintype" id="6489255">false</span><span class="op" id="6489260">,</span>&nbsp;<span class="num" id="6489262">0</span><span class="op" id="6489263">}</span><span class="op" id="6489264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489267">{</span><span class="op" id="6489268">[</span><span class="op" id="6489269">]</span><span class="builtintype" id="6489270">byte</span><span class="op" id="6489274">{</span><span class="num" id="6489275">1</span><span class="op" id="6489276">,</span>&nbsp;<span class="num" id="6489278">2</span><span class="op" id="6489279">,</span>&nbsp;<span class="num" id="6489281">3</span><span class="op" id="6489282">,</span>&nbsp;<span class="num" id="6489284">4</span><span class="op" id="6489285">,</span>&nbsp;<span class="num" id="6489287">99</span><span class="op" id="6489289">,</span>&nbsp;<span class="num" id="6489291">99</span><span class="op" id="6489293">}</span><span class="op" id="6489294">,</span>&nbsp;<span class="builtintype" id="6489296">false</span><span class="op" id="6489301">,</span>&nbsp;<span class="num" id="6489303">0</span><span class="op" id="6489304">}</span><span class="op" id="6489305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489308">{</span><span class="op" id="6489309">[</span><span class="op" id="6489310">]</span><span class="builtintype" id="6489311">byte</span><span class="op" id="6489315">{</span><span class="num" id="6489316">1</span><span class="op" id="6489317">,</span>&nbsp;<span class="num" id="6489319">2</span><span class="op" id="6489320">,</span>&nbsp;<span class="num" id="6489322">3</span><span class="op" id="6489323">,</span>&nbsp;<span class="num" id="6489325">4</span><span class="op" id="6489326">,</span>&nbsp;<span class="num" id="6489328">1</span><span class="op" id="6489329">,</span>&nbsp;<span class="num" id="6489331">1</span><span class="op" id="6489332">}</span><span class="op" id="6489333">,</span>&nbsp;<span class="builtintype" id="6489335">true</span><span class="op" id="6489339">,</span>&nbsp;<span class="num" id="6489341">4</span><span class="op" id="6489342">}</span><span class="op" id="6489343">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489346">{</span><span class="op" id="6489347">[</span><span class="op" id="6489348">]</span><span class="builtintype" id="6489349">byte</span><span class="op" id="6489353">{</span><span class="num" id="6489354">1</span><span class="op" id="6489355">,</span>&nbsp;<span class="num" id="6489357">2</span><span class="op" id="6489358">,</span>&nbsp;<span class="num" id="6489360">3</span><span class="op" id="6489361">,</span>&nbsp;<span class="num" id="6489363">2</span><span class="op" id="6489364">,</span>&nbsp;<span class="num" id="6489366">2</span><span class="op" id="6489367">,</span>&nbsp;<span class="num" id="6489369">2</span><span class="op" id="6489370">}</span><span class="op" id="6489371">,</span>&nbsp;<span class="builtintype" id="6489373">true</span><span class="op" id="6489377">,</span>&nbsp;<span class="num" id="6489379">3</span><span class="op" id="6489380">}</span><span class="op" id="6489381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489384">{</span><span class="op" id="6489385">[</span><span class="op" id="6489386">]</span><span class="builtintype" id="6489387">byte</span><span class="op" id="6489391">{</span><span class="num" id="6489392">1</span><span class="op" id="6489393">,</span>&nbsp;<span class="num" id="6489395">2</span><span class="op" id="6489396">,</span>&nbsp;<span class="num" id="6489398">3</span><span class="op" id="6489399">,</span>&nbsp;<span class="num" id="6489401">3</span><span class="op" id="6489402">,</span>&nbsp;<span class="num" id="6489404">3</span><span class="op" id="6489405">,</span>&nbsp;<span class="num" id="6489407">3</span><span class="op" id="6489408">}</span><span class="op" id="6489409">,</span>&nbsp;<span class="builtintype" id="6489411">true</span><span class="op" id="6489415">,</span>&nbsp;<span class="num" id="6489417">2</span><span class="op" id="6489418">}</span><span class="op" id="6489419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489422">{</span><span class="op" id="6489423">[</span><span class="op" id="6489424">]</span><span class="builtintype" id="6489425">byte</span><span class="op" id="6489429">{</span><span class="num" id="6489430">1</span><span class="op" id="6489431">,</span>&nbsp;<span class="num" id="6489433">2</span><span class="op" id="6489434">,</span>&nbsp;<span class="num" id="6489436">3</span><span class="op" id="6489437">,</span>&nbsp;<span class="num" id="6489439">4</span><span class="op" id="6489440">,</span>&nbsp;<span class="num" id="6489442">3</span><span class="op" id="6489443">,</span>&nbsp;<span class="num" id="6489445">3</span><span class="op" id="6489446">}</span><span class="op" id="6489447">,</span>&nbsp;<span class="builtintype" id="6489449">false</span><span class="op" id="6489454">,</span>&nbsp;<span class="num" id="6489456">0</span><span class="op" id="6489457">}</span><span class="op" id="6489458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489461">{</span><span class="op" id="6489462">[</span><span class="op" id="6489463">]</span><span class="builtintype" id="6489464">byte</span><span class="op" id="6489468">{</span><span class="num" id="6489469">1</span><span class="op" id="6489470">,</span>&nbsp;<span class="num" id="6489472">4</span><span class="op" id="6489473">,</span>&nbsp;<span class="num" id="6489475">4</span><span class="op" id="6489476">,</span>&nbsp;<span class="num" id="6489478">4</span><span class="op" id="6489479">,</span>&nbsp;<span class="num" id="6489481">4</span><span class="op" id="6489482">,</span>&nbsp;<span class="num" id="6489484">4</span><span class="op" id="6489485">}</span><span class="op" id="6489486">,</span>&nbsp;<span class="builtintype" id="6489488">true</span><span class="op" id="6489492">,</span>&nbsp;<span class="num" id="6489494">1</span><span class="op" id="6489495">}</span><span class="op" id="6489496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489499">{</span><span class="op" id="6489500">[</span><span class="op" id="6489501">]</span><span class="builtintype" id="6489502">byte</span><span class="op" id="6489506">{</span><span class="num" id="6489507">5</span><span class="op" id="6489508">,</span>&nbsp;<span class="num" id="6489510">5</span><span class="op" id="6489511">,</span>&nbsp;<span class="num" id="6489513">5</span><span class="op" id="6489514">,</span>&nbsp;<span class="num" id="6489516">5</span><span class="op" id="6489517">,</span>&nbsp;<span class="num" id="6489519">5</span><span class="op" id="6489520">,</span>&nbsp;<span class="num" id="6489522">5</span><span class="op" id="6489523">}</span><span class="op" id="6489524">,</span>&nbsp;<span class="builtintype" id="6489526">true</span><span class="op" id="6489530">,</span>&nbsp;<span class="num" id="6489532">0</span><span class="op" id="6489533">}</span><span class="op" id="6489534">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489537">{</span><span class="op" id="6489538">[</span><span class="op" id="6489539">]</span><span class="builtintype" id="6489540">byte</span><span class="op" id="6489544">{</span><span class="num" id="6489545">6</span><span class="op" id="6489546">,</span>&nbsp;<span class="num" id="6489548">6</span><span class="op" id="6489549">,</span>&nbsp;<span class="num" id="6489551">6</span><span class="op" id="6489552">,</span>&nbsp;<span class="num" id="6489554">6</span><span class="op" id="6489555">,</span>&nbsp;<span class="num" id="6489557">6</span><span class="op" id="6489558">,</span>&nbsp;<span class="num" id="6489560">6</span><span class="op" id="6489561">}</span><span class="op" id="6489562">,</span>&nbsp;<span class="builtintype" id="6489564">false</span><span class="op" id="6489569">,</span>&nbsp;<span class="num" id="6489571">0</span><span class="op" id="6489572">}</span><span class="op" id="6489573">,</span><br>
<span class="lineno"></span><span class="op" id="6489575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6489578">func</span>&nbsp;<span class="ident" id="6489583">TestRemovePadding</span><span class="op" id="6489600">(</span><span class="ident" id="6489601">t</span>&nbsp;<span class="op" id="6489603">*</span><span class="ident" id="6489604">testing</span><span class="op" id="6489611">.</span><span class="ident" id="6489612">T</span><span class="op" id="6489613">)</span>&nbsp;<span class="op" id="6489615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6489618">for</span>&nbsp;<span class="ident" id="6489622">i</span><span class="op" id="6489623">,</span>&nbsp;<span class="ident" id="6489625">test</span>&nbsp;<span class="op" id="6489630">:=</span>&nbsp;<span class="keyword" id="6489633">range</span>&nbsp;<span class="ident" id="6489639">paddingTests</span>&nbsp;<span class="op" id="6489652">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489656">payload</span><span class="op" id="6489663">,</span>&nbsp;<span class="ident" id="6489665">good</span>&nbsp;<span class="op" id="6489670">:=</span>&nbsp;<span class="ident" id="6489673">removePadding</span><span class="op" id="6489686">(</span><span class="ident" id="6489687">test</span><span class="op" id="6489691">.</span><span class="ident" id="6489692">in</span><span class="op" id="6489694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489698">expectedGood</span>&nbsp;<span class="op" id="6489711">:=</span>&nbsp;<span class="builtintype" id="6489714">byte</span><span class="op" id="6489718">(</span><span class="num" id="6489719">255</span><span class="op" id="6489722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6489726">if</span>&nbsp;<span class="op" id="6489729">!</span><span class="ident" id="6489730">test</span><span class="op" id="6489734">.</span><span class="ident" id="6489735">good</span>&nbsp;<span class="op" id="6489740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489745">expectedGood</span>&nbsp;<span class="op" id="6489758">=</span>&nbsp;<span class="num" id="6489760">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489764">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6489768">if</span>&nbsp;<span class="ident" id="6489771">good</span>&nbsp;<span class="op" id="6489776">!=</span>&nbsp;<span class="ident" id="6489779">expectedGood</span>&nbsp;<span class="op" id="6489792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489797">t</span><span class="op" id="6489798">.</span><span class="ident" id="6489799">Errorf</span><span class="op" id="6489805">(</span><span class="string" id="6489806">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="6489843">,</span>&nbsp;<span class="ident" id="6489845">i</span><span class="op" id="6489846">,</span>&nbsp;<span class="ident" id="6489848">expectedGood</span><span class="op" id="6489860">,</span>&nbsp;<span class="ident" id="6489862">good</span><span class="op" id="6489866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6489874">if</span>&nbsp;<span class="ident" id="6489877">good</span>&nbsp;<span class="op" id="6489882">==</span>&nbsp;<span class="num" id="6489885">255</span>&nbsp;<span class="op" id="6489889">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6489892">len</span><span class="op" id="6489895">(</span><span class="ident" id="6489896">payload</span><span class="op" id="6489903">)</span>&nbsp;<span class="op" id="6489905">!=</span>&nbsp;<span class="ident" id="6489908">test</span><span class="op" id="6489912">.</span><span class="ident" id="6489913">expectedLen</span>&nbsp;<span class="op" id="6489925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489930">t</span><span class="op" id="6489931">.</span><span class="ident" id="6489932">Errorf</span><span class="op" id="6489938">(</span><span class="string" id="6489939">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6489961">,</span>&nbsp;<span class="ident" id="6489963">i</span><span class="op" id="6489964">,</span>&nbsp;<span class="builtinfunc" id="6489966">len</span><span class="op" id="6489969">(</span><span class="ident" id="6489970">payload</span><span class="op" id="6489977">)</span><span class="op" id="6489978">,</span>&nbsp;<span class="ident" id="6489980">test</span><span class="op" id="6489984">.</span><span class="ident" id="6489985">expectedLen</span><span class="op" id="6489996">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6490000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6490003">}</span><br>
<span class="lineno"></span><span class="op" id="6490005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6490008">var</span>&nbsp;<span class="ident" id="6490012">certExampleCom</span>&nbsp;<span class="op" id="6490027">=</span>&nbsp;<span class="string" id="6490029">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="6490681">var</span>&nbsp;<span class="ident" id="6490685">certWildcardExampleCom</span>&nbsp;<span class="op" id="6490708">=</span>&nbsp;<span class="string" id="6490710">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6491366">var</span>&nbsp;<span class="ident" id="6491370">certFooExampleCom</span>&nbsp;<span class="op" id="6491388">=</span>&nbsp;<span class="string" id="6491390">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="6492050">var</span>&nbsp;<span class="ident" id="6492054">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="6492083">=</span>&nbsp;<span class="string" id="6492085">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6492745">func</span>&nbsp;<span class="ident" id="6492750">TestCertificateSelection</span><span class="op" id="6492774">(</span><span class="ident" id="6492775">t</span>&nbsp;<span class="op" id="6492777">*</span><span class="ident" id="6492778">testing</span><span class="op" id="6492785">.</span><span class="ident" id="6492786">T</span><span class="op" id="6492787">)</span>&nbsp;<span class="op" id="6492789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492792">config</span>&nbsp;<span class="op" id="6492799">:=</span>&nbsp;<span class="ident" id="6492802">Config</span><span class="op" id="6492808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492812">Certificates</span><span class="op" id="6492824">:</span>&nbsp;<span class="op" id="6492826">[</span><span class="op" id="6492827">]</span><span class="ident" id="6492828">Certificate</span><span class="op" id="6492839">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492850">Certificate</span><span class="op" id="6492861">:</span>&nbsp;<span class="op" id="6492863">[</span><span class="op" id="6492864">]</span><span class="op" id="6492865">[</span><span class="op" id="6492866">]</span><span class="builtintype" id="6492867">byte</span><span class="op" id="6492871">{</span><span class="ident" id="6492872">fromHex</span><span class="op" id="6492879">(</span><span class="ident" id="6492880">certExampleCom</span><span class="op" id="6492894">)</span><span class="op" id="6492895">}</span><span class="op" id="6492896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492901">}</span><span class="op" id="6492902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492913">Certificate</span><span class="op" id="6492924">:</span>&nbsp;<span class="op" id="6492926">[</span><span class="op" id="6492927">]</span><span class="op" id="6492928">[</span><span class="op" id="6492929">]</span><span class="builtintype" id="6492930">byte</span><span class="op" id="6492934">{</span><span class="ident" id="6492935">fromHex</span><span class="op" id="6492942">(</span><span class="ident" id="6492943">certWildcardExampleCom</span><span class="op" id="6492965">)</span><span class="op" id="6492966">}</span><span class="op" id="6492967">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492972">}</span><span class="op" id="6492973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492984">Certificate</span><span class="op" id="6492995">:</span>&nbsp;<span class="op" id="6492997">[</span><span class="op" id="6492998">]</span><span class="op" id="6492999">[</span><span class="op" id="6493000">]</span><span class="builtintype" id="6493001">byte</span><span class="op" id="6493005">{</span><span class="ident" id="6493006">fromHex</span><span class="op" id="6493013">(</span><span class="ident" id="6493014">certFooExampleCom</span><span class="op" id="6493031">)</span><span class="op" id="6493032">}</span><span class="op" id="6493033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493038">}</span><span class="op" id="6493039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493044">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493050">Certificate</span><span class="op" id="6493061">:</span>&nbsp;<span class="op" id="6493063">[</span><span class="op" id="6493064">]</span><span class="op" id="6493065">[</span><span class="op" id="6493066">]</span><span class="builtintype" id="6493067">byte</span><span class="op" id="6493071">{</span><span class="ident" id="6493072">fromHex</span><span class="op" id="6493079">(</span><span class="ident" id="6493080">certDoubleWildcardExampleCom</span><span class="op" id="6493108">)</span><span class="op" id="6493109">}</span><span class="op" id="6493110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493115">}</span><span class="op" id="6493116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493120">}</span><span class="op" id="6493121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493128">config</span><span class="op" id="6493134">.</span><span class="ident" id="6493135">BuildNameToCertificate</span><span class="op" id="6493157">(</span><span class="op" id="6493158">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493162">pointerToIndex</span>&nbsp;<span class="op" id="6493177">:=</span>&nbsp;<span class="keyword" id="6493180">func</span><span class="op" id="6493184">(</span><span class="ident" id="6493185">c</span>&nbsp;<span class="op" id="6493187">*</span><span class="ident" id="6493188">Certificate</span><span class="op" id="6493199">)</span>&nbsp;<span class="builtintype" id="6493201">int</span>&nbsp;<span class="op" id="6493205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493209">for</span>&nbsp;<span class="ident" id="6493213">i</span>&nbsp;<span class="op" id="6493215">:=</span>&nbsp;<span class="keyword" id="6493218">range</span>&nbsp;<span class="ident" id="6493224">config</span><span class="op" id="6493230">.</span><span class="ident" id="6493231">Certificates</span>&nbsp;<span class="op" id="6493244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493249">if</span>&nbsp;<span class="ident" id="6493252">c</span>&nbsp;<span class="op" id="6493254">==</span>&nbsp;<span class="op" id="6493257">&amp;</span><span class="ident" id="6493258">config</span><span class="op" id="6493264">.</span><span class="ident" id="6493265">Certificates</span><span class="op" id="6493277">[</span><span class="ident" id="6493278">i</span><span class="op" id="6493279">]</span>&nbsp;<span class="op" id="6493281">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493287">return</span>&nbsp;<span class="ident" id="6493294">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493307">return</span>&nbsp;<span class="op" id="6493314">-</span><span class="num" id="6493315">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493318">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493322">certificateForName</span>&nbsp;<span class="op" id="6493341">:=</span>&nbsp;<span class="keyword" id="6493344">func</span><span class="op" id="6493348">(</span><span class="ident" id="6493349">name</span>&nbsp;<span class="builtintype" id="6493354">string</span><span class="op" id="6493360">)</span>&nbsp;<span class="op" id="6493362">*</span><span class="ident" id="6493363">Certificate</span>&nbsp;<span class="op" id="6493375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493379">clientHello</span>&nbsp;<span class="op" id="6493391">:=</span>&nbsp;<span class="op" id="6493394">&amp;</span><span class="ident" id="6493395">ClientHelloInfo</span><span class="op" id="6493410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493415">ServerName</span><span class="op" id="6493425">:</span>&nbsp;<span class="ident" id="6493427">name</span><span class="op" id="6493431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493435">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493439">if</span>&nbsp;<span class="ident" id="6493442">cert</span><span class="op" id="6493446">,</span>&nbsp;<span class="ident" id="6493448">err</span>&nbsp;<span class="op" id="6493452">:=</span>&nbsp;<span class="ident" id="6493455">config</span><span class="op" id="6493461">.</span><span class="ident" id="6493462">getCertificate</span><span class="op" id="6493476">(</span><span class="ident" id="6493477">clientHello</span><span class="op" id="6493488">)</span><span class="op" id="6493489">;</span>&nbsp;<span class="ident" id="6493491">err</span>&nbsp;<span class="op" id="6493495">!=</span>&nbsp;<span class="ident" id="6493498">nil</span>&nbsp;<span class="op" id="6493502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493507">t</span><span class="op" id="6493508">.</span><span class="ident" id="6493509">Errorf</span><span class="op" id="6493515">(</span><span class="string" id="6493516">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="6493561">,</span>&nbsp;<span class="ident" id="6493563">name</span><span class="op" id="6493567">,</span>&nbsp;<span class="ident" id="6493569">err</span><span class="op" id="6493572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493577">return</span>&nbsp;<span class="ident" id="6493584">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493590">}</span>&nbsp;<span class="keyword" id="6493592">else</span>&nbsp;<span class="op" id="6493597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493602">return</span>&nbsp;<span class="ident" id="6493609">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493623">if</span>&nbsp;<span class="ident" id="6493626">n</span>&nbsp;<span class="op" id="6493628">:=</span>&nbsp;<span class="ident" id="6493631">pointerToIndex</span><span class="op" id="6493645">(</span><span class="ident" id="6493646">certificateForName</span><span class="op" id="6493664">(</span><span class="string" id="6493665">&#34;example.com&#34;</span><span class="op" id="6493678">)</span><span class="op" id="6493679">)</span><span class="op" id="6493680">;</span>&nbsp;<span class="ident" id="6493682">n</span>&nbsp;<span class="op" id="6493684">!=</span>&nbsp;<span class="num" id="6493687">0</span>&nbsp;<span class="op" id="6493689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493693">t</span><span class="op" id="6493694">.</span><span class="ident" id="6493695">Errorf</span><span class="op" id="6493701">(</span><span class="string" id="6493702">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="6493746">,</span>&nbsp;<span class="ident" id="6493748">n</span><span class="op" id="6493749">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493755">if</span>&nbsp;<span class="ident" id="6493758">n</span>&nbsp;<span class="op" id="6493760">:=</span>&nbsp;<span class="ident" id="6493763">pointerToIndex</span><span class="op" id="6493777">(</span><span class="ident" id="6493778">certificateForName</span><span class="op" id="6493796">(</span><span class="string" id="6493797">&#34;bar.example.com&#34;</span><span class="op" id="6493814">)</span><span class="op" id="6493815">)</span><span class="op" id="6493816">;</span>&nbsp;<span class="ident" id="6493818">n</span>&nbsp;<span class="op" id="6493820">!=</span>&nbsp;<span class="num" id="6493823">1</span>&nbsp;<span class="op" id="6493825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493829">t</span><span class="op" id="6493830">.</span><span class="ident" id="6493831">Errorf</span><span class="op" id="6493837">(</span><span class="string" id="6493838">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="6493886">,</span>&nbsp;<span class="ident" id="6493888">n</span><span class="op" id="6493889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493895">if</span>&nbsp;<span class="ident" id="6493898">n</span>&nbsp;<span class="op" id="6493900">:=</span>&nbsp;<span class="ident" id="6493903">pointerToIndex</span><span class="op" id="6493917">(</span><span class="ident" id="6493918">certificateForName</span><span class="op" id="6493936">(</span><span class="string" id="6493937">&#34;foo.example.com&#34;</span><span class="op" id="6493954">)</span><span class="op" id="6493955">)</span><span class="op" id="6493956">;</span>&nbsp;<span class="ident" id="6493958">n</span>&nbsp;<span class="op" id="6493960">!=</span>&nbsp;<span class="num" id="6493963">2</span>&nbsp;<span class="op" id="6493965">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493969">t</span><span class="op" id="6493970">.</span><span class="ident" id="6493971">Errorf</span><span class="op" id="6493977">(</span><span class="string" id="6493978">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="6494026">,</span>&nbsp;<span class="ident" id="6494028">n</span><span class="op" id="6494029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6494035">if</span>&nbsp;<span class="ident" id="6494038">n</span>&nbsp;<span class="op" id="6494040">:=</span>&nbsp;<span class="ident" id="6494043">pointerToIndex</span><span class="op" id="6494057">(</span><span class="ident" id="6494058">certificateForName</span><span class="op" id="6494076">(</span><span class="string" id="6494077">&#34;foo.bar.example.com&#34;</span><span class="op" id="6494098">)</span><span class="op" id="6494099">)</span><span class="op" id="6494100">;</span>&nbsp;<span class="ident" id="6494102">n</span>&nbsp;<span class="op" id="6494104">!=</span>&nbsp;<span class="num" id="6494107">3</span>&nbsp;<span class="op" id="6494109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6494113">t</span><span class="op" id="6494114">.</span><span class="ident" id="6494115">Errorf</span><span class="op" id="6494121">(</span><span class="string" id="6494122">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="6494174">,</span>&nbsp;<span class="ident" id="6494176">n</span><span class="op" id="6494177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494180">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6494183">if</span>&nbsp;<span class="ident" id="6494186">n</span>&nbsp;<span class="op" id="6494188">:=</span>&nbsp;<span class="ident" id="6494191">pointerToIndex</span><span class="op" id="6494205">(</span><span class="ident" id="6494206">certificateForName</span><span class="op" id="6494224">(</span><span class="string" id="6494225">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="6494250">)</span><span class="op" id="6494251">)</span><span class="op" id="6494252">;</span>&nbsp;<span class="ident" id="6494254">n</span>&nbsp;<span class="op" id="6494256">!=</span>&nbsp;<span class="num" id="6494259">0</span>&nbsp;<span class="op" id="6494261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6494265">t</span><span class="op" id="6494266">.</span><span class="ident" id="6494267">Errorf</span><span class="op" id="6494273">(</span><span class="string" id="6494274">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="6494330">,</span>&nbsp;<span class="ident" id="6494332">n</span><span class="op" id="6494333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494336">}</span><br>
<span class="lineno"></span><span class="op" id="6494338">}</span>
</div>
</body>
</html>
