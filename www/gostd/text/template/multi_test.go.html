<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8419433">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8419488">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8419542">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8419593">package</span>&nbsp;<span class="ident" id="8419601">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8419611">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8419666">import</span>&nbsp;<span class="op" id="8419673">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8419676">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8419685">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8419692">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8419703">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8419714">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8419736">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8419739">const</span>&nbsp;<span class="op" id="8419745">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419748">noError</span>&nbsp;&nbsp;<span class="op" id="8419757">=</span>&nbsp;<span class="builtintype" id="8419759">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419765">hasError</span>&nbsp;<span class="op" id="8419774">=</span>&nbsp;<span class="builtintype" id="8419776">false</span><br>
<span class="lineno">20</span><span class="op" id="8419782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8419785">type</span>&nbsp;<span class="ident" id="8419790">multiParseTest</span>&nbsp;<span class="keyword" id="8419805">struct</span>&nbsp;<span class="op" id="8419812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419815">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8419823">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419831">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8419839">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419847">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8419855">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419861">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8419869">[</span><span class="op" id="8419870">]</span><span class="builtintype" id="8419871">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419879">results</span>&nbsp;<span class="op" id="8419887">[</span><span class="op" id="8419888">]</span><span class="builtintype" id="8419889">string</span><br>
<span class="lineno"></span><span class="op" id="8419896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8419899">var</span>&nbsp;<span class="ident" id="8419903">multiParseTests</span>&nbsp;<span class="op" id="8419919">=</span>&nbsp;<span class="op" id="8419921">[</span><span class="op" id="8419922">]</span><span class="ident" id="8419923">multiParseTest</span><span class="op" id="8419937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419940">{</span><span class="string" id="8419941">&#34;empty&#34;</span><span class="op" id="8419948">,</span>&nbsp;<span class="string" id="8419950">&#34;&#34;</span><span class="op" id="8419952">,</span>&nbsp;<span class="ident" id="8419954">noError</span><span class="op" id="8419961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419965">nil</span><span class="op" id="8419968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8419972">nil</span><span class="op" id="8419975">}</span><span class="op" id="8419976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8419979">{</span><span class="string" id="8419980">&#34;one&#34;</span><span class="op" id="8419985">,</span>&nbsp;<span class="string" id="8419987">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="8420017">,</span>&nbsp;<span class="ident" id="8420019">noError</span><span class="op" id="8420026">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420030">[</span><span class="op" id="8420031">]</span><span class="builtintype" id="8420032">string</span><span class="op" id="8420038">{</span><span class="string" id="8420039">&#34;foo&#34;</span><span class="op" id="8420044">}</span><span class="op" id="8420045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420049">[</span><span class="op" id="8420050">]</span><span class="builtintype" id="8420051">string</span><span class="op" id="8420057">{</span><span class="string" id="8420058">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="8420065">}</span><span class="op" id="8420066">}</span><span class="op" id="8420067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420070">{</span><span class="string" id="8420071">&#34;two&#34;</span><span class="op" id="8420076">,</span>&nbsp;<span class="string" id="8420078">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="8420136">,</span>&nbsp;<span class="ident" id="8420138">noError</span><span class="op" id="8420145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420149">[</span><span class="op" id="8420150">]</span><span class="builtintype" id="8420151">string</span><span class="op" id="8420157">{</span><span class="string" id="8420158">&#34;foo&#34;</span><span class="op" id="8420163">,</span>&nbsp;<span class="string" id="8420165">&#34;bar&#34;</span><span class="op" id="8420170">}</span><span class="op" id="8420171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420175">[</span><span class="op" id="8420176">]</span><span class="builtintype" id="8420177">string</span><span class="op" id="8420183">{</span><span class="string" id="8420184">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="8420191">,</span>&nbsp;<span class="string" id="8420193">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="8420200">}</span><span class="op" id="8420201">}</span><span class="op" id="8420202">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8420205">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420216">{</span><span class="string" id="8420217">&#34;missing&nbsp;end&#34;</span><span class="op" id="8420230">,</span>&nbsp;<span class="string" id="8420232">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="8420255">,</span>&nbsp;<span class="ident" id="8420257">hasError</span><span class="op" id="8420265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420269">nil</span><span class="op" id="8420272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420276">nil</span><span class="op" id="8420279">}</span><span class="op" id="8420280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420283">{</span><span class="string" id="8420284">&#34;malformed&nbsp;name&#34;</span><span class="op" id="8420300">,</span>&nbsp;<span class="string" id="8420302">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="8420324">,</span>&nbsp;<span class="ident" id="8420326">hasError</span><span class="op" id="8420334">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420338">nil</span><span class="op" id="8420341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420345">nil</span><span class="op" id="8420348">}</span><span class="op" id="8420349">,</span><br>
<span class="lineno"></span><span class="op" id="8420351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8420354">func</span>&nbsp;<span class="ident" id="8420359">TestMultiParse</span><span class="op" id="8420373">(</span><span class="ident" id="8420374">t</span>&nbsp;<span class="op" id="8420376">*</span><span class="ident" id="8420377">testing</span><span class="op" id="8420384">.</span><span class="ident" id="8420385">T</span><span class="op" id="8420386">)</span>&nbsp;<span class="op" id="8420388">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420391">for</span>&nbsp;<span class="ident" id="8420395">_</span><span class="op" id="8420396">,</span>&nbsp;<span class="ident" id="8420398">test</span>&nbsp;<span class="op" id="8420403">:=</span>&nbsp;<span class="keyword" id="8420406">range</span>&nbsp;<span class="ident" id="8420412">multiParseTests</span>&nbsp;<span class="op" id="8420428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420432">template</span><span class="op" id="8420440">,</span>&nbsp;<span class="ident" id="8420442">err</span>&nbsp;<span class="op" id="8420446">:=</span>&nbsp;<span class="ident" id="8420449">New</span><span class="op" id="8420452">(</span><span class="string" id="8420453">&#34;root&#34;</span><span class="op" id="8420459">)</span><span class="op" id="8420460">.</span><span class="ident" id="8420461">Parse</span><span class="op" id="8420466">(</span><span class="ident" id="8420467">test</span><span class="op" id="8420471">.</span><span class="ident" id="8420472">input</span><span class="op" id="8420477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420481">switch</span>&nbsp;<span class="op" id="8420488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420492">case</span>&nbsp;<span class="ident" id="8420497">err</span>&nbsp;<span class="op" id="8420501">==</span>&nbsp;<span class="ident" id="8420504">nil</span>&nbsp;<span class="op" id="8420508">&amp;&amp;</span>&nbsp;<span class="op" id="8420511">!</span><span class="ident" id="8420512">test</span><span class="op" id="8420516">.</span><span class="ident" id="8420517">ok</span><span class="op" id="8420519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420524">t</span><span class="op" id="8420525">.</span><span class="ident" id="8420526">Errorf</span><span class="op" id="8420532">(</span><span class="string" id="8420533">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8420563">,</span>&nbsp;<span class="ident" id="8420565">test</span><span class="op" id="8420569">.</span><span class="ident" id="8420570">name</span><span class="op" id="8420574">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420579">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420590">case</span>&nbsp;<span class="ident" id="8420595">err</span>&nbsp;<span class="op" id="8420599">!=</span>&nbsp;<span class="ident" id="8420602">nil</span>&nbsp;<span class="op" id="8420606">&amp;&amp;</span>&nbsp;<span class="ident" id="8420609">test</span><span class="op" id="8420613">.</span><span class="ident" id="8420614">ok</span><span class="op" id="8420616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420621">t</span><span class="op" id="8420622">.</span><span class="ident" id="8420623">Errorf</span><span class="op" id="8420629">(</span><span class="string" id="8420630">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8420656">,</span>&nbsp;<span class="ident" id="8420658">test</span><span class="op" id="8420662">.</span><span class="ident" id="8420663">name</span><span class="op" id="8420667">,</span>&nbsp;<span class="ident" id="8420669">err</span><span class="op" id="8420672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420677">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420688">case</span>&nbsp;<span class="ident" id="8420693">err</span>&nbsp;<span class="op" id="8420697">!=</span>&nbsp;<span class="ident" id="8420700">nil</span>&nbsp;<span class="op" id="8420704">&amp;&amp;</span>&nbsp;<span class="op" id="8420707">!</span><span class="ident" id="8420708">test</span><span class="op" id="8420712">.</span><span class="ident" id="8420713">ok</span><span class="op" id="8420715">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8420720">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420750">if</span>&nbsp;<span class="op" id="8420753">*</span><span class="ident" id="8420754">debug</span>&nbsp;<span class="op" id="8420760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420766">fmt</span><span class="op" id="8420769">.</span><span class="ident" id="8420770">Printf</span><span class="op" id="8420776">(</span><span class="string" id="8420777">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="8420793">,</span>&nbsp;<span class="ident" id="8420795">test</span><span class="op" id="8420799">.</span><span class="ident" id="8420800">name</span><span class="op" id="8420804">,</span>&nbsp;<span class="ident" id="8420806">test</span><span class="op" id="8420810">.</span><span class="ident" id="8420811">input</span><span class="op" id="8420816">,</span>&nbsp;<span class="ident" id="8420818">err</span><span class="op" id="8420821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420831">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420846">if</span>&nbsp;<span class="ident" id="8420849">template</span>&nbsp;<span class="op" id="8420858">==</span>&nbsp;<span class="ident" id="8420861">nil</span>&nbsp;<span class="op" id="8420865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420870">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8420881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8420885">if</span>&nbsp;<span class="builtinfunc" id="8420888">len</span><span class="op" id="8420891">(</span><span class="ident" id="8420892">template</span><span class="op" id="8420900">.</span><span class="ident" id="8420901">tmpl</span><span class="op" id="8420905">)</span>&nbsp;<span class="op" id="8420907">!=</span>&nbsp;<span class="builtinfunc" id="8420910">len</span><span class="op" id="8420913">(</span><span class="ident" id="8420914">test</span><span class="op" id="8420918">.</span><span class="ident" id="8420919">names</span><span class="op" id="8420924">)</span><span class="op" id="8420925">+</span><span class="num" id="8420926">1</span>&nbsp;<span class="op" id="8420928">{</span>&nbsp;<span class="comment" id="8420930">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8420948">t</span><span class="op" id="8420949">.</span><span class="ident" id="8420950">Errorf</span><span class="op" id="8420956">(</span><span class="string" id="8420957">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8421006">,</span>&nbsp;<span class="ident" id="8421008">test</span><span class="op" id="8421012">.</span><span class="ident" id="8421013">name</span><span class="op" id="8421017">,</span>&nbsp;<span class="builtinfunc" id="8421019">len</span><span class="op" id="8421022">(</span><span class="ident" id="8421023">test</span><span class="op" id="8421027">.</span><span class="ident" id="8421028">names</span><span class="op" id="8421033">)</span><span class="op" id="8421034">,</span>&nbsp;<span class="builtinfunc" id="8421036">len</span><span class="op" id="8421039">(</span><span class="ident" id="8421040">template</span><span class="op" id="8421048">.</span><span class="ident" id="8421049">tmpl</span><span class="op" id="8421053">)</span><span class="op" id="8421054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421059">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421074">for</span>&nbsp;<span class="ident" id="8421078">i</span><span class="op" id="8421079">,</span>&nbsp;<span class="ident" id="8421081">name</span>&nbsp;<span class="op" id="8421086">:=</span>&nbsp;<span class="keyword" id="8421089">range</span>&nbsp;<span class="ident" id="8421095">test</span><span class="op" id="8421099">.</span><span class="ident" id="8421100">names</span>&nbsp;<span class="op" id="8421106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421111">tmpl</span><span class="op" id="8421115">,</span>&nbsp;<span class="ident" id="8421117">ok</span>&nbsp;<span class="op" id="8421120">:=</span>&nbsp;<span class="ident" id="8421123">template</span><span class="op" id="8421131">.</span><span class="ident" id="8421132">tmpl</span><span class="op" id="8421136">[</span><span class="ident" id="8421137">name</span><span class="op" id="8421141">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421146">if</span>&nbsp;<span class="op" id="8421149">!</span><span class="ident" id="8421150">ok</span>&nbsp;<span class="op" id="8421153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421159">t</span><span class="op" id="8421160">.</span><span class="ident" id="8421161">Errorf</span><span class="op" id="8421167">(</span><span class="string" id="8421168">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="8421196">,</span>&nbsp;<span class="ident" id="8421198">test</span><span class="op" id="8421202">.</span><span class="ident" id="8421203">name</span><span class="op" id="8421207">,</span>&nbsp;<span class="ident" id="8421209">name</span><span class="op" id="8421213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421219">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421236">result</span>&nbsp;<span class="op" id="8421243">:=</span>&nbsp;<span class="ident" id="8421246">tmpl</span><span class="op" id="8421250">.</span><span class="ident" id="8421251">Root</span><span class="op" id="8421255">.</span><span class="ident" id="8421256">String</span><span class="op" id="8421262">(</span><span class="op" id="8421263">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8421268">if</span>&nbsp;<span class="ident" id="8421271">result</span>&nbsp;<span class="op" id="8421278">!=</span>&nbsp;<span class="ident" id="8421281">test</span><span class="op" id="8421285">.</span><span class="ident" id="8421286">results</span><span class="op" id="8421293">[</span><span class="ident" id="8421294">i</span><span class="op" id="8421295">]</span>&nbsp;<span class="op" id="8421297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8421303">t</span><span class="op" id="8421304">.</span><span class="ident" id="8421305">Errorf</span><span class="op" id="8421311">(</span><span class="string" id="8421312">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="8421348">,</span>&nbsp;<span class="ident" id="8421350">test</span><span class="op" id="8421354">.</span><span class="ident" id="8421355">name</span><span class="op" id="8421359">,</span>&nbsp;<span class="ident" id="8421361">test</span><span class="op" id="8421365">.</span><span class="ident" id="8421366">input</span><span class="op" id="8421371">,</span>&nbsp;<span class="ident" id="8421373">result</span><span class="op" id="8421379">,</span>&nbsp;<span class="ident" id="8421381">test</span><span class="op" id="8421385">.</span><span class="ident" id="8421386">results</span><span class="op" id="8421393">[</span><span class="ident" id="8421394">i</span><span class="op" id="8421395">]</span><span class="op" id="8421396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421408">}</span><br>
<span class="lineno">85</span><span class="op" id="8421410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8421413">var</span>&nbsp;<span class="ident" id="8421417">multiExecTests</span>&nbsp;<span class="op" id="8421432">=</span>&nbsp;<span class="op" id="8421434">[</span><span class="op" id="8421435">]</span><span class="ident" id="8421436">execTest</span><span class="op" id="8421444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421447">{</span><span class="string" id="8421448">&#34;empty&#34;</span><span class="op" id="8421455">,</span>&nbsp;<span class="string" id="8421457">&#34;&#34;</span><span class="op" id="8421459">,</span>&nbsp;<span class="string" id="8421461">&#34;&#34;</span><span class="op" id="8421463">,</span>&nbsp;<span class="ident" id="8421465">nil</span><span class="op" id="8421468">,</span>&nbsp;<span class="builtintype" id="8421470">true</span><span class="op" id="8421474">}</span><span class="op" id="8421475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421478">{</span><span class="string" id="8421479">&#34;text&#34;</span><span class="op" id="8421485">,</span>&nbsp;<span class="string" id="8421487">&#34;some&nbsp;text&#34;</span><span class="op" id="8421498">,</span>&nbsp;<span class="string" id="8421500">&#34;some&nbsp;text&#34;</span><span class="op" id="8421511">,</span>&nbsp;<span class="ident" id="8421513">nil</span><span class="op" id="8421516">,</span>&nbsp;<span class="builtintype" id="8421518">true</span><span class="op" id="8421522">}</span><span class="op" id="8421523">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421526">{</span><span class="string" id="8421527">&#34;invoke&nbsp;x&#34;</span><span class="op" id="8421537">,</span>&nbsp;<span class="string" id="8421539">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="8421561">,</span>&nbsp;<span class="string" id="8421563">&#34;TEXT&#34;</span><span class="op" id="8421569">,</span>&nbsp;<span class="ident" id="8421571">tVal</span><span class="op" id="8421575">,</span>&nbsp;<span class="builtintype" id="8421577">true</span><span class="op" id="8421581">}</span><span class="op" id="8421582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421585">{</span><span class="string" id="8421586">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="8421604">,</span>&nbsp;<span class="string" id="8421606">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="8421624">,</span>&nbsp;<span class="string" id="8421626">&#34;TEXT&#34;</span><span class="op" id="8421632">,</span>&nbsp;<span class="ident" id="8421634">tVal</span><span class="op" id="8421638">,</span>&nbsp;<span class="builtintype" id="8421640">true</span><span class="op" id="8421644">}</span><span class="op" id="8421645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421648">{</span><span class="string" id="8421649">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="8421665">,</span>&nbsp;<span class="string" id="8421667">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="8421690">,</span>&nbsp;<span class="string" id="8421692">&#34;17&#34;</span><span class="op" id="8421696">,</span>&nbsp;<span class="ident" id="8421698">tVal</span><span class="op" id="8421702">,</span>&nbsp;<span class="builtintype" id="8421704">true</span><span class="op" id="8421708">}</span><span class="op" id="8421709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421712">{</span><span class="string" id="8421713">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="8421731">,</span>&nbsp;<span class="string" id="8421733">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="8421757">,</span>&nbsp;<span class="string" id="8421759">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="8421768">,</span>&nbsp;<span class="ident" id="8421770">tVal</span><span class="op" id="8421774">,</span>&nbsp;<span class="builtintype" id="8421776">true</span><span class="op" id="8421780">}</span><span class="op" id="8421781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421784">{</span><span class="string" id="8421785">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="8421798">,</span>&nbsp;<span class="string" id="8421800">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="8421824">,</span>&nbsp;<span class="string" id="8421826">&#34;v&#34;</span><span class="op" id="8421829">,</span>&nbsp;<span class="ident" id="8421831">tVal</span><span class="op" id="8421835">,</span>&nbsp;<span class="builtintype" id="8421837">true</span><span class="op" id="8421841">}</span><span class="op" id="8421842">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421845">{</span><span class="string" id="8421846">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="8421865">,</span>&nbsp;<span class="string" id="8421867">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="8421893">,</span>&nbsp;<span class="string" id="8421895">&#34;17&#34;</span><span class="op" id="8421899">,</span>&nbsp;<span class="ident" id="8421901">tVal</span><span class="op" id="8421905">,</span>&nbsp;<span class="builtintype" id="8421907">true</span><span class="op" id="8421911">}</span><span class="op" id="8421912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8421915">{</span><span class="string" id="8421916">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="8421947">,</span>&nbsp;<span class="string" id="8421949">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="8421995">,</span>&nbsp;<span class="string" id="8421997">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="8422008">,</span>&nbsp;<span class="ident" id="8422010">tVal</span><span class="op" id="8422014">,</span>&nbsp;<span class="builtintype" id="8422016">true</span><span class="op" id="8422020">}</span><span class="op" id="8422021">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8422025">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422077">{</span><span class="string" id="8422078">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="8422096">,</span>&nbsp;<span class="string" id="8422098">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="8422116">,</span>&nbsp;<span class="string" id="8422118">&#34;oneArg=joe&#34;</span><span class="op" id="8422130">,</span>&nbsp;<span class="ident" id="8422132">tVal</span><span class="op" id="8422136">,</span>&nbsp;<span class="builtintype" id="8422138">true</span><span class="op" id="8422142">}</span><span class="op" id="8422143">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422146">{</span><span class="string" id="8422147">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="8422159">,</span>&nbsp;<span class="string" id="8422161">`{{oneArg&nbsp;.}}`</span><span class="op" id="8422175">,</span>&nbsp;<span class="string" id="8422177">&#34;oneArg=joe&#34;</span><span class="op" id="8422189">,</span>&nbsp;<span class="string" id="8422191">&#34;joe&#34;</span><span class="op" id="8422196">,</span>&nbsp;<span class="builtintype" id="8422198">true</span><span class="op" id="8422202">}</span><span class="op" id="8422203">,</span><br>
<span class="lineno"></span><span class="op" id="8422205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8422208">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="8422249">const</span>&nbsp;<span class="ident" id="8422255">multiText1</span>&nbsp;<span class="op" id="8422266">=</span>&nbsp;<span class="string" id="8422268">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8422332">const</span>&nbsp;<span class="ident" id="8422338">multiText2</span>&nbsp;<span class="op" id="8422349">=</span>&nbsp;<span class="string" id="8422351">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8422434">func</span>&nbsp;<span class="ident" id="8422439">TestMultiExecute</span><span class="op" id="8422455">(</span><span class="ident" id="8422456">t</span>&nbsp;<span class="op" id="8422458">*</span><span class="ident" id="8422459">testing</span><span class="op" id="8422466">.</span><span class="ident" id="8422467">T</span><span class="op" id="8422468">)</span>&nbsp;<span class="op" id="8422470">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8422473">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422514">template</span><span class="op" id="8422522">,</span>&nbsp;<span class="ident" id="8422524">err</span>&nbsp;<span class="op" id="8422528">:=</span>&nbsp;<span class="ident" id="8422531">New</span><span class="op" id="8422534">(</span><span class="string" id="8422535">&#34;root&#34;</span><span class="op" id="8422541">)</span><span class="op" id="8422542">.</span><span class="ident" id="8422543">Parse</span><span class="op" id="8422548">(</span><span class="ident" id="8422549">multiText1</span><span class="op" id="8422559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422562">if</span>&nbsp;<span class="ident" id="8422565">err</span>&nbsp;<span class="op" id="8422569">!=</span>&nbsp;<span class="ident" id="8422572">nil</span>&nbsp;<span class="op" id="8422576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422580">t</span><span class="op" id="8422581">.</span><span class="ident" id="8422582">Fatalf</span><span class="op" id="8422588">(</span><span class="string" id="8422589">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="8422612">,</span>&nbsp;<span class="ident" id="8422614">err</span><span class="op" id="8422617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422620">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422623">_</span><span class="op" id="8422624">,</span>&nbsp;<span class="ident" id="8422626">err</span>&nbsp;<span class="op" id="8422630">=</span>&nbsp;<span class="ident" id="8422632">template</span><span class="op" id="8422640">.</span><span class="ident" id="8422641">Parse</span><span class="op" id="8422646">(</span><span class="ident" id="8422647">multiText2</span><span class="op" id="8422657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422660">if</span>&nbsp;<span class="ident" id="8422663">err</span>&nbsp;<span class="op" id="8422667">!=</span>&nbsp;<span class="ident" id="8422670">nil</span>&nbsp;<span class="op" id="8422674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422678">t</span><span class="op" id="8422679">.</span><span class="ident" id="8422680">Fatalf</span><span class="op" id="8422686">(</span><span class="string" id="8422687">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="8422710">,</span>&nbsp;<span class="ident" id="8422712">err</span><span class="op" id="8422715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422721">testExecute</span><span class="op" id="8422732">(</span><span class="ident" id="8422733">multiExecTests</span><span class="op" id="8422747">,</span>&nbsp;<span class="ident" id="8422749">template</span><span class="op" id="8422757">,</span>&nbsp;<span class="ident" id="8422759">t</span><span class="op" id="8422760">)</span><br>
<span class="lineno">125</span><span class="op" id="8422762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8422765">func</span>&nbsp;<span class="ident" id="8422770">TestParseFiles</span><span class="op" id="8422784">(</span><span class="ident" id="8422785">t</span>&nbsp;<span class="op" id="8422787">*</span><span class="ident" id="8422788">testing</span><span class="op" id="8422795">.</span><span class="ident" id="8422796">T</span><span class="op" id="8422797">)</span>&nbsp;<span class="op" id="8422799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422802">_</span><span class="op" id="8422803">,</span>&nbsp;<span class="ident" id="8422805">err</span>&nbsp;<span class="op" id="8422809">:=</span>&nbsp;<span class="ident" id="8422812">ParseFiles</span><span class="op" id="8422822">(</span><span class="string" id="8422823">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="8422839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422842">if</span>&nbsp;<span class="ident" id="8422845">err</span>&nbsp;<span class="op" id="8422849">==</span>&nbsp;<span class="ident" id="8422852">nil</span>&nbsp;<span class="op" id="8422856">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422860">t</span><span class="op" id="8422861">.</span><span class="ident" id="8422862">Error</span><span class="op" id="8422867">(</span><span class="string" id="8422868">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8422916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422922">template</span>&nbsp;<span class="op" id="8422931">:=</span>&nbsp;<span class="ident" id="8422934">New</span><span class="op" id="8422937">(</span><span class="string" id="8422938">&#34;root&#34;</span><span class="op" id="8422944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422947">_</span><span class="op" id="8422948">,</span>&nbsp;<span class="ident" id="8422950">err</span>&nbsp;<span class="op" id="8422954">=</span>&nbsp;<span class="ident" id="8422956">template</span><span class="op" id="8422964">.</span><span class="ident" id="8422965">ParseFiles</span><span class="op" id="8422975">(</span><span class="string" id="8422976">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="8422997">,</span>&nbsp;<span class="string" id="8422999">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="8423020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8423023">if</span>&nbsp;<span class="ident" id="8423026">err</span>&nbsp;<span class="op" id="8423030">!=</span>&nbsp;<span class="ident" id="8423033">nil</span>&nbsp;<span class="op" id="8423037">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423041">t</span><span class="op" id="8423042">.</span><span class="ident" id="8423043">Fatalf</span><span class="op" id="8423049">(</span><span class="string" id="8423050">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8423075">,</span>&nbsp;<span class="ident" id="8423077">err</span><span class="op" id="8423080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423086">testExecute</span><span class="op" id="8423097">(</span><span class="ident" id="8423098">multiExecTests</span><span class="op" id="8423112">,</span>&nbsp;<span class="ident" id="8423114">template</span><span class="op" id="8423122">,</span>&nbsp;<span class="ident" id="8423124">t</span><span class="op" id="8423125">)</span><br>
<span class="lineno"></span><span class="op" id="8423127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="8423130">func</span>&nbsp;<span class="ident" id="8423135">TestParseGlob</span><span class="op" id="8423148">(</span><span class="ident" id="8423149">t</span>&nbsp;<span class="op" id="8423151">*</span><span class="ident" id="8423152">testing</span><span class="op" id="8423159">.</span><span class="ident" id="8423160">T</span><span class="op" id="8423161">)</span>&nbsp;<span class="op" id="8423163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423166">_</span><span class="op" id="8423167">,</span>&nbsp;<span class="ident" id="8423169">err</span>&nbsp;<span class="op" id="8423173">:=</span>&nbsp;<span class="ident" id="8423176">ParseGlob</span><span class="op" id="8423185">(</span><span class="string" id="8423186">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="8423202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8423205">if</span>&nbsp;<span class="ident" id="8423208">err</span>&nbsp;<span class="op" id="8423212">==</span>&nbsp;<span class="ident" id="8423215">nil</span>&nbsp;<span class="op" id="8423219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423223">t</span><span class="op" id="8423224">.</span><span class="ident" id="8423225">Error</span><span class="op" id="8423230">(</span><span class="string" id="8423231">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8423279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423282">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423285">_</span><span class="op" id="8423286">,</span>&nbsp;<span class="ident" id="8423288">err</span>&nbsp;<span class="op" id="8423292">=</span>&nbsp;<span class="ident" id="8423294">New</span><span class="op" id="8423297">(</span><span class="string" id="8423298">&#34;error&#34;</span><span class="op" id="8423305">)</span><span class="op" id="8423306">.</span><span class="ident" id="8423307">ParseGlob</span><span class="op" id="8423316">(</span><span class="string" id="8423317">&#34;[x&#34;</span><span class="op" id="8423321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8423324">if</span>&nbsp;<span class="ident" id="8423327">err</span>&nbsp;<span class="op" id="8423331">==</span>&nbsp;<span class="ident" id="8423334">nil</span>&nbsp;<span class="op" id="8423338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423342">t</span><span class="op" id="8423343">.</span><span class="ident" id="8423344">Error</span><span class="op" id="8423349">(</span><span class="string" id="8423350">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="8423392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423398">template</span>&nbsp;<span class="op" id="8423407">:=</span>&nbsp;<span class="ident" id="8423410">New</span><span class="op" id="8423413">(</span><span class="string" id="8423414">&#34;root&#34;</span><span class="op" id="8423420">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423423">_</span><span class="op" id="8423424">,</span>&nbsp;<span class="ident" id="8423426">err</span>&nbsp;<span class="op" id="8423430">=</span>&nbsp;<span class="ident" id="8423432">template</span><span class="op" id="8423440">.</span><span class="ident" id="8423441">ParseGlob</span><span class="op" id="8423450">(</span><span class="string" id="8423451">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="8423472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8423475">if</span>&nbsp;<span class="ident" id="8423478">err</span>&nbsp;<span class="op" id="8423482">!=</span>&nbsp;<span class="ident" id="8423485">nil</span>&nbsp;<span class="op" id="8423489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423493">t</span><span class="op" id="8423494">.</span><span class="ident" id="8423495">Fatalf</span><span class="op" id="8423501">(</span><span class="string" id="8423502">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8423527">,</span>&nbsp;<span class="ident" id="8423529">err</span><span class="op" id="8423532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423538">testExecute</span><span class="op" id="8423549">(</span><span class="ident" id="8423550">multiExecTests</span><span class="op" id="8423564">,</span>&nbsp;<span class="ident" id="8423566">template</span><span class="op" id="8423574">,</span>&nbsp;<span class="ident" id="8423576">t</span><span class="op" id="8423577">)</span><br>
<span class="lineno">155</span><span class="op" id="8423579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8423582">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8423678">var</span>&nbsp;<span class="ident" id="8423682">templateFileExecTests</span>&nbsp;<span class="op" id="8423704">=</span>&nbsp;<span class="op" id="8423706">[</span><span class="op" id="8423707">]</span><span class="ident" id="8423708">execTest</span><span class="op" id="8423716">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423719">{</span><span class="string" id="8423720">&#34;test&#34;</span><span class="op" id="8423726">,</span>&nbsp;<span class="string" id="8423728">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="8423780">,</span>&nbsp;<span class="string" id="8423782">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="8423816">,</span>&nbsp;<span class="num" id="8423818">0</span><span class="op" id="8423819">,</span>&nbsp;<span class="builtintype" id="8423821">true</span><span class="op" id="8423825">}</span><span class="op" id="8423826">,</span><br>
<span class="lineno"></span><span class="op" id="8423828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8423831">func</span>&nbsp;<span class="ident" id="8423836">TestParseFilesWithData</span><span class="op" id="8423858">(</span><span class="ident" id="8423859">t</span>&nbsp;<span class="op" id="8423861">*</span><span class="ident" id="8423862">testing</span><span class="op" id="8423869">.</span><span class="ident" id="8423870">T</span><span class="op" id="8423871">)</span>&nbsp;<span class="op" id="8423873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423876">template</span><span class="op" id="8423884">,</span>&nbsp;<span class="ident" id="8423886">err</span>&nbsp;<span class="op" id="8423890">:=</span>&nbsp;<span class="ident" id="8423893">New</span><span class="op" id="8423896">(</span><span class="string" id="8423897">&#34;root&#34;</span><span class="op" id="8423903">)</span><span class="op" id="8423904">.</span><span class="ident" id="8423905">ParseFiles</span><span class="op" id="8423915">(</span><span class="string" id="8423916">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="8423937">,</span>&nbsp;<span class="string" id="8423939">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="8423960">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8423963">if</span>&nbsp;<span class="ident" id="8423966">err</span>&nbsp;<span class="op" id="8423970">!=</span>&nbsp;<span class="ident" id="8423973">nil</span>&nbsp;<span class="op" id="8423977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423981">t</span><span class="op" id="8423982">.</span><span class="ident" id="8423983">Fatalf</span><span class="op" id="8423989">(</span><span class="string" id="8423990">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8424015">,</span>&nbsp;<span class="ident" id="8424017">err</span><span class="op" id="8424020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8424023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424026">testExecute</span><span class="op" id="8424037">(</span><span class="ident" id="8424038">templateFileExecTests</span><span class="op" id="8424059">,</span>&nbsp;<span class="ident" id="8424061">template</span><span class="op" id="8424069">,</span>&nbsp;<span class="ident" id="8424071">t</span><span class="op" id="8424072">)</span><br>
<span class="lineno"></span><span class="op" id="8424074">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8424077">func</span>&nbsp;<span class="ident" id="8424082">TestParseGlobWithData</span><span class="op" id="8424103">(</span><span class="ident" id="8424104">t</span>&nbsp;<span class="op" id="8424106">*</span><span class="ident" id="8424107">testing</span><span class="op" id="8424114">.</span><span class="ident" id="8424115">T</span><span class="op" id="8424116">)</span>&nbsp;<span class="op" id="8424118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424121">template</span><span class="op" id="8424129">,</span>&nbsp;<span class="ident" id="8424131">err</span>&nbsp;<span class="op" id="8424135">:=</span>&nbsp;<span class="ident" id="8424138">New</span><span class="op" id="8424141">(</span><span class="string" id="8424142">&#34;root&#34;</span><span class="op" id="8424148">)</span><span class="op" id="8424149">.</span><span class="ident" id="8424150">ParseGlob</span><span class="op" id="8424159">(</span><span class="string" id="8424160">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="8424181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8424184">if</span>&nbsp;<span class="ident" id="8424187">err</span>&nbsp;<span class="op" id="8424191">!=</span>&nbsp;<span class="ident" id="8424194">nil</span>&nbsp;<span class="op" id="8424198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424202">t</span><span class="op" id="8424203">.</span><span class="ident" id="8424204">Fatalf</span><span class="op" id="8424210">(</span><span class="string" id="8424211">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="8424236">,</span>&nbsp;<span class="ident" id="8424238">err</span><span class="op" id="8424241">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8424244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424247">testExecute</span><span class="op" id="8424258">(</span><span class="ident" id="8424259">templateFileExecTests</span><span class="op" id="8424280">,</span>&nbsp;<span class="ident" id="8424282">template</span><span class="op" id="8424290">,</span>&nbsp;<span class="ident" id="8424292">t</span><span class="op" id="8424293">)</span><br>
<span class="lineno"></span><span class="op" id="8424295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8424298">const</span>&nbsp;<span class="op" id="8424304">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424307">cloneText1</span>&nbsp;<span class="op" id="8424318">=</span>&nbsp;<span class="string" id="8424320">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424377">cloneText2</span>&nbsp;<span class="op" id="8424388">=</span>&nbsp;<span class="string" id="8424390">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424416">cloneText3</span>&nbsp;<span class="op" id="8424427">=</span>&nbsp;<span class="string" id="8424429">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424458">cloneText4</span>&nbsp;<span class="op" id="8424469">=</span>&nbsp;<span class="string" id="8424471">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="8424500">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="8424503">func</span>&nbsp;<span class="ident" id="8424508">TestClone</span><span class="op" id="8424517">(</span><span class="ident" id="8424518">t</span>&nbsp;<span class="op" id="8424520">*</span><span class="ident" id="8424521">testing</span><span class="op" id="8424528">.</span><span class="ident" id="8424529">T</span><span class="op" id="8424530">)</span>&nbsp;<span class="op" id="8424532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8424535">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424581">root</span><span class="op" id="8424585">,</span>&nbsp;<span class="ident" id="8424587">err</span>&nbsp;<span class="op" id="8424591">:=</span>&nbsp;<span class="ident" id="8424594">New</span><span class="op" id="8424597">(</span><span class="string" id="8424598">&#34;root&#34;</span><span class="op" id="8424604">)</span><span class="op" id="8424605">.</span><span class="ident" id="8424606">Parse</span><span class="op" id="8424611">(</span><span class="ident" id="8424612">cloneText1</span><span class="op" id="8424622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8424625">if</span>&nbsp;<span class="ident" id="8424628">err</span>&nbsp;<span class="op" id="8424632">!=</span>&nbsp;<span class="ident" id="8424635">nil</span>&nbsp;<span class="op" id="8424639">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424643">t</span><span class="op" id="8424644">.</span><span class="ident" id="8424645">Fatal</span><span class="op" id="8424650">(</span><span class="ident" id="8424651">err</span><span class="op" id="8424654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8424657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424660">_</span><span class="op" id="8424661">,</span>&nbsp;<span class="ident" id="8424663">err</span>&nbsp;<span class="op" id="8424667">=</span>&nbsp;<span class="ident" id="8424669">root</span><span class="op" id="8424673">.</span><span class="ident" id="8424674">Parse</span><span class="op" id="8424679">(</span><span class="ident" id="8424680">cloneText2</span><span class="op" id="8424690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8424693">if</span>&nbsp;<span class="ident" id="8424696">err</span>&nbsp;<span class="op" id="8424700">!=</span>&nbsp;<span class="ident" id="8424703">nil</span>&nbsp;<span class="op" id="8424707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424711">t</span><span class="op" id="8424712">.</span><span class="ident" id="8424713">Fatal</span><span class="op" id="8424718">(</span><span class="ident" id="8424719">err</span><span class="op" id="8424722">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8424725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424728">clone</span>&nbsp;<span class="op" id="8424734">:=</span>&nbsp;<span class="ident" id="8424737">Must</span><span class="op" id="8424741">(</span><span class="ident" id="8424742">root</span><span class="op" id="8424746">.</span><span class="ident" id="8424747">Clone</span><span class="op" id="8424752">(</span><span class="op" id="8424753">)</span><span class="op" id="8424754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8424757">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424783">_</span><span class="op" id="8424784">,</span>&nbsp;<span class="ident" id="8424786">err</span>&nbsp;<span class="op" id="8424790">=</span>&nbsp;<span class="ident" id="8424792">root</span><span class="op" id="8424796">.</span><span class="ident" id="8424797">Parse</span><span class="op" id="8424802">(</span><span class="ident" id="8424803">cloneText3</span><span class="op" id="8424813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8424816">if</span>&nbsp;<span class="ident" id="8424819">err</span>&nbsp;<span class="op" id="8424823">!=</span>&nbsp;<span class="ident" id="8424826">nil</span>&nbsp;<span class="op" id="8424830">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424834">t</span><span class="op" id="8424835">.</span><span class="ident" id="8424836">Fatal</span><span class="op" id="8424841">(</span><span class="ident" id="8424842">err</span><span class="op" id="8424845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8424848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424851">_</span><span class="op" id="8424852">,</span>&nbsp;<span class="ident" id="8424854">err</span>&nbsp;<span class="op" id="8424858">=</span>&nbsp;<span class="ident" id="8424860">clone</span><span class="op" id="8424865">.</span><span class="ident" id="8424866">Parse</span><span class="op" id="8424871">(</span><span class="ident" id="8424872">cloneText4</span><span class="op" id="8424882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8424885">if</span>&nbsp;<span class="ident" id="8424888">err</span>&nbsp;<span class="op" id="8424892">!=</span>&nbsp;<span class="ident" id="8424895">nil</span>&nbsp;<span class="op" id="8424899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8424903">t</span><span class="op" id="8424904">.</span><span class="ident" id="8424905">Fatal</span><span class="op" id="8424910">(</span><span class="ident" id="8424911">err</span><span class="op" id="8424914">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8424917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8424920">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8424966">for</span>&nbsp;<span class="ident" id="8424970">k</span><span class="op" id="8424971">,</span>&nbsp;<span class="ident" id="8424973">v</span>&nbsp;<span class="op" id="8424975">:=</span>&nbsp;<span class="keyword" id="8424978">range</span>&nbsp;<span class="ident" id="8424984">clone</span><span class="op" id="8424989">.</span><span class="ident" id="8424990">tmpl</span>&nbsp;<span class="op" id="8424995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8424999">if</span>&nbsp;<span class="ident" id="8425002">k</span>&nbsp;<span class="op" id="8425004">==</span>&nbsp;<span class="ident" id="8425007">clone</span><span class="op" id="8425012">.</span><span class="ident" id="8425013">name</span>&nbsp;<span class="op" id="8425018">&amp;&amp;</span>&nbsp;<span class="ident" id="8425021">v</span><span class="op" id="8425022">.</span><span class="ident" id="8425023">tmpl</span><span class="op" id="8425027">[</span><span class="ident" id="8425028">k</span><span class="op" id="8425029">]</span>&nbsp;<span class="op" id="8425031">!=</span>&nbsp;<span class="ident" id="8425034">clone</span>&nbsp;<span class="op" id="8425040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425045">t</span><span class="op" id="8425046">.</span><span class="ident" id="8425047">Error</span><span class="op" id="8425052">(</span><span class="string" id="8425053">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="8425082">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8425086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8425090">if</span>&nbsp;<span class="ident" id="8425093">v</span>&nbsp;<span class="op" id="8425095">!=</span>&nbsp;<span class="ident" id="8425098">v</span><span class="op" id="8425099">.</span><span class="ident" id="8425100">tmpl</span><span class="op" id="8425104">[</span><span class="ident" id="8425105">v</span><span class="op" id="8425106">.</span><span class="ident" id="8425107">name</span><span class="op" id="8425111">]</span>&nbsp;<span class="op" id="8425113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425118">t</span><span class="op" id="8425119">.</span><span class="ident" id="8425120">Errorf</span><span class="op" id="8425126">(</span><span class="string" id="8425127">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="8425163">,</span>&nbsp;<span class="ident" id="8425165">k</span><span class="op" id="8425166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8425170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8425173">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8425176">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8425194">var</span>&nbsp;<span class="ident" id="8425198">b</span>&nbsp;<span class="ident" id="8425200">bytes</span><span class="op" id="8425205">.</span><span class="ident" id="8425206">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425214">err</span>&nbsp;<span class="op" id="8425218">=</span>&nbsp;<span class="ident" id="8425220">root</span><span class="op" id="8425224">.</span><span class="ident" id="8425225">ExecuteTemplate</span><span class="op" id="8425240">(</span><span class="op" id="8425241">&amp;</span><span class="ident" id="8425242">b</span><span class="op" id="8425243">,</span>&nbsp;<span class="string" id="8425245">&#34;a&#34;</span><span class="op" id="8425248">,</span>&nbsp;<span class="num" id="8425250">0</span><span class="op" id="8425251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8425254">if</span>&nbsp;<span class="ident" id="8425257">err</span>&nbsp;<span class="op" id="8425261">!=</span>&nbsp;<span class="ident" id="8425264">nil</span>&nbsp;<span class="op" id="8425268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425272">t</span><span class="op" id="8425273">.</span><span class="ident" id="8425274">Fatal</span><span class="op" id="8425279">(</span><span class="ident" id="8425280">err</span><span class="op" id="8425283">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8425286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8425289">if</span>&nbsp;<span class="ident" id="8425292">b</span><span class="op" id="8425293">.</span><span class="ident" id="8425294">String</span><span class="op" id="8425300">(</span><span class="op" id="8425301">)</span>&nbsp;<span class="op" id="8425303">!=</span>&nbsp;<span class="string" id="8425306">&#34;broot&#34;</span>&nbsp;<span class="op" id="8425314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425318">t</span><span class="op" id="8425319">.</span><span class="ident" id="8425320">Errorf</span><span class="op" id="8425326">(</span><span class="string" id="8425327">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8425347">,</span>&nbsp;<span class="string" id="8425349">&#34;broot&#34;</span><span class="op" id="8425356">,</span>&nbsp;<span class="ident" id="8425358">b</span><span class="op" id="8425359">.</span><span class="ident" id="8425360">String</span><span class="op" id="8425366">(</span><span class="op" id="8425367">)</span><span class="op" id="8425368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8425371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8425374">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425392">b</span><span class="op" id="8425393">.</span><span class="ident" id="8425394">Reset</span><span class="op" id="8425399">(</span><span class="op" id="8425400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425403">err</span>&nbsp;<span class="op" id="8425407">=</span>&nbsp;<span class="ident" id="8425409">clone</span><span class="op" id="8425414">.</span><span class="ident" id="8425415">ExecuteTemplate</span><span class="op" id="8425430">(</span><span class="op" id="8425431">&amp;</span><span class="ident" id="8425432">b</span><span class="op" id="8425433">,</span>&nbsp;<span class="string" id="8425435">&#34;a&#34;</span><span class="op" id="8425438">,</span>&nbsp;<span class="num" id="8425440">0</span><span class="op" id="8425441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8425444">if</span>&nbsp;<span class="ident" id="8425447">err</span>&nbsp;<span class="op" id="8425451">!=</span>&nbsp;<span class="ident" id="8425454">nil</span>&nbsp;<span class="op" id="8425458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425462">t</span><span class="op" id="8425463">.</span><span class="ident" id="8425464">Fatal</span><span class="op" id="8425469">(</span><span class="ident" id="8425470">err</span><span class="op" id="8425473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8425476">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8425479">if</span>&nbsp;<span class="ident" id="8425482">b</span><span class="op" id="8425483">.</span><span class="ident" id="8425484">String</span><span class="op" id="8425490">(</span><span class="op" id="8425491">)</span>&nbsp;<span class="op" id="8425493">!=</span>&nbsp;<span class="string" id="8425496">&#34;bclone&#34;</span>&nbsp;<span class="op" id="8425505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425509">t</span><span class="op" id="8425510">.</span><span class="ident" id="8425511">Errorf</span><span class="op" id="8425517">(</span><span class="string" id="8425518">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8425538">,</span>&nbsp;<span class="string" id="8425540">&#34;bclone&#34;</span><span class="op" id="8425548">,</span>&nbsp;<span class="ident" id="8425550">b</span><span class="op" id="8425551">.</span><span class="ident" id="8425552">String</span><span class="op" id="8425558">(</span><span class="op" id="8425559">)</span><span class="op" id="8425560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8425563">}</span><br>
<span class="lineno"></span><span class="op" id="8425565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8425568">func</span>&nbsp;<span class="ident" id="8425573">TestAddParseTree</span><span class="op" id="8425589">(</span><span class="ident" id="8425590">t</span>&nbsp;<span class="op" id="8425592">*</span><span class="ident" id="8425593">testing</span><span class="op" id="8425600">.</span><span class="ident" id="8425601">T</span><span class="op" id="8425602">)</span>&nbsp;<span class="op" id="8425604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8425607">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425634">root</span><span class="op" id="8425638">,</span>&nbsp;<span class="ident" id="8425640">err</span>&nbsp;<span class="op" id="8425644">:=</span>&nbsp;<span class="ident" id="8425647">New</span><span class="op" id="8425650">(</span><span class="string" id="8425651">&#34;root&#34;</span><span class="op" id="8425657">)</span><span class="op" id="8425658">.</span><span class="ident" id="8425659">Parse</span><span class="op" id="8425664">(</span><span class="ident" id="8425665">cloneText1</span><span class="op" id="8425675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8425678">if</span>&nbsp;<span class="ident" id="8425681">err</span>&nbsp;<span class="op" id="8425685">!=</span>&nbsp;<span class="ident" id="8425688">nil</span>&nbsp;<span class="op" id="8425692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425696">t</span><span class="op" id="8425697">.</span><span class="ident" id="8425698">Fatal</span><span class="op" id="8425703">(</span><span class="ident" id="8425704">err</span><span class="op" id="8425707">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8425710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425713">_</span><span class="op" id="8425714">,</span>&nbsp;<span class="ident" id="8425716">err</span>&nbsp;<span class="op" id="8425720">=</span>&nbsp;<span class="ident" id="8425722">root</span><span class="op" id="8425726">.</span><span class="ident" id="8425727">Parse</span><span class="op" id="8425732">(</span><span class="ident" id="8425733">cloneText2</span><span class="op" id="8425743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8425746">if</span>&nbsp;<span class="ident" id="8425749">err</span>&nbsp;<span class="op" id="8425753">!=</span>&nbsp;<span class="ident" id="8425756">nil</span>&nbsp;<span class="op" id="8425760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425764">t</span><span class="op" id="8425765">.</span><span class="ident" id="8425766">Fatal</span><span class="op" id="8425771">(</span><span class="ident" id="8425772">err</span><span class="op" id="8425775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8425778">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8425781">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425807">tree</span><span class="op" id="8425811">,</span>&nbsp;<span class="ident" id="8425813">err</span>&nbsp;<span class="op" id="8425817">:=</span>&nbsp;<span class="ident" id="8425820">parse</span><span class="op" id="8425825">.</span><span class="ident" id="8425826">Parse</span><span class="op" id="8425831">(</span><span class="string" id="8425832">&#34;cloneText3&#34;</span><span class="op" id="8425844">,</span>&nbsp;<span class="ident" id="8425846">cloneText3</span><span class="op" id="8425856">,</span>&nbsp;<span class="string" id="8425858">&#34;&#34;</span><span class="op" id="8425860">,</span>&nbsp;<span class="string" id="8425862">&#34;&#34;</span><span class="op" id="8425864">,</span>&nbsp;<span class="ident" id="8425866">nil</span><span class="op" id="8425869">,</span>&nbsp;<span class="ident" id="8425871">builtins</span><span class="op" id="8425879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8425882">if</span>&nbsp;<span class="ident" id="8425885">err</span>&nbsp;<span class="op" id="8425889">!=</span>&nbsp;<span class="ident" id="8425892">nil</span>&nbsp;<span class="op" id="8425896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425900">t</span><span class="op" id="8425901">.</span><span class="ident" id="8425902">Fatal</span><span class="op" id="8425907">(</span><span class="ident" id="8425908">err</span><span class="op" id="8425911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8425914">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425917">added</span><span class="op" id="8425922">,</span>&nbsp;<span class="ident" id="8425924">err</span>&nbsp;<span class="op" id="8425928">:=</span>&nbsp;<span class="ident" id="8425931">root</span><span class="op" id="8425935">.</span><span class="ident" id="8425936">AddParseTree</span><span class="op" id="8425948">(</span><span class="string" id="8425949">&#34;c&#34;</span><span class="op" id="8425952">,</span>&nbsp;<span class="ident" id="8425954">tree</span><span class="op" id="8425958">[</span><span class="string" id="8425959">&#34;c&#34;</span><span class="op" id="8425962">]</span><span class="op" id="8425963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8425966">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8425979">var</span>&nbsp;<span class="ident" id="8425983">b</span>&nbsp;<span class="ident" id="8425985">bytes</span><span class="op" id="8425990">.</span><span class="ident" id="8425991">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8425999">err</span>&nbsp;<span class="op" id="8426003">=</span>&nbsp;<span class="ident" id="8426005">added</span><span class="op" id="8426010">.</span><span class="ident" id="8426011">ExecuteTemplate</span><span class="op" id="8426026">(</span><span class="op" id="8426027">&amp;</span><span class="ident" id="8426028">b</span><span class="op" id="8426029">,</span>&nbsp;<span class="string" id="8426031">&#34;a&#34;</span><span class="op" id="8426034">,</span>&nbsp;<span class="num" id="8426036">0</span><span class="op" id="8426037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8426040">if</span>&nbsp;<span class="ident" id="8426043">err</span>&nbsp;<span class="op" id="8426047">!=</span>&nbsp;<span class="ident" id="8426050">nil</span>&nbsp;<span class="op" id="8426054">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426058">t</span><span class="op" id="8426059">.</span><span class="ident" id="8426060">Fatal</span><span class="op" id="8426065">(</span><span class="ident" id="8426066">err</span><span class="op" id="8426069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8426072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8426075">if</span>&nbsp;<span class="ident" id="8426078">b</span><span class="op" id="8426079">.</span><span class="ident" id="8426080">String</span><span class="op" id="8426086">(</span><span class="op" id="8426087">)</span>&nbsp;<span class="op" id="8426089">!=</span>&nbsp;<span class="string" id="8426092">&#34;broot&#34;</span>&nbsp;<span class="op" id="8426100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426104">t</span><span class="op" id="8426105">.</span><span class="ident" id="8426106">Errorf</span><span class="op" id="8426112">(</span><span class="string" id="8426113">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8426133">,</span>&nbsp;<span class="string" id="8426135">&#34;broot&#34;</span><span class="op" id="8426142">,</span>&nbsp;<span class="ident" id="8426144">b</span><span class="op" id="8426145">.</span><span class="ident" id="8426146">String</span><span class="op" id="8426152">(</span><span class="op" id="8426153">)</span><span class="op" id="8426154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8426157">}</span><br>
<span class="lineno">260</span><span class="op" id="8426159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8426162">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="8426176">func</span>&nbsp;<span class="ident" id="8426181">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="8426215">(</span><span class="ident" id="8426216">t</span>&nbsp;<span class="op" id="8426218">*</span><span class="ident" id="8426219">testing</span><span class="op" id="8426226">.</span><span class="ident" id="8426227">T</span><span class="op" id="8426228">)</span>&nbsp;<span class="op" id="8426230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426233">master</span>&nbsp;<span class="op" id="8426240">:=</span>&nbsp;<span class="string" id="8426243">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426275">tmpl</span>&nbsp;<span class="op" id="8426280">:=</span>&nbsp;<span class="ident" id="8426283">New</span><span class="op" id="8426286">(</span><span class="string" id="8426287">&#34;master&#34;</span><span class="op" id="8426295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426298">tree</span><span class="op" id="8426302">,</span>&nbsp;<span class="ident" id="8426304">err</span>&nbsp;<span class="op" id="8426308">:=</span>&nbsp;<span class="ident" id="8426311">parse</span><span class="op" id="8426316">.</span><span class="ident" id="8426317">Parse</span><span class="op" id="8426322">(</span><span class="string" id="8426323">&#34;master&#34;</span><span class="op" id="8426331">,</span>&nbsp;<span class="ident" id="8426333">master</span><span class="op" id="8426339">,</span>&nbsp;<span class="string" id="8426341">&#34;&#34;</span><span class="op" id="8426343">,</span>&nbsp;<span class="string" id="8426345">&#34;&#34;</span><span class="op" id="8426347">,</span>&nbsp;<span class="ident" id="8426349">nil</span><span class="op" id="8426352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8426355">if</span>&nbsp;<span class="ident" id="8426358">err</span>&nbsp;<span class="op" id="8426362">!=</span>&nbsp;<span class="ident" id="8426365">nil</span>&nbsp;<span class="op" id="8426369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426373">t</span><span class="op" id="8426374">.</span><span class="ident" id="8426375">Fatalf</span><span class="op" id="8426381">(</span><span class="string" id="8426382">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="8426408">,</span>&nbsp;<span class="ident" id="8426410">err</span><span class="op" id="8426413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8426416">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426419">masterTree</span>&nbsp;<span class="op" id="8426430">:=</span>&nbsp;<span class="ident" id="8426433">tree</span><span class="op" id="8426437">[</span><span class="string" id="8426438">&#34;master&#34;</span><span class="op" id="8426446">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426449">tmpl</span><span class="op" id="8426453">.</span><span class="ident" id="8426454">AddParseTree</span><span class="op" id="8426466">(</span><span class="string" id="8426467">&#34;master&#34;</span><span class="op" id="8426475">,</span>&nbsp;<span class="ident" id="8426477">masterTree</span><span class="op" id="8426487">)</span>&nbsp;<span class="comment" id="8426489">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="8426506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8426509">func</span>&nbsp;<span class="ident" id="8426514">TestRedefinition</span><span class="op" id="8426530">(</span><span class="ident" id="8426531">t</span>&nbsp;<span class="op" id="8426533">*</span><span class="ident" id="8426534">testing</span><span class="op" id="8426541">.</span><span class="ident" id="8426542">T</span><span class="op" id="8426543">)</span>&nbsp;<span class="op" id="8426545">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8426548">var</span>&nbsp;<span class="ident" id="8426552">tmpl</span>&nbsp;<span class="op" id="8426557">*</span><span class="ident" id="8426558">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8426568">var</span>&nbsp;<span class="ident" id="8426572">err</span>&nbsp;<span class="builtintype" id="8426576">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8426583">if</span>&nbsp;<span class="ident" id="8426586">tmpl</span><span class="op" id="8426590">,</span>&nbsp;<span class="ident" id="8426592">err</span>&nbsp;<span class="op" id="8426596">=</span>&nbsp;<span class="ident" id="8426598">New</span><span class="op" id="8426601">(</span><span class="string" id="8426602">&#34;tmpl1&#34;</span><span class="op" id="8426609">)</span><span class="op" id="8426610">.</span><span class="ident" id="8426611">Parse</span><span class="op" id="8426616">(</span><span class="string" id="8426617">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="8426646">)</span><span class="op" id="8426647">;</span>&nbsp;<span class="ident" id="8426649">err</span>&nbsp;<span class="op" id="8426653">!=</span>&nbsp;<span class="ident" id="8426656">nil</span>&nbsp;<span class="op" id="8426660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426664">t</span><span class="op" id="8426665">.</span><span class="ident" id="8426666">Fatalf</span><span class="op" id="8426672">(</span><span class="string" id="8426673">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="8426686">,</span>&nbsp;<span class="ident" id="8426688">err</span><span class="op" id="8426691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8426694">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8426697">if</span>&nbsp;<span class="ident" id="8426700">_</span><span class="op" id="8426701">,</span>&nbsp;<span class="ident" id="8426703">err</span>&nbsp;<span class="op" id="8426707">=</span>&nbsp;<span class="ident" id="8426709">tmpl</span><span class="op" id="8426713">.</span><span class="ident" id="8426714">Parse</span><span class="op" id="8426719">(</span><span class="string" id="8426720">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="8426749">)</span><span class="op" id="8426750">;</span>&nbsp;<span class="ident" id="8426752">err</span>&nbsp;<span class="op" id="8426756">==</span>&nbsp;<span class="ident" id="8426759">nil</span>&nbsp;<span class="op" id="8426763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426767">t</span><span class="op" id="8426768">.</span><span class="ident" id="8426769">Fatal</span><span class="op" id="8426774">(</span><span class="string" id="8426775">&#34;expected&nbsp;error&#34;</span><span class="op" id="8426791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8426794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8426797">if</span>&nbsp;<span class="op" id="8426800">!</span><span class="ident" id="8426801">strings</span><span class="op" id="8426808">.</span><span class="ident" id="8426809">Contains</span><span class="op" id="8426817">(</span><span class="ident" id="8426818">err</span><span class="op" id="8426821">.</span><span class="ident" id="8426822">Error</span><span class="op" id="8426827">(</span><span class="op" id="8426828">)</span><span class="op" id="8426829">,</span>&nbsp;<span class="string" id="8426831">&#34;redefinition&#34;</span><span class="op" id="8426845">)</span>&nbsp;<span class="op" id="8426847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426851">t</span><span class="op" id="8426852">.</span><span class="ident" id="8426853">Fatalf</span><span class="op" id="8426859">(</span><span class="string" id="8426860">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8426897">,</span>&nbsp;<span class="ident" id="8426899">err</span><span class="op" id="8426902">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8426905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8426908">if</span>&nbsp;<span class="ident" id="8426911">_</span><span class="op" id="8426912">,</span>&nbsp;<span class="ident" id="8426914">err</span>&nbsp;<span class="op" id="8426918">=</span>&nbsp;<span class="ident" id="8426920">tmpl</span><span class="op" id="8426924">.</span><span class="ident" id="8426925">New</span><span class="op" id="8426928">(</span><span class="string" id="8426929">&#34;tmpl2&#34;</span><span class="op" id="8426936">)</span><span class="op" id="8426937">.</span><span class="ident" id="8426938">Parse</span><span class="op" id="8426943">(</span><span class="string" id="8426944">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="8426973">)</span><span class="op" id="8426974">;</span>&nbsp;<span class="ident" id="8426976">err</span>&nbsp;<span class="op" id="8426980">==</span>&nbsp;<span class="ident" id="8426983">nil</span>&nbsp;<span class="op" id="8426987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8426991">t</span><span class="op" id="8426992">.</span><span class="ident" id="8426993">Fatal</span><span class="op" id="8426998">(</span><span class="string" id="8426999">&#34;expected&nbsp;error&#34;</span><span class="op" id="8427015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8427018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8427021">if</span>&nbsp;<span class="op" id="8427024">!</span><span class="ident" id="8427025">strings</span><span class="op" id="8427032">.</span><span class="ident" id="8427033">Contains</span><span class="op" id="8427041">(</span><span class="ident" id="8427042">err</span><span class="op" id="8427045">.</span><span class="ident" id="8427046">Error</span><span class="op" id="8427051">(</span><span class="op" id="8427052">)</span><span class="op" id="8427053">,</span>&nbsp;<span class="string" id="8427055">&#34;redefinition&#34;</span><span class="op" id="8427069">)</span>&nbsp;<span class="op" id="8427071">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8427075">t</span><span class="op" id="8427076">.</span><span class="ident" id="8427077">Fatalf</span><span class="op" id="8427083">(</span><span class="string" id="8427084">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8427121">,</span>&nbsp;<span class="ident" id="8427123">err</span><span class="op" id="8427126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8427129">}</span><br>
<span class="lineno"></span><span class="op" id="8427131">}</span>
</div>
</body>
</html>
