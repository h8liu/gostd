<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4745849">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4745904">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4745958">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4746009">package</span>&nbsp;<span class="ident" id="4746017">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4746023">import</span>&nbsp;<span class="op" id="4746030">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4746033">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4746042">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4746049">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4746056">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4746063">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4746074">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4746085">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4746092">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4746095">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="4746149">//</span><br>
<span class="lineno"></span><span class="comment" id="4746152">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4746194">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4746271">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4746329">type</span>&nbsp;<span class="ident" id="4746334">Cookie</span>&nbsp;<span class="keyword" id="4746341">struct</span>&nbsp;<span class="op" id="4746348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746351">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4746362">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746370">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4746381">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746389">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4746400">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746408">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4746419">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746427">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746438">time</span><span class="op" id="4746442">.</span><span class="ident" id="4746443">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746449">RawExpires</span>&nbsp;<span class="builtintype" id="4746460">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4746469">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4746522">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4746586">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746652">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4746661">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746666">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4746675">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746681">HttpOnly</span>&nbsp;<span class="builtintype" id="4746690">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746696">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4746705">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746713">Unparsed</span>&nbsp;<span class="op" id="4746722">[</span><span class="op" id="4746723">]</span><span class="builtintype" id="4746724">string</span>&nbsp;<span class="comment" id="4746731">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="4746777">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4746780">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4746834">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="4746895">func</span>&nbsp;<span class="ident" id="4746900">readSetCookies</span><span class="op" id="4746914">(</span><span class="ident" id="4746915">h</span>&nbsp;<span class="ident" id="4746917">Header</span><span class="op" id="4746923">)</span>&nbsp;<span class="op" id="4746925">[</span><span class="op" id="4746926">]</span><span class="op" id="4746927">*</span><span class="ident" id="4746928">Cookie</span>&nbsp;<span class="op" id="4746935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4746938">cookies</span>&nbsp;<span class="op" id="4746946">:=</span>&nbsp;<span class="op" id="4746949">[</span><span class="op" id="4746950">]</span><span class="op" id="4746951">*</span><span class="ident" id="4746952">Cookie</span><span class="op" id="4746958">{</span><span class="op" id="4746959">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4746962">for</span>&nbsp;<span class="ident" id="4746966">_</span><span class="op" id="4746967">,</span>&nbsp;<span class="ident" id="4746969">line</span>&nbsp;<span class="op" id="4746974">:=</span>&nbsp;<span class="keyword" id="4746977">range</span>&nbsp;<span class="ident" id="4746983">h</span><span class="op" id="4746984">[</span><span class="string" id="4746985">&#34;Set-Cookie&#34;</span><span class="op" id="4746997">]</span>&nbsp;<span class="op" id="4746999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747003">parts</span>&nbsp;<span class="op" id="4747009">:=</span>&nbsp;<span class="ident" id="4747012">strings</span><span class="op" id="4747019">.</span><span class="ident" id="4747020">Split</span><span class="op" id="4747025">(</span><span class="ident" id="4747026">strings</span><span class="op" id="4747033">.</span><span class="ident" id="4747034">TrimSpace</span><span class="op" id="4747043">(</span><span class="ident" id="4747044">line</span><span class="op" id="4747048">)</span><span class="op" id="4747049">,</span>&nbsp;<span class="string" id="4747051">&#34;;&#34;</span><span class="op" id="4747054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747058">if</span>&nbsp;<span class="builtinfunc" id="4747061">len</span><span class="op" id="4747064">(</span><span class="ident" id="4747065">parts</span><span class="op" id="4747070">)</span>&nbsp;<span class="op" id="4747072">==</span>&nbsp;<span class="num" id="4747075">1</span>&nbsp;<span class="op" id="4747077">&amp;&amp;</span>&nbsp;<span class="ident" id="4747080">parts</span><span class="op" id="4747085">[</span><span class="num" id="4747086">0</span><span class="op" id="4747087">]</span>&nbsp;<span class="op" id="4747089">==</span>&nbsp;<span class="string" id="4747092">&#34;&#34;</span>&nbsp;<span class="op" id="4747095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747100">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747111">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747115">parts</span><span class="op" id="4747120">[</span><span class="num" id="4747121">0</span><span class="op" id="4747122">]</span>&nbsp;<span class="op" id="4747124">=</span>&nbsp;<span class="ident" id="4747126">strings</span><span class="op" id="4747133">.</span><span class="ident" id="4747134">TrimSpace</span><span class="op" id="4747143">(</span><span class="ident" id="4747144">parts</span><span class="op" id="4747149">[</span><span class="num" id="4747150">0</span><span class="op" id="4747151">]</span><span class="op" id="4747152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747156">j</span>&nbsp;<span class="op" id="4747158">:=</span>&nbsp;<span class="ident" id="4747161">strings</span><span class="op" id="4747168">.</span><span class="ident" id="4747169">Index</span><span class="op" id="4747174">(</span><span class="ident" id="4747175">parts</span><span class="op" id="4747180">[</span><span class="num" id="4747181">0</span><span class="op" id="4747182">]</span><span class="op" id="4747183">,</span>&nbsp;<span class="string" id="4747185">&#34;=&#34;</span><span class="op" id="4747188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747192">if</span>&nbsp;<span class="ident" id="4747195">j</span>&nbsp;<span class="op" id="4747197">&lt;</span>&nbsp;<span class="num" id="4747199">0</span>&nbsp;<span class="op" id="4747201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747206">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747217">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747221">name</span><span class="op" id="4747225">,</span>&nbsp;<span class="ident" id="4747227">value</span>&nbsp;<span class="op" id="4747233">:=</span>&nbsp;<span class="ident" id="4747236">parts</span><span class="op" id="4747241">[</span><span class="num" id="4747242">0</span><span class="op" id="4747243">]</span><span class="op" id="4747244">[</span><span class="op" id="4747245">:</span><span class="ident" id="4747246">j</span><span class="op" id="4747247">]</span><span class="op" id="4747248">,</span>&nbsp;<span class="ident" id="4747250">parts</span><span class="op" id="4747255">[</span><span class="num" id="4747256">0</span><span class="op" id="4747257">]</span><span class="op" id="4747258">[</span><span class="ident" id="4747259">j</span><span class="op" id="4747260">+</span><span class="num" id="4747261">1</span><span class="op" id="4747262">:</span><span class="op" id="4747263">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747267">if</span>&nbsp;<span class="op" id="4747270">!</span><span class="ident" id="4747271">isCookieNameValid</span><span class="op" id="4747288">(</span><span class="ident" id="4747289">name</span><span class="op" id="4747293">)</span>&nbsp;<span class="op" id="4747295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747300">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747315">value</span><span class="op" id="4747320">,</span>&nbsp;<span class="ident" id="4747322">success</span>&nbsp;<span class="op" id="4747330">:=</span>&nbsp;<span class="ident" id="4747333">parseCookieValue</span><span class="op" id="4747349">(</span><span class="ident" id="4747350">value</span><span class="op" id="4747355">,</span>&nbsp;<span class="builtintype" id="4747357">true</span><span class="op" id="4747361">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747365">if</span>&nbsp;<span class="op" id="4747368">!</span><span class="ident" id="4747369">success</span>&nbsp;<span class="op" id="4747377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747382">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747397">c</span>&nbsp;<span class="op" id="4747399">:=</span>&nbsp;<span class="op" id="4747402">&amp;</span><span class="ident" id="4747403">Cookie</span><span class="op" id="4747409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747414">Name</span><span class="op" id="4747418">:</span>&nbsp;&nbsp;<span class="ident" id="4747421">name</span><span class="op" id="4747425">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747430">Value</span><span class="op" id="4747435">:</span>&nbsp;<span class="ident" id="4747437">value</span><span class="op" id="4747442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747447">Raw</span><span class="op" id="4747450">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4747454">line</span><span class="op" id="4747458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747466">for</span>&nbsp;<span class="ident" id="4747470">i</span>&nbsp;<span class="op" id="4747472">:=</span>&nbsp;<span class="num" id="4747475">1</span><span class="op" id="4747476">;</span>&nbsp;<span class="ident" id="4747478">i</span>&nbsp;<span class="op" id="4747480">&lt;</span>&nbsp;<span class="builtinfunc" id="4747482">len</span><span class="op" id="4747485">(</span><span class="ident" id="4747486">parts</span><span class="op" id="4747491">)</span><span class="op" id="4747492">;</span>&nbsp;<span class="ident" id="4747494">i</span><span class="op" id="4747495">++</span>&nbsp;<span class="op" id="4747498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747503">parts</span><span class="op" id="4747508">[</span><span class="ident" id="4747509">i</span><span class="op" id="4747510">]</span>&nbsp;<span class="op" id="4747512">=</span>&nbsp;<span class="ident" id="4747514">strings</span><span class="op" id="4747521">.</span><span class="ident" id="4747522">TrimSpace</span><span class="op" id="4747531">(</span><span class="ident" id="4747532">parts</span><span class="op" id="4747537">[</span><span class="ident" id="4747538">i</span><span class="op" id="4747539">]</span><span class="op" id="4747540">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747545">if</span>&nbsp;<span class="builtinfunc" id="4747548">len</span><span class="op" id="4747551">(</span><span class="ident" id="4747552">parts</span><span class="op" id="4747557">[</span><span class="ident" id="4747558">i</span><span class="op" id="4747559">]</span><span class="op" id="4747560">)</span>&nbsp;<span class="op" id="4747562">==</span>&nbsp;<span class="num" id="4747565">0</span>&nbsp;<span class="op" id="4747567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747573">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747591">attr</span><span class="op" id="4747595">,</span>&nbsp;<span class="ident" id="4747597">val</span>&nbsp;<span class="op" id="4747601">:=</span>&nbsp;<span class="ident" id="4747604">parts</span><span class="op" id="4747609">[</span><span class="ident" id="4747610">i</span><span class="op" id="4747611">]</span><span class="op" id="4747612">,</span>&nbsp;<span class="string" id="4747614">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747620">if</span>&nbsp;<span class="ident" id="4747623">j</span>&nbsp;<span class="op" id="4747625">:=</span>&nbsp;<span class="ident" id="4747628">strings</span><span class="op" id="4747635">.</span><span class="ident" id="4747636">Index</span><span class="op" id="4747641">(</span><span class="ident" id="4747642">attr</span><span class="op" id="4747646">,</span>&nbsp;<span class="string" id="4747648">&#34;=&#34;</span><span class="op" id="4747651">)</span><span class="op" id="4747652">;</span>&nbsp;<span class="ident" id="4747654">j</span>&nbsp;<span class="op" id="4747656">&gt;=</span>&nbsp;<span class="num" id="4747659">0</span>&nbsp;<span class="op" id="4747661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747667">attr</span><span class="op" id="4747671">,</span>&nbsp;<span class="ident" id="4747673">val</span>&nbsp;<span class="op" id="4747677">=</span>&nbsp;<span class="ident" id="4747679">attr</span><span class="op" id="4747683">[</span><span class="op" id="4747684">:</span><span class="ident" id="4747685">j</span><span class="op" id="4747686">]</span><span class="op" id="4747687">,</span>&nbsp;<span class="ident" id="4747689">attr</span><span class="op" id="4747693">[</span><span class="ident" id="4747694">j</span><span class="op" id="4747695">+</span><span class="num" id="4747696">1</span><span class="op" id="4747697">:</span><span class="op" id="4747698">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747708">lowerAttr</span>&nbsp;<span class="op" id="4747718">:=</span>&nbsp;<span class="ident" id="4747721">strings</span><span class="op" id="4747728">.</span><span class="ident" id="4747729">ToLower</span><span class="op" id="4747736">(</span><span class="ident" id="4747737">attr</span><span class="op" id="4747741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747746">val</span><span class="op" id="4747749">,</span>&nbsp;<span class="ident" id="4747751">success</span>&nbsp;<span class="op" id="4747759">=</span>&nbsp;<span class="ident" id="4747761">parseCookieValue</span><span class="op" id="4747777">(</span><span class="ident" id="4747778">val</span><span class="op" id="4747781">,</span>&nbsp;<span class="builtintype" id="4747783">false</span><span class="op" id="4747788">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747793">if</span>&nbsp;<span class="op" id="4747796">!</span><span class="ident" id="4747797">success</span>&nbsp;<span class="op" id="4747805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747811">c</span><span class="op" id="4747812">.</span><span class="ident" id="4747813">Unparsed</span>&nbsp;<span class="op" id="4747822">=</span>&nbsp;<span class="builtinfunc" id="4747824">append</span><span class="op" id="4747830">(</span><span class="ident" id="4747831">c</span><span class="op" id="4747832">.</span><span class="ident" id="4747833">Unparsed</span><span class="op" id="4747841">,</span>&nbsp;<span class="ident" id="4747843">parts</span><span class="op" id="4747848">[</span><span class="ident" id="4747849">i</span><span class="op" id="4747850">]</span><span class="op" id="4747851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747857">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4747869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747874">switch</span>&nbsp;<span class="ident" id="4747881">lowerAttr</span>&nbsp;<span class="op" id="4747891">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747896">case</span>&nbsp;<span class="string" id="4747901">&#34;secure&#34;</span><span class="op" id="4747909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747915">c</span><span class="op" id="4747916">.</span><span class="ident" id="4747917">Secure</span>&nbsp;<span class="op" id="4747924">=</span>&nbsp;<span class="builtintype" id="4747926">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747935">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747947">case</span>&nbsp;<span class="string" id="4747952">&#34;httponly&#34;</span><span class="op" id="4747962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4747968">c</span><span class="op" id="4747969">.</span><span class="ident" id="4747970">HttpOnly</span>&nbsp;<span class="op" id="4747979">=</span>&nbsp;<span class="builtintype" id="4747981">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4747990">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748002">case</span>&nbsp;<span class="string" id="4748007">&#34;domain&#34;</span><span class="op" id="4748015">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748021">c</span><span class="op" id="4748022">.</span><span class="ident" id="4748023">Domain</span>&nbsp;<span class="op" id="4748030">=</span>&nbsp;<span class="ident" id="4748032">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748040">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748052">case</span>&nbsp;<span class="string" id="4748057">&#34;max-age&#34;</span><span class="op" id="4748066">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748072">secs</span><span class="op" id="4748076">,</span>&nbsp;<span class="ident" id="4748078">err</span>&nbsp;<span class="op" id="4748082">:=</span>&nbsp;<span class="ident" id="4748085">strconv</span><span class="op" id="4748092">.</span><span class="ident" id="4748093">Atoi</span><span class="op" id="4748097">(</span><span class="ident" id="4748098">val</span><span class="op" id="4748101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748107">if</span>&nbsp;<span class="ident" id="4748110">err</span>&nbsp;<span class="op" id="4748114">!=</span>&nbsp;<span class="ident" id="4748117">nil</span>&nbsp;<span class="op" id="4748121">||</span>&nbsp;<span class="ident" id="4748124">secs</span>&nbsp;<span class="op" id="4748129">!=</span>&nbsp;<span class="num" id="4748132">0</span>&nbsp;<span class="op" id="4748134">&amp;&amp;</span>&nbsp;<span class="ident" id="4748137">val</span><span class="op" id="4748140">[</span><span class="num" id="4748141">0</span><span class="op" id="4748142">]</span>&nbsp;<span class="op" id="4748144">==</span>&nbsp;<span class="string" id="4748147">&#39;0&#39;</span>&nbsp;<span class="op" id="4748151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748158">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748174">if</span>&nbsp;<span class="ident" id="4748177">secs</span>&nbsp;<span class="op" id="4748182">&lt;=</span>&nbsp;<span class="num" id="4748185">0</span>&nbsp;<span class="op" id="4748187">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748194">c</span><span class="op" id="4748195">.</span><span class="ident" id="4748196">MaxAge</span>&nbsp;<span class="op" id="4748203">=</span>&nbsp;<span class="op" id="4748205">-</span><span class="num" id="4748206">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748212">}</span>&nbsp;<span class="keyword" id="4748214">else</span>&nbsp;<span class="op" id="4748219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748226">c</span><span class="op" id="4748227">.</span><span class="ident" id="4748228">MaxAge</span>&nbsp;<span class="op" id="4748235">=</span>&nbsp;<span class="ident" id="4748237">secs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748252">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748264">case</span>&nbsp;<span class="string" id="4748269">&#34;expires&#34;</span><span class="op" id="4748278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748284">c</span><span class="op" id="4748285">.</span><span class="ident" id="4748286">RawExpires</span>&nbsp;<span class="op" id="4748297">=</span>&nbsp;<span class="ident" id="4748299">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748307">exptime</span><span class="op" id="4748314">,</span>&nbsp;<span class="ident" id="4748316">err</span>&nbsp;<span class="op" id="4748320">:=</span>&nbsp;<span class="ident" id="4748323">time</span><span class="op" id="4748327">.</span><span class="ident" id="4748328">Parse</span><span class="op" id="4748333">(</span><span class="ident" id="4748334">time</span><span class="op" id="4748338">.</span><span class="ident" id="4748339">RFC1123</span><span class="op" id="4748346">,</span>&nbsp;<span class="ident" id="4748348">val</span><span class="op" id="4748351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748357">if</span>&nbsp;<span class="ident" id="4748360">err</span>&nbsp;<span class="op" id="4748364">!=</span>&nbsp;<span class="ident" id="4748367">nil</span>&nbsp;<span class="op" id="4748371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748378">exptime</span><span class="op" id="4748385">,</span>&nbsp;<span class="ident" id="4748387">err</span>&nbsp;<span class="op" id="4748391">=</span>&nbsp;<span class="ident" id="4748393">time</span><span class="op" id="4748397">.</span><span class="ident" id="4748398">Parse</span><span class="op" id="4748403">(</span><span class="string" id="4748404">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="4748435">,</span>&nbsp;<span class="ident" id="4748437">val</span><span class="op" id="4748440">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748447">if</span>&nbsp;<span class="ident" id="4748450">err</span>&nbsp;<span class="op" id="4748454">!=</span>&nbsp;<span class="ident" id="4748457">nil</span>&nbsp;<span class="op" id="4748461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748469">c</span><span class="op" id="4748470">.</span><span class="ident" id="4748471">Expires</span>&nbsp;<span class="op" id="4748479">=</span>&nbsp;<span class="ident" id="4748481">time</span><span class="op" id="4748485">.</span><span class="ident" id="4748486">Time</span><span class="op" id="4748490">{</span><span class="op" id="4748491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748499">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748516">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748522">c</span><span class="op" id="4748523">.</span><span class="ident" id="4748524">Expires</span>&nbsp;<span class="op" id="4748532">=</span>&nbsp;<span class="ident" id="4748534">exptime</span><span class="op" id="4748541">.</span><span class="ident" id="4748542">UTC</span><span class="op" id="4748545">(</span><span class="op" id="4748546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748552">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748564">case</span>&nbsp;<span class="string" id="4748569">&#34;path&#34;</span><span class="op" id="4748575">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748581">c</span><span class="op" id="4748582">.</span><span class="ident" id="4748583">Path</span>&nbsp;<span class="op" id="4748588">=</span>&nbsp;<span class="ident" id="4748590">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748598">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748615">c</span><span class="op" id="4748616">.</span><span class="ident" id="4748617">Unparsed</span>&nbsp;<span class="op" id="4748626">=</span>&nbsp;<span class="builtinfunc" id="4748628">append</span><span class="op" id="4748634">(</span><span class="ident" id="4748635">c</span><span class="op" id="4748636">.</span><span class="ident" id="4748637">Unparsed</span><span class="op" id="4748645">,</span>&nbsp;<span class="ident" id="4748647">parts</span><span class="op" id="4748652">[</span><span class="ident" id="4748653">i</span><span class="op" id="4748654">]</span><span class="op" id="4748655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748663">cookies</span>&nbsp;<span class="op" id="4748671">=</span>&nbsp;<span class="builtinfunc" id="4748673">append</span><span class="op" id="4748679">(</span><span class="ident" id="4748680">cookies</span><span class="op" id="4748687">,</span>&nbsp;<span class="ident" id="4748689">c</span><span class="op" id="4748690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4748693">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4748696">return</span>&nbsp;<span class="ident" id="4748703">cookies</span><br>
<span class="lineno"></span><span class="op" id="4748711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4748714">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="4748794">func</span>&nbsp;<span class="ident" id="4748799">SetCookie</span><span class="op" id="4748808">(</span><span class="ident" id="4748809">w</span>&nbsp;<span class="ident" id="4748811">ResponseWriter</span><span class="op" id="4748825">,</span>&nbsp;<span class="ident" id="4748827">cookie</span>&nbsp;<span class="op" id="4748834">*</span><span class="ident" id="4748835">Cookie</span><span class="op" id="4748841">)</span>&nbsp;<span class="op" id="4748843">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4748846">w</span><span class="op" id="4748847">.</span><span class="ident" id="4748848">Header</span><span class="op" id="4748854">(</span><span class="op" id="4748855">)</span><span class="op" id="4748856">.</span><span class="ident" id="4748857">Add</span><span class="op" id="4748860">(</span><span class="string" id="4748861">&#34;Set-Cookie&#34;</span><span class="op" id="4748873">,</span>&nbsp;<span class="ident" id="4748875">cookie</span><span class="op" id="4748881">.</span><span class="ident" id="4748882">String</span><span class="op" id="4748888">(</span><span class="op" id="4748889">)</span><span class="op" id="4748890">)</span><br>
<span class="lineno"></span><span class="op" id="4748892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4748895">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="4748965">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="4749033">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="4749070">func</span>&nbsp;<span class="op" id="4749075">(</span><span class="ident" id="4749076">c</span>&nbsp;<span class="op" id="4749078">*</span><span class="ident" id="4749079">Cookie</span><span class="op" id="4749085">)</span>&nbsp;<span class="ident" id="4749087">String</span><span class="op" id="4749093">(</span><span class="op" id="4749094">)</span>&nbsp;<span class="builtintype" id="4749096">string</span>&nbsp;<span class="op" id="4749103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749106">var</span>&nbsp;<span class="ident" id="4749110">b</span>&nbsp;<span class="ident" id="4749112">bytes</span><span class="op" id="4749117">.</span><span class="ident" id="4749118">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749126">fmt</span><span class="op" id="4749129">.</span><span class="ident" id="4749130">Fprintf</span><span class="op" id="4749137">(</span><span class="op" id="4749138">&amp;</span><span class="ident" id="4749139">b</span><span class="op" id="4749140">,</span>&nbsp;<span class="string" id="4749142">&#34;%s=%s&#34;</span><span class="op" id="4749149">,</span>&nbsp;<span class="ident" id="4749151">sanitizeCookieName</span><span class="op" id="4749169">(</span><span class="ident" id="4749170">c</span><span class="op" id="4749171">.</span><span class="ident" id="4749172">Name</span><span class="op" id="4749176">)</span><span class="op" id="4749177">,</span>&nbsp;<span class="ident" id="4749179">sanitizeCookieValue</span><span class="op" id="4749198">(</span><span class="ident" id="4749199">c</span><span class="op" id="4749200">.</span><span class="ident" id="4749201">Value</span><span class="op" id="4749206">)</span><span class="op" id="4749207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749210">if</span>&nbsp;<span class="builtinfunc" id="4749213">len</span><span class="op" id="4749216">(</span><span class="ident" id="4749217">c</span><span class="op" id="4749218">.</span><span class="ident" id="4749219">Path</span><span class="op" id="4749223">)</span>&nbsp;<span class="op" id="4749225">&gt;</span>&nbsp;<span class="num" id="4749227">0</span>&nbsp;<span class="op" id="4749229">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749233">fmt</span><span class="op" id="4749236">.</span><span class="ident" id="4749237">Fprintf</span><span class="op" id="4749244">(</span><span class="op" id="4749245">&amp;</span><span class="ident" id="4749246">b</span><span class="op" id="4749247">,</span>&nbsp;<span class="string" id="4749249">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="4749260">,</span>&nbsp;<span class="ident" id="4749262">sanitizeCookiePath</span><span class="op" id="4749280">(</span><span class="ident" id="4749281">c</span><span class="op" id="4749282">.</span><span class="ident" id="4749283">Path</span><span class="op" id="4749287">)</span><span class="op" id="4749288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749294">if</span>&nbsp;<span class="builtinfunc" id="4749297">len</span><span class="op" id="4749300">(</span><span class="ident" id="4749301">c</span><span class="op" id="4749302">.</span><span class="ident" id="4749303">Domain</span><span class="op" id="4749309">)</span>&nbsp;<span class="op" id="4749311">&gt;</span>&nbsp;<span class="num" id="4749313">0</span>&nbsp;<span class="op" id="4749315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749319">if</span>&nbsp;<span class="ident" id="4749322">validCookieDomain</span><span class="op" id="4749339">(</span><span class="ident" id="4749340">c</span><span class="op" id="4749341">.</span><span class="ident" id="4749342">Domain</span><span class="op" id="4749348">)</span>&nbsp;<span class="op" id="4749350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4749355">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4749409">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4749467">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4749520">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749545">d</span>&nbsp;<span class="op" id="4749547">:=</span>&nbsp;<span class="ident" id="4749550">c</span><span class="op" id="4749551">.</span><span class="ident" id="4749552">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749562">if</span>&nbsp;<span class="ident" id="4749565">d</span><span class="op" id="4749566">[</span><span class="num" id="4749567">0</span><span class="op" id="4749568">]</span>&nbsp;<span class="op" id="4749570">==</span>&nbsp;<span class="string" id="4749573">&#39;.&#39;</span>&nbsp;<span class="op" id="4749577">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749583">d</span>&nbsp;<span class="op" id="4749585">=</span>&nbsp;<span class="ident" id="4749587">d</span><span class="op" id="4749588">[</span><span class="num" id="4749589">1</span><span class="op" id="4749590">:</span><span class="op" id="4749591">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749601">fmt</span><span class="op" id="4749604">.</span><span class="ident" id="4749605">Fprintf</span><span class="op" id="4749612">(</span><span class="op" id="4749613">&amp;</span><span class="ident" id="4749614">b</span><span class="op" id="4749615">,</span>&nbsp;<span class="string" id="4749617">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="4749630">,</span>&nbsp;<span class="ident" id="4749632">d</span><span class="op" id="4749633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749637">}</span>&nbsp;<span class="keyword" id="4749639">else</span>&nbsp;<span class="op" id="4749644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749649">log</span><span class="op" id="4749652">.</span><span class="ident" id="4749653">Printf</span><span class="op" id="4749659">(</span><span class="string" id="4749660">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="4749723">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749729">c</span><span class="op" id="4749730">.</span><span class="ident" id="4749731">Domain</span><span class="op" id="4749737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749747">if</span>&nbsp;<span class="ident" id="4749750">c</span><span class="op" id="4749751">.</span><span class="ident" id="4749752">Expires</span><span class="op" id="4749759">.</span><span class="ident" id="4749760">Unix</span><span class="op" id="4749764">(</span><span class="op" id="4749765">)</span>&nbsp;<span class="op" id="4749767">&gt;</span>&nbsp;<span class="num" id="4749769">0</span>&nbsp;<span class="op" id="4749771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749775">fmt</span><span class="op" id="4749778">.</span><span class="ident" id="4749779">Fprintf</span><span class="op" id="4749786">(</span><span class="op" id="4749787">&amp;</span><span class="ident" id="4749788">b</span><span class="op" id="4749789">,</span>&nbsp;<span class="string" id="4749791">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="4749805">,</span>&nbsp;<span class="ident" id="4749807">c</span><span class="op" id="4749808">.</span><span class="ident" id="4749809">Expires</span><span class="op" id="4749816">.</span><span class="ident" id="4749817">UTC</span><span class="op" id="4749820">(</span><span class="op" id="4749821">)</span><span class="op" id="4749822">.</span><span class="ident" id="4749823">Format</span><span class="op" id="4749829">(</span><span class="ident" id="4749830">time</span><span class="op" id="4749834">.</span><span class="ident" id="4749835">RFC1123</span><span class="op" id="4749842">)</span><span class="op" id="4749843">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749849">if</span>&nbsp;<span class="ident" id="4749852">c</span><span class="op" id="4749853">.</span><span class="ident" id="4749854">MaxAge</span>&nbsp;<span class="op" id="4749861">&gt;</span>&nbsp;<span class="num" id="4749863">0</span>&nbsp;<span class="op" id="4749865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749869">fmt</span><span class="op" id="4749872">.</span><span class="ident" id="4749873">Fprintf</span><span class="op" id="4749880">(</span><span class="op" id="4749881">&amp;</span><span class="ident" id="4749882">b</span><span class="op" id="4749883">,</span>&nbsp;<span class="string" id="4749885">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="4749899">,</span>&nbsp;<span class="ident" id="4749901">c</span><span class="op" id="4749902">.</span><span class="ident" id="4749903">MaxAge</span><span class="op" id="4749909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749912">}</span>&nbsp;<span class="keyword" id="4749914">else</span>&nbsp;<span class="keyword" id="4749919">if</span>&nbsp;<span class="ident" id="4749922">c</span><span class="op" id="4749923">.</span><span class="ident" id="4749924">MaxAge</span>&nbsp;<span class="op" id="4749931">&lt;</span>&nbsp;<span class="num" id="4749933">0</span>&nbsp;<span class="op" id="4749935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749939">fmt</span><span class="op" id="4749942">.</span><span class="ident" id="4749943">Fprintf</span><span class="op" id="4749950">(</span><span class="op" id="4749951">&amp;</span><span class="ident" id="4749952">b</span><span class="op" id="4749953">,</span>&nbsp;<span class="string" id="4749955">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="4749968">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4749971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4749974">if</span>&nbsp;<span class="ident" id="4749977">c</span><span class="op" id="4749978">.</span><span class="ident" id="4749979">HttpOnly</span>&nbsp;<span class="op" id="4749988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4749992">fmt</span><span class="op" id="4749995">.</span><span class="ident" id="4749996">Fprintf</span><span class="op" id="4750003">(</span><span class="op" id="4750004">&amp;</span><span class="ident" id="4750005">b</span><span class="op" id="4750006">,</span>&nbsp;<span class="string" id="4750008">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="4750020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750026">if</span>&nbsp;<span class="ident" id="4750029">c</span><span class="op" id="4750030">.</span><span class="ident" id="4750031">Secure</span>&nbsp;<span class="op" id="4750038">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750042">fmt</span><span class="op" id="4750045">.</span><span class="ident" id="4750046">Fprintf</span><span class="op" id="4750053">(</span><span class="op" id="4750054">&amp;</span><span class="ident" id="4750055">b</span><span class="op" id="4750056">,</span>&nbsp;<span class="string" id="4750058">&#34;;&nbsp;Secure&#34;</span><span class="op" id="4750068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750074">return</span>&nbsp;<span class="ident" id="4750081">b</span><span class="op" id="4750082">.</span><span class="ident" id="4750083">String</span><span class="op" id="4750089">(</span><span class="op" id="4750090">)</span><br>
<span class="lineno"></span><span class="op" id="4750092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="4750095">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4750159">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="4750203">//</span><br>
<span class="lineno"></span><span class="comment" id="4750206">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="4750271">func</span>&nbsp;<span class="ident" id="4750276">readCookies</span><span class="op" id="4750287">(</span><span class="ident" id="4750288">h</span>&nbsp;<span class="ident" id="4750290">Header</span><span class="op" id="4750296">,</span>&nbsp;<span class="ident" id="4750298">filter</span>&nbsp;<span class="builtintype" id="4750305">string</span><span class="op" id="4750311">)</span>&nbsp;<span class="op" id="4750313">[</span><span class="op" id="4750314">]</span><span class="op" id="4750315">*</span><span class="ident" id="4750316">Cookie</span>&nbsp;<span class="op" id="4750323">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750326">cookies</span>&nbsp;<span class="op" id="4750334">:=</span>&nbsp;<span class="op" id="4750337">[</span><span class="op" id="4750338">]</span><span class="op" id="4750339">*</span><span class="ident" id="4750340">Cookie</span><span class="op" id="4750346">{</span><span class="op" id="4750347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750350">lines</span><span class="op" id="4750355">,</span>&nbsp;<span class="ident" id="4750357">ok</span>&nbsp;<span class="op" id="4750360">:=</span>&nbsp;<span class="ident" id="4750363">h</span><span class="op" id="4750364">[</span><span class="string" id="4750365">&#34;Cookie&#34;</span><span class="op" id="4750373">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750376">if</span>&nbsp;<span class="op" id="4750379">!</span><span class="ident" id="4750380">ok</span>&nbsp;<span class="op" id="4750383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750387">return</span>&nbsp;<span class="ident" id="4750394">cookies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750403">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750407">for</span>&nbsp;<span class="ident" id="4750411">_</span><span class="op" id="4750412">,</span>&nbsp;<span class="ident" id="4750414">line</span>&nbsp;<span class="op" id="4750419">:=</span>&nbsp;<span class="keyword" id="4750422">range</span>&nbsp;<span class="ident" id="4750428">lines</span>&nbsp;<span class="op" id="4750434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750438">parts</span>&nbsp;<span class="op" id="4750444">:=</span>&nbsp;<span class="ident" id="4750447">strings</span><span class="op" id="4750454">.</span><span class="ident" id="4750455">Split</span><span class="op" id="4750460">(</span><span class="ident" id="4750461">strings</span><span class="op" id="4750468">.</span><span class="ident" id="4750469">TrimSpace</span><span class="op" id="4750478">(</span><span class="ident" id="4750479">line</span><span class="op" id="4750483">)</span><span class="op" id="4750484">,</span>&nbsp;<span class="string" id="4750486">&#34;;&#34;</span><span class="op" id="4750489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750493">if</span>&nbsp;<span class="builtinfunc" id="4750496">len</span><span class="op" id="4750499">(</span><span class="ident" id="4750500">parts</span><span class="op" id="4750505">)</span>&nbsp;<span class="op" id="4750507">==</span>&nbsp;<span class="num" id="4750510">1</span>&nbsp;<span class="op" id="4750512">&amp;&amp;</span>&nbsp;<span class="ident" id="4750515">parts</span><span class="op" id="4750520">[</span><span class="num" id="4750521">0</span><span class="op" id="4750522">]</span>&nbsp;<span class="op" id="4750524">==</span>&nbsp;<span class="string" id="4750527">&#34;&#34;</span>&nbsp;<span class="op" id="4750530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750535">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4750550">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750575">parsedPairs</span>&nbsp;<span class="op" id="4750587">:=</span>&nbsp;<span class="num" id="4750590">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750594">for</span>&nbsp;<span class="ident" id="4750598">i</span>&nbsp;<span class="op" id="4750600">:=</span>&nbsp;<span class="num" id="4750603">0</span><span class="op" id="4750604">;</span>&nbsp;<span class="ident" id="4750606">i</span>&nbsp;<span class="op" id="4750608">&lt;</span>&nbsp;<span class="builtinfunc" id="4750610">len</span><span class="op" id="4750613">(</span><span class="ident" id="4750614">parts</span><span class="op" id="4750619">)</span><span class="op" id="4750620">;</span>&nbsp;<span class="ident" id="4750622">i</span><span class="op" id="4750623">++</span>&nbsp;<span class="op" id="4750626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750631">parts</span><span class="op" id="4750636">[</span><span class="ident" id="4750637">i</span><span class="op" id="4750638">]</span>&nbsp;<span class="op" id="4750640">=</span>&nbsp;<span class="ident" id="4750642">strings</span><span class="op" id="4750649">.</span><span class="ident" id="4750650">TrimSpace</span><span class="op" id="4750659">(</span><span class="ident" id="4750660">parts</span><span class="op" id="4750665">[</span><span class="ident" id="4750666">i</span><span class="op" id="4750667">]</span><span class="op" id="4750668">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750673">if</span>&nbsp;<span class="builtinfunc" id="4750676">len</span><span class="op" id="4750679">(</span><span class="ident" id="4750680">parts</span><span class="op" id="4750685">[</span><span class="ident" id="4750686">i</span><span class="op" id="4750687">]</span><span class="op" id="4750688">)</span>&nbsp;<span class="op" id="4750690">==</span>&nbsp;<span class="num" id="4750693">0</span>&nbsp;<span class="op" id="4750695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750701">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750718">name</span><span class="op" id="4750722">,</span>&nbsp;<span class="ident" id="4750724">val</span>&nbsp;<span class="op" id="4750728">:=</span>&nbsp;<span class="ident" id="4750731">parts</span><span class="op" id="4750736">[</span><span class="ident" id="4750737">i</span><span class="op" id="4750738">]</span><span class="op" id="4750739">,</span>&nbsp;<span class="string" id="4750741">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750747">if</span>&nbsp;<span class="ident" id="4750750">j</span>&nbsp;<span class="op" id="4750752">:=</span>&nbsp;<span class="ident" id="4750755">strings</span><span class="op" id="4750762">.</span><span class="ident" id="4750763">Index</span><span class="op" id="4750768">(</span><span class="ident" id="4750769">name</span><span class="op" id="4750773">,</span>&nbsp;<span class="string" id="4750775">&#34;=&#34;</span><span class="op" id="4750778">)</span><span class="op" id="4750779">;</span>&nbsp;<span class="ident" id="4750781">j</span>&nbsp;<span class="op" id="4750783">&gt;=</span>&nbsp;<span class="num" id="4750786">0</span>&nbsp;<span class="op" id="4750788">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750794">name</span><span class="op" id="4750798">,</span>&nbsp;<span class="ident" id="4750800">val</span>&nbsp;<span class="op" id="4750804">=</span>&nbsp;<span class="ident" id="4750806">name</span><span class="op" id="4750810">[</span><span class="op" id="4750811">:</span><span class="ident" id="4750812">j</span><span class="op" id="4750813">]</span><span class="op" id="4750814">,</span>&nbsp;<span class="ident" id="4750816">name</span><span class="op" id="4750820">[</span><span class="ident" id="4750821">j</span><span class="op" id="4750822">+</span><span class="num" id="4750823">1</span><span class="op" id="4750824">:</span><span class="op" id="4750825">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750835">if</span>&nbsp;<span class="op" id="4750838">!</span><span class="ident" id="4750839">isCookieNameValid</span><span class="op" id="4750856">(</span><span class="ident" id="4750857">name</span><span class="op" id="4750861">)</span>&nbsp;<span class="op" id="4750863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750869">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750881">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750886">if</span>&nbsp;<span class="ident" id="4750889">filter</span>&nbsp;<span class="op" id="4750896">!=</span>&nbsp;<span class="string" id="4750899">&#34;&#34;</span>&nbsp;<span class="op" id="4750902">&amp;&amp;</span>&nbsp;<span class="ident" id="4750905">filter</span>&nbsp;<span class="op" id="4750912">!=</span>&nbsp;<span class="ident" id="4750915">name</span>&nbsp;<span class="op" id="4750920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750926">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4750938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4750943">val</span><span class="op" id="4750946">,</span>&nbsp;<span class="ident" id="4750948">success</span>&nbsp;<span class="op" id="4750956">:=</span>&nbsp;<span class="ident" id="4750959">parseCookieValue</span><span class="op" id="4750975">(</span><span class="ident" id="4750976">val</span><span class="op" id="4750979">,</span>&nbsp;<span class="builtintype" id="4750981">true</span><span class="op" id="4750985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4750990">if</span>&nbsp;<span class="op" id="4750993">!</span><span class="ident" id="4750994">success</span>&nbsp;<span class="op" id="4751002">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751008">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751025">cookies</span>&nbsp;<span class="op" id="4751033">=</span>&nbsp;<span class="builtinfunc" id="4751035">append</span><span class="op" id="4751041">(</span><span class="ident" id="4751042">cookies</span><span class="op" id="4751049">,</span>&nbsp;<span class="op" id="4751051">&amp;</span><span class="ident" id="4751052">Cookie</span><span class="op" id="4751058">{</span><span class="ident" id="4751059">Name</span><span class="op" id="4751063">:</span>&nbsp;<span class="ident" id="4751065">name</span><span class="op" id="4751069">,</span>&nbsp;<span class="ident" id="4751071">Value</span><span class="op" id="4751076">:</span>&nbsp;<span class="ident" id="4751078">val</span><span class="op" id="4751081">}</span><span class="op" id="4751082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751087">parsedPairs</span><span class="op" id="4751098">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751103">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751109">return</span>&nbsp;<span class="ident" id="4751116">cookies</span><br>
<span class="lineno"></span><span class="op" id="4751124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4751127">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="4751197">func</span>&nbsp;<span class="ident" id="4751202">validCookieDomain</span><span class="op" id="4751219">(</span><span class="ident" id="4751220">v</span>&nbsp;<span class="builtintype" id="4751222">string</span><span class="op" id="4751228">)</span>&nbsp;<span class="builtintype" id="4751230">bool</span>&nbsp;<span class="op" id="4751235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751238">if</span>&nbsp;<span class="ident" id="4751241">isCookieDomainName</span><span class="op" id="4751259">(</span><span class="ident" id="4751260">v</span><span class="op" id="4751261">)</span>&nbsp;<span class="op" id="4751263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751267">return</span>&nbsp;<span class="builtintype" id="4751274">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751283">if</span>&nbsp;<span class="ident" id="4751286">net</span><span class="op" id="4751289">.</span><span class="ident" id="4751290">ParseIP</span><span class="op" id="4751297">(</span><span class="ident" id="4751298">v</span><span class="op" id="4751299">)</span>&nbsp;<span class="op" id="4751301">!=</span>&nbsp;<span class="ident" id="4751304">nil</span>&nbsp;<span class="op" id="4751308">&amp;&amp;</span>&nbsp;<span class="op" id="4751311">!</span><span class="ident" id="4751312">strings</span><span class="op" id="4751319">.</span><span class="ident" id="4751320">Contains</span><span class="op" id="4751328">(</span><span class="ident" id="4751329">v</span><span class="op" id="4751330">,</span>&nbsp;<span class="string" id="4751332">&#34;:&#34;</span><span class="op" id="4751335">)</span>&nbsp;<span class="op" id="4751337">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751341">return</span>&nbsp;<span class="builtintype" id="4751348">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751357">return</span>&nbsp;<span class="builtintype" id="4751364">false</span><br>
<span class="lineno"></span><span class="op" id="4751370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="4751373">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="4751447">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4751517">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="4751548">func</span>&nbsp;<span class="ident" id="4751553">isCookieDomainName</span><span class="op" id="4751571">(</span><span class="ident" id="4751572">s</span>&nbsp;<span class="builtintype" id="4751574">string</span><span class="op" id="4751580">)</span>&nbsp;<span class="builtintype" id="4751582">bool</span>&nbsp;<span class="op" id="4751587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751590">if</span>&nbsp;<span class="builtinfunc" id="4751593">len</span><span class="op" id="4751596">(</span><span class="ident" id="4751597">s</span><span class="op" id="4751598">)</span>&nbsp;<span class="op" id="4751600">==</span>&nbsp;<span class="num" id="4751603">0</span>&nbsp;<span class="op" id="4751605">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751609">return</span>&nbsp;<span class="builtintype" id="4751616">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751626">if</span>&nbsp;<span class="builtinfunc" id="4751629">len</span><span class="op" id="4751632">(</span><span class="ident" id="4751633">s</span><span class="op" id="4751634">)</span>&nbsp;<span class="op" id="4751636">&gt;</span>&nbsp;<span class="num" id="4751638">255</span>&nbsp;<span class="op" id="4751642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751646">return</span>&nbsp;<span class="builtintype" id="4751653">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751660">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751664">if</span>&nbsp;<span class="ident" id="4751667">s</span><span class="op" id="4751668">[</span><span class="num" id="4751669">0</span><span class="op" id="4751670">]</span>&nbsp;<span class="op" id="4751672">==</span>&nbsp;<span class="string" id="4751675">&#39;.&#39;</span>&nbsp;<span class="op" id="4751679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4751683">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751746">s</span>&nbsp;<span class="op" id="4751748">=</span>&nbsp;<span class="ident" id="4751750">s</span><span class="op" id="4751751">[</span><span class="num" id="4751752">1</span><span class="op" id="4751753">:</span><span class="op" id="4751754">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4751757">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751760">last</span>&nbsp;<span class="op" id="4751765">:=</span>&nbsp;<span class="builtintype" id="4751768">byte</span><span class="op" id="4751772">(</span><span class="string" id="4751773">&#39;.&#39;</span><span class="op" id="4751776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751779">ok</span>&nbsp;<span class="op" id="4751782">:=</span>&nbsp;<span class="builtintype" id="4751785">false</span>&nbsp;<span class="comment" id="4751791">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751824">partlen</span>&nbsp;<span class="op" id="4751832">:=</span>&nbsp;<span class="num" id="4751835">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751838">for</span>&nbsp;<span class="ident" id="4751842">i</span>&nbsp;<span class="op" id="4751844">:=</span>&nbsp;<span class="num" id="4751847">0</span><span class="op" id="4751848">;</span>&nbsp;<span class="ident" id="4751850">i</span>&nbsp;<span class="op" id="4751852">&lt;</span>&nbsp;<span class="builtinfunc" id="4751854">len</span><span class="op" id="4751857">(</span><span class="ident" id="4751858">s</span><span class="op" id="4751859">)</span><span class="op" id="4751860">;</span>&nbsp;<span class="ident" id="4751862">i</span><span class="op" id="4751863">++</span>&nbsp;<span class="op" id="4751866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4751870">c</span>&nbsp;<span class="op" id="4751872">:=</span>&nbsp;<span class="ident" id="4751875">s</span><span class="op" id="4751876">[</span><span class="ident" id="4751877">i</span><span class="op" id="4751878">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751882">switch</span>&nbsp;<span class="op" id="4751889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751893">default</span><span class="op" id="4751900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751905">return</span>&nbsp;<span class="builtintype" id="4751912">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4751920">case</span>&nbsp;<span class="string" id="4751925">&#39;a&#39;</span>&nbsp;<span class="op" id="4751929">&lt;=</span>&nbsp;<span class="ident" id="4751932">c</span>&nbsp;<span class="op" id="4751934">&amp;&amp;</span>&nbsp;<span class="ident" id="4751937">c</span>&nbsp;<span class="op" id="4751939">&lt;=</span>&nbsp;<span class="string" id="4751942">&#39;z&#39;</span>&nbsp;<span class="op" id="4751946">||</span>&nbsp;<span class="string" id="4751949">&#39;A&#39;</span>&nbsp;<span class="op" id="4751953">&lt;=</span>&nbsp;<span class="ident" id="4751956">c</span>&nbsp;<span class="op" id="4751958">&amp;&amp;</span>&nbsp;<span class="ident" id="4751961">c</span>&nbsp;<span class="op" id="4751963">&lt;=</span>&nbsp;<span class="string" id="4751966">&#39;Z&#39;</span><span class="op" id="4751969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4751974">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752030">ok</span>&nbsp;<span class="op" id="4752033">=</span>&nbsp;<span class="builtintype" id="4752035">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752043">partlen</span><span class="op" id="4752050">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752055">case</span>&nbsp;<span class="string" id="4752060">&#39;0&#39;</span>&nbsp;<span class="op" id="4752064">&lt;=</span>&nbsp;<span class="ident" id="4752067">c</span>&nbsp;<span class="op" id="4752069">&amp;&amp;</span>&nbsp;<span class="ident" id="4752072">c</span>&nbsp;<span class="op" id="4752074">&lt;=</span>&nbsp;<span class="string" id="4752077">&#39;9&#39;</span><span class="op" id="4752080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752085">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752096">partlen</span><span class="op" id="4752103">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752108">case</span>&nbsp;<span class="ident" id="4752113">c</span>&nbsp;<span class="op" id="4752115">==</span>&nbsp;<span class="string" id="4752118">&#39;-&#39;</span><span class="op" id="4752121">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752126">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752164">if</span>&nbsp;<span class="ident" id="4752167">last</span>&nbsp;<span class="op" id="4752172">==</span>&nbsp;<span class="string" id="4752175">&#39;.&#39;</span>&nbsp;<span class="op" id="4752179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752185">return</span>&nbsp;<span class="builtintype" id="4752192">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752201">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752206">partlen</span><span class="op" id="4752213">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752218">case</span>&nbsp;<span class="ident" id="4752223">c</span>&nbsp;<span class="op" id="4752225">==</span>&nbsp;<span class="string" id="4752228">&#39;.&#39;</span><span class="op" id="4752231">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4752236">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752279">if</span>&nbsp;<span class="ident" id="4752282">last</span>&nbsp;<span class="op" id="4752287">==</span>&nbsp;<span class="string" id="4752290">&#39;.&#39;</span>&nbsp;<span class="op" id="4752294">||</span>&nbsp;<span class="ident" id="4752297">last</span>&nbsp;<span class="op" id="4752302">==</span>&nbsp;<span class="string" id="4752305">&#39;-&#39;</span>&nbsp;<span class="op" id="4752309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752315">return</span>&nbsp;<span class="builtintype" id="4752322">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752336">if</span>&nbsp;<span class="ident" id="4752339">partlen</span>&nbsp;<span class="op" id="4752347">&gt;</span>&nbsp;<span class="num" id="4752349">63</span>&nbsp;<span class="op" id="4752352">||</span>&nbsp;<span class="ident" id="4752355">partlen</span>&nbsp;<span class="op" id="4752363">==</span>&nbsp;<span class="num" id="4752366">0</span>&nbsp;<span class="op" id="4752368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752374">return</span>&nbsp;<span class="builtintype" id="4752381">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752395">partlen</span>&nbsp;<span class="op" id="4752403">=</span>&nbsp;<span class="num" id="4752405">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4752413">last</span>&nbsp;<span class="op" id="4752418">=</span>&nbsp;<span class="ident" id="4752420">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752426">if</span>&nbsp;<span class="ident" id="4752429">last</span>&nbsp;<span class="op" id="4752434">==</span>&nbsp;<span class="string" id="4752437">&#39;-&#39;</span>&nbsp;<span class="op" id="4752441">||</span>&nbsp;<span class="ident" id="4752444">partlen</span>&nbsp;<span class="op" id="4752452">&gt;</span>&nbsp;<span class="num" id="4752454">63</span>&nbsp;<span class="op" id="4752457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752461">return</span>&nbsp;<span class="builtintype" id="4752468">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4752475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752479">return</span>&nbsp;<span class="ident" id="4752486">ok</span><br>
<span class="lineno"></span><span class="op" id="4752489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4752492">var</span>&nbsp;<span class="ident" id="4752496">cookieNameSanitizer</span>&nbsp;<span class="op" id="4752516">=</span>&nbsp;<span class="ident" id="4752518">strings</span><span class="op" id="4752525">.</span><span class="ident" id="4752526">NewReplacer</span><span class="op" id="4752537">(</span><span class="string" id="4752538">&#34;\n&#34;</span><span class="op" id="4752542">,</span>&nbsp;<span class="string" id="4752544">&#34;-&#34;</span><span class="op" id="4752547">,</span>&nbsp;<span class="string" id="4752549">&#34;\r&#34;</span><span class="op" id="4752553">,</span>&nbsp;<span class="string" id="4752555">&#34;-&#34;</span><span class="op" id="4752558">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4752561">func</span>&nbsp;<span class="ident" id="4752566">sanitizeCookieName</span><span class="op" id="4752584">(</span><span class="ident" id="4752585">n</span>&nbsp;<span class="builtintype" id="4752587">string</span><span class="op" id="4752593">)</span>&nbsp;<span class="builtintype" id="4752595">string</span>&nbsp;<span class="op" id="4752602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4752605">return</span>&nbsp;<span class="ident" id="4752612">cookieNameSanitizer</span><span class="op" id="4752631">.</span><span class="ident" id="4752632">Replace</span><span class="op" id="4752639">(</span><span class="ident" id="4752640">n</span><span class="op" id="4752641">)</span><br>
<span class="lineno"></span><span class="op" id="4752643">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="4752646">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="4752698">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="4752769">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="4752837">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="4752888">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="4752940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="4752969">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="4753036">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="4753105">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="4753131">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="4753187">func</span>&nbsp;<span class="ident" id="4753192">sanitizeCookieValue</span><span class="op" id="4753211">(</span><span class="ident" id="4753212">v</span>&nbsp;<span class="builtintype" id="4753214">string</span><span class="op" id="4753220">)</span>&nbsp;<span class="builtintype" id="4753222">string</span>&nbsp;<span class="op" id="4753229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753232">v</span>&nbsp;<span class="op" id="4753234">=</span>&nbsp;<span class="ident" id="4753236">sanitizeOrWarn</span><span class="op" id="4753250">(</span><span class="string" id="4753251">&#34;Cookie.Value&#34;</span><span class="op" id="4753265">,</span>&nbsp;<span class="ident" id="4753267">validCookieValueByte</span><span class="op" id="4753287">,</span>&nbsp;<span class="ident" id="4753289">v</span><span class="op" id="4753290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753293">if</span>&nbsp;<span class="builtinfunc" id="4753296">len</span><span class="op" id="4753299">(</span><span class="ident" id="4753300">v</span><span class="op" id="4753301">)</span>&nbsp;<span class="op" id="4753303">==</span>&nbsp;<span class="num" id="4753306">0</span>&nbsp;<span class="op" id="4753308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753312">return</span>&nbsp;<span class="ident" id="4753319">v</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753325">if</span>&nbsp;<span class="ident" id="4753328">v</span><span class="op" id="4753329">[</span><span class="num" id="4753330">0</span><span class="op" id="4753331">]</span>&nbsp;<span class="op" id="4753333">==</span>&nbsp;<span class="string" id="4753336">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4753340">||</span>&nbsp;<span class="ident" id="4753343">v</span><span class="op" id="4753344">[</span><span class="num" id="4753345">0</span><span class="op" id="4753346">]</span>&nbsp;<span class="op" id="4753348">==</span>&nbsp;<span class="string" id="4753351">&#39;,&#39;</span>&nbsp;<span class="op" id="4753355">||</span>&nbsp;<span class="ident" id="4753358">v</span><span class="op" id="4753359">[</span><span class="builtinfunc" id="4753360">len</span><span class="op" id="4753363">(</span><span class="ident" id="4753364">v</span><span class="op" id="4753365">)</span><span class="op" id="4753366">-</span><span class="num" id="4753367">1</span><span class="op" id="4753368">]</span>&nbsp;<span class="op" id="4753370">==</span>&nbsp;<span class="string" id="4753373">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4753377">||</span>&nbsp;<span class="ident" id="4753380">v</span><span class="op" id="4753381">[</span><span class="builtinfunc" id="4753382">len</span><span class="op" id="4753385">(</span><span class="ident" id="4753386">v</span><span class="op" id="4753387">)</span><span class="op" id="4753388">-</span><span class="num" id="4753389">1</span><span class="op" id="4753390">]</span>&nbsp;<span class="op" id="4753392">==</span>&nbsp;<span class="string" id="4753395">&#39;,&#39;</span>&nbsp;<span class="op" id="4753399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753403">return</span>&nbsp;<span class="string" id="4753410">`&#34;`</span>&nbsp;<span class="op" id="4753414">+</span>&nbsp;<span class="ident" id="4753416">v</span>&nbsp;<span class="op" id="4753418">+</span>&nbsp;<span class="string" id="4753420">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753428">return</span>&nbsp;<span class="ident" id="4753435">v</span><br>
<span class="lineno">310</span><span class="op" id="4753437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4753440">func</span>&nbsp;<span class="ident" id="4753445">validCookieValueByte</span><span class="op" id="4753465">(</span><span class="ident" id="4753466">b</span>&nbsp;<span class="builtintype" id="4753468">byte</span><span class="op" id="4753472">)</span>&nbsp;<span class="builtintype" id="4753474">bool</span>&nbsp;<span class="op" id="4753479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753482">return</span>&nbsp;<span class="num" id="4753489">0x20</span>&nbsp;<span class="op" id="4753494">&lt;=</span>&nbsp;<span class="ident" id="4753497">b</span>&nbsp;<span class="op" id="4753499">&amp;&amp;</span>&nbsp;<span class="ident" id="4753502">b</span>&nbsp;<span class="op" id="4753504">&lt;</span>&nbsp;<span class="num" id="4753506">0x7f</span>&nbsp;<span class="op" id="4753511">&amp;&amp;</span>&nbsp;<span class="ident" id="4753514">b</span>&nbsp;<span class="op" id="4753516">!=</span>&nbsp;<span class="string" id="4753519">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4753523">&amp;&amp;</span>&nbsp;<span class="ident" id="4753526">b</span>&nbsp;<span class="op" id="4753528">!=</span>&nbsp;<span class="string" id="4753531">&#39;;&#39;</span>&nbsp;<span class="op" id="4753535">&amp;&amp;</span>&nbsp;<span class="ident" id="4753538">b</span>&nbsp;<span class="op" id="4753540">!=</span>&nbsp;<span class="string" id="4753543">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="4753548">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="4753551">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="4753593">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="4753646">func</span>&nbsp;<span class="ident" id="4753651">sanitizeCookiePath</span><span class="op" id="4753669">(</span><span class="ident" id="4753670">v</span>&nbsp;<span class="builtintype" id="4753672">string</span><span class="op" id="4753678">)</span>&nbsp;<span class="builtintype" id="4753680">string</span>&nbsp;<span class="op" id="4753687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753690">return</span>&nbsp;<span class="ident" id="4753697">sanitizeOrWarn</span><span class="op" id="4753711">(</span><span class="string" id="4753712">&#34;Cookie.Path&#34;</span><span class="op" id="4753725">,</span>&nbsp;<span class="ident" id="4753727">validCookiePathByte</span><span class="op" id="4753746">,</span>&nbsp;<span class="ident" id="4753748">v</span><span class="op" id="4753749">)</span><br>
<span class="lineno">320</span><span class="op" id="4753751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4753754">func</span>&nbsp;<span class="ident" id="4753759">validCookiePathByte</span><span class="op" id="4753778">(</span><span class="ident" id="4753779">b</span>&nbsp;<span class="builtintype" id="4753781">byte</span><span class="op" id="4753785">)</span>&nbsp;<span class="builtintype" id="4753787">bool</span>&nbsp;<span class="op" id="4753792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753795">return</span>&nbsp;<span class="num" id="4753802">0x20</span>&nbsp;<span class="op" id="4753807">&lt;=</span>&nbsp;<span class="ident" id="4753810">b</span>&nbsp;<span class="op" id="4753812">&amp;&amp;</span>&nbsp;<span class="ident" id="4753815">b</span>&nbsp;<span class="op" id="4753817">&lt;</span>&nbsp;<span class="num" id="4753819">0x7f</span>&nbsp;<span class="op" id="4753824">&amp;&amp;</span>&nbsp;<span class="ident" id="4753827">b</span>&nbsp;<span class="op" id="4753829">!=</span>&nbsp;<span class="string" id="4753832">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="4753836">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="4753839">func</span>&nbsp;<span class="ident" id="4753844">sanitizeOrWarn</span><span class="op" id="4753858">(</span><span class="ident" id="4753859">fieldName</span>&nbsp;<span class="builtintype" id="4753869">string</span><span class="op" id="4753875">,</span>&nbsp;<span class="ident" id="4753877">valid</span>&nbsp;<span class="keyword" id="4753883">func</span><span class="op" id="4753887">(</span><span class="builtintype" id="4753888">byte</span><span class="op" id="4753892">)</span>&nbsp;<span class="builtintype" id="4753894">bool</span><span class="op" id="4753898">,</span>&nbsp;<span class="ident" id="4753900">v</span>&nbsp;<span class="builtintype" id="4753902">string</span><span class="op" id="4753908">)</span>&nbsp;<span class="builtintype" id="4753910">string</span>&nbsp;<span class="op" id="4753917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753920">ok</span>&nbsp;<span class="op" id="4753923">:=</span>&nbsp;<span class="builtintype" id="4753926">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753932">for</span>&nbsp;<span class="ident" id="4753936">i</span>&nbsp;<span class="op" id="4753938">:=</span>&nbsp;<span class="num" id="4753941">0</span><span class="op" id="4753942">;</span>&nbsp;<span class="ident" id="4753944">i</span>&nbsp;<span class="op" id="4753946">&lt;</span>&nbsp;<span class="builtinfunc" id="4753948">len</span><span class="op" id="4753951">(</span><span class="ident" id="4753952">v</span><span class="op" id="4753953">)</span><span class="op" id="4753954">;</span>&nbsp;<span class="ident" id="4753956">i</span><span class="op" id="4753957">++</span>&nbsp;<span class="op" id="4753960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753964">if</span>&nbsp;<span class="ident" id="4753967">valid</span><span class="op" id="4753972">(</span><span class="ident" id="4753973">v</span><span class="op" id="4753974">[</span><span class="ident" id="4753975">i</span><span class="op" id="4753976">]</span><span class="op" id="4753977">)</span>&nbsp;<span class="op" id="4753979">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753984">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753999">log</span><span class="op" id="4754002">.</span><span class="ident" id="4754003">Printf</span><span class="op" id="4754009">(</span><span class="string" id="4754010">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="4754067">,</span>&nbsp;<span class="ident" id="4754069">v</span><span class="op" id="4754070">[</span><span class="ident" id="4754071">i</span><span class="op" id="4754072">]</span><span class="op" id="4754073">,</span>&nbsp;<span class="ident" id="4754075">fieldName</span><span class="op" id="4754084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754088">ok</span>&nbsp;<span class="op" id="4754091">=</span>&nbsp;<span class="builtintype" id="4754093">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754101">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754111">if</span>&nbsp;<span class="ident" id="4754114">ok</span>&nbsp;<span class="op" id="4754117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754121">return</span>&nbsp;<span class="ident" id="4754128">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754134">buf</span>&nbsp;<span class="op" id="4754138">:=</span>&nbsp;<span class="builtinfunc" id="4754141">make</span><span class="op" id="4754145">(</span><span class="op" id="4754146">[</span><span class="op" id="4754147">]</span><span class="builtintype" id="4754148">byte</span><span class="op" id="4754152">,</span>&nbsp;<span class="num" id="4754154">0</span><span class="op" id="4754155">,</span>&nbsp;<span class="builtinfunc" id="4754157">len</span><span class="op" id="4754160">(</span><span class="ident" id="4754161">v</span><span class="op" id="4754162">)</span><span class="op" id="4754163">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754166">for</span>&nbsp;<span class="ident" id="4754170">i</span>&nbsp;<span class="op" id="4754172">:=</span>&nbsp;<span class="num" id="4754175">0</span><span class="op" id="4754176">;</span>&nbsp;<span class="ident" id="4754178">i</span>&nbsp;<span class="op" id="4754180">&lt;</span>&nbsp;<span class="builtinfunc" id="4754182">len</span><span class="op" id="4754185">(</span><span class="ident" id="4754186">v</span><span class="op" id="4754187">)</span><span class="op" id="4754188">;</span>&nbsp;<span class="ident" id="4754190">i</span><span class="op" id="4754191">++</span>&nbsp;<span class="op" id="4754194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754198">if</span>&nbsp;<span class="ident" id="4754201">b</span>&nbsp;<span class="op" id="4754203">:=</span>&nbsp;<span class="ident" id="4754206">v</span><span class="op" id="4754207">[</span><span class="ident" id="4754208">i</span><span class="op" id="4754209">]</span><span class="op" id="4754210">;</span>&nbsp;<span class="ident" id="4754212">valid</span><span class="op" id="4754217">(</span><span class="ident" id="4754218">b</span><span class="op" id="4754219">)</span>&nbsp;<span class="op" id="4754221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754226">buf</span>&nbsp;<span class="op" id="4754230">=</span>&nbsp;<span class="builtinfunc" id="4754232">append</span><span class="op" id="4754238">(</span><span class="ident" id="4754239">buf</span><span class="op" id="4754242">,</span>&nbsp;<span class="ident" id="4754244">b</span><span class="op" id="4754245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754252">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754255">return</span>&nbsp;<span class="builtintype" id="4754262">string</span><span class="op" id="4754268">(</span><span class="ident" id="4754269">buf</span><span class="op" id="4754272">)</span><br>
<span class="lineno"></span><span class="op" id="4754274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4754277">func</span>&nbsp;<span class="ident" id="4754282">parseCookieValue</span><span class="op" id="4754298">(</span><span class="ident" id="4754299">raw</span>&nbsp;<span class="builtintype" id="4754303">string</span><span class="op" id="4754309">,</span>&nbsp;<span class="ident" id="4754311">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="4754328">bool</span><span class="op" id="4754332">)</span>&nbsp;<span class="op" id="4754334">(</span><span class="builtintype" id="4754335">string</span><span class="op" id="4754341">,</span>&nbsp;<span class="builtintype" id="4754343">bool</span><span class="op" id="4754347">)</span>&nbsp;<span class="op" id="4754349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754352">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754386">if</span>&nbsp;<span class="ident" id="4754389">allowDoubleQuote</span>&nbsp;<span class="op" id="4754406">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4754409">len</span><span class="op" id="4754412">(</span><span class="ident" id="4754413">raw</span><span class="op" id="4754416">)</span>&nbsp;<span class="op" id="4754418">&gt;</span>&nbsp;<span class="num" id="4754420">1</span>&nbsp;<span class="op" id="4754422">&amp;&amp;</span>&nbsp;<span class="ident" id="4754425">raw</span><span class="op" id="4754428">[</span><span class="num" id="4754429">0</span><span class="op" id="4754430">]</span>&nbsp;<span class="op" id="4754432">==</span>&nbsp;<span class="string" id="4754435">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4754439">&amp;&amp;</span>&nbsp;<span class="ident" id="4754442">raw</span><span class="op" id="4754445">[</span><span class="builtinfunc" id="4754446">len</span><span class="op" id="4754449">(</span><span class="ident" id="4754450">raw</span><span class="op" id="4754453">)</span><span class="op" id="4754454">-</span><span class="num" id="4754455">1</span><span class="op" id="4754456">]</span>&nbsp;<span class="op" id="4754458">==</span>&nbsp;<span class="string" id="4754461">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4754465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754469">raw</span>&nbsp;<span class="op" id="4754473">=</span>&nbsp;<span class="ident" id="4754475">raw</span><span class="op" id="4754478">[</span><span class="num" id="4754479">1</span>&nbsp;<span class="op" id="4754481">:</span>&nbsp;<span class="builtinfunc" id="4754483">len</span><span class="op" id="4754486">(</span><span class="ident" id="4754487">raw</span><span class="op" id="4754490">)</span><span class="op" id="4754491">-</span><span class="num" id="4754492">1</span><span class="op" id="4754493">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754499">for</span>&nbsp;<span class="ident" id="4754503">i</span>&nbsp;<span class="op" id="4754505">:=</span>&nbsp;<span class="num" id="4754508">0</span><span class="op" id="4754509">;</span>&nbsp;<span class="ident" id="4754511">i</span>&nbsp;<span class="op" id="4754513">&lt;</span>&nbsp;<span class="builtinfunc" id="4754515">len</span><span class="op" id="4754518">(</span><span class="ident" id="4754519">raw</span><span class="op" id="4754522">)</span><span class="op" id="4754523">;</span>&nbsp;<span class="ident" id="4754525">i</span><span class="op" id="4754526">++</span>&nbsp;<span class="op" id="4754529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754533">if</span>&nbsp;<span class="op" id="4754536">!</span><span class="ident" id="4754537">validCookieValueByte</span><span class="op" id="4754557">(</span><span class="ident" id="4754558">raw</span><span class="op" id="4754561">[</span><span class="ident" id="4754562">i</span><span class="op" id="4754563">]</span><span class="op" id="4754564">)</span>&nbsp;<span class="op" id="4754566">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754571">return</span>&nbsp;<span class="string" id="4754578">&#34;&#34;</span><span class="op" id="4754580">,</span>&nbsp;<span class="builtintype" id="4754582">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754596">return</span>&nbsp;<span class="ident" id="4754603">raw</span><span class="op" id="4754606">,</span>&nbsp;<span class="builtintype" id="4754608">true</span><br>
<span class="lineno"></span><span class="op" id="4754613">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="4754616">func</span>&nbsp;<span class="ident" id="4754621">isCookieNameValid</span><span class="op" id="4754638">(</span><span class="ident" id="4754639">raw</span>&nbsp;<span class="builtintype" id="4754643">string</span><span class="op" id="4754649">)</span>&nbsp;<span class="builtintype" id="4754651">bool</span>&nbsp;<span class="op" id="4754656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754659">return</span>&nbsp;<span class="ident" id="4754666">strings</span><span class="op" id="4754673">.</span><span class="ident" id="4754674">IndexFunc</span><span class="op" id="4754683">(</span><span class="ident" id="4754684">raw</span><span class="op" id="4754687">,</span>&nbsp;<span class="ident" id="4754689">isNotToken</span><span class="op" id="4754699">)</span>&nbsp;<span class="op" id="4754701">&lt;</span>&nbsp;<span class="num" id="4754703">0</span><br>
<span class="lineno"></span><span class="op" id="4754705">}</span>
</div>
</body>
</html>
