<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3948726">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3948781">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3948835">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3948886">package</span>&nbsp;<span class="ident" id="3948894">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3948899">import</span>&nbsp;<span class="string" id="3948906">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3948915">type</span>&nbsp;<span class="ident" id="3948920">clientHelloMsg</span>&nbsp;<span class="keyword" id="3948935">struct</span>&nbsp;<span class="op" id="3948942">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948945">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948965">[</span><span class="op" id="3948966">]</span><span class="builtintype" id="3948967">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948973">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3948993">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949001">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949021">[</span><span class="op" id="3949022">]</span><span class="builtintype" id="3949023">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949029">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949049">[</span><span class="op" id="3949050">]</span><span class="builtintype" id="3949051">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949057">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949077">[</span><span class="op" id="3949078">]</span><span class="builtintype" id="3949079">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949087">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="3949107">[</span><span class="op" id="3949108">]</span><span class="builtintype" id="3949109">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949116">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3949136">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949142">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3949162">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949170">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3949190">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949196">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949216">[</span><span class="op" id="3949217">]</span><span class="ident" id="3949218">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949227">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949247">[</span><span class="op" id="3949248">]</span><span class="builtintype" id="3949249">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949256">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3949276">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949282">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949302">[</span><span class="op" id="3949303">]</span><span class="builtintype" id="3949304">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949311">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="3949331">[</span><span class="op" id="3949332">]</span><span class="ident" id="3949333">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949351">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3949371">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949377">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949397">[</span><span class="op" id="3949398">]</span><span class="builtintype" id="3949399">string</span><br>
<span class="lineno"></span><span class="op" id="3949406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3949409">func</span>&nbsp;<span class="op" id="3949414">(</span><span class="ident" id="3949415">m</span>&nbsp;<span class="op" id="3949417">*</span><span class="ident" id="3949418">clientHelloMsg</span><span class="op" id="3949432">)</span>&nbsp;<span class="ident" id="3949434">equal</span><span class="op" id="3949439">(</span><span class="ident" id="3949440">i</span>&nbsp;<span class="keyword" id="3949442">interface</span><span class="op" id="3949451">{</span><span class="op" id="3949452">}</span><span class="op" id="3949453">)</span>&nbsp;<span class="builtintype" id="3949455">bool</span>&nbsp;<span class="op" id="3949460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949463">m1</span><span class="op" id="3949465">,</span>&nbsp;<span class="ident" id="3949467">ok</span>&nbsp;<span class="op" id="3949470">:=</span>&nbsp;<span class="ident" id="3949473">i</span><span class="op" id="3949474">.</span><span class="op" id="3949475">(</span><span class="op" id="3949476">*</span><span class="ident" id="3949477">clientHelloMsg</span><span class="op" id="3949491">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949494">if</span>&nbsp;<span class="op" id="3949497">!</span><span class="ident" id="3949498">ok</span>&nbsp;<span class="op" id="3949501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949505">return</span>&nbsp;<span class="ident" id="3949512">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949523">return</span>&nbsp;<span class="ident" id="3949530">bytes</span><span class="op" id="3949535">.</span><span class="ident" id="3949536">Equal</span><span class="op" id="3949541">(</span><span class="ident" id="3949542">m</span><span class="op" id="3949543">.</span><span class="ident" id="3949544">raw</span><span class="op" id="3949547">,</span>&nbsp;<span class="ident" id="3949549">m1</span><span class="op" id="3949551">.</span><span class="ident" id="3949552">raw</span><span class="op" id="3949555">)</span>&nbsp;<span class="op" id="3949557">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949562">m</span><span class="op" id="3949563">.</span><span class="ident" id="3949564">vers</span>&nbsp;<span class="op" id="3949569">==</span>&nbsp;<span class="ident" id="3949572">m1</span><span class="op" id="3949574">.</span><span class="ident" id="3949575">vers</span>&nbsp;<span class="op" id="3949580">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949585">bytes</span><span class="op" id="3949590">.</span><span class="ident" id="3949591">Equal</span><span class="op" id="3949596">(</span><span class="ident" id="3949597">m</span><span class="op" id="3949598">.</span><span class="ident" id="3949599">random</span><span class="op" id="3949605">,</span>&nbsp;<span class="ident" id="3949607">m1</span><span class="op" id="3949609">.</span><span class="ident" id="3949610">random</span><span class="op" id="3949616">)</span>&nbsp;<span class="op" id="3949618">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949623">bytes</span><span class="op" id="3949628">.</span><span class="ident" id="3949629">Equal</span><span class="op" id="3949634">(</span><span class="ident" id="3949635">m</span><span class="op" id="3949636">.</span><span class="ident" id="3949637">sessionId</span><span class="op" id="3949646">,</span>&nbsp;<span class="ident" id="3949648">m1</span><span class="op" id="3949650">.</span><span class="ident" id="3949651">sessionId</span><span class="op" id="3949660">)</span>&nbsp;<span class="op" id="3949662">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949667">eqUint16s</span><span class="op" id="3949676">(</span><span class="ident" id="3949677">m</span><span class="op" id="3949678">.</span><span class="ident" id="3949679">cipherSuites</span><span class="op" id="3949691">,</span>&nbsp;<span class="ident" id="3949693">m1</span><span class="op" id="3949695">.</span><span class="ident" id="3949696">cipherSuites</span><span class="op" id="3949708">)</span>&nbsp;<span class="op" id="3949710">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949715">bytes</span><span class="op" id="3949720">.</span><span class="ident" id="3949721">Equal</span><span class="op" id="3949726">(</span><span class="ident" id="3949727">m</span><span class="op" id="3949728">.</span><span class="ident" id="3949729">compressionMethods</span><span class="op" id="3949747">,</span>&nbsp;<span class="ident" id="3949749">m1</span><span class="op" id="3949751">.</span><span class="ident" id="3949752">compressionMethods</span><span class="op" id="3949770">)</span>&nbsp;<span class="op" id="3949772">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949777">m</span><span class="op" id="3949778">.</span><span class="ident" id="3949779">nextProtoNeg</span>&nbsp;<span class="op" id="3949792">==</span>&nbsp;<span class="ident" id="3949795">m1</span><span class="op" id="3949797">.</span><span class="ident" id="3949798">nextProtoNeg</span>&nbsp;<span class="op" id="3949811">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949816">m</span><span class="op" id="3949817">.</span><span class="ident" id="3949818">serverName</span>&nbsp;<span class="op" id="3949829">==</span>&nbsp;<span class="ident" id="3949832">m1</span><span class="op" id="3949834">.</span><span class="ident" id="3949835">serverName</span>&nbsp;<span class="op" id="3949846">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949851">m</span><span class="op" id="3949852">.</span><span class="ident" id="3949853">ocspStapling</span>&nbsp;<span class="op" id="3949866">==</span>&nbsp;<span class="ident" id="3949869">m1</span><span class="op" id="3949871">.</span><span class="ident" id="3949872">ocspStapling</span>&nbsp;<span class="op" id="3949885">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949890">eqCurveIDs</span><span class="op" id="3949900">(</span><span class="ident" id="3949901">m</span><span class="op" id="3949902">.</span><span class="ident" id="3949903">supportedCurves</span><span class="op" id="3949918">,</span>&nbsp;<span class="ident" id="3949920">m1</span><span class="op" id="3949922">.</span><span class="ident" id="3949923">supportedCurves</span><span class="op" id="3949938">)</span>&nbsp;<span class="op" id="3949940">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949945">bytes</span><span class="op" id="3949950">.</span><span class="ident" id="3949951">Equal</span><span class="op" id="3949956">(</span><span class="ident" id="3949957">m</span><span class="op" id="3949958">.</span><span class="ident" id="3949959">supportedPoints</span><span class="op" id="3949974">,</span>&nbsp;<span class="ident" id="3949976">m1</span><span class="op" id="3949978">.</span><span class="ident" id="3949979">supportedPoints</span><span class="op" id="3949994">)</span>&nbsp;<span class="op" id="3949996">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950001">m</span><span class="op" id="3950002">.</span><span class="ident" id="3950003">ticketSupported</span>&nbsp;<span class="op" id="3950019">==</span>&nbsp;<span class="ident" id="3950022">m1</span><span class="op" id="3950024">.</span><span class="ident" id="3950025">ticketSupported</span>&nbsp;<span class="op" id="3950041">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950046">bytes</span><span class="op" id="3950051">.</span><span class="ident" id="3950052">Equal</span><span class="op" id="3950057">(</span><span class="ident" id="3950058">m</span><span class="op" id="3950059">.</span><span class="ident" id="3950060">sessionTicket</span><span class="op" id="3950073">,</span>&nbsp;<span class="ident" id="3950075">m1</span><span class="op" id="3950077">.</span><span class="ident" id="3950078">sessionTicket</span><span class="op" id="3950091">)</span>&nbsp;<span class="op" id="3950093">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950098">eqSignatureAndHashes</span><span class="op" id="3950118">(</span><span class="ident" id="3950119">m</span><span class="op" id="3950120">.</span><span class="ident" id="3950121">signatureAndHashes</span><span class="op" id="3950139">,</span>&nbsp;<span class="ident" id="3950141">m1</span><span class="op" id="3950143">.</span><span class="ident" id="3950144">signatureAndHashes</span><span class="op" id="3950162">)</span>&nbsp;<span class="op" id="3950164">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950169">m</span><span class="op" id="3950170">.</span><span class="ident" id="3950171">secureRenegotiation</span>&nbsp;<span class="op" id="3950191">==</span>&nbsp;<span class="ident" id="3950194">m1</span><span class="op" id="3950196">.</span><span class="ident" id="3950197">secureRenegotiation</span>&nbsp;<span class="op" id="3950217">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950222">eqStrings</span><span class="op" id="3950231">(</span><span class="ident" id="3950232">m</span><span class="op" id="3950233">.</span><span class="ident" id="3950234">alpnProtocols</span><span class="op" id="3950247">,</span>&nbsp;<span class="ident" id="3950249">m1</span><span class="op" id="3950251">.</span><span class="ident" id="3950252">alpnProtocols</span><span class="op" id="3950265">)</span><br>
<span class="lineno">50</span><span class="op" id="3950267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3950270">func</span>&nbsp;<span class="op" id="3950275">(</span><span class="ident" id="3950276">m</span>&nbsp;<span class="op" id="3950278">*</span><span class="ident" id="3950279">clientHelloMsg</span><span class="op" id="3950293">)</span>&nbsp;<span class="ident" id="3950295">marshal</span><span class="op" id="3950302">(</span><span class="op" id="3950303">)</span>&nbsp;<span class="op" id="3950305">[</span><span class="op" id="3950306">]</span><span class="builtintype" id="3950307">byte</span>&nbsp;<span class="op" id="3950312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950315">if</span>&nbsp;<span class="ident" id="3950318">m</span><span class="op" id="3950319">.</span><span class="ident" id="3950320">raw</span>&nbsp;<span class="op" id="3950324">!=</span>&nbsp;<span class="ident" id="3950327">nil</span>&nbsp;<span class="op" id="3950331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950335">return</span>&nbsp;<span class="ident" id="3950342">m</span><span class="op" id="3950343">.</span><span class="ident" id="3950344">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950353">length</span>&nbsp;<span class="op" id="3950360">:=</span>&nbsp;<span class="num" id="3950363">2</span>&nbsp;<span class="op" id="3950365">+</span>&nbsp;<span class="num" id="3950367">32</span>&nbsp;<span class="op" id="3950370">+</span>&nbsp;<span class="num" id="3950372">1</span>&nbsp;<span class="op" id="3950374">+</span>&nbsp;<span class="builtinfunc" id="3950376">len</span><span class="op" id="3950379">(</span><span class="ident" id="3950380">m</span><span class="op" id="3950381">.</span><span class="ident" id="3950382">sessionId</span><span class="op" id="3950391">)</span>&nbsp;<span class="op" id="3950393">+</span>&nbsp;<span class="num" id="3950395">2</span>&nbsp;<span class="op" id="3950397">+</span>&nbsp;<span class="builtinfunc" id="3950399">len</span><span class="op" id="3950402">(</span><span class="ident" id="3950403">m</span><span class="op" id="3950404">.</span><span class="ident" id="3950405">cipherSuites</span><span class="op" id="3950417">)</span><span class="op" id="3950418">*</span><span class="num" id="3950419">2</span>&nbsp;<span class="op" id="3950421">+</span>&nbsp;<span class="num" id="3950423">1</span>&nbsp;<span class="op" id="3950425">+</span>&nbsp;<span class="builtinfunc" id="3950427">len</span><span class="op" id="3950430">(</span><span class="ident" id="3950431">m</span><span class="op" id="3950432">.</span><span class="ident" id="3950433">compressionMethods</span><span class="op" id="3950451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950454">numExtensions</span>&nbsp;<span class="op" id="3950468">:=</span>&nbsp;<span class="num" id="3950471">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950474">extensionsLength</span>&nbsp;<span class="op" id="3950491">:=</span>&nbsp;<span class="num" id="3950494">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950497">if</span>&nbsp;<span class="ident" id="3950500">m</span><span class="op" id="3950501">.</span><span class="ident" id="3950502">nextProtoNeg</span>&nbsp;<span class="op" id="3950515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950519">numExtensions</span><span class="op" id="3950532">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950539">if</span>&nbsp;<span class="ident" id="3950542">m</span><span class="op" id="3950543">.</span><span class="ident" id="3950544">ocspStapling</span>&nbsp;<span class="op" id="3950557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950561">extensionsLength</span>&nbsp;<span class="op" id="3950578">+=</span>&nbsp;<span class="num" id="3950581">1</span>&nbsp;<span class="op" id="3950583">+</span>&nbsp;<span class="num" id="3950585">2</span>&nbsp;<span class="op" id="3950587">+</span>&nbsp;<span class="num" id="3950589">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950593">numExtensions</span><span class="op" id="3950606">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950613">if</span>&nbsp;<span class="builtinfunc" id="3950616">len</span><span class="op" id="3950619">(</span><span class="ident" id="3950620">m</span><span class="op" id="3950621">.</span><span class="ident" id="3950622">serverName</span><span class="op" id="3950632">)</span>&nbsp;<span class="op" id="3950634">&gt;</span>&nbsp;<span class="num" id="3950636">0</span>&nbsp;<span class="op" id="3950638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950642">extensionsLength</span>&nbsp;<span class="op" id="3950659">+=</span>&nbsp;<span class="num" id="3950662">5</span>&nbsp;<span class="op" id="3950664">+</span>&nbsp;<span class="builtinfunc" id="3950666">len</span><span class="op" id="3950669">(</span><span class="ident" id="3950670">m</span><span class="op" id="3950671">.</span><span class="ident" id="3950672">serverName</span><span class="op" id="3950682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950686">numExtensions</span><span class="op" id="3950699">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950706">if</span>&nbsp;<span class="builtinfunc" id="3950709">len</span><span class="op" id="3950712">(</span><span class="ident" id="3950713">m</span><span class="op" id="3950714">.</span><span class="ident" id="3950715">supportedCurves</span><span class="op" id="3950730">)</span>&nbsp;<span class="op" id="3950732">&gt;</span>&nbsp;<span class="num" id="3950734">0</span>&nbsp;<span class="op" id="3950736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950740">extensionsLength</span>&nbsp;<span class="op" id="3950757">+=</span>&nbsp;<span class="num" id="3950760">2</span>&nbsp;<span class="op" id="3950762">+</span>&nbsp;<span class="num" id="3950764">2</span><span class="op" id="3950765">*</span><span class="builtinfunc" id="3950766">len</span><span class="op" id="3950769">(</span><span class="ident" id="3950770">m</span><span class="op" id="3950771">.</span><span class="ident" id="3950772">supportedCurves</span><span class="op" id="3950787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950791">numExtensions</span><span class="op" id="3950804">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950808">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950811">if</span>&nbsp;<span class="builtinfunc" id="3950814">len</span><span class="op" id="3950817">(</span><span class="ident" id="3950818">m</span><span class="op" id="3950819">.</span><span class="ident" id="3950820">supportedPoints</span><span class="op" id="3950835">)</span>&nbsp;<span class="op" id="3950837">&gt;</span>&nbsp;<span class="num" id="3950839">0</span>&nbsp;<span class="op" id="3950841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950845">extensionsLength</span>&nbsp;<span class="op" id="3950862">+=</span>&nbsp;<span class="num" id="3950865">1</span>&nbsp;<span class="op" id="3950867">+</span>&nbsp;<span class="builtinfunc" id="3950869">len</span><span class="op" id="3950872">(</span><span class="ident" id="3950873">m</span><span class="op" id="3950874">.</span><span class="ident" id="3950875">supportedPoints</span><span class="op" id="3950890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950894">numExtensions</span><span class="op" id="3950907">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950914">if</span>&nbsp;<span class="ident" id="3950917">m</span><span class="op" id="3950918">.</span><span class="ident" id="3950919">ticketSupported</span>&nbsp;<span class="op" id="3950935">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950939">extensionsLength</span>&nbsp;<span class="op" id="3950956">+=</span>&nbsp;<span class="builtinfunc" id="3950959">len</span><span class="op" id="3950962">(</span><span class="ident" id="3950963">m</span><span class="op" id="3950964">.</span><span class="ident" id="3950965">sessionTicket</span><span class="op" id="3950978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950982">numExtensions</span><span class="op" id="3950995">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951002">if</span>&nbsp;<span class="builtinfunc" id="3951005">len</span><span class="op" id="3951008">(</span><span class="ident" id="3951009">m</span><span class="op" id="3951010">.</span><span class="ident" id="3951011">signatureAndHashes</span><span class="op" id="3951029">)</span>&nbsp;<span class="op" id="3951031">&gt;</span>&nbsp;<span class="num" id="3951033">0</span>&nbsp;<span class="op" id="3951035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951039">extensionsLength</span>&nbsp;<span class="op" id="3951056">+=</span>&nbsp;<span class="num" id="3951059">2</span>&nbsp;<span class="op" id="3951061">+</span>&nbsp;<span class="num" id="3951063">2</span><span class="op" id="3951064">*</span><span class="builtinfunc" id="3951065">len</span><span class="op" id="3951068">(</span><span class="ident" id="3951069">m</span><span class="op" id="3951070">.</span><span class="ident" id="3951071">signatureAndHashes</span><span class="op" id="3951089">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951093">numExtensions</span><span class="op" id="3951106">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951113">if</span>&nbsp;<span class="ident" id="3951116">m</span><span class="op" id="3951117">.</span><span class="ident" id="3951118">secureRenegotiation</span>&nbsp;<span class="op" id="3951138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951142">extensionsLength</span>&nbsp;<span class="op" id="3951159">+=</span>&nbsp;<span class="num" id="3951162">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951166">numExtensions</span><span class="op" id="3951179">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951186">if</span>&nbsp;<span class="builtinfunc" id="3951189">len</span><span class="op" id="3951192">(</span><span class="ident" id="3951193">m</span><span class="op" id="3951194">.</span><span class="ident" id="3951195">alpnProtocols</span><span class="op" id="3951208">)</span>&nbsp;<span class="op" id="3951210">&gt;</span>&nbsp;<span class="num" id="3951212">0</span>&nbsp;<span class="op" id="3951214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951218">extensionsLength</span>&nbsp;<span class="op" id="3951235">+=</span>&nbsp;<span class="num" id="3951238">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951242">for</span>&nbsp;<span class="ident" id="3951246">_</span><span class="op" id="3951247">,</span>&nbsp;<span class="ident" id="3951249">s</span>&nbsp;<span class="op" id="3951251">:=</span>&nbsp;<span class="keyword" id="3951254">range</span>&nbsp;<span class="ident" id="3951260">m</span><span class="op" id="3951261">.</span><span class="ident" id="3951262">alpnProtocols</span>&nbsp;<span class="op" id="3951276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951281">if</span>&nbsp;<span class="ident" id="3951284">l</span>&nbsp;<span class="op" id="3951286">:=</span>&nbsp;<span class="builtinfunc" id="3951289">len</span><span class="op" id="3951292">(</span><span class="ident" id="3951293">s</span><span class="op" id="3951294">)</span><span class="op" id="3951295">;</span>&nbsp;<span class="ident" id="3951297">l</span>&nbsp;<span class="op" id="3951299">==</span>&nbsp;<span class="num" id="3951302">0</span>&nbsp;<span class="op" id="3951304">||</span>&nbsp;<span class="ident" id="3951307">l</span>&nbsp;<span class="op" id="3951309">&gt;</span>&nbsp;<span class="num" id="3951311">255</span>&nbsp;<span class="op" id="3951315">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3951321">panic</span><span class="op" id="3951326">(</span><span class="string" id="3951327">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3951350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951360">extensionsLength</span><span class="op" id="3951376">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951382">extensionsLength</span>&nbsp;<span class="op" id="3951399">+=</span>&nbsp;<span class="builtinfunc" id="3951402">len</span><span class="op" id="3951405">(</span><span class="ident" id="3951406">s</span><span class="op" id="3951407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951411">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951415">numExtensions</span><span class="op" id="3951428">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951435">if</span>&nbsp;<span class="ident" id="3951438">numExtensions</span>&nbsp;<span class="op" id="3951452">&gt;</span>&nbsp;<span class="num" id="3951454">0</span>&nbsp;<span class="op" id="3951456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951460">extensionsLength</span>&nbsp;<span class="op" id="3951477">+=</span>&nbsp;<span class="num" id="3951480">4</span>&nbsp;<span class="op" id="3951482">*</span>&nbsp;<span class="ident" id="3951484">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951500">length</span>&nbsp;<span class="op" id="3951507">+=</span>&nbsp;<span class="num" id="3951510">2</span>&nbsp;<span class="op" id="3951512">+</span>&nbsp;<span class="ident" id="3951514">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951536">x</span>&nbsp;<span class="op" id="3951538">:=</span>&nbsp;<span class="builtinfunc" id="3951541">make</span><span class="op" id="3951545">(</span><span class="op" id="3951546">[</span><span class="op" id="3951547">]</span><span class="builtintype" id="3951548">byte</span><span class="op" id="3951552">,</span>&nbsp;<span class="num" id="3951554">4</span><span class="op" id="3951555">+</span><span class="ident" id="3951556">length</span><span class="op" id="3951562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951565">x</span><span class="op" id="3951566">[</span><span class="num" id="3951567">0</span><span class="op" id="3951568">]</span>&nbsp;<span class="op" id="3951570">=</span>&nbsp;<span class="ident" id="3951572">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951589">x</span><span class="op" id="3951590">[</span><span class="num" id="3951591">1</span><span class="op" id="3951592">]</span>&nbsp;<span class="op" id="3951594">=</span>&nbsp;<span class="builtintype" id="3951596">uint8</span><span class="op" id="3951601">(</span><span class="ident" id="3951602">length</span>&nbsp;<span class="op" id="3951609">&gt;&gt;</span>&nbsp;<span class="num" id="3951612">16</span><span class="op" id="3951614">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951617">x</span><span class="op" id="3951618">[</span><span class="num" id="3951619">2</span><span class="op" id="3951620">]</span>&nbsp;<span class="op" id="3951622">=</span>&nbsp;<span class="builtintype" id="3951624">uint8</span><span class="op" id="3951629">(</span><span class="ident" id="3951630">length</span>&nbsp;<span class="op" id="3951637">&gt;&gt;</span>&nbsp;<span class="num" id="3951640">8</span><span class="op" id="3951641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951644">x</span><span class="op" id="3951645">[</span><span class="num" id="3951646">3</span><span class="op" id="3951647">]</span>&nbsp;<span class="op" id="3951649">=</span>&nbsp;<span class="builtintype" id="3951651">uint8</span><span class="op" id="3951656">(</span><span class="ident" id="3951657">length</span><span class="op" id="3951663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951666">x</span><span class="op" id="3951667">[</span><span class="num" id="3951668">4</span><span class="op" id="3951669">]</span>&nbsp;<span class="op" id="3951671">=</span>&nbsp;<span class="builtintype" id="3951673">uint8</span><span class="op" id="3951678">(</span><span class="ident" id="3951679">m</span><span class="op" id="3951680">.</span><span class="ident" id="3951681">vers</span>&nbsp;<span class="op" id="3951686">&gt;&gt;</span>&nbsp;<span class="num" id="3951689">8</span><span class="op" id="3951690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951693">x</span><span class="op" id="3951694">[</span><span class="num" id="3951695">5</span><span class="op" id="3951696">]</span>&nbsp;<span class="op" id="3951698">=</span>&nbsp;<span class="builtintype" id="3951700">uint8</span><span class="op" id="3951705">(</span><span class="ident" id="3951706">m</span><span class="op" id="3951707">.</span><span class="ident" id="3951708">vers</span><span class="op" id="3951712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3951715">copy</span><span class="op" id="3951719">(</span><span class="ident" id="3951720">x</span><span class="op" id="3951721">[</span><span class="num" id="3951722">6</span><span class="op" id="3951723">:</span><span class="num" id="3951724">38</span><span class="op" id="3951726">]</span><span class="op" id="3951727">,</span>&nbsp;<span class="ident" id="3951729">m</span><span class="op" id="3951730">.</span><span class="ident" id="3951731">random</span><span class="op" id="3951737">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951740">x</span><span class="op" id="3951741">[</span><span class="num" id="3951742">38</span><span class="op" id="3951744">]</span>&nbsp;<span class="op" id="3951746">=</span>&nbsp;<span class="builtintype" id="3951748">uint8</span><span class="op" id="3951753">(</span><span class="builtinfunc" id="3951754">len</span><span class="op" id="3951757">(</span><span class="ident" id="3951758">m</span><span class="op" id="3951759">.</span><span class="ident" id="3951760">sessionId</span><span class="op" id="3951769">)</span><span class="op" id="3951770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3951773">copy</span><span class="op" id="3951777">(</span><span class="ident" id="3951778">x</span><span class="op" id="3951779">[</span><span class="num" id="3951780">39</span><span class="op" id="3951782">:</span><span class="num" id="3951783">39</span><span class="op" id="3951785">+</span><span class="builtinfunc" id="3951786">len</span><span class="op" id="3951789">(</span><span class="ident" id="3951790">m</span><span class="op" id="3951791">.</span><span class="ident" id="3951792">sessionId</span><span class="op" id="3951801">)</span><span class="op" id="3951802">]</span><span class="op" id="3951803">,</span>&nbsp;<span class="ident" id="3951805">m</span><span class="op" id="3951806">.</span><span class="ident" id="3951807">sessionId</span><span class="op" id="3951816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951819">y</span>&nbsp;<span class="op" id="3951821">:=</span>&nbsp;<span class="ident" id="3951824">x</span><span class="op" id="3951825">[</span><span class="num" id="3951826">39</span><span class="op" id="3951828">+</span><span class="builtinfunc" id="3951829">len</span><span class="op" id="3951832">(</span><span class="ident" id="3951833">m</span><span class="op" id="3951834">.</span><span class="ident" id="3951835">sessionId</span><span class="op" id="3951844">)</span><span class="op" id="3951845">:</span><span class="op" id="3951846">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951849">y</span><span class="op" id="3951850">[</span><span class="num" id="3951851">0</span><span class="op" id="3951852">]</span>&nbsp;<span class="op" id="3951854">=</span>&nbsp;<span class="builtintype" id="3951856">uint8</span><span class="op" id="3951861">(</span><span class="builtinfunc" id="3951862">len</span><span class="op" id="3951865">(</span><span class="ident" id="3951866">m</span><span class="op" id="3951867">.</span><span class="ident" id="3951868">cipherSuites</span><span class="op" id="3951880">)</span>&nbsp;<span class="op" id="3951882">&gt;&gt;</span>&nbsp;<span class="num" id="3951885">7</span><span class="op" id="3951886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951889">y</span><span class="op" id="3951890">[</span><span class="num" id="3951891">1</span><span class="op" id="3951892">]</span>&nbsp;<span class="op" id="3951894">=</span>&nbsp;<span class="builtintype" id="3951896">uint8</span><span class="op" id="3951901">(</span><span class="builtinfunc" id="3951902">len</span><span class="op" id="3951905">(</span><span class="ident" id="3951906">m</span><span class="op" id="3951907">.</span><span class="ident" id="3951908">cipherSuites</span><span class="op" id="3951920">)</span>&nbsp;<span class="op" id="3951922">&lt;&lt;</span>&nbsp;<span class="num" id="3951925">1</span><span class="op" id="3951926">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951929">for</span>&nbsp;<span class="ident" id="3951933">i</span><span class="op" id="3951934">,</span>&nbsp;<span class="ident" id="3951936">suite</span>&nbsp;<span class="op" id="3951942">:=</span>&nbsp;<span class="keyword" id="3951945">range</span>&nbsp;<span class="ident" id="3951951">m</span><span class="op" id="3951952">.</span><span class="ident" id="3951953">cipherSuites</span>&nbsp;<span class="op" id="3951966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951970">y</span><span class="op" id="3951971">[</span><span class="num" id="3951972">2</span><span class="op" id="3951973">+</span><span class="ident" id="3951974">i</span><span class="op" id="3951975">*</span><span class="num" id="3951976">2</span><span class="op" id="3951977">]</span>&nbsp;<span class="op" id="3951979">=</span>&nbsp;<span class="builtintype" id="3951981">uint8</span><span class="op" id="3951986">(</span><span class="ident" id="3951987">suite</span>&nbsp;<span class="op" id="3951993">&gt;&gt;</span>&nbsp;<span class="num" id="3951996">8</span><span class="op" id="3951997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952001">y</span><span class="op" id="3952002">[</span><span class="num" id="3952003">3</span><span class="op" id="3952004">+</span><span class="ident" id="3952005">i</span><span class="op" id="3952006">*</span><span class="num" id="3952007">2</span><span class="op" id="3952008">]</span>&nbsp;<span class="op" id="3952010">=</span>&nbsp;<span class="builtintype" id="3952012">uint8</span><span class="op" id="3952017">(</span><span class="ident" id="3952018">suite</span><span class="op" id="3952023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952029">z</span>&nbsp;<span class="op" id="3952031">:=</span>&nbsp;<span class="ident" id="3952034">y</span><span class="op" id="3952035">[</span><span class="num" id="3952036">2</span><span class="op" id="3952037">+</span><span class="builtinfunc" id="3952038">len</span><span class="op" id="3952041">(</span><span class="ident" id="3952042">m</span><span class="op" id="3952043">.</span><span class="ident" id="3952044">cipherSuites</span><span class="op" id="3952056">)</span><span class="op" id="3952057">*</span><span class="num" id="3952058">2</span><span class="op" id="3952059">:</span><span class="op" id="3952060">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952063">z</span><span class="op" id="3952064">[</span><span class="num" id="3952065">0</span><span class="op" id="3952066">]</span>&nbsp;<span class="op" id="3952068">=</span>&nbsp;<span class="builtintype" id="3952070">uint8</span><span class="op" id="3952075">(</span><span class="builtinfunc" id="3952076">len</span><span class="op" id="3952079">(</span><span class="ident" id="3952080">m</span><span class="op" id="3952081">.</span><span class="ident" id="3952082">compressionMethods</span><span class="op" id="3952100">)</span><span class="op" id="3952101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3952104">copy</span><span class="op" id="3952108">(</span><span class="ident" id="3952109">z</span><span class="op" id="3952110">[</span><span class="num" id="3952111">1</span><span class="op" id="3952112">:</span><span class="op" id="3952113">]</span><span class="op" id="3952114">,</span>&nbsp;<span class="ident" id="3952116">m</span><span class="op" id="3952117">.</span><span class="ident" id="3952118">compressionMethods</span><span class="op" id="3952136">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952140">z</span>&nbsp;<span class="op" id="3952142">=</span>&nbsp;<span class="ident" id="3952144">z</span><span class="op" id="3952145">[</span><span class="num" id="3952146">1</span><span class="op" id="3952147">+</span><span class="builtinfunc" id="3952148">len</span><span class="op" id="3952151">(</span><span class="ident" id="3952152">m</span><span class="op" id="3952153">.</span><span class="ident" id="3952154">compressionMethods</span><span class="op" id="3952172">)</span><span class="op" id="3952173">:</span><span class="op" id="3952174">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952177">if</span>&nbsp;<span class="ident" id="3952180">numExtensions</span>&nbsp;<span class="op" id="3952194">&gt;</span>&nbsp;<span class="num" id="3952196">0</span>&nbsp;<span class="op" id="3952198">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952202">z</span><span class="op" id="3952203">[</span><span class="num" id="3952204">0</span><span class="op" id="3952205">]</span>&nbsp;<span class="op" id="3952207">=</span>&nbsp;<span class="builtintype" id="3952209">byte</span><span class="op" id="3952213">(</span><span class="ident" id="3952214">extensionsLength</span>&nbsp;<span class="op" id="3952231">&gt;&gt;</span>&nbsp;<span class="num" id="3952234">8</span><span class="op" id="3952235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952239">z</span><span class="op" id="3952240">[</span><span class="num" id="3952241">1</span><span class="op" id="3952242">]</span>&nbsp;<span class="op" id="3952244">=</span>&nbsp;<span class="builtintype" id="3952246">byte</span><span class="op" id="3952250">(</span><span class="ident" id="3952251">extensionsLength</span><span class="op" id="3952267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952271">z</span>&nbsp;<span class="op" id="3952273">=</span>&nbsp;<span class="ident" id="3952275">z</span><span class="op" id="3952276">[</span><span class="num" id="3952277">2</span><span class="op" id="3952278">:</span><span class="op" id="3952279">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952285">if</span>&nbsp;<span class="ident" id="3952288">m</span><span class="op" id="3952289">.</span><span class="ident" id="3952290">nextProtoNeg</span>&nbsp;<span class="op" id="3952303">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952307">z</span><span class="op" id="3952308">[</span><span class="num" id="3952309">0</span><span class="op" id="3952310">]</span>&nbsp;<span class="op" id="3952312">=</span>&nbsp;<span class="builtintype" id="3952314">byte</span><span class="op" id="3952318">(</span><span class="ident" id="3952319">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3952341">&gt;&gt;</span>&nbsp;<span class="num" id="3952344">8</span><span class="op" id="3952345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952349">z</span><span class="op" id="3952350">[</span><span class="num" id="3952351">1</span><span class="op" id="3952352">]</span>&nbsp;<span class="op" id="3952354">=</span>&nbsp;<span class="builtintype" id="3952356">byte</span><span class="op" id="3952360">(</span><span class="ident" id="3952361">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3952383">&amp;</span>&nbsp;<span class="num" id="3952385">0xff</span><span class="op" id="3952389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952393">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952421">z</span>&nbsp;<span class="op" id="3952423">=</span>&nbsp;<span class="ident" id="3952425">z</span><span class="op" id="3952426">[</span><span class="num" id="3952427">4</span><span class="op" id="3952428">:</span><span class="op" id="3952429">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952432">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952435">if</span>&nbsp;<span class="builtinfunc" id="3952438">len</span><span class="op" id="3952441">(</span><span class="ident" id="3952442">m</span><span class="op" id="3952443">.</span><span class="ident" id="3952444">serverName</span><span class="op" id="3952454">)</span>&nbsp;<span class="op" id="3952456">&gt;</span>&nbsp;<span class="num" id="3952458">0</span>&nbsp;<span class="op" id="3952460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952464">z</span><span class="op" id="3952465">[</span><span class="num" id="3952466">0</span><span class="op" id="3952467">]</span>&nbsp;<span class="op" id="3952469">=</span>&nbsp;<span class="builtintype" id="3952471">byte</span><span class="op" id="3952475">(</span><span class="ident" id="3952476">extensionServerName</span>&nbsp;<span class="op" id="3952496">&gt;&gt;</span>&nbsp;<span class="num" id="3952499">8</span><span class="op" id="3952500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952504">z</span><span class="op" id="3952505">[</span><span class="num" id="3952506">1</span><span class="op" id="3952507">]</span>&nbsp;<span class="op" id="3952509">=</span>&nbsp;<span class="builtintype" id="3952511">byte</span><span class="op" id="3952515">(</span><span class="ident" id="3952516">extensionServerName</span>&nbsp;<span class="op" id="3952536">&amp;</span>&nbsp;<span class="num" id="3952538">0xff</span><span class="op" id="3952542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952546">l</span>&nbsp;<span class="op" id="3952548">:=</span>&nbsp;<span class="builtinfunc" id="3952551">len</span><span class="op" id="3952554">(</span><span class="ident" id="3952555">m</span><span class="op" id="3952556">.</span><span class="ident" id="3952557">serverName</span><span class="op" id="3952567">)</span>&nbsp;<span class="op" id="3952569">+</span>&nbsp;<span class="num" id="3952571">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952575">z</span><span class="op" id="3952576">[</span><span class="num" id="3952577">2</span><span class="op" id="3952578">]</span>&nbsp;<span class="op" id="3952580">=</span>&nbsp;<span class="builtintype" id="3952582">byte</span><span class="op" id="3952586">(</span><span class="ident" id="3952587">l</span>&nbsp;<span class="op" id="3952589">&gt;&gt;</span>&nbsp;<span class="num" id="3952592">8</span><span class="op" id="3952593">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952597">z</span><span class="op" id="3952598">[</span><span class="num" id="3952599">3</span><span class="op" id="3952600">]</span>&nbsp;<span class="op" id="3952602">=</span>&nbsp;<span class="builtintype" id="3952604">byte</span><span class="op" id="3952608">(</span><span class="ident" id="3952609">l</span><span class="op" id="3952610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952614">z</span>&nbsp;<span class="op" id="3952616">=</span>&nbsp;<span class="ident" id="3952618">z</span><span class="op" id="3952619">[</span><span class="num" id="3952620">4</span><span class="op" id="3952621">:</span><span class="op" id="3952622">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952627">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952654">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952659">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952673">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952702">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952732">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952771">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952788">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952807">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952812">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952824">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952853">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952870">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952875">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952908">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952913">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952927">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952975">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952999">z</span><span class="op" id="3953000">[</span><span class="num" id="3953001">0</span><span class="op" id="3953002">]</span>&nbsp;<span class="op" id="3953004">=</span>&nbsp;<span class="builtintype" id="3953006">byte</span><span class="op" id="3953010">(</span><span class="op" id="3953011">(</span><span class="builtinfunc" id="3953012">len</span><span class="op" id="3953015">(</span><span class="ident" id="3953016">m</span><span class="op" id="3953017">.</span><span class="ident" id="3953018">serverName</span><span class="op" id="3953028">)</span>&nbsp;<span class="op" id="3953030">+</span>&nbsp;<span class="num" id="3953032">3</span><span class="op" id="3953033">)</span>&nbsp;<span class="op" id="3953035">&gt;&gt;</span>&nbsp;<span class="num" id="3953038">8</span><span class="op" id="3953039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953043">z</span><span class="op" id="3953044">[</span><span class="num" id="3953045">1</span><span class="op" id="3953046">]</span>&nbsp;<span class="op" id="3953048">=</span>&nbsp;<span class="builtintype" id="3953050">byte</span><span class="op" id="3953054">(</span><span class="builtinfunc" id="3953055">len</span><span class="op" id="3953058">(</span><span class="ident" id="3953059">m</span><span class="op" id="3953060">.</span><span class="ident" id="3953061">serverName</span><span class="op" id="3953071">)</span>&nbsp;<span class="op" id="3953073">+</span>&nbsp;<span class="num" id="3953075">3</span><span class="op" id="3953076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953080">z</span><span class="op" id="3953081">[</span><span class="num" id="3953082">3</span><span class="op" id="3953083">]</span>&nbsp;<span class="op" id="3953085">=</span>&nbsp;<span class="builtintype" id="3953087">byte</span><span class="op" id="3953091">(</span><span class="builtinfunc" id="3953092">len</span><span class="op" id="3953095">(</span><span class="ident" id="3953096">m</span><span class="op" id="3953097">.</span><span class="ident" id="3953098">serverName</span><span class="op" id="3953108">)</span>&nbsp;<span class="op" id="3953110">&gt;&gt;</span>&nbsp;<span class="num" id="3953113">8</span><span class="op" id="3953114">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953118">z</span><span class="op" id="3953119">[</span><span class="num" id="3953120">4</span><span class="op" id="3953121">]</span>&nbsp;<span class="op" id="3953123">=</span>&nbsp;<span class="builtintype" id="3953125">byte</span><span class="op" id="3953129">(</span><span class="builtinfunc" id="3953130">len</span><span class="op" id="3953133">(</span><span class="ident" id="3953134">m</span><span class="op" id="3953135">.</span><span class="ident" id="3953136">serverName</span><span class="op" id="3953146">)</span><span class="op" id="3953147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3953151">copy</span><span class="op" id="3953155">(</span><span class="ident" id="3953156">z</span><span class="op" id="3953157">[</span><span class="num" id="3953158">5</span><span class="op" id="3953159">:</span><span class="op" id="3953160">]</span><span class="op" id="3953161">,</span>&nbsp;<span class="op" id="3953163">[</span><span class="op" id="3953164">]</span><span class="builtintype" id="3953165">byte</span><span class="op" id="3953169">(</span><span class="ident" id="3953170">m</span><span class="op" id="3953171">.</span><span class="ident" id="3953172">serverName</span><span class="op" id="3953182">)</span><span class="op" id="3953183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953187">z</span>&nbsp;<span class="op" id="3953189">=</span>&nbsp;<span class="ident" id="3953191">z</span><span class="op" id="3953192">[</span><span class="ident" id="3953193">l</span><span class="op" id="3953194">:</span><span class="op" id="3953195">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953201">if</span>&nbsp;<span class="ident" id="3953204">m</span><span class="op" id="3953205">.</span><span class="ident" id="3953206">ocspStapling</span>&nbsp;<span class="op" id="3953219">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953223">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953250">z</span><span class="op" id="3953251">[</span><span class="num" id="3953252">0</span><span class="op" id="3953253">]</span>&nbsp;<span class="op" id="3953255">=</span>&nbsp;<span class="builtintype" id="3953257">byte</span><span class="op" id="3953261">(</span><span class="ident" id="3953262">extensionStatusRequest</span>&nbsp;<span class="op" id="3953285">&gt;&gt;</span>&nbsp;<span class="num" id="3953288">8</span><span class="op" id="3953289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953293">z</span><span class="op" id="3953294">[</span><span class="num" id="3953295">1</span><span class="op" id="3953296">]</span>&nbsp;<span class="op" id="3953298">=</span>&nbsp;<span class="builtintype" id="3953300">byte</span><span class="op" id="3953304">(</span><span class="ident" id="3953305">extensionStatusRequest</span><span class="op" id="3953327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953331">z</span><span class="op" id="3953332">[</span><span class="num" id="3953333">2</span><span class="op" id="3953334">]</span>&nbsp;<span class="op" id="3953336">=</span>&nbsp;<span class="num" id="3953338">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953342">z</span><span class="op" id="3953343">[</span><span class="num" id="3953344">3</span><span class="op" id="3953345">]</span>&nbsp;<span class="op" id="3953347">=</span>&nbsp;<span class="num" id="3953349">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953353">z</span><span class="op" id="3953354">[</span><span class="num" id="3953355">4</span><span class="op" id="3953356">]</span>&nbsp;<span class="op" id="3953358">=</span>&nbsp;<span class="num" id="3953360">1</span>&nbsp;<span class="comment" id="3953362">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953377">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953427">z</span>&nbsp;<span class="op" id="3953429">=</span>&nbsp;<span class="ident" id="3953431">z</span><span class="op" id="3953432">[</span><span class="num" id="3953433">9</span><span class="op" id="3953434">:</span><span class="op" id="3953435">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953441">if</span>&nbsp;<span class="builtinfunc" id="3953444">len</span><span class="op" id="3953447">(</span><span class="ident" id="3953448">m</span><span class="op" id="3953449">.</span><span class="ident" id="3953450">supportedCurves</span><span class="op" id="3953465">)</span>&nbsp;<span class="op" id="3953467">&gt;</span>&nbsp;<span class="num" id="3953469">0</span>&nbsp;<span class="op" id="3953471">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953475">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953529">z</span><span class="op" id="3953530">[</span><span class="num" id="3953531">0</span><span class="op" id="3953532">]</span>&nbsp;<span class="op" id="3953534">=</span>&nbsp;<span class="builtintype" id="3953536">byte</span><span class="op" id="3953540">(</span><span class="ident" id="3953541">extensionSupportedCurves</span>&nbsp;<span class="op" id="3953566">&gt;&gt;</span>&nbsp;<span class="num" id="3953569">8</span><span class="op" id="3953570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953574">z</span><span class="op" id="3953575">[</span><span class="num" id="3953576">1</span><span class="op" id="3953577">]</span>&nbsp;<span class="op" id="3953579">=</span>&nbsp;<span class="builtintype" id="3953581">byte</span><span class="op" id="3953585">(</span><span class="ident" id="3953586">extensionSupportedCurves</span><span class="op" id="3953610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953614">l</span>&nbsp;<span class="op" id="3953616">:=</span>&nbsp;<span class="num" id="3953619">2</span>&nbsp;<span class="op" id="3953621">+</span>&nbsp;<span class="num" id="3953623">2</span><span class="op" id="3953624">*</span><span class="builtinfunc" id="3953625">len</span><span class="op" id="3953628">(</span><span class="ident" id="3953629">m</span><span class="op" id="3953630">.</span><span class="ident" id="3953631">supportedCurves</span><span class="op" id="3953646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953650">z</span><span class="op" id="3953651">[</span><span class="num" id="3953652">2</span><span class="op" id="3953653">]</span>&nbsp;<span class="op" id="3953655">=</span>&nbsp;<span class="builtintype" id="3953657">byte</span><span class="op" id="3953661">(</span><span class="ident" id="3953662">l</span>&nbsp;<span class="op" id="3953664">&gt;&gt;</span>&nbsp;<span class="num" id="3953667">8</span><span class="op" id="3953668">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953672">z</span><span class="op" id="3953673">[</span><span class="num" id="3953674">3</span><span class="op" id="3953675">]</span>&nbsp;<span class="op" id="3953677">=</span>&nbsp;<span class="builtintype" id="3953679">byte</span><span class="op" id="3953683">(</span><span class="ident" id="3953684">l</span><span class="op" id="3953685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953689">l</span>&nbsp;<span class="op" id="3953691">-=</span>&nbsp;<span class="num" id="3953694">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953698">z</span><span class="op" id="3953699">[</span><span class="num" id="3953700">4</span><span class="op" id="3953701">]</span>&nbsp;<span class="op" id="3953703">=</span>&nbsp;<span class="builtintype" id="3953705">byte</span><span class="op" id="3953709">(</span><span class="ident" id="3953710">l</span>&nbsp;<span class="op" id="3953712">&gt;&gt;</span>&nbsp;<span class="num" id="3953715">8</span><span class="op" id="3953716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953720">z</span><span class="op" id="3953721">[</span><span class="num" id="3953722">5</span><span class="op" id="3953723">]</span>&nbsp;<span class="op" id="3953725">=</span>&nbsp;<span class="builtintype" id="3953727">byte</span><span class="op" id="3953731">(</span><span class="ident" id="3953732">l</span><span class="op" id="3953733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953737">z</span>&nbsp;<span class="op" id="3953739">=</span>&nbsp;<span class="ident" id="3953741">z</span><span class="op" id="3953742">[</span><span class="num" id="3953743">6</span><span class="op" id="3953744">:</span><span class="op" id="3953745">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953749">for</span>&nbsp;<span class="ident" id="3953753">_</span><span class="op" id="3953754">,</span>&nbsp;<span class="ident" id="3953756">curve</span>&nbsp;<span class="op" id="3953762">:=</span>&nbsp;<span class="keyword" id="3953765">range</span>&nbsp;<span class="ident" id="3953771">m</span><span class="op" id="3953772">.</span><span class="ident" id="3953773">supportedCurves</span>&nbsp;<span class="op" id="3953789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953794">z</span><span class="op" id="3953795">[</span><span class="num" id="3953796">0</span><span class="op" id="3953797">]</span>&nbsp;<span class="op" id="3953799">=</span>&nbsp;<span class="builtintype" id="3953801">byte</span><span class="op" id="3953805">(</span><span class="ident" id="3953806">curve</span>&nbsp;<span class="op" id="3953812">&gt;&gt;</span>&nbsp;<span class="num" id="3953815">8</span><span class="op" id="3953816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953821">z</span><span class="op" id="3953822">[</span><span class="num" id="3953823">1</span><span class="op" id="3953824">]</span>&nbsp;<span class="op" id="3953826">=</span>&nbsp;<span class="builtintype" id="3953828">byte</span><span class="op" id="3953832">(</span><span class="ident" id="3953833">curve</span><span class="op" id="3953838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953843">z</span>&nbsp;<span class="op" id="3953845">=</span>&nbsp;<span class="ident" id="3953847">z</span><span class="op" id="3953848">[</span><span class="num" id="3953849">2</span><span class="op" id="3953850">:</span><span class="op" id="3953851">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953855">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953861">if</span>&nbsp;<span class="builtinfunc" id="3953864">len</span><span class="op" id="3953867">(</span><span class="ident" id="3953868">m</span><span class="op" id="3953869">.</span><span class="ident" id="3953870">supportedPoints</span><span class="op" id="3953885">)</span>&nbsp;<span class="op" id="3953887">&gt;</span>&nbsp;<span class="num" id="3953889">0</span>&nbsp;<span class="op" id="3953891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953895">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953949">z</span><span class="op" id="3953950">[</span><span class="num" id="3953951">0</span><span class="op" id="3953952">]</span>&nbsp;<span class="op" id="3953954">=</span>&nbsp;<span class="builtintype" id="3953956">byte</span><span class="op" id="3953960">(</span><span class="ident" id="3953961">extensionSupportedPoints</span>&nbsp;<span class="op" id="3953986">&gt;&gt;</span>&nbsp;<span class="num" id="3953989">8</span><span class="op" id="3953990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953994">z</span><span class="op" id="3953995">[</span><span class="num" id="3953996">1</span><span class="op" id="3953997">]</span>&nbsp;<span class="op" id="3953999">=</span>&nbsp;<span class="builtintype" id="3954001">byte</span><span class="op" id="3954005">(</span><span class="ident" id="3954006">extensionSupportedPoints</span><span class="op" id="3954030">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954034">l</span>&nbsp;<span class="op" id="3954036">:=</span>&nbsp;<span class="num" id="3954039">1</span>&nbsp;<span class="op" id="3954041">+</span>&nbsp;<span class="builtinfunc" id="3954043">len</span><span class="op" id="3954046">(</span><span class="ident" id="3954047">m</span><span class="op" id="3954048">.</span><span class="ident" id="3954049">supportedPoints</span><span class="op" id="3954064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954068">z</span><span class="op" id="3954069">[</span><span class="num" id="3954070">2</span><span class="op" id="3954071">]</span>&nbsp;<span class="op" id="3954073">=</span>&nbsp;<span class="builtintype" id="3954075">byte</span><span class="op" id="3954079">(</span><span class="ident" id="3954080">l</span>&nbsp;<span class="op" id="3954082">&gt;&gt;</span>&nbsp;<span class="num" id="3954085">8</span><span class="op" id="3954086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954090">z</span><span class="op" id="3954091">[</span><span class="num" id="3954092">3</span><span class="op" id="3954093">]</span>&nbsp;<span class="op" id="3954095">=</span>&nbsp;<span class="builtintype" id="3954097">byte</span><span class="op" id="3954101">(</span><span class="ident" id="3954102">l</span><span class="op" id="3954103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954107">l</span><span class="op" id="3954108">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954113">z</span><span class="op" id="3954114">[</span><span class="num" id="3954115">4</span><span class="op" id="3954116">]</span>&nbsp;<span class="op" id="3954118">=</span>&nbsp;<span class="builtintype" id="3954120">byte</span><span class="op" id="3954124">(</span><span class="ident" id="3954125">l</span><span class="op" id="3954126">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954130">z</span>&nbsp;<span class="op" id="3954132">=</span>&nbsp;<span class="ident" id="3954134">z</span><span class="op" id="3954135">[</span><span class="num" id="3954136">5</span><span class="op" id="3954137">:</span><span class="op" id="3954138">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954142">for</span>&nbsp;<span class="ident" id="3954146">_</span><span class="op" id="3954147">,</span>&nbsp;<span class="ident" id="3954149">pointFormat</span>&nbsp;<span class="op" id="3954161">:=</span>&nbsp;<span class="keyword" id="3954164">range</span>&nbsp;<span class="ident" id="3954170">m</span><span class="op" id="3954171">.</span><span class="ident" id="3954172">supportedPoints</span>&nbsp;<span class="op" id="3954188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954193">z</span><span class="op" id="3954194">[</span><span class="num" id="3954195">0</span><span class="op" id="3954196">]</span>&nbsp;<span class="op" id="3954198">=</span>&nbsp;<span class="builtintype" id="3954200">byte</span><span class="op" id="3954204">(</span><span class="ident" id="3954205">pointFormat</span><span class="op" id="3954216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954221">z</span>&nbsp;<span class="op" id="3954223">=</span>&nbsp;<span class="ident" id="3954225">z</span><span class="op" id="3954226">[</span><span class="num" id="3954227">1</span><span class="op" id="3954228">:</span><span class="op" id="3954229">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954233">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954239">if</span>&nbsp;<span class="ident" id="3954242">m</span><span class="op" id="3954243">.</span><span class="ident" id="3954244">ticketSupported</span>&nbsp;<span class="op" id="3954260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3954264">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954316">z</span><span class="op" id="3954317">[</span><span class="num" id="3954318">0</span><span class="op" id="3954319">]</span>&nbsp;<span class="op" id="3954321">=</span>&nbsp;<span class="builtintype" id="3954323">byte</span><span class="op" id="3954327">(</span><span class="ident" id="3954328">extensionSessionTicket</span>&nbsp;<span class="op" id="3954351">&gt;&gt;</span>&nbsp;<span class="num" id="3954354">8</span><span class="op" id="3954355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954359">z</span><span class="op" id="3954360">[</span><span class="num" id="3954361">1</span><span class="op" id="3954362">]</span>&nbsp;<span class="op" id="3954364">=</span>&nbsp;<span class="builtintype" id="3954366">byte</span><span class="op" id="3954370">(</span><span class="ident" id="3954371">extensionSessionTicket</span><span class="op" id="3954393">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954397">l</span>&nbsp;<span class="op" id="3954399">:=</span>&nbsp;<span class="builtinfunc" id="3954402">len</span><span class="op" id="3954405">(</span><span class="ident" id="3954406">m</span><span class="op" id="3954407">.</span><span class="ident" id="3954408">sessionTicket</span><span class="op" id="3954421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954425">z</span><span class="op" id="3954426">[</span><span class="num" id="3954427">2</span><span class="op" id="3954428">]</span>&nbsp;<span class="op" id="3954430">=</span>&nbsp;<span class="builtintype" id="3954432">byte</span><span class="op" id="3954436">(</span><span class="ident" id="3954437">l</span>&nbsp;<span class="op" id="3954439">&gt;&gt;</span>&nbsp;<span class="num" id="3954442">8</span><span class="op" id="3954443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954447">z</span><span class="op" id="3954448">[</span><span class="num" id="3954449">3</span><span class="op" id="3954450">]</span>&nbsp;<span class="op" id="3954452">=</span>&nbsp;<span class="builtintype" id="3954454">byte</span><span class="op" id="3954458">(</span><span class="ident" id="3954459">l</span><span class="op" id="3954460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954464">z</span>&nbsp;<span class="op" id="3954466">=</span>&nbsp;<span class="ident" id="3954468">z</span><span class="op" id="3954469">[</span><span class="num" id="3954470">4</span><span class="op" id="3954471">:</span><span class="op" id="3954472">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3954476">copy</span><span class="op" id="3954480">(</span><span class="ident" id="3954481">z</span><span class="op" id="3954482">,</span>&nbsp;<span class="ident" id="3954484">m</span><span class="op" id="3954485">.</span><span class="ident" id="3954486">sessionTicket</span><span class="op" id="3954499">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954503">z</span>&nbsp;<span class="op" id="3954505">=</span>&nbsp;<span class="ident" id="3954507">z</span><span class="op" id="3954508">[</span><span class="builtinfunc" id="3954509">len</span><span class="op" id="3954512">(</span><span class="ident" id="3954513">m</span><span class="op" id="3954514">.</span><span class="ident" id="3954515">sessionTicket</span><span class="op" id="3954528">)</span><span class="op" id="3954529">:</span><span class="op" id="3954530">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954536">if</span>&nbsp;<span class="builtinfunc" id="3954539">len</span><span class="op" id="3954542">(</span><span class="ident" id="3954543">m</span><span class="op" id="3954544">.</span><span class="ident" id="3954545">signatureAndHashes</span><span class="op" id="3954563">)</span>&nbsp;<span class="op" id="3954565">&gt;</span>&nbsp;<span class="num" id="3954567">0</span>&nbsp;<span class="op" id="3954569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3954573">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954632">z</span><span class="op" id="3954633">[</span><span class="num" id="3954634">0</span><span class="op" id="3954635">]</span>&nbsp;<span class="op" id="3954637">=</span>&nbsp;<span class="builtintype" id="3954639">byte</span><span class="op" id="3954643">(</span><span class="ident" id="3954644">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="3954673">&gt;&gt;</span>&nbsp;<span class="num" id="3954676">8</span><span class="op" id="3954677">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954681">z</span><span class="op" id="3954682">[</span><span class="num" id="3954683">1</span><span class="op" id="3954684">]</span>&nbsp;<span class="op" id="3954686">=</span>&nbsp;<span class="builtintype" id="3954688">byte</span><span class="op" id="3954692">(</span><span class="ident" id="3954693">extensionSignatureAlgorithms</span><span class="op" id="3954721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954725">l</span>&nbsp;<span class="op" id="3954727">:=</span>&nbsp;<span class="num" id="3954730">2</span>&nbsp;<span class="op" id="3954732">+</span>&nbsp;<span class="num" id="3954734">2</span><span class="op" id="3954735">*</span><span class="builtinfunc" id="3954736">len</span><span class="op" id="3954739">(</span><span class="ident" id="3954740">m</span><span class="op" id="3954741">.</span><span class="ident" id="3954742">signatureAndHashes</span><span class="op" id="3954760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954764">z</span><span class="op" id="3954765">[</span><span class="num" id="3954766">2</span><span class="op" id="3954767">]</span>&nbsp;<span class="op" id="3954769">=</span>&nbsp;<span class="builtintype" id="3954771">byte</span><span class="op" id="3954775">(</span><span class="ident" id="3954776">l</span>&nbsp;<span class="op" id="3954778">&gt;&gt;</span>&nbsp;<span class="num" id="3954781">8</span><span class="op" id="3954782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954786">z</span><span class="op" id="3954787">[</span><span class="num" id="3954788">3</span><span class="op" id="3954789">]</span>&nbsp;<span class="op" id="3954791">=</span>&nbsp;<span class="builtintype" id="3954793">byte</span><span class="op" id="3954797">(</span><span class="ident" id="3954798">l</span><span class="op" id="3954799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954803">z</span>&nbsp;<span class="op" id="3954805">=</span>&nbsp;<span class="ident" id="3954807">z</span><span class="op" id="3954808">[</span><span class="num" id="3954809">4</span><span class="op" id="3954810">:</span><span class="op" id="3954811">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954816">l</span>&nbsp;<span class="op" id="3954818">-=</span>&nbsp;<span class="num" id="3954821">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954825">z</span><span class="op" id="3954826">[</span><span class="num" id="3954827">0</span><span class="op" id="3954828">]</span>&nbsp;<span class="op" id="3954830">=</span>&nbsp;<span class="builtintype" id="3954832">byte</span><span class="op" id="3954836">(</span><span class="ident" id="3954837">l</span>&nbsp;<span class="op" id="3954839">&gt;&gt;</span>&nbsp;<span class="num" id="3954842">8</span><span class="op" id="3954843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954847">z</span><span class="op" id="3954848">[</span><span class="num" id="3954849">1</span><span class="op" id="3954850">]</span>&nbsp;<span class="op" id="3954852">=</span>&nbsp;<span class="builtintype" id="3954854">byte</span><span class="op" id="3954858">(</span><span class="ident" id="3954859">l</span><span class="op" id="3954860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954864">z</span>&nbsp;<span class="op" id="3954866">=</span>&nbsp;<span class="ident" id="3954868">z</span><span class="op" id="3954869">[</span><span class="num" id="3954870">2</span><span class="op" id="3954871">:</span><span class="op" id="3954872">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954876">for</span>&nbsp;<span class="ident" id="3954880">_</span><span class="op" id="3954881">,</span>&nbsp;<span class="ident" id="3954883">sigAndHash</span>&nbsp;<span class="op" id="3954894">:=</span>&nbsp;<span class="keyword" id="3954897">range</span>&nbsp;<span class="ident" id="3954903">m</span><span class="op" id="3954904">.</span><span class="ident" id="3954905">signatureAndHashes</span>&nbsp;<span class="op" id="3954924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954929">z</span><span class="op" id="3954930">[</span><span class="num" id="3954931">0</span><span class="op" id="3954932">]</span>&nbsp;<span class="op" id="3954934">=</span>&nbsp;<span class="ident" id="3954936">sigAndHash</span><span class="op" id="3954946">.</span><span class="ident" id="3954947">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954955">z</span><span class="op" id="3954956">[</span><span class="num" id="3954957">1</span><span class="op" id="3954958">]</span>&nbsp;<span class="op" id="3954960">=</span>&nbsp;<span class="ident" id="3954962">sigAndHash</span><span class="op" id="3954972">.</span><span class="ident" id="3954973">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954986">z</span>&nbsp;<span class="op" id="3954988">=</span>&nbsp;<span class="ident" id="3954990">z</span><span class="op" id="3954991">[</span><span class="num" id="3954992">2</span><span class="op" id="3954993">:</span><span class="op" id="3954994">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954998">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955004">if</span>&nbsp;<span class="ident" id="3955007">m</span><span class="op" id="3955008">.</span><span class="ident" id="3955009">secureRenegotiation</span>&nbsp;<span class="op" id="3955029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955033">z</span><span class="op" id="3955034">[</span><span class="num" id="3955035">0</span><span class="op" id="3955036">]</span>&nbsp;<span class="op" id="3955038">=</span>&nbsp;<span class="builtintype" id="3955040">byte</span><span class="op" id="3955044">(</span><span class="ident" id="3955045">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3955072">&gt;&gt;</span>&nbsp;<span class="num" id="3955075">8</span><span class="op" id="3955076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955080">z</span><span class="op" id="3955081">[</span><span class="num" id="3955082">1</span><span class="op" id="3955083">]</span>&nbsp;<span class="op" id="3955085">=</span>&nbsp;<span class="builtintype" id="3955087">byte</span><span class="op" id="3955091">(</span><span class="ident" id="3955092">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3955119">&amp;</span>&nbsp;<span class="num" id="3955121">0xff</span><span class="op" id="3955125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955129">z</span><span class="op" id="3955130">[</span><span class="num" id="3955131">2</span><span class="op" id="3955132">]</span>&nbsp;<span class="op" id="3955134">=</span>&nbsp;<span class="num" id="3955136">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955140">z</span><span class="op" id="3955141">[</span><span class="num" id="3955142">3</span><span class="op" id="3955143">]</span>&nbsp;<span class="op" id="3955145">=</span>&nbsp;<span class="num" id="3955147">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955151">z</span>&nbsp;<span class="op" id="3955153">=</span>&nbsp;<span class="ident" id="3955155">z</span><span class="op" id="3955156">[</span><span class="num" id="3955157">5</span><span class="op" id="3955158">:</span><span class="op" id="3955159">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955165">if</span>&nbsp;<span class="builtinfunc" id="3955168">len</span><span class="op" id="3955171">(</span><span class="ident" id="3955172">m</span><span class="op" id="3955173">.</span><span class="ident" id="3955174">alpnProtocols</span><span class="op" id="3955187">)</span>&nbsp;<span class="op" id="3955189">&gt;</span>&nbsp;<span class="num" id="3955191">0</span>&nbsp;<span class="op" id="3955193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955197">z</span><span class="op" id="3955198">[</span><span class="num" id="3955199">0</span><span class="op" id="3955200">]</span>&nbsp;<span class="op" id="3955202">=</span>&nbsp;<span class="builtintype" id="3955204">byte</span><span class="op" id="3955208">(</span><span class="ident" id="3955209">extensionALPN</span>&nbsp;<span class="op" id="3955223">&gt;&gt;</span>&nbsp;<span class="num" id="3955226">8</span><span class="op" id="3955227">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955231">z</span><span class="op" id="3955232">[</span><span class="num" id="3955233">1</span><span class="op" id="3955234">]</span>&nbsp;<span class="op" id="3955236">=</span>&nbsp;<span class="builtintype" id="3955238">byte</span><span class="op" id="3955242">(</span><span class="ident" id="3955243">extensionALPN</span>&nbsp;<span class="op" id="3955257">&amp;</span>&nbsp;<span class="num" id="3955259">0xff</span><span class="op" id="3955263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955267">lengths</span>&nbsp;<span class="op" id="3955275">:=</span>&nbsp;<span class="ident" id="3955278">z</span><span class="op" id="3955279">[</span><span class="num" id="3955280">2</span><span class="op" id="3955281">:</span><span class="op" id="3955282">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955286">z</span>&nbsp;<span class="op" id="3955288">=</span>&nbsp;<span class="ident" id="3955290">z</span><span class="op" id="3955291">[</span><span class="num" id="3955292">6</span><span class="op" id="3955293">:</span><span class="op" id="3955294">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955299">stringsLength</span>&nbsp;<span class="op" id="3955313">:=</span>&nbsp;<span class="num" id="3955316">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955320">for</span>&nbsp;<span class="ident" id="3955324">_</span><span class="op" id="3955325">,</span>&nbsp;<span class="ident" id="3955327">s</span>&nbsp;<span class="op" id="3955329">:=</span>&nbsp;<span class="keyword" id="3955332">range</span>&nbsp;<span class="ident" id="3955338">m</span><span class="op" id="3955339">.</span><span class="ident" id="3955340">alpnProtocols</span>&nbsp;<span class="op" id="3955354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955359">l</span>&nbsp;<span class="op" id="3955361">:=</span>&nbsp;<span class="builtinfunc" id="3955364">len</span><span class="op" id="3955367">(</span><span class="ident" id="3955368">s</span><span class="op" id="3955369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955374">z</span><span class="op" id="3955375">[</span><span class="num" id="3955376">0</span><span class="op" id="3955377">]</span>&nbsp;<span class="op" id="3955379">=</span>&nbsp;<span class="builtintype" id="3955381">byte</span><span class="op" id="3955385">(</span><span class="ident" id="3955386">l</span><span class="op" id="3955387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3955392">copy</span><span class="op" id="3955396">(</span><span class="ident" id="3955397">z</span><span class="op" id="3955398">[</span><span class="num" id="3955399">1</span><span class="op" id="3955400">:</span><span class="op" id="3955401">]</span><span class="op" id="3955402">,</span>&nbsp;<span class="ident" id="3955404">s</span><span class="op" id="3955405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955410">z</span>&nbsp;<span class="op" id="3955412">=</span>&nbsp;<span class="ident" id="3955414">z</span><span class="op" id="3955415">[</span><span class="num" id="3955416">1</span><span class="op" id="3955417">+</span><span class="ident" id="3955418">l</span><span class="op" id="3955419">:</span><span class="op" id="3955420">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955425">stringsLength</span>&nbsp;<span class="op" id="3955439">+=</span>&nbsp;<span class="num" id="3955442">1</span>&nbsp;<span class="op" id="3955444">+</span>&nbsp;<span class="ident" id="3955446">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955455">lengths</span><span class="op" id="3955462">[</span><span class="num" id="3955463">2</span><span class="op" id="3955464">]</span>&nbsp;<span class="op" id="3955466">=</span>&nbsp;<span class="builtintype" id="3955468">byte</span><span class="op" id="3955472">(</span><span class="ident" id="3955473">stringsLength</span>&nbsp;<span class="op" id="3955487">&gt;&gt;</span>&nbsp;<span class="num" id="3955490">8</span><span class="op" id="3955491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955495">lengths</span><span class="op" id="3955502">[</span><span class="num" id="3955503">3</span><span class="op" id="3955504">]</span>&nbsp;<span class="op" id="3955506">=</span>&nbsp;<span class="builtintype" id="3955508">byte</span><span class="op" id="3955512">(</span><span class="ident" id="3955513">stringsLength</span><span class="op" id="3955526">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955530">stringsLength</span>&nbsp;<span class="op" id="3955544">+=</span>&nbsp;<span class="num" id="3955547">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955551">lengths</span><span class="op" id="3955558">[</span><span class="num" id="3955559">0</span><span class="op" id="3955560">]</span>&nbsp;<span class="op" id="3955562">=</span>&nbsp;<span class="builtintype" id="3955564">byte</span><span class="op" id="3955568">(</span><span class="ident" id="3955569">stringsLength</span>&nbsp;<span class="op" id="3955583">&gt;&gt;</span>&nbsp;<span class="num" id="3955586">8</span><span class="op" id="3955587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955591">lengths</span><span class="op" id="3955598">[</span><span class="num" id="3955599">1</span><span class="op" id="3955600">]</span>&nbsp;<span class="op" id="3955602">=</span>&nbsp;<span class="builtintype" id="3955604">byte</span><span class="op" id="3955608">(</span><span class="ident" id="3955609">stringsLength</span><span class="op" id="3955622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955629">m</span><span class="op" id="3955630">.</span><span class="ident" id="3955631">raw</span>&nbsp;<span class="op" id="3955635">=</span>&nbsp;<span class="ident" id="3955637">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955641">return</span>&nbsp;<span class="ident" id="3955648">x</span><br>
<span class="lineno"></span><span class="op" id="3955650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3955653">func</span>&nbsp;<span class="op" id="3955658">(</span><span class="ident" id="3955659">m</span>&nbsp;<span class="op" id="3955661">*</span><span class="ident" id="3955662">clientHelloMsg</span><span class="op" id="3955676">)</span>&nbsp;<span class="ident" id="3955678">unmarshal</span><span class="op" id="3955687">(</span><span class="ident" id="3955688">data</span>&nbsp;<span class="op" id="3955693">[</span><span class="op" id="3955694">]</span><span class="builtintype" id="3955695">byte</span><span class="op" id="3955699">)</span>&nbsp;<span class="builtintype" id="3955701">bool</span>&nbsp;<span class="op" id="3955706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955709">if</span>&nbsp;<span class="builtinfunc" id="3955712">len</span><span class="op" id="3955715">(</span><span class="ident" id="3955716">data</span><span class="op" id="3955720">)</span>&nbsp;<span class="op" id="3955722">&lt;</span>&nbsp;<span class="num" id="3955724">42</span>&nbsp;<span class="op" id="3955727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955731">return</span>&nbsp;<span class="ident" id="3955738">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955748">m</span><span class="op" id="3955749">.</span><span class="ident" id="3955750">raw</span>&nbsp;<span class="op" id="3955754">=</span>&nbsp;<span class="ident" id="3955756">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955762">m</span><span class="op" id="3955763">.</span><span class="ident" id="3955764">vers</span>&nbsp;<span class="op" id="3955769">=</span>&nbsp;<span class="builtintype" id="3955771">uint16</span><span class="op" id="3955777">(</span><span class="ident" id="3955778">data</span><span class="op" id="3955782">[</span><span class="num" id="3955783">4</span><span class="op" id="3955784">]</span><span class="op" id="3955785">)</span><span class="op" id="3955786">&lt;&lt;</span><span class="num" id="3955788">8</span>&nbsp;<span class="op" id="3955790">|</span>&nbsp;<span class="builtintype" id="3955792">uint16</span><span class="op" id="3955798">(</span><span class="ident" id="3955799">data</span><span class="op" id="3955803">[</span><span class="num" id="3955804">5</span><span class="op" id="3955805">]</span><span class="op" id="3955806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955809">m</span><span class="op" id="3955810">.</span><span class="ident" id="3955811">random</span>&nbsp;<span class="op" id="3955818">=</span>&nbsp;<span class="ident" id="3955820">data</span><span class="op" id="3955824">[</span><span class="num" id="3955825">6</span><span class="op" id="3955826">:</span><span class="num" id="3955827">38</span><span class="op" id="3955829">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955832">sessionIdLen</span>&nbsp;<span class="op" id="3955845">:=</span>&nbsp;<span class="builtintype" id="3955848">int</span><span class="op" id="3955851">(</span><span class="ident" id="3955852">data</span><span class="op" id="3955856">[</span><span class="num" id="3955857">38</span><span class="op" id="3955859">]</span><span class="op" id="3955860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955863">if</span>&nbsp;<span class="ident" id="3955866">sessionIdLen</span>&nbsp;<span class="op" id="3955879">&gt;</span>&nbsp;<span class="num" id="3955881">32</span>&nbsp;<span class="op" id="3955884">||</span>&nbsp;<span class="builtinfunc" id="3955887">len</span><span class="op" id="3955890">(</span><span class="ident" id="3955891">data</span><span class="op" id="3955895">)</span>&nbsp;<span class="op" id="3955897">&lt;</span>&nbsp;<span class="num" id="3955899">39</span><span class="op" id="3955901">+</span><span class="ident" id="3955902">sessionIdLen</span>&nbsp;<span class="op" id="3955915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955919">return</span>&nbsp;<span class="ident" id="3955926">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955936">m</span><span class="op" id="3955937">.</span><span class="ident" id="3955938">sessionId</span>&nbsp;<span class="op" id="3955948">=</span>&nbsp;<span class="ident" id="3955950">data</span><span class="op" id="3955954">[</span><span class="num" id="3955955">39</span>&nbsp;<span class="op" id="3955958">:</span>&nbsp;<span class="num" id="3955960">39</span><span class="op" id="3955962">+</span><span class="ident" id="3955963">sessionIdLen</span><span class="op" id="3955975">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955978">data</span>&nbsp;<span class="op" id="3955983">=</span>&nbsp;<span class="ident" id="3955985">data</span><span class="op" id="3955989">[</span><span class="num" id="3955990">39</span><span class="op" id="3955992">+</span><span class="ident" id="3955993">sessionIdLen</span><span class="op" id="3956005">:</span><span class="op" id="3956006">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956009">if</span>&nbsp;<span class="builtinfunc" id="3956012">len</span><span class="op" id="3956015">(</span><span class="ident" id="3956016">data</span><span class="op" id="3956020">)</span>&nbsp;<span class="op" id="3956022">&lt;</span>&nbsp;<span class="num" id="3956024">2</span>&nbsp;<span class="op" id="3956026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956030">return</span>&nbsp;<span class="ident" id="3956037">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3956047">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3956120">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956167">cipherSuiteLen</span>&nbsp;<span class="op" id="3956182">:=</span>&nbsp;<span class="builtintype" id="3956185">int</span><span class="op" id="3956188">(</span><span class="ident" id="3956189">data</span><span class="op" id="3956193">[</span><span class="num" id="3956194">0</span><span class="op" id="3956195">]</span><span class="op" id="3956196">)</span><span class="op" id="3956197">&lt;&lt;</span><span class="num" id="3956199">8</span>&nbsp;<span class="op" id="3956201">|</span>&nbsp;<span class="builtintype" id="3956203">int</span><span class="op" id="3956206">(</span><span class="ident" id="3956207">data</span><span class="op" id="3956211">[</span><span class="num" id="3956212">1</span><span class="op" id="3956213">]</span><span class="op" id="3956214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956217">if</span>&nbsp;<span class="ident" id="3956220">cipherSuiteLen</span><span class="op" id="3956234">%</span><span class="num" id="3956235">2</span>&nbsp;<span class="op" id="3956237">==</span>&nbsp;<span class="num" id="3956240">1</span>&nbsp;<span class="op" id="3956242">||</span>&nbsp;<span class="builtinfunc" id="3956245">len</span><span class="op" id="3956248">(</span><span class="ident" id="3956249">data</span><span class="op" id="3956253">)</span>&nbsp;<span class="op" id="3956255">&lt;</span>&nbsp;<span class="num" id="3956257">2</span><span class="op" id="3956258">+</span><span class="ident" id="3956259">cipherSuiteLen</span>&nbsp;<span class="op" id="3956274">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956278">return</span>&nbsp;<span class="ident" id="3956285">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956295">numCipherSuites</span>&nbsp;<span class="op" id="3956311">:=</span>&nbsp;<span class="ident" id="3956314">cipherSuiteLen</span>&nbsp;<span class="op" id="3956329">/</span>&nbsp;<span class="num" id="3956331">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956334">m</span><span class="op" id="3956335">.</span><span class="ident" id="3956336">cipherSuites</span>&nbsp;<span class="op" id="3956349">=</span>&nbsp;<span class="builtinfunc" id="3956351">make</span><span class="op" id="3956355">(</span><span class="op" id="3956356">[</span><span class="op" id="3956357">]</span><span class="builtintype" id="3956358">uint16</span><span class="op" id="3956364">,</span>&nbsp;<span class="ident" id="3956366">numCipherSuites</span><span class="op" id="3956381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956384">for</span>&nbsp;<span class="ident" id="3956388">i</span>&nbsp;<span class="op" id="3956390">:=</span>&nbsp;<span class="num" id="3956393">0</span><span class="op" id="3956394">;</span>&nbsp;<span class="ident" id="3956396">i</span>&nbsp;<span class="op" id="3956398">&lt;</span>&nbsp;<span class="ident" id="3956400">numCipherSuites</span><span class="op" id="3956415">;</span>&nbsp;<span class="ident" id="3956417">i</span><span class="op" id="3956418">++</span>&nbsp;<span class="op" id="3956421">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956425">m</span><span class="op" id="3956426">.</span><span class="ident" id="3956427">cipherSuites</span><span class="op" id="3956439">[</span><span class="ident" id="3956440">i</span><span class="op" id="3956441">]</span>&nbsp;<span class="op" id="3956443">=</span>&nbsp;<span class="builtintype" id="3956445">uint16</span><span class="op" id="3956451">(</span><span class="ident" id="3956452">data</span><span class="op" id="3956456">[</span><span class="num" id="3956457">2</span><span class="op" id="3956458">+</span><span class="num" id="3956459">2</span><span class="op" id="3956460">*</span><span class="ident" id="3956461">i</span><span class="op" id="3956462">]</span><span class="op" id="3956463">)</span><span class="op" id="3956464">&lt;&lt;</span><span class="num" id="3956466">8</span>&nbsp;<span class="op" id="3956468">|</span>&nbsp;<span class="builtintype" id="3956470">uint16</span><span class="op" id="3956476">(</span><span class="ident" id="3956477">data</span><span class="op" id="3956481">[</span><span class="num" id="3956482">3</span><span class="op" id="3956483">+</span><span class="num" id="3956484">2</span><span class="op" id="3956485">*</span><span class="ident" id="3956486">i</span><span class="op" id="3956487">]</span><span class="op" id="3956488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956492">if</span>&nbsp;<span class="ident" id="3956495">m</span><span class="op" id="3956496">.</span><span class="ident" id="3956497">cipherSuites</span><span class="op" id="3956509">[</span><span class="ident" id="3956510">i</span><span class="op" id="3956511">]</span>&nbsp;<span class="op" id="3956513">==</span>&nbsp;<span class="ident" id="3956516">scsvRenegotiation</span>&nbsp;<span class="op" id="3956534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956539">m</span><span class="op" id="3956540">.</span><span class="ident" id="3956541">secureRenegotiation</span>&nbsp;<span class="op" id="3956561">=</span>&nbsp;<span class="ident" id="3956563">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956573">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956576">data</span>&nbsp;<span class="op" id="3956581">=</span>&nbsp;<span class="ident" id="3956583">data</span><span class="op" id="3956587">[</span><span class="num" id="3956588">2</span><span class="op" id="3956589">+</span><span class="ident" id="3956590">cipherSuiteLen</span><span class="op" id="3956604">:</span><span class="op" id="3956605">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956608">if</span>&nbsp;<span class="builtinfunc" id="3956611">len</span><span class="op" id="3956614">(</span><span class="ident" id="3956615">data</span><span class="op" id="3956619">)</span>&nbsp;<span class="op" id="3956621">&lt;</span>&nbsp;<span class="num" id="3956623">1</span>&nbsp;<span class="op" id="3956625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956629">return</span>&nbsp;<span class="ident" id="3956636">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956646">compressionMethodsLen</span>&nbsp;<span class="op" id="3956668">:=</span>&nbsp;<span class="builtintype" id="3956671">int</span><span class="op" id="3956674">(</span><span class="ident" id="3956675">data</span><span class="op" id="3956679">[</span><span class="num" id="3956680">0</span><span class="op" id="3956681">]</span><span class="op" id="3956682">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956685">if</span>&nbsp;<span class="builtinfunc" id="3956688">len</span><span class="op" id="3956691">(</span><span class="ident" id="3956692">data</span><span class="op" id="3956696">)</span>&nbsp;<span class="op" id="3956698">&lt;</span>&nbsp;<span class="num" id="3956700">1</span><span class="op" id="3956701">+</span><span class="ident" id="3956702">compressionMethodsLen</span>&nbsp;<span class="op" id="3956724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956728">return</span>&nbsp;<span class="ident" id="3956735">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956745">m</span><span class="op" id="3956746">.</span><span class="ident" id="3956747">compressionMethods</span>&nbsp;<span class="op" id="3956766">=</span>&nbsp;<span class="ident" id="3956768">data</span><span class="op" id="3956772">[</span><span class="num" id="3956773">1</span>&nbsp;<span class="op" id="3956775">:</span>&nbsp;<span class="num" id="3956777">1</span><span class="op" id="3956778">+</span><span class="ident" id="3956779">compressionMethodsLen</span><span class="op" id="3956800">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956804">data</span>&nbsp;<span class="op" id="3956809">=</span>&nbsp;<span class="ident" id="3956811">data</span><span class="op" id="3956815">[</span><span class="num" id="3956816">1</span><span class="op" id="3956817">+</span><span class="ident" id="3956818">compressionMethodsLen</span><span class="op" id="3956839">:</span><span class="op" id="3956840">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956844">m</span><span class="op" id="3956845">.</span><span class="ident" id="3956846">nextProtoNeg</span>&nbsp;<span class="op" id="3956859">=</span>&nbsp;<span class="ident" id="3956861">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956868">m</span><span class="op" id="3956869">.</span><span class="ident" id="3956870">serverName</span>&nbsp;<span class="op" id="3956881">=</span>&nbsp;<span class="string" id="3956883">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956887">m</span><span class="op" id="3956888">.</span><span class="ident" id="3956889">ocspStapling</span>&nbsp;<span class="op" id="3956902">=</span>&nbsp;<span class="ident" id="3956904">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956911">m</span><span class="op" id="3956912">.</span><span class="ident" id="3956913">ticketSupported</span>&nbsp;<span class="op" id="3956929">=</span>&nbsp;<span class="ident" id="3956931">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956938">m</span><span class="op" id="3956939">.</span><span class="ident" id="3956940">sessionTicket</span>&nbsp;<span class="op" id="3956954">=</span>&nbsp;<span class="ident" id="3956956">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956961">m</span><span class="op" id="3956962">.</span><span class="ident" id="3956963">signatureAndHashes</span>&nbsp;<span class="op" id="3956982">=</span>&nbsp;<span class="ident" id="3956984">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956989">m</span><span class="op" id="3956990">.</span><span class="ident" id="3956991">alpnProtocols</span>&nbsp;<span class="op" id="3957005">=</span>&nbsp;<span class="ident" id="3957007">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957013">if</span>&nbsp;<span class="builtinfunc" id="3957016">len</span><span class="op" id="3957019">(</span><span class="ident" id="3957020">data</span><span class="op" id="3957024">)</span>&nbsp;<span class="op" id="3957026">==</span>&nbsp;<span class="num" id="3957029">0</span>&nbsp;<span class="op" id="3957031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3957035">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957093">return</span>&nbsp;<span class="ident" id="3957100">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957109">if</span>&nbsp;<span class="builtinfunc" id="3957112">len</span><span class="op" id="3957115">(</span><span class="ident" id="3957116">data</span><span class="op" id="3957120">)</span>&nbsp;<span class="op" id="3957122">&lt;</span>&nbsp;<span class="num" id="3957124">2</span>&nbsp;<span class="op" id="3957126">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957130">return</span>&nbsp;<span class="ident" id="3957137">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957148">extensionsLength</span>&nbsp;<span class="op" id="3957165">:=</span>&nbsp;<span class="builtintype" id="3957168">int</span><span class="op" id="3957171">(</span><span class="ident" id="3957172">data</span><span class="op" id="3957176">[</span><span class="num" id="3957177">0</span><span class="op" id="3957178">]</span><span class="op" id="3957179">)</span><span class="op" id="3957180">&lt;&lt;</span><span class="num" id="3957182">8</span>&nbsp;<span class="op" id="3957184">|</span>&nbsp;<span class="builtintype" id="3957186">int</span><span class="op" id="3957189">(</span><span class="ident" id="3957190">data</span><span class="op" id="3957194">[</span><span class="num" id="3957195">1</span><span class="op" id="3957196">]</span><span class="op" id="3957197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957200">data</span>&nbsp;<span class="op" id="3957205">=</span>&nbsp;<span class="ident" id="3957207">data</span><span class="op" id="3957211">[</span><span class="num" id="3957212">2</span><span class="op" id="3957213">:</span><span class="op" id="3957214">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957217">if</span>&nbsp;<span class="ident" id="3957220">extensionsLength</span>&nbsp;<span class="op" id="3957237">!=</span>&nbsp;<span class="builtinfunc" id="3957240">len</span><span class="op" id="3957243">(</span><span class="ident" id="3957244">data</span><span class="op" id="3957248">)</span>&nbsp;<span class="op" id="3957250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957254">return</span>&nbsp;<span class="ident" id="3957261">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957272">for</span>&nbsp;<span class="builtinfunc" id="3957276">len</span><span class="op" id="3957279">(</span><span class="ident" id="3957280">data</span><span class="op" id="3957284">)</span>&nbsp;<span class="op" id="3957286">!=</span>&nbsp;<span class="num" id="3957289">0</span>&nbsp;<span class="op" id="3957291">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957295">if</span>&nbsp;<span class="builtinfunc" id="3957298">len</span><span class="op" id="3957301">(</span><span class="ident" id="3957302">data</span><span class="op" id="3957306">)</span>&nbsp;<span class="op" id="3957308">&lt;</span>&nbsp;<span class="num" id="3957310">4</span>&nbsp;<span class="op" id="3957312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957317">return</span>&nbsp;<span class="ident" id="3957324">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957336">extension</span>&nbsp;<span class="op" id="3957346">:=</span>&nbsp;<span class="builtintype" id="3957349">uint16</span><span class="op" id="3957355">(</span><span class="ident" id="3957356">data</span><span class="op" id="3957360">[</span><span class="num" id="3957361">0</span><span class="op" id="3957362">]</span><span class="op" id="3957363">)</span><span class="op" id="3957364">&lt;&lt;</span><span class="num" id="3957366">8</span>&nbsp;<span class="op" id="3957368">|</span>&nbsp;<span class="builtintype" id="3957370">uint16</span><span class="op" id="3957376">(</span><span class="ident" id="3957377">data</span><span class="op" id="3957381">[</span><span class="num" id="3957382">1</span><span class="op" id="3957383">]</span><span class="op" id="3957384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957388">length</span>&nbsp;<span class="op" id="3957395">:=</span>&nbsp;<span class="builtintype" id="3957398">int</span><span class="op" id="3957401">(</span><span class="ident" id="3957402">data</span><span class="op" id="3957406">[</span><span class="num" id="3957407">2</span><span class="op" id="3957408">]</span><span class="op" id="3957409">)</span><span class="op" id="3957410">&lt;&lt;</span><span class="num" id="3957412">8</span>&nbsp;<span class="op" id="3957414">|</span>&nbsp;<span class="builtintype" id="3957416">int</span><span class="op" id="3957419">(</span><span class="ident" id="3957420">data</span><span class="op" id="3957424">[</span><span class="num" id="3957425">3</span><span class="op" id="3957426">]</span><span class="op" id="3957427">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957431">data</span>&nbsp;<span class="op" id="3957436">=</span>&nbsp;<span class="ident" id="3957438">data</span><span class="op" id="3957442">[</span><span class="num" id="3957443">4</span><span class="op" id="3957444">:</span><span class="op" id="3957445">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957449">if</span>&nbsp;<span class="builtinfunc" id="3957452">len</span><span class="op" id="3957455">(</span><span class="ident" id="3957456">data</span><span class="op" id="3957460">)</span>&nbsp;<span class="op" id="3957462">&lt;</span>&nbsp;<span class="ident" id="3957464">length</span>&nbsp;<span class="op" id="3957471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957476">return</span>&nbsp;<span class="ident" id="3957483">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957496">switch</span>&nbsp;<span class="ident" id="3957503">extension</span>&nbsp;<span class="op" id="3957513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957517">case</span>&nbsp;<span class="ident" id="3957522">extensionServerName</span><span class="op" id="3957541">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957546">if</span>&nbsp;<span class="ident" id="3957549">length</span>&nbsp;<span class="op" id="3957556">&lt;</span>&nbsp;<span class="num" id="3957558">2</span>&nbsp;<span class="op" id="3957560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957566">return</span>&nbsp;<span class="ident" id="3957573">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957582">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957587">numNames</span>&nbsp;<span class="op" id="3957596">:=</span>&nbsp;<span class="builtintype" id="3957599">int</span><span class="op" id="3957602">(</span><span class="ident" id="3957603">data</span><span class="op" id="3957607">[</span><span class="num" id="3957608">0</span><span class="op" id="3957609">]</span><span class="op" id="3957610">)</span><span class="op" id="3957611">&lt;&lt;</span><span class="num" id="3957613">8</span>&nbsp;<span class="op" id="3957615">|</span>&nbsp;<span class="builtintype" id="3957617">int</span><span class="op" id="3957620">(</span><span class="ident" id="3957621">data</span><span class="op" id="3957625">[</span><span class="num" id="3957626">1</span><span class="op" id="3957627">]</span><span class="op" id="3957628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957633">d</span>&nbsp;<span class="op" id="3957635">:=</span>&nbsp;<span class="ident" id="3957638">data</span><span class="op" id="3957642">[</span><span class="num" id="3957643">2</span><span class="op" id="3957644">:</span><span class="op" id="3957645">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957650">for</span>&nbsp;<span class="ident" id="3957654">i</span>&nbsp;<span class="op" id="3957656">:=</span>&nbsp;<span class="num" id="3957659">0</span><span class="op" id="3957660">;</span>&nbsp;<span class="ident" id="3957662">i</span>&nbsp;<span class="op" id="3957664">&lt;</span>&nbsp;<span class="ident" id="3957666">numNames</span><span class="op" id="3957674">;</span>&nbsp;<span class="ident" id="3957676">i</span><span class="op" id="3957677">++</span>&nbsp;<span class="op" id="3957680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957686">if</span>&nbsp;<span class="builtinfunc" id="3957689">len</span><span class="op" id="3957692">(</span><span class="ident" id="3957693">d</span><span class="op" id="3957694">)</span>&nbsp;<span class="op" id="3957696">&lt;</span>&nbsp;<span class="num" id="3957698">3</span>&nbsp;<span class="op" id="3957700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957707">return</span>&nbsp;<span class="ident" id="3957714">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957730">nameType</span>&nbsp;<span class="op" id="3957739">:=</span>&nbsp;<span class="ident" id="3957742">d</span><span class="op" id="3957743">[</span><span class="num" id="3957744">0</span><span class="op" id="3957745">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957751">nameLen</span>&nbsp;<span class="op" id="3957759">:=</span>&nbsp;<span class="builtintype" id="3957762">int</span><span class="op" id="3957765">(</span><span class="ident" id="3957766">d</span><span class="op" id="3957767">[</span><span class="num" id="3957768">1</span><span class="op" id="3957769">]</span><span class="op" id="3957770">)</span><span class="op" id="3957771">&lt;&lt;</span><span class="num" id="3957773">8</span>&nbsp;<span class="op" id="3957775">|</span>&nbsp;<span class="builtintype" id="3957777">int</span><span class="op" id="3957780">(</span><span class="ident" id="3957781">d</span><span class="op" id="3957782">[</span><span class="num" id="3957783">2</span><span class="op" id="3957784">]</span><span class="op" id="3957785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957791">d</span>&nbsp;<span class="op" id="3957793">=</span>&nbsp;<span class="ident" id="3957795">d</span><span class="op" id="3957796">[</span><span class="num" id="3957797">3</span><span class="op" id="3957798">:</span><span class="op" id="3957799">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957805">if</span>&nbsp;<span class="builtinfunc" id="3957808">len</span><span class="op" id="3957811">(</span><span class="ident" id="3957812">d</span><span class="op" id="3957813">)</span>&nbsp;<span class="op" id="3957815">&lt;</span>&nbsp;<span class="ident" id="3957817">nameLen</span>&nbsp;<span class="op" id="3957825">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957832">return</span>&nbsp;<span class="ident" id="3957839">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957855">if</span>&nbsp;<span class="ident" id="3957858">nameType</span>&nbsp;<span class="op" id="3957867">==</span>&nbsp;<span class="num" id="3957870">0</span>&nbsp;<span class="op" id="3957872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957879">m</span><span class="op" id="3957880">.</span><span class="ident" id="3957881">serverName</span>&nbsp;<span class="op" id="3957892">=</span>&nbsp;<span class="builtintype" id="3957894">string</span><span class="op" id="3957900">(</span><span class="ident" id="3957901">d</span><span class="op" id="3957902">[</span><span class="num" id="3957903">0</span><span class="op" id="3957904">:</span><span class="ident" id="3957905">nameLen</span><span class="op" id="3957912">]</span><span class="op" id="3957913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957920">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957936">d</span>&nbsp;<span class="op" id="3957938">=</span>&nbsp;<span class="ident" id="3957940">d</span><span class="op" id="3957941">[</span><span class="ident" id="3957942">nameLen</span><span class="op" id="3957949">:</span><span class="op" id="3957950">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957959">case</span>&nbsp;<span class="ident" id="3957964">extensionNextProtoNeg</span><span class="op" id="3957985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957990">if</span>&nbsp;<span class="ident" id="3957993">length</span>&nbsp;<span class="op" id="3958000">&gt;</span>&nbsp;<span class="num" id="3958002">0</span>&nbsp;<span class="op" id="3958004">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958010">return</span>&nbsp;<span class="ident" id="3958017">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958031">m</span><span class="op" id="3958032">.</span><span class="ident" id="3958033">nextProtoNeg</span>&nbsp;<span class="op" id="3958046">=</span>&nbsp;<span class="ident" id="3958048">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958055">case</span>&nbsp;<span class="ident" id="3958060">extensionStatusRequest</span><span class="op" id="3958082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958087">m</span><span class="op" id="3958088">.</span><span class="ident" id="3958089">ocspStapling</span>&nbsp;<span class="op" id="3958102">=</span>&nbsp;<span class="ident" id="3958104">length</span>&nbsp;<span class="op" id="3958111">&gt;</span>&nbsp;<span class="num" id="3958113">0</span>&nbsp;<span class="op" id="3958115">&amp;&amp;</span>&nbsp;<span class="ident" id="3958118">data</span><span class="op" id="3958122">[</span><span class="num" id="3958123">0</span><span class="op" id="3958124">]</span>&nbsp;<span class="op" id="3958126">==</span>&nbsp;<span class="ident" id="3958129">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958146">case</span>&nbsp;<span class="ident" id="3958151">extensionSupportedCurves</span><span class="op" id="3958175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3958180">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958235">if</span>&nbsp;<span class="ident" id="3958238">length</span>&nbsp;<span class="op" id="3958245">&lt;</span>&nbsp;<span class="num" id="3958247">2</span>&nbsp;<span class="op" id="3958249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958255">return</span>&nbsp;<span class="ident" id="3958262">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958271">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958276">l</span>&nbsp;<span class="op" id="3958278">:=</span>&nbsp;<span class="builtintype" id="3958281">int</span><span class="op" id="3958284">(</span><span class="ident" id="3958285">data</span><span class="op" id="3958289">[</span><span class="num" id="3958290">0</span><span class="op" id="3958291">]</span><span class="op" id="3958292">)</span><span class="op" id="3958293">&lt;&lt;</span><span class="num" id="3958295">8</span>&nbsp;<span class="op" id="3958297">|</span>&nbsp;<span class="builtintype" id="3958299">int</span><span class="op" id="3958302">(</span><span class="ident" id="3958303">data</span><span class="op" id="3958307">[</span><span class="num" id="3958308">1</span><span class="op" id="3958309">]</span><span class="op" id="3958310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958315">if</span>&nbsp;<span class="ident" id="3958318">l</span><span class="op" id="3958319">%</span><span class="num" id="3958320">2</span>&nbsp;<span class="op" id="3958322">==</span>&nbsp;<span class="num" id="3958325">1</span>&nbsp;<span class="op" id="3958327">||</span>&nbsp;<span class="ident" id="3958330">length</span>&nbsp;<span class="op" id="3958337">!=</span>&nbsp;<span class="ident" id="3958340">l</span><span class="op" id="3958341">+</span><span class="num" id="3958342">2</span>&nbsp;<span class="op" id="3958344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958350">return</span>&nbsp;<span class="ident" id="3958357">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958371">numCurves</span>&nbsp;<span class="op" id="3958381">:=</span>&nbsp;<span class="ident" id="3958384">l</span>&nbsp;<span class="op" id="3958386">/</span>&nbsp;<span class="num" id="3958388">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958393">m</span><span class="op" id="3958394">.</span><span class="ident" id="3958395">supportedCurves</span>&nbsp;<span class="op" id="3958411">=</span>&nbsp;<span class="builtinfunc" id="3958413">make</span><span class="op" id="3958417">(</span><span class="op" id="3958418">[</span><span class="op" id="3958419">]</span><span class="ident" id="3958420">CurveID</span><span class="op" id="3958427">,</span>&nbsp;<span class="ident" id="3958429">numCurves</span><span class="op" id="3958438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958443">d</span>&nbsp;<span class="op" id="3958445">:=</span>&nbsp;<span class="ident" id="3958448">data</span><span class="op" id="3958452">[</span><span class="num" id="3958453">2</span><span class="op" id="3958454">:</span><span class="op" id="3958455">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958460">for</span>&nbsp;<span class="ident" id="3958464">i</span>&nbsp;<span class="op" id="3958466">:=</span>&nbsp;<span class="num" id="3958469">0</span><span class="op" id="3958470">;</span>&nbsp;<span class="ident" id="3958472">i</span>&nbsp;<span class="op" id="3958474">&lt;</span>&nbsp;<span class="ident" id="3958476">numCurves</span><span class="op" id="3958485">;</span>&nbsp;<span class="ident" id="3958487">i</span><span class="op" id="3958488">++</span>&nbsp;<span class="op" id="3958491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958497">m</span><span class="op" id="3958498">.</span><span class="ident" id="3958499">supportedCurves</span><span class="op" id="3958514">[</span><span class="ident" id="3958515">i</span><span class="op" id="3958516">]</span>&nbsp;<span class="op" id="3958518">=</span>&nbsp;<span class="ident" id="3958520">CurveID</span><span class="op" id="3958527">(</span><span class="ident" id="3958528">d</span><span class="op" id="3958529">[</span><span class="num" id="3958530">0</span><span class="op" id="3958531">]</span><span class="op" id="3958532">)</span><span class="op" id="3958533">&lt;&lt;</span><span class="num" id="3958535">8</span>&nbsp;<span class="op" id="3958537">|</span>&nbsp;<span class="ident" id="3958539">CurveID</span><span class="op" id="3958546">(</span><span class="ident" id="3958547">d</span><span class="op" id="3958548">[</span><span class="num" id="3958549">1</span><span class="op" id="3958550">]</span><span class="op" id="3958551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958557">d</span>&nbsp;<span class="op" id="3958559">=</span>&nbsp;<span class="ident" id="3958561">d</span><span class="op" id="3958562">[</span><span class="num" id="3958563">2</span><span class="op" id="3958564">:</span><span class="op" id="3958565">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958574">case</span>&nbsp;<span class="ident" id="3958579">extensionSupportedPoints</span><span class="op" id="3958603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3958608">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958663">if</span>&nbsp;<span class="ident" id="3958666">length</span>&nbsp;<span class="op" id="3958673">&lt;</span>&nbsp;<span class="num" id="3958675">1</span>&nbsp;<span class="op" id="3958677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958683">return</span>&nbsp;<span class="ident" id="3958690">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958704">l</span>&nbsp;<span class="op" id="3958706">:=</span>&nbsp;<span class="builtintype" id="3958709">int</span><span class="op" id="3958712">(</span><span class="ident" id="3958713">data</span><span class="op" id="3958717">[</span><span class="num" id="3958718">0</span><span class="op" id="3958719">]</span><span class="op" id="3958720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958725">if</span>&nbsp;<span class="ident" id="3958728">length</span>&nbsp;<span class="op" id="3958735">!=</span>&nbsp;<span class="ident" id="3958738">l</span><span class="op" id="3958739">+</span><span class="num" id="3958740">1</span>&nbsp;<span class="op" id="3958742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958748">return</span>&nbsp;<span class="ident" id="3958755">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958764">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958769">m</span><span class="op" id="3958770">.</span><span class="ident" id="3958771">supportedPoints</span>&nbsp;<span class="op" id="3958787">=</span>&nbsp;<span class="builtinfunc" id="3958789">make</span><span class="op" id="3958793">(</span><span class="op" id="3958794">[</span><span class="op" id="3958795">]</span><span class="builtintype" id="3958796">uint8</span><span class="op" id="3958801">,</span>&nbsp;<span class="ident" id="3958803">l</span><span class="op" id="3958804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3958809">copy</span><span class="op" id="3958813">(</span><span class="ident" id="3958814">m</span><span class="op" id="3958815">.</span><span class="ident" id="3958816">supportedPoints</span><span class="op" id="3958831">,</span>&nbsp;<span class="ident" id="3958833">data</span><span class="op" id="3958837">[</span><span class="num" id="3958838">1</span><span class="op" id="3958839">:</span><span class="op" id="3958840">]</span><span class="op" id="3958841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958845">case</span>&nbsp;<span class="ident" id="3958850">extensionSessionTicket</span><span class="op" id="3958872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3958877">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958930">m</span><span class="op" id="3958931">.</span><span class="ident" id="3958932">ticketSupported</span>&nbsp;<span class="op" id="3958948">=</span>&nbsp;<span class="ident" id="3958950">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958958">m</span><span class="op" id="3958959">.</span><span class="ident" id="3958960">sessionTicket</span>&nbsp;<span class="op" id="3958974">=</span>&nbsp;<span class="ident" id="3958976">data</span><span class="op" id="3958980">[</span><span class="op" id="3958981">:</span><span class="ident" id="3958982">length</span><span class="op" id="3958988">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958992">case</span>&nbsp;<span class="ident" id="3958997">extensionSignatureAlgorithms</span><span class="op" id="3959025">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3959030">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959090">if</span>&nbsp;<span class="ident" id="3959093">length</span>&nbsp;<span class="op" id="3959100">&lt;</span>&nbsp;<span class="num" id="3959102">2</span>&nbsp;<span class="op" id="3959104">||</span>&nbsp;<span class="ident" id="3959107">length</span><span class="op" id="3959113">&amp;</span><span class="num" id="3959114">1</span>&nbsp;<span class="op" id="3959116">!=</span>&nbsp;<span class="num" id="3959119">0</span>&nbsp;<span class="op" id="3959121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959127">return</span>&nbsp;<span class="ident" id="3959134">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959148">l</span>&nbsp;<span class="op" id="3959150">:=</span>&nbsp;<span class="builtintype" id="3959153">int</span><span class="op" id="3959156">(</span><span class="ident" id="3959157">data</span><span class="op" id="3959161">[</span><span class="num" id="3959162">0</span><span class="op" id="3959163">]</span><span class="op" id="3959164">)</span><span class="op" id="3959165">&lt;&lt;</span><span class="num" id="3959167">8</span>&nbsp;<span class="op" id="3959169">|</span>&nbsp;<span class="builtintype" id="3959171">int</span><span class="op" id="3959174">(</span><span class="ident" id="3959175">data</span><span class="op" id="3959179">[</span><span class="num" id="3959180">1</span><span class="op" id="3959181">]</span><span class="op" id="3959182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959187">if</span>&nbsp;<span class="ident" id="3959190">l</span>&nbsp;<span class="op" id="3959192">!=</span>&nbsp;<span class="ident" id="3959195">length</span><span class="op" id="3959201">-</span><span class="num" id="3959202">2</span>&nbsp;<span class="op" id="3959204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959210">return</span>&nbsp;<span class="ident" id="3959217">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959226">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959231">n</span>&nbsp;<span class="op" id="3959233">:=</span>&nbsp;<span class="ident" id="3959236">l</span>&nbsp;<span class="op" id="3959238">/</span>&nbsp;<span class="num" id="3959240">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959245">d</span>&nbsp;<span class="op" id="3959247">:=</span>&nbsp;<span class="ident" id="3959250">data</span><span class="op" id="3959254">[</span><span class="num" id="3959255">2</span><span class="op" id="3959256">:</span><span class="op" id="3959257">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959262">m</span><span class="op" id="3959263">.</span><span class="ident" id="3959264">signatureAndHashes</span>&nbsp;<span class="op" id="3959283">=</span>&nbsp;<span class="builtinfunc" id="3959285">make</span><span class="op" id="3959289">(</span><span class="op" id="3959290">[</span><span class="op" id="3959291">]</span><span class="ident" id="3959292">signatureAndHash</span><span class="op" id="3959308">,</span>&nbsp;<span class="ident" id="3959310">n</span><span class="op" id="3959311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959316">for</span>&nbsp;<span class="ident" id="3959320">i</span>&nbsp;<span class="op" id="3959322">:=</span>&nbsp;<span class="keyword" id="3959325">range</span>&nbsp;<span class="ident" id="3959331">m</span><span class="op" id="3959332">.</span><span class="ident" id="3959333">signatureAndHashes</span>&nbsp;<span class="op" id="3959352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959358">m</span><span class="op" id="3959359">.</span><span class="ident" id="3959360">signatureAndHashes</span><span class="op" id="3959378">[</span><span class="ident" id="3959379">i</span><span class="op" id="3959380">]</span><span class="op" id="3959381">.</span><span class="ident" id="3959382">hash</span>&nbsp;<span class="op" id="3959387">=</span>&nbsp;<span class="ident" id="3959389">d</span><span class="op" id="3959390">[</span><span class="num" id="3959391">0</span><span class="op" id="3959392">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959398">m</span><span class="op" id="3959399">.</span><span class="ident" id="3959400">signatureAndHashes</span><span class="op" id="3959418">[</span><span class="ident" id="3959419">i</span><span class="op" id="3959420">]</span><span class="op" id="3959421">.</span><span class="ident" id="3959422">signature</span>&nbsp;<span class="op" id="3959432">=</span>&nbsp;<span class="ident" id="3959434">d</span><span class="op" id="3959435">[</span><span class="num" id="3959436">1</span><span class="op" id="3959437">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959443">d</span>&nbsp;<span class="op" id="3959445">=</span>&nbsp;<span class="ident" id="3959447">d</span><span class="op" id="3959448">[</span><span class="num" id="3959449">2</span><span class="op" id="3959450">:</span><span class="op" id="3959451">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959460">case</span>&nbsp;<span class="ident" id="3959465">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3959492">+</span>&nbsp;<span class="num" id="3959494">1</span><span class="op" id="3959495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959500">if</span>&nbsp;<span class="ident" id="3959503">length</span>&nbsp;<span class="op" id="3959510">!=</span>&nbsp;<span class="num" id="3959513">1</span>&nbsp;<span class="op" id="3959515">||</span>&nbsp;<span class="ident" id="3959518">data</span><span class="op" id="3959522">[</span><span class="num" id="3959523">0</span><span class="op" id="3959524">]</span>&nbsp;<span class="op" id="3959526">!=</span>&nbsp;<span class="num" id="3959529">0</span>&nbsp;<span class="op" id="3959531">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959537">return</span>&nbsp;<span class="ident" id="3959544">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959558">m</span><span class="op" id="3959559">.</span><span class="ident" id="3959560">secureRenegotiation</span>&nbsp;<span class="op" id="3959580">=</span>&nbsp;<span class="ident" id="3959582">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959589">case</span>&nbsp;<span class="ident" id="3959594">extensionALPN</span><span class="op" id="3959607">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959612">if</span>&nbsp;<span class="ident" id="3959615">length</span>&nbsp;<span class="op" id="3959622">&lt;</span>&nbsp;<span class="num" id="3959624">2</span>&nbsp;<span class="op" id="3959626">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959632">return</span>&nbsp;<span class="ident" id="3959639">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959653">l</span>&nbsp;<span class="op" id="3959655">:=</span>&nbsp;<span class="builtintype" id="3959658">int</span><span class="op" id="3959661">(</span><span class="ident" id="3959662">data</span><span class="op" id="3959666">[</span><span class="num" id="3959667">0</span><span class="op" id="3959668">]</span><span class="op" id="3959669">)</span><span class="op" id="3959670">&lt;&lt;</span><span class="num" id="3959672">8</span>&nbsp;<span class="op" id="3959674">|</span>&nbsp;<span class="builtintype" id="3959676">int</span><span class="op" id="3959679">(</span><span class="ident" id="3959680">data</span><span class="op" id="3959684">[</span><span class="num" id="3959685">1</span><span class="op" id="3959686">]</span><span class="op" id="3959687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959692">if</span>&nbsp;<span class="ident" id="3959695">l</span>&nbsp;<span class="op" id="3959697">!=</span>&nbsp;<span class="ident" id="3959700">length</span><span class="op" id="3959706">-</span><span class="num" id="3959707">2</span>&nbsp;<span class="op" id="3959709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959715">return</span>&nbsp;<span class="ident" id="3959722">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959736">d</span>&nbsp;<span class="op" id="3959738">:=</span>&nbsp;<span class="ident" id="3959741">data</span><span class="op" id="3959745">[</span><span class="num" id="3959746">2</span><span class="op" id="3959747">:</span><span class="ident" id="3959748">length</span><span class="op" id="3959754">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959759">for</span>&nbsp;<span class="builtinfunc" id="3959763">len</span><span class="op" id="3959766">(</span><span class="ident" id="3959767">d</span><span class="op" id="3959768">)</span>&nbsp;<span class="op" id="3959770">!=</span>&nbsp;<span class="num" id="3959773">0</span>&nbsp;<span class="op" id="3959775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959781">stringLen</span>&nbsp;<span class="op" id="3959791">:=</span>&nbsp;<span class="builtintype" id="3959794">int</span><span class="op" id="3959797">(</span><span class="ident" id="3959798">d</span><span class="op" id="3959799">[</span><span class="num" id="3959800">0</span><span class="op" id="3959801">]</span><span class="op" id="3959802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959808">d</span>&nbsp;<span class="op" id="3959810">=</span>&nbsp;<span class="ident" id="3959812">d</span><span class="op" id="3959813">[</span><span class="num" id="3959814">1</span><span class="op" id="3959815">:</span><span class="op" id="3959816">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959822">if</span>&nbsp;<span class="ident" id="3959825">stringLen</span>&nbsp;<span class="op" id="3959835">==</span>&nbsp;<span class="num" id="3959838">0</span>&nbsp;<span class="op" id="3959840">||</span>&nbsp;<span class="ident" id="3959843">stringLen</span>&nbsp;<span class="op" id="3959853">&gt;</span>&nbsp;<span class="builtinfunc" id="3959855">len</span><span class="op" id="3959858">(</span><span class="ident" id="3959859">d</span><span class="op" id="3959860">)</span>&nbsp;<span class="op" id="3959862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959869">return</span>&nbsp;<span class="ident" id="3959876">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959892">m</span><span class="op" id="3959893">.</span><span class="ident" id="3959894">alpnProtocols</span>&nbsp;<span class="op" id="3959908">=</span>&nbsp;<span class="builtinfunc" id="3959910">append</span><span class="op" id="3959916">(</span><span class="ident" id="3959917">m</span><span class="op" id="3959918">.</span><span class="ident" id="3959919">alpnProtocols</span><span class="op" id="3959932">,</span>&nbsp;<span class="builtintype" id="3959934">string</span><span class="op" id="3959940">(</span><span class="ident" id="3959941">d</span><span class="op" id="3959942">[</span><span class="op" id="3959943">:</span><span class="ident" id="3959944">stringLen</span><span class="op" id="3959953">]</span><span class="op" id="3959954">)</span><span class="op" id="3959955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959961">d</span>&nbsp;<span class="op" id="3959963">=</span>&nbsp;<span class="ident" id="3959965">d</span><span class="op" id="3959966">[</span><span class="ident" id="3959967">stringLen</span><span class="op" id="3959976">:</span><span class="op" id="3959977">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959990">data</span>&nbsp;<span class="op" id="3959995">=</span>&nbsp;<span class="ident" id="3959997">data</span><span class="op" id="3960001">[</span><span class="ident" id="3960002">length</span><span class="op" id="3960008">:</span><span class="op" id="3960009">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960016">return</span>&nbsp;<span class="ident" id="3960023">true</span><br>
<span class="lineno"></span><span class="op" id="3960028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3960031">type</span>&nbsp;<span class="ident" id="3960036">serverHelloMsg</span>&nbsp;<span class="keyword" id="3960051">struct</span>&nbsp;<span class="op" id="3960058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960061">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3960081">[</span><span class="op" id="3960082">]</span><span class="builtintype" id="3960083">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960089">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3960109">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960117">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3960137">[</span><span class="op" id="3960138">]</span><span class="builtintype" id="3960139">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960145">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3960165">[</span><span class="op" id="3960166">]</span><span class="builtintype" id="3960167">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960173">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3960193">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960201">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3960221">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960228">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3960248">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960254">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3960274">[</span><span class="op" id="3960275">]</span><span class="builtintype" id="3960276">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960284">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3960304">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960310">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3960330">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960336">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3960356">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960362">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3960382">string</span><br>
<span class="lineno"></span><span class="op" id="3960389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3960392">func</span>&nbsp;<span class="op" id="3960397">(</span><span class="ident" id="3960398">m</span>&nbsp;<span class="op" id="3960400">*</span><span class="ident" id="3960401">serverHelloMsg</span><span class="op" id="3960415">)</span>&nbsp;<span class="ident" id="3960417">equal</span><span class="op" id="3960422">(</span><span class="ident" id="3960423">i</span>&nbsp;<span class="keyword" id="3960425">interface</span><span class="op" id="3960434">{</span><span class="op" id="3960435">}</span><span class="op" id="3960436">)</span>&nbsp;<span class="builtintype" id="3960438">bool</span>&nbsp;<span class="op" id="3960443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960446">m1</span><span class="op" id="3960448">,</span>&nbsp;<span class="ident" id="3960450">ok</span>&nbsp;<span class="op" id="3960453">:=</span>&nbsp;<span class="ident" id="3960456">i</span><span class="op" id="3960457">.</span><span class="op" id="3960458">(</span><span class="op" id="3960459">*</span><span class="ident" id="3960460">serverHelloMsg</span><span class="op" id="3960474">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960477">if</span>&nbsp;<span class="op" id="3960480">!</span><span class="ident" id="3960481">ok</span>&nbsp;<span class="op" id="3960484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960488">return</span>&nbsp;<span class="ident" id="3960495">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960506">return</span>&nbsp;<span class="ident" id="3960513">bytes</span><span class="op" id="3960518">.</span><span class="ident" id="3960519">Equal</span><span class="op" id="3960524">(</span><span class="ident" id="3960525">m</span><span class="op" id="3960526">.</span><span class="ident" id="3960527">raw</span><span class="op" id="3960530">,</span>&nbsp;<span class="ident" id="3960532">m1</span><span class="op" id="3960534">.</span><span class="ident" id="3960535">raw</span><span class="op" id="3960538">)</span>&nbsp;<span class="op" id="3960540">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960545">m</span><span class="op" id="3960546">.</span><span class="ident" id="3960547">vers</span>&nbsp;<span class="op" id="3960552">==</span>&nbsp;<span class="ident" id="3960555">m1</span><span class="op" id="3960557">.</span><span class="ident" id="3960558">vers</span>&nbsp;<span class="op" id="3960563">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960568">bytes</span><span class="op" id="3960573">.</span><span class="ident" id="3960574">Equal</span><span class="op" id="3960579">(</span><span class="ident" id="3960580">m</span><span class="op" id="3960581">.</span><span class="ident" id="3960582">random</span><span class="op" id="3960588">,</span>&nbsp;<span class="ident" id="3960590">m1</span><span class="op" id="3960592">.</span><span class="ident" id="3960593">random</span><span class="op" id="3960599">)</span>&nbsp;<span class="op" id="3960601">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960606">bytes</span><span class="op" id="3960611">.</span><span class="ident" id="3960612">Equal</span><span class="op" id="3960617">(</span><span class="ident" id="3960618">m</span><span class="op" id="3960619">.</span><span class="ident" id="3960620">sessionId</span><span class="op" id="3960629">,</span>&nbsp;<span class="ident" id="3960631">m1</span><span class="op" id="3960633">.</span><span class="ident" id="3960634">sessionId</span><span class="op" id="3960643">)</span>&nbsp;<span class="op" id="3960645">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960650">m</span><span class="op" id="3960651">.</span><span class="ident" id="3960652">cipherSuite</span>&nbsp;<span class="op" id="3960664">==</span>&nbsp;<span class="ident" id="3960667">m1</span><span class="op" id="3960669">.</span><span class="ident" id="3960670">cipherSuite</span>&nbsp;<span class="op" id="3960682">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960687">m</span><span class="op" id="3960688">.</span><span class="ident" id="3960689">compressionMethod</span>&nbsp;<span class="op" id="3960707">==</span>&nbsp;<span class="ident" id="3960710">m1</span><span class="op" id="3960712">.</span><span class="ident" id="3960713">compressionMethod</span>&nbsp;<span class="op" id="3960731">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960736">m</span><span class="op" id="3960737">.</span><span class="ident" id="3960738">nextProtoNeg</span>&nbsp;<span class="op" id="3960751">==</span>&nbsp;<span class="ident" id="3960754">m1</span><span class="op" id="3960756">.</span><span class="ident" id="3960757">nextProtoNeg</span>&nbsp;<span class="op" id="3960770">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960775">eqStrings</span><span class="op" id="3960784">(</span><span class="ident" id="3960785">m</span><span class="op" id="3960786">.</span><span class="ident" id="3960787">nextProtos</span><span class="op" id="3960797">,</span>&nbsp;<span class="ident" id="3960799">m1</span><span class="op" id="3960801">.</span><span class="ident" id="3960802">nextProtos</span><span class="op" id="3960812">)</span>&nbsp;<span class="op" id="3960814">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960819">m</span><span class="op" id="3960820">.</span><span class="ident" id="3960821">ocspStapling</span>&nbsp;<span class="op" id="3960834">==</span>&nbsp;<span class="ident" id="3960837">m1</span><span class="op" id="3960839">.</span><span class="ident" id="3960840">ocspStapling</span>&nbsp;<span class="op" id="3960853">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960858">m</span><span class="op" id="3960859">.</span><span class="ident" id="3960860">ticketSupported</span>&nbsp;<span class="op" id="3960876">==</span>&nbsp;<span class="ident" id="3960879">m1</span><span class="op" id="3960881">.</span><span class="ident" id="3960882">ticketSupported</span>&nbsp;<span class="op" id="3960898">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960903">m</span><span class="op" id="3960904">.</span><span class="ident" id="3960905">secureRenegotiation</span>&nbsp;<span class="op" id="3960925">==</span>&nbsp;<span class="ident" id="3960928">m1</span><span class="op" id="3960930">.</span><span class="ident" id="3960931">secureRenegotiation</span>&nbsp;<span class="op" id="3960951">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960956">m</span><span class="op" id="3960957">.</span><span class="ident" id="3960958">alpnProtocol</span>&nbsp;<span class="op" id="3960971">==</span>&nbsp;<span class="ident" id="3960974">m1</span><span class="op" id="3960976">.</span><span class="ident" id="3960977">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="3960990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3960993">func</span>&nbsp;<span class="op" id="3960998">(</span><span class="ident" id="3960999">m</span>&nbsp;<span class="op" id="3961001">*</span><span class="ident" id="3961002">serverHelloMsg</span><span class="op" id="3961016">)</span>&nbsp;<span class="ident" id="3961018">marshal</span><span class="op" id="3961025">(</span><span class="op" id="3961026">)</span>&nbsp;<span class="op" id="3961028">[</span><span class="op" id="3961029">]</span><span class="builtintype" id="3961030">byte</span>&nbsp;<span class="op" id="3961035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961038">if</span>&nbsp;<span class="ident" id="3961041">m</span><span class="op" id="3961042">.</span><span class="ident" id="3961043">raw</span>&nbsp;<span class="op" id="3961047">!=</span>&nbsp;<span class="ident" id="3961050">nil</span>&nbsp;<span class="op" id="3961054">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961058">return</span>&nbsp;<span class="ident" id="3961065">m</span><span class="op" id="3961066">.</span><span class="ident" id="3961067">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961076">length</span>&nbsp;<span class="op" id="3961083">:=</span>&nbsp;<span class="num" id="3961086">38</span>&nbsp;<span class="op" id="3961089">+</span>&nbsp;<span class="builtinfunc" id="3961091">len</span><span class="op" id="3961094">(</span><span class="ident" id="3961095">m</span><span class="op" id="3961096">.</span><span class="ident" id="3961097">sessionId</span><span class="op" id="3961106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961109">numExtensions</span>&nbsp;<span class="op" id="3961123">:=</span>&nbsp;<span class="num" id="3961126">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961129">extensionsLength</span>&nbsp;<span class="op" id="3961146">:=</span>&nbsp;<span class="num" id="3961149">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961153">nextProtoLen</span>&nbsp;<span class="op" id="3961166">:=</span>&nbsp;<span class="num" id="3961169">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961172">if</span>&nbsp;<span class="ident" id="3961175">m</span><span class="op" id="3961176">.</span><span class="ident" id="3961177">nextProtoNeg</span>&nbsp;<span class="op" id="3961190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961194">numExtensions</span><span class="op" id="3961207">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961212">for</span>&nbsp;<span class="ident" id="3961216">_</span><span class="op" id="3961217">,</span>&nbsp;<span class="ident" id="3961219">v</span>&nbsp;<span class="op" id="3961221">:=</span>&nbsp;<span class="keyword" id="3961224">range</span>&nbsp;<span class="ident" id="3961230">m</span><span class="op" id="3961231">.</span><span class="ident" id="3961232">nextProtos</span>&nbsp;<span class="op" id="3961243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961248">nextProtoLen</span>&nbsp;<span class="op" id="3961261">+=</span>&nbsp;<span class="builtinfunc" id="3961264">len</span><span class="op" id="3961267">(</span><span class="ident" id="3961268">v</span><span class="op" id="3961269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961277">nextProtoLen</span>&nbsp;<span class="op" id="3961290">+=</span>&nbsp;<span class="builtinfunc" id="3961293">len</span><span class="op" id="3961296">(</span><span class="ident" id="3961297">m</span><span class="op" id="3961298">.</span><span class="ident" id="3961299">nextProtos</span><span class="op" id="3961309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961313">extensionsLength</span>&nbsp;<span class="op" id="3961330">+=</span>&nbsp;<span class="ident" id="3961333">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961350">if</span>&nbsp;<span class="ident" id="3961353">m</span><span class="op" id="3961354">.</span><span class="ident" id="3961355">ocspStapling</span>&nbsp;<span class="op" id="3961368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961372">numExtensions</span><span class="op" id="3961385">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961392">if</span>&nbsp;<span class="ident" id="3961395">m</span><span class="op" id="3961396">.</span><span class="ident" id="3961397">ticketSupported</span>&nbsp;<span class="op" id="3961413">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961417">numExtensions</span><span class="op" id="3961430">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961437">if</span>&nbsp;<span class="ident" id="3961440">m</span><span class="op" id="3961441">.</span><span class="ident" id="3961442">secureRenegotiation</span>&nbsp;<span class="op" id="3961462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961466">extensionsLength</span>&nbsp;<span class="op" id="3961483">+=</span>&nbsp;<span class="num" id="3961486">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961490">numExtensions</span><span class="op" id="3961503">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961510">if</span>&nbsp;<span class="ident" id="3961513">alpnLen</span>&nbsp;<span class="op" id="3961521">:=</span>&nbsp;<span class="builtinfunc" id="3961524">len</span><span class="op" id="3961527">(</span><span class="ident" id="3961528">m</span><span class="op" id="3961529">.</span><span class="ident" id="3961530">alpnProtocol</span><span class="op" id="3961542">)</span><span class="op" id="3961543">;</span>&nbsp;<span class="ident" id="3961545">alpnLen</span>&nbsp;<span class="op" id="3961553">&gt;</span>&nbsp;<span class="num" id="3961555">0</span>&nbsp;<span class="op" id="3961557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961561">if</span>&nbsp;<span class="ident" id="3961564">alpnLen</span>&nbsp;<span class="op" id="3961572">&gt;=</span>&nbsp;<span class="num" id="3961575">256</span>&nbsp;<span class="op" id="3961579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3961584">panic</span><span class="op" id="3961589">(</span><span class="string" id="3961590">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3961613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961617">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961621">extensionsLength</span>&nbsp;<span class="op" id="3961638">+=</span>&nbsp;<span class="num" id="3961641">2</span>&nbsp;<span class="op" id="3961643">+</span>&nbsp;<span class="num" id="3961645">1</span>&nbsp;<span class="op" id="3961647">+</span>&nbsp;<span class="ident" id="3961649">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961659">numExtensions</span><span class="op" id="3961672">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961680">if</span>&nbsp;<span class="ident" id="3961683">numExtensions</span>&nbsp;<span class="op" id="3961697">&gt;</span>&nbsp;<span class="num" id="3961699">0</span>&nbsp;<span class="op" id="3961701">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961705">extensionsLength</span>&nbsp;<span class="op" id="3961722">+=</span>&nbsp;<span class="num" id="3961725">4</span>&nbsp;<span class="op" id="3961727">*</span>&nbsp;<span class="ident" id="3961729">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961745">length</span>&nbsp;<span class="op" id="3961752">+=</span>&nbsp;<span class="num" id="3961755">2</span>&nbsp;<span class="op" id="3961757">+</span>&nbsp;<span class="ident" id="3961759">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961781">x</span>&nbsp;<span class="op" id="3961783">:=</span>&nbsp;<span class="builtinfunc" id="3961786">make</span><span class="op" id="3961790">(</span><span class="op" id="3961791">[</span><span class="op" id="3961792">]</span><span class="builtintype" id="3961793">byte</span><span class="op" id="3961797">,</span>&nbsp;<span class="num" id="3961799">4</span><span class="op" id="3961800">+</span><span class="ident" id="3961801">length</span><span class="op" id="3961807">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961810">x</span><span class="op" id="3961811">[</span><span class="num" id="3961812">0</span><span class="op" id="3961813">]</span>&nbsp;<span class="op" id="3961815">=</span>&nbsp;<span class="ident" id="3961817">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961834">x</span><span class="op" id="3961835">[</span><span class="num" id="3961836">1</span><span class="op" id="3961837">]</span>&nbsp;<span class="op" id="3961839">=</span>&nbsp;<span class="builtintype" id="3961841">uint8</span><span class="op" id="3961846">(</span><span class="ident" id="3961847">length</span>&nbsp;<span class="op" id="3961854">&gt;&gt;</span>&nbsp;<span class="num" id="3961857">16</span><span class="op" id="3961859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961862">x</span><span class="op" id="3961863">[</span><span class="num" id="3961864">2</span><span class="op" id="3961865">]</span>&nbsp;<span class="op" id="3961867">=</span>&nbsp;<span class="builtintype" id="3961869">uint8</span><span class="op" id="3961874">(</span><span class="ident" id="3961875">length</span>&nbsp;<span class="op" id="3961882">&gt;&gt;</span>&nbsp;<span class="num" id="3961885">8</span><span class="op" id="3961886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961889">x</span><span class="op" id="3961890">[</span><span class="num" id="3961891">3</span><span class="op" id="3961892">]</span>&nbsp;<span class="op" id="3961894">=</span>&nbsp;<span class="builtintype" id="3961896">uint8</span><span class="op" id="3961901">(</span><span class="ident" id="3961902">length</span><span class="op" id="3961908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961911">x</span><span class="op" id="3961912">[</span><span class="num" id="3961913">4</span><span class="op" id="3961914">]</span>&nbsp;<span class="op" id="3961916">=</span>&nbsp;<span class="builtintype" id="3961918">uint8</span><span class="op" id="3961923">(</span><span class="ident" id="3961924">m</span><span class="op" id="3961925">.</span><span class="ident" id="3961926">vers</span>&nbsp;<span class="op" id="3961931">&gt;&gt;</span>&nbsp;<span class="num" id="3961934">8</span><span class="op" id="3961935">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961938">x</span><span class="op" id="3961939">[</span><span class="num" id="3961940">5</span><span class="op" id="3961941">]</span>&nbsp;<span class="op" id="3961943">=</span>&nbsp;<span class="builtintype" id="3961945">uint8</span><span class="op" id="3961950">(</span><span class="ident" id="3961951">m</span><span class="op" id="3961952">.</span><span class="ident" id="3961953">vers</span><span class="op" id="3961957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3961960">copy</span><span class="op" id="3961964">(</span><span class="ident" id="3961965">x</span><span class="op" id="3961966">[</span><span class="num" id="3961967">6</span><span class="op" id="3961968">:</span><span class="num" id="3961969">38</span><span class="op" id="3961971">]</span><span class="op" id="3961972">,</span>&nbsp;<span class="ident" id="3961974">m</span><span class="op" id="3961975">.</span><span class="ident" id="3961976">random</span><span class="op" id="3961982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961985">x</span><span class="op" id="3961986">[</span><span class="num" id="3961987">38</span><span class="op" id="3961989">]</span>&nbsp;<span class="op" id="3961991">=</span>&nbsp;<span class="builtintype" id="3961993">uint8</span><span class="op" id="3961998">(</span><span class="builtinfunc" id="3961999">len</span><span class="op" id="3962002">(</span><span class="ident" id="3962003">m</span><span class="op" id="3962004">.</span><span class="ident" id="3962005">sessionId</span><span class="op" id="3962014">)</span><span class="op" id="3962015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3962018">copy</span><span class="op" id="3962022">(</span><span class="ident" id="3962023">x</span><span class="op" id="3962024">[</span><span class="num" id="3962025">39</span><span class="op" id="3962027">:</span><span class="num" id="3962028">39</span><span class="op" id="3962030">+</span><span class="builtinfunc" id="3962031">len</span><span class="op" id="3962034">(</span><span class="ident" id="3962035">m</span><span class="op" id="3962036">.</span><span class="ident" id="3962037">sessionId</span><span class="op" id="3962046">)</span><span class="op" id="3962047">]</span><span class="op" id="3962048">,</span>&nbsp;<span class="ident" id="3962050">m</span><span class="op" id="3962051">.</span><span class="ident" id="3962052">sessionId</span><span class="op" id="3962061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962064">z</span>&nbsp;<span class="op" id="3962066">:=</span>&nbsp;<span class="ident" id="3962069">x</span><span class="op" id="3962070">[</span><span class="num" id="3962071">39</span><span class="op" id="3962073">+</span><span class="builtinfunc" id="3962074">len</span><span class="op" id="3962077">(</span><span class="ident" id="3962078">m</span><span class="op" id="3962079">.</span><span class="ident" id="3962080">sessionId</span><span class="op" id="3962089">)</span><span class="op" id="3962090">:</span><span class="op" id="3962091">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962094">z</span><span class="op" id="3962095">[</span><span class="num" id="3962096">0</span><span class="op" id="3962097">]</span>&nbsp;<span class="op" id="3962099">=</span>&nbsp;<span class="builtintype" id="3962101">uint8</span><span class="op" id="3962106">(</span><span class="ident" id="3962107">m</span><span class="op" id="3962108">.</span><span class="ident" id="3962109">cipherSuite</span>&nbsp;<span class="op" id="3962121">&gt;&gt;</span>&nbsp;<span class="num" id="3962124">8</span><span class="op" id="3962125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962128">z</span><span class="op" id="3962129">[</span><span class="num" id="3962130">1</span><span class="op" id="3962131">]</span>&nbsp;<span class="op" id="3962133">=</span>&nbsp;<span class="builtintype" id="3962135">uint8</span><span class="op" id="3962140">(</span><span class="ident" id="3962141">m</span><span class="op" id="3962142">.</span><span class="ident" id="3962143">cipherSuite</span><span class="op" id="3962154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962157">z</span><span class="op" id="3962158">[</span><span class="num" id="3962159">2</span><span class="op" id="3962160">]</span>&nbsp;<span class="op" id="3962162">=</span>&nbsp;<span class="builtintype" id="3962164">uint8</span><span class="op" id="3962169">(</span><span class="ident" id="3962170">m</span><span class="op" id="3962171">.</span><span class="ident" id="3962172">compressionMethod</span><span class="op" id="3962189">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962193">z</span>&nbsp;<span class="op" id="3962195">=</span>&nbsp;<span class="ident" id="3962197">z</span><span class="op" id="3962198">[</span><span class="num" id="3962199">3</span><span class="op" id="3962200">:</span><span class="op" id="3962201">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962204">if</span>&nbsp;<span class="ident" id="3962207">numExtensions</span>&nbsp;<span class="op" id="3962221">&gt;</span>&nbsp;<span class="num" id="3962223">0</span>&nbsp;<span class="op" id="3962225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962229">z</span><span class="op" id="3962230">[</span><span class="num" id="3962231">0</span><span class="op" id="3962232">]</span>&nbsp;<span class="op" id="3962234">=</span>&nbsp;<span class="builtintype" id="3962236">byte</span><span class="op" id="3962240">(</span><span class="ident" id="3962241">extensionsLength</span>&nbsp;<span class="op" id="3962258">&gt;&gt;</span>&nbsp;<span class="num" id="3962261">8</span><span class="op" id="3962262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962266">z</span><span class="op" id="3962267">[</span><span class="num" id="3962268">1</span><span class="op" id="3962269">]</span>&nbsp;<span class="op" id="3962271">=</span>&nbsp;<span class="builtintype" id="3962273">byte</span><span class="op" id="3962277">(</span><span class="ident" id="3962278">extensionsLength</span><span class="op" id="3962294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962298">z</span>&nbsp;<span class="op" id="3962300">=</span>&nbsp;<span class="ident" id="3962302">z</span><span class="op" id="3962303">[</span><span class="num" id="3962304">2</span><span class="op" id="3962305">:</span><span class="op" id="3962306">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962309">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962312">if</span>&nbsp;<span class="ident" id="3962315">m</span><span class="op" id="3962316">.</span><span class="ident" id="3962317">nextProtoNeg</span>&nbsp;<span class="op" id="3962330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962334">z</span><span class="op" id="3962335">[</span><span class="num" id="3962336">0</span><span class="op" id="3962337">]</span>&nbsp;<span class="op" id="3962339">=</span>&nbsp;<span class="builtintype" id="3962341">byte</span><span class="op" id="3962345">(</span><span class="ident" id="3962346">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3962368">&gt;&gt;</span>&nbsp;<span class="num" id="3962371">8</span><span class="op" id="3962372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962376">z</span><span class="op" id="3962377">[</span><span class="num" id="3962378">1</span><span class="op" id="3962379">]</span>&nbsp;<span class="op" id="3962381">=</span>&nbsp;<span class="builtintype" id="3962383">byte</span><span class="op" id="3962387">(</span><span class="ident" id="3962388">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3962410">&amp;</span>&nbsp;<span class="num" id="3962412">0xff</span><span class="op" id="3962416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962420">z</span><span class="op" id="3962421">[</span><span class="num" id="3962422">2</span><span class="op" id="3962423">]</span>&nbsp;<span class="op" id="3962425">=</span>&nbsp;<span class="builtintype" id="3962427">byte</span><span class="op" id="3962431">(</span><span class="ident" id="3962432">nextProtoLen</span>&nbsp;<span class="op" id="3962445">&gt;&gt;</span>&nbsp;<span class="num" id="3962448">8</span><span class="op" id="3962449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962453">z</span><span class="op" id="3962454">[</span><span class="num" id="3962455">3</span><span class="op" id="3962456">]</span>&nbsp;<span class="op" id="3962458">=</span>&nbsp;<span class="builtintype" id="3962460">byte</span><span class="op" id="3962464">(</span><span class="ident" id="3962465">nextProtoLen</span><span class="op" id="3962477">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962481">z</span>&nbsp;<span class="op" id="3962483">=</span>&nbsp;<span class="ident" id="3962485">z</span><span class="op" id="3962486">[</span><span class="num" id="3962487">4</span><span class="op" id="3962488">:</span><span class="op" id="3962489">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962494">for</span>&nbsp;<span class="ident" id="3962498">_</span><span class="op" id="3962499">,</span>&nbsp;<span class="ident" id="3962501">v</span>&nbsp;<span class="op" id="3962503">:=</span>&nbsp;<span class="keyword" id="3962506">range</span>&nbsp;<span class="ident" id="3962512">m</span><span class="op" id="3962513">.</span><span class="ident" id="3962514">nextProtos</span>&nbsp;<span class="op" id="3962525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962530">l</span>&nbsp;<span class="op" id="3962532">:=</span>&nbsp;<span class="builtinfunc" id="3962535">len</span><span class="op" id="3962538">(</span><span class="ident" id="3962539">v</span><span class="op" id="3962540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962545">if</span>&nbsp;<span class="ident" id="3962548">l</span>&nbsp;<span class="op" id="3962550">&gt;</span>&nbsp;<span class="num" id="3962552">255</span>&nbsp;<span class="op" id="3962556">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962562">l</span>&nbsp;<span class="op" id="3962564">=</span>&nbsp;<span class="num" id="3962566">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962578">z</span><span class="op" id="3962579">[</span><span class="num" id="3962580">0</span><span class="op" id="3962581">]</span>&nbsp;<span class="op" id="3962583">=</span>&nbsp;<span class="builtintype" id="3962585">byte</span><span class="op" id="3962589">(</span><span class="ident" id="3962590">l</span><span class="op" id="3962591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3962596">copy</span><span class="op" id="3962600">(</span><span class="ident" id="3962601">z</span><span class="op" id="3962602">[</span><span class="num" id="3962603">1</span><span class="op" id="3962604">:</span><span class="op" id="3962605">]</span><span class="op" id="3962606">,</span>&nbsp;<span class="op" id="3962608">[</span><span class="op" id="3962609">]</span><span class="builtintype" id="3962610">byte</span><span class="op" id="3962614">(</span><span class="ident" id="3962615">v</span><span class="op" id="3962616">[</span><span class="num" id="3962617">0</span><span class="op" id="3962618">:</span><span class="ident" id="3962619">l</span><span class="op" id="3962620">]</span><span class="op" id="3962621">)</span><span class="op" id="3962622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962627">z</span>&nbsp;<span class="op" id="3962629">=</span>&nbsp;<span class="ident" id="3962631">z</span><span class="op" id="3962632">[</span><span class="num" id="3962633">1</span><span class="op" id="3962634">+</span><span class="ident" id="3962635">l</span><span class="op" id="3962636">:</span><span class="op" id="3962637">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962647">if</span>&nbsp;<span class="ident" id="3962650">m</span><span class="op" id="3962651">.</span><span class="ident" id="3962652">ocspStapling</span>&nbsp;<span class="op" id="3962665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962669">z</span><span class="op" id="3962670">[</span><span class="num" id="3962671">0</span><span class="op" id="3962672">]</span>&nbsp;<span class="op" id="3962674">=</span>&nbsp;<span class="builtintype" id="3962676">byte</span><span class="op" id="3962680">(</span><span class="ident" id="3962681">extensionStatusRequest</span>&nbsp;<span class="op" id="3962704">&gt;&gt;</span>&nbsp;<span class="num" id="3962707">8</span><span class="op" id="3962708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962712">z</span><span class="op" id="3962713">[</span><span class="num" id="3962714">1</span><span class="op" id="3962715">]</span>&nbsp;<span class="op" id="3962717">=</span>&nbsp;<span class="builtintype" id="3962719">byte</span><span class="op" id="3962723">(</span><span class="ident" id="3962724">extensionStatusRequest</span><span class="op" id="3962746">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962750">z</span>&nbsp;<span class="op" id="3962752">=</span>&nbsp;<span class="ident" id="3962754">z</span><span class="op" id="3962755">[</span><span class="num" id="3962756">4</span><span class="op" id="3962757">:</span><span class="op" id="3962758">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962764">if</span>&nbsp;<span class="ident" id="3962767">m</span><span class="op" id="3962768">.</span><span class="ident" id="3962769">ticketSupported</span>&nbsp;<span class="op" id="3962785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962789">z</span><span class="op" id="3962790">[</span><span class="num" id="3962791">0</span><span class="op" id="3962792">]</span>&nbsp;<span class="op" id="3962794">=</span>&nbsp;<span class="builtintype" id="3962796">byte</span><span class="op" id="3962800">(</span><span class="ident" id="3962801">extensionSessionTicket</span>&nbsp;<span class="op" id="3962824">&gt;&gt;</span>&nbsp;<span class="num" id="3962827">8</span><span class="op" id="3962828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962832">z</span><span class="op" id="3962833">[</span><span class="num" id="3962834">1</span><span class="op" id="3962835">]</span>&nbsp;<span class="op" id="3962837">=</span>&nbsp;<span class="builtintype" id="3962839">byte</span><span class="op" id="3962843">(</span><span class="ident" id="3962844">extensionSessionTicket</span><span class="op" id="3962866">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962870">z</span>&nbsp;<span class="op" id="3962872">=</span>&nbsp;<span class="ident" id="3962874">z</span><span class="op" id="3962875">[</span><span class="num" id="3962876">4</span><span class="op" id="3962877">:</span><span class="op" id="3962878">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962884">if</span>&nbsp;<span class="ident" id="3962887">m</span><span class="op" id="3962888">.</span><span class="ident" id="3962889">secureRenegotiation</span>&nbsp;<span class="op" id="3962909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962913">z</span><span class="op" id="3962914">[</span><span class="num" id="3962915">0</span><span class="op" id="3962916">]</span>&nbsp;<span class="op" id="3962918">=</span>&nbsp;<span class="builtintype" id="3962920">byte</span><span class="op" id="3962924">(</span><span class="ident" id="3962925">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3962952">&gt;&gt;</span>&nbsp;<span class="num" id="3962955">8</span><span class="op" id="3962956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962960">z</span><span class="op" id="3962961">[</span><span class="num" id="3962962">1</span><span class="op" id="3962963">]</span>&nbsp;<span class="op" id="3962965">=</span>&nbsp;<span class="builtintype" id="3962967">byte</span><span class="op" id="3962971">(</span><span class="ident" id="3962972">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3962999">&amp;</span>&nbsp;<span class="num" id="3963001">0xff</span><span class="op" id="3963005">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963009">z</span><span class="op" id="3963010">[</span><span class="num" id="3963011">2</span><span class="op" id="3963012">]</span>&nbsp;<span class="op" id="3963014">=</span>&nbsp;<span class="num" id="3963016">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963020">z</span><span class="op" id="3963021">[</span><span class="num" id="3963022">3</span><span class="op" id="3963023">]</span>&nbsp;<span class="op" id="3963025">=</span>&nbsp;<span class="num" id="3963027">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963031">z</span>&nbsp;<span class="op" id="3963033">=</span>&nbsp;<span class="ident" id="3963035">z</span><span class="op" id="3963036">[</span><span class="num" id="3963037">5</span><span class="op" id="3963038">:</span><span class="op" id="3963039">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963045">if</span>&nbsp;<span class="ident" id="3963048">alpnLen</span>&nbsp;<span class="op" id="3963056">:=</span>&nbsp;<span class="builtinfunc" id="3963059">len</span><span class="op" id="3963062">(</span><span class="ident" id="3963063">m</span><span class="op" id="3963064">.</span><span class="ident" id="3963065">alpnProtocol</span><span class="op" id="3963077">)</span><span class="op" id="3963078">;</span>&nbsp;<span class="ident" id="3963080">alpnLen</span>&nbsp;<span class="op" id="3963088">&gt;</span>&nbsp;<span class="num" id="3963090">0</span>&nbsp;<span class="op" id="3963092">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963096">z</span><span class="op" id="3963097">[</span><span class="num" id="3963098">0</span><span class="op" id="3963099">]</span>&nbsp;<span class="op" id="3963101">=</span>&nbsp;<span class="builtintype" id="3963103">byte</span><span class="op" id="3963107">(</span><span class="ident" id="3963108">extensionALPN</span>&nbsp;<span class="op" id="3963122">&gt;&gt;</span>&nbsp;<span class="num" id="3963125">8</span><span class="op" id="3963126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963130">z</span><span class="op" id="3963131">[</span><span class="num" id="3963132">1</span><span class="op" id="3963133">]</span>&nbsp;<span class="op" id="3963135">=</span>&nbsp;<span class="builtintype" id="3963137">byte</span><span class="op" id="3963141">(</span><span class="ident" id="3963142">extensionALPN</span>&nbsp;<span class="op" id="3963156">&amp;</span>&nbsp;<span class="num" id="3963158">0xff</span><span class="op" id="3963162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963166">l</span>&nbsp;<span class="op" id="3963168">:=</span>&nbsp;<span class="num" id="3963171">2</span>&nbsp;<span class="op" id="3963173">+</span>&nbsp;<span class="num" id="3963175">1</span>&nbsp;<span class="op" id="3963177">+</span>&nbsp;<span class="ident" id="3963179">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963189">z</span><span class="op" id="3963190">[</span><span class="num" id="3963191">2</span><span class="op" id="3963192">]</span>&nbsp;<span class="op" id="3963194">=</span>&nbsp;<span class="builtintype" id="3963196">byte</span><span class="op" id="3963200">(</span><span class="ident" id="3963201">l</span>&nbsp;<span class="op" id="3963203">&gt;&gt;</span>&nbsp;<span class="num" id="3963206">8</span><span class="op" id="3963207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963211">z</span><span class="op" id="3963212">[</span><span class="num" id="3963213">3</span><span class="op" id="3963214">]</span>&nbsp;<span class="op" id="3963216">=</span>&nbsp;<span class="builtintype" id="3963218">byte</span><span class="op" id="3963222">(</span><span class="ident" id="3963223">l</span><span class="op" id="3963224">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963228">l</span>&nbsp;<span class="op" id="3963230">-=</span>&nbsp;<span class="num" id="3963233">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963237">z</span><span class="op" id="3963238">[</span><span class="num" id="3963239">4</span><span class="op" id="3963240">]</span>&nbsp;<span class="op" id="3963242">=</span>&nbsp;<span class="builtintype" id="3963244">byte</span><span class="op" id="3963248">(</span><span class="ident" id="3963249">l</span>&nbsp;<span class="op" id="3963251">&gt;&gt;</span>&nbsp;<span class="num" id="3963254">8</span><span class="op" id="3963255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963259">z</span><span class="op" id="3963260">[</span><span class="num" id="3963261">5</span><span class="op" id="3963262">]</span>&nbsp;<span class="op" id="3963264">=</span>&nbsp;<span class="builtintype" id="3963266">byte</span><span class="op" id="3963270">(</span><span class="ident" id="3963271">l</span><span class="op" id="3963272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963276">l</span>&nbsp;<span class="op" id="3963278">-=</span>&nbsp;<span class="num" id="3963281">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963285">z</span><span class="op" id="3963286">[</span><span class="num" id="3963287">6</span><span class="op" id="3963288">]</span>&nbsp;<span class="op" id="3963290">=</span>&nbsp;<span class="builtintype" id="3963292">byte</span><span class="op" id="3963296">(</span><span class="ident" id="3963297">l</span><span class="op" id="3963298">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3963302">copy</span><span class="op" id="3963306">(</span><span class="ident" id="3963307">z</span><span class="op" id="3963308">[</span><span class="num" id="3963309">7</span><span class="op" id="3963310">:</span><span class="op" id="3963311">]</span><span class="op" id="3963312">,</span>&nbsp;<span class="op" id="3963314">[</span><span class="op" id="3963315">]</span><span class="builtintype" id="3963316">byte</span><span class="op" id="3963320">(</span><span class="ident" id="3963321">m</span><span class="op" id="3963322">.</span><span class="ident" id="3963323">alpnProtocol</span><span class="op" id="3963335">)</span><span class="op" id="3963336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963340">z</span>&nbsp;<span class="op" id="3963342">=</span>&nbsp;<span class="ident" id="3963344">z</span><span class="op" id="3963345">[</span><span class="num" id="3963346">7</span><span class="op" id="3963347">+</span><span class="ident" id="3963348">alpnLen</span><span class="op" id="3963355">:</span><span class="op" id="3963356">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963363">m</span><span class="op" id="3963364">.</span><span class="ident" id="3963365">raw</span>&nbsp;<span class="op" id="3963369">=</span>&nbsp;<span class="ident" id="3963371">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963375">return</span>&nbsp;<span class="ident" id="3963382">x</span><br>
<span class="lineno"></span><span class="op" id="3963384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3963387">func</span>&nbsp;<span class="op" id="3963392">(</span><span class="ident" id="3963393">m</span>&nbsp;<span class="op" id="3963395">*</span><span class="ident" id="3963396">serverHelloMsg</span><span class="op" id="3963410">)</span>&nbsp;<span class="ident" id="3963412">unmarshal</span><span class="op" id="3963421">(</span><span class="ident" id="3963422">data</span>&nbsp;<span class="op" id="3963427">[</span><span class="op" id="3963428">]</span><span class="builtintype" id="3963429">byte</span><span class="op" id="3963433">)</span>&nbsp;<span class="builtintype" id="3963435">bool</span>&nbsp;<span class="op" id="3963440">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963443">if</span>&nbsp;<span class="builtinfunc" id="3963446">len</span><span class="op" id="3963449">(</span><span class="ident" id="3963450">data</span><span class="op" id="3963454">)</span>&nbsp;<span class="op" id="3963456">&lt;</span>&nbsp;<span class="num" id="3963458">42</span>&nbsp;<span class="op" id="3963461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963465">return</span>&nbsp;<span class="ident" id="3963472">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963482">m</span><span class="op" id="3963483">.</span><span class="ident" id="3963484">raw</span>&nbsp;<span class="op" id="3963488">=</span>&nbsp;<span class="ident" id="3963490">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963496">m</span><span class="op" id="3963497">.</span><span class="ident" id="3963498">vers</span>&nbsp;<span class="op" id="3963503">=</span>&nbsp;<span class="builtintype" id="3963505">uint16</span><span class="op" id="3963511">(</span><span class="ident" id="3963512">data</span><span class="op" id="3963516">[</span><span class="num" id="3963517">4</span><span class="op" id="3963518">]</span><span class="op" id="3963519">)</span><span class="op" id="3963520">&lt;&lt;</span><span class="num" id="3963522">8</span>&nbsp;<span class="op" id="3963524">|</span>&nbsp;<span class="builtintype" id="3963526">uint16</span><span class="op" id="3963532">(</span><span class="ident" id="3963533">data</span><span class="op" id="3963537">[</span><span class="num" id="3963538">5</span><span class="op" id="3963539">]</span><span class="op" id="3963540">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963543">m</span><span class="op" id="3963544">.</span><span class="ident" id="3963545">random</span>&nbsp;<span class="op" id="3963552">=</span>&nbsp;<span class="ident" id="3963554">data</span><span class="op" id="3963558">[</span><span class="num" id="3963559">6</span><span class="op" id="3963560">:</span><span class="num" id="3963561">38</span><span class="op" id="3963563">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963566">sessionIdLen</span>&nbsp;<span class="op" id="3963579">:=</span>&nbsp;<span class="builtintype" id="3963582">int</span><span class="op" id="3963585">(</span><span class="ident" id="3963586">data</span><span class="op" id="3963590">[</span><span class="num" id="3963591">38</span><span class="op" id="3963593">]</span><span class="op" id="3963594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963597">if</span>&nbsp;<span class="ident" id="3963600">sessionIdLen</span>&nbsp;<span class="op" id="3963613">&gt;</span>&nbsp;<span class="num" id="3963615">32</span>&nbsp;<span class="op" id="3963618">||</span>&nbsp;<span class="builtinfunc" id="3963621">len</span><span class="op" id="3963624">(</span><span class="ident" id="3963625">data</span><span class="op" id="3963629">)</span>&nbsp;<span class="op" id="3963631">&lt;</span>&nbsp;<span class="num" id="3963633">39</span><span class="op" id="3963635">+</span><span class="ident" id="3963636">sessionIdLen</span>&nbsp;<span class="op" id="3963649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963653">return</span>&nbsp;<span class="ident" id="3963660">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963667">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963670">m</span><span class="op" id="3963671">.</span><span class="ident" id="3963672">sessionId</span>&nbsp;<span class="op" id="3963682">=</span>&nbsp;<span class="ident" id="3963684">data</span><span class="op" id="3963688">[</span><span class="num" id="3963689">39</span>&nbsp;<span class="op" id="3963692">:</span>&nbsp;<span class="num" id="3963694">39</span><span class="op" id="3963696">+</span><span class="ident" id="3963697">sessionIdLen</span><span class="op" id="3963709">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963712">data</span>&nbsp;<span class="op" id="3963717">=</span>&nbsp;<span class="ident" id="3963719">data</span><span class="op" id="3963723">[</span><span class="num" id="3963724">39</span><span class="op" id="3963726">+</span><span class="ident" id="3963727">sessionIdLen</span><span class="op" id="3963739">:</span><span class="op" id="3963740">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963743">if</span>&nbsp;<span class="builtinfunc" id="3963746">len</span><span class="op" id="3963749">(</span><span class="ident" id="3963750">data</span><span class="op" id="3963754">)</span>&nbsp;<span class="op" id="3963756">&lt;</span>&nbsp;<span class="num" id="3963758">3</span>&nbsp;<span class="op" id="3963760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963764">return</span>&nbsp;<span class="ident" id="3963771">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963778">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963781">m</span><span class="op" id="3963782">.</span><span class="ident" id="3963783">cipherSuite</span>&nbsp;<span class="op" id="3963795">=</span>&nbsp;<span class="builtintype" id="3963797">uint16</span><span class="op" id="3963803">(</span><span class="ident" id="3963804">data</span><span class="op" id="3963808">[</span><span class="num" id="3963809">0</span><span class="op" id="3963810">]</span><span class="op" id="3963811">)</span><span class="op" id="3963812">&lt;&lt;</span><span class="num" id="3963814">8</span>&nbsp;<span class="op" id="3963816">|</span>&nbsp;<span class="builtintype" id="3963818">uint16</span><span class="op" id="3963824">(</span><span class="ident" id="3963825">data</span><span class="op" id="3963829">[</span><span class="num" id="3963830">1</span><span class="op" id="3963831">]</span><span class="op" id="3963832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963835">m</span><span class="op" id="3963836">.</span><span class="ident" id="3963837">compressionMethod</span>&nbsp;<span class="op" id="3963855">=</span>&nbsp;<span class="ident" id="3963857">data</span><span class="op" id="3963861">[</span><span class="num" id="3963862">2</span><span class="op" id="3963863">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963866">data</span>&nbsp;<span class="op" id="3963871">=</span>&nbsp;<span class="ident" id="3963873">data</span><span class="op" id="3963877">[</span><span class="num" id="3963878">3</span><span class="op" id="3963879">:</span><span class="op" id="3963880">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963884">m</span><span class="op" id="3963885">.</span><span class="ident" id="3963886">nextProtoNeg</span>&nbsp;<span class="op" id="3963899">=</span>&nbsp;<span class="ident" id="3963901">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963908">m</span><span class="op" id="3963909">.</span><span class="ident" id="3963910">nextProtos</span>&nbsp;<span class="op" id="3963921">=</span>&nbsp;<span class="ident" id="3963923">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963928">m</span><span class="op" id="3963929">.</span><span class="ident" id="3963930">ocspStapling</span>&nbsp;<span class="op" id="3963943">=</span>&nbsp;<span class="ident" id="3963945">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963952">m</span><span class="op" id="3963953">.</span><span class="ident" id="3963954">ticketSupported</span>&nbsp;<span class="op" id="3963970">=</span>&nbsp;<span class="ident" id="3963972">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963979">m</span><span class="op" id="3963980">.</span><span class="ident" id="3963981">alpnProtocol</span>&nbsp;<span class="op" id="3963994">=</span>&nbsp;<span class="string" id="3963996">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964001">if</span>&nbsp;<span class="builtinfunc" id="3964004">len</span><span class="op" id="3964007">(</span><span class="ident" id="3964008">data</span><span class="op" id="3964012">)</span>&nbsp;<span class="op" id="3964014">==</span>&nbsp;<span class="num" id="3964017">0</span>&nbsp;<span class="op" id="3964019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3964023">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964081">return</span>&nbsp;<span class="ident" id="3964088">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964097">if</span>&nbsp;<span class="builtinfunc" id="3964100">len</span><span class="op" id="3964103">(</span><span class="ident" id="3964104">data</span><span class="op" id="3964108">)</span>&nbsp;<span class="op" id="3964110">&lt;</span>&nbsp;<span class="num" id="3964112">2</span>&nbsp;<span class="op" id="3964114">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964118">return</span>&nbsp;<span class="ident" id="3964125">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964136">extensionsLength</span>&nbsp;<span class="op" id="3964153">:=</span>&nbsp;<span class="builtintype" id="3964156">int</span><span class="op" id="3964159">(</span><span class="ident" id="3964160">data</span><span class="op" id="3964164">[</span><span class="num" id="3964165">0</span><span class="op" id="3964166">]</span><span class="op" id="3964167">)</span><span class="op" id="3964168">&lt;&lt;</span><span class="num" id="3964170">8</span>&nbsp;<span class="op" id="3964172">|</span>&nbsp;<span class="builtintype" id="3964174">int</span><span class="op" id="3964177">(</span><span class="ident" id="3964178">data</span><span class="op" id="3964182">[</span><span class="num" id="3964183">1</span><span class="op" id="3964184">]</span><span class="op" id="3964185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964188">data</span>&nbsp;<span class="op" id="3964193">=</span>&nbsp;<span class="ident" id="3964195">data</span><span class="op" id="3964199">[</span><span class="num" id="3964200">2</span><span class="op" id="3964201">:</span><span class="op" id="3964202">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964205">if</span>&nbsp;<span class="builtinfunc" id="3964208">len</span><span class="op" id="3964211">(</span><span class="ident" id="3964212">data</span><span class="op" id="3964216">)</span>&nbsp;<span class="op" id="3964218">!=</span>&nbsp;<span class="ident" id="3964221">extensionsLength</span>&nbsp;<span class="op" id="3964238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964242">return</span>&nbsp;<span class="ident" id="3964249">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964260">for</span>&nbsp;<span class="builtinfunc" id="3964264">len</span><span class="op" id="3964267">(</span><span class="ident" id="3964268">data</span><span class="op" id="3964272">)</span>&nbsp;<span class="op" id="3964274">!=</span>&nbsp;<span class="num" id="3964277">0</span>&nbsp;<span class="op" id="3964279">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964283">if</span>&nbsp;<span class="builtinfunc" id="3964286">len</span><span class="op" id="3964289">(</span><span class="ident" id="3964290">data</span><span class="op" id="3964294">)</span>&nbsp;<span class="op" id="3964296">&lt;</span>&nbsp;<span class="num" id="3964298">4</span>&nbsp;<span class="op" id="3964300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964305">return</span>&nbsp;<span class="ident" id="3964312">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964324">extension</span>&nbsp;<span class="op" id="3964334">:=</span>&nbsp;<span class="builtintype" id="3964337">uint16</span><span class="op" id="3964343">(</span><span class="ident" id="3964344">data</span><span class="op" id="3964348">[</span><span class="num" id="3964349">0</span><span class="op" id="3964350">]</span><span class="op" id="3964351">)</span><span class="op" id="3964352">&lt;&lt;</span><span class="num" id="3964354">8</span>&nbsp;<span class="op" id="3964356">|</span>&nbsp;<span class="builtintype" id="3964358">uint16</span><span class="op" id="3964364">(</span><span class="ident" id="3964365">data</span><span class="op" id="3964369">[</span><span class="num" id="3964370">1</span><span class="op" id="3964371">]</span><span class="op" id="3964372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964376">length</span>&nbsp;<span class="op" id="3964383">:=</span>&nbsp;<span class="builtintype" id="3964386">int</span><span class="op" id="3964389">(</span><span class="ident" id="3964390">data</span><span class="op" id="3964394">[</span><span class="num" id="3964395">2</span><span class="op" id="3964396">]</span><span class="op" id="3964397">)</span><span class="op" id="3964398">&lt;&lt;</span><span class="num" id="3964400">8</span>&nbsp;<span class="op" id="3964402">|</span>&nbsp;<span class="builtintype" id="3964404">int</span><span class="op" id="3964407">(</span><span class="ident" id="3964408">data</span><span class="op" id="3964412">[</span><span class="num" id="3964413">3</span><span class="op" id="3964414">]</span><span class="op" id="3964415">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964419">data</span>&nbsp;<span class="op" id="3964424">=</span>&nbsp;<span class="ident" id="3964426">data</span><span class="op" id="3964430">[</span><span class="num" id="3964431">4</span><span class="op" id="3964432">:</span><span class="op" id="3964433">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964437">if</span>&nbsp;<span class="builtinfunc" id="3964440">len</span><span class="op" id="3964443">(</span><span class="ident" id="3964444">data</span><span class="op" id="3964448">)</span>&nbsp;<span class="op" id="3964450">&lt;</span>&nbsp;<span class="ident" id="3964452">length</span>&nbsp;<span class="op" id="3964459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964464">return</span>&nbsp;<span class="ident" id="3964471">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964484">switch</span>&nbsp;<span class="ident" id="3964491">extension</span>&nbsp;<span class="op" id="3964501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964505">case</span>&nbsp;<span class="ident" id="3964510">extensionNextProtoNeg</span><span class="op" id="3964531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964536">m</span><span class="op" id="3964537">.</span><span class="ident" id="3964538">nextProtoNeg</span>&nbsp;<span class="op" id="3964551">=</span>&nbsp;<span class="ident" id="3964553">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964561">d</span>&nbsp;<span class="op" id="3964563">:=</span>&nbsp;<span class="ident" id="3964566">data</span><span class="op" id="3964570">[</span><span class="op" id="3964571">:</span><span class="ident" id="3964572">length</span><span class="op" id="3964578">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964583">for</span>&nbsp;<span class="builtinfunc" id="3964587">len</span><span class="op" id="3964590">(</span><span class="ident" id="3964591">d</span><span class="op" id="3964592">)</span>&nbsp;<span class="op" id="3964594">&gt;</span>&nbsp;<span class="num" id="3964596">0</span>&nbsp;<span class="op" id="3964598">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964604">l</span>&nbsp;<span class="op" id="3964606">:=</span>&nbsp;<span class="builtintype" id="3964609">int</span><span class="op" id="3964612">(</span><span class="ident" id="3964613">d</span><span class="op" id="3964614">[</span><span class="num" id="3964615">0</span><span class="op" id="3964616">]</span><span class="op" id="3964617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964623">d</span>&nbsp;<span class="op" id="3964625">=</span>&nbsp;<span class="ident" id="3964627">d</span><span class="op" id="3964628">[</span><span class="num" id="3964629">1</span><span class="op" id="3964630">:</span><span class="op" id="3964631">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964637">if</span>&nbsp;<span class="ident" id="3964640">l</span>&nbsp;<span class="op" id="3964642">==</span>&nbsp;<span class="num" id="3964645">0</span>&nbsp;<span class="op" id="3964647">||</span>&nbsp;<span class="ident" id="3964650">l</span>&nbsp;<span class="op" id="3964652">&gt;</span>&nbsp;<span class="builtinfunc" id="3964654">len</span><span class="op" id="3964657">(</span><span class="ident" id="3964658">d</span><span class="op" id="3964659">)</span>&nbsp;<span class="op" id="3964661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964668">return</span>&nbsp;<span class="ident" id="3964675">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964685">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964691">m</span><span class="op" id="3964692">.</span><span class="ident" id="3964693">nextProtos</span>&nbsp;<span class="op" id="3964704">=</span>&nbsp;<span class="builtinfunc" id="3964706">append</span><span class="op" id="3964712">(</span><span class="ident" id="3964713">m</span><span class="op" id="3964714">.</span><span class="ident" id="3964715">nextProtos</span><span class="op" id="3964725">,</span>&nbsp;<span class="builtintype" id="3964727">string</span><span class="op" id="3964733">(</span><span class="ident" id="3964734">d</span><span class="op" id="3964735">[</span><span class="op" id="3964736">:</span><span class="ident" id="3964737">l</span><span class="op" id="3964738">]</span><span class="op" id="3964739">)</span><span class="op" id="3964740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964746">d</span>&nbsp;<span class="op" id="3964748">=</span>&nbsp;<span class="ident" id="3964750">d</span><span class="op" id="3964751">[</span><span class="ident" id="3964752">l</span><span class="op" id="3964753">:</span><span class="op" id="3964754">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964763">case</span>&nbsp;<span class="ident" id="3964768">extensionStatusRequest</span><span class="op" id="3964790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964795">if</span>&nbsp;<span class="ident" id="3964798">length</span>&nbsp;<span class="op" id="3964805">&gt;</span>&nbsp;<span class="num" id="3964807">0</span>&nbsp;<span class="op" id="3964809">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964815">return</span>&nbsp;<span class="ident" id="3964822">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964836">m</span><span class="op" id="3964837">.</span><span class="ident" id="3964838">ocspStapling</span>&nbsp;<span class="op" id="3964851">=</span>&nbsp;<span class="ident" id="3964853">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964860">case</span>&nbsp;<span class="ident" id="3964865">extensionSessionTicket</span><span class="op" id="3964887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964892">if</span>&nbsp;<span class="ident" id="3964895">length</span>&nbsp;<span class="op" id="3964902">&gt;</span>&nbsp;<span class="num" id="3964904">0</span>&nbsp;<span class="op" id="3964906">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964912">return</span>&nbsp;<span class="ident" id="3964919">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964933">m</span><span class="op" id="3964934">.</span><span class="ident" id="3964935">ticketSupported</span>&nbsp;<span class="op" id="3964951">=</span>&nbsp;<span class="ident" id="3964953">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964960">case</span>&nbsp;<span class="ident" id="3964965">extensionRenegotiationInfo</span><span class="op" id="3964991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964996">if</span>&nbsp;<span class="ident" id="3964999">length</span>&nbsp;<span class="op" id="3965006">!=</span>&nbsp;<span class="num" id="3965009">1</span>&nbsp;<span class="op" id="3965011">||</span>&nbsp;<span class="ident" id="3965014">data</span><span class="op" id="3965018">[</span><span class="num" id="3965019">0</span><span class="op" id="3965020">]</span>&nbsp;<span class="op" id="3965022">!=</span>&nbsp;<span class="num" id="3965025">0</span>&nbsp;<span class="op" id="3965027">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965033">return</span>&nbsp;<span class="ident" id="3965040">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965054">m</span><span class="op" id="3965055">.</span><span class="ident" id="3965056">secureRenegotiation</span>&nbsp;<span class="op" id="3965076">=</span>&nbsp;<span class="ident" id="3965078">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965085">case</span>&nbsp;<span class="ident" id="3965090">extensionALPN</span><span class="op" id="3965103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965108">d</span>&nbsp;<span class="op" id="3965110">:=</span>&nbsp;<span class="ident" id="3965113">data</span><span class="op" id="3965117">[</span><span class="op" id="3965118">:</span><span class="ident" id="3965119">length</span><span class="op" id="3965125">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965130">if</span>&nbsp;<span class="builtinfunc" id="3965133">len</span><span class="op" id="3965136">(</span><span class="ident" id="3965137">d</span><span class="op" id="3965138">)</span>&nbsp;<span class="op" id="3965140">&lt;</span>&nbsp;<span class="num" id="3965142">3</span>&nbsp;<span class="op" id="3965144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965150">return</span>&nbsp;<span class="ident" id="3965157">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965171">l</span>&nbsp;<span class="op" id="3965173">:=</span>&nbsp;<span class="builtintype" id="3965176">int</span><span class="op" id="3965179">(</span><span class="ident" id="3965180">d</span><span class="op" id="3965181">[</span><span class="num" id="3965182">0</span><span class="op" id="3965183">]</span><span class="op" id="3965184">)</span><span class="op" id="3965185">&lt;&lt;</span><span class="num" id="3965187">8</span>&nbsp;<span class="op" id="3965189">|</span>&nbsp;<span class="builtintype" id="3965191">int</span><span class="op" id="3965194">(</span><span class="ident" id="3965195">d</span><span class="op" id="3965196">[</span><span class="num" id="3965197">1</span><span class="op" id="3965198">]</span><span class="op" id="3965199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965204">if</span>&nbsp;<span class="ident" id="3965207">l</span>&nbsp;<span class="op" id="3965209">!=</span>&nbsp;<span class="builtinfunc" id="3965212">len</span><span class="op" id="3965215">(</span><span class="ident" id="3965216">d</span><span class="op" id="3965217">)</span><span class="op" id="3965218">-</span><span class="num" id="3965219">2</span>&nbsp;<span class="op" id="3965221">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965227">return</span>&nbsp;<span class="ident" id="3965234">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965248">d</span>&nbsp;<span class="op" id="3965250">=</span>&nbsp;<span class="ident" id="3965252">d</span><span class="op" id="3965253">[</span><span class="num" id="3965254">2</span><span class="op" id="3965255">:</span><span class="op" id="3965256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965261">l</span>&nbsp;<span class="op" id="3965263">=</span>&nbsp;<span class="builtintype" id="3965265">int</span><span class="op" id="3965268">(</span><span class="ident" id="3965269">d</span><span class="op" id="3965270">[</span><span class="num" id="3965271">0</span><span class="op" id="3965272">]</span><span class="op" id="3965273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965278">if</span>&nbsp;<span class="ident" id="3965281">l</span>&nbsp;<span class="op" id="3965283">!=</span>&nbsp;<span class="builtinfunc" id="3965286">len</span><span class="op" id="3965289">(</span><span class="ident" id="3965290">d</span><span class="op" id="3965291">)</span><span class="op" id="3965292">-</span><span class="num" id="3965293">1</span>&nbsp;<span class="op" id="3965295">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965301">return</span>&nbsp;<span class="ident" id="3965308">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965322">d</span>&nbsp;<span class="op" id="3965324">=</span>&nbsp;<span class="ident" id="3965326">d</span><span class="op" id="3965327">[</span><span class="num" id="3965328">1</span><span class="op" id="3965329">:</span><span class="op" id="3965330">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965335">m</span><span class="op" id="3965336">.</span><span class="ident" id="3965337">alpnProtocol</span>&nbsp;<span class="op" id="3965350">=</span>&nbsp;<span class="builtintype" id="3965352">string</span><span class="op" id="3965358">(</span><span class="ident" id="3965359">d</span><span class="op" id="3965360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965364">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965368">data</span>&nbsp;<span class="op" id="3965373">=</span>&nbsp;<span class="ident" id="3965375">data</span><span class="op" id="3965379">[</span><span class="ident" id="3965380">length</span><span class="op" id="3965386">:</span><span class="op" id="3965387">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965394">return</span>&nbsp;<span class="ident" id="3965401">true</span><br>
<span class="lineno"></span><span class="op" id="3965406">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="3965409">type</span>&nbsp;<span class="ident" id="3965414">certificateMsg</span>&nbsp;<span class="keyword" id="3965429">struct</span>&nbsp;<span class="op" id="3965436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965439">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965452">[</span><span class="op" id="3965453">]</span><span class="builtintype" id="3965454">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965460">certificates</span>&nbsp;<span class="op" id="3965473">[</span><span class="op" id="3965474">]</span><span class="op" id="3965475">[</span><span class="op" id="3965476">]</span><span class="builtintype" id="3965477">byte</span><br>
<span class="lineno"></span><span class="op" id="3965482">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="3965485">func</span>&nbsp;<span class="op" id="3965490">(</span><span class="ident" id="3965491">m</span>&nbsp;<span class="op" id="3965493">*</span><span class="ident" id="3965494">certificateMsg</span><span class="op" id="3965508">)</span>&nbsp;<span class="ident" id="3965510">equal</span><span class="op" id="3965515">(</span><span class="ident" id="3965516">i</span>&nbsp;<span class="keyword" id="3965518">interface</span><span class="op" id="3965527">{</span><span class="op" id="3965528">}</span><span class="op" id="3965529">)</span>&nbsp;<span class="builtintype" id="3965531">bool</span>&nbsp;<span class="op" id="3965536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965539">m1</span><span class="op" id="3965541">,</span>&nbsp;<span class="ident" id="3965543">ok</span>&nbsp;<span class="op" id="3965546">:=</span>&nbsp;<span class="ident" id="3965549">i</span><span class="op" id="3965550">.</span><span class="op" id="3965551">(</span><span class="op" id="3965552">*</span><span class="ident" id="3965553">certificateMsg</span><span class="op" id="3965567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965570">if</span>&nbsp;<span class="op" id="3965573">!</span><span class="ident" id="3965574">ok</span>&nbsp;<span class="op" id="3965577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965581">return</span>&nbsp;<span class="ident" id="3965588">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965599">return</span>&nbsp;<span class="ident" id="3965606">bytes</span><span class="op" id="3965611">.</span><span class="ident" id="3965612">Equal</span><span class="op" id="3965617">(</span><span class="ident" id="3965618">m</span><span class="op" id="3965619">.</span><span class="ident" id="3965620">raw</span><span class="op" id="3965623">,</span>&nbsp;<span class="ident" id="3965625">m1</span><span class="op" id="3965627">.</span><span class="ident" id="3965628">raw</span><span class="op" id="3965631">)</span>&nbsp;<span class="op" id="3965633">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965638">eqByteSlices</span><span class="op" id="3965650">(</span><span class="ident" id="3965651">m</span><span class="op" id="3965652">.</span><span class="ident" id="3965653">certificates</span><span class="op" id="3965665">,</span>&nbsp;<span class="ident" id="3965667">m1</span><span class="op" id="3965669">.</span><span class="ident" id="3965670">certificates</span><span class="op" id="3965682">)</span><br>
<span class="lineno"></span><span class="op" id="3965684">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="3965687">func</span>&nbsp;<span class="op" id="3965692">(</span><span class="ident" id="3965693">m</span>&nbsp;<span class="op" id="3965695">*</span><span class="ident" id="3965696">certificateMsg</span><span class="op" id="3965710">)</span>&nbsp;<span class="ident" id="3965712">marshal</span><span class="op" id="3965719">(</span><span class="op" id="3965720">)</span>&nbsp;<span class="op" id="3965722">(</span><span class="ident" id="3965723">x</span>&nbsp;<span class="op" id="3965725">[</span><span class="op" id="3965726">]</span><span class="builtintype" id="3965727">byte</span><span class="op" id="3965731">)</span>&nbsp;<span class="op" id="3965733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965736">if</span>&nbsp;<span class="ident" id="3965739">m</span><span class="op" id="3965740">.</span><span class="ident" id="3965741">raw</span>&nbsp;<span class="op" id="3965745">!=</span>&nbsp;<span class="ident" id="3965748">nil</span>&nbsp;<span class="op" id="3965752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965756">return</span>&nbsp;<span class="ident" id="3965763">m</span><span class="op" id="3965764">.</span><span class="ident" id="3965765">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965770">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965774">var</span>&nbsp;<span class="ident" id="3965778">i</span>&nbsp;<span class="builtintype" id="3965780">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965785">for</span>&nbsp;<span class="ident" id="3965789">_</span><span class="op" id="3965790">,</span>&nbsp;<span class="ident" id="3965792">slice</span>&nbsp;<span class="op" id="3965798">:=</span>&nbsp;<span class="keyword" id="3965801">range</span>&nbsp;<span class="ident" id="3965807">m</span><span class="op" id="3965808">.</span><span class="ident" id="3965809">certificates</span>&nbsp;<span class="op" id="3965822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965826">i</span>&nbsp;<span class="op" id="3965828">+=</span>&nbsp;<span class="builtinfunc" id="3965831">len</span><span class="op" id="3965834">(</span><span class="ident" id="3965835">slice</span><span class="op" id="3965840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965843">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965847">length</span>&nbsp;<span class="op" id="3965854">:=</span>&nbsp;<span class="num" id="3965857">3</span>&nbsp;<span class="op" id="3965859">+</span>&nbsp;<span class="num" id="3965861">3</span><span class="op" id="3965862">*</span><span class="builtinfunc" id="3965863">len</span><span class="op" id="3965866">(</span><span class="ident" id="3965867">m</span><span class="op" id="3965868">.</span><span class="ident" id="3965869">certificates</span><span class="op" id="3965881">)</span>&nbsp;<span class="op" id="3965883">+</span>&nbsp;<span class="ident" id="3965885">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965888">x</span>&nbsp;<span class="op" id="3965890">=</span>&nbsp;<span class="builtinfunc" id="3965892">make</span><span class="op" id="3965896">(</span><span class="op" id="3965897">[</span><span class="op" id="3965898">]</span><span class="builtintype" id="3965899">byte</span><span class="op" id="3965903">,</span>&nbsp;<span class="num" id="3965905">4</span><span class="op" id="3965906">+</span><span class="ident" id="3965907">length</span><span class="op" id="3965913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965916">x</span><span class="op" id="3965917">[</span><span class="num" id="3965918">0</span><span class="op" id="3965919">]</span>&nbsp;<span class="op" id="3965921">=</span>&nbsp;<span class="ident" id="3965923">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965940">x</span><span class="op" id="3965941">[</span><span class="num" id="3965942">1</span><span class="op" id="3965943">]</span>&nbsp;<span class="op" id="3965945">=</span>&nbsp;<span class="builtintype" id="3965947">uint8</span><span class="op" id="3965952">(</span><span class="ident" id="3965953">length</span>&nbsp;<span class="op" id="3965960">&gt;&gt;</span>&nbsp;<span class="num" id="3965963">16</span><span class="op" id="3965965">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965968">x</span><span class="op" id="3965969">[</span><span class="num" id="3965970">2</span><span class="op" id="3965971">]</span>&nbsp;<span class="op" id="3965973">=</span>&nbsp;<span class="builtintype" id="3965975">uint8</span><span class="op" id="3965980">(</span><span class="ident" id="3965981">length</span>&nbsp;<span class="op" id="3965988">&gt;&gt;</span>&nbsp;<span class="num" id="3965991">8</span><span class="op" id="3965992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965995">x</span><span class="op" id="3965996">[</span><span class="num" id="3965997">3</span><span class="op" id="3965998">]</span>&nbsp;<span class="op" id="3966000">=</span>&nbsp;<span class="builtintype" id="3966002">uint8</span><span class="op" id="3966007">(</span><span class="ident" id="3966008">length</span><span class="op" id="3966014">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966018">certificateOctets</span>&nbsp;<span class="op" id="3966036">:=</span>&nbsp;<span class="ident" id="3966039">length</span>&nbsp;<span class="op" id="3966046">-</span>&nbsp;<span class="num" id="3966048">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966051">x</span><span class="op" id="3966052">[</span><span class="num" id="3966053">4</span><span class="op" id="3966054">]</span>&nbsp;<span class="op" id="3966056">=</span>&nbsp;<span class="builtintype" id="3966058">uint8</span><span class="op" id="3966063">(</span><span class="ident" id="3966064">certificateOctets</span>&nbsp;<span class="op" id="3966082">&gt;&gt;</span>&nbsp;<span class="num" id="3966085">16</span><span class="op" id="3966087">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966090">x</span><span class="op" id="3966091">[</span><span class="num" id="3966092">5</span><span class="op" id="3966093">]</span>&nbsp;<span class="op" id="3966095">=</span>&nbsp;<span class="builtintype" id="3966097">uint8</span><span class="op" id="3966102">(</span><span class="ident" id="3966103">certificateOctets</span>&nbsp;<span class="op" id="3966121">&gt;&gt;</span>&nbsp;<span class="num" id="3966124">8</span><span class="op" id="3966125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966128">x</span><span class="op" id="3966129">[</span><span class="num" id="3966130">6</span><span class="op" id="3966131">]</span>&nbsp;<span class="op" id="3966133">=</span>&nbsp;<span class="builtintype" id="3966135">uint8</span><span class="op" id="3966140">(</span><span class="ident" id="3966141">certificateOctets</span><span class="op" id="3966158">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966162">y</span>&nbsp;<span class="op" id="3966164">:=</span>&nbsp;<span class="ident" id="3966167">x</span><span class="op" id="3966168">[</span><span class="num" id="3966169">7</span><span class="op" id="3966170">:</span><span class="op" id="3966171">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966174">for</span>&nbsp;<span class="ident" id="3966178">_</span><span class="op" id="3966179">,</span>&nbsp;<span class="ident" id="3966181">slice</span>&nbsp;<span class="op" id="3966187">:=</span>&nbsp;<span class="keyword" id="3966190">range</span>&nbsp;<span class="ident" id="3966196">m</span><span class="op" id="3966197">.</span><span class="ident" id="3966198">certificates</span>&nbsp;<span class="op" id="3966211">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966215">y</span><span class="op" id="3966216">[</span><span class="num" id="3966217">0</span><span class="op" id="3966218">]</span>&nbsp;<span class="op" id="3966220">=</span>&nbsp;<span class="builtintype" id="3966222">uint8</span><span class="op" id="3966227">(</span><span class="builtinfunc" id="3966228">len</span><span class="op" id="3966231">(</span><span class="ident" id="3966232">slice</span><span class="op" id="3966237">)</span>&nbsp;<span class="op" id="3966239">&gt;&gt;</span>&nbsp;<span class="num" id="3966242">16</span><span class="op" id="3966244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966248">y</span><span class="op" id="3966249">[</span><span class="num" id="3966250">1</span><span class="op" id="3966251">]</span>&nbsp;<span class="op" id="3966253">=</span>&nbsp;<span class="builtintype" id="3966255">uint8</span><span class="op" id="3966260">(</span><span class="builtinfunc" id="3966261">len</span><span class="op" id="3966264">(</span><span class="ident" id="3966265">slice</span><span class="op" id="3966270">)</span>&nbsp;<span class="op" id="3966272">&gt;&gt;</span>&nbsp;<span class="num" id="3966275">8</span><span class="op" id="3966276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966280">y</span><span class="op" id="3966281">[</span><span class="num" id="3966282">2</span><span class="op" id="3966283">]</span>&nbsp;<span class="op" id="3966285">=</span>&nbsp;<span class="builtintype" id="3966287">uint8</span><span class="op" id="3966292">(</span><span class="builtinfunc" id="3966293">len</span><span class="op" id="3966296">(</span><span class="ident" id="3966297">slice</span><span class="op" id="3966302">)</span><span class="op" id="3966303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3966307">copy</span><span class="op" id="3966311">(</span><span class="ident" id="3966312">y</span><span class="op" id="3966313">[</span><span class="num" id="3966314">3</span><span class="op" id="3966315">:</span><span class="op" id="3966316">]</span><span class="op" id="3966317">,</span>&nbsp;<span class="ident" id="3966319">slice</span><span class="op" id="3966324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966328">y</span>&nbsp;<span class="op" id="3966330">=</span>&nbsp;<span class="ident" id="3966332">y</span><span class="op" id="3966333">[</span><span class="num" id="3966334">3</span><span class="op" id="3966335">+</span><span class="builtinfunc" id="3966336">len</span><span class="op" id="3966339">(</span><span class="ident" id="3966340">slice</span><span class="op" id="3966345">)</span><span class="op" id="3966346">:</span><span class="op" id="3966347">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3966350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966354">m</span><span class="op" id="3966355">.</span><span class="ident" id="3966356">raw</span>&nbsp;<span class="op" id="3966360">=</span>&nbsp;<span class="ident" id="3966362">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966365">return</span><br>
<span class="lineno"></span><span class="op" id="3966372">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="3966375">func</span>&nbsp;<span class="op" id="3966380">(</span><span class="ident" id="3966381">m</span>&nbsp;<span class="op" id="3966383">*</span><span class="ident" id="3966384">certificateMsg</span><span class="op" id="3966398">)</span>&nbsp;<span class="ident" id="3966400">unmarshal</span><span class="op" id="3966409">(</span><span class="ident" id="3966410">data</span>&nbsp;<span class="op" id="3966415">[</span><span class="op" id="3966416">]</span><span class="builtintype" id="3966417">byte</span><span class="op" id="3966421">)</span>&nbsp;<span class="builtintype" id="3966423">bool</span>&nbsp;<span class="op" id="3966428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966431">if</span>&nbsp;<span class="builtinfunc" id="3966434">len</span><span class="op" id="3966437">(</span><span class="ident" id="3966438">data</span><span class="op" id="3966442">)</span>&nbsp;<span class="op" id="3966444">&lt;</span>&nbsp;<span class="num" id="3966446">7</span>&nbsp;<span class="op" id="3966448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966452">return</span>&nbsp;<span class="ident" id="3966459">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3966466">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966470">m</span><span class="op" id="3966471">.</span><span class="ident" id="3966472">raw</span>&nbsp;<span class="op" id="3966476">=</span>&nbsp;<span class="ident" id="3966478">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966484">certsLen</span>&nbsp;<span class="op" id="3966493">:=</span>&nbsp;<span class="builtintype" id="3966496">uint32</span><span class="op" id="3966502">(</span><span class="ident" id="3966503">data</span><span class="op" id="3966507">[</span><span class="num" id="3966508">4</span><span class="op" id="3966509">]</span><span class="op" id="3966510">)</span><span class="op" id="3966511">&lt;&lt;</span><span class="num" id="3966513">16</span>&nbsp;<span class="op" id="3966516">|</span>&nbsp;<span class="builtintype" id="3966518">uint32</span><span class="op" id="3966524">(</span><span class="ident" id="3966525">data</span><span class="op" id="3966529">[</span><span class="num" id="3966530">5</span><span class="op" id="3966531">]</span><span class="op" id="3966532">)</span><span class="op" id="3966533">&lt;&lt;</span><span class="num" id="3966535">8</span>&nbsp;<span class="op" id="3966537">|</span>&nbsp;<span class="builtintype" id="3966539">uint32</span><span class="op" id="3966545">(</span><span class="ident" id="3966546">data</span><span class="op" id="3966550">[</span><span class="num" id="3966551">6</span><span class="op" id="3966552">]</span><span class="op" id="3966553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966556">if</span>&nbsp;<span class="builtintype" id="3966559">uint32</span><span class="op" id="3966565">(</span><span class="builtinfunc" id="3966566">len</span><span class="op" id="3966569">(</span><span class="ident" id="3966570">data</span><span class="op" id="3966574">)</span><span class="op" id="3966575">)</span>&nbsp;<span class="op" id="3966577">!=</span>&nbsp;<span class="ident" id="3966580">certsLen</span><span class="op" id="3966588">+</span><span class="num" id="3966589">7</span>&nbsp;<span class="op" id="3966591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966595">return</span>&nbsp;<span class="ident" id="3966602">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3966609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966613">numCerts</span>&nbsp;<span class="op" id="3966622">:=</span>&nbsp;<span class="num" id="3966625">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966628">d</span>&nbsp;<span class="op" id="3966630">:=</span>&nbsp;<span class="ident" id="3966633">data</span><span class="op" id="3966637">[</span><span class="num" id="3966638">7</span><span class="op" id="3966639">:</span><span class="op" id="3966640">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966643">for</span>&nbsp;<span class="ident" id="3966647">certsLen</span>&nbsp;<span class="op" id="3966656">&gt;</span>&nbsp;<span class="num" id="3966658">0</span>&nbsp;<span class="op" id="3966660">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966664">if</span>&nbsp;<span class="builtinfunc" id="3966667">len</span><span class="op" id="3966670">(</span><span class="ident" id="3966671">d</span><span class="op" id="3966672">)</span>&nbsp;<span class="op" id="3966674">&lt;</span>&nbsp;<span class="num" id="3966676">4</span>&nbsp;<span class="op" id="3966678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966683">return</span>&nbsp;<span class="ident" id="3966690">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3966698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966702">certLen</span>&nbsp;<span class="op" id="3966710">:=</span>&nbsp;<span class="builtintype" id="3966713">uint32</span><span class="op" id="3966719">(</span><span class="ident" id="3966720">d</span><span class="op" id="3966721">[</span><span class="num" id="3966722">0</span><span class="op" id="3966723">]</span><span class="op" id="3966724">)</span><span class="op" id="3966725">&lt;&lt;</span><span class="num" id="3966727">16</span>&nbsp;<span class="op" id="3966730">|</span>&nbsp;<span class="builtintype" id="3966732">uint32</span><span class="op" id="3966738">(</span><span class="ident" id="3966739">d</span><span class="op" id="3966740">[</span><span class="num" id="3966741">1</span><span class="op" id="3966742">]</span><span class="op" id="3966743">)</span><span class="op" id="3966744">&lt;&lt;</span><span class="num" id="3966746">8</span>&nbsp;<span class="op" id="3966748">|</span>&nbsp;<span class="builtintype" id="3966750">uint32</span><span class="op" id="3966756">(</span><span class="ident" id="3966757">d</span><span class="op" id="3966758">[</span><span class="num" id="3966759">2</span><span class="op" id="3966760">]</span><span class="op" id="3966761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966765">if</span>&nbsp;<span class="builtintype" id="3966768">uint32</span><span class="op" id="3966774">(</span><span class="builtinfunc" id="3966775">len</span><span class="op" id="3966778">(</span><span class="ident" id="3966779">d</span><span class="op" id="3966780">)</span><span class="op" id="3966781">)</span>&nbsp;<span class="op" id="3966783">&lt;</span>&nbsp;<span class="num" id="3966785">3</span><span class="op" id="3966786">+</span><span class="ident" id="3966787">certLen</span>&nbsp;<span class="op" id="3966795">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966800">return</span>&nbsp;<span class="ident" id="3966807">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3966815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966819">d</span>&nbsp;<span class="op" id="3966821">=</span>&nbsp;<span class="ident" id="3966823">d</span><span class="op" id="3966824">[</span><span class="num" id="3966825">3</span><span class="op" id="3966826">+</span><span class="ident" id="3966827">certLen</span><span class="op" id="3966834">:</span><span class="op" id="3966835">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966839">certsLen</span>&nbsp;<span class="op" id="3966848">-=</span>&nbsp;<span class="num" id="3966851">3</span>&nbsp;<span class="op" id="3966853">+</span>&nbsp;<span class="ident" id="3966855">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966865">numCerts</span><span class="op" id="3966873">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3966877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966881">m</span><span class="op" id="3966882">.</span><span class="ident" id="3966883">certificates</span>&nbsp;<span class="op" id="3966896">=</span>&nbsp;<span class="builtinfunc" id="3966898">make</span><span class="op" id="3966902">(</span><span class="op" id="3966903">[</span><span class="op" id="3966904">]</span><span class="op" id="3966905">[</span><span class="op" id="3966906">]</span><span class="builtintype" id="3966907">byte</span><span class="op" id="3966911">,</span>&nbsp;<span class="ident" id="3966913">numCerts</span><span class="op" id="3966921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966924">d</span>&nbsp;<span class="op" id="3966926">=</span>&nbsp;<span class="ident" id="3966928">data</span><span class="op" id="3966932">[</span><span class="num" id="3966933">7</span><span class="op" id="3966934">:</span><span class="op" id="3966935">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3966938">for</span>&nbsp;<span class="ident" id="3966942">i</span>&nbsp;<span class="op" id="3966944">:=</span>&nbsp;<span class="num" id="3966947">0</span><span class="op" id="3966948">;</span>&nbsp;<span class="ident" id="3966950">i</span>&nbsp;<span class="op" id="3966952">&lt;</span>&nbsp;<span class="ident" id="3966954">numCerts</span><span class="op" id="3966962">;</span>&nbsp;<span class="ident" id="3966964">i</span><span class="op" id="3966965">++</span>&nbsp;<span class="op" id="3966968">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3966972">certLen</span>&nbsp;<span class="op" id="3966980">:=</span>&nbsp;<span class="builtintype" id="3966983">uint32</span><span class="op" id="3966989">(</span><span class="ident" id="3966990">d</span><span class="op" id="3966991">[</span><span class="num" id="3966992">0</span><span class="op" id="3966993">]</span><span class="op" id="3966994">)</span><span class="op" id="3966995">&lt;&lt;</span><span class="num" id="3966997">16</span>&nbsp;<span class="op" id="3967000">|</span>&nbsp;<span class="builtintype" id="3967002">uint32</span><span class="op" id="3967008">(</span><span class="ident" id="3967009">d</span><span class="op" id="3967010">[</span><span class="num" id="3967011">1</span><span class="op" id="3967012">]</span><span class="op" id="3967013">)</span><span class="op" id="3967014">&lt;&lt;</span><span class="num" id="3967016">8</span>&nbsp;<span class="op" id="3967018">|</span>&nbsp;<span class="builtintype" id="3967020">uint32</span><span class="op" id="3967026">(</span><span class="ident" id="3967027">d</span><span class="op" id="3967028">[</span><span class="num" id="3967029">2</span><span class="op" id="3967030">]</span><span class="op" id="3967031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967035">m</span><span class="op" id="3967036">.</span><span class="ident" id="3967037">certificates</span><span class="op" id="3967049">[</span><span class="ident" id="3967050">i</span><span class="op" id="3967051">]</span>&nbsp;<span class="op" id="3967053">=</span>&nbsp;<span class="ident" id="3967055">d</span><span class="op" id="3967056">[</span><span class="num" id="3967057">3</span>&nbsp;<span class="op" id="3967059">:</span>&nbsp;<span class="num" id="3967061">3</span><span class="op" id="3967062">+</span><span class="ident" id="3967063">certLen</span><span class="op" id="3967070">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967074">d</span>&nbsp;<span class="op" id="3967076">=</span>&nbsp;<span class="ident" id="3967078">d</span><span class="op" id="3967079">[</span><span class="num" id="3967080">3</span><span class="op" id="3967081">+</span><span class="ident" id="3967082">certLen</span><span class="op" id="3967089">:</span><span class="op" id="3967090">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3967093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967097">return</span>&nbsp;<span class="ident" id="3967104">true</span><br>
<span class="lineno"></span><span class="op" id="3967109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3967112">type</span>&nbsp;<span class="ident" id="3967117">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3967138">struct</span>&nbsp;<span class="op" id="3967145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967148">raw</span>&nbsp;<span class="op" id="3967152">[</span><span class="op" id="3967153">]</span><span class="builtintype" id="3967154">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967160">key</span>&nbsp;<span class="op" id="3967164">[</span><span class="op" id="3967165">]</span><span class="builtintype" id="3967166">byte</span><br>
<span class="lineno"></span><span class="op" id="3967171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3967174">func</span>&nbsp;<span class="op" id="3967179">(</span><span class="ident" id="3967180">m</span>&nbsp;<span class="op" id="3967182">*</span><span class="ident" id="3967183">serverKeyExchangeMsg</span><span class="op" id="3967203">)</span>&nbsp;<span class="ident" id="3967205">equal</span><span class="op" id="3967210">(</span><span class="ident" id="3967211">i</span>&nbsp;<span class="keyword" id="3967213">interface</span><span class="op" id="3967222">{</span><span class="op" id="3967223">}</span><span class="op" id="3967224">)</span>&nbsp;<span class="builtintype" id="3967226">bool</span>&nbsp;<span class="op" id="3967231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967234">m1</span><span class="op" id="3967236">,</span>&nbsp;<span class="ident" id="3967238">ok</span>&nbsp;<span class="op" id="3967241">:=</span>&nbsp;<span class="ident" id="3967244">i</span><span class="op" id="3967245">.</span><span class="op" id="3967246">(</span><span class="op" id="3967247">*</span><span class="ident" id="3967248">serverKeyExchangeMsg</span><span class="op" id="3967268">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967271">if</span>&nbsp;<span class="op" id="3967274">!</span><span class="ident" id="3967275">ok</span>&nbsp;<span class="op" id="3967278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967282">return</span>&nbsp;<span class="ident" id="3967289">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3967296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967300">return</span>&nbsp;<span class="ident" id="3967307">bytes</span><span class="op" id="3967312">.</span><span class="ident" id="3967313">Equal</span><span class="op" id="3967318">(</span><span class="ident" id="3967319">m</span><span class="op" id="3967320">.</span><span class="ident" id="3967321">raw</span><span class="op" id="3967324">,</span>&nbsp;<span class="ident" id="3967326">m1</span><span class="op" id="3967328">.</span><span class="ident" id="3967329">raw</span><span class="op" id="3967332">)</span>&nbsp;<span class="op" id="3967334">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967339">bytes</span><span class="op" id="3967344">.</span><span class="ident" id="3967345">Equal</span><span class="op" id="3967350">(</span><span class="ident" id="3967351">m</span><span class="op" id="3967352">.</span><span class="ident" id="3967353">key</span><span class="op" id="3967356">,</span>&nbsp;<span class="ident" id="3967358">m1</span><span class="op" id="3967360">.</span><span class="ident" id="3967361">key</span><span class="op" id="3967364">)</span><br>
<span class="lineno"></span><span class="op" id="3967366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3967369">func</span>&nbsp;<span class="op" id="3967374">(</span><span class="ident" id="3967375">m</span>&nbsp;<span class="op" id="3967377">*</span><span class="ident" id="3967378">serverKeyExchangeMsg</span><span class="op" id="3967398">)</span>&nbsp;<span class="ident" id="3967400">marshal</span><span class="op" id="3967407">(</span><span class="op" id="3967408">)</span>&nbsp;<span class="op" id="3967410">[</span><span class="op" id="3967411">]</span><span class="builtintype" id="3967412">byte</span>&nbsp;<span class="op" id="3967417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967420">if</span>&nbsp;<span class="ident" id="3967423">m</span><span class="op" id="3967424">.</span><span class="ident" id="3967425">raw</span>&nbsp;<span class="op" id="3967429">!=</span>&nbsp;<span class="ident" id="3967432">nil</span>&nbsp;<span class="op" id="3967436">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967440">return</span>&nbsp;<span class="ident" id="3967447">m</span><span class="op" id="3967448">.</span><span class="ident" id="3967449">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3967454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967457">length</span>&nbsp;<span class="op" id="3967464">:=</span>&nbsp;<span class="builtinfunc" id="3967467">len</span><span class="op" id="3967470">(</span><span class="ident" id="3967471">m</span><span class="op" id="3967472">.</span><span class="ident" id="3967473">key</span><span class="op" id="3967476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967479">x</span>&nbsp;<span class="op" id="3967481">:=</span>&nbsp;<span class="builtinfunc" id="3967484">make</span><span class="op" id="3967488">(</span><span class="op" id="3967489">[</span><span class="op" id="3967490">]</span><span class="builtintype" id="3967491">byte</span><span class="op" id="3967495">,</span>&nbsp;<span class="ident" id="3967497">length</span><span class="op" id="3967503">+</span><span class="num" id="3967504">4</span><span class="op" id="3967505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967508">x</span><span class="op" id="3967509">[</span><span class="num" id="3967510">0</span><span class="op" id="3967511">]</span>&nbsp;<span class="op" id="3967513">=</span>&nbsp;<span class="ident" id="3967515">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967538">x</span><span class="op" id="3967539">[</span><span class="num" id="3967540">1</span><span class="op" id="3967541">]</span>&nbsp;<span class="op" id="3967543">=</span>&nbsp;<span class="builtintype" id="3967545">uint8</span><span class="op" id="3967550">(</span><span class="ident" id="3967551">length</span>&nbsp;<span class="op" id="3967558">&gt;&gt;</span>&nbsp;<span class="num" id="3967561">16</span><span class="op" id="3967563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967566">x</span><span class="op" id="3967567">[</span><span class="num" id="3967568">2</span><span class="op" id="3967569">]</span>&nbsp;<span class="op" id="3967571">=</span>&nbsp;<span class="builtintype" id="3967573">uint8</span><span class="op" id="3967578">(</span><span class="ident" id="3967579">length</span>&nbsp;<span class="op" id="3967586">&gt;&gt;</span>&nbsp;<span class="num" id="3967589">8</span><span class="op" id="3967590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967593">x</span><span class="op" id="3967594">[</span><span class="num" id="3967595">3</span><span class="op" id="3967596">]</span>&nbsp;<span class="op" id="3967598">=</span>&nbsp;<span class="builtintype" id="3967600">uint8</span><span class="op" id="3967605">(</span><span class="ident" id="3967606">length</span><span class="op" id="3967612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3967615">copy</span><span class="op" id="3967619">(</span><span class="ident" id="3967620">x</span><span class="op" id="3967621">[</span><span class="num" id="3967622">4</span><span class="op" id="3967623">:</span><span class="op" id="3967624">]</span><span class="op" id="3967625">,</span>&nbsp;<span class="ident" id="3967627">m</span><span class="op" id="3967628">.</span><span class="ident" id="3967629">key</span><span class="op" id="3967632">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967636">m</span><span class="op" id="3967637">.</span><span class="ident" id="3967638">raw</span>&nbsp;<span class="op" id="3967642">=</span>&nbsp;<span class="ident" id="3967644">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967647">return</span>&nbsp;<span class="ident" id="3967654">x</span><br>
<span class="lineno"></span><span class="op" id="3967656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3967659">func</span>&nbsp;<span class="op" id="3967664">(</span><span class="ident" id="3967665">m</span>&nbsp;<span class="op" id="3967667">*</span><span class="ident" id="3967668">serverKeyExchangeMsg</span><span class="op" id="3967688">)</span>&nbsp;<span class="ident" id="3967690">unmarshal</span><span class="op" id="3967699">(</span><span class="ident" id="3967700">data</span>&nbsp;<span class="op" id="3967705">[</span><span class="op" id="3967706">]</span><span class="builtintype" id="3967707">byte</span><span class="op" id="3967711">)</span>&nbsp;<span class="builtintype" id="3967713">bool</span>&nbsp;<span class="op" id="3967718">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967721">m</span><span class="op" id="3967722">.</span><span class="ident" id="3967723">raw</span>&nbsp;<span class="op" id="3967727">=</span>&nbsp;<span class="ident" id="3967729">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967735">if</span>&nbsp;<span class="builtinfunc" id="3967738">len</span><span class="op" id="3967741">(</span><span class="ident" id="3967742">data</span><span class="op" id="3967746">)</span>&nbsp;<span class="op" id="3967748">&lt;</span>&nbsp;<span class="num" id="3967750">4</span>&nbsp;<span class="op" id="3967752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967756">return</span>&nbsp;<span class="ident" id="3967763">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3967770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967773">m</span><span class="op" id="3967774">.</span><span class="ident" id="3967775">key</span>&nbsp;<span class="op" id="3967779">=</span>&nbsp;<span class="ident" id="3967781">data</span><span class="op" id="3967785">[</span><span class="num" id="3967786">4</span><span class="op" id="3967787">:</span><span class="op" id="3967788">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967791">return</span>&nbsp;<span class="ident" id="3967798">true</span><br>
<span class="lineno"></span><span class="op" id="3967803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3967806">type</span>&nbsp;<span class="ident" id="3967811">certificateStatusMsg</span>&nbsp;<span class="keyword" id="3967832">struct</span>&nbsp;<span class="op" id="3967839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967842">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3967853">[</span><span class="op" id="3967854">]</span><span class="builtintype" id="3967855">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967861">statusType</span>&nbsp;<span class="builtintype" id="3967872">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967879">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3967890">[</span><span class="op" id="3967891">]</span><span class="builtintype" id="3967892">byte</span><br>
<span class="lineno"></span><span class="op" id="3967897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3967900">func</span>&nbsp;<span class="op" id="3967905">(</span><span class="ident" id="3967906">m</span>&nbsp;<span class="op" id="3967908">*</span><span class="ident" id="3967909">certificateStatusMsg</span><span class="op" id="3967929">)</span>&nbsp;<span class="ident" id="3967931">equal</span><span class="op" id="3967936">(</span><span class="ident" id="3967937">i</span>&nbsp;<span class="keyword" id="3967939">interface</span><span class="op" id="3967948">{</span><span class="op" id="3967949">}</span><span class="op" id="3967950">)</span>&nbsp;<span class="builtintype" id="3967952">bool</span>&nbsp;<span class="op" id="3967957">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3967960">m1</span><span class="op" id="3967962">,</span>&nbsp;<span class="ident" id="3967964">ok</span>&nbsp;<span class="op" id="3967967">:=</span>&nbsp;<span class="ident" id="3967970">i</span><span class="op" id="3967971">.</span><span class="op" id="3967972">(</span><span class="op" id="3967973">*</span><span class="ident" id="3967974">certificateStatusMsg</span><span class="op" id="3967994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3967997">if</span>&nbsp;<span class="op" id="3968000">!</span><span class="ident" id="3968001">ok</span>&nbsp;<span class="op" id="3968004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968008">return</span>&nbsp;<span class="ident" id="3968015">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3968022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968026">return</span>&nbsp;<span class="ident" id="3968033">bytes</span><span class="op" id="3968038">.</span><span class="ident" id="3968039">Equal</span><span class="op" id="3968044">(</span><span class="ident" id="3968045">m</span><span class="op" id="3968046">.</span><span class="ident" id="3968047">raw</span><span class="op" id="3968050">,</span>&nbsp;<span class="ident" id="3968052">m1</span><span class="op" id="3968054">.</span><span class="ident" id="3968055">raw</span><span class="op" id="3968058">)</span>&nbsp;<span class="op" id="3968060">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968065">m</span><span class="op" id="3968066">.</span><span class="ident" id="3968067">statusType</span>&nbsp;<span class="op" id="3968078">==</span>&nbsp;<span class="ident" id="3968081">m1</span><span class="op" id="3968083">.</span><span class="ident" id="3968084">statusType</span>&nbsp;<span class="op" id="3968095">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968100">bytes</span><span class="op" id="3968105">.</span><span class="ident" id="3968106">Equal</span><span class="op" id="3968111">(</span><span class="ident" id="3968112">m</span><span class="op" id="3968113">.</span><span class="ident" id="3968114">response</span><span class="op" id="3968122">,</span>&nbsp;<span class="ident" id="3968124">m1</span><span class="op" id="3968126">.</span><span class="ident" id="3968127">response</span><span class="op" id="3968135">)</span><br>
<span class="lineno"></span><span class="op" id="3968137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3968140">func</span>&nbsp;<span class="op" id="3968145">(</span><span class="ident" id="3968146">m</span>&nbsp;<span class="op" id="3968148">*</span><span class="ident" id="3968149">certificateStatusMsg</span><span class="op" id="3968169">)</span>&nbsp;<span class="ident" id="3968171">marshal</span><span class="op" id="3968178">(</span><span class="op" id="3968179">)</span>&nbsp;<span class="op" id="3968181">[</span><span class="op" id="3968182">]</span><span class="builtintype" id="3968183">byte</span>&nbsp;<span class="op" id="3968188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968191">if</span>&nbsp;<span class="ident" id="3968194">m</span><span class="op" id="3968195">.</span><span class="ident" id="3968196">raw</span>&nbsp;<span class="op" id="3968200">!=</span>&nbsp;<span class="ident" id="3968203">nil</span>&nbsp;<span class="op" id="3968207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968211">return</span>&nbsp;<span class="ident" id="3968218">m</span><span class="op" id="3968219">.</span><span class="ident" id="3968220">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3968225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968229">var</span>&nbsp;<span class="ident" id="3968233">x</span>&nbsp;<span class="op" id="3968235">[</span><span class="op" id="3968236">]</span><span class="builtintype" id="3968237">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968243">if</span>&nbsp;<span class="ident" id="3968246">m</span><span class="op" id="3968247">.</span><span class="ident" id="3968248">statusType</span>&nbsp;<span class="op" id="3968259">==</span>&nbsp;<span class="ident" id="3968262">statusTypeOCSP</span>&nbsp;<span class="op" id="3968277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968281">x</span>&nbsp;<span class="op" id="3968283">=</span>&nbsp;<span class="builtinfunc" id="3968285">make</span><span class="op" id="3968289">(</span><span class="op" id="3968290">[</span><span class="op" id="3968291">]</span><span class="builtintype" id="3968292">byte</span><span class="op" id="3968296">,</span>&nbsp;<span class="num" id="3968298">4</span><span class="op" id="3968299">+</span><span class="num" id="3968300">4</span><span class="op" id="3968301">+</span><span class="builtinfunc" id="3968302">len</span><span class="op" id="3968305">(</span><span class="ident" id="3968306">m</span><span class="op" id="3968307">.</span><span class="ident" id="3968308">response</span><span class="op" id="3968316">)</span><span class="op" id="3968317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968321">x</span><span class="op" id="3968322">[</span><span class="num" id="3968323">0</span><span class="op" id="3968324">]</span>&nbsp;<span class="op" id="3968326">=</span>&nbsp;<span class="ident" id="3968328">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968352">l</span>&nbsp;<span class="op" id="3968354">:=</span>&nbsp;<span class="builtinfunc" id="3968357">len</span><span class="op" id="3968360">(</span><span class="ident" id="3968361">m</span><span class="op" id="3968362">.</span><span class="ident" id="3968363">response</span><span class="op" id="3968371">)</span>&nbsp;<span class="op" id="3968373">+</span>&nbsp;<span class="num" id="3968375">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968379">x</span><span class="op" id="3968380">[</span><span class="num" id="3968381">1</span><span class="op" id="3968382">]</span>&nbsp;<span class="op" id="3968384">=</span>&nbsp;<span class="builtintype" id="3968386">byte</span><span class="op" id="3968390">(</span><span class="ident" id="3968391">l</span>&nbsp;<span class="op" id="3968393">&gt;&gt;</span>&nbsp;<span class="num" id="3968396">16</span><span class="op" id="3968398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968402">x</span><span class="op" id="3968403">[</span><span class="num" id="3968404">2</span><span class="op" id="3968405">]</span>&nbsp;<span class="op" id="3968407">=</span>&nbsp;<span class="builtintype" id="3968409">byte</span><span class="op" id="3968413">(</span><span class="ident" id="3968414">l</span>&nbsp;<span class="op" id="3968416">&gt;&gt;</span>&nbsp;<span class="num" id="3968419">8</span><span class="op" id="3968420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968424">x</span><span class="op" id="3968425">[</span><span class="num" id="3968426">3</span><span class="op" id="3968427">]</span>&nbsp;<span class="op" id="3968429">=</span>&nbsp;<span class="builtintype" id="3968431">byte</span><span class="op" id="3968435">(</span><span class="ident" id="3968436">l</span><span class="op" id="3968437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968441">x</span><span class="op" id="3968442">[</span><span class="num" id="3968443">4</span><span class="op" id="3968444">]</span>&nbsp;<span class="op" id="3968446">=</span>&nbsp;<span class="ident" id="3968448">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968466">l</span>&nbsp;<span class="op" id="3968468">-=</span>&nbsp;<span class="num" id="3968471">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968475">x</span><span class="op" id="3968476">[</span><span class="num" id="3968477">5</span><span class="op" id="3968478">]</span>&nbsp;<span class="op" id="3968480">=</span>&nbsp;<span class="builtintype" id="3968482">byte</span><span class="op" id="3968486">(</span><span class="ident" id="3968487">l</span>&nbsp;<span class="op" id="3968489">&gt;&gt;</span>&nbsp;<span class="num" id="3968492">16</span><span class="op" id="3968494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968498">x</span><span class="op" id="3968499">[</span><span class="num" id="3968500">6</span><span class="op" id="3968501">]</span>&nbsp;<span class="op" id="3968503">=</span>&nbsp;<span class="builtintype" id="3968505">byte</span><span class="op" id="3968509">(</span><span class="ident" id="3968510">l</span>&nbsp;<span class="op" id="3968512">&gt;&gt;</span>&nbsp;<span class="num" id="3968515">8</span><span class="op" id="3968516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968520">x</span><span class="op" id="3968521">[</span><span class="num" id="3968522">7</span><span class="op" id="3968523">]</span>&nbsp;<span class="op" id="3968525">=</span>&nbsp;<span class="builtintype" id="3968527">byte</span><span class="op" id="3968531">(</span><span class="ident" id="3968532">l</span><span class="op" id="3968533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3968537">copy</span><span class="op" id="3968541">(</span><span class="ident" id="3968542">x</span><span class="op" id="3968543">[</span><span class="num" id="3968544">8</span><span class="op" id="3968545">:</span><span class="op" id="3968546">]</span><span class="op" id="3968547">,</span>&nbsp;<span class="ident" id="3968549">m</span><span class="op" id="3968550">.</span><span class="ident" id="3968551">response</span><span class="op" id="3968559">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3968562">}</span>&nbsp;<span class="keyword" id="3968564">else</span>&nbsp;<span class="op" id="3968569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968573">x</span>&nbsp;<span class="op" id="3968575">=</span>&nbsp;<span class="op" id="3968577">[</span><span class="op" id="3968578">]</span><span class="builtintype" id="3968579">byte</span><span class="op" id="3968583">{</span><span class="ident" id="3968584">typeCertificateStatus</span><span class="op" id="3968605">,</span>&nbsp;<span class="num" id="3968607">0</span><span class="op" id="3968608">,</span>&nbsp;<span class="num" id="3968610">0</span><span class="op" id="3968611">,</span>&nbsp;<span class="num" id="3968613">1</span><span class="op" id="3968614">,</span>&nbsp;<span class="ident" id="3968616">m</span><span class="op" id="3968617">.</span><span class="ident" id="3968618">statusType</span><span class="op" id="3968628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3968631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968635">m</span><span class="op" id="3968636">.</span><span class="ident" id="3968637">raw</span>&nbsp;<span class="op" id="3968641">=</span>&nbsp;<span class="ident" id="3968643">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968646">return</span>&nbsp;<span class="ident" id="3968653">x</span><br>
<span class="lineno"></span><span class="op" id="3968655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3968658">func</span>&nbsp;<span class="op" id="3968663">(</span><span class="ident" id="3968664">m</span>&nbsp;<span class="op" id="3968666">*</span><span class="ident" id="3968667">certificateStatusMsg</span><span class="op" id="3968687">)</span>&nbsp;<span class="ident" id="3968689">unmarshal</span><span class="op" id="3968698">(</span><span class="ident" id="3968699">data</span>&nbsp;<span class="op" id="3968704">[</span><span class="op" id="3968705">]</span><span class="builtintype" id="3968706">byte</span><span class="op" id="3968710">)</span>&nbsp;<span class="builtintype" id="3968712">bool</span>&nbsp;<span class="op" id="3968717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968720">m</span><span class="op" id="3968721">.</span><span class="ident" id="3968722">raw</span>&nbsp;<span class="op" id="3968726">=</span>&nbsp;<span class="ident" id="3968728">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968734">if</span>&nbsp;<span class="builtinfunc" id="3968737">len</span><span class="op" id="3968740">(</span><span class="ident" id="3968741">data</span><span class="op" id="3968745">)</span>&nbsp;<span class="op" id="3968747">&lt;</span>&nbsp;<span class="num" id="3968749">5</span>&nbsp;<span class="op" id="3968751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968755">return</span>&nbsp;<span class="ident" id="3968762">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3968769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968772">m</span><span class="op" id="3968773">.</span><span class="ident" id="3968774">statusType</span>&nbsp;<span class="op" id="3968785">=</span>&nbsp;<span class="ident" id="3968787">data</span><span class="op" id="3968791">[</span><span class="num" id="3968792">4</span><span class="op" id="3968793">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968797">m</span><span class="op" id="3968798">.</span><span class="ident" id="3968799">response</span>&nbsp;<span class="op" id="3968808">=</span>&nbsp;<span class="ident" id="3968810">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968815">if</span>&nbsp;<span class="ident" id="3968818">m</span><span class="op" id="3968819">.</span><span class="ident" id="3968820">statusType</span>&nbsp;<span class="op" id="3968831">==</span>&nbsp;<span class="ident" id="3968834">statusTypeOCSP</span>&nbsp;<span class="op" id="3968849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968853">if</span>&nbsp;<span class="builtinfunc" id="3968856">len</span><span class="op" id="3968859">(</span><span class="ident" id="3968860">data</span><span class="op" id="3968864">)</span>&nbsp;<span class="op" id="3968866">&lt;</span>&nbsp;<span class="num" id="3968868">8</span>&nbsp;<span class="op" id="3968870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968875">return</span>&nbsp;<span class="ident" id="3968882">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3968890">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968894">respLen</span>&nbsp;<span class="op" id="3968902">:=</span>&nbsp;<span class="builtintype" id="3968905">uint32</span><span class="op" id="3968911">(</span><span class="ident" id="3968912">data</span><span class="op" id="3968916">[</span><span class="num" id="3968917">5</span><span class="op" id="3968918">]</span><span class="op" id="3968919">)</span><span class="op" id="3968920">&lt;&lt;</span><span class="num" id="3968922">16</span>&nbsp;<span class="op" id="3968925">|</span>&nbsp;<span class="builtintype" id="3968927">uint32</span><span class="op" id="3968933">(</span><span class="ident" id="3968934">data</span><span class="op" id="3968938">[</span><span class="num" id="3968939">6</span><span class="op" id="3968940">]</span><span class="op" id="3968941">)</span><span class="op" id="3968942">&lt;&lt;</span><span class="num" id="3968944">8</span>&nbsp;<span class="op" id="3968946">|</span>&nbsp;<span class="builtintype" id="3968948">uint32</span><span class="op" id="3968954">(</span><span class="ident" id="3968955">data</span><span class="op" id="3968959">[</span><span class="num" id="3968960">7</span><span class="op" id="3968961">]</span><span class="op" id="3968962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968966">if</span>&nbsp;<span class="builtintype" id="3968969">uint32</span><span class="op" id="3968975">(</span><span class="builtinfunc" id="3968976">len</span><span class="op" id="3968979">(</span><span class="ident" id="3968980">data</span><span class="op" id="3968984">)</span><span class="op" id="3968985">)</span>&nbsp;<span class="op" id="3968987">!=</span>&nbsp;<span class="num" id="3968990">4</span><span class="op" id="3968991">+</span><span class="num" id="3968992">4</span><span class="op" id="3968993">+</span><span class="ident" id="3968994">respLen</span>&nbsp;<span class="op" id="3969002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969007">return</span>&nbsp;<span class="ident" id="3969014">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3969022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969026">m</span><span class="op" id="3969027">.</span><span class="ident" id="3969028">response</span>&nbsp;<span class="op" id="3969037">=</span>&nbsp;<span class="ident" id="3969039">data</span><span class="op" id="3969043">[</span><span class="num" id="3969044">8</span><span class="op" id="3969045">:</span><span class="op" id="3969046">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3969049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969052">return</span>&nbsp;<span class="ident" id="3969059">true</span><br>
<span class="lineno"></span><span class="op" id="3969064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3969067">type</span>&nbsp;<span class="ident" id="3969072">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="3969091">struct</span><span class="op" id="3969097">{</span><span class="op" id="3969098">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="3969101">func</span>&nbsp;<span class="op" id="3969106">(</span><span class="ident" id="3969107">m</span>&nbsp;<span class="op" id="3969109">*</span><span class="ident" id="3969110">serverHelloDoneMsg</span><span class="op" id="3969128">)</span>&nbsp;<span class="ident" id="3969130">equal</span><span class="op" id="3969135">(</span><span class="ident" id="3969136">i</span>&nbsp;<span class="keyword" id="3969138">interface</span><span class="op" id="3969147">{</span><span class="op" id="3969148">}</span><span class="op" id="3969149">)</span>&nbsp;<span class="builtintype" id="3969151">bool</span>&nbsp;<span class="op" id="3969156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969159">_</span><span class="op" id="3969160">,</span>&nbsp;<span class="ident" id="3969162">ok</span>&nbsp;<span class="op" id="3969165">:=</span>&nbsp;<span class="ident" id="3969168">i</span><span class="op" id="3969169">.</span><span class="op" id="3969170">(</span><span class="op" id="3969171">*</span><span class="ident" id="3969172">serverHelloDoneMsg</span><span class="op" id="3969190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969193">return</span>&nbsp;<span class="ident" id="3969200">ok</span><br>
<span class="lineno"></span><span class="op" id="3969203">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="3969206">func</span>&nbsp;<span class="op" id="3969211">(</span><span class="ident" id="3969212">m</span>&nbsp;<span class="op" id="3969214">*</span><span class="ident" id="3969215">serverHelloDoneMsg</span><span class="op" id="3969233">)</span>&nbsp;<span class="ident" id="3969235">marshal</span><span class="op" id="3969242">(</span><span class="op" id="3969243">)</span>&nbsp;<span class="op" id="3969245">[</span><span class="op" id="3969246">]</span><span class="builtintype" id="3969247">byte</span>&nbsp;<span class="op" id="3969252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969255">x</span>&nbsp;<span class="op" id="3969257">:=</span>&nbsp;<span class="builtinfunc" id="3969260">make</span><span class="op" id="3969264">(</span><span class="op" id="3969265">[</span><span class="op" id="3969266">]</span><span class="builtintype" id="3969267">byte</span><span class="op" id="3969271">,</span>&nbsp;<span class="num" id="3969273">4</span><span class="op" id="3969274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969277">x</span><span class="op" id="3969278">[</span><span class="num" id="3969279">0</span><span class="op" id="3969280">]</span>&nbsp;<span class="op" id="3969282">=</span>&nbsp;<span class="ident" id="3969284">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969305">return</span>&nbsp;<span class="ident" id="3969312">x</span><br>
<span class="lineno">920</span><span class="op" id="3969314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3969317">func</span>&nbsp;<span class="op" id="3969322">(</span><span class="ident" id="3969323">m</span>&nbsp;<span class="op" id="3969325">*</span><span class="ident" id="3969326">serverHelloDoneMsg</span><span class="op" id="3969344">)</span>&nbsp;<span class="ident" id="3969346">unmarshal</span><span class="op" id="3969355">(</span><span class="ident" id="3969356">data</span>&nbsp;<span class="op" id="3969361">[</span><span class="op" id="3969362">]</span><span class="builtintype" id="3969363">byte</span><span class="op" id="3969367">)</span>&nbsp;<span class="builtintype" id="3969369">bool</span>&nbsp;<span class="op" id="3969374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969377">return</span>&nbsp;<span class="builtinfunc" id="3969384">len</span><span class="op" id="3969387">(</span><span class="ident" id="3969388">data</span><span class="op" id="3969392">)</span>&nbsp;<span class="op" id="3969394">==</span>&nbsp;<span class="num" id="3969397">4</span><br>
<span class="lineno"></span><span class="op" id="3969399">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="3969402">type</span>&nbsp;<span class="ident" id="3969407">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3969428">struct</span>&nbsp;<span class="op" id="3969435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969438">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969449">[</span><span class="op" id="3969450">]</span><span class="builtintype" id="3969451">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969457">ciphertext</span>&nbsp;<span class="op" id="3969468">[</span><span class="op" id="3969469">]</span><span class="builtintype" id="3969470">byte</span><br>
<span class="lineno"></span><span class="op" id="3969475">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="3969478">func</span>&nbsp;<span class="op" id="3969483">(</span><span class="ident" id="3969484">m</span>&nbsp;<span class="op" id="3969486">*</span><span class="ident" id="3969487">clientKeyExchangeMsg</span><span class="op" id="3969507">)</span>&nbsp;<span class="ident" id="3969509">equal</span><span class="op" id="3969514">(</span><span class="ident" id="3969515">i</span>&nbsp;<span class="keyword" id="3969517">interface</span><span class="op" id="3969526">{</span><span class="op" id="3969527">}</span><span class="op" id="3969528">)</span>&nbsp;<span class="builtintype" id="3969530">bool</span>&nbsp;<span class="op" id="3969535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969538">m1</span><span class="op" id="3969540">,</span>&nbsp;<span class="ident" id="3969542">ok</span>&nbsp;<span class="op" id="3969545">:=</span>&nbsp;<span class="ident" id="3969548">i</span><span class="op" id="3969549">.</span><span class="op" id="3969550">(</span><span class="op" id="3969551">*</span><span class="ident" id="3969552">clientKeyExchangeMsg</span><span class="op" id="3969572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969575">if</span>&nbsp;<span class="op" id="3969578">!</span><span class="ident" id="3969579">ok</span>&nbsp;<span class="op" id="3969582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969586">return</span>&nbsp;<span class="ident" id="3969593">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3969600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969604">return</span>&nbsp;<span class="ident" id="3969611">bytes</span><span class="op" id="3969616">.</span><span class="ident" id="3969617">Equal</span><span class="op" id="3969622">(</span><span class="ident" id="3969623">m</span><span class="op" id="3969624">.</span><span class="ident" id="3969625">raw</span><span class="op" id="3969628">,</span>&nbsp;<span class="ident" id="3969630">m1</span><span class="op" id="3969632">.</span><span class="ident" id="3969633">raw</span><span class="op" id="3969636">)</span>&nbsp;<span class="op" id="3969638">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969643">bytes</span><span class="op" id="3969648">.</span><span class="ident" id="3969649">Equal</span><span class="op" id="3969654">(</span><span class="ident" id="3969655">m</span><span class="op" id="3969656">.</span><span class="ident" id="3969657">ciphertext</span><span class="op" id="3969667">,</span>&nbsp;<span class="ident" id="3969669">m1</span><span class="op" id="3969671">.</span><span class="ident" id="3969672">ciphertext</span><span class="op" id="3969682">)</span><br>
<span class="lineno"></span><span class="op" id="3969684">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="3969687">func</span>&nbsp;<span class="op" id="3969692">(</span><span class="ident" id="3969693">m</span>&nbsp;<span class="op" id="3969695">*</span><span class="ident" id="3969696">clientKeyExchangeMsg</span><span class="op" id="3969716">)</span>&nbsp;<span class="ident" id="3969718">marshal</span><span class="op" id="3969725">(</span><span class="op" id="3969726">)</span>&nbsp;<span class="op" id="3969728">[</span><span class="op" id="3969729">]</span><span class="builtintype" id="3969730">byte</span>&nbsp;<span class="op" id="3969735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969738">if</span>&nbsp;<span class="ident" id="3969741">m</span><span class="op" id="3969742">.</span><span class="ident" id="3969743">raw</span>&nbsp;<span class="op" id="3969747">!=</span>&nbsp;<span class="ident" id="3969750">nil</span>&nbsp;<span class="op" id="3969754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969758">return</span>&nbsp;<span class="ident" id="3969765">m</span><span class="op" id="3969766">.</span><span class="ident" id="3969767">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3969772">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969775">length</span>&nbsp;<span class="op" id="3969782">:=</span>&nbsp;<span class="builtinfunc" id="3969785">len</span><span class="op" id="3969788">(</span><span class="ident" id="3969789">m</span><span class="op" id="3969790">.</span><span class="ident" id="3969791">ciphertext</span><span class="op" id="3969801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969804">x</span>&nbsp;<span class="op" id="3969806">:=</span>&nbsp;<span class="builtinfunc" id="3969809">make</span><span class="op" id="3969813">(</span><span class="op" id="3969814">[</span><span class="op" id="3969815">]</span><span class="builtintype" id="3969816">byte</span><span class="op" id="3969820">,</span>&nbsp;<span class="ident" id="3969822">length</span><span class="op" id="3969828">+</span><span class="num" id="3969829">4</span><span class="op" id="3969830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969833">x</span><span class="op" id="3969834">[</span><span class="num" id="3969835">0</span><span class="op" id="3969836">]</span>&nbsp;<span class="op" id="3969838">=</span>&nbsp;<span class="ident" id="3969840">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969863">x</span><span class="op" id="3969864">[</span><span class="num" id="3969865">1</span><span class="op" id="3969866">]</span>&nbsp;<span class="op" id="3969868">=</span>&nbsp;<span class="builtintype" id="3969870">uint8</span><span class="op" id="3969875">(</span><span class="ident" id="3969876">length</span>&nbsp;<span class="op" id="3969883">&gt;&gt;</span>&nbsp;<span class="num" id="3969886">16</span><span class="op" id="3969888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969891">x</span><span class="op" id="3969892">[</span><span class="num" id="3969893">2</span><span class="op" id="3969894">]</span>&nbsp;<span class="op" id="3969896">=</span>&nbsp;<span class="builtintype" id="3969898">uint8</span><span class="op" id="3969903">(</span><span class="ident" id="3969904">length</span>&nbsp;<span class="op" id="3969911">&gt;&gt;</span>&nbsp;<span class="num" id="3969914">8</span><span class="op" id="3969915">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969918">x</span><span class="op" id="3969919">[</span><span class="num" id="3969920">3</span><span class="op" id="3969921">]</span>&nbsp;<span class="op" id="3969923">=</span>&nbsp;<span class="builtintype" id="3969925">uint8</span><span class="op" id="3969930">(</span><span class="ident" id="3969931">length</span><span class="op" id="3969937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3969940">copy</span><span class="op" id="3969944">(</span><span class="ident" id="3969945">x</span><span class="op" id="3969946">[</span><span class="num" id="3969947">4</span><span class="op" id="3969948">:</span><span class="op" id="3969949">]</span><span class="op" id="3969950">,</span>&nbsp;<span class="ident" id="3969952">m</span><span class="op" id="3969953">.</span><span class="ident" id="3969954">ciphertext</span><span class="op" id="3969964">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3969968">m</span><span class="op" id="3969969">.</span><span class="ident" id="3969970">raw</span>&nbsp;<span class="op" id="3969974">=</span>&nbsp;<span class="ident" id="3969976">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3969979">return</span>&nbsp;<span class="ident" id="3969986">x</span><br>
<span class="lineno">955</span><span class="op" id="3969988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3969991">func</span>&nbsp;<span class="op" id="3969996">(</span><span class="ident" id="3969997">m</span>&nbsp;<span class="op" id="3969999">*</span><span class="ident" id="3970000">clientKeyExchangeMsg</span><span class="op" id="3970020">)</span>&nbsp;<span class="ident" id="3970022">unmarshal</span><span class="op" id="3970031">(</span><span class="ident" id="3970032">data</span>&nbsp;<span class="op" id="3970037">[</span><span class="op" id="3970038">]</span><span class="builtintype" id="3970039">byte</span><span class="op" id="3970043">)</span>&nbsp;<span class="builtintype" id="3970045">bool</span>&nbsp;<span class="op" id="3970050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970053">m</span><span class="op" id="3970054">.</span><span class="ident" id="3970055">raw</span>&nbsp;<span class="op" id="3970059">=</span>&nbsp;<span class="ident" id="3970061">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970067">if</span>&nbsp;<span class="builtinfunc" id="3970070">len</span><span class="op" id="3970073">(</span><span class="ident" id="3970074">data</span><span class="op" id="3970078">)</span>&nbsp;<span class="op" id="3970080">&lt;</span>&nbsp;<span class="num" id="3970082">4</span>&nbsp;<span class="op" id="3970084">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970088">return</span>&nbsp;<span class="ident" id="3970095">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3970102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970105">l</span>&nbsp;<span class="op" id="3970107">:=</span>&nbsp;<span class="builtintype" id="3970110">int</span><span class="op" id="3970113">(</span><span class="ident" id="3970114">data</span><span class="op" id="3970118">[</span><span class="num" id="3970119">1</span><span class="op" id="3970120">]</span><span class="op" id="3970121">)</span><span class="op" id="3970122">&lt;&lt;</span><span class="num" id="3970124">16</span>&nbsp;<span class="op" id="3970127">|</span>&nbsp;<span class="builtintype" id="3970129">int</span><span class="op" id="3970132">(</span><span class="ident" id="3970133">data</span><span class="op" id="3970137">[</span><span class="num" id="3970138">2</span><span class="op" id="3970139">]</span><span class="op" id="3970140">)</span><span class="op" id="3970141">&lt;&lt;</span><span class="num" id="3970143">8</span>&nbsp;<span class="op" id="3970145">|</span>&nbsp;<span class="builtintype" id="3970147">int</span><span class="op" id="3970150">(</span><span class="ident" id="3970151">data</span><span class="op" id="3970155">[</span><span class="num" id="3970156">3</span><span class="op" id="3970157">]</span><span class="op" id="3970158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970161">if</span>&nbsp;<span class="ident" id="3970164">l</span>&nbsp;<span class="op" id="3970166">!=</span>&nbsp;<span class="builtinfunc" id="3970169">len</span><span class="op" id="3970172">(</span><span class="ident" id="3970173">data</span><span class="op" id="3970177">)</span><span class="op" id="3970178">-</span><span class="num" id="3970179">4</span>&nbsp;<span class="op" id="3970181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970185">return</span>&nbsp;<span class="ident" id="3970192">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3970199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970202">m</span><span class="op" id="3970203">.</span><span class="ident" id="3970204">ciphertext</span>&nbsp;<span class="op" id="3970215">=</span>&nbsp;<span class="ident" id="3970217">data</span><span class="op" id="3970221">[</span><span class="num" id="3970222">4</span><span class="op" id="3970223">:</span><span class="op" id="3970224">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970227">return</span>&nbsp;<span class="ident" id="3970234">true</span><br>
<span class="lineno"></span><span class="op" id="3970239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="3970242">type</span>&nbsp;<span class="ident" id="3970247">finishedMsg</span>&nbsp;<span class="keyword" id="3970259">struct</span>&nbsp;<span class="op" id="3970266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970269">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3970280">[</span><span class="op" id="3970281">]</span><span class="builtintype" id="3970282">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970288">verifyData</span>&nbsp;<span class="op" id="3970299">[</span><span class="op" id="3970300">]</span><span class="builtintype" id="3970301">byte</span><br>
<span class="lineno"></span><span class="op" id="3970306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="3970309">func</span>&nbsp;<span class="op" id="3970314">(</span><span class="ident" id="3970315">m</span>&nbsp;<span class="op" id="3970317">*</span><span class="ident" id="3970318">finishedMsg</span><span class="op" id="3970329">)</span>&nbsp;<span class="ident" id="3970331">equal</span><span class="op" id="3970336">(</span><span class="ident" id="3970337">i</span>&nbsp;<span class="keyword" id="3970339">interface</span><span class="op" id="3970348">{</span><span class="op" id="3970349">}</span><span class="op" id="3970350">)</span>&nbsp;<span class="builtintype" id="3970352">bool</span>&nbsp;<span class="op" id="3970357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970360">m1</span><span class="op" id="3970362">,</span>&nbsp;<span class="ident" id="3970364">ok</span>&nbsp;<span class="op" id="3970367">:=</span>&nbsp;<span class="ident" id="3970370">i</span><span class="op" id="3970371">.</span><span class="op" id="3970372">(</span><span class="op" id="3970373">*</span><span class="ident" id="3970374">finishedMsg</span><span class="op" id="3970385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970388">if</span>&nbsp;<span class="op" id="3970391">!</span><span class="ident" id="3970392">ok</span>&nbsp;<span class="op" id="3970395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970399">return</span>&nbsp;<span class="ident" id="3970406">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3970413">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970417">return</span>&nbsp;<span class="ident" id="3970424">bytes</span><span class="op" id="3970429">.</span><span class="ident" id="3970430">Equal</span><span class="op" id="3970435">(</span><span class="ident" id="3970436">m</span><span class="op" id="3970437">.</span><span class="ident" id="3970438">raw</span><span class="op" id="3970441">,</span>&nbsp;<span class="ident" id="3970443">m1</span><span class="op" id="3970445">.</span><span class="ident" id="3970446">raw</span><span class="op" id="3970449">)</span>&nbsp;<span class="op" id="3970451">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970456">bytes</span><span class="op" id="3970461">.</span><span class="ident" id="3970462">Equal</span><span class="op" id="3970467">(</span><span class="ident" id="3970468">m</span><span class="op" id="3970469">.</span><span class="ident" id="3970470">verifyData</span><span class="op" id="3970480">,</span>&nbsp;<span class="ident" id="3970482">m1</span><span class="op" id="3970484">.</span><span class="ident" id="3970485">verifyData</span><span class="op" id="3970495">)</span><br>
<span class="lineno"></span><span class="op" id="3970497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="3970500">func</span>&nbsp;<span class="op" id="3970505">(</span><span class="ident" id="3970506">m</span>&nbsp;<span class="op" id="3970508">*</span><span class="ident" id="3970509">finishedMsg</span><span class="op" id="3970520">)</span>&nbsp;<span class="ident" id="3970522">marshal</span><span class="op" id="3970529">(</span><span class="op" id="3970530">)</span>&nbsp;<span class="op" id="3970532">(</span><span class="ident" id="3970533">x</span>&nbsp;<span class="op" id="3970535">[</span><span class="op" id="3970536">]</span><span class="builtintype" id="3970537">byte</span><span class="op" id="3970541">)</span>&nbsp;<span class="op" id="3970543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970546">if</span>&nbsp;<span class="ident" id="3970549">m</span><span class="op" id="3970550">.</span><span class="ident" id="3970551">raw</span>&nbsp;<span class="op" id="3970555">!=</span>&nbsp;<span class="ident" id="3970558">nil</span>&nbsp;<span class="op" id="3970562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970566">return</span>&nbsp;<span class="ident" id="3970573">m</span><span class="op" id="3970574">.</span><span class="ident" id="3970575">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3970580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970584">x</span>&nbsp;<span class="op" id="3970586">=</span>&nbsp;<span class="builtinfunc" id="3970588">make</span><span class="op" id="3970592">(</span><span class="op" id="3970593">[</span><span class="op" id="3970594">]</span><span class="builtintype" id="3970595">byte</span><span class="op" id="3970599">,</span>&nbsp;<span class="num" id="3970601">4</span><span class="op" id="3970602">+</span><span class="builtinfunc" id="3970603">len</span><span class="op" id="3970606">(</span><span class="ident" id="3970607">m</span><span class="op" id="3970608">.</span><span class="ident" id="3970609">verifyData</span><span class="op" id="3970619">)</span><span class="op" id="3970620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970623">x</span><span class="op" id="3970624">[</span><span class="num" id="3970625">0</span><span class="op" id="3970626">]</span>&nbsp;<span class="op" id="3970628">=</span>&nbsp;<span class="ident" id="3970630">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970644">x</span><span class="op" id="3970645">[</span><span class="num" id="3970646">3</span><span class="op" id="3970647">]</span>&nbsp;<span class="op" id="3970649">=</span>&nbsp;<span class="builtintype" id="3970651">byte</span><span class="op" id="3970655">(</span><span class="builtinfunc" id="3970656">len</span><span class="op" id="3970659">(</span><span class="ident" id="3970660">m</span><span class="op" id="3970661">.</span><span class="ident" id="3970662">verifyData</span><span class="op" id="3970672">)</span><span class="op" id="3970673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3970676">copy</span><span class="op" id="3970680">(</span><span class="ident" id="3970681">x</span><span class="op" id="3970682">[</span><span class="num" id="3970683">4</span><span class="op" id="3970684">:</span><span class="op" id="3970685">]</span><span class="op" id="3970686">,</span>&nbsp;<span class="ident" id="3970688">m</span><span class="op" id="3970689">.</span><span class="ident" id="3970690">verifyData</span><span class="op" id="3970700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970703">m</span><span class="op" id="3970704">.</span><span class="ident" id="3970705">raw</span>&nbsp;<span class="op" id="3970709">=</span>&nbsp;<span class="ident" id="3970711">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970714">return</span><br>
<span class="lineno"></span><span class="op" id="3970721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3970724">func</span>&nbsp;<span class="op" id="3970729">(</span><span class="ident" id="3970730">m</span>&nbsp;<span class="op" id="3970732">*</span><span class="ident" id="3970733">finishedMsg</span><span class="op" id="3970744">)</span>&nbsp;<span class="ident" id="3970746">unmarshal</span><span class="op" id="3970755">(</span><span class="ident" id="3970756">data</span>&nbsp;<span class="op" id="3970761">[</span><span class="op" id="3970762">]</span><span class="builtintype" id="3970763">byte</span><span class="op" id="3970767">)</span>&nbsp;<span class="builtintype" id="3970769">bool</span>&nbsp;<span class="op" id="3970774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970777">m</span><span class="op" id="3970778">.</span><span class="ident" id="3970779">raw</span>&nbsp;<span class="op" id="3970783">=</span>&nbsp;<span class="ident" id="3970785">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970791">if</span>&nbsp;<span class="builtinfunc" id="3970794">len</span><span class="op" id="3970797">(</span><span class="ident" id="3970798">data</span><span class="op" id="3970802">)</span>&nbsp;<span class="op" id="3970804">&lt;</span>&nbsp;<span class="num" id="3970806">4</span>&nbsp;<span class="op" id="3970808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970812">return</span>&nbsp;<span class="ident" id="3970819">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3970826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970829">m</span><span class="op" id="3970830">.</span><span class="ident" id="3970831">verifyData</span>&nbsp;<span class="op" id="3970842">=</span>&nbsp;<span class="ident" id="3970844">data</span><span class="op" id="3970848">[</span><span class="num" id="3970849">4</span><span class="op" id="3970850">:</span><span class="op" id="3970851">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3970854">return</span>&nbsp;<span class="ident" id="3970861">true</span><br>
<span class="lineno">1005</span><span class="op" id="3970866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3970869">type</span>&nbsp;<span class="ident" id="3970874">nextProtoMsg</span>&nbsp;<span class="keyword" id="3970887">struct</span>&nbsp;<span class="op" id="3970894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970897">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3970903">[</span><span class="op" id="3970904">]</span><span class="builtintype" id="3970905">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970911">proto</span>&nbsp;<span class="builtintype" id="3970917">string</span><br>
<span class="lineno">1010</span><span class="op" id="3970924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3970927">func</span>&nbsp;<span class="op" id="3970932">(</span><span class="ident" id="3970933">m</span>&nbsp;<span class="op" id="3970935">*</span><span class="ident" id="3970936">nextProtoMsg</span><span class="op" id="3970948">)</span>&nbsp;<span class="ident" id="3970950">equal</span><span class="op" id="3970955">(</span><span class="ident" id="3970956">i</span>&nbsp;<span class="keyword" id="3970958">interface</span><span class="op" id="3970967">{</span><span class="op" id="3970968">}</span><span class="op" id="3970969">)</span>&nbsp;<span class="builtintype" id="3970971">bool</span>&nbsp;<span class="op" id="3970976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3970979">m1</span><span class="op" id="3970981">,</span>&nbsp;<span class="ident" id="3970983">ok</span>&nbsp;<span class="op" id="3970986">:=</span>&nbsp;<span class="ident" id="3970989">i</span><span class="op" id="3970990">.</span><span class="op" id="3970991">(</span><span class="op" id="3970992">*</span><span class="ident" id="3970993">nextProtoMsg</span><span class="op" id="3971005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971008">if</span>&nbsp;<span class="op" id="3971011">!</span><span class="ident" id="3971012">ok</span>&nbsp;<span class="op" id="3971015">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971019">return</span>&nbsp;<span class="ident" id="3971026">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3971033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971037">return</span>&nbsp;<span class="ident" id="3971044">bytes</span><span class="op" id="3971049">.</span><span class="ident" id="3971050">Equal</span><span class="op" id="3971055">(</span><span class="ident" id="3971056">m</span><span class="op" id="3971057">.</span><span class="ident" id="3971058">raw</span><span class="op" id="3971061">,</span>&nbsp;<span class="ident" id="3971063">m1</span><span class="op" id="3971065">.</span><span class="ident" id="3971066">raw</span><span class="op" id="3971069">)</span>&nbsp;<span class="op" id="3971071">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971076">m</span><span class="op" id="3971077">.</span><span class="ident" id="3971078">proto</span>&nbsp;<span class="op" id="3971084">==</span>&nbsp;<span class="ident" id="3971087">m1</span><span class="op" id="3971089">.</span><span class="ident" id="3971090">proto</span><br>
<span class="lineno">1020</span><span class="op" id="3971096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3971099">func</span>&nbsp;<span class="op" id="3971104">(</span><span class="ident" id="3971105">m</span>&nbsp;<span class="op" id="3971107">*</span><span class="ident" id="3971108">nextProtoMsg</span><span class="op" id="3971120">)</span>&nbsp;<span class="ident" id="3971122">marshal</span><span class="op" id="3971129">(</span><span class="op" id="3971130">)</span>&nbsp;<span class="op" id="3971132">[</span><span class="op" id="3971133">]</span><span class="builtintype" id="3971134">byte</span>&nbsp;<span class="op" id="3971139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971142">if</span>&nbsp;<span class="ident" id="3971145">m</span><span class="op" id="3971146">.</span><span class="ident" id="3971147">raw</span>&nbsp;<span class="op" id="3971151">!=</span>&nbsp;<span class="ident" id="3971154">nil</span>&nbsp;<span class="op" id="3971158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971162">return</span>&nbsp;<span class="ident" id="3971169">m</span><span class="op" id="3971170">.</span><span class="ident" id="3971171">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3971176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971179">l</span>&nbsp;<span class="op" id="3971181">:=</span>&nbsp;<span class="builtinfunc" id="3971184">len</span><span class="op" id="3971187">(</span><span class="ident" id="3971188">m</span><span class="op" id="3971189">.</span><span class="ident" id="3971190">proto</span><span class="op" id="3971195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971198">if</span>&nbsp;<span class="ident" id="3971201">l</span>&nbsp;<span class="op" id="3971203">&gt;</span>&nbsp;<span class="num" id="3971205">255</span>&nbsp;<span class="op" id="3971209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971213">l</span>&nbsp;<span class="op" id="3971215">=</span>&nbsp;<span class="num" id="3971217">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3971222">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971226">padding</span>&nbsp;<span class="op" id="3971234">:=</span>&nbsp;<span class="num" id="3971237">32</span>&nbsp;<span class="op" id="3971240">-</span>&nbsp;<span class="op" id="3971242">(</span><span class="ident" id="3971243">l</span><span class="op" id="3971244">+</span><span class="num" id="3971245">2</span><span class="op" id="3971246">)</span><span class="op" id="3971247">%</span><span class="num" id="3971248">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971252">length</span>&nbsp;<span class="op" id="3971259">:=</span>&nbsp;<span class="ident" id="3971262">l</span>&nbsp;<span class="op" id="3971264">+</span>&nbsp;<span class="ident" id="3971266">padding</span>&nbsp;<span class="op" id="3971274">+</span>&nbsp;<span class="num" id="3971276">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971279">x</span>&nbsp;<span class="op" id="3971281">:=</span>&nbsp;<span class="builtinfunc" id="3971284">make</span><span class="op" id="3971288">(</span><span class="op" id="3971289">[</span><span class="op" id="3971290">]</span><span class="builtintype" id="3971291">byte</span><span class="op" id="3971295">,</span>&nbsp;<span class="ident" id="3971297">length</span><span class="op" id="3971303">+</span><span class="num" id="3971304">4</span><span class="op" id="3971305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971308">x</span><span class="op" id="3971309">[</span><span class="num" id="3971310">0</span><span class="op" id="3971311">]</span>&nbsp;<span class="op" id="3971313">=</span>&nbsp;<span class="ident" id="3971315">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971333">x</span><span class="op" id="3971334">[</span><span class="num" id="3971335">1</span><span class="op" id="3971336">]</span>&nbsp;<span class="op" id="3971338">=</span>&nbsp;<span class="builtintype" id="3971340">uint8</span><span class="op" id="3971345">(</span><span class="ident" id="3971346">length</span>&nbsp;<span class="op" id="3971353">&gt;&gt;</span>&nbsp;<span class="num" id="3971356">16</span><span class="op" id="3971358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971361">x</span><span class="op" id="3971362">[</span><span class="num" id="3971363">2</span><span class="op" id="3971364">]</span>&nbsp;<span class="op" id="3971366">=</span>&nbsp;<span class="builtintype" id="3971368">uint8</span><span class="op" id="3971373">(</span><span class="ident" id="3971374">length</span>&nbsp;<span class="op" id="3971381">&gt;&gt;</span>&nbsp;<span class="num" id="3971384">8</span><span class="op" id="3971385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971388">x</span><span class="op" id="3971389">[</span><span class="num" id="3971390">3</span><span class="op" id="3971391">]</span>&nbsp;<span class="op" id="3971393">=</span>&nbsp;<span class="builtintype" id="3971395">uint8</span><span class="op" id="3971400">(</span><span class="ident" id="3971401">length</span><span class="op" id="3971407">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971411">y</span>&nbsp;<span class="op" id="3971413">:=</span>&nbsp;<span class="ident" id="3971416">x</span><span class="op" id="3971417">[</span><span class="num" id="3971418">4</span><span class="op" id="3971419">:</span><span class="op" id="3971420">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971423">y</span><span class="op" id="3971424">[</span><span class="num" id="3971425">0</span><span class="op" id="3971426">]</span>&nbsp;<span class="op" id="3971428">=</span>&nbsp;<span class="builtintype" id="3971430">byte</span><span class="op" id="3971434">(</span><span class="ident" id="3971435">l</span><span class="op" id="3971436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3971439">copy</span><span class="op" id="3971443">(</span><span class="ident" id="3971444">y</span><span class="op" id="3971445">[</span><span class="num" id="3971446">1</span><span class="op" id="3971447">:</span><span class="op" id="3971448">]</span><span class="op" id="3971449">,</span>&nbsp;<span class="op" id="3971451">[</span><span class="op" id="3971452">]</span><span class="builtintype" id="3971453">byte</span><span class="op" id="3971457">(</span><span class="ident" id="3971458">m</span><span class="op" id="3971459">.</span><span class="ident" id="3971460">proto</span><span class="op" id="3971465">[</span><span class="num" id="3971466">0</span><span class="op" id="3971467">:</span><span class="ident" id="3971468">l</span><span class="op" id="3971469">]</span><span class="op" id="3971470">)</span><span class="op" id="3971471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971474">y</span>&nbsp;<span class="op" id="3971476">=</span>&nbsp;<span class="ident" id="3971478">y</span><span class="op" id="3971479">[</span><span class="num" id="3971480">1</span><span class="op" id="3971481">+</span><span class="ident" id="3971482">l</span><span class="op" id="3971483">:</span><span class="op" id="3971484">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971487">y</span><span class="op" id="3971488">[</span><span class="num" id="3971489">0</span><span class="op" id="3971490">]</span>&nbsp;<span class="op" id="3971492">=</span>&nbsp;<span class="builtintype" id="3971494">byte</span><span class="op" id="3971498">(</span><span class="ident" id="3971499">padding</span><span class="op" id="3971506">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971510">m</span><span class="op" id="3971511">.</span><span class="ident" id="3971512">raw</span>&nbsp;<span class="op" id="3971516">=</span>&nbsp;<span class="ident" id="3971518">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971522">return</span>&nbsp;<span class="ident" id="3971529">x</span><br>
<span class="lineno"></span><span class="op" id="3971531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="3971534">func</span>&nbsp;<span class="op" id="3971539">(</span><span class="ident" id="3971540">m</span>&nbsp;<span class="op" id="3971542">*</span><span class="ident" id="3971543">nextProtoMsg</span><span class="op" id="3971555">)</span>&nbsp;<span class="ident" id="3971557">unmarshal</span><span class="op" id="3971566">(</span><span class="ident" id="3971567">data</span>&nbsp;<span class="op" id="3971572">[</span><span class="op" id="3971573">]</span><span class="builtintype" id="3971574">byte</span><span class="op" id="3971578">)</span>&nbsp;<span class="builtintype" id="3971580">bool</span>&nbsp;<span class="op" id="3971585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971588">m</span><span class="op" id="3971589">.</span><span class="ident" id="3971590">raw</span>&nbsp;<span class="op" id="3971594">=</span>&nbsp;<span class="ident" id="3971596">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971603">if</span>&nbsp;<span class="builtinfunc" id="3971606">len</span><span class="op" id="3971609">(</span><span class="ident" id="3971610">data</span><span class="op" id="3971614">)</span>&nbsp;<span class="op" id="3971616">&lt;</span>&nbsp;<span class="num" id="3971618">5</span>&nbsp;<span class="op" id="3971620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971624">return</span>&nbsp;<span class="ident" id="3971631">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3971638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971641">data</span>&nbsp;<span class="op" id="3971646">=</span>&nbsp;<span class="ident" id="3971648">data</span><span class="op" id="3971652">[</span><span class="num" id="3971653">4</span><span class="op" id="3971654">:</span><span class="op" id="3971655">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971658">protoLen</span>&nbsp;<span class="op" id="3971667">:=</span>&nbsp;<span class="builtintype" id="3971670">int</span><span class="op" id="3971673">(</span><span class="ident" id="3971674">data</span><span class="op" id="3971678">[</span><span class="num" id="3971679">0</span><span class="op" id="3971680">]</span><span class="op" id="3971681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971684">data</span>&nbsp;<span class="op" id="3971689">=</span>&nbsp;<span class="ident" id="3971691">data</span><span class="op" id="3971695">[</span><span class="num" id="3971696">1</span><span class="op" id="3971697">:</span><span class="op" id="3971698">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971701">if</span>&nbsp;<span class="builtinfunc" id="3971704">len</span><span class="op" id="3971707">(</span><span class="ident" id="3971708">data</span><span class="op" id="3971712">)</span>&nbsp;<span class="op" id="3971714">&lt;</span>&nbsp;<span class="ident" id="3971716">protoLen</span>&nbsp;<span class="op" id="3971725">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971729">return</span>&nbsp;<span class="ident" id="3971736">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3971743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971746">m</span><span class="op" id="3971747">.</span><span class="ident" id="3971748">proto</span>&nbsp;<span class="op" id="3971754">=</span>&nbsp;<span class="builtintype" id="3971756">string</span><span class="op" id="3971762">(</span><span class="ident" id="3971763">data</span><span class="op" id="3971767">[</span><span class="num" id="3971768">0</span><span class="op" id="3971769">:</span><span class="ident" id="3971770">protoLen</span><span class="op" id="3971778">]</span><span class="op" id="3971779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971782">data</span>&nbsp;<span class="op" id="3971787">=</span>&nbsp;<span class="ident" id="3971789">data</span><span class="op" id="3971793">[</span><span class="ident" id="3971794">protoLen</span><span class="op" id="3971802">:</span><span class="op" id="3971803">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971807">if</span>&nbsp;<span class="builtinfunc" id="3971810">len</span><span class="op" id="3971813">(</span><span class="ident" id="3971814">data</span><span class="op" id="3971818">)</span>&nbsp;<span class="op" id="3971820">&lt;</span>&nbsp;<span class="num" id="3971822">1</span>&nbsp;<span class="op" id="3971824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971828">return</span>&nbsp;<span class="ident" id="3971835">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3971842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971845">paddingLen</span>&nbsp;<span class="op" id="3971856">:=</span>&nbsp;<span class="builtintype" id="3971859">int</span><span class="op" id="3971862">(</span><span class="ident" id="3971863">data</span><span class="op" id="3971867">[</span><span class="num" id="3971868">0</span><span class="op" id="3971869">]</span><span class="op" id="3971870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971873">data</span>&nbsp;<span class="op" id="3971878">=</span>&nbsp;<span class="ident" id="3971880">data</span><span class="op" id="3971884">[</span><span class="num" id="3971885">1</span><span class="op" id="3971886">:</span><span class="op" id="3971887">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971890">if</span>&nbsp;<span class="builtinfunc" id="3971893">len</span><span class="op" id="3971896">(</span><span class="ident" id="3971897">data</span><span class="op" id="3971901">)</span>&nbsp;<span class="op" id="3971903">!=</span>&nbsp;<span class="ident" id="3971906">paddingLen</span>&nbsp;<span class="op" id="3971917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971921">return</span>&nbsp;<span class="ident" id="3971928">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3971935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971939">return</span>&nbsp;<span class="ident" id="3971946">true</span><br>
<span class="lineno">1075</span><span class="op" id="3971951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3971954">type</span>&nbsp;<span class="ident" id="3971959">certificateRequestMsg</span>&nbsp;<span class="keyword" id="3971981">struct</span>&nbsp;<span class="op" id="3971988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971991">raw</span>&nbsp;<span class="op" id="3971995">[</span><span class="op" id="3971996">]</span><span class="builtintype" id="3971997">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3972003">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3972074">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3972147">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972156">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3972176">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972183">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972206">[</span><span class="op" id="3972207">]</span><span class="builtintype" id="3972208">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972214">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972237">[</span><span class="op" id="3972238">]</span><span class="ident" id="3972239">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972257">certificateAuthorities</span>&nbsp;<span class="op" id="3972280">[</span><span class="op" id="3972281">]</span><span class="op" id="3972282">[</span><span class="op" id="3972283">]</span><span class="builtintype" id="3972284">byte</span><br>
<span class="lineno"></span><span class="op" id="3972289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3972292">func</span>&nbsp;<span class="op" id="3972297">(</span><span class="ident" id="3972298">m</span>&nbsp;<span class="op" id="3972300">*</span><span class="ident" id="3972301">certificateRequestMsg</span><span class="op" id="3972322">)</span>&nbsp;<span class="ident" id="3972324">equal</span><span class="op" id="3972329">(</span><span class="ident" id="3972330">i</span>&nbsp;<span class="keyword" id="3972332">interface</span><span class="op" id="3972341">{</span><span class="op" id="3972342">}</span><span class="op" id="3972343">)</span>&nbsp;<span class="builtintype" id="3972345">bool</span>&nbsp;<span class="op" id="3972350">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972353">m1</span><span class="op" id="3972355">,</span>&nbsp;<span class="ident" id="3972357">ok</span>&nbsp;<span class="op" id="3972360">:=</span>&nbsp;<span class="ident" id="3972363">i</span><span class="op" id="3972364">.</span><span class="op" id="3972365">(</span><span class="op" id="3972366">*</span><span class="ident" id="3972367">certificateRequestMsg</span><span class="op" id="3972388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972391">if</span>&nbsp;<span class="op" id="3972394">!</span><span class="ident" id="3972395">ok</span>&nbsp;<span class="op" id="3972398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972402">return</span>&nbsp;<span class="ident" id="3972409">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3972416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972420">return</span>&nbsp;<span class="ident" id="3972427">bytes</span><span class="op" id="3972432">.</span><span class="ident" id="3972433">Equal</span><span class="op" id="3972438">(</span><span class="ident" id="3972439">m</span><span class="op" id="3972440">.</span><span class="ident" id="3972441">raw</span><span class="op" id="3972444">,</span>&nbsp;<span class="ident" id="3972446">m1</span><span class="op" id="3972448">.</span><span class="ident" id="3972449">raw</span><span class="op" id="3972452">)</span>&nbsp;<span class="op" id="3972454">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972459">bytes</span><span class="op" id="3972464">.</span><span class="ident" id="3972465">Equal</span><span class="op" id="3972470">(</span><span class="ident" id="3972471">m</span><span class="op" id="3972472">.</span><span class="ident" id="3972473">certificateTypes</span><span class="op" id="3972489">,</span>&nbsp;<span class="ident" id="3972491">m1</span><span class="op" id="3972493">.</span><span class="ident" id="3972494">certificateTypes</span><span class="op" id="3972510">)</span>&nbsp;<span class="op" id="3972512">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972517">eqByteSlices</span><span class="op" id="3972529">(</span><span class="ident" id="3972530">m</span><span class="op" id="3972531">.</span><span class="ident" id="3972532">certificateAuthorities</span><span class="op" id="3972554">,</span>&nbsp;<span class="ident" id="3972556">m1</span><span class="op" id="3972558">.</span><span class="ident" id="3972559">certificateAuthorities</span><span class="op" id="3972581">)</span>&nbsp;<span class="op" id="3972583">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972588">eqSignatureAndHashes</span><span class="op" id="3972608">(</span><span class="ident" id="3972609">m</span><span class="op" id="3972610">.</span><span class="ident" id="3972611">signatureAndHashes</span><span class="op" id="3972629">,</span>&nbsp;<span class="ident" id="3972631">m1</span><span class="op" id="3972633">.</span><span class="ident" id="3972634">signatureAndHashes</span><span class="op" id="3972652">)</span><br>
<span class="lineno"></span><span class="op" id="3972654">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="3972657">func</span>&nbsp;<span class="op" id="3972662">(</span><span class="ident" id="3972663">m</span>&nbsp;<span class="op" id="3972665">*</span><span class="ident" id="3972666">certificateRequestMsg</span><span class="op" id="3972687">)</span>&nbsp;<span class="ident" id="3972689">marshal</span><span class="op" id="3972696">(</span><span class="op" id="3972697">)</span>&nbsp;<span class="op" id="3972699">(</span><span class="ident" id="3972700">x</span>&nbsp;<span class="op" id="3972702">[</span><span class="op" id="3972703">]</span><span class="builtintype" id="3972704">byte</span><span class="op" id="3972708">)</span>&nbsp;<span class="op" id="3972710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972713">if</span>&nbsp;<span class="ident" id="3972716">m</span><span class="op" id="3972717">.</span><span class="ident" id="3972718">raw</span>&nbsp;<span class="op" id="3972722">!=</span>&nbsp;<span class="ident" id="3972725">nil</span>&nbsp;<span class="op" id="3972729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972733">return</span>&nbsp;<span class="ident" id="3972740">m</span><span class="op" id="3972741">.</span><span class="ident" id="3972742">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3972747">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3972751">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972808">length</span>&nbsp;<span class="op" id="3972815">:=</span>&nbsp;<span class="num" id="3972818">1</span>&nbsp;<span class="op" id="3972820">+</span>&nbsp;<span class="builtinfunc" id="3972822">len</span><span class="op" id="3972825">(</span><span class="ident" id="3972826">m</span><span class="op" id="3972827">.</span><span class="ident" id="3972828">certificateTypes</span><span class="op" id="3972844">)</span>&nbsp;<span class="op" id="3972846">+</span>&nbsp;<span class="num" id="3972848">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972851">casLength</span>&nbsp;<span class="op" id="3972861">:=</span>&nbsp;<span class="num" id="3972864">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972867">for</span>&nbsp;<span class="ident" id="3972871">_</span><span class="op" id="3972872">,</span>&nbsp;<span class="ident" id="3972874">ca</span>&nbsp;<span class="op" id="3972877">:=</span>&nbsp;<span class="keyword" id="3972880">range</span>&nbsp;<span class="ident" id="3972886">m</span><span class="op" id="3972887">.</span><span class="ident" id="3972888">certificateAuthorities</span>&nbsp;<span class="op" id="3972911">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972915">casLength</span>&nbsp;<span class="op" id="3972925">+=</span>&nbsp;<span class="num" id="3972928">2</span>&nbsp;<span class="op" id="3972930">+</span>&nbsp;<span class="builtinfunc" id="3972932">len</span><span class="op" id="3972935">(</span><span class="ident" id="3972936">ca</span><span class="op" id="3972938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3972941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972944">length</span>&nbsp;<span class="op" id="3972951">+=</span>&nbsp;<span class="ident" id="3972954">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972966">if</span>&nbsp;<span class="ident" id="3972969">m</span><span class="op" id="3972970">.</span><span class="ident" id="3972971">hasSignatureAndHash</span>&nbsp;<span class="op" id="3972991">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972995">length</span>&nbsp;<span class="op" id="3973002">+=</span>&nbsp;<span class="num" id="3973005">2</span>&nbsp;<span class="op" id="3973007">+</span>&nbsp;<span class="num" id="3973009">2</span><span class="op" id="3973010">*</span><span class="builtinfunc" id="3973011">len</span><span class="op" id="3973014">(</span><span class="ident" id="3973015">m</span><span class="op" id="3973016">.</span><span class="ident" id="3973017">signatureAndHashes</span><span class="op" id="3973035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973042">x</span>&nbsp;<span class="op" id="3973044">=</span>&nbsp;<span class="builtinfunc" id="3973046">make</span><span class="op" id="3973050">(</span><span class="op" id="3973051">[</span><span class="op" id="3973052">]</span><span class="builtintype" id="3973053">byte</span><span class="op" id="3973057">,</span>&nbsp;<span class="num" id="3973059">4</span><span class="op" id="3973060">+</span><span class="ident" id="3973061">length</span><span class="op" id="3973067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973070">x</span><span class="op" id="3973071">[</span><span class="num" id="3973072">0</span><span class="op" id="3973073">]</span>&nbsp;<span class="op" id="3973075">=</span>&nbsp;<span class="ident" id="3973077">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973101">x</span><span class="op" id="3973102">[</span><span class="num" id="3973103">1</span><span class="op" id="3973104">]</span>&nbsp;<span class="op" id="3973106">=</span>&nbsp;<span class="builtintype" id="3973108">uint8</span><span class="op" id="3973113">(</span><span class="ident" id="3973114">length</span>&nbsp;<span class="op" id="3973121">&gt;&gt;</span>&nbsp;<span class="num" id="3973124">16</span><span class="op" id="3973126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973129">x</span><span class="op" id="3973130">[</span><span class="num" id="3973131">2</span><span class="op" id="3973132">]</span>&nbsp;<span class="op" id="3973134">=</span>&nbsp;<span class="builtintype" id="3973136">uint8</span><span class="op" id="3973141">(</span><span class="ident" id="3973142">length</span>&nbsp;<span class="op" id="3973149">&gt;&gt;</span>&nbsp;<span class="num" id="3973152">8</span><span class="op" id="3973153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973156">x</span><span class="op" id="3973157">[</span><span class="num" id="3973158">3</span><span class="op" id="3973159">]</span>&nbsp;<span class="op" id="3973161">=</span>&nbsp;<span class="builtintype" id="3973163">uint8</span><span class="op" id="3973168">(</span><span class="ident" id="3973169">length</span><span class="op" id="3973175">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973179">x</span><span class="op" id="3973180">[</span><span class="num" id="3973181">4</span><span class="op" id="3973182">]</span>&nbsp;<span class="op" id="3973184">=</span>&nbsp;<span class="builtintype" id="3973186">uint8</span><span class="op" id="3973191">(</span><span class="builtinfunc" id="3973192">len</span><span class="op" id="3973195">(</span><span class="ident" id="3973196">m</span><span class="op" id="3973197">.</span><span class="ident" id="3973198">certificateTypes</span><span class="op" id="3973214">)</span><span class="op" id="3973215">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3973219">copy</span><span class="op" id="3973223">(</span><span class="ident" id="3973224">x</span><span class="op" id="3973225">[</span><span class="num" id="3973226">5</span><span class="op" id="3973227">:</span><span class="op" id="3973228">]</span><span class="op" id="3973229">,</span>&nbsp;<span class="ident" id="3973231">m</span><span class="op" id="3973232">.</span><span class="ident" id="3973233">certificateTypes</span><span class="op" id="3973249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973252">y</span>&nbsp;<span class="op" id="3973254">:=</span>&nbsp;<span class="ident" id="3973257">x</span><span class="op" id="3973258">[</span><span class="num" id="3973259">5</span><span class="op" id="3973260">+</span><span class="builtinfunc" id="3973261">len</span><span class="op" id="3973264">(</span><span class="ident" id="3973265">m</span><span class="op" id="3973266">.</span><span class="ident" id="3973267">certificateTypes</span><span class="op" id="3973283">)</span><span class="op" id="3973284">:</span><span class="op" id="3973285">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973289">if</span>&nbsp;<span class="ident" id="3973292">m</span><span class="op" id="3973293">.</span><span class="ident" id="3973294">hasSignatureAndHash</span>&nbsp;<span class="op" id="3973314">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973318">n</span>&nbsp;<span class="op" id="3973320">:=</span>&nbsp;<span class="builtinfunc" id="3973323">len</span><span class="op" id="3973326">(</span><span class="ident" id="3973327">m</span><span class="op" id="3973328">.</span><span class="ident" id="3973329">signatureAndHashes</span><span class="op" id="3973347">)</span>&nbsp;<span class="op" id="3973349">*</span>&nbsp;<span class="num" id="3973351">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973355">y</span><span class="op" id="3973356">[</span><span class="num" id="3973357">0</span><span class="op" id="3973358">]</span>&nbsp;<span class="op" id="3973360">=</span>&nbsp;<span class="builtintype" id="3973362">uint8</span><span class="op" id="3973367">(</span><span class="ident" id="3973368">n</span>&nbsp;<span class="op" id="3973370">&gt;&gt;</span>&nbsp;<span class="num" id="3973373">8</span><span class="op" id="3973374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973378">y</span><span class="op" id="3973379">[</span><span class="num" id="3973380">1</span><span class="op" id="3973381">]</span>&nbsp;<span class="op" id="3973383">=</span>&nbsp;<span class="builtintype" id="3973385">uint8</span><span class="op" id="3973390">(</span><span class="ident" id="3973391">n</span><span class="op" id="3973392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973396">y</span>&nbsp;<span class="op" id="3973398">=</span>&nbsp;<span class="ident" id="3973400">y</span><span class="op" id="3973401">[</span><span class="num" id="3973402">2</span><span class="op" id="3973403">:</span><span class="op" id="3973404">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973408">for</span>&nbsp;<span class="ident" id="3973412">_</span><span class="op" id="3973413">,</span>&nbsp;<span class="ident" id="3973415">sigAndHash</span>&nbsp;<span class="op" id="3973426">:=</span>&nbsp;<span class="keyword" id="3973429">range</span>&nbsp;<span class="ident" id="3973435">m</span><span class="op" id="3973436">.</span><span class="ident" id="3973437">signatureAndHashes</span>&nbsp;<span class="op" id="3973456">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973461">y</span><span class="op" id="3973462">[</span><span class="num" id="3973463">0</span><span class="op" id="3973464">]</span>&nbsp;<span class="op" id="3973466">=</span>&nbsp;<span class="ident" id="3973468">sigAndHash</span><span class="op" id="3973478">.</span><span class="ident" id="3973479">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973487">y</span><span class="op" id="3973488">[</span><span class="num" id="3973489">1</span><span class="op" id="3973490">]</span>&nbsp;<span class="op" id="3973492">=</span>&nbsp;<span class="ident" id="3973494">sigAndHash</span><span class="op" id="3973504">.</span><span class="ident" id="3973505">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973518">y</span>&nbsp;<span class="op" id="3973520">=</span>&nbsp;<span class="ident" id="3973522">y</span><span class="op" id="3973523">[</span><span class="num" id="3973524">2</span><span class="op" id="3973525">:</span><span class="op" id="3973526">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973533">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973537">y</span><span class="op" id="3973538">[</span><span class="num" id="3973539">0</span><span class="op" id="3973540">]</span>&nbsp;<span class="op" id="3973542">=</span>&nbsp;<span class="builtintype" id="3973544">uint8</span><span class="op" id="3973549">(</span><span class="ident" id="3973550">casLength</span>&nbsp;<span class="op" id="3973560">&gt;&gt;</span>&nbsp;<span class="num" id="3973563">8</span><span class="op" id="3973564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973567">y</span><span class="op" id="3973568">[</span><span class="num" id="3973569">1</span><span class="op" id="3973570">]</span>&nbsp;<span class="op" id="3973572">=</span>&nbsp;<span class="builtintype" id="3973574">uint8</span><span class="op" id="3973579">(</span><span class="ident" id="3973580">casLength</span><span class="op" id="3973589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973592">y</span>&nbsp;<span class="op" id="3973594">=</span>&nbsp;<span class="ident" id="3973596">y</span><span class="op" id="3973597">[</span><span class="num" id="3973598">2</span><span class="op" id="3973599">:</span><span class="op" id="3973600">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973603">for</span>&nbsp;<span class="ident" id="3973607">_</span><span class="op" id="3973608">,</span>&nbsp;<span class="ident" id="3973610">ca</span>&nbsp;<span class="op" id="3973613">:=</span>&nbsp;<span class="keyword" id="3973616">range</span>&nbsp;<span class="ident" id="3973622">m</span><span class="op" id="3973623">.</span><span class="ident" id="3973624">certificateAuthorities</span>&nbsp;<span class="op" id="3973647">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973651">y</span><span class="op" id="3973652">[</span><span class="num" id="3973653">0</span><span class="op" id="3973654">]</span>&nbsp;<span class="op" id="3973656">=</span>&nbsp;<span class="builtintype" id="3973658">uint8</span><span class="op" id="3973663">(</span><span class="builtinfunc" id="3973664">len</span><span class="op" id="3973667">(</span><span class="ident" id="3973668">ca</span><span class="op" id="3973670">)</span>&nbsp;<span class="op" id="3973672">&gt;&gt;</span>&nbsp;<span class="num" id="3973675">8</span><span class="op" id="3973676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973680">y</span><span class="op" id="3973681">[</span><span class="num" id="3973682">1</span><span class="op" id="3973683">]</span>&nbsp;<span class="op" id="3973685">=</span>&nbsp;<span class="builtintype" id="3973687">uint8</span><span class="op" id="3973692">(</span><span class="builtinfunc" id="3973693">len</span><span class="op" id="3973696">(</span><span class="ident" id="3973697">ca</span><span class="op" id="3973699">)</span><span class="op" id="3973700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973704">y</span>&nbsp;<span class="op" id="3973706">=</span>&nbsp;<span class="ident" id="3973708">y</span><span class="op" id="3973709">[</span><span class="num" id="3973710">2</span><span class="op" id="3973711">:</span><span class="op" id="3973712">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3973716">copy</span><span class="op" id="3973720">(</span><span class="ident" id="3973721">y</span><span class="op" id="3973722">,</span>&nbsp;<span class="ident" id="3973724">ca</span><span class="op" id="3973726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973730">y</span>&nbsp;<span class="op" id="3973732">=</span>&nbsp;<span class="ident" id="3973734">y</span><span class="op" id="3973735">[</span><span class="builtinfunc" id="3973736">len</span><span class="op" id="3973739">(</span><span class="ident" id="3973740">ca</span><span class="op" id="3973742">)</span><span class="op" id="3973743">:</span><span class="op" id="3973744">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973751">m</span><span class="op" id="3973752">.</span><span class="ident" id="3973753">raw</span>&nbsp;<span class="op" id="3973757">=</span>&nbsp;<span class="ident" id="3973759">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973762">return</span><br>
<span class="lineno"></span><span class="op" id="3973769">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="3973772">func</span>&nbsp;<span class="op" id="3973777">(</span><span class="ident" id="3973778">m</span>&nbsp;<span class="op" id="3973780">*</span><span class="ident" id="3973781">certificateRequestMsg</span><span class="op" id="3973802">)</span>&nbsp;<span class="ident" id="3973804">unmarshal</span><span class="op" id="3973813">(</span><span class="ident" id="3973814">data</span>&nbsp;<span class="op" id="3973819">[</span><span class="op" id="3973820">]</span><span class="builtintype" id="3973821">byte</span><span class="op" id="3973825">)</span>&nbsp;<span class="builtintype" id="3973827">bool</span>&nbsp;<span class="op" id="3973832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973835">m</span><span class="op" id="3973836">.</span><span class="ident" id="3973837">raw</span>&nbsp;<span class="op" id="3973841">=</span>&nbsp;<span class="ident" id="3973843">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973850">if</span>&nbsp;<span class="builtinfunc" id="3973853">len</span><span class="op" id="3973856">(</span><span class="ident" id="3973857">data</span><span class="op" id="3973861">)</span>&nbsp;<span class="op" id="3973863">&lt;</span>&nbsp;<span class="num" id="3973865">5</span>&nbsp;<span class="op" id="3973867">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973871">return</span>&nbsp;<span class="ident" id="3973878">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973889">length</span>&nbsp;<span class="op" id="3973896">:=</span>&nbsp;<span class="builtintype" id="3973899">uint32</span><span class="op" id="3973905">(</span><span class="ident" id="3973906">data</span><span class="op" id="3973910">[</span><span class="num" id="3973911">1</span><span class="op" id="3973912">]</span><span class="op" id="3973913">)</span><span class="op" id="3973914">&lt;&lt;</span><span class="num" id="3973916">16</span>&nbsp;<span class="op" id="3973919">|</span>&nbsp;<span class="builtintype" id="3973921">uint32</span><span class="op" id="3973927">(</span><span class="ident" id="3973928">data</span><span class="op" id="3973932">[</span><span class="num" id="3973933">2</span><span class="op" id="3973934">]</span><span class="op" id="3973935">)</span><span class="op" id="3973936">&lt;&lt;</span><span class="num" id="3973938">8</span>&nbsp;<span class="op" id="3973940">|</span>&nbsp;<span class="builtintype" id="3973942">uint32</span><span class="op" id="3973948">(</span><span class="ident" id="3973949">data</span><span class="op" id="3973953">[</span><span class="num" id="3973954">3</span><span class="op" id="3973955">]</span><span class="op" id="3973956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973959">if</span>&nbsp;<span class="builtintype" id="3973962">uint32</span><span class="op" id="3973968">(</span><span class="builtinfunc" id="3973969">len</span><span class="op" id="3973972">(</span><span class="ident" id="3973973">data</span><span class="op" id="3973977">)</span><span class="op" id="3973978">)</span><span class="op" id="3973979">-</span><span class="num" id="3973980">4</span>&nbsp;<span class="op" id="3973982">!=</span>&nbsp;<span class="ident" id="3973985">length</span>&nbsp;<span class="op" id="3973992">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973996">return</span>&nbsp;<span class="ident" id="3974003">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974014">numCertTypes</span>&nbsp;<span class="op" id="3974027">:=</span>&nbsp;<span class="builtintype" id="3974030">int</span><span class="op" id="3974033">(</span><span class="ident" id="3974034">data</span><span class="op" id="3974038">[</span><span class="num" id="3974039">4</span><span class="op" id="3974040">]</span><span class="op" id="3974041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974044">data</span>&nbsp;<span class="op" id="3974049">=</span>&nbsp;<span class="ident" id="3974051">data</span><span class="op" id="3974055">[</span><span class="num" id="3974056">5</span><span class="op" id="3974057">:</span><span class="op" id="3974058">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974061">if</span>&nbsp;<span class="ident" id="3974064">numCertTypes</span>&nbsp;<span class="op" id="3974077">==</span>&nbsp;<span class="num" id="3974080">0</span>&nbsp;<span class="op" id="3974082">||</span>&nbsp;<span class="builtinfunc" id="3974085">len</span><span class="op" id="3974088">(</span><span class="ident" id="3974089">data</span><span class="op" id="3974093">)</span>&nbsp;<span class="op" id="3974095">&lt;=</span>&nbsp;<span class="ident" id="3974098">numCertTypes</span>&nbsp;<span class="op" id="3974111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974115">return</span>&nbsp;<span class="ident" id="3974122">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974133">m</span><span class="op" id="3974134">.</span><span class="ident" id="3974135">certificateTypes</span>&nbsp;<span class="op" id="3974152">=</span>&nbsp;<span class="builtinfunc" id="3974154">make</span><span class="op" id="3974158">(</span><span class="op" id="3974159">[</span><span class="op" id="3974160">]</span><span class="builtintype" id="3974161">byte</span><span class="op" id="3974165">,</span>&nbsp;<span class="ident" id="3974167">numCertTypes</span><span class="op" id="3974179">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974182">if</span>&nbsp;<span class="builtinfunc" id="3974185">copy</span><span class="op" id="3974189">(</span><span class="ident" id="3974190">m</span><span class="op" id="3974191">.</span><span class="ident" id="3974192">certificateTypes</span><span class="op" id="3974208">,</span>&nbsp;<span class="ident" id="3974210">data</span><span class="op" id="3974214">)</span>&nbsp;<span class="op" id="3974216">!=</span>&nbsp;<span class="ident" id="3974219">numCertTypes</span>&nbsp;<span class="op" id="3974232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974236">return</span>&nbsp;<span class="ident" id="3974243">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974254">data</span>&nbsp;<span class="op" id="3974259">=</span>&nbsp;<span class="ident" id="3974261">data</span><span class="op" id="3974265">[</span><span class="ident" id="3974266">numCertTypes</span><span class="op" id="3974278">:</span><span class="op" id="3974279">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974283">if</span>&nbsp;<span class="ident" id="3974286">m</span><span class="op" id="3974287">.</span><span class="ident" id="3974288">hasSignatureAndHash</span>&nbsp;<span class="op" id="3974308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974312">if</span>&nbsp;<span class="builtinfunc" id="3974315">len</span><span class="op" id="3974318">(</span><span class="ident" id="3974319">data</span><span class="op" id="3974323">)</span>&nbsp;<span class="op" id="3974325">&lt;</span>&nbsp;<span class="num" id="3974327">2</span>&nbsp;<span class="op" id="3974329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974334">return</span>&nbsp;<span class="ident" id="3974341">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974349">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974353">sigAndHashLen</span>&nbsp;<span class="op" id="3974367">:=</span>&nbsp;<span class="builtintype" id="3974370">uint16</span><span class="op" id="3974376">(</span><span class="ident" id="3974377">data</span><span class="op" id="3974381">[</span><span class="num" id="3974382">0</span><span class="op" id="3974383">]</span><span class="op" id="3974384">)</span><span class="op" id="3974385">&lt;&lt;</span><span class="num" id="3974387">8</span>&nbsp;<span class="op" id="3974389">|</span>&nbsp;<span class="builtintype" id="3974391">uint16</span><span class="op" id="3974397">(</span><span class="ident" id="3974398">data</span><span class="op" id="3974402">[</span><span class="num" id="3974403">1</span><span class="op" id="3974404">]</span><span class="op" id="3974405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974409">data</span>&nbsp;<span class="op" id="3974414">=</span>&nbsp;<span class="ident" id="3974416">data</span><span class="op" id="3974420">[</span><span class="num" id="3974421">2</span><span class="op" id="3974422">:</span><span class="op" id="3974423">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974427">if</span>&nbsp;<span class="ident" id="3974430">sigAndHashLen</span><span class="op" id="3974443">&amp;</span><span class="num" id="3974444">1</span>&nbsp;<span class="op" id="3974446">!=</span>&nbsp;<span class="num" id="3974449">0</span>&nbsp;<span class="op" id="3974451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974456">return</span>&nbsp;<span class="ident" id="3974463">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974471">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974475">if</span>&nbsp;<span class="builtinfunc" id="3974478">len</span><span class="op" id="3974481">(</span><span class="ident" id="3974482">data</span><span class="op" id="3974486">)</span>&nbsp;<span class="op" id="3974488">&lt;</span>&nbsp;<span class="builtintype" id="3974490">int</span><span class="op" id="3974493">(</span><span class="ident" id="3974494">sigAndHashLen</span><span class="op" id="3974507">)</span>&nbsp;<span class="op" id="3974509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974514">return</span>&nbsp;<span class="ident" id="3974521">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974533">numSigAndHash</span>&nbsp;<span class="op" id="3974547">:=</span>&nbsp;<span class="ident" id="3974550">sigAndHashLen</span>&nbsp;<span class="op" id="3974564">/</span>&nbsp;<span class="num" id="3974566">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974570">m</span><span class="op" id="3974571">.</span><span class="ident" id="3974572">signatureAndHashes</span>&nbsp;<span class="op" id="3974591">=</span>&nbsp;<span class="builtinfunc" id="3974593">make</span><span class="op" id="3974597">(</span><span class="op" id="3974598">[</span><span class="op" id="3974599">]</span><span class="ident" id="3974600">signatureAndHash</span><span class="op" id="3974616">,</span>&nbsp;<span class="ident" id="3974618">numSigAndHash</span><span class="op" id="3974631">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974635">for</span>&nbsp;<span class="ident" id="3974639">i</span>&nbsp;<span class="op" id="3974641">:=</span>&nbsp;<span class="keyword" id="3974644">range</span>&nbsp;<span class="ident" id="3974650">m</span><span class="op" id="3974651">.</span><span class="ident" id="3974652">signatureAndHashes</span>&nbsp;<span class="op" id="3974671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974676">m</span><span class="op" id="3974677">.</span><span class="ident" id="3974678">signatureAndHashes</span><span class="op" id="3974696">[</span><span class="ident" id="3974697">i</span><span class="op" id="3974698">]</span><span class="op" id="3974699">.</span><span class="ident" id="3974700">hash</span>&nbsp;<span class="op" id="3974705">=</span>&nbsp;<span class="ident" id="3974707">data</span><span class="op" id="3974711">[</span><span class="num" id="3974712">0</span><span class="op" id="3974713">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974718">m</span><span class="op" id="3974719">.</span><span class="ident" id="3974720">signatureAndHashes</span><span class="op" id="3974738">[</span><span class="ident" id="3974739">i</span><span class="op" id="3974740">]</span><span class="op" id="3974741">.</span><span class="ident" id="3974742">signature</span>&nbsp;<span class="op" id="3974752">=</span>&nbsp;<span class="ident" id="3974754">data</span><span class="op" id="3974758">[</span><span class="num" id="3974759">1</span><span class="op" id="3974760">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974765">data</span>&nbsp;<span class="op" id="3974770">=</span>&nbsp;<span class="ident" id="3974772">data</span><span class="op" id="3974776">[</span><span class="num" id="3974777">2</span><span class="op" id="3974778">:</span><span class="op" id="3974779">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974783">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974790">if</span>&nbsp;<span class="builtinfunc" id="3974793">len</span><span class="op" id="3974796">(</span><span class="ident" id="3974797">data</span><span class="op" id="3974801">)</span>&nbsp;<span class="op" id="3974803">&lt;</span>&nbsp;<span class="num" id="3974805">2</span>&nbsp;<span class="op" id="3974807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974811">return</span>&nbsp;<span class="ident" id="3974818">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974825">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974828">casLength</span>&nbsp;<span class="op" id="3974838">:=</span>&nbsp;<span class="builtintype" id="3974841">uint16</span><span class="op" id="3974847">(</span><span class="ident" id="3974848">data</span><span class="op" id="3974852">[</span><span class="num" id="3974853">0</span><span class="op" id="3974854">]</span><span class="op" id="3974855">)</span><span class="op" id="3974856">&lt;&lt;</span><span class="num" id="3974858">8</span>&nbsp;<span class="op" id="3974860">|</span>&nbsp;<span class="builtintype" id="3974862">uint16</span><span class="op" id="3974868">(</span><span class="ident" id="3974869">data</span><span class="op" id="3974873">[</span><span class="num" id="3974874">1</span><span class="op" id="3974875">]</span><span class="op" id="3974876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974879">data</span>&nbsp;<span class="op" id="3974884">=</span>&nbsp;<span class="ident" id="3974886">data</span><span class="op" id="3974890">[</span><span class="num" id="3974891">2</span><span class="op" id="3974892">:</span><span class="op" id="3974893">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974896">if</span>&nbsp;<span class="builtinfunc" id="3974899">len</span><span class="op" id="3974902">(</span><span class="ident" id="3974903">data</span><span class="op" id="3974907">)</span>&nbsp;<span class="op" id="3974909">&lt;</span>&nbsp;<span class="builtintype" id="3974911">int</span><span class="op" id="3974914">(</span><span class="ident" id="3974915">casLength</span><span class="op" id="3974924">)</span>&nbsp;<span class="op" id="3974926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3974930">return</span>&nbsp;<span class="ident" id="3974937">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3974944">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974947">cas</span>&nbsp;<span class="op" id="3974951">:=</span>&nbsp;<span class="builtinfunc" id="3974954">make</span><span class="op" id="3974958">(</span><span class="op" id="3974959">[</span><span class="op" id="3974960">]</span><span class="builtintype" id="3974961">byte</span><span class="op" id="3974965">,</span>&nbsp;<span class="ident" id="3974967">casLength</span><span class="op" id="3974976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3974979">copy</span><span class="op" id="3974983">(</span><span class="ident" id="3974984">cas</span><span class="op" id="3974987">,</span>&nbsp;<span class="ident" id="3974989">data</span><span class="op" id="3974993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974996">data</span>&nbsp;<span class="op" id="3975001">=</span>&nbsp;<span class="ident" id="3975003">data</span><span class="op" id="3975007">[</span><span class="ident" id="3975008">casLength</span><span class="op" id="3975017">:</span><span class="op" id="3975018">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975022">m</span><span class="op" id="3975023">.</span><span class="ident" id="3975024">certificateAuthorities</span>&nbsp;<span class="op" id="3975047">=</span>&nbsp;<span class="ident" id="3975049">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975054">for</span>&nbsp;<span class="builtinfunc" id="3975058">len</span><span class="op" id="3975061">(</span><span class="ident" id="3975062">cas</span><span class="op" id="3975065">)</span>&nbsp;<span class="op" id="3975067">&gt;</span>&nbsp;<span class="num" id="3975069">0</span>&nbsp;<span class="op" id="3975071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975075">if</span>&nbsp;<span class="builtinfunc" id="3975078">len</span><span class="op" id="3975081">(</span><span class="ident" id="3975082">cas</span><span class="op" id="3975085">)</span>&nbsp;<span class="op" id="3975087">&lt;</span>&nbsp;<span class="num" id="3975089">2</span>&nbsp;<span class="op" id="3975091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975096">return</span>&nbsp;<span class="ident" id="3975103">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3975111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975115">caLen</span>&nbsp;<span class="op" id="3975121">:=</span>&nbsp;<span class="builtintype" id="3975124">uint16</span><span class="op" id="3975130">(</span><span class="ident" id="3975131">cas</span><span class="op" id="3975134">[</span><span class="num" id="3975135">0</span><span class="op" id="3975136">]</span><span class="op" id="3975137">)</span><span class="op" id="3975138">&lt;&lt;</span><span class="num" id="3975140">8</span>&nbsp;<span class="op" id="3975142">|</span>&nbsp;<span class="builtintype" id="3975144">uint16</span><span class="op" id="3975150">(</span><span class="ident" id="3975151">cas</span><span class="op" id="3975154">[</span><span class="num" id="3975155">1</span><span class="op" id="3975156">]</span><span class="op" id="3975157">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975161">cas</span>&nbsp;<span class="op" id="3975165">=</span>&nbsp;<span class="ident" id="3975167">cas</span><span class="op" id="3975170">[</span><span class="num" id="3975171">2</span><span class="op" id="3975172">:</span><span class="op" id="3975173">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975178">if</span>&nbsp;<span class="builtinfunc" id="3975181">len</span><span class="op" id="3975184">(</span><span class="ident" id="3975185">cas</span><span class="op" id="3975188">)</span>&nbsp;<span class="op" id="3975190">&lt;</span>&nbsp;<span class="builtintype" id="3975192">int</span><span class="op" id="3975195">(</span><span class="ident" id="3975196">caLen</span><span class="op" id="3975201">)</span>&nbsp;<span class="op" id="3975203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975208">return</span>&nbsp;<span class="ident" id="3975215">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3975223">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975228">m</span><span class="op" id="3975229">.</span><span class="ident" id="3975230">certificateAuthorities</span>&nbsp;<span class="op" id="3975253">=</span>&nbsp;<span class="builtinfunc" id="3975255">append</span><span class="op" id="3975261">(</span><span class="ident" id="3975262">m</span><span class="op" id="3975263">.</span><span class="ident" id="3975264">certificateAuthorities</span><span class="op" id="3975286">,</span>&nbsp;<span class="ident" id="3975288">cas</span><span class="op" id="3975291">[</span><span class="op" id="3975292">:</span><span class="ident" id="3975293">caLen</span><span class="op" id="3975298">]</span><span class="op" id="3975299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975303">cas</span>&nbsp;<span class="op" id="3975307">=</span>&nbsp;<span class="ident" id="3975309">cas</span><span class="op" id="3975312">[</span><span class="ident" id="3975313">caLen</span><span class="op" id="3975318">:</span><span class="op" id="3975319">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3975322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975325">if</span>&nbsp;<span class="builtinfunc" id="3975328">len</span><span class="op" id="3975331">(</span><span class="ident" id="3975332">data</span><span class="op" id="3975336">)</span>&nbsp;<span class="op" id="3975338">&gt;</span>&nbsp;<span class="num" id="3975340">0</span>&nbsp;<span class="op" id="3975342">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975346">return</span>&nbsp;<span class="ident" id="3975353">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3975360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975364">return</span>&nbsp;<span class="ident" id="3975371">true</span><br>
<span class="lineno"></span><span class="op" id="3975376">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="3975379">type</span>&nbsp;<span class="ident" id="3975384">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="3975405">struct</span>&nbsp;<span class="op" id="3975412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975415">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975435">[</span><span class="op" id="3975436">]</span><span class="builtintype" id="3975437">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975443">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3975463">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975469">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975489">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975507">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975527">[</span><span class="op" id="3975528">]</span><span class="builtintype" id="3975529">byte</span><br>
<span class="lineno"></span><span class="op" id="3975534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3975537">func</span>&nbsp;<span class="op" id="3975542">(</span><span class="ident" id="3975543">m</span>&nbsp;<span class="op" id="3975545">*</span><span class="ident" id="3975546">certificateVerifyMsg</span><span class="op" id="3975566">)</span>&nbsp;<span class="ident" id="3975568">equal</span><span class="op" id="3975573">(</span><span class="ident" id="3975574">i</span>&nbsp;<span class="keyword" id="3975576">interface</span><span class="op" id="3975585">{</span><span class="op" id="3975586">}</span><span class="op" id="3975587">)</span>&nbsp;<span class="builtintype" id="3975589">bool</span>&nbsp;<span class="op" id="3975594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975597">m1</span><span class="op" id="3975599">,</span>&nbsp;<span class="ident" id="3975601">ok</span>&nbsp;<span class="op" id="3975604">:=</span>&nbsp;<span class="ident" id="3975607">i</span><span class="op" id="3975608">.</span><span class="op" id="3975609">(</span><span class="op" id="3975610">*</span><span class="ident" id="3975611">certificateVerifyMsg</span><span class="op" id="3975631">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975634">if</span>&nbsp;<span class="op" id="3975637">!</span><span class="ident" id="3975638">ok</span>&nbsp;<span class="op" id="3975641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975645">return</span>&nbsp;<span class="ident" id="3975652">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3975659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975663">return</span>&nbsp;<span class="ident" id="3975670">bytes</span><span class="op" id="3975675">.</span><span class="ident" id="3975676">Equal</span><span class="op" id="3975681">(</span><span class="ident" id="3975682">m</span><span class="op" id="3975683">.</span><span class="ident" id="3975684">raw</span><span class="op" id="3975687">,</span>&nbsp;<span class="ident" id="3975689">m1</span><span class="op" id="3975691">.</span><span class="ident" id="3975692">raw</span><span class="op" id="3975695">)</span>&nbsp;<span class="op" id="3975697">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975702">m</span><span class="op" id="3975703">.</span><span class="ident" id="3975704">hasSignatureAndHash</span>&nbsp;<span class="op" id="3975724">==</span>&nbsp;<span class="ident" id="3975727">m1</span><span class="op" id="3975729">.</span><span class="ident" id="3975730">hasSignatureAndHash</span>&nbsp;<span class="op" id="3975750">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975755">m</span><span class="op" id="3975756">.</span><span class="ident" id="3975757">signatureAndHash</span><span class="op" id="3975773">.</span><span class="ident" id="3975774">hash</span>&nbsp;<span class="op" id="3975779">==</span>&nbsp;<span class="ident" id="3975782">m1</span><span class="op" id="3975784">.</span><span class="ident" id="3975785">signatureAndHash</span><span class="op" id="3975801">.</span><span class="ident" id="3975802">hash</span>&nbsp;<span class="op" id="3975807">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975812">m</span><span class="op" id="3975813">.</span><span class="ident" id="3975814">signatureAndHash</span><span class="op" id="3975830">.</span><span class="ident" id="3975831">signature</span>&nbsp;<span class="op" id="3975841">==</span>&nbsp;<span class="ident" id="3975844">m1</span><span class="op" id="3975846">.</span><span class="ident" id="3975847">signatureAndHash</span><span class="op" id="3975863">.</span><span class="ident" id="3975864">signature</span>&nbsp;<span class="op" id="3975874">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975879">bytes</span><span class="op" id="3975884">.</span><span class="ident" id="3975885">Equal</span><span class="op" id="3975890">(</span><span class="ident" id="3975891">m</span><span class="op" id="3975892">.</span><span class="ident" id="3975893">signature</span><span class="op" id="3975902">,</span>&nbsp;<span class="ident" id="3975904">m1</span><span class="op" id="3975906">.</span><span class="ident" id="3975907">signature</span><span class="op" id="3975916">)</span><br>
<span class="lineno"></span><span class="op" id="3975918">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="3975921">func</span>&nbsp;<span class="op" id="3975926">(</span><span class="ident" id="3975927">m</span>&nbsp;<span class="op" id="3975929">*</span><span class="ident" id="3975930">certificateVerifyMsg</span><span class="op" id="3975950">)</span>&nbsp;<span class="ident" id="3975952">marshal</span><span class="op" id="3975959">(</span><span class="op" id="3975960">)</span>&nbsp;<span class="op" id="3975962">(</span><span class="ident" id="3975963">x</span>&nbsp;<span class="op" id="3975965">[</span><span class="op" id="3975966">]</span><span class="builtintype" id="3975967">byte</span><span class="op" id="3975971">)</span>&nbsp;<span class="op" id="3975973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975976">if</span>&nbsp;<span class="ident" id="3975979">m</span><span class="op" id="3975980">.</span><span class="ident" id="3975981">raw</span>&nbsp;<span class="op" id="3975985">!=</span>&nbsp;<span class="ident" id="3975988">nil</span>&nbsp;<span class="op" id="3975992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975996">return</span>&nbsp;<span class="ident" id="3976003">m</span><span class="op" id="3976004">.</span><span class="ident" id="3976005">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3976010">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3976014">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976071">siglength</span>&nbsp;<span class="op" id="3976081">:=</span>&nbsp;<span class="builtinfunc" id="3976084">len</span><span class="op" id="3976087">(</span><span class="ident" id="3976088">m</span><span class="op" id="3976089">.</span><span class="ident" id="3976090">signature</span><span class="op" id="3976099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976102">length</span>&nbsp;<span class="op" id="3976109">:=</span>&nbsp;<span class="num" id="3976112">2</span>&nbsp;<span class="op" id="3976114">+</span>&nbsp;<span class="ident" id="3976116">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976127">if</span>&nbsp;<span class="ident" id="3976130">m</span><span class="op" id="3976131">.</span><span class="ident" id="3976132">hasSignatureAndHash</span>&nbsp;<span class="op" id="3976152">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976156">length</span>&nbsp;<span class="op" id="3976163">+=</span>&nbsp;<span class="num" id="3976166">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3976169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976172">x</span>&nbsp;<span class="op" id="3976174">=</span>&nbsp;<span class="builtinfunc" id="3976176">make</span><span class="op" id="3976180">(</span><span class="op" id="3976181">[</span><span class="op" id="3976182">]</span><span class="builtintype" id="3976183">byte</span><span class="op" id="3976187">,</span>&nbsp;<span class="num" id="3976189">4</span><span class="op" id="3976190">+</span><span class="ident" id="3976191">length</span><span class="op" id="3976197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976200">x</span><span class="op" id="3976201">[</span><span class="num" id="3976202">0</span><span class="op" id="3976203">]</span>&nbsp;<span class="op" id="3976205">=</span>&nbsp;<span class="ident" id="3976207">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976230">x</span><span class="op" id="3976231">[</span><span class="num" id="3976232">1</span><span class="op" id="3976233">]</span>&nbsp;<span class="op" id="3976235">=</span>&nbsp;<span class="builtintype" id="3976237">uint8</span><span class="op" id="3976242">(</span><span class="ident" id="3976243">length</span>&nbsp;<span class="op" id="3976250">&gt;&gt;</span>&nbsp;<span class="num" id="3976253">16</span><span class="op" id="3976255">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976258">x</span><span class="op" id="3976259">[</span><span class="num" id="3976260">2</span><span class="op" id="3976261">]</span>&nbsp;<span class="op" id="3976263">=</span>&nbsp;<span class="builtintype" id="3976265">uint8</span><span class="op" id="3976270">(</span><span class="ident" id="3976271">length</span>&nbsp;<span class="op" id="3976278">&gt;&gt;</span>&nbsp;<span class="num" id="3976281">8</span><span class="op" id="3976282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976285">x</span><span class="op" id="3976286">[</span><span class="num" id="3976287">3</span><span class="op" id="3976288">]</span>&nbsp;<span class="op" id="3976290">=</span>&nbsp;<span class="builtintype" id="3976292">uint8</span><span class="op" id="3976297">(</span><span class="ident" id="3976298">length</span><span class="op" id="3976304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976307">y</span>&nbsp;<span class="op" id="3976309">:=</span>&nbsp;<span class="ident" id="3976312">x</span><span class="op" id="3976313">[</span><span class="num" id="3976314">4</span><span class="op" id="3976315">:</span><span class="op" id="3976316">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976319">if</span>&nbsp;<span class="ident" id="3976322">m</span><span class="op" id="3976323">.</span><span class="ident" id="3976324">hasSignatureAndHash</span>&nbsp;<span class="op" id="3976344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976348">y</span><span class="op" id="3976349">[</span><span class="num" id="3976350">0</span><span class="op" id="3976351">]</span>&nbsp;<span class="op" id="3976353">=</span>&nbsp;<span class="ident" id="3976355">m</span><span class="op" id="3976356">.</span><span class="ident" id="3976357">signatureAndHash</span><span class="op" id="3976373">.</span><span class="ident" id="3976374">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976381">y</span><span class="op" id="3976382">[</span><span class="num" id="3976383">1</span><span class="op" id="3976384">]</span>&nbsp;<span class="op" id="3976386">=</span>&nbsp;<span class="ident" id="3976388">m</span><span class="op" id="3976389">.</span><span class="ident" id="3976390">signatureAndHash</span><span class="op" id="3976406">.</span><span class="ident" id="3976407">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976419">y</span>&nbsp;<span class="op" id="3976421">=</span>&nbsp;<span class="ident" id="3976423">y</span><span class="op" id="3976424">[</span><span class="num" id="3976425">2</span><span class="op" id="3976426">:</span><span class="op" id="3976427">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3976430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976433">y</span><span class="op" id="3976434">[</span><span class="num" id="3976435">0</span><span class="op" id="3976436">]</span>&nbsp;<span class="op" id="3976438">=</span>&nbsp;<span class="builtintype" id="3976440">uint8</span><span class="op" id="3976445">(</span><span class="ident" id="3976446">siglength</span>&nbsp;<span class="op" id="3976456">&gt;&gt;</span>&nbsp;<span class="num" id="3976459">8</span><span class="op" id="3976460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976463">y</span><span class="op" id="3976464">[</span><span class="num" id="3976465">1</span><span class="op" id="3976466">]</span>&nbsp;<span class="op" id="3976468">=</span>&nbsp;<span class="builtintype" id="3976470">uint8</span><span class="op" id="3976475">(</span><span class="ident" id="3976476">siglength</span><span class="op" id="3976485">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3976488">copy</span><span class="op" id="3976492">(</span><span class="ident" id="3976493">y</span><span class="op" id="3976494">[</span><span class="num" id="3976495">2</span><span class="op" id="3976496">:</span><span class="op" id="3976497">]</span><span class="op" id="3976498">,</span>&nbsp;<span class="ident" id="3976500">m</span><span class="op" id="3976501">.</span><span class="ident" id="3976502">signature</span><span class="op" id="3976511">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976515">m</span><span class="op" id="3976516">.</span><span class="ident" id="3976517">raw</span>&nbsp;<span class="op" id="3976521">=</span>&nbsp;<span class="ident" id="3976523">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976527">return</span><br>
<span class="lineno">1285</span><span class="op" id="3976534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3976537">func</span>&nbsp;<span class="op" id="3976542">(</span><span class="ident" id="3976543">m</span>&nbsp;<span class="op" id="3976545">*</span><span class="ident" id="3976546">certificateVerifyMsg</span><span class="op" id="3976566">)</span>&nbsp;<span class="ident" id="3976568">unmarshal</span><span class="op" id="3976577">(</span><span class="ident" id="3976578">data</span>&nbsp;<span class="op" id="3976583">[</span><span class="op" id="3976584">]</span><span class="builtintype" id="3976585">byte</span><span class="op" id="3976589">)</span>&nbsp;<span class="builtintype" id="3976591">bool</span>&nbsp;<span class="op" id="3976596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976599">m</span><span class="op" id="3976600">.</span><span class="ident" id="3976601">raw</span>&nbsp;<span class="op" id="3976605">=</span>&nbsp;<span class="ident" id="3976607">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976614">if</span>&nbsp;<span class="builtinfunc" id="3976617">len</span><span class="op" id="3976620">(</span><span class="ident" id="3976621">data</span><span class="op" id="3976625">)</span>&nbsp;<span class="op" id="3976627">&lt;</span>&nbsp;<span class="num" id="3976629">6</span>&nbsp;<span class="op" id="3976631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976635">return</span>&nbsp;<span class="ident" id="3976642">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3976649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976653">length</span>&nbsp;<span class="op" id="3976660">:=</span>&nbsp;<span class="builtintype" id="3976663">uint32</span><span class="op" id="3976669">(</span><span class="ident" id="3976670">data</span><span class="op" id="3976674">[</span><span class="num" id="3976675">1</span><span class="op" id="3976676">]</span><span class="op" id="3976677">)</span><span class="op" id="3976678">&lt;&lt;</span><span class="num" id="3976680">16</span>&nbsp;<span class="op" id="3976683">|</span>&nbsp;<span class="builtintype" id="3976685">uint32</span><span class="op" id="3976691">(</span><span class="ident" id="3976692">data</span><span class="op" id="3976696">[</span><span class="num" id="3976697">2</span><span class="op" id="3976698">]</span><span class="op" id="3976699">)</span><span class="op" id="3976700">&lt;&lt;</span><span class="num" id="3976702">8</span>&nbsp;<span class="op" id="3976704">|</span>&nbsp;<span class="builtintype" id="3976706">uint32</span><span class="op" id="3976712">(</span><span class="ident" id="3976713">data</span><span class="op" id="3976717">[</span><span class="num" id="3976718">3</span><span class="op" id="3976719">]</span><span class="op" id="3976720">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976723">if</span>&nbsp;<span class="builtintype" id="3976726">uint32</span><span class="op" id="3976732">(</span><span class="builtinfunc" id="3976733">len</span><span class="op" id="3976736">(</span><span class="ident" id="3976737">data</span><span class="op" id="3976741">)</span><span class="op" id="3976742">)</span><span class="op" id="3976743">-</span><span class="num" id="3976744">4</span>&nbsp;<span class="op" id="3976746">!=</span>&nbsp;<span class="ident" id="3976749">length</span>&nbsp;<span class="op" id="3976756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976760">return</span>&nbsp;<span class="ident" id="3976767">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3976774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976778">data</span>&nbsp;<span class="op" id="3976783">=</span>&nbsp;<span class="ident" id="3976785">data</span><span class="op" id="3976789">[</span><span class="num" id="3976790">4</span><span class="op" id="3976791">:</span><span class="op" id="3976792">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976795">if</span>&nbsp;<span class="ident" id="3976798">m</span><span class="op" id="3976799">.</span><span class="ident" id="3976800">hasSignatureAndHash</span>&nbsp;<span class="op" id="3976820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976824">m</span><span class="op" id="3976825">.</span><span class="ident" id="3976826">signatureAndHash</span><span class="op" id="3976842">.</span><span class="ident" id="3976843">hash</span>&nbsp;<span class="op" id="3976848">=</span>&nbsp;<span class="ident" id="3976850">data</span><span class="op" id="3976854">[</span><span class="num" id="3976855">0</span><span class="op" id="3976856">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976860">m</span><span class="op" id="3976861">.</span><span class="ident" id="3976862">signatureAndHash</span><span class="op" id="3976878">.</span><span class="ident" id="3976879">signature</span>&nbsp;<span class="op" id="3976889">=</span>&nbsp;<span class="ident" id="3976891">data</span><span class="op" id="3976895">[</span><span class="num" id="3976896">1</span><span class="op" id="3976897">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976901">data</span>&nbsp;<span class="op" id="3976906">=</span>&nbsp;<span class="ident" id="3976908">data</span><span class="op" id="3976912">[</span><span class="num" id="3976913">2</span><span class="op" id="3976914">:</span><span class="op" id="3976915">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3976918">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976922">if</span>&nbsp;<span class="builtinfunc" id="3976925">len</span><span class="op" id="3976928">(</span><span class="ident" id="3976929">data</span><span class="op" id="3976933">)</span>&nbsp;<span class="op" id="3976935">&lt;</span>&nbsp;<span class="num" id="3976937">2</span>&nbsp;<span class="op" id="3976939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976943">return</span>&nbsp;<span class="ident" id="3976950">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3976957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976960">siglength</span>&nbsp;<span class="op" id="3976970">:=</span>&nbsp;<span class="builtintype" id="3976973">int</span><span class="op" id="3976976">(</span><span class="ident" id="3976977">data</span><span class="op" id="3976981">[</span><span class="num" id="3976982">0</span><span class="op" id="3976983">]</span><span class="op" id="3976984">)</span><span class="op" id="3976985">&lt;&lt;</span><span class="num" id="3976987">8</span>&nbsp;<span class="op" id="3976989">+</span>&nbsp;<span class="builtintype" id="3976991">int</span><span class="op" id="3976994">(</span><span class="ident" id="3976995">data</span><span class="op" id="3976999">[</span><span class="num" id="3977000">1</span><span class="op" id="3977001">]</span><span class="op" id="3977002">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977005">data</span>&nbsp;<span class="op" id="3977010">=</span>&nbsp;<span class="ident" id="3977012">data</span><span class="op" id="3977016">[</span><span class="num" id="3977017">2</span><span class="op" id="3977018">:</span><span class="op" id="3977019">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977022">if</span>&nbsp;<span class="builtinfunc" id="3977025">len</span><span class="op" id="3977028">(</span><span class="ident" id="3977029">data</span><span class="op" id="3977033">)</span>&nbsp;<span class="op" id="3977035">!=</span>&nbsp;<span class="ident" id="3977038">siglength</span>&nbsp;<span class="op" id="3977048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977052">return</span>&nbsp;<span class="ident" id="3977059">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3977066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977070">m</span><span class="op" id="3977071">.</span><span class="ident" id="3977072">signature</span>&nbsp;<span class="op" id="3977082">=</span>&nbsp;<span class="ident" id="3977084">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977091">return</span>&nbsp;<span class="ident" id="3977098">true</span><br>
<span class="lineno"></span><span class="op" id="3977103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="3977106">type</span>&nbsp;<span class="ident" id="3977111">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="3977131">struct</span>&nbsp;<span class="op" id="3977138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977141">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977148">[</span><span class="op" id="3977149">]</span><span class="builtintype" id="3977150">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977156">ticket</span>&nbsp;<span class="op" id="3977163">[</span><span class="op" id="3977164">]</span><span class="builtintype" id="3977165">byte</span><br>
<span class="lineno"></span><span class="op" id="3977170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="3977173">func</span>&nbsp;<span class="op" id="3977178">(</span><span class="ident" id="3977179">m</span>&nbsp;<span class="op" id="3977181">*</span><span class="ident" id="3977182">newSessionTicketMsg</span><span class="op" id="3977201">)</span>&nbsp;<span class="ident" id="3977203">equal</span><span class="op" id="3977208">(</span><span class="ident" id="3977209">i</span>&nbsp;<span class="keyword" id="3977211">interface</span><span class="op" id="3977220">{</span><span class="op" id="3977221">}</span><span class="op" id="3977222">)</span>&nbsp;<span class="builtintype" id="3977224">bool</span>&nbsp;<span class="op" id="3977229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977232">m1</span><span class="op" id="3977234">,</span>&nbsp;<span class="ident" id="3977236">ok</span>&nbsp;<span class="op" id="3977239">:=</span>&nbsp;<span class="ident" id="3977242">i</span><span class="op" id="3977243">.</span><span class="op" id="3977244">(</span><span class="op" id="3977245">*</span><span class="ident" id="3977246">newSessionTicketMsg</span><span class="op" id="3977265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977268">if</span>&nbsp;<span class="op" id="3977271">!</span><span class="ident" id="3977272">ok</span>&nbsp;<span class="op" id="3977275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977279">return</span>&nbsp;<span class="ident" id="3977286">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3977293">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977297">return</span>&nbsp;<span class="ident" id="3977304">bytes</span><span class="op" id="3977309">.</span><span class="ident" id="3977310">Equal</span><span class="op" id="3977315">(</span><span class="ident" id="3977316">m</span><span class="op" id="3977317">.</span><span class="ident" id="3977318">raw</span><span class="op" id="3977321">,</span>&nbsp;<span class="ident" id="3977323">m1</span><span class="op" id="3977325">.</span><span class="ident" id="3977326">raw</span><span class="op" id="3977329">)</span>&nbsp;<span class="op" id="3977331">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977336">bytes</span><span class="op" id="3977341">.</span><span class="ident" id="3977342">Equal</span><span class="op" id="3977347">(</span><span class="ident" id="3977348">m</span><span class="op" id="3977349">.</span><span class="ident" id="3977350">ticket</span><span class="op" id="3977356">,</span>&nbsp;<span class="ident" id="3977358">m1</span><span class="op" id="3977360">.</span><span class="ident" id="3977361">ticket</span><span class="op" id="3977367">)</span><br>
<span class="lineno"></span><span class="op" id="3977369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="3977372">func</span>&nbsp;<span class="op" id="3977377">(</span><span class="ident" id="3977378">m</span>&nbsp;<span class="op" id="3977380">*</span><span class="ident" id="3977381">newSessionTicketMsg</span><span class="op" id="3977400">)</span>&nbsp;<span class="ident" id="3977402">marshal</span><span class="op" id="3977409">(</span><span class="op" id="3977410">)</span>&nbsp;<span class="op" id="3977412">(</span><span class="ident" id="3977413">x</span>&nbsp;<span class="op" id="3977415">[</span><span class="op" id="3977416">]</span><span class="builtintype" id="3977417">byte</span><span class="op" id="3977421">)</span>&nbsp;<span class="op" id="3977423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977426">if</span>&nbsp;<span class="ident" id="3977429">m</span><span class="op" id="3977430">.</span><span class="ident" id="3977431">raw</span>&nbsp;<span class="op" id="3977435">!=</span>&nbsp;<span class="ident" id="3977438">nil</span>&nbsp;<span class="op" id="3977442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977446">return</span>&nbsp;<span class="ident" id="3977453">m</span><span class="op" id="3977454">.</span><span class="ident" id="3977455">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3977460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3977464">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977519">ticketLen</span>&nbsp;<span class="op" id="3977529">:=</span>&nbsp;<span class="builtinfunc" id="3977532">len</span><span class="op" id="3977535">(</span><span class="ident" id="3977536">m</span><span class="op" id="3977537">.</span><span class="ident" id="3977538">ticket</span><span class="op" id="3977544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977547">length</span>&nbsp;<span class="op" id="3977554">:=</span>&nbsp;<span class="num" id="3977557">2</span>&nbsp;<span class="op" id="3977559">+</span>&nbsp;<span class="num" id="3977561">4</span>&nbsp;<span class="op" id="3977563">+</span>&nbsp;<span class="ident" id="3977565">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977576">x</span>&nbsp;<span class="op" id="3977578">=</span>&nbsp;<span class="builtinfunc" id="3977580">make</span><span class="op" id="3977584">(</span><span class="op" id="3977585">[</span><span class="op" id="3977586">]</span><span class="builtintype" id="3977587">byte</span><span class="op" id="3977591">,</span>&nbsp;<span class="num" id="3977593">4</span><span class="op" id="3977594">+</span><span class="ident" id="3977595">length</span><span class="op" id="3977601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977604">x</span><span class="op" id="3977605">[</span><span class="num" id="3977606">0</span><span class="op" id="3977607">]</span>&nbsp;<span class="op" id="3977609">=</span>&nbsp;<span class="ident" id="3977611">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977633">x</span><span class="op" id="3977634">[</span><span class="num" id="3977635">1</span><span class="op" id="3977636">]</span>&nbsp;<span class="op" id="3977638">=</span>&nbsp;<span class="builtintype" id="3977640">uint8</span><span class="op" id="3977645">(</span><span class="ident" id="3977646">length</span>&nbsp;<span class="op" id="3977653">&gt;&gt;</span>&nbsp;<span class="num" id="3977656">16</span><span class="op" id="3977658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977661">x</span><span class="op" id="3977662">[</span><span class="num" id="3977663">2</span><span class="op" id="3977664">]</span>&nbsp;<span class="op" id="3977666">=</span>&nbsp;<span class="builtintype" id="3977668">uint8</span><span class="op" id="3977673">(</span><span class="ident" id="3977674">length</span>&nbsp;<span class="op" id="3977681">&gt;&gt;</span>&nbsp;<span class="num" id="3977684">8</span><span class="op" id="3977685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977688">x</span><span class="op" id="3977689">[</span><span class="num" id="3977690">3</span><span class="op" id="3977691">]</span>&nbsp;<span class="op" id="3977693">=</span>&nbsp;<span class="builtintype" id="3977695">uint8</span><span class="op" id="3977700">(</span><span class="ident" id="3977701">length</span><span class="op" id="3977707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977710">x</span><span class="op" id="3977711">[</span><span class="num" id="3977712">8</span><span class="op" id="3977713">]</span>&nbsp;<span class="op" id="3977715">=</span>&nbsp;<span class="builtintype" id="3977717">uint8</span><span class="op" id="3977722">(</span><span class="ident" id="3977723">ticketLen</span>&nbsp;<span class="op" id="3977733">&gt;&gt;</span>&nbsp;<span class="num" id="3977736">8</span><span class="op" id="3977737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977740">x</span><span class="op" id="3977741">[</span><span class="num" id="3977742">9</span><span class="op" id="3977743">]</span>&nbsp;<span class="op" id="3977745">=</span>&nbsp;<span class="builtintype" id="3977747">uint8</span><span class="op" id="3977752">(</span><span class="ident" id="3977753">ticketLen</span><span class="op" id="3977762">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3977765">copy</span><span class="op" id="3977769">(</span><span class="ident" id="3977770">x</span><span class="op" id="3977771">[</span><span class="num" id="3977772">10</span><span class="op" id="3977774">:</span><span class="op" id="3977775">]</span><span class="op" id="3977776">,</span>&nbsp;<span class="ident" id="3977778">m</span><span class="op" id="3977779">.</span><span class="ident" id="3977780">ticket</span><span class="op" id="3977786">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977790">m</span><span class="op" id="3977791">.</span><span class="ident" id="3977792">raw</span>&nbsp;<span class="op" id="3977796">=</span>&nbsp;<span class="ident" id="3977798">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977802">return</span><br>
<span class="lineno">1355</span><span class="op" id="3977809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3977812">func</span>&nbsp;<span class="op" id="3977817">(</span><span class="ident" id="3977818">m</span>&nbsp;<span class="op" id="3977820">*</span><span class="ident" id="3977821">newSessionTicketMsg</span><span class="op" id="3977840">)</span>&nbsp;<span class="ident" id="3977842">unmarshal</span><span class="op" id="3977851">(</span><span class="ident" id="3977852">data</span>&nbsp;<span class="op" id="3977857">[</span><span class="op" id="3977858">]</span><span class="builtintype" id="3977859">byte</span><span class="op" id="3977863">)</span>&nbsp;<span class="builtintype" id="3977865">bool</span>&nbsp;<span class="op" id="3977870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977873">m</span><span class="op" id="3977874">.</span><span class="ident" id="3977875">raw</span>&nbsp;<span class="op" id="3977879">=</span>&nbsp;<span class="ident" id="3977881">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977888">if</span>&nbsp;<span class="builtinfunc" id="3977891">len</span><span class="op" id="3977894">(</span><span class="ident" id="3977895">data</span><span class="op" id="3977899">)</span>&nbsp;<span class="op" id="3977901">&lt;</span>&nbsp;<span class="num" id="3977903">10</span>&nbsp;<span class="op" id="3977906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977910">return</span>&nbsp;<span class="ident" id="3977917">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3977924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977928">length</span>&nbsp;<span class="op" id="3977935">:=</span>&nbsp;<span class="builtintype" id="3977938">uint32</span><span class="op" id="3977944">(</span><span class="ident" id="3977945">data</span><span class="op" id="3977949">[</span><span class="num" id="3977950">1</span><span class="op" id="3977951">]</span><span class="op" id="3977952">)</span><span class="op" id="3977953">&lt;&lt;</span><span class="num" id="3977955">16</span>&nbsp;<span class="op" id="3977958">|</span>&nbsp;<span class="builtintype" id="3977960">uint32</span><span class="op" id="3977966">(</span><span class="ident" id="3977967">data</span><span class="op" id="3977971">[</span><span class="num" id="3977972">2</span><span class="op" id="3977973">]</span><span class="op" id="3977974">)</span><span class="op" id="3977975">&lt;&lt;</span><span class="num" id="3977977">8</span>&nbsp;<span class="op" id="3977979">|</span>&nbsp;<span class="builtintype" id="3977981">uint32</span><span class="op" id="3977987">(</span><span class="ident" id="3977988">data</span><span class="op" id="3977992">[</span><span class="num" id="3977993">3</span><span class="op" id="3977994">]</span><span class="op" id="3977995">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3977998">if</span>&nbsp;<span class="builtintype" id="3978001">uint32</span><span class="op" id="3978007">(</span><span class="builtinfunc" id="3978008">len</span><span class="op" id="3978011">(</span><span class="ident" id="3978012">data</span><span class="op" id="3978016">)</span><span class="op" id="3978017">)</span><span class="op" id="3978018">-</span><span class="num" id="3978019">4</span>&nbsp;<span class="op" id="3978021">!=</span>&nbsp;<span class="ident" id="3978024">length</span>&nbsp;<span class="op" id="3978031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978035">return</span>&nbsp;<span class="ident" id="3978042">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3978053">ticketLen</span>&nbsp;<span class="op" id="3978063">:=</span>&nbsp;<span class="builtintype" id="3978066">int</span><span class="op" id="3978069">(</span><span class="ident" id="3978070">data</span><span class="op" id="3978074">[</span><span class="num" id="3978075">8</span><span class="op" id="3978076">]</span><span class="op" id="3978077">)</span><span class="op" id="3978078">&lt;&lt;</span><span class="num" id="3978080">8</span>&nbsp;<span class="op" id="3978082">+</span>&nbsp;<span class="builtintype" id="3978084">int</span><span class="op" id="3978087">(</span><span class="ident" id="3978088">data</span><span class="op" id="3978092">[</span><span class="num" id="3978093">9</span><span class="op" id="3978094">]</span><span class="op" id="3978095">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978098">if</span>&nbsp;<span class="builtinfunc" id="3978101">len</span><span class="op" id="3978104">(</span><span class="ident" id="3978105">data</span><span class="op" id="3978109">)</span><span class="op" id="3978110">-</span><span class="num" id="3978111">10</span>&nbsp;<span class="op" id="3978114">!=</span>&nbsp;<span class="ident" id="3978117">ticketLen</span>&nbsp;<span class="op" id="3978127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978131">return</span>&nbsp;<span class="ident" id="3978138">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3978149">m</span><span class="op" id="3978150">.</span><span class="ident" id="3978151">ticket</span>&nbsp;<span class="op" id="3978158">=</span>&nbsp;<span class="ident" id="3978160">data</span><span class="op" id="3978164">[</span><span class="num" id="3978165">10</span><span class="op" id="3978167">:</span><span class="op" id="3978168">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978172">return</span>&nbsp;<span class="ident" id="3978179">true</span><br>
<span class="lineno"></span><span class="op" id="3978184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3978187">func</span>&nbsp;<span class="ident" id="3978192">eqUint16s</span><span class="op" id="3978201">(</span><span class="ident" id="3978202">x</span><span class="op" id="3978203">,</span>&nbsp;<span class="ident" id="3978205">y</span>&nbsp;<span class="op" id="3978207">[</span><span class="op" id="3978208">]</span><span class="builtintype" id="3978209">uint16</span><span class="op" id="3978215">)</span>&nbsp;<span class="builtintype" id="3978217">bool</span>&nbsp;<span class="op" id="3978222">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978225">if</span>&nbsp;<span class="builtinfunc" id="3978228">len</span><span class="op" id="3978231">(</span><span class="ident" id="3978232">x</span><span class="op" id="3978233">)</span>&nbsp;<span class="op" id="3978235">!=</span>&nbsp;<span class="builtinfunc" id="3978238">len</span><span class="op" id="3978241">(</span><span class="ident" id="3978242">y</span><span class="op" id="3978243">)</span>&nbsp;<span class="op" id="3978245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978249">return</span>&nbsp;<span class="ident" id="3978256">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978266">for</span>&nbsp;<span class="ident" id="3978270">i</span><span class="op" id="3978271">,</span>&nbsp;<span class="ident" id="3978273">v</span>&nbsp;<span class="op" id="3978275">:=</span>&nbsp;<span class="keyword" id="3978278">range</span>&nbsp;<span class="ident" id="3978284">x</span>&nbsp;<span class="op" id="3978286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978290">if</span>&nbsp;<span class="ident" id="3978293">y</span><span class="op" id="3978294">[</span><span class="ident" id="3978295">i</span><span class="op" id="3978296">]</span>&nbsp;<span class="op" id="3978298">!=</span>&nbsp;<span class="ident" id="3978301">v</span>&nbsp;<span class="op" id="3978303">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978308">return</span>&nbsp;<span class="ident" id="3978315">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978329">return</span>&nbsp;<span class="ident" id="3978336">true</span><br>
<span class="lineno"></span><span class="op" id="3978341">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="3978344">func</span>&nbsp;<span class="ident" id="3978349">eqCurveIDs</span><span class="op" id="3978359">(</span><span class="ident" id="3978360">x</span><span class="op" id="3978361">,</span>&nbsp;<span class="ident" id="3978363">y</span>&nbsp;<span class="op" id="3978365">[</span><span class="op" id="3978366">]</span><span class="ident" id="3978367">CurveID</span><span class="op" id="3978374">)</span>&nbsp;<span class="builtintype" id="3978376">bool</span>&nbsp;<span class="op" id="3978381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978384">if</span>&nbsp;<span class="builtinfunc" id="3978387">len</span><span class="op" id="3978390">(</span><span class="ident" id="3978391">x</span><span class="op" id="3978392">)</span>&nbsp;<span class="op" id="3978394">!=</span>&nbsp;<span class="builtinfunc" id="3978397">len</span><span class="op" id="3978400">(</span><span class="ident" id="3978401">y</span><span class="op" id="3978402">)</span>&nbsp;<span class="op" id="3978404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978408">return</span>&nbsp;<span class="ident" id="3978415">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978422">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978425">for</span>&nbsp;<span class="ident" id="3978429">i</span><span class="op" id="3978430">,</span>&nbsp;<span class="ident" id="3978432">v</span>&nbsp;<span class="op" id="3978434">:=</span>&nbsp;<span class="keyword" id="3978437">range</span>&nbsp;<span class="ident" id="3978443">x</span>&nbsp;<span class="op" id="3978445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978449">if</span>&nbsp;<span class="ident" id="3978452">y</span><span class="op" id="3978453">[</span><span class="ident" id="3978454">i</span><span class="op" id="3978455">]</span>&nbsp;<span class="op" id="3978457">!=</span>&nbsp;<span class="ident" id="3978460">v</span>&nbsp;<span class="op" id="3978462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978467">return</span>&nbsp;<span class="ident" id="3978474">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978485">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978488">return</span>&nbsp;<span class="ident" id="3978495">true</span><br>
<span class="lineno"></span><span class="op" id="3978500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3978503">func</span>&nbsp;<span class="ident" id="3978508">eqStrings</span><span class="op" id="3978517">(</span><span class="ident" id="3978518">x</span><span class="op" id="3978519">,</span>&nbsp;<span class="ident" id="3978521">y</span>&nbsp;<span class="op" id="3978523">[</span><span class="op" id="3978524">]</span><span class="builtintype" id="3978525">string</span><span class="op" id="3978531">)</span>&nbsp;<span class="builtintype" id="3978533">bool</span>&nbsp;<span class="op" id="3978538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978541">if</span>&nbsp;<span class="builtinfunc" id="3978544">len</span><span class="op" id="3978547">(</span><span class="ident" id="3978548">x</span><span class="op" id="3978549">)</span>&nbsp;<span class="op" id="3978551">!=</span>&nbsp;<span class="builtinfunc" id="3978554">len</span><span class="op" id="3978557">(</span><span class="ident" id="3978558">y</span><span class="op" id="3978559">)</span>&nbsp;<span class="op" id="3978561">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978565">return</span>&nbsp;<span class="ident" id="3978572">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978582">for</span>&nbsp;<span class="ident" id="3978586">i</span><span class="op" id="3978587">,</span>&nbsp;<span class="ident" id="3978589">v</span>&nbsp;<span class="op" id="3978591">:=</span>&nbsp;<span class="keyword" id="3978594">range</span>&nbsp;<span class="ident" id="3978600">x</span>&nbsp;<span class="op" id="3978602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978606">if</span>&nbsp;<span class="ident" id="3978609">y</span><span class="op" id="3978610">[</span><span class="ident" id="3978611">i</span><span class="op" id="3978612">]</span>&nbsp;<span class="op" id="3978614">!=</span>&nbsp;<span class="ident" id="3978617">v</span>&nbsp;<span class="op" id="3978619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978624">return</span>&nbsp;<span class="ident" id="3978631">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978645">return</span>&nbsp;<span class="ident" id="3978652">true</span><br>
<span class="lineno"></span><span class="op" id="3978657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="3978660">func</span>&nbsp;<span class="ident" id="3978665">eqByteSlices</span><span class="op" id="3978677">(</span><span class="ident" id="3978678">x</span><span class="op" id="3978679">,</span>&nbsp;<span class="ident" id="3978681">y</span>&nbsp;<span class="op" id="3978683">[</span><span class="op" id="3978684">]</span><span class="op" id="3978685">[</span><span class="op" id="3978686">]</span><span class="builtintype" id="3978687">byte</span><span class="op" id="3978691">)</span>&nbsp;<span class="builtintype" id="3978693">bool</span>&nbsp;<span class="op" id="3978698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978701">if</span>&nbsp;<span class="builtinfunc" id="3978704">len</span><span class="op" id="3978707">(</span><span class="ident" id="3978708">x</span><span class="op" id="3978709">)</span>&nbsp;<span class="op" id="3978711">!=</span>&nbsp;<span class="builtinfunc" id="3978714">len</span><span class="op" id="3978717">(</span><span class="ident" id="3978718">y</span><span class="op" id="3978719">)</span>&nbsp;<span class="op" id="3978721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978725">return</span>&nbsp;<span class="ident" id="3978732">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978742">for</span>&nbsp;<span class="ident" id="3978746">i</span><span class="op" id="3978747">,</span>&nbsp;<span class="ident" id="3978749">v</span>&nbsp;<span class="op" id="3978751">:=</span>&nbsp;<span class="keyword" id="3978754">range</span>&nbsp;<span class="ident" id="3978760">x</span>&nbsp;<span class="op" id="3978762">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978766">if</span>&nbsp;<span class="op" id="3978769">!</span><span class="ident" id="3978770">bytes</span><span class="op" id="3978775">.</span><span class="ident" id="3978776">Equal</span><span class="op" id="3978781">(</span><span class="ident" id="3978782">v</span><span class="op" id="3978783">,</span>&nbsp;<span class="ident" id="3978785">y</span><span class="op" id="3978786">[</span><span class="ident" id="3978787">i</span><span class="op" id="3978788">]</span><span class="op" id="3978789">)</span>&nbsp;<span class="op" id="3978791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978796">return</span>&nbsp;<span class="ident" id="3978803">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978817">return</span>&nbsp;<span class="ident" id="3978824">true</span><br>
<span class="lineno">1425</span><span class="op" id="3978829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3978832">func</span>&nbsp;<span class="ident" id="3978837">eqSignatureAndHashes</span><span class="op" id="3978857">(</span><span class="ident" id="3978858">x</span><span class="op" id="3978859">,</span>&nbsp;<span class="ident" id="3978861">y</span>&nbsp;<span class="op" id="3978863">[</span><span class="op" id="3978864">]</span><span class="ident" id="3978865">signatureAndHash</span><span class="op" id="3978881">)</span>&nbsp;<span class="builtintype" id="3978883">bool</span>&nbsp;<span class="op" id="3978888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978891">if</span>&nbsp;<span class="builtinfunc" id="3978894">len</span><span class="op" id="3978897">(</span><span class="ident" id="3978898">x</span><span class="op" id="3978899">)</span>&nbsp;<span class="op" id="3978901">!=</span>&nbsp;<span class="builtinfunc" id="3978904">len</span><span class="op" id="3978907">(</span><span class="ident" id="3978908">y</span><span class="op" id="3978909">)</span>&nbsp;<span class="op" id="3978911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978915">return</span>&nbsp;<span class="ident" id="3978922">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3978929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978932">for</span>&nbsp;<span class="ident" id="3978936">i</span><span class="op" id="3978937">,</span>&nbsp;<span class="ident" id="3978939">v</span>&nbsp;<span class="op" id="3978941">:=</span>&nbsp;<span class="keyword" id="3978944">range</span>&nbsp;<span class="ident" id="3978950">x</span>&nbsp;<span class="op" id="3978952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3978956">v2</span>&nbsp;<span class="op" id="3978959">:=</span>&nbsp;<span class="ident" id="3978962">y</span><span class="op" id="3978963">[</span><span class="ident" id="3978964">i</span><span class="op" id="3978965">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3978969">if</span>&nbsp;<span class="ident" id="3978972">v</span><span class="op" id="3978973">.</span><span class="ident" id="3978974">hash</span>&nbsp;<span class="op" id="3978979">!=</span>&nbsp;<span class="ident" id="3978982">v2</span><span class="op" id="3978984">.</span><span class="ident" id="3978985">hash</span>&nbsp;<span class="op" id="3978990">||</span>&nbsp;<span class="ident" id="3978993">v</span><span class="op" id="3978994">.</span><span class="ident" id="3978995">signature</span>&nbsp;<span class="op" id="3979005">!=</span>&nbsp;<span class="ident" id="3979008">v2</span><span class="op" id="3979010">.</span><span class="ident" id="3979011">signature</span>&nbsp;<span class="op" id="3979021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3979026">return</span>&nbsp;<span class="ident" id="3979033">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3979041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3979044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3979047">return</span>&nbsp;<span class="ident" id="3979054">true</span><br>
<span class="lineno"></span><span class="op" id="3979059">}</span>
</div>
</body>
</html>
