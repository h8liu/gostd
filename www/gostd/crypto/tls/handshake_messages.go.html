<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3399496">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3399551">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3399605">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3399656">package</span>&nbsp;<span class="ident" id="3399664">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3399669">import</span>&nbsp;<span class="string" id="3399676">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3399685">type</span>&nbsp;<span class="ident" id="3399690">clientHelloMsg</span>&nbsp;<span class="keyword" id="3399705">struct</span>&nbsp;<span class="op" id="3399712">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399715">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3399735">[</span><span class="op" id="3399736">]</span><span class="builtintype" id="3399737">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399743">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3399763">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399771">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3399791">[</span><span class="op" id="3399792">]</span><span class="builtintype" id="3399793">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399799">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3399819">[</span><span class="op" id="3399820">]</span><span class="builtintype" id="3399821">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399827">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3399847">[</span><span class="op" id="3399848">]</span><span class="builtintype" id="3399849">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399857">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="3399877">[</span><span class="op" id="3399878">]</span><span class="builtintype" id="3399879">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399886">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3399906">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399912">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3399932">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399940">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3399960">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399966">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3399986">[</span><span class="op" id="3399987">]</span><span class="ident" id="3399988">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3399997">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3400017">[</span><span class="op" id="3400018">]</span><span class="builtintype" id="3400019">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400026">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3400046">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400052">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3400072">[</span><span class="op" id="3400073">]</span><span class="builtintype" id="3400074">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400081">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="3400101">[</span><span class="op" id="3400102">]</span><span class="ident" id="3400103">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400121">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3400141">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400147">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3400167">[</span><span class="op" id="3400168">]</span><span class="builtintype" id="3400169">string</span><br>
<span class="lineno"></span><span class="op" id="3400176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3400179">func</span>&nbsp;<span class="op" id="3400184">(</span><span class="ident" id="3400185">m</span>&nbsp;<span class="op" id="3400187">*</span><span class="ident" id="3400188">clientHelloMsg</span><span class="op" id="3400202">)</span>&nbsp;<span class="ident" id="3400204">equal</span><span class="op" id="3400209">(</span><span class="ident" id="3400210">i</span>&nbsp;<span class="keyword" id="3400212">interface</span><span class="op" id="3400221">{</span><span class="op" id="3400222">}</span><span class="op" id="3400223">)</span>&nbsp;<span class="builtintype" id="3400225">bool</span>&nbsp;<span class="op" id="3400230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400233">m1</span><span class="op" id="3400235">,</span>&nbsp;<span class="ident" id="3400237">ok</span>&nbsp;<span class="op" id="3400240">:=</span>&nbsp;<span class="ident" id="3400243">i</span><span class="op" id="3400244">.</span><span class="op" id="3400245">(</span><span class="op" id="3400246">*</span><span class="ident" id="3400247">clientHelloMsg</span><span class="op" id="3400261">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3400264">if</span>&nbsp;<span class="op" id="3400267">!</span><span class="ident" id="3400268">ok</span>&nbsp;<span class="op" id="3400271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3400275">return</span>&nbsp;<span class="builtintype" id="3400282">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3400289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3400293">return</span>&nbsp;<span class="ident" id="3400300">bytes</span><span class="op" id="3400305">.</span><span class="ident" id="3400306">Equal</span><span class="op" id="3400311">(</span><span class="ident" id="3400312">m</span><span class="op" id="3400313">.</span><span class="ident" id="3400314">raw</span><span class="op" id="3400317">,</span>&nbsp;<span class="ident" id="3400319">m1</span><span class="op" id="3400321">.</span><span class="ident" id="3400322">raw</span><span class="op" id="3400325">)</span>&nbsp;<span class="op" id="3400327">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400332">m</span><span class="op" id="3400333">.</span><span class="ident" id="3400334">vers</span>&nbsp;<span class="op" id="3400339">==</span>&nbsp;<span class="ident" id="3400342">m1</span><span class="op" id="3400344">.</span><span class="ident" id="3400345">vers</span>&nbsp;<span class="op" id="3400350">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400355">bytes</span><span class="op" id="3400360">.</span><span class="ident" id="3400361">Equal</span><span class="op" id="3400366">(</span><span class="ident" id="3400367">m</span><span class="op" id="3400368">.</span><span class="ident" id="3400369">random</span><span class="op" id="3400375">,</span>&nbsp;<span class="ident" id="3400377">m1</span><span class="op" id="3400379">.</span><span class="ident" id="3400380">random</span><span class="op" id="3400386">)</span>&nbsp;<span class="op" id="3400388">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400393">bytes</span><span class="op" id="3400398">.</span><span class="ident" id="3400399">Equal</span><span class="op" id="3400404">(</span><span class="ident" id="3400405">m</span><span class="op" id="3400406">.</span><span class="ident" id="3400407">sessionId</span><span class="op" id="3400416">,</span>&nbsp;<span class="ident" id="3400418">m1</span><span class="op" id="3400420">.</span><span class="ident" id="3400421">sessionId</span><span class="op" id="3400430">)</span>&nbsp;<span class="op" id="3400432">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400437">eqUint16s</span><span class="op" id="3400446">(</span><span class="ident" id="3400447">m</span><span class="op" id="3400448">.</span><span class="ident" id="3400449">cipherSuites</span><span class="op" id="3400461">,</span>&nbsp;<span class="ident" id="3400463">m1</span><span class="op" id="3400465">.</span><span class="ident" id="3400466">cipherSuites</span><span class="op" id="3400478">)</span>&nbsp;<span class="op" id="3400480">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400485">bytes</span><span class="op" id="3400490">.</span><span class="ident" id="3400491">Equal</span><span class="op" id="3400496">(</span><span class="ident" id="3400497">m</span><span class="op" id="3400498">.</span><span class="ident" id="3400499">compressionMethods</span><span class="op" id="3400517">,</span>&nbsp;<span class="ident" id="3400519">m1</span><span class="op" id="3400521">.</span><span class="ident" id="3400522">compressionMethods</span><span class="op" id="3400540">)</span>&nbsp;<span class="op" id="3400542">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400547">m</span><span class="op" id="3400548">.</span><span class="ident" id="3400549">nextProtoNeg</span>&nbsp;<span class="op" id="3400562">==</span>&nbsp;<span class="ident" id="3400565">m1</span><span class="op" id="3400567">.</span><span class="ident" id="3400568">nextProtoNeg</span>&nbsp;<span class="op" id="3400581">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400586">m</span><span class="op" id="3400587">.</span><span class="ident" id="3400588">serverName</span>&nbsp;<span class="op" id="3400599">==</span>&nbsp;<span class="ident" id="3400602">m1</span><span class="op" id="3400604">.</span><span class="ident" id="3400605">serverName</span>&nbsp;<span class="op" id="3400616">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400621">m</span><span class="op" id="3400622">.</span><span class="ident" id="3400623">ocspStapling</span>&nbsp;<span class="op" id="3400636">==</span>&nbsp;<span class="ident" id="3400639">m1</span><span class="op" id="3400641">.</span><span class="ident" id="3400642">ocspStapling</span>&nbsp;<span class="op" id="3400655">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400660">eqCurveIDs</span><span class="op" id="3400670">(</span><span class="ident" id="3400671">m</span><span class="op" id="3400672">.</span><span class="ident" id="3400673">supportedCurves</span><span class="op" id="3400688">,</span>&nbsp;<span class="ident" id="3400690">m1</span><span class="op" id="3400692">.</span><span class="ident" id="3400693">supportedCurves</span><span class="op" id="3400708">)</span>&nbsp;<span class="op" id="3400710">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400715">bytes</span><span class="op" id="3400720">.</span><span class="ident" id="3400721">Equal</span><span class="op" id="3400726">(</span><span class="ident" id="3400727">m</span><span class="op" id="3400728">.</span><span class="ident" id="3400729">supportedPoints</span><span class="op" id="3400744">,</span>&nbsp;<span class="ident" id="3400746">m1</span><span class="op" id="3400748">.</span><span class="ident" id="3400749">supportedPoints</span><span class="op" id="3400764">)</span>&nbsp;<span class="op" id="3400766">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400771">m</span><span class="op" id="3400772">.</span><span class="ident" id="3400773">ticketSupported</span>&nbsp;<span class="op" id="3400789">==</span>&nbsp;<span class="ident" id="3400792">m1</span><span class="op" id="3400794">.</span><span class="ident" id="3400795">ticketSupported</span>&nbsp;<span class="op" id="3400811">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400816">bytes</span><span class="op" id="3400821">.</span><span class="ident" id="3400822">Equal</span><span class="op" id="3400827">(</span><span class="ident" id="3400828">m</span><span class="op" id="3400829">.</span><span class="ident" id="3400830">sessionTicket</span><span class="op" id="3400843">,</span>&nbsp;<span class="ident" id="3400845">m1</span><span class="op" id="3400847">.</span><span class="ident" id="3400848">sessionTicket</span><span class="op" id="3400861">)</span>&nbsp;<span class="op" id="3400863">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400868">eqSignatureAndHashes</span><span class="op" id="3400888">(</span><span class="ident" id="3400889">m</span><span class="op" id="3400890">.</span><span class="ident" id="3400891">signatureAndHashes</span><span class="op" id="3400909">,</span>&nbsp;<span class="ident" id="3400911">m1</span><span class="op" id="3400913">.</span><span class="ident" id="3400914">signatureAndHashes</span><span class="op" id="3400932">)</span>&nbsp;<span class="op" id="3400934">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400939">m</span><span class="op" id="3400940">.</span><span class="ident" id="3400941">secureRenegotiation</span>&nbsp;<span class="op" id="3400961">==</span>&nbsp;<span class="ident" id="3400964">m1</span><span class="op" id="3400966">.</span><span class="ident" id="3400967">secureRenegotiation</span>&nbsp;<span class="op" id="3400987">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3400992">eqStrings</span><span class="op" id="3401001">(</span><span class="ident" id="3401002">m</span><span class="op" id="3401003">.</span><span class="ident" id="3401004">alpnProtocols</span><span class="op" id="3401017">,</span>&nbsp;<span class="ident" id="3401019">m1</span><span class="op" id="3401021">.</span><span class="ident" id="3401022">alpnProtocols</span><span class="op" id="3401035">)</span><br>
<span class="lineno">50</span><span class="op" id="3401037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3401040">func</span>&nbsp;<span class="op" id="3401045">(</span><span class="ident" id="3401046">m</span>&nbsp;<span class="op" id="3401048">*</span><span class="ident" id="3401049">clientHelloMsg</span><span class="op" id="3401063">)</span>&nbsp;<span class="ident" id="3401065">marshal</span><span class="op" id="3401072">(</span><span class="op" id="3401073">)</span>&nbsp;<span class="op" id="3401075">[</span><span class="op" id="3401076">]</span><span class="builtintype" id="3401077">byte</span>&nbsp;<span class="op" id="3401082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401085">if</span>&nbsp;<span class="ident" id="3401088">m</span><span class="op" id="3401089">.</span><span class="ident" id="3401090">raw</span>&nbsp;<span class="op" id="3401094">!=</span>&nbsp;<span class="ident" id="3401097">nil</span>&nbsp;<span class="op" id="3401101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401105">return</span>&nbsp;<span class="ident" id="3401112">m</span><span class="op" id="3401113">.</span><span class="ident" id="3401114">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3401119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401123">length</span>&nbsp;<span class="op" id="3401130">:=</span>&nbsp;<span class="num" id="3401133">2</span>&nbsp;<span class="op" id="3401135">+</span>&nbsp;<span class="num" id="3401137">32</span>&nbsp;<span class="op" id="3401140">+</span>&nbsp;<span class="num" id="3401142">1</span>&nbsp;<span class="op" id="3401144">+</span>&nbsp;<span class="builtinfunc" id="3401146">len</span><span class="op" id="3401149">(</span><span class="ident" id="3401150">m</span><span class="op" id="3401151">.</span><span class="ident" id="3401152">sessionId</span><span class="op" id="3401161">)</span>&nbsp;<span class="op" id="3401163">+</span>&nbsp;<span class="num" id="3401165">2</span>&nbsp;<span class="op" id="3401167">+</span>&nbsp;<span class="builtinfunc" id="3401169">len</span><span class="op" id="3401172">(</span><span class="ident" id="3401173">m</span><span class="op" id="3401174">.</span><span class="ident" id="3401175">cipherSuites</span><span class="op" id="3401187">)</span><span class="op" id="3401188">*</span><span class="num" id="3401189">2</span>&nbsp;<span class="op" id="3401191">+</span>&nbsp;<span class="num" id="3401193">1</span>&nbsp;<span class="op" id="3401195">+</span>&nbsp;<span class="builtinfunc" id="3401197">len</span><span class="op" id="3401200">(</span><span class="ident" id="3401201">m</span><span class="op" id="3401202">.</span><span class="ident" id="3401203">compressionMethods</span><span class="op" id="3401221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401224">numExtensions</span>&nbsp;<span class="op" id="3401238">:=</span>&nbsp;<span class="num" id="3401241">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401244">extensionsLength</span>&nbsp;<span class="op" id="3401261">:=</span>&nbsp;<span class="num" id="3401264">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401267">if</span>&nbsp;<span class="ident" id="3401270">m</span><span class="op" id="3401271">.</span><span class="ident" id="3401272">nextProtoNeg</span>&nbsp;<span class="op" id="3401285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401289">numExtensions</span><span class="op" id="3401302">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3401306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401309">if</span>&nbsp;<span class="ident" id="3401312">m</span><span class="op" id="3401313">.</span><span class="ident" id="3401314">ocspStapling</span>&nbsp;<span class="op" id="3401327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401331">extensionsLength</span>&nbsp;<span class="op" id="3401348">+=</span>&nbsp;<span class="num" id="3401351">1</span>&nbsp;<span class="op" id="3401353">+</span>&nbsp;<span class="num" id="3401355">2</span>&nbsp;<span class="op" id="3401357">+</span>&nbsp;<span class="num" id="3401359">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401363">numExtensions</span><span class="op" id="3401376">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3401380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401383">if</span>&nbsp;<span class="builtinfunc" id="3401386">len</span><span class="op" id="3401389">(</span><span class="ident" id="3401390">m</span><span class="op" id="3401391">.</span><span class="ident" id="3401392">serverName</span><span class="op" id="3401402">)</span>&nbsp;<span class="op" id="3401404">&gt;</span>&nbsp;<span class="num" id="3401406">0</span>&nbsp;<span class="op" id="3401408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401412">extensionsLength</span>&nbsp;<span class="op" id="3401429">+=</span>&nbsp;<span class="num" id="3401432">5</span>&nbsp;<span class="op" id="3401434">+</span>&nbsp;<span class="builtinfunc" id="3401436">len</span><span class="op" id="3401439">(</span><span class="ident" id="3401440">m</span><span class="op" id="3401441">.</span><span class="ident" id="3401442">serverName</span><span class="op" id="3401452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401456">numExtensions</span><span class="op" id="3401469">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3401473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401476">if</span>&nbsp;<span class="builtinfunc" id="3401479">len</span><span class="op" id="3401482">(</span><span class="ident" id="3401483">m</span><span class="op" id="3401484">.</span><span class="ident" id="3401485">supportedCurves</span><span class="op" id="3401500">)</span>&nbsp;<span class="op" id="3401502">&gt;</span>&nbsp;<span class="num" id="3401504">0</span>&nbsp;<span class="op" id="3401506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401510">extensionsLength</span>&nbsp;<span class="op" id="3401527">+=</span>&nbsp;<span class="num" id="3401530">2</span>&nbsp;<span class="op" id="3401532">+</span>&nbsp;<span class="num" id="3401534">2</span><span class="op" id="3401535">*</span><span class="builtinfunc" id="3401536">len</span><span class="op" id="3401539">(</span><span class="ident" id="3401540">m</span><span class="op" id="3401541">.</span><span class="ident" id="3401542">supportedCurves</span><span class="op" id="3401557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401561">numExtensions</span><span class="op" id="3401574">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3401578">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401581">if</span>&nbsp;<span class="builtinfunc" id="3401584">len</span><span class="op" id="3401587">(</span><span class="ident" id="3401588">m</span><span class="op" id="3401589">.</span><span class="ident" id="3401590">supportedPoints</span><span class="op" id="3401605">)</span>&nbsp;<span class="op" id="3401607">&gt;</span>&nbsp;<span class="num" id="3401609">0</span>&nbsp;<span class="op" id="3401611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401615">extensionsLength</span>&nbsp;<span class="op" id="3401632">+=</span>&nbsp;<span class="num" id="3401635">1</span>&nbsp;<span class="op" id="3401637">+</span>&nbsp;<span class="builtinfunc" id="3401639">len</span><span class="op" id="3401642">(</span><span class="ident" id="3401643">m</span><span class="op" id="3401644">.</span><span class="ident" id="3401645">supportedPoints</span><span class="op" id="3401660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401664">numExtensions</span><span class="op" id="3401677">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3401681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401684">if</span>&nbsp;<span class="ident" id="3401687">m</span><span class="op" id="3401688">.</span><span class="ident" id="3401689">ticketSupported</span>&nbsp;<span class="op" id="3401705">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401709">extensionsLength</span>&nbsp;<span class="op" id="3401726">+=</span>&nbsp;<span class="builtinfunc" id="3401729">len</span><span class="op" id="3401732">(</span><span class="ident" id="3401733">m</span><span class="op" id="3401734">.</span><span class="ident" id="3401735">sessionTicket</span><span class="op" id="3401748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401752">numExtensions</span><span class="op" id="3401765">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3401769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401772">if</span>&nbsp;<span class="builtinfunc" id="3401775">len</span><span class="op" id="3401778">(</span><span class="ident" id="3401779">m</span><span class="op" id="3401780">.</span><span class="ident" id="3401781">signatureAndHashes</span><span class="op" id="3401799">)</span>&nbsp;<span class="op" id="3401801">&gt;</span>&nbsp;<span class="num" id="3401803">0</span>&nbsp;<span class="op" id="3401805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401809">extensionsLength</span>&nbsp;<span class="op" id="3401826">+=</span>&nbsp;<span class="num" id="3401829">2</span>&nbsp;<span class="op" id="3401831">+</span>&nbsp;<span class="num" id="3401833">2</span><span class="op" id="3401834">*</span><span class="builtinfunc" id="3401835">len</span><span class="op" id="3401838">(</span><span class="ident" id="3401839">m</span><span class="op" id="3401840">.</span><span class="ident" id="3401841">signatureAndHashes</span><span class="op" id="3401859">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401863">numExtensions</span><span class="op" id="3401876">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3401880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401883">if</span>&nbsp;<span class="ident" id="3401886">m</span><span class="op" id="3401887">.</span><span class="ident" id="3401888">secureRenegotiation</span>&nbsp;<span class="op" id="3401908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401912">extensionsLength</span>&nbsp;<span class="op" id="3401929">+=</span>&nbsp;<span class="num" id="3401932">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401936">numExtensions</span><span class="op" id="3401949">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3401953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3401956">if</span>&nbsp;<span class="builtinfunc" id="3401959">len</span><span class="op" id="3401962">(</span><span class="ident" id="3401963">m</span><span class="op" id="3401964">.</span><span class="ident" id="3401965">alpnProtocols</span><span class="op" id="3401978">)</span>&nbsp;<span class="op" id="3401980">&gt;</span>&nbsp;<span class="num" id="3401982">0</span>&nbsp;<span class="op" id="3401984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3401988">extensionsLength</span>&nbsp;<span class="op" id="3402005">+=</span>&nbsp;<span class="num" id="3402008">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3402012">for</span>&nbsp;<span class="ident" id="3402016">_</span><span class="op" id="3402017">,</span>&nbsp;<span class="ident" id="3402019">s</span>&nbsp;<span class="op" id="3402021">:=</span>&nbsp;<span class="keyword" id="3402024">range</span>&nbsp;<span class="ident" id="3402030">m</span><span class="op" id="3402031">.</span><span class="ident" id="3402032">alpnProtocols</span>&nbsp;<span class="op" id="3402046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3402051">if</span>&nbsp;<span class="ident" id="3402054">l</span>&nbsp;<span class="op" id="3402056">:=</span>&nbsp;<span class="builtinfunc" id="3402059">len</span><span class="op" id="3402062">(</span><span class="ident" id="3402063">s</span><span class="op" id="3402064">)</span><span class="op" id="3402065">;</span>&nbsp;<span class="ident" id="3402067">l</span>&nbsp;<span class="op" id="3402069">==</span>&nbsp;<span class="num" id="3402072">0</span>&nbsp;<span class="op" id="3402074">||</span>&nbsp;<span class="ident" id="3402077">l</span>&nbsp;<span class="op" id="3402079">&gt;</span>&nbsp;<span class="num" id="3402081">255</span>&nbsp;<span class="op" id="3402085">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3402091">panic</span><span class="op" id="3402096">(</span><span class="string" id="3402097">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3402120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3402125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402130">extensionsLength</span><span class="op" id="3402146">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402152">extensionsLength</span>&nbsp;<span class="op" id="3402169">+=</span>&nbsp;<span class="builtinfunc" id="3402172">len</span><span class="op" id="3402175">(</span><span class="ident" id="3402176">s</span><span class="op" id="3402177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3402181">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402185">numExtensions</span><span class="op" id="3402198">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3402202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3402205">if</span>&nbsp;<span class="ident" id="3402208">numExtensions</span>&nbsp;<span class="op" id="3402222">&gt;</span>&nbsp;<span class="num" id="3402224">0</span>&nbsp;<span class="op" id="3402226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402230">extensionsLength</span>&nbsp;<span class="op" id="3402247">+=</span>&nbsp;<span class="num" id="3402250">4</span>&nbsp;<span class="op" id="3402252">*</span>&nbsp;<span class="ident" id="3402254">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402270">length</span>&nbsp;<span class="op" id="3402277">+=</span>&nbsp;<span class="num" id="3402280">2</span>&nbsp;<span class="op" id="3402282">+</span>&nbsp;<span class="ident" id="3402284">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3402302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402306">x</span>&nbsp;<span class="op" id="3402308">:=</span>&nbsp;<span class="builtinfunc" id="3402311">make</span><span class="op" id="3402315">(</span><span class="op" id="3402316">[</span><span class="op" id="3402317">]</span><span class="builtintype" id="3402318">byte</span><span class="op" id="3402322">,</span>&nbsp;<span class="num" id="3402324">4</span><span class="op" id="3402325">+</span><span class="ident" id="3402326">length</span><span class="op" id="3402332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402335">x</span><span class="op" id="3402336">[</span><span class="num" id="3402337">0</span><span class="op" id="3402338">]</span>&nbsp;<span class="op" id="3402340">=</span>&nbsp;<span class="ident" id="3402342">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402359">x</span><span class="op" id="3402360">[</span><span class="num" id="3402361">1</span><span class="op" id="3402362">]</span>&nbsp;<span class="op" id="3402364">=</span>&nbsp;<span class="builtintype" id="3402366">uint8</span><span class="op" id="3402371">(</span><span class="ident" id="3402372">length</span>&nbsp;<span class="op" id="3402379">&gt;&gt;</span>&nbsp;<span class="num" id="3402382">16</span><span class="op" id="3402384">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402387">x</span><span class="op" id="3402388">[</span><span class="num" id="3402389">2</span><span class="op" id="3402390">]</span>&nbsp;<span class="op" id="3402392">=</span>&nbsp;<span class="builtintype" id="3402394">uint8</span><span class="op" id="3402399">(</span><span class="ident" id="3402400">length</span>&nbsp;<span class="op" id="3402407">&gt;&gt;</span>&nbsp;<span class="num" id="3402410">8</span><span class="op" id="3402411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402414">x</span><span class="op" id="3402415">[</span><span class="num" id="3402416">3</span><span class="op" id="3402417">]</span>&nbsp;<span class="op" id="3402419">=</span>&nbsp;<span class="builtintype" id="3402421">uint8</span><span class="op" id="3402426">(</span><span class="ident" id="3402427">length</span><span class="op" id="3402433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402436">x</span><span class="op" id="3402437">[</span><span class="num" id="3402438">4</span><span class="op" id="3402439">]</span>&nbsp;<span class="op" id="3402441">=</span>&nbsp;<span class="builtintype" id="3402443">uint8</span><span class="op" id="3402448">(</span><span class="ident" id="3402449">m</span><span class="op" id="3402450">.</span><span class="ident" id="3402451">vers</span>&nbsp;<span class="op" id="3402456">&gt;&gt;</span>&nbsp;<span class="num" id="3402459">8</span><span class="op" id="3402460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402463">x</span><span class="op" id="3402464">[</span><span class="num" id="3402465">5</span><span class="op" id="3402466">]</span>&nbsp;<span class="op" id="3402468">=</span>&nbsp;<span class="builtintype" id="3402470">uint8</span><span class="op" id="3402475">(</span><span class="ident" id="3402476">m</span><span class="op" id="3402477">.</span><span class="ident" id="3402478">vers</span><span class="op" id="3402482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3402485">copy</span><span class="op" id="3402489">(</span><span class="ident" id="3402490">x</span><span class="op" id="3402491">[</span><span class="num" id="3402492">6</span><span class="op" id="3402493">:</span><span class="num" id="3402494">38</span><span class="op" id="3402496">]</span><span class="op" id="3402497">,</span>&nbsp;<span class="ident" id="3402499">m</span><span class="op" id="3402500">.</span><span class="ident" id="3402501">random</span><span class="op" id="3402507">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402510">x</span><span class="op" id="3402511">[</span><span class="num" id="3402512">38</span><span class="op" id="3402514">]</span>&nbsp;<span class="op" id="3402516">=</span>&nbsp;<span class="builtintype" id="3402518">uint8</span><span class="op" id="3402523">(</span><span class="builtinfunc" id="3402524">len</span><span class="op" id="3402527">(</span><span class="ident" id="3402528">m</span><span class="op" id="3402529">.</span><span class="ident" id="3402530">sessionId</span><span class="op" id="3402539">)</span><span class="op" id="3402540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3402543">copy</span><span class="op" id="3402547">(</span><span class="ident" id="3402548">x</span><span class="op" id="3402549">[</span><span class="num" id="3402550">39</span><span class="op" id="3402552">:</span><span class="num" id="3402553">39</span><span class="op" id="3402555">+</span><span class="builtinfunc" id="3402556">len</span><span class="op" id="3402559">(</span><span class="ident" id="3402560">m</span><span class="op" id="3402561">.</span><span class="ident" id="3402562">sessionId</span><span class="op" id="3402571">)</span><span class="op" id="3402572">]</span><span class="op" id="3402573">,</span>&nbsp;<span class="ident" id="3402575">m</span><span class="op" id="3402576">.</span><span class="ident" id="3402577">sessionId</span><span class="op" id="3402586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402589">y</span>&nbsp;<span class="op" id="3402591">:=</span>&nbsp;<span class="ident" id="3402594">x</span><span class="op" id="3402595">[</span><span class="num" id="3402596">39</span><span class="op" id="3402598">+</span><span class="builtinfunc" id="3402599">len</span><span class="op" id="3402602">(</span><span class="ident" id="3402603">m</span><span class="op" id="3402604">.</span><span class="ident" id="3402605">sessionId</span><span class="op" id="3402614">)</span><span class="op" id="3402615">:</span><span class="op" id="3402616">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402619">y</span><span class="op" id="3402620">[</span><span class="num" id="3402621">0</span><span class="op" id="3402622">]</span>&nbsp;<span class="op" id="3402624">=</span>&nbsp;<span class="builtintype" id="3402626">uint8</span><span class="op" id="3402631">(</span><span class="builtinfunc" id="3402632">len</span><span class="op" id="3402635">(</span><span class="ident" id="3402636">m</span><span class="op" id="3402637">.</span><span class="ident" id="3402638">cipherSuites</span><span class="op" id="3402650">)</span>&nbsp;<span class="op" id="3402652">&gt;&gt;</span>&nbsp;<span class="num" id="3402655">7</span><span class="op" id="3402656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402659">y</span><span class="op" id="3402660">[</span><span class="num" id="3402661">1</span><span class="op" id="3402662">]</span>&nbsp;<span class="op" id="3402664">=</span>&nbsp;<span class="builtintype" id="3402666">uint8</span><span class="op" id="3402671">(</span><span class="builtinfunc" id="3402672">len</span><span class="op" id="3402675">(</span><span class="ident" id="3402676">m</span><span class="op" id="3402677">.</span><span class="ident" id="3402678">cipherSuites</span><span class="op" id="3402690">)</span>&nbsp;<span class="op" id="3402692">&lt;&lt;</span>&nbsp;<span class="num" id="3402695">1</span><span class="op" id="3402696">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3402699">for</span>&nbsp;<span class="ident" id="3402703">i</span><span class="op" id="3402704">,</span>&nbsp;<span class="ident" id="3402706">suite</span>&nbsp;<span class="op" id="3402712">:=</span>&nbsp;<span class="keyword" id="3402715">range</span>&nbsp;<span class="ident" id="3402721">m</span><span class="op" id="3402722">.</span><span class="ident" id="3402723">cipherSuites</span>&nbsp;<span class="op" id="3402736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402740">y</span><span class="op" id="3402741">[</span><span class="num" id="3402742">2</span><span class="op" id="3402743">+</span><span class="ident" id="3402744">i</span><span class="op" id="3402745">*</span><span class="num" id="3402746">2</span><span class="op" id="3402747">]</span>&nbsp;<span class="op" id="3402749">=</span>&nbsp;<span class="builtintype" id="3402751">uint8</span><span class="op" id="3402756">(</span><span class="ident" id="3402757">suite</span>&nbsp;<span class="op" id="3402763">&gt;&gt;</span>&nbsp;<span class="num" id="3402766">8</span><span class="op" id="3402767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402771">y</span><span class="op" id="3402772">[</span><span class="num" id="3402773">3</span><span class="op" id="3402774">+</span><span class="ident" id="3402775">i</span><span class="op" id="3402776">*</span><span class="num" id="3402777">2</span><span class="op" id="3402778">]</span>&nbsp;<span class="op" id="3402780">=</span>&nbsp;<span class="builtintype" id="3402782">uint8</span><span class="op" id="3402787">(</span><span class="ident" id="3402788">suite</span><span class="op" id="3402793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3402796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402799">z</span>&nbsp;<span class="op" id="3402801">:=</span>&nbsp;<span class="ident" id="3402804">y</span><span class="op" id="3402805">[</span><span class="num" id="3402806">2</span><span class="op" id="3402807">+</span><span class="builtinfunc" id="3402808">len</span><span class="op" id="3402811">(</span><span class="ident" id="3402812">m</span><span class="op" id="3402813">.</span><span class="ident" id="3402814">cipherSuites</span><span class="op" id="3402826">)</span><span class="op" id="3402827">*</span><span class="num" id="3402828">2</span><span class="op" id="3402829">:</span><span class="op" id="3402830">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402833">z</span><span class="op" id="3402834">[</span><span class="num" id="3402835">0</span><span class="op" id="3402836">]</span>&nbsp;<span class="op" id="3402838">=</span>&nbsp;<span class="builtintype" id="3402840">uint8</span><span class="op" id="3402845">(</span><span class="builtinfunc" id="3402846">len</span><span class="op" id="3402849">(</span><span class="ident" id="3402850">m</span><span class="op" id="3402851">.</span><span class="ident" id="3402852">compressionMethods</span><span class="op" id="3402870">)</span><span class="op" id="3402871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3402874">copy</span><span class="op" id="3402878">(</span><span class="ident" id="3402879">z</span><span class="op" id="3402880">[</span><span class="num" id="3402881">1</span><span class="op" id="3402882">:</span><span class="op" id="3402883">]</span><span class="op" id="3402884">,</span>&nbsp;<span class="ident" id="3402886">m</span><span class="op" id="3402887">.</span><span class="ident" id="3402888">compressionMethods</span><span class="op" id="3402906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402910">z</span>&nbsp;<span class="op" id="3402912">=</span>&nbsp;<span class="ident" id="3402914">z</span><span class="op" id="3402915">[</span><span class="num" id="3402916">1</span><span class="op" id="3402917">+</span><span class="builtinfunc" id="3402918">len</span><span class="op" id="3402921">(</span><span class="ident" id="3402922">m</span><span class="op" id="3402923">.</span><span class="ident" id="3402924">compressionMethods</span><span class="op" id="3402942">)</span><span class="op" id="3402943">:</span><span class="op" id="3402944">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3402947">if</span>&nbsp;<span class="ident" id="3402950">numExtensions</span>&nbsp;<span class="op" id="3402964">&gt;</span>&nbsp;<span class="num" id="3402966">0</span>&nbsp;<span class="op" id="3402968">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3402972">z</span><span class="op" id="3402973">[</span><span class="num" id="3402974">0</span><span class="op" id="3402975">]</span>&nbsp;<span class="op" id="3402977">=</span>&nbsp;<span class="builtintype" id="3402979">byte</span><span class="op" id="3402983">(</span><span class="ident" id="3402984">extensionsLength</span>&nbsp;<span class="op" id="3403001">&gt;&gt;</span>&nbsp;<span class="num" id="3403004">8</span><span class="op" id="3403005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403009">z</span><span class="op" id="3403010">[</span><span class="num" id="3403011">1</span><span class="op" id="3403012">]</span>&nbsp;<span class="op" id="3403014">=</span>&nbsp;<span class="builtintype" id="3403016">byte</span><span class="op" id="3403020">(</span><span class="ident" id="3403021">extensionsLength</span><span class="op" id="3403037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403041">z</span>&nbsp;<span class="op" id="3403043">=</span>&nbsp;<span class="ident" id="3403045">z</span><span class="op" id="3403046">[</span><span class="num" id="3403047">2</span><span class="op" id="3403048">:</span><span class="op" id="3403049">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3403052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3403055">if</span>&nbsp;<span class="ident" id="3403058">m</span><span class="op" id="3403059">.</span><span class="ident" id="3403060">nextProtoNeg</span>&nbsp;<span class="op" id="3403073">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403077">z</span><span class="op" id="3403078">[</span><span class="num" id="3403079">0</span><span class="op" id="3403080">]</span>&nbsp;<span class="op" id="3403082">=</span>&nbsp;<span class="builtintype" id="3403084">byte</span><span class="op" id="3403088">(</span><span class="ident" id="3403089">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3403111">&gt;&gt;</span>&nbsp;<span class="num" id="3403114">8</span><span class="op" id="3403115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403119">z</span><span class="op" id="3403120">[</span><span class="num" id="3403121">1</span><span class="op" id="3403122">]</span>&nbsp;<span class="op" id="3403124">=</span>&nbsp;<span class="builtintype" id="3403126">byte</span><span class="op" id="3403130">(</span><span class="ident" id="3403131">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3403153">&amp;</span>&nbsp;<span class="num" id="3403155">0xff</span><span class="op" id="3403159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403163">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403191">z</span>&nbsp;<span class="op" id="3403193">=</span>&nbsp;<span class="ident" id="3403195">z</span><span class="op" id="3403196">[</span><span class="num" id="3403197">4</span><span class="op" id="3403198">:</span><span class="op" id="3403199">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3403202">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3403205">if</span>&nbsp;<span class="builtinfunc" id="3403208">len</span><span class="op" id="3403211">(</span><span class="ident" id="3403212">m</span><span class="op" id="3403213">.</span><span class="ident" id="3403214">serverName</span><span class="op" id="3403224">)</span>&nbsp;<span class="op" id="3403226">&gt;</span>&nbsp;<span class="num" id="3403228">0</span>&nbsp;<span class="op" id="3403230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403234">z</span><span class="op" id="3403235">[</span><span class="num" id="3403236">0</span><span class="op" id="3403237">]</span>&nbsp;<span class="op" id="3403239">=</span>&nbsp;<span class="builtintype" id="3403241">byte</span><span class="op" id="3403245">(</span><span class="ident" id="3403246">extensionServerName</span>&nbsp;<span class="op" id="3403266">&gt;&gt;</span>&nbsp;<span class="num" id="3403269">8</span><span class="op" id="3403270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403274">z</span><span class="op" id="3403275">[</span><span class="num" id="3403276">1</span><span class="op" id="3403277">]</span>&nbsp;<span class="op" id="3403279">=</span>&nbsp;<span class="builtintype" id="3403281">byte</span><span class="op" id="3403285">(</span><span class="ident" id="3403286">extensionServerName</span>&nbsp;<span class="op" id="3403306">&amp;</span>&nbsp;<span class="num" id="3403308">0xff</span><span class="op" id="3403312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403316">l</span>&nbsp;<span class="op" id="3403318">:=</span>&nbsp;<span class="builtinfunc" id="3403321">len</span><span class="op" id="3403324">(</span><span class="ident" id="3403325">m</span><span class="op" id="3403326">.</span><span class="ident" id="3403327">serverName</span><span class="op" id="3403337">)</span>&nbsp;<span class="op" id="3403339">+</span>&nbsp;<span class="num" id="3403341">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403345">z</span><span class="op" id="3403346">[</span><span class="num" id="3403347">2</span><span class="op" id="3403348">]</span>&nbsp;<span class="op" id="3403350">=</span>&nbsp;<span class="builtintype" id="3403352">byte</span><span class="op" id="3403356">(</span><span class="ident" id="3403357">l</span>&nbsp;<span class="op" id="3403359">&gt;&gt;</span>&nbsp;<span class="num" id="3403362">8</span><span class="op" id="3403363">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403367">z</span><span class="op" id="3403368">[</span><span class="num" id="3403369">3</span><span class="op" id="3403370">]</span>&nbsp;<span class="op" id="3403372">=</span>&nbsp;<span class="builtintype" id="3403374">byte</span><span class="op" id="3403378">(</span><span class="ident" id="3403379">l</span><span class="op" id="3403380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403384">z</span>&nbsp;<span class="op" id="3403386">=</span>&nbsp;<span class="ident" id="3403388">z</span><span class="op" id="3403389">[</span><span class="num" id="3403390">4</span><span class="op" id="3403391">:</span><span class="op" id="3403392">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403397">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403424">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403429">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403443">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403472">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403502">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403541">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403558">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403577">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403582">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403594">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403623">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403640">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403645">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403678">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403683">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403697">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403745">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403769">z</span><span class="op" id="3403770">[</span><span class="num" id="3403771">0</span><span class="op" id="3403772">]</span>&nbsp;<span class="op" id="3403774">=</span>&nbsp;<span class="builtintype" id="3403776">byte</span><span class="op" id="3403780">(</span><span class="op" id="3403781">(</span><span class="builtinfunc" id="3403782">len</span><span class="op" id="3403785">(</span><span class="ident" id="3403786">m</span><span class="op" id="3403787">.</span><span class="ident" id="3403788">serverName</span><span class="op" id="3403798">)</span>&nbsp;<span class="op" id="3403800">+</span>&nbsp;<span class="num" id="3403802">3</span><span class="op" id="3403803">)</span>&nbsp;<span class="op" id="3403805">&gt;&gt;</span>&nbsp;<span class="num" id="3403808">8</span><span class="op" id="3403809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403813">z</span><span class="op" id="3403814">[</span><span class="num" id="3403815">1</span><span class="op" id="3403816">]</span>&nbsp;<span class="op" id="3403818">=</span>&nbsp;<span class="builtintype" id="3403820">byte</span><span class="op" id="3403824">(</span><span class="builtinfunc" id="3403825">len</span><span class="op" id="3403828">(</span><span class="ident" id="3403829">m</span><span class="op" id="3403830">.</span><span class="ident" id="3403831">serverName</span><span class="op" id="3403841">)</span>&nbsp;<span class="op" id="3403843">+</span>&nbsp;<span class="num" id="3403845">3</span><span class="op" id="3403846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403850">z</span><span class="op" id="3403851">[</span><span class="num" id="3403852">3</span><span class="op" id="3403853">]</span>&nbsp;<span class="op" id="3403855">=</span>&nbsp;<span class="builtintype" id="3403857">byte</span><span class="op" id="3403861">(</span><span class="builtinfunc" id="3403862">len</span><span class="op" id="3403865">(</span><span class="ident" id="3403866">m</span><span class="op" id="3403867">.</span><span class="ident" id="3403868">serverName</span><span class="op" id="3403878">)</span>&nbsp;<span class="op" id="3403880">&gt;&gt;</span>&nbsp;<span class="num" id="3403883">8</span><span class="op" id="3403884">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403888">z</span><span class="op" id="3403889">[</span><span class="num" id="3403890">4</span><span class="op" id="3403891">]</span>&nbsp;<span class="op" id="3403893">=</span>&nbsp;<span class="builtintype" id="3403895">byte</span><span class="op" id="3403899">(</span><span class="builtinfunc" id="3403900">len</span><span class="op" id="3403903">(</span><span class="ident" id="3403904">m</span><span class="op" id="3403905">.</span><span class="ident" id="3403906">serverName</span><span class="op" id="3403916">)</span><span class="op" id="3403917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3403921">copy</span><span class="op" id="3403925">(</span><span class="ident" id="3403926">z</span><span class="op" id="3403927">[</span><span class="num" id="3403928">5</span><span class="op" id="3403929">:</span><span class="op" id="3403930">]</span><span class="op" id="3403931">,</span>&nbsp;<span class="op" id="3403933">[</span><span class="op" id="3403934">]</span><span class="builtintype" id="3403935">byte</span><span class="op" id="3403939">(</span><span class="ident" id="3403940">m</span><span class="op" id="3403941">.</span><span class="ident" id="3403942">serverName</span><span class="op" id="3403952">)</span><span class="op" id="3403953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3403957">z</span>&nbsp;<span class="op" id="3403959">=</span>&nbsp;<span class="ident" id="3403961">z</span><span class="op" id="3403962">[</span><span class="ident" id="3403963">l</span><span class="op" id="3403964">:</span><span class="op" id="3403965">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3403968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3403971">if</span>&nbsp;<span class="ident" id="3403974">m</span><span class="op" id="3403975">.</span><span class="ident" id="3403976">ocspStapling</span>&nbsp;<span class="op" id="3403989">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3403993">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404020">z</span><span class="op" id="3404021">[</span><span class="num" id="3404022">0</span><span class="op" id="3404023">]</span>&nbsp;<span class="op" id="3404025">=</span>&nbsp;<span class="builtintype" id="3404027">byte</span><span class="op" id="3404031">(</span><span class="ident" id="3404032">extensionStatusRequest</span>&nbsp;<span class="op" id="3404055">&gt;&gt;</span>&nbsp;<span class="num" id="3404058">8</span><span class="op" id="3404059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404063">z</span><span class="op" id="3404064">[</span><span class="num" id="3404065">1</span><span class="op" id="3404066">]</span>&nbsp;<span class="op" id="3404068">=</span>&nbsp;<span class="builtintype" id="3404070">byte</span><span class="op" id="3404074">(</span><span class="ident" id="3404075">extensionStatusRequest</span><span class="op" id="3404097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404101">z</span><span class="op" id="3404102">[</span><span class="num" id="3404103">2</span><span class="op" id="3404104">]</span>&nbsp;<span class="op" id="3404106">=</span>&nbsp;<span class="num" id="3404108">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404112">z</span><span class="op" id="3404113">[</span><span class="num" id="3404114">3</span><span class="op" id="3404115">]</span>&nbsp;<span class="op" id="3404117">=</span>&nbsp;<span class="num" id="3404119">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404123">z</span><span class="op" id="3404124">[</span><span class="num" id="3404125">4</span><span class="op" id="3404126">]</span>&nbsp;<span class="op" id="3404128">=</span>&nbsp;<span class="num" id="3404130">1</span>&nbsp;<span class="comment" id="3404132">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3404147">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404197">z</span>&nbsp;<span class="op" id="3404199">=</span>&nbsp;<span class="ident" id="3404201">z</span><span class="op" id="3404202">[</span><span class="num" id="3404203">9</span><span class="op" id="3404204">:</span><span class="op" id="3404205">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404211">if</span>&nbsp;<span class="builtinfunc" id="3404214">len</span><span class="op" id="3404217">(</span><span class="ident" id="3404218">m</span><span class="op" id="3404219">.</span><span class="ident" id="3404220">supportedCurves</span><span class="op" id="3404235">)</span>&nbsp;<span class="op" id="3404237">&gt;</span>&nbsp;<span class="num" id="3404239">0</span>&nbsp;<span class="op" id="3404241">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3404245">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404299">z</span><span class="op" id="3404300">[</span><span class="num" id="3404301">0</span><span class="op" id="3404302">]</span>&nbsp;<span class="op" id="3404304">=</span>&nbsp;<span class="builtintype" id="3404306">byte</span><span class="op" id="3404310">(</span><span class="ident" id="3404311">extensionSupportedCurves</span>&nbsp;<span class="op" id="3404336">&gt;&gt;</span>&nbsp;<span class="num" id="3404339">8</span><span class="op" id="3404340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404344">z</span><span class="op" id="3404345">[</span><span class="num" id="3404346">1</span><span class="op" id="3404347">]</span>&nbsp;<span class="op" id="3404349">=</span>&nbsp;<span class="builtintype" id="3404351">byte</span><span class="op" id="3404355">(</span><span class="ident" id="3404356">extensionSupportedCurves</span><span class="op" id="3404380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404384">l</span>&nbsp;<span class="op" id="3404386">:=</span>&nbsp;<span class="num" id="3404389">2</span>&nbsp;<span class="op" id="3404391">+</span>&nbsp;<span class="num" id="3404393">2</span><span class="op" id="3404394">*</span><span class="builtinfunc" id="3404395">len</span><span class="op" id="3404398">(</span><span class="ident" id="3404399">m</span><span class="op" id="3404400">.</span><span class="ident" id="3404401">supportedCurves</span><span class="op" id="3404416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404420">z</span><span class="op" id="3404421">[</span><span class="num" id="3404422">2</span><span class="op" id="3404423">]</span>&nbsp;<span class="op" id="3404425">=</span>&nbsp;<span class="builtintype" id="3404427">byte</span><span class="op" id="3404431">(</span><span class="ident" id="3404432">l</span>&nbsp;<span class="op" id="3404434">&gt;&gt;</span>&nbsp;<span class="num" id="3404437">8</span><span class="op" id="3404438">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404442">z</span><span class="op" id="3404443">[</span><span class="num" id="3404444">3</span><span class="op" id="3404445">]</span>&nbsp;<span class="op" id="3404447">=</span>&nbsp;<span class="builtintype" id="3404449">byte</span><span class="op" id="3404453">(</span><span class="ident" id="3404454">l</span><span class="op" id="3404455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404459">l</span>&nbsp;<span class="op" id="3404461">-=</span>&nbsp;<span class="num" id="3404464">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404468">z</span><span class="op" id="3404469">[</span><span class="num" id="3404470">4</span><span class="op" id="3404471">]</span>&nbsp;<span class="op" id="3404473">=</span>&nbsp;<span class="builtintype" id="3404475">byte</span><span class="op" id="3404479">(</span><span class="ident" id="3404480">l</span>&nbsp;<span class="op" id="3404482">&gt;&gt;</span>&nbsp;<span class="num" id="3404485">8</span><span class="op" id="3404486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404490">z</span><span class="op" id="3404491">[</span><span class="num" id="3404492">5</span><span class="op" id="3404493">]</span>&nbsp;<span class="op" id="3404495">=</span>&nbsp;<span class="builtintype" id="3404497">byte</span><span class="op" id="3404501">(</span><span class="ident" id="3404502">l</span><span class="op" id="3404503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404507">z</span>&nbsp;<span class="op" id="3404509">=</span>&nbsp;<span class="ident" id="3404511">z</span><span class="op" id="3404512">[</span><span class="num" id="3404513">6</span><span class="op" id="3404514">:</span><span class="op" id="3404515">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404519">for</span>&nbsp;<span class="ident" id="3404523">_</span><span class="op" id="3404524">,</span>&nbsp;<span class="ident" id="3404526">curve</span>&nbsp;<span class="op" id="3404532">:=</span>&nbsp;<span class="keyword" id="3404535">range</span>&nbsp;<span class="ident" id="3404541">m</span><span class="op" id="3404542">.</span><span class="ident" id="3404543">supportedCurves</span>&nbsp;<span class="op" id="3404559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404564">z</span><span class="op" id="3404565">[</span><span class="num" id="3404566">0</span><span class="op" id="3404567">]</span>&nbsp;<span class="op" id="3404569">=</span>&nbsp;<span class="builtintype" id="3404571">byte</span><span class="op" id="3404575">(</span><span class="ident" id="3404576">curve</span>&nbsp;<span class="op" id="3404582">&gt;&gt;</span>&nbsp;<span class="num" id="3404585">8</span><span class="op" id="3404586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404591">z</span><span class="op" id="3404592">[</span><span class="num" id="3404593">1</span><span class="op" id="3404594">]</span>&nbsp;<span class="op" id="3404596">=</span>&nbsp;<span class="builtintype" id="3404598">byte</span><span class="op" id="3404602">(</span><span class="ident" id="3404603">curve</span><span class="op" id="3404608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404613">z</span>&nbsp;<span class="op" id="3404615">=</span>&nbsp;<span class="ident" id="3404617">z</span><span class="op" id="3404618">[</span><span class="num" id="3404619">2</span><span class="op" id="3404620">:</span><span class="op" id="3404621">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404625">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404631">if</span>&nbsp;<span class="builtinfunc" id="3404634">len</span><span class="op" id="3404637">(</span><span class="ident" id="3404638">m</span><span class="op" id="3404639">.</span><span class="ident" id="3404640">supportedPoints</span><span class="op" id="3404655">)</span>&nbsp;<span class="op" id="3404657">&gt;</span>&nbsp;<span class="num" id="3404659">0</span>&nbsp;<span class="op" id="3404661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3404665">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404719">z</span><span class="op" id="3404720">[</span><span class="num" id="3404721">0</span><span class="op" id="3404722">]</span>&nbsp;<span class="op" id="3404724">=</span>&nbsp;<span class="builtintype" id="3404726">byte</span><span class="op" id="3404730">(</span><span class="ident" id="3404731">extensionSupportedPoints</span>&nbsp;<span class="op" id="3404756">&gt;&gt;</span>&nbsp;<span class="num" id="3404759">8</span><span class="op" id="3404760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404764">z</span><span class="op" id="3404765">[</span><span class="num" id="3404766">1</span><span class="op" id="3404767">]</span>&nbsp;<span class="op" id="3404769">=</span>&nbsp;<span class="builtintype" id="3404771">byte</span><span class="op" id="3404775">(</span><span class="ident" id="3404776">extensionSupportedPoints</span><span class="op" id="3404800">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404804">l</span>&nbsp;<span class="op" id="3404806">:=</span>&nbsp;<span class="num" id="3404809">1</span>&nbsp;<span class="op" id="3404811">+</span>&nbsp;<span class="builtinfunc" id="3404813">len</span><span class="op" id="3404816">(</span><span class="ident" id="3404817">m</span><span class="op" id="3404818">.</span><span class="ident" id="3404819">supportedPoints</span><span class="op" id="3404834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404838">z</span><span class="op" id="3404839">[</span><span class="num" id="3404840">2</span><span class="op" id="3404841">]</span>&nbsp;<span class="op" id="3404843">=</span>&nbsp;<span class="builtintype" id="3404845">byte</span><span class="op" id="3404849">(</span><span class="ident" id="3404850">l</span>&nbsp;<span class="op" id="3404852">&gt;&gt;</span>&nbsp;<span class="num" id="3404855">8</span><span class="op" id="3404856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404860">z</span><span class="op" id="3404861">[</span><span class="num" id="3404862">3</span><span class="op" id="3404863">]</span>&nbsp;<span class="op" id="3404865">=</span>&nbsp;<span class="builtintype" id="3404867">byte</span><span class="op" id="3404871">(</span><span class="ident" id="3404872">l</span><span class="op" id="3404873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404877">l</span><span class="op" id="3404878">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404883">z</span><span class="op" id="3404884">[</span><span class="num" id="3404885">4</span><span class="op" id="3404886">]</span>&nbsp;<span class="op" id="3404888">=</span>&nbsp;<span class="builtintype" id="3404890">byte</span><span class="op" id="3404894">(</span><span class="ident" id="3404895">l</span><span class="op" id="3404896">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404900">z</span>&nbsp;<span class="op" id="3404902">=</span>&nbsp;<span class="ident" id="3404904">z</span><span class="op" id="3404905">[</span><span class="num" id="3404906">5</span><span class="op" id="3404907">:</span><span class="op" id="3404908">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404912">for</span>&nbsp;<span class="ident" id="3404916">_</span><span class="op" id="3404917">,</span>&nbsp;<span class="ident" id="3404919">pointFormat</span>&nbsp;<span class="op" id="3404931">:=</span>&nbsp;<span class="keyword" id="3404934">range</span>&nbsp;<span class="ident" id="3404940">m</span><span class="op" id="3404941">.</span><span class="ident" id="3404942">supportedPoints</span>&nbsp;<span class="op" id="3404958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404963">z</span><span class="op" id="3404964">[</span><span class="num" id="3404965">0</span><span class="op" id="3404966">]</span>&nbsp;<span class="op" id="3404968">=</span>&nbsp;<span class="builtintype" id="3404970">byte</span><span class="op" id="3404974">(</span><span class="ident" id="3404975">pointFormat</span><span class="op" id="3404986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404991">z</span>&nbsp;<span class="op" id="3404993">=</span>&nbsp;<span class="ident" id="3404995">z</span><span class="op" id="3404996">[</span><span class="num" id="3404997">1</span><span class="op" id="3404998">:</span><span class="op" id="3404999">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405003">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405009">if</span>&nbsp;<span class="ident" id="3405012">m</span><span class="op" id="3405013">.</span><span class="ident" id="3405014">ticketSupported</span>&nbsp;<span class="op" id="3405030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3405034">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405086">z</span><span class="op" id="3405087">[</span><span class="num" id="3405088">0</span><span class="op" id="3405089">]</span>&nbsp;<span class="op" id="3405091">=</span>&nbsp;<span class="builtintype" id="3405093">byte</span><span class="op" id="3405097">(</span><span class="ident" id="3405098">extensionSessionTicket</span>&nbsp;<span class="op" id="3405121">&gt;&gt;</span>&nbsp;<span class="num" id="3405124">8</span><span class="op" id="3405125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405129">z</span><span class="op" id="3405130">[</span><span class="num" id="3405131">1</span><span class="op" id="3405132">]</span>&nbsp;<span class="op" id="3405134">=</span>&nbsp;<span class="builtintype" id="3405136">byte</span><span class="op" id="3405140">(</span><span class="ident" id="3405141">extensionSessionTicket</span><span class="op" id="3405163">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405167">l</span>&nbsp;<span class="op" id="3405169">:=</span>&nbsp;<span class="builtinfunc" id="3405172">len</span><span class="op" id="3405175">(</span><span class="ident" id="3405176">m</span><span class="op" id="3405177">.</span><span class="ident" id="3405178">sessionTicket</span><span class="op" id="3405191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405195">z</span><span class="op" id="3405196">[</span><span class="num" id="3405197">2</span><span class="op" id="3405198">]</span>&nbsp;<span class="op" id="3405200">=</span>&nbsp;<span class="builtintype" id="3405202">byte</span><span class="op" id="3405206">(</span><span class="ident" id="3405207">l</span>&nbsp;<span class="op" id="3405209">&gt;&gt;</span>&nbsp;<span class="num" id="3405212">8</span><span class="op" id="3405213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405217">z</span><span class="op" id="3405218">[</span><span class="num" id="3405219">3</span><span class="op" id="3405220">]</span>&nbsp;<span class="op" id="3405222">=</span>&nbsp;<span class="builtintype" id="3405224">byte</span><span class="op" id="3405228">(</span><span class="ident" id="3405229">l</span><span class="op" id="3405230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405234">z</span>&nbsp;<span class="op" id="3405236">=</span>&nbsp;<span class="ident" id="3405238">z</span><span class="op" id="3405239">[</span><span class="num" id="3405240">4</span><span class="op" id="3405241">:</span><span class="op" id="3405242">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3405246">copy</span><span class="op" id="3405250">(</span><span class="ident" id="3405251">z</span><span class="op" id="3405252">,</span>&nbsp;<span class="ident" id="3405254">m</span><span class="op" id="3405255">.</span><span class="ident" id="3405256">sessionTicket</span><span class="op" id="3405269">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405273">z</span>&nbsp;<span class="op" id="3405275">=</span>&nbsp;<span class="ident" id="3405277">z</span><span class="op" id="3405278">[</span><span class="builtinfunc" id="3405279">len</span><span class="op" id="3405282">(</span><span class="ident" id="3405283">m</span><span class="op" id="3405284">.</span><span class="ident" id="3405285">sessionTicket</span><span class="op" id="3405298">)</span><span class="op" id="3405299">:</span><span class="op" id="3405300">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405306">if</span>&nbsp;<span class="builtinfunc" id="3405309">len</span><span class="op" id="3405312">(</span><span class="ident" id="3405313">m</span><span class="op" id="3405314">.</span><span class="ident" id="3405315">signatureAndHashes</span><span class="op" id="3405333">)</span>&nbsp;<span class="op" id="3405335">&gt;</span>&nbsp;<span class="num" id="3405337">0</span>&nbsp;<span class="op" id="3405339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3405343">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405402">z</span><span class="op" id="3405403">[</span><span class="num" id="3405404">0</span><span class="op" id="3405405">]</span>&nbsp;<span class="op" id="3405407">=</span>&nbsp;<span class="builtintype" id="3405409">byte</span><span class="op" id="3405413">(</span><span class="ident" id="3405414">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="3405443">&gt;&gt;</span>&nbsp;<span class="num" id="3405446">8</span><span class="op" id="3405447">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405451">z</span><span class="op" id="3405452">[</span><span class="num" id="3405453">1</span><span class="op" id="3405454">]</span>&nbsp;<span class="op" id="3405456">=</span>&nbsp;<span class="builtintype" id="3405458">byte</span><span class="op" id="3405462">(</span><span class="ident" id="3405463">extensionSignatureAlgorithms</span><span class="op" id="3405491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405495">l</span>&nbsp;<span class="op" id="3405497">:=</span>&nbsp;<span class="num" id="3405500">2</span>&nbsp;<span class="op" id="3405502">+</span>&nbsp;<span class="num" id="3405504">2</span><span class="op" id="3405505">*</span><span class="builtinfunc" id="3405506">len</span><span class="op" id="3405509">(</span><span class="ident" id="3405510">m</span><span class="op" id="3405511">.</span><span class="ident" id="3405512">signatureAndHashes</span><span class="op" id="3405530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405534">z</span><span class="op" id="3405535">[</span><span class="num" id="3405536">2</span><span class="op" id="3405537">]</span>&nbsp;<span class="op" id="3405539">=</span>&nbsp;<span class="builtintype" id="3405541">byte</span><span class="op" id="3405545">(</span><span class="ident" id="3405546">l</span>&nbsp;<span class="op" id="3405548">&gt;&gt;</span>&nbsp;<span class="num" id="3405551">8</span><span class="op" id="3405552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405556">z</span><span class="op" id="3405557">[</span><span class="num" id="3405558">3</span><span class="op" id="3405559">]</span>&nbsp;<span class="op" id="3405561">=</span>&nbsp;<span class="builtintype" id="3405563">byte</span><span class="op" id="3405567">(</span><span class="ident" id="3405568">l</span><span class="op" id="3405569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405573">z</span>&nbsp;<span class="op" id="3405575">=</span>&nbsp;<span class="ident" id="3405577">z</span><span class="op" id="3405578">[</span><span class="num" id="3405579">4</span><span class="op" id="3405580">:</span><span class="op" id="3405581">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405586">l</span>&nbsp;<span class="op" id="3405588">-=</span>&nbsp;<span class="num" id="3405591">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405595">z</span><span class="op" id="3405596">[</span><span class="num" id="3405597">0</span><span class="op" id="3405598">]</span>&nbsp;<span class="op" id="3405600">=</span>&nbsp;<span class="builtintype" id="3405602">byte</span><span class="op" id="3405606">(</span><span class="ident" id="3405607">l</span>&nbsp;<span class="op" id="3405609">&gt;&gt;</span>&nbsp;<span class="num" id="3405612">8</span><span class="op" id="3405613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405617">z</span><span class="op" id="3405618">[</span><span class="num" id="3405619">1</span><span class="op" id="3405620">]</span>&nbsp;<span class="op" id="3405622">=</span>&nbsp;<span class="builtintype" id="3405624">byte</span><span class="op" id="3405628">(</span><span class="ident" id="3405629">l</span><span class="op" id="3405630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405634">z</span>&nbsp;<span class="op" id="3405636">=</span>&nbsp;<span class="ident" id="3405638">z</span><span class="op" id="3405639">[</span><span class="num" id="3405640">2</span><span class="op" id="3405641">:</span><span class="op" id="3405642">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405646">for</span>&nbsp;<span class="ident" id="3405650">_</span><span class="op" id="3405651">,</span>&nbsp;<span class="ident" id="3405653">sigAndHash</span>&nbsp;<span class="op" id="3405664">:=</span>&nbsp;<span class="keyword" id="3405667">range</span>&nbsp;<span class="ident" id="3405673">m</span><span class="op" id="3405674">.</span><span class="ident" id="3405675">signatureAndHashes</span>&nbsp;<span class="op" id="3405694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405699">z</span><span class="op" id="3405700">[</span><span class="num" id="3405701">0</span><span class="op" id="3405702">]</span>&nbsp;<span class="op" id="3405704">=</span>&nbsp;<span class="ident" id="3405706">sigAndHash</span><span class="op" id="3405716">.</span><span class="ident" id="3405717">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405725">z</span><span class="op" id="3405726">[</span><span class="num" id="3405727">1</span><span class="op" id="3405728">]</span>&nbsp;<span class="op" id="3405730">=</span>&nbsp;<span class="ident" id="3405732">sigAndHash</span><span class="op" id="3405742">.</span><span class="ident" id="3405743">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405756">z</span>&nbsp;<span class="op" id="3405758">=</span>&nbsp;<span class="ident" id="3405760">z</span><span class="op" id="3405761">[</span><span class="num" id="3405762">2</span><span class="op" id="3405763">:</span><span class="op" id="3405764">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405768">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405774">if</span>&nbsp;<span class="ident" id="3405777">m</span><span class="op" id="3405778">.</span><span class="ident" id="3405779">secureRenegotiation</span>&nbsp;<span class="op" id="3405799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405803">z</span><span class="op" id="3405804">[</span><span class="num" id="3405805">0</span><span class="op" id="3405806">]</span>&nbsp;<span class="op" id="3405808">=</span>&nbsp;<span class="builtintype" id="3405810">byte</span><span class="op" id="3405814">(</span><span class="ident" id="3405815">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3405842">&gt;&gt;</span>&nbsp;<span class="num" id="3405845">8</span><span class="op" id="3405846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405850">z</span><span class="op" id="3405851">[</span><span class="num" id="3405852">1</span><span class="op" id="3405853">]</span>&nbsp;<span class="op" id="3405855">=</span>&nbsp;<span class="builtintype" id="3405857">byte</span><span class="op" id="3405861">(</span><span class="ident" id="3405862">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3405889">&amp;</span>&nbsp;<span class="num" id="3405891">0xff</span><span class="op" id="3405895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405899">z</span><span class="op" id="3405900">[</span><span class="num" id="3405901">2</span><span class="op" id="3405902">]</span>&nbsp;<span class="op" id="3405904">=</span>&nbsp;<span class="num" id="3405906">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405910">z</span><span class="op" id="3405911">[</span><span class="num" id="3405912">3</span><span class="op" id="3405913">]</span>&nbsp;<span class="op" id="3405915">=</span>&nbsp;<span class="num" id="3405917">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405921">z</span>&nbsp;<span class="op" id="3405923">=</span>&nbsp;<span class="ident" id="3405925">z</span><span class="op" id="3405926">[</span><span class="num" id="3405927">5</span><span class="op" id="3405928">:</span><span class="op" id="3405929">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405935">if</span>&nbsp;<span class="builtinfunc" id="3405938">len</span><span class="op" id="3405941">(</span><span class="ident" id="3405942">m</span><span class="op" id="3405943">.</span><span class="ident" id="3405944">alpnProtocols</span><span class="op" id="3405957">)</span>&nbsp;<span class="op" id="3405959">&gt;</span>&nbsp;<span class="num" id="3405961">0</span>&nbsp;<span class="op" id="3405963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405967">z</span><span class="op" id="3405968">[</span><span class="num" id="3405969">0</span><span class="op" id="3405970">]</span>&nbsp;<span class="op" id="3405972">=</span>&nbsp;<span class="builtintype" id="3405974">byte</span><span class="op" id="3405978">(</span><span class="ident" id="3405979">extensionALPN</span>&nbsp;<span class="op" id="3405993">&gt;&gt;</span>&nbsp;<span class="num" id="3405996">8</span><span class="op" id="3405997">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406001">z</span><span class="op" id="3406002">[</span><span class="num" id="3406003">1</span><span class="op" id="3406004">]</span>&nbsp;<span class="op" id="3406006">=</span>&nbsp;<span class="builtintype" id="3406008">byte</span><span class="op" id="3406012">(</span><span class="ident" id="3406013">extensionALPN</span>&nbsp;<span class="op" id="3406027">&amp;</span>&nbsp;<span class="num" id="3406029">0xff</span><span class="op" id="3406033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406037">lengths</span>&nbsp;<span class="op" id="3406045">:=</span>&nbsp;<span class="ident" id="3406048">z</span><span class="op" id="3406049">[</span><span class="num" id="3406050">2</span><span class="op" id="3406051">:</span><span class="op" id="3406052">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406056">z</span>&nbsp;<span class="op" id="3406058">=</span>&nbsp;<span class="ident" id="3406060">z</span><span class="op" id="3406061">[</span><span class="num" id="3406062">6</span><span class="op" id="3406063">:</span><span class="op" id="3406064">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406069">stringsLength</span>&nbsp;<span class="op" id="3406083">:=</span>&nbsp;<span class="num" id="3406086">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406090">for</span>&nbsp;<span class="ident" id="3406094">_</span><span class="op" id="3406095">,</span>&nbsp;<span class="ident" id="3406097">s</span>&nbsp;<span class="op" id="3406099">:=</span>&nbsp;<span class="keyword" id="3406102">range</span>&nbsp;<span class="ident" id="3406108">m</span><span class="op" id="3406109">.</span><span class="ident" id="3406110">alpnProtocols</span>&nbsp;<span class="op" id="3406124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406129">l</span>&nbsp;<span class="op" id="3406131">:=</span>&nbsp;<span class="builtinfunc" id="3406134">len</span><span class="op" id="3406137">(</span><span class="ident" id="3406138">s</span><span class="op" id="3406139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406144">z</span><span class="op" id="3406145">[</span><span class="num" id="3406146">0</span><span class="op" id="3406147">]</span>&nbsp;<span class="op" id="3406149">=</span>&nbsp;<span class="builtintype" id="3406151">byte</span><span class="op" id="3406155">(</span><span class="ident" id="3406156">l</span><span class="op" id="3406157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3406162">copy</span><span class="op" id="3406166">(</span><span class="ident" id="3406167">z</span><span class="op" id="3406168">[</span><span class="num" id="3406169">1</span><span class="op" id="3406170">:</span><span class="op" id="3406171">]</span><span class="op" id="3406172">,</span>&nbsp;<span class="ident" id="3406174">s</span><span class="op" id="3406175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406180">z</span>&nbsp;<span class="op" id="3406182">=</span>&nbsp;<span class="ident" id="3406184">z</span><span class="op" id="3406185">[</span><span class="num" id="3406186">1</span><span class="op" id="3406187">+</span><span class="ident" id="3406188">l</span><span class="op" id="3406189">:</span><span class="op" id="3406190">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406195">stringsLength</span>&nbsp;<span class="op" id="3406209">+=</span>&nbsp;<span class="num" id="3406212">1</span>&nbsp;<span class="op" id="3406214">+</span>&nbsp;<span class="ident" id="3406216">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406225">lengths</span><span class="op" id="3406232">[</span><span class="num" id="3406233">2</span><span class="op" id="3406234">]</span>&nbsp;<span class="op" id="3406236">=</span>&nbsp;<span class="builtintype" id="3406238">byte</span><span class="op" id="3406242">(</span><span class="ident" id="3406243">stringsLength</span>&nbsp;<span class="op" id="3406257">&gt;&gt;</span>&nbsp;<span class="num" id="3406260">8</span><span class="op" id="3406261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406265">lengths</span><span class="op" id="3406272">[</span><span class="num" id="3406273">3</span><span class="op" id="3406274">]</span>&nbsp;<span class="op" id="3406276">=</span>&nbsp;<span class="builtintype" id="3406278">byte</span><span class="op" id="3406282">(</span><span class="ident" id="3406283">stringsLength</span><span class="op" id="3406296">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406300">stringsLength</span>&nbsp;<span class="op" id="3406314">+=</span>&nbsp;<span class="num" id="3406317">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406321">lengths</span><span class="op" id="3406328">[</span><span class="num" id="3406329">0</span><span class="op" id="3406330">]</span>&nbsp;<span class="op" id="3406332">=</span>&nbsp;<span class="builtintype" id="3406334">byte</span><span class="op" id="3406338">(</span><span class="ident" id="3406339">stringsLength</span>&nbsp;<span class="op" id="3406353">&gt;&gt;</span>&nbsp;<span class="num" id="3406356">8</span><span class="op" id="3406357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406361">lengths</span><span class="op" id="3406368">[</span><span class="num" id="3406369">1</span><span class="op" id="3406370">]</span>&nbsp;<span class="op" id="3406372">=</span>&nbsp;<span class="builtintype" id="3406374">byte</span><span class="op" id="3406378">(</span><span class="ident" id="3406379">stringsLength</span><span class="op" id="3406392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406399">m</span><span class="op" id="3406400">.</span><span class="ident" id="3406401">raw</span>&nbsp;<span class="op" id="3406405">=</span>&nbsp;<span class="ident" id="3406407">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406411">return</span>&nbsp;<span class="ident" id="3406418">x</span><br>
<span class="lineno"></span><span class="op" id="3406420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3406423">func</span>&nbsp;<span class="op" id="3406428">(</span><span class="ident" id="3406429">m</span>&nbsp;<span class="op" id="3406431">*</span><span class="ident" id="3406432">clientHelloMsg</span><span class="op" id="3406446">)</span>&nbsp;<span class="ident" id="3406448">unmarshal</span><span class="op" id="3406457">(</span><span class="ident" id="3406458">data</span>&nbsp;<span class="op" id="3406463">[</span><span class="op" id="3406464">]</span><span class="builtintype" id="3406465">byte</span><span class="op" id="3406469">)</span>&nbsp;<span class="builtintype" id="3406471">bool</span>&nbsp;<span class="op" id="3406476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406479">if</span>&nbsp;<span class="builtinfunc" id="3406482">len</span><span class="op" id="3406485">(</span><span class="ident" id="3406486">data</span><span class="op" id="3406490">)</span>&nbsp;<span class="op" id="3406492">&lt;</span>&nbsp;<span class="num" id="3406494">42</span>&nbsp;<span class="op" id="3406497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406501">return</span>&nbsp;<span class="builtintype" id="3406508">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406518">m</span><span class="op" id="3406519">.</span><span class="ident" id="3406520">raw</span>&nbsp;<span class="op" id="3406524">=</span>&nbsp;<span class="ident" id="3406526">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406532">m</span><span class="op" id="3406533">.</span><span class="ident" id="3406534">vers</span>&nbsp;<span class="op" id="3406539">=</span>&nbsp;<span class="builtintype" id="3406541">uint16</span><span class="op" id="3406547">(</span><span class="ident" id="3406548">data</span><span class="op" id="3406552">[</span><span class="num" id="3406553">4</span><span class="op" id="3406554">]</span><span class="op" id="3406555">)</span><span class="op" id="3406556">&lt;&lt;</span><span class="num" id="3406558">8</span>&nbsp;<span class="op" id="3406560">|</span>&nbsp;<span class="builtintype" id="3406562">uint16</span><span class="op" id="3406568">(</span><span class="ident" id="3406569">data</span><span class="op" id="3406573">[</span><span class="num" id="3406574">5</span><span class="op" id="3406575">]</span><span class="op" id="3406576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406579">m</span><span class="op" id="3406580">.</span><span class="ident" id="3406581">random</span>&nbsp;<span class="op" id="3406588">=</span>&nbsp;<span class="ident" id="3406590">data</span><span class="op" id="3406594">[</span><span class="num" id="3406595">6</span><span class="op" id="3406596">:</span><span class="num" id="3406597">38</span><span class="op" id="3406599">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406602">sessionIdLen</span>&nbsp;<span class="op" id="3406615">:=</span>&nbsp;<span class="builtintype" id="3406618">int</span><span class="op" id="3406621">(</span><span class="ident" id="3406622">data</span><span class="op" id="3406626">[</span><span class="num" id="3406627">38</span><span class="op" id="3406629">]</span><span class="op" id="3406630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406633">if</span>&nbsp;<span class="ident" id="3406636">sessionIdLen</span>&nbsp;<span class="op" id="3406649">&gt;</span>&nbsp;<span class="num" id="3406651">32</span>&nbsp;<span class="op" id="3406654">||</span>&nbsp;<span class="builtinfunc" id="3406657">len</span><span class="op" id="3406660">(</span><span class="ident" id="3406661">data</span><span class="op" id="3406665">)</span>&nbsp;<span class="op" id="3406667">&lt;</span>&nbsp;<span class="num" id="3406669">39</span><span class="op" id="3406671">+</span><span class="ident" id="3406672">sessionIdLen</span>&nbsp;<span class="op" id="3406685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406689">return</span>&nbsp;<span class="builtintype" id="3406696">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406706">m</span><span class="op" id="3406707">.</span><span class="ident" id="3406708">sessionId</span>&nbsp;<span class="op" id="3406718">=</span>&nbsp;<span class="ident" id="3406720">data</span><span class="op" id="3406724">[</span><span class="num" id="3406725">39</span>&nbsp;<span class="op" id="3406728">:</span>&nbsp;<span class="num" id="3406730">39</span><span class="op" id="3406732">+</span><span class="ident" id="3406733">sessionIdLen</span><span class="op" id="3406745">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406748">data</span>&nbsp;<span class="op" id="3406753">=</span>&nbsp;<span class="ident" id="3406755">data</span><span class="op" id="3406759">[</span><span class="num" id="3406760">39</span><span class="op" id="3406762">+</span><span class="ident" id="3406763">sessionIdLen</span><span class="op" id="3406775">:</span><span class="op" id="3406776">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406779">if</span>&nbsp;<span class="builtinfunc" id="3406782">len</span><span class="op" id="3406785">(</span><span class="ident" id="3406786">data</span><span class="op" id="3406790">)</span>&nbsp;<span class="op" id="3406792">&lt;</span>&nbsp;<span class="num" id="3406794">2</span>&nbsp;<span class="op" id="3406796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406800">return</span>&nbsp;<span class="builtintype" id="3406807">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3406817">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3406890">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406937">cipherSuiteLen</span>&nbsp;<span class="op" id="3406952">:=</span>&nbsp;<span class="builtintype" id="3406955">int</span><span class="op" id="3406958">(</span><span class="ident" id="3406959">data</span><span class="op" id="3406963">[</span><span class="num" id="3406964">0</span><span class="op" id="3406965">]</span><span class="op" id="3406966">)</span><span class="op" id="3406967">&lt;&lt;</span><span class="num" id="3406969">8</span>&nbsp;<span class="op" id="3406971">|</span>&nbsp;<span class="builtintype" id="3406973">int</span><span class="op" id="3406976">(</span><span class="ident" id="3406977">data</span><span class="op" id="3406981">[</span><span class="num" id="3406982">1</span><span class="op" id="3406983">]</span><span class="op" id="3406984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406987">if</span>&nbsp;<span class="ident" id="3406990">cipherSuiteLen</span><span class="op" id="3407004">%</span><span class="num" id="3407005">2</span>&nbsp;<span class="op" id="3407007">==</span>&nbsp;<span class="num" id="3407010">1</span>&nbsp;<span class="op" id="3407012">||</span>&nbsp;<span class="builtinfunc" id="3407015">len</span><span class="op" id="3407018">(</span><span class="ident" id="3407019">data</span><span class="op" id="3407023">)</span>&nbsp;<span class="op" id="3407025">&lt;</span>&nbsp;<span class="num" id="3407027">2</span><span class="op" id="3407028">+</span><span class="ident" id="3407029">cipherSuiteLen</span>&nbsp;<span class="op" id="3407044">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407048">return</span>&nbsp;<span class="builtintype" id="3407055">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3407062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407065">numCipherSuites</span>&nbsp;<span class="op" id="3407081">:=</span>&nbsp;<span class="ident" id="3407084">cipherSuiteLen</span>&nbsp;<span class="op" id="3407099">/</span>&nbsp;<span class="num" id="3407101">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407104">m</span><span class="op" id="3407105">.</span><span class="ident" id="3407106">cipherSuites</span>&nbsp;<span class="op" id="3407119">=</span>&nbsp;<span class="builtinfunc" id="3407121">make</span><span class="op" id="3407125">(</span><span class="op" id="3407126">[</span><span class="op" id="3407127">]</span><span class="builtintype" id="3407128">uint16</span><span class="op" id="3407134">,</span>&nbsp;<span class="ident" id="3407136">numCipherSuites</span><span class="op" id="3407151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407154">for</span>&nbsp;<span class="ident" id="3407158">i</span>&nbsp;<span class="op" id="3407160">:=</span>&nbsp;<span class="num" id="3407163">0</span><span class="op" id="3407164">;</span>&nbsp;<span class="ident" id="3407166">i</span>&nbsp;<span class="op" id="3407168">&lt;</span>&nbsp;<span class="ident" id="3407170">numCipherSuites</span><span class="op" id="3407185">;</span>&nbsp;<span class="ident" id="3407187">i</span><span class="op" id="3407188">++</span>&nbsp;<span class="op" id="3407191">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407195">m</span><span class="op" id="3407196">.</span><span class="ident" id="3407197">cipherSuites</span><span class="op" id="3407209">[</span><span class="ident" id="3407210">i</span><span class="op" id="3407211">]</span>&nbsp;<span class="op" id="3407213">=</span>&nbsp;<span class="builtintype" id="3407215">uint16</span><span class="op" id="3407221">(</span><span class="ident" id="3407222">data</span><span class="op" id="3407226">[</span><span class="num" id="3407227">2</span><span class="op" id="3407228">+</span><span class="num" id="3407229">2</span><span class="op" id="3407230">*</span><span class="ident" id="3407231">i</span><span class="op" id="3407232">]</span><span class="op" id="3407233">)</span><span class="op" id="3407234">&lt;&lt;</span><span class="num" id="3407236">8</span>&nbsp;<span class="op" id="3407238">|</span>&nbsp;<span class="builtintype" id="3407240">uint16</span><span class="op" id="3407246">(</span><span class="ident" id="3407247">data</span><span class="op" id="3407251">[</span><span class="num" id="3407252">3</span><span class="op" id="3407253">+</span><span class="num" id="3407254">2</span><span class="op" id="3407255">*</span><span class="ident" id="3407256">i</span><span class="op" id="3407257">]</span><span class="op" id="3407258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407262">if</span>&nbsp;<span class="ident" id="3407265">m</span><span class="op" id="3407266">.</span><span class="ident" id="3407267">cipherSuites</span><span class="op" id="3407279">[</span><span class="ident" id="3407280">i</span><span class="op" id="3407281">]</span>&nbsp;<span class="op" id="3407283">==</span>&nbsp;<span class="ident" id="3407286">scsvRenegotiation</span>&nbsp;<span class="op" id="3407304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407309">m</span><span class="op" id="3407310">.</span><span class="ident" id="3407311">secureRenegotiation</span>&nbsp;<span class="op" id="3407331">=</span>&nbsp;<span class="builtintype" id="3407333">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3407340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3407343">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407346">data</span>&nbsp;<span class="op" id="3407351">=</span>&nbsp;<span class="ident" id="3407353">data</span><span class="op" id="3407357">[</span><span class="num" id="3407358">2</span><span class="op" id="3407359">+</span><span class="ident" id="3407360">cipherSuiteLen</span><span class="op" id="3407374">:</span><span class="op" id="3407375">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407378">if</span>&nbsp;<span class="builtinfunc" id="3407381">len</span><span class="op" id="3407384">(</span><span class="ident" id="3407385">data</span><span class="op" id="3407389">)</span>&nbsp;<span class="op" id="3407391">&lt;</span>&nbsp;<span class="num" id="3407393">1</span>&nbsp;<span class="op" id="3407395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407399">return</span>&nbsp;<span class="builtintype" id="3407406">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3407413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407416">compressionMethodsLen</span>&nbsp;<span class="op" id="3407438">:=</span>&nbsp;<span class="builtintype" id="3407441">int</span><span class="op" id="3407444">(</span><span class="ident" id="3407445">data</span><span class="op" id="3407449">[</span><span class="num" id="3407450">0</span><span class="op" id="3407451">]</span><span class="op" id="3407452">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407455">if</span>&nbsp;<span class="builtinfunc" id="3407458">len</span><span class="op" id="3407461">(</span><span class="ident" id="3407462">data</span><span class="op" id="3407466">)</span>&nbsp;<span class="op" id="3407468">&lt;</span>&nbsp;<span class="num" id="3407470">1</span><span class="op" id="3407471">+</span><span class="ident" id="3407472">compressionMethodsLen</span>&nbsp;<span class="op" id="3407494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407498">return</span>&nbsp;<span class="builtintype" id="3407505">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3407512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407515">m</span><span class="op" id="3407516">.</span><span class="ident" id="3407517">compressionMethods</span>&nbsp;<span class="op" id="3407536">=</span>&nbsp;<span class="ident" id="3407538">data</span><span class="op" id="3407542">[</span><span class="num" id="3407543">1</span>&nbsp;<span class="op" id="3407545">:</span>&nbsp;<span class="num" id="3407547">1</span><span class="op" id="3407548">+</span><span class="ident" id="3407549">compressionMethodsLen</span><span class="op" id="3407570">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407574">data</span>&nbsp;<span class="op" id="3407579">=</span>&nbsp;<span class="ident" id="3407581">data</span><span class="op" id="3407585">[</span><span class="num" id="3407586">1</span><span class="op" id="3407587">+</span><span class="ident" id="3407588">compressionMethodsLen</span><span class="op" id="3407609">:</span><span class="op" id="3407610">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407614">m</span><span class="op" id="3407615">.</span><span class="ident" id="3407616">nextProtoNeg</span>&nbsp;<span class="op" id="3407629">=</span>&nbsp;<span class="builtintype" id="3407631">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407638">m</span><span class="op" id="3407639">.</span><span class="ident" id="3407640">serverName</span>&nbsp;<span class="op" id="3407651">=</span>&nbsp;<span class="string" id="3407653">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407657">m</span><span class="op" id="3407658">.</span><span class="ident" id="3407659">ocspStapling</span>&nbsp;<span class="op" id="3407672">=</span>&nbsp;<span class="builtintype" id="3407674">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407681">m</span><span class="op" id="3407682">.</span><span class="ident" id="3407683">ticketSupported</span>&nbsp;<span class="op" id="3407699">=</span>&nbsp;<span class="builtintype" id="3407701">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407708">m</span><span class="op" id="3407709">.</span><span class="ident" id="3407710">sessionTicket</span>&nbsp;<span class="op" id="3407724">=</span>&nbsp;<span class="ident" id="3407726">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407731">m</span><span class="op" id="3407732">.</span><span class="ident" id="3407733">signatureAndHashes</span>&nbsp;<span class="op" id="3407752">=</span>&nbsp;<span class="ident" id="3407754">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407759">m</span><span class="op" id="3407760">.</span><span class="ident" id="3407761">alpnProtocols</span>&nbsp;<span class="op" id="3407775">=</span>&nbsp;<span class="ident" id="3407777">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407783">if</span>&nbsp;<span class="builtinfunc" id="3407786">len</span><span class="op" id="3407789">(</span><span class="ident" id="3407790">data</span><span class="op" id="3407794">)</span>&nbsp;<span class="op" id="3407796">==</span>&nbsp;<span class="num" id="3407799">0</span>&nbsp;<span class="op" id="3407801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3407805">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407863">return</span>&nbsp;<span class="builtintype" id="3407870">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3407876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407879">if</span>&nbsp;<span class="builtinfunc" id="3407882">len</span><span class="op" id="3407885">(</span><span class="ident" id="3407886">data</span><span class="op" id="3407890">)</span>&nbsp;<span class="op" id="3407892">&lt;</span>&nbsp;<span class="num" id="3407894">2</span>&nbsp;<span class="op" id="3407896">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407900">return</span>&nbsp;<span class="builtintype" id="3407907">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3407914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407918">extensionsLength</span>&nbsp;<span class="op" id="3407935">:=</span>&nbsp;<span class="builtintype" id="3407938">int</span><span class="op" id="3407941">(</span><span class="ident" id="3407942">data</span><span class="op" id="3407946">[</span><span class="num" id="3407947">0</span><span class="op" id="3407948">]</span><span class="op" id="3407949">)</span><span class="op" id="3407950">&lt;&lt;</span><span class="num" id="3407952">8</span>&nbsp;<span class="op" id="3407954">|</span>&nbsp;<span class="builtintype" id="3407956">int</span><span class="op" id="3407959">(</span><span class="ident" id="3407960">data</span><span class="op" id="3407964">[</span><span class="num" id="3407965">1</span><span class="op" id="3407966">]</span><span class="op" id="3407967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407970">data</span>&nbsp;<span class="op" id="3407975">=</span>&nbsp;<span class="ident" id="3407977">data</span><span class="op" id="3407981">[</span><span class="num" id="3407982">2</span><span class="op" id="3407983">:</span><span class="op" id="3407984">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407987">if</span>&nbsp;<span class="ident" id="3407990">extensionsLength</span>&nbsp;<span class="op" id="3408007">!=</span>&nbsp;<span class="builtinfunc" id="3408010">len</span><span class="op" id="3408013">(</span><span class="ident" id="3408014">data</span><span class="op" id="3408018">)</span>&nbsp;<span class="op" id="3408020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408024">return</span>&nbsp;<span class="builtintype" id="3408031">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408042">for</span>&nbsp;<span class="builtinfunc" id="3408046">len</span><span class="op" id="3408049">(</span><span class="ident" id="3408050">data</span><span class="op" id="3408054">)</span>&nbsp;<span class="op" id="3408056">!=</span>&nbsp;<span class="num" id="3408059">0</span>&nbsp;<span class="op" id="3408061">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408065">if</span>&nbsp;<span class="builtinfunc" id="3408068">len</span><span class="op" id="3408071">(</span><span class="ident" id="3408072">data</span><span class="op" id="3408076">)</span>&nbsp;<span class="op" id="3408078">&lt;</span>&nbsp;<span class="num" id="3408080">4</span>&nbsp;<span class="op" id="3408082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408087">return</span>&nbsp;<span class="builtintype" id="3408094">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408106">extension</span>&nbsp;<span class="op" id="3408116">:=</span>&nbsp;<span class="builtintype" id="3408119">uint16</span><span class="op" id="3408125">(</span><span class="ident" id="3408126">data</span><span class="op" id="3408130">[</span><span class="num" id="3408131">0</span><span class="op" id="3408132">]</span><span class="op" id="3408133">)</span><span class="op" id="3408134">&lt;&lt;</span><span class="num" id="3408136">8</span>&nbsp;<span class="op" id="3408138">|</span>&nbsp;<span class="builtintype" id="3408140">uint16</span><span class="op" id="3408146">(</span><span class="ident" id="3408147">data</span><span class="op" id="3408151">[</span><span class="num" id="3408152">1</span><span class="op" id="3408153">]</span><span class="op" id="3408154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408158">length</span>&nbsp;<span class="op" id="3408165">:=</span>&nbsp;<span class="builtintype" id="3408168">int</span><span class="op" id="3408171">(</span><span class="ident" id="3408172">data</span><span class="op" id="3408176">[</span><span class="num" id="3408177">2</span><span class="op" id="3408178">]</span><span class="op" id="3408179">)</span><span class="op" id="3408180">&lt;&lt;</span><span class="num" id="3408182">8</span>&nbsp;<span class="op" id="3408184">|</span>&nbsp;<span class="builtintype" id="3408186">int</span><span class="op" id="3408189">(</span><span class="ident" id="3408190">data</span><span class="op" id="3408194">[</span><span class="num" id="3408195">3</span><span class="op" id="3408196">]</span><span class="op" id="3408197">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408201">data</span>&nbsp;<span class="op" id="3408206">=</span>&nbsp;<span class="ident" id="3408208">data</span><span class="op" id="3408212">[</span><span class="num" id="3408213">4</span><span class="op" id="3408214">:</span><span class="op" id="3408215">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408219">if</span>&nbsp;<span class="builtinfunc" id="3408222">len</span><span class="op" id="3408225">(</span><span class="ident" id="3408226">data</span><span class="op" id="3408230">)</span>&nbsp;<span class="op" id="3408232">&lt;</span>&nbsp;<span class="ident" id="3408234">length</span>&nbsp;<span class="op" id="3408241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408246">return</span>&nbsp;<span class="builtintype" id="3408253">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408266">switch</span>&nbsp;<span class="ident" id="3408273">extension</span>&nbsp;<span class="op" id="3408283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408287">case</span>&nbsp;<span class="ident" id="3408292">extensionServerName</span><span class="op" id="3408311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408316">if</span>&nbsp;<span class="ident" id="3408319">length</span>&nbsp;<span class="op" id="3408326">&lt;</span>&nbsp;<span class="num" id="3408328">2</span>&nbsp;<span class="op" id="3408330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408336">return</span>&nbsp;<span class="builtintype" id="3408343">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408352">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408357">numNames</span>&nbsp;<span class="op" id="3408366">:=</span>&nbsp;<span class="builtintype" id="3408369">int</span><span class="op" id="3408372">(</span><span class="ident" id="3408373">data</span><span class="op" id="3408377">[</span><span class="num" id="3408378">0</span><span class="op" id="3408379">]</span><span class="op" id="3408380">)</span><span class="op" id="3408381">&lt;&lt;</span><span class="num" id="3408383">8</span>&nbsp;<span class="op" id="3408385">|</span>&nbsp;<span class="builtintype" id="3408387">int</span><span class="op" id="3408390">(</span><span class="ident" id="3408391">data</span><span class="op" id="3408395">[</span><span class="num" id="3408396">1</span><span class="op" id="3408397">]</span><span class="op" id="3408398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408403">d</span>&nbsp;<span class="op" id="3408405">:=</span>&nbsp;<span class="ident" id="3408408">data</span><span class="op" id="3408412">[</span><span class="num" id="3408413">2</span><span class="op" id="3408414">:</span><span class="op" id="3408415">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408420">for</span>&nbsp;<span class="ident" id="3408424">i</span>&nbsp;<span class="op" id="3408426">:=</span>&nbsp;<span class="num" id="3408429">0</span><span class="op" id="3408430">;</span>&nbsp;<span class="ident" id="3408432">i</span>&nbsp;<span class="op" id="3408434">&lt;</span>&nbsp;<span class="ident" id="3408436">numNames</span><span class="op" id="3408444">;</span>&nbsp;<span class="ident" id="3408446">i</span><span class="op" id="3408447">++</span>&nbsp;<span class="op" id="3408450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408456">if</span>&nbsp;<span class="builtinfunc" id="3408459">len</span><span class="op" id="3408462">(</span><span class="ident" id="3408463">d</span><span class="op" id="3408464">)</span>&nbsp;<span class="op" id="3408466">&lt;</span>&nbsp;<span class="num" id="3408468">3</span>&nbsp;<span class="op" id="3408470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408477">return</span>&nbsp;<span class="builtintype" id="3408484">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408500">nameType</span>&nbsp;<span class="op" id="3408509">:=</span>&nbsp;<span class="ident" id="3408512">d</span><span class="op" id="3408513">[</span><span class="num" id="3408514">0</span><span class="op" id="3408515">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408521">nameLen</span>&nbsp;<span class="op" id="3408529">:=</span>&nbsp;<span class="builtintype" id="3408532">int</span><span class="op" id="3408535">(</span><span class="ident" id="3408536">d</span><span class="op" id="3408537">[</span><span class="num" id="3408538">1</span><span class="op" id="3408539">]</span><span class="op" id="3408540">)</span><span class="op" id="3408541">&lt;&lt;</span><span class="num" id="3408543">8</span>&nbsp;<span class="op" id="3408545">|</span>&nbsp;<span class="builtintype" id="3408547">int</span><span class="op" id="3408550">(</span><span class="ident" id="3408551">d</span><span class="op" id="3408552">[</span><span class="num" id="3408553">2</span><span class="op" id="3408554">]</span><span class="op" id="3408555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408561">d</span>&nbsp;<span class="op" id="3408563">=</span>&nbsp;<span class="ident" id="3408565">d</span><span class="op" id="3408566">[</span><span class="num" id="3408567">3</span><span class="op" id="3408568">:</span><span class="op" id="3408569">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408575">if</span>&nbsp;<span class="builtinfunc" id="3408578">len</span><span class="op" id="3408581">(</span><span class="ident" id="3408582">d</span><span class="op" id="3408583">)</span>&nbsp;<span class="op" id="3408585">&lt;</span>&nbsp;<span class="ident" id="3408587">nameLen</span>&nbsp;<span class="op" id="3408595">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408602">return</span>&nbsp;<span class="builtintype" id="3408609">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408625">if</span>&nbsp;<span class="ident" id="3408628">nameType</span>&nbsp;<span class="op" id="3408637">==</span>&nbsp;<span class="num" id="3408640">0</span>&nbsp;<span class="op" id="3408642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408649">m</span><span class="op" id="3408650">.</span><span class="ident" id="3408651">serverName</span>&nbsp;<span class="op" id="3408662">=</span>&nbsp;<span class="builtintype" id="3408664">string</span><span class="op" id="3408670">(</span><span class="ident" id="3408671">d</span><span class="op" id="3408672">[</span><span class="num" id="3408673">0</span><span class="op" id="3408674">:</span><span class="ident" id="3408675">nameLen</span><span class="op" id="3408682">]</span><span class="op" id="3408683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408690">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408706">d</span>&nbsp;<span class="op" id="3408708">=</span>&nbsp;<span class="ident" id="3408710">d</span><span class="op" id="3408711">[</span><span class="ident" id="3408712">nameLen</span><span class="op" id="3408719">:</span><span class="op" id="3408720">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408729">case</span>&nbsp;<span class="ident" id="3408734">extensionNextProtoNeg</span><span class="op" id="3408755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408760">if</span>&nbsp;<span class="ident" id="3408763">length</span>&nbsp;<span class="op" id="3408770">&gt;</span>&nbsp;<span class="num" id="3408772">0</span>&nbsp;<span class="op" id="3408774">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408780">return</span>&nbsp;<span class="builtintype" id="3408787">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408801">m</span><span class="op" id="3408802">.</span><span class="ident" id="3408803">nextProtoNeg</span>&nbsp;<span class="op" id="3408816">=</span>&nbsp;<span class="builtintype" id="3408818">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408825">case</span>&nbsp;<span class="ident" id="3408830">extensionStatusRequest</span><span class="op" id="3408852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408857">m</span><span class="op" id="3408858">.</span><span class="ident" id="3408859">ocspStapling</span>&nbsp;<span class="op" id="3408872">=</span>&nbsp;<span class="ident" id="3408874">length</span>&nbsp;<span class="op" id="3408881">&gt;</span>&nbsp;<span class="num" id="3408883">0</span>&nbsp;<span class="op" id="3408885">&amp;&amp;</span>&nbsp;<span class="ident" id="3408888">data</span><span class="op" id="3408892">[</span><span class="num" id="3408893">0</span><span class="op" id="3408894">]</span>&nbsp;<span class="op" id="3408896">==</span>&nbsp;<span class="ident" id="3408899">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408916">case</span>&nbsp;<span class="ident" id="3408921">extensionSupportedCurves</span><span class="op" id="3408945">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3408950">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409005">if</span>&nbsp;<span class="ident" id="3409008">length</span>&nbsp;<span class="op" id="3409015">&lt;</span>&nbsp;<span class="num" id="3409017">2</span>&nbsp;<span class="op" id="3409019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409025">return</span>&nbsp;<span class="builtintype" id="3409032">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3409041">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409046">l</span>&nbsp;<span class="op" id="3409048">:=</span>&nbsp;<span class="builtintype" id="3409051">int</span><span class="op" id="3409054">(</span><span class="ident" id="3409055">data</span><span class="op" id="3409059">[</span><span class="num" id="3409060">0</span><span class="op" id="3409061">]</span><span class="op" id="3409062">)</span><span class="op" id="3409063">&lt;&lt;</span><span class="num" id="3409065">8</span>&nbsp;<span class="op" id="3409067">|</span>&nbsp;<span class="builtintype" id="3409069">int</span><span class="op" id="3409072">(</span><span class="ident" id="3409073">data</span><span class="op" id="3409077">[</span><span class="num" id="3409078">1</span><span class="op" id="3409079">]</span><span class="op" id="3409080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409085">if</span>&nbsp;<span class="ident" id="3409088">l</span><span class="op" id="3409089">%</span><span class="num" id="3409090">2</span>&nbsp;<span class="op" id="3409092">==</span>&nbsp;<span class="num" id="3409095">1</span>&nbsp;<span class="op" id="3409097">||</span>&nbsp;<span class="ident" id="3409100">length</span>&nbsp;<span class="op" id="3409107">!=</span>&nbsp;<span class="ident" id="3409110">l</span><span class="op" id="3409111">+</span><span class="num" id="3409112">2</span>&nbsp;<span class="op" id="3409114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409120">return</span>&nbsp;<span class="builtintype" id="3409127">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3409136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409141">numCurves</span>&nbsp;<span class="op" id="3409151">:=</span>&nbsp;<span class="ident" id="3409154">l</span>&nbsp;<span class="op" id="3409156">/</span>&nbsp;<span class="num" id="3409158">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409163">m</span><span class="op" id="3409164">.</span><span class="ident" id="3409165">supportedCurves</span>&nbsp;<span class="op" id="3409181">=</span>&nbsp;<span class="builtinfunc" id="3409183">make</span><span class="op" id="3409187">(</span><span class="op" id="3409188">[</span><span class="op" id="3409189">]</span><span class="ident" id="3409190">CurveID</span><span class="op" id="3409197">,</span>&nbsp;<span class="ident" id="3409199">numCurves</span><span class="op" id="3409208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409213">d</span>&nbsp;<span class="op" id="3409215">:=</span>&nbsp;<span class="ident" id="3409218">data</span><span class="op" id="3409222">[</span><span class="num" id="3409223">2</span><span class="op" id="3409224">:</span><span class="op" id="3409225">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409230">for</span>&nbsp;<span class="ident" id="3409234">i</span>&nbsp;<span class="op" id="3409236">:=</span>&nbsp;<span class="num" id="3409239">0</span><span class="op" id="3409240">;</span>&nbsp;<span class="ident" id="3409242">i</span>&nbsp;<span class="op" id="3409244">&lt;</span>&nbsp;<span class="ident" id="3409246">numCurves</span><span class="op" id="3409255">;</span>&nbsp;<span class="ident" id="3409257">i</span><span class="op" id="3409258">++</span>&nbsp;<span class="op" id="3409261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409267">m</span><span class="op" id="3409268">.</span><span class="ident" id="3409269">supportedCurves</span><span class="op" id="3409284">[</span><span class="ident" id="3409285">i</span><span class="op" id="3409286">]</span>&nbsp;<span class="op" id="3409288">=</span>&nbsp;<span class="ident" id="3409290">CurveID</span><span class="op" id="3409297">(</span><span class="ident" id="3409298">d</span><span class="op" id="3409299">[</span><span class="num" id="3409300">0</span><span class="op" id="3409301">]</span><span class="op" id="3409302">)</span><span class="op" id="3409303">&lt;&lt;</span><span class="num" id="3409305">8</span>&nbsp;<span class="op" id="3409307">|</span>&nbsp;<span class="ident" id="3409309">CurveID</span><span class="op" id="3409316">(</span><span class="ident" id="3409317">d</span><span class="op" id="3409318">[</span><span class="num" id="3409319">1</span><span class="op" id="3409320">]</span><span class="op" id="3409321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409327">d</span>&nbsp;<span class="op" id="3409329">=</span>&nbsp;<span class="ident" id="3409331">d</span><span class="op" id="3409332">[</span><span class="num" id="3409333">2</span><span class="op" id="3409334">:</span><span class="op" id="3409335">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3409340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409344">case</span>&nbsp;<span class="ident" id="3409349">extensionSupportedPoints</span><span class="op" id="3409373">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3409378">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409433">if</span>&nbsp;<span class="ident" id="3409436">length</span>&nbsp;<span class="op" id="3409443">&lt;</span>&nbsp;<span class="num" id="3409445">1</span>&nbsp;<span class="op" id="3409447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409453">return</span>&nbsp;<span class="builtintype" id="3409460">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3409469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409474">l</span>&nbsp;<span class="op" id="3409476">:=</span>&nbsp;<span class="builtintype" id="3409479">int</span><span class="op" id="3409482">(</span><span class="ident" id="3409483">data</span><span class="op" id="3409487">[</span><span class="num" id="3409488">0</span><span class="op" id="3409489">]</span><span class="op" id="3409490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409495">if</span>&nbsp;<span class="ident" id="3409498">length</span>&nbsp;<span class="op" id="3409505">!=</span>&nbsp;<span class="ident" id="3409508">l</span><span class="op" id="3409509">+</span><span class="num" id="3409510">1</span>&nbsp;<span class="op" id="3409512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409518">return</span>&nbsp;<span class="builtintype" id="3409525">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3409534">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409539">m</span><span class="op" id="3409540">.</span><span class="ident" id="3409541">supportedPoints</span>&nbsp;<span class="op" id="3409557">=</span>&nbsp;<span class="builtinfunc" id="3409559">make</span><span class="op" id="3409563">(</span><span class="op" id="3409564">[</span><span class="op" id="3409565">]</span><span class="builtintype" id="3409566">uint8</span><span class="op" id="3409571">,</span>&nbsp;<span class="ident" id="3409573">l</span><span class="op" id="3409574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3409579">copy</span><span class="op" id="3409583">(</span><span class="ident" id="3409584">m</span><span class="op" id="3409585">.</span><span class="ident" id="3409586">supportedPoints</span><span class="op" id="3409601">,</span>&nbsp;<span class="ident" id="3409603">data</span><span class="op" id="3409607">[</span><span class="num" id="3409608">1</span><span class="op" id="3409609">:</span><span class="op" id="3409610">]</span><span class="op" id="3409611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409615">case</span>&nbsp;<span class="ident" id="3409620">extensionSessionTicket</span><span class="op" id="3409642">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3409647">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409700">m</span><span class="op" id="3409701">.</span><span class="ident" id="3409702">ticketSupported</span>&nbsp;<span class="op" id="3409718">=</span>&nbsp;<span class="builtintype" id="3409720">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409728">m</span><span class="op" id="3409729">.</span><span class="ident" id="3409730">sessionTicket</span>&nbsp;<span class="op" id="3409744">=</span>&nbsp;<span class="ident" id="3409746">data</span><span class="op" id="3409750">[</span><span class="op" id="3409751">:</span><span class="ident" id="3409752">length</span><span class="op" id="3409758">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409762">case</span>&nbsp;<span class="ident" id="3409767">extensionSignatureAlgorithms</span><span class="op" id="3409795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3409800">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409860">if</span>&nbsp;<span class="ident" id="3409863">length</span>&nbsp;<span class="op" id="3409870">&lt;</span>&nbsp;<span class="num" id="3409872">2</span>&nbsp;<span class="op" id="3409874">||</span>&nbsp;<span class="ident" id="3409877">length</span><span class="op" id="3409883">&amp;</span><span class="num" id="3409884">1</span>&nbsp;<span class="op" id="3409886">!=</span>&nbsp;<span class="num" id="3409889">0</span>&nbsp;<span class="op" id="3409891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409897">return</span>&nbsp;<span class="builtintype" id="3409904">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3409913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409918">l</span>&nbsp;<span class="op" id="3409920">:=</span>&nbsp;<span class="builtintype" id="3409923">int</span><span class="op" id="3409926">(</span><span class="ident" id="3409927">data</span><span class="op" id="3409931">[</span><span class="num" id="3409932">0</span><span class="op" id="3409933">]</span><span class="op" id="3409934">)</span><span class="op" id="3409935">&lt;&lt;</span><span class="num" id="3409937">8</span>&nbsp;<span class="op" id="3409939">|</span>&nbsp;<span class="builtintype" id="3409941">int</span><span class="op" id="3409944">(</span><span class="ident" id="3409945">data</span><span class="op" id="3409949">[</span><span class="num" id="3409950">1</span><span class="op" id="3409951">]</span><span class="op" id="3409952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409957">if</span>&nbsp;<span class="ident" id="3409960">l</span>&nbsp;<span class="op" id="3409962">!=</span>&nbsp;<span class="ident" id="3409965">length</span><span class="op" id="3409971">-</span><span class="num" id="3409972">2</span>&nbsp;<span class="op" id="3409974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409980">return</span>&nbsp;<span class="builtintype" id="3409987">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3409996">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410001">n</span>&nbsp;<span class="op" id="3410003">:=</span>&nbsp;<span class="ident" id="3410006">l</span>&nbsp;<span class="op" id="3410008">/</span>&nbsp;<span class="num" id="3410010">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410015">d</span>&nbsp;<span class="op" id="3410017">:=</span>&nbsp;<span class="ident" id="3410020">data</span><span class="op" id="3410024">[</span><span class="num" id="3410025">2</span><span class="op" id="3410026">:</span><span class="op" id="3410027">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410032">m</span><span class="op" id="3410033">.</span><span class="ident" id="3410034">signatureAndHashes</span>&nbsp;<span class="op" id="3410053">=</span>&nbsp;<span class="builtinfunc" id="3410055">make</span><span class="op" id="3410059">(</span><span class="op" id="3410060">[</span><span class="op" id="3410061">]</span><span class="ident" id="3410062">signatureAndHash</span><span class="op" id="3410078">,</span>&nbsp;<span class="ident" id="3410080">n</span><span class="op" id="3410081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410086">for</span>&nbsp;<span class="ident" id="3410090">i</span>&nbsp;<span class="op" id="3410092">:=</span>&nbsp;<span class="keyword" id="3410095">range</span>&nbsp;<span class="ident" id="3410101">m</span><span class="op" id="3410102">.</span><span class="ident" id="3410103">signatureAndHashes</span>&nbsp;<span class="op" id="3410122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410128">m</span><span class="op" id="3410129">.</span><span class="ident" id="3410130">signatureAndHashes</span><span class="op" id="3410148">[</span><span class="ident" id="3410149">i</span><span class="op" id="3410150">]</span><span class="op" id="3410151">.</span><span class="ident" id="3410152">hash</span>&nbsp;<span class="op" id="3410157">=</span>&nbsp;<span class="ident" id="3410159">d</span><span class="op" id="3410160">[</span><span class="num" id="3410161">0</span><span class="op" id="3410162">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410168">m</span><span class="op" id="3410169">.</span><span class="ident" id="3410170">signatureAndHashes</span><span class="op" id="3410188">[</span><span class="ident" id="3410189">i</span><span class="op" id="3410190">]</span><span class="op" id="3410191">.</span><span class="ident" id="3410192">signature</span>&nbsp;<span class="op" id="3410202">=</span>&nbsp;<span class="ident" id="3410204">d</span><span class="op" id="3410205">[</span><span class="num" id="3410206">1</span><span class="op" id="3410207">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410213">d</span>&nbsp;<span class="op" id="3410215">=</span>&nbsp;<span class="ident" id="3410217">d</span><span class="op" id="3410218">[</span><span class="num" id="3410219">2</span><span class="op" id="3410220">:</span><span class="op" id="3410221">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410230">case</span>&nbsp;<span class="ident" id="3410235">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3410262">+</span>&nbsp;<span class="num" id="3410264">1</span><span class="op" id="3410265">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410270">if</span>&nbsp;<span class="ident" id="3410273">length</span>&nbsp;<span class="op" id="3410280">!=</span>&nbsp;<span class="num" id="3410283">1</span>&nbsp;<span class="op" id="3410285">||</span>&nbsp;<span class="ident" id="3410288">data</span><span class="op" id="3410292">[</span><span class="num" id="3410293">0</span><span class="op" id="3410294">]</span>&nbsp;<span class="op" id="3410296">!=</span>&nbsp;<span class="num" id="3410299">0</span>&nbsp;<span class="op" id="3410301">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410307">return</span>&nbsp;<span class="builtintype" id="3410314">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410328">m</span><span class="op" id="3410329">.</span><span class="ident" id="3410330">secureRenegotiation</span>&nbsp;<span class="op" id="3410350">=</span>&nbsp;<span class="builtintype" id="3410352">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410359">case</span>&nbsp;<span class="ident" id="3410364">extensionALPN</span><span class="op" id="3410377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410382">if</span>&nbsp;<span class="ident" id="3410385">length</span>&nbsp;<span class="op" id="3410392">&lt;</span>&nbsp;<span class="num" id="3410394">2</span>&nbsp;<span class="op" id="3410396">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410402">return</span>&nbsp;<span class="builtintype" id="3410409">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410423">l</span>&nbsp;<span class="op" id="3410425">:=</span>&nbsp;<span class="builtintype" id="3410428">int</span><span class="op" id="3410431">(</span><span class="ident" id="3410432">data</span><span class="op" id="3410436">[</span><span class="num" id="3410437">0</span><span class="op" id="3410438">]</span><span class="op" id="3410439">)</span><span class="op" id="3410440">&lt;&lt;</span><span class="num" id="3410442">8</span>&nbsp;<span class="op" id="3410444">|</span>&nbsp;<span class="builtintype" id="3410446">int</span><span class="op" id="3410449">(</span><span class="ident" id="3410450">data</span><span class="op" id="3410454">[</span><span class="num" id="3410455">1</span><span class="op" id="3410456">]</span><span class="op" id="3410457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410462">if</span>&nbsp;<span class="ident" id="3410465">l</span>&nbsp;<span class="op" id="3410467">!=</span>&nbsp;<span class="ident" id="3410470">length</span><span class="op" id="3410476">-</span><span class="num" id="3410477">2</span>&nbsp;<span class="op" id="3410479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410485">return</span>&nbsp;<span class="builtintype" id="3410492">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410506">d</span>&nbsp;<span class="op" id="3410508">:=</span>&nbsp;<span class="ident" id="3410511">data</span><span class="op" id="3410515">[</span><span class="num" id="3410516">2</span><span class="op" id="3410517">:</span><span class="ident" id="3410518">length</span><span class="op" id="3410524">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410529">for</span>&nbsp;<span class="builtinfunc" id="3410533">len</span><span class="op" id="3410536">(</span><span class="ident" id="3410537">d</span><span class="op" id="3410538">)</span>&nbsp;<span class="op" id="3410540">!=</span>&nbsp;<span class="num" id="3410543">0</span>&nbsp;<span class="op" id="3410545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410551">stringLen</span>&nbsp;<span class="op" id="3410561">:=</span>&nbsp;<span class="builtintype" id="3410564">int</span><span class="op" id="3410567">(</span><span class="ident" id="3410568">d</span><span class="op" id="3410569">[</span><span class="num" id="3410570">0</span><span class="op" id="3410571">]</span><span class="op" id="3410572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410578">d</span>&nbsp;<span class="op" id="3410580">=</span>&nbsp;<span class="ident" id="3410582">d</span><span class="op" id="3410583">[</span><span class="num" id="3410584">1</span><span class="op" id="3410585">:</span><span class="op" id="3410586">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410592">if</span>&nbsp;<span class="ident" id="3410595">stringLen</span>&nbsp;<span class="op" id="3410605">==</span>&nbsp;<span class="num" id="3410608">0</span>&nbsp;<span class="op" id="3410610">||</span>&nbsp;<span class="ident" id="3410613">stringLen</span>&nbsp;<span class="op" id="3410623">&gt;</span>&nbsp;<span class="builtinfunc" id="3410625">len</span><span class="op" id="3410628">(</span><span class="ident" id="3410629">d</span><span class="op" id="3410630">)</span>&nbsp;<span class="op" id="3410632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410639">return</span>&nbsp;<span class="builtintype" id="3410646">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410662">m</span><span class="op" id="3410663">.</span><span class="ident" id="3410664">alpnProtocols</span>&nbsp;<span class="op" id="3410678">=</span>&nbsp;<span class="builtinfunc" id="3410680">append</span><span class="op" id="3410686">(</span><span class="ident" id="3410687">m</span><span class="op" id="3410688">.</span><span class="ident" id="3410689">alpnProtocols</span><span class="op" id="3410702">,</span>&nbsp;<span class="builtintype" id="3410704">string</span><span class="op" id="3410710">(</span><span class="ident" id="3410711">d</span><span class="op" id="3410712">[</span><span class="op" id="3410713">:</span><span class="ident" id="3410714">stringLen</span><span class="op" id="3410723">]</span><span class="op" id="3410724">)</span><span class="op" id="3410725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410731">d</span>&nbsp;<span class="op" id="3410733">=</span>&nbsp;<span class="ident" id="3410735">d</span><span class="op" id="3410736">[</span><span class="ident" id="3410737">stringLen</span><span class="op" id="3410746">:</span><span class="op" id="3410747">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410760">data</span>&nbsp;<span class="op" id="3410765">=</span>&nbsp;<span class="ident" id="3410767">data</span><span class="op" id="3410771">[</span><span class="ident" id="3410772">length</span><span class="op" id="3410778">:</span><span class="op" id="3410779">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410786">return</span>&nbsp;<span class="builtintype" id="3410793">true</span><br>
<span class="lineno"></span><span class="op" id="3410798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3410801">type</span>&nbsp;<span class="ident" id="3410806">serverHelloMsg</span>&nbsp;<span class="keyword" id="3410821">struct</span>&nbsp;<span class="op" id="3410828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410831">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3410851">[</span><span class="op" id="3410852">]</span><span class="builtintype" id="3410853">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410859">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3410879">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410887">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3410907">[</span><span class="op" id="3410908">]</span><span class="builtintype" id="3410909">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410915">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3410935">[</span><span class="op" id="3410936">]</span><span class="builtintype" id="3410937">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410943">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3410963">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410971">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3410991">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410998">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3411018">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411024">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3411044">[</span><span class="op" id="3411045">]</span><span class="builtintype" id="3411046">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411054">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3411074">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411080">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3411100">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411106">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3411126">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411132">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3411152">string</span><br>
<span class="lineno"></span><span class="op" id="3411159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3411162">func</span>&nbsp;<span class="op" id="3411167">(</span><span class="ident" id="3411168">m</span>&nbsp;<span class="op" id="3411170">*</span><span class="ident" id="3411171">serverHelloMsg</span><span class="op" id="3411185">)</span>&nbsp;<span class="ident" id="3411187">equal</span><span class="op" id="3411192">(</span><span class="ident" id="3411193">i</span>&nbsp;<span class="keyword" id="3411195">interface</span><span class="op" id="3411204">{</span><span class="op" id="3411205">}</span><span class="op" id="3411206">)</span>&nbsp;<span class="builtintype" id="3411208">bool</span>&nbsp;<span class="op" id="3411213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411216">m1</span><span class="op" id="3411218">,</span>&nbsp;<span class="ident" id="3411220">ok</span>&nbsp;<span class="op" id="3411223">:=</span>&nbsp;<span class="ident" id="3411226">i</span><span class="op" id="3411227">.</span><span class="op" id="3411228">(</span><span class="op" id="3411229">*</span><span class="ident" id="3411230">serverHelloMsg</span><span class="op" id="3411244">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411247">if</span>&nbsp;<span class="op" id="3411250">!</span><span class="ident" id="3411251">ok</span>&nbsp;<span class="op" id="3411254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411258">return</span>&nbsp;<span class="builtintype" id="3411265">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3411272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411276">return</span>&nbsp;<span class="ident" id="3411283">bytes</span><span class="op" id="3411288">.</span><span class="ident" id="3411289">Equal</span><span class="op" id="3411294">(</span><span class="ident" id="3411295">m</span><span class="op" id="3411296">.</span><span class="ident" id="3411297">raw</span><span class="op" id="3411300">,</span>&nbsp;<span class="ident" id="3411302">m1</span><span class="op" id="3411304">.</span><span class="ident" id="3411305">raw</span><span class="op" id="3411308">)</span>&nbsp;<span class="op" id="3411310">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411315">m</span><span class="op" id="3411316">.</span><span class="ident" id="3411317">vers</span>&nbsp;<span class="op" id="3411322">==</span>&nbsp;<span class="ident" id="3411325">m1</span><span class="op" id="3411327">.</span><span class="ident" id="3411328">vers</span>&nbsp;<span class="op" id="3411333">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411338">bytes</span><span class="op" id="3411343">.</span><span class="ident" id="3411344">Equal</span><span class="op" id="3411349">(</span><span class="ident" id="3411350">m</span><span class="op" id="3411351">.</span><span class="ident" id="3411352">random</span><span class="op" id="3411358">,</span>&nbsp;<span class="ident" id="3411360">m1</span><span class="op" id="3411362">.</span><span class="ident" id="3411363">random</span><span class="op" id="3411369">)</span>&nbsp;<span class="op" id="3411371">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411376">bytes</span><span class="op" id="3411381">.</span><span class="ident" id="3411382">Equal</span><span class="op" id="3411387">(</span><span class="ident" id="3411388">m</span><span class="op" id="3411389">.</span><span class="ident" id="3411390">sessionId</span><span class="op" id="3411399">,</span>&nbsp;<span class="ident" id="3411401">m1</span><span class="op" id="3411403">.</span><span class="ident" id="3411404">sessionId</span><span class="op" id="3411413">)</span>&nbsp;<span class="op" id="3411415">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411420">m</span><span class="op" id="3411421">.</span><span class="ident" id="3411422">cipherSuite</span>&nbsp;<span class="op" id="3411434">==</span>&nbsp;<span class="ident" id="3411437">m1</span><span class="op" id="3411439">.</span><span class="ident" id="3411440">cipherSuite</span>&nbsp;<span class="op" id="3411452">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411457">m</span><span class="op" id="3411458">.</span><span class="ident" id="3411459">compressionMethod</span>&nbsp;<span class="op" id="3411477">==</span>&nbsp;<span class="ident" id="3411480">m1</span><span class="op" id="3411482">.</span><span class="ident" id="3411483">compressionMethod</span>&nbsp;<span class="op" id="3411501">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411506">m</span><span class="op" id="3411507">.</span><span class="ident" id="3411508">nextProtoNeg</span>&nbsp;<span class="op" id="3411521">==</span>&nbsp;<span class="ident" id="3411524">m1</span><span class="op" id="3411526">.</span><span class="ident" id="3411527">nextProtoNeg</span>&nbsp;<span class="op" id="3411540">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411545">eqStrings</span><span class="op" id="3411554">(</span><span class="ident" id="3411555">m</span><span class="op" id="3411556">.</span><span class="ident" id="3411557">nextProtos</span><span class="op" id="3411567">,</span>&nbsp;<span class="ident" id="3411569">m1</span><span class="op" id="3411571">.</span><span class="ident" id="3411572">nextProtos</span><span class="op" id="3411582">)</span>&nbsp;<span class="op" id="3411584">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411589">m</span><span class="op" id="3411590">.</span><span class="ident" id="3411591">ocspStapling</span>&nbsp;<span class="op" id="3411604">==</span>&nbsp;<span class="ident" id="3411607">m1</span><span class="op" id="3411609">.</span><span class="ident" id="3411610">ocspStapling</span>&nbsp;<span class="op" id="3411623">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411628">m</span><span class="op" id="3411629">.</span><span class="ident" id="3411630">ticketSupported</span>&nbsp;<span class="op" id="3411646">==</span>&nbsp;<span class="ident" id="3411649">m1</span><span class="op" id="3411651">.</span><span class="ident" id="3411652">ticketSupported</span>&nbsp;<span class="op" id="3411668">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411673">m</span><span class="op" id="3411674">.</span><span class="ident" id="3411675">secureRenegotiation</span>&nbsp;<span class="op" id="3411695">==</span>&nbsp;<span class="ident" id="3411698">m1</span><span class="op" id="3411700">.</span><span class="ident" id="3411701">secureRenegotiation</span>&nbsp;<span class="op" id="3411721">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411726">m</span><span class="op" id="3411727">.</span><span class="ident" id="3411728">alpnProtocol</span>&nbsp;<span class="op" id="3411741">==</span>&nbsp;<span class="ident" id="3411744">m1</span><span class="op" id="3411746">.</span><span class="ident" id="3411747">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="3411760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3411763">func</span>&nbsp;<span class="op" id="3411768">(</span><span class="ident" id="3411769">m</span>&nbsp;<span class="op" id="3411771">*</span><span class="ident" id="3411772">serverHelloMsg</span><span class="op" id="3411786">)</span>&nbsp;<span class="ident" id="3411788">marshal</span><span class="op" id="3411795">(</span><span class="op" id="3411796">)</span>&nbsp;<span class="op" id="3411798">[</span><span class="op" id="3411799">]</span><span class="builtintype" id="3411800">byte</span>&nbsp;<span class="op" id="3411805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411808">if</span>&nbsp;<span class="ident" id="3411811">m</span><span class="op" id="3411812">.</span><span class="ident" id="3411813">raw</span>&nbsp;<span class="op" id="3411817">!=</span>&nbsp;<span class="ident" id="3411820">nil</span>&nbsp;<span class="op" id="3411824">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411828">return</span>&nbsp;<span class="ident" id="3411835">m</span><span class="op" id="3411836">.</span><span class="ident" id="3411837">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3411842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411846">length</span>&nbsp;<span class="op" id="3411853">:=</span>&nbsp;<span class="num" id="3411856">38</span>&nbsp;<span class="op" id="3411859">+</span>&nbsp;<span class="builtinfunc" id="3411861">len</span><span class="op" id="3411864">(</span><span class="ident" id="3411865">m</span><span class="op" id="3411866">.</span><span class="ident" id="3411867">sessionId</span><span class="op" id="3411876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411879">numExtensions</span>&nbsp;<span class="op" id="3411893">:=</span>&nbsp;<span class="num" id="3411896">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411899">extensionsLength</span>&nbsp;<span class="op" id="3411916">:=</span>&nbsp;<span class="num" id="3411919">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411923">nextProtoLen</span>&nbsp;<span class="op" id="3411936">:=</span>&nbsp;<span class="num" id="3411939">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411942">if</span>&nbsp;<span class="ident" id="3411945">m</span><span class="op" id="3411946">.</span><span class="ident" id="3411947">nextProtoNeg</span>&nbsp;<span class="op" id="3411960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411964">numExtensions</span><span class="op" id="3411977">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411982">for</span>&nbsp;<span class="ident" id="3411986">_</span><span class="op" id="3411987">,</span>&nbsp;<span class="ident" id="3411989">v</span>&nbsp;<span class="op" id="3411991">:=</span>&nbsp;<span class="keyword" id="3411994">range</span>&nbsp;<span class="ident" id="3412000">m</span><span class="op" id="3412001">.</span><span class="ident" id="3412002">nextProtos</span>&nbsp;<span class="op" id="3412013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412018">nextProtoLen</span>&nbsp;<span class="op" id="3412031">+=</span>&nbsp;<span class="builtinfunc" id="3412034">len</span><span class="op" id="3412037">(</span><span class="ident" id="3412038">v</span><span class="op" id="3412039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412047">nextProtoLen</span>&nbsp;<span class="op" id="3412060">+=</span>&nbsp;<span class="builtinfunc" id="3412063">len</span><span class="op" id="3412066">(</span><span class="ident" id="3412067">m</span><span class="op" id="3412068">.</span><span class="ident" id="3412069">nextProtos</span><span class="op" id="3412079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412083">extensionsLength</span>&nbsp;<span class="op" id="3412100">+=</span>&nbsp;<span class="ident" id="3412103">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412120">if</span>&nbsp;<span class="ident" id="3412123">m</span><span class="op" id="3412124">.</span><span class="ident" id="3412125">ocspStapling</span>&nbsp;<span class="op" id="3412138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412142">numExtensions</span><span class="op" id="3412155">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412162">if</span>&nbsp;<span class="ident" id="3412165">m</span><span class="op" id="3412166">.</span><span class="ident" id="3412167">ticketSupported</span>&nbsp;<span class="op" id="3412183">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412187">numExtensions</span><span class="op" id="3412200">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412207">if</span>&nbsp;<span class="ident" id="3412210">m</span><span class="op" id="3412211">.</span><span class="ident" id="3412212">secureRenegotiation</span>&nbsp;<span class="op" id="3412232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412236">extensionsLength</span>&nbsp;<span class="op" id="3412253">+=</span>&nbsp;<span class="num" id="3412256">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412260">numExtensions</span><span class="op" id="3412273">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412280">if</span>&nbsp;<span class="ident" id="3412283">alpnLen</span>&nbsp;<span class="op" id="3412291">:=</span>&nbsp;<span class="builtinfunc" id="3412294">len</span><span class="op" id="3412297">(</span><span class="ident" id="3412298">m</span><span class="op" id="3412299">.</span><span class="ident" id="3412300">alpnProtocol</span><span class="op" id="3412312">)</span><span class="op" id="3412313">;</span>&nbsp;<span class="ident" id="3412315">alpnLen</span>&nbsp;<span class="op" id="3412323">&gt;</span>&nbsp;<span class="num" id="3412325">0</span>&nbsp;<span class="op" id="3412327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412331">if</span>&nbsp;<span class="ident" id="3412334">alpnLen</span>&nbsp;<span class="op" id="3412342">&gt;=</span>&nbsp;<span class="num" id="3412345">256</span>&nbsp;<span class="op" id="3412349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3412354">panic</span><span class="op" id="3412359">(</span><span class="string" id="3412360">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3412383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412387">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412391">extensionsLength</span>&nbsp;<span class="op" id="3412408">+=</span>&nbsp;<span class="num" id="3412411">2</span>&nbsp;<span class="op" id="3412413">+</span>&nbsp;<span class="num" id="3412415">1</span>&nbsp;<span class="op" id="3412417">+</span>&nbsp;<span class="ident" id="3412419">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412429">numExtensions</span><span class="op" id="3412442">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412450">if</span>&nbsp;<span class="ident" id="3412453">numExtensions</span>&nbsp;<span class="op" id="3412467">&gt;</span>&nbsp;<span class="num" id="3412469">0</span>&nbsp;<span class="op" id="3412471">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412475">extensionsLength</span>&nbsp;<span class="op" id="3412492">+=</span>&nbsp;<span class="num" id="3412495">4</span>&nbsp;<span class="op" id="3412497">*</span>&nbsp;<span class="ident" id="3412499">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412515">length</span>&nbsp;<span class="op" id="3412522">+=</span>&nbsp;<span class="num" id="3412525">2</span>&nbsp;<span class="op" id="3412527">+</span>&nbsp;<span class="ident" id="3412529">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412551">x</span>&nbsp;<span class="op" id="3412553">:=</span>&nbsp;<span class="builtinfunc" id="3412556">make</span><span class="op" id="3412560">(</span><span class="op" id="3412561">[</span><span class="op" id="3412562">]</span><span class="builtintype" id="3412563">byte</span><span class="op" id="3412567">,</span>&nbsp;<span class="num" id="3412569">4</span><span class="op" id="3412570">+</span><span class="ident" id="3412571">length</span><span class="op" id="3412577">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412580">x</span><span class="op" id="3412581">[</span><span class="num" id="3412582">0</span><span class="op" id="3412583">]</span>&nbsp;<span class="op" id="3412585">=</span>&nbsp;<span class="ident" id="3412587">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412604">x</span><span class="op" id="3412605">[</span><span class="num" id="3412606">1</span><span class="op" id="3412607">]</span>&nbsp;<span class="op" id="3412609">=</span>&nbsp;<span class="builtintype" id="3412611">uint8</span><span class="op" id="3412616">(</span><span class="ident" id="3412617">length</span>&nbsp;<span class="op" id="3412624">&gt;&gt;</span>&nbsp;<span class="num" id="3412627">16</span><span class="op" id="3412629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412632">x</span><span class="op" id="3412633">[</span><span class="num" id="3412634">2</span><span class="op" id="3412635">]</span>&nbsp;<span class="op" id="3412637">=</span>&nbsp;<span class="builtintype" id="3412639">uint8</span><span class="op" id="3412644">(</span><span class="ident" id="3412645">length</span>&nbsp;<span class="op" id="3412652">&gt;&gt;</span>&nbsp;<span class="num" id="3412655">8</span><span class="op" id="3412656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412659">x</span><span class="op" id="3412660">[</span><span class="num" id="3412661">3</span><span class="op" id="3412662">]</span>&nbsp;<span class="op" id="3412664">=</span>&nbsp;<span class="builtintype" id="3412666">uint8</span><span class="op" id="3412671">(</span><span class="ident" id="3412672">length</span><span class="op" id="3412678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412681">x</span><span class="op" id="3412682">[</span><span class="num" id="3412683">4</span><span class="op" id="3412684">]</span>&nbsp;<span class="op" id="3412686">=</span>&nbsp;<span class="builtintype" id="3412688">uint8</span><span class="op" id="3412693">(</span><span class="ident" id="3412694">m</span><span class="op" id="3412695">.</span><span class="ident" id="3412696">vers</span>&nbsp;<span class="op" id="3412701">&gt;&gt;</span>&nbsp;<span class="num" id="3412704">8</span><span class="op" id="3412705">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412708">x</span><span class="op" id="3412709">[</span><span class="num" id="3412710">5</span><span class="op" id="3412711">]</span>&nbsp;<span class="op" id="3412713">=</span>&nbsp;<span class="builtintype" id="3412715">uint8</span><span class="op" id="3412720">(</span><span class="ident" id="3412721">m</span><span class="op" id="3412722">.</span><span class="ident" id="3412723">vers</span><span class="op" id="3412727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3412730">copy</span><span class="op" id="3412734">(</span><span class="ident" id="3412735">x</span><span class="op" id="3412736">[</span><span class="num" id="3412737">6</span><span class="op" id="3412738">:</span><span class="num" id="3412739">38</span><span class="op" id="3412741">]</span><span class="op" id="3412742">,</span>&nbsp;<span class="ident" id="3412744">m</span><span class="op" id="3412745">.</span><span class="ident" id="3412746">random</span><span class="op" id="3412752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412755">x</span><span class="op" id="3412756">[</span><span class="num" id="3412757">38</span><span class="op" id="3412759">]</span>&nbsp;<span class="op" id="3412761">=</span>&nbsp;<span class="builtintype" id="3412763">uint8</span><span class="op" id="3412768">(</span><span class="builtinfunc" id="3412769">len</span><span class="op" id="3412772">(</span><span class="ident" id="3412773">m</span><span class="op" id="3412774">.</span><span class="ident" id="3412775">sessionId</span><span class="op" id="3412784">)</span><span class="op" id="3412785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3412788">copy</span><span class="op" id="3412792">(</span><span class="ident" id="3412793">x</span><span class="op" id="3412794">[</span><span class="num" id="3412795">39</span><span class="op" id="3412797">:</span><span class="num" id="3412798">39</span><span class="op" id="3412800">+</span><span class="builtinfunc" id="3412801">len</span><span class="op" id="3412804">(</span><span class="ident" id="3412805">m</span><span class="op" id="3412806">.</span><span class="ident" id="3412807">sessionId</span><span class="op" id="3412816">)</span><span class="op" id="3412817">]</span><span class="op" id="3412818">,</span>&nbsp;<span class="ident" id="3412820">m</span><span class="op" id="3412821">.</span><span class="ident" id="3412822">sessionId</span><span class="op" id="3412831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412834">z</span>&nbsp;<span class="op" id="3412836">:=</span>&nbsp;<span class="ident" id="3412839">x</span><span class="op" id="3412840">[</span><span class="num" id="3412841">39</span><span class="op" id="3412843">+</span><span class="builtinfunc" id="3412844">len</span><span class="op" id="3412847">(</span><span class="ident" id="3412848">m</span><span class="op" id="3412849">.</span><span class="ident" id="3412850">sessionId</span><span class="op" id="3412859">)</span><span class="op" id="3412860">:</span><span class="op" id="3412861">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412864">z</span><span class="op" id="3412865">[</span><span class="num" id="3412866">0</span><span class="op" id="3412867">]</span>&nbsp;<span class="op" id="3412869">=</span>&nbsp;<span class="builtintype" id="3412871">uint8</span><span class="op" id="3412876">(</span><span class="ident" id="3412877">m</span><span class="op" id="3412878">.</span><span class="ident" id="3412879">cipherSuite</span>&nbsp;<span class="op" id="3412891">&gt;&gt;</span>&nbsp;<span class="num" id="3412894">8</span><span class="op" id="3412895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412898">z</span><span class="op" id="3412899">[</span><span class="num" id="3412900">1</span><span class="op" id="3412901">]</span>&nbsp;<span class="op" id="3412903">=</span>&nbsp;<span class="builtintype" id="3412905">uint8</span><span class="op" id="3412910">(</span><span class="ident" id="3412911">m</span><span class="op" id="3412912">.</span><span class="ident" id="3412913">cipherSuite</span><span class="op" id="3412924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412927">z</span><span class="op" id="3412928">[</span><span class="num" id="3412929">2</span><span class="op" id="3412930">]</span>&nbsp;<span class="op" id="3412932">=</span>&nbsp;<span class="builtintype" id="3412934">uint8</span><span class="op" id="3412939">(</span><span class="ident" id="3412940">m</span><span class="op" id="3412941">.</span><span class="ident" id="3412942">compressionMethod</span><span class="op" id="3412959">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412963">z</span>&nbsp;<span class="op" id="3412965">=</span>&nbsp;<span class="ident" id="3412967">z</span><span class="op" id="3412968">[</span><span class="num" id="3412969">3</span><span class="op" id="3412970">:</span><span class="op" id="3412971">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412974">if</span>&nbsp;<span class="ident" id="3412977">numExtensions</span>&nbsp;<span class="op" id="3412991">&gt;</span>&nbsp;<span class="num" id="3412993">0</span>&nbsp;<span class="op" id="3412995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412999">z</span><span class="op" id="3413000">[</span><span class="num" id="3413001">0</span><span class="op" id="3413002">]</span>&nbsp;<span class="op" id="3413004">=</span>&nbsp;<span class="builtintype" id="3413006">byte</span><span class="op" id="3413010">(</span><span class="ident" id="3413011">extensionsLength</span>&nbsp;<span class="op" id="3413028">&gt;&gt;</span>&nbsp;<span class="num" id="3413031">8</span><span class="op" id="3413032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413036">z</span><span class="op" id="3413037">[</span><span class="num" id="3413038">1</span><span class="op" id="3413039">]</span>&nbsp;<span class="op" id="3413041">=</span>&nbsp;<span class="builtintype" id="3413043">byte</span><span class="op" id="3413047">(</span><span class="ident" id="3413048">extensionsLength</span><span class="op" id="3413064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413068">z</span>&nbsp;<span class="op" id="3413070">=</span>&nbsp;<span class="ident" id="3413072">z</span><span class="op" id="3413073">[</span><span class="num" id="3413074">2</span><span class="op" id="3413075">:</span><span class="op" id="3413076">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413079">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413082">if</span>&nbsp;<span class="ident" id="3413085">m</span><span class="op" id="3413086">.</span><span class="ident" id="3413087">nextProtoNeg</span>&nbsp;<span class="op" id="3413100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413104">z</span><span class="op" id="3413105">[</span><span class="num" id="3413106">0</span><span class="op" id="3413107">]</span>&nbsp;<span class="op" id="3413109">=</span>&nbsp;<span class="builtintype" id="3413111">byte</span><span class="op" id="3413115">(</span><span class="ident" id="3413116">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3413138">&gt;&gt;</span>&nbsp;<span class="num" id="3413141">8</span><span class="op" id="3413142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413146">z</span><span class="op" id="3413147">[</span><span class="num" id="3413148">1</span><span class="op" id="3413149">]</span>&nbsp;<span class="op" id="3413151">=</span>&nbsp;<span class="builtintype" id="3413153">byte</span><span class="op" id="3413157">(</span><span class="ident" id="3413158">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3413180">&amp;</span>&nbsp;<span class="num" id="3413182">0xff</span><span class="op" id="3413186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413190">z</span><span class="op" id="3413191">[</span><span class="num" id="3413192">2</span><span class="op" id="3413193">]</span>&nbsp;<span class="op" id="3413195">=</span>&nbsp;<span class="builtintype" id="3413197">byte</span><span class="op" id="3413201">(</span><span class="ident" id="3413202">nextProtoLen</span>&nbsp;<span class="op" id="3413215">&gt;&gt;</span>&nbsp;<span class="num" id="3413218">8</span><span class="op" id="3413219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413223">z</span><span class="op" id="3413224">[</span><span class="num" id="3413225">3</span><span class="op" id="3413226">]</span>&nbsp;<span class="op" id="3413228">=</span>&nbsp;<span class="builtintype" id="3413230">byte</span><span class="op" id="3413234">(</span><span class="ident" id="3413235">nextProtoLen</span><span class="op" id="3413247">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413251">z</span>&nbsp;<span class="op" id="3413253">=</span>&nbsp;<span class="ident" id="3413255">z</span><span class="op" id="3413256">[</span><span class="num" id="3413257">4</span><span class="op" id="3413258">:</span><span class="op" id="3413259">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413264">for</span>&nbsp;<span class="ident" id="3413268">_</span><span class="op" id="3413269">,</span>&nbsp;<span class="ident" id="3413271">v</span>&nbsp;<span class="op" id="3413273">:=</span>&nbsp;<span class="keyword" id="3413276">range</span>&nbsp;<span class="ident" id="3413282">m</span><span class="op" id="3413283">.</span><span class="ident" id="3413284">nextProtos</span>&nbsp;<span class="op" id="3413295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413300">l</span>&nbsp;<span class="op" id="3413302">:=</span>&nbsp;<span class="builtinfunc" id="3413305">len</span><span class="op" id="3413308">(</span><span class="ident" id="3413309">v</span><span class="op" id="3413310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413315">if</span>&nbsp;<span class="ident" id="3413318">l</span>&nbsp;<span class="op" id="3413320">&gt;</span>&nbsp;<span class="num" id="3413322">255</span>&nbsp;<span class="op" id="3413326">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413332">l</span>&nbsp;<span class="op" id="3413334">=</span>&nbsp;<span class="num" id="3413336">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413348">z</span><span class="op" id="3413349">[</span><span class="num" id="3413350">0</span><span class="op" id="3413351">]</span>&nbsp;<span class="op" id="3413353">=</span>&nbsp;<span class="builtintype" id="3413355">byte</span><span class="op" id="3413359">(</span><span class="ident" id="3413360">l</span><span class="op" id="3413361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3413366">copy</span><span class="op" id="3413370">(</span><span class="ident" id="3413371">z</span><span class="op" id="3413372">[</span><span class="num" id="3413373">1</span><span class="op" id="3413374">:</span><span class="op" id="3413375">]</span><span class="op" id="3413376">,</span>&nbsp;<span class="op" id="3413378">[</span><span class="op" id="3413379">]</span><span class="builtintype" id="3413380">byte</span><span class="op" id="3413384">(</span><span class="ident" id="3413385">v</span><span class="op" id="3413386">[</span><span class="num" id="3413387">0</span><span class="op" id="3413388">:</span><span class="ident" id="3413389">l</span><span class="op" id="3413390">]</span><span class="op" id="3413391">)</span><span class="op" id="3413392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413397">z</span>&nbsp;<span class="op" id="3413399">=</span>&nbsp;<span class="ident" id="3413401">z</span><span class="op" id="3413402">[</span><span class="num" id="3413403">1</span><span class="op" id="3413404">+</span><span class="ident" id="3413405">l</span><span class="op" id="3413406">:</span><span class="op" id="3413407">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413417">if</span>&nbsp;<span class="ident" id="3413420">m</span><span class="op" id="3413421">.</span><span class="ident" id="3413422">ocspStapling</span>&nbsp;<span class="op" id="3413435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413439">z</span><span class="op" id="3413440">[</span><span class="num" id="3413441">0</span><span class="op" id="3413442">]</span>&nbsp;<span class="op" id="3413444">=</span>&nbsp;<span class="builtintype" id="3413446">byte</span><span class="op" id="3413450">(</span><span class="ident" id="3413451">extensionStatusRequest</span>&nbsp;<span class="op" id="3413474">&gt;&gt;</span>&nbsp;<span class="num" id="3413477">8</span><span class="op" id="3413478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413482">z</span><span class="op" id="3413483">[</span><span class="num" id="3413484">1</span><span class="op" id="3413485">]</span>&nbsp;<span class="op" id="3413487">=</span>&nbsp;<span class="builtintype" id="3413489">byte</span><span class="op" id="3413493">(</span><span class="ident" id="3413494">extensionStatusRequest</span><span class="op" id="3413516">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413520">z</span>&nbsp;<span class="op" id="3413522">=</span>&nbsp;<span class="ident" id="3413524">z</span><span class="op" id="3413525">[</span><span class="num" id="3413526">4</span><span class="op" id="3413527">:</span><span class="op" id="3413528">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413534">if</span>&nbsp;<span class="ident" id="3413537">m</span><span class="op" id="3413538">.</span><span class="ident" id="3413539">ticketSupported</span>&nbsp;<span class="op" id="3413555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413559">z</span><span class="op" id="3413560">[</span><span class="num" id="3413561">0</span><span class="op" id="3413562">]</span>&nbsp;<span class="op" id="3413564">=</span>&nbsp;<span class="builtintype" id="3413566">byte</span><span class="op" id="3413570">(</span><span class="ident" id="3413571">extensionSessionTicket</span>&nbsp;<span class="op" id="3413594">&gt;&gt;</span>&nbsp;<span class="num" id="3413597">8</span><span class="op" id="3413598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413602">z</span><span class="op" id="3413603">[</span><span class="num" id="3413604">1</span><span class="op" id="3413605">]</span>&nbsp;<span class="op" id="3413607">=</span>&nbsp;<span class="builtintype" id="3413609">byte</span><span class="op" id="3413613">(</span><span class="ident" id="3413614">extensionSessionTicket</span><span class="op" id="3413636">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413640">z</span>&nbsp;<span class="op" id="3413642">=</span>&nbsp;<span class="ident" id="3413644">z</span><span class="op" id="3413645">[</span><span class="num" id="3413646">4</span><span class="op" id="3413647">:</span><span class="op" id="3413648">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413654">if</span>&nbsp;<span class="ident" id="3413657">m</span><span class="op" id="3413658">.</span><span class="ident" id="3413659">secureRenegotiation</span>&nbsp;<span class="op" id="3413679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413683">z</span><span class="op" id="3413684">[</span><span class="num" id="3413685">0</span><span class="op" id="3413686">]</span>&nbsp;<span class="op" id="3413688">=</span>&nbsp;<span class="builtintype" id="3413690">byte</span><span class="op" id="3413694">(</span><span class="ident" id="3413695">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3413722">&gt;&gt;</span>&nbsp;<span class="num" id="3413725">8</span><span class="op" id="3413726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413730">z</span><span class="op" id="3413731">[</span><span class="num" id="3413732">1</span><span class="op" id="3413733">]</span>&nbsp;<span class="op" id="3413735">=</span>&nbsp;<span class="builtintype" id="3413737">byte</span><span class="op" id="3413741">(</span><span class="ident" id="3413742">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3413769">&amp;</span>&nbsp;<span class="num" id="3413771">0xff</span><span class="op" id="3413775">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413779">z</span><span class="op" id="3413780">[</span><span class="num" id="3413781">2</span><span class="op" id="3413782">]</span>&nbsp;<span class="op" id="3413784">=</span>&nbsp;<span class="num" id="3413786">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413790">z</span><span class="op" id="3413791">[</span><span class="num" id="3413792">3</span><span class="op" id="3413793">]</span>&nbsp;<span class="op" id="3413795">=</span>&nbsp;<span class="num" id="3413797">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413801">z</span>&nbsp;<span class="op" id="3413803">=</span>&nbsp;<span class="ident" id="3413805">z</span><span class="op" id="3413806">[</span><span class="num" id="3413807">5</span><span class="op" id="3413808">:</span><span class="op" id="3413809">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413815">if</span>&nbsp;<span class="ident" id="3413818">alpnLen</span>&nbsp;<span class="op" id="3413826">:=</span>&nbsp;<span class="builtinfunc" id="3413829">len</span><span class="op" id="3413832">(</span><span class="ident" id="3413833">m</span><span class="op" id="3413834">.</span><span class="ident" id="3413835">alpnProtocol</span><span class="op" id="3413847">)</span><span class="op" id="3413848">;</span>&nbsp;<span class="ident" id="3413850">alpnLen</span>&nbsp;<span class="op" id="3413858">&gt;</span>&nbsp;<span class="num" id="3413860">0</span>&nbsp;<span class="op" id="3413862">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413866">z</span><span class="op" id="3413867">[</span><span class="num" id="3413868">0</span><span class="op" id="3413869">]</span>&nbsp;<span class="op" id="3413871">=</span>&nbsp;<span class="builtintype" id="3413873">byte</span><span class="op" id="3413877">(</span><span class="ident" id="3413878">extensionALPN</span>&nbsp;<span class="op" id="3413892">&gt;&gt;</span>&nbsp;<span class="num" id="3413895">8</span><span class="op" id="3413896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413900">z</span><span class="op" id="3413901">[</span><span class="num" id="3413902">1</span><span class="op" id="3413903">]</span>&nbsp;<span class="op" id="3413905">=</span>&nbsp;<span class="builtintype" id="3413907">byte</span><span class="op" id="3413911">(</span><span class="ident" id="3413912">extensionALPN</span>&nbsp;<span class="op" id="3413926">&amp;</span>&nbsp;<span class="num" id="3413928">0xff</span><span class="op" id="3413932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413936">l</span>&nbsp;<span class="op" id="3413938">:=</span>&nbsp;<span class="num" id="3413941">2</span>&nbsp;<span class="op" id="3413943">+</span>&nbsp;<span class="num" id="3413945">1</span>&nbsp;<span class="op" id="3413947">+</span>&nbsp;<span class="ident" id="3413949">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413959">z</span><span class="op" id="3413960">[</span><span class="num" id="3413961">2</span><span class="op" id="3413962">]</span>&nbsp;<span class="op" id="3413964">=</span>&nbsp;<span class="builtintype" id="3413966">byte</span><span class="op" id="3413970">(</span><span class="ident" id="3413971">l</span>&nbsp;<span class="op" id="3413973">&gt;&gt;</span>&nbsp;<span class="num" id="3413976">8</span><span class="op" id="3413977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413981">z</span><span class="op" id="3413982">[</span><span class="num" id="3413983">3</span><span class="op" id="3413984">]</span>&nbsp;<span class="op" id="3413986">=</span>&nbsp;<span class="builtintype" id="3413988">byte</span><span class="op" id="3413992">(</span><span class="ident" id="3413993">l</span><span class="op" id="3413994">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413998">l</span>&nbsp;<span class="op" id="3414000">-=</span>&nbsp;<span class="num" id="3414003">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414007">z</span><span class="op" id="3414008">[</span><span class="num" id="3414009">4</span><span class="op" id="3414010">]</span>&nbsp;<span class="op" id="3414012">=</span>&nbsp;<span class="builtintype" id="3414014">byte</span><span class="op" id="3414018">(</span><span class="ident" id="3414019">l</span>&nbsp;<span class="op" id="3414021">&gt;&gt;</span>&nbsp;<span class="num" id="3414024">8</span><span class="op" id="3414025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414029">z</span><span class="op" id="3414030">[</span><span class="num" id="3414031">5</span><span class="op" id="3414032">]</span>&nbsp;<span class="op" id="3414034">=</span>&nbsp;<span class="builtintype" id="3414036">byte</span><span class="op" id="3414040">(</span><span class="ident" id="3414041">l</span><span class="op" id="3414042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414046">l</span>&nbsp;<span class="op" id="3414048">-=</span>&nbsp;<span class="num" id="3414051">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414055">z</span><span class="op" id="3414056">[</span><span class="num" id="3414057">6</span><span class="op" id="3414058">]</span>&nbsp;<span class="op" id="3414060">=</span>&nbsp;<span class="builtintype" id="3414062">byte</span><span class="op" id="3414066">(</span><span class="ident" id="3414067">l</span><span class="op" id="3414068">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3414072">copy</span><span class="op" id="3414076">(</span><span class="ident" id="3414077">z</span><span class="op" id="3414078">[</span><span class="num" id="3414079">7</span><span class="op" id="3414080">:</span><span class="op" id="3414081">]</span><span class="op" id="3414082">,</span>&nbsp;<span class="op" id="3414084">[</span><span class="op" id="3414085">]</span><span class="builtintype" id="3414086">byte</span><span class="op" id="3414090">(</span><span class="ident" id="3414091">m</span><span class="op" id="3414092">.</span><span class="ident" id="3414093">alpnProtocol</span><span class="op" id="3414105">)</span><span class="op" id="3414106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414110">z</span>&nbsp;<span class="op" id="3414112">=</span>&nbsp;<span class="ident" id="3414114">z</span><span class="op" id="3414115">[</span><span class="num" id="3414116">7</span><span class="op" id="3414117">+</span><span class="ident" id="3414118">alpnLen</span><span class="op" id="3414125">:</span><span class="op" id="3414126">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414133">m</span><span class="op" id="3414134">.</span><span class="ident" id="3414135">raw</span>&nbsp;<span class="op" id="3414139">=</span>&nbsp;<span class="ident" id="3414141">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414145">return</span>&nbsp;<span class="ident" id="3414152">x</span><br>
<span class="lineno"></span><span class="op" id="3414154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3414157">func</span>&nbsp;<span class="op" id="3414162">(</span><span class="ident" id="3414163">m</span>&nbsp;<span class="op" id="3414165">*</span><span class="ident" id="3414166">serverHelloMsg</span><span class="op" id="3414180">)</span>&nbsp;<span class="ident" id="3414182">unmarshal</span><span class="op" id="3414191">(</span><span class="ident" id="3414192">data</span>&nbsp;<span class="op" id="3414197">[</span><span class="op" id="3414198">]</span><span class="builtintype" id="3414199">byte</span><span class="op" id="3414203">)</span>&nbsp;<span class="builtintype" id="3414205">bool</span>&nbsp;<span class="op" id="3414210">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414213">if</span>&nbsp;<span class="builtinfunc" id="3414216">len</span><span class="op" id="3414219">(</span><span class="ident" id="3414220">data</span><span class="op" id="3414224">)</span>&nbsp;<span class="op" id="3414226">&lt;</span>&nbsp;<span class="num" id="3414228">42</span>&nbsp;<span class="op" id="3414231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414235">return</span>&nbsp;<span class="builtintype" id="3414242">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414252">m</span><span class="op" id="3414253">.</span><span class="ident" id="3414254">raw</span>&nbsp;<span class="op" id="3414258">=</span>&nbsp;<span class="ident" id="3414260">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414266">m</span><span class="op" id="3414267">.</span><span class="ident" id="3414268">vers</span>&nbsp;<span class="op" id="3414273">=</span>&nbsp;<span class="builtintype" id="3414275">uint16</span><span class="op" id="3414281">(</span><span class="ident" id="3414282">data</span><span class="op" id="3414286">[</span><span class="num" id="3414287">4</span><span class="op" id="3414288">]</span><span class="op" id="3414289">)</span><span class="op" id="3414290">&lt;&lt;</span><span class="num" id="3414292">8</span>&nbsp;<span class="op" id="3414294">|</span>&nbsp;<span class="builtintype" id="3414296">uint16</span><span class="op" id="3414302">(</span><span class="ident" id="3414303">data</span><span class="op" id="3414307">[</span><span class="num" id="3414308">5</span><span class="op" id="3414309">]</span><span class="op" id="3414310">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414313">m</span><span class="op" id="3414314">.</span><span class="ident" id="3414315">random</span>&nbsp;<span class="op" id="3414322">=</span>&nbsp;<span class="ident" id="3414324">data</span><span class="op" id="3414328">[</span><span class="num" id="3414329">6</span><span class="op" id="3414330">:</span><span class="num" id="3414331">38</span><span class="op" id="3414333">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414336">sessionIdLen</span>&nbsp;<span class="op" id="3414349">:=</span>&nbsp;<span class="builtintype" id="3414352">int</span><span class="op" id="3414355">(</span><span class="ident" id="3414356">data</span><span class="op" id="3414360">[</span><span class="num" id="3414361">38</span><span class="op" id="3414363">]</span><span class="op" id="3414364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414367">if</span>&nbsp;<span class="ident" id="3414370">sessionIdLen</span>&nbsp;<span class="op" id="3414383">&gt;</span>&nbsp;<span class="num" id="3414385">32</span>&nbsp;<span class="op" id="3414388">||</span>&nbsp;<span class="builtinfunc" id="3414391">len</span><span class="op" id="3414394">(</span><span class="ident" id="3414395">data</span><span class="op" id="3414399">)</span>&nbsp;<span class="op" id="3414401">&lt;</span>&nbsp;<span class="num" id="3414403">39</span><span class="op" id="3414405">+</span><span class="ident" id="3414406">sessionIdLen</span>&nbsp;<span class="op" id="3414419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414423">return</span>&nbsp;<span class="builtintype" id="3414430">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414437">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414440">m</span><span class="op" id="3414441">.</span><span class="ident" id="3414442">sessionId</span>&nbsp;<span class="op" id="3414452">=</span>&nbsp;<span class="ident" id="3414454">data</span><span class="op" id="3414458">[</span><span class="num" id="3414459">39</span>&nbsp;<span class="op" id="3414462">:</span>&nbsp;<span class="num" id="3414464">39</span><span class="op" id="3414466">+</span><span class="ident" id="3414467">sessionIdLen</span><span class="op" id="3414479">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414482">data</span>&nbsp;<span class="op" id="3414487">=</span>&nbsp;<span class="ident" id="3414489">data</span><span class="op" id="3414493">[</span><span class="num" id="3414494">39</span><span class="op" id="3414496">+</span><span class="ident" id="3414497">sessionIdLen</span><span class="op" id="3414509">:</span><span class="op" id="3414510">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414513">if</span>&nbsp;<span class="builtinfunc" id="3414516">len</span><span class="op" id="3414519">(</span><span class="ident" id="3414520">data</span><span class="op" id="3414524">)</span>&nbsp;<span class="op" id="3414526">&lt;</span>&nbsp;<span class="num" id="3414528">3</span>&nbsp;<span class="op" id="3414530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414534">return</span>&nbsp;<span class="builtintype" id="3414541">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414548">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414551">m</span><span class="op" id="3414552">.</span><span class="ident" id="3414553">cipherSuite</span>&nbsp;<span class="op" id="3414565">=</span>&nbsp;<span class="builtintype" id="3414567">uint16</span><span class="op" id="3414573">(</span><span class="ident" id="3414574">data</span><span class="op" id="3414578">[</span><span class="num" id="3414579">0</span><span class="op" id="3414580">]</span><span class="op" id="3414581">)</span><span class="op" id="3414582">&lt;&lt;</span><span class="num" id="3414584">8</span>&nbsp;<span class="op" id="3414586">|</span>&nbsp;<span class="builtintype" id="3414588">uint16</span><span class="op" id="3414594">(</span><span class="ident" id="3414595">data</span><span class="op" id="3414599">[</span><span class="num" id="3414600">1</span><span class="op" id="3414601">]</span><span class="op" id="3414602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414605">m</span><span class="op" id="3414606">.</span><span class="ident" id="3414607">compressionMethod</span>&nbsp;<span class="op" id="3414625">=</span>&nbsp;<span class="ident" id="3414627">data</span><span class="op" id="3414631">[</span><span class="num" id="3414632">2</span><span class="op" id="3414633">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414636">data</span>&nbsp;<span class="op" id="3414641">=</span>&nbsp;<span class="ident" id="3414643">data</span><span class="op" id="3414647">[</span><span class="num" id="3414648">3</span><span class="op" id="3414649">:</span><span class="op" id="3414650">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414654">m</span><span class="op" id="3414655">.</span><span class="ident" id="3414656">nextProtoNeg</span>&nbsp;<span class="op" id="3414669">=</span>&nbsp;<span class="builtintype" id="3414671">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414678">m</span><span class="op" id="3414679">.</span><span class="ident" id="3414680">nextProtos</span>&nbsp;<span class="op" id="3414691">=</span>&nbsp;<span class="ident" id="3414693">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414698">m</span><span class="op" id="3414699">.</span><span class="ident" id="3414700">ocspStapling</span>&nbsp;<span class="op" id="3414713">=</span>&nbsp;<span class="builtintype" id="3414715">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414722">m</span><span class="op" id="3414723">.</span><span class="ident" id="3414724">ticketSupported</span>&nbsp;<span class="op" id="3414740">=</span>&nbsp;<span class="builtintype" id="3414742">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414749">m</span><span class="op" id="3414750">.</span><span class="ident" id="3414751">alpnProtocol</span>&nbsp;<span class="op" id="3414764">=</span>&nbsp;<span class="string" id="3414766">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414771">if</span>&nbsp;<span class="builtinfunc" id="3414774">len</span><span class="op" id="3414777">(</span><span class="ident" id="3414778">data</span><span class="op" id="3414782">)</span>&nbsp;<span class="op" id="3414784">==</span>&nbsp;<span class="num" id="3414787">0</span>&nbsp;<span class="op" id="3414789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3414793">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414851">return</span>&nbsp;<span class="builtintype" id="3414858">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414867">if</span>&nbsp;<span class="builtinfunc" id="3414870">len</span><span class="op" id="3414873">(</span><span class="ident" id="3414874">data</span><span class="op" id="3414878">)</span>&nbsp;<span class="op" id="3414880">&lt;</span>&nbsp;<span class="num" id="3414882">2</span>&nbsp;<span class="op" id="3414884">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414888">return</span>&nbsp;<span class="builtintype" id="3414895">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414906">extensionsLength</span>&nbsp;<span class="op" id="3414923">:=</span>&nbsp;<span class="builtintype" id="3414926">int</span><span class="op" id="3414929">(</span><span class="ident" id="3414930">data</span><span class="op" id="3414934">[</span><span class="num" id="3414935">0</span><span class="op" id="3414936">]</span><span class="op" id="3414937">)</span><span class="op" id="3414938">&lt;&lt;</span><span class="num" id="3414940">8</span>&nbsp;<span class="op" id="3414942">|</span>&nbsp;<span class="builtintype" id="3414944">int</span><span class="op" id="3414947">(</span><span class="ident" id="3414948">data</span><span class="op" id="3414952">[</span><span class="num" id="3414953">1</span><span class="op" id="3414954">]</span><span class="op" id="3414955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414958">data</span>&nbsp;<span class="op" id="3414963">=</span>&nbsp;<span class="ident" id="3414965">data</span><span class="op" id="3414969">[</span><span class="num" id="3414970">2</span><span class="op" id="3414971">:</span><span class="op" id="3414972">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414975">if</span>&nbsp;<span class="builtinfunc" id="3414978">len</span><span class="op" id="3414981">(</span><span class="ident" id="3414982">data</span><span class="op" id="3414986">)</span>&nbsp;<span class="op" id="3414988">!=</span>&nbsp;<span class="ident" id="3414991">extensionsLength</span>&nbsp;<span class="op" id="3415008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415012">return</span>&nbsp;<span class="builtintype" id="3415019">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415030">for</span>&nbsp;<span class="builtinfunc" id="3415034">len</span><span class="op" id="3415037">(</span><span class="ident" id="3415038">data</span><span class="op" id="3415042">)</span>&nbsp;<span class="op" id="3415044">!=</span>&nbsp;<span class="num" id="3415047">0</span>&nbsp;<span class="op" id="3415049">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415053">if</span>&nbsp;<span class="builtinfunc" id="3415056">len</span><span class="op" id="3415059">(</span><span class="ident" id="3415060">data</span><span class="op" id="3415064">)</span>&nbsp;<span class="op" id="3415066">&lt;</span>&nbsp;<span class="num" id="3415068">4</span>&nbsp;<span class="op" id="3415070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415075">return</span>&nbsp;<span class="builtintype" id="3415082">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415094">extension</span>&nbsp;<span class="op" id="3415104">:=</span>&nbsp;<span class="builtintype" id="3415107">uint16</span><span class="op" id="3415113">(</span><span class="ident" id="3415114">data</span><span class="op" id="3415118">[</span><span class="num" id="3415119">0</span><span class="op" id="3415120">]</span><span class="op" id="3415121">)</span><span class="op" id="3415122">&lt;&lt;</span><span class="num" id="3415124">8</span>&nbsp;<span class="op" id="3415126">|</span>&nbsp;<span class="builtintype" id="3415128">uint16</span><span class="op" id="3415134">(</span><span class="ident" id="3415135">data</span><span class="op" id="3415139">[</span><span class="num" id="3415140">1</span><span class="op" id="3415141">]</span><span class="op" id="3415142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415146">length</span>&nbsp;<span class="op" id="3415153">:=</span>&nbsp;<span class="builtintype" id="3415156">int</span><span class="op" id="3415159">(</span><span class="ident" id="3415160">data</span><span class="op" id="3415164">[</span><span class="num" id="3415165">2</span><span class="op" id="3415166">]</span><span class="op" id="3415167">)</span><span class="op" id="3415168">&lt;&lt;</span><span class="num" id="3415170">8</span>&nbsp;<span class="op" id="3415172">|</span>&nbsp;<span class="builtintype" id="3415174">int</span><span class="op" id="3415177">(</span><span class="ident" id="3415178">data</span><span class="op" id="3415182">[</span><span class="num" id="3415183">3</span><span class="op" id="3415184">]</span><span class="op" id="3415185">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415189">data</span>&nbsp;<span class="op" id="3415194">=</span>&nbsp;<span class="ident" id="3415196">data</span><span class="op" id="3415200">[</span><span class="num" id="3415201">4</span><span class="op" id="3415202">:</span><span class="op" id="3415203">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415207">if</span>&nbsp;<span class="builtinfunc" id="3415210">len</span><span class="op" id="3415213">(</span><span class="ident" id="3415214">data</span><span class="op" id="3415218">)</span>&nbsp;<span class="op" id="3415220">&lt;</span>&nbsp;<span class="ident" id="3415222">length</span>&nbsp;<span class="op" id="3415229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415234">return</span>&nbsp;<span class="builtintype" id="3415241">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415254">switch</span>&nbsp;<span class="ident" id="3415261">extension</span>&nbsp;<span class="op" id="3415271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415275">case</span>&nbsp;<span class="ident" id="3415280">extensionNextProtoNeg</span><span class="op" id="3415301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415306">m</span><span class="op" id="3415307">.</span><span class="ident" id="3415308">nextProtoNeg</span>&nbsp;<span class="op" id="3415321">=</span>&nbsp;<span class="builtintype" id="3415323">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415331">d</span>&nbsp;<span class="op" id="3415333">:=</span>&nbsp;<span class="ident" id="3415336">data</span><span class="op" id="3415340">[</span><span class="op" id="3415341">:</span><span class="ident" id="3415342">length</span><span class="op" id="3415348">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415353">for</span>&nbsp;<span class="builtinfunc" id="3415357">len</span><span class="op" id="3415360">(</span><span class="ident" id="3415361">d</span><span class="op" id="3415362">)</span>&nbsp;<span class="op" id="3415364">&gt;</span>&nbsp;<span class="num" id="3415366">0</span>&nbsp;<span class="op" id="3415368">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415374">l</span>&nbsp;<span class="op" id="3415376">:=</span>&nbsp;<span class="builtintype" id="3415379">int</span><span class="op" id="3415382">(</span><span class="ident" id="3415383">d</span><span class="op" id="3415384">[</span><span class="num" id="3415385">0</span><span class="op" id="3415386">]</span><span class="op" id="3415387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415393">d</span>&nbsp;<span class="op" id="3415395">=</span>&nbsp;<span class="ident" id="3415397">d</span><span class="op" id="3415398">[</span><span class="num" id="3415399">1</span><span class="op" id="3415400">:</span><span class="op" id="3415401">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415407">if</span>&nbsp;<span class="ident" id="3415410">l</span>&nbsp;<span class="op" id="3415412">==</span>&nbsp;<span class="num" id="3415415">0</span>&nbsp;<span class="op" id="3415417">||</span>&nbsp;<span class="ident" id="3415420">l</span>&nbsp;<span class="op" id="3415422">&gt;</span>&nbsp;<span class="builtinfunc" id="3415424">len</span><span class="op" id="3415427">(</span><span class="ident" id="3415428">d</span><span class="op" id="3415429">)</span>&nbsp;<span class="op" id="3415431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415438">return</span>&nbsp;<span class="builtintype" id="3415445">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415455">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415461">m</span><span class="op" id="3415462">.</span><span class="ident" id="3415463">nextProtos</span>&nbsp;<span class="op" id="3415474">=</span>&nbsp;<span class="builtinfunc" id="3415476">append</span><span class="op" id="3415482">(</span><span class="ident" id="3415483">m</span><span class="op" id="3415484">.</span><span class="ident" id="3415485">nextProtos</span><span class="op" id="3415495">,</span>&nbsp;<span class="builtintype" id="3415497">string</span><span class="op" id="3415503">(</span><span class="ident" id="3415504">d</span><span class="op" id="3415505">[</span><span class="op" id="3415506">:</span><span class="ident" id="3415507">l</span><span class="op" id="3415508">]</span><span class="op" id="3415509">)</span><span class="op" id="3415510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415516">d</span>&nbsp;<span class="op" id="3415518">=</span>&nbsp;<span class="ident" id="3415520">d</span><span class="op" id="3415521">[</span><span class="ident" id="3415522">l</span><span class="op" id="3415523">:</span><span class="op" id="3415524">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415533">case</span>&nbsp;<span class="ident" id="3415538">extensionStatusRequest</span><span class="op" id="3415560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415565">if</span>&nbsp;<span class="ident" id="3415568">length</span>&nbsp;<span class="op" id="3415575">&gt;</span>&nbsp;<span class="num" id="3415577">0</span>&nbsp;<span class="op" id="3415579">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415585">return</span>&nbsp;<span class="builtintype" id="3415592">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415606">m</span><span class="op" id="3415607">.</span><span class="ident" id="3415608">ocspStapling</span>&nbsp;<span class="op" id="3415621">=</span>&nbsp;<span class="builtintype" id="3415623">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415630">case</span>&nbsp;<span class="ident" id="3415635">extensionSessionTicket</span><span class="op" id="3415657">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415662">if</span>&nbsp;<span class="ident" id="3415665">length</span>&nbsp;<span class="op" id="3415672">&gt;</span>&nbsp;<span class="num" id="3415674">0</span>&nbsp;<span class="op" id="3415676">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415682">return</span>&nbsp;<span class="builtintype" id="3415689">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415703">m</span><span class="op" id="3415704">.</span><span class="ident" id="3415705">ticketSupported</span>&nbsp;<span class="op" id="3415721">=</span>&nbsp;<span class="builtintype" id="3415723">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415730">case</span>&nbsp;<span class="ident" id="3415735">extensionRenegotiationInfo</span><span class="op" id="3415761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415766">if</span>&nbsp;<span class="ident" id="3415769">length</span>&nbsp;<span class="op" id="3415776">!=</span>&nbsp;<span class="num" id="3415779">1</span>&nbsp;<span class="op" id="3415781">||</span>&nbsp;<span class="ident" id="3415784">data</span><span class="op" id="3415788">[</span><span class="num" id="3415789">0</span><span class="op" id="3415790">]</span>&nbsp;<span class="op" id="3415792">!=</span>&nbsp;<span class="num" id="3415795">0</span>&nbsp;<span class="op" id="3415797">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415803">return</span>&nbsp;<span class="builtintype" id="3415810">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415824">m</span><span class="op" id="3415825">.</span><span class="ident" id="3415826">secureRenegotiation</span>&nbsp;<span class="op" id="3415846">=</span>&nbsp;<span class="builtintype" id="3415848">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415855">case</span>&nbsp;<span class="ident" id="3415860">extensionALPN</span><span class="op" id="3415873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415878">d</span>&nbsp;<span class="op" id="3415880">:=</span>&nbsp;<span class="ident" id="3415883">data</span><span class="op" id="3415887">[</span><span class="op" id="3415888">:</span><span class="ident" id="3415889">length</span><span class="op" id="3415895">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415900">if</span>&nbsp;<span class="builtinfunc" id="3415903">len</span><span class="op" id="3415906">(</span><span class="ident" id="3415907">d</span><span class="op" id="3415908">)</span>&nbsp;<span class="op" id="3415910">&lt;</span>&nbsp;<span class="num" id="3415912">3</span>&nbsp;<span class="op" id="3415914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415920">return</span>&nbsp;<span class="builtintype" id="3415927">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415941">l</span>&nbsp;<span class="op" id="3415943">:=</span>&nbsp;<span class="builtintype" id="3415946">int</span><span class="op" id="3415949">(</span><span class="ident" id="3415950">d</span><span class="op" id="3415951">[</span><span class="num" id="3415952">0</span><span class="op" id="3415953">]</span><span class="op" id="3415954">)</span><span class="op" id="3415955">&lt;&lt;</span><span class="num" id="3415957">8</span>&nbsp;<span class="op" id="3415959">|</span>&nbsp;<span class="builtintype" id="3415961">int</span><span class="op" id="3415964">(</span><span class="ident" id="3415965">d</span><span class="op" id="3415966">[</span><span class="num" id="3415967">1</span><span class="op" id="3415968">]</span><span class="op" id="3415969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415974">if</span>&nbsp;<span class="ident" id="3415977">l</span>&nbsp;<span class="op" id="3415979">!=</span>&nbsp;<span class="builtinfunc" id="3415982">len</span><span class="op" id="3415985">(</span><span class="ident" id="3415986">d</span><span class="op" id="3415987">)</span><span class="op" id="3415988">-</span><span class="num" id="3415989">2</span>&nbsp;<span class="op" id="3415991">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415997">return</span>&nbsp;<span class="builtintype" id="3416004">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3416013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416018">d</span>&nbsp;<span class="op" id="3416020">=</span>&nbsp;<span class="ident" id="3416022">d</span><span class="op" id="3416023">[</span><span class="num" id="3416024">2</span><span class="op" id="3416025">:</span><span class="op" id="3416026">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416031">l</span>&nbsp;<span class="op" id="3416033">=</span>&nbsp;<span class="builtintype" id="3416035">int</span><span class="op" id="3416038">(</span><span class="ident" id="3416039">d</span><span class="op" id="3416040">[</span><span class="num" id="3416041">0</span><span class="op" id="3416042">]</span><span class="op" id="3416043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416048">if</span>&nbsp;<span class="ident" id="3416051">l</span>&nbsp;<span class="op" id="3416053">!=</span>&nbsp;<span class="builtinfunc" id="3416056">len</span><span class="op" id="3416059">(</span><span class="ident" id="3416060">d</span><span class="op" id="3416061">)</span><span class="op" id="3416062">-</span><span class="num" id="3416063">1</span>&nbsp;<span class="op" id="3416065">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416071">return</span>&nbsp;<span class="builtintype" id="3416078">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3416087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416092">d</span>&nbsp;<span class="op" id="3416094">=</span>&nbsp;<span class="ident" id="3416096">d</span><span class="op" id="3416097">[</span><span class="num" id="3416098">1</span><span class="op" id="3416099">:</span><span class="op" id="3416100">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416105">m</span><span class="op" id="3416106">.</span><span class="ident" id="3416107">alpnProtocol</span>&nbsp;<span class="op" id="3416120">=</span>&nbsp;<span class="builtintype" id="3416122">string</span><span class="op" id="3416128">(</span><span class="ident" id="3416129">d</span><span class="op" id="3416130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3416134">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416138">data</span>&nbsp;<span class="op" id="3416143">=</span>&nbsp;<span class="ident" id="3416145">data</span><span class="op" id="3416149">[</span><span class="ident" id="3416150">length</span><span class="op" id="3416156">:</span><span class="op" id="3416157">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3416160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416164">return</span>&nbsp;<span class="builtintype" id="3416171">true</span><br>
<span class="lineno"></span><span class="op" id="3416176">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="3416179">type</span>&nbsp;<span class="ident" id="3416184">certificateMsg</span>&nbsp;<span class="keyword" id="3416199">struct</span>&nbsp;<span class="op" id="3416206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416209">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3416222">[</span><span class="op" id="3416223">]</span><span class="builtintype" id="3416224">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416230">certificates</span>&nbsp;<span class="op" id="3416243">[</span><span class="op" id="3416244">]</span><span class="op" id="3416245">[</span><span class="op" id="3416246">]</span><span class="builtintype" id="3416247">byte</span><br>
<span class="lineno"></span><span class="op" id="3416252">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="3416255">func</span>&nbsp;<span class="op" id="3416260">(</span><span class="ident" id="3416261">m</span>&nbsp;<span class="op" id="3416263">*</span><span class="ident" id="3416264">certificateMsg</span><span class="op" id="3416278">)</span>&nbsp;<span class="ident" id="3416280">equal</span><span class="op" id="3416285">(</span><span class="ident" id="3416286">i</span>&nbsp;<span class="keyword" id="3416288">interface</span><span class="op" id="3416297">{</span><span class="op" id="3416298">}</span><span class="op" id="3416299">)</span>&nbsp;<span class="builtintype" id="3416301">bool</span>&nbsp;<span class="op" id="3416306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416309">m1</span><span class="op" id="3416311">,</span>&nbsp;<span class="ident" id="3416313">ok</span>&nbsp;<span class="op" id="3416316">:=</span>&nbsp;<span class="ident" id="3416319">i</span><span class="op" id="3416320">.</span><span class="op" id="3416321">(</span><span class="op" id="3416322">*</span><span class="ident" id="3416323">certificateMsg</span><span class="op" id="3416337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416340">if</span>&nbsp;<span class="op" id="3416343">!</span><span class="ident" id="3416344">ok</span>&nbsp;<span class="op" id="3416347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416351">return</span>&nbsp;<span class="builtintype" id="3416358">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3416365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416369">return</span>&nbsp;<span class="ident" id="3416376">bytes</span><span class="op" id="3416381">.</span><span class="ident" id="3416382">Equal</span><span class="op" id="3416387">(</span><span class="ident" id="3416388">m</span><span class="op" id="3416389">.</span><span class="ident" id="3416390">raw</span><span class="op" id="3416393">,</span>&nbsp;<span class="ident" id="3416395">m1</span><span class="op" id="3416397">.</span><span class="ident" id="3416398">raw</span><span class="op" id="3416401">)</span>&nbsp;<span class="op" id="3416403">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416408">eqByteSlices</span><span class="op" id="3416420">(</span><span class="ident" id="3416421">m</span><span class="op" id="3416422">.</span><span class="ident" id="3416423">certificates</span><span class="op" id="3416435">,</span>&nbsp;<span class="ident" id="3416437">m1</span><span class="op" id="3416439">.</span><span class="ident" id="3416440">certificates</span><span class="op" id="3416452">)</span><br>
<span class="lineno"></span><span class="op" id="3416454">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="3416457">func</span>&nbsp;<span class="op" id="3416462">(</span><span class="ident" id="3416463">m</span>&nbsp;<span class="op" id="3416465">*</span><span class="ident" id="3416466">certificateMsg</span><span class="op" id="3416480">)</span>&nbsp;<span class="ident" id="3416482">marshal</span><span class="op" id="3416489">(</span><span class="op" id="3416490">)</span>&nbsp;<span class="op" id="3416492">(</span><span class="ident" id="3416493">x</span>&nbsp;<span class="op" id="3416495">[</span><span class="op" id="3416496">]</span><span class="builtintype" id="3416497">byte</span><span class="op" id="3416501">)</span>&nbsp;<span class="op" id="3416503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416506">if</span>&nbsp;<span class="ident" id="3416509">m</span><span class="op" id="3416510">.</span><span class="ident" id="3416511">raw</span>&nbsp;<span class="op" id="3416515">!=</span>&nbsp;<span class="ident" id="3416518">nil</span>&nbsp;<span class="op" id="3416522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416526">return</span>&nbsp;<span class="ident" id="3416533">m</span><span class="op" id="3416534">.</span><span class="ident" id="3416535">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3416540">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416544">var</span>&nbsp;<span class="ident" id="3416548">i</span>&nbsp;<span class="builtintype" id="3416550">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416555">for</span>&nbsp;<span class="ident" id="3416559">_</span><span class="op" id="3416560">,</span>&nbsp;<span class="ident" id="3416562">slice</span>&nbsp;<span class="op" id="3416568">:=</span>&nbsp;<span class="keyword" id="3416571">range</span>&nbsp;<span class="ident" id="3416577">m</span><span class="op" id="3416578">.</span><span class="ident" id="3416579">certificates</span>&nbsp;<span class="op" id="3416592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416596">i</span>&nbsp;<span class="op" id="3416598">+=</span>&nbsp;<span class="builtinfunc" id="3416601">len</span><span class="op" id="3416604">(</span><span class="ident" id="3416605">slice</span><span class="op" id="3416610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3416613">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416617">length</span>&nbsp;<span class="op" id="3416624">:=</span>&nbsp;<span class="num" id="3416627">3</span>&nbsp;<span class="op" id="3416629">+</span>&nbsp;<span class="num" id="3416631">3</span><span class="op" id="3416632">*</span><span class="builtinfunc" id="3416633">len</span><span class="op" id="3416636">(</span><span class="ident" id="3416637">m</span><span class="op" id="3416638">.</span><span class="ident" id="3416639">certificates</span><span class="op" id="3416651">)</span>&nbsp;<span class="op" id="3416653">+</span>&nbsp;<span class="ident" id="3416655">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416658">x</span>&nbsp;<span class="op" id="3416660">=</span>&nbsp;<span class="builtinfunc" id="3416662">make</span><span class="op" id="3416666">(</span><span class="op" id="3416667">[</span><span class="op" id="3416668">]</span><span class="builtintype" id="3416669">byte</span><span class="op" id="3416673">,</span>&nbsp;<span class="num" id="3416675">4</span><span class="op" id="3416676">+</span><span class="ident" id="3416677">length</span><span class="op" id="3416683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416686">x</span><span class="op" id="3416687">[</span><span class="num" id="3416688">0</span><span class="op" id="3416689">]</span>&nbsp;<span class="op" id="3416691">=</span>&nbsp;<span class="ident" id="3416693">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416710">x</span><span class="op" id="3416711">[</span><span class="num" id="3416712">1</span><span class="op" id="3416713">]</span>&nbsp;<span class="op" id="3416715">=</span>&nbsp;<span class="builtintype" id="3416717">uint8</span><span class="op" id="3416722">(</span><span class="ident" id="3416723">length</span>&nbsp;<span class="op" id="3416730">&gt;&gt;</span>&nbsp;<span class="num" id="3416733">16</span><span class="op" id="3416735">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416738">x</span><span class="op" id="3416739">[</span><span class="num" id="3416740">2</span><span class="op" id="3416741">]</span>&nbsp;<span class="op" id="3416743">=</span>&nbsp;<span class="builtintype" id="3416745">uint8</span><span class="op" id="3416750">(</span><span class="ident" id="3416751">length</span>&nbsp;<span class="op" id="3416758">&gt;&gt;</span>&nbsp;<span class="num" id="3416761">8</span><span class="op" id="3416762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416765">x</span><span class="op" id="3416766">[</span><span class="num" id="3416767">3</span><span class="op" id="3416768">]</span>&nbsp;<span class="op" id="3416770">=</span>&nbsp;<span class="builtintype" id="3416772">uint8</span><span class="op" id="3416777">(</span><span class="ident" id="3416778">length</span><span class="op" id="3416784">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416788">certificateOctets</span>&nbsp;<span class="op" id="3416806">:=</span>&nbsp;<span class="ident" id="3416809">length</span>&nbsp;<span class="op" id="3416816">-</span>&nbsp;<span class="num" id="3416818">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416821">x</span><span class="op" id="3416822">[</span><span class="num" id="3416823">4</span><span class="op" id="3416824">]</span>&nbsp;<span class="op" id="3416826">=</span>&nbsp;<span class="builtintype" id="3416828">uint8</span><span class="op" id="3416833">(</span><span class="ident" id="3416834">certificateOctets</span>&nbsp;<span class="op" id="3416852">&gt;&gt;</span>&nbsp;<span class="num" id="3416855">16</span><span class="op" id="3416857">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416860">x</span><span class="op" id="3416861">[</span><span class="num" id="3416862">5</span><span class="op" id="3416863">]</span>&nbsp;<span class="op" id="3416865">=</span>&nbsp;<span class="builtintype" id="3416867">uint8</span><span class="op" id="3416872">(</span><span class="ident" id="3416873">certificateOctets</span>&nbsp;<span class="op" id="3416891">&gt;&gt;</span>&nbsp;<span class="num" id="3416894">8</span><span class="op" id="3416895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416898">x</span><span class="op" id="3416899">[</span><span class="num" id="3416900">6</span><span class="op" id="3416901">]</span>&nbsp;<span class="op" id="3416903">=</span>&nbsp;<span class="builtintype" id="3416905">uint8</span><span class="op" id="3416910">(</span><span class="ident" id="3416911">certificateOctets</span><span class="op" id="3416928">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416932">y</span>&nbsp;<span class="op" id="3416934">:=</span>&nbsp;<span class="ident" id="3416937">x</span><span class="op" id="3416938">[</span><span class="num" id="3416939">7</span><span class="op" id="3416940">:</span><span class="op" id="3416941">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416944">for</span>&nbsp;<span class="ident" id="3416948">_</span><span class="op" id="3416949">,</span>&nbsp;<span class="ident" id="3416951">slice</span>&nbsp;<span class="op" id="3416957">:=</span>&nbsp;<span class="keyword" id="3416960">range</span>&nbsp;<span class="ident" id="3416966">m</span><span class="op" id="3416967">.</span><span class="ident" id="3416968">certificates</span>&nbsp;<span class="op" id="3416981">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416985">y</span><span class="op" id="3416986">[</span><span class="num" id="3416987">0</span><span class="op" id="3416988">]</span>&nbsp;<span class="op" id="3416990">=</span>&nbsp;<span class="builtintype" id="3416992">uint8</span><span class="op" id="3416997">(</span><span class="builtinfunc" id="3416998">len</span><span class="op" id="3417001">(</span><span class="ident" id="3417002">slice</span><span class="op" id="3417007">)</span>&nbsp;<span class="op" id="3417009">&gt;&gt;</span>&nbsp;<span class="num" id="3417012">16</span><span class="op" id="3417014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417018">y</span><span class="op" id="3417019">[</span><span class="num" id="3417020">1</span><span class="op" id="3417021">]</span>&nbsp;<span class="op" id="3417023">=</span>&nbsp;<span class="builtintype" id="3417025">uint8</span><span class="op" id="3417030">(</span><span class="builtinfunc" id="3417031">len</span><span class="op" id="3417034">(</span><span class="ident" id="3417035">slice</span><span class="op" id="3417040">)</span>&nbsp;<span class="op" id="3417042">&gt;&gt;</span>&nbsp;<span class="num" id="3417045">8</span><span class="op" id="3417046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417050">y</span><span class="op" id="3417051">[</span><span class="num" id="3417052">2</span><span class="op" id="3417053">]</span>&nbsp;<span class="op" id="3417055">=</span>&nbsp;<span class="builtintype" id="3417057">uint8</span><span class="op" id="3417062">(</span><span class="builtinfunc" id="3417063">len</span><span class="op" id="3417066">(</span><span class="ident" id="3417067">slice</span><span class="op" id="3417072">)</span><span class="op" id="3417073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3417077">copy</span><span class="op" id="3417081">(</span><span class="ident" id="3417082">y</span><span class="op" id="3417083">[</span><span class="num" id="3417084">3</span><span class="op" id="3417085">:</span><span class="op" id="3417086">]</span><span class="op" id="3417087">,</span>&nbsp;<span class="ident" id="3417089">slice</span><span class="op" id="3417094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417098">y</span>&nbsp;<span class="op" id="3417100">=</span>&nbsp;<span class="ident" id="3417102">y</span><span class="op" id="3417103">[</span><span class="num" id="3417104">3</span><span class="op" id="3417105">+</span><span class="builtinfunc" id="3417106">len</span><span class="op" id="3417109">(</span><span class="ident" id="3417110">slice</span><span class="op" id="3417115">)</span><span class="op" id="3417116">:</span><span class="op" id="3417117">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417124">m</span><span class="op" id="3417125">.</span><span class="ident" id="3417126">raw</span>&nbsp;<span class="op" id="3417130">=</span>&nbsp;<span class="ident" id="3417132">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417135">return</span><br>
<span class="lineno"></span><span class="op" id="3417142">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="3417145">func</span>&nbsp;<span class="op" id="3417150">(</span><span class="ident" id="3417151">m</span>&nbsp;<span class="op" id="3417153">*</span><span class="ident" id="3417154">certificateMsg</span><span class="op" id="3417168">)</span>&nbsp;<span class="ident" id="3417170">unmarshal</span><span class="op" id="3417179">(</span><span class="ident" id="3417180">data</span>&nbsp;<span class="op" id="3417185">[</span><span class="op" id="3417186">]</span><span class="builtintype" id="3417187">byte</span><span class="op" id="3417191">)</span>&nbsp;<span class="builtintype" id="3417193">bool</span>&nbsp;<span class="op" id="3417198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417201">if</span>&nbsp;<span class="builtinfunc" id="3417204">len</span><span class="op" id="3417207">(</span><span class="ident" id="3417208">data</span><span class="op" id="3417212">)</span>&nbsp;<span class="op" id="3417214">&lt;</span>&nbsp;<span class="num" id="3417216">7</span>&nbsp;<span class="op" id="3417218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417222">return</span>&nbsp;<span class="builtintype" id="3417229">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417236">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417240">m</span><span class="op" id="3417241">.</span><span class="ident" id="3417242">raw</span>&nbsp;<span class="op" id="3417246">=</span>&nbsp;<span class="ident" id="3417248">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417254">certsLen</span>&nbsp;<span class="op" id="3417263">:=</span>&nbsp;<span class="builtintype" id="3417266">uint32</span><span class="op" id="3417272">(</span><span class="ident" id="3417273">data</span><span class="op" id="3417277">[</span><span class="num" id="3417278">4</span><span class="op" id="3417279">]</span><span class="op" id="3417280">)</span><span class="op" id="3417281">&lt;&lt;</span><span class="num" id="3417283">16</span>&nbsp;<span class="op" id="3417286">|</span>&nbsp;<span class="builtintype" id="3417288">uint32</span><span class="op" id="3417294">(</span><span class="ident" id="3417295">data</span><span class="op" id="3417299">[</span><span class="num" id="3417300">5</span><span class="op" id="3417301">]</span><span class="op" id="3417302">)</span><span class="op" id="3417303">&lt;&lt;</span><span class="num" id="3417305">8</span>&nbsp;<span class="op" id="3417307">|</span>&nbsp;<span class="builtintype" id="3417309">uint32</span><span class="op" id="3417315">(</span><span class="ident" id="3417316">data</span><span class="op" id="3417320">[</span><span class="num" id="3417321">6</span><span class="op" id="3417322">]</span><span class="op" id="3417323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417326">if</span>&nbsp;<span class="builtintype" id="3417329">uint32</span><span class="op" id="3417335">(</span><span class="builtinfunc" id="3417336">len</span><span class="op" id="3417339">(</span><span class="ident" id="3417340">data</span><span class="op" id="3417344">)</span><span class="op" id="3417345">)</span>&nbsp;<span class="op" id="3417347">!=</span>&nbsp;<span class="ident" id="3417350">certsLen</span><span class="op" id="3417358">+</span><span class="num" id="3417359">7</span>&nbsp;<span class="op" id="3417361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417365">return</span>&nbsp;<span class="builtintype" id="3417372">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417383">numCerts</span>&nbsp;<span class="op" id="3417392">:=</span>&nbsp;<span class="num" id="3417395">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417398">d</span>&nbsp;<span class="op" id="3417400">:=</span>&nbsp;<span class="ident" id="3417403">data</span><span class="op" id="3417407">[</span><span class="num" id="3417408">7</span><span class="op" id="3417409">:</span><span class="op" id="3417410">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417413">for</span>&nbsp;<span class="ident" id="3417417">certsLen</span>&nbsp;<span class="op" id="3417426">&gt;</span>&nbsp;<span class="num" id="3417428">0</span>&nbsp;<span class="op" id="3417430">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417434">if</span>&nbsp;<span class="builtinfunc" id="3417437">len</span><span class="op" id="3417440">(</span><span class="ident" id="3417441">d</span><span class="op" id="3417442">)</span>&nbsp;<span class="op" id="3417444">&lt;</span>&nbsp;<span class="num" id="3417446">4</span>&nbsp;<span class="op" id="3417448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417453">return</span>&nbsp;<span class="builtintype" id="3417460">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417472">certLen</span>&nbsp;<span class="op" id="3417480">:=</span>&nbsp;<span class="builtintype" id="3417483">uint32</span><span class="op" id="3417489">(</span><span class="ident" id="3417490">d</span><span class="op" id="3417491">[</span><span class="num" id="3417492">0</span><span class="op" id="3417493">]</span><span class="op" id="3417494">)</span><span class="op" id="3417495">&lt;&lt;</span><span class="num" id="3417497">16</span>&nbsp;<span class="op" id="3417500">|</span>&nbsp;<span class="builtintype" id="3417502">uint32</span><span class="op" id="3417508">(</span><span class="ident" id="3417509">d</span><span class="op" id="3417510">[</span><span class="num" id="3417511">1</span><span class="op" id="3417512">]</span><span class="op" id="3417513">)</span><span class="op" id="3417514">&lt;&lt;</span><span class="num" id="3417516">8</span>&nbsp;<span class="op" id="3417518">|</span>&nbsp;<span class="builtintype" id="3417520">uint32</span><span class="op" id="3417526">(</span><span class="ident" id="3417527">d</span><span class="op" id="3417528">[</span><span class="num" id="3417529">2</span><span class="op" id="3417530">]</span><span class="op" id="3417531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417535">if</span>&nbsp;<span class="builtintype" id="3417538">uint32</span><span class="op" id="3417544">(</span><span class="builtinfunc" id="3417545">len</span><span class="op" id="3417548">(</span><span class="ident" id="3417549">d</span><span class="op" id="3417550">)</span><span class="op" id="3417551">)</span>&nbsp;<span class="op" id="3417553">&lt;</span>&nbsp;<span class="num" id="3417555">3</span><span class="op" id="3417556">+</span><span class="ident" id="3417557">certLen</span>&nbsp;<span class="op" id="3417565">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417570">return</span>&nbsp;<span class="builtintype" id="3417577">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417589">d</span>&nbsp;<span class="op" id="3417591">=</span>&nbsp;<span class="ident" id="3417593">d</span><span class="op" id="3417594">[</span><span class="num" id="3417595">3</span><span class="op" id="3417596">+</span><span class="ident" id="3417597">certLen</span><span class="op" id="3417604">:</span><span class="op" id="3417605">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417609">certsLen</span>&nbsp;<span class="op" id="3417618">-=</span>&nbsp;<span class="num" id="3417621">3</span>&nbsp;<span class="op" id="3417623">+</span>&nbsp;<span class="ident" id="3417625">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417635">numCerts</span><span class="op" id="3417643">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417651">m</span><span class="op" id="3417652">.</span><span class="ident" id="3417653">certificates</span>&nbsp;<span class="op" id="3417666">=</span>&nbsp;<span class="builtinfunc" id="3417668">make</span><span class="op" id="3417672">(</span><span class="op" id="3417673">[</span><span class="op" id="3417674">]</span><span class="op" id="3417675">[</span><span class="op" id="3417676">]</span><span class="builtintype" id="3417677">byte</span><span class="op" id="3417681">,</span>&nbsp;<span class="ident" id="3417683">numCerts</span><span class="op" id="3417691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417694">d</span>&nbsp;<span class="op" id="3417696">=</span>&nbsp;<span class="ident" id="3417698">data</span><span class="op" id="3417702">[</span><span class="num" id="3417703">7</span><span class="op" id="3417704">:</span><span class="op" id="3417705">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417708">for</span>&nbsp;<span class="ident" id="3417712">i</span>&nbsp;<span class="op" id="3417714">:=</span>&nbsp;<span class="num" id="3417717">0</span><span class="op" id="3417718">;</span>&nbsp;<span class="ident" id="3417720">i</span>&nbsp;<span class="op" id="3417722">&lt;</span>&nbsp;<span class="ident" id="3417724">numCerts</span><span class="op" id="3417732">;</span>&nbsp;<span class="ident" id="3417734">i</span><span class="op" id="3417735">++</span>&nbsp;<span class="op" id="3417738">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417742">certLen</span>&nbsp;<span class="op" id="3417750">:=</span>&nbsp;<span class="builtintype" id="3417753">uint32</span><span class="op" id="3417759">(</span><span class="ident" id="3417760">d</span><span class="op" id="3417761">[</span><span class="num" id="3417762">0</span><span class="op" id="3417763">]</span><span class="op" id="3417764">)</span><span class="op" id="3417765">&lt;&lt;</span><span class="num" id="3417767">16</span>&nbsp;<span class="op" id="3417770">|</span>&nbsp;<span class="builtintype" id="3417772">uint32</span><span class="op" id="3417778">(</span><span class="ident" id="3417779">d</span><span class="op" id="3417780">[</span><span class="num" id="3417781">1</span><span class="op" id="3417782">]</span><span class="op" id="3417783">)</span><span class="op" id="3417784">&lt;&lt;</span><span class="num" id="3417786">8</span>&nbsp;<span class="op" id="3417788">|</span>&nbsp;<span class="builtintype" id="3417790">uint32</span><span class="op" id="3417796">(</span><span class="ident" id="3417797">d</span><span class="op" id="3417798">[</span><span class="num" id="3417799">2</span><span class="op" id="3417800">]</span><span class="op" id="3417801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417805">m</span><span class="op" id="3417806">.</span><span class="ident" id="3417807">certificates</span><span class="op" id="3417819">[</span><span class="ident" id="3417820">i</span><span class="op" id="3417821">]</span>&nbsp;<span class="op" id="3417823">=</span>&nbsp;<span class="ident" id="3417825">d</span><span class="op" id="3417826">[</span><span class="num" id="3417827">3</span>&nbsp;<span class="op" id="3417829">:</span>&nbsp;<span class="num" id="3417831">3</span><span class="op" id="3417832">+</span><span class="ident" id="3417833">certLen</span><span class="op" id="3417840">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417844">d</span>&nbsp;<span class="op" id="3417846">=</span>&nbsp;<span class="ident" id="3417848">d</span><span class="op" id="3417849">[</span><span class="num" id="3417850">3</span><span class="op" id="3417851">+</span><span class="ident" id="3417852">certLen</span><span class="op" id="3417859">:</span><span class="op" id="3417860">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417867">return</span>&nbsp;<span class="builtintype" id="3417874">true</span><br>
<span class="lineno"></span><span class="op" id="3417879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3417882">type</span>&nbsp;<span class="ident" id="3417887">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3417908">struct</span>&nbsp;<span class="op" id="3417915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417918">raw</span>&nbsp;<span class="op" id="3417922">[</span><span class="op" id="3417923">]</span><span class="builtintype" id="3417924">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417930">key</span>&nbsp;<span class="op" id="3417934">[</span><span class="op" id="3417935">]</span><span class="builtintype" id="3417936">byte</span><br>
<span class="lineno"></span><span class="op" id="3417941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3417944">func</span>&nbsp;<span class="op" id="3417949">(</span><span class="ident" id="3417950">m</span>&nbsp;<span class="op" id="3417952">*</span><span class="ident" id="3417953">serverKeyExchangeMsg</span><span class="op" id="3417973">)</span>&nbsp;<span class="ident" id="3417975">equal</span><span class="op" id="3417980">(</span><span class="ident" id="3417981">i</span>&nbsp;<span class="keyword" id="3417983">interface</span><span class="op" id="3417992">{</span><span class="op" id="3417993">}</span><span class="op" id="3417994">)</span>&nbsp;<span class="builtintype" id="3417996">bool</span>&nbsp;<span class="op" id="3418001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418004">m1</span><span class="op" id="3418006">,</span>&nbsp;<span class="ident" id="3418008">ok</span>&nbsp;<span class="op" id="3418011">:=</span>&nbsp;<span class="ident" id="3418014">i</span><span class="op" id="3418015">.</span><span class="op" id="3418016">(</span><span class="op" id="3418017">*</span><span class="ident" id="3418018">serverKeyExchangeMsg</span><span class="op" id="3418038">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418041">if</span>&nbsp;<span class="op" id="3418044">!</span><span class="ident" id="3418045">ok</span>&nbsp;<span class="op" id="3418048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418052">return</span>&nbsp;<span class="builtintype" id="3418059">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3418066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418070">return</span>&nbsp;<span class="ident" id="3418077">bytes</span><span class="op" id="3418082">.</span><span class="ident" id="3418083">Equal</span><span class="op" id="3418088">(</span><span class="ident" id="3418089">m</span><span class="op" id="3418090">.</span><span class="ident" id="3418091">raw</span><span class="op" id="3418094">,</span>&nbsp;<span class="ident" id="3418096">m1</span><span class="op" id="3418098">.</span><span class="ident" id="3418099">raw</span><span class="op" id="3418102">)</span>&nbsp;<span class="op" id="3418104">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418109">bytes</span><span class="op" id="3418114">.</span><span class="ident" id="3418115">Equal</span><span class="op" id="3418120">(</span><span class="ident" id="3418121">m</span><span class="op" id="3418122">.</span><span class="ident" id="3418123">key</span><span class="op" id="3418126">,</span>&nbsp;<span class="ident" id="3418128">m1</span><span class="op" id="3418130">.</span><span class="ident" id="3418131">key</span><span class="op" id="3418134">)</span><br>
<span class="lineno"></span><span class="op" id="3418136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3418139">func</span>&nbsp;<span class="op" id="3418144">(</span><span class="ident" id="3418145">m</span>&nbsp;<span class="op" id="3418147">*</span><span class="ident" id="3418148">serverKeyExchangeMsg</span><span class="op" id="3418168">)</span>&nbsp;<span class="ident" id="3418170">marshal</span><span class="op" id="3418177">(</span><span class="op" id="3418178">)</span>&nbsp;<span class="op" id="3418180">[</span><span class="op" id="3418181">]</span><span class="builtintype" id="3418182">byte</span>&nbsp;<span class="op" id="3418187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418190">if</span>&nbsp;<span class="ident" id="3418193">m</span><span class="op" id="3418194">.</span><span class="ident" id="3418195">raw</span>&nbsp;<span class="op" id="3418199">!=</span>&nbsp;<span class="ident" id="3418202">nil</span>&nbsp;<span class="op" id="3418206">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418210">return</span>&nbsp;<span class="ident" id="3418217">m</span><span class="op" id="3418218">.</span><span class="ident" id="3418219">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3418224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418227">length</span>&nbsp;<span class="op" id="3418234">:=</span>&nbsp;<span class="builtinfunc" id="3418237">len</span><span class="op" id="3418240">(</span><span class="ident" id="3418241">m</span><span class="op" id="3418242">.</span><span class="ident" id="3418243">key</span><span class="op" id="3418246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418249">x</span>&nbsp;<span class="op" id="3418251">:=</span>&nbsp;<span class="builtinfunc" id="3418254">make</span><span class="op" id="3418258">(</span><span class="op" id="3418259">[</span><span class="op" id="3418260">]</span><span class="builtintype" id="3418261">byte</span><span class="op" id="3418265">,</span>&nbsp;<span class="ident" id="3418267">length</span><span class="op" id="3418273">+</span><span class="num" id="3418274">4</span><span class="op" id="3418275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418278">x</span><span class="op" id="3418279">[</span><span class="num" id="3418280">0</span><span class="op" id="3418281">]</span>&nbsp;<span class="op" id="3418283">=</span>&nbsp;<span class="ident" id="3418285">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418308">x</span><span class="op" id="3418309">[</span><span class="num" id="3418310">1</span><span class="op" id="3418311">]</span>&nbsp;<span class="op" id="3418313">=</span>&nbsp;<span class="builtintype" id="3418315">uint8</span><span class="op" id="3418320">(</span><span class="ident" id="3418321">length</span>&nbsp;<span class="op" id="3418328">&gt;&gt;</span>&nbsp;<span class="num" id="3418331">16</span><span class="op" id="3418333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418336">x</span><span class="op" id="3418337">[</span><span class="num" id="3418338">2</span><span class="op" id="3418339">]</span>&nbsp;<span class="op" id="3418341">=</span>&nbsp;<span class="builtintype" id="3418343">uint8</span><span class="op" id="3418348">(</span><span class="ident" id="3418349">length</span>&nbsp;<span class="op" id="3418356">&gt;&gt;</span>&nbsp;<span class="num" id="3418359">8</span><span class="op" id="3418360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418363">x</span><span class="op" id="3418364">[</span><span class="num" id="3418365">3</span><span class="op" id="3418366">]</span>&nbsp;<span class="op" id="3418368">=</span>&nbsp;<span class="builtintype" id="3418370">uint8</span><span class="op" id="3418375">(</span><span class="ident" id="3418376">length</span><span class="op" id="3418382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3418385">copy</span><span class="op" id="3418389">(</span><span class="ident" id="3418390">x</span><span class="op" id="3418391">[</span><span class="num" id="3418392">4</span><span class="op" id="3418393">:</span><span class="op" id="3418394">]</span><span class="op" id="3418395">,</span>&nbsp;<span class="ident" id="3418397">m</span><span class="op" id="3418398">.</span><span class="ident" id="3418399">key</span><span class="op" id="3418402">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418406">m</span><span class="op" id="3418407">.</span><span class="ident" id="3418408">raw</span>&nbsp;<span class="op" id="3418412">=</span>&nbsp;<span class="ident" id="3418414">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418417">return</span>&nbsp;<span class="ident" id="3418424">x</span><br>
<span class="lineno"></span><span class="op" id="3418426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3418429">func</span>&nbsp;<span class="op" id="3418434">(</span><span class="ident" id="3418435">m</span>&nbsp;<span class="op" id="3418437">*</span><span class="ident" id="3418438">serverKeyExchangeMsg</span><span class="op" id="3418458">)</span>&nbsp;<span class="ident" id="3418460">unmarshal</span><span class="op" id="3418469">(</span><span class="ident" id="3418470">data</span>&nbsp;<span class="op" id="3418475">[</span><span class="op" id="3418476">]</span><span class="builtintype" id="3418477">byte</span><span class="op" id="3418481">)</span>&nbsp;<span class="builtintype" id="3418483">bool</span>&nbsp;<span class="op" id="3418488">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418491">m</span><span class="op" id="3418492">.</span><span class="ident" id="3418493">raw</span>&nbsp;<span class="op" id="3418497">=</span>&nbsp;<span class="ident" id="3418499">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418505">if</span>&nbsp;<span class="builtinfunc" id="3418508">len</span><span class="op" id="3418511">(</span><span class="ident" id="3418512">data</span><span class="op" id="3418516">)</span>&nbsp;<span class="op" id="3418518">&lt;</span>&nbsp;<span class="num" id="3418520">4</span>&nbsp;<span class="op" id="3418522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418526">return</span>&nbsp;<span class="builtintype" id="3418533">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3418540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418543">m</span><span class="op" id="3418544">.</span><span class="ident" id="3418545">key</span>&nbsp;<span class="op" id="3418549">=</span>&nbsp;<span class="ident" id="3418551">data</span><span class="op" id="3418555">[</span><span class="num" id="3418556">4</span><span class="op" id="3418557">:</span><span class="op" id="3418558">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418561">return</span>&nbsp;<span class="builtintype" id="3418568">true</span><br>
<span class="lineno"></span><span class="op" id="3418573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3418576">type</span>&nbsp;<span class="ident" id="3418581">certificateStatusMsg</span>&nbsp;<span class="keyword" id="3418602">struct</span>&nbsp;<span class="op" id="3418609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418612">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3418623">[</span><span class="op" id="3418624">]</span><span class="builtintype" id="3418625">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418631">statusType</span>&nbsp;<span class="builtintype" id="3418642">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418649">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3418660">[</span><span class="op" id="3418661">]</span><span class="builtintype" id="3418662">byte</span><br>
<span class="lineno"></span><span class="op" id="3418667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3418670">func</span>&nbsp;<span class="op" id="3418675">(</span><span class="ident" id="3418676">m</span>&nbsp;<span class="op" id="3418678">*</span><span class="ident" id="3418679">certificateStatusMsg</span><span class="op" id="3418699">)</span>&nbsp;<span class="ident" id="3418701">equal</span><span class="op" id="3418706">(</span><span class="ident" id="3418707">i</span>&nbsp;<span class="keyword" id="3418709">interface</span><span class="op" id="3418718">{</span><span class="op" id="3418719">}</span><span class="op" id="3418720">)</span>&nbsp;<span class="builtintype" id="3418722">bool</span>&nbsp;<span class="op" id="3418727">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418730">m1</span><span class="op" id="3418732">,</span>&nbsp;<span class="ident" id="3418734">ok</span>&nbsp;<span class="op" id="3418737">:=</span>&nbsp;<span class="ident" id="3418740">i</span><span class="op" id="3418741">.</span><span class="op" id="3418742">(</span><span class="op" id="3418743">*</span><span class="ident" id="3418744">certificateStatusMsg</span><span class="op" id="3418764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418767">if</span>&nbsp;<span class="op" id="3418770">!</span><span class="ident" id="3418771">ok</span>&nbsp;<span class="op" id="3418774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418778">return</span>&nbsp;<span class="builtintype" id="3418785">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3418792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418796">return</span>&nbsp;<span class="ident" id="3418803">bytes</span><span class="op" id="3418808">.</span><span class="ident" id="3418809">Equal</span><span class="op" id="3418814">(</span><span class="ident" id="3418815">m</span><span class="op" id="3418816">.</span><span class="ident" id="3418817">raw</span><span class="op" id="3418820">,</span>&nbsp;<span class="ident" id="3418822">m1</span><span class="op" id="3418824">.</span><span class="ident" id="3418825">raw</span><span class="op" id="3418828">)</span>&nbsp;<span class="op" id="3418830">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418835">m</span><span class="op" id="3418836">.</span><span class="ident" id="3418837">statusType</span>&nbsp;<span class="op" id="3418848">==</span>&nbsp;<span class="ident" id="3418851">m1</span><span class="op" id="3418853">.</span><span class="ident" id="3418854">statusType</span>&nbsp;<span class="op" id="3418865">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418870">bytes</span><span class="op" id="3418875">.</span><span class="ident" id="3418876">Equal</span><span class="op" id="3418881">(</span><span class="ident" id="3418882">m</span><span class="op" id="3418883">.</span><span class="ident" id="3418884">response</span><span class="op" id="3418892">,</span>&nbsp;<span class="ident" id="3418894">m1</span><span class="op" id="3418896">.</span><span class="ident" id="3418897">response</span><span class="op" id="3418905">)</span><br>
<span class="lineno"></span><span class="op" id="3418907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3418910">func</span>&nbsp;<span class="op" id="3418915">(</span><span class="ident" id="3418916">m</span>&nbsp;<span class="op" id="3418918">*</span><span class="ident" id="3418919">certificateStatusMsg</span><span class="op" id="3418939">)</span>&nbsp;<span class="ident" id="3418941">marshal</span><span class="op" id="3418948">(</span><span class="op" id="3418949">)</span>&nbsp;<span class="op" id="3418951">[</span><span class="op" id="3418952">]</span><span class="builtintype" id="3418953">byte</span>&nbsp;<span class="op" id="3418958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418961">if</span>&nbsp;<span class="ident" id="3418964">m</span><span class="op" id="3418965">.</span><span class="ident" id="3418966">raw</span>&nbsp;<span class="op" id="3418970">!=</span>&nbsp;<span class="ident" id="3418973">nil</span>&nbsp;<span class="op" id="3418977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418981">return</span>&nbsp;<span class="ident" id="3418988">m</span><span class="op" id="3418989">.</span><span class="ident" id="3418990">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3418995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418999">var</span>&nbsp;<span class="ident" id="3419003">x</span>&nbsp;<span class="op" id="3419005">[</span><span class="op" id="3419006">]</span><span class="builtintype" id="3419007">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419013">if</span>&nbsp;<span class="ident" id="3419016">m</span><span class="op" id="3419017">.</span><span class="ident" id="3419018">statusType</span>&nbsp;<span class="op" id="3419029">==</span>&nbsp;<span class="ident" id="3419032">statusTypeOCSP</span>&nbsp;<span class="op" id="3419047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419051">x</span>&nbsp;<span class="op" id="3419053">=</span>&nbsp;<span class="builtinfunc" id="3419055">make</span><span class="op" id="3419059">(</span><span class="op" id="3419060">[</span><span class="op" id="3419061">]</span><span class="builtintype" id="3419062">byte</span><span class="op" id="3419066">,</span>&nbsp;<span class="num" id="3419068">4</span><span class="op" id="3419069">+</span><span class="num" id="3419070">4</span><span class="op" id="3419071">+</span><span class="builtinfunc" id="3419072">len</span><span class="op" id="3419075">(</span><span class="ident" id="3419076">m</span><span class="op" id="3419077">.</span><span class="ident" id="3419078">response</span><span class="op" id="3419086">)</span><span class="op" id="3419087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419091">x</span><span class="op" id="3419092">[</span><span class="num" id="3419093">0</span><span class="op" id="3419094">]</span>&nbsp;<span class="op" id="3419096">=</span>&nbsp;<span class="ident" id="3419098">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419122">l</span>&nbsp;<span class="op" id="3419124">:=</span>&nbsp;<span class="builtinfunc" id="3419127">len</span><span class="op" id="3419130">(</span><span class="ident" id="3419131">m</span><span class="op" id="3419132">.</span><span class="ident" id="3419133">response</span><span class="op" id="3419141">)</span>&nbsp;<span class="op" id="3419143">+</span>&nbsp;<span class="num" id="3419145">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419149">x</span><span class="op" id="3419150">[</span><span class="num" id="3419151">1</span><span class="op" id="3419152">]</span>&nbsp;<span class="op" id="3419154">=</span>&nbsp;<span class="builtintype" id="3419156">byte</span><span class="op" id="3419160">(</span><span class="ident" id="3419161">l</span>&nbsp;<span class="op" id="3419163">&gt;&gt;</span>&nbsp;<span class="num" id="3419166">16</span><span class="op" id="3419168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419172">x</span><span class="op" id="3419173">[</span><span class="num" id="3419174">2</span><span class="op" id="3419175">]</span>&nbsp;<span class="op" id="3419177">=</span>&nbsp;<span class="builtintype" id="3419179">byte</span><span class="op" id="3419183">(</span><span class="ident" id="3419184">l</span>&nbsp;<span class="op" id="3419186">&gt;&gt;</span>&nbsp;<span class="num" id="3419189">8</span><span class="op" id="3419190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419194">x</span><span class="op" id="3419195">[</span><span class="num" id="3419196">3</span><span class="op" id="3419197">]</span>&nbsp;<span class="op" id="3419199">=</span>&nbsp;<span class="builtintype" id="3419201">byte</span><span class="op" id="3419205">(</span><span class="ident" id="3419206">l</span><span class="op" id="3419207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419211">x</span><span class="op" id="3419212">[</span><span class="num" id="3419213">4</span><span class="op" id="3419214">]</span>&nbsp;<span class="op" id="3419216">=</span>&nbsp;<span class="ident" id="3419218">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419236">l</span>&nbsp;<span class="op" id="3419238">-=</span>&nbsp;<span class="num" id="3419241">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419245">x</span><span class="op" id="3419246">[</span><span class="num" id="3419247">5</span><span class="op" id="3419248">]</span>&nbsp;<span class="op" id="3419250">=</span>&nbsp;<span class="builtintype" id="3419252">byte</span><span class="op" id="3419256">(</span><span class="ident" id="3419257">l</span>&nbsp;<span class="op" id="3419259">&gt;&gt;</span>&nbsp;<span class="num" id="3419262">16</span><span class="op" id="3419264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419268">x</span><span class="op" id="3419269">[</span><span class="num" id="3419270">6</span><span class="op" id="3419271">]</span>&nbsp;<span class="op" id="3419273">=</span>&nbsp;<span class="builtintype" id="3419275">byte</span><span class="op" id="3419279">(</span><span class="ident" id="3419280">l</span>&nbsp;<span class="op" id="3419282">&gt;&gt;</span>&nbsp;<span class="num" id="3419285">8</span><span class="op" id="3419286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419290">x</span><span class="op" id="3419291">[</span><span class="num" id="3419292">7</span><span class="op" id="3419293">]</span>&nbsp;<span class="op" id="3419295">=</span>&nbsp;<span class="builtintype" id="3419297">byte</span><span class="op" id="3419301">(</span><span class="ident" id="3419302">l</span><span class="op" id="3419303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3419307">copy</span><span class="op" id="3419311">(</span><span class="ident" id="3419312">x</span><span class="op" id="3419313">[</span><span class="num" id="3419314">8</span><span class="op" id="3419315">:</span><span class="op" id="3419316">]</span><span class="op" id="3419317">,</span>&nbsp;<span class="ident" id="3419319">m</span><span class="op" id="3419320">.</span><span class="ident" id="3419321">response</span><span class="op" id="3419329">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419332">}</span>&nbsp;<span class="keyword" id="3419334">else</span>&nbsp;<span class="op" id="3419339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419343">x</span>&nbsp;<span class="op" id="3419345">=</span>&nbsp;<span class="op" id="3419347">[</span><span class="op" id="3419348">]</span><span class="builtintype" id="3419349">byte</span><span class="op" id="3419353">{</span><span class="ident" id="3419354">typeCertificateStatus</span><span class="op" id="3419375">,</span>&nbsp;<span class="num" id="3419377">0</span><span class="op" id="3419378">,</span>&nbsp;<span class="num" id="3419380">0</span><span class="op" id="3419381">,</span>&nbsp;<span class="num" id="3419383">1</span><span class="op" id="3419384">,</span>&nbsp;<span class="ident" id="3419386">m</span><span class="op" id="3419387">.</span><span class="ident" id="3419388">statusType</span><span class="op" id="3419398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419405">m</span><span class="op" id="3419406">.</span><span class="ident" id="3419407">raw</span>&nbsp;<span class="op" id="3419411">=</span>&nbsp;<span class="ident" id="3419413">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419416">return</span>&nbsp;<span class="ident" id="3419423">x</span><br>
<span class="lineno"></span><span class="op" id="3419425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3419428">func</span>&nbsp;<span class="op" id="3419433">(</span><span class="ident" id="3419434">m</span>&nbsp;<span class="op" id="3419436">*</span><span class="ident" id="3419437">certificateStatusMsg</span><span class="op" id="3419457">)</span>&nbsp;<span class="ident" id="3419459">unmarshal</span><span class="op" id="3419468">(</span><span class="ident" id="3419469">data</span>&nbsp;<span class="op" id="3419474">[</span><span class="op" id="3419475">]</span><span class="builtintype" id="3419476">byte</span><span class="op" id="3419480">)</span>&nbsp;<span class="builtintype" id="3419482">bool</span>&nbsp;<span class="op" id="3419487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419490">m</span><span class="op" id="3419491">.</span><span class="ident" id="3419492">raw</span>&nbsp;<span class="op" id="3419496">=</span>&nbsp;<span class="ident" id="3419498">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419504">if</span>&nbsp;<span class="builtinfunc" id="3419507">len</span><span class="op" id="3419510">(</span><span class="ident" id="3419511">data</span><span class="op" id="3419515">)</span>&nbsp;<span class="op" id="3419517">&lt;</span>&nbsp;<span class="num" id="3419519">5</span>&nbsp;<span class="op" id="3419521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419525">return</span>&nbsp;<span class="builtintype" id="3419532">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419542">m</span><span class="op" id="3419543">.</span><span class="ident" id="3419544">statusType</span>&nbsp;<span class="op" id="3419555">=</span>&nbsp;<span class="ident" id="3419557">data</span><span class="op" id="3419561">[</span><span class="num" id="3419562">4</span><span class="op" id="3419563">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419567">m</span><span class="op" id="3419568">.</span><span class="ident" id="3419569">response</span>&nbsp;<span class="op" id="3419578">=</span>&nbsp;<span class="ident" id="3419580">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419585">if</span>&nbsp;<span class="ident" id="3419588">m</span><span class="op" id="3419589">.</span><span class="ident" id="3419590">statusType</span>&nbsp;<span class="op" id="3419601">==</span>&nbsp;<span class="ident" id="3419604">statusTypeOCSP</span>&nbsp;<span class="op" id="3419619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419623">if</span>&nbsp;<span class="builtinfunc" id="3419626">len</span><span class="op" id="3419629">(</span><span class="ident" id="3419630">data</span><span class="op" id="3419634">)</span>&nbsp;<span class="op" id="3419636">&lt;</span>&nbsp;<span class="num" id="3419638">8</span>&nbsp;<span class="op" id="3419640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419645">return</span>&nbsp;<span class="builtintype" id="3419652">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419660">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419664">respLen</span>&nbsp;<span class="op" id="3419672">:=</span>&nbsp;<span class="builtintype" id="3419675">uint32</span><span class="op" id="3419681">(</span><span class="ident" id="3419682">data</span><span class="op" id="3419686">[</span><span class="num" id="3419687">5</span><span class="op" id="3419688">]</span><span class="op" id="3419689">)</span><span class="op" id="3419690">&lt;&lt;</span><span class="num" id="3419692">16</span>&nbsp;<span class="op" id="3419695">|</span>&nbsp;<span class="builtintype" id="3419697">uint32</span><span class="op" id="3419703">(</span><span class="ident" id="3419704">data</span><span class="op" id="3419708">[</span><span class="num" id="3419709">6</span><span class="op" id="3419710">]</span><span class="op" id="3419711">)</span><span class="op" id="3419712">&lt;&lt;</span><span class="num" id="3419714">8</span>&nbsp;<span class="op" id="3419716">|</span>&nbsp;<span class="builtintype" id="3419718">uint32</span><span class="op" id="3419724">(</span><span class="ident" id="3419725">data</span><span class="op" id="3419729">[</span><span class="num" id="3419730">7</span><span class="op" id="3419731">]</span><span class="op" id="3419732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419736">if</span>&nbsp;<span class="builtintype" id="3419739">uint32</span><span class="op" id="3419745">(</span><span class="builtinfunc" id="3419746">len</span><span class="op" id="3419749">(</span><span class="ident" id="3419750">data</span><span class="op" id="3419754">)</span><span class="op" id="3419755">)</span>&nbsp;<span class="op" id="3419757">!=</span>&nbsp;<span class="num" id="3419760">4</span><span class="op" id="3419761">+</span><span class="num" id="3419762">4</span><span class="op" id="3419763">+</span><span class="ident" id="3419764">respLen</span>&nbsp;<span class="op" id="3419772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419777">return</span>&nbsp;<span class="builtintype" id="3419784">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419796">m</span><span class="op" id="3419797">.</span><span class="ident" id="3419798">response</span>&nbsp;<span class="op" id="3419807">=</span>&nbsp;<span class="ident" id="3419809">data</span><span class="op" id="3419813">[</span><span class="num" id="3419814">8</span><span class="op" id="3419815">:</span><span class="op" id="3419816">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419822">return</span>&nbsp;<span class="builtintype" id="3419829">true</span><br>
<span class="lineno"></span><span class="op" id="3419834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3419837">type</span>&nbsp;<span class="ident" id="3419842">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="3419861">struct</span><span class="op" id="3419867">{</span><span class="op" id="3419868">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="3419871">func</span>&nbsp;<span class="op" id="3419876">(</span><span class="ident" id="3419877">m</span>&nbsp;<span class="op" id="3419879">*</span><span class="ident" id="3419880">serverHelloDoneMsg</span><span class="op" id="3419898">)</span>&nbsp;<span class="ident" id="3419900">equal</span><span class="op" id="3419905">(</span><span class="ident" id="3419906">i</span>&nbsp;<span class="keyword" id="3419908">interface</span><span class="op" id="3419917">{</span><span class="op" id="3419918">}</span><span class="op" id="3419919">)</span>&nbsp;<span class="builtintype" id="3419921">bool</span>&nbsp;<span class="op" id="3419926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419929">_</span><span class="op" id="3419930">,</span>&nbsp;<span class="ident" id="3419932">ok</span>&nbsp;<span class="op" id="3419935">:=</span>&nbsp;<span class="ident" id="3419938">i</span><span class="op" id="3419939">.</span><span class="op" id="3419940">(</span><span class="op" id="3419941">*</span><span class="ident" id="3419942">serverHelloDoneMsg</span><span class="op" id="3419960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419963">return</span>&nbsp;<span class="ident" id="3419970">ok</span><br>
<span class="lineno"></span><span class="op" id="3419973">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="3419976">func</span>&nbsp;<span class="op" id="3419981">(</span><span class="ident" id="3419982">m</span>&nbsp;<span class="op" id="3419984">*</span><span class="ident" id="3419985">serverHelloDoneMsg</span><span class="op" id="3420003">)</span>&nbsp;<span class="ident" id="3420005">marshal</span><span class="op" id="3420012">(</span><span class="op" id="3420013">)</span>&nbsp;<span class="op" id="3420015">[</span><span class="op" id="3420016">]</span><span class="builtintype" id="3420017">byte</span>&nbsp;<span class="op" id="3420022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420025">x</span>&nbsp;<span class="op" id="3420027">:=</span>&nbsp;<span class="builtinfunc" id="3420030">make</span><span class="op" id="3420034">(</span><span class="op" id="3420035">[</span><span class="op" id="3420036">]</span><span class="builtintype" id="3420037">byte</span><span class="op" id="3420041">,</span>&nbsp;<span class="num" id="3420043">4</span><span class="op" id="3420044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420047">x</span><span class="op" id="3420048">[</span><span class="num" id="3420049">0</span><span class="op" id="3420050">]</span>&nbsp;<span class="op" id="3420052">=</span>&nbsp;<span class="ident" id="3420054">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420075">return</span>&nbsp;<span class="ident" id="3420082">x</span><br>
<span class="lineno">920</span><span class="op" id="3420084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3420087">func</span>&nbsp;<span class="op" id="3420092">(</span><span class="ident" id="3420093">m</span>&nbsp;<span class="op" id="3420095">*</span><span class="ident" id="3420096">serverHelloDoneMsg</span><span class="op" id="3420114">)</span>&nbsp;<span class="ident" id="3420116">unmarshal</span><span class="op" id="3420125">(</span><span class="ident" id="3420126">data</span>&nbsp;<span class="op" id="3420131">[</span><span class="op" id="3420132">]</span><span class="builtintype" id="3420133">byte</span><span class="op" id="3420137">)</span>&nbsp;<span class="builtintype" id="3420139">bool</span>&nbsp;<span class="op" id="3420144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420147">return</span>&nbsp;<span class="builtinfunc" id="3420154">len</span><span class="op" id="3420157">(</span><span class="ident" id="3420158">data</span><span class="op" id="3420162">)</span>&nbsp;<span class="op" id="3420164">==</span>&nbsp;<span class="num" id="3420167">4</span><br>
<span class="lineno"></span><span class="op" id="3420169">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="3420172">type</span>&nbsp;<span class="ident" id="3420177">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3420198">struct</span>&nbsp;<span class="op" id="3420205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420208">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3420219">[</span><span class="op" id="3420220">]</span><span class="builtintype" id="3420221">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420227">ciphertext</span>&nbsp;<span class="op" id="3420238">[</span><span class="op" id="3420239">]</span><span class="builtintype" id="3420240">byte</span><br>
<span class="lineno"></span><span class="op" id="3420245">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="3420248">func</span>&nbsp;<span class="op" id="3420253">(</span><span class="ident" id="3420254">m</span>&nbsp;<span class="op" id="3420256">*</span><span class="ident" id="3420257">clientKeyExchangeMsg</span><span class="op" id="3420277">)</span>&nbsp;<span class="ident" id="3420279">equal</span><span class="op" id="3420284">(</span><span class="ident" id="3420285">i</span>&nbsp;<span class="keyword" id="3420287">interface</span><span class="op" id="3420296">{</span><span class="op" id="3420297">}</span><span class="op" id="3420298">)</span>&nbsp;<span class="builtintype" id="3420300">bool</span>&nbsp;<span class="op" id="3420305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420308">m1</span><span class="op" id="3420310">,</span>&nbsp;<span class="ident" id="3420312">ok</span>&nbsp;<span class="op" id="3420315">:=</span>&nbsp;<span class="ident" id="3420318">i</span><span class="op" id="3420319">.</span><span class="op" id="3420320">(</span><span class="op" id="3420321">*</span><span class="ident" id="3420322">clientKeyExchangeMsg</span><span class="op" id="3420342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420345">if</span>&nbsp;<span class="op" id="3420348">!</span><span class="ident" id="3420349">ok</span>&nbsp;<span class="op" id="3420352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420356">return</span>&nbsp;<span class="builtintype" id="3420363">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3420370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420374">return</span>&nbsp;<span class="ident" id="3420381">bytes</span><span class="op" id="3420386">.</span><span class="ident" id="3420387">Equal</span><span class="op" id="3420392">(</span><span class="ident" id="3420393">m</span><span class="op" id="3420394">.</span><span class="ident" id="3420395">raw</span><span class="op" id="3420398">,</span>&nbsp;<span class="ident" id="3420400">m1</span><span class="op" id="3420402">.</span><span class="ident" id="3420403">raw</span><span class="op" id="3420406">)</span>&nbsp;<span class="op" id="3420408">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420413">bytes</span><span class="op" id="3420418">.</span><span class="ident" id="3420419">Equal</span><span class="op" id="3420424">(</span><span class="ident" id="3420425">m</span><span class="op" id="3420426">.</span><span class="ident" id="3420427">ciphertext</span><span class="op" id="3420437">,</span>&nbsp;<span class="ident" id="3420439">m1</span><span class="op" id="3420441">.</span><span class="ident" id="3420442">ciphertext</span><span class="op" id="3420452">)</span><br>
<span class="lineno"></span><span class="op" id="3420454">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="3420457">func</span>&nbsp;<span class="op" id="3420462">(</span><span class="ident" id="3420463">m</span>&nbsp;<span class="op" id="3420465">*</span><span class="ident" id="3420466">clientKeyExchangeMsg</span><span class="op" id="3420486">)</span>&nbsp;<span class="ident" id="3420488">marshal</span><span class="op" id="3420495">(</span><span class="op" id="3420496">)</span>&nbsp;<span class="op" id="3420498">[</span><span class="op" id="3420499">]</span><span class="builtintype" id="3420500">byte</span>&nbsp;<span class="op" id="3420505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420508">if</span>&nbsp;<span class="ident" id="3420511">m</span><span class="op" id="3420512">.</span><span class="ident" id="3420513">raw</span>&nbsp;<span class="op" id="3420517">!=</span>&nbsp;<span class="ident" id="3420520">nil</span>&nbsp;<span class="op" id="3420524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420528">return</span>&nbsp;<span class="ident" id="3420535">m</span><span class="op" id="3420536">.</span><span class="ident" id="3420537">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3420542">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420545">length</span>&nbsp;<span class="op" id="3420552">:=</span>&nbsp;<span class="builtinfunc" id="3420555">len</span><span class="op" id="3420558">(</span><span class="ident" id="3420559">m</span><span class="op" id="3420560">.</span><span class="ident" id="3420561">ciphertext</span><span class="op" id="3420571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420574">x</span>&nbsp;<span class="op" id="3420576">:=</span>&nbsp;<span class="builtinfunc" id="3420579">make</span><span class="op" id="3420583">(</span><span class="op" id="3420584">[</span><span class="op" id="3420585">]</span><span class="builtintype" id="3420586">byte</span><span class="op" id="3420590">,</span>&nbsp;<span class="ident" id="3420592">length</span><span class="op" id="3420598">+</span><span class="num" id="3420599">4</span><span class="op" id="3420600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420603">x</span><span class="op" id="3420604">[</span><span class="num" id="3420605">0</span><span class="op" id="3420606">]</span>&nbsp;<span class="op" id="3420608">=</span>&nbsp;<span class="ident" id="3420610">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420633">x</span><span class="op" id="3420634">[</span><span class="num" id="3420635">1</span><span class="op" id="3420636">]</span>&nbsp;<span class="op" id="3420638">=</span>&nbsp;<span class="builtintype" id="3420640">uint8</span><span class="op" id="3420645">(</span><span class="ident" id="3420646">length</span>&nbsp;<span class="op" id="3420653">&gt;&gt;</span>&nbsp;<span class="num" id="3420656">16</span><span class="op" id="3420658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420661">x</span><span class="op" id="3420662">[</span><span class="num" id="3420663">2</span><span class="op" id="3420664">]</span>&nbsp;<span class="op" id="3420666">=</span>&nbsp;<span class="builtintype" id="3420668">uint8</span><span class="op" id="3420673">(</span><span class="ident" id="3420674">length</span>&nbsp;<span class="op" id="3420681">&gt;&gt;</span>&nbsp;<span class="num" id="3420684">8</span><span class="op" id="3420685">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420688">x</span><span class="op" id="3420689">[</span><span class="num" id="3420690">3</span><span class="op" id="3420691">]</span>&nbsp;<span class="op" id="3420693">=</span>&nbsp;<span class="builtintype" id="3420695">uint8</span><span class="op" id="3420700">(</span><span class="ident" id="3420701">length</span><span class="op" id="3420707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3420710">copy</span><span class="op" id="3420714">(</span><span class="ident" id="3420715">x</span><span class="op" id="3420716">[</span><span class="num" id="3420717">4</span><span class="op" id="3420718">:</span><span class="op" id="3420719">]</span><span class="op" id="3420720">,</span>&nbsp;<span class="ident" id="3420722">m</span><span class="op" id="3420723">.</span><span class="ident" id="3420724">ciphertext</span><span class="op" id="3420734">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420738">m</span><span class="op" id="3420739">.</span><span class="ident" id="3420740">raw</span>&nbsp;<span class="op" id="3420744">=</span>&nbsp;<span class="ident" id="3420746">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420749">return</span>&nbsp;<span class="ident" id="3420756">x</span><br>
<span class="lineno">955</span><span class="op" id="3420758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3420761">func</span>&nbsp;<span class="op" id="3420766">(</span><span class="ident" id="3420767">m</span>&nbsp;<span class="op" id="3420769">*</span><span class="ident" id="3420770">clientKeyExchangeMsg</span><span class="op" id="3420790">)</span>&nbsp;<span class="ident" id="3420792">unmarshal</span><span class="op" id="3420801">(</span><span class="ident" id="3420802">data</span>&nbsp;<span class="op" id="3420807">[</span><span class="op" id="3420808">]</span><span class="builtintype" id="3420809">byte</span><span class="op" id="3420813">)</span>&nbsp;<span class="builtintype" id="3420815">bool</span>&nbsp;<span class="op" id="3420820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420823">m</span><span class="op" id="3420824">.</span><span class="ident" id="3420825">raw</span>&nbsp;<span class="op" id="3420829">=</span>&nbsp;<span class="ident" id="3420831">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420837">if</span>&nbsp;<span class="builtinfunc" id="3420840">len</span><span class="op" id="3420843">(</span><span class="ident" id="3420844">data</span><span class="op" id="3420848">)</span>&nbsp;<span class="op" id="3420850">&lt;</span>&nbsp;<span class="num" id="3420852">4</span>&nbsp;<span class="op" id="3420854">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420858">return</span>&nbsp;<span class="builtintype" id="3420865">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3420872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420875">l</span>&nbsp;<span class="op" id="3420877">:=</span>&nbsp;<span class="builtintype" id="3420880">int</span><span class="op" id="3420883">(</span><span class="ident" id="3420884">data</span><span class="op" id="3420888">[</span><span class="num" id="3420889">1</span><span class="op" id="3420890">]</span><span class="op" id="3420891">)</span><span class="op" id="3420892">&lt;&lt;</span><span class="num" id="3420894">16</span>&nbsp;<span class="op" id="3420897">|</span>&nbsp;<span class="builtintype" id="3420899">int</span><span class="op" id="3420902">(</span><span class="ident" id="3420903">data</span><span class="op" id="3420907">[</span><span class="num" id="3420908">2</span><span class="op" id="3420909">]</span><span class="op" id="3420910">)</span><span class="op" id="3420911">&lt;&lt;</span><span class="num" id="3420913">8</span>&nbsp;<span class="op" id="3420915">|</span>&nbsp;<span class="builtintype" id="3420917">int</span><span class="op" id="3420920">(</span><span class="ident" id="3420921">data</span><span class="op" id="3420925">[</span><span class="num" id="3420926">3</span><span class="op" id="3420927">]</span><span class="op" id="3420928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420931">if</span>&nbsp;<span class="ident" id="3420934">l</span>&nbsp;<span class="op" id="3420936">!=</span>&nbsp;<span class="builtinfunc" id="3420939">len</span><span class="op" id="3420942">(</span><span class="ident" id="3420943">data</span><span class="op" id="3420947">)</span><span class="op" id="3420948">-</span><span class="num" id="3420949">4</span>&nbsp;<span class="op" id="3420951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420955">return</span>&nbsp;<span class="builtintype" id="3420962">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3420969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420972">m</span><span class="op" id="3420973">.</span><span class="ident" id="3420974">ciphertext</span>&nbsp;<span class="op" id="3420985">=</span>&nbsp;<span class="ident" id="3420987">data</span><span class="op" id="3420991">[</span><span class="num" id="3420992">4</span><span class="op" id="3420993">:</span><span class="op" id="3420994">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420997">return</span>&nbsp;<span class="builtintype" id="3421004">true</span><br>
<span class="lineno"></span><span class="op" id="3421009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="3421012">type</span>&nbsp;<span class="ident" id="3421017">finishedMsg</span>&nbsp;<span class="keyword" id="3421029">struct</span>&nbsp;<span class="op" id="3421036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421039">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3421050">[</span><span class="op" id="3421051">]</span><span class="builtintype" id="3421052">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421058">verifyData</span>&nbsp;<span class="op" id="3421069">[</span><span class="op" id="3421070">]</span><span class="builtintype" id="3421071">byte</span><br>
<span class="lineno"></span><span class="op" id="3421076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="3421079">func</span>&nbsp;<span class="op" id="3421084">(</span><span class="ident" id="3421085">m</span>&nbsp;<span class="op" id="3421087">*</span><span class="ident" id="3421088">finishedMsg</span><span class="op" id="3421099">)</span>&nbsp;<span class="ident" id="3421101">equal</span><span class="op" id="3421106">(</span><span class="ident" id="3421107">i</span>&nbsp;<span class="keyword" id="3421109">interface</span><span class="op" id="3421118">{</span><span class="op" id="3421119">}</span><span class="op" id="3421120">)</span>&nbsp;<span class="builtintype" id="3421122">bool</span>&nbsp;<span class="op" id="3421127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421130">m1</span><span class="op" id="3421132">,</span>&nbsp;<span class="ident" id="3421134">ok</span>&nbsp;<span class="op" id="3421137">:=</span>&nbsp;<span class="ident" id="3421140">i</span><span class="op" id="3421141">.</span><span class="op" id="3421142">(</span><span class="op" id="3421143">*</span><span class="ident" id="3421144">finishedMsg</span><span class="op" id="3421155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421158">if</span>&nbsp;<span class="op" id="3421161">!</span><span class="ident" id="3421162">ok</span>&nbsp;<span class="op" id="3421165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421169">return</span>&nbsp;<span class="builtintype" id="3421176">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3421183">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421187">return</span>&nbsp;<span class="ident" id="3421194">bytes</span><span class="op" id="3421199">.</span><span class="ident" id="3421200">Equal</span><span class="op" id="3421205">(</span><span class="ident" id="3421206">m</span><span class="op" id="3421207">.</span><span class="ident" id="3421208">raw</span><span class="op" id="3421211">,</span>&nbsp;<span class="ident" id="3421213">m1</span><span class="op" id="3421215">.</span><span class="ident" id="3421216">raw</span><span class="op" id="3421219">)</span>&nbsp;<span class="op" id="3421221">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421226">bytes</span><span class="op" id="3421231">.</span><span class="ident" id="3421232">Equal</span><span class="op" id="3421237">(</span><span class="ident" id="3421238">m</span><span class="op" id="3421239">.</span><span class="ident" id="3421240">verifyData</span><span class="op" id="3421250">,</span>&nbsp;<span class="ident" id="3421252">m1</span><span class="op" id="3421254">.</span><span class="ident" id="3421255">verifyData</span><span class="op" id="3421265">)</span><br>
<span class="lineno"></span><span class="op" id="3421267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="3421270">func</span>&nbsp;<span class="op" id="3421275">(</span><span class="ident" id="3421276">m</span>&nbsp;<span class="op" id="3421278">*</span><span class="ident" id="3421279">finishedMsg</span><span class="op" id="3421290">)</span>&nbsp;<span class="ident" id="3421292">marshal</span><span class="op" id="3421299">(</span><span class="op" id="3421300">)</span>&nbsp;<span class="op" id="3421302">(</span><span class="ident" id="3421303">x</span>&nbsp;<span class="op" id="3421305">[</span><span class="op" id="3421306">]</span><span class="builtintype" id="3421307">byte</span><span class="op" id="3421311">)</span>&nbsp;<span class="op" id="3421313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421316">if</span>&nbsp;<span class="ident" id="3421319">m</span><span class="op" id="3421320">.</span><span class="ident" id="3421321">raw</span>&nbsp;<span class="op" id="3421325">!=</span>&nbsp;<span class="ident" id="3421328">nil</span>&nbsp;<span class="op" id="3421332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421336">return</span>&nbsp;<span class="ident" id="3421343">m</span><span class="op" id="3421344">.</span><span class="ident" id="3421345">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3421350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421354">x</span>&nbsp;<span class="op" id="3421356">=</span>&nbsp;<span class="builtinfunc" id="3421358">make</span><span class="op" id="3421362">(</span><span class="op" id="3421363">[</span><span class="op" id="3421364">]</span><span class="builtintype" id="3421365">byte</span><span class="op" id="3421369">,</span>&nbsp;<span class="num" id="3421371">4</span><span class="op" id="3421372">+</span><span class="builtinfunc" id="3421373">len</span><span class="op" id="3421376">(</span><span class="ident" id="3421377">m</span><span class="op" id="3421378">.</span><span class="ident" id="3421379">verifyData</span><span class="op" id="3421389">)</span><span class="op" id="3421390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421393">x</span><span class="op" id="3421394">[</span><span class="num" id="3421395">0</span><span class="op" id="3421396">]</span>&nbsp;<span class="op" id="3421398">=</span>&nbsp;<span class="ident" id="3421400">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421414">x</span><span class="op" id="3421415">[</span><span class="num" id="3421416">3</span><span class="op" id="3421417">]</span>&nbsp;<span class="op" id="3421419">=</span>&nbsp;<span class="builtintype" id="3421421">byte</span><span class="op" id="3421425">(</span><span class="builtinfunc" id="3421426">len</span><span class="op" id="3421429">(</span><span class="ident" id="3421430">m</span><span class="op" id="3421431">.</span><span class="ident" id="3421432">verifyData</span><span class="op" id="3421442">)</span><span class="op" id="3421443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3421446">copy</span><span class="op" id="3421450">(</span><span class="ident" id="3421451">x</span><span class="op" id="3421452">[</span><span class="num" id="3421453">4</span><span class="op" id="3421454">:</span><span class="op" id="3421455">]</span><span class="op" id="3421456">,</span>&nbsp;<span class="ident" id="3421458">m</span><span class="op" id="3421459">.</span><span class="ident" id="3421460">verifyData</span><span class="op" id="3421470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421473">m</span><span class="op" id="3421474">.</span><span class="ident" id="3421475">raw</span>&nbsp;<span class="op" id="3421479">=</span>&nbsp;<span class="ident" id="3421481">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421484">return</span><br>
<span class="lineno"></span><span class="op" id="3421491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3421494">func</span>&nbsp;<span class="op" id="3421499">(</span><span class="ident" id="3421500">m</span>&nbsp;<span class="op" id="3421502">*</span><span class="ident" id="3421503">finishedMsg</span><span class="op" id="3421514">)</span>&nbsp;<span class="ident" id="3421516">unmarshal</span><span class="op" id="3421525">(</span><span class="ident" id="3421526">data</span>&nbsp;<span class="op" id="3421531">[</span><span class="op" id="3421532">]</span><span class="builtintype" id="3421533">byte</span><span class="op" id="3421537">)</span>&nbsp;<span class="builtintype" id="3421539">bool</span>&nbsp;<span class="op" id="3421544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421547">m</span><span class="op" id="3421548">.</span><span class="ident" id="3421549">raw</span>&nbsp;<span class="op" id="3421553">=</span>&nbsp;<span class="ident" id="3421555">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421561">if</span>&nbsp;<span class="builtinfunc" id="3421564">len</span><span class="op" id="3421567">(</span><span class="ident" id="3421568">data</span><span class="op" id="3421572">)</span>&nbsp;<span class="op" id="3421574">&lt;</span>&nbsp;<span class="num" id="3421576">4</span>&nbsp;<span class="op" id="3421578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421582">return</span>&nbsp;<span class="builtintype" id="3421589">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3421596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421599">m</span><span class="op" id="3421600">.</span><span class="ident" id="3421601">verifyData</span>&nbsp;<span class="op" id="3421612">=</span>&nbsp;<span class="ident" id="3421614">data</span><span class="op" id="3421618">[</span><span class="num" id="3421619">4</span><span class="op" id="3421620">:</span><span class="op" id="3421621">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421624">return</span>&nbsp;<span class="builtintype" id="3421631">true</span><br>
<span class="lineno">1005</span><span class="op" id="3421636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3421639">type</span>&nbsp;<span class="ident" id="3421644">nextProtoMsg</span>&nbsp;<span class="keyword" id="3421657">struct</span>&nbsp;<span class="op" id="3421664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421667">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3421673">[</span><span class="op" id="3421674">]</span><span class="builtintype" id="3421675">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421681">proto</span>&nbsp;<span class="builtintype" id="3421687">string</span><br>
<span class="lineno">1010</span><span class="op" id="3421694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3421697">func</span>&nbsp;<span class="op" id="3421702">(</span><span class="ident" id="3421703">m</span>&nbsp;<span class="op" id="3421705">*</span><span class="ident" id="3421706">nextProtoMsg</span><span class="op" id="3421718">)</span>&nbsp;<span class="ident" id="3421720">equal</span><span class="op" id="3421725">(</span><span class="ident" id="3421726">i</span>&nbsp;<span class="keyword" id="3421728">interface</span><span class="op" id="3421737">{</span><span class="op" id="3421738">}</span><span class="op" id="3421739">)</span>&nbsp;<span class="builtintype" id="3421741">bool</span>&nbsp;<span class="op" id="3421746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421749">m1</span><span class="op" id="3421751">,</span>&nbsp;<span class="ident" id="3421753">ok</span>&nbsp;<span class="op" id="3421756">:=</span>&nbsp;<span class="ident" id="3421759">i</span><span class="op" id="3421760">.</span><span class="op" id="3421761">(</span><span class="op" id="3421762">*</span><span class="ident" id="3421763">nextProtoMsg</span><span class="op" id="3421775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421778">if</span>&nbsp;<span class="op" id="3421781">!</span><span class="ident" id="3421782">ok</span>&nbsp;<span class="op" id="3421785">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421789">return</span>&nbsp;<span class="builtintype" id="3421796">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3421803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421807">return</span>&nbsp;<span class="ident" id="3421814">bytes</span><span class="op" id="3421819">.</span><span class="ident" id="3421820">Equal</span><span class="op" id="3421825">(</span><span class="ident" id="3421826">m</span><span class="op" id="3421827">.</span><span class="ident" id="3421828">raw</span><span class="op" id="3421831">,</span>&nbsp;<span class="ident" id="3421833">m1</span><span class="op" id="3421835">.</span><span class="ident" id="3421836">raw</span><span class="op" id="3421839">)</span>&nbsp;<span class="op" id="3421841">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421846">m</span><span class="op" id="3421847">.</span><span class="ident" id="3421848">proto</span>&nbsp;<span class="op" id="3421854">==</span>&nbsp;<span class="ident" id="3421857">m1</span><span class="op" id="3421859">.</span><span class="ident" id="3421860">proto</span><br>
<span class="lineno">1020</span><span class="op" id="3421866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3421869">func</span>&nbsp;<span class="op" id="3421874">(</span><span class="ident" id="3421875">m</span>&nbsp;<span class="op" id="3421877">*</span><span class="ident" id="3421878">nextProtoMsg</span><span class="op" id="3421890">)</span>&nbsp;<span class="ident" id="3421892">marshal</span><span class="op" id="3421899">(</span><span class="op" id="3421900">)</span>&nbsp;<span class="op" id="3421902">[</span><span class="op" id="3421903">]</span><span class="builtintype" id="3421904">byte</span>&nbsp;<span class="op" id="3421909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421912">if</span>&nbsp;<span class="ident" id="3421915">m</span><span class="op" id="3421916">.</span><span class="ident" id="3421917">raw</span>&nbsp;<span class="op" id="3421921">!=</span>&nbsp;<span class="ident" id="3421924">nil</span>&nbsp;<span class="op" id="3421928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421932">return</span>&nbsp;<span class="ident" id="3421939">m</span><span class="op" id="3421940">.</span><span class="ident" id="3421941">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3421946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421949">l</span>&nbsp;<span class="op" id="3421951">:=</span>&nbsp;<span class="builtinfunc" id="3421954">len</span><span class="op" id="3421957">(</span><span class="ident" id="3421958">m</span><span class="op" id="3421959">.</span><span class="ident" id="3421960">proto</span><span class="op" id="3421965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421968">if</span>&nbsp;<span class="ident" id="3421971">l</span>&nbsp;<span class="op" id="3421973">&gt;</span>&nbsp;<span class="num" id="3421975">255</span>&nbsp;<span class="op" id="3421979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421983">l</span>&nbsp;<span class="op" id="3421985">=</span>&nbsp;<span class="num" id="3421987">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3421992">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421996">padding</span>&nbsp;<span class="op" id="3422004">:=</span>&nbsp;<span class="num" id="3422007">32</span>&nbsp;<span class="op" id="3422010">-</span>&nbsp;<span class="op" id="3422012">(</span><span class="ident" id="3422013">l</span><span class="op" id="3422014">+</span><span class="num" id="3422015">2</span><span class="op" id="3422016">)</span><span class="op" id="3422017">%</span><span class="num" id="3422018">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422022">length</span>&nbsp;<span class="op" id="3422029">:=</span>&nbsp;<span class="ident" id="3422032">l</span>&nbsp;<span class="op" id="3422034">+</span>&nbsp;<span class="ident" id="3422036">padding</span>&nbsp;<span class="op" id="3422044">+</span>&nbsp;<span class="num" id="3422046">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422049">x</span>&nbsp;<span class="op" id="3422051">:=</span>&nbsp;<span class="builtinfunc" id="3422054">make</span><span class="op" id="3422058">(</span><span class="op" id="3422059">[</span><span class="op" id="3422060">]</span><span class="builtintype" id="3422061">byte</span><span class="op" id="3422065">,</span>&nbsp;<span class="ident" id="3422067">length</span><span class="op" id="3422073">+</span><span class="num" id="3422074">4</span><span class="op" id="3422075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422078">x</span><span class="op" id="3422079">[</span><span class="num" id="3422080">0</span><span class="op" id="3422081">]</span>&nbsp;<span class="op" id="3422083">=</span>&nbsp;<span class="ident" id="3422085">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422103">x</span><span class="op" id="3422104">[</span><span class="num" id="3422105">1</span><span class="op" id="3422106">]</span>&nbsp;<span class="op" id="3422108">=</span>&nbsp;<span class="builtintype" id="3422110">uint8</span><span class="op" id="3422115">(</span><span class="ident" id="3422116">length</span>&nbsp;<span class="op" id="3422123">&gt;&gt;</span>&nbsp;<span class="num" id="3422126">16</span><span class="op" id="3422128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422131">x</span><span class="op" id="3422132">[</span><span class="num" id="3422133">2</span><span class="op" id="3422134">]</span>&nbsp;<span class="op" id="3422136">=</span>&nbsp;<span class="builtintype" id="3422138">uint8</span><span class="op" id="3422143">(</span><span class="ident" id="3422144">length</span>&nbsp;<span class="op" id="3422151">&gt;&gt;</span>&nbsp;<span class="num" id="3422154">8</span><span class="op" id="3422155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422158">x</span><span class="op" id="3422159">[</span><span class="num" id="3422160">3</span><span class="op" id="3422161">]</span>&nbsp;<span class="op" id="3422163">=</span>&nbsp;<span class="builtintype" id="3422165">uint8</span><span class="op" id="3422170">(</span><span class="ident" id="3422171">length</span><span class="op" id="3422177">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422181">y</span>&nbsp;<span class="op" id="3422183">:=</span>&nbsp;<span class="ident" id="3422186">x</span><span class="op" id="3422187">[</span><span class="num" id="3422188">4</span><span class="op" id="3422189">:</span><span class="op" id="3422190">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422193">y</span><span class="op" id="3422194">[</span><span class="num" id="3422195">0</span><span class="op" id="3422196">]</span>&nbsp;<span class="op" id="3422198">=</span>&nbsp;<span class="builtintype" id="3422200">byte</span><span class="op" id="3422204">(</span><span class="ident" id="3422205">l</span><span class="op" id="3422206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3422209">copy</span><span class="op" id="3422213">(</span><span class="ident" id="3422214">y</span><span class="op" id="3422215">[</span><span class="num" id="3422216">1</span><span class="op" id="3422217">:</span><span class="op" id="3422218">]</span><span class="op" id="3422219">,</span>&nbsp;<span class="op" id="3422221">[</span><span class="op" id="3422222">]</span><span class="builtintype" id="3422223">byte</span><span class="op" id="3422227">(</span><span class="ident" id="3422228">m</span><span class="op" id="3422229">.</span><span class="ident" id="3422230">proto</span><span class="op" id="3422235">[</span><span class="num" id="3422236">0</span><span class="op" id="3422237">:</span><span class="ident" id="3422238">l</span><span class="op" id="3422239">]</span><span class="op" id="3422240">)</span><span class="op" id="3422241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422244">y</span>&nbsp;<span class="op" id="3422246">=</span>&nbsp;<span class="ident" id="3422248">y</span><span class="op" id="3422249">[</span><span class="num" id="3422250">1</span><span class="op" id="3422251">+</span><span class="ident" id="3422252">l</span><span class="op" id="3422253">:</span><span class="op" id="3422254">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422257">y</span><span class="op" id="3422258">[</span><span class="num" id="3422259">0</span><span class="op" id="3422260">]</span>&nbsp;<span class="op" id="3422262">=</span>&nbsp;<span class="builtintype" id="3422264">byte</span><span class="op" id="3422268">(</span><span class="ident" id="3422269">padding</span><span class="op" id="3422276">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422280">m</span><span class="op" id="3422281">.</span><span class="ident" id="3422282">raw</span>&nbsp;<span class="op" id="3422286">=</span>&nbsp;<span class="ident" id="3422288">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422292">return</span>&nbsp;<span class="ident" id="3422299">x</span><br>
<span class="lineno"></span><span class="op" id="3422301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="3422304">func</span>&nbsp;<span class="op" id="3422309">(</span><span class="ident" id="3422310">m</span>&nbsp;<span class="op" id="3422312">*</span><span class="ident" id="3422313">nextProtoMsg</span><span class="op" id="3422325">)</span>&nbsp;<span class="ident" id="3422327">unmarshal</span><span class="op" id="3422336">(</span><span class="ident" id="3422337">data</span>&nbsp;<span class="op" id="3422342">[</span><span class="op" id="3422343">]</span><span class="builtintype" id="3422344">byte</span><span class="op" id="3422348">)</span>&nbsp;<span class="builtintype" id="3422350">bool</span>&nbsp;<span class="op" id="3422355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422358">m</span><span class="op" id="3422359">.</span><span class="ident" id="3422360">raw</span>&nbsp;<span class="op" id="3422364">=</span>&nbsp;<span class="ident" id="3422366">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422373">if</span>&nbsp;<span class="builtinfunc" id="3422376">len</span><span class="op" id="3422379">(</span><span class="ident" id="3422380">data</span><span class="op" id="3422384">)</span>&nbsp;<span class="op" id="3422386">&lt;</span>&nbsp;<span class="num" id="3422388">5</span>&nbsp;<span class="op" id="3422390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422394">return</span>&nbsp;<span class="builtintype" id="3422401">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3422408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422411">data</span>&nbsp;<span class="op" id="3422416">=</span>&nbsp;<span class="ident" id="3422418">data</span><span class="op" id="3422422">[</span><span class="num" id="3422423">4</span><span class="op" id="3422424">:</span><span class="op" id="3422425">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422428">protoLen</span>&nbsp;<span class="op" id="3422437">:=</span>&nbsp;<span class="builtintype" id="3422440">int</span><span class="op" id="3422443">(</span><span class="ident" id="3422444">data</span><span class="op" id="3422448">[</span><span class="num" id="3422449">0</span><span class="op" id="3422450">]</span><span class="op" id="3422451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422454">data</span>&nbsp;<span class="op" id="3422459">=</span>&nbsp;<span class="ident" id="3422461">data</span><span class="op" id="3422465">[</span><span class="num" id="3422466">1</span><span class="op" id="3422467">:</span><span class="op" id="3422468">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422471">if</span>&nbsp;<span class="builtinfunc" id="3422474">len</span><span class="op" id="3422477">(</span><span class="ident" id="3422478">data</span><span class="op" id="3422482">)</span>&nbsp;<span class="op" id="3422484">&lt;</span>&nbsp;<span class="ident" id="3422486">protoLen</span>&nbsp;<span class="op" id="3422495">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422499">return</span>&nbsp;<span class="builtintype" id="3422506">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3422513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422516">m</span><span class="op" id="3422517">.</span><span class="ident" id="3422518">proto</span>&nbsp;<span class="op" id="3422524">=</span>&nbsp;<span class="builtintype" id="3422526">string</span><span class="op" id="3422532">(</span><span class="ident" id="3422533">data</span><span class="op" id="3422537">[</span><span class="num" id="3422538">0</span><span class="op" id="3422539">:</span><span class="ident" id="3422540">protoLen</span><span class="op" id="3422548">]</span><span class="op" id="3422549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422552">data</span>&nbsp;<span class="op" id="3422557">=</span>&nbsp;<span class="ident" id="3422559">data</span><span class="op" id="3422563">[</span><span class="ident" id="3422564">protoLen</span><span class="op" id="3422572">:</span><span class="op" id="3422573">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422577">if</span>&nbsp;<span class="builtinfunc" id="3422580">len</span><span class="op" id="3422583">(</span><span class="ident" id="3422584">data</span><span class="op" id="3422588">)</span>&nbsp;<span class="op" id="3422590">&lt;</span>&nbsp;<span class="num" id="3422592">1</span>&nbsp;<span class="op" id="3422594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422598">return</span>&nbsp;<span class="builtintype" id="3422605">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3422612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422615">paddingLen</span>&nbsp;<span class="op" id="3422626">:=</span>&nbsp;<span class="builtintype" id="3422629">int</span><span class="op" id="3422632">(</span><span class="ident" id="3422633">data</span><span class="op" id="3422637">[</span><span class="num" id="3422638">0</span><span class="op" id="3422639">]</span><span class="op" id="3422640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422643">data</span>&nbsp;<span class="op" id="3422648">=</span>&nbsp;<span class="ident" id="3422650">data</span><span class="op" id="3422654">[</span><span class="num" id="3422655">1</span><span class="op" id="3422656">:</span><span class="op" id="3422657">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422660">if</span>&nbsp;<span class="builtinfunc" id="3422663">len</span><span class="op" id="3422666">(</span><span class="ident" id="3422667">data</span><span class="op" id="3422671">)</span>&nbsp;<span class="op" id="3422673">!=</span>&nbsp;<span class="ident" id="3422676">paddingLen</span>&nbsp;<span class="op" id="3422687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422691">return</span>&nbsp;<span class="builtintype" id="3422698">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3422705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422709">return</span>&nbsp;<span class="builtintype" id="3422716">true</span><br>
<span class="lineno">1075</span><span class="op" id="3422721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3422724">type</span>&nbsp;<span class="ident" id="3422729">certificateRequestMsg</span>&nbsp;<span class="keyword" id="3422751">struct</span>&nbsp;<span class="op" id="3422758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422761">raw</span>&nbsp;<span class="op" id="3422765">[</span><span class="op" id="3422766">]</span><span class="builtintype" id="3422767">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3422773">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3422844">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3422917">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422926">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3422946">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422953">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3422976">[</span><span class="op" id="3422977">]</span><span class="builtintype" id="3422978">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422984">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3423007">[</span><span class="op" id="3423008">]</span><span class="ident" id="3423009">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423027">certificateAuthorities</span>&nbsp;<span class="op" id="3423050">[</span><span class="op" id="3423051">]</span><span class="op" id="3423052">[</span><span class="op" id="3423053">]</span><span class="builtintype" id="3423054">byte</span><br>
<span class="lineno"></span><span class="op" id="3423059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3423062">func</span>&nbsp;<span class="op" id="3423067">(</span><span class="ident" id="3423068">m</span>&nbsp;<span class="op" id="3423070">*</span><span class="ident" id="3423071">certificateRequestMsg</span><span class="op" id="3423092">)</span>&nbsp;<span class="ident" id="3423094">equal</span><span class="op" id="3423099">(</span><span class="ident" id="3423100">i</span>&nbsp;<span class="keyword" id="3423102">interface</span><span class="op" id="3423111">{</span><span class="op" id="3423112">}</span><span class="op" id="3423113">)</span>&nbsp;<span class="builtintype" id="3423115">bool</span>&nbsp;<span class="op" id="3423120">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423123">m1</span><span class="op" id="3423125">,</span>&nbsp;<span class="ident" id="3423127">ok</span>&nbsp;<span class="op" id="3423130">:=</span>&nbsp;<span class="ident" id="3423133">i</span><span class="op" id="3423134">.</span><span class="op" id="3423135">(</span><span class="op" id="3423136">*</span><span class="ident" id="3423137">certificateRequestMsg</span><span class="op" id="3423158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423161">if</span>&nbsp;<span class="op" id="3423164">!</span><span class="ident" id="3423165">ok</span>&nbsp;<span class="op" id="3423168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423172">return</span>&nbsp;<span class="builtintype" id="3423179">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3423186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423190">return</span>&nbsp;<span class="ident" id="3423197">bytes</span><span class="op" id="3423202">.</span><span class="ident" id="3423203">Equal</span><span class="op" id="3423208">(</span><span class="ident" id="3423209">m</span><span class="op" id="3423210">.</span><span class="ident" id="3423211">raw</span><span class="op" id="3423214">,</span>&nbsp;<span class="ident" id="3423216">m1</span><span class="op" id="3423218">.</span><span class="ident" id="3423219">raw</span><span class="op" id="3423222">)</span>&nbsp;<span class="op" id="3423224">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423229">bytes</span><span class="op" id="3423234">.</span><span class="ident" id="3423235">Equal</span><span class="op" id="3423240">(</span><span class="ident" id="3423241">m</span><span class="op" id="3423242">.</span><span class="ident" id="3423243">certificateTypes</span><span class="op" id="3423259">,</span>&nbsp;<span class="ident" id="3423261">m1</span><span class="op" id="3423263">.</span><span class="ident" id="3423264">certificateTypes</span><span class="op" id="3423280">)</span>&nbsp;<span class="op" id="3423282">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423287">eqByteSlices</span><span class="op" id="3423299">(</span><span class="ident" id="3423300">m</span><span class="op" id="3423301">.</span><span class="ident" id="3423302">certificateAuthorities</span><span class="op" id="3423324">,</span>&nbsp;<span class="ident" id="3423326">m1</span><span class="op" id="3423328">.</span><span class="ident" id="3423329">certificateAuthorities</span><span class="op" id="3423351">)</span>&nbsp;<span class="op" id="3423353">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423358">eqSignatureAndHashes</span><span class="op" id="3423378">(</span><span class="ident" id="3423379">m</span><span class="op" id="3423380">.</span><span class="ident" id="3423381">signatureAndHashes</span><span class="op" id="3423399">,</span>&nbsp;<span class="ident" id="3423401">m1</span><span class="op" id="3423403">.</span><span class="ident" id="3423404">signatureAndHashes</span><span class="op" id="3423422">)</span><br>
<span class="lineno"></span><span class="op" id="3423424">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="3423427">func</span>&nbsp;<span class="op" id="3423432">(</span><span class="ident" id="3423433">m</span>&nbsp;<span class="op" id="3423435">*</span><span class="ident" id="3423436">certificateRequestMsg</span><span class="op" id="3423457">)</span>&nbsp;<span class="ident" id="3423459">marshal</span><span class="op" id="3423466">(</span><span class="op" id="3423467">)</span>&nbsp;<span class="op" id="3423469">(</span><span class="ident" id="3423470">x</span>&nbsp;<span class="op" id="3423472">[</span><span class="op" id="3423473">]</span><span class="builtintype" id="3423474">byte</span><span class="op" id="3423478">)</span>&nbsp;<span class="op" id="3423480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423483">if</span>&nbsp;<span class="ident" id="3423486">m</span><span class="op" id="3423487">.</span><span class="ident" id="3423488">raw</span>&nbsp;<span class="op" id="3423492">!=</span>&nbsp;<span class="ident" id="3423495">nil</span>&nbsp;<span class="op" id="3423499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423503">return</span>&nbsp;<span class="ident" id="3423510">m</span><span class="op" id="3423511">.</span><span class="ident" id="3423512">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3423517">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3423521">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423578">length</span>&nbsp;<span class="op" id="3423585">:=</span>&nbsp;<span class="num" id="3423588">1</span>&nbsp;<span class="op" id="3423590">+</span>&nbsp;<span class="builtinfunc" id="3423592">len</span><span class="op" id="3423595">(</span><span class="ident" id="3423596">m</span><span class="op" id="3423597">.</span><span class="ident" id="3423598">certificateTypes</span><span class="op" id="3423614">)</span>&nbsp;<span class="op" id="3423616">+</span>&nbsp;<span class="num" id="3423618">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423621">casLength</span>&nbsp;<span class="op" id="3423631">:=</span>&nbsp;<span class="num" id="3423634">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423637">for</span>&nbsp;<span class="ident" id="3423641">_</span><span class="op" id="3423642">,</span>&nbsp;<span class="ident" id="3423644">ca</span>&nbsp;<span class="op" id="3423647">:=</span>&nbsp;<span class="keyword" id="3423650">range</span>&nbsp;<span class="ident" id="3423656">m</span><span class="op" id="3423657">.</span><span class="ident" id="3423658">certificateAuthorities</span>&nbsp;<span class="op" id="3423681">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423685">casLength</span>&nbsp;<span class="op" id="3423695">+=</span>&nbsp;<span class="num" id="3423698">2</span>&nbsp;<span class="op" id="3423700">+</span>&nbsp;<span class="builtinfunc" id="3423702">len</span><span class="op" id="3423705">(</span><span class="ident" id="3423706">ca</span><span class="op" id="3423708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3423711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423714">length</span>&nbsp;<span class="op" id="3423721">+=</span>&nbsp;<span class="ident" id="3423724">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423736">if</span>&nbsp;<span class="ident" id="3423739">m</span><span class="op" id="3423740">.</span><span class="ident" id="3423741">hasSignatureAndHash</span>&nbsp;<span class="op" id="3423761">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423765">length</span>&nbsp;<span class="op" id="3423772">+=</span>&nbsp;<span class="num" id="3423775">2</span>&nbsp;<span class="op" id="3423777">+</span>&nbsp;<span class="num" id="3423779">2</span><span class="op" id="3423780">*</span><span class="builtinfunc" id="3423781">len</span><span class="op" id="3423784">(</span><span class="ident" id="3423785">m</span><span class="op" id="3423786">.</span><span class="ident" id="3423787">signatureAndHashes</span><span class="op" id="3423805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3423808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423812">x</span>&nbsp;<span class="op" id="3423814">=</span>&nbsp;<span class="builtinfunc" id="3423816">make</span><span class="op" id="3423820">(</span><span class="op" id="3423821">[</span><span class="op" id="3423822">]</span><span class="builtintype" id="3423823">byte</span><span class="op" id="3423827">,</span>&nbsp;<span class="num" id="3423829">4</span><span class="op" id="3423830">+</span><span class="ident" id="3423831">length</span><span class="op" id="3423837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423840">x</span><span class="op" id="3423841">[</span><span class="num" id="3423842">0</span><span class="op" id="3423843">]</span>&nbsp;<span class="op" id="3423845">=</span>&nbsp;<span class="ident" id="3423847">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423871">x</span><span class="op" id="3423872">[</span><span class="num" id="3423873">1</span><span class="op" id="3423874">]</span>&nbsp;<span class="op" id="3423876">=</span>&nbsp;<span class="builtintype" id="3423878">uint8</span><span class="op" id="3423883">(</span><span class="ident" id="3423884">length</span>&nbsp;<span class="op" id="3423891">&gt;&gt;</span>&nbsp;<span class="num" id="3423894">16</span><span class="op" id="3423896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423899">x</span><span class="op" id="3423900">[</span><span class="num" id="3423901">2</span><span class="op" id="3423902">]</span>&nbsp;<span class="op" id="3423904">=</span>&nbsp;<span class="builtintype" id="3423906">uint8</span><span class="op" id="3423911">(</span><span class="ident" id="3423912">length</span>&nbsp;<span class="op" id="3423919">&gt;&gt;</span>&nbsp;<span class="num" id="3423922">8</span><span class="op" id="3423923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423926">x</span><span class="op" id="3423927">[</span><span class="num" id="3423928">3</span><span class="op" id="3423929">]</span>&nbsp;<span class="op" id="3423931">=</span>&nbsp;<span class="builtintype" id="3423933">uint8</span><span class="op" id="3423938">(</span><span class="ident" id="3423939">length</span><span class="op" id="3423945">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423949">x</span><span class="op" id="3423950">[</span><span class="num" id="3423951">4</span><span class="op" id="3423952">]</span>&nbsp;<span class="op" id="3423954">=</span>&nbsp;<span class="builtintype" id="3423956">uint8</span><span class="op" id="3423961">(</span><span class="builtinfunc" id="3423962">len</span><span class="op" id="3423965">(</span><span class="ident" id="3423966">m</span><span class="op" id="3423967">.</span><span class="ident" id="3423968">certificateTypes</span><span class="op" id="3423984">)</span><span class="op" id="3423985">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3423989">copy</span><span class="op" id="3423993">(</span><span class="ident" id="3423994">x</span><span class="op" id="3423995">[</span><span class="num" id="3423996">5</span><span class="op" id="3423997">:</span><span class="op" id="3423998">]</span><span class="op" id="3423999">,</span>&nbsp;<span class="ident" id="3424001">m</span><span class="op" id="3424002">.</span><span class="ident" id="3424003">certificateTypes</span><span class="op" id="3424019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424022">y</span>&nbsp;<span class="op" id="3424024">:=</span>&nbsp;<span class="ident" id="3424027">x</span><span class="op" id="3424028">[</span><span class="num" id="3424029">5</span><span class="op" id="3424030">+</span><span class="builtinfunc" id="3424031">len</span><span class="op" id="3424034">(</span><span class="ident" id="3424035">m</span><span class="op" id="3424036">.</span><span class="ident" id="3424037">certificateTypes</span><span class="op" id="3424053">)</span><span class="op" id="3424054">:</span><span class="op" id="3424055">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424059">if</span>&nbsp;<span class="ident" id="3424062">m</span><span class="op" id="3424063">.</span><span class="ident" id="3424064">hasSignatureAndHash</span>&nbsp;<span class="op" id="3424084">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424088">n</span>&nbsp;<span class="op" id="3424090">:=</span>&nbsp;<span class="builtinfunc" id="3424093">len</span><span class="op" id="3424096">(</span><span class="ident" id="3424097">m</span><span class="op" id="3424098">.</span><span class="ident" id="3424099">signatureAndHashes</span><span class="op" id="3424117">)</span>&nbsp;<span class="op" id="3424119">*</span>&nbsp;<span class="num" id="3424121">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424125">y</span><span class="op" id="3424126">[</span><span class="num" id="3424127">0</span><span class="op" id="3424128">]</span>&nbsp;<span class="op" id="3424130">=</span>&nbsp;<span class="builtintype" id="3424132">uint8</span><span class="op" id="3424137">(</span><span class="ident" id="3424138">n</span>&nbsp;<span class="op" id="3424140">&gt;&gt;</span>&nbsp;<span class="num" id="3424143">8</span><span class="op" id="3424144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424148">y</span><span class="op" id="3424149">[</span><span class="num" id="3424150">1</span><span class="op" id="3424151">]</span>&nbsp;<span class="op" id="3424153">=</span>&nbsp;<span class="builtintype" id="3424155">uint8</span><span class="op" id="3424160">(</span><span class="ident" id="3424161">n</span><span class="op" id="3424162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424166">y</span>&nbsp;<span class="op" id="3424168">=</span>&nbsp;<span class="ident" id="3424170">y</span><span class="op" id="3424171">[</span><span class="num" id="3424172">2</span><span class="op" id="3424173">:</span><span class="op" id="3424174">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424178">for</span>&nbsp;<span class="ident" id="3424182">_</span><span class="op" id="3424183">,</span>&nbsp;<span class="ident" id="3424185">sigAndHash</span>&nbsp;<span class="op" id="3424196">:=</span>&nbsp;<span class="keyword" id="3424199">range</span>&nbsp;<span class="ident" id="3424205">m</span><span class="op" id="3424206">.</span><span class="ident" id="3424207">signatureAndHashes</span>&nbsp;<span class="op" id="3424226">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424231">y</span><span class="op" id="3424232">[</span><span class="num" id="3424233">0</span><span class="op" id="3424234">]</span>&nbsp;<span class="op" id="3424236">=</span>&nbsp;<span class="ident" id="3424238">sigAndHash</span><span class="op" id="3424248">.</span><span class="ident" id="3424249">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424257">y</span><span class="op" id="3424258">[</span><span class="num" id="3424259">1</span><span class="op" id="3424260">]</span>&nbsp;<span class="op" id="3424262">=</span>&nbsp;<span class="ident" id="3424264">sigAndHash</span><span class="op" id="3424274">.</span><span class="ident" id="3424275">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424288">y</span>&nbsp;<span class="op" id="3424290">=</span>&nbsp;<span class="ident" id="3424292">y</span><span class="op" id="3424293">[</span><span class="num" id="3424294">2</span><span class="op" id="3424295">:</span><span class="op" id="3424296">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424303">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424307">y</span><span class="op" id="3424308">[</span><span class="num" id="3424309">0</span><span class="op" id="3424310">]</span>&nbsp;<span class="op" id="3424312">=</span>&nbsp;<span class="builtintype" id="3424314">uint8</span><span class="op" id="3424319">(</span><span class="ident" id="3424320">casLength</span>&nbsp;<span class="op" id="3424330">&gt;&gt;</span>&nbsp;<span class="num" id="3424333">8</span><span class="op" id="3424334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424337">y</span><span class="op" id="3424338">[</span><span class="num" id="3424339">1</span><span class="op" id="3424340">]</span>&nbsp;<span class="op" id="3424342">=</span>&nbsp;<span class="builtintype" id="3424344">uint8</span><span class="op" id="3424349">(</span><span class="ident" id="3424350">casLength</span><span class="op" id="3424359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424362">y</span>&nbsp;<span class="op" id="3424364">=</span>&nbsp;<span class="ident" id="3424366">y</span><span class="op" id="3424367">[</span><span class="num" id="3424368">2</span><span class="op" id="3424369">:</span><span class="op" id="3424370">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424373">for</span>&nbsp;<span class="ident" id="3424377">_</span><span class="op" id="3424378">,</span>&nbsp;<span class="ident" id="3424380">ca</span>&nbsp;<span class="op" id="3424383">:=</span>&nbsp;<span class="keyword" id="3424386">range</span>&nbsp;<span class="ident" id="3424392">m</span><span class="op" id="3424393">.</span><span class="ident" id="3424394">certificateAuthorities</span>&nbsp;<span class="op" id="3424417">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424421">y</span><span class="op" id="3424422">[</span><span class="num" id="3424423">0</span><span class="op" id="3424424">]</span>&nbsp;<span class="op" id="3424426">=</span>&nbsp;<span class="builtintype" id="3424428">uint8</span><span class="op" id="3424433">(</span><span class="builtinfunc" id="3424434">len</span><span class="op" id="3424437">(</span><span class="ident" id="3424438">ca</span><span class="op" id="3424440">)</span>&nbsp;<span class="op" id="3424442">&gt;&gt;</span>&nbsp;<span class="num" id="3424445">8</span><span class="op" id="3424446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424450">y</span><span class="op" id="3424451">[</span><span class="num" id="3424452">1</span><span class="op" id="3424453">]</span>&nbsp;<span class="op" id="3424455">=</span>&nbsp;<span class="builtintype" id="3424457">uint8</span><span class="op" id="3424462">(</span><span class="builtinfunc" id="3424463">len</span><span class="op" id="3424466">(</span><span class="ident" id="3424467">ca</span><span class="op" id="3424469">)</span><span class="op" id="3424470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424474">y</span>&nbsp;<span class="op" id="3424476">=</span>&nbsp;<span class="ident" id="3424478">y</span><span class="op" id="3424479">[</span><span class="num" id="3424480">2</span><span class="op" id="3424481">:</span><span class="op" id="3424482">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3424486">copy</span><span class="op" id="3424490">(</span><span class="ident" id="3424491">y</span><span class="op" id="3424492">,</span>&nbsp;<span class="ident" id="3424494">ca</span><span class="op" id="3424496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424500">y</span>&nbsp;<span class="op" id="3424502">=</span>&nbsp;<span class="ident" id="3424504">y</span><span class="op" id="3424505">[</span><span class="builtinfunc" id="3424506">len</span><span class="op" id="3424509">(</span><span class="ident" id="3424510">ca</span><span class="op" id="3424512">)</span><span class="op" id="3424513">:</span><span class="op" id="3424514">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424521">m</span><span class="op" id="3424522">.</span><span class="ident" id="3424523">raw</span>&nbsp;<span class="op" id="3424527">=</span>&nbsp;<span class="ident" id="3424529">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424532">return</span><br>
<span class="lineno"></span><span class="op" id="3424539">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="3424542">func</span>&nbsp;<span class="op" id="3424547">(</span><span class="ident" id="3424548">m</span>&nbsp;<span class="op" id="3424550">*</span><span class="ident" id="3424551">certificateRequestMsg</span><span class="op" id="3424572">)</span>&nbsp;<span class="ident" id="3424574">unmarshal</span><span class="op" id="3424583">(</span><span class="ident" id="3424584">data</span>&nbsp;<span class="op" id="3424589">[</span><span class="op" id="3424590">]</span><span class="builtintype" id="3424591">byte</span><span class="op" id="3424595">)</span>&nbsp;<span class="builtintype" id="3424597">bool</span>&nbsp;<span class="op" id="3424602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424605">m</span><span class="op" id="3424606">.</span><span class="ident" id="3424607">raw</span>&nbsp;<span class="op" id="3424611">=</span>&nbsp;<span class="ident" id="3424613">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424620">if</span>&nbsp;<span class="builtinfunc" id="3424623">len</span><span class="op" id="3424626">(</span><span class="ident" id="3424627">data</span><span class="op" id="3424631">)</span>&nbsp;<span class="op" id="3424633">&lt;</span>&nbsp;<span class="num" id="3424635">5</span>&nbsp;<span class="op" id="3424637">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424641">return</span>&nbsp;<span class="builtintype" id="3424648">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424659">length</span>&nbsp;<span class="op" id="3424666">:=</span>&nbsp;<span class="builtintype" id="3424669">uint32</span><span class="op" id="3424675">(</span><span class="ident" id="3424676">data</span><span class="op" id="3424680">[</span><span class="num" id="3424681">1</span><span class="op" id="3424682">]</span><span class="op" id="3424683">)</span><span class="op" id="3424684">&lt;&lt;</span><span class="num" id="3424686">16</span>&nbsp;<span class="op" id="3424689">|</span>&nbsp;<span class="builtintype" id="3424691">uint32</span><span class="op" id="3424697">(</span><span class="ident" id="3424698">data</span><span class="op" id="3424702">[</span><span class="num" id="3424703">2</span><span class="op" id="3424704">]</span><span class="op" id="3424705">)</span><span class="op" id="3424706">&lt;&lt;</span><span class="num" id="3424708">8</span>&nbsp;<span class="op" id="3424710">|</span>&nbsp;<span class="builtintype" id="3424712">uint32</span><span class="op" id="3424718">(</span><span class="ident" id="3424719">data</span><span class="op" id="3424723">[</span><span class="num" id="3424724">3</span><span class="op" id="3424725">]</span><span class="op" id="3424726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424729">if</span>&nbsp;<span class="builtintype" id="3424732">uint32</span><span class="op" id="3424738">(</span><span class="builtinfunc" id="3424739">len</span><span class="op" id="3424742">(</span><span class="ident" id="3424743">data</span><span class="op" id="3424747">)</span><span class="op" id="3424748">)</span><span class="op" id="3424749">-</span><span class="num" id="3424750">4</span>&nbsp;<span class="op" id="3424752">!=</span>&nbsp;<span class="ident" id="3424755">length</span>&nbsp;<span class="op" id="3424762">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424766">return</span>&nbsp;<span class="builtintype" id="3424773">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424784">numCertTypes</span>&nbsp;<span class="op" id="3424797">:=</span>&nbsp;<span class="builtintype" id="3424800">int</span><span class="op" id="3424803">(</span><span class="ident" id="3424804">data</span><span class="op" id="3424808">[</span><span class="num" id="3424809">4</span><span class="op" id="3424810">]</span><span class="op" id="3424811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424814">data</span>&nbsp;<span class="op" id="3424819">=</span>&nbsp;<span class="ident" id="3424821">data</span><span class="op" id="3424825">[</span><span class="num" id="3424826">5</span><span class="op" id="3424827">:</span><span class="op" id="3424828">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424831">if</span>&nbsp;<span class="ident" id="3424834">numCertTypes</span>&nbsp;<span class="op" id="3424847">==</span>&nbsp;<span class="num" id="3424850">0</span>&nbsp;<span class="op" id="3424852">||</span>&nbsp;<span class="builtinfunc" id="3424855">len</span><span class="op" id="3424858">(</span><span class="ident" id="3424859">data</span><span class="op" id="3424863">)</span>&nbsp;<span class="op" id="3424865">&lt;=</span>&nbsp;<span class="ident" id="3424868">numCertTypes</span>&nbsp;<span class="op" id="3424881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424885">return</span>&nbsp;<span class="builtintype" id="3424892">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424903">m</span><span class="op" id="3424904">.</span><span class="ident" id="3424905">certificateTypes</span>&nbsp;<span class="op" id="3424922">=</span>&nbsp;<span class="builtinfunc" id="3424924">make</span><span class="op" id="3424928">(</span><span class="op" id="3424929">[</span><span class="op" id="3424930">]</span><span class="builtintype" id="3424931">byte</span><span class="op" id="3424935">,</span>&nbsp;<span class="ident" id="3424937">numCertTypes</span><span class="op" id="3424949">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424952">if</span>&nbsp;<span class="builtinfunc" id="3424955">copy</span><span class="op" id="3424959">(</span><span class="ident" id="3424960">m</span><span class="op" id="3424961">.</span><span class="ident" id="3424962">certificateTypes</span><span class="op" id="3424978">,</span>&nbsp;<span class="ident" id="3424980">data</span><span class="op" id="3424984">)</span>&nbsp;<span class="op" id="3424986">!=</span>&nbsp;<span class="ident" id="3424989">numCertTypes</span>&nbsp;<span class="op" id="3425002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425006">return</span>&nbsp;<span class="builtintype" id="3425013">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425024">data</span>&nbsp;<span class="op" id="3425029">=</span>&nbsp;<span class="ident" id="3425031">data</span><span class="op" id="3425035">[</span><span class="ident" id="3425036">numCertTypes</span><span class="op" id="3425048">:</span><span class="op" id="3425049">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425053">if</span>&nbsp;<span class="ident" id="3425056">m</span><span class="op" id="3425057">.</span><span class="ident" id="3425058">hasSignatureAndHash</span>&nbsp;<span class="op" id="3425078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425082">if</span>&nbsp;<span class="builtinfunc" id="3425085">len</span><span class="op" id="3425088">(</span><span class="ident" id="3425089">data</span><span class="op" id="3425093">)</span>&nbsp;<span class="op" id="3425095">&lt;</span>&nbsp;<span class="num" id="3425097">2</span>&nbsp;<span class="op" id="3425099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425104">return</span>&nbsp;<span class="builtintype" id="3425111">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425119">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425123">sigAndHashLen</span>&nbsp;<span class="op" id="3425137">:=</span>&nbsp;<span class="builtintype" id="3425140">uint16</span><span class="op" id="3425146">(</span><span class="ident" id="3425147">data</span><span class="op" id="3425151">[</span><span class="num" id="3425152">0</span><span class="op" id="3425153">]</span><span class="op" id="3425154">)</span><span class="op" id="3425155">&lt;&lt;</span><span class="num" id="3425157">8</span>&nbsp;<span class="op" id="3425159">|</span>&nbsp;<span class="builtintype" id="3425161">uint16</span><span class="op" id="3425167">(</span><span class="ident" id="3425168">data</span><span class="op" id="3425172">[</span><span class="num" id="3425173">1</span><span class="op" id="3425174">]</span><span class="op" id="3425175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425179">data</span>&nbsp;<span class="op" id="3425184">=</span>&nbsp;<span class="ident" id="3425186">data</span><span class="op" id="3425190">[</span><span class="num" id="3425191">2</span><span class="op" id="3425192">:</span><span class="op" id="3425193">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425197">if</span>&nbsp;<span class="ident" id="3425200">sigAndHashLen</span><span class="op" id="3425213">&amp;</span><span class="num" id="3425214">1</span>&nbsp;<span class="op" id="3425216">!=</span>&nbsp;<span class="num" id="3425219">0</span>&nbsp;<span class="op" id="3425221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425226">return</span>&nbsp;<span class="builtintype" id="3425233">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425241">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425245">if</span>&nbsp;<span class="builtinfunc" id="3425248">len</span><span class="op" id="3425251">(</span><span class="ident" id="3425252">data</span><span class="op" id="3425256">)</span>&nbsp;<span class="op" id="3425258">&lt;</span>&nbsp;<span class="builtintype" id="3425260">int</span><span class="op" id="3425263">(</span><span class="ident" id="3425264">sigAndHashLen</span><span class="op" id="3425277">)</span>&nbsp;<span class="op" id="3425279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425284">return</span>&nbsp;<span class="builtintype" id="3425291">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425303">numSigAndHash</span>&nbsp;<span class="op" id="3425317">:=</span>&nbsp;<span class="ident" id="3425320">sigAndHashLen</span>&nbsp;<span class="op" id="3425334">/</span>&nbsp;<span class="num" id="3425336">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425340">m</span><span class="op" id="3425341">.</span><span class="ident" id="3425342">signatureAndHashes</span>&nbsp;<span class="op" id="3425361">=</span>&nbsp;<span class="builtinfunc" id="3425363">make</span><span class="op" id="3425367">(</span><span class="op" id="3425368">[</span><span class="op" id="3425369">]</span><span class="ident" id="3425370">signatureAndHash</span><span class="op" id="3425386">,</span>&nbsp;<span class="ident" id="3425388">numSigAndHash</span><span class="op" id="3425401">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425405">for</span>&nbsp;<span class="ident" id="3425409">i</span>&nbsp;<span class="op" id="3425411">:=</span>&nbsp;<span class="keyword" id="3425414">range</span>&nbsp;<span class="ident" id="3425420">m</span><span class="op" id="3425421">.</span><span class="ident" id="3425422">signatureAndHashes</span>&nbsp;<span class="op" id="3425441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425446">m</span><span class="op" id="3425447">.</span><span class="ident" id="3425448">signatureAndHashes</span><span class="op" id="3425466">[</span><span class="ident" id="3425467">i</span><span class="op" id="3425468">]</span><span class="op" id="3425469">.</span><span class="ident" id="3425470">hash</span>&nbsp;<span class="op" id="3425475">=</span>&nbsp;<span class="ident" id="3425477">data</span><span class="op" id="3425481">[</span><span class="num" id="3425482">0</span><span class="op" id="3425483">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425488">m</span><span class="op" id="3425489">.</span><span class="ident" id="3425490">signatureAndHashes</span><span class="op" id="3425508">[</span><span class="ident" id="3425509">i</span><span class="op" id="3425510">]</span><span class="op" id="3425511">.</span><span class="ident" id="3425512">signature</span>&nbsp;<span class="op" id="3425522">=</span>&nbsp;<span class="ident" id="3425524">data</span><span class="op" id="3425528">[</span><span class="num" id="3425529">1</span><span class="op" id="3425530">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425535">data</span>&nbsp;<span class="op" id="3425540">=</span>&nbsp;<span class="ident" id="3425542">data</span><span class="op" id="3425546">[</span><span class="num" id="3425547">2</span><span class="op" id="3425548">:</span><span class="op" id="3425549">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425553">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425560">if</span>&nbsp;<span class="builtinfunc" id="3425563">len</span><span class="op" id="3425566">(</span><span class="ident" id="3425567">data</span><span class="op" id="3425571">)</span>&nbsp;<span class="op" id="3425573">&lt;</span>&nbsp;<span class="num" id="3425575">2</span>&nbsp;<span class="op" id="3425577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425581">return</span>&nbsp;<span class="builtintype" id="3425588">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425595">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425598">casLength</span>&nbsp;<span class="op" id="3425608">:=</span>&nbsp;<span class="builtintype" id="3425611">uint16</span><span class="op" id="3425617">(</span><span class="ident" id="3425618">data</span><span class="op" id="3425622">[</span><span class="num" id="3425623">0</span><span class="op" id="3425624">]</span><span class="op" id="3425625">)</span><span class="op" id="3425626">&lt;&lt;</span><span class="num" id="3425628">8</span>&nbsp;<span class="op" id="3425630">|</span>&nbsp;<span class="builtintype" id="3425632">uint16</span><span class="op" id="3425638">(</span><span class="ident" id="3425639">data</span><span class="op" id="3425643">[</span><span class="num" id="3425644">1</span><span class="op" id="3425645">]</span><span class="op" id="3425646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425649">data</span>&nbsp;<span class="op" id="3425654">=</span>&nbsp;<span class="ident" id="3425656">data</span><span class="op" id="3425660">[</span><span class="num" id="3425661">2</span><span class="op" id="3425662">:</span><span class="op" id="3425663">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425666">if</span>&nbsp;<span class="builtinfunc" id="3425669">len</span><span class="op" id="3425672">(</span><span class="ident" id="3425673">data</span><span class="op" id="3425677">)</span>&nbsp;<span class="op" id="3425679">&lt;</span>&nbsp;<span class="builtintype" id="3425681">int</span><span class="op" id="3425684">(</span><span class="ident" id="3425685">casLength</span><span class="op" id="3425694">)</span>&nbsp;<span class="op" id="3425696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425700">return</span>&nbsp;<span class="builtintype" id="3425707">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425714">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425717">cas</span>&nbsp;<span class="op" id="3425721">:=</span>&nbsp;<span class="builtinfunc" id="3425724">make</span><span class="op" id="3425728">(</span><span class="op" id="3425729">[</span><span class="op" id="3425730">]</span><span class="builtintype" id="3425731">byte</span><span class="op" id="3425735">,</span>&nbsp;<span class="ident" id="3425737">casLength</span><span class="op" id="3425746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3425749">copy</span><span class="op" id="3425753">(</span><span class="ident" id="3425754">cas</span><span class="op" id="3425757">,</span>&nbsp;<span class="ident" id="3425759">data</span><span class="op" id="3425763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425766">data</span>&nbsp;<span class="op" id="3425771">=</span>&nbsp;<span class="ident" id="3425773">data</span><span class="op" id="3425777">[</span><span class="ident" id="3425778">casLength</span><span class="op" id="3425787">:</span><span class="op" id="3425788">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425792">m</span><span class="op" id="3425793">.</span><span class="ident" id="3425794">certificateAuthorities</span>&nbsp;<span class="op" id="3425817">=</span>&nbsp;<span class="ident" id="3425819">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425824">for</span>&nbsp;<span class="builtinfunc" id="3425828">len</span><span class="op" id="3425831">(</span><span class="ident" id="3425832">cas</span><span class="op" id="3425835">)</span>&nbsp;<span class="op" id="3425837">&gt;</span>&nbsp;<span class="num" id="3425839">0</span>&nbsp;<span class="op" id="3425841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425845">if</span>&nbsp;<span class="builtinfunc" id="3425848">len</span><span class="op" id="3425851">(</span><span class="ident" id="3425852">cas</span><span class="op" id="3425855">)</span>&nbsp;<span class="op" id="3425857">&lt;</span>&nbsp;<span class="num" id="3425859">2</span>&nbsp;<span class="op" id="3425861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425866">return</span>&nbsp;<span class="builtintype" id="3425873">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425885">caLen</span>&nbsp;<span class="op" id="3425891">:=</span>&nbsp;<span class="builtintype" id="3425894">uint16</span><span class="op" id="3425900">(</span><span class="ident" id="3425901">cas</span><span class="op" id="3425904">[</span><span class="num" id="3425905">0</span><span class="op" id="3425906">]</span><span class="op" id="3425907">)</span><span class="op" id="3425908">&lt;&lt;</span><span class="num" id="3425910">8</span>&nbsp;<span class="op" id="3425912">|</span>&nbsp;<span class="builtintype" id="3425914">uint16</span><span class="op" id="3425920">(</span><span class="ident" id="3425921">cas</span><span class="op" id="3425924">[</span><span class="num" id="3425925">1</span><span class="op" id="3425926">]</span><span class="op" id="3425927">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425931">cas</span>&nbsp;<span class="op" id="3425935">=</span>&nbsp;<span class="ident" id="3425937">cas</span><span class="op" id="3425940">[</span><span class="num" id="3425941">2</span><span class="op" id="3425942">:</span><span class="op" id="3425943">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425948">if</span>&nbsp;<span class="builtinfunc" id="3425951">len</span><span class="op" id="3425954">(</span><span class="ident" id="3425955">cas</span><span class="op" id="3425958">)</span>&nbsp;<span class="op" id="3425960">&lt;</span>&nbsp;<span class="builtintype" id="3425962">int</span><span class="op" id="3425965">(</span><span class="ident" id="3425966">caLen</span><span class="op" id="3425971">)</span>&nbsp;<span class="op" id="3425973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425978">return</span>&nbsp;<span class="builtintype" id="3425985">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425993">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425998">m</span><span class="op" id="3425999">.</span><span class="ident" id="3426000">certificateAuthorities</span>&nbsp;<span class="op" id="3426023">=</span>&nbsp;<span class="builtinfunc" id="3426025">append</span><span class="op" id="3426031">(</span><span class="ident" id="3426032">m</span><span class="op" id="3426033">.</span><span class="ident" id="3426034">certificateAuthorities</span><span class="op" id="3426056">,</span>&nbsp;<span class="ident" id="3426058">cas</span><span class="op" id="3426061">[</span><span class="op" id="3426062">:</span><span class="ident" id="3426063">caLen</span><span class="op" id="3426068">]</span><span class="op" id="3426069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426073">cas</span>&nbsp;<span class="op" id="3426077">=</span>&nbsp;<span class="ident" id="3426079">cas</span><span class="op" id="3426082">[</span><span class="ident" id="3426083">caLen</span><span class="op" id="3426088">:</span><span class="op" id="3426089">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426095">if</span>&nbsp;<span class="builtinfunc" id="3426098">len</span><span class="op" id="3426101">(</span><span class="ident" id="3426102">data</span><span class="op" id="3426106">)</span>&nbsp;<span class="op" id="3426108">&gt;</span>&nbsp;<span class="num" id="3426110">0</span>&nbsp;<span class="op" id="3426112">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426116">return</span>&nbsp;<span class="builtintype" id="3426123">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426134">return</span>&nbsp;<span class="builtintype" id="3426141">true</span><br>
<span class="lineno"></span><span class="op" id="3426146">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="3426149">type</span>&nbsp;<span class="ident" id="3426154">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="3426175">struct</span>&nbsp;<span class="op" id="3426182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426185">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3426205">[</span><span class="op" id="3426206">]</span><span class="builtintype" id="3426207">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426213">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3426233">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426239">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3426259">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426277">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3426297">[</span><span class="op" id="3426298">]</span><span class="builtintype" id="3426299">byte</span><br>
<span class="lineno"></span><span class="op" id="3426304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3426307">func</span>&nbsp;<span class="op" id="3426312">(</span><span class="ident" id="3426313">m</span>&nbsp;<span class="op" id="3426315">*</span><span class="ident" id="3426316">certificateVerifyMsg</span><span class="op" id="3426336">)</span>&nbsp;<span class="ident" id="3426338">equal</span><span class="op" id="3426343">(</span><span class="ident" id="3426344">i</span>&nbsp;<span class="keyword" id="3426346">interface</span><span class="op" id="3426355">{</span><span class="op" id="3426356">}</span><span class="op" id="3426357">)</span>&nbsp;<span class="builtintype" id="3426359">bool</span>&nbsp;<span class="op" id="3426364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426367">m1</span><span class="op" id="3426369">,</span>&nbsp;<span class="ident" id="3426371">ok</span>&nbsp;<span class="op" id="3426374">:=</span>&nbsp;<span class="ident" id="3426377">i</span><span class="op" id="3426378">.</span><span class="op" id="3426379">(</span><span class="op" id="3426380">*</span><span class="ident" id="3426381">certificateVerifyMsg</span><span class="op" id="3426401">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426404">if</span>&nbsp;<span class="op" id="3426407">!</span><span class="ident" id="3426408">ok</span>&nbsp;<span class="op" id="3426411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426415">return</span>&nbsp;<span class="builtintype" id="3426422">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426433">return</span>&nbsp;<span class="ident" id="3426440">bytes</span><span class="op" id="3426445">.</span><span class="ident" id="3426446">Equal</span><span class="op" id="3426451">(</span><span class="ident" id="3426452">m</span><span class="op" id="3426453">.</span><span class="ident" id="3426454">raw</span><span class="op" id="3426457">,</span>&nbsp;<span class="ident" id="3426459">m1</span><span class="op" id="3426461">.</span><span class="ident" id="3426462">raw</span><span class="op" id="3426465">)</span>&nbsp;<span class="op" id="3426467">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426472">m</span><span class="op" id="3426473">.</span><span class="ident" id="3426474">hasSignatureAndHash</span>&nbsp;<span class="op" id="3426494">==</span>&nbsp;<span class="ident" id="3426497">m1</span><span class="op" id="3426499">.</span><span class="ident" id="3426500">hasSignatureAndHash</span>&nbsp;<span class="op" id="3426520">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426525">m</span><span class="op" id="3426526">.</span><span class="ident" id="3426527">signatureAndHash</span><span class="op" id="3426543">.</span><span class="ident" id="3426544">hash</span>&nbsp;<span class="op" id="3426549">==</span>&nbsp;<span class="ident" id="3426552">m1</span><span class="op" id="3426554">.</span><span class="ident" id="3426555">signatureAndHash</span><span class="op" id="3426571">.</span><span class="ident" id="3426572">hash</span>&nbsp;<span class="op" id="3426577">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426582">m</span><span class="op" id="3426583">.</span><span class="ident" id="3426584">signatureAndHash</span><span class="op" id="3426600">.</span><span class="ident" id="3426601">signature</span>&nbsp;<span class="op" id="3426611">==</span>&nbsp;<span class="ident" id="3426614">m1</span><span class="op" id="3426616">.</span><span class="ident" id="3426617">signatureAndHash</span><span class="op" id="3426633">.</span><span class="ident" id="3426634">signature</span>&nbsp;<span class="op" id="3426644">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426649">bytes</span><span class="op" id="3426654">.</span><span class="ident" id="3426655">Equal</span><span class="op" id="3426660">(</span><span class="ident" id="3426661">m</span><span class="op" id="3426662">.</span><span class="ident" id="3426663">signature</span><span class="op" id="3426672">,</span>&nbsp;<span class="ident" id="3426674">m1</span><span class="op" id="3426676">.</span><span class="ident" id="3426677">signature</span><span class="op" id="3426686">)</span><br>
<span class="lineno"></span><span class="op" id="3426688">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="3426691">func</span>&nbsp;<span class="op" id="3426696">(</span><span class="ident" id="3426697">m</span>&nbsp;<span class="op" id="3426699">*</span><span class="ident" id="3426700">certificateVerifyMsg</span><span class="op" id="3426720">)</span>&nbsp;<span class="ident" id="3426722">marshal</span><span class="op" id="3426729">(</span><span class="op" id="3426730">)</span>&nbsp;<span class="op" id="3426732">(</span><span class="ident" id="3426733">x</span>&nbsp;<span class="op" id="3426735">[</span><span class="op" id="3426736">]</span><span class="builtintype" id="3426737">byte</span><span class="op" id="3426741">)</span>&nbsp;<span class="op" id="3426743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426746">if</span>&nbsp;<span class="ident" id="3426749">m</span><span class="op" id="3426750">.</span><span class="ident" id="3426751">raw</span>&nbsp;<span class="op" id="3426755">!=</span>&nbsp;<span class="ident" id="3426758">nil</span>&nbsp;<span class="op" id="3426762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426766">return</span>&nbsp;<span class="ident" id="3426773">m</span><span class="op" id="3426774">.</span><span class="ident" id="3426775">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426780">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426784">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426841">siglength</span>&nbsp;<span class="op" id="3426851">:=</span>&nbsp;<span class="builtinfunc" id="3426854">len</span><span class="op" id="3426857">(</span><span class="ident" id="3426858">m</span><span class="op" id="3426859">.</span><span class="ident" id="3426860">signature</span><span class="op" id="3426869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426872">length</span>&nbsp;<span class="op" id="3426879">:=</span>&nbsp;<span class="num" id="3426882">2</span>&nbsp;<span class="op" id="3426884">+</span>&nbsp;<span class="ident" id="3426886">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426897">if</span>&nbsp;<span class="ident" id="3426900">m</span><span class="op" id="3426901">.</span><span class="ident" id="3426902">hasSignatureAndHash</span>&nbsp;<span class="op" id="3426922">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426926">length</span>&nbsp;<span class="op" id="3426933">+=</span>&nbsp;<span class="num" id="3426936">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426942">x</span>&nbsp;<span class="op" id="3426944">=</span>&nbsp;<span class="builtinfunc" id="3426946">make</span><span class="op" id="3426950">(</span><span class="op" id="3426951">[</span><span class="op" id="3426952">]</span><span class="builtintype" id="3426953">byte</span><span class="op" id="3426957">,</span>&nbsp;<span class="num" id="3426959">4</span><span class="op" id="3426960">+</span><span class="ident" id="3426961">length</span><span class="op" id="3426967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426970">x</span><span class="op" id="3426971">[</span><span class="num" id="3426972">0</span><span class="op" id="3426973">]</span>&nbsp;<span class="op" id="3426975">=</span>&nbsp;<span class="ident" id="3426977">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427000">x</span><span class="op" id="3427001">[</span><span class="num" id="3427002">1</span><span class="op" id="3427003">]</span>&nbsp;<span class="op" id="3427005">=</span>&nbsp;<span class="builtintype" id="3427007">uint8</span><span class="op" id="3427012">(</span><span class="ident" id="3427013">length</span>&nbsp;<span class="op" id="3427020">&gt;&gt;</span>&nbsp;<span class="num" id="3427023">16</span><span class="op" id="3427025">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427028">x</span><span class="op" id="3427029">[</span><span class="num" id="3427030">2</span><span class="op" id="3427031">]</span>&nbsp;<span class="op" id="3427033">=</span>&nbsp;<span class="builtintype" id="3427035">uint8</span><span class="op" id="3427040">(</span><span class="ident" id="3427041">length</span>&nbsp;<span class="op" id="3427048">&gt;&gt;</span>&nbsp;<span class="num" id="3427051">8</span><span class="op" id="3427052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427055">x</span><span class="op" id="3427056">[</span><span class="num" id="3427057">3</span><span class="op" id="3427058">]</span>&nbsp;<span class="op" id="3427060">=</span>&nbsp;<span class="builtintype" id="3427062">uint8</span><span class="op" id="3427067">(</span><span class="ident" id="3427068">length</span><span class="op" id="3427074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427077">y</span>&nbsp;<span class="op" id="3427079">:=</span>&nbsp;<span class="ident" id="3427082">x</span><span class="op" id="3427083">[</span><span class="num" id="3427084">4</span><span class="op" id="3427085">:</span><span class="op" id="3427086">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427089">if</span>&nbsp;<span class="ident" id="3427092">m</span><span class="op" id="3427093">.</span><span class="ident" id="3427094">hasSignatureAndHash</span>&nbsp;<span class="op" id="3427114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427118">y</span><span class="op" id="3427119">[</span><span class="num" id="3427120">0</span><span class="op" id="3427121">]</span>&nbsp;<span class="op" id="3427123">=</span>&nbsp;<span class="ident" id="3427125">m</span><span class="op" id="3427126">.</span><span class="ident" id="3427127">signatureAndHash</span><span class="op" id="3427143">.</span><span class="ident" id="3427144">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427151">y</span><span class="op" id="3427152">[</span><span class="num" id="3427153">1</span><span class="op" id="3427154">]</span>&nbsp;<span class="op" id="3427156">=</span>&nbsp;<span class="ident" id="3427158">m</span><span class="op" id="3427159">.</span><span class="ident" id="3427160">signatureAndHash</span><span class="op" id="3427176">.</span><span class="ident" id="3427177">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427189">y</span>&nbsp;<span class="op" id="3427191">=</span>&nbsp;<span class="ident" id="3427193">y</span><span class="op" id="3427194">[</span><span class="num" id="3427195">2</span><span class="op" id="3427196">:</span><span class="op" id="3427197">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427203">y</span><span class="op" id="3427204">[</span><span class="num" id="3427205">0</span><span class="op" id="3427206">]</span>&nbsp;<span class="op" id="3427208">=</span>&nbsp;<span class="builtintype" id="3427210">uint8</span><span class="op" id="3427215">(</span><span class="ident" id="3427216">siglength</span>&nbsp;<span class="op" id="3427226">&gt;&gt;</span>&nbsp;<span class="num" id="3427229">8</span><span class="op" id="3427230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427233">y</span><span class="op" id="3427234">[</span><span class="num" id="3427235">1</span><span class="op" id="3427236">]</span>&nbsp;<span class="op" id="3427238">=</span>&nbsp;<span class="builtintype" id="3427240">uint8</span><span class="op" id="3427245">(</span><span class="ident" id="3427246">siglength</span><span class="op" id="3427255">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3427258">copy</span><span class="op" id="3427262">(</span><span class="ident" id="3427263">y</span><span class="op" id="3427264">[</span><span class="num" id="3427265">2</span><span class="op" id="3427266">:</span><span class="op" id="3427267">]</span><span class="op" id="3427268">,</span>&nbsp;<span class="ident" id="3427270">m</span><span class="op" id="3427271">.</span><span class="ident" id="3427272">signature</span><span class="op" id="3427281">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427285">m</span><span class="op" id="3427286">.</span><span class="ident" id="3427287">raw</span>&nbsp;<span class="op" id="3427291">=</span>&nbsp;<span class="ident" id="3427293">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427297">return</span><br>
<span class="lineno">1285</span><span class="op" id="3427304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3427307">func</span>&nbsp;<span class="op" id="3427312">(</span><span class="ident" id="3427313">m</span>&nbsp;<span class="op" id="3427315">*</span><span class="ident" id="3427316">certificateVerifyMsg</span><span class="op" id="3427336">)</span>&nbsp;<span class="ident" id="3427338">unmarshal</span><span class="op" id="3427347">(</span><span class="ident" id="3427348">data</span>&nbsp;<span class="op" id="3427353">[</span><span class="op" id="3427354">]</span><span class="builtintype" id="3427355">byte</span><span class="op" id="3427359">)</span>&nbsp;<span class="builtintype" id="3427361">bool</span>&nbsp;<span class="op" id="3427366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427369">m</span><span class="op" id="3427370">.</span><span class="ident" id="3427371">raw</span>&nbsp;<span class="op" id="3427375">=</span>&nbsp;<span class="ident" id="3427377">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427384">if</span>&nbsp;<span class="builtinfunc" id="3427387">len</span><span class="op" id="3427390">(</span><span class="ident" id="3427391">data</span><span class="op" id="3427395">)</span>&nbsp;<span class="op" id="3427397">&lt;</span>&nbsp;<span class="num" id="3427399">6</span>&nbsp;<span class="op" id="3427401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427405">return</span>&nbsp;<span class="builtintype" id="3427412">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427423">length</span>&nbsp;<span class="op" id="3427430">:=</span>&nbsp;<span class="builtintype" id="3427433">uint32</span><span class="op" id="3427439">(</span><span class="ident" id="3427440">data</span><span class="op" id="3427444">[</span><span class="num" id="3427445">1</span><span class="op" id="3427446">]</span><span class="op" id="3427447">)</span><span class="op" id="3427448">&lt;&lt;</span><span class="num" id="3427450">16</span>&nbsp;<span class="op" id="3427453">|</span>&nbsp;<span class="builtintype" id="3427455">uint32</span><span class="op" id="3427461">(</span><span class="ident" id="3427462">data</span><span class="op" id="3427466">[</span><span class="num" id="3427467">2</span><span class="op" id="3427468">]</span><span class="op" id="3427469">)</span><span class="op" id="3427470">&lt;&lt;</span><span class="num" id="3427472">8</span>&nbsp;<span class="op" id="3427474">|</span>&nbsp;<span class="builtintype" id="3427476">uint32</span><span class="op" id="3427482">(</span><span class="ident" id="3427483">data</span><span class="op" id="3427487">[</span><span class="num" id="3427488">3</span><span class="op" id="3427489">]</span><span class="op" id="3427490">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427493">if</span>&nbsp;<span class="builtintype" id="3427496">uint32</span><span class="op" id="3427502">(</span><span class="builtinfunc" id="3427503">len</span><span class="op" id="3427506">(</span><span class="ident" id="3427507">data</span><span class="op" id="3427511">)</span><span class="op" id="3427512">)</span><span class="op" id="3427513">-</span><span class="num" id="3427514">4</span>&nbsp;<span class="op" id="3427516">!=</span>&nbsp;<span class="ident" id="3427519">length</span>&nbsp;<span class="op" id="3427526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427530">return</span>&nbsp;<span class="builtintype" id="3427537">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427548">data</span>&nbsp;<span class="op" id="3427553">=</span>&nbsp;<span class="ident" id="3427555">data</span><span class="op" id="3427559">[</span><span class="num" id="3427560">4</span><span class="op" id="3427561">:</span><span class="op" id="3427562">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427565">if</span>&nbsp;<span class="ident" id="3427568">m</span><span class="op" id="3427569">.</span><span class="ident" id="3427570">hasSignatureAndHash</span>&nbsp;<span class="op" id="3427590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427594">m</span><span class="op" id="3427595">.</span><span class="ident" id="3427596">signatureAndHash</span><span class="op" id="3427612">.</span><span class="ident" id="3427613">hash</span>&nbsp;<span class="op" id="3427618">=</span>&nbsp;<span class="ident" id="3427620">data</span><span class="op" id="3427624">[</span><span class="num" id="3427625">0</span><span class="op" id="3427626">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427630">m</span><span class="op" id="3427631">.</span><span class="ident" id="3427632">signatureAndHash</span><span class="op" id="3427648">.</span><span class="ident" id="3427649">signature</span>&nbsp;<span class="op" id="3427659">=</span>&nbsp;<span class="ident" id="3427661">data</span><span class="op" id="3427665">[</span><span class="num" id="3427666">1</span><span class="op" id="3427667">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427671">data</span>&nbsp;<span class="op" id="3427676">=</span>&nbsp;<span class="ident" id="3427678">data</span><span class="op" id="3427682">[</span><span class="num" id="3427683">2</span><span class="op" id="3427684">:</span><span class="op" id="3427685">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427688">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427692">if</span>&nbsp;<span class="builtinfunc" id="3427695">len</span><span class="op" id="3427698">(</span><span class="ident" id="3427699">data</span><span class="op" id="3427703">)</span>&nbsp;<span class="op" id="3427705">&lt;</span>&nbsp;<span class="num" id="3427707">2</span>&nbsp;<span class="op" id="3427709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427713">return</span>&nbsp;<span class="builtintype" id="3427720">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427730">siglength</span>&nbsp;<span class="op" id="3427740">:=</span>&nbsp;<span class="builtintype" id="3427743">int</span><span class="op" id="3427746">(</span><span class="ident" id="3427747">data</span><span class="op" id="3427751">[</span><span class="num" id="3427752">0</span><span class="op" id="3427753">]</span><span class="op" id="3427754">)</span><span class="op" id="3427755">&lt;&lt;</span><span class="num" id="3427757">8</span>&nbsp;<span class="op" id="3427759">+</span>&nbsp;<span class="builtintype" id="3427761">int</span><span class="op" id="3427764">(</span><span class="ident" id="3427765">data</span><span class="op" id="3427769">[</span><span class="num" id="3427770">1</span><span class="op" id="3427771">]</span><span class="op" id="3427772">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427775">data</span>&nbsp;<span class="op" id="3427780">=</span>&nbsp;<span class="ident" id="3427782">data</span><span class="op" id="3427786">[</span><span class="num" id="3427787">2</span><span class="op" id="3427788">:</span><span class="op" id="3427789">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427792">if</span>&nbsp;<span class="builtinfunc" id="3427795">len</span><span class="op" id="3427798">(</span><span class="ident" id="3427799">data</span><span class="op" id="3427803">)</span>&nbsp;<span class="op" id="3427805">!=</span>&nbsp;<span class="ident" id="3427808">siglength</span>&nbsp;<span class="op" id="3427818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427822">return</span>&nbsp;<span class="builtintype" id="3427829">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427840">m</span><span class="op" id="3427841">.</span><span class="ident" id="3427842">signature</span>&nbsp;<span class="op" id="3427852">=</span>&nbsp;<span class="ident" id="3427854">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427861">return</span>&nbsp;<span class="builtintype" id="3427868">true</span><br>
<span class="lineno"></span><span class="op" id="3427873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="3427876">type</span>&nbsp;<span class="ident" id="3427881">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="3427901">struct</span>&nbsp;<span class="op" id="3427908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427911">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3427918">[</span><span class="op" id="3427919">]</span><span class="builtintype" id="3427920">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427926">ticket</span>&nbsp;<span class="op" id="3427933">[</span><span class="op" id="3427934">]</span><span class="builtintype" id="3427935">byte</span><br>
<span class="lineno"></span><span class="op" id="3427940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="3427943">func</span>&nbsp;<span class="op" id="3427948">(</span><span class="ident" id="3427949">m</span>&nbsp;<span class="op" id="3427951">*</span><span class="ident" id="3427952">newSessionTicketMsg</span><span class="op" id="3427971">)</span>&nbsp;<span class="ident" id="3427973">equal</span><span class="op" id="3427978">(</span><span class="ident" id="3427979">i</span>&nbsp;<span class="keyword" id="3427981">interface</span><span class="op" id="3427990">{</span><span class="op" id="3427991">}</span><span class="op" id="3427992">)</span>&nbsp;<span class="builtintype" id="3427994">bool</span>&nbsp;<span class="op" id="3427999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428002">m1</span><span class="op" id="3428004">,</span>&nbsp;<span class="ident" id="3428006">ok</span>&nbsp;<span class="op" id="3428009">:=</span>&nbsp;<span class="ident" id="3428012">i</span><span class="op" id="3428013">.</span><span class="op" id="3428014">(</span><span class="op" id="3428015">*</span><span class="ident" id="3428016">newSessionTicketMsg</span><span class="op" id="3428035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428038">if</span>&nbsp;<span class="op" id="3428041">!</span><span class="ident" id="3428042">ok</span>&nbsp;<span class="op" id="3428045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428049">return</span>&nbsp;<span class="builtintype" id="3428056">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3428063">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428067">return</span>&nbsp;<span class="ident" id="3428074">bytes</span><span class="op" id="3428079">.</span><span class="ident" id="3428080">Equal</span><span class="op" id="3428085">(</span><span class="ident" id="3428086">m</span><span class="op" id="3428087">.</span><span class="ident" id="3428088">raw</span><span class="op" id="3428091">,</span>&nbsp;<span class="ident" id="3428093">m1</span><span class="op" id="3428095">.</span><span class="ident" id="3428096">raw</span><span class="op" id="3428099">)</span>&nbsp;<span class="op" id="3428101">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428106">bytes</span><span class="op" id="3428111">.</span><span class="ident" id="3428112">Equal</span><span class="op" id="3428117">(</span><span class="ident" id="3428118">m</span><span class="op" id="3428119">.</span><span class="ident" id="3428120">ticket</span><span class="op" id="3428126">,</span>&nbsp;<span class="ident" id="3428128">m1</span><span class="op" id="3428130">.</span><span class="ident" id="3428131">ticket</span><span class="op" id="3428137">)</span><br>
<span class="lineno"></span><span class="op" id="3428139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="3428142">func</span>&nbsp;<span class="op" id="3428147">(</span><span class="ident" id="3428148">m</span>&nbsp;<span class="op" id="3428150">*</span><span class="ident" id="3428151">newSessionTicketMsg</span><span class="op" id="3428170">)</span>&nbsp;<span class="ident" id="3428172">marshal</span><span class="op" id="3428179">(</span><span class="op" id="3428180">)</span>&nbsp;<span class="op" id="3428182">(</span><span class="ident" id="3428183">x</span>&nbsp;<span class="op" id="3428185">[</span><span class="op" id="3428186">]</span><span class="builtintype" id="3428187">byte</span><span class="op" id="3428191">)</span>&nbsp;<span class="op" id="3428193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428196">if</span>&nbsp;<span class="ident" id="3428199">m</span><span class="op" id="3428200">.</span><span class="ident" id="3428201">raw</span>&nbsp;<span class="op" id="3428205">!=</span>&nbsp;<span class="ident" id="3428208">nil</span>&nbsp;<span class="op" id="3428212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428216">return</span>&nbsp;<span class="ident" id="3428223">m</span><span class="op" id="3428224">.</span><span class="ident" id="3428225">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3428230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3428234">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428289">ticketLen</span>&nbsp;<span class="op" id="3428299">:=</span>&nbsp;<span class="builtinfunc" id="3428302">len</span><span class="op" id="3428305">(</span><span class="ident" id="3428306">m</span><span class="op" id="3428307">.</span><span class="ident" id="3428308">ticket</span><span class="op" id="3428314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428317">length</span>&nbsp;<span class="op" id="3428324">:=</span>&nbsp;<span class="num" id="3428327">2</span>&nbsp;<span class="op" id="3428329">+</span>&nbsp;<span class="num" id="3428331">4</span>&nbsp;<span class="op" id="3428333">+</span>&nbsp;<span class="ident" id="3428335">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428346">x</span>&nbsp;<span class="op" id="3428348">=</span>&nbsp;<span class="builtinfunc" id="3428350">make</span><span class="op" id="3428354">(</span><span class="op" id="3428355">[</span><span class="op" id="3428356">]</span><span class="builtintype" id="3428357">byte</span><span class="op" id="3428361">,</span>&nbsp;<span class="num" id="3428363">4</span><span class="op" id="3428364">+</span><span class="ident" id="3428365">length</span><span class="op" id="3428371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428374">x</span><span class="op" id="3428375">[</span><span class="num" id="3428376">0</span><span class="op" id="3428377">]</span>&nbsp;<span class="op" id="3428379">=</span>&nbsp;<span class="ident" id="3428381">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428403">x</span><span class="op" id="3428404">[</span><span class="num" id="3428405">1</span><span class="op" id="3428406">]</span>&nbsp;<span class="op" id="3428408">=</span>&nbsp;<span class="builtintype" id="3428410">uint8</span><span class="op" id="3428415">(</span><span class="ident" id="3428416">length</span>&nbsp;<span class="op" id="3428423">&gt;&gt;</span>&nbsp;<span class="num" id="3428426">16</span><span class="op" id="3428428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428431">x</span><span class="op" id="3428432">[</span><span class="num" id="3428433">2</span><span class="op" id="3428434">]</span>&nbsp;<span class="op" id="3428436">=</span>&nbsp;<span class="builtintype" id="3428438">uint8</span><span class="op" id="3428443">(</span><span class="ident" id="3428444">length</span>&nbsp;<span class="op" id="3428451">&gt;&gt;</span>&nbsp;<span class="num" id="3428454">8</span><span class="op" id="3428455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428458">x</span><span class="op" id="3428459">[</span><span class="num" id="3428460">3</span><span class="op" id="3428461">]</span>&nbsp;<span class="op" id="3428463">=</span>&nbsp;<span class="builtintype" id="3428465">uint8</span><span class="op" id="3428470">(</span><span class="ident" id="3428471">length</span><span class="op" id="3428477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428480">x</span><span class="op" id="3428481">[</span><span class="num" id="3428482">8</span><span class="op" id="3428483">]</span>&nbsp;<span class="op" id="3428485">=</span>&nbsp;<span class="builtintype" id="3428487">uint8</span><span class="op" id="3428492">(</span><span class="ident" id="3428493">ticketLen</span>&nbsp;<span class="op" id="3428503">&gt;&gt;</span>&nbsp;<span class="num" id="3428506">8</span><span class="op" id="3428507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428510">x</span><span class="op" id="3428511">[</span><span class="num" id="3428512">9</span><span class="op" id="3428513">]</span>&nbsp;<span class="op" id="3428515">=</span>&nbsp;<span class="builtintype" id="3428517">uint8</span><span class="op" id="3428522">(</span><span class="ident" id="3428523">ticketLen</span><span class="op" id="3428532">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3428535">copy</span><span class="op" id="3428539">(</span><span class="ident" id="3428540">x</span><span class="op" id="3428541">[</span><span class="num" id="3428542">10</span><span class="op" id="3428544">:</span><span class="op" id="3428545">]</span><span class="op" id="3428546">,</span>&nbsp;<span class="ident" id="3428548">m</span><span class="op" id="3428549">.</span><span class="ident" id="3428550">ticket</span><span class="op" id="3428556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428560">m</span><span class="op" id="3428561">.</span><span class="ident" id="3428562">raw</span>&nbsp;<span class="op" id="3428566">=</span>&nbsp;<span class="ident" id="3428568">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428572">return</span><br>
<span class="lineno">1355</span><span class="op" id="3428579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3428582">func</span>&nbsp;<span class="op" id="3428587">(</span><span class="ident" id="3428588">m</span>&nbsp;<span class="op" id="3428590">*</span><span class="ident" id="3428591">newSessionTicketMsg</span><span class="op" id="3428610">)</span>&nbsp;<span class="ident" id="3428612">unmarshal</span><span class="op" id="3428621">(</span><span class="ident" id="3428622">data</span>&nbsp;<span class="op" id="3428627">[</span><span class="op" id="3428628">]</span><span class="builtintype" id="3428629">byte</span><span class="op" id="3428633">)</span>&nbsp;<span class="builtintype" id="3428635">bool</span>&nbsp;<span class="op" id="3428640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428643">m</span><span class="op" id="3428644">.</span><span class="ident" id="3428645">raw</span>&nbsp;<span class="op" id="3428649">=</span>&nbsp;<span class="ident" id="3428651">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428658">if</span>&nbsp;<span class="builtinfunc" id="3428661">len</span><span class="op" id="3428664">(</span><span class="ident" id="3428665">data</span><span class="op" id="3428669">)</span>&nbsp;<span class="op" id="3428671">&lt;</span>&nbsp;<span class="num" id="3428673">10</span>&nbsp;<span class="op" id="3428676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428680">return</span>&nbsp;<span class="builtintype" id="3428687">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3428694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428698">length</span>&nbsp;<span class="op" id="3428705">:=</span>&nbsp;<span class="builtintype" id="3428708">uint32</span><span class="op" id="3428714">(</span><span class="ident" id="3428715">data</span><span class="op" id="3428719">[</span><span class="num" id="3428720">1</span><span class="op" id="3428721">]</span><span class="op" id="3428722">)</span><span class="op" id="3428723">&lt;&lt;</span><span class="num" id="3428725">16</span>&nbsp;<span class="op" id="3428728">|</span>&nbsp;<span class="builtintype" id="3428730">uint32</span><span class="op" id="3428736">(</span><span class="ident" id="3428737">data</span><span class="op" id="3428741">[</span><span class="num" id="3428742">2</span><span class="op" id="3428743">]</span><span class="op" id="3428744">)</span><span class="op" id="3428745">&lt;&lt;</span><span class="num" id="3428747">8</span>&nbsp;<span class="op" id="3428749">|</span>&nbsp;<span class="builtintype" id="3428751">uint32</span><span class="op" id="3428757">(</span><span class="ident" id="3428758">data</span><span class="op" id="3428762">[</span><span class="num" id="3428763">3</span><span class="op" id="3428764">]</span><span class="op" id="3428765">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428768">if</span>&nbsp;<span class="builtintype" id="3428771">uint32</span><span class="op" id="3428777">(</span><span class="builtinfunc" id="3428778">len</span><span class="op" id="3428781">(</span><span class="ident" id="3428782">data</span><span class="op" id="3428786">)</span><span class="op" id="3428787">)</span><span class="op" id="3428788">-</span><span class="num" id="3428789">4</span>&nbsp;<span class="op" id="3428791">!=</span>&nbsp;<span class="ident" id="3428794">length</span>&nbsp;<span class="op" id="3428801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428805">return</span>&nbsp;<span class="builtintype" id="3428812">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3428819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428823">ticketLen</span>&nbsp;<span class="op" id="3428833">:=</span>&nbsp;<span class="builtintype" id="3428836">int</span><span class="op" id="3428839">(</span><span class="ident" id="3428840">data</span><span class="op" id="3428844">[</span><span class="num" id="3428845">8</span><span class="op" id="3428846">]</span><span class="op" id="3428847">)</span><span class="op" id="3428848">&lt;&lt;</span><span class="num" id="3428850">8</span>&nbsp;<span class="op" id="3428852">+</span>&nbsp;<span class="builtintype" id="3428854">int</span><span class="op" id="3428857">(</span><span class="ident" id="3428858">data</span><span class="op" id="3428862">[</span><span class="num" id="3428863">9</span><span class="op" id="3428864">]</span><span class="op" id="3428865">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428868">if</span>&nbsp;<span class="builtinfunc" id="3428871">len</span><span class="op" id="3428874">(</span><span class="ident" id="3428875">data</span><span class="op" id="3428879">)</span><span class="op" id="3428880">-</span><span class="num" id="3428881">10</span>&nbsp;<span class="op" id="3428884">!=</span>&nbsp;<span class="ident" id="3428887">ticketLen</span>&nbsp;<span class="op" id="3428897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428901">return</span>&nbsp;<span class="builtintype" id="3428908">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3428915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428919">m</span><span class="op" id="3428920">.</span><span class="ident" id="3428921">ticket</span>&nbsp;<span class="op" id="3428928">=</span>&nbsp;<span class="ident" id="3428930">data</span><span class="op" id="3428934">[</span><span class="num" id="3428935">10</span><span class="op" id="3428937">:</span><span class="op" id="3428938">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428942">return</span>&nbsp;<span class="builtintype" id="3428949">true</span><br>
<span class="lineno"></span><span class="op" id="3428954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3428957">func</span>&nbsp;<span class="ident" id="3428962">eqUint16s</span><span class="op" id="3428971">(</span><span class="ident" id="3428972">x</span><span class="op" id="3428973">,</span>&nbsp;<span class="ident" id="3428975">y</span>&nbsp;<span class="op" id="3428977">[</span><span class="op" id="3428978">]</span><span class="builtintype" id="3428979">uint16</span><span class="op" id="3428985">)</span>&nbsp;<span class="builtintype" id="3428987">bool</span>&nbsp;<span class="op" id="3428992">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428995">if</span>&nbsp;<span class="builtinfunc" id="3428998">len</span><span class="op" id="3429001">(</span><span class="ident" id="3429002">x</span><span class="op" id="3429003">)</span>&nbsp;<span class="op" id="3429005">!=</span>&nbsp;<span class="builtinfunc" id="3429008">len</span><span class="op" id="3429011">(</span><span class="ident" id="3429012">y</span><span class="op" id="3429013">)</span>&nbsp;<span class="op" id="3429015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429019">return</span>&nbsp;<span class="builtintype" id="3429026">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429036">for</span>&nbsp;<span class="ident" id="3429040">i</span><span class="op" id="3429041">,</span>&nbsp;<span class="ident" id="3429043">v</span>&nbsp;<span class="op" id="3429045">:=</span>&nbsp;<span class="keyword" id="3429048">range</span>&nbsp;<span class="ident" id="3429054">x</span>&nbsp;<span class="op" id="3429056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429060">if</span>&nbsp;<span class="ident" id="3429063">y</span><span class="op" id="3429064">[</span><span class="ident" id="3429065">i</span><span class="op" id="3429066">]</span>&nbsp;<span class="op" id="3429068">!=</span>&nbsp;<span class="ident" id="3429071">v</span>&nbsp;<span class="op" id="3429073">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429078">return</span>&nbsp;<span class="builtintype" id="3429085">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429099">return</span>&nbsp;<span class="builtintype" id="3429106">true</span><br>
<span class="lineno"></span><span class="op" id="3429111">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="3429114">func</span>&nbsp;<span class="ident" id="3429119">eqCurveIDs</span><span class="op" id="3429129">(</span><span class="ident" id="3429130">x</span><span class="op" id="3429131">,</span>&nbsp;<span class="ident" id="3429133">y</span>&nbsp;<span class="op" id="3429135">[</span><span class="op" id="3429136">]</span><span class="ident" id="3429137">CurveID</span><span class="op" id="3429144">)</span>&nbsp;<span class="builtintype" id="3429146">bool</span>&nbsp;<span class="op" id="3429151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429154">if</span>&nbsp;<span class="builtinfunc" id="3429157">len</span><span class="op" id="3429160">(</span><span class="ident" id="3429161">x</span><span class="op" id="3429162">)</span>&nbsp;<span class="op" id="3429164">!=</span>&nbsp;<span class="builtinfunc" id="3429167">len</span><span class="op" id="3429170">(</span><span class="ident" id="3429171">y</span><span class="op" id="3429172">)</span>&nbsp;<span class="op" id="3429174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429178">return</span>&nbsp;<span class="builtintype" id="3429185">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429192">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429195">for</span>&nbsp;<span class="ident" id="3429199">i</span><span class="op" id="3429200">,</span>&nbsp;<span class="ident" id="3429202">v</span>&nbsp;<span class="op" id="3429204">:=</span>&nbsp;<span class="keyword" id="3429207">range</span>&nbsp;<span class="ident" id="3429213">x</span>&nbsp;<span class="op" id="3429215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429219">if</span>&nbsp;<span class="ident" id="3429222">y</span><span class="op" id="3429223">[</span><span class="ident" id="3429224">i</span><span class="op" id="3429225">]</span>&nbsp;<span class="op" id="3429227">!=</span>&nbsp;<span class="ident" id="3429230">v</span>&nbsp;<span class="op" id="3429232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429237">return</span>&nbsp;<span class="builtintype" id="3429244">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429255">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429258">return</span>&nbsp;<span class="builtintype" id="3429265">true</span><br>
<span class="lineno"></span><span class="op" id="3429270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3429273">func</span>&nbsp;<span class="ident" id="3429278">eqStrings</span><span class="op" id="3429287">(</span><span class="ident" id="3429288">x</span><span class="op" id="3429289">,</span>&nbsp;<span class="ident" id="3429291">y</span>&nbsp;<span class="op" id="3429293">[</span><span class="op" id="3429294">]</span><span class="builtintype" id="3429295">string</span><span class="op" id="3429301">)</span>&nbsp;<span class="builtintype" id="3429303">bool</span>&nbsp;<span class="op" id="3429308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429311">if</span>&nbsp;<span class="builtinfunc" id="3429314">len</span><span class="op" id="3429317">(</span><span class="ident" id="3429318">x</span><span class="op" id="3429319">)</span>&nbsp;<span class="op" id="3429321">!=</span>&nbsp;<span class="builtinfunc" id="3429324">len</span><span class="op" id="3429327">(</span><span class="ident" id="3429328">y</span><span class="op" id="3429329">)</span>&nbsp;<span class="op" id="3429331">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429335">return</span>&nbsp;<span class="builtintype" id="3429342">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429352">for</span>&nbsp;<span class="ident" id="3429356">i</span><span class="op" id="3429357">,</span>&nbsp;<span class="ident" id="3429359">v</span>&nbsp;<span class="op" id="3429361">:=</span>&nbsp;<span class="keyword" id="3429364">range</span>&nbsp;<span class="ident" id="3429370">x</span>&nbsp;<span class="op" id="3429372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429376">if</span>&nbsp;<span class="ident" id="3429379">y</span><span class="op" id="3429380">[</span><span class="ident" id="3429381">i</span><span class="op" id="3429382">]</span>&nbsp;<span class="op" id="3429384">!=</span>&nbsp;<span class="ident" id="3429387">v</span>&nbsp;<span class="op" id="3429389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429394">return</span>&nbsp;<span class="builtintype" id="3429401">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429415">return</span>&nbsp;<span class="builtintype" id="3429422">true</span><br>
<span class="lineno"></span><span class="op" id="3429427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="3429430">func</span>&nbsp;<span class="ident" id="3429435">eqByteSlices</span><span class="op" id="3429447">(</span><span class="ident" id="3429448">x</span><span class="op" id="3429449">,</span>&nbsp;<span class="ident" id="3429451">y</span>&nbsp;<span class="op" id="3429453">[</span><span class="op" id="3429454">]</span><span class="op" id="3429455">[</span><span class="op" id="3429456">]</span><span class="builtintype" id="3429457">byte</span><span class="op" id="3429461">)</span>&nbsp;<span class="builtintype" id="3429463">bool</span>&nbsp;<span class="op" id="3429468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429471">if</span>&nbsp;<span class="builtinfunc" id="3429474">len</span><span class="op" id="3429477">(</span><span class="ident" id="3429478">x</span><span class="op" id="3429479">)</span>&nbsp;<span class="op" id="3429481">!=</span>&nbsp;<span class="builtinfunc" id="3429484">len</span><span class="op" id="3429487">(</span><span class="ident" id="3429488">y</span><span class="op" id="3429489">)</span>&nbsp;<span class="op" id="3429491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429495">return</span>&nbsp;<span class="builtintype" id="3429502">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429512">for</span>&nbsp;<span class="ident" id="3429516">i</span><span class="op" id="3429517">,</span>&nbsp;<span class="ident" id="3429519">v</span>&nbsp;<span class="op" id="3429521">:=</span>&nbsp;<span class="keyword" id="3429524">range</span>&nbsp;<span class="ident" id="3429530">x</span>&nbsp;<span class="op" id="3429532">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429536">if</span>&nbsp;<span class="op" id="3429539">!</span><span class="ident" id="3429540">bytes</span><span class="op" id="3429545">.</span><span class="ident" id="3429546">Equal</span><span class="op" id="3429551">(</span><span class="ident" id="3429552">v</span><span class="op" id="3429553">,</span>&nbsp;<span class="ident" id="3429555">y</span><span class="op" id="3429556">[</span><span class="ident" id="3429557">i</span><span class="op" id="3429558">]</span><span class="op" id="3429559">)</span>&nbsp;<span class="op" id="3429561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429566">return</span>&nbsp;<span class="builtintype" id="3429573">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429587">return</span>&nbsp;<span class="builtintype" id="3429594">true</span><br>
<span class="lineno">1425</span><span class="op" id="3429599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3429602">func</span>&nbsp;<span class="ident" id="3429607">eqSignatureAndHashes</span><span class="op" id="3429627">(</span><span class="ident" id="3429628">x</span><span class="op" id="3429629">,</span>&nbsp;<span class="ident" id="3429631">y</span>&nbsp;<span class="op" id="3429633">[</span><span class="op" id="3429634">]</span><span class="ident" id="3429635">signatureAndHash</span><span class="op" id="3429651">)</span>&nbsp;<span class="builtintype" id="3429653">bool</span>&nbsp;<span class="op" id="3429658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429661">if</span>&nbsp;<span class="builtinfunc" id="3429664">len</span><span class="op" id="3429667">(</span><span class="ident" id="3429668">x</span><span class="op" id="3429669">)</span>&nbsp;<span class="op" id="3429671">!=</span>&nbsp;<span class="builtinfunc" id="3429674">len</span><span class="op" id="3429677">(</span><span class="ident" id="3429678">y</span><span class="op" id="3429679">)</span>&nbsp;<span class="op" id="3429681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429685">return</span>&nbsp;<span class="builtintype" id="3429692">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429702">for</span>&nbsp;<span class="ident" id="3429706">i</span><span class="op" id="3429707">,</span>&nbsp;<span class="ident" id="3429709">v</span>&nbsp;<span class="op" id="3429711">:=</span>&nbsp;<span class="keyword" id="3429714">range</span>&nbsp;<span class="ident" id="3429720">x</span>&nbsp;<span class="op" id="3429722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429726">v2</span>&nbsp;<span class="op" id="3429729">:=</span>&nbsp;<span class="ident" id="3429732">y</span><span class="op" id="3429733">[</span><span class="ident" id="3429734">i</span><span class="op" id="3429735">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429739">if</span>&nbsp;<span class="ident" id="3429742">v</span><span class="op" id="3429743">.</span><span class="ident" id="3429744">hash</span>&nbsp;<span class="op" id="3429749">!=</span>&nbsp;<span class="ident" id="3429752">v2</span><span class="op" id="3429754">.</span><span class="ident" id="3429755">hash</span>&nbsp;<span class="op" id="3429760">||</span>&nbsp;<span class="ident" id="3429763">v</span><span class="op" id="3429764">.</span><span class="ident" id="3429765">signature</span>&nbsp;<span class="op" id="3429775">!=</span>&nbsp;<span class="ident" id="3429778">v2</span><span class="op" id="3429780">.</span><span class="ident" id="3429781">signature</span>&nbsp;<span class="op" id="3429791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429796">return</span>&nbsp;<span class="builtintype" id="3429803">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429817">return</span>&nbsp;<span class="builtintype" id="3429824">true</span><br>
<span class="lineno"></span><span class="op" id="3429829">}</span>
</div>
</body>
</html>
