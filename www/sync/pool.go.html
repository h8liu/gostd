<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1840393">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1840448">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1840502">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1840553">package</span>&nbsp;<span class="ident" id="1840561">sync</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1840567">import</span>&nbsp;<span class="op" id="1840574">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1840577">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1840588">&#34;sync/atomic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1840603">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="1840612">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1840615">//&nbsp;A&nbsp;Pool&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;temporary&nbsp;objects&nbsp;that&nbsp;may&nbsp;be&nbsp;individually&nbsp;saved&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1840690">//&nbsp;retrieved.</span><br>
<span class="lineno">15</span><span class="comment" id="1840704">//</span><br>
<span class="lineno"></span><span class="comment" id="1840707">//&nbsp;Any&nbsp;item&nbsp;stored&nbsp;in&nbsp;the&nbsp;Pool&nbsp;may&nbsp;be&nbsp;removed&nbsp;automatically&nbsp;at&nbsp;any&nbsp;time&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="1840787">//&nbsp;notification.&nbsp;If&nbsp;the&nbsp;Pool&nbsp;holds&nbsp;the&nbsp;only&nbsp;reference&nbsp;when&nbsp;this&nbsp;happens,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1840864">//&nbsp;item&nbsp;might&nbsp;be&nbsp;deallocated.</span><br>
<span class="lineno"></span><span class="comment" id="1840894">//</span><br>
<span class="lineno">20</span><span class="comment" id="1840897">//&nbsp;A&nbsp;Pool&nbsp;is&nbsp;safe&nbsp;for&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="1840962">//</span><br>
<span class="lineno"></span><span class="comment" id="1840965">//&nbsp;Pool&#39;s&nbsp;purpose&nbsp;is&nbsp;to&nbsp;cache&nbsp;allocated&nbsp;but&nbsp;unused&nbsp;items&nbsp;for&nbsp;later&nbsp;reuse,</span><br>
<span class="lineno"></span><span class="comment" id="1841039">//&nbsp;relieving&nbsp;pressure&nbsp;on&nbsp;the&nbsp;garbage&nbsp;collector.&nbsp;That&nbsp;is,&nbsp;it&nbsp;makes&nbsp;it&nbsp;easy&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1841116">//&nbsp;build&nbsp;efficient,&nbsp;thread-safe&nbsp;free&nbsp;lists.&nbsp;However,&nbsp;it&nbsp;is&nbsp;not&nbsp;suitable&nbsp;for&nbsp;all</span><br>
<span class="lineno">25</span><span class="comment" id="1841196">//&nbsp;free&nbsp;lists.</span><br>
<span class="lineno"></span><span class="comment" id="1841211">//</span><br>
<span class="lineno"></span><span class="comment" id="1841214">//&nbsp;An&nbsp;appropriate&nbsp;use&nbsp;of&nbsp;a&nbsp;Pool&nbsp;is&nbsp;to&nbsp;manage&nbsp;a&nbsp;group&nbsp;of&nbsp;temporary&nbsp;items</span><br>
<span class="lineno"></span><span class="comment" id="1841286">//&nbsp;silently&nbsp;shared&nbsp;among&nbsp;and&nbsp;potentially&nbsp;reused&nbsp;by&nbsp;concurrent&nbsp;independent</span><br>
<span class="lineno"></span><span class="comment" id="1841360">//&nbsp;clients&nbsp;of&nbsp;a&nbsp;package.&nbsp;Pool&nbsp;provides&nbsp;a&nbsp;way&nbsp;to&nbsp;amortize&nbsp;allocation&nbsp;overhead</span><br>
<span class="lineno">30</span><span class="comment" id="1841437">//&nbsp;across&nbsp;many&nbsp;clients.</span><br>
<span class="lineno"></span><span class="comment" id="1841461">//</span><br>
<span class="lineno"></span><span class="comment" id="1841464">//&nbsp;An&nbsp;example&nbsp;of&nbsp;good&nbsp;use&nbsp;of&nbsp;a&nbsp;Pool&nbsp;is&nbsp;in&nbsp;the&nbsp;fmt&nbsp;package,&nbsp;which&nbsp;maintains&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1841541">//&nbsp;dynamically-sized&nbsp;store&nbsp;of&nbsp;temporary&nbsp;output&nbsp;buffers.&nbsp;The&nbsp;store&nbsp;scales&nbsp;under</span><br>
<span class="lineno"></span><span class="comment" id="1841620">//&nbsp;load&nbsp;(when&nbsp;many&nbsp;goroutines&nbsp;are&nbsp;actively&nbsp;printing)&nbsp;and&nbsp;shrinks&nbsp;when</span><br>
<span class="lineno">35</span><span class="comment" id="1841690">//&nbsp;quiescent.</span><br>
<span class="lineno"></span><span class="comment" id="1841704">//</span><br>
<span class="lineno"></span><span class="comment" id="1841707">//&nbsp;On&nbsp;the&nbsp;other&nbsp;hand,&nbsp;a&nbsp;free&nbsp;list&nbsp;maintained&nbsp;as&nbsp;part&nbsp;of&nbsp;a&nbsp;short-lived&nbsp;object&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1841787">//&nbsp;not&nbsp;a&nbsp;suitable&nbsp;use&nbsp;for&nbsp;a&nbsp;Pool,&nbsp;since&nbsp;the&nbsp;overhead&nbsp;does&nbsp;not&nbsp;amortize&nbsp;well&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="1841866">//&nbsp;that&nbsp;scenario.&nbsp;It&nbsp;is&nbsp;more&nbsp;efficient&nbsp;to&nbsp;have&nbsp;such&nbsp;objects&nbsp;implement&nbsp;their&nbsp;own</span><br>
<span class="lineno">40</span><span class="comment" id="1841946">//&nbsp;free&nbsp;list.</span><br>
<span class="lineno"></span><span class="comment" id="1841960">//</span><br>
<span class="lineno"></span><span class="keyword" id="1841963">type</span>&nbsp;<span class="ident" id="1841968">Pool</span>&nbsp;<span class="keyword" id="1841973">struct</span>&nbsp;<span class="op" id="1841980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1841983">local</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1841993"><a href="/sync/pool.go.html#1840603">unsafe</a></span><span class="op" id="1841999">.</span><span class="ident" id="1842000">Pointer</span>&nbsp;<span class="comment" id="1842008">//&nbsp;local&nbsp;fixed-size&nbsp;per-P&nbsp;pool,&nbsp;actual&nbsp;type&nbsp;is&nbsp;[P]poolLocal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842069">localSize</span>&nbsp;<span class="builtintype" id="1842079">uintptr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1842094">//&nbsp;size&nbsp;of&nbsp;the&nbsp;local&nbsp;array</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1842123">//&nbsp;New&nbsp;optionally&nbsp;specifies&nbsp;a&nbsp;function&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1842175">//&nbsp;a&nbsp;value&nbsp;when&nbsp;Get&nbsp;would&nbsp;otherwise&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1842224">//&nbsp;It&nbsp;may&nbsp;not&nbsp;be&nbsp;changed&nbsp;concurrently&nbsp;with&nbsp;calls&nbsp;to&nbsp;Get.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842282">New</span>&nbsp;<span class="keyword" id="1842286">func</span><span class="op" id="1842290">(</span><span class="op" id="1842291">)</span>&nbsp;<span class="keyword" id="1842293">interface</span><span class="op" id="1842302">{</span><span class="op" id="1842303">}</span><br>
<span class="lineno">50</span><span class="op" id="1842305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1842308">//&nbsp;Local&nbsp;per-P&nbsp;Pool&nbsp;appendix.</span><br>
<span class="lineno"></span><span class="keyword" id="1842338">type</span>&nbsp;<span class="ident" id="1842343">poolLocal</span>&nbsp;<span class="keyword" id="1842353">struct</span>&nbsp;<span class="op" id="1842360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842363">private</span>&nbsp;<span class="keyword" id="1842371">interface</span><span class="op" id="1842380">{</span><span class="op" id="1842381">}</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1842385">//&nbsp;Can&nbsp;be&nbsp;used&nbsp;only&nbsp;by&nbsp;the&nbsp;respective&nbsp;P.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842427">shared</span>&nbsp;&nbsp;<span class="op" id="1842435">[</span><span class="op" id="1842436">]</span><span class="keyword" id="1842437">interface</span><span class="op" id="1842446">{</span><span class="op" id="1842447">}</span>&nbsp;<span class="comment" id="1842449">//&nbsp;Can&nbsp;be&nbsp;used&nbsp;by&nbsp;any&nbsp;P.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842475"><a href="/sync/mutex.go.html#1837076">Mutex</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1842497">//&nbsp;Protects&nbsp;shared.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842518">pad</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1842526">[</span><span class="num" id="1842527">128</span><span class="op" id="1842530">]</span><span class="builtintype" id="1842531">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1842540">//&nbsp;Prevents&nbsp;false&nbsp;sharing.</span><br>
<span class="lineno"></span><span class="op" id="1842567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="1842570">//&nbsp;Put&nbsp;adds&nbsp;x&nbsp;to&nbsp;the&nbsp;pool.</span><br>
<span class="lineno"></span><span class="keyword" id="1842597">func</span>&nbsp;<span class="op" id="1842602">(</span><span class="ident" id="1842603">p</span>&nbsp;<span class="op" id="1842605">*</span><span class="ident" id="1842606"><a href="/sync/pool.go.html#1841968">Pool</a></span><span class="op" id="1842610">)</span>&nbsp;<span class="ident" id="1842612">Put</span><span class="op" id="1842615">(</span><span class="ident" id="1842616">x</span>&nbsp;<span class="keyword" id="1842618">interface</span><span class="op" id="1842627">{</span><span class="op" id="1842628">}</span><span class="op" id="1842629">)</span>&nbsp;<span class="op" id="1842631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842634">if</span>&nbsp;<span class="ident" id="1842637"><a href="/sync/race0.go.html#1847161">raceenabled</a></span>&nbsp;<span class="op" id="1842649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1842653">//&nbsp;Under&nbsp;race&nbsp;detector&nbsp;the&nbsp;Pool&nbsp;degenerates&nbsp;into&nbsp;no-op.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1842711">//&nbsp;It&#39;s&nbsp;conforming,&nbsp;simple&nbsp;and&nbsp;does&nbsp;not&nbsp;introduce&nbsp;excessive</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1842773">//&nbsp;happens-before&nbsp;edges&nbsp;between&nbsp;unrelated&nbsp;goroutines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842829">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1842837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842840">if</span>&nbsp;<span class="ident" id="1842843"><a href="/sync/pool.go.html#1842616">x</a></span>&nbsp;<span class="op" id="1842845">==</span>&nbsp;<span class="ident" id="1842848">nil</span>&nbsp;<span class="op" id="1842852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842856">return</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1842864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842867">l</span>&nbsp;<span class="op" id="1842869">:=</span>&nbsp;<span class="ident" id="1842872"><a href="/sync/pool.go.html#1842603">p</a></span><span class="op" id="1842873">.</span><span class="ident" id="1842874">pin</span><span class="op" id="1842877">(</span><span class="op" id="1842878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842881">if</span>&nbsp;<span class="ident" id="1842884"><a href="/sync/pool.go.html#1842867">l</a></span><span class="op" id="1842885">.</span><span class="ident" id="1842886">private</span>&nbsp;<span class="op" id="1842894">==</span>&nbsp;<span class="ident" id="1842897">nil</span>&nbsp;<span class="op" id="1842901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842905"><a href="/sync/pool.go.html#1842867">l</a></span><span class="op" id="1842906">.</span><span class="ident" id="1842907">private</span>&nbsp;<span class="op" id="1842915">=</span>&nbsp;<span class="ident" id="1842917"><a href="/sync/pool.go.html#1842616">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842921"><a href="/sync/pool.go.html#1842616">x</a></span>&nbsp;<span class="op" id="1842923">=</span>&nbsp;<span class="ident" id="1842925">nil</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1842930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842933"><a href="/sync/pool.go.html#1846920">runtime_procUnpin</a></span><span class="op" id="1842950">(</span><span class="op" id="1842951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842954">if</span>&nbsp;<span class="ident" id="1842957"><a href="/sync/pool.go.html#1842616">x</a></span>&nbsp;<span class="op" id="1842959">==</span>&nbsp;<span class="ident" id="1842962">nil</span>&nbsp;<span class="op" id="1842966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1842970">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1842978">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842981"><a href="/sync/pool.go.html#1842867">l</a></span><span class="op" id="1842982">.</span><span class="ident" id="1842983">Lock</span><span class="op" id="1842987">(</span><span class="op" id="1842988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1842991"><a href="/sync/pool.go.html#1842867">l</a></span><span class="op" id="1842992">.</span><span class="ident" id="1842993">shared</span>&nbsp;<span class="op" id="1843000">=</span>&nbsp;<span class="builtinfunc" id="1843002">append</span><span class="op" id="1843008">(</span><span class="ident" id="1843009"><a href="/sync/pool.go.html#1842867">l</a></span><span class="op" id="1843010">.</span><span class="ident" id="1843011">shared</span><span class="op" id="1843017">,</span>&nbsp;<span class="ident" id="1843019"><a href="/sync/pool.go.html#1842616">x</a></span><span class="op" id="1843020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843023"><a href="/sync/pool.go.html#1842867">l</a></span><span class="op" id="1843024">.</span><span class="ident" id="1843025">Unlock</span><span class="op" id="1843031">(</span><span class="op" id="1843032">)</span><br>
<span class="lineno"></span><span class="op" id="1843034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1843037">//&nbsp;Get&nbsp;selects&nbsp;an&nbsp;arbitrary&nbsp;item&nbsp;from&nbsp;the&nbsp;Pool,&nbsp;removes&nbsp;it&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1843105">//&nbsp;Pool,&nbsp;and&nbsp;returns&nbsp;it&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span><span class="comment" id="1843144">//&nbsp;Get&nbsp;may&nbsp;choose&nbsp;to&nbsp;ignore&nbsp;the&nbsp;pool&nbsp;and&nbsp;treat&nbsp;it&nbsp;as&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="1843204">//&nbsp;Callers&nbsp;should&nbsp;not&nbsp;assume&nbsp;any&nbsp;relation&nbsp;between&nbsp;values&nbsp;passed&nbsp;to&nbsp;Put&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1843279">//&nbsp;the&nbsp;values&nbsp;returned&nbsp;by&nbsp;Get.</span><br>
<span class="lineno">90</span><span class="comment" id="1843310">//</span><br>
<span class="lineno"></span><span class="comment" id="1843313">//&nbsp;If&nbsp;Get&nbsp;would&nbsp;otherwise&nbsp;return&nbsp;nil&nbsp;and&nbsp;p.New&nbsp;is&nbsp;non-nil,&nbsp;Get&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="1843384">//&nbsp;the&nbsp;result&nbsp;of&nbsp;calling&nbsp;p.New.</span><br>
<span class="lineno"></span><span class="keyword" id="1843416">func</span>&nbsp;<span class="op" id="1843421">(</span><span class="ident" id="1843422">p</span>&nbsp;<span class="op" id="1843424">*</span><span class="ident" id="1843425"><a href="/sync/pool.go.html#1841968">Pool</a></span><span class="op" id="1843429">)</span>&nbsp;<span class="ident" id="1843431">Get</span><span class="op" id="1843434">(</span><span class="op" id="1843435">)</span>&nbsp;<span class="keyword" id="1843437">interface</span><span class="op" id="1843446">{</span><span class="op" id="1843447">}</span>&nbsp;<span class="op" id="1843449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843452">if</span>&nbsp;<span class="ident" id="1843455"><a href="/sync/race0.go.html#1847161">raceenabled</a></span>&nbsp;<span class="op" id="1843467">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843471">if</span>&nbsp;<span class="ident" id="1843474"><a href="/sync/pool.go.html#1843422">p</a></span><span class="op" id="1843475">.</span><span class="ident" id="1843476">New</span>&nbsp;<span class="op" id="1843480">!=</span>&nbsp;<span class="ident" id="1843483">nil</span>&nbsp;<span class="op" id="1843487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843492">return</span>&nbsp;<span class="ident" id="1843499"><a href="/sync/pool.go.html#1843422">p</a></span><span class="op" id="1843500">.</span><span class="ident" id="1843501">New</span><span class="op" id="1843504">(</span><span class="op" id="1843505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1843509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843513">return</span>&nbsp;<span class="ident" id="1843520">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1843525">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843528">l</span>&nbsp;<span class="op" id="1843530">:=</span>&nbsp;<span class="ident" id="1843533"><a href="/sync/pool.go.html#1843422">p</a></span><span class="op" id="1843534">.</span><span class="ident" id="1843535">pin</span><span class="op" id="1843538">(</span><span class="op" id="1843539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843542">x</span>&nbsp;<span class="op" id="1843544">:=</span>&nbsp;<span class="ident" id="1843547"><a href="/sync/pool.go.html#1843528">l</a></span><span class="op" id="1843548">.</span><span class="ident" id="1843549">private</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843558"><a href="/sync/pool.go.html#1843528">l</a></span><span class="op" id="1843559">.</span><span class="ident" id="1843560">private</span>&nbsp;<span class="op" id="1843568">=</span>&nbsp;<span class="ident" id="1843570">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843575"><a href="/sync/pool.go.html#1846920">runtime_procUnpin</a></span><span class="op" id="1843592">(</span><span class="op" id="1843593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843596">if</span>&nbsp;<span class="ident" id="1843599"><a href="/sync/pool.go.html#1843542">x</a></span>&nbsp;<span class="op" id="1843601">!=</span>&nbsp;<span class="ident" id="1843604">nil</span>&nbsp;<span class="op" id="1843608">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843612">return</span>&nbsp;<span class="ident" id="1843619"><a href="/sync/pool.go.html#1843542">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1843622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843625"><a href="/sync/pool.go.html#1843528">l</a></span><span class="op" id="1843626">.</span><span class="ident" id="1843627">Lock</span><span class="op" id="1843631">(</span><span class="op" id="1843632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843635">last</span>&nbsp;<span class="op" id="1843640">:=</span>&nbsp;<span class="builtinfunc" id="1843643">len</span><span class="op" id="1843646">(</span><span class="ident" id="1843647"><a href="/sync/pool.go.html#1843528">l</a></span><span class="op" id="1843648">.</span><span class="ident" id="1843649">shared</span><span class="op" id="1843655">)</span>&nbsp;<span class="op" id="1843657">-</span>&nbsp;<span class="num" id="1843659">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843662">if</span>&nbsp;<span class="ident" id="1843665"><a href="/sync/pool.go.html#1843635">last</a></span>&nbsp;<span class="op" id="1843670">&gt;=</span>&nbsp;<span class="num" id="1843673">0</span>&nbsp;<span class="op" id="1843675">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843679"><a href="/sync/pool.go.html#1843542">x</a></span>&nbsp;<span class="op" id="1843681">=</span>&nbsp;<span class="ident" id="1843683"><a href="/sync/pool.go.html#1843528">l</a></span><span class="op" id="1843684">.</span><span class="ident" id="1843685">shared</span><span class="op" id="1843691">[</span><span class="ident" id="1843692"><a href="/sync/pool.go.html#1843635">last</a></span><span class="op" id="1843696">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843700"><a href="/sync/pool.go.html#1843528">l</a></span><span class="op" id="1843701">.</span><span class="ident" id="1843702">shared</span>&nbsp;<span class="op" id="1843709">=</span>&nbsp;<span class="ident" id="1843711"><a href="/sync/pool.go.html#1843528">l</a></span><span class="op" id="1843712">.</span><span class="ident" id="1843713">shared</span><span class="op" id="1843719">[</span><span class="op" id="1843720">:</span><span class="ident" id="1843721"><a href="/sync/pool.go.html#1843635">last</a></span><span class="op" id="1843725">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1843728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843731"><a href="/sync/pool.go.html#1843528">l</a></span><span class="op" id="1843732">.</span><span class="ident" id="1843733">Unlock</span><span class="op" id="1843739">(</span><span class="op" id="1843740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843743">if</span>&nbsp;<span class="ident" id="1843746"><a href="/sync/pool.go.html#1843542">x</a></span>&nbsp;<span class="op" id="1843748">!=</span>&nbsp;<span class="ident" id="1843751">nil</span>&nbsp;<span class="op" id="1843755">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843759">return</span>&nbsp;<span class="ident" id="1843766"><a href="/sync/pool.go.html#1843542">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1843769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1843772">return</span>&nbsp;<span class="ident" id="1843779"><a href="/sync/pool.go.html#1843422">p</a></span><span class="op" id="1843780">.</span><span class="ident" id="1843781">getSlow</span><span class="op" id="1843788">(</span><span class="op" id="1843789">)</span><br>
<span class="lineno"></span><span class="op" id="1843791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="1843794">func</span>&nbsp;<span class="op" id="1843799">(</span><span class="ident" id="1843800">p</span>&nbsp;<span class="op" id="1843802">*</span><span class="ident" id="1843803"><a href="/sync/pool.go.html#1841968">Pool</a></span><span class="op" id="1843807">)</span>&nbsp;<span class="ident" id="1843809">getSlow</span><span class="op" id="1843816">(</span><span class="op" id="1843817">)</span>&nbsp;<span class="op" id="1843819">(</span><span class="ident" id="1843820">x</span>&nbsp;<span class="keyword" id="1843822">interface</span><span class="op" id="1843831">{</span><span class="op" id="1843832">}</span><span class="op" id="1843833">)</span>&nbsp;<span class="op" id="1843835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1843838">//&nbsp;See&nbsp;the&nbsp;comment&nbsp;in&nbsp;pin&nbsp;regarding&nbsp;ordering&nbsp;of&nbsp;the&nbsp;loads.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843898">size</span>&nbsp;<span class="op" id="1843903">:=</span>&nbsp;<span class="ident" id="1843906"><a href="/sync/pool.go.html#1840588">atomic</a></span><span class="op" id="1843912">.</span><span class="ident" id="1843913">LoadUintptr</span><span class="op" id="1843924">(</span><span class="op" id="1843925">&amp;</span><span class="ident" id="1843926"><a href="/sync/pool.go.html#1843800">p</a></span><span class="op" id="1843927">.</span><span class="ident" id="1843928">localSize</span><span class="op" id="1843937">)</span>&nbsp;<span class="comment" id="1843939">//&nbsp;load-acquire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1843956">local</span>&nbsp;<span class="op" id="1843962">:=</span>&nbsp;<span class="ident" id="1843965"><a href="/sync/pool.go.html#1843800">p</a></span><span class="op" id="1843966">.</span><span class="ident" id="1843967">local</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1843997">//&nbsp;load-consume</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1844014">//&nbsp;Try&nbsp;to&nbsp;steal&nbsp;one&nbsp;element&nbsp;from&nbsp;other&nbsp;procs.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844061">pid</span>&nbsp;<span class="op" id="1844065">:=</span>&nbsp;<span class="ident" id="1844068"><a href="/sync/pool.go.html#1846893">runtime_procPin</a></span><span class="op" id="1844083">(</span><span class="op" id="1844084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844087"><a href="/sync/pool.go.html#1846920">runtime_procUnpin</a></span><span class="op" id="1844104">(</span><span class="op" id="1844105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1844108">for</span>&nbsp;<span class="ident" id="1844112">i</span>&nbsp;<span class="op" id="1844114">:=</span>&nbsp;<span class="num" id="1844117">0</span><span class="op" id="1844118">;</span>&nbsp;<span class="ident" id="1844120"><a href="/sync/pool.go.html#1844112">i</a></span>&nbsp;<span class="op" id="1844122">&lt;</span>&nbsp;<span class="builtintype" id="1844124">int</span><span class="op" id="1844127">(</span><span class="ident" id="1844128"><a href="/sync/pool.go.html#1843898">size</a></span><span class="op" id="1844132">)</span><span class="op" id="1844133">;</span>&nbsp;<span class="ident" id="1844135"><a href="/sync/pool.go.html#1844112">i</a></span><span class="op" id="1844136">++</span>&nbsp;<span class="op" id="1844139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844143">l</span>&nbsp;<span class="op" id="1844145">:=</span>&nbsp;<span class="ident" id="1844148"><a href="/sync/pool.go.html#1846723">indexLocal</a></span><span class="op" id="1844158">(</span><span class="ident" id="1844159"><a href="/sync/pool.go.html#1843956">local</a></span><span class="op" id="1844164">,</span>&nbsp;<span class="op" id="1844166">(</span><span class="ident" id="1844167"><a href="/sync/pool.go.html#1844061">pid</a></span><span class="op" id="1844170">+</span><span class="ident" id="1844171"><a href="/sync/pool.go.html#1844112">i</a></span><span class="op" id="1844172">+</span><span class="num" id="1844173">1</span><span class="op" id="1844174">)</span><span class="op" id="1844175">%</span><span class="builtintype" id="1844176">int</span><span class="op" id="1844179">(</span><span class="ident" id="1844180"><a href="/sync/pool.go.html#1843898">size</a></span><span class="op" id="1844184">)</span><span class="op" id="1844185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844189"><a href="/sync/pool.go.html#1844143">l</a></span><span class="op" id="1844190">.</span><span class="ident" id="1844191">Lock</span><span class="op" id="1844195">(</span><span class="op" id="1844196">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844200">last</span>&nbsp;<span class="op" id="1844205">:=</span>&nbsp;<span class="builtinfunc" id="1844208">len</span><span class="op" id="1844211">(</span><span class="ident" id="1844212"><a href="/sync/pool.go.html#1844143">l</a></span><span class="op" id="1844213">.</span><span class="ident" id="1844214">shared</span><span class="op" id="1844220">)</span>&nbsp;<span class="op" id="1844222">-</span>&nbsp;<span class="num" id="1844224">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1844228">if</span>&nbsp;<span class="ident" id="1844231"><a href="/sync/pool.go.html#1844200">last</a></span>&nbsp;<span class="op" id="1844236">&gt;=</span>&nbsp;<span class="num" id="1844239">0</span>&nbsp;<span class="op" id="1844241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844246"><a href="/sync/pool.go.html#1843820">x</a></span>&nbsp;<span class="op" id="1844248">=</span>&nbsp;<span class="ident" id="1844250"><a href="/sync/pool.go.html#1844143">l</a></span><span class="op" id="1844251">.</span><span class="ident" id="1844252">shared</span><span class="op" id="1844258">[</span><span class="ident" id="1844259"><a href="/sync/pool.go.html#1844200">last</a></span><span class="op" id="1844263">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844268"><a href="/sync/pool.go.html#1844143">l</a></span><span class="op" id="1844269">.</span><span class="ident" id="1844270">shared</span>&nbsp;<span class="op" id="1844277">=</span>&nbsp;<span class="ident" id="1844279"><a href="/sync/pool.go.html#1844143">l</a></span><span class="op" id="1844280">.</span><span class="ident" id="1844281">shared</span><span class="op" id="1844287">[</span><span class="op" id="1844288">:</span><span class="ident" id="1844289"><a href="/sync/pool.go.html#1844200">last</a></span><span class="op" id="1844293">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844298"><a href="/sync/pool.go.html#1844143">l</a></span><span class="op" id="1844299">.</span><span class="ident" id="1844300">Unlock</span><span class="op" id="1844306">(</span><span class="op" id="1844307">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1844312">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1844320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844324"><a href="/sync/pool.go.html#1844143">l</a></span><span class="op" id="1844325">.</span><span class="ident" id="1844326">Unlock</span><span class="op" id="1844332">(</span><span class="op" id="1844333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1844336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1844340">if</span>&nbsp;<span class="ident" id="1844343"><a href="/sync/pool.go.html#1843820">x</a></span>&nbsp;<span class="op" id="1844345">==</span>&nbsp;<span class="ident" id="1844348">nil</span>&nbsp;<span class="op" id="1844352">&amp;&amp;</span>&nbsp;<span class="ident" id="1844355"><a href="/sync/pool.go.html#1843800">p</a></span><span class="op" id="1844356">.</span><span class="ident" id="1844357">New</span>&nbsp;<span class="op" id="1844361">!=</span>&nbsp;<span class="ident" id="1844364">nil</span>&nbsp;<span class="op" id="1844368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844372"><a href="/sync/pool.go.html#1843820">x</a></span>&nbsp;<span class="op" id="1844374">=</span>&nbsp;<span class="ident" id="1844376"><a href="/sync/pool.go.html#1843800">p</a></span><span class="op" id="1844377">.</span><span class="ident" id="1844378">New</span><span class="op" id="1844381">(</span><span class="op" id="1844382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1844385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1844388">return</span>&nbsp;<span class="ident" id="1844395"><a href="/sync/pool.go.html#1843820">x</a></span><br>
<span class="lineno"></span><span class="op" id="1844397">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="1844400">//&nbsp;pin&nbsp;pins&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;P,&nbsp;disables&nbsp;preemption&nbsp;and&nbsp;returns&nbsp;poolLocal&nbsp;pool&nbsp;for&nbsp;the&nbsp;P.</span><br>
<span class="lineno"></span><span class="comment" id="1844498">//&nbsp;Caller&nbsp;must&nbsp;call&nbsp;runtime_procUnpin()&nbsp;when&nbsp;done&nbsp;with&nbsp;the&nbsp;pool.</span><br>
<span class="lineno"></span><span class="keyword" id="1844563">func</span>&nbsp;<span class="op" id="1844568">(</span><span class="ident" id="1844569">p</span>&nbsp;<span class="op" id="1844571">*</span><span class="ident" id="1844572"><a href="/sync/pool.go.html#1841968">Pool</a></span><span class="op" id="1844576">)</span>&nbsp;<span class="ident" id="1844578">pin</span><span class="op" id="1844581">(</span><span class="op" id="1844582">)</span>&nbsp;<span class="op" id="1844584">*</span><span class="ident" id="1844585"><a href="/sync/pool.go.html#1842343">poolLocal</a></span>&nbsp;<span class="op" id="1844595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844598">pid</span>&nbsp;<span class="op" id="1844602">:=</span>&nbsp;<span class="ident" id="1844605"><a href="/sync/pool.go.html#1846893">runtime_procPin</a></span><span class="op" id="1844620">(</span><span class="op" id="1844621">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1844624">//&nbsp;In&nbsp;pinSlow&nbsp;we&nbsp;store&nbsp;to&nbsp;localSize&nbsp;and&nbsp;then&nbsp;to&nbsp;local,&nbsp;here&nbsp;we&nbsp;load&nbsp;in&nbsp;opposite&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1844712">//&nbsp;Since&nbsp;we&#39;ve&nbsp;disabled&nbsp;preemption,&nbsp;GC&nbsp;can&nbsp;not&nbsp;happen&nbsp;in&nbsp;between.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1844779">//&nbsp;Thus&nbsp;here&nbsp;we&nbsp;must&nbsp;observe&nbsp;local&nbsp;at&nbsp;least&nbsp;as&nbsp;large&nbsp;localSize.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1844844">//&nbsp;We&nbsp;can&nbsp;observe&nbsp;a&nbsp;newer/larger&nbsp;local,&nbsp;it&nbsp;is&nbsp;fine&nbsp;(we&nbsp;must&nbsp;observe&nbsp;its&nbsp;zero-initialized-ness).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844941">s</span>&nbsp;<span class="op" id="1844943">:=</span>&nbsp;<span class="ident" id="1844946"><a href="/sync/pool.go.html#1840588">atomic</a></span><span class="op" id="1844952">.</span><span class="ident" id="1844953">LoadUintptr</span><span class="op" id="1844964">(</span><span class="op" id="1844965">&amp;</span><span class="ident" id="1844966"><a href="/sync/pool.go.html#1844569">p</a></span><span class="op" id="1844967">.</span><span class="ident" id="1844968">localSize</span><span class="op" id="1844977">)</span>&nbsp;<span class="comment" id="1844979">//&nbsp;load-acquire</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1844996">l</span>&nbsp;<span class="op" id="1844998">:=</span>&nbsp;<span class="ident" id="1845001"><a href="/sync/pool.go.html#1844569">p</a></span><span class="op" id="1845002">.</span><span class="ident" id="1845003">local</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1845034">//&nbsp;load-consume</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1845051">if</span>&nbsp;<span class="builtintype" id="1845054">uintptr</span><span class="op" id="1845061">(</span><span class="ident" id="1845062"><a href="/sync/pool.go.html#1844598">pid</a></span><span class="op" id="1845065">)</span>&nbsp;<span class="op" id="1845067">&lt;</span>&nbsp;<span class="ident" id="1845069"><a href="/sync/pool.go.html#1844941">s</a></span>&nbsp;<span class="op" id="1845071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1845075">return</span>&nbsp;<span class="ident" id="1845082"><a href="/sync/pool.go.html#1846723">indexLocal</a></span><span class="op" id="1845092">(</span><span class="ident" id="1845093"><a href="/sync/pool.go.html#1844996">l</a></span><span class="op" id="1845094">,</span>&nbsp;<span class="ident" id="1845096"><a href="/sync/pool.go.html#1844598">pid</a></span><span class="op" id="1845099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1845102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1845105">return</span>&nbsp;<span class="ident" id="1845112"><a href="/sync/pool.go.html#1844569">p</a></span><span class="op" id="1845113">.</span><span class="ident" id="1845114">pinSlow</span><span class="op" id="1845121">(</span><span class="op" id="1845122">)</span><br>
<span class="lineno">160</span><span class="op" id="1845124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1845127">func</span>&nbsp;<span class="op" id="1845132">(</span><span class="ident" id="1845133">p</span>&nbsp;<span class="op" id="1845135">*</span><span class="ident" id="1845136"><a href="/sync/pool.go.html#1841968">Pool</a></span><span class="op" id="1845140">)</span>&nbsp;<span class="ident" id="1845142">pinSlow</span><span class="op" id="1845149">(</span><span class="op" id="1845150">)</span>&nbsp;<span class="op" id="1845152">*</span><span class="ident" id="1845153"><a href="/sync/pool.go.html#1842343">poolLocal</a></span>&nbsp;<span class="op" id="1845163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1845166">//&nbsp;Retry&nbsp;under&nbsp;the&nbsp;mutex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1845193">//&nbsp;Can&nbsp;not&nbsp;lock&nbsp;the&nbsp;mutex&nbsp;while&nbsp;pinned.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1845234"><a href="/sync/pool.go.html#1846920">runtime_procUnpin</a></span><span class="op" id="1845251">(</span><span class="op" id="1845252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1845255"><a href="/sync/pool.go.html#1846619">allPoolsMu</a></span><span class="op" id="1845265">.</span><span class="ident" id="1845266">Lock</span><span class="op" id="1845270">(</span><span class="op" id="1845271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1845274">defer</span>&nbsp;<span class="ident" id="1845280"><a href="/sync/pool.go.html#1846619">allPoolsMu</a></span><span class="op" id="1845290">.</span><span class="ident" id="1845291">Unlock</span><span class="op" id="1845297">(</span><span class="op" id="1845298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1845301">pid</span>&nbsp;<span class="op" id="1845305">:=</span>&nbsp;<span class="ident" id="1845308"><a href="/sync/pool.go.html#1846893">runtime_procPin</a></span><span class="op" id="1845323">(</span><span class="op" id="1845324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1845327">//&nbsp;poolCleanup&nbsp;won&#39;t&nbsp;be&nbsp;called&nbsp;while&nbsp;we&nbsp;are&nbsp;pinned.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1845380">s</span>&nbsp;<span class="op" id="1845382">:=</span>&nbsp;<span class="ident" id="1845385"><a href="/sync/pool.go.html#1845133">p</a></span><span class="op" id="1845386">.</span><span class="ident" id="1845387">localSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1845398">l</span>&nbsp;<span class="op" id="1845400">:=</span>&nbsp;<span class="ident" id="1845403"><a href="/sync/pool.go.html#1845133">p</a></span><span class="op" id="1845404">.</span><span class="ident" id="1845405">local</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1845412">if</span>&nbsp;<span class="builtintype" id="1845415">uintptr</span><span class="op" id="1845422">(</span><span class="ident" id="1845423"><a href="/sync/pool.go.html#1845301">pid</a></span><span class="op" id="1845426">)</span>&nbsp;<span class="op" id="1845428">&lt;</span>&nbsp;<span class="ident" id="1845430"><a href="/sync/pool.go.html#1845380">s</a></span>&nbsp;<span class="op" id="1845432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1845436">return</span>&nbsp;<span class="ident" id="1845443"><a href="/sync/pool.go.html#1846723">indexLocal</a></span><span class="op" id="1845453">(</span><span class="ident" id="1845454"><a href="/sync/pool.go.html#1845398">l</a></span><span class="op" id="1845455">,</span>&nbsp;<span class="ident" id="1845457"><a href="/sync/pool.go.html#1845301">pid</a></span><span class="op" id="1845460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1845463">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1845466">if</span>&nbsp;<span class="ident" id="1845469"><a href="/sync/pool.go.html#1845133">p</a></span><span class="op" id="1845470">.</span><span class="ident" id="1845471">local</span>&nbsp;<span class="op" id="1845477">==</span>&nbsp;<span class="ident" id="1845480">nil</span>&nbsp;<span class="op" id="1845484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1845488"><a href="/sync/pool.go.html#1846637">allPools</a></span>&nbsp;<span class="op" id="1845497">=</span>&nbsp;<span class="builtinfunc" id="1845499">append</span><span class="op" id="1845505">(</span><span class="ident" id="1845506"><a href="/sync/pool.go.html#1846637">allPools</a></span><span class="op" id="1845514">,</span>&nbsp;<span class="ident" id="1845516"><a href="/sync/pool.go.html#1845133">p</a></span><span class="op" id="1845517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1845520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1845523">//&nbsp;If&nbsp;GOMAXPROCS&nbsp;changes&nbsp;between&nbsp;GCs,&nbsp;we&nbsp;re-allocate&nbsp;the&nbsp;array&nbsp;and&nbsp;lose&nbsp;the&nbsp;old&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1845609">size</span>&nbsp;<span class="op" id="1845614">:=</span>&nbsp;<span class="ident" id="1845617"><a href="/sync/pool.go.html#1840577">runtime</a></span><span class="op" id="1845624">.</span><span class="ident" id="1845625">GOMAXPROCS</span><span class="op" id="1845635">(</span><span class="num" id="1845636">0</span><span class="op" id="1845637">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1845640">local</span>&nbsp;<span class="op" id="1845646">:=</span>&nbsp;<span class="builtinfunc" id="1845649">make</span><span class="op" id="1845653">(</span><span class="op" id="1845654">[</span><span class="op" id="1845655">]</span><span class="ident" id="1845656"><a href="/sync/pool.go.html#1842343">poolLocal</a></span><span class="op" id="1845665">,</span>&nbsp;<span class="ident" id="1845667"><a href="/sync/pool.go.html#1845609">size</a></span><span class="op" id="1845671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1845674"><a href="/sync/pool.go.html#1840588">atomic</a></span><span class="op" id="1845680">.</span><span class="ident" id="1845681">StorePointer</span><span class="op" id="1845693">(</span><span class="op" id="1845694">(</span><span class="op" id="1845695">*</span><span class="ident" id="1845696"><a href="/sync/pool.go.html#1840603">unsafe</a></span><span class="op" id="1845702">.</span><span class="ident" id="1845703">Pointer</span><span class="op" id="1845710">)</span><span class="op" id="1845711">(</span><span class="op" id="1845712">&amp;</span><span class="ident" id="1845713"><a href="/sync/pool.go.html#1845133">p</a></span><span class="op" id="1845714">.</span><span class="ident" id="1845715">local</span><span class="op" id="1845720">)</span><span class="op" id="1845721">,</span>&nbsp;<span class="ident" id="1845723"><a href="/sync/pool.go.html#1840603">unsafe</a></span><span class="op" id="1845729">.</span><span class="ident" id="1845730">Pointer</span><span class="op" id="1845737">(</span><span class="op" id="1845738">&amp;</span><span class="ident" id="1845739"><a href="/sync/pool.go.html#1845640">local</a></span><span class="op" id="1845744">[</span><span class="num" id="1845745">0</span><span class="op" id="1845746">]</span><span class="op" id="1845747">)</span><span class="op" id="1845748">)</span>&nbsp;<span class="comment" id="1845750">//&nbsp;store-release</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1845768"><a href="/sync/pool.go.html#1840588">atomic</a></span><span class="op" id="1845774">.</span><span class="ident" id="1845775">StoreUintptr</span><span class="op" id="1845787">(</span><span class="op" id="1845788">&amp;</span><span class="ident" id="1845789"><a href="/sync/pool.go.html#1845133">p</a></span><span class="op" id="1845790">.</span><span class="ident" id="1845791">localSize</span><span class="op" id="1845800">,</span>&nbsp;<span class="builtintype" id="1845802">uintptr</span><span class="op" id="1845809">(</span><span class="ident" id="1845810"><a href="/sync/pool.go.html#1845609">size</a></span><span class="op" id="1845814">)</span><span class="op" id="1845815">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1845844">//&nbsp;store-release</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1845862">return</span>&nbsp;<span class="op" id="1845869">&amp;</span><span class="ident" id="1845870"><a href="/sync/pool.go.html#1845640">local</a></span><span class="op" id="1845875">[</span><span class="ident" id="1845876"><a href="/sync/pool.go.html#1845301">pid</a></span><span class="op" id="1845879">]</span><br>
<span class="lineno"></span><span class="op" id="1845881">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="1845884">func</span>&nbsp;<span class="ident" id="1845889">poolCleanup</span><span class="op" id="1845900">(</span><span class="op" id="1845901">)</span>&nbsp;<span class="op" id="1845903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1845906">//&nbsp;This&nbsp;function&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;world&nbsp;stopped,&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1846000">//&nbsp;It&nbsp;must&nbsp;not&nbsp;allocate&nbsp;and&nbsp;probably&nbsp;should&nbsp;not&nbsp;call&nbsp;any&nbsp;runtime&nbsp;functions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1846077">//&nbsp;Defensively&nbsp;zero&nbsp;out&nbsp;everything,&nbsp;2&nbsp;reasons:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1846125">//&nbsp;1.&nbsp;To&nbsp;prevent&nbsp;false&nbsp;retention&nbsp;of&nbsp;whole&nbsp;Pools.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1846175">//&nbsp;2.&nbsp;If&nbsp;GC&nbsp;happens&nbsp;while&nbsp;a&nbsp;goroutine&nbsp;works&nbsp;with&nbsp;l.shared&nbsp;in&nbsp;Put/Get,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1846246">//&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;will&nbsp;retain&nbsp;whole&nbsp;Pool.&nbsp;So&nbsp;next&nbsp;cycle&nbsp;memory&nbsp;consumption&nbsp;would&nbsp;be&nbsp;doubled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1846331">for</span>&nbsp;<span class="ident" id="1846335">i</span><span class="op" id="1846336">,</span>&nbsp;<span class="ident" id="1846338">p</span>&nbsp;<span class="op" id="1846340">:=</span>&nbsp;<span class="keyword" id="1846343">range</span>&nbsp;<span class="ident" id="1846349"><a href="/sync/pool.go.html#1846637">allPools</a></span>&nbsp;<span class="op" id="1846358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846362"><a href="/sync/pool.go.html#1846637">allPools</a></span><span class="op" id="1846370">[</span><span class="ident" id="1846371"><a href="/sync/pool.go.html#1846335">i</a></span><span class="op" id="1846372">]</span>&nbsp;<span class="op" id="1846374">=</span>&nbsp;<span class="ident" id="1846376">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1846382">for</span>&nbsp;<span class="ident" id="1846386">i</span>&nbsp;<span class="op" id="1846388">:=</span>&nbsp;<span class="num" id="1846391">0</span><span class="op" id="1846392">;</span>&nbsp;<span class="ident" id="1846394"><a href="/sync/pool.go.html#1846386">i</a></span>&nbsp;<span class="op" id="1846396">&lt;</span>&nbsp;<span class="builtintype" id="1846398">int</span><span class="op" id="1846401">(</span><span class="ident" id="1846402"><a href="/sync/pool.go.html#1846338">p</a></span><span class="op" id="1846403">.</span><span class="ident" id="1846404">localSize</span><span class="op" id="1846413">)</span><span class="op" id="1846414">;</span>&nbsp;<span class="ident" id="1846416"><a href="/sync/pool.go.html#1846386">i</a></span><span class="op" id="1846417">++</span>&nbsp;<span class="op" id="1846420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846425">l</span>&nbsp;<span class="op" id="1846427">:=</span>&nbsp;<span class="ident" id="1846430"><a href="/sync/pool.go.html#1846723">indexLocal</a></span><span class="op" id="1846440">(</span><span class="ident" id="1846441"><a href="/sync/pool.go.html#1846338">p</a></span><span class="op" id="1846442">.</span><span class="ident" id="1846443">local</span><span class="op" id="1846448">,</span>&nbsp;<span class="ident" id="1846450"><a href="/sync/pool.go.html#1846386">i</a></span><span class="op" id="1846451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846456"><a href="/sync/pool.go.html#1846425">l</a></span><span class="op" id="1846457">.</span><span class="ident" id="1846458">private</span>&nbsp;<span class="op" id="1846466">=</span>&nbsp;<span class="ident" id="1846468">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1846475">for</span>&nbsp;<span class="ident" id="1846479">j</span>&nbsp;<span class="op" id="1846481">:=</span>&nbsp;<span class="keyword" id="1846484">range</span>&nbsp;<span class="ident" id="1846490"><a href="/sync/pool.go.html#1846425">l</a></span><span class="op" id="1846491">.</span><span class="ident" id="1846492">shared</span>&nbsp;<span class="op" id="1846499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846505"><a href="/sync/pool.go.html#1846425">l</a></span><span class="op" id="1846506">.</span><span class="ident" id="1846507">shared</span><span class="op" id="1846513">[</span><span class="ident" id="1846514"><a href="/sync/pool.go.html#1846479">j</a></span><span class="op" id="1846515">]</span>&nbsp;<span class="op" id="1846517">=</span>&nbsp;<span class="ident" id="1846519">nil</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1846526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846531"><a href="/sync/pool.go.html#1846425">l</a></span><span class="op" id="1846532">.</span><span class="ident" id="1846533">shared</span>&nbsp;<span class="op" id="1846540">=</span>&nbsp;<span class="ident" id="1846542">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1846548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846552"><a href="/sync/pool.go.html#1846338">p</a></span><span class="op" id="1846553">.</span><span class="ident" id="1846554">local</span>&nbsp;<span class="op" id="1846560">=</span>&nbsp;<span class="ident" id="1846562">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846568"><a href="/sync/pool.go.html#1846338">p</a></span><span class="op" id="1846569">.</span><span class="ident" id="1846570">localSize</span>&nbsp;<span class="op" id="1846580">=</span>&nbsp;<span class="num" id="1846582">0</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1846585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846588"><a href="/sync/pool.go.html#1846637">allPools</a></span>&nbsp;<span class="op" id="1846597">=</span>&nbsp;<span class="op" id="1846599">[</span><span class="op" id="1846600">]</span><span class="op" id="1846601">*</span><span class="ident" id="1846602"><a href="/sync/pool.go.html#1841968">Pool</a></span><span class="op" id="1846606">{</span><span class="op" id="1846607">}</span><br>
<span class="lineno"></span><span class="op" id="1846609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1846612">var</span>&nbsp;<span class="op" id="1846616">(</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846619">allPoolsMu</span>&nbsp;<span class="ident" id="1846630"><a href="/sync/mutex.go.html#1837076">Mutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846637">allPools</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1846648">[</span><span class="op" id="1846649">]</span><span class="op" id="1846650">*</span><span class="ident" id="1846651"><a href="/sync/pool.go.html#1841968">Pool</a></span><br>
<span class="lineno"></span><span class="op" id="1846656">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1846659">func</span>&nbsp;<span class="ident" id="1846664">init</span><span class="op" id="1846668">(</span><span class="op" id="1846669">)</span>&nbsp;<span class="op" id="1846671">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1846674"><a href="/sync/pool.go.html#1846844">runtime_registerPoolCleanup</a></span><span class="op" id="1846701">(</span><span class="ident" id="1846702"><a href="/sync/pool.go.html#1845889">poolCleanup</a></span><span class="op" id="1846713">)</span><br>
<span class="lineno"></span><span class="op" id="1846715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1846718">func</span>&nbsp;<span class="ident" id="1846723">indexLocal</span><span class="op" id="1846733">(</span><span class="ident" id="1846734">l</span>&nbsp;<span class="ident" id="1846736"><a href="/sync/pool.go.html#1840603">unsafe</a></span><span class="op" id="1846742">.</span><span class="ident" id="1846743">Pointer</span><span class="op" id="1846750">,</span>&nbsp;<span class="ident" id="1846752">i</span>&nbsp;<span class="builtintype" id="1846754">int</span><span class="op" id="1846757">)</span>&nbsp;<span class="op" id="1846759">*</span><span class="ident" id="1846760"><a href="/sync/pool.go.html#1842343">poolLocal</a></span>&nbsp;<span class="op" id="1846770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1846773">return</span>&nbsp;<span class="op" id="1846780">&amp;</span><span class="op" id="1846781">(</span><span class="op" id="1846782">*</span><span class="op" id="1846783">[</span><span class="num" id="1846784">1000000</span><span class="op" id="1846791">]</span><span class="ident" id="1846792"><a href="/sync/pool.go.html#1842343">poolLocal</a></span><span class="op" id="1846801">)</span><span class="op" id="1846802">(</span><span class="ident" id="1846803"><a href="/sync/pool.go.html#1846734">l</a></span><span class="op" id="1846804">)</span><span class="op" id="1846805">[</span><span class="ident" id="1846806"><a href="/sync/pool.go.html#1846752">i</a></span><span class="op" id="1846807">]</span><br>
<span class="lineno">220</span><span class="op" id="1846809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1846812">//&nbsp;Implemented&nbsp;in&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="keyword" id="1846839">func</span>&nbsp;<span class="ident" id="1846844">runtime_registerPoolCleanup</span><span class="op" id="1846871">(</span><span class="ident" id="1846872">cleanup</span>&nbsp;<span class="keyword" id="1846880">func</span><span class="op" id="1846884">(</span><span class="op" id="1846885">)</span><span class="op" id="1846886">)</span><br>
<span class="lineno"></span><span class="keyword" id="1846888">func</span>&nbsp;<span class="ident" id="1846893">runtime_procPin</span><span class="op" id="1846908">(</span><span class="op" id="1846909">)</span>&nbsp;<span class="builtintype" id="1846911">int</span><br>
<span class="lineno">225</span><span class="keyword" id="1846915">func</span>&nbsp;<span class="ident" id="1846920">runtime_procUnpin</span><span class="op" id="1846937">(</span><span class="op" id="1846938">)</span>
</div>
</body>
</html>
