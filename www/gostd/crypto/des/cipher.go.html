<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html" class="current">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4479743">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4479798">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4479852">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4479903">package</span>&nbsp;<span class="ident" id="4479911">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4479916">import</span>&nbsp;<span class="op" id="4479923">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4479926">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4479943">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4479953">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4479956">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4479988">const</span>&nbsp;<span class="ident" id="4479994">BlockSize</span>&nbsp;<span class="op" id="4480004">=</span>&nbsp;<span class="num" id="4480006">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4480009">type</span>&nbsp;<span class="ident" id="4480014">KeySizeError</span>&nbsp;<span class="builtintype" id="4480027">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4480032">func</span>&nbsp;<span class="op" id="4480037">(</span><span class="ident" id="4480038">k</span>&nbsp;<span class="ident" id="4480040">KeySizeError</span><span class="op" id="4480052">)</span>&nbsp;<span class="ident" id="4480054">Error</span><span class="op" id="4480059">(</span><span class="op" id="4480060">)</span>&nbsp;<span class="builtintype" id="4480062">string</span>&nbsp;<span class="op" id="4480069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4480072">return</span>&nbsp;<span class="string" id="4480079">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="4480111">+</span>&nbsp;<span class="ident" id="4480113">strconv</span><span class="op" id="4480120">.</span><span class="ident" id="4480121">Itoa</span><span class="op" id="4480125">(</span><span class="builtintype" id="4480126">int</span><span class="op" id="4480129">(</span><span class="ident" id="4480130">k</span><span class="op" id="4480131">)</span><span class="op" id="4480132">)</span><br>
<span class="lineno"></span><span class="op" id="4480134">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4480137">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4480184">type</span>&nbsp;<span class="ident" id="4480189">desCipher</span>&nbsp;<span class="keyword" id="4480199">struct</span>&nbsp;<span class="op" id="4480206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4480209">subkeys</span>&nbsp;<span class="op" id="4480217">[</span><span class="num" id="4480218">16</span><span class="op" id="4480220">]</span><span class="ident" id="4480221">uint64</span><br>
<span class="lineno"></span><span class="op" id="4480228">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4480231">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4480284">func</span>&nbsp;<span class="ident" id="4480289">NewCipher</span><span class="op" id="4480298">(</span><span class="ident" id="4480299">key</span>&nbsp;<span class="op" id="4480303">[</span><span class="op" id="4480304">]</span><span class="builtintype" id="4480305">byte</span><span class="op" id="4480309">)</span>&nbsp;<span class="op" id="4480311">(</span><span class="ident" id="4480312">cipher</span><span class="op" id="4480318">.</span><span class="ident" id="4480319">Block</span><span class="op" id="4480324">,</span>&nbsp;<span class="builtintype" id="4480326">error</span><span class="op" id="4480331">)</span>&nbsp;<span class="op" id="4480333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4480336">if</span>&nbsp;<span class="builtinfunc" id="4480339">len</span><span class="op" id="4480342">(</span><span class="ident" id="4480343">key</span><span class="op" id="4480346">)</span>&nbsp;<span class="op" id="4480348">!=</span>&nbsp;<span class="num" id="4480351">8</span>&nbsp;<span class="op" id="4480353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4480357">return</span>&nbsp;<span class="builtintype" id="4480364">nil</span><span class="op" id="4480367">,</span>&nbsp;<span class="ident" id="4480369">KeySizeError</span><span class="op" id="4480381">(</span><span class="builtinfunc" id="4480382">len</span><span class="op" id="4480385">(</span><span class="ident" id="4480386">key</span><span class="op" id="4480389">)</span><span class="op" id="4480390">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4480393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4480397">c</span>&nbsp;<span class="op" id="4480399">:=</span>&nbsp;<span class="builtinfunc" id="4480402">new</span><span class="op" id="4480405">(</span><span class="ident" id="4480406">desCipher</span><span class="op" id="4480415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4480418">c</span><span class="op" id="4480419">.</span><span class="ident" id="4480420">generateSubkeys</span><span class="op" id="4480435">(</span><span class="ident" id="4480436">key</span><span class="op" id="4480439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4480442">return</span>&nbsp;<span class="ident" id="4480449">c</span><span class="op" id="4480450">,</span>&nbsp;<span class="builtintype" id="4480452">nil</span><br>
<span class="lineno">35</span><span class="op" id="4480456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4480459">func</span>&nbsp;<span class="op" id="4480464">(</span><span class="ident" id="4480465">c</span>&nbsp;<span class="op" id="4480467">*</span><span class="ident" id="4480468">desCipher</span><span class="op" id="4480477">)</span>&nbsp;<span class="ident" id="4480479">BlockSize</span><span class="op" id="4480488">(</span><span class="op" id="4480489">)</span>&nbsp;<span class="builtintype" id="4480491">int</span>&nbsp;<span class="op" id="4480495">{</span>&nbsp;<span class="keyword" id="4480497">return</span>&nbsp;<span class="ident" id="4480504">BlockSize</span>&nbsp;<span class="op" id="4480514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4480517">func</span>&nbsp;<span class="op" id="4480522">(</span><span class="ident" id="4480523">c</span>&nbsp;<span class="op" id="4480525">*</span><span class="ident" id="4480526">desCipher</span><span class="op" id="4480535">)</span>&nbsp;<span class="ident" id="4480537">Encrypt</span><span class="op" id="4480544">(</span><span class="ident" id="4480545">dst</span><span class="op" id="4480548">,</span>&nbsp;<span class="ident" id="4480550">src</span>&nbsp;<span class="op" id="4480554">[</span><span class="op" id="4480555">]</span><span class="builtintype" id="4480556">byte</span><span class="op" id="4480560">)</span>&nbsp;<span class="op" id="4480562">{</span>&nbsp;<span class="ident" id="4480564">encryptBlock</span><span class="op" id="4480576">(</span><span class="ident" id="4480577">c</span><span class="op" id="4480578">.</span><span class="ident" id="4480579">subkeys</span><span class="op" id="4480586">[</span><span class="op" id="4480587">:</span><span class="op" id="4480588">]</span><span class="op" id="4480589">,</span>&nbsp;<span class="ident" id="4480591">dst</span><span class="op" id="4480594">,</span>&nbsp;<span class="ident" id="4480596">src</span><span class="op" id="4480599">)</span>&nbsp;<span class="op" id="4480601">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4480604">func</span>&nbsp;<span class="op" id="4480609">(</span><span class="ident" id="4480610">c</span>&nbsp;<span class="op" id="4480612">*</span><span class="ident" id="4480613">desCipher</span><span class="op" id="4480622">)</span>&nbsp;<span class="ident" id="4480624">Decrypt</span><span class="op" id="4480631">(</span><span class="ident" id="4480632">dst</span><span class="op" id="4480635">,</span>&nbsp;<span class="ident" id="4480637">src</span>&nbsp;<span class="op" id="4480641">[</span><span class="op" id="4480642">]</span><span class="builtintype" id="4480643">byte</span><span class="op" id="4480647">)</span>&nbsp;<span class="op" id="4480649">{</span>&nbsp;<span class="ident" id="4480651">decryptBlock</span><span class="op" id="4480663">(</span><span class="ident" id="4480664">c</span><span class="op" id="4480665">.</span><span class="ident" id="4480666">subkeys</span><span class="op" id="4480673">[</span><span class="op" id="4480674">:</span><span class="op" id="4480675">]</span><span class="op" id="4480676">,</span>&nbsp;<span class="ident" id="4480678">dst</span><span class="op" id="4480681">,</span>&nbsp;<span class="ident" id="4480683">src</span><span class="op" id="4480686">)</span>&nbsp;<span class="op" id="4480688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4480691">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4480752">type</span>&nbsp;<span class="ident" id="4480757">tripleDESCipher</span>&nbsp;<span class="keyword" id="4480773">struct</span>&nbsp;<span class="op" id="4480780">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4480783">cipher1</span><span class="op" id="4480790">,</span>&nbsp;<span class="ident" id="4480792">cipher2</span><span class="op" id="4480799">,</span>&nbsp;<span class="ident" id="4480801">cipher3</span>&nbsp;<span class="ident" id="4480809">desCipher</span><br>
<span class="lineno"></span><span class="op" id="4480819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4480822">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4480884">func</span>&nbsp;<span class="ident" id="4480889">NewTripleDESCipher</span><span class="op" id="4480907">(</span><span class="ident" id="4480908">key</span>&nbsp;<span class="op" id="4480912">[</span><span class="op" id="4480913">]</span><span class="builtintype" id="4480914">byte</span><span class="op" id="4480918">)</span>&nbsp;<span class="op" id="4480920">(</span><span class="ident" id="4480921">cipher</span><span class="op" id="4480927">.</span><span class="ident" id="4480928">Block</span><span class="op" id="4480933">,</span>&nbsp;<span class="builtintype" id="4480935">error</span><span class="op" id="4480940">)</span>&nbsp;<span class="op" id="4480942">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4480945">if</span>&nbsp;<span class="builtinfunc" id="4480948">len</span><span class="op" id="4480951">(</span><span class="ident" id="4480952">key</span><span class="op" id="4480955">)</span>&nbsp;<span class="op" id="4480957">!=</span>&nbsp;<span class="num" id="4480960">24</span>&nbsp;<span class="op" id="4480963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4480967">return</span>&nbsp;<span class="builtintype" id="4480974">nil</span><span class="op" id="4480977">,</span>&nbsp;<span class="ident" id="4480979">KeySizeError</span><span class="op" id="4480991">(</span><span class="builtinfunc" id="4480992">len</span><span class="op" id="4480995">(</span><span class="ident" id="4480996">key</span><span class="op" id="4480999">)</span><span class="op" id="4481000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4481003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4481007">c</span>&nbsp;<span class="op" id="4481009">:=</span>&nbsp;<span class="builtinfunc" id="4481012">new</span><span class="op" id="4481015">(</span><span class="ident" id="4481016">tripleDESCipher</span><span class="op" id="4481031">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4481034">c</span><span class="op" id="4481035">.</span><span class="ident" id="4481036">cipher1</span><span class="op" id="4481043">.</span><span class="ident" id="4481044">generateSubkeys</span><span class="op" id="4481059">(</span><span class="ident" id="4481060">key</span><span class="op" id="4481063">[</span><span class="op" id="4481064">:</span><span class="num" id="4481065">8</span><span class="op" id="4481066">]</span><span class="op" id="4481067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4481070">c</span><span class="op" id="4481071">.</span><span class="ident" id="4481072">cipher2</span><span class="op" id="4481079">.</span><span class="ident" id="4481080">generateSubkeys</span><span class="op" id="4481095">(</span><span class="ident" id="4481096">key</span><span class="op" id="4481099">[</span><span class="num" id="4481100">8</span><span class="op" id="4481101">:</span><span class="num" id="4481102">16</span><span class="op" id="4481104">]</span><span class="op" id="4481105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4481108">c</span><span class="op" id="4481109">.</span><span class="ident" id="4481110">cipher3</span><span class="op" id="4481117">.</span><span class="ident" id="4481118">generateSubkeys</span><span class="op" id="4481133">(</span><span class="ident" id="4481134">key</span><span class="op" id="4481137">[</span><span class="num" id="4481138">16</span><span class="op" id="4481140">:</span><span class="op" id="4481141">]</span><span class="op" id="4481142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4481145">return</span>&nbsp;<span class="ident" id="4481152">c</span><span class="op" id="4481153">,</span>&nbsp;<span class="builtintype" id="4481155">nil</span><br>
<span class="lineno"></span><span class="op" id="4481159">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4481162">func</span>&nbsp;<span class="op" id="4481167">(</span><span class="ident" id="4481168">c</span>&nbsp;<span class="op" id="4481170">*</span><span class="ident" id="4481171">tripleDESCipher</span><span class="op" id="4481186">)</span>&nbsp;<span class="ident" id="4481188">BlockSize</span><span class="op" id="4481197">(</span><span class="op" id="4481198">)</span>&nbsp;<span class="builtintype" id="4481200">int</span>&nbsp;<span class="op" id="4481204">{</span>&nbsp;<span class="keyword" id="4481206">return</span>&nbsp;<span class="ident" id="4481213">BlockSize</span>&nbsp;<span class="op" id="4481223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4481226">func</span>&nbsp;<span class="op" id="4481231">(</span><span class="ident" id="4481232">c</span>&nbsp;<span class="op" id="4481234">*</span><span class="ident" id="4481235">tripleDESCipher</span><span class="op" id="4481250">)</span>&nbsp;<span class="ident" id="4481252">Encrypt</span><span class="op" id="4481259">(</span><span class="ident" id="4481260">dst</span><span class="op" id="4481263">,</span>&nbsp;<span class="ident" id="4481265">src</span>&nbsp;<span class="op" id="4481269">[</span><span class="op" id="4481270">]</span><span class="builtintype" id="4481271">byte</span><span class="op" id="4481275">)</span>&nbsp;<span class="op" id="4481277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4481280">c</span><span class="op" id="4481281">.</span><span class="ident" id="4481282">cipher1</span><span class="op" id="4481289">.</span><span class="ident" id="4481290">Encrypt</span><span class="op" id="4481297">(</span><span class="ident" id="4481298">dst</span><span class="op" id="4481301">,</span>&nbsp;<span class="ident" id="4481303">src</span><span class="op" id="4481306">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4481309">c</span><span class="op" id="4481310">.</span><span class="ident" id="4481311">cipher2</span><span class="op" id="4481318">.</span><span class="ident" id="4481319">Decrypt</span><span class="op" id="4481326">(</span><span class="ident" id="4481327">dst</span><span class="op" id="4481330">,</span>&nbsp;<span class="ident" id="4481332">dst</span><span class="op" id="4481335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4481338">c</span><span class="op" id="4481339">.</span><span class="ident" id="4481340">cipher3</span><span class="op" id="4481347">.</span><span class="ident" id="4481348">Encrypt</span><span class="op" id="4481355">(</span><span class="ident" id="4481356">dst</span><span class="op" id="4481359">,</span>&nbsp;<span class="ident" id="4481361">dst</span><span class="op" id="4481364">)</span><br>
<span class="lineno"></span><span class="op" id="4481366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4481369">func</span>&nbsp;<span class="op" id="4481374">(</span><span class="ident" id="4481375">c</span>&nbsp;<span class="op" id="4481377">*</span><span class="ident" id="4481378">tripleDESCipher</span><span class="op" id="4481393">)</span>&nbsp;<span class="ident" id="4481395">Decrypt</span><span class="op" id="4481402">(</span><span class="ident" id="4481403">dst</span><span class="op" id="4481406">,</span>&nbsp;<span class="ident" id="4481408">src</span>&nbsp;<span class="op" id="4481412">[</span><span class="op" id="4481413">]</span><span class="builtintype" id="4481414">byte</span><span class="op" id="4481418">)</span>&nbsp;<span class="op" id="4481420">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4481423">c</span><span class="op" id="4481424">.</span><span class="ident" id="4481425">cipher3</span><span class="op" id="4481432">.</span><span class="ident" id="4481433">Decrypt</span><span class="op" id="4481440">(</span><span class="ident" id="4481441">dst</span><span class="op" id="4481444">,</span>&nbsp;<span class="ident" id="4481446">src</span><span class="op" id="4481449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4481452">c</span><span class="op" id="4481453">.</span><span class="ident" id="4481454">cipher2</span><span class="op" id="4481461">.</span><span class="ident" id="4481462">Encrypt</span><span class="op" id="4481469">(</span><span class="ident" id="4481470">dst</span><span class="op" id="4481473">,</span>&nbsp;<span class="ident" id="4481475">dst</span><span class="op" id="4481478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4481481">c</span><span class="op" id="4481482">.</span><span class="ident" id="4481483">cipher1</span><span class="op" id="4481490">.</span><span class="ident" id="4481491">Decrypt</span><span class="op" id="4481498">(</span><span class="ident" id="4481499">dst</span><span class="op" id="4481502">,</span>&nbsp;<span class="ident" id="4481504">dst</span><span class="op" id="4481507">)</span><br>
<span class="lineno"></span><span class="op" id="4481509">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
