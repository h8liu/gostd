<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7884305">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7884360">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7884414">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7884465">package</span>&nbsp;<span class="ident" id="7884473">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7884484">import</span>&nbsp;<span class="op" id="7884491">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884494">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884503">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884512">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884522">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884530">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884537">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884543">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884554">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884564">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884572">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884583">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884594">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="7884601">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7884604">func</span>&nbsp;<span class="ident" id="7884609">TestQuotedPrintable</span><span class="op" id="7884628">(</span><span class="ident" id="7884629">t</span>&nbsp;<span class="op" id="7884631">*</span><span class="ident" id="7884632">testing</span><span class="op" id="7884639">.</span><span class="ident" id="7884640">T</span><span class="op" id="7884641">)</span>&nbsp;<span class="op" id="7884643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7884646">tests</span>&nbsp;<span class="op" id="7884652">:=</span>&nbsp;<span class="op" id="7884655">[</span><span class="op" id="7884656">]</span><span class="keyword" id="7884657">struct</span>&nbsp;<span class="op" id="7884664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7884668">in</span><span class="op" id="7884670">,</span>&nbsp;<span class="ident" id="7884672">want</span>&nbsp;<span class="builtintype" id="7884677">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7884686">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7884695">interface</span><span class="op" id="7884704">{</span><span class="op" id="7884705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884708">}</span><span class="op" id="7884709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884713">{</span><span class="ident" id="7884714">in</span><span class="op" id="7884716">:</span>&nbsp;<span class="string" id="7884718">&#34;&#34;</span><span class="op" id="7884720">,</span>&nbsp;<span class="ident" id="7884722">want</span><span class="op" id="7884726">:</span>&nbsp;<span class="string" id="7884728">&#34;&#34;</span><span class="op" id="7884730">}</span><span class="op" id="7884731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884735">{</span><span class="ident" id="7884736">in</span><span class="op" id="7884738">:</span>&nbsp;<span class="string" id="7884740">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7884749">,</span>&nbsp;<span class="ident" id="7884751">want</span><span class="op" id="7884755">:</span>&nbsp;<span class="string" id="7884757">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7884766">}</span><span class="op" id="7884767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884771">{</span><span class="ident" id="7884772">in</span><span class="op" id="7884774">:</span>&nbsp;<span class="string" id="7884776">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="7884788">,</span>&nbsp;<span class="ident" id="7884790">want</span><span class="op" id="7884794">:</span>&nbsp;<span class="string" id="7884796">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="7884806">}</span><span class="op" id="7884807">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884811">{</span><span class="ident" id="7884812">in</span><span class="op" id="7884814">:</span>&nbsp;<span class="string" id="7884816">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="7884828">,</span>&nbsp;<span class="ident" id="7884830">want</span><span class="op" id="7884834">:</span>&nbsp;<span class="string" id="7884836">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7884845">}</span><span class="op" id="7884846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884850">{</span><span class="ident" id="7884851">in</span><span class="op" id="7884853">:</span>&nbsp;<span class="string" id="7884855">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="7884866">,</span>&nbsp;<span class="ident" id="7884868">want</span><span class="op" id="7884872">:</span>&nbsp;<span class="string" id="7884874">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="7884885">}</span><span class="op" id="7884886">,</span>&nbsp;<span class="comment" id="7884888">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884907">{</span><span class="ident" id="7884908">in</span><span class="op" id="7884910">:</span>&nbsp;<span class="string" id="7884912">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="7884923">,</span>&nbsp;<span class="ident" id="7884925">want</span><span class="op" id="7884929">:</span>&nbsp;<span class="string" id="7884931">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7884940">,</span>&nbsp;<span class="ident" id="7884942">err</span><span class="op" id="7884945">:</span>&nbsp;<span class="ident" id="7884947">io</span><span class="op" id="7884949">.</span><span class="ident" id="7884950">ErrUnexpectedEOF</span><span class="op" id="7884966">}</span><span class="op" id="7884967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884971">{</span><span class="ident" id="7884972">in</span><span class="op" id="7884974">:</span>&nbsp;<span class="string" id="7884976">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="7884988">,</span>&nbsp;<span class="ident" id="7884990">want</span><span class="op" id="7884994">:</span>&nbsp;<span class="string" id="7884996">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7885005">,</span>&nbsp;<span class="ident" id="7885007">err</span><span class="op" id="7885010">:</span>&nbsp;<span class="string" id="7885012">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="7885063">}</span><span class="op" id="7885064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885068">{</span><span class="ident" id="7885069">in</span><span class="op" id="7885071">:</span>&nbsp;<span class="string" id="7885073">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="7885088">,</span>&nbsp;<span class="ident" id="7885090">want</span><span class="op" id="7885094">:</span>&nbsp;<span class="string" id="7885096">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="7885109">}</span><span class="op" id="7885110">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885114">{</span><span class="ident" id="7885115">in</span><span class="op" id="7885117">:</span>&nbsp;<span class="string" id="7885119">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7885140">,</span>&nbsp;<span class="ident" id="7885142">want</span><span class="op" id="7885146">:</span>&nbsp;<span class="string" id="7885148">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="7885160">}</span><span class="op" id="7885161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885165">{</span><span class="ident" id="7885166">in</span><span class="op" id="7885168">:</span>&nbsp;<span class="string" id="7885170">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7885185">,</span>&nbsp;<span class="ident" id="7885187">want</span><span class="op" id="7885191">:</span>&nbsp;<span class="string" id="7885193">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="7885202">}</span><span class="op" id="7885203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885207">{</span><span class="ident" id="7885208">in</span><span class="op" id="7885210">:</span>&nbsp;<span class="string" id="7885212">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7885225">,</span>&nbsp;<span class="ident" id="7885227">want</span><span class="op" id="7885231">:</span>&nbsp;<span class="string" id="7885233">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="7885242">}</span><span class="op" id="7885243">,</span>&nbsp;<span class="comment" id="7885245">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885275">{</span><span class="ident" id="7885276">in</span><span class="op" id="7885278">:</span>&nbsp;<span class="string" id="7885280">&#34;foo=\nbar&#34;</span><span class="op" id="7885291">,</span>&nbsp;<span class="ident" id="7885293">want</span><span class="op" id="7885297">:</span>&nbsp;<span class="string" id="7885299">&#34;foobar&#34;</span><span class="op" id="7885307">}</span><span class="op" id="7885308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885312">{</span><span class="ident" id="7885313">in</span><span class="op" id="7885315">:</span>&nbsp;<span class="string" id="7885317">&#34;foo\x00bar&#34;</span><span class="op" id="7885329">,</span>&nbsp;<span class="ident" id="7885331">want</span><span class="op" id="7885335">:</span>&nbsp;<span class="string" id="7885337">&#34;foo&#34;</span><span class="op" id="7885342">,</span>&nbsp;<span class="ident" id="7885344">err</span><span class="op" id="7885347">:</span>&nbsp;<span class="string" id="7885349">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="7885414">}</span><span class="op" id="7885415">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885419">{</span><span class="ident" id="7885420">in</span><span class="op" id="7885422">:</span>&nbsp;<span class="string" id="7885424">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="7885437">,</span>&nbsp;<span class="ident" id="7885439">want</span><span class="op" id="7885443">:</span>&nbsp;<span class="string" id="7885445">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7885454">,</span>&nbsp;<span class="ident" id="7885456">err</span><span class="op" id="7885459">:</span>&nbsp;<span class="string" id="7885461">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="7885526">}</span><span class="op" id="7885527">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7885532">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885549">{</span><span class="ident" id="7885550">in</span><span class="op" id="7885552">:</span>&nbsp;<span class="string" id="7885554">&#34;=3D30\n&#34;</span><span class="op" id="7885563">,</span>&nbsp;<span class="ident" id="7885565">want</span><span class="op" id="7885569">:</span>&nbsp;<span class="string" id="7885571">&#34;=30\n&#34;</span><span class="op" id="7885578">}</span><span class="op" id="7885579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885583">{</span><span class="ident" id="7885584">in</span><span class="op" id="7885586">:</span>&nbsp;<span class="string" id="7885588">&#34;=00=FF0=\n&#34;</span><span class="op" id="7885600">,</span>&nbsp;<span class="ident" id="7885602">want</span><span class="op" id="7885606">:</span>&nbsp;<span class="string" id="7885608">&#34;\x00\xff0&#34;</span><span class="op" id="7885619">}</span><span class="op" id="7885620">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7885625">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885650">{</span><span class="ident" id="7885651">in</span><span class="op" id="7885653">:</span>&nbsp;<span class="string" id="7885655">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="7885664">,</span>&nbsp;<span class="ident" id="7885666">want</span><span class="op" id="7885670">:</span>&nbsp;<span class="string" id="7885672">&#34;foo\n&#34;</span><span class="op" id="7885679">}</span><span class="op" id="7885680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885684">{</span><span class="ident" id="7885685">in</span><span class="op" id="7885687">:</span>&nbsp;<span class="string" id="7885689">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="7885719">,</span>&nbsp;<span class="ident" id="7885721">want</span><span class="op" id="7885725">:</span>&nbsp;<span class="string" id="7885727">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="7885750">}</span><span class="op" id="7885751">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7885756">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7885831">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885896">{</span><span class="ident" id="7885897">in</span><span class="op" id="7885899">:</span>&nbsp;<span class="string" id="7885901">&#34;foo\nbar&#34;</span><span class="op" id="7885911">,</span>&nbsp;<span class="ident" id="7885913">want</span><span class="op" id="7885917">:</span>&nbsp;<span class="string" id="7885919">&#34;foo\nbar&#34;</span><span class="op" id="7885929">}</span><span class="op" id="7885930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885934">{</span><span class="ident" id="7885935">in</span><span class="op" id="7885937">:</span>&nbsp;<span class="string" id="7885939">&#34;foo\rbar&#34;</span><span class="op" id="7885949">,</span>&nbsp;<span class="ident" id="7885951">want</span><span class="op" id="7885955">:</span>&nbsp;<span class="string" id="7885957">&#34;foo\rbar&#34;</span><span class="op" id="7885967">}</span><span class="op" id="7885968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885972">{</span><span class="ident" id="7885973">in</span><span class="op" id="7885975">:</span>&nbsp;<span class="string" id="7885977">&#34;foo\r\nbar&#34;</span><span class="op" id="7885989">,</span>&nbsp;<span class="ident" id="7885991">want</span><span class="op" id="7885995">:</span>&nbsp;<span class="string" id="7885997">&#34;foo\r\nbar&#34;</span><span class="op" id="7886009">}</span><span class="op" id="7886010">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7886015">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886057">{</span><span class="ident" id="7886058">in</span><span class="op" id="7886060">:</span>&nbsp;<span class="string" id="7886062">&#34;foo=\r\nbar&#34;</span><span class="op" id="7886075">,</span>&nbsp;<span class="ident" id="7886077">want</span><span class="op" id="7886081">:</span>&nbsp;<span class="string" id="7886083">&#34;foobar&#34;</span><span class="op" id="7886091">}</span><span class="op" id="7886092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886096">{</span><span class="ident" id="7886097">in</span><span class="op" id="7886099">:</span>&nbsp;<span class="string" id="7886101">&#34;foo=\nbar&#34;</span><span class="op" id="7886112">,</span>&nbsp;<span class="ident" id="7886114">want</span><span class="op" id="7886118">:</span>&nbsp;<span class="string" id="7886120">&#34;foobar&#34;</span><span class="op" id="7886128">}</span><span class="op" id="7886129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886133">{</span><span class="ident" id="7886134">in</span><span class="op" id="7886136">:</span>&nbsp;<span class="string" id="7886138">&#34;foo=\rbar&#34;</span><span class="op" id="7886149">,</span>&nbsp;<span class="ident" id="7886151">want</span><span class="op" id="7886155">:</span>&nbsp;<span class="string" id="7886157">&#34;foo&#34;</span><span class="op" id="7886162">,</span>&nbsp;<span class="ident" id="7886164">err</span><span class="op" id="7886167">:</span>&nbsp;<span class="string" id="7886169">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="7886220">}</span><span class="op" id="7886221">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886225">{</span><span class="ident" id="7886226">in</span><span class="op" id="7886228">:</span>&nbsp;<span class="string" id="7886230">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="7886248">,</span>&nbsp;<span class="ident" id="7886250">want</span><span class="op" id="7886254">:</span>&nbsp;<span class="string" id="7886256">&#34;foo&#34;</span><span class="op" id="7886261">,</span>&nbsp;<span class="ident" id="7886263">err</span><span class="op" id="7886266">:</span>&nbsp;<span class="string" id="7886268">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="7886315">}</span><span class="op" id="7886316">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7886321">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886349">{</span><span class="ident" id="7886350">in</span><span class="op" id="7886352">:</span>&nbsp;<span class="string" id="7886354">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="7886375">+</span>&nbsp;<span class="string" id="7886377">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="7886403">+</span>&nbsp;<span class="string" id="7886405">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7886436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886441">want</span><span class="op" id="7886445">:</span>&nbsp;<span class="string" id="7886447">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7886513">}</span><span class="op" id="7886514">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886520">for</span>&nbsp;<span class="ident" id="7886524">_</span><span class="op" id="7886525">,</span>&nbsp;<span class="ident" id="7886527">tt</span>&nbsp;<span class="op" id="7886530">:=</span>&nbsp;<span class="keyword" id="7886533">range</span>&nbsp;<span class="ident" id="7886539">tests</span>&nbsp;<span class="op" id="7886545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886549">var</span>&nbsp;<span class="ident" id="7886553">buf</span>&nbsp;<span class="ident" id="7886557">bytes</span><span class="op" id="7886562">.</span><span class="ident" id="7886563">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886572">_</span><span class="op" id="7886573">,</span>&nbsp;<span class="ident" id="7886575">err</span>&nbsp;<span class="op" id="7886579">:=</span>&nbsp;<span class="ident" id="7886582">io</span><span class="op" id="7886584">.</span><span class="ident" id="7886585">Copy</span><span class="op" id="7886589">(</span><span class="op" id="7886590">&amp;</span><span class="ident" id="7886591">buf</span><span class="op" id="7886594">,</span>&nbsp;<span class="ident" id="7886596">newQuotedPrintableReader</span><span class="op" id="7886620">(</span><span class="ident" id="7886621">strings</span><span class="op" id="7886628">.</span><span class="ident" id="7886629">NewReader</span><span class="op" id="7886638">(</span><span class="ident" id="7886639">tt</span><span class="op" id="7886641">.</span><span class="ident" id="7886642">in</span><span class="op" id="7886644">)</span><span class="op" id="7886645">)</span><span class="op" id="7886646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886650">if</span>&nbsp;<span class="ident" id="7886653">got</span>&nbsp;<span class="op" id="7886657">:=</span>&nbsp;<span class="ident" id="7886660">buf</span><span class="op" id="7886663">.</span><span class="ident" id="7886664">String</span><span class="op" id="7886670">(</span><span class="op" id="7886671">)</span><span class="op" id="7886672">;</span>&nbsp;<span class="ident" id="7886674">got</span>&nbsp;<span class="op" id="7886678">!=</span>&nbsp;<span class="ident" id="7886681">tt</span><span class="op" id="7886683">.</span><span class="ident" id="7886684">want</span>&nbsp;<span class="op" id="7886689">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886694">t</span><span class="op" id="7886695">.</span><span class="ident" id="7886696">Errorf</span><span class="op" id="7886702">(</span><span class="string" id="7886703">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7886728">,</span>&nbsp;<span class="ident" id="7886730">tt</span><span class="op" id="7886732">.</span><span class="ident" id="7886733">in</span><span class="op" id="7886735">,</span>&nbsp;<span class="ident" id="7886737">got</span><span class="op" id="7886740">,</span>&nbsp;<span class="ident" id="7886742">tt</span><span class="op" id="7886744">.</span><span class="ident" id="7886745">want</span><span class="op" id="7886749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886757">switch</span>&nbsp;<span class="ident" id="7886764">verr</span>&nbsp;<span class="op" id="7886769">:=</span>&nbsp;<span class="ident" id="7886772">tt</span><span class="op" id="7886774">.</span><span class="ident" id="7886775">err</span><span class="op" id="7886778">.</span><span class="op" id="7886779">(</span><span class="keyword" id="7886780">type</span><span class="op" id="7886784">)</span>&nbsp;<span class="op" id="7886786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886790">case</span>&nbsp;<span class="ident" id="7886795">nil</span><span class="op" id="7886798">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886803">if</span>&nbsp;<span class="ident" id="7886806">err</span>&nbsp;<span class="op" id="7886810">!=</span>&nbsp;<span class="ident" id="7886813">nil</span>&nbsp;<span class="op" id="7886817">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886823">t</span><span class="op" id="7886824">.</span><span class="ident" id="7886825">Errorf</span><span class="op" id="7886831">(</span><span class="string" id="7886832">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7886866">,</span>&nbsp;<span class="ident" id="7886868">tt</span><span class="op" id="7886870">.</span><span class="ident" id="7886871">in</span><span class="op" id="7886873">,</span>&nbsp;<span class="ident" id="7886875">err</span><span class="op" id="7886878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886887">case</span>&nbsp;<span class="builtintype" id="7886892">string</span><span class="op" id="7886898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886903">if</span>&nbsp;<span class="ident" id="7886906">got</span>&nbsp;<span class="op" id="7886910">:=</span>&nbsp;<span class="ident" id="7886913">fmt</span><span class="op" id="7886916">.</span><span class="ident" id="7886917">Sprint</span><span class="op" id="7886923">(</span><span class="ident" id="7886924">err</span><span class="op" id="7886927">)</span><span class="op" id="7886928">;</span>&nbsp;<span class="ident" id="7886930">got</span>&nbsp;<span class="op" id="7886934">!=</span>&nbsp;<span class="ident" id="7886937">verr</span>&nbsp;<span class="op" id="7886942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886948">t</span><span class="op" id="7886949">.</span><span class="ident" id="7886950">Errorf</span><span class="op" id="7886956">(</span><span class="string" id="7886957">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7886988">,</span>&nbsp;<span class="ident" id="7886990">tt</span><span class="op" id="7886992">.</span><span class="ident" id="7886993">in</span><span class="op" id="7886995">,</span>&nbsp;<span class="ident" id="7886997">got</span><span class="op" id="7887000">,</span>&nbsp;<span class="ident" id="7887002">verr</span><span class="op" id="7887006">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887015">case</span>&nbsp;<span class="builtintype" id="7887020">error</span><span class="op" id="7887025">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887030">if</span>&nbsp;<span class="ident" id="7887033">err</span>&nbsp;<span class="op" id="7887037">!=</span>&nbsp;<span class="ident" id="7887040">verr</span>&nbsp;<span class="op" id="7887045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887051">t</span><span class="op" id="7887052">.</span><span class="ident" id="7887053">Errorf</span><span class="op" id="7887059">(</span><span class="string" id="7887060">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7887091">,</span>&nbsp;<span class="ident" id="7887093">tt</span><span class="op" id="7887095">.</span><span class="ident" id="7887096">in</span><span class="op" id="7887098">,</span>&nbsp;<span class="ident" id="7887100">err</span><span class="op" id="7887103">,</span>&nbsp;<span class="ident" id="7887105">verr</span><span class="op" id="7887109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887114">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="7887124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7887127">func</span>&nbsp;<span class="ident" id="7887132">everySequence</span><span class="op" id="7887145">(</span><span class="ident" id="7887146">base</span><span class="op" id="7887150">,</span>&nbsp;<span class="ident" id="7887152">alpha</span>&nbsp;<span class="builtintype" id="7887158">string</span><span class="op" id="7887164">,</span>&nbsp;<span class="ident" id="7887166">length</span>&nbsp;<span class="builtintype" id="7887173">int</span><span class="op" id="7887176">,</span>&nbsp;<span class="ident" id="7887178">fn</span>&nbsp;<span class="keyword" id="7887181">func</span><span class="op" id="7887185">(</span><span class="builtintype" id="7887186">string</span><span class="op" id="7887192">)</span><span class="op" id="7887193">)</span>&nbsp;<span class="op" id="7887195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887198">if</span>&nbsp;<span class="builtinfunc" id="7887201">len</span><span class="op" id="7887204">(</span><span class="ident" id="7887205">base</span><span class="op" id="7887209">)</span>&nbsp;<span class="op" id="7887211">==</span>&nbsp;<span class="ident" id="7887214">length</span>&nbsp;<span class="op" id="7887221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887225">fn</span><span class="op" id="7887227">(</span><span class="ident" id="7887228">base</span><span class="op" id="7887232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887236">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887244">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887247">for</span>&nbsp;<span class="ident" id="7887251">i</span>&nbsp;<span class="op" id="7887253">:=</span>&nbsp;<span class="num" id="7887256">0</span><span class="op" id="7887257">;</span>&nbsp;<span class="ident" id="7887259">i</span>&nbsp;<span class="op" id="7887261">&lt;</span>&nbsp;<span class="builtinfunc" id="7887263">len</span><span class="op" id="7887266">(</span><span class="ident" id="7887267">alpha</span><span class="op" id="7887272">)</span><span class="op" id="7887273">;</span>&nbsp;<span class="ident" id="7887275">i</span><span class="op" id="7887276">++</span>&nbsp;<span class="op" id="7887279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887283">everySequence</span><span class="op" id="7887296">(</span><span class="ident" id="7887297">base</span><span class="op" id="7887301">+</span><span class="ident" id="7887302">alpha</span><span class="op" id="7887307">[</span><span class="ident" id="7887308">i</span><span class="op" id="7887309">:</span><span class="ident" id="7887310">i</span><span class="op" id="7887311">+</span><span class="num" id="7887312">1</span><span class="op" id="7887313">]</span><span class="op" id="7887314">,</span>&nbsp;<span class="ident" id="7887316">alpha</span><span class="op" id="7887321">,</span>&nbsp;<span class="ident" id="7887323">length</span><span class="op" id="7887329">,</span>&nbsp;<span class="ident" id="7887331">fn</span><span class="op" id="7887333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887336">}</span><br>
<span class="lineno"></span><span class="op" id="7887338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="7887341">var</span>&nbsp;<span class="ident" id="7887345">useQprint</span>&nbsp;<span class="op" id="7887355">=</span>&nbsp;<span class="ident" id="7887357">flag</span><span class="op" id="7887361">.</span><span class="ident" id="7887362">Bool</span><span class="op" id="7887366">(</span><span class="string" id="7887367">&#34;qprint&#34;</span><span class="op" id="7887375">,</span>&nbsp;<span class="builtintype" id="7887377">false</span><span class="op" id="7887382">,</span>&nbsp;<span class="string" id="7887384">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="7887423">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7887426">var</span>&nbsp;<span class="ident" id="7887430">badSoftRx</span>&nbsp;<span class="op" id="7887440">=</span>&nbsp;<span class="ident" id="7887442">regexp</span><span class="op" id="7887448">.</span><span class="ident" id="7887449">MustCompile</span><span class="op" id="7887460">(</span><span class="string" id="7887461">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="7887516">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7887519">func</span>&nbsp;<span class="ident" id="7887524">TestQPExhaustive</span><span class="op" id="7887540">(</span><span class="ident" id="7887541">t</span>&nbsp;<span class="op" id="7887543">*</span><span class="ident" id="7887544">testing</span><span class="op" id="7887551">.</span><span class="ident" id="7887552">T</span><span class="op" id="7887553">)</span>&nbsp;<span class="op" id="7887555">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887558">if</span>&nbsp;<span class="op" id="7887561">*</span><span class="ident" id="7887562">useQprint</span>&nbsp;<span class="op" id="7887572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887576">_</span><span class="op" id="7887577">,</span>&nbsp;<span class="ident" id="7887579">err</span>&nbsp;<span class="op" id="7887583">:=</span>&nbsp;<span class="ident" id="7887586">exec</span><span class="op" id="7887590">.</span><span class="ident" id="7887591">LookPath</span><span class="op" id="7887599">(</span><span class="string" id="7887600">&#34;qprint&#34;</span><span class="op" id="7887608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887612">if</span>&nbsp;<span class="ident" id="7887615">err</span>&nbsp;<span class="op" id="7887619">!=</span>&nbsp;<span class="ident" id="7887622">nil</span>&nbsp;<span class="op" id="7887626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887631">t</span><span class="op" id="7887632">.</span><span class="ident" id="7887633">Fatalf</span><span class="op" id="7887639">(</span><span class="string" id="7887640">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="7887670">,</span>&nbsp;<span class="ident" id="7887672">err</span><span class="op" id="7887675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887679">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887686">var</span>&nbsp;<span class="ident" id="7887690">buf</span>&nbsp;<span class="ident" id="7887694">bytes</span><span class="op" id="7887699">.</span><span class="ident" id="7887700">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887708">res</span>&nbsp;<span class="op" id="7887712">:=</span>&nbsp;<span class="builtinfunc" id="7887715">make</span><span class="op" id="7887719">(</span><span class="keyword" id="7887720">map</span><span class="op" id="7887723">[</span><span class="builtintype" id="7887724">string</span><span class="op" id="7887730">]</span><span class="builtintype" id="7887731">int</span><span class="op" id="7887734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887737">everySequence</span><span class="op" id="7887750">(</span><span class="string" id="7887751">&#34;&#34;</span><span class="op" id="7887753">,</span>&nbsp;<span class="string" id="7887755">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="7887765">,</span>&nbsp;<span class="num" id="7887767">6</span><span class="op" id="7887768">,</span>&nbsp;<span class="keyword" id="7887770">func</span><span class="op" id="7887774">(</span><span class="ident" id="7887775">s</span>&nbsp;<span class="builtintype" id="7887777">string</span><span class="op" id="7887783">)</span>&nbsp;<span class="op" id="7887785">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887789">if</span>&nbsp;<span class="ident" id="7887792">strings</span><span class="op" id="7887799">.</span><span class="ident" id="7887800">HasSuffix</span><span class="op" id="7887809">(</span><span class="ident" id="7887810">s</span><span class="op" id="7887811">,</span>&nbsp;<span class="string" id="7887813">&#34;=&#34;</span><span class="op" id="7887816">)</span>&nbsp;<span class="op" id="7887818">||</span>&nbsp;<span class="ident" id="7887821">strings</span><span class="op" id="7887828">.</span><span class="ident" id="7887829">Contains</span><span class="op" id="7887837">(</span><span class="ident" id="7887838">s</span><span class="op" id="7887839">,</span>&nbsp;<span class="string" id="7887841">&#34;==&#34;</span><span class="op" id="7887845">)</span>&nbsp;<span class="op" id="7887847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887852">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887865">buf</span><span class="op" id="7887868">.</span><span class="ident" id="7887869">Reset</span><span class="op" id="7887874">(</span><span class="op" id="7887875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887879">_</span><span class="op" id="7887880">,</span>&nbsp;<span class="ident" id="7887882">err</span>&nbsp;<span class="op" id="7887886">:=</span>&nbsp;<span class="ident" id="7887889">io</span><span class="op" id="7887891">.</span><span class="ident" id="7887892">Copy</span><span class="op" id="7887896">(</span><span class="op" id="7887897">&amp;</span><span class="ident" id="7887898">buf</span><span class="op" id="7887901">,</span>&nbsp;<span class="ident" id="7887903">newQuotedPrintableReader</span><span class="op" id="7887927">(</span><span class="ident" id="7887928">strings</span><span class="op" id="7887935">.</span><span class="ident" id="7887936">NewReader</span><span class="op" id="7887945">(</span><span class="ident" id="7887946">s</span><span class="op" id="7887947">)</span><span class="op" id="7887948">)</span><span class="op" id="7887949">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887953">if</span>&nbsp;<span class="ident" id="7887956">err</span>&nbsp;<span class="op" id="7887960">!=</span>&nbsp;<span class="ident" id="7887963">nil</span>&nbsp;<span class="op" id="7887967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887972">errStr</span>&nbsp;<span class="op" id="7887979">:=</span>&nbsp;<span class="ident" id="7887982">err</span><span class="op" id="7887985">.</span><span class="ident" id="7887986">Error</span><span class="op" id="7887991">(</span><span class="op" id="7887992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887997">if</span>&nbsp;<span class="ident" id="7888000">strings</span><span class="op" id="7888007">.</span><span class="ident" id="7888008">Contains</span><span class="op" id="7888016">(</span><span class="ident" id="7888017">errStr</span><span class="op" id="7888023">,</span>&nbsp;<span class="string" id="7888025">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="7888049">)</span>&nbsp;<span class="op" id="7888051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888057">errStr</span>&nbsp;<span class="op" id="7888064">=</span>&nbsp;<span class="string" id="7888066">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888093">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888098">res</span><span class="op" id="7888101">[</span><span class="ident" id="7888102">errStr</span><span class="op" id="7888108">]</span><span class="op" id="7888109">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888115">if</span>&nbsp;<span class="ident" id="7888118">strings</span><span class="op" id="7888125">.</span><span class="ident" id="7888126">Contains</span><span class="op" id="7888134">(</span><span class="ident" id="7888135">errStr</span><span class="op" id="7888141">,</span>&nbsp;<span class="string" id="7888143">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="7888179">)</span>&nbsp;<span class="op" id="7888181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888187">if</span>&nbsp;<span class="ident" id="7888190">strings</span><span class="op" id="7888197">.</span><span class="ident" id="7888198">HasSuffix</span><span class="op" id="7888207">(</span><span class="ident" id="7888208">errStr</span><span class="op" id="7888214">,</span>&nbsp;<span class="string" id="7888216">&#34;0x20&#34;</span><span class="op" id="7888222">)</span>&nbsp;<span class="op" id="7888224">&amp;&amp;</span>&nbsp;<span class="op" id="7888227">(</span><span class="ident" id="7888228">strings</span><span class="op" id="7888235">.</span><span class="ident" id="7888236">Contains</span><span class="op" id="7888244">(</span><span class="ident" id="7888245">s</span><span class="op" id="7888246">,</span>&nbsp;<span class="string" id="7888248">&#34;=0&nbsp;&#34;</span><span class="op" id="7888253">)</span>&nbsp;<span class="op" id="7888255">||</span>&nbsp;<span class="ident" id="7888258">strings</span><span class="op" id="7888265">.</span><span class="ident" id="7888266">Contains</span><span class="op" id="7888274">(</span><span class="ident" id="7888275">s</span><span class="op" id="7888276">,</span>&nbsp;<span class="string" id="7888278">&#34;=A&nbsp;&#34;</span><span class="op" id="7888283">)</span>&nbsp;<span class="op" id="7888285">||</span>&nbsp;<span class="ident" id="7888288">strings</span><span class="op" id="7888295">.</span><span class="ident" id="7888296">Contains</span><span class="op" id="7888304">(</span><span class="ident" id="7888305">s</span><span class="op" id="7888306">,</span>&nbsp;<span class="string" id="7888308">&#34;=&nbsp;&#34;</span><span class="op" id="7888312">)</span><span class="op" id="7888313">)</span>&nbsp;<span class="op" id="7888315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888322">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888333">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888339">if</span>&nbsp;<span class="ident" id="7888342">strings</span><span class="op" id="7888349">.</span><span class="ident" id="7888350">HasSuffix</span><span class="op" id="7888359">(</span><span class="ident" id="7888360">errStr</span><span class="op" id="7888366">,</span>&nbsp;<span class="string" id="7888368">&#34;0x3d&#34;</span><span class="op" id="7888374">)</span>&nbsp;<span class="op" id="7888376">&amp;&amp;</span>&nbsp;<span class="op" id="7888379">(</span><span class="ident" id="7888380">strings</span><span class="op" id="7888387">.</span><span class="ident" id="7888388">Contains</span><span class="op" id="7888396">(</span><span class="ident" id="7888397">s</span><span class="op" id="7888398">,</span>&nbsp;<span class="string" id="7888400">&#34;=0=&#34;</span><span class="op" id="7888405">)</span>&nbsp;<span class="op" id="7888407">||</span>&nbsp;<span class="ident" id="7888410">strings</span><span class="op" id="7888417">.</span><span class="ident" id="7888418">Contains</span><span class="op" id="7888426">(</span><span class="ident" id="7888427">s</span><span class="op" id="7888428">,</span>&nbsp;<span class="string" id="7888430">&#34;=A=&#34;</span><span class="op" id="7888435">)</span><span class="op" id="7888436">)</span>&nbsp;<span class="op" id="7888438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888445">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888462">if</span>&nbsp;<span class="ident" id="7888465">strings</span><span class="op" id="7888472">.</span><span class="ident" id="7888473">HasSuffix</span><span class="op" id="7888482">(</span><span class="ident" id="7888483">errStr</span><span class="op" id="7888489">,</span>&nbsp;<span class="string" id="7888491">&#34;0x0a&#34;</span><span class="op" id="7888497">)</span>&nbsp;<span class="op" id="7888499">||</span>&nbsp;<span class="ident" id="7888502">strings</span><span class="op" id="7888509">.</span><span class="ident" id="7888510">HasSuffix</span><span class="op" id="7888519">(</span><span class="ident" id="7888520">errStr</span><span class="op" id="7888526">,</span>&nbsp;<span class="string" id="7888528">&#34;0x0d&#34;</span><span class="op" id="7888534">)</span>&nbsp;<span class="op" id="7888536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7888543">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888627">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888648">if</span>&nbsp;<span class="ident" id="7888651">strings</span><span class="op" id="7888658">.</span><span class="ident" id="7888659">Contains</span><span class="op" id="7888667">(</span><span class="ident" id="7888668">errStr</span><span class="op" id="7888674">,</span>&nbsp;<span class="string" id="7888676">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="7888692">)</span>&nbsp;<span class="op" id="7888694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888700">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888715">if</span>&nbsp;<span class="ident" id="7888718">errStr</span>&nbsp;<span class="op" id="7888725">==</span>&nbsp;<span class="string" id="7888728">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="7888752">&amp;&amp;</span>&nbsp;<span class="ident" id="7888755">badSoftRx</span><span class="op" id="7888764">.</span><span class="ident" id="7888765">MatchString</span><span class="op" id="7888776">(</span><span class="ident" id="7888777">s</span><span class="op" id="7888778">)</span>&nbsp;<span class="op" id="7888780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888786">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888801">t</span><span class="op" id="7888802">.</span><span class="ident" id="7888803">Errorf</span><span class="op" id="7888809">(</span><span class="string" id="7888810">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7888827">,</span>&nbsp;<span class="ident" id="7888829">s</span><span class="op" id="7888830">,</span>&nbsp;<span class="ident" id="7888832">err</span><span class="op" id="7888835">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888840">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888853">if</span>&nbsp;<span class="op" id="7888856">*</span><span class="ident" id="7888857">useQprint</span>&nbsp;<span class="op" id="7888867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888872">cmd</span>&nbsp;<span class="op" id="7888876">:=</span>&nbsp;<span class="ident" id="7888879">exec</span><span class="op" id="7888883">.</span><span class="ident" id="7888884">Command</span><span class="op" id="7888891">(</span><span class="string" id="7888892">&#34;qprint&#34;</span><span class="op" id="7888900">,</span>&nbsp;<span class="string" id="7888902">&#34;-d&#34;</span><span class="op" id="7888906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888911">cmd</span><span class="op" id="7888914">.</span><span class="ident" id="7888915">Stdin</span>&nbsp;<span class="op" id="7888921">=</span>&nbsp;<span class="ident" id="7888923">strings</span><span class="op" id="7888930">.</span><span class="ident" id="7888931">NewReader</span><span class="op" id="7888940">(</span><span class="ident" id="7888941">s</span><span class="op" id="7888942">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888947">stderr</span><span class="op" id="7888953">,</span>&nbsp;<span class="ident" id="7888955">err</span>&nbsp;<span class="op" id="7888959">:=</span>&nbsp;<span class="ident" id="7888962">cmd</span><span class="op" id="7888965">.</span><span class="ident" id="7888966">StderrPipe</span><span class="op" id="7888976">(</span><span class="op" id="7888977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888982">if</span>&nbsp;<span class="ident" id="7888985">err</span>&nbsp;<span class="op" id="7888989">!=</span>&nbsp;<span class="ident" id="7888992">nil</span>&nbsp;<span class="op" id="7888996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7889002">panic</span><span class="op" id="7889007">(</span><span class="ident" id="7889008">err</span><span class="op" id="7889011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889021">qpres</span>&nbsp;<span class="op" id="7889027">:=</span>&nbsp;<span class="builtinfunc" id="7889030">make</span><span class="op" id="7889034">(</span><span class="keyword" id="7889035">chan</span>&nbsp;<span class="keyword" id="7889040">interface</span><span class="op" id="7889049">{</span><span class="op" id="7889050">}</span><span class="op" id="7889051">,</span>&nbsp;<span class="num" id="7889053">2</span><span class="op" id="7889054">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889059">go</span>&nbsp;<span class="keyword" id="7889062">func</span><span class="op" id="7889066">(</span><span class="op" id="7889067">)</span>&nbsp;<span class="op" id="7889069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889075">br</span>&nbsp;<span class="op" id="7889078">:=</span>&nbsp;<span class="ident" id="7889081">bufio</span><span class="op" id="7889086">.</span><span class="ident" id="7889087">NewReader</span><span class="op" id="7889096">(</span><span class="ident" id="7889097">stderr</span><span class="op" id="7889103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889109">s</span><span class="op" id="7889110">,</span>&nbsp;<span class="ident" id="7889112">_</span>&nbsp;<span class="op" id="7889114">:=</span>&nbsp;<span class="ident" id="7889117">br</span><span class="op" id="7889119">.</span><span class="ident" id="7889120">ReadString</span><span class="op" id="7889130">(</span><span class="string" id="7889131">&#39;\n&#39;</span><span class="op" id="7889135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889141">if</span>&nbsp;<span class="ident" id="7889144">s</span>&nbsp;<span class="op" id="7889146">!=</span>&nbsp;<span class="string" id="7889149">&#34;&#34;</span>&nbsp;<span class="op" id="7889152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889159">qpres</span>&nbsp;<span class="op" id="7889165">&lt;-</span>&nbsp;<span class="ident" id="7889168">errors</span><span class="op" id="7889174">.</span><span class="ident" id="7889175">New</span><span class="op" id="7889178">(</span><span class="ident" id="7889179">s</span><span class="op" id="7889180">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889187">if</span>&nbsp;<span class="ident" id="7889190">cmd</span><span class="op" id="7889193">.</span><span class="ident" id="7889194">Process</span>&nbsp;<span class="op" id="7889202">!=</span>&nbsp;<span class="ident" id="7889205">nil</span>&nbsp;<span class="op" id="7889209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7889217">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7889267">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889305">cmd</span><span class="op" id="7889308">.</span><span class="ident" id="7889309">Process</span><span class="op" id="7889316">.</span><span class="ident" id="7889317">Kill</span><span class="op" id="7889321">(</span><span class="op" id="7889322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889329">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889340">}</span><span class="op" id="7889341">(</span><span class="op" id="7889342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889347">go</span>&nbsp;<span class="keyword" id="7889350">func</span><span class="op" id="7889354">(</span><span class="op" id="7889355">)</span>&nbsp;<span class="op" id="7889357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889363">want</span><span class="op" id="7889367">,</span>&nbsp;<span class="ident" id="7889369">err</span>&nbsp;<span class="op" id="7889373">:=</span>&nbsp;<span class="ident" id="7889376">cmd</span><span class="op" id="7889379">.</span><span class="ident" id="7889380">Output</span><span class="op" id="7889386">(</span><span class="op" id="7889387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889393">if</span>&nbsp;<span class="ident" id="7889396">err</span>&nbsp;<span class="op" id="7889400">==</span>&nbsp;<span class="ident" id="7889403">nil</span>&nbsp;<span class="op" id="7889407">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889414">qpres</span>&nbsp;<span class="op" id="7889420">&lt;-</span>&nbsp;<span class="ident" id="7889423">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889437">}</span><span class="op" id="7889438">(</span><span class="op" id="7889439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889444">select</span>&nbsp;<span class="op" id="7889451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889456">case</span>&nbsp;<span class="ident" id="7889461">got</span>&nbsp;<span class="op" id="7889465">:=</span>&nbsp;<span class="op" id="7889468">&lt;-</span><span class="ident" id="7889470">qpres</span><span class="op" id="7889475">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889481">if</span>&nbsp;<span class="ident" id="7889484">want</span><span class="op" id="7889488">,</span>&nbsp;<span class="ident" id="7889490">ok</span>&nbsp;<span class="op" id="7889493">:=</span>&nbsp;<span class="ident" id="7889496">got</span><span class="op" id="7889499">.</span><span class="op" id="7889500">(</span><span class="op" id="7889501">[</span><span class="op" id="7889502">]</span><span class="builtintype" id="7889503">byte</span><span class="op" id="7889507">)</span><span class="op" id="7889508">;</span>&nbsp;<span class="ident" id="7889510">ok</span>&nbsp;<span class="op" id="7889513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889520">if</span>&nbsp;<span class="builtintype" id="7889523">string</span><span class="op" id="7889529">(</span><span class="ident" id="7889530">want</span><span class="op" id="7889534">)</span>&nbsp;<span class="op" id="7889536">!=</span>&nbsp;<span class="ident" id="7889539">buf</span><span class="op" id="7889542">.</span><span class="ident" id="7889543">String</span><span class="op" id="7889549">(</span><span class="op" id="7889550">)</span>&nbsp;<span class="op" id="7889552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889560">t</span><span class="op" id="7889561">.</span><span class="ident" id="7889562">Errorf</span><span class="op" id="7889568">(</span><span class="string" id="7889569">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="7889602">,</span>&nbsp;<span class="ident" id="7889604">s</span><span class="op" id="7889605">,</span>&nbsp;<span class="ident" id="7889607">want</span><span class="op" id="7889611">,</span>&nbsp;<span class="ident" id="7889613">buf</span><span class="op" id="7889616">.</span><span class="ident" id="7889617">String</span><span class="op" id="7889623">(</span><span class="op" id="7889624">)</span><span class="op" id="7889625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889638">}</span>&nbsp;<span class="keyword" id="7889640">else</span>&nbsp;<span class="op" id="7889645">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889652">t</span><span class="op" id="7889653">.</span><span class="ident" id="7889654">Logf</span><span class="op" id="7889658">(</span><span class="string" id="7889659">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7889679">,</span>&nbsp;<span class="ident" id="7889681">s</span><span class="op" id="7889682">,</span>&nbsp;<span class="ident" id="7889684">got</span><span class="op" id="7889687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889698">case</span>&nbsp;<span class="op" id="7889703">&lt;-</span><span class="ident" id="7889705">time</span><span class="op" id="7889709">.</span><span class="ident" id="7889710">After</span><span class="op" id="7889715">(</span><span class="num" id="7889716">5</span>&nbsp;<span class="op" id="7889718">*</span>&nbsp;<span class="ident" id="7889720">time</span><span class="op" id="7889724">.</span><span class="ident" id="7889725">Second</span><span class="op" id="7889731">)</span><span class="op" id="7889732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889738">t</span><span class="op" id="7889739">.</span><span class="ident" id="7889740">Logf</span><span class="op" id="7889744">(</span><span class="string" id="7889745">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7889767">,</span>&nbsp;<span class="ident" id="7889769">s</span><span class="op" id="7889770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889775">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889783">res</span><span class="op" id="7889786">[</span><span class="string" id="7889787">&#34;OK&#34;</span><span class="op" id="7889791">]</span><span class="op" id="7889792">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889796">}</span><span class="op" id="7889797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889800">var</span>&nbsp;<span class="ident" id="7889804">outcomes</span>&nbsp;<span class="op" id="7889813">[</span><span class="op" id="7889814">]</span><span class="builtintype" id="7889815">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7889823">for</span>&nbsp;<span class="ident" id="7889827">k</span><span class="op" id="7889828">,</span>&nbsp;<span class="ident" id="7889830">v</span>&nbsp;<span class="op" id="7889832">:=</span>&nbsp;<span class="keyword" id="7889835">range</span>&nbsp;<span class="ident" id="7889841">res</span>&nbsp;<span class="op" id="7889845">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889849">outcomes</span>&nbsp;<span class="op" id="7889858">=</span>&nbsp;<span class="builtinfunc" id="7889860">append</span><span class="op" id="7889866">(</span><span class="ident" id="7889867">outcomes</span><span class="op" id="7889875">,</span>&nbsp;<span class="ident" id="7889877">fmt</span><span class="op" id="7889880">.</span><span class="ident" id="7889881">Sprintf</span><span class="op" id="7889888">(</span><span class="string" id="7889889">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="7889897">,</span>&nbsp;<span class="ident" id="7889899">k</span><span class="op" id="7889900">,</span>&nbsp;<span class="ident" id="7889902">v</span><span class="op" id="7889903">)</span><span class="op" id="7889904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7889907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889910">sort</span><span class="op" id="7889914">.</span><span class="ident" id="7889915">Strings</span><span class="op" id="7889922">(</span><span class="ident" id="7889923">outcomes</span><span class="op" id="7889931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889934">got</span>&nbsp;<span class="op" id="7889938">:=</span>&nbsp;<span class="ident" id="7889941">strings</span><span class="op" id="7889948">.</span><span class="ident" id="7889949">Join</span><span class="op" id="7889953">(</span><span class="ident" id="7889954">outcomes</span><span class="op" id="7889962">,</span>&nbsp;<span class="string" id="7889964">&#34;\n&#34;</span><span class="op" id="7889968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7889971">want</span>&nbsp;<span class="op" id="7889976">:=</span>&nbsp;<span class="string" id="7889979">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7890264">if</span>&nbsp;<span class="ident" id="7890267">got</span>&nbsp;<span class="op" id="7890271">!=</span>&nbsp;<span class="ident" id="7890274">want</span>&nbsp;<span class="op" id="7890279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7890283">t</span><span class="op" id="7890284">.</span><span class="ident" id="7890285">Errorf</span><span class="op" id="7890291">(</span><span class="string" id="7890292">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="7890313">,</span>&nbsp;<span class="ident" id="7890315">got</span><span class="op" id="7890318">,</span>&nbsp;<span class="ident" id="7890320">want</span><span class="op" id="7890324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7890327">}</span><br>
<span class="lineno"></span><span class="op" id="7890329">}</span>
</div>
</body>
</html>
