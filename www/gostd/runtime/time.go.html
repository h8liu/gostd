<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html" class="current">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1669260">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1669315">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1669369">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1669420">//&nbsp;Time-related&nbsp;runtime&nbsp;and&nbsp;pieces&nbsp;of&nbsp;package&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1669473">package</span>&nbsp;<span class="ident" id="1669481">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1669490">import</span>&nbsp;<span class="string" id="1669497">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1669507">//&nbsp;Package&nbsp;time&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1669559">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../time/sleep.go:/runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="1669625">//&nbsp;For&nbsp;GOOS=nacl,&nbsp;package&nbsp;syscall&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1669695">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../syscall/net_nacl.go:/runtimeTimer.</span><br>
<span class="lineno">15</span><span class="keyword" id="1669767">type</span>&nbsp;<span class="ident" id="1669772">timer</span>&nbsp;<span class="keyword" id="1669778">struct</span>&nbsp;<span class="op" id="1669785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1669788">i</span>&nbsp;<span class="builtintype" id="1669790">int</span>&nbsp;<span class="comment" id="1669794">//&nbsp;heap&nbsp;index</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1669810">//&nbsp;Timer&nbsp;wakes&nbsp;up&nbsp;at&nbsp;when,&nbsp;and&nbsp;then&nbsp;at&nbsp;when+period,&nbsp;...&nbsp;(period&nbsp;&gt;&nbsp;0&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1669885">//&nbsp;each&nbsp;time&nbsp;calling&nbsp;f(now,&nbsp;arg)&nbsp;in&nbsp;the&nbsp;timer&nbsp;goroutine,&nbsp;so&nbsp;f&nbsp;must&nbsp;be</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1669956">//&nbsp;a&nbsp;well-behaved&nbsp;function&nbsp;and&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1669999">when</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1670006">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670013">period</span>&nbsp;<span class="builtintype" id="1670020">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670027">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1670034">func</span><span class="op" id="1670038">(</span><span class="keyword" id="1670039">interface</span><span class="op" id="1670048">{</span><span class="op" id="1670049">}</span><span class="op" id="1670050">,</span>&nbsp;<span class="builtintype" id="1670052">uintptr</span><span class="op" id="1670059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670062">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1670069">interface</span><span class="op" id="1670078">{</span><span class="op" id="1670079">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670082">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1670089">uintptr</span><br>
<span class="lineno"></span><span class="op" id="1670097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1670100">var</span>&nbsp;<span class="ident" id="1670104">timers</span>&nbsp;<span class="keyword" id="1670111">struct</span>&nbsp;<span class="op" id="1670118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670121">lock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670134">mutex</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670141">gp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1670154">*</span><span class="ident" id="1670155">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670158">created</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1670171">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670177">sleeping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1670190">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670196">rescheduling</span>&nbsp;<span class="builtintype" id="1670209">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670215">waitnote</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670228">note</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670234">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1670247">[</span><span class="op" id="1670248">]</span><span class="op" id="1670249">*</span><span class="ident" id="1670250">timer</span><br>
<span class="lineno"></span><span class="op" id="1670256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1670259">//&nbsp;nacl&nbsp;fake&nbsp;time&nbsp;support&nbsp;-&nbsp;time&nbsp;in&nbsp;nanoseconds&nbsp;since&nbsp;1970</span><br>
<span class="lineno"></span><span class="keyword" id="1670318">var</span>&nbsp;<span class="ident" id="1670322">faketime</span>&nbsp;<span class="builtintype" id="1670331">int64</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1670338">//&nbsp;Package&nbsp;time&nbsp;APIs.</span><br>
<span class="lineno"></span><span class="comment" id="1670360">//&nbsp;Godoc&nbsp;uses&nbsp;the&nbsp;comments&nbsp;in&nbsp;package&nbsp;time,&nbsp;not&nbsp;these.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1670416">//&nbsp;time.now&nbsp;is&nbsp;implemented&nbsp;in&nbsp;assembly.</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="1670457">//&nbsp;Sleep&nbsp;puts&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;sleep&nbsp;for&nbsp;at&nbsp;least&nbsp;ns&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="1670531">func</span>&nbsp;<span class="ident" id="1670536">timeSleep</span><span class="op" id="1670545">(</span><span class="ident" id="1670546">ns</span>&nbsp;<span class="builtintype" id="1670549">int64</span><span class="op" id="1670554">)</span>&nbsp;<span class="op" id="1670556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1670559">if</span>&nbsp;<span class="ident" id="1670562">ns</span>&nbsp;<span class="op" id="1670565">&lt;=</span>&nbsp;<span class="num" id="1670568">0</span>&nbsp;<span class="op" id="1670570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1670574">return</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1670582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670586">t</span>&nbsp;<span class="op" id="1670588">:=</span>&nbsp;<span class="builtinfunc" id="1670591">new</span><span class="op" id="1670594">(</span><span class="ident" id="1670595">timer</span><span class="op" id="1670600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670603">t</span><span class="op" id="1670604">.</span><span class="ident" id="1670605">when</span>&nbsp;<span class="op" id="1670610">=</span>&nbsp;<span class="ident" id="1670612">nanotime</span><span class="op" id="1670620">(</span><span class="op" id="1670621">)</span>&nbsp;<span class="op" id="1670623">+</span>&nbsp;<span class="ident" id="1670625">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670629">t</span><span class="op" id="1670630">.</span><span class="ident" id="1670631">f</span>&nbsp;<span class="op" id="1670633">=</span>&nbsp;<span class="ident" id="1670635">goroutineReady</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670651">t</span><span class="op" id="1670652">.</span><span class="ident" id="1670653">arg</span>&nbsp;<span class="op" id="1670657">=</span>&nbsp;<span class="ident" id="1670659">getg</span><span class="op" id="1670663">(</span><span class="op" id="1670664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670667">lock</span><span class="op" id="1670671">(</span><span class="op" id="1670672">&amp;</span><span class="ident" id="1670673">timers</span><span class="op" id="1670679">.</span><span class="ident" id="1670680">lock</span><span class="op" id="1670684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670687">addtimerLocked</span><span class="op" id="1670701">(</span><span class="ident" id="1670702">t</span><span class="op" id="1670703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670706">goparkunlock</span><span class="op" id="1670718">(</span><span class="op" id="1670719">&amp;</span><span class="ident" id="1670720">timers</span><span class="op" id="1670726">.</span><span class="ident" id="1670727">lock</span><span class="op" id="1670731">,</span>&nbsp;<span class="string" id="1670733">&#34;sleep&#34;</span><span class="op" id="1670740">)</span><br>
<span class="lineno"></span><span class="op" id="1670742">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1670745">//&nbsp;startTimer&nbsp;adds&nbsp;t&nbsp;to&nbsp;the&nbsp;timer&nbsp;heap.</span><br>
<span class="lineno"></span><span class="keyword" id="1670785">func</span>&nbsp;<span class="ident" id="1670790">startTimer</span><span class="op" id="1670800">(</span><span class="ident" id="1670801">t</span>&nbsp;<span class="op" id="1670803">*</span><span class="ident" id="1670804">timer</span><span class="op" id="1670809">)</span>&nbsp;<span class="op" id="1670811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1670814">if</span>&nbsp;<span class="ident" id="1670817">raceenabled</span>&nbsp;<span class="op" id="1670829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670833">racerelease</span><span class="op" id="1670844">(</span><span class="ident" id="1670845">unsafe</span><span class="op" id="1670851">.</span><span class="ident" id="1670852">Pointer</span><span class="op" id="1670859">(</span><span class="ident" id="1670860">t</span><span class="op" id="1670861">)</span><span class="op" id="1670862">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1670865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1670868">addtimer</span><span class="op" id="1670876">(</span><span class="ident" id="1670877">t</span><span class="op" id="1670878">)</span><br>
<span class="lineno"></span><span class="op" id="1670880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1670883">//&nbsp;stopTimer&nbsp;removes&nbsp;t&nbsp;from&nbsp;the&nbsp;timer&nbsp;heap&nbsp;if&nbsp;it&nbsp;is&nbsp;there.</span><br>
<span class="lineno">70</span><span class="comment" id="1670942">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;t&nbsp;was&nbsp;removed,&nbsp;false&nbsp;if&nbsp;t&nbsp;wasn&#39;t&nbsp;even&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="1671009">func</span>&nbsp;<span class="ident" id="1671014">stopTimer</span><span class="op" id="1671023">(</span><span class="ident" id="1671024">t</span>&nbsp;<span class="op" id="1671026">*</span><span class="ident" id="1671027">timer</span><span class="op" id="1671032">)</span>&nbsp;<span class="builtintype" id="1671034">bool</span>&nbsp;<span class="op" id="1671039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1671042">return</span>&nbsp;<span class="ident" id="1671049">deltimer</span><span class="op" id="1671057">(</span><span class="ident" id="1671058">t</span><span class="op" id="1671059">)</span><br>
<span class="lineno"></span><span class="op" id="1671061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1671064">//&nbsp;Go&nbsp;runtime.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1671080">//&nbsp;Ready&nbsp;the&nbsp;goroutine&nbsp;arg.</span><br>
<span class="lineno"></span><span class="keyword" id="1671108">func</span>&nbsp;<span class="ident" id="1671113">goroutineReady</span><span class="op" id="1671127">(</span><span class="ident" id="1671128">arg</span>&nbsp;<span class="keyword" id="1671132">interface</span><span class="op" id="1671141">{</span><span class="op" id="1671142">}</span><span class="op" id="1671143">,</span>&nbsp;<span class="ident" id="1671145">seq</span>&nbsp;<span class="builtintype" id="1671149">uintptr</span><span class="op" id="1671156">)</span>&nbsp;<span class="op" id="1671158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671161">goready</span><span class="op" id="1671168">(</span><span class="ident" id="1671169">arg</span><span class="op" id="1671172">.</span><span class="op" id="1671173">(</span><span class="op" id="1671174">*</span><span class="ident" id="1671175">g</span><span class="op" id="1671176">)</span><span class="op" id="1671177">)</span><br>
<span class="lineno">80</span><span class="op" id="1671179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1671182">func</span>&nbsp;<span class="ident" id="1671187">addtimer</span><span class="op" id="1671195">(</span><span class="ident" id="1671196">t</span>&nbsp;<span class="op" id="1671198">*</span><span class="ident" id="1671199">timer</span><span class="op" id="1671204">)</span>&nbsp;<span class="op" id="1671206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671209">lock</span><span class="op" id="1671213">(</span><span class="op" id="1671214">&amp;</span><span class="ident" id="1671215">timers</span><span class="op" id="1671221">.</span><span class="ident" id="1671222">lock</span><span class="op" id="1671226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671229">addtimerLocked</span><span class="op" id="1671243">(</span><span class="ident" id="1671244">t</span><span class="op" id="1671245">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671248">unlock</span><span class="op" id="1671254">(</span><span class="op" id="1671255">&amp;</span><span class="ident" id="1671256">timers</span><span class="op" id="1671262">.</span><span class="ident" id="1671263">lock</span><span class="op" id="1671267">)</span><br>
<span class="lineno"></span><span class="op" id="1671269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1671272">//&nbsp;Add&nbsp;a&nbsp;timer&nbsp;to&nbsp;the&nbsp;heap&nbsp;and&nbsp;start&nbsp;or&nbsp;kick&nbsp;the&nbsp;timer&nbsp;proc.</span><br>
<span class="lineno"></span><span class="comment" id="1671333">//&nbsp;If&nbsp;the&nbsp;new&nbsp;timer&nbsp;is&nbsp;earlier&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;others.</span><br>
<span class="lineno">90</span><span class="comment" id="1671388">//&nbsp;Timers&nbsp;are&nbsp;locked.</span><br>
<span class="lineno"></span><span class="keyword" id="1671410">func</span>&nbsp;<span class="ident" id="1671415">addtimerLocked</span><span class="op" id="1671429">(</span><span class="ident" id="1671430">t</span>&nbsp;<span class="op" id="1671432">*</span><span class="ident" id="1671433">timer</span><span class="op" id="1671438">)</span>&nbsp;<span class="op" id="1671440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1671443">//&nbsp;when&nbsp;must&nbsp;never&nbsp;be&nbsp;negative;&nbsp;otherwise&nbsp;timerproc&nbsp;will&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1671510">//&nbsp;during&nbsp;its&nbsp;delta&nbsp;calculation&nbsp;and&nbsp;never&nbsp;expire&nbsp;other&nbsp;runtime·timers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1671583">if</span>&nbsp;<span class="ident" id="1671586">t</span><span class="op" id="1671587">.</span><span class="ident" id="1671588">when</span>&nbsp;<span class="op" id="1671593">&lt;</span>&nbsp;<span class="num" id="1671595">0</span>&nbsp;<span class="op" id="1671597">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671601">t</span><span class="op" id="1671602">.</span><span class="ident" id="1671603">when</span>&nbsp;<span class="op" id="1671608">=</span>&nbsp;<span class="num" id="1671610">1</span><span class="op" id="1671611">&lt;&lt;</span><span class="num" id="1671613">63</span>&nbsp;<span class="op" id="1671616">-</span>&nbsp;<span class="num" id="1671618">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1671621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671624">t</span><span class="op" id="1671625">.</span><span class="ident" id="1671626">i</span>&nbsp;<span class="op" id="1671628">=</span>&nbsp;<span class="builtinfunc" id="1671630">len</span><span class="op" id="1671633">(</span><span class="ident" id="1671634">timers</span><span class="op" id="1671640">.</span><span class="ident" id="1671641">t</span><span class="op" id="1671642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671645">timers</span><span class="op" id="1671651">.</span><span class="ident" id="1671652">t</span>&nbsp;<span class="op" id="1671654">=</span>&nbsp;<span class="builtinfunc" id="1671656">append</span><span class="op" id="1671662">(</span><span class="ident" id="1671663">timers</span><span class="op" id="1671669">.</span><span class="ident" id="1671670">t</span><span class="op" id="1671671">,</span>&nbsp;<span class="ident" id="1671673">t</span><span class="op" id="1671674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671677">siftupTimer</span><span class="op" id="1671688">(</span><span class="ident" id="1671689">t</span><span class="op" id="1671690">.</span><span class="ident" id="1671691">i</span><span class="op" id="1671692">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1671695">if</span>&nbsp;<span class="ident" id="1671698">t</span><span class="op" id="1671699">.</span><span class="ident" id="1671700">i</span>&nbsp;<span class="op" id="1671702">==</span>&nbsp;<span class="num" id="1671705">0</span>&nbsp;<span class="op" id="1671707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1671711">//&nbsp;siftup&nbsp;moved&nbsp;to&nbsp;top:&nbsp;new&nbsp;earliest&nbsp;deadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1671760">if</span>&nbsp;<span class="ident" id="1671763">timers</span><span class="op" id="1671769">.</span><span class="ident" id="1671770">sleeping</span>&nbsp;<span class="op" id="1671779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671784">timers</span><span class="op" id="1671790">.</span><span class="ident" id="1671791">sleeping</span>&nbsp;<span class="op" id="1671800">=</span>&nbsp;<span class="builtintype" id="1671802">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671811">notewakeup</span><span class="op" id="1671821">(</span><span class="op" id="1671822">&amp;</span><span class="ident" id="1671823">timers</span><span class="op" id="1671829">.</span><span class="ident" id="1671830">waitnote</span><span class="op" id="1671838">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1671842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1671846">if</span>&nbsp;<span class="ident" id="1671849">timers</span><span class="op" id="1671855">.</span><span class="ident" id="1671856">rescheduling</span>&nbsp;<span class="op" id="1671869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671874">timers</span><span class="op" id="1671880">.</span><span class="ident" id="1671881">rescheduling</span>&nbsp;<span class="op" id="1671894">=</span>&nbsp;<span class="builtintype" id="1671896">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671905">goready</span><span class="op" id="1671912">(</span><span class="ident" id="1671913">timers</span><span class="op" id="1671919">.</span><span class="ident" id="1671920">gp</span><span class="op" id="1671922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1671926">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1671929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1671932">if</span>&nbsp;<span class="op" id="1671935">!</span><span class="ident" id="1671936">timers</span><span class="op" id="1671942">.</span><span class="ident" id="1671943">created</span>&nbsp;<span class="op" id="1671951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1671955">timers</span><span class="op" id="1671961">.</span><span class="ident" id="1671962">created</span>&nbsp;<span class="op" id="1671970">=</span>&nbsp;<span class="builtintype" id="1671972">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1671979">go</span>&nbsp;<span class="ident" id="1671982">timerproc</span><span class="op" id="1671991">(</span><span class="op" id="1671992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1671995">}</span><br>
<span class="lineno">115</span><span class="op" id="1671997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1672000">//&nbsp;Delete&nbsp;timer&nbsp;t&nbsp;from&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span><span class="comment" id="1672033">//&nbsp;Do&nbsp;not&nbsp;need&nbsp;to&nbsp;update&nbsp;the&nbsp;timerproc:&nbsp;if&nbsp;it&nbsp;wakes&nbsp;up&nbsp;early,&nbsp;no&nbsp;big&nbsp;deal.</span><br>
<span class="lineno"></span><span class="keyword" id="1672108">func</span>&nbsp;<span class="ident" id="1672113">deltimer</span><span class="op" id="1672121">(</span><span class="ident" id="1672122">t</span>&nbsp;<span class="op" id="1672124">*</span><span class="ident" id="1672125">timer</span><span class="op" id="1672130">)</span>&nbsp;<span class="builtintype" id="1672132">bool</span>&nbsp;<span class="op" id="1672137">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1672140">//&nbsp;Dereference&nbsp;t&nbsp;so&nbsp;that&nbsp;any&nbsp;panic&nbsp;happens&nbsp;before&nbsp;the&nbsp;lock&nbsp;is&nbsp;held.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1672209">//&nbsp;Discard&nbsp;result,&nbsp;because&nbsp;t&nbsp;might&nbsp;be&nbsp;moving&nbsp;in&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672268">_</span>&nbsp;<span class="op" id="1672270">=</span>&nbsp;<span class="ident" id="1672272">t</span><span class="op" id="1672273">.</span><span class="ident" id="1672274">i</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672278">lock</span><span class="op" id="1672282">(</span><span class="op" id="1672283">&amp;</span><span class="ident" id="1672284">timers</span><span class="op" id="1672290">.</span><span class="ident" id="1672291">lock</span><span class="op" id="1672295">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1672298">//&nbsp;t&nbsp;may&nbsp;not&nbsp;be&nbsp;registered&nbsp;anymore&nbsp;and&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1672347">//&nbsp;a&nbsp;bogus&nbsp;i&nbsp;(typically&nbsp;0,&nbsp;if&nbsp;generated&nbsp;by&nbsp;Go).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1672396">//&nbsp;Verify&nbsp;it&nbsp;before&nbsp;proceeding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672429">i</span>&nbsp;<span class="op" id="1672431">:=</span>&nbsp;<span class="ident" id="1672434">t</span><span class="op" id="1672435">.</span><span class="ident" id="1672436">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672439">last</span>&nbsp;<span class="op" id="1672444">:=</span>&nbsp;<span class="builtinfunc" id="1672447">len</span><span class="op" id="1672450">(</span><span class="ident" id="1672451">timers</span><span class="op" id="1672457">.</span><span class="ident" id="1672458">t</span><span class="op" id="1672459">)</span>&nbsp;<span class="op" id="1672461">-</span>&nbsp;<span class="num" id="1672463">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1672466">if</span>&nbsp;<span class="ident" id="1672469">i</span>&nbsp;<span class="op" id="1672471">&lt;</span>&nbsp;<span class="num" id="1672473">0</span>&nbsp;<span class="op" id="1672475">||</span>&nbsp;<span class="ident" id="1672478">i</span>&nbsp;<span class="op" id="1672480">&gt;</span>&nbsp;<span class="ident" id="1672482">last</span>&nbsp;<span class="op" id="1672487">||</span>&nbsp;<span class="ident" id="1672490">timers</span><span class="op" id="1672496">.</span><span class="ident" id="1672497">t</span><span class="op" id="1672498">[</span><span class="ident" id="1672499">i</span><span class="op" id="1672500">]</span>&nbsp;<span class="op" id="1672502">!=</span>&nbsp;<span class="ident" id="1672505">t</span>&nbsp;<span class="op" id="1672507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672511">unlock</span><span class="op" id="1672517">(</span><span class="op" id="1672518">&amp;</span><span class="ident" id="1672519">timers</span><span class="op" id="1672525">.</span><span class="ident" id="1672526">lock</span><span class="op" id="1672530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1672534">return</span>&nbsp;<span class="builtintype" id="1672541">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1672548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1672551">if</span>&nbsp;<span class="ident" id="1672554">i</span>&nbsp;<span class="op" id="1672556">!=</span>&nbsp;<span class="ident" id="1672559">last</span>&nbsp;<span class="op" id="1672564">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672568">timers</span><span class="op" id="1672574">.</span><span class="ident" id="1672575">t</span><span class="op" id="1672576">[</span><span class="ident" id="1672577">i</span><span class="op" id="1672578">]</span>&nbsp;<span class="op" id="1672580">=</span>&nbsp;<span class="ident" id="1672582">timers</span><span class="op" id="1672588">.</span><span class="ident" id="1672589">t</span><span class="op" id="1672590">[</span><span class="ident" id="1672591">last</span><span class="op" id="1672595">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672599">timers</span><span class="op" id="1672605">.</span><span class="ident" id="1672606">t</span><span class="op" id="1672607">[</span><span class="ident" id="1672608">i</span><span class="op" id="1672609">]</span><span class="op" id="1672610">.</span><span class="ident" id="1672611">i</span>&nbsp;<span class="op" id="1672613">=</span>&nbsp;<span class="ident" id="1672615">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1672618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672621">timers</span><span class="op" id="1672627">.</span><span class="ident" id="1672628">t</span><span class="op" id="1672629">[</span><span class="ident" id="1672630">last</span><span class="op" id="1672634">]</span>&nbsp;<span class="op" id="1672636">=</span>&nbsp;<span class="builtintype" id="1672638">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672643">timers</span><span class="op" id="1672649">.</span><span class="ident" id="1672650">t</span>&nbsp;<span class="op" id="1672652">=</span>&nbsp;<span class="ident" id="1672654">timers</span><span class="op" id="1672660">.</span><span class="ident" id="1672661">t</span><span class="op" id="1672662">[</span><span class="op" id="1672663">:</span><span class="ident" id="1672664">last</span><span class="op" id="1672668">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1672671">if</span>&nbsp;<span class="ident" id="1672674">i</span>&nbsp;<span class="op" id="1672676">!=</span>&nbsp;<span class="ident" id="1672679">last</span>&nbsp;<span class="op" id="1672684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672688">siftupTimer</span><span class="op" id="1672699">(</span><span class="ident" id="1672700">i</span><span class="op" id="1672701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672705">siftdownTimer</span><span class="op" id="1672718">(</span><span class="ident" id="1672719">i</span><span class="op" id="1672720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1672723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672726">unlock</span><span class="op" id="1672732">(</span><span class="op" id="1672733">&amp;</span><span class="ident" id="1672734">timers</span><span class="op" id="1672740">.</span><span class="ident" id="1672741">lock</span><span class="op" id="1672745">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1672748">return</span>&nbsp;<span class="builtintype" id="1672755">true</span><br>
<span class="lineno"></span><span class="op" id="1672760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1672763">//&nbsp;Timerproc&nbsp;runs&nbsp;the&nbsp;time-driven&nbsp;events.</span><br>
<span class="lineno"></span><span class="comment" id="1672805">//&nbsp;It&nbsp;sleeps&nbsp;until&nbsp;the&nbsp;next&nbsp;event&nbsp;in&nbsp;the&nbsp;timers&nbsp;heap.</span><br>
<span class="lineno">150</span><span class="comment" id="1672859">//&nbsp;If&nbsp;addtimer&nbsp;inserts&nbsp;a&nbsp;new&nbsp;earlier&nbsp;event,&nbsp;addtimer1&nbsp;wakes&nbsp;timerproc&nbsp;early.</span><br>
<span class="lineno"></span><span class="keyword" id="1672936">func</span>&nbsp;<span class="ident" id="1672941">timerproc</span><span class="op" id="1672950">(</span><span class="op" id="1672951">)</span>&nbsp;<span class="op" id="1672953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672956">timers</span><span class="op" id="1672962">.</span><span class="ident" id="1672963">gp</span>&nbsp;<span class="op" id="1672966">=</span>&nbsp;<span class="ident" id="1672968">getg</span><span class="op" id="1672972">(</span><span class="op" id="1672973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1672976">timers</span><span class="op" id="1672982">.</span><span class="ident" id="1672983">gp</span><span class="op" id="1672985">.</span><span class="ident" id="1672986">issystem</span>&nbsp;<span class="op" id="1672995">=</span>&nbsp;<span class="builtintype" id="1672997">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673003">for</span>&nbsp;<span class="op" id="1673007">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673011">lock</span><span class="op" id="1673015">(</span><span class="op" id="1673016">&amp;</span><span class="ident" id="1673017">timers</span><span class="op" id="1673023">.</span><span class="ident" id="1673024">lock</span><span class="op" id="1673028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673032">timers</span><span class="op" id="1673038">.</span><span class="ident" id="1673039">sleeping</span>&nbsp;<span class="op" id="1673048">=</span>&nbsp;<span class="builtintype" id="1673050">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673058">now</span>&nbsp;<span class="op" id="1673062">:=</span>&nbsp;<span class="ident" id="1673065">nanotime</span><span class="op" id="1673073">(</span><span class="op" id="1673074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673078">delta</span>&nbsp;<span class="op" id="1673084">:=</span>&nbsp;<span class="builtintype" id="1673087">int64</span><span class="op" id="1673092">(</span><span class="op" id="1673093">-</span><span class="num" id="1673094">1</span><span class="op" id="1673095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673099">for</span>&nbsp;<span class="op" id="1673103">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673108">if</span>&nbsp;<span class="builtinfunc" id="1673111">len</span><span class="op" id="1673114">(</span><span class="ident" id="1673115">timers</span><span class="op" id="1673121">.</span><span class="ident" id="1673122">t</span><span class="op" id="1673123">)</span>&nbsp;<span class="op" id="1673125">==</span>&nbsp;<span class="num" id="1673128">0</span>&nbsp;<span class="op" id="1673130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673136">delta</span>&nbsp;<span class="op" id="1673142">=</span>&nbsp;<span class="op" id="1673144">-</span><span class="num" id="1673145">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673151">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1673160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673165">t</span>&nbsp;<span class="op" id="1673167">:=</span>&nbsp;<span class="ident" id="1673170">timers</span><span class="op" id="1673176">.</span><span class="ident" id="1673177">t</span><span class="op" id="1673178">[</span><span class="num" id="1673179">0</span><span class="op" id="1673180">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673185">delta</span>&nbsp;<span class="op" id="1673191">=</span>&nbsp;<span class="ident" id="1673193">t</span><span class="op" id="1673194">.</span><span class="ident" id="1673195">when</span>&nbsp;<span class="op" id="1673200">-</span>&nbsp;<span class="ident" id="1673202">now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673209">if</span>&nbsp;<span class="ident" id="1673212">delta</span>&nbsp;<span class="op" id="1673218">&gt;</span>&nbsp;<span class="num" id="1673220">0</span>&nbsp;<span class="op" id="1673222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673228">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1673237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673242">if</span>&nbsp;<span class="ident" id="1673245">t</span><span class="op" id="1673246">.</span><span class="ident" id="1673247">period</span>&nbsp;<span class="op" id="1673254">&gt;</span>&nbsp;<span class="num" id="1673256">0</span>&nbsp;<span class="op" id="1673258">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1673264">//&nbsp;leave&nbsp;in&nbsp;heap&nbsp;but&nbsp;adjust&nbsp;next&nbsp;time&nbsp;to&nbsp;fire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673314">t</span><span class="op" id="1673315">.</span><span class="ident" id="1673316">when</span>&nbsp;<span class="op" id="1673321">+=</span>&nbsp;<span class="ident" id="1673324">t</span><span class="op" id="1673325">.</span><span class="ident" id="1673326">period</span>&nbsp;<span class="op" id="1673333">*</span>&nbsp;<span class="op" id="1673335">(</span><span class="num" id="1673336">1</span>&nbsp;<span class="op" id="1673338">+</span>&nbsp;<span class="op" id="1673340">-</span><span class="ident" id="1673341">delta</span><span class="op" id="1673346">/</span><span class="ident" id="1673347">t</span><span class="op" id="1673348">.</span><span class="ident" id="1673349">period</span><span class="op" id="1673355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673361">siftdownTimer</span><span class="op" id="1673374">(</span><span class="num" id="1673375">0</span><span class="op" id="1673376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1673381">}</span>&nbsp;<span class="keyword" id="1673383">else</span>&nbsp;<span class="op" id="1673388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1673394">//&nbsp;remove&nbsp;from&nbsp;heap</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673418">last</span>&nbsp;<span class="op" id="1673423">:=</span>&nbsp;<span class="builtinfunc" id="1673426">len</span><span class="op" id="1673429">(</span><span class="ident" id="1673430">timers</span><span class="op" id="1673436">.</span><span class="ident" id="1673437">t</span><span class="op" id="1673438">)</span>&nbsp;<span class="op" id="1673440">-</span>&nbsp;<span class="num" id="1673442">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673448">if</span>&nbsp;<span class="ident" id="1673451">last</span>&nbsp;<span class="op" id="1673456">&gt;</span>&nbsp;<span class="num" id="1673458">0</span>&nbsp;<span class="op" id="1673460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673467">timers</span><span class="op" id="1673473">.</span><span class="ident" id="1673474">t</span><span class="op" id="1673475">[</span><span class="num" id="1673476">0</span><span class="op" id="1673477">]</span>&nbsp;<span class="op" id="1673479">=</span>&nbsp;<span class="ident" id="1673481">timers</span><span class="op" id="1673487">.</span><span class="ident" id="1673488">t</span><span class="op" id="1673489">[</span><span class="ident" id="1673490">last</span><span class="op" id="1673494">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673501">timers</span><span class="op" id="1673507">.</span><span class="ident" id="1673508">t</span><span class="op" id="1673509">[</span><span class="num" id="1673510">0</span><span class="op" id="1673511">]</span><span class="op" id="1673512">.</span><span class="ident" id="1673513">i</span>&nbsp;<span class="op" id="1673515">=</span>&nbsp;<span class="num" id="1673517">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1673523">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673529">timers</span><span class="op" id="1673535">.</span><span class="ident" id="1673536">t</span><span class="op" id="1673537">[</span><span class="ident" id="1673538">last</span><span class="op" id="1673542">]</span>&nbsp;<span class="op" id="1673544">=</span>&nbsp;<span class="builtintype" id="1673546">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673554">timers</span><span class="op" id="1673560">.</span><span class="ident" id="1673561">t</span>&nbsp;<span class="op" id="1673563">=</span>&nbsp;<span class="ident" id="1673565">timers</span><span class="op" id="1673571">.</span><span class="ident" id="1673572">t</span><span class="op" id="1673573">[</span><span class="op" id="1673574">:</span><span class="ident" id="1673575">last</span><span class="op" id="1673579">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673585">if</span>&nbsp;<span class="ident" id="1673588">last</span>&nbsp;<span class="op" id="1673593">&gt;</span>&nbsp;<span class="num" id="1673595">0</span>&nbsp;<span class="op" id="1673597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673604">siftdownTimer</span><span class="op" id="1673617">(</span><span class="num" id="1673618">0</span><span class="op" id="1673619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1673625">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673631">t</span><span class="op" id="1673632">.</span><span class="ident" id="1673633">i</span>&nbsp;<span class="op" id="1673635">=</span>&nbsp;<span class="op" id="1673637">-</span><span class="num" id="1673638">1</span>&nbsp;<span class="comment" id="1673640">//&nbsp;mark&nbsp;as&nbsp;removed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1673662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673667">f</span>&nbsp;<span class="op" id="1673669">:=</span>&nbsp;<span class="ident" id="1673672">t</span><span class="op" id="1673673">.</span><span class="ident" id="1673674">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673679">arg</span>&nbsp;<span class="op" id="1673683">:=</span>&nbsp;<span class="ident" id="1673686">t</span><span class="op" id="1673687">.</span><span class="ident" id="1673688">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673695">seq</span>&nbsp;<span class="op" id="1673699">:=</span>&nbsp;<span class="ident" id="1673702">t</span><span class="op" id="1673703">.</span><span class="ident" id="1673704">seq</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673711">unlock</span><span class="op" id="1673717">(</span><span class="op" id="1673718">&amp;</span><span class="ident" id="1673719">timers</span><span class="op" id="1673725">.</span><span class="ident" id="1673726">lock</span><span class="op" id="1673730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673735">if</span>&nbsp;<span class="ident" id="1673738">raceenabled</span>&nbsp;<span class="op" id="1673750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673756">raceacquire</span><span class="op" id="1673767">(</span><span class="ident" id="1673768">unsafe</span><span class="op" id="1673774">.</span><span class="ident" id="1673775">Pointer</span><span class="op" id="1673782">(</span><span class="ident" id="1673783">t</span><span class="op" id="1673784">)</span><span class="op" id="1673785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1673790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673795">f</span><span class="op" id="1673796">(</span><span class="ident" id="1673797">arg</span><span class="op" id="1673800">,</span>&nbsp;<span class="ident" id="1673802">seq</span><span class="op" id="1673805">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673810">lock</span><span class="op" id="1673814">(</span><span class="op" id="1673815">&amp;</span><span class="ident" id="1673816">timers</span><span class="op" id="1673822">.</span><span class="ident" id="1673823">lock</span><span class="op" id="1673827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1673831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1673835">if</span>&nbsp;<span class="ident" id="1673838">delta</span>&nbsp;<span class="op" id="1673844">&lt;</span>&nbsp;<span class="num" id="1673846">0</span>&nbsp;<span class="op" id="1673848">||</span>&nbsp;<span class="ident" id="1673851">faketime</span>&nbsp;<span class="op" id="1673860">&gt;</span>&nbsp;<span class="num" id="1673862">0</span>&nbsp;<span class="op" id="1673864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1673869">//&nbsp;No&nbsp;timers&nbsp;left&nbsp;-&nbsp;put&nbsp;goroutine&nbsp;to&nbsp;sleep.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673916">timers</span><span class="op" id="1673922">.</span><span class="ident" id="1673923">rescheduling</span>&nbsp;<span class="op" id="1673936">=</span>&nbsp;<span class="builtintype" id="1673938">true</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1673946">goparkunlock</span><span class="op" id="1673958">(</span><span class="op" id="1673959">&amp;</span><span class="ident" id="1673960">timers</span><span class="op" id="1673966">.</span><span class="ident" id="1673967">lock</span><span class="op" id="1673971">,</span>&nbsp;<span class="string" id="1673973">&#34;timer&nbsp;goroutine&nbsp;(idle)&#34;</span><span class="op" id="1673997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674002">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1674013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1674017">//&nbsp;At&nbsp;least&nbsp;one&nbsp;timer&nbsp;pending.&nbsp;&nbsp;Sleep&nbsp;until&nbsp;then.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674069">timers</span><span class="op" id="1674075">.</span><span class="ident" id="1674076">sleeping</span>&nbsp;<span class="op" id="1674085">=</span>&nbsp;<span class="builtintype" id="1674087">true</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674094">noteclear</span><span class="op" id="1674103">(</span><span class="op" id="1674104">&amp;</span><span class="ident" id="1674105">timers</span><span class="op" id="1674111">.</span><span class="ident" id="1674112">waitnote</span><span class="op" id="1674120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674124">unlock</span><span class="op" id="1674130">(</span><span class="op" id="1674131">&amp;</span><span class="ident" id="1674132">timers</span><span class="op" id="1674138">.</span><span class="ident" id="1674139">lock</span><span class="op" id="1674143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674147">notetsleepg</span><span class="op" id="1674158">(</span><span class="op" id="1674159">&amp;</span><span class="ident" id="1674160">timers</span><span class="op" id="1674166">.</span><span class="ident" id="1674167">waitnote</span><span class="op" id="1674175">,</span>&nbsp;<span class="ident" id="1674177">delta</span><span class="op" id="1674182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1674185">}</span><br>
<span class="lineno"></span><span class="op" id="1674187">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1674190">func</span>&nbsp;<span class="ident" id="1674195">timejump</span><span class="op" id="1674203">(</span><span class="op" id="1674204">)</span>&nbsp;<span class="op" id="1674206">*</span><span class="ident" id="1674207">g</span>&nbsp;<span class="op" id="1674209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674212">if</span>&nbsp;<span class="ident" id="1674215">faketime</span>&nbsp;<span class="op" id="1674224">==</span>&nbsp;<span class="num" id="1674227">0</span>&nbsp;<span class="op" id="1674229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674233">return</span>&nbsp;<span class="builtintype" id="1674240">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1674245">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674249">lock</span><span class="op" id="1674253">(</span><span class="op" id="1674254">&amp;</span><span class="ident" id="1674255">timers</span><span class="op" id="1674261">.</span><span class="ident" id="1674262">lock</span><span class="op" id="1674266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674269">if</span>&nbsp;<span class="op" id="1674272">!</span><span class="ident" id="1674273">timers</span><span class="op" id="1674279">.</span><span class="ident" id="1674280">created</span>&nbsp;<span class="op" id="1674288">||</span>&nbsp;<span class="builtinfunc" id="1674291">len</span><span class="op" id="1674294">(</span><span class="ident" id="1674295">timers</span><span class="op" id="1674301">.</span><span class="ident" id="1674302">t</span><span class="op" id="1674303">)</span>&nbsp;<span class="op" id="1674305">==</span>&nbsp;<span class="num" id="1674308">0</span>&nbsp;<span class="op" id="1674310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674314">unlock</span><span class="op" id="1674320">(</span><span class="op" id="1674321">&amp;</span><span class="ident" id="1674322">timers</span><span class="op" id="1674328">.</span><span class="ident" id="1674329">lock</span><span class="op" id="1674333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674337">return</span>&nbsp;<span class="builtintype" id="1674344">nil</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1674349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674353">var</span>&nbsp;<span class="ident" id="1674357">gp</span>&nbsp;<span class="op" id="1674360">*</span><span class="ident" id="1674361">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674364">if</span>&nbsp;<span class="ident" id="1674367">faketime</span>&nbsp;<span class="op" id="1674376">&lt;</span>&nbsp;<span class="ident" id="1674378">timers</span><span class="op" id="1674384">.</span><span class="ident" id="1674385">t</span><span class="op" id="1674386">[</span><span class="num" id="1674387">0</span><span class="op" id="1674388">]</span><span class="op" id="1674389">.</span><span class="ident" id="1674390">when</span>&nbsp;<span class="op" id="1674395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674399">faketime</span>&nbsp;<span class="op" id="1674408">=</span>&nbsp;<span class="ident" id="1674410">timers</span><span class="op" id="1674416">.</span><span class="ident" id="1674417">t</span><span class="op" id="1674418">[</span><span class="num" id="1674419">0</span><span class="op" id="1674420">]</span><span class="op" id="1674421">.</span><span class="ident" id="1674422">when</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674429">if</span>&nbsp;<span class="ident" id="1674432">timers</span><span class="op" id="1674438">.</span><span class="ident" id="1674439">rescheduling</span>&nbsp;<span class="op" id="1674452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674457">timers</span><span class="op" id="1674463">.</span><span class="ident" id="1674464">rescheduling</span>&nbsp;<span class="op" id="1674477">=</span>&nbsp;<span class="builtintype" id="1674479">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674488">gp</span>&nbsp;<span class="op" id="1674491">=</span>&nbsp;<span class="ident" id="1674493">timers</span><span class="op" id="1674499">.</span><span class="ident" id="1674500">gp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1674505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1674508">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674511">unlock</span><span class="op" id="1674517">(</span><span class="op" id="1674518">&amp;</span><span class="ident" id="1674519">timers</span><span class="op" id="1674525">.</span><span class="ident" id="1674526">lock</span><span class="op" id="1674530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674533">return</span>&nbsp;<span class="ident" id="1674540">gp</span><br>
<span class="lineno"></span><span class="op" id="1674543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1674546">//&nbsp;Heap&nbsp;maintenance&nbsp;algorithms.</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="1674579">func</span>&nbsp;<span class="ident" id="1674584">siftupTimer</span><span class="op" id="1674595">(</span><span class="ident" id="1674596">i</span>&nbsp;<span class="builtintype" id="1674598">int</span><span class="op" id="1674601">)</span>&nbsp;<span class="op" id="1674603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674606">t</span>&nbsp;<span class="op" id="1674608">:=</span>&nbsp;<span class="ident" id="1674611">timers</span><span class="op" id="1674617">.</span><span class="ident" id="1674618">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674621">when</span>&nbsp;<span class="op" id="1674626">:=</span>&nbsp;<span class="ident" id="1674629">t</span><span class="op" id="1674630">[</span><span class="ident" id="1674631">i</span><span class="op" id="1674632">]</span><span class="op" id="1674633">.</span><span class="ident" id="1674634">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674640">tmp</span>&nbsp;<span class="op" id="1674644">:=</span>&nbsp;<span class="ident" id="1674647">t</span><span class="op" id="1674648">[</span><span class="ident" id="1674649">i</span><span class="op" id="1674650">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674653">for</span>&nbsp;<span class="ident" id="1674657">i</span>&nbsp;<span class="op" id="1674659">&gt;</span>&nbsp;<span class="num" id="1674661">0</span>&nbsp;<span class="op" id="1674663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674667">p</span>&nbsp;<span class="op" id="1674669">:=</span>&nbsp;<span class="op" id="1674672">(</span><span class="ident" id="1674673">i</span>&nbsp;<span class="op" id="1674675">-</span>&nbsp;<span class="num" id="1674677">1</span><span class="op" id="1674678">)</span>&nbsp;<span class="op" id="1674680">/</span>&nbsp;<span class="num" id="1674682">4</span>&nbsp;<span class="comment" id="1674684">//&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674696">if</span>&nbsp;<span class="ident" id="1674699">when</span>&nbsp;<span class="op" id="1674704">&gt;=</span>&nbsp;<span class="ident" id="1674707">t</span><span class="op" id="1674708">[</span><span class="ident" id="1674709">p</span><span class="op" id="1674710">]</span><span class="op" id="1674711">.</span><span class="ident" id="1674712">when</span>&nbsp;<span class="op" id="1674717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674722">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1674730">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674734">t</span><span class="op" id="1674735">[</span><span class="ident" id="1674736">i</span><span class="op" id="1674737">]</span>&nbsp;<span class="op" id="1674739">=</span>&nbsp;<span class="ident" id="1674741">t</span><span class="op" id="1674742">[</span><span class="ident" id="1674743">p</span><span class="op" id="1674744">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674748">t</span><span class="op" id="1674749">[</span><span class="ident" id="1674750">i</span><span class="op" id="1674751">]</span><span class="op" id="1674752">.</span><span class="ident" id="1674753">i</span>&nbsp;<span class="op" id="1674755">=</span>&nbsp;<span class="ident" id="1674757">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674761">t</span><span class="op" id="1674762">[</span><span class="ident" id="1674763">p</span><span class="op" id="1674764">]</span>&nbsp;<span class="op" id="1674766">=</span>&nbsp;<span class="ident" id="1674768">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674774">t</span><span class="op" id="1674775">[</span><span class="ident" id="1674776">p</span><span class="op" id="1674777">]</span><span class="op" id="1674778">.</span><span class="ident" id="1674779">i</span>&nbsp;<span class="op" id="1674781">=</span>&nbsp;<span class="ident" id="1674783">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674787">i</span>&nbsp;<span class="op" id="1674789">=</span>&nbsp;<span class="ident" id="1674791">p</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1674794">}</span><br>
<span class="lineno"></span><span class="op" id="1674796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1674799">func</span>&nbsp;<span class="ident" id="1674804">siftdownTimer</span><span class="op" id="1674817">(</span><span class="ident" id="1674818">i</span>&nbsp;<span class="builtintype" id="1674820">int</span><span class="op" id="1674823">)</span>&nbsp;<span class="op" id="1674825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674828">t</span>&nbsp;<span class="op" id="1674830">:=</span>&nbsp;<span class="ident" id="1674833">timers</span><span class="op" id="1674839">.</span><span class="ident" id="1674840">t</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674843">n</span>&nbsp;<span class="op" id="1674845">:=</span>&nbsp;<span class="builtinfunc" id="1674848">len</span><span class="op" id="1674851">(</span><span class="ident" id="1674852">t</span><span class="op" id="1674853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674856">when</span>&nbsp;<span class="op" id="1674861">:=</span>&nbsp;<span class="ident" id="1674864">t</span><span class="op" id="1674865">[</span><span class="ident" id="1674866">i</span><span class="op" id="1674867">]</span><span class="op" id="1674868">.</span><span class="ident" id="1674869">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674875">tmp</span>&nbsp;<span class="op" id="1674879">:=</span>&nbsp;<span class="ident" id="1674882">t</span><span class="op" id="1674883">[</span><span class="ident" id="1674884">i</span><span class="op" id="1674885">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674888">for</span>&nbsp;<span class="op" id="1674892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674896">c</span>&nbsp;<span class="op" id="1674898">:=</span>&nbsp;<span class="ident" id="1674901">i</span><span class="op" id="1674902">*</span><span class="num" id="1674903">4</span>&nbsp;<span class="op" id="1674905">+</span>&nbsp;<span class="num" id="1674907">1</span>&nbsp;<span class="comment" id="1674909">//&nbsp;left&nbsp;child</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674925">c3</span>&nbsp;<span class="op" id="1674928">:=</span>&nbsp;<span class="ident" id="1674931">c</span>&nbsp;<span class="op" id="1674933">+</span>&nbsp;<span class="num" id="1674935">2</span>&nbsp;&nbsp;<span class="comment" id="1674938">//&nbsp;mid&nbsp;child</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674953">if</span>&nbsp;<span class="ident" id="1674956">c</span>&nbsp;<span class="op" id="1674958">&gt;=</span>&nbsp;<span class="ident" id="1674961">n</span>&nbsp;<span class="op" id="1674963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674968">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1674976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1674980">w</span>&nbsp;<span class="op" id="1674982">:=</span>&nbsp;<span class="ident" id="1674985">t</span><span class="op" id="1674986">[</span><span class="ident" id="1674987">c</span><span class="op" id="1674988">]</span><span class="op" id="1674989">.</span><span class="ident" id="1674990">when</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1674997">if</span>&nbsp;<span class="ident" id="1675000">c</span><span class="op" id="1675001">+</span><span class="num" id="1675002">1</span>&nbsp;<span class="op" id="1675004">&lt;</span>&nbsp;<span class="ident" id="1675006">n</span>&nbsp;<span class="op" id="1675008">&amp;&amp;</span>&nbsp;<span class="ident" id="1675011">t</span><span class="op" id="1675012">[</span><span class="ident" id="1675013">c</span><span class="op" id="1675014">+</span><span class="num" id="1675015">1</span><span class="op" id="1675016">]</span><span class="op" id="1675017">.</span><span class="ident" id="1675018">when</span>&nbsp;<span class="op" id="1675023">&lt;</span>&nbsp;<span class="ident" id="1675025">w</span>&nbsp;<span class="op" id="1675027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675032">w</span>&nbsp;<span class="op" id="1675034">=</span>&nbsp;<span class="ident" id="1675036">t</span><span class="op" id="1675037">[</span><span class="ident" id="1675038">c</span><span class="op" id="1675039">+</span><span class="num" id="1675040">1</span><span class="op" id="1675041">]</span><span class="op" id="1675042">.</span><span class="ident" id="1675043">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675051">c</span><span class="op" id="1675052">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1675057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1675061">if</span>&nbsp;<span class="ident" id="1675064">c3</span>&nbsp;<span class="op" id="1675067">&lt;</span>&nbsp;<span class="ident" id="1675069">n</span>&nbsp;<span class="op" id="1675071">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675076">w3</span>&nbsp;<span class="op" id="1675079">:=</span>&nbsp;<span class="ident" id="1675082">t</span><span class="op" id="1675083">[</span><span class="ident" id="1675084">c3</span><span class="op" id="1675086">]</span><span class="op" id="1675087">.</span><span class="ident" id="1675088">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1675096">if</span>&nbsp;<span class="ident" id="1675099">c3</span><span class="op" id="1675101">+</span><span class="num" id="1675102">1</span>&nbsp;<span class="op" id="1675104">&lt;</span>&nbsp;<span class="ident" id="1675106">n</span>&nbsp;<span class="op" id="1675108">&amp;&amp;</span>&nbsp;<span class="ident" id="1675111">t</span><span class="op" id="1675112">[</span><span class="ident" id="1675113">c3</span><span class="op" id="1675115">+</span><span class="num" id="1675116">1</span><span class="op" id="1675117">]</span><span class="op" id="1675118">.</span><span class="ident" id="1675119">when</span>&nbsp;<span class="op" id="1675124">&lt;</span>&nbsp;<span class="ident" id="1675126">w3</span>&nbsp;<span class="op" id="1675129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675135">w3</span>&nbsp;<span class="op" id="1675138">=</span>&nbsp;<span class="ident" id="1675140">t</span><span class="op" id="1675141">[</span><span class="ident" id="1675142">c3</span><span class="op" id="1675144">+</span><span class="num" id="1675145">1</span><span class="op" id="1675146">]</span><span class="op" id="1675147">.</span><span class="ident" id="1675148">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675157">c3</span><span class="op" id="1675159">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1675165">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1675170">if</span>&nbsp;<span class="ident" id="1675173">w3</span>&nbsp;<span class="op" id="1675176">&lt;</span>&nbsp;<span class="ident" id="1675178">w</span>&nbsp;<span class="op" id="1675180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675186">w</span>&nbsp;<span class="op" id="1675188">=</span>&nbsp;<span class="ident" id="1675190">w3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675197">c</span>&nbsp;<span class="op" id="1675199">=</span>&nbsp;<span class="ident" id="1675201">c3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1675207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1675211">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1675215">if</span>&nbsp;<span class="ident" id="1675218">w</span>&nbsp;<span class="op" id="1675220">&gt;=</span>&nbsp;<span class="ident" id="1675223">when</span>&nbsp;<span class="op" id="1675228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1675233">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1675241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675245">t</span><span class="op" id="1675246">[</span><span class="ident" id="1675247">i</span><span class="op" id="1675248">]</span>&nbsp;<span class="op" id="1675250">=</span>&nbsp;<span class="ident" id="1675252">t</span><span class="op" id="1675253">[</span><span class="ident" id="1675254">c</span><span class="op" id="1675255">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675259">t</span><span class="op" id="1675260">[</span><span class="ident" id="1675261">i</span><span class="op" id="1675262">]</span><span class="op" id="1675263">.</span><span class="ident" id="1675264">i</span>&nbsp;<span class="op" id="1675266">=</span>&nbsp;<span class="ident" id="1675268">i</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675272">t</span><span class="op" id="1675273">[</span><span class="ident" id="1675274">c</span><span class="op" id="1675275">]</span>&nbsp;<span class="op" id="1675277">=</span>&nbsp;<span class="ident" id="1675279">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675285">t</span><span class="op" id="1675286">[</span><span class="ident" id="1675287">c</span><span class="op" id="1675288">]</span><span class="op" id="1675289">.</span><span class="ident" id="1675290">i</span>&nbsp;<span class="op" id="1675292">=</span>&nbsp;<span class="ident" id="1675294">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1675298">i</span>&nbsp;<span class="op" id="1675300">=</span>&nbsp;<span class="ident" id="1675302">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1675305">}</span><br>
<span class="lineno"></span><span class="op" id="1675307">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
