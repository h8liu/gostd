<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2041660">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2041715">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2041769">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2041820">//&nbsp;+build&nbsp;linux</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2041837">package</span>&nbsp;<span class="ident" id="2041845">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2041854">import</span>&nbsp;<span class="string" id="2041861">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="2041871">func</span>&nbsp;<span class="ident" id="2041876">epollcreate</span><span class="op" id="2041887">(</span><span class="ident" id="2041888">size</span>&nbsp;<span class="builtintype" id="2041893">int32</span><span class="op" id="2041898">)</span>&nbsp;<span class="builtintype" id="2041900">int32</span><br>
<span class="lineno"></span><span class="keyword" id="2041906">func</span>&nbsp;<span class="ident" id="2041911">epollcreate1</span><span class="op" id="2041923">(</span><span class="ident" id="2041924">flags</span>&nbsp;<span class="builtintype" id="2041930">int32</span><span class="op" id="2041935">)</span>&nbsp;<span class="builtintype" id="2041937">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2041944">//go:noescape</span><br>
<span class="lineno">15</span><span class="keyword" id="2041958">func</span>&nbsp;<span class="ident" id="2041963">epollctl</span><span class="op" id="2041971">(</span><span class="ident" id="2041972">epfd</span><span class="op" id="2041976">,</span>&nbsp;<span class="ident" id="2041978">op</span><span class="op" id="2041980">,</span>&nbsp;<span class="ident" id="2041982">fd</span>&nbsp;<span class="builtintype" id="2041985">int32</span><span class="op" id="2041990">,</span>&nbsp;<span class="ident" id="2041992">ev</span>&nbsp;<span class="op" id="2041995">*</span><span class="ident" id="2041996"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2192126">epollevent</a></span><span class="op" id="2042006">)</span>&nbsp;<span class="builtintype" id="2042008">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2042015">//go:noescape</span><br>
<span class="lineno"></span><span class="keyword" id="2042029">func</span>&nbsp;<span class="ident" id="2042034">epollwait</span><span class="op" id="2042043">(</span><span class="ident" id="2042044">epfd</span>&nbsp;<span class="builtintype" id="2042049">int32</span><span class="op" id="2042054">,</span>&nbsp;<span class="ident" id="2042056">ev</span>&nbsp;<span class="op" id="2042059">*</span><span class="ident" id="2042060"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2192126">epollevent</a></span><span class="op" id="2042070">,</span>&nbsp;<span class="ident" id="2042072">nev</span><span class="op" id="2042075">,</span>&nbsp;<span class="ident" id="2042077">timeout</span>&nbsp;<span class="builtintype" id="2042085">int32</span><span class="op" id="2042090">)</span>&nbsp;<span class="builtintype" id="2042092">int32</span><br>
<span class="lineno"></span><span class="keyword" id="2042098">func</span>&nbsp;<span class="ident" id="2042103">closeonexec</span><span class="op" id="2042114">(</span><span class="ident" id="2042115">fd</span>&nbsp;<span class="builtintype" id="2042118">int32</span><span class="op" id="2042123">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2042126">var</span>&nbsp;<span class="op" id="2042130">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042133">epfd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2042148">int32</span>&nbsp;<span class="op" id="2042154">=</span>&nbsp;<span class="op" id="2042156">-</span><span class="num" id="2042157">1</span>&nbsp;<span class="comment" id="2042159">//&nbsp;epoll&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042180">netpolllasterr</span>&nbsp;<span class="builtintype" id="2042195">int32</span><br>
<span class="lineno"></span><span class="op" id="2042201">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="2042204">func</span>&nbsp;<span class="ident" id="2042209">netpollinit</span><span class="op" id="2042220">(</span><span class="op" id="2042221">)</span>&nbsp;<span class="op" id="2042223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042226"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span>&nbsp;<span class="op" id="2042231">=</span>&nbsp;<span class="ident" id="2042233"><a href="/runtime/netpoll_epoll.go.html#2041911">epollcreate1</a></span><span class="op" id="2042245">(</span><span class="ident" id="2042246"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191619">_EPOLL_CLOEXEC</a></span><span class="op" id="2042260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042263">if</span>&nbsp;<span class="ident" id="2042266"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span>&nbsp;<span class="op" id="2042271">&gt;=</span>&nbsp;<span class="num" id="2042274">0</span>&nbsp;<span class="op" id="2042276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042280">return</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042291"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span>&nbsp;<span class="op" id="2042296">=</span>&nbsp;<span class="ident" id="2042298"><a href="/runtime/netpoll_epoll.go.html#2041876">epollcreate</a></span><span class="op" id="2042309">(</span><span class="num" id="2042310">1024</span><span class="op" id="2042314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042317">if</span>&nbsp;<span class="ident" id="2042320"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span>&nbsp;<span class="op" id="2042325">&gt;=</span>&nbsp;<span class="num" id="2042328">0</span>&nbsp;<span class="op" id="2042330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042334"><a href="/runtime/netpoll_epoll.go.html#2042103">closeonexec</a></span><span class="op" id="2042345">(</span><span class="ident" id="2042346"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span><span class="op" id="2042350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042354">return</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2042365">println</span><span class="op" id="2042372">(</span><span class="string" id="2042373">&#34;netpollinit:&nbsp;failed&nbsp;to&nbsp;create&nbsp;epoll&nbsp;descriptor&#34;</span><span class="op" id="2042421">,</span>&nbsp;<span class="op" id="2042423">-</span><span class="ident" id="2042424"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span><span class="op" id="2042428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042431"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2042438">(</span><span class="string" id="2042439">&#34;netpollinit:&nbsp;failed&nbsp;to&nbsp;create&nbsp;descriptor&#34;</span><span class="op" id="2042481">)</span><br>
<span class="lineno"></span><span class="op" id="2042483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2042486">func</span>&nbsp;<span class="ident" id="2042491">netpollopen</span><span class="op" id="2042502">(</span><span class="ident" id="2042503">fd</span>&nbsp;<span class="builtintype" id="2042506">uintptr</span><span class="op" id="2042513">,</span>&nbsp;<span class="ident" id="2042515">pd</span>&nbsp;<span class="op" id="2042518">*</span><span class="ident" id="2042519"><a href="/runtime/netpoll.go.html#2031666">pollDesc</a></span><span class="op" id="2042527">)</span>&nbsp;<span class="builtintype" id="2042529">int32</span>&nbsp;<span class="op" id="2042535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042538">var</span>&nbsp;<span class="ident" id="2042542">ev</span>&nbsp;<span class="ident" id="2042545"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2192126">epollevent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042557"><a href="/runtime/netpoll_epoll.go.html#2042542">ev</a></span><span class="op" id="2042559">.</span><span class="ident" id="2042560">events</span>&nbsp;<span class="op" id="2042567">=</span>&nbsp;<span class="ident" id="2042569"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191486">_EPOLLIN</a></span>&nbsp;<span class="op" id="2042578">|</span>&nbsp;<span class="ident" id="2042580"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191505">_EPOLLOUT</a></span>&nbsp;<span class="op" id="2042590">|</span>&nbsp;<span class="ident" id="2042592"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191566">_EPOLLRDHUP</a></span>&nbsp;<span class="op" id="2042604">|</span>&nbsp;<span class="ident" id="2042606"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191591">_EPOLLET</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2042616">*</span><span class="op" id="2042617">(</span><span class="op" id="2042618">*</span><span class="op" id="2042619">*</span><span class="ident" id="2042620"><a href="/runtime/netpoll.go.html#2031666">pollDesc</a></span><span class="op" id="2042628">)</span><span class="op" id="2042629">(</span><span class="ident" id="2042630"><a href="/runtime/netpoll_epoll.go.html#2041861">unsafe</a></span><span class="op" id="2042636">.</span><span class="ident" id="2042637">Pointer</span><span class="op" id="2042644">(</span><span class="op" id="2042645">&amp;</span><span class="ident" id="2042646"><a href="/runtime/netpoll_epoll.go.html#2042542">ev</a></span><span class="op" id="2042648">.</span><span class="ident" id="2042649">data</span><span class="op" id="2042653">)</span><span class="op" id="2042654">)</span>&nbsp;<span class="op" id="2042656">=</span>&nbsp;<span class="ident" id="2042658"><a href="/runtime/netpoll_epoll.go.html#2042515">pd</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042662">return</span>&nbsp;<span class="op" id="2042669">-</span><span class="ident" id="2042670"><a href="/runtime/netpoll_epoll.go.html#2041963">epollctl</a></span><span class="op" id="2042678">(</span><span class="ident" id="2042679"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span><span class="op" id="2042683">,</span>&nbsp;<span class="ident" id="2042685"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191649">_EPOLL_CTL_ADD</a></span><span class="op" id="2042699">,</span>&nbsp;<span class="builtintype" id="2042701">int32</span><span class="op" id="2042706">(</span><span class="ident" id="2042707"><a href="/runtime/netpoll_epoll.go.html#2042503">fd</a></span><span class="op" id="2042709">)</span><span class="op" id="2042710">,</span>&nbsp;<span class="op" id="2042712">&amp;</span><span class="ident" id="2042713"><a href="/runtime/netpoll_epoll.go.html#2042542">ev</a></span><span class="op" id="2042715">)</span><br>
<span class="lineno">45</span><span class="op" id="2042717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2042720">func</span>&nbsp;<span class="ident" id="2042725">netpollclose</span><span class="op" id="2042737">(</span><span class="ident" id="2042738">fd</span>&nbsp;<span class="builtintype" id="2042741">uintptr</span><span class="op" id="2042748">)</span>&nbsp;<span class="builtintype" id="2042750">int32</span>&nbsp;<span class="op" id="2042756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042759">var</span>&nbsp;<span class="ident" id="2042763">ev</span>&nbsp;<span class="ident" id="2042766"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2192126">epollevent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2042778">return</span>&nbsp;<span class="op" id="2042785">-</span><span class="ident" id="2042786"><a href="/runtime/netpoll_epoll.go.html#2041963">epollctl</a></span><span class="op" id="2042794">(</span><span class="ident" id="2042795"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span><span class="op" id="2042799">,</span>&nbsp;<span class="ident" id="2042801"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191674">_EPOLL_CTL_DEL</a></span><span class="op" id="2042815">,</span>&nbsp;<span class="builtintype" id="2042817">int32</span><span class="op" id="2042822">(</span><span class="ident" id="2042823"><a href="/runtime/netpoll_epoll.go.html#2042738">fd</a></span><span class="op" id="2042825">)</span><span class="op" id="2042826">,</span>&nbsp;<span class="op" id="2042828">&amp;</span><span class="ident" id="2042829"><a href="/runtime/netpoll_epoll.go.html#2042763">ev</a></span><span class="op" id="2042831">)</span><br>
<span class="lineno">50</span><span class="op" id="2042833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2042836">func</span>&nbsp;<span class="ident" id="2042841">netpollarm</span><span class="op" id="2042851">(</span><span class="ident" id="2042852">pd</span>&nbsp;<span class="op" id="2042855">*</span><span class="ident" id="2042856"><a href="/runtime/netpoll.go.html#2031666">pollDesc</a></span><span class="op" id="2042864">,</span>&nbsp;<span class="ident" id="2042866">mode</span>&nbsp;<span class="builtintype" id="2042871">int</span><span class="op" id="2042874">)</span>&nbsp;<span class="op" id="2042876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2042879"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2042886">(</span><span class="string" id="2042887">&#34;unused&#34;</span><span class="op" id="2042895">)</span><br>
<span class="lineno"></span><span class="op" id="2042897">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2042900">//&nbsp;polls&nbsp;for&nbsp;ready&nbsp;network&nbsp;connections</span><br>
<span class="lineno"></span><span class="comment" id="2042939">//&nbsp;returns&nbsp;list&nbsp;of&nbsp;goroutines&nbsp;that&nbsp;become&nbsp;runnable</span><br>
<span class="lineno"></span><span class="keyword" id="2042990">func</span>&nbsp;<span class="ident" id="2042995">netpoll</span><span class="op" id="2043002">(</span><span class="ident" id="2043003">block</span>&nbsp;<span class="builtintype" id="2043009">bool</span><span class="op" id="2043013">)</span>&nbsp;<span class="op" id="2043015">(</span><span class="ident" id="2043016">gp</span>&nbsp;<span class="op" id="2043019">*</span><span class="ident" id="2043020"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2180373">g</a></span><span class="op" id="2043021">)</span>&nbsp;<span class="op" id="2043023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043026">if</span>&nbsp;<span class="ident" id="2043029"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span>&nbsp;<span class="op" id="2043034">==</span>&nbsp;<span class="op" id="2043037">-</span><span class="num" id="2043038">1</span>&nbsp;<span class="op" id="2043040">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043044">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043055">waitms</span>&nbsp;<span class="op" id="2043062">:=</span>&nbsp;<span class="builtintype" id="2043065">int32</span><span class="op" id="2043070">(</span><span class="op" id="2043071">-</span><span class="num" id="2043072">1</span><span class="op" id="2043073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043076">if</span>&nbsp;<span class="op" id="2043079">!</span><span class="ident" id="2043080"><a href="/runtime/netpoll_epoll.go.html#2043003">block</a></span>&nbsp;<span class="op" id="2043086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043090"><a href="/runtime/netpoll_epoll.go.html#2043055">waitms</a></span>&nbsp;<span class="op" id="2043097">=</span>&nbsp;<span class="num" id="2043099">0</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043105">var</span>&nbsp;<span class="ident" id="2043109">events</span>&nbsp;<span class="op" id="2043116">[</span><span class="num" id="2043117">128</span><span class="op" id="2043120">]</span><span class="ident" id="2043121"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2192126">epollevent</a></span><br>
<span class="lineno"></span><span class="ident" id="2043132">retry</span><span class="op" id="2043137">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043140">n</span>&nbsp;<span class="op" id="2043142">:=</span>&nbsp;<span class="ident" id="2043145"><a href="/runtime/netpoll_epoll.go.html#2042034">epollwait</a></span><span class="op" id="2043154">(</span><span class="ident" id="2043155"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span><span class="op" id="2043159">,</span>&nbsp;<span class="op" id="2043161">&amp;</span><span class="ident" id="2043162"><a href="/runtime/netpoll_epoll.go.html#2043109">events</a></span><span class="op" id="2043168">[</span><span class="num" id="2043169">0</span><span class="op" id="2043170">]</span><span class="op" id="2043171">,</span>&nbsp;<span class="builtintype" id="2043173">int32</span><span class="op" id="2043178">(</span><span class="builtinfunc" id="2043179">len</span><span class="op" id="2043182">(</span><span class="ident" id="2043183"><a href="/runtime/netpoll_epoll.go.html#2043109">events</a></span><span class="op" id="2043189">)</span><span class="op" id="2043190">)</span><span class="op" id="2043191">,</span>&nbsp;<span class="ident" id="2043193"><a href="/runtime/netpoll_epoll.go.html#2043055">waitms</a></span><span class="op" id="2043199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043202">if</span>&nbsp;<span class="ident" id="2043205"><a href="/runtime/netpoll_epoll.go.html#2043140">n</a></span>&nbsp;<span class="op" id="2043207">&lt;</span>&nbsp;<span class="num" id="2043209">0</span>&nbsp;<span class="op" id="2043211">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043215">if</span>&nbsp;<span class="ident" id="2043218"><a href="/runtime/netpoll_epoll.go.html#2043140">n</a></span>&nbsp;<span class="op" id="2043220">!=</span>&nbsp;<span class="op" id="2043223">-</span><span class="ident" id="2043224"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2190197">_EINTR</a></span>&nbsp;<span class="op" id="2043231">&amp;&amp;</span>&nbsp;<span class="ident" id="2043234"><a href="/runtime/netpoll_epoll.go.html#2043140">n</a></span>&nbsp;<span class="op" id="2043236">!=</span>&nbsp;<span class="ident" id="2043239"><a href="/runtime/netpoll_epoll.go.html#2042180">netpolllasterr</a></span>&nbsp;<span class="op" id="2043254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043259"><a href="/runtime/netpoll_epoll.go.html#2042180">netpolllasterr</a></span>&nbsp;<span class="op" id="2043274">=</span>&nbsp;<span class="ident" id="2043276"><a href="/runtime/netpoll_epoll.go.html#2043140">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2043281">println</span><span class="op" id="2043288">(</span><span class="string" id="2043289">&#34;runtime:&nbsp;epollwait&nbsp;on&nbsp;fd&#34;</span><span class="op" id="2043315">,</span>&nbsp;<span class="ident" id="2043317"><a href="/runtime/netpoll_epoll.go.html#2042133">epfd</a></span><span class="op" id="2043321">,</span>&nbsp;<span class="string" id="2043323">&#34;failed&nbsp;with&#34;</span><span class="op" id="2043336">,</span>&nbsp;<span class="op" id="2043338">-</span><span class="ident" id="2043339"><a href="/runtime/netpoll_epoll.go.html#2043140">n</a></span><span class="op" id="2043340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043348">goto</span>&nbsp;<span class="ident" id="2043353">retry</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043363">for</span>&nbsp;<span class="ident" id="2043367">i</span>&nbsp;<span class="op" id="2043369">:=</span>&nbsp;<span class="builtintype" id="2043372">int32</span><span class="op" id="2043377">(</span><span class="num" id="2043378">0</span><span class="op" id="2043379">)</span><span class="op" id="2043380">;</span>&nbsp;<span class="ident" id="2043382"><a href="/runtime/netpoll_epoll.go.html#2043367">i</a></span>&nbsp;<span class="op" id="2043384">&lt;</span>&nbsp;<span class="ident" id="2043386"><a href="/runtime/netpoll_epoll.go.html#2043140">n</a></span><span class="op" id="2043387">;</span>&nbsp;<span class="ident" id="2043389"><a href="/runtime/netpoll_epoll.go.html#2043367">i</a></span><span class="op" id="2043390">++</span>&nbsp;<span class="op" id="2043393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043397">ev</span>&nbsp;<span class="op" id="2043400">:=</span>&nbsp;<span class="op" id="2043403">&amp;</span><span class="ident" id="2043404"><a href="/runtime/netpoll_epoll.go.html#2043109">events</a></span><span class="op" id="2043410">[</span><span class="ident" id="2043411"><a href="/runtime/netpoll_epoll.go.html#2043367">i</a></span><span class="op" id="2043412">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043416">if</span>&nbsp;<span class="ident" id="2043419"><a href="/runtime/netpoll_epoll.go.html#2043397">ev</a></span><span class="op" id="2043421">.</span><span class="ident" id="2043422">events</span>&nbsp;<span class="op" id="2043429">==</span>&nbsp;<span class="num" id="2043432">0</span>&nbsp;<span class="op" id="2043434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043439">continue</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043454">var</span>&nbsp;<span class="ident" id="2043458">mode</span>&nbsp;<span class="builtintype" id="2043463">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043471">if</span>&nbsp;<span class="ident" id="2043474"><a href="/runtime/netpoll_epoll.go.html#2043397">ev</a></span><span class="op" id="2043476">.</span><span class="ident" id="2043477">events</span><span class="op" id="2043483">&amp;</span><span class="op" id="2043484">(</span><span class="ident" id="2043485"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191486">_EPOLLIN</a></span><span class="op" id="2043493">|</span><span class="ident" id="2043494"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191566">_EPOLLRDHUP</a></span><span class="op" id="2043505">|</span><span class="ident" id="2043506"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191545">_EPOLLHUP</a></span><span class="op" id="2043515">|</span><span class="ident" id="2043516"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191525">_EPOLLERR</a></span><span class="op" id="2043525">)</span>&nbsp;<span class="op" id="2043527">!=</span>&nbsp;<span class="num" id="2043530">0</span>&nbsp;<span class="op" id="2043532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043537"><a href="/runtime/netpoll_epoll.go.html#2043458">mode</a></span>&nbsp;<span class="op" id="2043542">+=</span>&nbsp;<span class="string" id="2043545">&#39;r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043551">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043555">if</span>&nbsp;<span class="ident" id="2043558"><a href="/runtime/netpoll_epoll.go.html#2043397">ev</a></span><span class="op" id="2043560">.</span><span class="ident" id="2043561">events</span><span class="op" id="2043567">&amp;</span><span class="op" id="2043568">(</span><span class="ident" id="2043569"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191505">_EPOLLOUT</a></span><span class="op" id="2043578">|</span><span class="ident" id="2043579"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191545">_EPOLLHUP</a></span><span class="op" id="2043588">|</span><span class="ident" id="2043589"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2191525">_EPOLLERR</a></span><span class="op" id="2043598">)</span>&nbsp;<span class="op" id="2043600">!=</span>&nbsp;<span class="num" id="2043603">0</span>&nbsp;<span class="op" id="2043605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043610"><a href="/runtime/netpoll_epoll.go.html#2043458">mode</a></span>&nbsp;<span class="op" id="2043615">+=</span>&nbsp;<span class="string" id="2043618">&#39;w&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043628">if</span>&nbsp;<span class="ident" id="2043631"><a href="/runtime/netpoll_epoll.go.html#2043458">mode</a></span>&nbsp;<span class="op" id="2043636">!=</span>&nbsp;<span class="num" id="2043639">0</span>&nbsp;<span class="op" id="2043641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043646">pd</span>&nbsp;<span class="op" id="2043649">:=</span>&nbsp;<span class="op" id="2043652">*</span><span class="op" id="2043653">(</span><span class="op" id="2043654">*</span><span class="op" id="2043655">*</span><span class="ident" id="2043656"><a href="/runtime/netpoll.go.html#2031666">pollDesc</a></span><span class="op" id="2043664">)</span><span class="op" id="2043665">(</span><span class="ident" id="2043666"><a href="/runtime/netpoll_epoll.go.html#2041861">unsafe</a></span><span class="op" id="2043672">.</span><span class="ident" id="2043673">Pointer</span><span class="op" id="2043680">(</span><span class="op" id="2043681">&amp;</span><span class="ident" id="2043682"><a href="/runtime/netpoll_epoll.go.html#2043397">ev</a></span><span class="op" id="2043684">.</span><span class="ident" id="2043685">data</span><span class="op" id="2043689">)</span><span class="op" id="2043690">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2043695"><a href="/runtime/netpoll.go.html#2037639">netpollready</a></span><span class="op" id="2043707">(</span><span class="op" id="2043708">(</span><span class="op" id="2043709">*</span><span class="op" id="2043710">*</span><span class="ident" id="2043711"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2180373">g</a></span><span class="op" id="2043712">)</span><span class="op" id="2043713">(</span><span class="ident" id="2043714"><a href="/runtime/stubs.go.html#2136422">noescape</a></span><span class="op" id="2043722">(</span><span class="ident" id="2043723"><a href="/runtime/netpoll_epoll.go.html#2041861">unsafe</a></span><span class="op" id="2043729">.</span><span class="ident" id="2043730">Pointer</span><span class="op" id="2043737">(</span><span class="op" id="2043738">&amp;</span><span class="ident" id="2043739"><a href="/runtime/netpoll_epoll.go.html#2043016">gp</a></span><span class="op" id="2043741">)</span><span class="op" id="2043742">)</span><span class="op" id="2043743">)</span><span class="op" id="2043744">,</span>&nbsp;<span class="ident" id="2043746"><a href="/runtime/netpoll_epoll.go.html#2043646">pd</a></span><span class="op" id="2043748">,</span>&nbsp;<span class="ident" id="2043750"><a href="/runtime/netpoll_epoll.go.html#2043458">mode</a></span><span class="op" id="2043754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043764">if</span>&nbsp;<span class="ident" id="2043767"><a href="/runtime/netpoll_epoll.go.html#2043003">block</a></span>&nbsp;<span class="op" id="2043773">&amp;&amp;</span>&nbsp;<span class="ident" id="2043776"><a href="/runtime/netpoll_epoll.go.html#2043016">gp</a></span>&nbsp;<span class="op" id="2043779">==</span>&nbsp;<span class="ident" id="2043782">nil</span>&nbsp;<span class="op" id="2043786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043790">goto</span>&nbsp;<span class="ident" id="2043795">retry</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2043802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2043805">return</span>&nbsp;<span class="ident" id="2043812"><a href="/runtime/netpoll_epoll.go.html#2043016">gp</a></span><br>
<span class="lineno"></span><span class="op" id="2043815">}</span>
</div>
</body>
</html>
