<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5180080">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5180135">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5180189">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5180240">package</span>&nbsp;<span class="ident" id="5180248">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5180258">import</span>&nbsp;<span class="op" id="5180265">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5180268">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5180277">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5180284">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5180295">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5180310">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5180313">//&nbsp;endsWithCSSKeyword&nbsp;reports&nbsp;whether&nbsp;b&nbsp;ends&nbsp;with&nbsp;an&nbsp;ident&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5180377">//&nbsp;case-insensitively&nbsp;matches&nbsp;the&nbsp;lower-case&nbsp;kw.</span><br>
<span class="lineno"></span><span class="keyword" id="5180426">func</span>&nbsp;<span class="ident" id="5180431">endsWithCSSKeyword</span><span class="op" id="5180449">(</span><span class="ident" id="5180450">b</span>&nbsp;<span class="op" id="5180452">[</span><span class="op" id="5180453">]</span><span class="builtintype" id="5180454">byte</span><span class="op" id="5180458">,</span>&nbsp;<span class="ident" id="5180460">kw</span>&nbsp;<span class="builtintype" id="5180463">string</span><span class="op" id="5180469">)</span>&nbsp;<span class="builtintype" id="5180471">bool</span>&nbsp;<span class="op" id="5180476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180479">i</span>&nbsp;<span class="op" id="5180481">:=</span>&nbsp;<span class="builtinfunc" id="5180484">len</span><span class="op" id="5180487">(</span><span class="ident" id="5180488">b</span><span class="op" id="5180489">)</span>&nbsp;<span class="op" id="5180491">-</span>&nbsp;<span class="builtinfunc" id="5180493">len</span><span class="op" id="5180496">(</span><span class="ident" id="5180497">kw</span><span class="op" id="5180499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180502">if</span>&nbsp;<span class="ident" id="5180505">i</span>&nbsp;<span class="op" id="5180507">&lt;</span>&nbsp;<span class="num" id="5180509">0</span>&nbsp;<span class="op" id="5180511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180515">//&nbsp;Too&nbsp;short.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180531">return</span>&nbsp;<span class="builtintype" id="5180538">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180548">if</span>&nbsp;<span class="ident" id="5180551">i</span>&nbsp;<span class="op" id="5180553">!=</span>&nbsp;<span class="num" id="5180556">0</span>&nbsp;<span class="op" id="5180558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180562">r</span><span class="op" id="5180563">,</span>&nbsp;<span class="ident" id="5180565">_</span>&nbsp;<span class="op" id="5180567">:=</span>&nbsp;<span class="ident" id="5180570">utf8</span><span class="op" id="5180574">.</span><span class="ident" id="5180575">DecodeLastRune</span><span class="op" id="5180589">(</span><span class="ident" id="5180590">b</span><span class="op" id="5180591">[</span><span class="op" id="5180592">:</span><span class="ident" id="5180593">i</span><span class="op" id="5180594">]</span><span class="op" id="5180595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180599">if</span>&nbsp;<span class="ident" id="5180602">isCSSNmchar</span><span class="op" id="5180613">(</span><span class="ident" id="5180614">r</span><span class="op" id="5180615">)</span>&nbsp;<span class="op" id="5180617">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180622">//&nbsp;Too&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180638">return</span>&nbsp;<span class="builtintype" id="5180645">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180659">//&nbsp;Many&nbsp;CSS&nbsp;keywords,&nbsp;such&nbsp;as&nbsp;&#34;!important&#34;&nbsp;can&nbsp;have&nbsp;characters&nbsp;encoded,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180732">//&nbsp;but&nbsp;the&nbsp;URI&nbsp;production&nbsp;does&nbsp;not&nbsp;allow&nbsp;that&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180792">//&nbsp;http://www.w3.org/TR/css3-syntax/#TOK-URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180838">//&nbsp;This&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;recognize&nbsp;encoded&nbsp;keywords.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180908">//&nbsp;given&nbsp;&#34;\75\72\6c&#34;&nbsp;and&nbsp;&#34;url&#34;&nbsp;this&nbsp;return&nbsp;false.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180959">return</span>&nbsp;<span class="builtintype" id="5180966">string</span><span class="op" id="5180972">(</span><span class="ident" id="5180973">bytes</span><span class="op" id="5180978">.</span><span class="ident" id="5180979">ToLower</span><span class="op" id="5180986">(</span><span class="ident" id="5180987">b</span><span class="op" id="5180988">[</span><span class="ident" id="5180989">i</span><span class="op" id="5180990">:</span><span class="op" id="5180991">]</span><span class="op" id="5180992">)</span><span class="op" id="5180993">)</span>&nbsp;<span class="op" id="5180995">==</span>&nbsp;<span class="ident" id="5180998">kw</span><br>
<span class="lineno">35</span><span class="op" id="5181001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5181004">//&nbsp;isCSSNmchar&nbsp;reports&nbsp;whether&nbsp;rune&nbsp;is&nbsp;allowed&nbsp;anywhere&nbsp;in&nbsp;a&nbsp;CSS&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="5181081">func</span>&nbsp;<span class="ident" id="5181086">isCSSNmchar</span><span class="op" id="5181097">(</span><span class="ident" id="5181098">r</span>&nbsp;<span class="builtintype" id="5181100">rune</span><span class="op" id="5181104">)</span>&nbsp;<span class="builtintype" id="5181106">bool</span>&nbsp;<span class="op" id="5181111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181114">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;CSS3&nbsp;nmchar&nbsp;production&nbsp;but&nbsp;ignores&nbsp;multi-rune&nbsp;escape</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181184">//&nbsp;sequences.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181199">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-nmchar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5181251">return</span>&nbsp;<span class="string" id="5181258">&#39;a&#39;</span>&nbsp;<span class="op" id="5181262">&lt;=</span>&nbsp;<span class="ident" id="5181265">r</span>&nbsp;<span class="op" id="5181267">&amp;&amp;</span>&nbsp;<span class="ident" id="5181270">r</span>&nbsp;<span class="op" id="5181272">&lt;=</span>&nbsp;<span class="string" id="5181275">&#39;z&#39;</span>&nbsp;<span class="op" id="5181279">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5181284">&#39;A&#39;</span>&nbsp;<span class="op" id="5181288">&lt;=</span>&nbsp;<span class="ident" id="5181291">r</span>&nbsp;<span class="op" id="5181293">&amp;&amp;</span>&nbsp;<span class="ident" id="5181296">r</span>&nbsp;<span class="op" id="5181298">&lt;=</span>&nbsp;<span class="string" id="5181301">&#39;Z&#39;</span>&nbsp;<span class="op" id="5181305">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5181310">&#39;0&#39;</span>&nbsp;<span class="op" id="5181314">&lt;=</span>&nbsp;<span class="ident" id="5181317">r</span>&nbsp;<span class="op" id="5181319">&amp;&amp;</span>&nbsp;<span class="ident" id="5181322">r</span>&nbsp;<span class="op" id="5181324">&lt;=</span>&nbsp;<span class="string" id="5181327">&#39;9&#39;</span>&nbsp;<span class="op" id="5181331">||</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5181336">r</span>&nbsp;<span class="op" id="5181338">==</span>&nbsp;<span class="string" id="5181341">&#39;-&#39;</span>&nbsp;<span class="op" id="5181345">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5181350">r</span>&nbsp;<span class="op" id="5181352">==</span>&nbsp;<span class="string" id="5181355">&#39;_&#39;</span>&nbsp;<span class="op" id="5181359">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181364">//&nbsp;Non-ASCII&nbsp;cases&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5181392">0x80</span>&nbsp;<span class="op" id="5181397">&lt;=</span>&nbsp;<span class="ident" id="5181400">r</span>&nbsp;<span class="op" id="5181402">&amp;&amp;</span>&nbsp;<span class="ident" id="5181405">r</span>&nbsp;<span class="op" id="5181407">&lt;=</span>&nbsp;<span class="num" id="5181410">0xd7ff</span>&nbsp;<span class="op" id="5181417">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5181422">0xe000</span>&nbsp;<span class="op" id="5181429">&lt;=</span>&nbsp;<span class="ident" id="5181432">r</span>&nbsp;<span class="op" id="5181434">&amp;&amp;</span>&nbsp;<span class="ident" id="5181437">r</span>&nbsp;<span class="op" id="5181439">&lt;=</span>&nbsp;<span class="num" id="5181442">0xfffd</span>&nbsp;<span class="op" id="5181449">||</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5181454">0x10000</span>&nbsp;<span class="op" id="5181462">&lt;=</span>&nbsp;<span class="ident" id="5181465">r</span>&nbsp;<span class="op" id="5181467">&amp;&amp;</span>&nbsp;<span class="ident" id="5181470">r</span>&nbsp;<span class="op" id="5181472">&lt;=</span>&nbsp;<span class="num" id="5181475">0x10ffff</span><br>
<span class="lineno"></span><span class="op" id="5181484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5181487">//&nbsp;decodeCSS&nbsp;decodes&nbsp;CSS3&nbsp;escapes&nbsp;given&nbsp;a&nbsp;sequence&nbsp;of&nbsp;stringchars.</span><br>
<span class="lineno"></span><span class="comment" id="5181554">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;change,&nbsp;it&nbsp;returns&nbsp;the&nbsp;input,&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno">55</span><span class="comment" id="5181631">//&nbsp;backed&nbsp;by&nbsp;a&nbsp;new&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="5181657">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-stringchar&nbsp;defines&nbsp;stringchar.</span><br>
<span class="lineno"></span><span class="keyword" id="5181732">func</span>&nbsp;<span class="ident" id="5181737">decodeCSS</span><span class="op" id="5181746">(</span><span class="ident" id="5181747">s</span>&nbsp;<span class="op" id="5181749">[</span><span class="op" id="5181750">]</span><span class="builtintype" id="5181751">byte</span><span class="op" id="5181755">)</span>&nbsp;<span class="op" id="5181757">[</span><span class="op" id="5181758">]</span><span class="builtintype" id="5181759">byte</span>&nbsp;<span class="op" id="5181764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5181767">i</span>&nbsp;<span class="op" id="5181769">:=</span>&nbsp;<span class="ident" id="5181772">bytes</span><span class="op" id="5181777">.</span><span class="ident" id="5181778">IndexByte</span><span class="op" id="5181787">(</span><span class="ident" id="5181788">s</span><span class="op" id="5181789">,</span>&nbsp;<span class="string" id="5181791">&#39;\\&#39;</span><span class="op" id="5181795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5181798">if</span>&nbsp;<span class="ident" id="5181801">i</span>&nbsp;<span class="op" id="5181803">==</span>&nbsp;<span class="op" id="5181806">-</span><span class="num" id="5181807">1</span>&nbsp;<span class="op" id="5181809">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5181813">return</span>&nbsp;<span class="ident" id="5181820">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5181823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181826">//&nbsp;The&nbsp;UTF-8&nbsp;sequence&nbsp;for&nbsp;a&nbsp;codepoint&nbsp;is&nbsp;never&nbsp;longer&nbsp;than&nbsp;1&nbsp;+&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181894">//&nbsp;number&nbsp;hex&nbsp;digits&nbsp;need&nbsp;to&nbsp;represent&nbsp;that&nbsp;codepoint,&nbsp;so&nbsp;len(s)&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181966">//&nbsp;upper&nbsp;bound&nbsp;on&nbsp;the&nbsp;output&nbsp;length.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182004">b</span>&nbsp;<span class="op" id="5182006">:=</span>&nbsp;<span class="builtinfunc" id="5182009">make</span><span class="op" id="5182013">(</span><span class="op" id="5182014">[</span><span class="op" id="5182015">]</span><span class="builtintype" id="5182016">byte</span><span class="op" id="5182020">,</span>&nbsp;<span class="num" id="5182022">0</span><span class="op" id="5182023">,</span>&nbsp;<span class="builtinfunc" id="5182025">len</span><span class="op" id="5182028">(</span><span class="ident" id="5182029">s</span><span class="op" id="5182030">)</span><span class="op" id="5182031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182034">for</span>&nbsp;<span class="builtinfunc" id="5182038">len</span><span class="op" id="5182041">(</span><span class="ident" id="5182042">s</span><span class="op" id="5182043">)</span>&nbsp;<span class="op" id="5182045">!=</span>&nbsp;<span class="num" id="5182048">0</span>&nbsp;<span class="op" id="5182050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182054">i</span>&nbsp;<span class="op" id="5182056">:=</span>&nbsp;<span class="ident" id="5182059">bytes</span><span class="op" id="5182064">.</span><span class="ident" id="5182065">IndexByte</span><span class="op" id="5182074">(</span><span class="ident" id="5182075">s</span><span class="op" id="5182076">,</span>&nbsp;<span class="string" id="5182078">&#39;\\&#39;</span><span class="op" id="5182082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182086">if</span>&nbsp;<span class="ident" id="5182089">i</span>&nbsp;<span class="op" id="5182091">==</span>&nbsp;<span class="op" id="5182094">-</span><span class="num" id="5182095">1</span>&nbsp;<span class="op" id="5182097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182102">i</span>&nbsp;<span class="op" id="5182104">=</span>&nbsp;<span class="builtinfunc" id="5182106">len</span><span class="op" id="5182109">(</span><span class="ident" id="5182110">s</span><span class="op" id="5182111">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182119">b</span><span class="op" id="5182120">,</span>&nbsp;<span class="ident" id="5182122">s</span>&nbsp;<span class="op" id="5182124">=</span>&nbsp;<span class="builtinfunc" id="5182126">append</span><span class="op" id="5182132">(</span><span class="ident" id="5182133">b</span><span class="op" id="5182134">,</span>&nbsp;<span class="ident" id="5182136">s</span><span class="op" id="5182137">[</span><span class="op" id="5182138">:</span><span class="ident" id="5182139">i</span><span class="op" id="5182140">]</span><span class="op" id="5182141">...</span><span class="op" id="5182144">)</span><span class="op" id="5182145">,</span>&nbsp;<span class="ident" id="5182147">s</span><span class="op" id="5182148">[</span><span class="ident" id="5182149">i</span><span class="op" id="5182150">:</span><span class="op" id="5182151">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182155">if</span>&nbsp;<span class="builtinfunc" id="5182158">len</span><span class="op" id="5182161">(</span><span class="ident" id="5182162">s</span><span class="op" id="5182163">)</span>&nbsp;<span class="op" id="5182165">&lt;</span>&nbsp;<span class="num" id="5182167">2</span>&nbsp;<span class="op" id="5182169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182174">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182182">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182186">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182239">//&nbsp;escape&nbsp;::=&nbsp;unicode&nbsp;|&nbsp;&#39;\&#39;&nbsp;[#x20-#x7E#x80-#xD7FF#xE000-#xFFFD#x10000-#x10FFFF]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182321">if</span>&nbsp;<span class="ident" id="5182324">isHex</span><span class="op" id="5182329">(</span><span class="ident" id="5182330">s</span><span class="op" id="5182331">[</span><span class="num" id="5182332">1</span><span class="op" id="5182333">]</span><span class="op" id="5182334">)</span>&nbsp;<span class="op" id="5182336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182341">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-unicode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182396">//&nbsp;&nbsp;&nbsp;unicode&nbsp;::=&nbsp;&#39;\&#39;&nbsp;[0-9a-fA-F]{1,6}&nbsp;wc?</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182441">j</span>&nbsp;<span class="op" id="5182443">:=</span>&nbsp;<span class="num" id="5182446">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182451">for</span>&nbsp;<span class="ident" id="5182455">j</span>&nbsp;<span class="op" id="5182457">&lt;</span>&nbsp;<span class="builtinfunc" id="5182459">len</span><span class="op" id="5182462">(</span><span class="ident" id="5182463">s</span><span class="op" id="5182464">)</span>&nbsp;<span class="op" id="5182466">&amp;&amp;</span>&nbsp;<span class="ident" id="5182469">j</span>&nbsp;<span class="op" id="5182471">&lt;</span>&nbsp;<span class="num" id="5182473">7</span>&nbsp;<span class="op" id="5182475">&amp;&amp;</span>&nbsp;<span class="ident" id="5182478">isHex</span><span class="op" id="5182483">(</span><span class="ident" id="5182484">s</span><span class="op" id="5182485">[</span><span class="ident" id="5182486">j</span><span class="op" id="5182487">]</span><span class="op" id="5182488">)</span>&nbsp;<span class="op" id="5182490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182496">j</span><span class="op" id="5182497">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182508">r</span>&nbsp;<span class="op" id="5182510">:=</span>&nbsp;<span class="ident" id="5182513">hexDecode</span><span class="op" id="5182522">(</span><span class="ident" id="5182523">s</span><span class="op" id="5182524">[</span><span class="num" id="5182525">1</span><span class="op" id="5182526">:</span><span class="ident" id="5182527">j</span><span class="op" id="5182528">]</span><span class="op" id="5182529">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182534">if</span>&nbsp;<span class="ident" id="5182537">r</span>&nbsp;<span class="op" id="5182539">&gt;</span>&nbsp;<span class="ident" id="5182541">unicode</span><span class="op" id="5182548">.</span><span class="ident" id="5182549">MaxRune</span>&nbsp;<span class="op" id="5182557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182563">r</span><span class="op" id="5182564">,</span>&nbsp;<span class="ident" id="5182566">j</span>&nbsp;<span class="op" id="5182568">=</span>&nbsp;<span class="ident" id="5182570">r</span><span class="op" id="5182571">/</span><span class="num" id="5182572">16</span><span class="op" id="5182574">,</span>&nbsp;<span class="ident" id="5182576">j</span><span class="op" id="5182577">-</span><span class="num" id="5182578">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182588">n</span>&nbsp;<span class="op" id="5182590">:=</span>&nbsp;<span class="ident" id="5182593">utf8</span><span class="op" id="5182597">.</span><span class="ident" id="5182598">EncodeRune</span><span class="op" id="5182608">(</span><span class="ident" id="5182609">b</span><span class="op" id="5182610">[</span><span class="builtinfunc" id="5182611">len</span><span class="op" id="5182614">(</span><span class="ident" id="5182615">b</span><span class="op" id="5182616">)</span><span class="op" id="5182617">:</span><span class="builtinfunc" id="5182618">cap</span><span class="op" id="5182621">(</span><span class="ident" id="5182622">b</span><span class="op" id="5182623">)</span><span class="op" id="5182624">]</span><span class="op" id="5182625">,</span>&nbsp;<span class="ident" id="5182627">r</span><span class="op" id="5182628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182633">//&nbsp;The&nbsp;optional&nbsp;space&nbsp;at&nbsp;the&nbsp;end&nbsp;allows&nbsp;a&nbsp;hex</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182682">//&nbsp;sequence&nbsp;to&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;literal&nbsp;hex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182730">//&nbsp;string(decodeCSS([]byte(`\A&nbsp;B`)))&nbsp;==&nbsp;&#34;\nB&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182779">b</span><span class="op" id="5182780">,</span>&nbsp;<span class="ident" id="5182782">s</span>&nbsp;<span class="op" id="5182784">=</span>&nbsp;<span class="ident" id="5182786">b</span><span class="op" id="5182787">[</span><span class="op" id="5182788">:</span><span class="builtinfunc" id="5182789">len</span><span class="op" id="5182792">(</span><span class="ident" id="5182793">b</span><span class="op" id="5182794">)</span><span class="op" id="5182795">+</span><span class="ident" id="5182796">n</span><span class="op" id="5182797">]</span><span class="op" id="5182798">,</span>&nbsp;<span class="ident" id="5182800">skipCSSSpace</span><span class="op" id="5182812">(</span><span class="ident" id="5182813">s</span><span class="op" id="5182814">[</span><span class="ident" id="5182815">j</span><span class="op" id="5182816">:</span><span class="op" id="5182817">]</span><span class="op" id="5182818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182822">}</span>&nbsp;<span class="keyword" id="5182824">else</span>&nbsp;<span class="op" id="5182829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182834">//&nbsp;`\\`&nbsp;decodes&nbsp;to&nbsp;`\`&nbsp;and&nbsp;`\&#34;`&nbsp;to&nbsp;`&#34;`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182877">_</span><span class="op" id="5182878">,</span>&nbsp;<span class="ident" id="5182880">n</span>&nbsp;<span class="op" id="5182882">:=</span>&nbsp;<span class="ident" id="5182885">utf8</span><span class="op" id="5182889">.</span><span class="ident" id="5182890">DecodeRune</span><span class="op" id="5182900">(</span><span class="ident" id="5182901">s</span><span class="op" id="5182902">[</span><span class="num" id="5182903">1</span><span class="op" id="5182904">:</span><span class="op" id="5182905">]</span><span class="op" id="5182906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182911">b</span><span class="op" id="5182912">,</span>&nbsp;<span class="ident" id="5182914">s</span>&nbsp;<span class="op" id="5182916">=</span>&nbsp;<span class="builtinfunc" id="5182918">append</span><span class="op" id="5182924">(</span><span class="ident" id="5182925">b</span><span class="op" id="5182926">,</span>&nbsp;<span class="ident" id="5182928">s</span><span class="op" id="5182929">[</span><span class="num" id="5182930">1</span><span class="op" id="5182931">:</span><span class="num" id="5182932">1</span><span class="op" id="5182933">+</span><span class="ident" id="5182934">n</span><span class="op" id="5182935">]</span><span class="op" id="5182936">...</span><span class="op" id="5182939">)</span><span class="op" id="5182940">,</span>&nbsp;<span class="ident" id="5182942">s</span><span class="op" id="5182943">[</span><span class="num" id="5182944">1</span><span class="op" id="5182945">+</span><span class="ident" id="5182946">n</span><span class="op" id="5182947">:</span><span class="op" id="5182948">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182958">return</span>&nbsp;<span class="ident" id="5182965">b</span><br>
<span class="lineno">100</span><span class="op" id="5182967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5182970">//&nbsp;isHex&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;character&nbsp;is&nbsp;a&nbsp;hex&nbsp;digit.</span><br>
<span class="lineno"></span><span class="keyword" id="5183031">func</span>&nbsp;<span class="ident" id="5183036">isHex</span><span class="op" id="5183041">(</span><span class="ident" id="5183042">c</span>&nbsp;<span class="builtintype" id="5183044">byte</span><span class="op" id="5183048">)</span>&nbsp;<span class="builtintype" id="5183050">bool</span>&nbsp;<span class="op" id="5183055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183058">return</span>&nbsp;<span class="string" id="5183065">&#39;0&#39;</span>&nbsp;<span class="op" id="5183069">&lt;=</span>&nbsp;<span class="ident" id="5183072">c</span>&nbsp;<span class="op" id="5183074">&amp;&amp;</span>&nbsp;<span class="ident" id="5183077">c</span>&nbsp;<span class="op" id="5183079">&lt;=</span>&nbsp;<span class="string" id="5183082">&#39;9&#39;</span>&nbsp;<span class="op" id="5183086">||</span>&nbsp;<span class="string" id="5183089">&#39;a&#39;</span>&nbsp;<span class="op" id="5183093">&lt;=</span>&nbsp;<span class="ident" id="5183096">c</span>&nbsp;<span class="op" id="5183098">&amp;&amp;</span>&nbsp;<span class="ident" id="5183101">c</span>&nbsp;<span class="op" id="5183103">&lt;=</span>&nbsp;<span class="string" id="5183106">&#39;f&#39;</span>&nbsp;<span class="op" id="5183110">||</span>&nbsp;<span class="string" id="5183113">&#39;A&#39;</span>&nbsp;<span class="op" id="5183117">&lt;=</span>&nbsp;<span class="ident" id="5183120">c</span>&nbsp;<span class="op" id="5183122">&amp;&amp;</span>&nbsp;<span class="ident" id="5183125">c</span>&nbsp;<span class="op" id="5183127">&lt;=</span>&nbsp;<span class="string" id="5183130">&#39;F&#39;</span><br>
<span class="lineno">105</span><span class="op" id="5183134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5183137">//&nbsp;hexDecode&nbsp;decodes&nbsp;a&nbsp;short&nbsp;hex&nbsp;digit&nbsp;sequence:&nbsp;&#34;10&#34;&nbsp;-&gt;&nbsp;16.</span><br>
<span class="lineno"></span><span class="keyword" id="5183198">func</span>&nbsp;<span class="ident" id="5183203">hexDecode</span><span class="op" id="5183212">(</span><span class="ident" id="5183213">s</span>&nbsp;<span class="op" id="5183215">[</span><span class="op" id="5183216">]</span><span class="builtintype" id="5183217">byte</span><span class="op" id="5183221">)</span>&nbsp;<span class="builtintype" id="5183223">rune</span>&nbsp;<span class="op" id="5183228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183231">n</span>&nbsp;<span class="op" id="5183233">:=</span>&nbsp;<span class="string" id="5183236">&#39;\x00&#39;</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183244">for</span>&nbsp;<span class="ident" id="5183248">_</span><span class="op" id="5183249">,</span>&nbsp;<span class="ident" id="5183251">c</span>&nbsp;<span class="op" id="5183253">:=</span>&nbsp;<span class="keyword" id="5183256">range</span>&nbsp;<span class="ident" id="5183262">s</span>&nbsp;<span class="op" id="5183264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183268">n</span>&nbsp;<span class="op" id="5183270">&lt;&lt;=</span>&nbsp;<span class="num" id="5183274">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183278">switch</span>&nbsp;<span class="op" id="5183285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183289">case</span>&nbsp;<span class="string" id="5183294">&#39;0&#39;</span>&nbsp;<span class="op" id="5183298">&lt;=</span>&nbsp;<span class="ident" id="5183301">c</span>&nbsp;<span class="op" id="5183303">&amp;&amp;</span>&nbsp;<span class="ident" id="5183306">c</span>&nbsp;<span class="op" id="5183308">&lt;=</span>&nbsp;<span class="string" id="5183311">&#39;9&#39;</span><span class="op" id="5183314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183319">n</span>&nbsp;<span class="op" id="5183321">|=</span>&nbsp;<span class="builtintype" id="5183324">rune</span><span class="op" id="5183328">(</span><span class="ident" id="5183329">c</span>&nbsp;<span class="op" id="5183331">-</span>&nbsp;<span class="string" id="5183333">&#39;0&#39;</span><span class="op" id="5183336">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183340">case</span>&nbsp;<span class="string" id="5183345">&#39;a&#39;</span>&nbsp;<span class="op" id="5183349">&lt;=</span>&nbsp;<span class="ident" id="5183352">c</span>&nbsp;<span class="op" id="5183354">&amp;&amp;</span>&nbsp;<span class="ident" id="5183357">c</span>&nbsp;<span class="op" id="5183359">&lt;=</span>&nbsp;<span class="string" id="5183362">&#39;f&#39;</span><span class="op" id="5183365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183370">n</span>&nbsp;<span class="op" id="5183372">|=</span>&nbsp;<span class="builtintype" id="5183375">rune</span><span class="op" id="5183379">(</span><span class="ident" id="5183380">c</span><span class="op" id="5183381">-</span><span class="string" id="5183382">&#39;a&#39;</span><span class="op" id="5183385">)</span>&nbsp;<span class="op" id="5183387">+</span>&nbsp;<span class="num" id="5183389">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183394">case</span>&nbsp;<span class="string" id="5183399">&#39;A&#39;</span>&nbsp;<span class="op" id="5183403">&lt;=</span>&nbsp;<span class="ident" id="5183406">c</span>&nbsp;<span class="op" id="5183408">&amp;&amp;</span>&nbsp;<span class="ident" id="5183411">c</span>&nbsp;<span class="op" id="5183413">&lt;=</span>&nbsp;<span class="string" id="5183416">&#39;F&#39;</span><span class="op" id="5183419">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183424">n</span>&nbsp;<span class="op" id="5183426">|=</span>&nbsp;<span class="builtintype" id="5183429">rune</span><span class="op" id="5183433">(</span><span class="ident" id="5183434">c</span><span class="op" id="5183435">-</span><span class="string" id="5183436">&#39;A&#39;</span><span class="op" id="5183439">)</span>&nbsp;<span class="op" id="5183441">+</span>&nbsp;<span class="num" id="5183443">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183448">default</span><span class="op" id="5183455">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5183460">panic</span><span class="op" id="5183465">(</span><span class="ident" id="5183466">fmt</span><span class="op" id="5183469">.</span><span class="ident" id="5183470">Sprintf</span><span class="op" id="5183477">(</span><span class="string" id="5183478">&#34;Bad&nbsp;hex&nbsp;digit&nbsp;in&nbsp;%q&#34;</span><span class="op" id="5183499">,</span>&nbsp;<span class="ident" id="5183501">s</span><span class="op" id="5183502">)</span><span class="op" id="5183503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5183507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5183510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183513">return</span>&nbsp;<span class="ident" id="5183520">n</span><br>
<span class="lineno"></span><span class="op" id="5183522">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5183525">//&nbsp;skipCSSSpace&nbsp;returns&nbsp;a&nbsp;suffix&nbsp;of&nbsp;c,&nbsp;skipping&nbsp;over&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="5183594">func</span>&nbsp;<span class="ident" id="5183599">skipCSSSpace</span><span class="op" id="5183611">(</span><span class="ident" id="5183612">c</span>&nbsp;<span class="op" id="5183614">[</span><span class="op" id="5183615">]</span><span class="builtintype" id="5183616">byte</span><span class="op" id="5183620">)</span>&nbsp;<span class="op" id="5183622">[</span><span class="op" id="5183623">]</span><span class="builtintype" id="5183624">byte</span>&nbsp;<span class="op" id="5183629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183632">if</span>&nbsp;<span class="builtinfunc" id="5183635">len</span><span class="op" id="5183638">(</span><span class="ident" id="5183639">c</span><span class="op" id="5183640">)</span>&nbsp;<span class="op" id="5183642">==</span>&nbsp;<span class="num" id="5183645">0</span>&nbsp;<span class="op" id="5183647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183651">return</span>&nbsp;<span class="ident" id="5183658">c</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5183661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5183664">//&nbsp;wc&nbsp;::=&nbsp;#x9&nbsp;|&nbsp;#xA&nbsp;|&nbsp;#xC&nbsp;|&nbsp;#xD&nbsp;|&nbsp;#x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183704">switch</span>&nbsp;<span class="ident" id="5183711">c</span><span class="op" id="5183712">[</span><span class="num" id="5183713">0</span><span class="op" id="5183714">]</span>&nbsp;<span class="op" id="5183716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183719">case</span>&nbsp;<span class="string" id="5183724">&#39;\t&#39;</span><span class="op" id="5183728">,</span>&nbsp;<span class="string" id="5183730">&#39;\n&#39;</span><span class="op" id="5183734">,</span>&nbsp;<span class="string" id="5183736">&#39;\f&#39;</span><span class="op" id="5183740">,</span>&nbsp;<span class="string" id="5183742">&#39;&nbsp;&#39;</span><span class="op" id="5183745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183749">return</span>&nbsp;<span class="ident" id="5183756">c</span><span class="op" id="5183757">[</span><span class="num" id="5183758">1</span><span class="op" id="5183759">:</span><span class="op" id="5183760">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183763">case</span>&nbsp;<span class="string" id="5183768">&#39;\r&#39;</span><span class="op" id="5183772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5183776">//&nbsp;This&nbsp;differs&nbsp;from&nbsp;CSS3&#39;s&nbsp;wc&nbsp;production&nbsp;because&nbsp;it&nbsp;contains&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5183842">//&nbsp;probable&nbsp;spec&nbsp;error&nbsp;whereby&nbsp;wc&nbsp;contains&nbsp;all&nbsp;the&nbsp;single&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5183907">//&nbsp;sequences&nbsp;in&nbsp;nl&nbsp;(newline)&nbsp;but&nbsp;not&nbsp;CRLF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183952">if</span>&nbsp;<span class="builtinfunc" id="5183955">len</span><span class="op" id="5183958">(</span><span class="ident" id="5183959">c</span><span class="op" id="5183960">)</span>&nbsp;<span class="op" id="5183962">&gt;=</span>&nbsp;<span class="num" id="5183965">2</span>&nbsp;<span class="op" id="5183967">&amp;&amp;</span>&nbsp;<span class="ident" id="5183970">c</span><span class="op" id="5183971">[</span><span class="num" id="5183972">1</span><span class="op" id="5183973">]</span>&nbsp;<span class="op" id="5183975">==</span>&nbsp;<span class="string" id="5183978">&#39;\n&#39;</span>&nbsp;<span class="op" id="5183983">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183988">return</span>&nbsp;<span class="ident" id="5183995">c</span><span class="op" id="5183996">[</span><span class="num" id="5183997">2</span><span class="op" id="5183998">:</span><span class="op" id="5183999">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184007">return</span>&nbsp;<span class="ident" id="5184014">c</span><span class="op" id="5184015">[</span><span class="num" id="5184016">1</span><span class="op" id="5184017">:</span><span class="op" id="5184018">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184024">return</span>&nbsp;<span class="ident" id="5184031">c</span><br>
<span class="lineno">145</span><span class="op" id="5184033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5184036">//&nbsp;isCSSSpace&nbsp;reports&nbsp;whether&nbsp;b&nbsp;is&nbsp;a&nbsp;CSS&nbsp;space&nbsp;char&nbsp;as&nbsp;defined&nbsp;in&nbsp;wc.</span><br>
<span class="lineno"></span><span class="keyword" id="5184106">func</span>&nbsp;<span class="ident" id="5184111">isCSSSpace</span><span class="op" id="5184121">(</span><span class="ident" id="5184122">b</span>&nbsp;<span class="builtintype" id="5184124">byte</span><span class="op" id="5184128">)</span>&nbsp;<span class="builtintype" id="5184130">bool</span>&nbsp;<span class="op" id="5184135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184138">switch</span>&nbsp;<span class="ident" id="5184145">b</span>&nbsp;<span class="op" id="5184147">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184150">case</span>&nbsp;<span class="string" id="5184155">&#39;\t&#39;</span><span class="op" id="5184159">,</span>&nbsp;<span class="string" id="5184161">&#39;\n&#39;</span><span class="op" id="5184165">,</span>&nbsp;<span class="string" id="5184167">&#39;\f&#39;</span><span class="op" id="5184171">,</span>&nbsp;<span class="string" id="5184173">&#39;\r&#39;</span><span class="op" id="5184177">,</span>&nbsp;<span class="string" id="5184179">&#39;&nbsp;&#39;</span><span class="op" id="5184182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184186">return</span>&nbsp;<span class="builtintype" id="5184193">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184202">return</span>&nbsp;<span class="builtintype" id="5184209">false</span><br>
<span class="lineno"></span><span class="op" id="5184215">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5184218">//&nbsp;cssEscaper&nbsp;escapes&nbsp;HTML&nbsp;and&nbsp;CSS&nbsp;special&nbsp;characters&nbsp;using&nbsp;\&lt;hex&gt;+&nbsp;escapes.</span><br>
<span class="lineno"></span><span class="keyword" id="5184295">func</span>&nbsp;<span class="ident" id="5184300">cssEscaper</span><span class="op" id="5184310">(</span><span class="ident" id="5184311">args</span>&nbsp;<span class="op" id="5184316">...</span><span class="keyword" id="5184319">interface</span><span class="op" id="5184328">{</span><span class="op" id="5184329">}</span><span class="op" id="5184330">)</span>&nbsp;<span class="builtintype" id="5184332">string</span>&nbsp;<span class="op" id="5184339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184342">s</span><span class="op" id="5184343">,</span>&nbsp;<span class="ident" id="5184345">_</span>&nbsp;<span class="op" id="5184347">:=</span>&nbsp;<span class="ident" id="5184350">stringify</span><span class="op" id="5184359">(</span><span class="ident" id="5184360">args</span><span class="op" id="5184364">...</span><span class="op" id="5184367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184370">var</span>&nbsp;<span class="ident" id="5184374">b</span>&nbsp;<span class="ident" id="5184376">bytes</span><span class="op" id="5184381">.</span><span class="ident" id="5184382">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184390">written</span>&nbsp;<span class="op" id="5184398">:=</span>&nbsp;<span class="num" id="5184401">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184404">for</span>&nbsp;<span class="ident" id="5184408">i</span><span class="op" id="5184409">,</span>&nbsp;<span class="ident" id="5184411">r</span>&nbsp;<span class="op" id="5184413">:=</span>&nbsp;<span class="keyword" id="5184416">range</span>&nbsp;<span class="ident" id="5184422">s</span>&nbsp;<span class="op" id="5184424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184428">var</span>&nbsp;<span class="ident" id="5184432">repl</span>&nbsp;<span class="builtintype" id="5184437">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184446">switch</span>&nbsp;<span class="ident" id="5184453">r</span>&nbsp;<span class="op" id="5184455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184459">case</span>&nbsp;<span class="num" id="5184464">0</span><span class="op" id="5184465">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184470">repl</span>&nbsp;<span class="op" id="5184475">=</span>&nbsp;<span class="string" id="5184477">`\0`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184484">case</span>&nbsp;<span class="string" id="5184489">&#39;\t&#39;</span><span class="op" id="5184493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184498">repl</span>&nbsp;<span class="op" id="5184503">=</span>&nbsp;<span class="string" id="5184505">`\9`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184512">case</span>&nbsp;<span class="string" id="5184517">&#39;\n&#39;</span><span class="op" id="5184521">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184526">repl</span>&nbsp;<span class="op" id="5184531">=</span>&nbsp;<span class="string" id="5184533">`\a`</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184540">case</span>&nbsp;<span class="string" id="5184545">&#39;\f&#39;</span><span class="op" id="5184549">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184554">repl</span>&nbsp;<span class="op" id="5184559">=</span>&nbsp;<span class="string" id="5184561">`\c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184568">case</span>&nbsp;<span class="string" id="5184573">&#39;\r&#39;</span><span class="op" id="5184577">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184582">repl</span>&nbsp;<span class="op" id="5184587">=</span>&nbsp;<span class="string" id="5184589">`\d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5184596">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5184659">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184709">case</span>&nbsp;<span class="string" id="5184714">&#39;&#34;&#39;</span><span class="op" id="5184717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184722">repl</span>&nbsp;<span class="op" id="5184727">=</span>&nbsp;<span class="string" id="5184729">`\22`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184737">case</span>&nbsp;<span class="string" id="5184742">&#39;&amp;&#39;</span><span class="op" id="5184745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184750">repl</span>&nbsp;<span class="op" id="5184755">=</span>&nbsp;<span class="string" id="5184757">`\26`</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184765">case</span>&nbsp;<span class="string" id="5184770">&#39;\&#39;&#39;</span><span class="op" id="5184774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184779">repl</span>&nbsp;<span class="op" id="5184784">=</span>&nbsp;<span class="string" id="5184786">`\27`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184794">case</span>&nbsp;<span class="string" id="5184799">&#39;(&#39;</span><span class="op" id="5184802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184807">repl</span>&nbsp;<span class="op" id="5184812">=</span>&nbsp;<span class="string" id="5184814">`\28`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184822">case</span>&nbsp;<span class="string" id="5184827">&#39;)&#39;</span><span class="op" id="5184830">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184835">repl</span>&nbsp;<span class="op" id="5184840">=</span>&nbsp;<span class="string" id="5184842">`\29`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184850">case</span>&nbsp;<span class="string" id="5184855">&#39;+&#39;</span><span class="op" id="5184858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184863">repl</span>&nbsp;<span class="op" id="5184868">=</span>&nbsp;<span class="string" id="5184870">`\2b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184878">case</span>&nbsp;<span class="string" id="5184883">&#39;/&#39;</span><span class="op" id="5184886">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184891">repl</span>&nbsp;<span class="op" id="5184896">=</span>&nbsp;<span class="string" id="5184898">`\2f`</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184906">case</span>&nbsp;<span class="string" id="5184911">&#39;:&#39;</span><span class="op" id="5184914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184919">repl</span>&nbsp;<span class="op" id="5184924">=</span>&nbsp;<span class="string" id="5184926">`\3a`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184934">case</span>&nbsp;<span class="string" id="5184939">&#39;;&#39;</span><span class="op" id="5184942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184947">repl</span>&nbsp;<span class="op" id="5184952">=</span>&nbsp;<span class="string" id="5184954">`\3b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184962">case</span>&nbsp;<span class="string" id="5184967">&#39;&lt;&#39;</span><span class="op" id="5184970">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184975">repl</span>&nbsp;<span class="op" id="5184980">=</span>&nbsp;<span class="string" id="5184982">`\3c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184990">case</span>&nbsp;<span class="string" id="5184995">&#39;&gt;&#39;</span><span class="op" id="5184998">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185003">repl</span>&nbsp;<span class="op" id="5185008">=</span>&nbsp;<span class="string" id="5185010">`\3e`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185018">case</span>&nbsp;<span class="string" id="5185023">&#39;\\&#39;</span><span class="op" id="5185027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185032">repl</span>&nbsp;<span class="op" id="5185037">=</span>&nbsp;<span class="string" id="5185039">`\\`</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185046">case</span>&nbsp;<span class="string" id="5185051">&#39;{&#39;</span><span class="op" id="5185054">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185059">repl</span>&nbsp;<span class="op" id="5185064">=</span>&nbsp;<span class="string" id="5185066">`\7b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185074">case</span>&nbsp;<span class="string" id="5185079">&#39;}&#39;</span><span class="op" id="5185082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185087">repl</span>&nbsp;<span class="op" id="5185092">=</span>&nbsp;<span class="string" id="5185094">`\7d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185102">default</span><span class="op" id="5185109">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185114">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5185125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185129">b</span><span class="op" id="5185130">.</span><span class="ident" id="5185131">WriteString</span><span class="op" id="5185142">(</span><span class="ident" id="5185143">s</span><span class="op" id="5185144">[</span><span class="ident" id="5185145">written</span><span class="op" id="5185152">:</span><span class="ident" id="5185153">i</span><span class="op" id="5185154">]</span><span class="op" id="5185155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185159">b</span><span class="op" id="5185160">.</span><span class="ident" id="5185161">WriteString</span><span class="op" id="5185172">(</span><span class="ident" id="5185173">repl</span><span class="op" id="5185177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185181">written</span>&nbsp;<span class="op" id="5185189">=</span>&nbsp;<span class="ident" id="5185191">i</span>&nbsp;<span class="op" id="5185193">+</span>&nbsp;<span class="ident" id="5185195">utf8</span><span class="op" id="5185199">.</span><span class="ident" id="5185200">RuneLen</span><span class="op" id="5185207">(</span><span class="ident" id="5185208">r</span><span class="op" id="5185209">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185213">if</span>&nbsp;<span class="ident" id="5185216">repl</span>&nbsp;<span class="op" id="5185221">!=</span>&nbsp;<span class="string" id="5185224">`\\`</span>&nbsp;<span class="op" id="5185229">&amp;&amp;</span>&nbsp;<span class="op" id="5185232">(</span><span class="ident" id="5185233">written</span>&nbsp;<span class="op" id="5185241">==</span>&nbsp;<span class="builtinfunc" id="5185244">len</span><span class="op" id="5185247">(</span><span class="ident" id="5185248">s</span><span class="op" id="5185249">)</span>&nbsp;<span class="op" id="5185251">||</span>&nbsp;<span class="ident" id="5185254">isHex</span><span class="op" id="5185259">(</span><span class="ident" id="5185260">s</span><span class="op" id="5185261">[</span><span class="ident" id="5185262">written</span><span class="op" id="5185269">]</span><span class="op" id="5185270">)</span>&nbsp;<span class="op" id="5185272">||</span>&nbsp;<span class="ident" id="5185275">isCSSSpace</span><span class="op" id="5185285">(</span><span class="ident" id="5185286">s</span><span class="op" id="5185287">[</span><span class="ident" id="5185288">written</span><span class="op" id="5185295">]</span><span class="op" id="5185296">)</span><span class="op" id="5185297">)</span>&nbsp;<span class="op" id="5185299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185304">b</span><span class="op" id="5185305">.</span><span class="ident" id="5185306">WriteByte</span><span class="op" id="5185315">(</span><span class="string" id="5185316">&#39;&nbsp;&#39;</span><span class="op" id="5185319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5185323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5185326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185329">if</span>&nbsp;<span class="ident" id="5185332">written</span>&nbsp;<span class="op" id="5185340">==</span>&nbsp;<span class="num" id="5185343">0</span>&nbsp;<span class="op" id="5185345">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185349">return</span>&nbsp;<span class="ident" id="5185356">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5185359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185362">b</span><span class="op" id="5185363">.</span><span class="ident" id="5185364">WriteString</span><span class="op" id="5185375">(</span><span class="ident" id="5185376">s</span><span class="op" id="5185377">[</span><span class="ident" id="5185378">written</span><span class="op" id="5185385">:</span><span class="op" id="5185386">]</span><span class="op" id="5185387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185390">return</span>&nbsp;<span class="ident" id="5185397">b</span><span class="op" id="5185398">.</span><span class="ident" id="5185399">String</span><span class="op" id="5185405">(</span><span class="op" id="5185406">)</span><br>
<span class="lineno"></span><span class="op" id="5185408">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="5185411">var</span>&nbsp;<span class="ident" id="5185415">expressionBytes</span>&nbsp;<span class="op" id="5185431">=</span>&nbsp;<span class="op" id="5185433">[</span><span class="op" id="5185434">]</span><span class="builtintype" id="5185435">byte</span><span class="op" id="5185439">(</span><span class="string" id="5185440">&#34;expression&#34;</span><span class="op" id="5185452">)</span><br>
<span class="lineno"></span><span class="keyword" id="5185454">var</span>&nbsp;<span class="ident" id="5185458">mozBindingBytes</span>&nbsp;<span class="op" id="5185474">=</span>&nbsp;<span class="op" id="5185476">[</span><span class="op" id="5185477">]</span><span class="builtintype" id="5185478">byte</span><span class="op" id="5185482">(</span><span class="string" id="5185483">&#34;mozbinding&#34;</span><span class="op" id="5185495">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5185498">//&nbsp;cssValueFilter&nbsp;allows&nbsp;innocuous&nbsp;CSS&nbsp;values&nbsp;in&nbsp;the&nbsp;output&nbsp;including&nbsp;CSS</span><br>
<span class="lineno">225</span><span class="comment" id="5185572">//&nbsp;quantities&nbsp;(10px&nbsp;or&nbsp;25%),&nbsp;ID&nbsp;or&nbsp;class&nbsp;literals&nbsp;(#foo,&nbsp;.bar),&nbsp;keyword&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5185651">//&nbsp;(inherit,&nbsp;blue),&nbsp;and&nbsp;colors&nbsp;(#888).</span><br>
<span class="lineno"></span><span class="comment" id="5185690">//&nbsp;It&nbsp;filters&nbsp;out&nbsp;unsafe&nbsp;values,&nbsp;such&nbsp;as&nbsp;those&nbsp;that&nbsp;affect&nbsp;token&nbsp;boundaries,</span><br>
<span class="lineno"></span><span class="comment" id="5185767">//&nbsp;and&nbsp;anything&nbsp;that&nbsp;might&nbsp;execute&nbsp;scripts.</span><br>
<span class="lineno"></span><span class="keyword" id="5185811">func</span>&nbsp;<span class="ident" id="5185816">cssValueFilter</span><span class="op" id="5185830">(</span><span class="ident" id="5185831">args</span>&nbsp;<span class="op" id="5185836">...</span><span class="keyword" id="5185839">interface</span><span class="op" id="5185848">{</span><span class="op" id="5185849">}</span><span class="op" id="5185850">)</span>&nbsp;<span class="builtintype" id="5185852">string</span>&nbsp;<span class="op" id="5185859">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185862">s</span><span class="op" id="5185863">,</span>&nbsp;<span class="ident" id="5185865">t</span>&nbsp;<span class="op" id="5185867">:=</span>&nbsp;<span class="ident" id="5185870">stringify</span><span class="op" id="5185879">(</span><span class="ident" id="5185880">args</span><span class="op" id="5185884">...</span><span class="op" id="5185887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185890">if</span>&nbsp;<span class="ident" id="5185893">t</span>&nbsp;<span class="op" id="5185895">==</span>&nbsp;<span class="ident" id="5185898">contentTypeCSS</span>&nbsp;<span class="op" id="5185913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185917">return</span>&nbsp;<span class="ident" id="5185924">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5185927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185930">b</span><span class="op" id="5185931">,</span>&nbsp;<span class="ident" id="5185933">id</span>&nbsp;<span class="op" id="5185936">:=</span>&nbsp;<span class="ident" id="5185939">decodeCSS</span><span class="op" id="5185948">(</span><span class="op" id="5185949">[</span><span class="op" id="5185950">]</span><span class="builtintype" id="5185951">byte</span><span class="op" id="5185955">(</span><span class="ident" id="5185956">s</span><span class="op" id="5185957">)</span><span class="op" id="5185958">)</span><span class="op" id="5185959">,</span>&nbsp;<span class="builtinfunc" id="5185961">make</span><span class="op" id="5185965">(</span><span class="op" id="5185966">[</span><span class="op" id="5185967">]</span><span class="builtintype" id="5185968">byte</span><span class="op" id="5185972">,</span>&nbsp;<span class="num" id="5185974">0</span><span class="op" id="5185975">,</span>&nbsp;<span class="num" id="5185977">64</span><span class="op" id="5185979">)</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185983">//&nbsp;CSS3&nbsp;error&nbsp;handling&nbsp;is&nbsp;specified&nbsp;as&nbsp;honoring&nbsp;string&nbsp;boundaries&nbsp;per</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186054">//&nbsp;http://www.w3.org/TR/css3-syntax/#error-handling&nbsp;:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186109">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malformed&nbsp;declarations.&nbsp;User&nbsp;agents&nbsp;must&nbsp;handle&nbsp;unexpected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186176">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tokens&nbsp;encountered&nbsp;while&nbsp;parsing&nbsp;a&nbsp;declaration&nbsp;by&nbsp;reading&nbsp;until</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186248">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;declaration,&nbsp;while&nbsp;observing&nbsp;the&nbsp;rules&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186314">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching&nbsp;pairs&nbsp;of&nbsp;(),&nbsp;[],&nbsp;{},&nbsp;&#34;&#34;,&nbsp;and&nbsp;&#39;&#39;,&nbsp;and&nbsp;correctly&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186387">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapes.&nbsp;For&nbsp;example,&nbsp;a&nbsp;malformed&nbsp;declaration&nbsp;may&nbsp;be&nbsp;missing&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186458">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property,&nbsp;colon&nbsp;(:)&nbsp;or&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186496">//&nbsp;So&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;values&nbsp;do&nbsp;not&nbsp;have&nbsp;mismatched&nbsp;bracket</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186567">//&nbsp;or&nbsp;quote&nbsp;characters&nbsp;to&nbsp;prevent&nbsp;the&nbsp;browser&nbsp;from&nbsp;restarting&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186638">//&nbsp;inside&nbsp;a&nbsp;string&nbsp;that&nbsp;might&nbsp;embed&nbsp;JavaScript&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186694">for</span>&nbsp;<span class="ident" id="5186698">i</span><span class="op" id="5186699">,</span>&nbsp;<span class="ident" id="5186701">c</span>&nbsp;<span class="op" id="5186703">:=</span>&nbsp;<span class="keyword" id="5186706">range</span>&nbsp;<span class="ident" id="5186712">b</span>&nbsp;<span class="op" id="5186714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186718">switch</span>&nbsp;<span class="ident" id="5186725">c</span>&nbsp;<span class="op" id="5186727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186731">case</span>&nbsp;<span class="num" id="5186736">0</span><span class="op" id="5186737">,</span>&nbsp;<span class="string" id="5186739">&#39;&#34;&#39;</span><span class="op" id="5186742">,</span>&nbsp;<span class="string" id="5186744">&#39;\&#39;&#39;</span><span class="op" id="5186748">,</span>&nbsp;<span class="string" id="5186750">&#39;(&#39;</span><span class="op" id="5186753">,</span>&nbsp;<span class="string" id="5186755">&#39;)&#39;</span><span class="op" id="5186758">,</span>&nbsp;<span class="string" id="5186760">&#39;/&#39;</span><span class="op" id="5186763">,</span>&nbsp;<span class="string" id="5186765">&#39;;&#39;</span><span class="op" id="5186768">,</span>&nbsp;<span class="string" id="5186770">&#39;@&#39;</span><span class="op" id="5186773">,</span>&nbsp;<span class="string" id="5186775">&#39;[&#39;</span><span class="op" id="5186778">,</span>&nbsp;<span class="string" id="5186780">&#39;\\&#39;</span><span class="op" id="5186784">,</span>&nbsp;<span class="string" id="5186786">&#39;]&#39;</span><span class="op" id="5186789">,</span>&nbsp;<span class="string" id="5186791">&#39;`&#39;</span><span class="op" id="5186794">,</span>&nbsp;<span class="string" id="5186796">&#39;{&#39;</span><span class="op" id="5186799">,</span>&nbsp;<span class="string" id="5186801">&#39;}&#39;</span><span class="op" id="5186804">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186809">return</span>&nbsp;<span class="ident" id="5186816">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186833">case</span>&nbsp;<span class="string" id="5186838">&#39;-&#39;</span><span class="op" id="5186841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186846">//&nbsp;Disallow&nbsp;&lt;!--&nbsp;or&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186874">//&nbsp;--&nbsp;should&nbsp;not&nbsp;appear&nbsp;in&nbsp;valid&nbsp;identifiers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186923">if</span>&nbsp;<span class="ident" id="5186926">i</span>&nbsp;<span class="op" id="5186928">!=</span>&nbsp;<span class="num" id="5186931">0</span>&nbsp;<span class="op" id="5186933">&amp;&amp;</span>&nbsp;<span class="ident" id="5186936">b</span><span class="op" id="5186937">[</span><span class="ident" id="5186938">i</span><span class="op" id="5186939">-</span><span class="num" id="5186940">1</span><span class="op" id="5186941">]</span>&nbsp;<span class="op" id="5186943">==</span>&nbsp;<span class="string" id="5186946">&#39;-&#39;</span>&nbsp;<span class="op" id="5186950">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186956">return</span>&nbsp;<span class="ident" id="5186963">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186985">default</span><span class="op" id="5186992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186997">if</span>&nbsp;<span class="ident" id="5187000">c</span>&nbsp;<span class="op" id="5187002">&lt;</span>&nbsp;<span class="num" id="5187004">0x80</span>&nbsp;<span class="op" id="5187009">&amp;&amp;</span>&nbsp;<span class="ident" id="5187012">isCSSNmchar</span><span class="op" id="5187023">(</span><span class="builtintype" id="5187024">rune</span><span class="op" id="5187028">(</span><span class="ident" id="5187029">c</span><span class="op" id="5187030">)</span><span class="op" id="5187031">)</span>&nbsp;<span class="op" id="5187033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187039">id</span>&nbsp;<span class="op" id="5187042">=</span>&nbsp;<span class="builtinfunc" id="5187044">append</span><span class="op" id="5187050">(</span><span class="ident" id="5187051">id</span><span class="op" id="5187053">,</span>&nbsp;<span class="ident" id="5187055">c</span><span class="op" id="5187056">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187071">id</span>&nbsp;<span class="op" id="5187074">=</span>&nbsp;<span class="ident" id="5187076">bytes</span><span class="op" id="5187081">.</span><span class="ident" id="5187082">ToLower</span><span class="op" id="5187089">(</span><span class="ident" id="5187090">id</span><span class="op" id="5187092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187095">if</span>&nbsp;<span class="ident" id="5187098">bytes</span><span class="op" id="5187103">.</span><span class="ident" id="5187104">Index</span><span class="op" id="5187109">(</span><span class="ident" id="5187110">id</span><span class="op" id="5187112">,</span>&nbsp;<span class="ident" id="5187114">expressionBytes</span><span class="op" id="5187129">)</span>&nbsp;<span class="op" id="5187131">!=</span>&nbsp;<span class="op" id="5187134">-</span><span class="num" id="5187135">1</span>&nbsp;<span class="op" id="5187137">||</span>&nbsp;<span class="ident" id="5187140">bytes</span><span class="op" id="5187145">.</span><span class="ident" id="5187146">Index</span><span class="op" id="5187151">(</span><span class="ident" id="5187152">id</span><span class="op" id="5187154">,</span>&nbsp;<span class="ident" id="5187156">mozBindingBytes</span><span class="op" id="5187171">)</span>&nbsp;<span class="op" id="5187173">!=</span>&nbsp;<span class="op" id="5187176">-</span><span class="num" id="5187177">1</span>&nbsp;<span class="op" id="5187179">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187183">return</span>&nbsp;<span class="ident" id="5187190">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187209">return</span>&nbsp;<span class="builtintype" id="5187216">string</span><span class="op" id="5187222">(</span><span class="ident" id="5187223">b</span><span class="op" id="5187224">)</span><br>
<span class="lineno"></span><span class="op" id="5187226">}</span>
</div>
</body>
</html>
