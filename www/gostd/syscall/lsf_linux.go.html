<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html" class="current">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2532408">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2532464">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2532518">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2532569">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2532593">package</span>&nbsp;<span class="ident" id="2532601">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2532610">import</span>&nbsp;<span class="op" id="2532617">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2532620">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2532629">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2532632">func</span>&nbsp;<span class="ident" id="2532637">LsfStmt</span><span class="op" id="2532644">(</span><span class="ident" id="2532645">code</span><span class="op" id="2532649">,</span>&nbsp;<span class="ident" id="2532651">k</span>&nbsp;<span class="builtintype" id="2532653">int</span><span class="op" id="2532656">)</span>&nbsp;<span class="op" id="2532658">*</span><span class="ident" id="2532659">SockFilter</span>&nbsp;<span class="op" id="2532670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2532673">return</span>&nbsp;<span class="op" id="2532680">&amp;</span><span class="ident" id="2532681">SockFilter</span><span class="op" id="2532691">{</span><span class="ident" id="2532692">Code</span><span class="op" id="2532696">:</span>&nbsp;<span class="builtintype" id="2532698">uint16</span><span class="op" id="2532704">(</span><span class="ident" id="2532705">code</span><span class="op" id="2532709">)</span><span class="op" id="2532710">,</span>&nbsp;<span class="ident" id="2532712">K</span><span class="op" id="2532713">:</span>&nbsp;<span class="builtintype" id="2532715">uint32</span><span class="op" id="2532721">(</span><span class="ident" id="2532722">k</span><span class="op" id="2532723">)</span><span class="op" id="2532724">}</span><br>
<span class="lineno">15</span><span class="op" id="2532726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2532729">func</span>&nbsp;<span class="ident" id="2532734">LsfJump</span><span class="op" id="2532741">(</span><span class="ident" id="2532742">code</span><span class="op" id="2532746">,</span>&nbsp;<span class="ident" id="2532748">k</span><span class="op" id="2532749">,</span>&nbsp;<span class="ident" id="2532751">jt</span><span class="op" id="2532753">,</span>&nbsp;<span class="ident" id="2532755">jf</span>&nbsp;<span class="builtintype" id="2532758">int</span><span class="op" id="2532761">)</span>&nbsp;<span class="op" id="2532763">*</span><span class="ident" id="2532764">SockFilter</span>&nbsp;<span class="op" id="2532775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2532778">return</span>&nbsp;<span class="op" id="2532785">&amp;</span><span class="ident" id="2532786">SockFilter</span><span class="op" id="2532796">{</span><span class="ident" id="2532797">Code</span><span class="op" id="2532801">:</span>&nbsp;<span class="builtintype" id="2532803">uint16</span><span class="op" id="2532809">(</span><span class="ident" id="2532810">code</span><span class="op" id="2532814">)</span><span class="op" id="2532815">,</span>&nbsp;<span class="ident" id="2532817">Jt</span><span class="op" id="2532819">:</span>&nbsp;<span class="builtintype" id="2532821">uint8</span><span class="op" id="2532826">(</span><span class="ident" id="2532827">jt</span><span class="op" id="2532829">)</span><span class="op" id="2532830">,</span>&nbsp;<span class="ident" id="2532832">Jf</span><span class="op" id="2532834">:</span>&nbsp;<span class="builtintype" id="2532836">uint8</span><span class="op" id="2532841">(</span><span class="ident" id="2532842">jf</span><span class="op" id="2532844">)</span><span class="op" id="2532845">,</span>&nbsp;<span class="ident" id="2532847">K</span><span class="op" id="2532848">:</span>&nbsp;<span class="builtintype" id="2532850">uint32</span><span class="op" id="2532856">(</span><span class="ident" id="2532857">k</span><span class="op" id="2532858">)</span><span class="op" id="2532859">}</span><br>
<span class="lineno"></span><span class="op" id="2532861">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2532864">func</span>&nbsp;<span class="ident" id="2532869">LsfSocket</span><span class="op" id="2532878">(</span><span class="ident" id="2532879">ifindex</span><span class="op" id="2532886">,</span>&nbsp;<span class="ident" id="2532888">proto</span>&nbsp;<span class="builtintype" id="2532894">int</span><span class="op" id="2532897">)</span>&nbsp;<span class="op" id="2532899">(</span><span class="builtintype" id="2532900">int</span><span class="op" id="2532903">,</span>&nbsp;<span class="builtintype" id="2532905">error</span><span class="op" id="2532910">)</span>&nbsp;<span class="op" id="2532912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2532915">var</span>&nbsp;<span class="ident" id="2532919">lsall</span>&nbsp;<span class="ident" id="2532925">SockaddrLinklayer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2532944">s</span><span class="op" id="2532945">,</span>&nbsp;<span class="ident" id="2532947">e</span>&nbsp;<span class="op" id="2532949">:=</span>&nbsp;<span class="ident" id="2532952">Socket</span><span class="op" id="2532958">(</span><span class="ident" id="2532959">AF_PACKET</span><span class="op" id="2532968">,</span>&nbsp;<span class="ident" id="2532970">SOCK_RAW</span><span class="op" id="2532978">,</span>&nbsp;<span class="ident" id="2532980">proto</span><span class="op" id="2532985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2532988">if</span>&nbsp;<span class="ident" id="2532991">e</span>&nbsp;<span class="op" id="2532993">!=</span>&nbsp;<span class="builtintype" id="2532996">nil</span>&nbsp;<span class="op" id="2533000">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533004">return</span>&nbsp;<span class="num" id="2533011">0</span><span class="op" id="2533012">,</span>&nbsp;<span class="ident" id="2533014">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2533017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533020">p</span>&nbsp;<span class="op" id="2533022">:=</span>&nbsp;<span class="op" id="2533025">(</span><span class="op" id="2533026">*</span><span class="op" id="2533027">[</span><span class="num" id="2533028">2</span><span class="op" id="2533029">]</span><span class="builtintype" id="2533030">byte</span><span class="op" id="2533034">)</span><span class="op" id="2533035">(</span><span class="ident" id="2533036">unsafe</span><span class="op" id="2533042">.</span><span class="ident" id="2533043">Pointer</span><span class="op" id="2533050">(</span><span class="op" id="2533051">&amp;</span><span class="ident" id="2533052">lsall</span><span class="op" id="2533057">.</span><span class="ident" id="2533058">Protocol</span><span class="op" id="2533066">)</span><span class="op" id="2533067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533070">p</span><span class="op" id="2533071">[</span><span class="num" id="2533072">0</span><span class="op" id="2533073">]</span>&nbsp;<span class="op" id="2533075">=</span>&nbsp;<span class="builtintype" id="2533077">byte</span><span class="op" id="2533081">(</span><span class="ident" id="2533082">proto</span>&nbsp;<span class="op" id="2533088">&gt;&gt;</span>&nbsp;<span class="num" id="2533091">8</span><span class="op" id="2533092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533095">p</span><span class="op" id="2533096">[</span><span class="num" id="2533097">1</span><span class="op" id="2533098">]</span>&nbsp;<span class="op" id="2533100">=</span>&nbsp;<span class="builtintype" id="2533102">byte</span><span class="op" id="2533106">(</span><span class="ident" id="2533107">proto</span><span class="op" id="2533112">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533115">lsall</span><span class="op" id="2533120">.</span><span class="ident" id="2533121">Ifindex</span>&nbsp;<span class="op" id="2533129">=</span>&nbsp;<span class="ident" id="2533131">ifindex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533140">e</span>&nbsp;<span class="op" id="2533142">=</span>&nbsp;<span class="ident" id="2533144">Bind</span><span class="op" id="2533148">(</span><span class="ident" id="2533149">s</span><span class="op" id="2533150">,</span>&nbsp;<span class="op" id="2533152">&amp;</span><span class="ident" id="2533153">lsall</span><span class="op" id="2533158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533161">if</span>&nbsp;<span class="ident" id="2533164">e</span>&nbsp;<span class="op" id="2533166">!=</span>&nbsp;<span class="builtintype" id="2533169">nil</span>&nbsp;<span class="op" id="2533173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533177">Close</span><span class="op" id="2533182">(</span><span class="ident" id="2533183">s</span><span class="op" id="2533184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533188">return</span>&nbsp;<span class="num" id="2533195">0</span><span class="op" id="2533196">,</span>&nbsp;<span class="ident" id="2533198">e</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2533201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533204">return</span>&nbsp;<span class="ident" id="2533211">s</span><span class="op" id="2533212">,</span>&nbsp;<span class="builtintype" id="2533214">nil</span><br>
<span class="lineno"></span><span class="op" id="2533218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2533221">type</span>&nbsp;<span class="ident" id="2533226">iflags</span>&nbsp;<span class="keyword" id="2533233">struct</span>&nbsp;<span class="op" id="2533240">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533243">name</span>&nbsp;&nbsp;<span class="op" id="2533249">[</span><span class="ident" id="2533250">IFNAMSIZ</span><span class="op" id="2533258">]</span><span class="builtintype" id="2533259">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533265">flags</span>&nbsp;<span class="builtintype" id="2533271">uint16</span><br>
<span class="lineno"></span><span class="op" id="2533278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2533281">func</span>&nbsp;<span class="ident" id="2533286">SetLsfPromisc</span><span class="op" id="2533299">(</span><span class="ident" id="2533300">name</span>&nbsp;<span class="builtintype" id="2533305">string</span><span class="op" id="2533311">,</span>&nbsp;<span class="ident" id="2533313">m</span>&nbsp;<span class="builtintype" id="2533315">bool</span><span class="op" id="2533319">)</span>&nbsp;<span class="builtintype" id="2533321">error</span>&nbsp;<span class="op" id="2533327">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533330">s</span><span class="op" id="2533331">,</span>&nbsp;<span class="ident" id="2533333">e</span>&nbsp;<span class="op" id="2533335">:=</span>&nbsp;<span class="ident" id="2533338">Socket</span><span class="op" id="2533344">(</span><span class="ident" id="2533345">AF_INET</span><span class="op" id="2533352">,</span>&nbsp;<span class="ident" id="2533354">SOCK_DGRAM</span><span class="op" id="2533364">,</span>&nbsp;<span class="num" id="2533366">0</span><span class="op" id="2533367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533370">if</span>&nbsp;<span class="ident" id="2533373">e</span>&nbsp;<span class="op" id="2533375">!=</span>&nbsp;<span class="builtintype" id="2533378">nil</span>&nbsp;<span class="op" id="2533382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533386">return</span>&nbsp;<span class="ident" id="2533393">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2533396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533399">defer</span>&nbsp;<span class="ident" id="2533405">Close</span><span class="op" id="2533410">(</span><span class="ident" id="2533411">s</span><span class="op" id="2533412">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533415">var</span>&nbsp;<span class="ident" id="2533419">ifl</span>&nbsp;<span class="ident" id="2533423">iflags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2533431">copy</span><span class="op" id="2533435">(</span><span class="ident" id="2533436">ifl</span><span class="op" id="2533439">.</span><span class="ident" id="2533440">name</span><span class="op" id="2533444">[</span><span class="op" id="2533445">:</span><span class="op" id="2533446">]</span><span class="op" id="2533447">,</span>&nbsp;<span class="op" id="2533449">[</span><span class="op" id="2533450">]</span><span class="builtintype" id="2533451">byte</span><span class="op" id="2533455">(</span><span class="ident" id="2533456">name</span><span class="op" id="2533460">)</span><span class="op" id="2533461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533464">_</span><span class="op" id="2533465">,</span>&nbsp;<span class="ident" id="2533467">_</span><span class="op" id="2533468">,</span>&nbsp;<span class="ident" id="2533470">ep</span>&nbsp;<span class="op" id="2533473">:=</span>&nbsp;<span class="ident" id="2533476">Syscall</span><span class="op" id="2533483">(</span><span class="ident" id="2533484">SYS_IOCTL</span><span class="op" id="2533493">,</span>&nbsp;<span class="builtintype" id="2533495">uintptr</span><span class="op" id="2533502">(</span><span class="ident" id="2533503">s</span><span class="op" id="2533504">)</span><span class="op" id="2533505">,</span>&nbsp;<span class="ident" id="2533507">SIOCGIFFLAGS</span><span class="op" id="2533519">,</span>&nbsp;<span class="builtintype" id="2533521">uintptr</span><span class="op" id="2533528">(</span><span class="ident" id="2533529">unsafe</span><span class="op" id="2533535">.</span><span class="ident" id="2533536">Pointer</span><span class="op" id="2533543">(</span><span class="op" id="2533544">&amp;</span><span class="ident" id="2533545">ifl</span><span class="op" id="2533548">)</span><span class="op" id="2533549">)</span><span class="op" id="2533550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533553">if</span>&nbsp;<span class="ident" id="2533556">ep</span>&nbsp;<span class="op" id="2533559">!=</span>&nbsp;<span class="num" id="2533562">0</span>&nbsp;<span class="op" id="2533564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533568">return</span>&nbsp;<span class="ident" id="2533575">Errno</span><span class="op" id="2533580">(</span><span class="ident" id="2533581">ep</span><span class="op" id="2533583">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2533586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533589">if</span>&nbsp;<span class="ident" id="2533592">m</span>&nbsp;<span class="op" id="2533594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533598">ifl</span><span class="op" id="2533601">.</span><span class="ident" id="2533602">flags</span>&nbsp;<span class="op" id="2533608">|=</span>&nbsp;<span class="builtintype" id="2533611">uint16</span><span class="op" id="2533617">(</span><span class="ident" id="2533618">IFF_PROMISC</span><span class="op" id="2533629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2533632">}</span>&nbsp;<span class="keyword" id="2533634">else</span>&nbsp;<span class="op" id="2533639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533643">ifl</span><span class="op" id="2533646">.</span><span class="ident" id="2533647">flags</span>&nbsp;<span class="op" id="2533653">&amp;=</span>&nbsp;<span class="op" id="2533656">^</span><span class="builtintype" id="2533657">uint16</span><span class="op" id="2533663">(</span><span class="ident" id="2533664">IFF_PROMISC</span><span class="op" id="2533675">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2533678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533681">_</span><span class="op" id="2533682">,</span>&nbsp;<span class="ident" id="2533684">_</span><span class="op" id="2533685">,</span>&nbsp;<span class="ident" id="2533687">ep</span>&nbsp;<span class="op" id="2533690">=</span>&nbsp;<span class="ident" id="2533692">Syscall</span><span class="op" id="2533699">(</span><span class="ident" id="2533700">SYS_IOCTL</span><span class="op" id="2533709">,</span>&nbsp;<span class="builtintype" id="2533711">uintptr</span><span class="op" id="2533718">(</span><span class="ident" id="2533719">s</span><span class="op" id="2533720">)</span><span class="op" id="2533721">,</span>&nbsp;<span class="ident" id="2533723">SIOCSIFFLAGS</span><span class="op" id="2533735">,</span>&nbsp;<span class="builtintype" id="2533737">uintptr</span><span class="op" id="2533744">(</span><span class="ident" id="2533745">unsafe</span><span class="op" id="2533751">.</span><span class="ident" id="2533752">Pointer</span><span class="op" id="2533759">(</span><span class="op" id="2533760">&amp;</span><span class="ident" id="2533761">ifl</span><span class="op" id="2533764">)</span><span class="op" id="2533765">)</span><span class="op" id="2533766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533769">if</span>&nbsp;<span class="ident" id="2533772">ep</span>&nbsp;<span class="op" id="2533775">!=</span>&nbsp;<span class="num" id="2533778">0</span>&nbsp;<span class="op" id="2533780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533784">return</span>&nbsp;<span class="ident" id="2533791">Errno</span><span class="op" id="2533796">(</span><span class="ident" id="2533797">ep</span><span class="op" id="2533799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2533802">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533805">return</span>&nbsp;<span class="builtintype" id="2533812">nil</span><br>
<span class="lineno"></span><span class="op" id="2533816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2533819">func</span>&nbsp;<span class="ident" id="2533824">AttachLsf</span><span class="op" id="2533833">(</span><span class="ident" id="2533834">fd</span>&nbsp;<span class="builtintype" id="2533837">int</span><span class="op" id="2533840">,</span>&nbsp;<span class="ident" id="2533842">i</span>&nbsp;<span class="op" id="2533844">[</span><span class="op" id="2533845">]</span><span class="ident" id="2533846">SockFilter</span><span class="op" id="2533856">)</span>&nbsp;<span class="builtintype" id="2533858">error</span>&nbsp;<span class="op" id="2533864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533867">var</span>&nbsp;<span class="ident" id="2533871">p</span>&nbsp;<span class="ident" id="2533873">SockFprog</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533884">p</span><span class="op" id="2533885">.</span><span class="ident" id="2533886">Len</span>&nbsp;<span class="op" id="2533890">=</span>&nbsp;<span class="builtintype" id="2533892">uint16</span><span class="op" id="2533898">(</span><span class="builtinfunc" id="2533899">len</span><span class="op" id="2533902">(</span><span class="ident" id="2533903">i</span><span class="op" id="2533904">)</span><span class="op" id="2533905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2533908">p</span><span class="op" id="2533909">.</span><span class="ident" id="2533910">Filter</span>&nbsp;<span class="op" id="2533917">=</span>&nbsp;<span class="op" id="2533919">(</span><span class="op" id="2533920">*</span><span class="ident" id="2533921">SockFilter</span><span class="op" id="2533931">)</span><span class="op" id="2533932">(</span><span class="ident" id="2533933">unsafe</span><span class="op" id="2533939">.</span><span class="ident" id="2533940">Pointer</span><span class="op" id="2533947">(</span><span class="op" id="2533948">&amp;</span><span class="ident" id="2533949">i</span><span class="op" id="2533950">[</span><span class="num" id="2533951">0</span><span class="op" id="2533952">]</span><span class="op" id="2533953">)</span><span class="op" id="2533954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2533957">return</span>&nbsp;<span class="ident" id="2533964">setsockopt</span><span class="op" id="2533974">(</span><span class="ident" id="2533975">fd</span><span class="op" id="2533977">,</span>&nbsp;<span class="ident" id="2533979">SOL_SOCKET</span><span class="op" id="2533989">,</span>&nbsp;<span class="ident" id="2533991">SO_ATTACH_FILTER</span><span class="op" id="2534007">,</span>&nbsp;<span class="ident" id="2534009">unsafe</span><span class="op" id="2534015">.</span><span class="ident" id="2534016">Pointer</span><span class="op" id="2534023">(</span><span class="op" id="2534024">&amp;</span><span class="ident" id="2534025">p</span><span class="op" id="2534026">)</span><span class="op" id="2534027">,</span>&nbsp;<span class="ident" id="2534029">unsafe</span><span class="op" id="2534035">.</span><span class="ident" id="2534036">Sizeof</span><span class="op" id="2534042">(</span><span class="ident" id="2534043">p</span><span class="op" id="2534044">)</span><span class="op" id="2534045">)</span><br>
<span class="lineno"></span><span class="op" id="2534047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="2534050">func</span>&nbsp;<span class="ident" id="2534055">DetachLsf</span><span class="op" id="2534064">(</span><span class="ident" id="2534065">fd</span>&nbsp;<span class="builtintype" id="2534068">int</span><span class="op" id="2534071">)</span>&nbsp;<span class="builtintype" id="2534073">error</span>&nbsp;<span class="op" id="2534079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2534082">var</span>&nbsp;<span class="ident" id="2534086">dummy</span>&nbsp;<span class="builtintype" id="2534092">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2534097">return</span>&nbsp;<span class="ident" id="2534104">setsockopt</span><span class="op" id="2534114">(</span><span class="ident" id="2534115">fd</span><span class="op" id="2534117">,</span>&nbsp;<span class="ident" id="2534119">SOL_SOCKET</span><span class="op" id="2534129">,</span>&nbsp;<span class="ident" id="2534131">SO_DETACH_FILTER</span><span class="op" id="2534147">,</span>&nbsp;<span class="ident" id="2534149">unsafe</span><span class="op" id="2534155">.</span><span class="ident" id="2534156">Pointer</span><span class="op" id="2534163">(</span><span class="op" id="2534164">&amp;</span><span class="ident" id="2534165">dummy</span><span class="op" id="2534170">)</span><span class="op" id="2534171">,</span>&nbsp;<span class="ident" id="2534173">unsafe</span><span class="op" id="2534179">.</span><span class="ident" id="2534180">Sizeof</span><span class="op" id="2534186">(</span><span class="ident" id="2534187">dummy</span><span class="op" id="2534192">)</span><span class="op" id="2534193">)</span><br>
<span class="lineno"></span><span class="op" id="2534195">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
