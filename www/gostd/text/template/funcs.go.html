<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3143605">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3143660">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3143714">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3143765">package</span>&nbsp;<span class="ident" id="3143773">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3143783">import</span>&nbsp;<span class="op" id="3143790">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3143793">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3143802">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3143812">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3143819">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3143825">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3143836">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3143847">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3143858">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3143869">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3143884">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3143887">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to&nbsp;functions.</span><br>
<span class="lineno">20</span><span class="comment" id="3143967">//&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two&nbsp;return&nbsp;values&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3144048">//&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the&nbsp;second&nbsp;(error)</span><br>
<span class="lineno"></span><span class="comment" id="3144120">//&nbsp;return&nbsp;value&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution&nbsp;terminates&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3144200">//&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3144231">type</span>&nbsp;<span class="ident" id="3144236">FuncMap</span>&nbsp;<span class="keyword" id="3144244">map</span><span class="op" id="3144247">[</span><span class="builtintype" id="3144248">string</span><span class="op" id="3144254">]</span><span class="keyword" id="3144255">interface</span><span class="op" id="3144264">{</span><span class="op" id="3144265">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3144268">var</span>&nbsp;<span class="ident" id="3144272">builtins</span>&nbsp;<span class="op" id="3144281">=</span>&nbsp;<span class="ident" id="3144283">FuncMap</span><span class="op" id="3144290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144293">&#34;and&#34;</span><span class="op" id="3144298">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144305">and</span><span class="op" id="3144308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144311">&#34;call&#34;</span><span class="op" id="3144317">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144323">call</span><span class="op" id="3144327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144330">&#34;html&#34;</span><span class="op" id="3144336">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144342">HTMLEscaper</span><span class="op" id="3144353">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144356">&#34;index&#34;</span><span class="op" id="3144363">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144368">index</span><span class="op" id="3144373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144376">&#34;js&#34;</span><span class="op" id="3144380">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144388">JSEscaper</span><span class="op" id="3144397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144400">&#34;len&#34;</span><span class="op" id="3144405">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144412">length</span><span class="op" id="3144418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144421">&#34;not&#34;</span><span class="op" id="3144426">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144433">not</span><span class="op" id="3144436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144439">&#34;or&#34;</span><span class="op" id="3144443">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144451">or</span><span class="op" id="3144453">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144456">&#34;print&#34;</span><span class="op" id="3144463">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144468">fmt</span><span class="op" id="3144471">.</span><span class="ident" id="3144472">Sprint</span><span class="op" id="3144478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144481">&#34;printf&#34;</span><span class="op" id="3144489">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3144493">fmt</span><span class="op" id="3144496">.</span><span class="ident" id="3144497">Sprintf</span><span class="op" id="3144504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144507">&#34;println&#34;</span><span class="op" id="3144516">:</span>&nbsp;&nbsp;<span class="ident" id="3144519">fmt</span><span class="op" id="3144522">.</span><span class="ident" id="3144523">Sprintln</span><span class="op" id="3144531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144534">&#34;urlquery&#34;</span><span class="op" id="3144544">:</span>&nbsp;<span class="ident" id="3144546">URLQueryEscaper</span><span class="op" id="3144561">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3144565">//&nbsp;Comparisons</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144581">&#34;eq&#34;</span><span class="op" id="3144585">:</span>&nbsp;<span class="ident" id="3144587">eq</span><span class="op" id="3144589">,</span>&nbsp;<span class="comment" id="3144591">//&nbsp;==</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144598">&#34;ge&#34;</span><span class="op" id="3144602">:</span>&nbsp;<span class="ident" id="3144604">ge</span><span class="op" id="3144606">,</span>&nbsp;<span class="comment" id="3144608">//&nbsp;&gt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144615">&#34;gt&#34;</span><span class="op" id="3144619">:</span>&nbsp;<span class="ident" id="3144621">gt</span><span class="op" id="3144623">,</span>&nbsp;<span class="comment" id="3144625">//&nbsp;&gt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144631">&#34;le&#34;</span><span class="op" id="3144635">:</span>&nbsp;<span class="ident" id="3144637">le</span><span class="op" id="3144639">,</span>&nbsp;<span class="comment" id="3144641">//&nbsp;&lt;=</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144648">&#34;lt&#34;</span><span class="op" id="3144652">:</span>&nbsp;<span class="ident" id="3144654">lt</span><span class="op" id="3144656">,</span>&nbsp;<span class="comment" id="3144658">//&nbsp;&lt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3144664">&#34;ne&#34;</span><span class="op" id="3144668">:</span>&nbsp;<span class="ident" id="3144670">ne</span><span class="op" id="3144672">,</span>&nbsp;<span class="comment" id="3144674">//&nbsp;!=</span><br>
<span class="lineno"></span><span class="op" id="3144680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3144683">var</span>&nbsp;<span class="ident" id="3144687">builtinFuncs</span>&nbsp;<span class="op" id="3144700">=</span>&nbsp;<span class="ident" id="3144702">createValueFuncs</span><span class="op" id="3144718">(</span><span class="ident" id="3144719">builtins</span><span class="op" id="3144727">)</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="3144730">//&nbsp;createValueFuncs&nbsp;turns&nbsp;a&nbsp;FuncMap&nbsp;into&nbsp;a&nbsp;map[string]reflect.Value</span><br>
<span class="lineno"></span><span class="keyword" id="3144798">func</span>&nbsp;<span class="ident" id="3144803">createValueFuncs</span><span class="op" id="3144819">(</span><span class="ident" id="3144820">funcMap</span>&nbsp;<span class="ident" id="3144828">FuncMap</span><span class="op" id="3144835">)</span>&nbsp;<span class="keyword" id="3144837">map</span><span class="op" id="3144840">[</span><span class="builtintype" id="3144841">string</span><span class="op" id="3144847">]</span><span class="ident" id="3144848">reflect</span><span class="op" id="3144855">.</span><span class="ident" id="3144856">Value</span>&nbsp;<span class="op" id="3144862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3144865">m</span>&nbsp;<span class="op" id="3144867">:=</span>&nbsp;<span class="builtinfunc" id="3144870">make</span><span class="op" id="3144874">(</span><span class="keyword" id="3144875">map</span><span class="op" id="3144878">[</span><span class="builtintype" id="3144879">string</span><span class="op" id="3144885">]</span><span class="ident" id="3144886">reflect</span><span class="op" id="3144893">.</span><span class="ident" id="3144894">Value</span><span class="op" id="3144899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3144902">addValueFuncs</span><span class="op" id="3144915">(</span><span class="ident" id="3144916">m</span><span class="op" id="3144917">,</span>&nbsp;<span class="ident" id="3144919">funcMap</span><span class="op" id="3144926">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3144929">return</span>&nbsp;<span class="ident" id="3144936">m</span><br>
<span class="lineno"></span><span class="op" id="3144938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3144941">//&nbsp;addValueFuncs&nbsp;adds&nbsp;to&nbsp;values&nbsp;the&nbsp;functions&nbsp;in&nbsp;funcs,&nbsp;converting&nbsp;them&nbsp;to&nbsp;reflect.Values.</span><br>
<span class="lineno"></span><span class="keyword" id="3145032">func</span>&nbsp;<span class="ident" id="3145037">addValueFuncs</span><span class="op" id="3145050">(</span><span class="ident" id="3145051">out</span>&nbsp;<span class="keyword" id="3145055">map</span><span class="op" id="3145058">[</span><span class="builtintype" id="3145059">string</span><span class="op" id="3145065">]</span><span class="ident" id="3145066">reflect</span><span class="op" id="3145073">.</span><span class="ident" id="3145074">Value</span><span class="op" id="3145079">,</span>&nbsp;<span class="ident" id="3145081">in</span>&nbsp;<span class="ident" id="3145084">FuncMap</span><span class="op" id="3145091">)</span>&nbsp;<span class="op" id="3145093">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3145096">for</span>&nbsp;<span class="ident" id="3145100">name</span><span class="op" id="3145104">,</span>&nbsp;<span class="ident" id="3145106">fn</span>&nbsp;<span class="op" id="3145109">:=</span>&nbsp;<span class="keyword" id="3145112">range</span>&nbsp;<span class="ident" id="3145118">in</span>&nbsp;<span class="op" id="3145121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145125">v</span>&nbsp;<span class="op" id="3145127">:=</span>&nbsp;<span class="ident" id="3145130">reflect</span><span class="op" id="3145137">.</span><span class="ident" id="3145138">ValueOf</span><span class="op" id="3145145">(</span><span class="ident" id="3145146">fn</span><span class="op" id="3145148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3145152">if</span>&nbsp;<span class="ident" id="3145155">v</span><span class="op" id="3145156">.</span><span class="ident" id="3145157">Kind</span><span class="op" id="3145161">(</span><span class="op" id="3145162">)</span>&nbsp;<span class="op" id="3145164">!=</span>&nbsp;<span class="ident" id="3145167">reflect</span><span class="op" id="3145174">.</span><span class="ident" id="3145175">Func</span>&nbsp;<span class="op" id="3145180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3145185">panic</span><span class="op" id="3145190">(</span><span class="string" id="3145191">&#34;value&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="3145204">+</span>&nbsp;<span class="ident" id="3145206">name</span>&nbsp;<span class="op" id="3145211">+</span>&nbsp;<span class="string" id="3145213">&#34;&nbsp;not&nbsp;a&nbsp;function&#34;</span><span class="op" id="3145230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3145234">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3145238">if</span>&nbsp;<span class="op" id="3145241">!</span><span class="ident" id="3145242">goodFunc</span><span class="op" id="3145250">(</span><span class="ident" id="3145251">v</span><span class="op" id="3145252">.</span><span class="ident" id="3145253">Type</span><span class="op" id="3145257">(</span><span class="op" id="3145258">)</span><span class="op" id="3145259">)</span>&nbsp;<span class="op" id="3145261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3145266">panic</span><span class="op" id="3145271">(</span><span class="ident" id="3145272">fmt</span><span class="op" id="3145275">.</span><span class="ident" id="3145276">Errorf</span><span class="op" id="3145282">(</span><span class="string" id="3145283">&#34;can&#39;t&nbsp;install&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="3145333">,</span>&nbsp;<span class="ident" id="3145335">name</span><span class="op" id="3145339">,</span>&nbsp;<span class="ident" id="3145341">v</span><span class="op" id="3145342">.</span><span class="ident" id="3145343">Type</span><span class="op" id="3145347">(</span><span class="op" id="3145348">)</span><span class="op" id="3145349">.</span><span class="ident" id="3145350">NumOut</span><span class="op" id="3145356">(</span><span class="op" id="3145357">)</span><span class="op" id="3145358">)</span><span class="op" id="3145359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3145363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145367">out</span><span class="op" id="3145370">[</span><span class="ident" id="3145371">name</span><span class="op" id="3145375">]</span>&nbsp;<span class="op" id="3145377">=</span>&nbsp;<span class="ident" id="3145379">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3145382">}</span><br>
<span class="lineno">70</span><span class="op" id="3145384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3145387">//&nbsp;addFuncs&nbsp;adds&nbsp;to&nbsp;values&nbsp;the&nbsp;functions&nbsp;in&nbsp;funcs.&nbsp;It&nbsp;does&nbsp;no&nbsp;checking&nbsp;of&nbsp;the&nbsp;input&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="3145473">//&nbsp;call&nbsp;addValueFuncs&nbsp;first.</span><br>
<span class="lineno"></span><span class="keyword" id="3145502">func</span>&nbsp;<span class="ident" id="3145507">addFuncs</span><span class="op" id="3145515">(</span><span class="ident" id="3145516">out</span><span class="op" id="3145519">,</span>&nbsp;<span class="ident" id="3145521">in</span>&nbsp;<span class="ident" id="3145524">FuncMap</span><span class="op" id="3145531">)</span>&nbsp;<span class="op" id="3145533">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3145536">for</span>&nbsp;<span class="ident" id="3145540">name</span><span class="op" id="3145544">,</span>&nbsp;<span class="ident" id="3145546">fn</span>&nbsp;<span class="op" id="3145549">:=</span>&nbsp;<span class="keyword" id="3145552">range</span>&nbsp;<span class="ident" id="3145558">in</span>&nbsp;<span class="op" id="3145561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145565">out</span><span class="op" id="3145568">[</span><span class="ident" id="3145569">name</span><span class="op" id="3145573">]</span>&nbsp;<span class="op" id="3145575">=</span>&nbsp;<span class="ident" id="3145577">fn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3145581">}</span><br>
<span class="lineno"></span><span class="op" id="3145583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3145586">//&nbsp;goodFunc&nbsp;checks&nbsp;that&nbsp;the&nbsp;function&nbsp;or&nbsp;method&nbsp;has&nbsp;the&nbsp;right&nbsp;result&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="3145665">func</span>&nbsp;<span class="ident" id="3145670">goodFunc</span><span class="op" id="3145678">(</span><span class="ident" id="3145679">typ</span>&nbsp;<span class="ident" id="3145683">reflect</span><span class="op" id="3145690">.</span><span class="ident" id="3145691">Type</span><span class="op" id="3145695">)</span>&nbsp;<span class="builtintype" id="3145697">bool</span>&nbsp;<span class="op" id="3145702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3145705">//&nbsp;We&nbsp;allow&nbsp;functions&nbsp;with&nbsp;1&nbsp;result&nbsp;or&nbsp;2&nbsp;results&nbsp;where&nbsp;the&nbsp;second&nbsp;is&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3145785">switch</span>&nbsp;<span class="op" id="3145792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3145795">case</span>&nbsp;<span class="ident" id="3145800">typ</span><span class="op" id="3145803">.</span><span class="ident" id="3145804">NumOut</span><span class="op" id="3145810">(</span><span class="op" id="3145811">)</span>&nbsp;<span class="op" id="3145813">==</span>&nbsp;<span class="num" id="3145816">1</span><span class="op" id="3145817">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3145821">return</span>&nbsp;<span class="builtintype" id="3145828">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3145834">case</span>&nbsp;<span class="ident" id="3145839">typ</span><span class="op" id="3145842">.</span><span class="ident" id="3145843">NumOut</span><span class="op" id="3145849">(</span><span class="op" id="3145850">)</span>&nbsp;<span class="op" id="3145852">==</span>&nbsp;<span class="num" id="3145855">2</span>&nbsp;<span class="op" id="3145857">&amp;&amp;</span>&nbsp;<span class="ident" id="3145860">typ</span><span class="op" id="3145863">.</span><span class="ident" id="3145864">Out</span><span class="op" id="3145867">(</span><span class="num" id="3145868">1</span><span class="op" id="3145869">)</span>&nbsp;<span class="op" id="3145871">==</span>&nbsp;<span class="ident" id="3145874">errorType</span><span class="op" id="3145883">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3145887">return</span>&nbsp;<span class="builtintype" id="3145894">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3145900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3145903">return</span>&nbsp;<span class="builtintype" id="3145910">false</span><br>
<span class="lineno">90</span><span class="op" id="3145916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3145919">//&nbsp;findFunction&nbsp;looks&nbsp;for&nbsp;a&nbsp;function&nbsp;in&nbsp;the&nbsp;template,&nbsp;and&nbsp;global&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="3145989">func</span>&nbsp;<span class="ident" id="3145994">findFunction</span><span class="op" id="3146006">(</span><span class="ident" id="3146007">name</span>&nbsp;<span class="builtintype" id="3146012">string</span><span class="op" id="3146018">,</span>&nbsp;<span class="ident" id="3146020">tmpl</span>&nbsp;<span class="op" id="3146025">*</span><span class="ident" id="3146026">Template</span><span class="op" id="3146034">)</span>&nbsp;<span class="op" id="3146036">(</span><span class="ident" id="3146037">reflect</span><span class="op" id="3146044">.</span><span class="ident" id="3146045">Value</span><span class="op" id="3146050">,</span>&nbsp;<span class="builtintype" id="3146052">bool</span><span class="op" id="3146056">)</span>&nbsp;<span class="op" id="3146058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146061">if</span>&nbsp;<span class="ident" id="3146064">tmpl</span>&nbsp;<span class="op" id="3146069">!=</span>&nbsp;<span class="ident" id="3146072">nil</span>&nbsp;<span class="op" id="3146076">&amp;&amp;</span>&nbsp;<span class="ident" id="3146079">tmpl</span><span class="op" id="3146083">.</span><span class="ident" id="3146084">common</span>&nbsp;<span class="op" id="3146091">!=</span>&nbsp;<span class="ident" id="3146094">nil</span>&nbsp;<span class="op" id="3146098">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146102">if</span>&nbsp;<span class="ident" id="3146105">fn</span>&nbsp;<span class="op" id="3146108">:=</span>&nbsp;<span class="ident" id="3146111">tmpl</span><span class="op" id="3146115">.</span><span class="ident" id="3146116">execFuncs</span><span class="op" id="3146125">[</span><span class="ident" id="3146126">name</span><span class="op" id="3146130">]</span><span class="op" id="3146131">;</span>&nbsp;<span class="ident" id="3146133">fn</span><span class="op" id="3146135">.</span><span class="ident" id="3146136">IsValid</span><span class="op" id="3146143">(</span><span class="op" id="3146144">)</span>&nbsp;<span class="op" id="3146146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146151">return</span>&nbsp;<span class="ident" id="3146158">fn</span><span class="op" id="3146160">,</span>&nbsp;<span class="builtintype" id="3146162">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3146169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3146172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146175">if</span>&nbsp;<span class="ident" id="3146178">fn</span>&nbsp;<span class="op" id="3146181">:=</span>&nbsp;<span class="ident" id="3146184">builtinFuncs</span><span class="op" id="3146196">[</span><span class="ident" id="3146197">name</span><span class="op" id="3146201">]</span><span class="op" id="3146202">;</span>&nbsp;<span class="ident" id="3146204">fn</span><span class="op" id="3146206">.</span><span class="ident" id="3146207">IsValid</span><span class="op" id="3146214">(</span><span class="op" id="3146215">)</span>&nbsp;<span class="op" id="3146217">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146221">return</span>&nbsp;<span class="ident" id="3146228">fn</span><span class="op" id="3146230">,</span>&nbsp;<span class="builtintype" id="3146232">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3146238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146241">return</span>&nbsp;<span class="ident" id="3146248">reflect</span><span class="op" id="3146255">.</span><span class="ident" id="3146256">Value</span><span class="op" id="3146261">{</span><span class="op" id="3146262">}</span><span class="op" id="3146263">,</span>&nbsp;<span class="builtintype" id="3146265">false</span><br>
<span class="lineno"></span><span class="op" id="3146271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="3146274">//&nbsp;Indexing.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3146288">//&nbsp;index&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;indexing&nbsp;its&nbsp;first&nbsp;argument&nbsp;by&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="3146364">//&nbsp;arguments.&nbsp;&nbsp;Thus&nbsp;&#34;index&nbsp;x&nbsp;1&nbsp;2&nbsp;3&#34;&nbsp;is,&nbsp;in&nbsp;Go&nbsp;syntax,&nbsp;x[1][2][3].&nbsp;Each</span><br>
<span class="lineno"></span><span class="comment" id="3146435">//&nbsp;indexed&nbsp;item&nbsp;must&nbsp;be&nbsp;a&nbsp;map,&nbsp;slice,&nbsp;or&nbsp;array.</span><br>
<span class="lineno">110</span><span class="keyword" id="3146483">func</span>&nbsp;<span class="ident" id="3146488">index</span><span class="op" id="3146493">(</span><span class="ident" id="3146494">item</span>&nbsp;<span class="keyword" id="3146499">interface</span><span class="op" id="3146508">{</span><span class="op" id="3146509">}</span><span class="op" id="3146510">,</span>&nbsp;<span class="ident" id="3146512">indices</span>&nbsp;<span class="op" id="3146520">...</span><span class="keyword" id="3146523">interface</span><span class="op" id="3146532">{</span><span class="op" id="3146533">}</span><span class="op" id="3146534">)</span>&nbsp;<span class="op" id="3146536">(</span><span class="keyword" id="3146537">interface</span><span class="op" id="3146546">{</span><span class="op" id="3146547">}</span><span class="op" id="3146548">,</span>&nbsp;<span class="builtintype" id="3146550">error</span><span class="op" id="3146555">)</span>&nbsp;<span class="op" id="3146557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3146560">v</span>&nbsp;<span class="op" id="3146562">:=</span>&nbsp;<span class="ident" id="3146565">reflect</span><span class="op" id="3146572">.</span><span class="ident" id="3146573">ValueOf</span><span class="op" id="3146580">(</span><span class="ident" id="3146581">item</span><span class="op" id="3146585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146588">for</span>&nbsp;<span class="ident" id="3146592">_</span><span class="op" id="3146593">,</span>&nbsp;<span class="ident" id="3146595">i</span>&nbsp;<span class="op" id="3146597">:=</span>&nbsp;<span class="keyword" id="3146600">range</span>&nbsp;<span class="ident" id="3146606">indices</span>&nbsp;<span class="op" id="3146614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3146618">index</span>&nbsp;<span class="op" id="3146624">:=</span>&nbsp;<span class="ident" id="3146627">reflect</span><span class="op" id="3146634">.</span><span class="ident" id="3146635">ValueOf</span><span class="op" id="3146642">(</span><span class="ident" id="3146643">i</span><span class="op" id="3146644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146648">var</span>&nbsp;<span class="ident" id="3146652">isNil</span>&nbsp;<span class="builtintype" id="3146658">bool</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146665">if</span>&nbsp;<span class="ident" id="3146668">v</span><span class="op" id="3146669">,</span>&nbsp;<span class="ident" id="3146671">isNil</span>&nbsp;<span class="op" id="3146677">=</span>&nbsp;<span class="ident" id="3146679">indirect</span><span class="op" id="3146687">(</span><span class="ident" id="3146688">v</span><span class="op" id="3146689">)</span><span class="op" id="3146690">;</span>&nbsp;<span class="ident" id="3146692">isNil</span>&nbsp;<span class="op" id="3146698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146703">return</span>&nbsp;<span class="ident" id="3146710">nil</span><span class="op" id="3146713">,</span>&nbsp;<span class="ident" id="3146715">fmt</span><span class="op" id="3146718">.</span><span class="ident" id="3146719">Errorf</span><span class="op" id="3146725">(</span><span class="string" id="3146726">&#34;index&nbsp;of&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="3146748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3146752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146756">switch</span>&nbsp;<span class="ident" id="3146763">v</span><span class="op" id="3146764">.</span><span class="ident" id="3146765">Kind</span><span class="op" id="3146769">(</span><span class="op" id="3146770">)</span>&nbsp;<span class="op" id="3146772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146776">case</span>&nbsp;<span class="ident" id="3146781">reflect</span><span class="op" id="3146788">.</span><span class="ident" id="3146789">Array</span><span class="op" id="3146794">,</span>&nbsp;<span class="ident" id="3146796">reflect</span><span class="op" id="3146803">.</span><span class="ident" id="3146804">Slice</span><span class="op" id="3146809">,</span>&nbsp;<span class="ident" id="3146811">reflect</span><span class="op" id="3146818">.</span><span class="ident" id="3146819">String</span><span class="op" id="3146825">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146830">var</span>&nbsp;<span class="ident" id="3146834">x</span>&nbsp;<span class="ident" id="3146836">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146845">switch</span>&nbsp;<span class="ident" id="3146852">index</span><span class="op" id="3146857">.</span><span class="ident" id="3146858">Kind</span><span class="op" id="3146862">(</span><span class="op" id="3146863">)</span>&nbsp;<span class="op" id="3146865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146870">case</span>&nbsp;<span class="ident" id="3146875">reflect</span><span class="op" id="3146882">.</span><span class="ident" id="3146883">Int</span><span class="op" id="3146886">,</span>&nbsp;<span class="ident" id="3146888">reflect</span><span class="op" id="3146895">.</span><span class="ident" id="3146896">Int8</span><span class="op" id="3146900">,</span>&nbsp;<span class="ident" id="3146902">reflect</span><span class="op" id="3146909">.</span><span class="ident" id="3146910">Int16</span><span class="op" id="3146915">,</span>&nbsp;<span class="ident" id="3146917">reflect</span><span class="op" id="3146924">.</span><span class="ident" id="3146925">Int32</span><span class="op" id="3146930">,</span>&nbsp;<span class="ident" id="3146932">reflect</span><span class="op" id="3146939">.</span><span class="ident" id="3146940">Int64</span><span class="op" id="3146945">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3146951">x</span>&nbsp;<span class="op" id="3146953">=</span>&nbsp;<span class="ident" id="3146955">index</span><span class="op" id="3146960">.</span><span class="ident" id="3146961">Int</span><span class="op" id="3146964">(</span><span class="op" id="3146965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146970">case</span>&nbsp;<span class="ident" id="3146975">reflect</span><span class="op" id="3146982">.</span><span class="ident" id="3146983">Uint</span><span class="op" id="3146987">,</span>&nbsp;<span class="ident" id="3146989">reflect</span><span class="op" id="3146996">.</span><span class="ident" id="3146997">Uint8</span><span class="op" id="3147002">,</span>&nbsp;<span class="ident" id="3147004">reflect</span><span class="op" id="3147011">.</span><span class="ident" id="3147012">Uint16</span><span class="op" id="3147018">,</span>&nbsp;<span class="ident" id="3147020">reflect</span><span class="op" id="3147027">.</span><span class="ident" id="3147028">Uint32</span><span class="op" id="3147034">,</span>&nbsp;<span class="ident" id="3147036">reflect</span><span class="op" id="3147043">.</span><span class="ident" id="3147044">Uint64</span><span class="op" id="3147050">,</span>&nbsp;<span class="ident" id="3147052">reflect</span><span class="op" id="3147059">.</span><span class="ident" id="3147060">Uintptr</span><span class="op" id="3147067">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147073">x</span>&nbsp;<span class="op" id="3147075">=</span>&nbsp;<span class="ident" id="3147077">int64</span><span class="op" id="3147082">(</span><span class="ident" id="3147083">index</span><span class="op" id="3147088">.</span><span class="ident" id="3147089">Uint</span><span class="op" id="3147093">(</span><span class="op" id="3147094">)</span><span class="op" id="3147095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147100">default</span><span class="op" id="3147107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147113">return</span>&nbsp;<span class="ident" id="3147120">nil</span><span class="op" id="3147123">,</span>&nbsp;<span class="ident" id="3147125">fmt</span><span class="op" id="3147128">.</span><span class="ident" id="3147129">Errorf</span><span class="op" id="3147135">(</span><span class="string" id="3147136">&#34;cannot&nbsp;index&nbsp;slice/array&nbsp;with&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3147175">,</span>&nbsp;<span class="ident" id="3147177">index</span><span class="op" id="3147182">.</span><span class="ident" id="3147183">Type</span><span class="op" id="3147187">(</span><span class="op" id="3147188">)</span><span class="op" id="3147189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3147194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147199">if</span>&nbsp;<span class="ident" id="3147202">x</span>&nbsp;<span class="op" id="3147204">&lt;</span>&nbsp;<span class="num" id="3147206">0</span>&nbsp;<span class="op" id="3147208">||</span>&nbsp;<span class="ident" id="3147211">x</span>&nbsp;<span class="op" id="3147213">&gt;=</span>&nbsp;<span class="ident" id="3147216">int64</span><span class="op" id="3147221">(</span><span class="ident" id="3147222">v</span><span class="op" id="3147223">.</span><span class="ident" id="3147224">Len</span><span class="op" id="3147227">(</span><span class="op" id="3147228">)</span><span class="op" id="3147229">)</span>&nbsp;<span class="op" id="3147231">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147237">return</span>&nbsp;<span class="ident" id="3147244">nil</span><span class="op" id="3147247">,</span>&nbsp;<span class="ident" id="3147249">fmt</span><span class="op" id="3147252">.</span><span class="ident" id="3147253">Errorf</span><span class="op" id="3147259">(</span><span class="string" id="3147260">&#34;index&nbsp;out&nbsp;of&nbsp;range:&nbsp;%d&#34;</span><span class="op" id="3147284">,</span>&nbsp;<span class="ident" id="3147286">x</span><span class="op" id="3147287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3147292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147297">v</span>&nbsp;<span class="op" id="3147299">=</span>&nbsp;<span class="ident" id="3147301">v</span><span class="op" id="3147302">.</span><span class="ident" id="3147303">Index</span><span class="op" id="3147308">(</span><span class="builtintype" id="3147309">int</span><span class="op" id="3147312">(</span><span class="ident" id="3147313">x</span><span class="op" id="3147314">)</span><span class="op" id="3147315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147319">case</span>&nbsp;<span class="ident" id="3147324">reflect</span><span class="op" id="3147331">.</span><span class="ident" id="3147332">Map</span><span class="op" id="3147335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147340">if</span>&nbsp;<span class="op" id="3147343">!</span><span class="ident" id="3147344">index</span><span class="op" id="3147349">.</span><span class="ident" id="3147350">IsValid</span><span class="op" id="3147357">(</span><span class="op" id="3147358">)</span>&nbsp;<span class="op" id="3147360">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147366">index</span>&nbsp;<span class="op" id="3147372">=</span>&nbsp;<span class="ident" id="3147374">reflect</span><span class="op" id="3147381">.</span><span class="ident" id="3147382">Zero</span><span class="op" id="3147386">(</span><span class="ident" id="3147387">v</span><span class="op" id="3147388">.</span><span class="ident" id="3147389">Type</span><span class="op" id="3147393">(</span><span class="op" id="3147394">)</span><span class="op" id="3147395">.</span><span class="ident" id="3147396">Key</span><span class="op" id="3147399">(</span><span class="op" id="3147400">)</span><span class="op" id="3147401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3147406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147411">if</span>&nbsp;<span class="op" id="3147414">!</span><span class="ident" id="3147415">index</span><span class="op" id="3147420">.</span><span class="ident" id="3147421">Type</span><span class="op" id="3147425">(</span><span class="op" id="3147426">)</span><span class="op" id="3147427">.</span><span class="ident" id="3147428">AssignableTo</span><span class="op" id="3147440">(</span><span class="ident" id="3147441">v</span><span class="op" id="3147442">.</span><span class="ident" id="3147443">Type</span><span class="op" id="3147447">(</span><span class="op" id="3147448">)</span><span class="op" id="3147449">.</span><span class="ident" id="3147450">Key</span><span class="op" id="3147453">(</span><span class="op" id="3147454">)</span><span class="op" id="3147455">)</span>&nbsp;<span class="op" id="3147457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147463">return</span>&nbsp;<span class="ident" id="3147470">nil</span><span class="op" id="3147473">,</span>&nbsp;<span class="ident" id="3147475">fmt</span><span class="op" id="3147478">.</span><span class="ident" id="3147479">Errorf</span><span class="op" id="3147485">(</span><span class="string" id="3147486">&#34;%s&nbsp;is&nbsp;not&nbsp;index&nbsp;type&nbsp;for&nbsp;%s&#34;</span><span class="op" id="3147515">,</span>&nbsp;<span class="ident" id="3147517">index</span><span class="op" id="3147522">.</span><span class="ident" id="3147523">Type</span><span class="op" id="3147527">(</span><span class="op" id="3147528">)</span><span class="op" id="3147529">,</span>&nbsp;<span class="ident" id="3147531">v</span><span class="op" id="3147532">.</span><span class="ident" id="3147533">Type</span><span class="op" id="3147537">(</span><span class="op" id="3147538">)</span><span class="op" id="3147539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3147544">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147549">if</span>&nbsp;<span class="ident" id="3147552">x</span>&nbsp;<span class="op" id="3147554">:=</span>&nbsp;<span class="ident" id="3147557">v</span><span class="op" id="3147558">.</span><span class="ident" id="3147559">MapIndex</span><span class="op" id="3147567">(</span><span class="ident" id="3147568">index</span><span class="op" id="3147573">)</span><span class="op" id="3147574">;</span>&nbsp;<span class="ident" id="3147576">x</span><span class="op" id="3147577">.</span><span class="ident" id="3147578">IsValid</span><span class="op" id="3147585">(</span><span class="op" id="3147586">)</span>&nbsp;<span class="op" id="3147588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147594">v</span>&nbsp;<span class="op" id="3147596">=</span>&nbsp;<span class="ident" id="3147598">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3147603">}</span>&nbsp;<span class="keyword" id="3147605">else</span>&nbsp;<span class="op" id="3147610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147616">v</span>&nbsp;<span class="op" id="3147618">=</span>&nbsp;<span class="ident" id="3147620">reflect</span><span class="op" id="3147627">.</span><span class="ident" id="3147628">Zero</span><span class="op" id="3147632">(</span><span class="ident" id="3147633">v</span><span class="op" id="3147634">.</span><span class="ident" id="3147635">Type</span><span class="op" id="3147639">(</span><span class="op" id="3147640">)</span><span class="op" id="3147641">.</span><span class="ident" id="3147642">Elem</span><span class="op" id="3147646">(</span><span class="op" id="3147647">)</span><span class="op" id="3147648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3147653">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147657">default</span><span class="op" id="3147664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147669">return</span>&nbsp;<span class="ident" id="3147676">nil</span><span class="op" id="3147679">,</span>&nbsp;<span class="ident" id="3147681">fmt</span><span class="op" id="3147684">.</span><span class="ident" id="3147685">Errorf</span><span class="op" id="3147691">(</span><span class="string" id="3147692">&#34;can&#39;t&nbsp;index&nbsp;item&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3147721">,</span>&nbsp;<span class="ident" id="3147723">v</span><span class="op" id="3147724">.</span><span class="ident" id="3147725">Type</span><span class="op" id="3147729">(</span><span class="op" id="3147730">)</span><span class="op" id="3147731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3147735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3147738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147741">return</span>&nbsp;<span class="ident" id="3147748">v</span><span class="op" id="3147749">.</span><span class="ident" id="3147750">Interface</span><span class="op" id="3147759">(</span><span class="op" id="3147760">)</span><span class="op" id="3147761">,</span>&nbsp;<span class="ident" id="3147763">nil</span><br>
<span class="lineno">150</span><span class="op" id="3147767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3147770">//&nbsp;Length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3147781">//&nbsp;length&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;item,&nbsp;with&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;defined&nbsp;length.</span><br>
<span class="lineno">155</span><span class="keyword" id="3147866">func</span>&nbsp;<span class="ident" id="3147871">length</span><span class="op" id="3147877">(</span><span class="ident" id="3147878">item</span>&nbsp;<span class="keyword" id="3147883">interface</span><span class="op" id="3147892">{</span><span class="op" id="3147893">}</span><span class="op" id="3147894">)</span>&nbsp;<span class="op" id="3147896">(</span><span class="builtintype" id="3147897">int</span><span class="op" id="3147900">,</span>&nbsp;<span class="builtintype" id="3147902">error</span><span class="op" id="3147907">)</span>&nbsp;<span class="op" id="3147909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147912">v</span><span class="op" id="3147913">,</span>&nbsp;<span class="ident" id="3147915">isNil</span>&nbsp;<span class="op" id="3147921">:=</span>&nbsp;<span class="ident" id="3147924">indirect</span><span class="op" id="3147932">(</span><span class="ident" id="3147933">reflect</span><span class="op" id="3147940">.</span><span class="ident" id="3147941">ValueOf</span><span class="op" id="3147948">(</span><span class="ident" id="3147949">item</span><span class="op" id="3147953">)</span><span class="op" id="3147954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147957">if</span>&nbsp;<span class="ident" id="3147960">isNil</span>&nbsp;<span class="op" id="3147966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147970">return</span>&nbsp;<span class="num" id="3147977">0</span><span class="op" id="3147978">,</span>&nbsp;<span class="ident" id="3147980">fmt</span><span class="op" id="3147983">.</span><span class="ident" id="3147984">Errorf</span><span class="op" id="3147990">(</span><span class="string" id="3147991">&#34;len&nbsp;of&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="3148011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3148014">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148017">switch</span>&nbsp;<span class="ident" id="3148024">v</span><span class="op" id="3148025">.</span><span class="ident" id="3148026">Kind</span><span class="op" id="3148030">(</span><span class="op" id="3148031">)</span>&nbsp;<span class="op" id="3148033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148036">case</span>&nbsp;<span class="ident" id="3148041">reflect</span><span class="op" id="3148048">.</span><span class="ident" id="3148049">Array</span><span class="op" id="3148054">,</span>&nbsp;<span class="ident" id="3148056">reflect</span><span class="op" id="3148063">.</span><span class="ident" id="3148064">Chan</span><span class="op" id="3148068">,</span>&nbsp;<span class="ident" id="3148070">reflect</span><span class="op" id="3148077">.</span><span class="ident" id="3148078">Map</span><span class="op" id="3148081">,</span>&nbsp;<span class="ident" id="3148083">reflect</span><span class="op" id="3148090">.</span><span class="ident" id="3148091">Slice</span><span class="op" id="3148096">,</span>&nbsp;<span class="ident" id="3148098">reflect</span><span class="op" id="3148105">.</span><span class="ident" id="3148106">String</span><span class="op" id="3148112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148116">return</span>&nbsp;<span class="ident" id="3148123">v</span><span class="op" id="3148124">.</span><span class="ident" id="3148125">Len</span><span class="op" id="3148128">(</span><span class="op" id="3148129">)</span><span class="op" id="3148130">,</span>&nbsp;<span class="ident" id="3148132">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3148137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148140">return</span>&nbsp;<span class="num" id="3148147">0</span><span class="op" id="3148148">,</span>&nbsp;<span class="ident" id="3148150">fmt</span><span class="op" id="3148153">.</span><span class="ident" id="3148154">Errorf</span><span class="op" id="3148160">(</span><span class="string" id="3148161">&#34;len&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3148177">,</span>&nbsp;<span class="ident" id="3148179">v</span><span class="op" id="3148180">.</span><span class="ident" id="3148181">Type</span><span class="op" id="3148185">(</span><span class="op" id="3148186">)</span><span class="op" id="3148187">)</span><br>
<span class="lineno">165</span><span class="op" id="3148189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3148192">//&nbsp;Function&nbsp;invocation</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3148216">//&nbsp;call&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;evaluating&nbsp;the&nbsp;first&nbsp;argument&nbsp;as&nbsp;a&nbsp;function.</span><br>
<span class="lineno">170</span><span class="comment" id="3148291">//&nbsp;The&nbsp;function&nbsp;must&nbsp;return&nbsp;1&nbsp;result,&nbsp;or&nbsp;2&nbsp;results,&nbsp;the&nbsp;second&nbsp;of&nbsp;which&nbsp;is&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3148376">func</span>&nbsp;<span class="ident" id="3148381">call</span><span class="op" id="3148385">(</span><span class="ident" id="3148386">fn</span>&nbsp;<span class="keyword" id="3148389">interface</span><span class="op" id="3148398">{</span><span class="op" id="3148399">}</span><span class="op" id="3148400">,</span>&nbsp;<span class="ident" id="3148402">args</span>&nbsp;<span class="op" id="3148407">...</span><span class="keyword" id="3148410">interface</span><span class="op" id="3148419">{</span><span class="op" id="3148420">}</span><span class="op" id="3148421">)</span>&nbsp;<span class="op" id="3148423">(</span><span class="keyword" id="3148424">interface</span><span class="op" id="3148433">{</span><span class="op" id="3148434">}</span><span class="op" id="3148435">,</span>&nbsp;<span class="builtintype" id="3148437">error</span><span class="op" id="3148442">)</span>&nbsp;<span class="op" id="3148444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148447">v</span>&nbsp;<span class="op" id="3148449">:=</span>&nbsp;<span class="ident" id="3148452">reflect</span><span class="op" id="3148459">.</span><span class="ident" id="3148460">ValueOf</span><span class="op" id="3148467">(</span><span class="ident" id="3148468">fn</span><span class="op" id="3148470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148473">typ</span>&nbsp;<span class="op" id="3148477">:=</span>&nbsp;<span class="ident" id="3148480">v</span><span class="op" id="3148481">.</span><span class="ident" id="3148482">Type</span><span class="op" id="3148486">(</span><span class="op" id="3148487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148490">if</span>&nbsp;<span class="ident" id="3148493">typ</span><span class="op" id="3148496">.</span><span class="ident" id="3148497">Kind</span><span class="op" id="3148501">(</span><span class="op" id="3148502">)</span>&nbsp;<span class="op" id="3148504">!=</span>&nbsp;<span class="ident" id="3148507">reflect</span><span class="op" id="3148514">.</span><span class="ident" id="3148515">Func</span>&nbsp;<span class="op" id="3148520">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148524">return</span>&nbsp;<span class="ident" id="3148531">nil</span><span class="op" id="3148534">,</span>&nbsp;<span class="ident" id="3148536">fmt</span><span class="op" id="3148539">.</span><span class="ident" id="3148540">Errorf</span><span class="op" id="3148546">(</span><span class="string" id="3148547">&#34;non-function&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3148572">,</span>&nbsp;<span class="ident" id="3148574">typ</span><span class="op" id="3148577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3148580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148583">if</span>&nbsp;<span class="op" id="3148586">!</span><span class="ident" id="3148587">goodFunc</span><span class="op" id="3148595">(</span><span class="ident" id="3148596">typ</span><span class="op" id="3148599">)</span>&nbsp;<span class="op" id="3148601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148605">return</span>&nbsp;<span class="ident" id="3148612">nil</span><span class="op" id="3148615">,</span>&nbsp;<span class="ident" id="3148617">fmt</span><span class="op" id="3148620">.</span><span class="ident" id="3148621">Errorf</span><span class="op" id="3148627">(</span><span class="string" id="3148628">&#34;function&nbsp;called&nbsp;with&nbsp;%d&nbsp;args;&nbsp;should&nbsp;be&nbsp;1&nbsp;or&nbsp;2&#34;</span><span class="op" id="3148676">,</span>&nbsp;<span class="ident" id="3148678">typ</span><span class="op" id="3148681">.</span><span class="ident" id="3148682">NumOut</span><span class="op" id="3148688">(</span><span class="op" id="3148689">)</span><span class="op" id="3148690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3148693">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148696">numIn</span>&nbsp;<span class="op" id="3148702">:=</span>&nbsp;<span class="ident" id="3148705">typ</span><span class="op" id="3148708">.</span><span class="ident" id="3148709">NumIn</span><span class="op" id="3148714">(</span><span class="op" id="3148715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148718">var</span>&nbsp;<span class="ident" id="3148722">dddType</span>&nbsp;<span class="ident" id="3148730">reflect</span><span class="op" id="3148737">.</span><span class="ident" id="3148738">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148744">if</span>&nbsp;<span class="ident" id="3148747">typ</span><span class="op" id="3148750">.</span><span class="ident" id="3148751">IsVariadic</span><span class="op" id="3148761">(</span><span class="op" id="3148762">)</span>&nbsp;<span class="op" id="3148764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148768">if</span>&nbsp;<span class="builtinfunc" id="3148771">len</span><span class="op" id="3148774">(</span><span class="ident" id="3148775">args</span><span class="op" id="3148779">)</span>&nbsp;<span class="op" id="3148781">&lt;</span>&nbsp;<span class="ident" id="3148783">numIn</span><span class="op" id="3148788">-</span><span class="num" id="3148789">1</span>&nbsp;<span class="op" id="3148791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148796">return</span>&nbsp;<span class="ident" id="3148803">nil</span><span class="op" id="3148806">,</span>&nbsp;<span class="ident" id="3148808">fmt</span><span class="op" id="3148811">.</span><span class="ident" id="3148812">Errorf</span><span class="op" id="3148818">(</span><span class="string" id="3148819">&#34;wrong&nbsp;number&nbsp;of&nbsp;args:&nbsp;got&nbsp;%d&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&#34;</span><span class="op" id="3148866">,</span>&nbsp;<span class="builtinfunc" id="3148868">len</span><span class="op" id="3148871">(</span><span class="ident" id="3148872">args</span><span class="op" id="3148876">)</span><span class="op" id="3148877">,</span>&nbsp;<span class="ident" id="3148879">numIn</span><span class="op" id="3148884">-</span><span class="num" id="3148885">1</span><span class="op" id="3148886">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3148890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148894">dddType</span>&nbsp;<span class="op" id="3148902">=</span>&nbsp;<span class="ident" id="3148904">typ</span><span class="op" id="3148907">.</span><span class="ident" id="3148908">In</span><span class="op" id="3148910">(</span><span class="ident" id="3148911">numIn</span>&nbsp;<span class="op" id="3148917">-</span>&nbsp;<span class="num" id="3148919">1</span><span class="op" id="3148920">)</span><span class="op" id="3148921">.</span><span class="ident" id="3148922">Elem</span><span class="op" id="3148926">(</span><span class="op" id="3148927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3148930">}</span>&nbsp;<span class="keyword" id="3148932">else</span>&nbsp;<span class="op" id="3148937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148941">if</span>&nbsp;<span class="builtinfunc" id="3148944">len</span><span class="op" id="3148947">(</span><span class="ident" id="3148948">args</span><span class="op" id="3148952">)</span>&nbsp;<span class="op" id="3148954">!=</span>&nbsp;<span class="ident" id="3148957">numIn</span>&nbsp;<span class="op" id="3148963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148968">return</span>&nbsp;<span class="ident" id="3148975">nil</span><span class="op" id="3148978">,</span>&nbsp;<span class="ident" id="3148980">fmt</span><span class="op" id="3148983">.</span><span class="ident" id="3148984">Errorf</span><span class="op" id="3148990">(</span><span class="string" id="3148991">&#34;wrong&nbsp;number&nbsp;of&nbsp;args:&nbsp;got&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="3149029">,</span>&nbsp;<span class="builtinfunc" id="3149031">len</span><span class="op" id="3149034">(</span><span class="ident" id="3149035">args</span><span class="op" id="3149039">)</span><span class="op" id="3149040">,</span>&nbsp;<span class="ident" id="3149042">numIn</span><span class="op" id="3149047">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3149051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3149054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149057">argv</span>&nbsp;<span class="op" id="3149062">:=</span>&nbsp;<span class="builtinfunc" id="3149065">make</span><span class="op" id="3149069">(</span><span class="op" id="3149070">[</span><span class="op" id="3149071">]</span><span class="ident" id="3149072">reflect</span><span class="op" id="3149079">.</span><span class="ident" id="3149080">Value</span><span class="op" id="3149085">,</span>&nbsp;<span class="builtinfunc" id="3149087">len</span><span class="op" id="3149090">(</span><span class="ident" id="3149091">args</span><span class="op" id="3149095">)</span><span class="op" id="3149096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149099">for</span>&nbsp;<span class="ident" id="3149103">i</span><span class="op" id="3149104">,</span>&nbsp;<span class="ident" id="3149106">arg</span>&nbsp;<span class="op" id="3149110">:=</span>&nbsp;<span class="keyword" id="3149113">range</span>&nbsp;<span class="ident" id="3149119">args</span>&nbsp;<span class="op" id="3149124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149128">value</span>&nbsp;<span class="op" id="3149134">:=</span>&nbsp;<span class="ident" id="3149137">reflect</span><span class="op" id="3149144">.</span><span class="ident" id="3149145">ValueOf</span><span class="op" id="3149152">(</span><span class="ident" id="3149153">arg</span><span class="op" id="3149156">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3149160">//&nbsp;Compute&nbsp;the&nbsp;expected&nbsp;type.&nbsp;Clumsy&nbsp;because&nbsp;of&nbsp;variadics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149221">var</span>&nbsp;<span class="ident" id="3149225">argType</span>&nbsp;<span class="ident" id="3149233">reflect</span><span class="op" id="3149240">.</span><span class="ident" id="3149241">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149248">if</span>&nbsp;<span class="op" id="3149251">!</span><span class="ident" id="3149252">typ</span><span class="op" id="3149255">.</span><span class="ident" id="3149256">IsVariadic</span><span class="op" id="3149266">(</span><span class="op" id="3149267">)</span>&nbsp;<span class="op" id="3149269">||</span>&nbsp;<span class="ident" id="3149272">i</span>&nbsp;<span class="op" id="3149274">&lt;</span>&nbsp;<span class="ident" id="3149276">numIn</span><span class="op" id="3149281">-</span><span class="num" id="3149282">1</span>&nbsp;<span class="op" id="3149284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149289">argType</span>&nbsp;<span class="op" id="3149297">=</span>&nbsp;<span class="ident" id="3149299">typ</span><span class="op" id="3149302">.</span><span class="ident" id="3149303">In</span><span class="op" id="3149305">(</span><span class="ident" id="3149306">i</span><span class="op" id="3149307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3149311">}</span>&nbsp;<span class="keyword" id="3149313">else</span>&nbsp;<span class="op" id="3149318">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149323">argType</span>&nbsp;<span class="op" id="3149331">=</span>&nbsp;<span class="ident" id="3149333">dddType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3149343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149347">if</span>&nbsp;<span class="op" id="3149350">!</span><span class="ident" id="3149351">value</span><span class="op" id="3149356">.</span><span class="ident" id="3149357">IsValid</span><span class="op" id="3149364">(</span><span class="op" id="3149365">)</span>&nbsp;<span class="op" id="3149367">&amp;&amp;</span>&nbsp;<span class="ident" id="3149370">canBeNil</span><span class="op" id="3149378">(</span><span class="ident" id="3149379">argType</span><span class="op" id="3149386">)</span>&nbsp;<span class="op" id="3149388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149393">value</span>&nbsp;<span class="op" id="3149399">=</span>&nbsp;<span class="ident" id="3149401">reflect</span><span class="op" id="3149408">.</span><span class="ident" id="3149409">Zero</span><span class="op" id="3149413">(</span><span class="ident" id="3149414">argType</span><span class="op" id="3149421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3149425">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149429">if</span>&nbsp;<span class="op" id="3149432">!</span><span class="ident" id="3149433">value</span><span class="op" id="3149438">.</span><span class="ident" id="3149439">Type</span><span class="op" id="3149443">(</span><span class="op" id="3149444">)</span><span class="op" id="3149445">.</span><span class="ident" id="3149446">AssignableTo</span><span class="op" id="3149458">(</span><span class="ident" id="3149459">argType</span><span class="op" id="3149466">)</span>&nbsp;<span class="op" id="3149468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149473">return</span>&nbsp;<span class="ident" id="3149480">nil</span><span class="op" id="3149483">,</span>&nbsp;<span class="ident" id="3149485">fmt</span><span class="op" id="3149488">.</span><span class="ident" id="3149489">Errorf</span><span class="op" id="3149495">(</span><span class="string" id="3149496">&#34;arg&nbsp;%d&nbsp;has&nbsp;type&nbsp;%s;&nbsp;should&nbsp;be&nbsp;%s&#34;</span><span class="op" id="3149530">,</span>&nbsp;<span class="ident" id="3149532">i</span><span class="op" id="3149533">,</span>&nbsp;<span class="ident" id="3149535">value</span><span class="op" id="3149540">.</span><span class="ident" id="3149541">Type</span><span class="op" id="3149545">(</span><span class="op" id="3149546">)</span><span class="op" id="3149547">,</span>&nbsp;<span class="ident" id="3149549">argType</span><span class="op" id="3149556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3149560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149564">argv</span><span class="op" id="3149568">[</span><span class="ident" id="3149569">i</span><span class="op" id="3149570">]</span>&nbsp;<span class="op" id="3149572">=</span>&nbsp;<span class="ident" id="3149574">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3149581">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149584">result</span>&nbsp;<span class="op" id="3149591">:=</span>&nbsp;<span class="ident" id="3149594">v</span><span class="op" id="3149595">.</span><span class="ident" id="3149596">Call</span><span class="op" id="3149600">(</span><span class="ident" id="3149601">argv</span><span class="op" id="3149605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149608">if</span>&nbsp;<span class="builtinfunc" id="3149611">len</span><span class="op" id="3149614">(</span><span class="ident" id="3149615">result</span><span class="op" id="3149621">)</span>&nbsp;<span class="op" id="3149623">==</span>&nbsp;<span class="num" id="3149626">2</span>&nbsp;<span class="op" id="3149628">&amp;&amp;</span>&nbsp;<span class="op" id="3149631">!</span><span class="ident" id="3149632">result</span><span class="op" id="3149638">[</span><span class="num" id="3149639">1</span><span class="op" id="3149640">]</span><span class="op" id="3149641">.</span><span class="ident" id="3149642">IsNil</span><span class="op" id="3149647">(</span><span class="op" id="3149648">)</span>&nbsp;<span class="op" id="3149650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149654">return</span>&nbsp;<span class="ident" id="3149661">result</span><span class="op" id="3149667">[</span><span class="num" id="3149668">0</span><span class="op" id="3149669">]</span><span class="op" id="3149670">.</span><span class="ident" id="3149671">Interface</span><span class="op" id="3149680">(</span><span class="op" id="3149681">)</span><span class="op" id="3149682">,</span>&nbsp;<span class="ident" id="3149684">result</span><span class="op" id="3149690">[</span><span class="num" id="3149691">1</span><span class="op" id="3149692">]</span><span class="op" id="3149693">.</span><span class="ident" id="3149694">Interface</span><span class="op" id="3149703">(</span><span class="op" id="3149704">)</span><span class="op" id="3149705">.</span><span class="op" id="3149706">(</span><span class="builtintype" id="3149707">error</span><span class="op" id="3149712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3149715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149718">return</span>&nbsp;<span class="ident" id="3149725">result</span><span class="op" id="3149731">[</span><span class="num" id="3149732">0</span><span class="op" id="3149733">]</span><span class="op" id="3149734">.</span><span class="ident" id="3149735">Interface</span><span class="op" id="3149744">(</span><span class="op" id="3149745">)</span><span class="op" id="3149746">,</span>&nbsp;<span class="ident" id="3149748">nil</span><br>
<span class="lineno">215</span><span class="op" id="3149752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3149755">//&nbsp;Boolean&nbsp;logic.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149774">func</span>&nbsp;<span class="ident" id="3149779">truth</span><span class="op" id="3149784">(</span><span class="ident" id="3149785">a</span>&nbsp;<span class="keyword" id="3149787">interface</span><span class="op" id="3149796">{</span><span class="op" id="3149797">}</span><span class="op" id="3149798">)</span>&nbsp;<span class="builtintype" id="3149800">bool</span>&nbsp;<span class="op" id="3149805">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149808">t</span><span class="op" id="3149809">,</span>&nbsp;<span class="ident" id="3149811">_</span>&nbsp;<span class="op" id="3149813">:=</span>&nbsp;<span class="ident" id="3149816">isTrue</span><span class="op" id="3149822">(</span><span class="ident" id="3149823">reflect</span><span class="op" id="3149830">.</span><span class="ident" id="3149831">ValueOf</span><span class="op" id="3149838">(</span><span class="ident" id="3149839">a</span><span class="op" id="3149840">)</span><span class="op" id="3149841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149844">return</span>&nbsp;<span class="ident" id="3149851">t</span><br>
<span class="lineno"></span><span class="op" id="3149853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3149856">//&nbsp;and&nbsp;computes&nbsp;the&nbsp;Boolean&nbsp;AND&nbsp;of&nbsp;its&nbsp;arguments,&nbsp;returning</span><br>
<span class="lineno">225</span><span class="comment" id="3149916">//&nbsp;the&nbsp;first&nbsp;false&nbsp;argument&nbsp;it&nbsp;encounters,&nbsp;or&nbsp;the&nbsp;last&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="3149981">func</span>&nbsp;<span class="ident" id="3149986">and</span><span class="op" id="3149989">(</span><span class="ident" id="3149990">arg0</span>&nbsp;<span class="keyword" id="3149995">interface</span><span class="op" id="3150004">{</span><span class="op" id="3150005">}</span><span class="op" id="3150006">,</span>&nbsp;<span class="ident" id="3150008">args</span>&nbsp;<span class="op" id="3150013">...</span><span class="keyword" id="3150016">interface</span><span class="op" id="3150025">{</span><span class="op" id="3150026">}</span><span class="op" id="3150027">)</span>&nbsp;<span class="keyword" id="3150029">interface</span><span class="op" id="3150038">{</span><span class="op" id="3150039">}</span>&nbsp;<span class="op" id="3150041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150044">if</span>&nbsp;<span class="op" id="3150047">!</span><span class="ident" id="3150048">truth</span><span class="op" id="3150053">(</span><span class="ident" id="3150054">arg0</span><span class="op" id="3150058">)</span>&nbsp;<span class="op" id="3150060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150064">return</span>&nbsp;<span class="ident" id="3150071">arg0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3150077">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150080">for</span>&nbsp;<span class="ident" id="3150084">i</span>&nbsp;<span class="op" id="3150086">:=</span>&nbsp;<span class="keyword" id="3150089">range</span>&nbsp;<span class="ident" id="3150095">args</span>&nbsp;<span class="op" id="3150100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150104">arg0</span>&nbsp;<span class="op" id="3150109">=</span>&nbsp;<span class="ident" id="3150111">args</span><span class="op" id="3150115">[</span><span class="ident" id="3150116">i</span><span class="op" id="3150117">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150121">if</span>&nbsp;<span class="op" id="3150124">!</span><span class="ident" id="3150125">truth</span><span class="op" id="3150130">(</span><span class="ident" id="3150131">arg0</span><span class="op" id="3150135">)</span>&nbsp;<span class="op" id="3150137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150142">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3150150">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3150153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150156">return</span>&nbsp;<span class="ident" id="3150163">arg0</span><br>
<span class="lineno"></span><span class="op" id="3150168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3150171">//&nbsp;or&nbsp;computes&nbsp;the&nbsp;Boolean&nbsp;OR&nbsp;of&nbsp;its&nbsp;arguments,&nbsp;returning</span><br>
<span class="lineno">240</span><span class="comment" id="3150229">//&nbsp;the&nbsp;first&nbsp;true&nbsp;argument&nbsp;it&nbsp;encounters,&nbsp;or&nbsp;the&nbsp;last&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="3150293">func</span>&nbsp;<span class="ident" id="3150298">or</span><span class="op" id="3150300">(</span><span class="ident" id="3150301">arg0</span>&nbsp;<span class="keyword" id="3150306">interface</span><span class="op" id="3150315">{</span><span class="op" id="3150316">}</span><span class="op" id="3150317">,</span>&nbsp;<span class="ident" id="3150319">args</span>&nbsp;<span class="op" id="3150324">...</span><span class="keyword" id="3150327">interface</span><span class="op" id="3150336">{</span><span class="op" id="3150337">}</span><span class="op" id="3150338">)</span>&nbsp;<span class="keyword" id="3150340">interface</span><span class="op" id="3150349">{</span><span class="op" id="3150350">}</span>&nbsp;<span class="op" id="3150352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150355">if</span>&nbsp;<span class="ident" id="3150358">truth</span><span class="op" id="3150363">(</span><span class="ident" id="3150364">arg0</span><span class="op" id="3150368">)</span>&nbsp;<span class="op" id="3150370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150374">return</span>&nbsp;<span class="ident" id="3150381">arg0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3150387">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150390">for</span>&nbsp;<span class="ident" id="3150394">i</span>&nbsp;<span class="op" id="3150396">:=</span>&nbsp;<span class="keyword" id="3150399">range</span>&nbsp;<span class="ident" id="3150405">args</span>&nbsp;<span class="op" id="3150410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150414">arg0</span>&nbsp;<span class="op" id="3150419">=</span>&nbsp;<span class="ident" id="3150421">args</span><span class="op" id="3150425">[</span><span class="ident" id="3150426">i</span><span class="op" id="3150427">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150431">if</span>&nbsp;<span class="ident" id="3150434">truth</span><span class="op" id="3150439">(</span><span class="ident" id="3150440">arg0</span><span class="op" id="3150444">)</span>&nbsp;<span class="op" id="3150446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150451">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3150459">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3150462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150465">return</span>&nbsp;<span class="ident" id="3150472">arg0</span><br>
<span class="lineno"></span><span class="op" id="3150477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3150480">//&nbsp;not&nbsp;returns&nbsp;the&nbsp;Boolean&nbsp;negation&nbsp;of&nbsp;its&nbsp;argument.</span><br>
<span class="lineno">255</span><span class="keyword" id="3150533">func</span>&nbsp;<span class="ident" id="3150538">not</span><span class="op" id="3150541">(</span><span class="ident" id="3150542">arg</span>&nbsp;<span class="keyword" id="3150546">interface</span><span class="op" id="3150555">{</span><span class="op" id="3150556">}</span><span class="op" id="3150557">)</span>&nbsp;<span class="op" id="3150559">(</span><span class="ident" id="3150560">truth</span>&nbsp;<span class="builtintype" id="3150566">bool</span><span class="op" id="3150570">)</span>&nbsp;<span class="op" id="3150572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150575">truth</span><span class="op" id="3150580">,</span>&nbsp;<span class="ident" id="3150582">_</span>&nbsp;<span class="op" id="3150584">=</span>&nbsp;<span class="ident" id="3150586">isTrue</span><span class="op" id="3150592">(</span><span class="ident" id="3150593">reflect</span><span class="op" id="3150600">.</span><span class="ident" id="3150601">ValueOf</span><span class="op" id="3150608">(</span><span class="ident" id="3150609">arg</span><span class="op" id="3150612">)</span><span class="op" id="3150613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150616">return</span>&nbsp;<span class="op" id="3150623">!</span><span class="ident" id="3150624">truth</span><br>
<span class="lineno"></span><span class="op" id="3150630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3150633">//&nbsp;Comparison.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3150649">//&nbsp;TODO:&nbsp;Perhaps&nbsp;allow&nbsp;comparison&nbsp;between&nbsp;signed&nbsp;and&nbsp;unsigned&nbsp;integers.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150722">var</span>&nbsp;<span class="op" id="3150726">(</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150729">errBadComparisonType</span>&nbsp;<span class="op" id="3150750">=</span>&nbsp;<span class="ident" id="3150752">errors</span><span class="op" id="3150758">.</span><span class="ident" id="3150759">New</span><span class="op" id="3150762">(</span><span class="string" id="3150763">&#34;invalid&nbsp;type&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3150792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150795">errBadComparison</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3150816">=</span>&nbsp;<span class="ident" id="3150818">errors</span><span class="op" id="3150824">.</span><span class="ident" id="3150825">New</span><span class="op" id="3150828">(</span><span class="string" id="3150829">&#34;incompatible&nbsp;types&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3150864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150867">errNoComparison</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3150888">=</span>&nbsp;<span class="ident" id="3150890">errors</span><span class="op" id="3150896">.</span><span class="ident" id="3150897">New</span><span class="op" id="3150900">(</span><span class="string" id="3150901">&#34;missing&nbsp;argument&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3150934">)</span><br>
<span class="lineno"></span><span class="op" id="3150936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="keyword" id="3150939">type</span>&nbsp;<span class="ident" id="3150944">kind</span>&nbsp;<span class="builtintype" id="3150949">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150954">const</span>&nbsp;<span class="op" id="3150960">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150963">invalidKind</span>&nbsp;<span class="ident" id="3150975">kind</span>&nbsp;<span class="op" id="3150980">=</span>&nbsp;<span class="ident" id="3150982">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150988">boolKind</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150998">complexKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151011">intKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151020">floatKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151031">integerKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151044">stringKind</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151056">uintKind</span><br>
<span class="lineno"></span><span class="op" id="3151065">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3151068">func</span>&nbsp;<span class="ident" id="3151073">basicKind</span><span class="op" id="3151082">(</span><span class="ident" id="3151083">v</span>&nbsp;<span class="ident" id="3151085">reflect</span><span class="op" id="3151092">.</span><span class="ident" id="3151093">Value</span><span class="op" id="3151098">)</span>&nbsp;<span class="op" id="3151100">(</span><span class="ident" id="3151101">kind</span><span class="op" id="3151105">,</span>&nbsp;<span class="builtintype" id="3151107">error</span><span class="op" id="3151112">)</span>&nbsp;<span class="op" id="3151114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151117">switch</span>&nbsp;<span class="ident" id="3151124">v</span><span class="op" id="3151125">.</span><span class="ident" id="3151126">Kind</span><span class="op" id="3151130">(</span><span class="op" id="3151131">)</span>&nbsp;<span class="op" id="3151133">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151136">case</span>&nbsp;<span class="ident" id="3151141">reflect</span><span class="op" id="3151148">.</span><span class="ident" id="3151149">Bool</span><span class="op" id="3151153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151157">return</span>&nbsp;<span class="ident" id="3151164">boolKind</span><span class="op" id="3151172">,</span>&nbsp;<span class="ident" id="3151174">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151179">case</span>&nbsp;<span class="ident" id="3151184">reflect</span><span class="op" id="3151191">.</span><span class="ident" id="3151192">Int</span><span class="op" id="3151195">,</span>&nbsp;<span class="ident" id="3151197">reflect</span><span class="op" id="3151204">.</span><span class="ident" id="3151205">Int8</span><span class="op" id="3151209">,</span>&nbsp;<span class="ident" id="3151211">reflect</span><span class="op" id="3151218">.</span><span class="ident" id="3151219">Int16</span><span class="op" id="3151224">,</span>&nbsp;<span class="ident" id="3151226">reflect</span><span class="op" id="3151233">.</span><span class="ident" id="3151234">Int32</span><span class="op" id="3151239">,</span>&nbsp;<span class="ident" id="3151241">reflect</span><span class="op" id="3151248">.</span><span class="ident" id="3151249">Int64</span><span class="op" id="3151254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151258">return</span>&nbsp;<span class="ident" id="3151265">intKind</span><span class="op" id="3151272">,</span>&nbsp;<span class="ident" id="3151274">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151279">case</span>&nbsp;<span class="ident" id="3151284">reflect</span><span class="op" id="3151291">.</span><span class="ident" id="3151292">Uint</span><span class="op" id="3151296">,</span>&nbsp;<span class="ident" id="3151298">reflect</span><span class="op" id="3151305">.</span><span class="ident" id="3151306">Uint8</span><span class="op" id="3151311">,</span>&nbsp;<span class="ident" id="3151313">reflect</span><span class="op" id="3151320">.</span><span class="ident" id="3151321">Uint16</span><span class="op" id="3151327">,</span>&nbsp;<span class="ident" id="3151329">reflect</span><span class="op" id="3151336">.</span><span class="ident" id="3151337">Uint32</span><span class="op" id="3151343">,</span>&nbsp;<span class="ident" id="3151345">reflect</span><span class="op" id="3151352">.</span><span class="ident" id="3151353">Uint64</span><span class="op" id="3151359">,</span>&nbsp;<span class="ident" id="3151361">reflect</span><span class="op" id="3151368">.</span><span class="ident" id="3151369">Uintptr</span><span class="op" id="3151376">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151380">return</span>&nbsp;<span class="ident" id="3151387">uintKind</span><span class="op" id="3151395">,</span>&nbsp;<span class="ident" id="3151397">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151402">case</span>&nbsp;<span class="ident" id="3151407">reflect</span><span class="op" id="3151414">.</span><span class="ident" id="3151415">Float32</span><span class="op" id="3151422">,</span>&nbsp;<span class="ident" id="3151424">reflect</span><span class="op" id="3151431">.</span><span class="ident" id="3151432">Float64</span><span class="op" id="3151439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151443">return</span>&nbsp;<span class="ident" id="3151450">floatKind</span><span class="op" id="3151459">,</span>&nbsp;<span class="ident" id="3151461">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151466">case</span>&nbsp;<span class="ident" id="3151471">reflect</span><span class="op" id="3151478">.</span><span class="ident" id="3151479">Complex64</span><span class="op" id="3151488">,</span>&nbsp;<span class="ident" id="3151490">reflect</span><span class="op" id="3151497">.</span><span class="ident" id="3151498">Complex128</span><span class="op" id="3151508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151512">return</span>&nbsp;<span class="ident" id="3151519">complexKind</span><span class="op" id="3151530">,</span>&nbsp;<span class="ident" id="3151532">nil</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151537">case</span>&nbsp;<span class="ident" id="3151542">reflect</span><span class="op" id="3151549">.</span><span class="ident" id="3151550">String</span><span class="op" id="3151556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151560">return</span>&nbsp;<span class="ident" id="3151567">stringKind</span><span class="op" id="3151577">,</span>&nbsp;<span class="ident" id="3151579">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3151584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151587">return</span>&nbsp;<span class="ident" id="3151594">invalidKind</span><span class="op" id="3151605">,</span>&nbsp;<span class="ident" id="3151607">errBadComparisonType</span><br>
<span class="lineno"></span><span class="op" id="3151628">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="3151631">//&nbsp;eq&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;==&nbsp;b&nbsp;||&nbsp;a&nbsp;==&nbsp;c&nbsp;||&nbsp;...</span><br>
<span class="lineno"></span><span class="keyword" id="3151686">func</span>&nbsp;<span class="ident" id="3151691">eq</span><span class="op" id="3151693">(</span><span class="ident" id="3151694">arg1</span>&nbsp;<span class="keyword" id="3151699">interface</span><span class="op" id="3151708">{</span><span class="op" id="3151709">}</span><span class="op" id="3151710">,</span>&nbsp;<span class="ident" id="3151712">arg2</span>&nbsp;<span class="op" id="3151717">...</span><span class="keyword" id="3151720">interface</span><span class="op" id="3151729">{</span><span class="op" id="3151730">}</span><span class="op" id="3151731">)</span>&nbsp;<span class="op" id="3151733">(</span><span class="builtintype" id="3151734">bool</span><span class="op" id="3151738">,</span>&nbsp;<span class="builtintype" id="3151740">error</span><span class="op" id="3151745">)</span>&nbsp;<span class="op" id="3151747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151750">v1</span>&nbsp;<span class="op" id="3151753">:=</span>&nbsp;<span class="ident" id="3151756">reflect</span><span class="op" id="3151763">.</span><span class="ident" id="3151764">ValueOf</span><span class="op" id="3151771">(</span><span class="ident" id="3151772">arg1</span><span class="op" id="3151776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151779">k1</span><span class="op" id="3151781">,</span>&nbsp;<span class="ident" id="3151783">err</span>&nbsp;<span class="op" id="3151787">:=</span>&nbsp;<span class="ident" id="3151790">basicKind</span><span class="op" id="3151799">(</span><span class="ident" id="3151800">v1</span><span class="op" id="3151802">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151805">if</span>&nbsp;<span class="ident" id="3151808">err</span>&nbsp;<span class="op" id="3151812">!=</span>&nbsp;<span class="ident" id="3151815">nil</span>&nbsp;<span class="op" id="3151819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151823">return</span>&nbsp;<span class="builtintype" id="3151830">false</span><span class="op" id="3151835">,</span>&nbsp;<span class="ident" id="3151837">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3151842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151845">if</span>&nbsp;<span class="builtinfunc" id="3151848">len</span><span class="op" id="3151851">(</span><span class="ident" id="3151852">arg2</span><span class="op" id="3151856">)</span>&nbsp;<span class="op" id="3151858">==</span>&nbsp;<span class="num" id="3151861">0</span>&nbsp;<span class="op" id="3151863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151867">return</span>&nbsp;<span class="builtintype" id="3151874">false</span><span class="op" id="3151879">,</span>&nbsp;<span class="ident" id="3151881">errNoComparison</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3151898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151901">for</span>&nbsp;<span class="ident" id="3151905">_</span><span class="op" id="3151906">,</span>&nbsp;<span class="ident" id="3151908">arg</span>&nbsp;<span class="op" id="3151912">:=</span>&nbsp;<span class="keyword" id="3151915">range</span>&nbsp;<span class="ident" id="3151921">arg2</span>&nbsp;<span class="op" id="3151926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151930">v2</span>&nbsp;<span class="op" id="3151933">:=</span>&nbsp;<span class="ident" id="3151936">reflect</span><span class="op" id="3151943">.</span><span class="ident" id="3151944">ValueOf</span><span class="op" id="3151951">(</span><span class="ident" id="3151952">arg</span><span class="op" id="3151955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151959">k2</span><span class="op" id="3151961">,</span>&nbsp;<span class="ident" id="3151963">err</span>&nbsp;<span class="op" id="3151967">:=</span>&nbsp;<span class="ident" id="3151970">basicKind</span><span class="op" id="3151979">(</span><span class="ident" id="3151980">v2</span><span class="op" id="3151982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151986">if</span>&nbsp;<span class="ident" id="3151989">err</span>&nbsp;<span class="op" id="3151993">!=</span>&nbsp;<span class="ident" id="3151996">nil</span>&nbsp;<span class="op" id="3152000">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152005">return</span>&nbsp;<span class="builtintype" id="3152012">false</span><span class="op" id="3152017">,</span>&nbsp;<span class="ident" id="3152019">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3152025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152029">truth</span>&nbsp;<span class="op" id="3152035">:=</span>&nbsp;<span class="builtintype" id="3152038">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152046">if</span>&nbsp;<span class="ident" id="3152049">k1</span>&nbsp;<span class="op" id="3152052">!=</span>&nbsp;<span class="ident" id="3152055">k2</span>&nbsp;<span class="op" id="3152058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3152063">//&nbsp;Special&nbsp;case:&nbsp;Can&nbsp;compare&nbsp;integer&nbsp;values&nbsp;regardless&nbsp;of&nbsp;type&#39;s&nbsp;sign.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152137">switch</span>&nbsp;<span class="op" id="3152144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152149">case</span>&nbsp;<span class="ident" id="3152154">k1</span>&nbsp;<span class="op" id="3152157">==</span>&nbsp;<span class="ident" id="3152160">intKind</span>&nbsp;<span class="op" id="3152168">&amp;&amp;</span>&nbsp;<span class="ident" id="3152171">k2</span>&nbsp;<span class="op" id="3152174">==</span>&nbsp;<span class="ident" id="3152177">uintKind</span><span class="op" id="3152185">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152191">truth</span>&nbsp;<span class="op" id="3152197">=</span>&nbsp;<span class="ident" id="3152199">v1</span><span class="op" id="3152201">.</span><span class="ident" id="3152202">Int</span><span class="op" id="3152205">(</span><span class="op" id="3152206">)</span>&nbsp;<span class="op" id="3152208">&gt;=</span>&nbsp;<span class="num" id="3152211">0</span>&nbsp;<span class="op" id="3152213">&amp;&amp;</span>&nbsp;<span class="ident" id="3152216">uint64</span><span class="op" id="3152222">(</span><span class="ident" id="3152223">v1</span><span class="op" id="3152225">.</span><span class="ident" id="3152226">Int</span><span class="op" id="3152229">(</span><span class="op" id="3152230">)</span><span class="op" id="3152231">)</span>&nbsp;<span class="op" id="3152233">==</span>&nbsp;<span class="ident" id="3152236">v2</span><span class="op" id="3152238">.</span><span class="ident" id="3152239">Uint</span><span class="op" id="3152243">(</span><span class="op" id="3152244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152249">case</span>&nbsp;<span class="ident" id="3152254">k1</span>&nbsp;<span class="op" id="3152257">==</span>&nbsp;<span class="ident" id="3152260">uintKind</span>&nbsp;<span class="op" id="3152269">&amp;&amp;</span>&nbsp;<span class="ident" id="3152272">k2</span>&nbsp;<span class="op" id="3152275">==</span>&nbsp;<span class="ident" id="3152278">intKind</span><span class="op" id="3152285">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152291">truth</span>&nbsp;<span class="op" id="3152297">=</span>&nbsp;<span class="ident" id="3152299">v2</span><span class="op" id="3152301">.</span><span class="ident" id="3152302">Int</span><span class="op" id="3152305">(</span><span class="op" id="3152306">)</span>&nbsp;<span class="op" id="3152308">&gt;=</span>&nbsp;<span class="num" id="3152311">0</span>&nbsp;<span class="op" id="3152313">&amp;&amp;</span>&nbsp;<span class="ident" id="3152316">v1</span><span class="op" id="3152318">.</span><span class="ident" id="3152319">Uint</span><span class="op" id="3152323">(</span><span class="op" id="3152324">)</span>&nbsp;<span class="op" id="3152326">==</span>&nbsp;<span class="ident" id="3152329">uint64</span><span class="op" id="3152335">(</span><span class="ident" id="3152336">v2</span><span class="op" id="3152338">.</span><span class="ident" id="3152339">Int</span><span class="op" id="3152342">(</span><span class="op" id="3152343">)</span><span class="op" id="3152344">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152349">default</span><span class="op" id="3152356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152362">return</span>&nbsp;<span class="builtintype" id="3152369">false</span><span class="op" id="3152374">,</span>&nbsp;<span class="ident" id="3152376">errBadComparison</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3152396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3152400">}</span>&nbsp;<span class="keyword" id="3152402">else</span>&nbsp;<span class="op" id="3152407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152412">switch</span>&nbsp;<span class="ident" id="3152419">k1</span>&nbsp;<span class="op" id="3152422">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152427">case</span>&nbsp;<span class="ident" id="3152432">boolKind</span><span class="op" id="3152440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152446">truth</span>&nbsp;<span class="op" id="3152452">=</span>&nbsp;<span class="ident" id="3152454">v1</span><span class="op" id="3152456">.</span><span class="ident" id="3152457">Bool</span><span class="op" id="3152461">(</span><span class="op" id="3152462">)</span>&nbsp;<span class="op" id="3152464">==</span>&nbsp;<span class="ident" id="3152467">v2</span><span class="op" id="3152469">.</span><span class="ident" id="3152470">Bool</span><span class="op" id="3152474">(</span><span class="op" id="3152475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152480">case</span>&nbsp;<span class="ident" id="3152485">complexKind</span><span class="op" id="3152496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152502">truth</span>&nbsp;<span class="op" id="3152508">=</span>&nbsp;<span class="ident" id="3152510">v1</span><span class="op" id="3152512">.</span><span class="ident" id="3152513">Complex</span><span class="op" id="3152520">(</span><span class="op" id="3152521">)</span>&nbsp;<span class="op" id="3152523">==</span>&nbsp;<span class="ident" id="3152526">v2</span><span class="op" id="3152528">.</span><span class="ident" id="3152529">Complex</span><span class="op" id="3152536">(</span><span class="op" id="3152537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152542">case</span>&nbsp;<span class="ident" id="3152547">floatKind</span><span class="op" id="3152556">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152562">truth</span>&nbsp;<span class="op" id="3152568">=</span>&nbsp;<span class="ident" id="3152570">v1</span><span class="op" id="3152572">.</span><span class="ident" id="3152573">Float</span><span class="op" id="3152578">(</span><span class="op" id="3152579">)</span>&nbsp;<span class="op" id="3152581">==</span>&nbsp;<span class="ident" id="3152584">v2</span><span class="op" id="3152586">.</span><span class="ident" id="3152587">Float</span><span class="op" id="3152592">(</span><span class="op" id="3152593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152598">case</span>&nbsp;<span class="ident" id="3152603">intKind</span><span class="op" id="3152610">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152616">truth</span>&nbsp;<span class="op" id="3152622">=</span>&nbsp;<span class="ident" id="3152624">v1</span><span class="op" id="3152626">.</span><span class="ident" id="3152627">Int</span><span class="op" id="3152630">(</span><span class="op" id="3152631">)</span>&nbsp;<span class="op" id="3152633">==</span>&nbsp;<span class="ident" id="3152636">v2</span><span class="op" id="3152638">.</span><span class="ident" id="3152639">Int</span><span class="op" id="3152642">(</span><span class="op" id="3152643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152648">case</span>&nbsp;<span class="ident" id="3152653">stringKind</span><span class="op" id="3152663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152669">truth</span>&nbsp;<span class="op" id="3152675">=</span>&nbsp;<span class="ident" id="3152677">v1</span><span class="op" id="3152679">.</span><span class="ident" id="3152680">String</span><span class="op" id="3152686">(</span><span class="op" id="3152687">)</span>&nbsp;<span class="op" id="3152689">==</span>&nbsp;<span class="ident" id="3152692">v2</span><span class="op" id="3152694">.</span><span class="ident" id="3152695">String</span><span class="op" id="3152701">(</span><span class="op" id="3152702">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152707">case</span>&nbsp;<span class="ident" id="3152712">uintKind</span><span class="op" id="3152720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152726">truth</span>&nbsp;<span class="op" id="3152732">=</span>&nbsp;<span class="ident" id="3152734">v1</span><span class="op" id="3152736">.</span><span class="ident" id="3152737">Uint</span><span class="op" id="3152741">(</span><span class="op" id="3152742">)</span>&nbsp;<span class="op" id="3152744">==</span>&nbsp;<span class="ident" id="3152747">v2</span><span class="op" id="3152749">.</span><span class="ident" id="3152750">Uint</span><span class="op" id="3152754">(</span><span class="op" id="3152755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152760">default</span><span class="op" id="3152767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3152773">panic</span><span class="op" id="3152778">(</span><span class="string" id="3152779">&#34;invalid&nbsp;kind&#34;</span><span class="op" id="3152793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3152798">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3152802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152806">if</span>&nbsp;<span class="ident" id="3152809">truth</span>&nbsp;<span class="op" id="3152815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152820">return</span>&nbsp;<span class="builtintype" id="3152827">true</span><span class="op" id="3152831">,</span>&nbsp;<span class="ident" id="3152833">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3152839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3152842">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152845">return</span>&nbsp;<span class="builtintype" id="3152852">false</span><span class="op" id="3152857">,</span>&nbsp;<span class="ident" id="3152859">nil</span><br>
<span class="lineno"></span><span class="op" id="3152863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3152866">//&nbsp;ne&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3152905">func</span>&nbsp;<span class="ident" id="3152910">ne</span><span class="op" id="3152912">(</span><span class="ident" id="3152913">arg1</span><span class="op" id="3152917">,</span>&nbsp;<span class="ident" id="3152919">arg2</span>&nbsp;<span class="keyword" id="3152924">interface</span><span class="op" id="3152933">{</span><span class="op" id="3152934">}</span><span class="op" id="3152935">)</span>&nbsp;<span class="op" id="3152937">(</span><span class="builtintype" id="3152938">bool</span><span class="op" id="3152942">,</span>&nbsp;<span class="builtintype" id="3152944">error</span><span class="op" id="3152949">)</span>&nbsp;<span class="op" id="3152951">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3152954">//&nbsp;!=&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;==.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152983">equal</span><span class="op" id="3152988">,</span>&nbsp;<span class="ident" id="3152990">err</span>&nbsp;<span class="op" id="3152994">:=</span>&nbsp;<span class="ident" id="3152997">eq</span><span class="op" id="3152999">(</span><span class="ident" id="3153000">arg1</span><span class="op" id="3153004">,</span>&nbsp;<span class="ident" id="3153006">arg2</span><span class="op" id="3153010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153013">return</span>&nbsp;<span class="op" id="3153020">!</span><span class="ident" id="3153021">equal</span><span class="op" id="3153026">,</span>&nbsp;<span class="ident" id="3153028">err</span><br>
<span class="lineno"></span><span class="op" id="3153032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="3153035">//&nbsp;lt&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&lt;&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3153073">func</span>&nbsp;<span class="ident" id="3153078">lt</span><span class="op" id="3153080">(</span><span class="ident" id="3153081">arg1</span><span class="op" id="3153085">,</span>&nbsp;<span class="ident" id="3153087">arg2</span>&nbsp;<span class="keyword" id="3153092">interface</span><span class="op" id="3153101">{</span><span class="op" id="3153102">}</span><span class="op" id="3153103">)</span>&nbsp;<span class="op" id="3153105">(</span><span class="builtintype" id="3153106">bool</span><span class="op" id="3153110">,</span>&nbsp;<span class="builtintype" id="3153112">error</span><span class="op" id="3153117">)</span>&nbsp;<span class="op" id="3153119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153122">v1</span>&nbsp;<span class="op" id="3153125">:=</span>&nbsp;<span class="ident" id="3153128">reflect</span><span class="op" id="3153135">.</span><span class="ident" id="3153136">ValueOf</span><span class="op" id="3153143">(</span><span class="ident" id="3153144">arg1</span><span class="op" id="3153148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153151">k1</span><span class="op" id="3153153">,</span>&nbsp;<span class="ident" id="3153155">err</span>&nbsp;<span class="op" id="3153159">:=</span>&nbsp;<span class="ident" id="3153162">basicKind</span><span class="op" id="3153171">(</span><span class="ident" id="3153172">v1</span><span class="op" id="3153174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153177">if</span>&nbsp;<span class="ident" id="3153180">err</span>&nbsp;<span class="op" id="3153184">!=</span>&nbsp;<span class="ident" id="3153187">nil</span>&nbsp;<span class="op" id="3153191">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153195">return</span>&nbsp;<span class="builtintype" id="3153202">false</span><span class="op" id="3153207">,</span>&nbsp;<span class="ident" id="3153209">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153217">v2</span>&nbsp;<span class="op" id="3153220">:=</span>&nbsp;<span class="ident" id="3153223">reflect</span><span class="op" id="3153230">.</span><span class="ident" id="3153231">ValueOf</span><span class="op" id="3153238">(</span><span class="ident" id="3153239">arg2</span><span class="op" id="3153243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153246">k2</span><span class="op" id="3153248">,</span>&nbsp;<span class="ident" id="3153250">err</span>&nbsp;<span class="op" id="3153254">:=</span>&nbsp;<span class="ident" id="3153257">basicKind</span><span class="op" id="3153266">(</span><span class="ident" id="3153267">v2</span><span class="op" id="3153269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153272">if</span>&nbsp;<span class="ident" id="3153275">err</span>&nbsp;<span class="op" id="3153279">!=</span>&nbsp;<span class="ident" id="3153282">nil</span>&nbsp;<span class="op" id="3153286">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153290">return</span>&nbsp;<span class="builtintype" id="3153297">false</span><span class="op" id="3153302">,</span>&nbsp;<span class="ident" id="3153304">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153312">truth</span>&nbsp;<span class="op" id="3153318">:=</span>&nbsp;<span class="builtintype" id="3153321">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153328">if</span>&nbsp;<span class="ident" id="3153331">k1</span>&nbsp;<span class="op" id="3153334">!=</span>&nbsp;<span class="ident" id="3153337">k2</span>&nbsp;<span class="op" id="3153340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3153344">//&nbsp;Special&nbsp;case:&nbsp;Can&nbsp;compare&nbsp;integer&nbsp;values&nbsp;regardless&nbsp;of&nbsp;type&#39;s&nbsp;sign.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153417">switch</span>&nbsp;<span class="op" id="3153424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153428">case</span>&nbsp;<span class="ident" id="3153433">k1</span>&nbsp;<span class="op" id="3153436">==</span>&nbsp;<span class="ident" id="3153439">intKind</span>&nbsp;<span class="op" id="3153447">&amp;&amp;</span>&nbsp;<span class="ident" id="3153450">k2</span>&nbsp;<span class="op" id="3153453">==</span>&nbsp;<span class="ident" id="3153456">uintKind</span><span class="op" id="3153464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153469">truth</span>&nbsp;<span class="op" id="3153475">=</span>&nbsp;<span class="ident" id="3153477">v1</span><span class="op" id="3153479">.</span><span class="ident" id="3153480">Int</span><span class="op" id="3153483">(</span><span class="op" id="3153484">)</span>&nbsp;<span class="op" id="3153486">&lt;</span>&nbsp;<span class="num" id="3153488">0</span>&nbsp;<span class="op" id="3153490">||</span>&nbsp;<span class="ident" id="3153493">uint64</span><span class="op" id="3153499">(</span><span class="ident" id="3153500">v1</span><span class="op" id="3153502">.</span><span class="ident" id="3153503">Int</span><span class="op" id="3153506">(</span><span class="op" id="3153507">)</span><span class="op" id="3153508">)</span>&nbsp;<span class="op" id="3153510">&lt;</span>&nbsp;<span class="ident" id="3153512">v2</span><span class="op" id="3153514">.</span><span class="ident" id="3153515">Uint</span><span class="op" id="3153519">(</span><span class="op" id="3153520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153524">case</span>&nbsp;<span class="ident" id="3153529">k1</span>&nbsp;<span class="op" id="3153532">==</span>&nbsp;<span class="ident" id="3153535">uintKind</span>&nbsp;<span class="op" id="3153544">&amp;&amp;</span>&nbsp;<span class="ident" id="3153547">k2</span>&nbsp;<span class="op" id="3153550">==</span>&nbsp;<span class="ident" id="3153553">intKind</span><span class="op" id="3153560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153565">truth</span>&nbsp;<span class="op" id="3153571">=</span>&nbsp;<span class="ident" id="3153573">v2</span><span class="op" id="3153575">.</span><span class="ident" id="3153576">Int</span><span class="op" id="3153579">(</span><span class="op" id="3153580">)</span>&nbsp;<span class="op" id="3153582">&gt;=</span>&nbsp;<span class="num" id="3153585">0</span>&nbsp;<span class="op" id="3153587">&amp;&amp;</span>&nbsp;<span class="ident" id="3153590">v1</span><span class="op" id="3153592">.</span><span class="ident" id="3153593">Uint</span><span class="op" id="3153597">(</span><span class="op" id="3153598">)</span>&nbsp;<span class="op" id="3153600">&lt;</span>&nbsp;<span class="ident" id="3153602">uint64</span><span class="op" id="3153608">(</span><span class="ident" id="3153609">v2</span><span class="op" id="3153611">.</span><span class="ident" id="3153612">Int</span><span class="op" id="3153615">(</span><span class="op" id="3153616">)</span><span class="op" id="3153617">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153621">default</span><span class="op" id="3153628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153633">return</span>&nbsp;<span class="builtintype" id="3153640">false</span><span class="op" id="3153645">,</span>&nbsp;<span class="ident" id="3153647">errBadComparison</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3153669">}</span>&nbsp;<span class="keyword" id="3153671">else</span>&nbsp;<span class="op" id="3153676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153680">switch</span>&nbsp;<span class="ident" id="3153687">k1</span>&nbsp;<span class="op" id="3153690">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153694">case</span>&nbsp;<span class="ident" id="3153699">boolKind</span><span class="op" id="3153707">,</span>&nbsp;<span class="ident" id="3153709">complexKind</span><span class="op" id="3153720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153725">return</span>&nbsp;<span class="builtintype" id="3153732">false</span><span class="op" id="3153737">,</span>&nbsp;<span class="ident" id="3153739">errBadComparisonType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153762">case</span>&nbsp;<span class="ident" id="3153767">floatKind</span><span class="op" id="3153776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153781">truth</span>&nbsp;<span class="op" id="3153787">=</span>&nbsp;<span class="ident" id="3153789">v1</span><span class="op" id="3153791">.</span><span class="ident" id="3153792">Float</span><span class="op" id="3153797">(</span><span class="op" id="3153798">)</span>&nbsp;<span class="op" id="3153800">&lt;</span>&nbsp;<span class="ident" id="3153802">v2</span><span class="op" id="3153804">.</span><span class="ident" id="3153805">Float</span><span class="op" id="3153810">(</span><span class="op" id="3153811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153815">case</span>&nbsp;<span class="ident" id="3153820">intKind</span><span class="op" id="3153827">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153832">truth</span>&nbsp;<span class="op" id="3153838">=</span>&nbsp;<span class="ident" id="3153840">v1</span><span class="op" id="3153842">.</span><span class="ident" id="3153843">Int</span><span class="op" id="3153846">(</span><span class="op" id="3153847">)</span>&nbsp;<span class="op" id="3153849">&lt;</span>&nbsp;<span class="ident" id="3153851">v2</span><span class="op" id="3153853">.</span><span class="ident" id="3153854">Int</span><span class="op" id="3153857">(</span><span class="op" id="3153858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153862">case</span>&nbsp;<span class="ident" id="3153867">stringKind</span><span class="op" id="3153877">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153882">truth</span>&nbsp;<span class="op" id="3153888">=</span>&nbsp;<span class="ident" id="3153890">v1</span><span class="op" id="3153892">.</span><span class="ident" id="3153893">String</span><span class="op" id="3153899">(</span><span class="op" id="3153900">)</span>&nbsp;<span class="op" id="3153902">&lt;</span>&nbsp;<span class="ident" id="3153904">v2</span><span class="op" id="3153906">.</span><span class="ident" id="3153907">String</span><span class="op" id="3153913">(</span><span class="op" id="3153914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153918">case</span>&nbsp;<span class="ident" id="3153923">uintKind</span><span class="op" id="3153931">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153936">truth</span>&nbsp;<span class="op" id="3153942">=</span>&nbsp;<span class="ident" id="3153944">v1</span><span class="op" id="3153946">.</span><span class="ident" id="3153947">Uint</span><span class="op" id="3153951">(</span><span class="op" id="3153952">)</span>&nbsp;<span class="op" id="3153954">&lt;</span>&nbsp;<span class="ident" id="3153956">v2</span><span class="op" id="3153958">.</span><span class="ident" id="3153959">Uint</span><span class="op" id="3153963">(</span><span class="op" id="3153964">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3153968">default</span><span class="op" id="3153975">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3153980">panic</span><span class="op" id="3153985">(</span><span class="string" id="3153986">&#34;invalid&nbsp;kind&#34;</span><span class="op" id="3154000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154010">return</span>&nbsp;<span class="ident" id="3154017">truth</span><span class="op" id="3154022">,</span>&nbsp;<span class="ident" id="3154024">nil</span><br>
<span class="lineno">400</span><span class="op" id="3154028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3154031">//&nbsp;le&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;&lt;=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3154068">func</span>&nbsp;<span class="ident" id="3154073">le</span><span class="op" id="3154075">(</span><span class="ident" id="3154076">arg1</span><span class="op" id="3154080">,</span>&nbsp;<span class="ident" id="3154082">arg2</span>&nbsp;<span class="keyword" id="3154087">interface</span><span class="op" id="3154096">{</span><span class="op" id="3154097">}</span><span class="op" id="3154098">)</span>&nbsp;<span class="op" id="3154100">(</span><span class="builtintype" id="3154101">bool</span><span class="op" id="3154105">,</span>&nbsp;<span class="builtintype" id="3154107">error</span><span class="op" id="3154112">)</span>&nbsp;<span class="op" id="3154114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3154117">//&nbsp;&lt;=&nbsp;is&nbsp;&lt;&nbsp;or&nbsp;==.</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154136">lessThan</span><span class="op" id="3154144">,</span>&nbsp;<span class="ident" id="3154146">err</span>&nbsp;<span class="op" id="3154150">:=</span>&nbsp;<span class="ident" id="3154153">lt</span><span class="op" id="3154155">(</span><span class="ident" id="3154156">arg1</span><span class="op" id="3154160">,</span>&nbsp;<span class="ident" id="3154162">arg2</span><span class="op" id="3154166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154169">if</span>&nbsp;<span class="ident" id="3154172">lessThan</span>&nbsp;<span class="op" id="3154181">||</span>&nbsp;<span class="ident" id="3154184">err</span>&nbsp;<span class="op" id="3154188">!=</span>&nbsp;<span class="ident" id="3154191">nil</span>&nbsp;<span class="op" id="3154195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154199">return</span>&nbsp;<span class="ident" id="3154206">lessThan</span><span class="op" id="3154214">,</span>&nbsp;<span class="ident" id="3154216">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154224">return</span>&nbsp;<span class="ident" id="3154231">eq</span><span class="op" id="3154233">(</span><span class="ident" id="3154234">arg1</span><span class="op" id="3154238">,</span>&nbsp;<span class="ident" id="3154240">arg2</span><span class="op" id="3154244">)</span><br>
<span class="lineno">410</span><span class="op" id="3154246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3154249">//&nbsp;gt&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&gt;&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3154287">func</span>&nbsp;<span class="ident" id="3154292">gt</span><span class="op" id="3154294">(</span><span class="ident" id="3154295">arg1</span><span class="op" id="3154299">,</span>&nbsp;<span class="ident" id="3154301">arg2</span>&nbsp;<span class="keyword" id="3154306">interface</span><span class="op" id="3154315">{</span><span class="op" id="3154316">}</span><span class="op" id="3154317">)</span>&nbsp;<span class="op" id="3154319">(</span><span class="builtintype" id="3154320">bool</span><span class="op" id="3154324">,</span>&nbsp;<span class="builtintype" id="3154326">error</span><span class="op" id="3154331">)</span>&nbsp;<span class="op" id="3154333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3154336">//&nbsp;&gt;&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;&lt;=.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154364">lessOrEqual</span><span class="op" id="3154375">,</span>&nbsp;<span class="ident" id="3154377">err</span>&nbsp;<span class="op" id="3154381">:=</span>&nbsp;<span class="ident" id="3154384">le</span><span class="op" id="3154386">(</span><span class="ident" id="3154387">arg1</span><span class="op" id="3154391">,</span>&nbsp;<span class="ident" id="3154393">arg2</span><span class="op" id="3154397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154400">if</span>&nbsp;<span class="ident" id="3154403">err</span>&nbsp;<span class="op" id="3154407">!=</span>&nbsp;<span class="ident" id="3154410">nil</span>&nbsp;<span class="op" id="3154414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154418">return</span>&nbsp;<span class="builtintype" id="3154425">false</span><span class="op" id="3154430">,</span>&nbsp;<span class="ident" id="3154432">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154440">return</span>&nbsp;<span class="op" id="3154447">!</span><span class="ident" id="3154448">lessOrEqual</span><span class="op" id="3154459">,</span>&nbsp;<span class="ident" id="3154461">nil</span><br>
<span class="lineno">420</span><span class="op" id="3154465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3154468">//&nbsp;ge&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&gt;=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3154507">func</span>&nbsp;<span class="ident" id="3154512">ge</span><span class="op" id="3154514">(</span><span class="ident" id="3154515">arg1</span><span class="op" id="3154519">,</span>&nbsp;<span class="ident" id="3154521">arg2</span>&nbsp;<span class="keyword" id="3154526">interface</span><span class="op" id="3154535">{</span><span class="op" id="3154536">}</span><span class="op" id="3154537">)</span>&nbsp;<span class="op" id="3154539">(</span><span class="builtintype" id="3154540">bool</span><span class="op" id="3154544">,</span>&nbsp;<span class="builtintype" id="3154546">error</span><span class="op" id="3154551">)</span>&nbsp;<span class="op" id="3154553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3154556">//&nbsp;&gt;=&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;&lt;.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154584">lessThan</span><span class="op" id="3154592">,</span>&nbsp;<span class="ident" id="3154594">err</span>&nbsp;<span class="op" id="3154598">:=</span>&nbsp;<span class="ident" id="3154601">lt</span><span class="op" id="3154603">(</span><span class="ident" id="3154604">arg1</span><span class="op" id="3154608">,</span>&nbsp;<span class="ident" id="3154610">arg2</span><span class="op" id="3154614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154617">if</span>&nbsp;<span class="ident" id="3154620">err</span>&nbsp;<span class="op" id="3154624">!=</span>&nbsp;<span class="ident" id="3154627">nil</span>&nbsp;<span class="op" id="3154631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154635">return</span>&nbsp;<span class="builtintype" id="3154642">false</span><span class="op" id="3154647">,</span>&nbsp;<span class="ident" id="3154649">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154657">return</span>&nbsp;<span class="op" id="3154664">!</span><span class="ident" id="3154665">lessThan</span><span class="op" id="3154673">,</span>&nbsp;<span class="ident" id="3154675">nil</span><br>
<span class="lineno">430</span><span class="op" id="3154679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3154682">//&nbsp;HTML&nbsp;escaping.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3154701">var</span>&nbsp;<span class="op" id="3154705">(</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154708">htmlQuot</span>&nbsp;<span class="op" id="3154717">=</span>&nbsp;<span class="op" id="3154719">[</span><span class="op" id="3154720">]</span><span class="builtintype" id="3154721">byte</span><span class="op" id="3154725">(</span><span class="string" id="3154726">&#34;&amp;#34;&#34;</span><span class="op" id="3154733">)</span>&nbsp;<span class="comment" id="3154735">//&nbsp;shorter&nbsp;than&nbsp;&#34;&amp;quot;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154761">htmlApos</span>&nbsp;<span class="op" id="3154770">=</span>&nbsp;<span class="op" id="3154772">[</span><span class="op" id="3154773">]</span><span class="builtintype" id="3154774">byte</span><span class="op" id="3154778">(</span><span class="string" id="3154779">&#34;&amp;#39;&#34;</span><span class="op" id="3154786">)</span>&nbsp;<span class="comment" id="3154788">//&nbsp;shorter&nbsp;than&nbsp;&#34;&amp;apos;&#34;&nbsp;and&nbsp;apos&nbsp;was&nbsp;not&nbsp;in&nbsp;HTML&nbsp;until&nbsp;HTML5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154851">htmlAmp</span>&nbsp;&nbsp;<span class="op" id="3154860">=</span>&nbsp;<span class="op" id="3154862">[</span><span class="op" id="3154863">]</span><span class="builtintype" id="3154864">byte</span><span class="op" id="3154868">(</span><span class="string" id="3154869">&#34;&amp;amp;&#34;</span><span class="op" id="3154876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154879">htmlLt</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3154888">=</span>&nbsp;<span class="op" id="3154890">[</span><span class="op" id="3154891">]</span><span class="builtintype" id="3154892">byte</span><span class="op" id="3154896">(</span><span class="string" id="3154897">&#34;&amp;lt;&#34;</span><span class="op" id="3154903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154906">htmlGt</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3154915">=</span>&nbsp;<span class="op" id="3154917">[</span><span class="op" id="3154918">]</span><span class="builtintype" id="3154919">byte</span><span class="op" id="3154923">(</span><span class="string" id="3154924">&#34;&amp;gt;&#34;</span><span class="op" id="3154930">)</span><br>
<span class="lineno">440</span><span class="op" id="3154932">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3154935">//&nbsp;HTMLEscape&nbsp;writes&nbsp;to&nbsp;w&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3155015">func</span>&nbsp;<span class="ident" id="3155020">HTMLEscape</span><span class="op" id="3155030">(</span><span class="ident" id="3155031">w</span>&nbsp;<span class="ident" id="3155033">io</span><span class="op" id="3155035">.</span><span class="ident" id="3155036">Writer</span><span class="op" id="3155042">,</span>&nbsp;<span class="ident" id="3155044">b</span>&nbsp;<span class="op" id="3155046">[</span><span class="op" id="3155047">]</span><span class="builtintype" id="3155048">byte</span><span class="op" id="3155052">)</span>&nbsp;<span class="op" id="3155054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155057">last</span>&nbsp;<span class="op" id="3155062">:=</span>&nbsp;<span class="num" id="3155065">0</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155068">for</span>&nbsp;<span class="ident" id="3155072">i</span><span class="op" id="3155073">,</span>&nbsp;<span class="ident" id="3155075">c</span>&nbsp;<span class="op" id="3155077">:=</span>&nbsp;<span class="keyword" id="3155080">range</span>&nbsp;<span class="ident" id="3155086">b</span>&nbsp;<span class="op" id="3155088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155092">var</span>&nbsp;<span class="ident" id="3155096">html</span>&nbsp;<span class="op" id="3155101">[</span><span class="op" id="3155102">]</span><span class="builtintype" id="3155103">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155110">switch</span>&nbsp;<span class="ident" id="3155117">c</span>&nbsp;<span class="op" id="3155119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155123">case</span>&nbsp;<span class="string" id="3155128">&#39;&#34;&#39;</span><span class="op" id="3155131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155136">html</span>&nbsp;<span class="op" id="3155141">=</span>&nbsp;<span class="ident" id="3155143">htmlQuot</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155154">case</span>&nbsp;<span class="string" id="3155159">&#39;\&#39;&#39;</span><span class="op" id="3155163">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155168">html</span>&nbsp;<span class="op" id="3155173">=</span>&nbsp;<span class="ident" id="3155175">htmlApos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155186">case</span>&nbsp;<span class="string" id="3155191">&#39;&amp;&#39;</span><span class="op" id="3155194">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155199">html</span>&nbsp;<span class="op" id="3155204">=</span>&nbsp;<span class="ident" id="3155206">htmlAmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155216">case</span>&nbsp;<span class="string" id="3155221">&#39;&lt;&#39;</span><span class="op" id="3155224">:</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155229">html</span>&nbsp;<span class="op" id="3155234">=</span>&nbsp;<span class="ident" id="3155236">htmlLt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155245">case</span>&nbsp;<span class="string" id="3155250">&#39;&gt;&#39;</span><span class="op" id="3155253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155258">html</span>&nbsp;<span class="op" id="3155263">=</span>&nbsp;<span class="ident" id="3155265">htmlGt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155274">default</span><span class="op" id="3155281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155286">continue</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3155297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155301">w</span><span class="op" id="3155302">.</span><span class="ident" id="3155303">Write</span><span class="op" id="3155308">(</span><span class="ident" id="3155309">b</span><span class="op" id="3155310">[</span><span class="ident" id="3155311">last</span><span class="op" id="3155315">:</span><span class="ident" id="3155316">i</span><span class="op" id="3155317">]</span><span class="op" id="3155318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155322">w</span><span class="op" id="3155323">.</span><span class="ident" id="3155324">Write</span><span class="op" id="3155329">(</span><span class="ident" id="3155330">html</span><span class="op" id="3155334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155338">last</span>&nbsp;<span class="op" id="3155343">=</span>&nbsp;<span class="ident" id="3155345">i</span>&nbsp;<span class="op" id="3155347">+</span>&nbsp;<span class="num" id="3155349">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3155352">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155355">w</span><span class="op" id="3155356">.</span><span class="ident" id="3155357">Write</span><span class="op" id="3155362">(</span><span class="ident" id="3155363">b</span><span class="op" id="3155364">[</span><span class="ident" id="3155365">last</span><span class="op" id="3155369">:</span><span class="op" id="3155370">]</span><span class="op" id="3155371">)</span><br>
<span class="lineno"></span><span class="op" id="3155373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3155376">//&nbsp;HTMLEscapeString&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3155458">func</span>&nbsp;<span class="ident" id="3155463">HTMLEscapeString</span><span class="op" id="3155479">(</span><span class="ident" id="3155480">s</span>&nbsp;<span class="builtintype" id="3155482">string</span><span class="op" id="3155488">)</span>&nbsp;<span class="builtintype" id="3155490">string</span>&nbsp;<span class="op" id="3155497">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3155500">//&nbsp;Avoid&nbsp;allocation&nbsp;if&nbsp;we&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155532">if</span>&nbsp;<span class="ident" id="3155535">strings</span><span class="op" id="3155542">.</span><span class="ident" id="3155543">IndexAny</span><span class="op" id="3155551">(</span><span class="ident" id="3155552">s</span><span class="op" id="3155553">,</span>&nbsp;<span class="string" id="3155555">`&#39;&#34;&amp;&lt;&gt;`</span><span class="op" id="3155562">)</span>&nbsp;<span class="op" id="3155564">&lt;</span>&nbsp;<span class="num" id="3155566">0</span>&nbsp;<span class="op" id="3155568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155572">return</span>&nbsp;<span class="ident" id="3155579">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3155582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155585">var</span>&nbsp;<span class="ident" id="3155589">b</span>&nbsp;<span class="ident" id="3155591">bytes</span><span class="op" id="3155596">.</span><span class="ident" id="3155597">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155605">HTMLEscape</span><span class="op" id="3155615">(</span><span class="op" id="3155616">&amp;</span><span class="ident" id="3155617">b</span><span class="op" id="3155618">,</span>&nbsp;<span class="op" id="3155620">[</span><span class="op" id="3155621">]</span><span class="builtintype" id="3155622">byte</span><span class="op" id="3155626">(</span><span class="ident" id="3155627">s</span><span class="op" id="3155628">)</span><span class="op" id="3155629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155632">return</span>&nbsp;<span class="ident" id="3155639">b</span><span class="op" id="3155640">.</span><span class="ident" id="3155641">String</span><span class="op" id="3155647">(</span><span class="op" id="3155648">)</span><br>
<span class="lineno"></span><span class="op" id="3155650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3155653">//&nbsp;HTMLEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;textual</span><br>
<span class="lineno">480</span><span class="comment" id="3155719">//&nbsp;representation&nbsp;of&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="keyword" id="3155755">func</span>&nbsp;<span class="ident" id="3155760">HTMLEscaper</span><span class="op" id="3155771">(</span><span class="ident" id="3155772">args</span>&nbsp;<span class="op" id="3155777">...</span><span class="keyword" id="3155780">interface</span><span class="op" id="3155789">{</span><span class="op" id="3155790">}</span><span class="op" id="3155791">)</span>&nbsp;<span class="builtintype" id="3155793">string</span>&nbsp;<span class="op" id="3155800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155803">return</span>&nbsp;<span class="ident" id="3155810">HTMLEscapeString</span><span class="op" id="3155826">(</span><span class="ident" id="3155827">evalArgs</span><span class="op" id="3155835">(</span><span class="ident" id="3155836">args</span><span class="op" id="3155840">)</span><span class="op" id="3155841">)</span><br>
<span class="lineno"></span><span class="op" id="3155843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="3155846">//&nbsp;JavaScript&nbsp;escaping.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3155871">var</span>&nbsp;<span class="op" id="3155875">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155878">jsLowUni</span>&nbsp;<span class="op" id="3155887">=</span>&nbsp;<span class="op" id="3155889">[</span><span class="op" id="3155890">]</span><span class="builtintype" id="3155891">byte</span><span class="op" id="3155895">(</span><span class="string" id="3155896">`\u00`</span><span class="op" id="3155902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155905">hex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3155914">=</span>&nbsp;<span class="op" id="3155916">[</span><span class="op" id="3155917">]</span><span class="builtintype" id="3155918">byte</span><span class="op" id="3155922">(</span><span class="string" id="3155923">&#34;0123456789ABCDEF&#34;</span><span class="op" id="3155941">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155945">jsBackslash</span>&nbsp;<span class="op" id="3155957">=</span>&nbsp;<span class="op" id="3155959">[</span><span class="op" id="3155960">]</span><span class="builtintype" id="3155961">byte</span><span class="op" id="3155965">(</span><span class="string" id="3155966">`\\`</span><span class="op" id="3155970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155973">jsApos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3155985">=</span>&nbsp;<span class="op" id="3155987">[</span><span class="op" id="3155988">]</span><span class="builtintype" id="3155989">byte</span><span class="op" id="3155993">(</span><span class="string" id="3155994">`\&#39;`</span><span class="op" id="3155998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156001">jsQuot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156013">=</span>&nbsp;<span class="op" id="3156015">[</span><span class="op" id="3156016">]</span><span class="builtintype" id="3156017">byte</span><span class="op" id="3156021">(</span><span class="string" id="3156022">`\&#34;`</span><span class="op" id="3156026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156029">jsLt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156041">=</span>&nbsp;<span class="op" id="3156043">[</span><span class="op" id="3156044">]</span><span class="builtintype" id="3156045">byte</span><span class="op" id="3156049">(</span><span class="string" id="3156050">`\x3C`</span><span class="op" id="3156056">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156059">jsGt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3156071">=</span>&nbsp;<span class="op" id="3156073">[</span><span class="op" id="3156074">]</span><span class="builtintype" id="3156075">byte</span><span class="op" id="3156079">(</span><span class="string" id="3156080">`\x3E`</span><span class="op" id="3156086">)</span><br>
<span class="lineno"></span><span class="op" id="3156088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3156091">//&nbsp;JSEscape&nbsp;writes&nbsp;to&nbsp;w&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3156175">func</span>&nbsp;<span class="ident" id="3156180">JSEscape</span><span class="op" id="3156188">(</span><span class="ident" id="3156189">w</span>&nbsp;<span class="ident" id="3156191">io</span><span class="op" id="3156193">.</span><span class="ident" id="3156194">Writer</span><span class="op" id="3156200">,</span>&nbsp;<span class="ident" id="3156202">b</span>&nbsp;<span class="op" id="3156204">[</span><span class="op" id="3156205">]</span><span class="builtintype" id="3156206">byte</span><span class="op" id="3156210">)</span>&nbsp;<span class="op" id="3156212">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156215">last</span>&nbsp;<span class="op" id="3156220">:=</span>&nbsp;<span class="num" id="3156223">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156226">for</span>&nbsp;<span class="ident" id="3156230">i</span>&nbsp;<span class="op" id="3156232">:=</span>&nbsp;<span class="num" id="3156235">0</span><span class="op" id="3156236">;</span>&nbsp;<span class="ident" id="3156238">i</span>&nbsp;<span class="op" id="3156240">&lt;</span>&nbsp;<span class="builtinfunc" id="3156242">len</span><span class="op" id="3156245">(</span><span class="ident" id="3156246">b</span><span class="op" id="3156247">)</span><span class="op" id="3156248">;</span>&nbsp;<span class="ident" id="3156250">i</span><span class="op" id="3156251">++</span>&nbsp;<span class="op" id="3156254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156258">c</span>&nbsp;<span class="op" id="3156260">:=</span>&nbsp;<span class="ident" id="3156263">b</span><span class="op" id="3156264">[</span><span class="ident" id="3156265">i</span><span class="op" id="3156266">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156271">if</span>&nbsp;<span class="op" id="3156274">!</span><span class="ident" id="3156275">jsIsSpecial</span><span class="op" id="3156286">(</span><span class="builtintype" id="3156287">rune</span><span class="op" id="3156291">(</span><span class="ident" id="3156292">c</span><span class="op" id="3156293">)</span><span class="op" id="3156294">)</span>&nbsp;<span class="op" id="3156296">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156301">//&nbsp;fast&nbsp;path:&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156332">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156347">w</span><span class="op" id="3156348">.</span><span class="ident" id="3156349">Write</span><span class="op" id="3156354">(</span><span class="ident" id="3156355">b</span><span class="op" id="3156356">[</span><span class="ident" id="3156357">last</span><span class="op" id="3156361">:</span><span class="ident" id="3156362">i</span><span class="op" id="3156363">]</span><span class="op" id="3156364">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156369">if</span>&nbsp;<span class="ident" id="3156372">c</span>&nbsp;<span class="op" id="3156374">&lt;</span>&nbsp;<span class="ident" id="3156376">utf8</span><span class="op" id="3156380">.</span><span class="ident" id="3156381">RuneSelf</span>&nbsp;<span class="op" id="3156390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156395">//&nbsp;Quotes,&nbsp;slashes&nbsp;and&nbsp;angle&nbsp;brackets&nbsp;get&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156448">//&nbsp;Control&nbsp;characters&nbsp;get&nbsp;written&nbsp;as&nbsp;\u00XX.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156496">switch</span>&nbsp;<span class="ident" id="3156503">c</span>&nbsp;<span class="op" id="3156505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156510">case</span>&nbsp;<span class="string" id="3156515">&#39;\\&#39;</span><span class="op" id="3156519">:</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156525">w</span><span class="op" id="3156526">.</span><span class="ident" id="3156527">Write</span><span class="op" id="3156532">(</span><span class="ident" id="3156533">jsBackslash</span><span class="op" id="3156544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156549">case</span>&nbsp;<span class="string" id="3156554">&#39;\&#39;&#39;</span><span class="op" id="3156558">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156564">w</span><span class="op" id="3156565">.</span><span class="ident" id="3156566">Write</span><span class="op" id="3156571">(</span><span class="ident" id="3156572">jsApos</span><span class="op" id="3156578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156583">case</span>&nbsp;<span class="string" id="3156588">&#39;&#34;&#39;</span><span class="op" id="3156591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156597">w</span><span class="op" id="3156598">.</span><span class="ident" id="3156599">Write</span><span class="op" id="3156604">(</span><span class="ident" id="3156605">jsQuot</span><span class="op" id="3156611">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156616">case</span>&nbsp;<span class="string" id="3156621">&#39;&lt;&#39;</span><span class="op" id="3156624">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156630">w</span><span class="op" id="3156631">.</span><span class="ident" id="3156632">Write</span><span class="op" id="3156637">(</span><span class="ident" id="3156638">jsLt</span><span class="op" id="3156642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156647">case</span>&nbsp;<span class="string" id="3156652">&#39;&gt;&#39;</span><span class="op" id="3156655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156661">w</span><span class="op" id="3156662">.</span><span class="ident" id="3156663">Write</span><span class="op" id="3156668">(</span><span class="ident" id="3156669">jsGt</span><span class="op" id="3156673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156678">default</span><span class="op" id="3156685">:</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156691">w</span><span class="op" id="3156692">.</span><span class="ident" id="3156693">Write</span><span class="op" id="3156698">(</span><span class="ident" id="3156699">jsLowUni</span><span class="op" id="3156707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156713">t</span><span class="op" id="3156714">,</span>&nbsp;<span class="ident" id="3156716">b</span>&nbsp;<span class="op" id="3156718">:=</span>&nbsp;<span class="ident" id="3156721">c</span><span class="op" id="3156722">&gt;&gt;</span><span class="num" id="3156724">4</span><span class="op" id="3156725">,</span>&nbsp;<span class="ident" id="3156727">c</span><span class="op" id="3156728">&amp;</span><span class="num" id="3156729">0x0f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156738">w</span><span class="op" id="3156739">.</span><span class="ident" id="3156740">Write</span><span class="op" id="3156745">(</span><span class="ident" id="3156746">hex</span><span class="op" id="3156749">[</span><span class="ident" id="3156750">t</span>&nbsp;<span class="op" id="3156752">:</span>&nbsp;<span class="ident" id="3156754">t</span><span class="op" id="3156755">+</span><span class="num" id="3156756">1</span><span class="op" id="3156757">]</span><span class="op" id="3156758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156764">w</span><span class="op" id="3156765">.</span><span class="ident" id="3156766">Write</span><span class="op" id="3156771">(</span><span class="ident" id="3156772">hex</span><span class="op" id="3156775">[</span><span class="ident" id="3156776">b</span>&nbsp;<span class="op" id="3156778">:</span>&nbsp;<span class="ident" id="3156780">b</span><span class="op" id="3156781">+</span><span class="num" id="3156782">1</span><span class="op" id="3156783">]</span><span class="op" id="3156784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156789">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156793">}</span>&nbsp;<span class="keyword" id="3156795">else</span>&nbsp;<span class="op" id="3156800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156805">//&nbsp;Unicode&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156825">r</span><span class="op" id="3156826">,</span>&nbsp;<span class="ident" id="3156828">size</span>&nbsp;<span class="op" id="3156833">:=</span>&nbsp;<span class="ident" id="3156836">utf8</span><span class="op" id="3156840">.</span><span class="ident" id="3156841">DecodeRune</span><span class="op" id="3156851">(</span><span class="ident" id="3156852">b</span><span class="op" id="3156853">[</span><span class="ident" id="3156854">i</span><span class="op" id="3156855">:</span><span class="op" id="3156856">]</span><span class="op" id="3156857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156862">if</span>&nbsp;<span class="ident" id="3156865">unicode</span><span class="op" id="3156872">.</span><span class="ident" id="3156873">IsPrint</span><span class="op" id="3156880">(</span><span class="ident" id="3156881">r</span><span class="op" id="3156882">)</span>&nbsp;<span class="op" id="3156884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156890">w</span><span class="op" id="3156891">.</span><span class="ident" id="3156892">Write</span><span class="op" id="3156897">(</span><span class="ident" id="3156898">b</span><span class="op" id="3156899">[</span><span class="ident" id="3156900">i</span>&nbsp;<span class="op" id="3156902">:</span>&nbsp;<span class="ident" id="3156904">i</span><span class="op" id="3156905">+</span><span class="ident" id="3156906">size</span><span class="op" id="3156910">]</span><span class="op" id="3156911">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156916">}</span>&nbsp;<span class="keyword" id="3156918">else</span>&nbsp;<span class="op" id="3156923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156929">fmt</span><span class="op" id="3156932">.</span><span class="ident" id="3156933">Fprintf</span><span class="op" id="3156940">(</span><span class="ident" id="3156941">w</span><span class="op" id="3156942">,</span>&nbsp;<span class="string" id="3156944">&#34;\\u%04X&#34;</span><span class="op" id="3156953">,</span>&nbsp;<span class="ident" id="3156955">r</span><span class="op" id="3156956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156966">i</span>&nbsp;<span class="op" id="3156968">+=</span>&nbsp;<span class="ident" id="3156971">size</span>&nbsp;<span class="op" id="3156976">-</span>&nbsp;<span class="num" id="3156978">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156982">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156986">last</span>&nbsp;<span class="op" id="3156991">=</span>&nbsp;<span class="ident" id="3156993">i</span>&nbsp;<span class="op" id="3156995">+</span>&nbsp;<span class="num" id="3156997">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157003">w</span><span class="op" id="3157004">.</span><span class="ident" id="3157005">Write</span><span class="op" id="3157010">(</span><span class="ident" id="3157011">b</span><span class="op" id="3157012">[</span><span class="ident" id="3157013">last</span><span class="op" id="3157017">:</span><span class="op" id="3157018">]</span><span class="op" id="3157019">)</span><br>
<span class="lineno"></span><span class="op" id="3157021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="3157024">//&nbsp;JSEscapeString&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3157110">func</span>&nbsp;<span class="ident" id="3157115">JSEscapeString</span><span class="op" id="3157129">(</span><span class="ident" id="3157130">s</span>&nbsp;<span class="builtintype" id="3157132">string</span><span class="op" id="3157138">)</span>&nbsp;<span class="builtintype" id="3157140">string</span>&nbsp;<span class="op" id="3157147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3157150">//&nbsp;Avoid&nbsp;allocation&nbsp;if&nbsp;we&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157182">if</span>&nbsp;<span class="ident" id="3157185">strings</span><span class="op" id="3157192">.</span><span class="ident" id="3157193">IndexFunc</span><span class="op" id="3157202">(</span><span class="ident" id="3157203">s</span><span class="op" id="3157204">,</span>&nbsp;<span class="ident" id="3157206">jsIsSpecial</span><span class="op" id="3157217">)</span>&nbsp;<span class="op" id="3157219">&lt;</span>&nbsp;<span class="num" id="3157221">0</span>&nbsp;<span class="op" id="3157223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157227">return</span>&nbsp;<span class="ident" id="3157234">s</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157240">var</span>&nbsp;<span class="ident" id="3157244">b</span>&nbsp;<span class="ident" id="3157246">bytes</span><span class="op" id="3157251">.</span><span class="ident" id="3157252">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157260">JSEscape</span><span class="op" id="3157268">(</span><span class="op" id="3157269">&amp;</span><span class="ident" id="3157270">b</span><span class="op" id="3157271">,</span>&nbsp;<span class="op" id="3157273">[</span><span class="op" id="3157274">]</span><span class="builtintype" id="3157275">byte</span><span class="op" id="3157279">(</span><span class="ident" id="3157280">s</span><span class="op" id="3157281">)</span><span class="op" id="3157282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157285">return</span>&nbsp;<span class="ident" id="3157292">b</span><span class="op" id="3157293">.</span><span class="ident" id="3157294">String</span><span class="op" id="3157300">(</span><span class="op" id="3157301">)</span><br>
<span class="lineno"></span><span class="op" id="3157303">}</span><br>
<span class="lineno">555</span><br>
<span class="lineno"></span><span class="keyword" id="3157306">func</span>&nbsp;<span class="ident" id="3157311">jsIsSpecial</span><span class="op" id="3157322">(</span><span class="ident" id="3157323">r</span>&nbsp;<span class="builtintype" id="3157325">rune</span><span class="op" id="3157329">)</span>&nbsp;<span class="builtintype" id="3157331">bool</span>&nbsp;<span class="op" id="3157336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157339">switch</span>&nbsp;<span class="ident" id="3157346">r</span>&nbsp;<span class="op" id="3157348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157351">case</span>&nbsp;<span class="string" id="3157356">&#39;\\&#39;</span><span class="op" id="3157360">,</span>&nbsp;<span class="string" id="3157362">&#39;\&#39;&#39;</span><span class="op" id="3157366">,</span>&nbsp;<span class="string" id="3157368">&#39;&#34;&#39;</span><span class="op" id="3157371">,</span>&nbsp;<span class="string" id="3157373">&#39;&lt;&#39;</span><span class="op" id="3157376">,</span>&nbsp;<span class="string" id="3157378">&#39;&gt;&#39;</span><span class="op" id="3157381">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157385">return</span>&nbsp;<span class="builtintype" id="3157392">true</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157401">return</span>&nbsp;<span class="ident" id="3157408">r</span>&nbsp;<span class="op" id="3157410">&lt;</span>&nbsp;<span class="string" id="3157412">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3157416">||</span>&nbsp;<span class="ident" id="3157419">utf8</span><span class="op" id="3157423">.</span><span class="ident" id="3157424">RuneSelf</span>&nbsp;<span class="op" id="3157433">&lt;=</span>&nbsp;<span class="ident" id="3157436">r</span><br>
<span class="lineno"></span><span class="op" id="3157438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3157441">//&nbsp;JSEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;textual</span><br>
<span class="lineno">565</span><span class="comment" id="3157511">//&nbsp;representation&nbsp;of&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="keyword" id="3157547">func</span>&nbsp;<span class="ident" id="3157552">JSEscaper</span><span class="op" id="3157561">(</span><span class="ident" id="3157562">args</span>&nbsp;<span class="op" id="3157567">...</span><span class="keyword" id="3157570">interface</span><span class="op" id="3157579">{</span><span class="op" id="3157580">}</span><span class="op" id="3157581">)</span>&nbsp;<span class="builtintype" id="3157583">string</span>&nbsp;<span class="op" id="3157590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157593">return</span>&nbsp;<span class="ident" id="3157600">JSEscapeString</span><span class="op" id="3157614">(</span><span class="ident" id="3157615">evalArgs</span><span class="op" id="3157623">(</span><span class="ident" id="3157624">args</span><span class="op" id="3157628">)</span><span class="op" id="3157629">)</span><br>
<span class="lineno"></span><span class="op" id="3157631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="comment" id="3157634">//&nbsp;URLQueryEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;value&nbsp;of&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3157712">//&nbsp;its&nbsp;arguments&nbsp;in&nbsp;a&nbsp;form&nbsp;suitable&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;URL&nbsp;query.</span><br>
<span class="lineno"></span><span class="keyword" id="3157778">func</span>&nbsp;<span class="ident" id="3157783">URLQueryEscaper</span><span class="op" id="3157798">(</span><span class="ident" id="3157799">args</span>&nbsp;<span class="op" id="3157804">...</span><span class="keyword" id="3157807">interface</span><span class="op" id="3157816">{</span><span class="op" id="3157817">}</span><span class="op" id="3157818">)</span>&nbsp;<span class="builtintype" id="3157820">string</span>&nbsp;<span class="op" id="3157827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157830">return</span>&nbsp;<span class="ident" id="3157837">url</span><span class="op" id="3157840">.</span><span class="ident" id="3157841">QueryEscape</span><span class="op" id="3157852">(</span><span class="ident" id="3157853">evalArgs</span><span class="op" id="3157861">(</span><span class="ident" id="3157862">args</span><span class="op" id="3157866">)</span><span class="op" id="3157867">)</span><br>
<span class="lineno"></span><span class="op" id="3157869">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="3157872">//&nbsp;evalArgs&nbsp;formats&nbsp;the&nbsp;list&nbsp;of&nbsp;arguments&nbsp;into&nbsp;a&nbsp;string.&nbsp;It&nbsp;is&nbsp;therefore&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3157959">//&nbsp;&nbsp;&nbsp;&nbspfmt.Sprint(args...)</span><br>
<span class="lineno"></span><span class="comment" id="3157982">//&nbsp;except&nbsp;that&nbsp;each&nbsp;argument&nbsp;is&nbsp;indirected&nbsp;(if&nbsp;a&nbsp;pointer),&nbsp;as&nbsp;required,</span><br>
<span class="lineno"></span><span class="comment" id="3158054">//&nbsp;using&nbsp;the&nbsp;same&nbsp;rules&nbsp;as&nbsp;the&nbsp;default&nbsp;string&nbsp;evaluation&nbsp;during&nbsp;template</span><br>
<span class="lineno">580</span><span class="comment" id="3158127">//&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="3158141">func</span>&nbsp;<span class="ident" id="3158146">evalArgs</span><span class="op" id="3158154">(</span><span class="ident" id="3158155">args</span>&nbsp;<span class="op" id="3158160">[</span><span class="op" id="3158161">]</span><span class="keyword" id="3158162">interface</span><span class="op" id="3158171">{</span><span class="op" id="3158172">}</span><span class="op" id="3158173">)</span>&nbsp;<span class="builtintype" id="3158175">string</span>&nbsp;<span class="op" id="3158182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158185">ok</span>&nbsp;<span class="op" id="3158188">:=</span>&nbsp;<span class="builtintype" id="3158191">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158198">var</span>&nbsp;<span class="ident" id="3158202">s</span>&nbsp;<span class="builtintype" id="3158204">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3158212">//&nbsp;Fast&nbsp;path&nbsp;for&nbsp;simple&nbsp;common&nbsp;case.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158250">if</span>&nbsp;<span class="builtinfunc" id="3158253">len</span><span class="op" id="3158256">(</span><span class="ident" id="3158257">args</span><span class="op" id="3158261">)</span>&nbsp;<span class="op" id="3158263">==</span>&nbsp;<span class="num" id="3158266">1</span>&nbsp;<span class="op" id="3158268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158272">s</span><span class="op" id="3158273">,</span>&nbsp;<span class="ident" id="3158275">ok</span>&nbsp;<span class="op" id="3158278">=</span>&nbsp;<span class="ident" id="3158280">args</span><span class="op" id="3158284">[</span><span class="num" id="3158285">0</span><span class="op" id="3158286">]</span><span class="op" id="3158287">.</span><span class="op" id="3158288">(</span><span class="builtintype" id="3158289">string</span><span class="op" id="3158295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3158298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158301">if</span>&nbsp;<span class="op" id="3158304">!</span><span class="ident" id="3158305">ok</span>&nbsp;<span class="op" id="3158308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158312">for</span>&nbsp;<span class="ident" id="3158316">i</span><span class="op" id="3158317">,</span>&nbsp;<span class="ident" id="3158319">arg</span>&nbsp;<span class="op" id="3158323">:=</span>&nbsp;<span class="keyword" id="3158326">range</span>&nbsp;<span class="ident" id="3158332">args</span>&nbsp;<span class="op" id="3158337">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158342">a</span><span class="op" id="3158343">,</span>&nbsp;<span class="ident" id="3158345">ok</span>&nbsp;<span class="op" id="3158348">:=</span>&nbsp;<span class="ident" id="3158351">printableValue</span><span class="op" id="3158365">(</span><span class="ident" id="3158366">reflect</span><span class="op" id="3158373">.</span><span class="ident" id="3158374">ValueOf</span><span class="op" id="3158381">(</span><span class="ident" id="3158382">arg</span><span class="op" id="3158385">)</span><span class="op" id="3158386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158391">if</span>&nbsp;<span class="ident" id="3158394">ok</span>&nbsp;<span class="op" id="3158397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158403">args</span><span class="op" id="3158407">[</span><span class="ident" id="3158408">i</span><span class="op" id="3158409">]</span>&nbsp;<span class="op" id="3158411">=</span>&nbsp;<span class="ident" id="3158413">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3158418">}</span>&nbsp;<span class="comment" id="3158420">//&nbsp;else&nbsp;left&nbsp;fmt&nbsp;do&nbsp;its&nbsp;thing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3158452">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158456">s</span>&nbsp;<span class="op" id="3158458">=</span>&nbsp;<span class="ident" id="3158460">fmt</span><span class="op" id="3158463">.</span><span class="ident" id="3158464">Sprint</span><span class="op" id="3158470">(</span><span class="ident" id="3158471">args</span><span class="op" id="3158475">...</span><span class="op" id="3158478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3158481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158484">return</span>&nbsp;<span class="ident" id="3158491">s</span><br>
<span class="lineno"></span><span class="op" id="3158493">}</span>
</div>
</body>
</html>
