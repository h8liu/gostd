<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html" class="current">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7405072">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7405128">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7405182">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7405233">package</span>&nbsp;<span class="ident" id="7405241">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7405247">import</span>&nbsp;<span class="op" id="7405254">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7405257">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7405266">&#34;math&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7405274">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7405287">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7405298">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7405308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="7405311">//&nbsp;Tests&nbsp;of&nbsp;simple&nbsp;examples.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7405341">type</span>&nbsp;<span class="ident" id="7405346">example</span>&nbsp;<span class="keyword" id="7405354">struct</span>&nbsp;<span class="op" id="7405361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405364">compact</span>&nbsp;<span class="builtintype" id="7405372">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405380">indent</span>&nbsp;&nbsp;<span class="builtintype" id="7405388">string</span><br>
<span class="lineno">20</span><span class="op" id="7405395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7405398">var</span>&nbsp;<span class="ident" id="7405402">examples</span>&nbsp;<span class="op" id="7405411">=</span>&nbsp;<span class="op" id="7405413">[</span><span class="op" id="7405414">]</span><span class="ident" id="7405415">example</span><span class="op" id="7405422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7405425">{</span><span class="string" id="7405426">`1`</span><span class="op" id="7405429">,</span>&nbsp;<span class="string" id="7405431">`1`</span><span class="op" id="7405434">}</span><span class="op" id="7405435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7405438">{</span><span class="string" id="7405439">`{}`</span><span class="op" id="7405443">,</span>&nbsp;<span class="string" id="7405445">`{}`</span><span class="op" id="7405449">}</span><span class="op" id="7405450">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7405453">{</span><span class="string" id="7405454">`[]`</span><span class="op" id="7405458">,</span>&nbsp;<span class="string" id="7405460">`[]`</span><span class="op" id="7405464">}</span><span class="op" id="7405465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7405468">{</span><span class="string" id="7405469">`{&#34;&#34;:2}`</span><span class="op" id="7405477">,</span>&nbsp;<span class="string" id="7405479">&#34;{\n\t\&#34;\&#34;:&nbsp;2\n}&#34;</span><span class="op" id="7405496">}</span><span class="op" id="7405497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7405500">{</span><span class="string" id="7405501">`[3]`</span><span class="op" id="7405506">,</span>&nbsp;<span class="string" id="7405508">&#34;[\n\t3\n]&#34;</span><span class="op" id="7405519">}</span><span class="op" id="7405520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7405523">{</span><span class="string" id="7405524">`[1,2,3]`</span><span class="op" id="7405533">,</span>&nbsp;<span class="string" id="7405535">&#34;[\n\t1,\n\t2,\n\t3\n]&#34;</span><span class="op" id="7405558">}</span><span class="op" id="7405559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7405562">{</span><span class="string" id="7405563">`{&#34;x&#34;:1}`</span><span class="op" id="7405572">,</span>&nbsp;<span class="string" id="7405574">&#34;{\n\t\&#34;x\&#34;:&nbsp;1\n}&#34;</span><span class="op" id="7405592">}</span><span class="op" id="7405593">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7405596">{</span><span class="ident" id="7405597">ex1</span><span class="op" id="7405600">,</span>&nbsp;<span class="ident" id="7405602">ex1i</span><span class="op" id="7405606">}</span><span class="op" id="7405607">,</span><br>
<span class="lineno"></span><span class="op" id="7405609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7405612">var</span>&nbsp;<span class="ident" id="7405616">ex1</span>&nbsp;<span class="op" id="7405620">=</span>&nbsp;<span class="string" id="7405622">`[true,false,null,&#34;x&#34;,1,1.5,0,-5e+2]`</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7405661">var</span>&nbsp;<span class="ident" id="7405665">ex1i</span>&nbsp;<span class="op" id="7405670">=</span>&nbsp;<span class="string" id="7405672">`[<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;true,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;false,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;null,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&#34;x&#34;,<br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;1,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;1.5,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;0,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;-5e+2<br>
<span class="lineno"></span>]`</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7405728">func</span>&nbsp;<span class="ident" id="7405733">TestCompact</span><span class="op" id="7405744">(</span><span class="ident" id="7405745">t</span>&nbsp;<span class="op" id="7405747">*</span><span class="ident" id="7405748">testing</span><span class="op" id="7405755">.</span><span class="ident" id="7405756">T</span><span class="op" id="7405757">)</span>&nbsp;<span class="op" id="7405759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7405762">var</span>&nbsp;<span class="ident" id="7405766">buf</span>&nbsp;<span class="ident" id="7405770">bytes</span><span class="op" id="7405775">.</span><span class="ident" id="7405776">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7405784">for</span>&nbsp;<span class="ident" id="7405788">_</span><span class="op" id="7405789">,</span>&nbsp;<span class="ident" id="7405791">tt</span>&nbsp;<span class="op" id="7405794">:=</span>&nbsp;<span class="keyword" id="7405797">range</span>&nbsp;<span class="ident" id="7405803">examples</span>&nbsp;<span class="op" id="7405812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405816">buf</span><span class="op" id="7405819">.</span><span class="ident" id="7405820">Reset</span><span class="op" id="7405825">(</span><span class="op" id="7405826">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7405830">if</span>&nbsp;<span class="ident" id="7405833">err</span>&nbsp;<span class="op" id="7405837">:=</span>&nbsp;<span class="ident" id="7405840">Compact</span><span class="op" id="7405847">(</span><span class="op" id="7405848">&amp;</span><span class="ident" id="7405849">buf</span><span class="op" id="7405852">,</span>&nbsp;<span class="op" id="7405854">[</span><span class="op" id="7405855">]</span><span class="builtintype" id="7405856">byte</span><span class="op" id="7405860">(</span><span class="ident" id="7405861">tt</span><span class="op" id="7405863">.</span><span class="ident" id="7405864">compact</span><span class="op" id="7405871">)</span><span class="op" id="7405872">)</span><span class="op" id="7405873">;</span>&nbsp;<span class="ident" id="7405875">err</span>&nbsp;<span class="op" id="7405879">!=</span>&nbsp;<span class="ident" id="7405882">nil</span>&nbsp;<span class="op" id="7405886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405891">t</span><span class="op" id="7405892">.</span><span class="ident" id="7405893">Errorf</span><span class="op" id="7405899">(</span><span class="string" id="7405900">&#34;Compact(%#q):&nbsp;%v&#34;</span><span class="op" id="7405918">,</span>&nbsp;<span class="ident" id="7405920">tt</span><span class="op" id="7405922">.</span><span class="ident" id="7405923">compact</span><span class="op" id="7405930">,</span>&nbsp;<span class="ident" id="7405932">err</span><span class="op" id="7405935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7405939">}</span>&nbsp;<span class="keyword" id="7405941">else</span>&nbsp;<span class="keyword" id="7405946">if</span>&nbsp;<span class="ident" id="7405949">s</span>&nbsp;<span class="op" id="7405951">:=</span>&nbsp;<span class="ident" id="7405954">buf</span><span class="op" id="7405957">.</span><span class="ident" id="7405958">String</span><span class="op" id="7405964">(</span><span class="op" id="7405965">)</span><span class="op" id="7405966">;</span>&nbsp;<span class="ident" id="7405968">s</span>&nbsp;<span class="op" id="7405970">!=</span>&nbsp;<span class="ident" id="7405973">tt</span><span class="op" id="7405975">.</span><span class="ident" id="7405976">compact</span>&nbsp;<span class="op" id="7405984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405989">t</span><span class="op" id="7405990">.</span><span class="ident" id="7405991">Errorf</span><span class="op" id="7405997">(</span><span class="string" id="7405998">&#34;Compact(%#q)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;original&#34;</span><span class="op" id="7406033">,</span>&nbsp;<span class="ident" id="7406035">tt</span><span class="op" id="7406037">.</span><span class="ident" id="7406038">compact</span><span class="op" id="7406045">,</span>&nbsp;<span class="ident" id="7406047">s</span><span class="op" id="7406048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406052">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406057">buf</span><span class="op" id="7406060">.</span><span class="ident" id="7406061">Reset</span><span class="op" id="7406066">(</span><span class="op" id="7406067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406071">if</span>&nbsp;<span class="ident" id="7406074">err</span>&nbsp;<span class="op" id="7406078">:=</span>&nbsp;<span class="ident" id="7406081">Compact</span><span class="op" id="7406088">(</span><span class="op" id="7406089">&amp;</span><span class="ident" id="7406090">buf</span><span class="op" id="7406093">,</span>&nbsp;<span class="op" id="7406095">[</span><span class="op" id="7406096">]</span><span class="builtintype" id="7406097">byte</span><span class="op" id="7406101">(</span><span class="ident" id="7406102">tt</span><span class="op" id="7406104">.</span><span class="ident" id="7406105">indent</span><span class="op" id="7406111">)</span><span class="op" id="7406112">)</span><span class="op" id="7406113">;</span>&nbsp;<span class="ident" id="7406115">err</span>&nbsp;<span class="op" id="7406119">!=</span>&nbsp;<span class="ident" id="7406122">nil</span>&nbsp;<span class="op" id="7406126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406131">t</span><span class="op" id="7406132">.</span><span class="ident" id="7406133">Errorf</span><span class="op" id="7406139">(</span><span class="string" id="7406140">&#34;Compact(%#q):&nbsp;%v&#34;</span><span class="op" id="7406158">,</span>&nbsp;<span class="ident" id="7406160">tt</span><span class="op" id="7406162">.</span><span class="ident" id="7406163">indent</span><span class="op" id="7406169">,</span>&nbsp;<span class="ident" id="7406171">err</span><span class="op" id="7406174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406179">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406190">}</span>&nbsp;<span class="keyword" id="7406192">else</span>&nbsp;<span class="keyword" id="7406197">if</span>&nbsp;<span class="ident" id="7406200">s</span>&nbsp;<span class="op" id="7406202">:=</span>&nbsp;<span class="ident" id="7406205">buf</span><span class="op" id="7406208">.</span><span class="ident" id="7406209">String</span><span class="op" id="7406215">(</span><span class="op" id="7406216">)</span><span class="op" id="7406217">;</span>&nbsp;<span class="ident" id="7406219">s</span>&nbsp;<span class="op" id="7406221">!=</span>&nbsp;<span class="ident" id="7406224">tt</span><span class="op" id="7406226">.</span><span class="ident" id="7406227">compact</span>&nbsp;<span class="op" id="7406235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406240">t</span><span class="op" id="7406241">.</span><span class="ident" id="7406242">Errorf</span><span class="op" id="7406248">(</span><span class="string" id="7406249">&#34;Compact(%#q)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="7406279">,</span>&nbsp;<span class="ident" id="7406281">tt</span><span class="op" id="7406283">.</span><span class="ident" id="7406284">indent</span><span class="op" id="7406290">,</span>&nbsp;<span class="ident" id="7406292">s</span><span class="op" id="7406293">,</span>&nbsp;<span class="ident" id="7406295">tt</span><span class="op" id="7406297">.</span><span class="ident" id="7406298">compact</span><span class="op" id="7406305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406312">}</span><br>
<span class="lineno"></span><span class="op" id="7406314">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="7406317">func</span>&nbsp;<span class="ident" id="7406322">TestCompactSeparators</span><span class="op" id="7406343">(</span><span class="ident" id="7406344">t</span>&nbsp;<span class="op" id="7406346">*</span><span class="ident" id="7406347">testing</span><span class="op" id="7406354">.</span><span class="ident" id="7406355">T</span><span class="op" id="7406356">)</span>&nbsp;<span class="op" id="7406358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7406361">//&nbsp;U+2028&nbsp;and&nbsp;U+2029&nbsp;should&nbsp;be&nbsp;escaped&nbsp;inside&nbsp;strings.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7406417">//&nbsp;They&nbsp;should&nbsp;not&nbsp;appear&nbsp;outside&nbsp;strings.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406461">tests</span>&nbsp;<span class="op" id="7406467">:=</span>&nbsp;<span class="op" id="7406470">[</span><span class="op" id="7406471">]</span><span class="keyword" id="7406472">struct</span>&nbsp;<span class="op" id="7406479">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406483">in</span><span class="op" id="7406485">,</span>&nbsp;<span class="ident" id="7406487">compact</span>&nbsp;<span class="builtintype" id="7406495">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406503">}</span><span class="op" id="7406504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406508">{</span><span class="string" id="7406509">&#34;{\&#34;\u2028\&#34;:&nbsp;1}&#34;</span><span class="op" id="7406526">,</span>&nbsp;<span class="string" id="7406528">`{&#34;\u2028&#34;:1}`</span><span class="op" id="7406542">}</span><span class="op" id="7406543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406547">{</span><span class="string" id="7406548">&#34;{\&#34;\u2029\&#34;&nbsp;:2}&#34;</span><span class="op" id="7406565">,</span>&nbsp;<span class="string" id="7406567">`{&#34;\u2029&#34;:2}`</span><span class="op" id="7406581">}</span><span class="op" id="7406582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406585">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406588">for</span>&nbsp;<span class="ident" id="7406592">_</span><span class="op" id="7406593">,</span>&nbsp;<span class="ident" id="7406595">tt</span>&nbsp;<span class="op" id="7406598">:=</span>&nbsp;<span class="keyword" id="7406601">range</span>&nbsp;<span class="ident" id="7406607">tests</span>&nbsp;<span class="op" id="7406613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406617">var</span>&nbsp;<span class="ident" id="7406621">buf</span>&nbsp;<span class="ident" id="7406625">bytes</span><span class="op" id="7406630">.</span><span class="ident" id="7406631">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406640">if</span>&nbsp;<span class="ident" id="7406643">err</span>&nbsp;<span class="op" id="7406647">:=</span>&nbsp;<span class="ident" id="7406650">Compact</span><span class="op" id="7406657">(</span><span class="op" id="7406658">&amp;</span><span class="ident" id="7406659">buf</span><span class="op" id="7406662">,</span>&nbsp;<span class="op" id="7406664">[</span><span class="op" id="7406665">]</span><span class="builtintype" id="7406666">byte</span><span class="op" id="7406670">(</span><span class="ident" id="7406671">tt</span><span class="op" id="7406673">.</span><span class="ident" id="7406674">in</span><span class="op" id="7406676">)</span><span class="op" id="7406677">)</span><span class="op" id="7406678">;</span>&nbsp;<span class="ident" id="7406680">err</span>&nbsp;<span class="op" id="7406684">!=</span>&nbsp;<span class="ident" id="7406687">nil</span>&nbsp;<span class="op" id="7406691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406696">t</span><span class="op" id="7406697">.</span><span class="ident" id="7406698">Errorf</span><span class="op" id="7406704">(</span><span class="string" id="7406705">&#34;Compact(%q):&nbsp;%v&#34;</span><span class="op" id="7406722">,</span>&nbsp;<span class="ident" id="7406724">tt</span><span class="op" id="7406726">.</span><span class="ident" id="7406727">in</span><span class="op" id="7406729">,</span>&nbsp;<span class="ident" id="7406731">err</span><span class="op" id="7406734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406738">}</span>&nbsp;<span class="keyword" id="7406740">else</span>&nbsp;<span class="keyword" id="7406745">if</span>&nbsp;<span class="ident" id="7406748">s</span>&nbsp;<span class="op" id="7406750">:=</span>&nbsp;<span class="ident" id="7406753">buf</span><span class="op" id="7406756">.</span><span class="ident" id="7406757">String</span><span class="op" id="7406763">(</span><span class="op" id="7406764">)</span><span class="op" id="7406765">;</span>&nbsp;<span class="ident" id="7406767">s</span>&nbsp;<span class="op" id="7406769">!=</span>&nbsp;<span class="ident" id="7406772">tt</span><span class="op" id="7406774">.</span><span class="ident" id="7406775">compact</span>&nbsp;<span class="op" id="7406783">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406788">t</span><span class="op" id="7406789">.</span><span class="ident" id="7406790">Errorf</span><span class="op" id="7406796">(</span><span class="string" id="7406797">&#34;Compact(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7406824">,</span>&nbsp;<span class="ident" id="7406826">tt</span><span class="op" id="7406828">.</span><span class="ident" id="7406829">in</span><span class="op" id="7406831">,</span>&nbsp;<span class="ident" id="7406833">s</span><span class="op" id="7406834">,</span>&nbsp;<span class="ident" id="7406836">tt</span><span class="op" id="7406838">.</span><span class="ident" id="7406839">compact</span><span class="op" id="7406846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406853">}</span><br>
<span class="lineno"></span><span class="op" id="7406855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="7406858">func</span>&nbsp;<span class="ident" id="7406863">TestIndent</span><span class="op" id="7406873">(</span><span class="ident" id="7406874">t</span>&nbsp;<span class="op" id="7406876">*</span><span class="ident" id="7406877">testing</span><span class="op" id="7406884">.</span><span class="ident" id="7406885">T</span><span class="op" id="7406886">)</span>&nbsp;<span class="op" id="7406888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406891">var</span>&nbsp;<span class="ident" id="7406895">buf</span>&nbsp;<span class="ident" id="7406899">bytes</span><span class="op" id="7406904">.</span><span class="ident" id="7406905">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406913">for</span>&nbsp;<span class="ident" id="7406917">_</span><span class="op" id="7406918">,</span>&nbsp;<span class="ident" id="7406920">tt</span>&nbsp;<span class="op" id="7406923">:=</span>&nbsp;<span class="keyword" id="7406926">range</span>&nbsp;<span class="ident" id="7406932">examples</span>&nbsp;<span class="op" id="7406941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406945">buf</span><span class="op" id="7406948">.</span><span class="ident" id="7406949">Reset</span><span class="op" id="7406954">(</span><span class="op" id="7406955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406959">if</span>&nbsp;<span class="ident" id="7406962">err</span>&nbsp;<span class="op" id="7406966">:=</span>&nbsp;<span class="ident" id="7406969">Indent</span><span class="op" id="7406975">(</span><span class="op" id="7406976">&amp;</span><span class="ident" id="7406977">buf</span><span class="op" id="7406980">,</span>&nbsp;<span class="op" id="7406982">[</span><span class="op" id="7406983">]</span><span class="builtintype" id="7406984">byte</span><span class="op" id="7406988">(</span><span class="ident" id="7406989">tt</span><span class="op" id="7406991">.</span><span class="ident" id="7406992">indent</span><span class="op" id="7406998">)</span><span class="op" id="7406999">,</span>&nbsp;<span class="string" id="7407001">&#34;&#34;</span><span class="op" id="7407003">,</span>&nbsp;<span class="string" id="7407005">&#34;\t&#34;</span><span class="op" id="7407009">)</span><span class="op" id="7407010">;</span>&nbsp;<span class="ident" id="7407012">err</span>&nbsp;<span class="op" id="7407016">!=</span>&nbsp;<span class="ident" id="7407019">nil</span>&nbsp;<span class="op" id="7407023">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407028">t</span><span class="op" id="7407029">.</span><span class="ident" id="7407030">Errorf</span><span class="op" id="7407036">(</span><span class="string" id="7407037">&#34;Indent(%#q):&nbsp;%v&#34;</span><span class="op" id="7407054">,</span>&nbsp;<span class="ident" id="7407056">tt</span><span class="op" id="7407058">.</span><span class="ident" id="7407059">indent</span><span class="op" id="7407065">,</span>&nbsp;<span class="ident" id="7407067">err</span><span class="op" id="7407070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407074">}</span>&nbsp;<span class="keyword" id="7407076">else</span>&nbsp;<span class="keyword" id="7407081">if</span>&nbsp;<span class="ident" id="7407084">s</span>&nbsp;<span class="op" id="7407086">:=</span>&nbsp;<span class="ident" id="7407089">buf</span><span class="op" id="7407092">.</span><span class="ident" id="7407093">String</span><span class="op" id="7407099">(</span><span class="op" id="7407100">)</span><span class="op" id="7407101">;</span>&nbsp;<span class="ident" id="7407103">s</span>&nbsp;<span class="op" id="7407105">!=</span>&nbsp;<span class="ident" id="7407108">tt</span><span class="op" id="7407110">.</span><span class="ident" id="7407111">indent</span>&nbsp;<span class="op" id="7407118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407123">t</span><span class="op" id="7407124">.</span><span class="ident" id="7407125">Errorf</span><span class="op" id="7407131">(</span><span class="string" id="7407132">&#34;Indent(%#q)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;original&#34;</span><span class="op" id="7407166">,</span>&nbsp;<span class="ident" id="7407168">tt</span><span class="op" id="7407170">.</span><span class="ident" id="7407171">indent</span><span class="op" id="7407177">,</span>&nbsp;<span class="ident" id="7407179">s</span><span class="op" id="7407180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407189">buf</span><span class="op" id="7407192">.</span><span class="ident" id="7407193">Reset</span><span class="op" id="7407198">(</span><span class="op" id="7407199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407203">if</span>&nbsp;<span class="ident" id="7407206">err</span>&nbsp;<span class="op" id="7407210">:=</span>&nbsp;<span class="ident" id="7407213">Indent</span><span class="op" id="7407219">(</span><span class="op" id="7407220">&amp;</span><span class="ident" id="7407221">buf</span><span class="op" id="7407224">,</span>&nbsp;<span class="op" id="7407226">[</span><span class="op" id="7407227">]</span><span class="builtintype" id="7407228">byte</span><span class="op" id="7407232">(</span><span class="ident" id="7407233">tt</span><span class="op" id="7407235">.</span><span class="ident" id="7407236">compact</span><span class="op" id="7407243">)</span><span class="op" id="7407244">,</span>&nbsp;<span class="string" id="7407246">&#34;&#34;</span><span class="op" id="7407248">,</span>&nbsp;<span class="string" id="7407250">&#34;\t&#34;</span><span class="op" id="7407254">)</span><span class="op" id="7407255">;</span>&nbsp;<span class="ident" id="7407257">err</span>&nbsp;<span class="op" id="7407261">!=</span>&nbsp;<span class="ident" id="7407264">nil</span>&nbsp;<span class="op" id="7407268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407273">t</span><span class="op" id="7407274">.</span><span class="ident" id="7407275">Errorf</span><span class="op" id="7407281">(</span><span class="string" id="7407282">&#34;Indent(%#q):&nbsp;%v&#34;</span><span class="op" id="7407299">,</span>&nbsp;<span class="ident" id="7407301">tt</span><span class="op" id="7407303">.</span><span class="ident" id="7407304">compact</span><span class="op" id="7407311">,</span>&nbsp;<span class="ident" id="7407313">err</span><span class="op" id="7407316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407321">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407332">}</span>&nbsp;<span class="keyword" id="7407334">else</span>&nbsp;<span class="keyword" id="7407339">if</span>&nbsp;<span class="ident" id="7407342">s</span>&nbsp;<span class="op" id="7407344">:=</span>&nbsp;<span class="ident" id="7407347">buf</span><span class="op" id="7407350">.</span><span class="ident" id="7407351">String</span><span class="op" id="7407357">(</span><span class="op" id="7407358">)</span><span class="op" id="7407359">;</span>&nbsp;<span class="ident" id="7407361">s</span>&nbsp;<span class="op" id="7407363">!=</span>&nbsp;<span class="ident" id="7407366">tt</span><span class="op" id="7407368">.</span><span class="ident" id="7407369">indent</span>&nbsp;<span class="op" id="7407376">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407381">t</span><span class="op" id="7407382">.</span><span class="ident" id="7407383">Errorf</span><span class="op" id="7407389">(</span><span class="string" id="7407390">&#34;Indent(%#q)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="7407419">,</span>&nbsp;<span class="ident" id="7407421">tt</span><span class="op" id="7407423">.</span><span class="ident" id="7407424">compact</span><span class="op" id="7407431">,</span>&nbsp;<span class="ident" id="7407433">s</span><span class="op" id="7407434">,</span>&nbsp;<span class="ident" id="7407436">tt</span><span class="op" id="7407438">.</span><span class="ident" id="7407439">indent</span><span class="op" id="7407445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407452">}</span><br>
<span class="lineno"></span><span class="op" id="7407454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="7407457">//&nbsp;Tests&nbsp;of&nbsp;a&nbsp;large&nbsp;random&nbsp;structure.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7407496">func</span>&nbsp;<span class="ident" id="7407501">TestCompactBig</span><span class="op" id="7407515">(</span><span class="ident" id="7407516">t</span>&nbsp;<span class="op" id="7407518">*</span><span class="ident" id="7407519">testing</span><span class="op" id="7407526">.</span><span class="ident" id="7407527">T</span><span class="op" id="7407528">)</span>&nbsp;<span class="op" id="7407530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407533">initBig</span><span class="op" id="7407540">(</span><span class="op" id="7407541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407544">var</span>&nbsp;<span class="ident" id="7407548">buf</span>&nbsp;<span class="ident" id="7407552">bytes</span><span class="op" id="7407557">.</span><span class="ident" id="7407558">Buffer</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407566">if</span>&nbsp;<span class="ident" id="7407569">err</span>&nbsp;<span class="op" id="7407573">:=</span>&nbsp;<span class="ident" id="7407576">Compact</span><span class="op" id="7407583">(</span><span class="op" id="7407584">&amp;</span><span class="ident" id="7407585">buf</span><span class="op" id="7407588">,</span>&nbsp;<span class="ident" id="7407590">jsonBig</span><span class="op" id="7407597">)</span><span class="op" id="7407598">;</span>&nbsp;<span class="ident" id="7407600">err</span>&nbsp;<span class="op" id="7407604">!=</span>&nbsp;<span class="ident" id="7407607">nil</span>&nbsp;<span class="op" id="7407611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407615">t</span><span class="op" id="7407616">.</span><span class="ident" id="7407617">Fatalf</span><span class="op" id="7407623">(</span><span class="string" id="7407624">&#34;Compact:&nbsp;%v&#34;</span><span class="op" id="7407637">,</span>&nbsp;<span class="ident" id="7407639">err</span><span class="op" id="7407642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407648">b</span>&nbsp;<span class="op" id="7407650">:=</span>&nbsp;<span class="ident" id="7407653">buf</span><span class="op" id="7407656">.</span><span class="ident" id="7407657">Bytes</span><span class="op" id="7407662">(</span><span class="op" id="7407663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407666">if</span>&nbsp;<span class="op" id="7407669">!</span><span class="ident" id="7407670">bytes</span><span class="op" id="7407675">.</span><span class="ident" id="7407676">Equal</span><span class="op" id="7407681">(</span><span class="ident" id="7407682">b</span><span class="op" id="7407683">,</span>&nbsp;<span class="ident" id="7407685">jsonBig</span><span class="op" id="7407692">)</span>&nbsp;<span class="op" id="7407694">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407698">t</span><span class="op" id="7407699">.</span><span class="ident" id="7407700">Error</span><span class="op" id="7407705">(</span><span class="string" id="7407706">&#34;Compact(jsonBig)&nbsp;!=&nbsp;jsonBig&#34;</span><span class="op" id="7407735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407739">diff</span><span class="op" id="7407743">(</span><span class="ident" id="7407744">t</span><span class="op" id="7407745">,</span>&nbsp;<span class="ident" id="7407747">b</span><span class="op" id="7407748">,</span>&nbsp;<span class="ident" id="7407750">jsonBig</span><span class="op" id="7407757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407761">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407769">}</span><br>
<span class="lineno"></span><span class="op" id="7407771">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7407774">func</span>&nbsp;<span class="ident" id="7407779">TestIndentBig</span><span class="op" id="7407792">(</span><span class="ident" id="7407793">t</span>&nbsp;<span class="op" id="7407795">*</span><span class="ident" id="7407796">testing</span><span class="op" id="7407803">.</span><span class="ident" id="7407804">T</span><span class="op" id="7407805">)</span>&nbsp;<span class="op" id="7407807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407810">initBig</span><span class="op" id="7407817">(</span><span class="op" id="7407818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407821">var</span>&nbsp;<span class="ident" id="7407825">buf</span>&nbsp;<span class="ident" id="7407829">bytes</span><span class="op" id="7407834">.</span><span class="ident" id="7407835">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407843">if</span>&nbsp;<span class="ident" id="7407846">err</span>&nbsp;<span class="op" id="7407850">:=</span>&nbsp;<span class="ident" id="7407853">Indent</span><span class="op" id="7407859">(</span><span class="op" id="7407860">&amp;</span><span class="ident" id="7407861">buf</span><span class="op" id="7407864">,</span>&nbsp;<span class="ident" id="7407866">jsonBig</span><span class="op" id="7407873">,</span>&nbsp;<span class="string" id="7407875">&#34;&#34;</span><span class="op" id="7407877">,</span>&nbsp;<span class="string" id="7407879">&#34;\t&#34;</span><span class="op" id="7407883">)</span><span class="op" id="7407884">;</span>&nbsp;<span class="ident" id="7407886">err</span>&nbsp;<span class="op" id="7407890">!=</span>&nbsp;<span class="ident" id="7407893">nil</span>&nbsp;<span class="op" id="7407897">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407901">t</span><span class="op" id="7407902">.</span><span class="ident" id="7407903">Fatalf</span><span class="op" id="7407909">(</span><span class="string" id="7407910">&#34;Indent1:&nbsp;%v&#34;</span><span class="op" id="7407923">,</span>&nbsp;<span class="ident" id="7407925">err</span><span class="op" id="7407928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407934">b</span>&nbsp;<span class="op" id="7407936">:=</span>&nbsp;<span class="ident" id="7407939">buf</span><span class="op" id="7407942">.</span><span class="ident" id="7407943">Bytes</span><span class="op" id="7407948">(</span><span class="op" id="7407949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407952">if</span>&nbsp;<span class="builtinfunc" id="7407955">len</span><span class="op" id="7407958">(</span><span class="ident" id="7407959">b</span><span class="op" id="7407960">)</span>&nbsp;<span class="op" id="7407962">==</span>&nbsp;<span class="builtinfunc" id="7407965">len</span><span class="op" id="7407968">(</span><span class="ident" id="7407969">jsonBig</span><span class="op" id="7407976">)</span>&nbsp;<span class="op" id="7407978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7407982">//&nbsp;jsonBig&nbsp;is&nbsp;compact&nbsp;(no&nbsp;unnecessary&nbsp;spaces);</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7408031">//&nbsp;indenting&nbsp;should&nbsp;make&nbsp;it&nbsp;bigger</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408068">t</span><span class="op" id="7408069">.</span><span class="ident" id="7408070">Fatalf</span><span class="op" id="7408076">(</span><span class="string" id="7408077">&#34;Indent(jsonBig)&nbsp;did&nbsp;not&nbsp;get&nbsp;bigger&#34;</span><span class="op" id="7408113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7408120">//&nbsp;should&nbsp;be&nbsp;idempotent</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408145">var</span>&nbsp;<span class="ident" id="7408149">buf1</span>&nbsp;<span class="ident" id="7408154">bytes</span><span class="op" id="7408159">.</span><span class="ident" id="7408160">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408168">if</span>&nbsp;<span class="ident" id="7408171">err</span>&nbsp;<span class="op" id="7408175">:=</span>&nbsp;<span class="ident" id="7408178">Indent</span><span class="op" id="7408184">(</span><span class="op" id="7408185">&amp;</span><span class="ident" id="7408186">buf1</span><span class="op" id="7408190">,</span>&nbsp;<span class="ident" id="7408192">b</span><span class="op" id="7408193">,</span>&nbsp;<span class="string" id="7408195">&#34;&#34;</span><span class="op" id="7408197">,</span>&nbsp;<span class="string" id="7408199">&#34;\t&#34;</span><span class="op" id="7408203">)</span><span class="op" id="7408204">;</span>&nbsp;<span class="ident" id="7408206">err</span>&nbsp;<span class="op" id="7408210">!=</span>&nbsp;<span class="ident" id="7408213">nil</span>&nbsp;<span class="op" id="7408217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408221">t</span><span class="op" id="7408222">.</span><span class="ident" id="7408223">Fatalf</span><span class="op" id="7408229">(</span><span class="string" id="7408230">&#34;Indent2:&nbsp;%v&#34;</span><span class="op" id="7408243">,</span>&nbsp;<span class="ident" id="7408245">err</span><span class="op" id="7408248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408254">b1</span>&nbsp;<span class="op" id="7408257">:=</span>&nbsp;<span class="ident" id="7408260">buf1</span><span class="op" id="7408264">.</span><span class="ident" id="7408265">Bytes</span><span class="op" id="7408270">(</span><span class="op" id="7408271">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408274">if</span>&nbsp;<span class="op" id="7408277">!</span><span class="ident" id="7408278">bytes</span><span class="op" id="7408283">.</span><span class="ident" id="7408284">Equal</span><span class="op" id="7408289">(</span><span class="ident" id="7408290">b1</span><span class="op" id="7408292">,</span>&nbsp;<span class="ident" id="7408294">b</span><span class="op" id="7408295">)</span>&nbsp;<span class="op" id="7408297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408301">t</span><span class="op" id="7408302">.</span><span class="ident" id="7408303">Error</span><span class="op" id="7408308">(</span><span class="string" id="7408309">&#34;Indent(Indent(jsonBig))&nbsp;!=&nbsp;Indent(jsonBig)&#34;</span><span class="op" id="7408353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408357">diff</span><span class="op" id="7408361">(</span><span class="ident" id="7408362">t</span><span class="op" id="7408363">,</span>&nbsp;<span class="ident" id="7408365">b1</span><span class="op" id="7408367">,</span>&nbsp;<span class="ident" id="7408369">b</span><span class="op" id="7408370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408374">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408382">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7408386">//&nbsp;should&nbsp;get&nbsp;back&nbsp;to&nbsp;original</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408418">buf1</span><span class="op" id="7408422">.</span><span class="ident" id="7408423">Reset</span><span class="op" id="7408428">(</span><span class="op" id="7408429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408432">if</span>&nbsp;<span class="ident" id="7408435">err</span>&nbsp;<span class="op" id="7408439">:=</span>&nbsp;<span class="ident" id="7408442">Compact</span><span class="op" id="7408449">(</span><span class="op" id="7408450">&amp;</span><span class="ident" id="7408451">buf1</span><span class="op" id="7408455">,</span>&nbsp;<span class="ident" id="7408457">b</span><span class="op" id="7408458">)</span><span class="op" id="7408459">;</span>&nbsp;<span class="ident" id="7408461">err</span>&nbsp;<span class="op" id="7408465">!=</span>&nbsp;<span class="ident" id="7408468">nil</span>&nbsp;<span class="op" id="7408472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408476">t</span><span class="op" id="7408477">.</span><span class="ident" id="7408478">Fatalf</span><span class="op" id="7408484">(</span><span class="string" id="7408485">&#34;Compact:&nbsp;%v&#34;</span><span class="op" id="7408498">,</span>&nbsp;<span class="ident" id="7408500">err</span><span class="op" id="7408503">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408509">b1</span>&nbsp;<span class="op" id="7408512">=</span>&nbsp;<span class="ident" id="7408514">buf1</span><span class="op" id="7408518">.</span><span class="ident" id="7408519">Bytes</span><span class="op" id="7408524">(</span><span class="op" id="7408525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408528">if</span>&nbsp;<span class="op" id="7408531">!</span><span class="ident" id="7408532">bytes</span><span class="op" id="7408537">.</span><span class="ident" id="7408538">Equal</span><span class="op" id="7408543">(</span><span class="ident" id="7408544">b1</span><span class="op" id="7408546">,</span>&nbsp;<span class="ident" id="7408548">jsonBig</span><span class="op" id="7408555">)</span>&nbsp;<span class="op" id="7408557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408561">t</span><span class="op" id="7408562">.</span><span class="ident" id="7408563">Error</span><span class="op" id="7408568">(</span><span class="string" id="7408569">&#34;Compact(Indent(jsonBig))&nbsp;!=&nbsp;jsonBig&#34;</span><span class="op" id="7408606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408610">diff</span><span class="op" id="7408614">(</span><span class="ident" id="7408615">t</span><span class="op" id="7408616">,</span>&nbsp;<span class="ident" id="7408618">b1</span><span class="op" id="7408620">,</span>&nbsp;<span class="ident" id="7408622">jsonBig</span><span class="op" id="7408629">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408633">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408641">}</span><br>
<span class="lineno"></span><span class="op" id="7408643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7408646">type</span>&nbsp;<span class="ident" id="7408651">indentErrorTest</span>&nbsp;<span class="keyword" id="7408667">struct</span>&nbsp;<span class="op" id="7408674">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408677">in</span>&nbsp;&nbsp;<span class="builtintype" id="7408681">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408689">err</span>&nbsp;<span class="builtintype" id="7408693">error</span><br>
<span class="lineno"></span><span class="op" id="7408699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7408702">var</span>&nbsp;<span class="ident" id="7408706">indentErrorTests</span>&nbsp;<span class="op" id="7408723">=</span>&nbsp;<span class="op" id="7408725">[</span><span class="op" id="7408726">]</span><span class="ident" id="7408727">indentErrorTest</span><span class="op" id="7408742">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408745">{</span><span class="string" id="7408746">`{&#34;X&#34;:&nbsp;&#34;foo&#34;,&nbsp;&#34;Y&#34;}`</span><span class="op" id="7408765">,</span>&nbsp;<span class="op" id="7408767">&amp;</span><span class="ident" id="7408768">SyntaxError</span><span class="op" id="7408779">{</span><span class="string" id="7408780">&#34;invalid&nbsp;character&nbsp;&#39;}&#39;&nbsp;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="7408820">,</span>&nbsp;<span class="num" id="7408822">17</span><span class="op" id="7408824">}</span><span class="op" id="7408825">}</span><span class="op" id="7408826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408829">{</span><span class="string" id="7408830">`{&#34;X&#34;:&nbsp;&#34;foo&#34;&nbsp;&#34;Y&#34;:&nbsp;&#34;bar&#34;}`</span><span class="op" id="7408855">,</span>&nbsp;<span class="op" id="7408857">&amp;</span><span class="ident" id="7408858">SyntaxError</span><span class="op" id="7408869">{</span><span class="string" id="7408870">&#34;invalid&nbsp;character&nbsp;&#39;\&#34;&#39;&nbsp;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="7408922">,</span>&nbsp;<span class="num" id="7408924">13</span><span class="op" id="7408926">}</span><span class="op" id="7408927">}</span><span class="op" id="7408928">,</span><br>
<span class="lineno"></span><span class="op" id="7408930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7408933">func</span>&nbsp;<span class="ident" id="7408938">TestIndentErrors</span><span class="op" id="7408954">(</span><span class="ident" id="7408955">t</span>&nbsp;<span class="op" id="7408957">*</span><span class="ident" id="7408958">testing</span><span class="op" id="7408965">.</span><span class="ident" id="7408966">T</span><span class="op" id="7408967">)</span>&nbsp;<span class="op" id="7408969">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408972">for</span>&nbsp;<span class="ident" id="7408976">i</span><span class="op" id="7408977">,</span>&nbsp;<span class="ident" id="7408979">tt</span>&nbsp;<span class="op" id="7408982">:=</span>&nbsp;<span class="keyword" id="7408985">range</span>&nbsp;<span class="ident" id="7408991">indentErrorTests</span>&nbsp;<span class="op" id="7409008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409012">slice</span>&nbsp;<span class="op" id="7409018">:=</span>&nbsp;<span class="builtinfunc" id="7409021">make</span><span class="op" id="7409025">(</span><span class="op" id="7409026">[</span><span class="op" id="7409027">]</span><span class="builtintype" id="7409028">uint8</span><span class="op" id="7409033">,</span>&nbsp;<span class="num" id="7409035">0</span><span class="op" id="7409036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409040">buf</span>&nbsp;<span class="op" id="7409044">:=</span>&nbsp;<span class="ident" id="7409047">bytes</span><span class="op" id="7409052">.</span><span class="ident" id="7409053">NewBuffer</span><span class="op" id="7409062">(</span><span class="ident" id="7409063">slice</span><span class="op" id="7409068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409072">if</span>&nbsp;<span class="ident" id="7409075">err</span>&nbsp;<span class="op" id="7409079">:=</span>&nbsp;<span class="ident" id="7409082">Indent</span><span class="op" id="7409088">(</span><span class="ident" id="7409089">buf</span><span class="op" id="7409092">,</span>&nbsp;<span class="op" id="7409094">[</span><span class="op" id="7409095">]</span><span class="builtintype" id="7409096">uint8</span><span class="op" id="7409101">(</span><span class="ident" id="7409102">tt</span><span class="op" id="7409104">.</span><span class="ident" id="7409105">in</span><span class="op" id="7409107">)</span><span class="op" id="7409108">,</span>&nbsp;<span class="string" id="7409110">&#34;&#34;</span><span class="op" id="7409112">,</span>&nbsp;<span class="string" id="7409114">&#34;&#34;</span><span class="op" id="7409116">)</span><span class="op" id="7409117">;</span>&nbsp;<span class="ident" id="7409119">err</span>&nbsp;<span class="op" id="7409123">!=</span>&nbsp;<span class="ident" id="7409126">nil</span>&nbsp;<span class="op" id="7409130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409135">if</span>&nbsp;<span class="op" id="7409138">!</span><span class="ident" id="7409139">reflect</span><span class="op" id="7409146">.</span><span class="ident" id="7409147">DeepEqual</span><span class="op" id="7409156">(</span><span class="ident" id="7409157">err</span><span class="op" id="7409160">,</span>&nbsp;<span class="ident" id="7409162">tt</span><span class="op" id="7409164">.</span><span class="ident" id="7409165">err</span><span class="op" id="7409168">)</span>&nbsp;<span class="op" id="7409170">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409176">t</span><span class="op" id="7409177">.</span><span class="ident" id="7409178">Errorf</span><span class="op" id="7409184">(</span><span class="string" id="7409185">&#34;#%d:&nbsp;Indent:&nbsp;%#v&#34;</span><span class="op" id="7409203">,</span>&nbsp;<span class="ident" id="7409205">i</span><span class="op" id="7409206">,</span>&nbsp;<span class="ident" id="7409208">err</span><span class="op" id="7409211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409217">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409236">}</span><br>
<span class="lineno">180</span><span class="op" id="7409238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7409241">func</span>&nbsp;<span class="ident" id="7409246">TestNextValueBig</span><span class="op" id="7409262">(</span><span class="ident" id="7409263">t</span>&nbsp;<span class="op" id="7409265">*</span><span class="ident" id="7409266">testing</span><span class="op" id="7409273">.</span><span class="ident" id="7409274">T</span><span class="op" id="7409275">)</span>&nbsp;<span class="op" id="7409277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409280">initBig</span><span class="op" id="7409287">(</span><span class="op" id="7409288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409291">var</span>&nbsp;<span class="ident" id="7409295">scan</span>&nbsp;<span class="ident" id="7409300">scanner</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409309">item</span><span class="op" id="7409313">,</span>&nbsp;<span class="ident" id="7409315">rest</span><span class="op" id="7409319">,</span>&nbsp;<span class="ident" id="7409321">err</span>&nbsp;<span class="op" id="7409325">:=</span>&nbsp;<span class="ident" id="7409328">nextValue</span><span class="op" id="7409337">(</span><span class="ident" id="7409338">jsonBig</span><span class="op" id="7409345">,</span>&nbsp;<span class="op" id="7409347">&amp;</span><span class="ident" id="7409348">scan</span><span class="op" id="7409352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409355">if</span>&nbsp;<span class="ident" id="7409358">err</span>&nbsp;<span class="op" id="7409362">!=</span>&nbsp;<span class="ident" id="7409365">nil</span>&nbsp;<span class="op" id="7409369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409373">t</span><span class="op" id="7409374">.</span><span class="ident" id="7409375">Fatalf</span><span class="op" id="7409381">(</span><span class="string" id="7409382">&#34;nextValue:&nbsp;%s&#34;</span><span class="op" id="7409397">,</span>&nbsp;<span class="ident" id="7409399">err</span><span class="op" id="7409402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409408">if</span>&nbsp;<span class="builtinfunc" id="7409411">len</span><span class="op" id="7409414">(</span><span class="ident" id="7409415">item</span><span class="op" id="7409419">)</span>&nbsp;<span class="op" id="7409421">!=</span>&nbsp;<span class="builtinfunc" id="7409424">len</span><span class="op" id="7409427">(</span><span class="ident" id="7409428">jsonBig</span><span class="op" id="7409435">)</span>&nbsp;<span class="op" id="7409437">||</span>&nbsp;<span class="op" id="7409440">&amp;</span><span class="ident" id="7409441">item</span><span class="op" id="7409445">[</span><span class="num" id="7409446">0</span><span class="op" id="7409447">]</span>&nbsp;<span class="op" id="7409449">!=</span>&nbsp;<span class="op" id="7409452">&amp;</span><span class="ident" id="7409453">jsonBig</span><span class="op" id="7409460">[</span><span class="num" id="7409461">0</span><span class="op" id="7409462">]</span>&nbsp;<span class="op" id="7409464">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409468">t</span><span class="op" id="7409469">.</span><span class="ident" id="7409470">Errorf</span><span class="op" id="7409476">(</span><span class="string" id="7409477">&#34;invalid&nbsp;item:&nbsp;%d&nbsp;%d&#34;</span><span class="op" id="7409498">,</span>&nbsp;<span class="builtinfunc" id="7409500">len</span><span class="op" id="7409503">(</span><span class="ident" id="7409504">item</span><span class="op" id="7409508">)</span><span class="op" id="7409509">,</span>&nbsp;<span class="builtinfunc" id="7409511">len</span><span class="op" id="7409514">(</span><span class="ident" id="7409515">jsonBig</span><span class="op" id="7409522">)</span><span class="op" id="7409523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409529">if</span>&nbsp;<span class="builtinfunc" id="7409532">len</span><span class="op" id="7409535">(</span><span class="ident" id="7409536">rest</span><span class="op" id="7409540">)</span>&nbsp;<span class="op" id="7409542">!=</span>&nbsp;<span class="num" id="7409545">0</span>&nbsp;<span class="op" id="7409547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409551">t</span><span class="op" id="7409552">.</span><span class="ident" id="7409553">Errorf</span><span class="op" id="7409559">(</span><span class="string" id="7409560">&#34;invalid&nbsp;rest:&nbsp;%d&#34;</span><span class="op" id="7409578">,</span>&nbsp;<span class="builtinfunc" id="7409580">len</span><span class="op" id="7409583">(</span><span class="ident" id="7409584">rest</span><span class="op" id="7409588">)</span><span class="op" id="7409589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409592">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409596">item</span><span class="op" id="7409600">,</span>&nbsp;<span class="ident" id="7409602">rest</span><span class="op" id="7409606">,</span>&nbsp;<span class="ident" id="7409608">err</span>&nbsp;<span class="op" id="7409612">=</span>&nbsp;<span class="ident" id="7409614">nextValue</span><span class="op" id="7409623">(</span><span class="builtinfunc" id="7409624">append</span><span class="op" id="7409630">(</span><span class="ident" id="7409631">jsonBig</span><span class="op" id="7409638">,</span>&nbsp;<span class="string" id="7409640">&#34;HELLO&nbsp;WORLD&#34;</span><span class="op" id="7409653">...</span><span class="op" id="7409656">)</span><span class="op" id="7409657">,</span>&nbsp;<span class="op" id="7409659">&amp;</span><span class="ident" id="7409660">scan</span><span class="op" id="7409664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409667">if</span>&nbsp;<span class="ident" id="7409670">err</span>&nbsp;<span class="op" id="7409674">!=</span>&nbsp;<span class="ident" id="7409677">nil</span>&nbsp;<span class="op" id="7409681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409685">t</span><span class="op" id="7409686">.</span><span class="ident" id="7409687">Fatalf</span><span class="op" id="7409693">(</span><span class="string" id="7409694">&#34;nextValue&nbsp;extra:&nbsp;%s&#34;</span><span class="op" id="7409715">,</span>&nbsp;<span class="ident" id="7409717">err</span><span class="op" id="7409720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409723">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409726">if</span>&nbsp;<span class="builtinfunc" id="7409729">len</span><span class="op" id="7409732">(</span><span class="ident" id="7409733">item</span><span class="op" id="7409737">)</span>&nbsp;<span class="op" id="7409739">!=</span>&nbsp;<span class="builtinfunc" id="7409742">len</span><span class="op" id="7409745">(</span><span class="ident" id="7409746">jsonBig</span><span class="op" id="7409753">)</span>&nbsp;<span class="op" id="7409755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409759">t</span><span class="op" id="7409760">.</span><span class="ident" id="7409761">Errorf</span><span class="op" id="7409767">(</span><span class="string" id="7409768">&#34;invalid&nbsp;item:&nbsp;%d&nbsp;%d&#34;</span><span class="op" id="7409789">,</span>&nbsp;<span class="builtinfunc" id="7409791">len</span><span class="op" id="7409794">(</span><span class="ident" id="7409795">item</span><span class="op" id="7409799">)</span><span class="op" id="7409800">,</span>&nbsp;<span class="builtinfunc" id="7409802">len</span><span class="op" id="7409805">(</span><span class="ident" id="7409806">jsonBig</span><span class="op" id="7409813">)</span><span class="op" id="7409814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409820">if</span>&nbsp;<span class="builtintype" id="7409823">string</span><span class="op" id="7409829">(</span><span class="ident" id="7409830">rest</span><span class="op" id="7409834">)</span>&nbsp;<span class="op" id="7409836">!=</span>&nbsp;<span class="string" id="7409839">&#34;HELLO&nbsp;WORLD&#34;</span>&nbsp;<span class="op" id="7409853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409857">t</span><span class="op" id="7409858">.</span><span class="ident" id="7409859">Errorf</span><span class="op" id="7409865">(</span><span class="string" id="7409866">&#34;invalid&nbsp;rest:&nbsp;%d&#34;</span><span class="op" id="7409884">,</span>&nbsp;<span class="builtinfunc" id="7409886">len</span><span class="op" id="7409889">(</span><span class="ident" id="7409890">rest</span><span class="op" id="7409894">)</span><span class="op" id="7409895">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409898">}</span><br>
<span class="lineno"></span><span class="op" id="7409900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7409903">var</span>&nbsp;<span class="ident" id="7409907">benchScan</span>&nbsp;<span class="ident" id="7409917">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="7409926">func</span>&nbsp;<span class="ident" id="7409931">BenchmarkSkipValue</span><span class="op" id="7409949">(</span><span class="ident" id="7409950">b</span>&nbsp;<span class="op" id="7409952">*</span><span class="ident" id="7409953">testing</span><span class="op" id="7409960">.</span><span class="ident" id="7409961">B</span><span class="op" id="7409962">)</span>&nbsp;<span class="op" id="7409964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409967">initBig</span><span class="op" id="7409974">(</span><span class="op" id="7409975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409978">for</span>&nbsp;<span class="ident" id="7409982">i</span>&nbsp;<span class="op" id="7409984">:=</span>&nbsp;<span class="num" id="7409987">0</span><span class="op" id="7409988">;</span>&nbsp;<span class="ident" id="7409990">i</span>&nbsp;<span class="op" id="7409992">&lt;</span>&nbsp;<span class="ident" id="7409994">b</span><span class="op" id="7409995">.</span><span class="ident" id="7409996">N</span><span class="op" id="7409997">;</span>&nbsp;<span class="ident" id="7409999">i</span><span class="op" id="7410000">++</span>&nbsp;<span class="op" id="7410003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410007">nextValue</span><span class="op" id="7410016">(</span><span class="ident" id="7410017">jsonBig</span><span class="op" id="7410024">,</span>&nbsp;<span class="op" id="7410026">&amp;</span><span class="ident" id="7410027">benchScan</span><span class="op" id="7410036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410039">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410042">b</span><span class="op" id="7410043">.</span><span class="ident" id="7410044">SetBytes</span><span class="op" id="7410052">(</span><span class="ident" id="7410053">int64</span><span class="op" id="7410058">(</span><span class="builtinfunc" id="7410059">len</span><span class="op" id="7410062">(</span><span class="ident" id="7410063">jsonBig</span><span class="op" id="7410070">)</span><span class="op" id="7410071">)</span><span class="op" id="7410072">)</span><br>
<span class="lineno"></span><span class="op" id="7410074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7410077">func</span>&nbsp;<span class="ident" id="7410082">diff</span><span class="op" id="7410086">(</span><span class="ident" id="7410087">t</span>&nbsp;<span class="op" id="7410089">*</span><span class="ident" id="7410090">testing</span><span class="op" id="7410097">.</span><span class="ident" id="7410098">T</span><span class="op" id="7410099">,</span>&nbsp;<span class="ident" id="7410101">a</span><span class="op" id="7410102">,</span>&nbsp;<span class="ident" id="7410104">b</span>&nbsp;<span class="op" id="7410106">[</span><span class="op" id="7410107">]</span><span class="builtintype" id="7410108">byte</span><span class="op" id="7410112">)</span>&nbsp;<span class="op" id="7410114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410117">for</span>&nbsp;<span class="ident" id="7410121">i</span>&nbsp;<span class="op" id="7410123">:=</span>&nbsp;<span class="num" id="7410126">0</span><span class="op" id="7410127">;</span>&nbsp;<span class="op" id="7410129">;</span>&nbsp;<span class="ident" id="7410131">i</span><span class="op" id="7410132">++</span>&nbsp;<span class="op" id="7410135">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410139">if</span>&nbsp;<span class="ident" id="7410142">i</span>&nbsp;<span class="op" id="7410144">&gt;=</span>&nbsp;<span class="builtinfunc" id="7410147">len</span><span class="op" id="7410150">(</span><span class="ident" id="7410151">a</span><span class="op" id="7410152">)</span>&nbsp;<span class="op" id="7410154">||</span>&nbsp;<span class="ident" id="7410157">i</span>&nbsp;<span class="op" id="7410159">&gt;=</span>&nbsp;<span class="builtinfunc" id="7410162">len</span><span class="op" id="7410165">(</span><span class="ident" id="7410166">b</span><span class="op" id="7410167">)</span>&nbsp;<span class="op" id="7410169">||</span>&nbsp;<span class="ident" id="7410172">a</span><span class="op" id="7410173">[</span><span class="ident" id="7410174">i</span><span class="op" id="7410175">]</span>&nbsp;<span class="op" id="7410177">!=</span>&nbsp;<span class="ident" id="7410180">b</span><span class="op" id="7410181">[</span><span class="ident" id="7410182">i</span><span class="op" id="7410183">]</span>&nbsp;<span class="op" id="7410185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410190">j</span>&nbsp;<span class="op" id="7410192">:=</span>&nbsp;<span class="ident" id="7410195">i</span>&nbsp;<span class="op" id="7410197">-</span>&nbsp;<span class="num" id="7410199">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410205">if</span>&nbsp;<span class="ident" id="7410208">j</span>&nbsp;<span class="op" id="7410210">&lt;</span>&nbsp;<span class="num" id="7410212">0</span>&nbsp;<span class="op" id="7410214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410220">j</span>&nbsp;<span class="op" id="7410222">=</span>&nbsp;<span class="num" id="7410224">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410229">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410234">t</span><span class="op" id="7410235">.</span><span class="ident" id="7410236">Errorf</span><span class="op" id="7410242">(</span><span class="string" id="7410243">&#34;diverge&nbsp;at&nbsp;%d:&nbsp;%s&nbsp;vs&nbsp;%s&#34;</span><span class="op" id="7410276">,</span>&nbsp;<span class="ident" id="7410278">i</span><span class="op" id="7410279">,</span>&nbsp;<span class="ident" id="7410281">trim</span><span class="op" id="7410285">(</span><span class="ident" id="7410286">a</span><span class="op" id="7410287">[</span><span class="ident" id="7410288">j</span><span class="op" id="7410289">:</span><span class="op" id="7410290">]</span><span class="op" id="7410291">)</span><span class="op" id="7410292">,</span>&nbsp;<span class="ident" id="7410294">trim</span><span class="op" id="7410298">(</span><span class="ident" id="7410299">b</span><span class="op" id="7410300">[</span><span class="ident" id="7410301">j</span><span class="op" id="7410302">:</span><span class="op" id="7410303">]</span><span class="op" id="7410304">)</span><span class="op" id="7410305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410310">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410322">}</span><br>
<span class="lineno"></span><span class="op" id="7410324">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="7410327">func</span>&nbsp;<span class="ident" id="7410332">trim</span><span class="op" id="7410336">(</span><span class="ident" id="7410337">b</span>&nbsp;<span class="op" id="7410339">[</span><span class="op" id="7410340">]</span><span class="builtintype" id="7410341">byte</span><span class="op" id="7410345">)</span>&nbsp;<span class="op" id="7410347">[</span><span class="op" id="7410348">]</span><span class="builtintype" id="7410349">byte</span>&nbsp;<span class="op" id="7410354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410357">if</span>&nbsp;<span class="builtinfunc" id="7410360">len</span><span class="op" id="7410363">(</span><span class="ident" id="7410364">b</span><span class="op" id="7410365">)</span>&nbsp;<span class="op" id="7410367">&gt;</span>&nbsp;<span class="num" id="7410369">20</span>&nbsp;<span class="op" id="7410372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410376">return</span>&nbsp;<span class="ident" id="7410383">b</span><span class="op" id="7410384">[</span><span class="num" id="7410385">0</span><span class="op" id="7410386">:</span><span class="num" id="7410387">20</span><span class="op" id="7410389">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410392">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410395">return</span>&nbsp;<span class="ident" id="7410402">b</span><br>
<span class="lineno"></span><span class="op" id="7410404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7410407">//&nbsp;Generate&nbsp;a&nbsp;random&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7410442">var</span>&nbsp;<span class="ident" id="7410446">jsonBig</span>&nbsp;<span class="op" id="7410454">[</span><span class="op" id="7410455">]</span><span class="builtintype" id="7410456">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7410462">func</span>&nbsp;<span class="ident" id="7410467">initBig</span><span class="op" id="7410474">(</span><span class="op" id="7410475">)</span>&nbsp;<span class="op" id="7410477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410480">n</span>&nbsp;<span class="op" id="7410482">:=</span>&nbsp;<span class="num" id="7410485">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410492">if</span>&nbsp;<span class="ident" id="7410495">testing</span><span class="op" id="7410502">.</span><span class="ident" id="7410503">Short</span><span class="op" id="7410508">(</span><span class="op" id="7410509">)</span>&nbsp;<span class="op" id="7410511">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410515">n</span>&nbsp;<span class="op" id="7410517">=</span>&nbsp;<span class="num" id="7410519">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410527">b</span><span class="op" id="7410528">,</span>&nbsp;<span class="ident" id="7410530">err</span>&nbsp;<span class="op" id="7410534">:=</span>&nbsp;<span class="ident" id="7410537">Marshal</span><span class="op" id="7410544">(</span><span class="ident" id="7410545">genValue</span><span class="op" id="7410553">(</span><span class="ident" id="7410554">n</span><span class="op" id="7410555">)</span><span class="op" id="7410556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410559">if</span>&nbsp;<span class="ident" id="7410562">err</span>&nbsp;<span class="op" id="7410566">!=</span>&nbsp;<span class="ident" id="7410569">nil</span>&nbsp;<span class="op" id="7410573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7410577">panic</span><span class="op" id="7410582">(</span><span class="ident" id="7410583">err</span><span class="op" id="7410586">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410592">jsonBig</span>&nbsp;<span class="op" id="7410600">=</span>&nbsp;<span class="ident" id="7410602">b</span><br>
<span class="lineno"></span><span class="op" id="7410604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7410607">func</span>&nbsp;<span class="ident" id="7410612">genValue</span><span class="op" id="7410620">(</span><span class="ident" id="7410621">n</span>&nbsp;<span class="builtintype" id="7410623">int</span><span class="op" id="7410626">)</span>&nbsp;<span class="keyword" id="7410628">interface</span><span class="op" id="7410637">{</span><span class="op" id="7410638">}</span>&nbsp;<span class="op" id="7410640">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410643">if</span>&nbsp;<span class="ident" id="7410646">n</span>&nbsp;<span class="op" id="7410648">&gt;</span>&nbsp;<span class="num" id="7410650">1</span>&nbsp;<span class="op" id="7410652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410656">switch</span>&nbsp;<span class="ident" id="7410663">rand</span><span class="op" id="7410667">.</span><span class="ident" id="7410668">Intn</span><span class="op" id="7410672">(</span><span class="num" id="7410673">2</span><span class="op" id="7410674">)</span>&nbsp;<span class="op" id="7410676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410680">case</span>&nbsp;<span class="num" id="7410685">0</span><span class="op" id="7410686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410691">return</span>&nbsp;<span class="ident" id="7410698">genArray</span><span class="op" id="7410706">(</span><span class="ident" id="7410707">n</span><span class="op" id="7410708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410712">case</span>&nbsp;<span class="num" id="7410717">1</span><span class="op" id="7410718">:</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410723">return</span>&nbsp;<span class="ident" id="7410730">genMap</span><span class="op" id="7410736">(</span><span class="ident" id="7410737">n</span><span class="op" id="7410738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410748">switch</span>&nbsp;<span class="ident" id="7410755">rand</span><span class="op" id="7410759">.</span><span class="ident" id="7410760">Intn</span><span class="op" id="7410764">(</span><span class="num" id="7410765">3</span><span class="op" id="7410766">)</span>&nbsp;<span class="op" id="7410768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410771">case</span>&nbsp;<span class="num" id="7410776">0</span><span class="op" id="7410777">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410781">return</span>&nbsp;<span class="ident" id="7410788">rand</span><span class="op" id="7410792">.</span><span class="ident" id="7410793">Intn</span><span class="op" id="7410797">(</span><span class="num" id="7410798">2</span><span class="op" id="7410799">)</span>&nbsp;<span class="op" id="7410801">==</span>&nbsp;<span class="num" id="7410804">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410807">case</span>&nbsp;<span class="num" id="7410812">1</span><span class="op" id="7410813">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410817">return</span>&nbsp;<span class="ident" id="7410824">rand</span><span class="op" id="7410828">.</span><span class="ident" id="7410829">NormFloat64</span><span class="op" id="7410840">(</span><span class="op" id="7410841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410844">case</span>&nbsp;<span class="num" id="7410849">2</span><span class="op" id="7410850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410854">return</span>&nbsp;<span class="ident" id="7410861">genString</span><span class="op" id="7410870">(</span><span class="num" id="7410871">30</span><span class="op" id="7410873">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7410879">panic</span><span class="op" id="7410884">(</span><span class="string" id="7410885">&#34;unreachable&#34;</span><span class="op" id="7410898">)</span><br>
<span class="lineno"></span><span class="op" id="7410900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7410903">func</span>&nbsp;<span class="ident" id="7410908">genString</span><span class="op" id="7410917">(</span><span class="ident" id="7410918">stddev</span>&nbsp;<span class="builtintype" id="7410925">float64</span><span class="op" id="7410932">)</span>&nbsp;<span class="builtintype" id="7410934">string</span>&nbsp;<span class="op" id="7410941">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410944">n</span>&nbsp;<span class="op" id="7410946">:=</span>&nbsp;<span class="builtintype" id="7410949">int</span><span class="op" id="7410952">(</span><span class="ident" id="7410953">math</span><span class="op" id="7410957">.</span><span class="ident" id="7410958">Abs</span><span class="op" id="7410961">(</span><span class="ident" id="7410962">rand</span><span class="op" id="7410966">.</span><span class="ident" id="7410967">NormFloat64</span><span class="op" id="7410978">(</span><span class="op" id="7410979">)</span><span class="op" id="7410980">*</span><span class="ident" id="7410981">stddev</span>&nbsp;<span class="op" id="7410988">+</span>&nbsp;<span class="ident" id="7410990">stddev</span><span class="op" id="7410996">/</span><span class="num" id="7410997">2</span><span class="op" id="7410998">)</span><span class="op" id="7410999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411002">c</span>&nbsp;<span class="op" id="7411004">:=</span>&nbsp;<span class="builtinfunc" id="7411007">make</span><span class="op" id="7411011">(</span><span class="op" id="7411012">[</span><span class="op" id="7411013">]</span><span class="builtintype" id="7411014">rune</span><span class="op" id="7411018">,</span>&nbsp;<span class="ident" id="7411020">n</span><span class="op" id="7411021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411024">for</span>&nbsp;<span class="ident" id="7411028">i</span>&nbsp;<span class="op" id="7411030">:=</span>&nbsp;<span class="keyword" id="7411033">range</span>&nbsp;<span class="ident" id="7411039">c</span>&nbsp;<span class="op" id="7411041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411045">f</span>&nbsp;<span class="op" id="7411047">:=</span>&nbsp;<span class="ident" id="7411050">math</span><span class="op" id="7411054">.</span><span class="ident" id="7411055">Abs</span><span class="op" id="7411058">(</span><span class="ident" id="7411059">rand</span><span class="op" id="7411063">.</span><span class="ident" id="7411064">NormFloat64</span><span class="op" id="7411075">(</span><span class="op" id="7411076">)</span><span class="op" id="7411077">*</span><span class="num" id="7411078">64</span>&nbsp;<span class="op" id="7411081">+</span>&nbsp;<span class="num" id="7411083">32</span><span class="op" id="7411085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411089">if</span>&nbsp;<span class="ident" id="7411092">f</span>&nbsp;<span class="op" id="7411094">&gt;</span>&nbsp;<span class="num" id="7411096">0x10ffff</span>&nbsp;<span class="op" id="7411105">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411110">f</span>&nbsp;<span class="op" id="7411112">=</span>&nbsp;<span class="num" id="7411114">0x10ffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7411125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411129">c</span><span class="op" id="7411130">[</span><span class="ident" id="7411131">i</span><span class="op" id="7411132">]</span>&nbsp;<span class="op" id="7411134">=</span>&nbsp;<span class="builtintype" id="7411136">rune</span><span class="op" id="7411140">(</span><span class="ident" id="7411141">f</span><span class="op" id="7411142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7411145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411148">return</span>&nbsp;<span class="builtintype" id="7411155">string</span><span class="op" id="7411161">(</span><span class="ident" id="7411162">c</span><span class="op" id="7411163">)</span><br>
<span class="lineno">285</span><span class="op" id="7411165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7411168">func</span>&nbsp;<span class="ident" id="7411173">genArray</span><span class="op" id="7411181">(</span><span class="ident" id="7411182">n</span>&nbsp;<span class="builtintype" id="7411184">int</span><span class="op" id="7411187">)</span>&nbsp;<span class="op" id="7411189">[</span><span class="op" id="7411190">]</span><span class="keyword" id="7411191">interface</span><span class="op" id="7411200">{</span><span class="op" id="7411201">}</span>&nbsp;<span class="op" id="7411203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411206">f</span>&nbsp;<span class="op" id="7411208">:=</span>&nbsp;<span class="builtintype" id="7411211">int</span><span class="op" id="7411214">(</span><span class="ident" id="7411215">math</span><span class="op" id="7411219">.</span><span class="ident" id="7411220">Abs</span><span class="op" id="7411223">(</span><span class="ident" id="7411224">rand</span><span class="op" id="7411228">.</span><span class="ident" id="7411229">NormFloat64</span><span class="op" id="7411240">(</span><span class="op" id="7411241">)</span><span class="op" id="7411242">)</span>&nbsp;<span class="op" id="7411244">*</span>&nbsp;<span class="ident" id="7411246">math</span><span class="op" id="7411250">.</span><span class="ident" id="7411251">Min</span><span class="op" id="7411254">(</span><span class="num" id="7411255">10</span><span class="op" id="7411257">,</span>&nbsp;<span class="builtintype" id="7411259">float64</span><span class="op" id="7411266">(</span><span class="ident" id="7411267">n</span><span class="op" id="7411268">/</span><span class="num" id="7411269">2</span><span class="op" id="7411270">)</span><span class="op" id="7411271">)</span><span class="op" id="7411272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411275">if</span>&nbsp;<span class="ident" id="7411278">f</span>&nbsp;<span class="op" id="7411280">&gt;</span>&nbsp;<span class="ident" id="7411282">n</span>&nbsp;<span class="op" id="7411284">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411288">f</span>&nbsp;<span class="op" id="7411290">=</span>&nbsp;<span class="ident" id="7411292">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7411295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411298">if</span>&nbsp;<span class="ident" id="7411301">f</span>&nbsp;<span class="op" id="7411303">&lt;</span>&nbsp;<span class="num" id="7411305">1</span>&nbsp;<span class="op" id="7411307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411311">f</span>&nbsp;<span class="op" id="7411313">=</span>&nbsp;<span class="num" id="7411315">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7411318">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411321">x</span>&nbsp;<span class="op" id="7411323">:=</span>&nbsp;<span class="builtinfunc" id="7411326">make</span><span class="op" id="7411330">(</span><span class="op" id="7411331">[</span><span class="op" id="7411332">]</span><span class="keyword" id="7411333">interface</span><span class="op" id="7411342">{</span><span class="op" id="7411343">}</span><span class="op" id="7411344">,</span>&nbsp;<span class="ident" id="7411346">f</span><span class="op" id="7411347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411350">for</span>&nbsp;<span class="ident" id="7411354">i</span>&nbsp;<span class="op" id="7411356">:=</span>&nbsp;<span class="keyword" id="7411359">range</span>&nbsp;<span class="ident" id="7411365">x</span>&nbsp;<span class="op" id="7411367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411371">x</span><span class="op" id="7411372">[</span><span class="ident" id="7411373">i</span><span class="op" id="7411374">]</span>&nbsp;<span class="op" id="7411376">=</span>&nbsp;<span class="ident" id="7411378">genValue</span><span class="op" id="7411386">(</span><span class="op" id="7411387">(</span><span class="op" id="7411388">(</span><span class="ident" id="7411389">i</span><span class="op" id="7411390">+</span><span class="num" id="7411391">1</span><span class="op" id="7411392">)</span><span class="op" id="7411393">*</span><span class="ident" id="7411394">n</span><span class="op" id="7411395">)</span><span class="op" id="7411396">/</span><span class="ident" id="7411397">f</span>&nbsp;<span class="op" id="7411399">-</span>&nbsp;<span class="op" id="7411401">(</span><span class="ident" id="7411402">i</span><span class="op" id="7411403">*</span><span class="ident" id="7411404">n</span><span class="op" id="7411405">)</span><span class="op" id="7411406">/</span><span class="ident" id="7411407">f</span><span class="op" id="7411408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7411411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411414">return</span>&nbsp;<span class="ident" id="7411421">x</span><br>
<span class="lineno">300</span><span class="op" id="7411423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7411426">func</span>&nbsp;<span class="ident" id="7411431">genMap</span><span class="op" id="7411437">(</span><span class="ident" id="7411438">n</span>&nbsp;<span class="builtintype" id="7411440">int</span><span class="op" id="7411443">)</span>&nbsp;<span class="keyword" id="7411445">map</span><span class="op" id="7411448">[</span><span class="builtintype" id="7411449">string</span><span class="op" id="7411455">]</span><span class="keyword" id="7411456">interface</span><span class="op" id="7411465">{</span><span class="op" id="7411466">}</span>&nbsp;<span class="op" id="7411468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411471">f</span>&nbsp;<span class="op" id="7411473">:=</span>&nbsp;<span class="builtintype" id="7411476">int</span><span class="op" id="7411479">(</span><span class="ident" id="7411480">math</span><span class="op" id="7411484">.</span><span class="ident" id="7411485">Abs</span><span class="op" id="7411488">(</span><span class="ident" id="7411489">rand</span><span class="op" id="7411493">.</span><span class="ident" id="7411494">NormFloat64</span><span class="op" id="7411505">(</span><span class="op" id="7411506">)</span><span class="op" id="7411507">)</span>&nbsp;<span class="op" id="7411509">*</span>&nbsp;<span class="ident" id="7411511">math</span><span class="op" id="7411515">.</span><span class="ident" id="7411516">Min</span><span class="op" id="7411519">(</span><span class="num" id="7411520">10</span><span class="op" id="7411522">,</span>&nbsp;<span class="builtintype" id="7411524">float64</span><span class="op" id="7411531">(</span><span class="ident" id="7411532">n</span><span class="op" id="7411533">/</span><span class="num" id="7411534">2</span><span class="op" id="7411535">)</span><span class="op" id="7411536">)</span><span class="op" id="7411537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411540">if</span>&nbsp;<span class="ident" id="7411543">f</span>&nbsp;<span class="op" id="7411545">&gt;</span>&nbsp;<span class="ident" id="7411547">n</span>&nbsp;<span class="op" id="7411549">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411553">f</span>&nbsp;<span class="op" id="7411555">=</span>&nbsp;<span class="ident" id="7411557">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7411560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411563">if</span>&nbsp;<span class="ident" id="7411566">n</span>&nbsp;<span class="op" id="7411568">&gt;</span>&nbsp;<span class="num" id="7411570">0</span>&nbsp;<span class="op" id="7411572">&amp;&amp;</span>&nbsp;<span class="ident" id="7411575">f</span>&nbsp;<span class="op" id="7411577">==</span>&nbsp;<span class="num" id="7411580">0</span>&nbsp;<span class="op" id="7411582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411586">f</span>&nbsp;<span class="op" id="7411588">=</span>&nbsp;<span class="num" id="7411590">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7411593">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411596">x</span>&nbsp;<span class="op" id="7411598">:=</span>&nbsp;<span class="builtinfunc" id="7411601">make</span><span class="op" id="7411605">(</span><span class="keyword" id="7411606">map</span><span class="op" id="7411609">[</span><span class="builtintype" id="7411610">string</span><span class="op" id="7411616">]</span><span class="keyword" id="7411617">interface</span><span class="op" id="7411626">{</span><span class="op" id="7411627">}</span><span class="op" id="7411628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411631">for</span>&nbsp;<span class="ident" id="7411635">i</span>&nbsp;<span class="op" id="7411637">:=</span>&nbsp;<span class="num" id="7411640">0</span><span class="op" id="7411641">;</span>&nbsp;<span class="ident" id="7411643">i</span>&nbsp;<span class="op" id="7411645">&lt;</span>&nbsp;<span class="ident" id="7411647">f</span><span class="op" id="7411648">;</span>&nbsp;<span class="ident" id="7411650">i</span><span class="op" id="7411651">++</span>&nbsp;<span class="op" id="7411654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7411658">x</span><span class="op" id="7411659">[</span><span class="ident" id="7411660">genString</span><span class="op" id="7411669">(</span><span class="num" id="7411670">10</span><span class="op" id="7411672">)</span><span class="op" id="7411673">]</span>&nbsp;<span class="op" id="7411675">=</span>&nbsp;<span class="ident" id="7411677">genValue</span><span class="op" id="7411685">(</span><span class="op" id="7411686">(</span><span class="op" id="7411687">(</span><span class="ident" id="7411688">i</span><span class="op" id="7411689">+</span><span class="num" id="7411690">1</span><span class="op" id="7411691">)</span><span class="op" id="7411692">*</span><span class="ident" id="7411693">n</span><span class="op" id="7411694">)</span><span class="op" id="7411695">/</span><span class="ident" id="7411696">f</span>&nbsp;<span class="op" id="7411698">-</span>&nbsp;<span class="op" id="7411700">(</span><span class="ident" id="7411701">i</span><span class="op" id="7411702">*</span><span class="ident" id="7411703">n</span><span class="op" id="7411704">)</span><span class="op" id="7411705">/</span><span class="ident" id="7411706">f</span><span class="op" id="7411707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7411710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7411713">return</span>&nbsp;<span class="ident" id="7411720">x</span><br>
<span class="lineno">315</span><span class="op" id="7411722">}</span>
</div>
</body>
</html>
