<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7490815">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7490870">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7490924">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7490975">package</span>&nbsp;<span class="ident" id="7490983">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7490989">import</span>&nbsp;<span class="op" id="7490996">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7490999">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491008">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491015">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491024">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491039">&#34;image/png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491052">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491065">&#34;math/rand&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491078">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491084">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7491094">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7491097">//&nbsp;zigzag&nbsp;maps&nbsp;from&nbsp;the&nbsp;natural&nbsp;ordering&nbsp;to&nbsp;the&nbsp;zig-zag&nbsp;ordering.&nbsp;For&nbsp;example,</span><br>
<span class="lineno">20</span><span class="comment" id="7491176">//&nbsp;zigzag[0*8&nbsp;+&nbsp;3]&nbsp;is&nbsp;the&nbsp;zig-zag&nbsp;sequence&nbsp;number&nbsp;of&nbsp;the&nbsp;element&nbsp;in&nbsp;the&nbsp;fourth</span><br>
<span class="lineno"></span><span class="comment" id="7491255">//&nbsp;column&nbsp;and&nbsp;first&nbsp;row.</span><br>
<span class="lineno"></span><span class="keyword" id="7491280">var</span>&nbsp;<span class="ident" id="7491284">zigzag</span>&nbsp;<span class="op" id="7491291">=</span>&nbsp;<span class="op" id="7491293">[</span><span class="ident" id="7491294"><a href="/image/jpeg/idct.go.html#5398910">blockSize</a></span><span class="op" id="7491303">]</span><span class="builtintype" id="7491304">int</span><span class="op" id="7491307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7491310">0</span><span class="op" id="7491311">,</span>&nbsp;<span class="num" id="7491313">1</span><span class="op" id="7491314">,</span>&nbsp;<span class="num" id="7491316">5</span><span class="op" id="7491317">,</span>&nbsp;<span class="num" id="7491319">6</span><span class="op" id="7491320">,</span>&nbsp;<span class="num" id="7491322">14</span><span class="op" id="7491324">,</span>&nbsp;<span class="num" id="7491326">15</span><span class="op" id="7491328">,</span>&nbsp;<span class="num" id="7491330">27</span><span class="op" id="7491332">,</span>&nbsp;<span class="num" id="7491334">28</span><span class="op" id="7491336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7491339">2</span><span class="op" id="7491340">,</span>&nbsp;<span class="num" id="7491342">4</span><span class="op" id="7491343">,</span>&nbsp;<span class="num" id="7491345">7</span><span class="op" id="7491346">,</span>&nbsp;<span class="num" id="7491348">13</span><span class="op" id="7491350">,</span>&nbsp;<span class="num" id="7491352">16</span><span class="op" id="7491354">,</span>&nbsp;<span class="num" id="7491356">26</span><span class="op" id="7491358">,</span>&nbsp;<span class="num" id="7491360">29</span><span class="op" id="7491362">,</span>&nbsp;<span class="num" id="7491364">42</span><span class="op" id="7491366">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7491369">3</span><span class="op" id="7491370">,</span>&nbsp;<span class="num" id="7491372">8</span><span class="op" id="7491373">,</span>&nbsp;<span class="num" id="7491375">12</span><span class="op" id="7491377">,</span>&nbsp;<span class="num" id="7491379">17</span><span class="op" id="7491381">,</span>&nbsp;<span class="num" id="7491383">25</span><span class="op" id="7491385">,</span>&nbsp;<span class="num" id="7491387">30</span><span class="op" id="7491389">,</span>&nbsp;<span class="num" id="7491391">41</span><span class="op" id="7491393">,</span>&nbsp;<span class="num" id="7491395">43</span><span class="op" id="7491397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7491400">9</span><span class="op" id="7491401">,</span>&nbsp;<span class="num" id="7491403">11</span><span class="op" id="7491405">,</span>&nbsp;<span class="num" id="7491407">18</span><span class="op" id="7491409">,</span>&nbsp;<span class="num" id="7491411">24</span><span class="op" id="7491413">,</span>&nbsp;<span class="num" id="7491415">31</span><span class="op" id="7491417">,</span>&nbsp;<span class="num" id="7491419">40</span><span class="op" id="7491421">,</span>&nbsp;<span class="num" id="7491423">44</span><span class="op" id="7491425">,</span>&nbsp;<span class="num" id="7491427">53</span><span class="op" id="7491429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7491432">10</span><span class="op" id="7491434">,</span>&nbsp;<span class="num" id="7491436">19</span><span class="op" id="7491438">,</span>&nbsp;<span class="num" id="7491440">23</span><span class="op" id="7491442">,</span>&nbsp;<span class="num" id="7491444">32</span><span class="op" id="7491446">,</span>&nbsp;<span class="num" id="7491448">39</span><span class="op" id="7491450">,</span>&nbsp;<span class="num" id="7491452">45</span><span class="op" id="7491454">,</span>&nbsp;<span class="num" id="7491456">52</span><span class="op" id="7491458">,</span>&nbsp;<span class="num" id="7491460">54</span><span class="op" id="7491462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7491465">20</span><span class="op" id="7491467">,</span>&nbsp;<span class="num" id="7491469">22</span><span class="op" id="7491471">,</span>&nbsp;<span class="num" id="7491473">33</span><span class="op" id="7491475">,</span>&nbsp;<span class="num" id="7491477">38</span><span class="op" id="7491479">,</span>&nbsp;<span class="num" id="7491481">46</span><span class="op" id="7491483">,</span>&nbsp;<span class="num" id="7491485">51</span><span class="op" id="7491487">,</span>&nbsp;<span class="num" id="7491489">55</span><span class="op" id="7491491">,</span>&nbsp;<span class="num" id="7491493">60</span><span class="op" id="7491495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7491498">21</span><span class="op" id="7491500">,</span>&nbsp;<span class="num" id="7491502">34</span><span class="op" id="7491504">,</span>&nbsp;<span class="num" id="7491506">37</span><span class="op" id="7491508">,</span>&nbsp;<span class="num" id="7491510">47</span><span class="op" id="7491512">,</span>&nbsp;<span class="num" id="7491514">50</span><span class="op" id="7491516">,</span>&nbsp;<span class="num" id="7491518">56</span><span class="op" id="7491520">,</span>&nbsp;<span class="num" id="7491522">59</span><span class="op" id="7491524">,</span>&nbsp;<span class="num" id="7491526">61</span><span class="op" id="7491528">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7491531">35</span><span class="op" id="7491533">,</span>&nbsp;<span class="num" id="7491535">36</span><span class="op" id="7491537">,</span>&nbsp;<span class="num" id="7491539">48</span><span class="op" id="7491541">,</span>&nbsp;<span class="num" id="7491543">49</span><span class="op" id="7491545">,</span>&nbsp;<span class="num" id="7491547">57</span><span class="op" id="7491549">,</span>&nbsp;<span class="num" id="7491551">58</span><span class="op" id="7491553">,</span>&nbsp;<span class="num" id="7491555">62</span><span class="op" id="7491557">,</span>&nbsp;<span class="num" id="7491559">63</span><span class="op" id="7491561">,</span><br>
<span class="lineno"></span><span class="op" id="7491563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7491566">func</span>&nbsp;<span class="ident" id="7491571">TestZigUnzig</span><span class="op" id="7491583">(</span><span class="ident" id="7491584">t</span>&nbsp;<span class="op" id="7491586">*</span><span class="ident" id="7491587"><a href="/image/jpeg/writer_test.go.html#7491084">testing</a></span><span class="op" id="7491594">.</span><span class="ident" id="7491595">T</span><span class="op" id="7491596">)</span>&nbsp;<span class="op" id="7491598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491601">for</span>&nbsp;<span class="ident" id="7491605">i</span>&nbsp;<span class="op" id="7491607">:=</span>&nbsp;<span class="num" id="7491610">0</span><span class="op" id="7491611">;</span>&nbsp;<span class="ident" id="7491613"><a href="/image/jpeg/writer_test.go.html#7491605">i</a></span>&nbsp;<span class="op" id="7491615">&lt;</span>&nbsp;<span class="ident" id="7491617"><a href="/image/jpeg/idct.go.html#5398910">blockSize</a></span><span class="op" id="7491626">;</span>&nbsp;<span class="ident" id="7491628"><a href="/image/jpeg/writer_test.go.html#7491605">i</a></span><span class="op" id="7491629">++</span>&nbsp;<span class="op" id="7491632">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491636">if</span>&nbsp;<span class="ident" id="7491639"><a href="/image/jpeg/reader.go.html#5404818">unzig</a></span><span class="op" id="7491644">[</span><span class="ident" id="7491645"><a href="/image/jpeg/writer_test.go.html#7491284">zigzag</a></span><span class="op" id="7491651">[</span><span class="ident" id="7491652"><a href="/image/jpeg/writer_test.go.html#7491605">i</a></span><span class="op" id="7491653">]</span><span class="op" id="7491654">]</span>&nbsp;<span class="op" id="7491656">!=</span>&nbsp;<span class="ident" id="7491659"><a href="/image/jpeg/writer_test.go.html#7491605">i</a></span>&nbsp;<span class="op" id="7491661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491666"><a href="/image/jpeg/writer_test.go.html#7491584">t</a></span><span class="op" id="7491667">.</span><span class="ident" id="7491668">Errorf</span><span class="op" id="7491674">(</span><span class="string" id="7491675">&#34;unzig[zigzag[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7491700">,</span>&nbsp;<span class="ident" id="7491702"><a href="/image/jpeg/writer_test.go.html#7491605">i</a></span><span class="op" id="7491703">,</span>&nbsp;<span class="ident" id="7491705"><a href="/image/jpeg/reader.go.html#5404818">unzig</a></span><span class="op" id="7491710">[</span><span class="ident" id="7491711"><a href="/image/jpeg/writer_test.go.html#7491284">zigzag</a></span><span class="op" id="7491717">[</span><span class="ident" id="7491718"><a href="/image/jpeg/writer_test.go.html#7491605">i</a></span><span class="op" id="7491719">]</span><span class="op" id="7491720">]</span><span class="op" id="7491721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491729">if</span>&nbsp;<span class="ident" id="7491732"><a href="/image/jpeg/writer_test.go.html#7491284">zigzag</a></span><span class="op" id="7491738">[</span><span class="ident" id="7491739"><a href="/image/jpeg/reader.go.html#5404818">unzig</a></span><span class="op" id="7491744">[</span><span class="ident" id="7491745"><a href="/image/jpeg/writer_test.go.html#7491605">i</a></span><span class="op" id="7491746">]</span><span class="op" id="7491747">]</span>&nbsp;<span class="op" id="7491749">!=</span>&nbsp;<span class="ident" id="7491752"><a href="/image/jpeg/writer_test.go.html#7491605">i</a></span>&nbsp;<span class="op" id="7491754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491759"><a href="/image/jpeg/writer_test.go.html#7491584">t</a></span><span class="op" id="7491760">.</span><span class="ident" id="7491761">Errorf</span><span class="op" id="7491767">(</span><span class="string" id="7491768">&#34;zigzag[unzig[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7491793">,</span>&nbsp;<span class="ident" id="7491795"><a href="/image/jpeg/writer_test.go.html#7491605">i</a></span><span class="op" id="7491796">,</span>&nbsp;<span class="ident" id="7491798"><a href="/image/jpeg/writer_test.go.html#7491284">zigzag</a></span><span class="op" id="7491804">[</span><span class="ident" id="7491805"><a href="/image/jpeg/reader.go.html#5404818">unzig</a></span><span class="op" id="7491810">[</span><span class="ident" id="7491811"><a href="/image/jpeg/writer_test.go.html#7491605">i</a></span><span class="op" id="7491812">]</span><span class="op" id="7491813">]</span><span class="op" id="7491814">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491821">}</span><br>
<span class="lineno"></span><span class="op" id="7491823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7491826">//&nbsp;unscaledQuantInNaturalOrder&nbsp;are&nbsp;the&nbsp;unscaled&nbsp;quantization&nbsp;tables&nbsp;in</span><br>
<span class="lineno">45</span><span class="comment" id="7491897">//&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order,&nbsp;as&nbsp;specified&nbsp;in&nbsp;section&nbsp;K.1.</span><br>
<span class="lineno"></span><span class="keyword" id="7491958">var</span>&nbsp;<span class="ident" id="7491962">unscaledQuantInNaturalOrder</span>&nbsp;<span class="op" id="7491990">=</span>&nbsp;<span class="op" id="7491992">[</span><span class="ident" id="7491993"><a href="/image/jpeg/writer.go.html#5432115">nQuantIndex</a></span><span class="op" id="7492004">]</span><span class="op" id="7492005">[</span><span class="ident" id="7492006"><a href="/image/jpeg/idct.go.html#5398910">blockSize</a></span><span class="op" id="7492015">]</span><span class="builtintype" id="7492016">byte</span><span class="op" id="7492020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7492023">//&nbsp;Luminance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492042">16</span><span class="op" id="7492044">,</span>&nbsp;<span class="num" id="7492046">11</span><span class="op" id="7492048">,</span>&nbsp;<span class="num" id="7492050">10</span><span class="op" id="7492052">,</span>&nbsp;<span class="num" id="7492054">16</span><span class="op" id="7492056">,</span>&nbsp;<span class="num" id="7492058">24</span><span class="op" id="7492060">,</span>&nbsp;<span class="num" id="7492062">40</span><span class="op" id="7492064">,</span>&nbsp;<span class="num" id="7492066">51</span><span class="op" id="7492068">,</span>&nbsp;<span class="num" id="7492070">61</span><span class="op" id="7492072">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492076">12</span><span class="op" id="7492078">,</span>&nbsp;<span class="num" id="7492080">12</span><span class="op" id="7492082">,</span>&nbsp;<span class="num" id="7492084">14</span><span class="op" id="7492086">,</span>&nbsp;<span class="num" id="7492088">19</span><span class="op" id="7492090">,</span>&nbsp;<span class="num" id="7492092">26</span><span class="op" id="7492094">,</span>&nbsp;<span class="num" id="7492096">58</span><span class="op" id="7492098">,</span>&nbsp;<span class="num" id="7492100">60</span><span class="op" id="7492102">,</span>&nbsp;<span class="num" id="7492104">55</span><span class="op" id="7492106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492110">14</span><span class="op" id="7492112">,</span>&nbsp;<span class="num" id="7492114">13</span><span class="op" id="7492116">,</span>&nbsp;<span class="num" id="7492118">16</span><span class="op" id="7492120">,</span>&nbsp;<span class="num" id="7492122">24</span><span class="op" id="7492124">,</span>&nbsp;<span class="num" id="7492126">40</span><span class="op" id="7492128">,</span>&nbsp;<span class="num" id="7492130">57</span><span class="op" id="7492132">,</span>&nbsp;<span class="num" id="7492134">69</span><span class="op" id="7492136">,</span>&nbsp;<span class="num" id="7492138">56</span><span class="op" id="7492140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492144">14</span><span class="op" id="7492146">,</span>&nbsp;<span class="num" id="7492148">17</span><span class="op" id="7492150">,</span>&nbsp;<span class="num" id="7492152">22</span><span class="op" id="7492154">,</span>&nbsp;<span class="num" id="7492156">29</span><span class="op" id="7492158">,</span>&nbsp;<span class="num" id="7492160">51</span><span class="op" id="7492162">,</span>&nbsp;<span class="num" id="7492164">87</span><span class="op" id="7492166">,</span>&nbsp;<span class="num" id="7492168">80</span><span class="op" id="7492170">,</span>&nbsp;<span class="num" id="7492172">62</span><span class="op" id="7492174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492178">18</span><span class="op" id="7492180">,</span>&nbsp;<span class="num" id="7492182">22</span><span class="op" id="7492184">,</span>&nbsp;<span class="num" id="7492186">37</span><span class="op" id="7492188">,</span>&nbsp;<span class="num" id="7492190">56</span><span class="op" id="7492192">,</span>&nbsp;<span class="num" id="7492194">68</span><span class="op" id="7492196">,</span>&nbsp;<span class="num" id="7492198">109</span><span class="op" id="7492201">,</span>&nbsp;<span class="num" id="7492203">103</span><span class="op" id="7492206">,</span>&nbsp;<span class="num" id="7492208">77</span><span class="op" id="7492210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492214">24</span><span class="op" id="7492216">,</span>&nbsp;<span class="num" id="7492218">35</span><span class="op" id="7492220">,</span>&nbsp;<span class="num" id="7492222">55</span><span class="op" id="7492224">,</span>&nbsp;<span class="num" id="7492226">64</span><span class="op" id="7492228">,</span>&nbsp;<span class="num" id="7492230">81</span><span class="op" id="7492232">,</span>&nbsp;<span class="num" id="7492234">104</span><span class="op" id="7492237">,</span>&nbsp;<span class="num" id="7492239">113</span><span class="op" id="7492242">,</span>&nbsp;<span class="num" id="7492244">92</span><span class="op" id="7492246">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492250">49</span><span class="op" id="7492252">,</span>&nbsp;<span class="num" id="7492254">64</span><span class="op" id="7492256">,</span>&nbsp;<span class="num" id="7492258">78</span><span class="op" id="7492260">,</span>&nbsp;<span class="num" id="7492262">87</span><span class="op" id="7492264">,</span>&nbsp;<span class="num" id="7492266">103</span><span class="op" id="7492269">,</span>&nbsp;<span class="num" id="7492271">121</span><span class="op" id="7492274">,</span>&nbsp;<span class="num" id="7492276">120</span><span class="op" id="7492279">,</span>&nbsp;<span class="num" id="7492281">101</span><span class="op" id="7492284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492288">72</span><span class="op" id="7492290">,</span>&nbsp;<span class="num" id="7492292">92</span><span class="op" id="7492294">,</span>&nbsp;<span class="num" id="7492296">95</span><span class="op" id="7492298">,</span>&nbsp;<span class="num" id="7492300">98</span><span class="op" id="7492302">,</span>&nbsp;<span class="num" id="7492304">112</span><span class="op" id="7492307">,</span>&nbsp;<span class="num" id="7492309">100</span><span class="op" id="7492312">,</span>&nbsp;<span class="num" id="7492314">103</span><span class="op" id="7492317">,</span>&nbsp;<span class="num" id="7492319">99</span><span class="op" id="7492321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492324">}</span><span class="op" id="7492325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7492328">//&nbsp;Chrominance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492345">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492349">17</span><span class="op" id="7492351">,</span>&nbsp;<span class="num" id="7492353">18</span><span class="op" id="7492355">,</span>&nbsp;<span class="num" id="7492357">24</span><span class="op" id="7492359">,</span>&nbsp;<span class="num" id="7492361">47</span><span class="op" id="7492363">,</span>&nbsp;<span class="num" id="7492365">99</span><span class="op" id="7492367">,</span>&nbsp;<span class="num" id="7492369">99</span><span class="op" id="7492371">,</span>&nbsp;<span class="num" id="7492373">99</span><span class="op" id="7492375">,</span>&nbsp;<span class="num" id="7492377">99</span><span class="op" id="7492379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492383">18</span><span class="op" id="7492385">,</span>&nbsp;<span class="num" id="7492387">21</span><span class="op" id="7492389">,</span>&nbsp;<span class="num" id="7492391">26</span><span class="op" id="7492393">,</span>&nbsp;<span class="num" id="7492395">66</span><span class="op" id="7492397">,</span>&nbsp;<span class="num" id="7492399">99</span><span class="op" id="7492401">,</span>&nbsp;<span class="num" id="7492403">99</span><span class="op" id="7492405">,</span>&nbsp;<span class="num" id="7492407">99</span><span class="op" id="7492409">,</span>&nbsp;<span class="num" id="7492411">99</span><span class="op" id="7492413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492417">24</span><span class="op" id="7492419">,</span>&nbsp;<span class="num" id="7492421">26</span><span class="op" id="7492423">,</span>&nbsp;<span class="num" id="7492425">56</span><span class="op" id="7492427">,</span>&nbsp;<span class="num" id="7492429">99</span><span class="op" id="7492431">,</span>&nbsp;<span class="num" id="7492433">99</span><span class="op" id="7492435">,</span>&nbsp;<span class="num" id="7492437">99</span><span class="op" id="7492439">,</span>&nbsp;<span class="num" id="7492441">99</span><span class="op" id="7492443">,</span>&nbsp;<span class="num" id="7492445">99</span><span class="op" id="7492447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492451">47</span><span class="op" id="7492453">,</span>&nbsp;<span class="num" id="7492455">66</span><span class="op" id="7492457">,</span>&nbsp;<span class="num" id="7492459">99</span><span class="op" id="7492461">,</span>&nbsp;<span class="num" id="7492463">99</span><span class="op" id="7492465">,</span>&nbsp;<span class="num" id="7492467">99</span><span class="op" id="7492469">,</span>&nbsp;<span class="num" id="7492471">99</span><span class="op" id="7492473">,</span>&nbsp;<span class="num" id="7492475">99</span><span class="op" id="7492477">,</span>&nbsp;<span class="num" id="7492479">99</span><span class="op" id="7492481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492485">99</span><span class="op" id="7492487">,</span>&nbsp;<span class="num" id="7492489">99</span><span class="op" id="7492491">,</span>&nbsp;<span class="num" id="7492493">99</span><span class="op" id="7492495">,</span>&nbsp;<span class="num" id="7492497">99</span><span class="op" id="7492499">,</span>&nbsp;<span class="num" id="7492501">99</span><span class="op" id="7492503">,</span>&nbsp;<span class="num" id="7492505">99</span><span class="op" id="7492507">,</span>&nbsp;<span class="num" id="7492509">99</span><span class="op" id="7492511">,</span>&nbsp;<span class="num" id="7492513">99</span><span class="op" id="7492515">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492519">99</span><span class="op" id="7492521">,</span>&nbsp;<span class="num" id="7492523">99</span><span class="op" id="7492525">,</span>&nbsp;<span class="num" id="7492527">99</span><span class="op" id="7492529">,</span>&nbsp;<span class="num" id="7492531">99</span><span class="op" id="7492533">,</span>&nbsp;<span class="num" id="7492535">99</span><span class="op" id="7492537">,</span>&nbsp;<span class="num" id="7492539">99</span><span class="op" id="7492541">,</span>&nbsp;<span class="num" id="7492543">99</span><span class="op" id="7492545">,</span>&nbsp;<span class="num" id="7492547">99</span><span class="op" id="7492549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492553">99</span><span class="op" id="7492555">,</span>&nbsp;<span class="num" id="7492557">99</span><span class="op" id="7492559">,</span>&nbsp;<span class="num" id="7492561">99</span><span class="op" id="7492563">,</span>&nbsp;<span class="num" id="7492565">99</span><span class="op" id="7492567">,</span>&nbsp;<span class="num" id="7492569">99</span><span class="op" id="7492571">,</span>&nbsp;<span class="num" id="7492573">99</span><span class="op" id="7492575">,</span>&nbsp;<span class="num" id="7492577">99</span><span class="op" id="7492579">,</span>&nbsp;<span class="num" id="7492581">99</span><span class="op" id="7492583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7492587">99</span><span class="op" id="7492589">,</span>&nbsp;<span class="num" id="7492591">99</span><span class="op" id="7492593">,</span>&nbsp;<span class="num" id="7492595">99</span><span class="op" id="7492597">,</span>&nbsp;<span class="num" id="7492599">99</span><span class="op" id="7492601">,</span>&nbsp;<span class="num" id="7492603">99</span><span class="op" id="7492605">,</span>&nbsp;<span class="num" id="7492607">99</span><span class="op" id="7492609">,</span>&nbsp;<span class="num" id="7492611">99</span><span class="op" id="7492613">,</span>&nbsp;<span class="num" id="7492615">99</span><span class="op" id="7492617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492620">}</span><span class="op" id="7492621">,</span><br>
<span class="lineno"></span><span class="op" id="7492623">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7492626">func</span>&nbsp;<span class="ident" id="7492631">TestUnscaledQuant</span><span class="op" id="7492648">(</span><span class="ident" id="7492649">t</span>&nbsp;<span class="op" id="7492651">*</span><span class="ident" id="7492652"><a href="/image/jpeg/writer_test.go.html#7491084">testing</a></span><span class="op" id="7492659">.</span><span class="ident" id="7492660">T</span><span class="op" id="7492661">)</span>&nbsp;<span class="op" id="7492663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492666">bad</span>&nbsp;<span class="op" id="7492670">:=</span>&nbsp;<span class="ident" id="7492673">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492680">for</span>&nbsp;<span class="ident" id="7492684">i</span>&nbsp;<span class="op" id="7492686">:=</span>&nbsp;<span class="ident" id="7492689"><a href="/image/jpeg/writer.go.html#5432028">quantIndex</a></span><span class="op" id="7492699">(</span><span class="num" id="7492700">0</span><span class="op" id="7492701">)</span><span class="op" id="7492702">;</span>&nbsp;<span class="ident" id="7492704"><a href="/image/jpeg/writer_test.go.html#7492684">i</a></span>&nbsp;<span class="op" id="7492706">&lt;</span>&nbsp;<span class="ident" id="7492708"><a href="/image/jpeg/writer.go.html#5432115">nQuantIndex</a></span><span class="op" id="7492719">;</span>&nbsp;<span class="ident" id="7492721"><a href="/image/jpeg/writer_test.go.html#7492684">i</a></span><span class="op" id="7492722">++</span>&nbsp;<span class="op" id="7492725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492729">for</span>&nbsp;<span class="ident" id="7492733">zig</span>&nbsp;<span class="op" id="7492737">:=</span>&nbsp;<span class="num" id="7492740">0</span><span class="op" id="7492741">;</span>&nbsp;<span class="ident" id="7492743"><a href="/image/jpeg/writer_test.go.html#7492733">zig</a></span>&nbsp;<span class="op" id="7492747">&lt;</span>&nbsp;<span class="ident" id="7492749"><a href="/image/jpeg/idct.go.html#5398910">blockSize</a></span><span class="op" id="7492758">;</span>&nbsp;<span class="ident" id="7492760"><a href="/image/jpeg/writer_test.go.html#7492733">zig</a></span><span class="op" id="7492763">++</span>&nbsp;<span class="op" id="7492766">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492771">got</span>&nbsp;<span class="op" id="7492775">:=</span>&nbsp;<span class="ident" id="7492778"><a href="/image/jpeg/writer.go.html#5432381">unscaledQuant</a></span><span class="op" id="7492791">[</span><span class="ident" id="7492792"><a href="/image/jpeg/writer_test.go.html#7492684">i</a></span><span class="op" id="7492793">]</span><span class="op" id="7492794">[</span><span class="ident" id="7492795"><a href="/image/jpeg/writer_test.go.html#7492733">zig</a></span><span class="op" id="7492798">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492803">want</span>&nbsp;<span class="op" id="7492808">:=</span>&nbsp;<span class="ident" id="7492811"><a href="/image/jpeg/writer_test.go.html#7491962">unscaledQuantInNaturalOrder</a></span><span class="op" id="7492838">[</span><span class="ident" id="7492839"><a href="/image/jpeg/writer_test.go.html#7492684">i</a></span><span class="op" id="7492840">]</span><span class="op" id="7492841">[</span><span class="ident" id="7492842"><a href="/image/jpeg/reader.go.html#5404818">unzig</a></span><span class="op" id="7492847">[</span><span class="ident" id="7492848"><a href="/image/jpeg/writer_test.go.html#7492733">zig</a></span><span class="op" id="7492851">]</span><span class="op" id="7492852">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492857">if</span>&nbsp;<span class="ident" id="7492860"><a href="/image/jpeg/writer_test.go.html#7492771">got</a></span>&nbsp;<span class="op" id="7492864">!=</span>&nbsp;<span class="ident" id="7492867"><a href="/image/jpeg/writer_test.go.html#7492803">want</a></span>&nbsp;<span class="op" id="7492872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492878"><a href="/image/jpeg/writer_test.go.html#7492649">t</a></span><span class="op" id="7492879">.</span><span class="ident" id="7492880">Errorf</span><span class="op" id="7492886">(</span><span class="string" id="7492887">&#34;i=%d,&nbsp;zig=%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7492918">,</span>&nbsp;<span class="ident" id="7492920"><a href="/image/jpeg/writer_test.go.html#7492684">i</a></span><span class="op" id="7492921">,</span>&nbsp;<span class="ident" id="7492923"><a href="/image/jpeg/writer_test.go.html#7492733">zig</a></span><span class="op" id="7492926">,</span>&nbsp;<span class="ident" id="7492928"><a href="/image/jpeg/writer_test.go.html#7492771">got</a></span><span class="op" id="7492931">,</span>&nbsp;<span class="ident" id="7492933"><a href="/image/jpeg/writer_test.go.html#7492803">want</a></span><span class="op" id="7492937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492943"><a href="/image/jpeg/writer_test.go.html#7492666">bad</a></span>&nbsp;<span class="op" id="7492947">=</span>&nbsp;<span class="ident" id="7492949">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492967">if</span>&nbsp;<span class="ident" id="7492970"><a href="/image/jpeg/writer_test.go.html#7492666">bad</a></span>&nbsp;<span class="op" id="7492974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492978">names</span>&nbsp;<span class="op" id="7492984">:=</span>&nbsp;<span class="op" id="7492987">[</span><span class="ident" id="7492988"><a href="/image/jpeg/writer.go.html#5432115">nQuantIndex</a></span><span class="op" id="7492999">]</span><span class="builtintype" id="7493000">string</span><span class="op" id="7493006">{</span><span class="string" id="7493007">&#34;Luminance&#34;</span><span class="op" id="7493018">,</span>&nbsp;<span class="string" id="7493020">&#34;Chrominance&#34;</span><span class="op" id="7493033">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493037">buf</span>&nbsp;<span class="op" id="7493041">:=</span>&nbsp;<span class="op" id="7493044">&amp;</span><span class="ident" id="7493045"><a href="/image/jpeg/writer_test.go.html#7490999">bytes</a></span><span class="op" id="7493050">.</span><span class="ident" id="7493051">Buffer</span><span class="op" id="7493057">{</span><span class="op" id="7493058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493062">for</span>&nbsp;<span class="ident" id="7493066">i</span><span class="op" id="7493067">,</span>&nbsp;<span class="ident" id="7493069">name</span>&nbsp;<span class="op" id="7493074">:=</span>&nbsp;<span class="keyword" id="7493077">range</span>&nbsp;<span class="ident" id="7493083"><a href="/image/jpeg/writer_test.go.html#7492978">names</a></span>&nbsp;<span class="op" id="7493089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493094"><a href="/image/jpeg/writer_test.go.html#7491008">fmt</a></span><span class="op" id="7493097">.</span><span class="ident" id="7493098">Fprintf</span><span class="op" id="7493105">(</span><span class="ident" id="7493106"><a href="/image/jpeg/writer_test.go.html#7493037">buf</a></span><span class="op" id="7493109">,</span>&nbsp;<span class="string" id="7493111">&#34;//&nbsp;%s.\n{\n&#34;</span><span class="op" id="7493124">,</span>&nbsp;<span class="ident" id="7493126"><a href="/image/jpeg/writer_test.go.html#7493069">name</a></span><span class="op" id="7493130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493135">for</span>&nbsp;<span class="ident" id="7493139">zig</span>&nbsp;<span class="op" id="7493143">:=</span>&nbsp;<span class="num" id="7493146">0</span><span class="op" id="7493147">;</span>&nbsp;<span class="ident" id="7493149"><a href="/image/jpeg/writer_test.go.html#7493139">zig</a></span>&nbsp;<span class="op" id="7493153">&lt;</span>&nbsp;<span class="ident" id="7493155"><a href="/image/jpeg/idct.go.html#5398910">blockSize</a></span><span class="op" id="7493164">;</span>&nbsp;<span class="ident" id="7493166"><a href="/image/jpeg/writer_test.go.html#7493139">zig</a></span><span class="op" id="7493169">++</span>&nbsp;<span class="op" id="7493172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493178"><a href="/image/jpeg/writer_test.go.html#7491008">fmt</a></span><span class="op" id="7493181">.</span><span class="ident" id="7493182">Fprintf</span><span class="op" id="7493189">(</span><span class="ident" id="7493190"><a href="/image/jpeg/writer_test.go.html#7493037">buf</a></span><span class="op" id="7493193">,</span>&nbsp;<span class="string" id="7493195">&#34;%d,&nbsp;&#34;</span><span class="op" id="7493201">,</span>&nbsp;<span class="ident" id="7493203"><a href="/image/jpeg/writer_test.go.html#7491962">unscaledQuantInNaturalOrder</a></span><span class="op" id="7493230">[</span><span class="ident" id="7493231"><a href="/image/jpeg/writer_test.go.html#7493066">i</a></span><span class="op" id="7493232">]</span><span class="op" id="7493233">[</span><span class="ident" id="7493234"><a href="/image/jpeg/reader.go.html#5404818">unzig</a></span><span class="op" id="7493239">[</span><span class="ident" id="7493240"><a href="/image/jpeg/writer_test.go.html#7493139">zig</a></span><span class="op" id="7493243">]</span><span class="op" id="7493244">]</span><span class="op" id="7493245">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493251">if</span>&nbsp;<span class="ident" id="7493254"><a href="/image/jpeg/writer_test.go.html#7493139">zig</a></span><span class="op" id="7493257">%</span><span class="num" id="7493258">8</span>&nbsp;<span class="op" id="7493260">==</span>&nbsp;<span class="num" id="7493263">7</span>&nbsp;<span class="op" id="7493265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493272"><a href="/image/jpeg/writer_test.go.html#7493037">buf</a></span><span class="op" id="7493275">.</span><span class="ident" id="7493276">WriteString</span><span class="op" id="7493287">(</span><span class="string" id="7493288">&#34;\n&#34;</span><span class="op" id="7493292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493308"><a href="/image/jpeg/writer_test.go.html#7493037">buf</a></span><span class="op" id="7493311">.</span><span class="ident" id="7493312">WriteString</span><span class="op" id="7493323">(</span><span class="string" id="7493324">&#34;},\n&#34;</span><span class="op" id="7493330">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493338"><a href="/image/jpeg/writer_test.go.html#7492649">t</a></span><span class="op" id="7493339">.</span><span class="ident" id="7493340">Logf</span><span class="op" id="7493344">(</span><span class="string" id="7493345">&#34;expected&nbsp;unscaledQuant&nbsp;values:\n%s&#34;</span><span class="op" id="7493381">,</span>&nbsp;<span class="ident" id="7493383"><a href="/image/jpeg/writer_test.go.html#7493037">buf</a></span><span class="op" id="7493386">.</span><span class="ident" id="7493387">String</span><span class="op" id="7493393">(</span><span class="op" id="7493394">)</span><span class="op" id="7493395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493398">}</span><br>
<span class="lineno"></span><span class="op" id="7493400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="7493403">var</span>&nbsp;<span class="ident" id="7493407">testCase</span>&nbsp;<span class="op" id="7493416">=</span>&nbsp;<span class="op" id="7493418">[</span><span class="op" id="7493419">]</span><span class="keyword" id="7493420">struct</span>&nbsp;<span class="op" id="7493427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493430">filename</span>&nbsp;&nbsp;<span class="builtintype" id="7493440">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493448">quality</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7493458">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493463">tolerance</span>&nbsp;<span class="ident" id="7493473">int64</span><br>
<span class="lineno"></span><span class="op" id="7493479">}</span><span class="op" id="7493480">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493483">{</span><span class="string" id="7493484">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7493511">,</span>&nbsp;<span class="num" id="7493513">1</span><span class="op" id="7493514">,</span>&nbsp;<span class="num" id="7493516">24</span>&nbsp;<span class="op" id="7493519">&lt;&lt;</span>&nbsp;<span class="num" id="7493522">8</span><span class="op" id="7493523">}</span><span class="op" id="7493524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493527">{</span><span class="string" id="7493528">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7493555">,</span>&nbsp;<span class="num" id="7493557">20</span><span class="op" id="7493559">,</span>&nbsp;<span class="num" id="7493561">12</span>&nbsp;<span class="op" id="7493564">&lt;&lt;</span>&nbsp;<span class="num" id="7493567">8</span><span class="op" id="7493568">}</span><span class="op" id="7493569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493572">{</span><span class="string" id="7493573">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7493600">,</span>&nbsp;<span class="num" id="7493602">60</span><span class="op" id="7493604">,</span>&nbsp;<span class="num" id="7493606">8</span>&nbsp;<span class="op" id="7493608">&lt;&lt;</span>&nbsp;<span class="num" id="7493611">8</span><span class="op" id="7493612">}</span><span class="op" id="7493613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493616">{</span><span class="string" id="7493617">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7493644">,</span>&nbsp;<span class="num" id="7493646">80</span><span class="op" id="7493648">,</span>&nbsp;<span class="num" id="7493650">6</span>&nbsp;<span class="op" id="7493652">&lt;&lt;</span>&nbsp;<span class="num" id="7493655">8</span><span class="op" id="7493656">}</span><span class="op" id="7493657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493660">{</span><span class="string" id="7493661">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7493688">,</span>&nbsp;<span class="num" id="7493690">90</span><span class="op" id="7493692">,</span>&nbsp;<span class="num" id="7493694">4</span>&nbsp;<span class="op" id="7493696">&lt;&lt;</span>&nbsp;<span class="num" id="7493699">8</span><span class="op" id="7493700">}</span><span class="op" id="7493701">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493704">{</span><span class="string" id="7493705">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7493732">,</span>&nbsp;<span class="num" id="7493734">100</span><span class="op" id="7493737">,</span>&nbsp;<span class="num" id="7493739">2</span>&nbsp;<span class="op" id="7493741">&lt;&lt;</span>&nbsp;<span class="num" id="7493744">8</span><span class="op" id="7493745">}</span><span class="op" id="7493746">,</span><br>
<span class="lineno"></span><span class="op" id="7493748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7493751">func</span>&nbsp;<span class="ident" id="7493756">delta</span><span class="op" id="7493761">(</span><span class="ident" id="7493762">u0</span><span class="op" id="7493764">,</span>&nbsp;<span class="ident" id="7493766">u1</span>&nbsp;<span class="builtintype" id="7493769">uint32</span><span class="op" id="7493775">)</span>&nbsp;<span class="ident" id="7493777">int64</span>&nbsp;<span class="op" id="7493783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493786">d</span>&nbsp;<span class="op" id="7493788">:=</span>&nbsp;<span class="ident" id="7493791">int64</span><span class="op" id="7493796">(</span><span class="ident" id="7493797"><a href="/image/jpeg/writer_test.go.html#7493762">u0</a></span><span class="op" id="7493799">)</span>&nbsp;<span class="op" id="7493801">-</span>&nbsp;<span class="ident" id="7493803">int64</span><span class="op" id="7493808">(</span><span class="ident" id="7493809"><a href="/image/jpeg/writer_test.go.html#7493766">u1</a></span><span class="op" id="7493811">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493814">if</span>&nbsp;<span class="ident" id="7493817"><a href="/image/jpeg/writer_test.go.html#7493786">d</a></span>&nbsp;<span class="op" id="7493819">&lt;</span>&nbsp;<span class="num" id="7493821">0</span>&nbsp;<span class="op" id="7493823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493827">return</span>&nbsp;<span class="op" id="7493834">-</span><span class="ident" id="7493835"><a href="/image/jpeg/writer_test.go.html#7493786">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493841">return</span>&nbsp;<span class="ident" id="7493848"><a href="/image/jpeg/writer_test.go.html#7493786">d</a></span><br>
<span class="lineno"></span><span class="op" id="7493850">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7493853">func</span>&nbsp;<span class="ident" id="7493858">readPng</span><span class="op" id="7493865">(</span><span class="ident" id="7493866">filename</span>&nbsp;<span class="builtintype" id="7493875">string</span><span class="op" id="7493881">)</span>&nbsp;<span class="op" id="7493883">(</span><span class="ident" id="7493884"><a href="/image/jpeg/writer_test.go.html#7491015">image</a></span><span class="op" id="7493889">.</span><span class="ident" id="7493890">Image</span><span class="op" id="7493895">,</span>&nbsp;<span class="builtintype" id="7493897">error</span><span class="op" id="7493902">)</span>&nbsp;<span class="op" id="7493904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493907">f</span><span class="op" id="7493908">,</span>&nbsp;<span class="ident" id="7493910">err</span>&nbsp;<span class="op" id="7493914">:=</span>&nbsp;<span class="ident" id="7493917"><a href="/image/jpeg/writer_test.go.html#7491078">os</a></span><span class="op" id="7493919">.</span><span class="ident" id="7493920">Open</span><span class="op" id="7493924">(</span><span class="ident" id="7493925"><a href="/image/jpeg/writer_test.go.html#7493866">filename</a></span><span class="op" id="7493933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493936">if</span>&nbsp;<span class="ident" id="7493939"><a href="/image/jpeg/writer_test.go.html#7493910">err</a></span>&nbsp;<span class="op" id="7493943">!=</span>&nbsp;<span class="ident" id="7493946">nil</span>&nbsp;<span class="op" id="7493950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493954">return</span>&nbsp;<span class="ident" id="7493961">nil</span><span class="op" id="7493964">,</span>&nbsp;<span class="ident" id="7493966"><a href="/image/jpeg/writer_test.go.html#7493910">err</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493974">defer</span>&nbsp;<span class="ident" id="7493980"><a href="/image/jpeg/writer_test.go.html#7493907">f</a></span><span class="op" id="7493981">.</span><span class="ident" id="7493982">Close</span><span class="op" id="7493987">(</span><span class="op" id="7493988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493991">return</span>&nbsp;<span class="ident" id="7493998"><a href="/image/jpeg/writer_test.go.html#7491039">png</a></span><span class="op" id="7494001">.</span><span class="ident" id="7494002">Decode</span><span class="op" id="7494008">(</span><span class="ident" id="7494009"><a href="/image/jpeg/writer_test.go.html#7493907">f</a></span><span class="op" id="7494010">)</span><br>
<span class="lineno"></span><span class="op" id="7494012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7494015">func</span>&nbsp;<span class="ident" id="7494020">TestWriter</span><span class="op" id="7494030">(</span><span class="ident" id="7494031">t</span>&nbsp;<span class="op" id="7494033">*</span><span class="ident" id="7494034"><a href="/image/jpeg/writer_test.go.html#7491084">testing</a></span><span class="op" id="7494041">.</span><span class="ident" id="7494042">T</span><span class="op" id="7494043">)</span>&nbsp;<span class="op" id="7494045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494048">for</span>&nbsp;<span class="ident" id="7494052">_</span><span class="op" id="7494053">,</span>&nbsp;<span class="ident" id="7494055">tc</span>&nbsp;<span class="op" id="7494058">:=</span>&nbsp;<span class="keyword" id="7494061">range</span>&nbsp;<span class="ident" id="7494067"><a href="/image/jpeg/writer_test.go.html#7493407">testCase</a></span>&nbsp;<span class="op" id="7494076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7494080">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494101">m0</span><span class="op" id="7494103">,</span>&nbsp;<span class="ident" id="7494105">err</span>&nbsp;<span class="op" id="7494109">:=</span>&nbsp;<span class="ident" id="7494112"><a href="/image/jpeg/writer_test.go.html#7493858">readPng</a></span><span class="op" id="7494119">(</span><span class="ident" id="7494120"><a href="/image/jpeg/writer_test.go.html#7494055">tc</a></span><span class="op" id="7494122">.</span><span class="ident" id="7494123">filename</span><span class="op" id="7494131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494135">if</span>&nbsp;<span class="ident" id="7494138"><a href="/image/jpeg/writer_test.go.html#7494105">err</a></span>&nbsp;<span class="op" id="7494142">!=</span>&nbsp;<span class="ident" id="7494145">nil</span>&nbsp;<span class="op" id="7494149">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494154"><a href="/image/jpeg/writer_test.go.html#7494031">t</a></span><span class="op" id="7494155">.</span><span class="ident" id="7494156">Error</span><span class="op" id="7494161">(</span><span class="ident" id="7494162"><a href="/image/jpeg/writer_test.go.html#7494055">tc</a></span><span class="op" id="7494164">.</span><span class="ident" id="7494165">filename</span><span class="op" id="7494173">,</span>&nbsp;<span class="ident" id="7494175"><a href="/image/jpeg/writer_test.go.html#7494105">err</a></span><span class="op" id="7494178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494183">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7494198">//&nbsp;Encode&nbsp;that&nbsp;image&nbsp;as&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494230">var</span>&nbsp;<span class="ident" id="7494234">buf</span>&nbsp;<span class="ident" id="7494238"><a href="/image/jpeg/writer_test.go.html#7490999">bytes</a></span><span class="op" id="7494243">.</span><span class="ident" id="7494244">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494253"><a href="/image/jpeg/writer_test.go.html#7494105">err</a></span>&nbsp;<span class="op" id="7494257">=</span>&nbsp;<span class="ident" id="7494259"><a href="/image/jpeg/writer.go.html#5446040">Encode</a></span><span class="op" id="7494265">(</span><span class="op" id="7494266">&amp;</span><span class="ident" id="7494267"><a href="/image/jpeg/writer_test.go.html#7494234">buf</a></span><span class="op" id="7494270">,</span>&nbsp;<span class="ident" id="7494272"><a href="/image/jpeg/writer_test.go.html#7494101">m0</a></span><span class="op" id="7494274">,</span>&nbsp;<span class="op" id="7494276">&amp;</span><span class="ident" id="7494277"><a href="/image/jpeg/writer.go.html#5445854">Options</a></span><span class="op" id="7494284">{</span><span class="ident" id="7494285">Quality</span><span class="op" id="7494292">:</span>&nbsp;<span class="ident" id="7494294"><a href="/image/jpeg/writer_test.go.html#7494055">tc</a></span><span class="op" id="7494296">.</span><span class="ident" id="7494297">quality</span><span class="op" id="7494304">}</span><span class="op" id="7494305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494309">if</span>&nbsp;<span class="ident" id="7494312"><a href="/image/jpeg/writer_test.go.html#7494105">err</a></span>&nbsp;<span class="op" id="7494316">!=</span>&nbsp;<span class="ident" id="7494319">nil</span>&nbsp;<span class="op" id="7494323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494328"><a href="/image/jpeg/writer_test.go.html#7494031">t</a></span><span class="op" id="7494329">.</span><span class="ident" id="7494330">Error</span><span class="op" id="7494335">(</span><span class="ident" id="7494336"><a href="/image/jpeg/writer_test.go.html#7494055">tc</a></span><span class="op" id="7494338">.</span><span class="ident" id="7494339">filename</span><span class="op" id="7494347">,</span>&nbsp;<span class="ident" id="7494349"><a href="/image/jpeg/writer_test.go.html#7494105">err</a></span><span class="op" id="7494352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494357">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494368">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7494372">//&nbsp;Decode&nbsp;that&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494395">m1</span><span class="op" id="7494397">,</span>&nbsp;<span class="ident" id="7494399"><a href="/image/jpeg/writer_test.go.html#7494105">err</a></span>&nbsp;<span class="op" id="7494403">:=</span>&nbsp;<span class="ident" id="7494406"><a href="/image/jpeg/reader.go.html#5417124">Decode</a></span><span class="op" id="7494412">(</span><span class="op" id="7494413">&amp;</span><span class="ident" id="7494414"><a href="/image/jpeg/writer_test.go.html#7494234">buf</a></span><span class="op" id="7494417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494421">if</span>&nbsp;<span class="ident" id="7494424"><a href="/image/jpeg/writer_test.go.html#7494105">err</a></span>&nbsp;<span class="op" id="7494428">!=</span>&nbsp;<span class="ident" id="7494431">nil</span>&nbsp;<span class="op" id="7494435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494440"><a href="/image/jpeg/writer_test.go.html#7494031">t</a></span><span class="op" id="7494441">.</span><span class="ident" id="7494442">Error</span><span class="op" id="7494447">(</span><span class="ident" id="7494448"><a href="/image/jpeg/writer_test.go.html#7494055">tc</a></span><span class="op" id="7494450">.</span><span class="ident" id="7494451">filename</span><span class="op" id="7494459">,</span>&nbsp;<span class="ident" id="7494461"><a href="/image/jpeg/writer_test.go.html#7494105">err</a></span><span class="op" id="7494464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494469">continue</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494484">if</span>&nbsp;<span class="ident" id="7494487"><a href="/image/jpeg/writer_test.go.html#7494101">m0</a></span><span class="op" id="7494489">.</span><span class="ident" id="7494490">Bounds</span><span class="op" id="7494496">(</span><span class="op" id="7494497">)</span>&nbsp;<span class="op" id="7494499">!=</span>&nbsp;<span class="ident" id="7494502"><a href="/image/jpeg/writer_test.go.html#7494395">m1</a></span><span class="op" id="7494504">.</span><span class="ident" id="7494505">Bounds</span><span class="op" id="7494511">(</span><span class="op" id="7494512">)</span>&nbsp;<span class="op" id="7494514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494519"><a href="/image/jpeg/writer_test.go.html#7494031">t</a></span><span class="op" id="7494520">.</span><span class="ident" id="7494521">Errorf</span><span class="op" id="7494527">(</span><span class="string" id="7494528">&#34;%s,&nbsp;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7494558">,</span>&nbsp;<span class="ident" id="7494560"><a href="/image/jpeg/writer_test.go.html#7494055">tc</a></span><span class="op" id="7494562">.</span><span class="ident" id="7494563">filename</span><span class="op" id="7494571">,</span>&nbsp;<span class="ident" id="7494573"><a href="/image/jpeg/writer_test.go.html#7494101">m0</a></span><span class="op" id="7494575">.</span><span class="ident" id="7494576">Bounds</span><span class="op" id="7494582">(</span><span class="op" id="7494583">)</span><span class="op" id="7494584">,</span>&nbsp;<span class="ident" id="7494586"><a href="/image/jpeg/writer_test.go.html#7494395">m1</a></span><span class="op" id="7494588">.</span><span class="ident" id="7494589">Bounds</span><span class="op" id="7494595">(</span><span class="op" id="7494596">)</span><span class="op" id="7494597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494602">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494613">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7494617">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494672">if</span>&nbsp;<span class="ident" id="7494675"><a href="/image/jpeg/writer_test.go.html#7495695">averageDelta</a></span><span class="op" id="7494687">(</span><span class="ident" id="7494688"><a href="/image/jpeg/writer_test.go.html#7494101">m0</a></span><span class="op" id="7494690">,</span>&nbsp;<span class="ident" id="7494692"><a href="/image/jpeg/writer_test.go.html#7494395">m1</a></span><span class="op" id="7494694">)</span>&nbsp;<span class="op" id="7494696">&gt;</span>&nbsp;<span class="ident" id="7494698"><a href="/image/jpeg/writer_test.go.html#7494055">tc</a></span><span class="op" id="7494700">.</span><span class="ident" id="7494701">tolerance</span>&nbsp;<span class="op" id="7494711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494716"><a href="/image/jpeg/writer_test.go.html#7494031">t</a></span><span class="op" id="7494717">.</span><span class="ident" id="7494718">Errorf</span><span class="op" id="7494724">(</span><span class="string" id="7494725">&#34;%s,&nbsp;quality=%d:&nbsp;average&nbsp;delta&nbsp;is&nbsp;too&nbsp;high&#34;</span><span class="op" id="7494768">,</span>&nbsp;<span class="ident" id="7494770"><a href="/image/jpeg/writer_test.go.html#7494055">tc</a></span><span class="op" id="7494772">.</span><span class="ident" id="7494773">filename</span><span class="op" id="7494781">,</span>&nbsp;<span class="ident" id="7494783"><a href="/image/jpeg/writer_test.go.html#7494055">tc</a></span><span class="op" id="7494785">.</span><span class="ident" id="7494786">quality</span><span class="op" id="7494793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494798">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494809">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494812">}</span><br>
<span class="lineno"></span><span class="op" id="7494814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7494817">//&nbsp;TestWriteGrayscale&nbsp;tests&nbsp;that&nbsp;a&nbsp;grayscale&nbsp;images&nbsp;survives&nbsp;a&nbsp;round-trip</span><br>
<span class="lineno"></span><span class="comment" id="7494891">//&nbsp;through&nbsp;encode/decode&nbsp;cycle.</span><br>
<span class="lineno">165</span><span class="keyword" id="7494923">func</span>&nbsp;<span class="ident" id="7494928">TestWriteGrayscale</span><span class="op" id="7494946">(</span><span class="ident" id="7494947">t</span>&nbsp;<span class="op" id="7494949">*</span><span class="ident" id="7494950"><a href="/image/jpeg/writer_test.go.html#7491084">testing</a></span><span class="op" id="7494957">.</span><span class="ident" id="7494958">T</span><span class="op" id="7494959">)</span>&nbsp;<span class="op" id="7494961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494964">m0</span>&nbsp;<span class="op" id="7494967">:=</span>&nbsp;<span class="ident" id="7494970"><a href="/image/jpeg/writer_test.go.html#7491015">image</a></span><span class="op" id="7494975">.</span><span class="ident" id="7494976">NewGray</span><span class="op" id="7494983">(</span><span class="ident" id="7494984"><a href="/image/jpeg/writer_test.go.html#7491015">image</a></span><span class="op" id="7494989">.</span><span class="ident" id="7494990">Rect</span><span class="op" id="7494994">(</span><span class="num" id="7494995">0</span><span class="op" id="7494996">,</span>&nbsp;<span class="num" id="7494998">0</span><span class="op" id="7494999">,</span>&nbsp;<span class="num" id="7495001">32</span><span class="op" id="7495003">,</span>&nbsp;<span class="num" id="7495005">32</span><span class="op" id="7495007">)</span><span class="op" id="7495008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495011">for</span>&nbsp;<span class="ident" id="7495015">i</span>&nbsp;<span class="op" id="7495017">:=</span>&nbsp;<span class="keyword" id="7495020">range</span>&nbsp;<span class="ident" id="7495026"><a href="/image/jpeg/writer_test.go.html#7494964">m0</a></span><span class="op" id="7495028">.</span><span class="ident" id="7495029">Pix</span>&nbsp;<span class="op" id="7495033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495037"><a href="/image/jpeg/writer_test.go.html#7494964">m0</a></span><span class="op" id="7495039">.</span><span class="ident" id="7495040">Pix</span><span class="op" id="7495043">[</span><span class="ident" id="7495044"><a href="/image/jpeg/writer_test.go.html#7495015">i</a></span><span class="op" id="7495045">]</span>&nbsp;<span class="op" id="7495047">=</span>&nbsp;<span class="builtintype" id="7495049">uint8</span><span class="op" id="7495054">(</span><span class="ident" id="7495055"><a href="/image/jpeg/writer_test.go.html#7495015">i</a></span><span class="op" id="7495056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495059">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495062">var</span>&nbsp;<span class="ident" id="7495066">buf</span>&nbsp;<span class="ident" id="7495070"><a href="/image/jpeg/writer_test.go.html#7490999">bytes</a></span><span class="op" id="7495075">.</span><span class="ident" id="7495076">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495084">if</span>&nbsp;<span class="ident" id="7495087">err</span>&nbsp;<span class="op" id="7495091">:=</span>&nbsp;<span class="ident" id="7495094"><a href="/image/jpeg/writer.go.html#5446040">Encode</a></span><span class="op" id="7495100">(</span><span class="op" id="7495101">&amp;</span><span class="ident" id="7495102"><a href="/image/jpeg/writer_test.go.html#7495066">buf</a></span><span class="op" id="7495105">,</span>&nbsp;<span class="ident" id="7495107"><a href="/image/jpeg/writer_test.go.html#7494964">m0</a></span><span class="op" id="7495109">,</span>&nbsp;<span class="ident" id="7495111">nil</span><span class="op" id="7495114">)</span><span class="op" id="7495115">;</span>&nbsp;<span class="ident" id="7495117"><a href="/image/jpeg/writer_test.go.html#7495087">err</a></span>&nbsp;<span class="op" id="7495121">!=</span>&nbsp;<span class="ident" id="7495124">nil</span>&nbsp;<span class="op" id="7495128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495132"><a href="/image/jpeg/writer_test.go.html#7494947">t</a></span><span class="op" id="7495133">.</span><span class="ident" id="7495134">Fatal</span><span class="op" id="7495139">(</span><span class="ident" id="7495140"><a href="/image/jpeg/writer_test.go.html#7495087">err</a></span><span class="op" id="7495143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495149">m1</span><span class="op" id="7495151">,</span>&nbsp;<span class="ident" id="7495153">err</span>&nbsp;<span class="op" id="7495157">:=</span>&nbsp;<span class="ident" id="7495160"><a href="/image/jpeg/reader.go.html#5417124">Decode</a></span><span class="op" id="7495166">(</span><span class="op" id="7495167">&amp;</span><span class="ident" id="7495168"><a href="/image/jpeg/writer_test.go.html#7495066">buf</a></span><span class="op" id="7495171">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495174">if</span>&nbsp;<span class="ident" id="7495177"><a href="/image/jpeg/writer_test.go.html#7495153">err</a></span>&nbsp;<span class="op" id="7495181">!=</span>&nbsp;<span class="ident" id="7495184">nil</span>&nbsp;<span class="op" id="7495188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495192"><a href="/image/jpeg/writer_test.go.html#7494947">t</a></span><span class="op" id="7495193">.</span><span class="ident" id="7495194">Fatal</span><span class="op" id="7495199">(</span><span class="ident" id="7495200"><a href="/image/jpeg/writer_test.go.html#7495153">err</a></span><span class="op" id="7495203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495209">if</span>&nbsp;<span class="ident" id="7495212"><a href="/image/jpeg/writer_test.go.html#7494964">m0</a></span><span class="op" id="7495214">.</span><span class="ident" id="7495215">Bounds</span><span class="op" id="7495221">(</span><span class="op" id="7495222">)</span>&nbsp;<span class="op" id="7495224">!=</span>&nbsp;<span class="ident" id="7495227"><a href="/image/jpeg/writer_test.go.html#7495149">m1</a></span><span class="op" id="7495229">.</span><span class="ident" id="7495230">Bounds</span><span class="op" id="7495236">(</span><span class="op" id="7495237">)</span>&nbsp;<span class="op" id="7495239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495243"><a href="/image/jpeg/writer_test.go.html#7494947">t</a></span><span class="op" id="7495244">.</span><span class="ident" id="7495245">Fatalf</span><span class="op" id="7495251">(</span><span class="string" id="7495252">&#34;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7495278">,</span>&nbsp;<span class="ident" id="7495280"><a href="/image/jpeg/writer_test.go.html#7494964">m0</a></span><span class="op" id="7495282">.</span><span class="ident" id="7495283">Bounds</span><span class="op" id="7495289">(</span><span class="op" id="7495290">)</span><span class="op" id="7495291">,</span>&nbsp;<span class="ident" id="7495293"><a href="/image/jpeg/writer_test.go.html#7495149">m1</a></span><span class="op" id="7495295">.</span><span class="ident" id="7495296">Bounds</span><span class="op" id="7495302">(</span><span class="op" id="7495303">)</span><span class="op" id="7495304">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495310">if</span>&nbsp;<span class="ident" id="7495313">_</span><span class="op" id="7495314">,</span>&nbsp;<span class="ident" id="7495316">ok</span>&nbsp;<span class="op" id="7495319">:=</span>&nbsp;<span class="ident" id="7495322"><a href="/image/jpeg/writer_test.go.html#7495149">m1</a></span><span class="op" id="7495324">.</span><span class="op" id="7495325">(</span><span class="op" id="7495326">*</span><span class="ident" id="7495327"><a href="/image/jpeg/writer_test.go.html#7491015">image</a></span><span class="op" id="7495332">.</span><span class="ident" id="7495333">Gray</span><span class="op" id="7495337">)</span><span class="op" id="7495338">;</span>&nbsp;<span class="op" id="7495340">!</span><span class="ident" id="7495341"><a href="/image/jpeg/writer_test.go.html#7495316">ok</a></span>&nbsp;<span class="op" id="7495344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495348"><a href="/image/jpeg/writer_test.go.html#7494947">t</a></span><span class="op" id="7495349">.</span><span class="ident" id="7495350">Errorf</span><span class="op" id="7495356">(</span><span class="string" id="7495357">&#34;got&nbsp;%T,&nbsp;want&nbsp;*image.Gray&#34;</span><span class="op" id="7495383">,</span>&nbsp;<span class="ident" id="7495385"><a href="/image/jpeg/writer_test.go.html#7495149">m1</a></span><span class="op" id="7495387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7495393">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495447">want</span>&nbsp;<span class="op" id="7495452">:=</span>&nbsp;<span class="ident" id="7495455">int64</span><span class="op" id="7495460">(</span><span class="num" id="7495461">2</span>&nbsp;<span class="op" id="7495463">&lt;&lt;</span>&nbsp;<span class="num" id="7495466">8</span><span class="op" id="7495467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495470">if</span>&nbsp;<span class="ident" id="7495473">got</span>&nbsp;<span class="op" id="7495477">:=</span>&nbsp;<span class="ident" id="7495480"><a href="/image/jpeg/writer_test.go.html#7495695">averageDelta</a></span><span class="op" id="7495492">(</span><span class="ident" id="7495493"><a href="/image/jpeg/writer_test.go.html#7494964">m0</a></span><span class="op" id="7495495">,</span>&nbsp;<span class="ident" id="7495497"><a href="/image/jpeg/writer_test.go.html#7495149">m1</a></span><span class="op" id="7495499">)</span><span class="op" id="7495500">;</span>&nbsp;<span class="ident" id="7495502"><a href="/image/jpeg/writer_test.go.html#7495473">got</a></span>&nbsp;<span class="op" id="7495506">&gt;</span>&nbsp;<span class="ident" id="7495508"><a href="/image/jpeg/writer_test.go.html#7495447">want</a></span>&nbsp;<span class="op" id="7495513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495517"><a href="/image/jpeg/writer_test.go.html#7494947">t</a></span><span class="op" id="7495518">.</span><span class="ident" id="7495519">Errorf</span><span class="op" id="7495525">(</span><span class="string" id="7495526">&#34;average&nbsp;delta&nbsp;too&nbsp;high;&nbsp;got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&#34;</span><span class="op" id="7495570">,</span>&nbsp;<span class="ident" id="7495572"><a href="/image/jpeg/writer_test.go.html#7495473">got</a></span><span class="op" id="7495575">,</span>&nbsp;<span class="ident" id="7495577"><a href="/image/jpeg/writer_test.go.html#7495447">want</a></span><span class="op" id="7495581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495584">}</span><br>
<span class="lineno"></span><span class="op" id="7495586">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="7495589">//&nbsp;averageDelta&nbsp;returns&nbsp;the&nbsp;average&nbsp;delta&nbsp;in&nbsp;RGB&nbsp;space.&nbsp;The&nbsp;two&nbsp;images&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="7495665">//&nbsp;have&nbsp;the&nbsp;same&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword" id="7495690">func</span>&nbsp;<span class="ident" id="7495695">averageDelta</span><span class="op" id="7495707">(</span><span class="ident" id="7495708">m0</span><span class="op" id="7495710">,</span>&nbsp;<span class="ident" id="7495712">m1</span>&nbsp;<span class="ident" id="7495715"><a href="/image/jpeg/writer_test.go.html#7491015">image</a></span><span class="op" id="7495720">.</span><span class="ident" id="7495721">Image</span><span class="op" id="7495726">)</span>&nbsp;<span class="ident" id="7495728">int64</span>&nbsp;<span class="op" id="7495734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495737">b</span>&nbsp;<span class="op" id="7495739">:=</span>&nbsp;<span class="ident" id="7495742"><a href="/image/jpeg/writer_test.go.html#7495708">m0</a></span><span class="op" id="7495744">.</span><span class="ident" id="7495745">Bounds</span><span class="op" id="7495751">(</span><span class="op" id="7495752">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495755">var</span>&nbsp;<span class="ident" id="7495759">sum</span><span class="op" id="7495762">,</span>&nbsp;<span class="ident" id="7495764">n</span>&nbsp;<span class="ident" id="7495766">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495773">for</span>&nbsp;<span class="ident" id="7495777">y</span>&nbsp;<span class="op" id="7495779">:=</span>&nbsp;<span class="ident" id="7495782"><a href="/image/jpeg/writer_test.go.html#7495737">b</a></span><span class="op" id="7495783">.</span><span class="ident" id="7495784">Min</span><span class="op" id="7495787">.</span><span class="ident" id="7495788">Y</span><span class="op" id="7495789">;</span>&nbsp;<span class="ident" id="7495791"><a href="/image/jpeg/writer_test.go.html#7495777">y</a></span>&nbsp;<span class="op" id="7495793">&lt;</span>&nbsp;<span class="ident" id="7495795"><a href="/image/jpeg/writer_test.go.html#7495737">b</a></span><span class="op" id="7495796">.</span><span class="ident" id="7495797">Max</span><span class="op" id="7495800">.</span><span class="ident" id="7495801">Y</span><span class="op" id="7495802">;</span>&nbsp;<span class="ident" id="7495804"><a href="/image/jpeg/writer_test.go.html#7495777">y</a></span><span class="op" id="7495805">++</span>&nbsp;<span class="op" id="7495808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495812">for</span>&nbsp;<span class="ident" id="7495816">x</span>&nbsp;<span class="op" id="7495818">:=</span>&nbsp;<span class="ident" id="7495821"><a href="/image/jpeg/writer_test.go.html#7495737">b</a></span><span class="op" id="7495822">.</span><span class="ident" id="7495823">Min</span><span class="op" id="7495826">.</span><span class="ident" id="7495827">X</span><span class="op" id="7495828">;</span>&nbsp;<span class="ident" id="7495830"><a href="/image/jpeg/writer_test.go.html#7495816">x</a></span>&nbsp;<span class="op" id="7495832">&lt;</span>&nbsp;<span class="ident" id="7495834"><a href="/image/jpeg/writer_test.go.html#7495737">b</a></span><span class="op" id="7495835">.</span><span class="ident" id="7495836">Max</span><span class="op" id="7495839">.</span><span class="ident" id="7495840">X</span><span class="op" id="7495841">;</span>&nbsp;<span class="ident" id="7495843"><a href="/image/jpeg/writer_test.go.html#7495816">x</a></span><span class="op" id="7495844">++</span>&nbsp;<span class="op" id="7495847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495852">c0</span>&nbsp;<span class="op" id="7495855">:=</span>&nbsp;<span class="ident" id="7495858"><a href="/image/jpeg/writer_test.go.html#7495708">m0</a></span><span class="op" id="7495860">.</span><span class="ident" id="7495861">At</span><span class="op" id="7495863">(</span><span class="ident" id="7495864"><a href="/image/jpeg/writer_test.go.html#7495816">x</a></span><span class="op" id="7495865">,</span>&nbsp;<span class="ident" id="7495867"><a href="/image/jpeg/writer_test.go.html#7495777">y</a></span><span class="op" id="7495868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495873">c1</span>&nbsp;<span class="op" id="7495876">:=</span>&nbsp;<span class="ident" id="7495879"><a href="/image/jpeg/writer_test.go.html#7495712">m1</a></span><span class="op" id="7495881">.</span><span class="ident" id="7495882">At</span><span class="op" id="7495884">(</span><span class="ident" id="7495885"><a href="/image/jpeg/writer_test.go.html#7495816">x</a></span><span class="op" id="7495886">,</span>&nbsp;<span class="ident" id="7495888"><a href="/image/jpeg/writer_test.go.html#7495777">y</a></span><span class="op" id="7495889">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495894">r0</span><span class="op" id="7495896">,</span>&nbsp;<span class="ident" id="7495898">g0</span><span class="op" id="7495900">,</span>&nbsp;<span class="ident" id="7495902">b0</span><span class="op" id="7495904">,</span>&nbsp;<span class="ident" id="7495906">_</span>&nbsp;<span class="op" id="7495908">:=</span>&nbsp;<span class="ident" id="7495911"><a href="/image/jpeg/writer_test.go.html#7495852">c0</a></span><span class="op" id="7495913">.</span><span class="ident" id="7495914">RGBA</span><span class="op" id="7495918">(</span><span class="op" id="7495919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495924">r1</span><span class="op" id="7495926">,</span>&nbsp;<span class="ident" id="7495928">g1</span><span class="op" id="7495930">,</span>&nbsp;<span class="ident" id="7495932">b1</span><span class="op" id="7495934">,</span>&nbsp;<span class="ident" id="7495936">_</span>&nbsp;<span class="op" id="7495938">:=</span>&nbsp;<span class="ident" id="7495941"><a href="/image/jpeg/writer_test.go.html#7495873">c1</a></span><span class="op" id="7495943">.</span><span class="ident" id="7495944">RGBA</span><span class="op" id="7495948">(</span><span class="op" id="7495949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495954"><a href="/image/jpeg/writer_test.go.html#7495759">sum</a></span>&nbsp;<span class="op" id="7495958">+=</span>&nbsp;<span class="ident" id="7495961"><a href="/image/jpeg/writer_test.go.html#7493756">delta</a></span><span class="op" id="7495966">(</span><span class="ident" id="7495967"><a href="/image/jpeg/writer_test.go.html#7495894">r0</a></span><span class="op" id="7495969">,</span>&nbsp;<span class="ident" id="7495971"><a href="/image/jpeg/writer_test.go.html#7495924">r1</a></span><span class="op" id="7495973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495978"><a href="/image/jpeg/writer_test.go.html#7495759">sum</a></span>&nbsp;<span class="op" id="7495982">+=</span>&nbsp;<span class="ident" id="7495985"><a href="/image/jpeg/writer_test.go.html#7493756">delta</a></span><span class="op" id="7495990">(</span><span class="ident" id="7495991"><a href="/image/jpeg/writer_test.go.html#7495898">g0</a></span><span class="op" id="7495993">,</span>&nbsp;<span class="ident" id="7495995"><a href="/image/jpeg/writer_test.go.html#7495928">g1</a></span><span class="op" id="7495997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496002"><a href="/image/jpeg/writer_test.go.html#7495759">sum</a></span>&nbsp;<span class="op" id="7496006">+=</span>&nbsp;<span class="ident" id="7496009"><a href="/image/jpeg/writer_test.go.html#7493756">delta</a></span><span class="op" id="7496014">(</span><span class="ident" id="7496015"><a href="/image/jpeg/writer_test.go.html#7495902">b0</a></span><span class="op" id="7496017">,</span>&nbsp;<span class="ident" id="7496019"><a href="/image/jpeg/writer_test.go.html#7495932">b1</a></span><span class="op" id="7496021">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496026"><a href="/image/jpeg/writer_test.go.html#7495764">n</a></span>&nbsp;<span class="op" id="7496028">+=</span>&nbsp;<span class="num" id="7496031">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496041">return</span>&nbsp;<span class="ident" id="7496048"><a href="/image/jpeg/writer_test.go.html#7495759">sum</a></span>&nbsp;<span class="op" id="7496052">/</span>&nbsp;<span class="ident" id="7496054"><a href="/image/jpeg/writer_test.go.html#7495764">n</a></span><br>
<span class="lineno"></span><span class="op" id="7496056">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="7496059">func</span>&nbsp;<span class="ident" id="7496064">BenchmarkEncode</span><span class="op" id="7496079">(</span><span class="ident" id="7496080">b</span>&nbsp;<span class="op" id="7496082">*</span><span class="ident" id="7496083"><a href="/image/jpeg/writer_test.go.html#7491084">testing</a></span><span class="op" id="7496090">.</span><span class="ident" id="7496091">B</span><span class="op" id="7496092">)</span>&nbsp;<span class="op" id="7496094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496097"><a href="/image/jpeg/writer_test.go.html#7496080">b</a></span><span class="op" id="7496098">.</span><span class="ident" id="7496099">StopTimer</span><span class="op" id="7496108">(</span><span class="op" id="7496109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496112">img</span>&nbsp;<span class="op" id="7496116">:=</span>&nbsp;<span class="ident" id="7496119"><a href="/image/jpeg/writer_test.go.html#7491015">image</a></span><span class="op" id="7496124">.</span><span class="ident" id="7496125">NewRGBA</span><span class="op" id="7496132">(</span><span class="ident" id="7496133"><a href="/image/jpeg/writer_test.go.html#7491015">image</a></span><span class="op" id="7496138">.</span><span class="ident" id="7496139">Rect</span><span class="op" id="7496143">(</span><span class="num" id="7496144">0</span><span class="op" id="7496145">,</span>&nbsp;<span class="num" id="7496147">0</span><span class="op" id="7496148">,</span>&nbsp;<span class="num" id="7496150">640</span><span class="op" id="7496153">,</span>&nbsp;<span class="num" id="7496155">480</span><span class="op" id="7496158">)</span><span class="op" id="7496159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496162">bo</span>&nbsp;<span class="op" id="7496165">:=</span>&nbsp;<span class="ident" id="7496168"><a href="/image/jpeg/writer_test.go.html#7496112">img</a></span><span class="op" id="7496171">.</span><span class="ident" id="7496172">Bounds</span><span class="op" id="7496178">(</span><span class="op" id="7496179">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496182">rnd</span>&nbsp;<span class="op" id="7496186">:=</span>&nbsp;<span class="ident" id="7496189"><a href="/image/jpeg/writer_test.go.html#7491065">rand</a></span><span class="op" id="7496193">.</span><span class="ident" id="7496194">New</span><span class="op" id="7496197">(</span><span class="ident" id="7496198"><a href="/image/jpeg/writer_test.go.html#7491065">rand</a></span><span class="op" id="7496202">.</span><span class="ident" id="7496203">NewSource</span><span class="op" id="7496212">(</span><span class="num" id="7496213">123</span><span class="op" id="7496216">)</span><span class="op" id="7496217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496220">for</span>&nbsp;<span class="ident" id="7496224">y</span>&nbsp;<span class="op" id="7496226">:=</span>&nbsp;<span class="ident" id="7496229"><a href="/image/jpeg/writer_test.go.html#7496162">bo</a></span><span class="op" id="7496231">.</span><span class="ident" id="7496232">Min</span><span class="op" id="7496235">.</span><span class="ident" id="7496236">Y</span><span class="op" id="7496237">;</span>&nbsp;<span class="ident" id="7496239"><a href="/image/jpeg/writer_test.go.html#7496224">y</a></span>&nbsp;<span class="op" id="7496241">&lt;</span>&nbsp;<span class="ident" id="7496243"><a href="/image/jpeg/writer_test.go.html#7496162">bo</a></span><span class="op" id="7496245">.</span><span class="ident" id="7496246">Max</span><span class="op" id="7496249">.</span><span class="ident" id="7496250">Y</span><span class="op" id="7496251">;</span>&nbsp;<span class="ident" id="7496253"><a href="/image/jpeg/writer_test.go.html#7496224">y</a></span><span class="op" id="7496254">++</span>&nbsp;<span class="op" id="7496257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496261">for</span>&nbsp;<span class="ident" id="7496265">x</span>&nbsp;<span class="op" id="7496267">:=</span>&nbsp;<span class="ident" id="7496270"><a href="/image/jpeg/writer_test.go.html#7496162">bo</a></span><span class="op" id="7496272">.</span><span class="ident" id="7496273">Min</span><span class="op" id="7496276">.</span><span class="ident" id="7496277">X</span><span class="op" id="7496278">;</span>&nbsp;<span class="ident" id="7496280"><a href="/image/jpeg/writer_test.go.html#7496265">x</a></span>&nbsp;<span class="op" id="7496282">&lt;</span>&nbsp;<span class="ident" id="7496284"><a href="/image/jpeg/writer_test.go.html#7496162">bo</a></span><span class="op" id="7496286">.</span><span class="ident" id="7496287">Max</span><span class="op" id="7496290">.</span><span class="ident" id="7496291">X</span><span class="op" id="7496292">;</span>&nbsp;<span class="ident" id="7496294"><a href="/image/jpeg/writer_test.go.html#7496265">x</a></span><span class="op" id="7496295">++</span>&nbsp;<span class="op" id="7496298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496303"><a href="/image/jpeg/writer_test.go.html#7496112">img</a></span><span class="op" id="7496306">.</span><span class="ident" id="7496307">SetRGBA</span><span class="op" id="7496314">(</span><span class="ident" id="7496315"><a href="/image/jpeg/writer_test.go.html#7496265">x</a></span><span class="op" id="7496316">,</span>&nbsp;<span class="ident" id="7496318"><a href="/image/jpeg/writer_test.go.html#7496224">y</a></span><span class="op" id="7496319">,</span>&nbsp;<span class="ident" id="7496321"><a href="/image/jpeg/writer_test.go.html#7491024">color</a></span><span class="op" id="7496326">.</span><span class="ident" id="7496327">RGBA</span><span class="op" id="7496331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7496337">uint8</span><span class="op" id="7496342">(</span><span class="ident" id="7496343"><a href="/image/jpeg/writer_test.go.html#7496182">rnd</a></span><span class="op" id="7496346">.</span><span class="ident" id="7496347">Intn</span><span class="op" id="7496351">(</span><span class="num" id="7496352">256</span><span class="op" id="7496355">)</span><span class="op" id="7496356">)</span><span class="op" id="7496357">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7496363">uint8</span><span class="op" id="7496368">(</span><span class="ident" id="7496369"><a href="/image/jpeg/writer_test.go.html#7496182">rnd</a></span><span class="op" id="7496372">.</span><span class="ident" id="7496373">Intn</span><span class="op" id="7496377">(</span><span class="num" id="7496378">256</span><span class="op" id="7496381">)</span><span class="op" id="7496382">)</span><span class="op" id="7496383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7496389">uint8</span><span class="op" id="7496394">(</span><span class="ident" id="7496395"><a href="/image/jpeg/writer_test.go.html#7496182">rnd</a></span><span class="op" id="7496398">.</span><span class="ident" id="7496399">Intn</span><span class="op" id="7496403">(</span><span class="num" id="7496404">256</span><span class="op" id="7496407">)</span><span class="op" id="7496408">)</span><span class="op" id="7496409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7496415">255</span><span class="op" id="7496418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496423">}</span><span class="op" id="7496424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496428">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496434"><a href="/image/jpeg/writer_test.go.html#7496080">b</a></span><span class="op" id="7496435">.</span><span class="ident" id="7496436">SetBytes</span><span class="op" id="7496444">(</span><span class="num" id="7496445">640</span>&nbsp;<span class="op" id="7496449">*</span>&nbsp;<span class="num" id="7496451">480</span>&nbsp;<span class="op" id="7496455">*</span>&nbsp;<span class="num" id="7496457">4</span><span class="op" id="7496458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496461"><a href="/image/jpeg/writer_test.go.html#7496080">b</a></span><span class="op" id="7496462">.</span><span class="ident" id="7496463">StartTimer</span><span class="op" id="7496473">(</span><span class="op" id="7496474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496477">options</span>&nbsp;<span class="op" id="7496485">:=</span>&nbsp;<span class="op" id="7496488">&amp;</span><span class="ident" id="7496489"><a href="/image/jpeg/writer.go.html#5445854">Options</a></span><span class="op" id="7496496">{</span><span class="ident" id="7496497">Quality</span><span class="op" id="7496504">:</span>&nbsp;<span class="num" id="7496506">90</span><span class="op" id="7496508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496511">for</span>&nbsp;<span class="ident" id="7496515">i</span>&nbsp;<span class="op" id="7496517">:=</span>&nbsp;<span class="num" id="7496520">0</span><span class="op" id="7496521">;</span>&nbsp;<span class="ident" id="7496523"><a href="/image/jpeg/writer_test.go.html#7496515">i</a></span>&nbsp;<span class="op" id="7496525">&lt;</span>&nbsp;<span class="ident" id="7496527"><a href="/image/jpeg/writer_test.go.html#7496080">b</a></span><span class="op" id="7496528">.</span><span class="ident" id="7496529">N</span><span class="op" id="7496530">;</span>&nbsp;<span class="ident" id="7496532"><a href="/image/jpeg/writer_test.go.html#7496515">i</a></span><span class="op" id="7496533">++</span>&nbsp;<span class="op" id="7496536">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496540"><a href="/image/jpeg/writer.go.html#5446040">Encode</a></span><span class="op" id="7496546">(</span><span class="ident" id="7496547"><a href="/image/jpeg/writer_test.go.html#7491052">ioutil</a></span><span class="op" id="7496553">.</span><span class="ident" id="7496554">Discard</span><span class="op" id="7496561">,</span>&nbsp;<span class="ident" id="7496563"><a href="/image/jpeg/writer_test.go.html#7496112">img</a></span><span class="op" id="7496566">,</span>&nbsp;<span class="ident" id="7496568"><a href="/image/jpeg/writer_test.go.html#7496477">options</a></span><span class="op" id="7496575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496578">}</span><br>
<span class="lineno"></span><span class="op" id="7496580">}</span>
</div>
</body>
</html>
