<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1606095">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1606150">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1606204">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1606255">package</span>&nbsp;<span class="ident" id="1606263">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1606272">import</span>&nbsp;<span class="string" id="1606279">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1606289">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*m.</span><br>
<span class="lineno">10</span><span class="keyword" id="1606331">func</span>&nbsp;<span class="ident" id="1606336">gc_m_ptr</span><span class="op" id="1606344">(</span><span class="ident" id="1606345">ret</span>&nbsp;<span class="op" id="1606349">*</span><span class="keyword" id="1606350">interface</span><span class="op" id="1606359">{</span><span class="op" id="1606360">}</span><span class="op" id="1606361">)</span>&nbsp;<span class="op" id="1606363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606366">*</span><span class="ident" id="1606367">ret</span>&nbsp;<span class="op" id="1606371">=</span>&nbsp;<span class="op" id="1606373">(</span><span class="op" id="1606374">*</span><span class="ident" id="1606375">m</span><span class="op" id="1606376">)</span><span class="op" id="1606377">(</span><span class="ident" id="1606378">nil</span><span class="op" id="1606381">)</span><br>
<span class="lineno"></span><span class="op" id="1606383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1606386">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*g.</span><br>
<span class="lineno">15</span><span class="keyword" id="1606428">func</span>&nbsp;<span class="ident" id="1606433">gc_g_ptr</span><span class="op" id="1606441">(</span><span class="ident" id="1606442">ret</span>&nbsp;<span class="op" id="1606446">*</span><span class="keyword" id="1606447">interface</span><span class="op" id="1606456">{</span><span class="op" id="1606457">}</span><span class="op" id="1606458">)</span>&nbsp;<span class="op" id="1606460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606463">*</span><span class="ident" id="1606464">ret</span>&nbsp;<span class="op" id="1606468">=</span>&nbsp;<span class="op" id="1606470">(</span><span class="op" id="1606471">*</span><span class="ident" id="1606472">g</span><span class="op" id="1606473">)</span><span class="op" id="1606474">(</span><span class="ident" id="1606475">nil</span><span class="op" id="1606478">)</span><br>
<span class="lineno"></span><span class="op" id="1606480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1606483">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*itab.</span><br>
<span class="lineno">20</span><span class="keyword" id="1606528">func</span>&nbsp;<span class="ident" id="1606533">gc_itab_ptr</span><span class="op" id="1606544">(</span><span class="ident" id="1606545">ret</span>&nbsp;<span class="op" id="1606549">*</span><span class="keyword" id="1606550">interface</span><span class="op" id="1606559">{</span><span class="op" id="1606560">}</span><span class="op" id="1606561">)</span>&nbsp;<span class="op" id="1606563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606566">*</span><span class="ident" id="1606567">ret</span>&nbsp;<span class="op" id="1606571">=</span>&nbsp;<span class="op" id="1606573">(</span><span class="op" id="1606574">*</span><span class="ident" id="1606575">itab</span><span class="op" id="1606579">)</span><span class="op" id="1606580">(</span><span class="ident" id="1606581">nil</span><span class="op" id="1606584">)</span><br>
<span class="lineno"></span><span class="op" id="1606586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1606589">func</span>&nbsp;<span class="ident" id="1606594">gc_unixnanotime</span><span class="op" id="1606609">(</span><span class="ident" id="1606610">now</span>&nbsp;<span class="op" id="1606614">*</span><span class="ident" id="1606615">int64</span><span class="op" id="1606620">)</span>&nbsp;<span class="op" id="1606622">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606625">sec</span><span class="op" id="1606628">,</span>&nbsp;<span class="ident" id="1606630">nsec</span>&nbsp;<span class="op" id="1606635">:=</span>&nbsp;<span class="ident" id="1606638">timenow</span><span class="op" id="1606645">(</span><span class="op" id="1606646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606649">*</span><span class="ident" id="1606650">now</span>&nbsp;<span class="op" id="1606654">=</span>&nbsp;<span class="ident" id="1606656">sec</span><span class="op" id="1606659">*</span><span class="num" id="1606660">1e9</span>&nbsp;<span class="op" id="1606664">+</span>&nbsp;<span class="ident" id="1606666">int64</span><span class="op" id="1606671">(</span><span class="ident" id="1606672">nsec</span><span class="op" id="1606676">)</span><br>
<span class="lineno"></span><span class="op" id="1606678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1606681">func</span>&nbsp;<span class="ident" id="1606686">freeOSMemory</span><span class="op" id="1606698">(</span><span class="op" id="1606699">)</span>&nbsp;<span class="op" id="1606701">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606704">gogc</span><span class="op" id="1606708">(</span><span class="num" id="1606709">2</span><span class="op" id="1606710">)</span>&nbsp;<span class="comment" id="1606712">//&nbsp;force&nbsp;GC&nbsp;and&nbsp;do&nbsp;eager&nbsp;sweep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606744">onM</span><span class="op" id="1606747">(</span><span class="ident" id="1606748">scavenge_m</span><span class="op" id="1606758">)</span><br>
<span class="lineno"></span><span class="op" id="1606760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1606763">var</span>&nbsp;<span class="ident" id="1606767">poolcleanup</span>&nbsp;<span class="keyword" id="1606779">func</span><span class="op" id="1606783">(</span><span class="op" id="1606784">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="1606787">func</span>&nbsp;<span class="ident" id="1606792">registerPoolCleanup</span><span class="op" id="1606811">(</span><span class="ident" id="1606812">f</span>&nbsp;<span class="keyword" id="1606814">func</span><span class="op" id="1606818">(</span><span class="op" id="1606819">)</span><span class="op" id="1606820">)</span>&nbsp;<span class="op" id="1606822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606825">poolcleanup</span>&nbsp;<span class="op" id="1606837">=</span>&nbsp;<span class="ident" id="1606839">f</span><br>
<span class="lineno"></span><span class="op" id="1606841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="1606844">func</span>&nbsp;<span class="ident" id="1606849">clearpools</span><span class="op" id="1606859">(</span><span class="op" id="1606860">)</span>&nbsp;<span class="op" id="1606862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1606865">//&nbsp;clear&nbsp;sync.Pools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606886">if</span>&nbsp;<span class="ident" id="1606889">poolcleanup</span>&nbsp;<span class="op" id="1606901">!=</span>&nbsp;<span class="ident" id="1606904">nil</span>&nbsp;<span class="op" id="1606908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606912">poolcleanup</span><span class="op" id="1606923">(</span><span class="op" id="1606924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606927">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606931">for</span>&nbsp;<span class="ident" id="1606935">_</span><span class="op" id="1606936">,</span>&nbsp;<span class="ident" id="1606938">p</span>&nbsp;<span class="op" id="1606940">:=</span>&nbsp;<span class="keyword" id="1606943">range</span>&nbsp;<span class="op" id="1606949">&amp;</span><span class="ident" id="1606950">allp</span>&nbsp;<span class="op" id="1606955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606959">if</span>&nbsp;<span class="ident" id="1606962">p</span>&nbsp;<span class="op" id="1606964">==</span>&nbsp;<span class="ident" id="1606967">nil</span>&nbsp;<span class="op" id="1606971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606976">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606984">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1606988">//&nbsp;clear&nbsp;tinyalloc&nbsp;pool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607014">if</span>&nbsp;<span class="ident" id="1607017">c</span>&nbsp;<span class="op" id="1607019">:=</span>&nbsp;<span class="ident" id="1607022">p</span><span class="op" id="1607023">.</span><span class="ident" id="1607024">mcache</span><span class="op" id="1607030">;</span>&nbsp;<span class="ident" id="1607032">c</span>&nbsp;<span class="op" id="1607034">!=</span>&nbsp;<span class="ident" id="1607037">nil</span>&nbsp;<span class="op" id="1607041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607046">c</span><span class="op" id="1607047">.</span><span class="ident" id="1607048">tiny</span>&nbsp;<span class="op" id="1607053">=</span>&nbsp;<span class="ident" id="1607055">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607062">c</span><span class="op" id="1607063">.</span><span class="ident" id="1607064">tinysize</span>&nbsp;<span class="op" id="1607073">=</span>&nbsp;<span class="num" id="1607075">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607081">//&nbsp;disconnect&nbsp;cached&nbsp;list&nbsp;before&nbsp;dropping&nbsp;it&nbsp;on&nbsp;the&nbsp;floor,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607143">//&nbsp;so&nbsp;that&nbsp;a&nbsp;dangling&nbsp;ref&nbsp;to&nbsp;one&nbsp;entry&nbsp;does&nbsp;not&nbsp;pin&nbsp;all&nbsp;of&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607211">var</span>&nbsp;<span class="ident" id="1607215">sg</span><span class="op" id="1607217">,</span>&nbsp;<span class="ident" id="1607219">sgnext</span>&nbsp;<span class="op" id="1607226">*</span><span class="ident" id="1607227">sudog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607236">for</span>&nbsp;<span class="ident" id="1607240">sg</span>&nbsp;<span class="op" id="1607243">=</span>&nbsp;<span class="ident" id="1607245">c</span><span class="op" id="1607246">.</span><span class="ident" id="1607247">sudogcache</span><span class="op" id="1607257">;</span>&nbsp;<span class="ident" id="1607259">sg</span>&nbsp;<span class="op" id="1607262">!=</span>&nbsp;<span class="ident" id="1607265">nil</span><span class="op" id="1607268">;</span>&nbsp;<span class="ident" id="1607270">sg</span>&nbsp;<span class="op" id="1607273">=</span>&nbsp;<span class="ident" id="1607275">sgnext</span>&nbsp;<span class="op" id="1607282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607288">sgnext</span>&nbsp;<span class="op" id="1607295">=</span>&nbsp;<span class="ident" id="1607297">sg</span><span class="op" id="1607299">.</span><span class="ident" id="1607300">next</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607309">sg</span><span class="op" id="1607311">.</span><span class="ident" id="1607312">next</span>&nbsp;<span class="op" id="1607317">=</span>&nbsp;<span class="ident" id="1607319">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607331">c</span><span class="op" id="1607332">.</span><span class="ident" id="1607333">sudogcache</span>&nbsp;<span class="op" id="1607344">=</span>&nbsp;<span class="ident" id="1607346">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607357">//&nbsp;clear&nbsp;defer&nbsp;pools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607380">for</span>&nbsp;<span class="ident" id="1607384">i</span>&nbsp;<span class="op" id="1607386">:=</span>&nbsp;<span class="keyword" id="1607389">range</span>&nbsp;<span class="ident" id="1607395">p</span><span class="op" id="1607396">.</span><span class="ident" id="1607397">deferpool</span>&nbsp;<span class="op" id="1607407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607412">//&nbsp;disconnect&nbsp;cached&nbsp;list&nbsp;before&nbsp;dropping&nbsp;it&nbsp;on&nbsp;the&nbsp;floor,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607474">//&nbsp;so&nbsp;that&nbsp;a&nbsp;dangling&nbsp;ref&nbsp;to&nbsp;one&nbsp;entry&nbsp;does&nbsp;not&nbsp;pin&nbsp;all&nbsp;of&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607542">var</span>&nbsp;<span class="ident" id="1607546">d</span><span class="op" id="1607547">,</span>&nbsp;<span class="ident" id="1607549">dlink</span>&nbsp;<span class="op" id="1607555">*</span><span class="ident" id="1607556">_defer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607566">for</span>&nbsp;<span class="ident" id="1607570">d</span>&nbsp;<span class="op" id="1607572">=</span>&nbsp;<span class="ident" id="1607574">p</span><span class="op" id="1607575">.</span><span class="ident" id="1607576">deferpool</span><span class="op" id="1607585">[</span><span class="ident" id="1607586">i</span><span class="op" id="1607587">]</span><span class="op" id="1607588">;</span>&nbsp;<span class="ident" id="1607590">d</span>&nbsp;<span class="op" id="1607592">!=</span>&nbsp;<span class="ident" id="1607595">nil</span><span class="op" id="1607598">;</span>&nbsp;<span class="ident" id="1607600">d</span>&nbsp;<span class="op" id="1607602">=</span>&nbsp;<span class="ident" id="1607604">dlink</span>&nbsp;<span class="op" id="1607610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607616">dlink</span>&nbsp;<span class="op" id="1607622">=</span>&nbsp;<span class="ident" id="1607624">d</span><span class="op" id="1607625">.</span><span class="ident" id="1607626">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607635">d</span><span class="op" id="1607636">.</span><span class="ident" id="1607637">link</span>&nbsp;<span class="op" id="1607642">=</span>&nbsp;<span class="ident" id="1607644">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607656">p</span><span class="op" id="1607657">.</span><span class="ident" id="1607658">deferpool</span><span class="op" id="1607667">[</span><span class="ident" id="1607668">i</span><span class="op" id="1607669">]</span>&nbsp;<span class="op" id="1607671">=</span>&nbsp;<span class="ident" id="1607673">nil</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607682">}</span><br>
<span class="lineno"></span><span class="op" id="1607684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1607687">func</span>&nbsp;<span class="ident" id="1607692">gosweepone</span><span class="op" id="1607702">(</span><span class="op" id="1607703">)</span>&nbsp;<span class="builtintype" id="1607705">uintptr</span><br>
<span class="lineno">80</span><span class="keyword" id="1607713">func</span>&nbsp;<span class="ident" id="1607718">gosweepdone</span><span class="op" id="1607729">(</span><span class="op" id="1607730">)</span>&nbsp;<span class="builtintype" id="1607732">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1607738">func</span>&nbsp;<span class="ident" id="1607743">bgsweep</span><span class="op" id="1607750">(</span><span class="op" id="1607751">)</span>&nbsp;<span class="op" id="1607753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607756">getg</span><span class="op" id="1607760">(</span><span class="op" id="1607761">)</span><span class="op" id="1607762">.</span><span class="ident" id="1607763">issystem</span>&nbsp;<span class="op" id="1607772">=</span>&nbsp;<span class="builtintype" id="1607774">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607780">for</span>&nbsp;<span class="op" id="1607784">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607788">for</span>&nbsp;<span class="ident" id="1607792">gosweepone</span><span class="op" id="1607802">(</span><span class="op" id="1607803">)</span>&nbsp;<span class="op" id="1607805">!=</span>&nbsp;<span class="op" id="1607808">^</span><span class="builtintype" id="1607809">uintptr</span><span class="op" id="1607816">(</span><span class="num" id="1607817">0</span><span class="op" id="1607818">)</span>&nbsp;<span class="op" id="1607820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607825">sweep</span><span class="op" id="1607830">.</span><span class="ident" id="1607831">nbgsweep</span><span class="op" id="1607839">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607845">Gosched</span><span class="op" id="1607852">(</span><span class="op" id="1607853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607861">lock</span><span class="op" id="1607865">(</span><span class="op" id="1607866">&amp;</span><span class="ident" id="1607867">gclock</span><span class="op" id="1607873">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607877">if</span>&nbsp;<span class="op" id="1607880">!</span><span class="ident" id="1607881">gosweepdone</span><span class="op" id="1607892">(</span><span class="op" id="1607893">)</span>&nbsp;<span class="op" id="1607895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607900">//&nbsp;This&nbsp;can&nbsp;happen&nbsp;if&nbsp;a&nbsp;GC&nbsp;runs&nbsp;between</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607943">//&nbsp;gosweepone&nbsp;returning&nbsp;^0&nbsp;above</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607979">//&nbsp;and&nbsp;the&nbsp;lock&nbsp;being&nbsp;acquired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608014">unlock</span><span class="op" id="1608020">(</span><span class="op" id="1608021">&amp;</span><span class="ident" id="1608022">gclock</span><span class="op" id="1608028">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1608033">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1608044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608048">sweep</span><span class="op" id="1608053">.</span><span class="ident" id="1608054">parked</span>&nbsp;<span class="op" id="1608061">=</span>&nbsp;<span class="builtintype" id="1608063">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608070">goparkunlock</span><span class="op" id="1608082">(</span><span class="op" id="1608083">&amp;</span><span class="ident" id="1608084">gclock</span><span class="op" id="1608090">,</span>&nbsp;<span class="string" id="1608092">&#34;GC&nbsp;sweep&nbsp;wait&#34;</span><span class="op" id="1608107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1608110">}</span><br>
<span class="lineno">100</span><span class="op" id="1608112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1608115">//&nbsp;NOTE:&nbsp;Really&nbsp;dst&nbsp;*unsafe.Pointer,&nbsp;src&nbsp;unsafe.Pointer,</span><br>
<span class="lineno"></span><span class="comment" id="1608172">//&nbsp;but&nbsp;if&nbsp;we&nbsp;do&nbsp;that,&nbsp;Go&nbsp;inserts&nbsp;a&nbsp;write&nbsp;barrier&nbsp;on&nbsp;*dst&nbsp;=&nbsp;src.</span><br>
<span class="lineno"></span><span class="comment" id="1608236">//go:nosplit</span><br>
<span class="lineno">105</span><span class="keyword" id="1608249">func</span>&nbsp;<span class="ident" id="1608254">writebarrierptr</span><span class="op" id="1608269">(</span><span class="ident" id="1608270">dst</span>&nbsp;<span class="op" id="1608274">*</span><span class="builtintype" id="1608275">uintptr</span><span class="op" id="1608282">,</span>&nbsp;<span class="ident" id="1608284">src</span>&nbsp;<span class="builtintype" id="1608288">uintptr</span><span class="op" id="1608295">)</span>&nbsp;<span class="op" id="1608297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1608300">*</span><span class="ident" id="1608301">dst</span>&nbsp;<span class="op" id="1608305">=</span>&nbsp;<span class="ident" id="1608307">src</span><br>
<span class="lineno"></span><span class="op" id="1608311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1608314">//go:nosplit</span><br>
<span class="lineno">110</span><span class="keyword" id="1608327">func</span>&nbsp;<span class="ident" id="1608332">writebarrierstring</span><span class="op" id="1608350">(</span><span class="ident" id="1608351">dst</span>&nbsp;<span class="op" id="1608355">*</span><span class="op" id="1608356">[</span><span class="num" id="1608357">2</span><span class="op" id="1608358">]</span><span class="builtintype" id="1608359">uintptr</span><span class="op" id="1608366">,</span>&nbsp;<span class="ident" id="1608368">src</span>&nbsp;<span class="op" id="1608372">[</span><span class="num" id="1608373">2</span><span class="op" id="1608374">]</span><span class="builtintype" id="1608375">uintptr</span><span class="op" id="1608382">)</span>&nbsp;<span class="op" id="1608384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608387">dst</span><span class="op" id="1608390">[</span><span class="num" id="1608391">0</span><span class="op" id="1608392">]</span>&nbsp;<span class="op" id="1608394">=</span>&nbsp;<span class="ident" id="1608396">src</span><span class="op" id="1608399">[</span><span class="num" id="1608400">0</span><span class="op" id="1608401">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608404">dst</span><span class="op" id="1608407">[</span><span class="num" id="1608408">1</span><span class="op" id="1608409">]</span>&nbsp;<span class="op" id="1608411">=</span>&nbsp;<span class="ident" id="1608413">src</span><span class="op" id="1608416">[</span><span class="num" id="1608417">1</span><span class="op" id="1608418">]</span><br>
<span class="lineno"></span><span class="op" id="1608420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="1608423">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1608436">func</span>&nbsp;<span class="ident" id="1608441">writebarrierslice</span><span class="op" id="1608458">(</span><span class="ident" id="1608459">dst</span>&nbsp;<span class="op" id="1608463">*</span><span class="op" id="1608464">[</span><span class="num" id="1608465">3</span><span class="op" id="1608466">]</span><span class="builtintype" id="1608467">uintptr</span><span class="op" id="1608474">,</span>&nbsp;<span class="ident" id="1608476">src</span>&nbsp;<span class="op" id="1608480">[</span><span class="num" id="1608481">3</span><span class="op" id="1608482">]</span><span class="builtintype" id="1608483">uintptr</span><span class="op" id="1608490">)</span>&nbsp;<span class="op" id="1608492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608495">dst</span><span class="op" id="1608498">[</span><span class="num" id="1608499">0</span><span class="op" id="1608500">]</span>&nbsp;<span class="op" id="1608502">=</span>&nbsp;<span class="ident" id="1608504">src</span><span class="op" id="1608507">[</span><span class="num" id="1608508">0</span><span class="op" id="1608509">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608512">dst</span><span class="op" id="1608515">[</span><span class="num" id="1608516">1</span><span class="op" id="1608517">]</span>&nbsp;<span class="op" id="1608519">=</span>&nbsp;<span class="ident" id="1608521">src</span><span class="op" id="1608524">[</span><span class="num" id="1608525">1</span><span class="op" id="1608526">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608529">dst</span><span class="op" id="1608532">[</span><span class="num" id="1608533">2</span><span class="op" id="1608534">]</span>&nbsp;<span class="op" id="1608536">=</span>&nbsp;<span class="ident" id="1608538">src</span><span class="op" id="1608541">[</span><span class="num" id="1608542">2</span><span class="op" id="1608543">]</span><br>
<span class="lineno">120</span><span class="op" id="1608545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1608548">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1608561">func</span>&nbsp;<span class="ident" id="1608566">writebarrieriface</span><span class="op" id="1608583">(</span><span class="ident" id="1608584">dst</span>&nbsp;<span class="op" id="1608588">*</span><span class="op" id="1608589">[</span><span class="num" id="1608590">2</span><span class="op" id="1608591">]</span><span class="builtintype" id="1608592">uintptr</span><span class="op" id="1608599">,</span>&nbsp;<span class="ident" id="1608601">src</span>&nbsp;<span class="op" id="1608605">[</span><span class="num" id="1608606">2</span><span class="op" id="1608607">]</span><span class="builtintype" id="1608608">uintptr</span><span class="op" id="1608615">)</span>&nbsp;<span class="op" id="1608617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608620">dst</span><span class="op" id="1608623">[</span><span class="num" id="1608624">0</span><span class="op" id="1608625">]</span>&nbsp;<span class="op" id="1608627">=</span>&nbsp;<span class="ident" id="1608629">src</span><span class="op" id="1608632">[</span><span class="num" id="1608633">0</span><span class="op" id="1608634">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608637">dst</span><span class="op" id="1608640">[</span><span class="num" id="1608641">1</span><span class="op" id="1608642">]</span>&nbsp;<span class="op" id="1608644">=</span>&nbsp;<span class="ident" id="1608646">src</span><span class="op" id="1608649">[</span><span class="num" id="1608650">1</span><span class="op" id="1608651">]</span><br>
<span class="lineno"></span><span class="op" id="1608653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1608656">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1608669">func</span>&nbsp;<span class="ident" id="1608674">writebarrierfat2</span><span class="op" id="1608690">(</span><span class="ident" id="1608691">dst</span>&nbsp;<span class="op" id="1608695">*</span><span class="op" id="1608696">[</span><span class="num" id="1608697">2</span><span class="op" id="1608698">]</span><span class="builtintype" id="1608699">uintptr</span><span class="op" id="1608706">,</span>&nbsp;<span class="ident" id="1608708">_</span>&nbsp;<span class="op" id="1608710">*</span><span class="builtintype" id="1608711">byte</span><span class="op" id="1608715">,</span>&nbsp;<span class="ident" id="1608717">src</span>&nbsp;<span class="op" id="1608721">[</span><span class="num" id="1608722">2</span><span class="op" id="1608723">]</span><span class="builtintype" id="1608724">uintptr</span><span class="op" id="1608731">)</span>&nbsp;<span class="op" id="1608733">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608736">dst</span><span class="op" id="1608739">[</span><span class="num" id="1608740">0</span><span class="op" id="1608741">]</span>&nbsp;<span class="op" id="1608743">=</span>&nbsp;<span class="ident" id="1608745">src</span><span class="op" id="1608748">[</span><span class="num" id="1608749">0</span><span class="op" id="1608750">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608753">dst</span><span class="op" id="1608756">[</span><span class="num" id="1608757">1</span><span class="op" id="1608758">]</span>&nbsp;<span class="op" id="1608760">=</span>&nbsp;<span class="ident" id="1608762">src</span><span class="op" id="1608765">[</span><span class="num" id="1608766">1</span><span class="op" id="1608767">]</span><br>
<span class="lineno"></span><span class="op" id="1608769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1608772">//go:nosplit</span><br>
<span class="lineno">135</span><span class="keyword" id="1608785">func</span>&nbsp;<span class="ident" id="1608790">writebarrierfat3</span><span class="op" id="1608806">(</span><span class="ident" id="1608807">dst</span>&nbsp;<span class="op" id="1608811">*</span><span class="op" id="1608812">[</span><span class="num" id="1608813">3</span><span class="op" id="1608814">]</span><span class="builtintype" id="1608815">uintptr</span><span class="op" id="1608822">,</span>&nbsp;<span class="ident" id="1608824">_</span>&nbsp;<span class="op" id="1608826">*</span><span class="builtintype" id="1608827">byte</span><span class="op" id="1608831">,</span>&nbsp;<span class="ident" id="1608833">src</span>&nbsp;<span class="op" id="1608837">[</span><span class="num" id="1608838">3</span><span class="op" id="1608839">]</span><span class="builtintype" id="1608840">uintptr</span><span class="op" id="1608847">)</span>&nbsp;<span class="op" id="1608849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608852">dst</span><span class="op" id="1608855">[</span><span class="num" id="1608856">0</span><span class="op" id="1608857">]</span>&nbsp;<span class="op" id="1608859">=</span>&nbsp;<span class="ident" id="1608861">src</span><span class="op" id="1608864">[</span><span class="num" id="1608865">0</span><span class="op" id="1608866">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608869">dst</span><span class="op" id="1608872">[</span><span class="num" id="1608873">1</span><span class="op" id="1608874">]</span>&nbsp;<span class="op" id="1608876">=</span>&nbsp;<span class="ident" id="1608878">src</span><span class="op" id="1608881">[</span><span class="num" id="1608882">1</span><span class="op" id="1608883">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608886">dst</span><span class="op" id="1608889">[</span><span class="num" id="1608890">2</span><span class="op" id="1608891">]</span>&nbsp;<span class="op" id="1608893">=</span>&nbsp;<span class="ident" id="1608895">src</span><span class="op" id="1608898">[</span><span class="num" id="1608899">2</span><span class="op" id="1608900">]</span><br>
<span class="lineno"></span><span class="op" id="1608902">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1608905">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1608918">func</span>&nbsp;<span class="ident" id="1608923">writebarrierfat4</span><span class="op" id="1608939">(</span><span class="ident" id="1608940">dst</span>&nbsp;<span class="op" id="1608944">*</span><span class="op" id="1608945">[</span><span class="num" id="1608946">4</span><span class="op" id="1608947">]</span><span class="builtintype" id="1608948">uintptr</span><span class="op" id="1608955">,</span>&nbsp;<span class="ident" id="1608957">_</span>&nbsp;<span class="op" id="1608959">*</span><span class="builtintype" id="1608960">byte</span><span class="op" id="1608964">,</span>&nbsp;<span class="ident" id="1608966">src</span>&nbsp;<span class="op" id="1608970">[</span><span class="num" id="1608971">4</span><span class="op" id="1608972">]</span><span class="builtintype" id="1608973">uintptr</span><span class="op" id="1608980">)</span>&nbsp;<span class="op" id="1608982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608985">dst</span><span class="op" id="1608988">[</span><span class="num" id="1608989">0</span><span class="op" id="1608990">]</span>&nbsp;<span class="op" id="1608992">=</span>&nbsp;<span class="ident" id="1608994">src</span><span class="op" id="1608997">[</span><span class="num" id="1608998">0</span><span class="op" id="1608999">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609002">dst</span><span class="op" id="1609005">[</span><span class="num" id="1609006">1</span><span class="op" id="1609007">]</span>&nbsp;<span class="op" id="1609009">=</span>&nbsp;<span class="ident" id="1609011">src</span><span class="op" id="1609014">[</span><span class="num" id="1609015">1</span><span class="op" id="1609016">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609019">dst</span><span class="op" id="1609022">[</span><span class="num" id="1609023">2</span><span class="op" id="1609024">]</span>&nbsp;<span class="op" id="1609026">=</span>&nbsp;<span class="ident" id="1609028">src</span><span class="op" id="1609031">[</span><span class="num" id="1609032">2</span><span class="op" id="1609033">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609036">dst</span><span class="op" id="1609039">[</span><span class="num" id="1609040">3</span><span class="op" id="1609041">]</span>&nbsp;<span class="op" id="1609043">=</span>&nbsp;<span class="ident" id="1609045">src</span><span class="op" id="1609048">[</span><span class="num" id="1609049">3</span><span class="op" id="1609050">]</span><br>
<span class="lineno"></span><span class="op" id="1609052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1609055">//go:nosplit</span><br>
<span class="lineno">150</span><span class="keyword" id="1609068">func</span>&nbsp;<span class="ident" id="1609073">writebarrierfat</span><span class="op" id="1609088">(</span><span class="ident" id="1609089">typ</span>&nbsp;<span class="op" id="1609093">*</span><span class="ident" id="1609094">_type</span><span class="op" id="1609099">,</span>&nbsp;<span class="ident" id="1609101">dst</span><span class="op" id="1609104">,</span>&nbsp;<span class="ident" id="1609106">src</span>&nbsp;<span class="ident" id="1609110">unsafe</span><span class="op" id="1609116">.</span><span class="ident" id="1609117">Pointer</span><span class="op" id="1609124">)</span>&nbsp;<span class="op" id="1609126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609129">memmove</span><span class="op" id="1609136">(</span><span class="ident" id="1609137">dst</span><span class="op" id="1609140">,</span>&nbsp;<span class="ident" id="1609142">src</span><span class="op" id="1609145">,</span>&nbsp;<span class="ident" id="1609147">typ</span><span class="op" id="1609150">.</span><span class="ident" id="1609151">size</span><span class="op" id="1609155">)</span><br>
<span class="lineno"></span><span class="op" id="1609157">}</span>
</div>
</body>
</html>
