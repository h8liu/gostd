<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2451486">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2451541">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2451595">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2451646">package</span>&nbsp;<span class="ident" id="2451654">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2451659">import</span>&nbsp;<span class="op" id="2451666">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2451669">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2451677">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2451688">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2451703">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2451706">const</span>&nbsp;<span class="op" id="2451712">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451715">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451748">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451795">nByte</span>&nbsp;<span class="op" id="2451801">=</span>&nbsp;<span class="num" id="2451803">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451808">ldigits</span>&nbsp;<span class="op" id="2451816">=</span>&nbsp;<span class="string" id="2451818">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451838">udigits</span>&nbsp;<span class="op" id="2451846">=</span>&nbsp;<span class="string" id="2451848">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="2451867">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2451870">const</span>&nbsp;<span class="op" id="2451876">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451879">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2451888">=</span>&nbsp;<span class="builtintype" id="2451890">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451896">unsigned</span>&nbsp;<span class="op" id="2451905">=</span>&nbsp;<span class="builtintype" id="2451907">false</span><br>
<span class="lineno">25</span><span class="op" id="2451913">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2451916">var</span>&nbsp;<span class="ident" id="2451920">padZeroBytes</span>&nbsp;<span class="op" id="2451933">=</span>&nbsp;<span class="builtinfunc" id="2451935">make</span><span class="op" id="2451939">(</span><span class="op" id="2451940">[</span><span class="op" id="2451941">]</span><span class="builtintype" id="2451942">byte</span><span class="op" id="2451946">,</span>&nbsp;<span class="ident" id="2451948">nByte</span><span class="op" id="2451953">)</span><br>
<span class="lineno"></span><span class="keyword" id="2451955">var</span>&nbsp;<span class="ident" id="2451959">padSpaceBytes</span>&nbsp;<span class="op" id="2451973">=</span>&nbsp;<span class="builtinfunc" id="2451975">make</span><span class="op" id="2451979">(</span><span class="op" id="2451980">[</span><span class="op" id="2451981">]</span><span class="builtintype" id="2451982">byte</span><span class="op" id="2451986">,</span>&nbsp;<span class="ident" id="2451988">nByte</span><span class="op" id="2451993">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2451996">func</span>&nbsp;<span class="ident" id="2452001">init</span><span class="op" id="2452005">(</span><span class="op" id="2452006">)</span>&nbsp;<span class="op" id="2452008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452011">for</span>&nbsp;<span class="ident" id="2452015">i</span>&nbsp;<span class="op" id="2452017">:=</span>&nbsp;<span class="num" id="2452020">0</span><span class="op" id="2452021">;</span>&nbsp;<span class="ident" id="2452023">i</span>&nbsp;<span class="op" id="2452025">&lt;</span>&nbsp;<span class="ident" id="2452027">nByte</span><span class="op" id="2452032">;</span>&nbsp;<span class="ident" id="2452034">i</span><span class="op" id="2452035">++</span>&nbsp;<span class="op" id="2452038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452042">padZeroBytes</span><span class="op" id="2452054">[</span><span class="ident" id="2452055">i</span><span class="op" id="2452056">]</span>&nbsp;<span class="op" id="2452058">=</span>&nbsp;<span class="string" id="2452060">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452066">padSpaceBytes</span><span class="op" id="2452079">[</span><span class="ident" id="2452080">i</span><span class="op" id="2452081">]</span>&nbsp;<span class="op" id="2452083">=</span>&nbsp;<span class="string" id="2452085">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452090">}</span><br>
<span class="lineno">35</span><span class="op" id="2452092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2452095">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="2452151">type</span>&nbsp;<span class="ident" id="2452156">fmtFlags</span>&nbsp;<span class="keyword" id="2452165">struct</span>&nbsp;<span class="op" id="2452172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452175">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="2452187">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452193">precPresent</span>&nbsp;<span class="builtintype" id="2452205">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452211">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2452223">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452229">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2452241">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452247">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2452259">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452265">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2452277">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452283">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2452295">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452301">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2452313">bool</span>&nbsp;<span class="comment" id="2452318">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452359">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2452371">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452378">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452437">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452504">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452558">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="2452565">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452571">sharpV</span>&nbsp;<span class="builtintype" id="2452578">bool</span><br>
<span class="lineno"></span><span class="op" id="2452583">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2452586">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="2452636">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="2452695">type</span>&nbsp;<span class="ident" id="2452700">fmt</span>&nbsp;<span class="keyword" id="2452704">struct</span>&nbsp;<span class="op" id="2452711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452714">intbuf</span>&nbsp;<span class="op" id="2452721">[</span><span class="ident" id="2452722">nByte</span><span class="op" id="2452727">]</span><span class="builtintype" id="2452728">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452734">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2452741">*</span><span class="ident" id="2452742">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452750">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452771">wid</span>&nbsp;&nbsp;<span class="builtintype" id="2452776">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452781">prec</span>&nbsp;<span class="builtintype" id="2452786">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452791">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="2452800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2452803">func</span>&nbsp;<span class="op" id="2452808">(</span><span class="ident" id="2452809">f</span>&nbsp;<span class="op" id="2452811">*</span><span class="ident" id="2452812">fmt</span><span class="op" id="2452815">)</span>&nbsp;<span class="ident" id="2452817">clearflags</span><span class="op" id="2452827">(</span><span class="op" id="2452828">)</span>&nbsp;<span class="op" id="2452830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452833">f</span><span class="op" id="2452834">.</span><span class="ident" id="2452835">fmtFlags</span>&nbsp;<span class="op" id="2452844">=</span>&nbsp;<span class="ident" id="2452846">fmtFlags</span><span class="op" id="2452854">{</span><span class="op" id="2452855">}</span><br>
<span class="lineno"></span><span class="op" id="2452857">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2452860">func</span>&nbsp;<span class="op" id="2452865">(</span><span class="ident" id="2452866">f</span>&nbsp;<span class="op" id="2452868">*</span><span class="ident" id="2452869">fmt</span><span class="op" id="2452872">)</span>&nbsp;<span class="ident" id="2452874">init</span><span class="op" id="2452878">(</span><span class="ident" id="2452879">buf</span>&nbsp;<span class="op" id="2452883">*</span><span class="ident" id="2452884">buffer</span><span class="op" id="2452890">)</span>&nbsp;<span class="op" id="2452892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452895">f</span><span class="op" id="2452896">.</span><span class="ident" id="2452897">buf</span>&nbsp;<span class="op" id="2452901">=</span>&nbsp;<span class="ident" id="2452903">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452908">f</span><span class="op" id="2452909">.</span><span class="ident" id="2452910">clearflags</span><span class="op" id="2452920">(</span><span class="op" id="2452921">)</span><br>
<span class="lineno"></span><span class="op" id="2452923">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2452926">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="2453012">func</span>&nbsp;<span class="op" id="2453017">(</span><span class="ident" id="2453018">f</span>&nbsp;<span class="op" id="2453020">*</span><span class="ident" id="2453021">fmt</span><span class="op" id="2453024">)</span>&nbsp;<span class="ident" id="2453026">computePadding</span><span class="op" id="2453040">(</span><span class="ident" id="2453041">width</span>&nbsp;<span class="builtintype" id="2453047">int</span><span class="op" id="2453050">)</span>&nbsp;<span class="op" id="2453052">(</span><span class="ident" id="2453053">padding</span>&nbsp;<span class="op" id="2453061">[</span><span class="op" id="2453062">]</span><span class="builtintype" id="2453063">byte</span><span class="op" id="2453067">,</span>&nbsp;<span class="ident" id="2453069">leftWidth</span><span class="op" id="2453078">,</span>&nbsp;<span class="ident" id="2453080">rightWidth</span>&nbsp;<span class="builtintype" id="2453091">int</span><span class="op" id="2453094">)</span>&nbsp;<span class="op" id="2453096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453099">left</span>&nbsp;<span class="op" id="2453104">:=</span>&nbsp;<span class="op" id="2453107">!</span><span class="ident" id="2453108">f</span><span class="op" id="2453109">.</span><span class="ident" id="2453110">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453117">w</span>&nbsp;<span class="op" id="2453119">:=</span>&nbsp;<span class="ident" id="2453122">f</span><span class="op" id="2453123">.</span><span class="ident" id="2453124">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453129">if</span>&nbsp;<span class="ident" id="2453132">w</span>&nbsp;<span class="op" id="2453134">&lt;</span>&nbsp;<span class="num" id="2453136">0</span>&nbsp;<span class="op" id="2453138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453142">left</span>&nbsp;<span class="op" id="2453147">=</span>&nbsp;<span class="builtintype" id="2453149">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453157">w</span>&nbsp;<span class="op" id="2453159">=</span>&nbsp;<span class="op" id="2453161">-</span><span class="ident" id="2453162">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453168">w</span>&nbsp;<span class="op" id="2453170">-=</span>&nbsp;<span class="ident" id="2453173">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453180">if</span>&nbsp;<span class="ident" id="2453183">w</span>&nbsp;<span class="op" id="2453185">&gt;</span>&nbsp;<span class="num" id="2453187">0</span>&nbsp;<span class="op" id="2453189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453193">if</span>&nbsp;<span class="ident" id="2453196">left</span>&nbsp;<span class="op" id="2453201">&amp;&amp;</span>&nbsp;<span class="ident" id="2453204">f</span><span class="op" id="2453205">.</span><span class="ident" id="2453206">zero</span>&nbsp;<span class="op" id="2453211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453216">return</span>&nbsp;<span class="ident" id="2453223">padZeroBytes</span><span class="op" id="2453235">,</span>&nbsp;<span class="ident" id="2453237">w</span><span class="op" id="2453238">,</span>&nbsp;<span class="num" id="2453240">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453248">if</span>&nbsp;<span class="ident" id="2453251">left</span>&nbsp;<span class="op" id="2453256">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453261">return</span>&nbsp;<span class="ident" id="2453268">padSpaceBytes</span><span class="op" id="2453281">,</span>&nbsp;<span class="ident" id="2453283">w</span><span class="op" id="2453284">,</span>&nbsp;<span class="num" id="2453286">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453290">}</span>&nbsp;<span class="keyword" id="2453292">else</span>&nbsp;<span class="op" id="2453297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2453302">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453343">return</span>&nbsp;<span class="ident" id="2453350">padSpaceBytes</span><span class="op" id="2453363">,</span>&nbsp;<span class="num" id="2453365">0</span><span class="op" id="2453366">,</span>&nbsp;<span class="ident" id="2453368">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453372">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453378">return</span><br>
<span class="lineno"></span><span class="op" id="2453385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2453388">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="2453434">func</span>&nbsp;<span class="op" id="2453439">(</span><span class="ident" id="2453440">f</span>&nbsp;<span class="op" id="2453442">*</span><span class="ident" id="2453443">fmt</span><span class="op" id="2453446">)</span>&nbsp;<span class="ident" id="2453448">writePadding</span><span class="op" id="2453460">(</span><span class="ident" id="2453461">n</span>&nbsp;<span class="builtintype" id="2453463">int</span><span class="op" id="2453466">,</span>&nbsp;<span class="ident" id="2453468">padding</span>&nbsp;<span class="op" id="2453476">[</span><span class="op" id="2453477">]</span><span class="builtintype" id="2453478">byte</span><span class="op" id="2453482">)</span>&nbsp;<span class="op" id="2453484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453487">for</span>&nbsp;<span class="ident" id="2453491">n</span>&nbsp;<span class="op" id="2453493">&gt;</span>&nbsp;<span class="num" id="2453495">0</span>&nbsp;<span class="op" id="2453497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453501">m</span>&nbsp;<span class="op" id="2453503">:=</span>&nbsp;<span class="ident" id="2453506">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453510">if</span>&nbsp;<span class="ident" id="2453513">m</span>&nbsp;<span class="op" id="2453515">&gt;</span>&nbsp;<span class="ident" id="2453517">nByte</span>&nbsp;<span class="op" id="2453523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453528">m</span>&nbsp;<span class="op" id="2453530">=</span>&nbsp;<span class="ident" id="2453532">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453544">f</span><span class="op" id="2453545">.</span><span class="ident" id="2453546">buf</span><span class="op" id="2453549">.</span><span class="ident" id="2453550">Write</span><span class="op" id="2453555">(</span><span class="ident" id="2453556">padding</span><span class="op" id="2453563">[</span><span class="num" id="2453564">0</span><span class="op" id="2453565">:</span><span class="ident" id="2453566">m</span><span class="op" id="2453567">]</span><span class="op" id="2453568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453572">n</span>&nbsp;<span class="op" id="2453574">-=</span>&nbsp;<span class="ident" id="2453577">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453580">}</span><br>
<span class="lineno"></span><span class="op" id="2453582">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2453585">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2453664">func</span>&nbsp;<span class="op" id="2453669">(</span><span class="ident" id="2453670">f</span>&nbsp;<span class="op" id="2453672">*</span><span class="ident" id="2453673">fmt</span><span class="op" id="2453676">)</span>&nbsp;<span class="ident" id="2453678">pad</span><span class="op" id="2453681">(</span><span class="ident" id="2453682">b</span>&nbsp;<span class="op" id="2453684">[</span><span class="op" id="2453685">]</span><span class="builtintype" id="2453686">byte</span><span class="op" id="2453690">)</span>&nbsp;<span class="op" id="2453692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453695">if</span>&nbsp;<span class="op" id="2453698">!</span><span class="ident" id="2453699">f</span><span class="op" id="2453700">.</span><span class="ident" id="2453701">widPresent</span>&nbsp;<span class="op" id="2453712">||</span>&nbsp;<span class="ident" id="2453715">f</span><span class="op" id="2453716">.</span><span class="ident" id="2453717">wid</span>&nbsp;<span class="op" id="2453721">==</span>&nbsp;<span class="num" id="2453724">0</span>&nbsp;<span class="op" id="2453726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453730">f</span><span class="op" id="2453731">.</span><span class="ident" id="2453732">buf</span><span class="op" id="2453735">.</span><span class="ident" id="2453736">Write</span><span class="op" id="2453741">(</span><span class="ident" id="2453742">b</span><span class="op" id="2453743">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453747">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453758">padding</span><span class="op" id="2453765">,</span>&nbsp;<span class="ident" id="2453767">left</span><span class="op" id="2453771">,</span>&nbsp;<span class="ident" id="2453773">right</span>&nbsp;<span class="op" id="2453779">:=</span>&nbsp;<span class="ident" id="2453782">f</span><span class="op" id="2453783">.</span><span class="ident" id="2453784">computePadding</span><span class="op" id="2453798">(</span><span class="ident" id="2453799">utf8</span><span class="op" id="2453803">.</span><span class="ident" id="2453804">RuneCount</span><span class="op" id="2453813">(</span><span class="ident" id="2453814">b</span><span class="op" id="2453815">)</span><span class="op" id="2453816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453819">if</span>&nbsp;<span class="ident" id="2453822">left</span>&nbsp;<span class="op" id="2453827">&gt;</span>&nbsp;<span class="num" id="2453829">0</span>&nbsp;<span class="op" id="2453831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453835">f</span><span class="op" id="2453836">.</span><span class="ident" id="2453837">writePadding</span><span class="op" id="2453849">(</span><span class="ident" id="2453850">left</span><span class="op" id="2453854">,</span>&nbsp;<span class="ident" id="2453856">padding</span><span class="op" id="2453863">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453869">f</span><span class="op" id="2453870">.</span><span class="ident" id="2453871">buf</span><span class="op" id="2453874">.</span><span class="ident" id="2453875">Write</span><span class="op" id="2453880">(</span><span class="ident" id="2453881">b</span><span class="op" id="2453882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453885">if</span>&nbsp;<span class="ident" id="2453888">right</span>&nbsp;<span class="op" id="2453894">&gt;</span>&nbsp;<span class="num" id="2453896">0</span>&nbsp;<span class="op" id="2453898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453902">f</span><span class="op" id="2453903">.</span><span class="ident" id="2453904">writePadding</span><span class="op" id="2453916">(</span><span class="ident" id="2453917">right</span><span class="op" id="2453922">,</span>&nbsp;<span class="ident" id="2453924">padding</span><span class="op" id="2453931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453934">}</span><br>
<span class="lineno">125</span><span class="op" id="2453936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2453939">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2454022">func</span>&nbsp;<span class="op" id="2454027">(</span><span class="ident" id="2454028">f</span>&nbsp;<span class="op" id="2454030">*</span><span class="ident" id="2454031">fmt</span><span class="op" id="2454034">)</span>&nbsp;<span class="ident" id="2454036">padString</span><span class="op" id="2454045">(</span><span class="ident" id="2454046">s</span>&nbsp;<span class="builtintype" id="2454048">string</span><span class="op" id="2454054">)</span>&nbsp;<span class="op" id="2454056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454059">if</span>&nbsp;<span class="op" id="2454062">!</span><span class="ident" id="2454063">f</span><span class="op" id="2454064">.</span><span class="ident" id="2454065">widPresent</span>&nbsp;<span class="op" id="2454076">||</span>&nbsp;<span class="ident" id="2454079">f</span><span class="op" id="2454080">.</span><span class="ident" id="2454081">wid</span>&nbsp;<span class="op" id="2454085">==</span>&nbsp;<span class="num" id="2454088">0</span>&nbsp;<span class="op" id="2454090">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454094">f</span><span class="op" id="2454095">.</span><span class="ident" id="2454096">buf</span><span class="op" id="2454099">.</span><span class="ident" id="2454100">WriteString</span><span class="op" id="2454111">(</span><span class="ident" id="2454112">s</span><span class="op" id="2454113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454117">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2454125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454128">padding</span><span class="op" id="2454135">,</span>&nbsp;<span class="ident" id="2454137">left</span><span class="op" id="2454141">,</span>&nbsp;<span class="ident" id="2454143">right</span>&nbsp;<span class="op" id="2454149">:=</span>&nbsp;<span class="ident" id="2454152">f</span><span class="op" id="2454153">.</span><span class="ident" id="2454154">computePadding</span><span class="op" id="2454168">(</span><span class="ident" id="2454169">utf8</span><span class="op" id="2454173">.</span><span class="ident" id="2454174">RuneCountInString</span><span class="op" id="2454191">(</span><span class="ident" id="2454192">s</span><span class="op" id="2454193">)</span><span class="op" id="2454194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454197">if</span>&nbsp;<span class="ident" id="2454200">left</span>&nbsp;<span class="op" id="2454205">&gt;</span>&nbsp;<span class="num" id="2454207">0</span>&nbsp;<span class="op" id="2454209">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454213">f</span><span class="op" id="2454214">.</span><span class="ident" id="2454215">writePadding</span><span class="op" id="2454227">(</span><span class="ident" id="2454228">left</span><span class="op" id="2454232">,</span>&nbsp;<span class="ident" id="2454234">padding</span><span class="op" id="2454241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2454244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454247">f</span><span class="op" id="2454248">.</span><span class="ident" id="2454249">buf</span><span class="op" id="2454252">.</span><span class="ident" id="2454253">WriteString</span><span class="op" id="2454264">(</span><span class="ident" id="2454265">s</span><span class="op" id="2454266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454269">if</span>&nbsp;<span class="ident" id="2454272">right</span>&nbsp;<span class="op" id="2454278">&gt;</span>&nbsp;<span class="num" id="2454280">0</span>&nbsp;<span class="op" id="2454282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454286">f</span><span class="op" id="2454287">.</span><span class="ident" id="2454288">writePadding</span><span class="op" id="2454300">(</span><span class="ident" id="2454301">right</span><span class="op" id="2454306">,</span>&nbsp;<span class="ident" id="2454308">padding</span><span class="op" id="2454315">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2454318">}</span><br>
<span class="lineno"></span><span class="op" id="2454320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2454323">var</span>&nbsp;<span class="op" id="2454327">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454330">trueBytes</span>&nbsp;&nbsp;<span class="op" id="2454341">=</span>&nbsp;<span class="op" id="2454343">[</span><span class="op" id="2454344">]</span><span class="builtintype" id="2454345">byte</span><span class="op" id="2454349">(</span><span class="string" id="2454350">&#34;true&#34;</span><span class="op" id="2454356">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454359">falseBytes</span>&nbsp;<span class="op" id="2454370">=</span>&nbsp;<span class="op" id="2454372">[</span><span class="op" id="2454373">]</span><span class="builtintype" id="2454374">byte</span><span class="op" id="2454378">(</span><span class="string" id="2454379">&#34;false&#34;</span><span class="op" id="2454386">)</span><br>
<span class="lineno"></span><span class="op" id="2454388">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2454391">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="2454425">func</span>&nbsp;<span class="op" id="2454430">(</span><span class="ident" id="2454431">f</span>&nbsp;<span class="op" id="2454433">*</span><span class="ident" id="2454434">fmt</span><span class="op" id="2454437">)</span>&nbsp;<span class="ident" id="2454439">fmt_boolean</span><span class="op" id="2454450">(</span><span class="ident" id="2454451">v</span>&nbsp;<span class="builtintype" id="2454453">bool</span><span class="op" id="2454457">)</span>&nbsp;<span class="op" id="2454459">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454462">if</span>&nbsp;<span class="ident" id="2454465">v</span>&nbsp;<span class="op" id="2454467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454471">f</span><span class="op" id="2454472">.</span><span class="ident" id="2454473">pad</span><span class="op" id="2454476">(</span><span class="ident" id="2454477">trueBytes</span><span class="op" id="2454486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2454489">}</span>&nbsp;<span class="keyword" id="2454491">else</span>&nbsp;<span class="op" id="2454496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454500">f</span><span class="op" id="2454501">.</span><span class="ident" id="2454502">pad</span><span class="op" id="2454505">(</span><span class="ident" id="2454506">falseBytes</span><span class="op" id="2454516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2454519">}</span><br>
<span class="lineno">155</span><span class="op" id="2454521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2454524">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="2454606">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="2454637">func</span>&nbsp;<span class="op" id="2454642">(</span><span class="ident" id="2454643">f</span>&nbsp;<span class="op" id="2454645">*</span><span class="ident" id="2454646">fmt</span><span class="op" id="2454649">)</span>&nbsp;<span class="ident" id="2454651">integer</span><span class="op" id="2454658">(</span><span class="ident" id="2454659">a</span>&nbsp;<span class="ident" id="2454661">int64</span><span class="op" id="2454666">,</span>&nbsp;<span class="ident" id="2454668">base</span>&nbsp;<span class="ident" id="2454673">uint64</span><span class="op" id="2454679">,</span>&nbsp;<span class="ident" id="2454681">signedness</span>&nbsp;<span class="builtintype" id="2454692">bool</span><span class="op" id="2454696">,</span>&nbsp;<span class="ident" id="2454698">digits</span>&nbsp;<span class="builtintype" id="2454705">string</span><span class="op" id="2454711">)</span>&nbsp;<span class="op" id="2454713">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2454716">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454772">if</span>&nbsp;<span class="ident" id="2454775">f</span><span class="op" id="2454776">.</span><span class="ident" id="2454777">precPresent</span>&nbsp;<span class="op" id="2454789">&amp;&amp;</span>&nbsp;<span class="ident" id="2454792">f</span><span class="op" id="2454793">.</span><span class="ident" id="2454794">prec</span>&nbsp;<span class="op" id="2454799">==</span>&nbsp;<span class="num" id="2454802">0</span>&nbsp;<span class="op" id="2454804">&amp;&amp;</span>&nbsp;<span class="ident" id="2454807">a</span>&nbsp;<span class="op" id="2454809">==</span>&nbsp;<span class="num" id="2454812">0</span>&nbsp;<span class="op" id="2454814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454818">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2454826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454830">var</span>&nbsp;<span class="ident" id="2454834">buf</span>&nbsp;<span class="op" id="2454838">[</span><span class="op" id="2454839">]</span><span class="builtintype" id="2454840">byte</span>&nbsp;<span class="op" id="2454845">=</span>&nbsp;<span class="ident" id="2454847">f</span><span class="op" id="2454848">.</span><span class="ident" id="2454849">intbuf</span><span class="op" id="2454855">[</span><span class="num" id="2454856">0</span><span class="op" id="2454857">:</span><span class="op" id="2454858">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454861">if</span>&nbsp;<span class="ident" id="2454864">f</span><span class="op" id="2454865">.</span><span class="ident" id="2454866">widPresent</span>&nbsp;<span class="op" id="2454877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454881">width</span>&nbsp;<span class="op" id="2454887">:=</span>&nbsp;<span class="ident" id="2454890">f</span><span class="op" id="2454891">.</span><span class="ident" id="2454892">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454898">if</span>&nbsp;<span class="ident" id="2454901">base</span>&nbsp;<span class="op" id="2454906">==</span>&nbsp;<span class="num" id="2454909">16</span>&nbsp;<span class="op" id="2454912">&amp;&amp;</span>&nbsp;<span class="ident" id="2454915">f</span><span class="op" id="2454916">.</span><span class="ident" id="2454917">sharp</span>&nbsp;<span class="op" id="2454923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2454928">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454950">width</span>&nbsp;<span class="op" id="2454956">+=</span>&nbsp;<span class="num" id="2454959">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2454963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454967">if</span>&nbsp;<span class="ident" id="2454970">width</span>&nbsp;<span class="op" id="2454976">&gt;</span>&nbsp;<span class="ident" id="2454978">nByte</span>&nbsp;<span class="op" id="2454984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2454989">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455030">buf</span>&nbsp;<span class="op" id="2455034">=</span>&nbsp;<span class="builtinfunc" id="2455036">make</span><span class="op" id="2455040">(</span><span class="op" id="2455041">[</span><span class="op" id="2455042">]</span><span class="builtintype" id="2455043">byte</span><span class="op" id="2455047">,</span>&nbsp;<span class="ident" id="2455049">width</span><span class="op" id="2455054">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2455058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2455061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455065">negative</span>&nbsp;<span class="op" id="2455074">:=</span>&nbsp;<span class="ident" id="2455077">signedness</span>&nbsp;<span class="op" id="2455088">==</span>&nbsp;<span class="ident" id="2455091">signed</span>&nbsp;<span class="op" id="2455098">&amp;&amp;</span>&nbsp;<span class="ident" id="2455101">a</span>&nbsp;<span class="op" id="2455103">&lt;</span>&nbsp;<span class="num" id="2455105">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455108">if</span>&nbsp;<span class="ident" id="2455111">negative</span>&nbsp;<span class="op" id="2455120">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455124">a</span>&nbsp;<span class="op" id="2455126">=</span>&nbsp;<span class="op" id="2455128">-</span><span class="ident" id="2455129">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2455132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2455136">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2455201">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455246">prec</span>&nbsp;<span class="op" id="2455251">:=</span>&nbsp;<span class="num" id="2455254">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455257">if</span>&nbsp;<span class="ident" id="2455260">f</span><span class="op" id="2455261">.</span><span class="ident" id="2455262">precPresent</span>&nbsp;<span class="op" id="2455274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455278">prec</span>&nbsp;<span class="op" id="2455283">=</span>&nbsp;<span class="ident" id="2455285">f</span><span class="op" id="2455286">.</span><span class="ident" id="2455287">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455294">f</span><span class="op" id="2455295">.</span><span class="ident" id="2455296">zero</span>&nbsp;<span class="op" id="2455301">=</span>&nbsp;<span class="builtintype" id="2455303">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2455310">}</span>&nbsp;<span class="keyword" id="2455312">else</span>&nbsp;<span class="keyword" id="2455317">if</span>&nbsp;<span class="ident" id="2455320">f</span><span class="op" id="2455321">.</span><span class="ident" id="2455322">zero</span>&nbsp;<span class="op" id="2455327">&amp;&amp;</span>&nbsp;<span class="ident" id="2455330">f</span><span class="op" id="2455331">.</span><span class="ident" id="2455332">widPresent</span>&nbsp;<span class="op" id="2455343">&amp;&amp;</span>&nbsp;<span class="op" id="2455346">!</span><span class="ident" id="2455347">f</span><span class="op" id="2455348">.</span><span class="ident" id="2455349">minus</span>&nbsp;<span class="op" id="2455355">&amp;&amp;</span>&nbsp;<span class="ident" id="2455358">f</span><span class="op" id="2455359">.</span><span class="ident" id="2455360">wid</span>&nbsp;<span class="op" id="2455364">&gt;</span>&nbsp;<span class="num" id="2455366">0</span>&nbsp;<span class="op" id="2455368">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455372">prec</span>&nbsp;<span class="op" id="2455377">=</span>&nbsp;<span class="ident" id="2455379">f</span><span class="op" id="2455380">.</span><span class="ident" id="2455381">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455387">if</span>&nbsp;<span class="ident" id="2455390">negative</span>&nbsp;<span class="op" id="2455399">||</span>&nbsp;<span class="ident" id="2455402">f</span><span class="op" id="2455403">.</span><span class="ident" id="2455404">plus</span>&nbsp;<span class="op" id="2455409">||</span>&nbsp;<span class="ident" id="2455412">f</span><span class="op" id="2455413">.</span><span class="ident" id="2455414">space</span>&nbsp;<span class="op" id="2455420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455425">prec</span><span class="op" id="2455429">--</span>&nbsp;<span class="comment" id="2455432">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2455457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2455460">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2455464">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2455542">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2455596">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2455667">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455732">i</span>&nbsp;<span class="op" id="2455734">:=</span>&nbsp;<span class="builtinfunc" id="2455737">len</span><span class="op" id="2455740">(</span><span class="ident" id="2455741">buf</span><span class="op" id="2455744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455747">ua</span>&nbsp;<span class="op" id="2455750">:=</span>&nbsp;<span class="ident" id="2455753">uint64</span><span class="op" id="2455759">(</span><span class="ident" id="2455760">a</span><span class="op" id="2455761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2455764">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2455835">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455875">switch</span>&nbsp;<span class="ident" id="2455882">base</span>&nbsp;<span class="op" id="2455887">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455890">case</span>&nbsp;<span class="num" id="2455895">10</span><span class="op" id="2455897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455901">for</span>&nbsp;<span class="ident" id="2455905">ua</span>&nbsp;<span class="op" id="2455908">&gt;=</span>&nbsp;<span class="num" id="2455911">10</span>&nbsp;<span class="op" id="2455914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455919">i</span><span class="op" id="2455920">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455926">next</span>&nbsp;<span class="op" id="2455931">:=</span>&nbsp;<span class="ident" id="2455934">ua</span>&nbsp;<span class="op" id="2455937">/</span>&nbsp;<span class="num" id="2455939">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455945">buf</span><span class="op" id="2455948">[</span><span class="ident" id="2455949">i</span><span class="op" id="2455950">]</span>&nbsp;<span class="op" id="2455952">=</span>&nbsp;<span class="builtintype" id="2455954">byte</span><span class="op" id="2455958">(</span><span class="string" id="2455959">&#39;0&#39;</span>&nbsp;<span class="op" id="2455963">+</span>&nbsp;<span class="ident" id="2455965">ua</span>&nbsp;<span class="op" id="2455968">-</span>&nbsp;<span class="ident" id="2455970">next</span><span class="op" id="2455974">*</span><span class="num" id="2455975">10</span><span class="op" id="2455977">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455982">ua</span>&nbsp;<span class="op" id="2455985">=</span>&nbsp;<span class="ident" id="2455987">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2455994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455997">case</span>&nbsp;<span class="num" id="2456002">16</span><span class="op" id="2456004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456008">for</span>&nbsp;<span class="ident" id="2456012">ua</span>&nbsp;<span class="op" id="2456015">&gt;=</span>&nbsp;<span class="num" id="2456018">16</span>&nbsp;<span class="op" id="2456021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456026">i</span><span class="op" id="2456027">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456033">buf</span><span class="op" id="2456036">[</span><span class="ident" id="2456037">i</span><span class="op" id="2456038">]</span>&nbsp;<span class="op" id="2456040">=</span>&nbsp;<span class="ident" id="2456042">digits</span><span class="op" id="2456048">[</span><span class="ident" id="2456049">ua</span><span class="op" id="2456051">&amp;</span><span class="num" id="2456052">0xF</span><span class="op" id="2456055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456060">ua</span>&nbsp;<span class="op" id="2456063">&gt;&gt;=</span>&nbsp;<span class="num" id="2456067">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456074">case</span>&nbsp;<span class="num" id="2456079">8</span><span class="op" id="2456080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456084">for</span>&nbsp;<span class="ident" id="2456088">ua</span>&nbsp;<span class="op" id="2456091">&gt;=</span>&nbsp;<span class="num" id="2456094">8</span>&nbsp;<span class="op" id="2456096">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456101">i</span><span class="op" id="2456102">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456108">buf</span><span class="op" id="2456111">[</span><span class="ident" id="2456112">i</span><span class="op" id="2456113">]</span>&nbsp;<span class="op" id="2456115">=</span>&nbsp;<span class="builtintype" id="2456117">byte</span><span class="op" id="2456121">(</span><span class="string" id="2456122">&#39;0&#39;</span>&nbsp;<span class="op" id="2456126">+</span>&nbsp;<span class="ident" id="2456128">ua</span><span class="op" id="2456130">&amp;</span><span class="num" id="2456131">7</span><span class="op" id="2456132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456137">ua</span>&nbsp;<span class="op" id="2456140">&gt;&gt;=</span>&nbsp;<span class="num" id="2456144">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456151">case</span>&nbsp;<span class="num" id="2456156">2</span><span class="op" id="2456157">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456161">for</span>&nbsp;<span class="ident" id="2456165">ua</span>&nbsp;<span class="op" id="2456168">&gt;=</span>&nbsp;<span class="num" id="2456171">2</span>&nbsp;<span class="op" id="2456173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456178">i</span><span class="op" id="2456179">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456185">buf</span><span class="op" id="2456188">[</span><span class="ident" id="2456189">i</span><span class="op" id="2456190">]</span>&nbsp;<span class="op" id="2456192">=</span>&nbsp;<span class="builtintype" id="2456194">byte</span><span class="op" id="2456198">(</span><span class="string" id="2456199">&#39;0&#39;</span>&nbsp;<span class="op" id="2456203">+</span>&nbsp;<span class="ident" id="2456205">ua</span><span class="op" id="2456207">&amp;</span><span class="num" id="2456208">1</span><span class="op" id="2456209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456214">ua</span>&nbsp;<span class="op" id="2456217">&gt;&gt;=</span>&nbsp;<span class="num" id="2456221">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456225">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456228">default</span><span class="op" id="2456235">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2456239">panic</span><span class="op" id="2456244">(</span><span class="string" id="2456245">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="2456278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456284">i</span><span class="op" id="2456285">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456289">buf</span><span class="op" id="2456292">[</span><span class="ident" id="2456293">i</span><span class="op" id="2456294">]</span>&nbsp;<span class="op" id="2456296">=</span>&nbsp;<span class="ident" id="2456298">digits</span><span class="op" id="2456304">[</span><span class="ident" id="2456305">ua</span><span class="op" id="2456307">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456310">for</span>&nbsp;<span class="ident" id="2456314">i</span>&nbsp;<span class="op" id="2456316">&gt;</span>&nbsp;<span class="num" id="2456318">0</span>&nbsp;<span class="op" id="2456320">&amp;&amp;</span>&nbsp;<span class="ident" id="2456323">prec</span>&nbsp;<span class="op" id="2456328">&gt;</span>&nbsp;<span class="builtinfunc" id="2456330">len</span><span class="op" id="2456333">(</span><span class="ident" id="2456334">buf</span><span class="op" id="2456337">)</span><span class="op" id="2456338">-</span><span class="ident" id="2456339">i</span>&nbsp;<span class="op" id="2456341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456345">i</span><span class="op" id="2456346">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456351">buf</span><span class="op" id="2456354">[</span><span class="ident" id="2456355">i</span><span class="op" id="2456356">]</span>&nbsp;<span class="op" id="2456358">=</span>&nbsp;<span class="string" id="2456360">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2456369">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456403">if</span>&nbsp;<span class="ident" id="2456406">f</span><span class="op" id="2456407">.</span><span class="ident" id="2456408">sharp</span>&nbsp;<span class="op" id="2456414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456418">switch</span>&nbsp;<span class="ident" id="2456425">base</span>&nbsp;<span class="op" id="2456430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456434">case</span>&nbsp;<span class="num" id="2456439">8</span><span class="op" id="2456440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456445">if</span>&nbsp;<span class="ident" id="2456448">buf</span><span class="op" id="2456451">[</span><span class="ident" id="2456452">i</span><span class="op" id="2456453">]</span>&nbsp;<span class="op" id="2456455">!=</span>&nbsp;<span class="string" id="2456458">&#39;0&#39;</span>&nbsp;<span class="op" id="2456462">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456468">i</span><span class="op" id="2456469">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456476">buf</span><span class="op" id="2456479">[</span><span class="ident" id="2456480">i</span><span class="op" id="2456481">]</span>&nbsp;<span class="op" id="2456483">=</span>&nbsp;<span class="string" id="2456485">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456496">case</span>&nbsp;<span class="num" id="2456501">16</span><span class="op" id="2456503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456508">i</span><span class="op" id="2456509">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456515">buf</span><span class="op" id="2456518">[</span><span class="ident" id="2456519">i</span><span class="op" id="2456520">]</span>&nbsp;<span class="op" id="2456522">=</span>&nbsp;<span class="string" id="2456524">&#39;x&#39;</span>&nbsp;<span class="op" id="2456528">+</span>&nbsp;<span class="ident" id="2456530">digits</span><span class="op" id="2456536">[</span><span class="num" id="2456537">10</span><span class="op" id="2456539">]</span>&nbsp;<span class="op" id="2456541">-</span>&nbsp;<span class="string" id="2456543">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456550">i</span><span class="op" id="2456551">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456557">buf</span><span class="op" id="2456560">[</span><span class="ident" id="2456561">i</span><span class="op" id="2456562">]</span>&nbsp;<span class="op" id="2456564">=</span>&nbsp;<span class="string" id="2456566">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456575">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456578">if</span>&nbsp;<span class="ident" id="2456581">f</span><span class="op" id="2456582">.</span><span class="ident" id="2456583">unicode</span>&nbsp;<span class="op" id="2456591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456595">i</span><span class="op" id="2456596">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456601">buf</span><span class="op" id="2456604">[</span><span class="ident" id="2456605">i</span><span class="op" id="2456606">]</span>&nbsp;<span class="op" id="2456608">=</span>&nbsp;<span class="string" id="2456610">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456616">i</span><span class="op" id="2456617">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456622">buf</span><span class="op" id="2456625">[</span><span class="ident" id="2456626">i</span><span class="op" id="2456627">]</span>&nbsp;<span class="op" id="2456629">=</span>&nbsp;<span class="string" id="2456631">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456640">if</span>&nbsp;<span class="ident" id="2456643">negative</span>&nbsp;<span class="op" id="2456652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456656">i</span><span class="op" id="2456657">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456662">buf</span><span class="op" id="2456665">[</span><span class="ident" id="2456666">i</span><span class="op" id="2456667">]</span>&nbsp;<span class="op" id="2456669">=</span>&nbsp;<span class="string" id="2456671">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456676">}</span>&nbsp;<span class="keyword" id="2456678">else</span>&nbsp;<span class="keyword" id="2456683">if</span>&nbsp;<span class="ident" id="2456686">f</span><span class="op" id="2456687">.</span><span class="ident" id="2456688">plus</span>&nbsp;<span class="op" id="2456693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456697">i</span><span class="op" id="2456698">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456703">buf</span><span class="op" id="2456706">[</span><span class="ident" id="2456707">i</span><span class="op" id="2456708">]</span>&nbsp;<span class="op" id="2456710">=</span>&nbsp;<span class="string" id="2456712">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456717">}</span>&nbsp;<span class="keyword" id="2456719">else</span>&nbsp;<span class="keyword" id="2456724">if</span>&nbsp;<span class="ident" id="2456727">f</span><span class="op" id="2456728">.</span><span class="ident" id="2456729">space</span>&nbsp;<span class="op" id="2456735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456739">i</span><span class="op" id="2456740">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456745">buf</span><span class="op" id="2456748">[</span><span class="ident" id="2456749">i</span><span class="op" id="2456750">]</span>&nbsp;<span class="op" id="2456752">=</span>&nbsp;<span class="string" id="2456754">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2456759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2456763">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456832">if</span>&nbsp;<span class="ident" id="2456835">f</span><span class="op" id="2456836">.</span><span class="ident" id="2456837">unicode</span>&nbsp;<span class="op" id="2456845">&amp;&amp;</span>&nbsp;<span class="ident" id="2456848">f</span><span class="op" id="2456849">.</span><span class="ident" id="2456850">uniQuote</span>&nbsp;<span class="op" id="2456859">&amp;&amp;</span>&nbsp;<span class="ident" id="2456862">a</span>&nbsp;<span class="op" id="2456864">&gt;=</span>&nbsp;<span class="num" id="2456867">0</span>&nbsp;<span class="op" id="2456869">&amp;&amp;</span>&nbsp;<span class="ident" id="2456872">a</span>&nbsp;<span class="op" id="2456874">&lt;=</span>&nbsp;<span class="ident" id="2456877">utf8</span><span class="op" id="2456881">.</span><span class="ident" id="2456882">MaxRune</span>&nbsp;<span class="op" id="2456890">&amp;&amp;</span>&nbsp;<span class="ident" id="2456893">strconv</span><span class="op" id="2456900">.</span><span class="ident" id="2456901">IsPrint</span><span class="op" id="2456908">(</span><span class="builtintype" id="2456909">rune</span><span class="op" id="2456913">(</span><span class="ident" id="2456914">a</span><span class="op" id="2456915">)</span><span class="op" id="2456916">)</span>&nbsp;<span class="op" id="2456918">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456922">runeWidth</span>&nbsp;<span class="op" id="2456932">:=</span>&nbsp;<span class="ident" id="2456935">utf8</span><span class="op" id="2456939">.</span><span class="ident" id="2456940">RuneLen</span><span class="op" id="2456947">(</span><span class="builtintype" id="2456948">rune</span><span class="op" id="2456952">(</span><span class="ident" id="2456953">a</span><span class="op" id="2456954">)</span><span class="op" id="2456955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456959">width</span>&nbsp;<span class="op" id="2456965">:=</span>&nbsp;<span class="num" id="2456968">1</span>&nbsp;<span class="op" id="2456970">+</span>&nbsp;<span class="num" id="2456972">1</span>&nbsp;<span class="op" id="2456974">+</span>&nbsp;<span class="ident" id="2456976">runeWidth</span>&nbsp;<span class="op" id="2456986">+</span>&nbsp;<span class="num" id="2456988">1</span>&nbsp;<span class="comment" id="2456990">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2457021">copy</span><span class="op" id="2457025">(</span><span class="ident" id="2457026">buf</span><span class="op" id="2457029">[</span><span class="ident" id="2457030">i</span><span class="op" id="2457031">-</span><span class="ident" id="2457032">width</span><span class="op" id="2457037">:</span><span class="op" id="2457038">]</span><span class="op" id="2457039">,</span>&nbsp;<span class="ident" id="2457041">buf</span><span class="op" id="2457044">[</span><span class="ident" id="2457045">i</span><span class="op" id="2457046">:</span><span class="op" id="2457047">]</span><span class="op" id="2457048">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2457052">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457089">i</span>&nbsp;<span class="op" id="2457091">-=</span>&nbsp;<span class="ident" id="2457094">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457102">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457134">j</span>&nbsp;<span class="op" id="2457136">:=</span>&nbsp;<span class="builtinfunc" id="2457139">len</span><span class="op" id="2457142">(</span><span class="ident" id="2457143">buf</span><span class="op" id="2457146">)</span>&nbsp;<span class="op" id="2457148">-</span>&nbsp;<span class="ident" id="2457150">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457158">buf</span><span class="op" id="2457161">[</span><span class="ident" id="2457162">j</span><span class="op" id="2457163">]</span>&nbsp;<span class="op" id="2457165">=</span>&nbsp;<span class="string" id="2457167">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457173">j</span><span class="op" id="2457174">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457179">buf</span><span class="op" id="2457182">[</span><span class="ident" id="2457183">j</span><span class="op" id="2457184">]</span>&nbsp;<span class="op" id="2457186">=</span>&nbsp;<span class="string" id="2457188">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457195">j</span><span class="op" id="2457196">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457201">utf8</span><span class="op" id="2457205">.</span><span class="ident" id="2457206">EncodeRune</span><span class="op" id="2457216">(</span><span class="ident" id="2457217">buf</span><span class="op" id="2457220">[</span><span class="ident" id="2457221">j</span><span class="op" id="2457222">:</span><span class="op" id="2457223">]</span><span class="op" id="2457224">,</span>&nbsp;<span class="builtintype" id="2457226">rune</span><span class="op" id="2457230">(</span><span class="ident" id="2457231">a</span><span class="op" id="2457232">)</span><span class="op" id="2457233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457237">j</span>&nbsp;<span class="op" id="2457239">+=</span>&nbsp;<span class="ident" id="2457242">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457254">buf</span><span class="op" id="2457257">[</span><span class="ident" id="2457258">j</span><span class="op" id="2457259">]</span>&nbsp;<span class="op" id="2457261">=</span>&nbsp;<span class="string" id="2457263">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2457269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457273">f</span><span class="op" id="2457274">.</span><span class="ident" id="2457275">pad</span><span class="op" id="2457278">(</span><span class="ident" id="2457279">buf</span><span class="op" id="2457282">[</span><span class="ident" id="2457283">i</span><span class="op" id="2457284">:</span><span class="op" id="2457285">]</span><span class="op" id="2457286">)</span><br>
<span class="lineno"></span><span class="op" id="2457288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2457291">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2457364">func</span>&nbsp;<span class="op" id="2457369">(</span><span class="ident" id="2457370">f</span>&nbsp;<span class="op" id="2457372">*</span><span class="ident" id="2457373">fmt</span><span class="op" id="2457376">)</span>&nbsp;<span class="ident" id="2457378">truncate</span><span class="op" id="2457386">(</span><span class="ident" id="2457387">s</span>&nbsp;<span class="builtintype" id="2457389">string</span><span class="op" id="2457395">)</span>&nbsp;<span class="builtintype" id="2457397">string</span>&nbsp;<span class="op" id="2457404">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457407">if</span>&nbsp;<span class="ident" id="2457410">f</span><span class="op" id="2457411">.</span><span class="ident" id="2457412">precPresent</span>&nbsp;<span class="op" id="2457424">&amp;&amp;</span>&nbsp;<span class="ident" id="2457427">f</span><span class="op" id="2457428">.</span><span class="ident" id="2457429">prec</span>&nbsp;<span class="op" id="2457434">&lt;</span>&nbsp;<span class="ident" id="2457436">utf8</span><span class="op" id="2457440">.</span><span class="ident" id="2457441">RuneCountInString</span><span class="op" id="2457458">(</span><span class="ident" id="2457459">s</span><span class="op" id="2457460">)</span>&nbsp;<span class="op" id="2457462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457466">n</span>&nbsp;<span class="op" id="2457468">:=</span>&nbsp;<span class="ident" id="2457471">f</span><span class="op" id="2457472">.</span><span class="ident" id="2457473">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457480">for</span>&nbsp;<span class="ident" id="2457484">i</span>&nbsp;<span class="op" id="2457486">:=</span>&nbsp;<span class="keyword" id="2457489">range</span>&nbsp;<span class="ident" id="2457495">s</span>&nbsp;<span class="op" id="2457497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457502">if</span>&nbsp;<span class="ident" id="2457505">n</span>&nbsp;<span class="op" id="2457507">==</span>&nbsp;<span class="num" id="2457510">0</span>&nbsp;<span class="op" id="2457512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457518">s</span>&nbsp;<span class="op" id="2457520">=</span>&nbsp;<span class="ident" id="2457522">s</span><span class="op" id="2457523">[</span><span class="op" id="2457524">:</span><span class="ident" id="2457525">i</span><span class="op" id="2457526">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457532">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2457541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457546">n</span><span class="op" id="2457547">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2457552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2457555">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457558">return</span>&nbsp;<span class="ident" id="2457565">s</span><br>
<span class="lineno"></span><span class="op" id="2457567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2457570">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2457597">func</span>&nbsp;<span class="op" id="2457602">(</span><span class="ident" id="2457603">f</span>&nbsp;<span class="op" id="2457605">*</span><span class="ident" id="2457606">fmt</span><span class="op" id="2457609">)</span>&nbsp;<span class="ident" id="2457611">fmt_s</span><span class="op" id="2457616">(</span><span class="ident" id="2457617">s</span>&nbsp;<span class="builtintype" id="2457619">string</span><span class="op" id="2457625">)</span>&nbsp;<span class="op" id="2457627">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457630">s</span>&nbsp;<span class="op" id="2457632">=</span>&nbsp;<span class="ident" id="2457634">f</span><span class="op" id="2457635">.</span><span class="ident" id="2457636">truncate</span><span class="op" id="2457644">(</span><span class="ident" id="2457645">s</span><span class="op" id="2457646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457649">f</span><span class="op" id="2457650">.</span><span class="ident" id="2457651">padString</span><span class="op" id="2457660">(</span><span class="ident" id="2457661">s</span><span class="op" id="2457662">)</span><br>
<span class="lineno"></span><span class="op" id="2457664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2457667">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="2457749">func</span>&nbsp;<span class="op" id="2457754">(</span><span class="ident" id="2457755">f</span>&nbsp;<span class="op" id="2457757">*</span><span class="ident" id="2457758">fmt</span><span class="op" id="2457761">)</span>&nbsp;<span class="ident" id="2457763">fmt_sbx</span><span class="op" id="2457770">(</span><span class="ident" id="2457771">s</span>&nbsp;<span class="builtintype" id="2457773">string</span><span class="op" id="2457779">,</span>&nbsp;<span class="ident" id="2457781">b</span>&nbsp;<span class="op" id="2457783">[</span><span class="op" id="2457784">]</span><span class="builtintype" id="2457785">byte</span><span class="op" id="2457789">,</span>&nbsp;<span class="ident" id="2457791">digits</span>&nbsp;<span class="builtintype" id="2457798">string</span><span class="op" id="2457804">)</span>&nbsp;<span class="op" id="2457806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457809">n</span>&nbsp;<span class="op" id="2457811">:=</span>&nbsp;<span class="builtinfunc" id="2457814">len</span><span class="op" id="2457817">(</span><span class="ident" id="2457818">b</span><span class="op" id="2457819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457822">if</span>&nbsp;<span class="ident" id="2457825">b</span>&nbsp;<span class="op" id="2457827">==</span>&nbsp;<span class="ident" id="2457830">nil</span>&nbsp;<span class="op" id="2457834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457838">n</span>&nbsp;<span class="op" id="2457840">=</span>&nbsp;<span class="builtinfunc" id="2457842">len</span><span class="op" id="2457845">(</span><span class="ident" id="2457846">s</span><span class="op" id="2457847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2457850">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457853">x</span>&nbsp;<span class="op" id="2457855">:=</span>&nbsp;<span class="ident" id="2457858">digits</span><span class="op" id="2457864">[</span><span class="num" id="2457865">10</span><span class="op" id="2457867">]</span>&nbsp;<span class="op" id="2457869">-</span>&nbsp;<span class="string" id="2457871">&#39;a&#39;</span>&nbsp;<span class="op" id="2457875">+</span>&nbsp;<span class="string" id="2457877">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457882">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457921">var</span>&nbsp;<span class="ident" id="2457925">buf</span>&nbsp;<span class="op" id="2457929">[</span><span class="op" id="2457930">]</span><span class="builtintype" id="2457931">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457937">for</span>&nbsp;<span class="ident" id="2457941">i</span>&nbsp;<span class="op" id="2457943">:=</span>&nbsp;<span class="num" id="2457946">0</span><span class="op" id="2457947">;</span>&nbsp;<span class="ident" id="2457949">i</span>&nbsp;<span class="op" id="2457951">&lt;</span>&nbsp;<span class="ident" id="2457953">n</span><span class="op" id="2457954">;</span>&nbsp;<span class="ident" id="2457956">i</span><span class="op" id="2457957">++</span>&nbsp;<span class="op" id="2457960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457964">if</span>&nbsp;<span class="ident" id="2457967">i</span>&nbsp;<span class="op" id="2457969">&gt;</span>&nbsp;<span class="num" id="2457971">0</span>&nbsp;<span class="op" id="2457973">&amp;&amp;</span>&nbsp;<span class="ident" id="2457976">f</span><span class="op" id="2457977">.</span><span class="ident" id="2457978">space</span>&nbsp;<span class="op" id="2457984">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457989">buf</span>&nbsp;<span class="op" id="2457993">=</span>&nbsp;<span class="builtinfunc" id="2457995">append</span><span class="op" id="2458001">(</span><span class="ident" id="2458002">buf</span><span class="op" id="2458005">,</span>&nbsp;<span class="string" id="2458007">&#39;&nbsp;&#39;</span><span class="op" id="2458010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458018">if</span>&nbsp;<span class="ident" id="2458021">f</span><span class="op" id="2458022">.</span><span class="ident" id="2458023">sharp</span>&nbsp;<span class="op" id="2458029">&amp;&amp;</span>&nbsp;<span class="op" id="2458032">(</span><span class="ident" id="2458033">f</span><span class="op" id="2458034">.</span><span class="ident" id="2458035">space</span>&nbsp;<span class="op" id="2458041">||</span>&nbsp;<span class="ident" id="2458044">i</span>&nbsp;<span class="op" id="2458046">==</span>&nbsp;<span class="num" id="2458049">0</span><span class="op" id="2458050">)</span>&nbsp;<span class="op" id="2458052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458057">buf</span>&nbsp;<span class="op" id="2458061">=</span>&nbsp;<span class="builtinfunc" id="2458063">append</span><span class="op" id="2458069">(</span><span class="ident" id="2458070">buf</span><span class="op" id="2458073">,</span>&nbsp;<span class="string" id="2458075">&#39;0&#39;</span><span class="op" id="2458078">,</span>&nbsp;<span class="ident" id="2458080">x</span><span class="op" id="2458081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458085">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458089">var</span>&nbsp;<span class="ident" id="2458093">c</span>&nbsp;<span class="builtintype" id="2458095">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458102">if</span>&nbsp;<span class="ident" id="2458105">b</span>&nbsp;<span class="op" id="2458107">==</span>&nbsp;<span class="ident" id="2458110">nil</span>&nbsp;<span class="op" id="2458114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458119">c</span>&nbsp;<span class="op" id="2458121">=</span>&nbsp;<span class="ident" id="2458123">s</span><span class="op" id="2458124">[</span><span class="ident" id="2458125">i</span><span class="op" id="2458126">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458130">}</span>&nbsp;<span class="keyword" id="2458132">else</span>&nbsp;<span class="op" id="2458137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458142">c</span>&nbsp;<span class="op" id="2458144">=</span>&nbsp;<span class="ident" id="2458146">b</span><span class="op" id="2458147">[</span><span class="ident" id="2458148">i</span><span class="op" id="2458149">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458157">buf</span>&nbsp;<span class="op" id="2458161">=</span>&nbsp;<span class="builtinfunc" id="2458163">append</span><span class="op" id="2458169">(</span><span class="ident" id="2458170">buf</span><span class="op" id="2458173">,</span>&nbsp;<span class="ident" id="2458175">digits</span><span class="op" id="2458181">[</span><span class="ident" id="2458182">c</span><span class="op" id="2458183">&gt;&gt;</span><span class="num" id="2458185">4</span><span class="op" id="2458186">]</span><span class="op" id="2458187">,</span>&nbsp;<span class="ident" id="2458189">digits</span><span class="op" id="2458195">[</span><span class="ident" id="2458196">c</span><span class="op" id="2458197">&amp;</span><span class="num" id="2458198">0xF</span><span class="op" id="2458201">]</span><span class="op" id="2458202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458208">f</span><span class="op" id="2458209">.</span><span class="ident" id="2458210">pad</span><span class="op" id="2458213">(</span><span class="ident" id="2458214">buf</span><span class="op" id="2458217">)</span><br>
<span class="lineno"></span><span class="op" id="2458219">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="2458222">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2458289">func</span>&nbsp;<span class="op" id="2458294">(</span><span class="ident" id="2458295">f</span>&nbsp;<span class="op" id="2458297">*</span><span class="ident" id="2458298">fmt</span><span class="op" id="2458301">)</span>&nbsp;<span class="ident" id="2458303">fmt_sx</span><span class="op" id="2458309">(</span><span class="ident" id="2458310">s</span><span class="op" id="2458311">,</span>&nbsp;<span class="ident" id="2458313">digits</span>&nbsp;<span class="builtintype" id="2458320">string</span><span class="op" id="2458326">)</span>&nbsp;<span class="op" id="2458328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458331">if</span>&nbsp;<span class="ident" id="2458334">f</span><span class="op" id="2458335">.</span><span class="ident" id="2458336">precPresent</span>&nbsp;<span class="op" id="2458348">&amp;&amp;</span>&nbsp;<span class="ident" id="2458351">f</span><span class="op" id="2458352">.</span><span class="ident" id="2458353">prec</span>&nbsp;<span class="op" id="2458358">&lt;</span>&nbsp;<span class="builtinfunc" id="2458360">len</span><span class="op" id="2458363">(</span><span class="ident" id="2458364">s</span><span class="op" id="2458365">)</span>&nbsp;<span class="op" id="2458367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458371">s</span>&nbsp;<span class="op" id="2458373">=</span>&nbsp;<span class="ident" id="2458375">s</span><span class="op" id="2458376">[</span><span class="op" id="2458377">:</span><span class="ident" id="2458378">f</span><span class="op" id="2458379">.</span><span class="ident" id="2458380">prec</span><span class="op" id="2458384">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458390">f</span><span class="op" id="2458391">.</span><span class="ident" id="2458392">fmt_sbx</span><span class="op" id="2458399">(</span><span class="ident" id="2458400">s</span><span class="op" id="2458401">,</span>&nbsp;<span class="ident" id="2458403">nil</span><span class="op" id="2458406">,</span>&nbsp;<span class="ident" id="2458408">digits</span><span class="op" id="2458414">)</span><br>
<span class="lineno"></span><span class="op" id="2458416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2458419">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="2458490">func</span>&nbsp;<span class="op" id="2458495">(</span><span class="ident" id="2458496">f</span>&nbsp;<span class="op" id="2458498">*</span><span class="ident" id="2458499">fmt</span><span class="op" id="2458502">)</span>&nbsp;<span class="ident" id="2458504">fmt_bx</span><span class="op" id="2458510">(</span><span class="ident" id="2458511">b</span>&nbsp;<span class="op" id="2458513">[</span><span class="op" id="2458514">]</span><span class="builtintype" id="2458515">byte</span><span class="op" id="2458519">,</span>&nbsp;<span class="ident" id="2458521">digits</span>&nbsp;<span class="builtintype" id="2458528">string</span><span class="op" id="2458534">)</span>&nbsp;<span class="op" id="2458536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458539">if</span>&nbsp;<span class="ident" id="2458542">f</span><span class="op" id="2458543">.</span><span class="ident" id="2458544">precPresent</span>&nbsp;<span class="op" id="2458556">&amp;&amp;</span>&nbsp;<span class="ident" id="2458559">f</span><span class="op" id="2458560">.</span><span class="ident" id="2458561">prec</span>&nbsp;<span class="op" id="2458566">&lt;</span>&nbsp;<span class="builtinfunc" id="2458568">len</span><span class="op" id="2458571">(</span><span class="ident" id="2458572">b</span><span class="op" id="2458573">)</span>&nbsp;<span class="op" id="2458575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458579">b</span>&nbsp;<span class="op" id="2458581">=</span>&nbsp;<span class="ident" id="2458583">b</span><span class="op" id="2458584">[</span><span class="op" id="2458585">:</span><span class="ident" id="2458586">f</span><span class="op" id="2458587">.</span><span class="ident" id="2458588">prec</span><span class="op" id="2458592">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458598">f</span><span class="op" id="2458599">.</span><span class="ident" id="2458600">fmt_sbx</span><span class="op" id="2458607">(</span><span class="string" id="2458608">&#34;&#34;</span><span class="op" id="2458610">,</span>&nbsp;<span class="ident" id="2458612">b</span><span class="op" id="2458613">,</span>&nbsp;<span class="ident" id="2458615">digits</span><span class="op" id="2458621">)</span><br>
<span class="lineno">355</span><span class="op" id="2458623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2458626">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2458700">func</span>&nbsp;<span class="op" id="2458705">(</span><span class="ident" id="2458706">f</span>&nbsp;<span class="op" id="2458708">*</span><span class="ident" id="2458709">fmt</span><span class="op" id="2458712">)</span>&nbsp;<span class="ident" id="2458714">fmt_q</span><span class="op" id="2458719">(</span><span class="ident" id="2458720">s</span>&nbsp;<span class="builtintype" id="2458722">string</span><span class="op" id="2458728">)</span>&nbsp;<span class="op" id="2458730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458733">s</span>&nbsp;<span class="op" id="2458735">=</span>&nbsp;<span class="ident" id="2458737">f</span><span class="op" id="2458738">.</span><span class="ident" id="2458739">truncate</span><span class="op" id="2458747">(</span><span class="ident" id="2458748">s</span><span class="op" id="2458749">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458752">var</span>&nbsp;<span class="ident" id="2458756">quoted</span>&nbsp;<span class="builtintype" id="2458763">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458771">if</span>&nbsp;<span class="ident" id="2458774">f</span><span class="op" id="2458775">.</span><span class="ident" id="2458776">sharp</span>&nbsp;<span class="op" id="2458782">&amp;&amp;</span>&nbsp;<span class="ident" id="2458785">strconv</span><span class="op" id="2458792">.</span><span class="ident" id="2458793">CanBackquote</span><span class="op" id="2458805">(</span><span class="ident" id="2458806">s</span><span class="op" id="2458807">)</span>&nbsp;<span class="op" id="2458809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458813">quoted</span>&nbsp;<span class="op" id="2458820">=</span>&nbsp;<span class="string" id="2458822">&#34;`&#34;</span>&nbsp;<span class="op" id="2458826">+</span>&nbsp;<span class="ident" id="2458828">s</span>&nbsp;<span class="op" id="2458830">+</span>&nbsp;<span class="string" id="2458832">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458837">}</span>&nbsp;<span class="keyword" id="2458839">else</span>&nbsp;<span class="op" id="2458844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458848">if</span>&nbsp;<span class="ident" id="2458851">f</span><span class="op" id="2458852">.</span><span class="ident" id="2458853">plus</span>&nbsp;<span class="op" id="2458858">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458863">quoted</span>&nbsp;<span class="op" id="2458870">=</span>&nbsp;<span class="ident" id="2458872">strconv</span><span class="op" id="2458879">.</span><span class="ident" id="2458880">QuoteToASCII</span><span class="op" id="2458892">(</span><span class="ident" id="2458893">s</span><span class="op" id="2458894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458898">}</span>&nbsp;<span class="keyword" id="2458900">else</span>&nbsp;<span class="op" id="2458905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458910">quoted</span>&nbsp;<span class="op" id="2458917">=</span>&nbsp;<span class="ident" id="2458919">strconv</span><span class="op" id="2458926">.</span><span class="ident" id="2458927">Quote</span><span class="op" id="2458932">(</span><span class="ident" id="2458933">s</span><span class="op" id="2458934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458941">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458944">f</span><span class="op" id="2458945">.</span><span class="ident" id="2458946">padString</span><span class="op" id="2458955">(</span><span class="ident" id="2458956">quoted</span><span class="op" id="2458962">)</span><br>
<span class="lineno"></span><span class="op" id="2458964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2458967">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2459048">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="2459114">func</span>&nbsp;<span class="op" id="2459119">(</span><span class="ident" id="2459120">f</span>&nbsp;<span class="op" id="2459122">*</span><span class="ident" id="2459123">fmt</span><span class="op" id="2459126">)</span>&nbsp;<span class="ident" id="2459128">fmt_qc</span><span class="op" id="2459134">(</span><span class="ident" id="2459135">c</span>&nbsp;<span class="ident" id="2459137">int64</span><span class="op" id="2459142">)</span>&nbsp;<span class="op" id="2459144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459147">var</span>&nbsp;<span class="ident" id="2459151">quoted</span>&nbsp;<span class="op" id="2459158">[</span><span class="op" id="2459159">]</span><span class="builtintype" id="2459160">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459166">if</span>&nbsp;<span class="ident" id="2459169">f</span><span class="op" id="2459170">.</span><span class="ident" id="2459171">plus</span>&nbsp;<span class="op" id="2459176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459180">quoted</span>&nbsp;<span class="op" id="2459187">=</span>&nbsp;<span class="ident" id="2459189">strconv</span><span class="op" id="2459196">.</span><span class="ident" id="2459197">AppendQuoteRuneToASCII</span><span class="op" id="2459219">(</span><span class="ident" id="2459220">f</span><span class="op" id="2459221">.</span><span class="ident" id="2459222">intbuf</span><span class="op" id="2459228">[</span><span class="num" id="2459229">0</span><span class="op" id="2459230">:</span><span class="num" id="2459231">0</span><span class="op" id="2459232">]</span><span class="op" id="2459233">,</span>&nbsp;<span class="builtintype" id="2459235">rune</span><span class="op" id="2459239">(</span><span class="ident" id="2459240">c</span><span class="op" id="2459241">)</span><span class="op" id="2459242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459245">}</span>&nbsp;<span class="keyword" id="2459247">else</span>&nbsp;<span class="op" id="2459252">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459256">quoted</span>&nbsp;<span class="op" id="2459263">=</span>&nbsp;<span class="ident" id="2459265">strconv</span><span class="op" id="2459272">.</span><span class="ident" id="2459273">AppendQuoteRune</span><span class="op" id="2459288">(</span><span class="ident" id="2459289">f</span><span class="op" id="2459290">.</span><span class="ident" id="2459291">intbuf</span><span class="op" id="2459297">[</span><span class="num" id="2459298">0</span><span class="op" id="2459299">:</span><span class="num" id="2459300">0</span><span class="op" id="2459301">]</span><span class="op" id="2459302">,</span>&nbsp;<span class="builtintype" id="2459304">rune</span><span class="op" id="2459308">(</span><span class="ident" id="2459309">c</span><span class="op" id="2459310">)</span><span class="op" id="2459311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459317">f</span><span class="op" id="2459318">.</span><span class="ident" id="2459319">pad</span><span class="op" id="2459322">(</span><span class="ident" id="2459323">quoted</span><span class="op" id="2459329">)</span><br>
<span class="lineno"></span><span class="op" id="2459331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="2459334">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2459353">func</span>&nbsp;<span class="ident" id="2459358">doPrec</span><span class="op" id="2459364">(</span><span class="ident" id="2459365">f</span>&nbsp;<span class="op" id="2459367">*</span><span class="ident" id="2459368">fmt</span><span class="op" id="2459371">,</span>&nbsp;<span class="ident" id="2459373">def</span>&nbsp;<span class="builtintype" id="2459377">int</span><span class="op" id="2459380">)</span>&nbsp;<span class="builtintype" id="2459382">int</span>&nbsp;<span class="op" id="2459386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459389">if</span>&nbsp;<span class="ident" id="2459392">f</span><span class="op" id="2459393">.</span><span class="ident" id="2459394">precPresent</span>&nbsp;<span class="op" id="2459406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459410">return</span>&nbsp;<span class="ident" id="2459417">f</span><span class="op" id="2459418">.</span><span class="ident" id="2459419">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459428">return</span>&nbsp;<span class="ident" id="2459435">def</span><br>
<span class="lineno"></span><span class="op" id="2459439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2459442">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="2459543">func</span>&nbsp;<span class="op" id="2459548">(</span><span class="ident" id="2459549">f</span>&nbsp;<span class="op" id="2459551">*</span><span class="ident" id="2459552">fmt</span><span class="op" id="2459555">)</span>&nbsp;<span class="ident" id="2459557">formatFloat</span><span class="op" id="2459568">(</span><span class="ident" id="2459569">v</span>&nbsp;<span class="builtintype" id="2459571">float64</span><span class="op" id="2459578">,</span>&nbsp;<span class="ident" id="2459580">verb</span>&nbsp;<span class="builtintype" id="2459585">byte</span><span class="op" id="2459589">,</span>&nbsp;<span class="ident" id="2459591">prec</span><span class="op" id="2459595">,</span>&nbsp;<span class="ident" id="2459597">n</span>&nbsp;<span class="builtintype" id="2459599">int</span><span class="op" id="2459602">)</span>&nbsp;<span class="op" id="2459604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2459607">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459672">num</span>&nbsp;<span class="op" id="2459676">:=</span>&nbsp;<span class="ident" id="2459679">strconv</span><span class="op" id="2459686">.</span><span class="ident" id="2459687">AppendFloat</span><span class="op" id="2459698">(</span><span class="ident" id="2459699">f</span><span class="op" id="2459700">.</span><span class="ident" id="2459701">intbuf</span><span class="op" id="2459707">[</span><span class="num" id="2459708">0</span><span class="op" id="2459709">:</span><span class="num" id="2459710">1</span><span class="op" id="2459711">]</span><span class="op" id="2459712">,</span>&nbsp;<span class="ident" id="2459714">v</span><span class="op" id="2459715">,</span>&nbsp;<span class="ident" id="2459717">verb</span><span class="op" id="2459721">,</span>&nbsp;<span class="ident" id="2459723">prec</span><span class="op" id="2459727">,</span>&nbsp;<span class="ident" id="2459729">n</span><span class="op" id="2459730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459733">if</span>&nbsp;<span class="ident" id="2459736">num</span><span class="op" id="2459739">[</span><span class="num" id="2459740">1</span><span class="op" id="2459741">]</span>&nbsp;<span class="op" id="2459743">==</span>&nbsp;<span class="string" id="2459746">&#39;-&#39;</span>&nbsp;<span class="op" id="2459750">||</span>&nbsp;<span class="ident" id="2459753">num</span><span class="op" id="2459756">[</span><span class="num" id="2459757">1</span><span class="op" id="2459758">]</span>&nbsp;<span class="op" id="2459760">==</span>&nbsp;<span class="string" id="2459763">&#39;+&#39;</span>&nbsp;<span class="op" id="2459767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459771">num</span>&nbsp;<span class="op" id="2459775">=</span>&nbsp;<span class="ident" id="2459777">num</span><span class="op" id="2459780">[</span><span class="num" id="2459781">1</span><span class="op" id="2459782">:</span><span class="op" id="2459783">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459786">}</span>&nbsp;<span class="keyword" id="2459788">else</span>&nbsp;<span class="op" id="2459793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459797">num</span><span class="op" id="2459800">[</span><span class="num" id="2459801">0</span><span class="op" id="2459802">]</span>&nbsp;<span class="op" id="2459804">=</span>&nbsp;<span class="string" id="2459806">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2459814">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459917">if</span>&nbsp;<span class="ident" id="2459920">math</span><span class="op" id="2459924">.</span><span class="ident" id="2459925">IsInf</span><span class="op" id="2459930">(</span><span class="ident" id="2459931">v</span><span class="op" id="2459932">,</span>&nbsp;<span class="num" id="2459934">0</span><span class="op" id="2459935">)</span>&nbsp;<span class="op" id="2459937">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459941">if</span>&nbsp;<span class="ident" id="2459944">f</span><span class="op" id="2459945">.</span><span class="ident" id="2459946">zero</span>&nbsp;<span class="op" id="2459951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459956">defer</span>&nbsp;<span class="keyword" id="2459962">func</span><span class="op" id="2459966">(</span><span class="op" id="2459967">)</span>&nbsp;<span class="op" id="2459969">{</span>&nbsp;<span class="ident" id="2459971">f</span><span class="op" id="2459972">.</span><span class="ident" id="2459973">zero</span>&nbsp;<span class="op" id="2459978">=</span>&nbsp;<span class="builtintype" id="2459980">true</span>&nbsp;<span class="op" id="2459985">}</span><span class="op" id="2459986">(</span><span class="op" id="2459987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459992">f</span><span class="op" id="2459993">.</span><span class="ident" id="2459994">zero</span>&nbsp;<span class="op" id="2459999">=</span>&nbsp;<span class="builtintype" id="2460001">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460012">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2460015">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2460062">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2460129">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460208">if</span>&nbsp;<span class="ident" id="2460211">f</span><span class="op" id="2460212">.</span><span class="ident" id="2460213">zero</span>&nbsp;<span class="op" id="2460218">&amp;&amp;</span>&nbsp;<span class="ident" id="2460221">f</span><span class="op" id="2460222">.</span><span class="ident" id="2460223">widPresent</span>&nbsp;<span class="op" id="2460234">&amp;&amp;</span>&nbsp;<span class="ident" id="2460237">f</span><span class="op" id="2460238">.</span><span class="ident" id="2460239">wid</span>&nbsp;<span class="op" id="2460243">&gt;</span>&nbsp;<span class="builtinfunc" id="2460245">len</span><span class="op" id="2460248">(</span><span class="ident" id="2460249">num</span><span class="op" id="2460252">)</span>&nbsp;<span class="op" id="2460254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460258">if</span>&nbsp;<span class="ident" id="2460261">f</span><span class="op" id="2460262">.</span><span class="ident" id="2460263">space</span>&nbsp;<span class="op" id="2460269">&amp;&amp;</span>&nbsp;<span class="ident" id="2460272">v</span>&nbsp;<span class="op" id="2460274">&gt;=</span>&nbsp;<span class="num" id="2460277">0</span>&nbsp;<span class="op" id="2460279">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460284">f</span><span class="op" id="2460285">.</span><span class="ident" id="2460286">buf</span><span class="op" id="2460289">.</span><span class="ident" id="2460290">WriteByte</span><span class="op" id="2460299">(</span><span class="string" id="2460300">&#39;&nbsp;&#39;</span><span class="op" id="2460303">)</span>&nbsp;<span class="comment" id="2460305">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460369">f</span><span class="op" id="2460370">.</span><span class="ident" id="2460371">wid</span><span class="op" id="2460374">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460379">}</span>&nbsp;<span class="keyword" id="2460381">else</span>&nbsp;<span class="keyword" id="2460386">if</span>&nbsp;<span class="ident" id="2460389">f</span><span class="op" id="2460390">.</span><span class="ident" id="2460391">plus</span>&nbsp;<span class="op" id="2460396">||</span>&nbsp;<span class="ident" id="2460399">v</span>&nbsp;<span class="op" id="2460401">&lt;</span>&nbsp;<span class="num" id="2460403">0</span>&nbsp;<span class="op" id="2460405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460410">f</span><span class="op" id="2460411">.</span><span class="ident" id="2460412">buf</span><span class="op" id="2460415">.</span><span class="ident" id="2460416">WriteByte</span><span class="op" id="2460425">(</span><span class="ident" id="2460426">num</span><span class="op" id="2460429">[</span><span class="num" id="2460430">0</span><span class="op" id="2460431">]</span><span class="op" id="2460432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460437">f</span><span class="op" id="2460438">.</span><span class="ident" id="2460439">wid</span><span class="op" id="2460442">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460451">f</span><span class="op" id="2460452">.</span><span class="ident" id="2460453">pad</span><span class="op" id="2460456">(</span><span class="ident" id="2460457">num</span><span class="op" id="2460460">[</span><span class="num" id="2460461">1</span><span class="op" id="2460462">:</span><span class="op" id="2460463">]</span><span class="op" id="2460464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460468">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2460479">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460533">if</span>&nbsp;<span class="ident" id="2460536">f</span><span class="op" id="2460537">.</span><span class="ident" id="2460538">space</span>&nbsp;<span class="op" id="2460544">&amp;&amp;</span>&nbsp;<span class="ident" id="2460547">num</span><span class="op" id="2460550">[</span><span class="num" id="2460551">0</span><span class="op" id="2460552">]</span>&nbsp;<span class="op" id="2460554">==</span>&nbsp;<span class="string" id="2460557">&#39;+&#39;</span>&nbsp;<span class="op" id="2460561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460565">num</span><span class="op" id="2460568">[</span><span class="num" id="2460569">0</span><span class="op" id="2460570">]</span>&nbsp;<span class="op" id="2460572">=</span>&nbsp;<span class="string" id="2460574">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460580">f</span><span class="op" id="2460581">.</span><span class="ident" id="2460582">pad</span><span class="op" id="2460585">(</span><span class="ident" id="2460586">num</span><span class="op" id="2460589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460593">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460601">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2460604">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2460684">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460772">if</span>&nbsp;<span class="ident" id="2460775">f</span><span class="op" id="2460776">.</span><span class="ident" id="2460777">plus</span>&nbsp;<span class="op" id="2460782">||</span>&nbsp;<span class="ident" id="2460785">num</span><span class="op" id="2460788">[</span><span class="num" id="2460789">0</span><span class="op" id="2460790">]</span>&nbsp;<span class="op" id="2460792">==</span>&nbsp;<span class="string" id="2460795">&#39;-&#39;</span>&nbsp;<span class="op" id="2460799">||</span>&nbsp;<span class="ident" id="2460802">math</span><span class="op" id="2460806">.</span><span class="ident" id="2460807">IsInf</span><span class="op" id="2460812">(</span><span class="ident" id="2460813">v</span><span class="op" id="2460814">,</span>&nbsp;<span class="num" id="2460816">0</span><span class="op" id="2460817">)</span>&nbsp;<span class="op" id="2460819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460823">f</span><span class="op" id="2460824">.</span><span class="ident" id="2460825">pad</span><span class="op" id="2460828">(</span><span class="ident" id="2460829">num</span><span class="op" id="2460832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460836">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2460847">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460927">f</span><span class="op" id="2460928">.</span><span class="ident" id="2460929">pad</span><span class="op" id="2460932">(</span><span class="ident" id="2460933">num</span><span class="op" id="2460936">[</span><span class="num" id="2460937">1</span><span class="op" id="2460938">:</span><span class="op" id="2460939">]</span><span class="op" id="2460940">)</span><br>
<span class="lineno"></span><span class="op" id="2460942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="2460945">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2460997">func</span>&nbsp;<span class="op" id="2461002">(</span><span class="ident" id="2461003">f</span>&nbsp;<span class="op" id="2461005">*</span><span class="ident" id="2461006">fmt</span><span class="op" id="2461009">)</span>&nbsp;<span class="ident" id="2461011">fmt_e64</span><span class="op" id="2461018">(</span><span class="ident" id="2461019">v</span>&nbsp;<span class="builtintype" id="2461021">float64</span><span class="op" id="2461028">)</span>&nbsp;<span class="op" id="2461030">{</span>&nbsp;<span class="ident" id="2461032">f</span><span class="op" id="2461033">.</span><span class="ident" id="2461034">formatFloat</span><span class="op" id="2461045">(</span><span class="ident" id="2461046">v</span><span class="op" id="2461047">,</span>&nbsp;<span class="string" id="2461049">&#39;e&#39;</span><span class="op" id="2461052">,</span>&nbsp;<span class="ident" id="2461054">doPrec</span><span class="op" id="2461060">(</span><span class="ident" id="2461061">f</span><span class="op" id="2461062">,</span>&nbsp;<span class="num" id="2461064">6</span><span class="op" id="2461065">)</span><span class="op" id="2461066">,</span>&nbsp;<span class="num" id="2461068">64</span><span class="op" id="2461070">)</span>&nbsp;<span class="op" id="2461072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461075">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2461127">func</span>&nbsp;<span class="op" id="2461132">(</span><span class="ident" id="2461133">f</span>&nbsp;<span class="op" id="2461135">*</span><span class="ident" id="2461136">fmt</span><span class="op" id="2461139">)</span>&nbsp;<span class="ident" id="2461141">fmt_E64</span><span class="op" id="2461148">(</span><span class="ident" id="2461149">v</span>&nbsp;<span class="builtintype" id="2461151">float64</span><span class="op" id="2461158">)</span>&nbsp;<span class="op" id="2461160">{</span>&nbsp;<span class="ident" id="2461162">f</span><span class="op" id="2461163">.</span><span class="ident" id="2461164">formatFloat</span><span class="op" id="2461175">(</span><span class="ident" id="2461176">v</span><span class="op" id="2461177">,</span>&nbsp;<span class="string" id="2461179">&#39;E&#39;</span><span class="op" id="2461182">,</span>&nbsp;<span class="ident" id="2461184">doPrec</span><span class="op" id="2461190">(</span><span class="ident" id="2461191">f</span><span class="op" id="2461192">,</span>&nbsp;<span class="num" id="2461194">6</span><span class="op" id="2461195">)</span><span class="op" id="2461196">,</span>&nbsp;<span class="num" id="2461198">64</span><span class="op" id="2461200">)</span>&nbsp;<span class="op" id="2461202">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="2461205">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2461253">func</span>&nbsp;<span class="op" id="2461258">(</span><span class="ident" id="2461259">f</span>&nbsp;<span class="op" id="2461261">*</span><span class="ident" id="2461262">fmt</span><span class="op" id="2461265">)</span>&nbsp;<span class="ident" id="2461267">fmt_f64</span><span class="op" id="2461274">(</span><span class="ident" id="2461275">v</span>&nbsp;<span class="builtintype" id="2461277">float64</span><span class="op" id="2461284">)</span>&nbsp;<span class="op" id="2461286">{</span>&nbsp;<span class="ident" id="2461288">f</span><span class="op" id="2461289">.</span><span class="ident" id="2461290">formatFloat</span><span class="op" id="2461301">(</span><span class="ident" id="2461302">v</span><span class="op" id="2461303">,</span>&nbsp;<span class="string" id="2461305">&#39;f&#39;</span><span class="op" id="2461308">,</span>&nbsp;<span class="ident" id="2461310">doPrec</span><span class="op" id="2461316">(</span><span class="ident" id="2461317">f</span><span class="op" id="2461318">,</span>&nbsp;<span class="num" id="2461320">6</span><span class="op" id="2461321">)</span><span class="op" id="2461322">,</span>&nbsp;<span class="num" id="2461324">64</span><span class="op" id="2461326">)</span>&nbsp;<span class="op" id="2461328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461331">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="2461402">func</span>&nbsp;<span class="op" id="2461407">(</span><span class="ident" id="2461408">f</span>&nbsp;<span class="op" id="2461410">*</span><span class="ident" id="2461411">fmt</span><span class="op" id="2461414">)</span>&nbsp;<span class="ident" id="2461416">fmt_g64</span><span class="op" id="2461423">(</span><span class="ident" id="2461424">v</span>&nbsp;<span class="builtintype" id="2461426">float64</span><span class="op" id="2461433">)</span>&nbsp;<span class="op" id="2461435">{</span>&nbsp;<span class="ident" id="2461437">f</span><span class="op" id="2461438">.</span><span class="ident" id="2461439">formatFloat</span><span class="op" id="2461450">(</span><span class="ident" id="2461451">v</span><span class="op" id="2461452">,</span>&nbsp;<span class="string" id="2461454">&#39;g&#39;</span><span class="op" id="2461457">,</span>&nbsp;<span class="ident" id="2461459">doPrec</span><span class="op" id="2461465">(</span><span class="ident" id="2461466">f</span><span class="op" id="2461467">,</span>&nbsp;<span class="op" id="2461469">-</span><span class="num" id="2461470">1</span><span class="op" id="2461471">)</span><span class="op" id="2461472">,</span>&nbsp;<span class="num" id="2461474">64</span><span class="op" id="2461476">)</span>&nbsp;<span class="op" id="2461478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461481">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2461552">func</span>&nbsp;<span class="op" id="2461557">(</span><span class="ident" id="2461558">f</span>&nbsp;<span class="op" id="2461560">*</span><span class="ident" id="2461561">fmt</span><span class="op" id="2461564">)</span>&nbsp;<span class="ident" id="2461566">fmt_G64</span><span class="op" id="2461573">(</span><span class="ident" id="2461574">v</span>&nbsp;<span class="builtintype" id="2461576">float64</span><span class="op" id="2461583">)</span>&nbsp;<span class="op" id="2461585">{</span>&nbsp;<span class="ident" id="2461587">f</span><span class="op" id="2461588">.</span><span class="ident" id="2461589">formatFloat</span><span class="op" id="2461600">(</span><span class="ident" id="2461601">v</span><span class="op" id="2461602">,</span>&nbsp;<span class="string" id="2461604">&#39;G&#39;</span><span class="op" id="2461607">,</span>&nbsp;<span class="ident" id="2461609">doPrec</span><span class="op" id="2461615">(</span><span class="ident" id="2461616">f</span><span class="op" id="2461617">,</span>&nbsp;<span class="op" id="2461619">-</span><span class="num" id="2461620">1</span><span class="op" id="2461621">)</span><span class="op" id="2461622">,</span>&nbsp;<span class="num" id="2461624">64</span><span class="op" id="2461626">)</span>&nbsp;<span class="op" id="2461628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="2461631">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2461706">func</span>&nbsp;<span class="op" id="2461711">(</span><span class="ident" id="2461712">f</span>&nbsp;<span class="op" id="2461714">*</span><span class="ident" id="2461715">fmt</span><span class="op" id="2461718">)</span>&nbsp;<span class="ident" id="2461720">fmt_fb64</span><span class="op" id="2461728">(</span><span class="ident" id="2461729">v</span>&nbsp;<span class="builtintype" id="2461731">float64</span><span class="op" id="2461738">)</span>&nbsp;<span class="op" id="2461740">{</span>&nbsp;<span class="ident" id="2461742">f</span><span class="op" id="2461743">.</span><span class="ident" id="2461744">formatFloat</span><span class="op" id="2461755">(</span><span class="ident" id="2461756">v</span><span class="op" id="2461757">,</span>&nbsp;<span class="string" id="2461759">&#39;b&#39;</span><span class="op" id="2461762">,</span>&nbsp;<span class="num" id="2461764">0</span><span class="op" id="2461765">,</span>&nbsp;<span class="num" id="2461767">64</span><span class="op" id="2461769">)</span>&nbsp;<span class="op" id="2461771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461774">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="2461785">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="2461821">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461877">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2461929">func</span>&nbsp;<span class="op" id="2461934">(</span><span class="ident" id="2461935">f</span>&nbsp;<span class="op" id="2461937">*</span><span class="ident" id="2461938">fmt</span><span class="op" id="2461941">)</span>&nbsp;<span class="ident" id="2461943">fmt_e32</span><span class="op" id="2461950">(</span><span class="ident" id="2461951">v</span>&nbsp;<span class="builtintype" id="2461953">float32</span><span class="op" id="2461960">)</span>&nbsp;<span class="op" id="2461962">{</span>&nbsp;<span class="ident" id="2461964">f</span><span class="op" id="2461965">.</span><span class="ident" id="2461966">formatFloat</span><span class="op" id="2461977">(</span><span class="builtintype" id="2461978">float64</span><span class="op" id="2461985">(</span><span class="ident" id="2461986">v</span><span class="op" id="2461987">)</span><span class="op" id="2461988">,</span>&nbsp;<span class="string" id="2461990">&#39;e&#39;</span><span class="op" id="2461993">,</span>&nbsp;<span class="ident" id="2461995">doPrec</span><span class="op" id="2462001">(</span><span class="ident" id="2462002">f</span><span class="op" id="2462003">,</span>&nbsp;<span class="num" id="2462005">6</span><span class="op" id="2462006">)</span><span class="op" id="2462007">,</span>&nbsp;<span class="num" id="2462009">32</span><span class="op" id="2462011">)</span>&nbsp;<span class="op" id="2462013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="2462016">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2462068">func</span>&nbsp;<span class="op" id="2462073">(</span><span class="ident" id="2462074">f</span>&nbsp;<span class="op" id="2462076">*</span><span class="ident" id="2462077">fmt</span><span class="op" id="2462080">)</span>&nbsp;<span class="ident" id="2462082">fmt_E32</span><span class="op" id="2462089">(</span><span class="ident" id="2462090">v</span>&nbsp;<span class="builtintype" id="2462092">float32</span><span class="op" id="2462099">)</span>&nbsp;<span class="op" id="2462101">{</span>&nbsp;<span class="ident" id="2462103">f</span><span class="op" id="2462104">.</span><span class="ident" id="2462105">formatFloat</span><span class="op" id="2462116">(</span><span class="builtintype" id="2462117">float64</span><span class="op" id="2462124">(</span><span class="ident" id="2462125">v</span><span class="op" id="2462126">)</span><span class="op" id="2462127">,</span>&nbsp;<span class="string" id="2462129">&#39;E&#39;</span><span class="op" id="2462132">,</span>&nbsp;<span class="ident" id="2462134">doPrec</span><span class="op" id="2462140">(</span><span class="ident" id="2462141">f</span><span class="op" id="2462142">,</span>&nbsp;<span class="num" id="2462144">6</span><span class="op" id="2462145">)</span><span class="op" id="2462146">,</span>&nbsp;<span class="num" id="2462148">32</span><span class="op" id="2462150">)</span>&nbsp;<span class="op" id="2462152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2462155">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2462203">func</span>&nbsp;<span class="op" id="2462208">(</span><span class="ident" id="2462209">f</span>&nbsp;<span class="op" id="2462211">*</span><span class="ident" id="2462212">fmt</span><span class="op" id="2462215">)</span>&nbsp;<span class="ident" id="2462217">fmt_f32</span><span class="op" id="2462224">(</span><span class="ident" id="2462225">v</span>&nbsp;<span class="builtintype" id="2462227">float32</span><span class="op" id="2462234">)</span>&nbsp;<span class="op" id="2462236">{</span>&nbsp;<span class="ident" id="2462238">f</span><span class="op" id="2462239">.</span><span class="ident" id="2462240">formatFloat</span><span class="op" id="2462251">(</span><span class="builtintype" id="2462252">float64</span><span class="op" id="2462259">(</span><span class="ident" id="2462260">v</span><span class="op" id="2462261">)</span><span class="op" id="2462262">,</span>&nbsp;<span class="string" id="2462264">&#39;f&#39;</span><span class="op" id="2462267">,</span>&nbsp;<span class="ident" id="2462269">doPrec</span><span class="op" id="2462275">(</span><span class="ident" id="2462276">f</span><span class="op" id="2462277">,</span>&nbsp;<span class="num" id="2462279">6</span><span class="op" id="2462280">)</span><span class="op" id="2462281">,</span>&nbsp;<span class="num" id="2462283">32</span><span class="op" id="2462285">)</span>&nbsp;<span class="op" id="2462287">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="2462290">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2462361">func</span>&nbsp;<span class="op" id="2462366">(</span><span class="ident" id="2462367">f</span>&nbsp;<span class="op" id="2462369">*</span><span class="ident" id="2462370">fmt</span><span class="op" id="2462373">)</span>&nbsp;<span class="ident" id="2462375">fmt_g32</span><span class="op" id="2462382">(</span><span class="ident" id="2462383">v</span>&nbsp;<span class="builtintype" id="2462385">float32</span><span class="op" id="2462392">)</span>&nbsp;<span class="op" id="2462394">{</span>&nbsp;<span class="ident" id="2462396">f</span><span class="op" id="2462397">.</span><span class="ident" id="2462398">formatFloat</span><span class="op" id="2462409">(</span><span class="builtintype" id="2462410">float64</span><span class="op" id="2462417">(</span><span class="ident" id="2462418">v</span><span class="op" id="2462419">)</span><span class="op" id="2462420">,</span>&nbsp;<span class="string" id="2462422">&#39;g&#39;</span><span class="op" id="2462425">,</span>&nbsp;<span class="ident" id="2462427">doPrec</span><span class="op" id="2462433">(</span><span class="ident" id="2462434">f</span><span class="op" id="2462435">,</span>&nbsp;<span class="op" id="2462437">-</span><span class="num" id="2462438">1</span><span class="op" id="2462439">)</span><span class="op" id="2462440">,</span>&nbsp;<span class="num" id="2462442">32</span><span class="op" id="2462444">)</span>&nbsp;<span class="op" id="2462446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2462449">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="2462520">func</span>&nbsp;<span class="op" id="2462525">(</span><span class="ident" id="2462526">f</span>&nbsp;<span class="op" id="2462528">*</span><span class="ident" id="2462529">fmt</span><span class="op" id="2462532">)</span>&nbsp;<span class="ident" id="2462534">fmt_G32</span><span class="op" id="2462541">(</span><span class="ident" id="2462542">v</span>&nbsp;<span class="builtintype" id="2462544">float32</span><span class="op" id="2462551">)</span>&nbsp;<span class="op" id="2462553">{</span>&nbsp;<span class="ident" id="2462555">f</span><span class="op" id="2462556">.</span><span class="ident" id="2462557">formatFloat</span><span class="op" id="2462568">(</span><span class="builtintype" id="2462569">float64</span><span class="op" id="2462576">(</span><span class="ident" id="2462577">v</span><span class="op" id="2462578">)</span><span class="op" id="2462579">,</span>&nbsp;<span class="string" id="2462581">&#39;G&#39;</span><span class="op" id="2462584">,</span>&nbsp;<span class="ident" id="2462586">doPrec</span><span class="op" id="2462592">(</span><span class="ident" id="2462593">f</span><span class="op" id="2462594">,</span>&nbsp;<span class="op" id="2462596">-</span><span class="num" id="2462597">1</span><span class="op" id="2462598">)</span><span class="op" id="2462599">,</span>&nbsp;<span class="num" id="2462601">32</span><span class="op" id="2462603">)</span>&nbsp;<span class="op" id="2462605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2462608">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2462683">func</span>&nbsp;<span class="op" id="2462688">(</span><span class="ident" id="2462689">f</span>&nbsp;<span class="op" id="2462691">*</span><span class="ident" id="2462692">fmt</span><span class="op" id="2462695">)</span>&nbsp;<span class="ident" id="2462697">fmt_fb32</span><span class="op" id="2462705">(</span><span class="ident" id="2462706">v</span>&nbsp;<span class="builtintype" id="2462708">float32</span><span class="op" id="2462715">)</span>&nbsp;<span class="op" id="2462717">{</span>&nbsp;<span class="ident" id="2462719">f</span><span class="op" id="2462720">.</span><span class="ident" id="2462721">formatFloat</span><span class="op" id="2462732">(</span><span class="builtintype" id="2462733">float64</span><span class="op" id="2462740">(</span><span class="ident" id="2462741">v</span><span class="op" id="2462742">)</span><span class="op" id="2462743">,</span>&nbsp;<span class="string" id="2462745">&#39;b&#39;</span><span class="op" id="2462748">,</span>&nbsp;<span class="num" id="2462750">0</span><span class="op" id="2462751">,</span>&nbsp;<span class="num" id="2462753">32</span><span class="op" id="2462755">)</span>&nbsp;<span class="op" id="2462757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="2462760">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2462814">func</span>&nbsp;<span class="op" id="2462819">(</span><span class="ident" id="2462820">f</span>&nbsp;<span class="op" id="2462822">*</span><span class="ident" id="2462823">fmt</span><span class="op" id="2462826">)</span>&nbsp;<span class="ident" id="2462828">fmt_c64</span><span class="op" id="2462835">(</span><span class="ident" id="2462836">v</span>&nbsp;<span class="builtintype" id="2462838">complex64</span><span class="op" id="2462847">,</span>&nbsp;<span class="ident" id="2462849">verb</span>&nbsp;<span class="builtintype" id="2462854">rune</span><span class="op" id="2462858">)</span>&nbsp;<span class="op" id="2462860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462863">f</span><span class="op" id="2462864">.</span><span class="ident" id="2462865">fmt_complex</span><span class="op" id="2462876">(</span><span class="builtintype" id="2462877">float64</span><span class="op" id="2462884">(</span><span class="builtinfunc" id="2462885">real</span><span class="op" id="2462889">(</span><span class="ident" id="2462890">v</span><span class="op" id="2462891">)</span><span class="op" id="2462892">)</span><span class="op" id="2462893">,</span>&nbsp;<span class="builtintype" id="2462895">float64</span><span class="op" id="2462902">(</span><span class="builtinfunc" id="2462903">imag</span><span class="op" id="2462907">(</span><span class="ident" id="2462908">v</span><span class="op" id="2462909">)</span><span class="op" id="2462910">)</span><span class="op" id="2462911">,</span>&nbsp;<span class="num" id="2462913">32</span><span class="op" id="2462915">,</span>&nbsp;<span class="ident" id="2462917">verb</span><span class="op" id="2462921">)</span><br>
<span class="lineno"></span><span class="op" id="2462923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="2462926">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2462982">func</span>&nbsp;<span class="op" id="2462987">(</span><span class="ident" id="2462988">f</span>&nbsp;<span class="op" id="2462990">*</span><span class="ident" id="2462991">fmt</span><span class="op" id="2462994">)</span>&nbsp;<span class="ident" id="2462996">fmt_c128</span><span class="op" id="2463004">(</span><span class="ident" id="2463005">v</span>&nbsp;<span class="builtintype" id="2463007">complex128</span><span class="op" id="2463017">,</span>&nbsp;<span class="ident" id="2463019">verb</span>&nbsp;<span class="builtintype" id="2463024">rune</span><span class="op" id="2463028">)</span>&nbsp;<span class="op" id="2463030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463033">f</span><span class="op" id="2463034">.</span><span class="ident" id="2463035">fmt_complex</span><span class="op" id="2463046">(</span><span class="builtinfunc" id="2463047">real</span><span class="op" id="2463051">(</span><span class="ident" id="2463052">v</span><span class="op" id="2463053">)</span><span class="op" id="2463054">,</span>&nbsp;<span class="builtinfunc" id="2463056">imag</span><span class="op" id="2463060">(</span><span class="ident" id="2463061">v</span><span class="op" id="2463062">)</span><span class="op" id="2463063">,</span>&nbsp;<span class="num" id="2463065">64</span><span class="op" id="2463067">,</span>&nbsp;<span class="ident" id="2463069">verb</span><span class="op" id="2463073">)</span><br>
<span class="lineno"></span><span class="op" id="2463075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="2463078">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="2463129">func</span>&nbsp;<span class="op" id="2463134">(</span><span class="ident" id="2463135">f</span>&nbsp;<span class="op" id="2463137">*</span><span class="ident" id="2463138">fmt</span><span class="op" id="2463141">)</span>&nbsp;<span class="ident" id="2463143">fmt_complex</span><span class="op" id="2463154">(</span><span class="ident" id="2463155">r</span><span class="op" id="2463156">,</span>&nbsp;<span class="ident" id="2463158">j</span>&nbsp;<span class="builtintype" id="2463160">float64</span><span class="op" id="2463167">,</span>&nbsp;<span class="ident" id="2463169">size</span>&nbsp;<span class="builtintype" id="2463174">int</span><span class="op" id="2463177">,</span>&nbsp;<span class="ident" id="2463179">verb</span>&nbsp;<span class="builtintype" id="2463184">rune</span><span class="op" id="2463188">)</span>&nbsp;<span class="op" id="2463190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463193">f</span><span class="op" id="2463194">.</span><span class="ident" id="2463195">buf</span><span class="op" id="2463198">.</span><span class="ident" id="2463199">WriteByte</span><span class="op" id="2463208">(</span><span class="string" id="2463209">&#39;(&#39;</span><span class="op" id="2463212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463215">oldPlus</span>&nbsp;<span class="op" id="2463223">:=</span>&nbsp;<span class="ident" id="2463226">f</span><span class="op" id="2463227">.</span><span class="ident" id="2463228">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463234">oldSpace</span>&nbsp;<span class="op" id="2463243">:=</span>&nbsp;<span class="ident" id="2463246">f</span><span class="op" id="2463247">.</span><span class="ident" id="2463248">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463255">oldWid</span>&nbsp;<span class="op" id="2463262">:=</span>&nbsp;<span class="ident" id="2463265">f</span><span class="op" id="2463266">.</span><span class="ident" id="2463267">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463272">for</span>&nbsp;<span class="ident" id="2463276">i</span>&nbsp;<span class="op" id="2463278">:=</span>&nbsp;<span class="num" id="2463281">0</span><span class="op" id="2463282">;</span>&nbsp;<span class="op" id="2463284">;</span>&nbsp;<span class="ident" id="2463286">i</span><span class="op" id="2463287">++</span>&nbsp;<span class="op" id="2463290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463294">switch</span>&nbsp;<span class="ident" id="2463301">verb</span>&nbsp;<span class="op" id="2463306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463310">case</span>&nbsp;<span class="string" id="2463315">&#39;b&#39;</span><span class="op" id="2463318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463323">f</span><span class="op" id="2463324">.</span><span class="ident" id="2463325">formatFloat</span><span class="op" id="2463336">(</span><span class="ident" id="2463337">r</span><span class="op" id="2463338">,</span>&nbsp;<span class="string" id="2463340">&#39;b&#39;</span><span class="op" id="2463343">,</span>&nbsp;<span class="num" id="2463345">0</span><span class="op" id="2463346">,</span>&nbsp;<span class="ident" id="2463348">size</span><span class="op" id="2463352">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463356">case</span>&nbsp;<span class="string" id="2463361">&#39;e&#39;</span><span class="op" id="2463364">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463369">f</span><span class="op" id="2463370">.</span><span class="ident" id="2463371">formatFloat</span><span class="op" id="2463382">(</span><span class="ident" id="2463383">r</span><span class="op" id="2463384">,</span>&nbsp;<span class="string" id="2463386">&#39;e&#39;</span><span class="op" id="2463389">,</span>&nbsp;<span class="ident" id="2463391">doPrec</span><span class="op" id="2463397">(</span><span class="ident" id="2463398">f</span><span class="op" id="2463399">,</span>&nbsp;<span class="num" id="2463401">6</span><span class="op" id="2463402">)</span><span class="op" id="2463403">,</span>&nbsp;<span class="ident" id="2463405">size</span><span class="op" id="2463409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463413">case</span>&nbsp;<span class="string" id="2463418">&#39;E&#39;</span><span class="op" id="2463421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463426">f</span><span class="op" id="2463427">.</span><span class="ident" id="2463428">formatFloat</span><span class="op" id="2463439">(</span><span class="ident" id="2463440">r</span><span class="op" id="2463441">,</span>&nbsp;<span class="string" id="2463443">&#39;E&#39;</span><span class="op" id="2463446">,</span>&nbsp;<span class="ident" id="2463448">doPrec</span><span class="op" id="2463454">(</span><span class="ident" id="2463455">f</span><span class="op" id="2463456">,</span>&nbsp;<span class="num" id="2463458">6</span><span class="op" id="2463459">)</span><span class="op" id="2463460">,</span>&nbsp;<span class="ident" id="2463462">size</span><span class="op" id="2463466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463470">case</span>&nbsp;<span class="string" id="2463475">&#39;f&#39;</span><span class="op" id="2463478">,</span>&nbsp;<span class="string" id="2463480">&#39;F&#39;</span><span class="op" id="2463483">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463488">f</span><span class="op" id="2463489">.</span><span class="ident" id="2463490">formatFloat</span><span class="op" id="2463501">(</span><span class="ident" id="2463502">r</span><span class="op" id="2463503">,</span>&nbsp;<span class="string" id="2463505">&#39;f&#39;</span><span class="op" id="2463508">,</span>&nbsp;<span class="ident" id="2463510">doPrec</span><span class="op" id="2463516">(</span><span class="ident" id="2463517">f</span><span class="op" id="2463518">,</span>&nbsp;<span class="num" id="2463520">6</span><span class="op" id="2463521">)</span><span class="op" id="2463522">,</span>&nbsp;<span class="ident" id="2463524">size</span><span class="op" id="2463528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463532">case</span>&nbsp;<span class="string" id="2463537">&#39;g&#39;</span><span class="op" id="2463540">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463545">f</span><span class="op" id="2463546">.</span><span class="ident" id="2463547">formatFloat</span><span class="op" id="2463558">(</span><span class="ident" id="2463559">r</span><span class="op" id="2463560">,</span>&nbsp;<span class="string" id="2463562">&#39;g&#39;</span><span class="op" id="2463565">,</span>&nbsp;<span class="ident" id="2463567">doPrec</span><span class="op" id="2463573">(</span><span class="ident" id="2463574">f</span><span class="op" id="2463575">,</span>&nbsp;<span class="op" id="2463577">-</span><span class="num" id="2463578">1</span><span class="op" id="2463579">)</span><span class="op" id="2463580">,</span>&nbsp;<span class="ident" id="2463582">size</span><span class="op" id="2463586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463590">case</span>&nbsp;<span class="string" id="2463595">&#39;G&#39;</span><span class="op" id="2463598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463603">f</span><span class="op" id="2463604">.</span><span class="ident" id="2463605">formatFloat</span><span class="op" id="2463616">(</span><span class="ident" id="2463617">r</span><span class="op" id="2463618">,</span>&nbsp;<span class="string" id="2463620">&#39;G&#39;</span><span class="op" id="2463623">,</span>&nbsp;<span class="ident" id="2463625">doPrec</span><span class="op" id="2463631">(</span><span class="ident" id="2463632">f</span><span class="op" id="2463633">,</span>&nbsp;<span class="op" id="2463635">-</span><span class="num" id="2463636">1</span><span class="op" id="2463637">)</span><span class="op" id="2463638">,</span>&nbsp;<span class="ident" id="2463640">size</span><span class="op" id="2463644">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2463648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463652">if</span>&nbsp;<span class="ident" id="2463655">i</span>&nbsp;<span class="op" id="2463657">!=</span>&nbsp;<span class="num" id="2463660">0</span>&nbsp;<span class="op" id="2463662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463667">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2463675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2463679">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463718">f</span><span class="op" id="2463719">.</span><span class="ident" id="2463720">plus</span>&nbsp;<span class="op" id="2463725">=</span>&nbsp;<span class="builtintype" id="2463727">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463734">f</span><span class="op" id="2463735">.</span><span class="ident" id="2463736">space</span>&nbsp;<span class="op" id="2463742">=</span>&nbsp;<span class="builtintype" id="2463744">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463752">f</span><span class="op" id="2463753">.</span><span class="ident" id="2463754">wid</span>&nbsp;<span class="op" id="2463758">=</span>&nbsp;<span class="ident" id="2463760">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463769">r</span>&nbsp;<span class="op" id="2463771">=</span>&nbsp;<span class="ident" id="2463773">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2463776">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463779">f</span><span class="op" id="2463780">.</span><span class="ident" id="2463781">space</span>&nbsp;<span class="op" id="2463787">=</span>&nbsp;<span class="ident" id="2463789">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463799">f</span><span class="op" id="2463800">.</span><span class="ident" id="2463801">plus</span>&nbsp;<span class="op" id="2463806">=</span>&nbsp;<span class="ident" id="2463808">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463817">f</span><span class="op" id="2463818">.</span><span class="ident" id="2463819">wid</span>&nbsp;<span class="op" id="2463823">=</span>&nbsp;<span class="ident" id="2463825">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2463833">f</span><span class="op" id="2463834">.</span><span class="ident" id="2463835">buf</span><span class="op" id="2463838">.</span><span class="ident" id="2463839">Write</span><span class="op" id="2463844">(</span><span class="ident" id="2463845">irparenBytes</span><span class="op" id="2463857">)</span><br>
<span class="lineno"></span><span class="op" id="2463859">}</span>
</div>
</body>
</html>
