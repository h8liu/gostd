<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2787951">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2788006">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2788060">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2788111">package</span>&nbsp;<span class="ident" id="2788119">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2788127">import</span>&nbsp;<span class="string" id="2788134">&#34;io&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2788140">//&nbsp;TruncateWriter&nbsp;returns&nbsp;a&nbsp;Writer&nbsp;that&nbsp;writes&nbsp;to&nbsp;w</span><br>
<span class="lineno">10</span><span class="comment" id="2788192">//&nbsp;but&nbsp;stops&nbsp;silently&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2788229">func</span>&nbsp;<span class="ident" id="2788234">TruncateWriter</span><span class="op" id="2788248">(</span><span class="ident" id="2788249">w</span>&nbsp;<span class="ident" id="2788251"><a href="/testing/iotest/writer.go.html#2788134">io</a></span><span class="op" id="2788253">.</span><span class="ident" id="2788254">Writer</span><span class="op" id="2788260">,</span>&nbsp;<span class="ident" id="2788262">n</span>&nbsp;<span class="ident" id="2788264">int64</span><span class="op" id="2788269">)</span>&nbsp;<span class="ident" id="2788271"><a href="/testing/iotest/writer.go.html#2788134">io</a></span><span class="op" id="2788273">.</span><span class="ident" id="2788274">Writer</span>&nbsp;<span class="op" id="2788281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788284">return</span>&nbsp;<span class="op" id="2788291">&amp;</span><span class="ident" id="2788292"><a href="/testing/iotest/writer.go.html#2788321">truncateWriter</a></span><span class="op" id="2788306">{</span><span class="ident" id="2788307"><a href="/testing/iotest/writer.go.html#2788249">w</a></span><span class="op" id="2788308">,</span>&nbsp;<span class="ident" id="2788310"><a href="/testing/iotest/writer.go.html#2788262">n</a></span><span class="op" id="2788311">}</span><br>
<span class="lineno"></span><span class="op" id="2788313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2788316">type</span>&nbsp;<span class="ident" id="2788321">truncateWriter</span>&nbsp;<span class="keyword" id="2788336">struct</span>&nbsp;<span class="op" id="2788343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788346">w</span>&nbsp;<span class="ident" id="2788348"><a href="/testing/iotest/writer.go.html#2788134">io</a></span><span class="op" id="2788350">.</span><span class="ident" id="2788351">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788359">n</span>&nbsp;<span class="ident" id="2788361">int64</span><br>
<span class="lineno"></span><span class="op" id="2788367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2788370">func</span>&nbsp;<span class="op" id="2788375">(</span><span class="ident" id="2788376">t</span>&nbsp;<span class="op" id="2788378">*</span><span class="ident" id="2788379"><a href="/testing/iotest/writer.go.html#2788321">truncateWriter</a></span><span class="op" id="2788393">)</span>&nbsp;<span class="ident" id="2788395">Write</span><span class="op" id="2788400">(</span><span class="ident" id="2788401">p</span>&nbsp;<span class="op" id="2788403">[</span><span class="op" id="2788404">]</span><span class="builtintype" id="2788405">byte</span><span class="op" id="2788409">)</span>&nbsp;<span class="op" id="2788411">(</span><span class="ident" id="2788412">n</span>&nbsp;<span class="builtintype" id="2788414">int</span><span class="op" id="2788417">,</span>&nbsp;<span class="ident" id="2788419">err</span>&nbsp;<span class="builtintype" id="2788423">error</span><span class="op" id="2788428">)</span>&nbsp;<span class="op" id="2788430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788433">if</span>&nbsp;<span class="ident" id="2788436"><a href="/testing/iotest/writer.go.html#2788376">t</a></span><span class="op" id="2788437">.</span><span class="ident" id="2788438">n</span>&nbsp;<span class="op" id="2788440">&lt;=</span>&nbsp;<span class="num" id="2788443">0</span>&nbsp;<span class="op" id="2788445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788449">return</span>&nbsp;<span class="builtinfunc" id="2788456">len</span><span class="op" id="2788459">(</span><span class="ident" id="2788460"><a href="/testing/iotest/writer.go.html#2788401">p</a></span><span class="op" id="2788461">)</span><span class="op" id="2788462">,</span>&nbsp;<span class="ident" id="2788464">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2788469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2788472">//&nbsp;real&nbsp;write</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788487"><a href="/testing/iotest/writer.go.html#2788412">n</a></span>&nbsp;<span class="op" id="2788489">=</span>&nbsp;<span class="builtinfunc" id="2788491">len</span><span class="op" id="2788494">(</span><span class="ident" id="2788495"><a href="/testing/iotest/writer.go.html#2788401">p</a></span><span class="op" id="2788496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788499">if</span>&nbsp;<span class="ident" id="2788502">int64</span><span class="op" id="2788507">(</span><span class="ident" id="2788508"><a href="/testing/iotest/writer.go.html#2788412">n</a></span><span class="op" id="2788509">)</span>&nbsp;<span class="op" id="2788511">&gt;</span>&nbsp;<span class="ident" id="2788513"><a href="/testing/iotest/writer.go.html#2788376">t</a></span><span class="op" id="2788514">.</span><span class="ident" id="2788515">n</span>&nbsp;<span class="op" id="2788517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788521"><a href="/testing/iotest/writer.go.html#2788412">n</a></span>&nbsp;<span class="op" id="2788523">=</span>&nbsp;<span class="builtintype" id="2788525">int</span><span class="op" id="2788528">(</span><span class="ident" id="2788529"><a href="/testing/iotest/writer.go.html#2788376">t</a></span><span class="op" id="2788530">.</span><span class="ident" id="2788531">n</span><span class="op" id="2788532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2788535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788538"><a href="/testing/iotest/writer.go.html#2788412">n</a></span><span class="op" id="2788539">,</span>&nbsp;<span class="ident" id="2788541"><a href="/testing/iotest/writer.go.html#2788419">err</a></span>&nbsp;<span class="op" id="2788545">=</span>&nbsp;<span class="ident" id="2788547"><a href="/testing/iotest/writer.go.html#2788376">t</a></span><span class="op" id="2788548">.</span><span class="ident" id="2788549">w</span><span class="op" id="2788550">.</span><span class="ident" id="2788551">Write</span><span class="op" id="2788556">(</span><span class="ident" id="2788557"><a href="/testing/iotest/writer.go.html#2788401">p</a></span><span class="op" id="2788558">[</span><span class="num" id="2788559">0</span><span class="op" id="2788560">:</span><span class="ident" id="2788561"><a href="/testing/iotest/writer.go.html#2788412">n</a></span><span class="op" id="2788562">]</span><span class="op" id="2788563">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788566"><a href="/testing/iotest/writer.go.html#2788376">t</a></span><span class="op" id="2788567">.</span><span class="ident" id="2788568">n</span>&nbsp;<span class="op" id="2788570">-=</span>&nbsp;<span class="ident" id="2788573">int64</span><span class="op" id="2788578">(</span><span class="ident" id="2788579"><a href="/testing/iotest/writer.go.html#2788412">n</a></span><span class="op" id="2788580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788583">if</span>&nbsp;<span class="ident" id="2788586"><a href="/testing/iotest/writer.go.html#2788419">err</a></span>&nbsp;<span class="op" id="2788590">==</span>&nbsp;<span class="ident" id="2788593">nil</span>&nbsp;<span class="op" id="2788597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788601"><a href="/testing/iotest/writer.go.html#2788412">n</a></span>&nbsp;<span class="op" id="2788603">=</span>&nbsp;<span class="builtinfunc" id="2788605">len</span><span class="op" id="2788608">(</span><span class="ident" id="2788609"><a href="/testing/iotest/writer.go.html#2788401">p</a></span><span class="op" id="2788610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2788613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788616">return</span><br>
<span class="lineno">35</span><span class="op" id="2788623">}</span>
</div>
</body>
</html>
