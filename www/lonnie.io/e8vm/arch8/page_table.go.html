<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5981187">package</span>&nbsp;<span class="ident" id="5981195">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5981202">//&nbsp;PageTable&nbsp;describes&nbsp;a&nbsp;page&nbsp;table&nbsp;in&nbsp;a&nbsp;physical&nbsp;memory.</span><br>
<span class="lineno"></span><span class="comment" id="5981260">//&nbsp;It&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;translate&nbsp;a&nbsp;virtual&nbsp;memory&nbsp;address&nbsp;into&nbsp;a&nbsp;physical</span><br>
<span class="lineno">5</span><span class="comment" id="5981332">//&nbsp;memory&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="5981351">type</span>&nbsp;<span class="ident" id="5981356">pageTable</span>&nbsp;<span class="keyword" id="5981366">struct</span>&nbsp;<span class="op" id="5981373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981376">mem</span>&nbsp;&nbsp;<span class="op" id="5981381">*</span><span class="ident" id="5981382"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span>&nbsp;<span class="comment" id="5981392">//&nbsp;the&nbsp;physical&nbsp;memory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981416">root</span>&nbsp;<span class="builtintype" id="5981421">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5981432">//&nbsp;root&nbsp;address</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5981450">//&nbsp;last&nbsp;translation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981471">pte1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5981480"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981960">ptEntry</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981489">pte2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5981498"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981960">ptEntry</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981507">pte1Addr</span>&nbsp;<span class="builtintype" id="5981516">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981524">pte2Addr</span>&nbsp;<span class="builtintype" id="5981533">uint32</span><br>
<span class="lineno">15</span><span class="op" id="5981540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5981543">//&nbsp;NewPageTable&nbsp;creates&nbsp;a&nbsp;new&nbsp;page&nbsp;table&nbsp;pointer.</span><br>
<span class="lineno"></span><span class="comment" id="5981593">//&nbsp;The&nbsp;page&nbsp;table&nbsp;is&nbsp;saved&nbsp;at&nbsp;addr.</span><br>
<span class="lineno"></span><span class="comment" id="5981629">//&nbsp;If&nbsp;addr&nbsp;is&nbsp;not&nbsp;page&nbsp;size&nbsp;aligned,&nbsp;it&nbsp;is&nbsp;aligned&nbsp;down.</span><br>
<span class="lineno">20</span><span class="keyword" id="5981686">func</span>&nbsp;<span class="ident" id="5981691">newPageTable</span><span class="op" id="5981703">(</span><span class="ident" id="5981704">m</span>&nbsp;<span class="op" id="5981706">*</span><span class="ident" id="5981707"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><span class="op" id="5981716">,</span>&nbsp;<span class="ident" id="5981718">addr</span>&nbsp;<span class="builtintype" id="5981723">uint32</span><span class="op" id="5981729">)</span>&nbsp;<span class="op" id="5981731">*</span><span class="ident" id="5981732"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981356">pageTable</a></span>&nbsp;<span class="op" id="5981742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981745"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981718">addr</a></span>&nbsp;<span class="op" id="5981750">-=</span>&nbsp;<span class="ident" id="5981753"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981718">addr</a></span>&nbsp;<span class="op" id="5981758">%</span>&nbsp;<span class="ident" id="5981760"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981770">ret</span>&nbsp;<span class="op" id="5981774">:=</span>&nbsp;<span class="builtinfunc" id="5981777">new</span><span class="op" id="5981780">(</span><span class="ident" id="5981781"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981356">pageTable</a></span><span class="op" id="5981790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981793"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981770">ret</a></span><span class="op" id="5981796">.</span><span class="ident" id="5981797">mem</span>&nbsp;<span class="op" id="5981801">=</span>&nbsp;<span class="ident" id="5981803"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981704">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981806"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981770">ret</a></span><span class="op" id="5981809">.</span><span class="ident" id="5981810">root</span>&nbsp;<span class="op" id="5981815">=</span>&nbsp;<span class="ident" id="5981817"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981718">addr</a></span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981824">return</span>&nbsp;<span class="ident" id="5981831"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981770">ret</a></span><br>
<span class="lineno"></span><span class="op" id="5981835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5981838">//&nbsp;bit&nbsp;[31:12]&nbsp;-&gt;&nbsp;a&nbsp;page&nbsp;pointer</span><br>
<span class="lineno">30</span><span class="comment" id="5981871">//</span><br>
<span class="lineno"></span><span class="comment" id="5981874">//&nbsp;bit&nbsp;3:&nbsp;dirty&nbsp;bit</span><br>
<span class="lineno"></span><span class="comment" id="5981894">//&nbsp;bit&nbsp;2:&nbsp;use&nbsp;bit</span><br>
<span class="lineno"></span><span class="comment" id="5981912">//&nbsp;bit&nbsp;1:&nbsp;readonly&nbsp;bit</span><br>
<span class="lineno"></span><span class="comment" id="5981935">//&nbsp;bit&nbsp;0:&nbsp;valid&nbsp;bit</span><br>
<span class="lineno">35</span><span class="keyword" id="5981955">type</span>&nbsp;<span class="ident" id="5981960">ptEntry</span>&nbsp;<span class="builtintype" id="5981968">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5981976">const</span>&nbsp;<span class="op" id="5981982">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981985">pteValid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5981997">=</span>&nbsp;<span class="num" id="5981999">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982002">pteReadonly</span>&nbsp;<span class="op" id="5982014">=</span>&nbsp;<span class="num" id="5982016">1</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982019">pteUse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5982031">=</span>&nbsp;<span class="num" id="5982033">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982036">pteDirty</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5982048">=</span>&nbsp;<span class="num" id="5982050">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982053">pteUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5982065">=</span>&nbsp;<span class="num" id="5982067">4</span><br>
<span class="lineno"></span><span class="op" id="5982069">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="5982072">const</span>&nbsp;<span class="ident" id="5982078">u32one</span>&nbsp;<span class="builtintype" id="5982085">uint32</span>&nbsp;<span class="op" id="5982092">=</span>&nbsp;<span class="num" id="5982094">0x1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5982099">func</span>&nbsp;<span class="op" id="5982104">(</span><span class="ident" id="5982105">pte</span>&nbsp;<span class="ident" id="5982109"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981960">ptEntry</a></span><span class="op" id="5982116">)</span>&nbsp;<span class="ident" id="5982118">testBit</span><span class="op" id="5982125">(</span><span class="ident" id="5982126">n</span>&nbsp;<span class="builtintype" id="5982128">uint</span><span class="op" id="5982132">)</span>&nbsp;<span class="builtintype" id="5982134">bool</span>&nbsp;<span class="op" id="5982139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982142">return</span>&nbsp;<span class="op" id="5982149">(</span><span class="builtintype" id="5982150">uint32</span><span class="op" id="5982156">(</span><span class="ident" id="5982157"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982105">pte</a></span><span class="op" id="5982160">)</span>&nbsp;<span class="op" id="5982162">&amp;</span>&nbsp;<span class="op" id="5982164">(</span><span class="ident" id="5982165"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982078">u32one</a></span>&nbsp;<span class="op" id="5982172">&lt;&lt;</span>&nbsp;<span class="ident" id="5982175"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982126">n</a></span><span class="op" id="5982176">)</span><span class="op" id="5982177">)</span>&nbsp;<span class="op" id="5982179">!=</span>&nbsp;<span class="num" id="5982182">0</span><br>
<span class="lineno"></span><span class="op" id="5982184">}</span><br>
<span class="lineno">50</span><span class="keyword" id="5982186">func</span>&nbsp;<span class="op" id="5982191">(</span><span class="ident" id="5982192">pte</span>&nbsp;<span class="op" id="5982196">*</span><span class="ident" id="5982197"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981960">ptEntry</a></span><span class="op" id="5982204">)</span>&nbsp;<span class="ident" id="5982206">setBit</span><span class="op" id="5982212">(</span><span class="ident" id="5982213">n</span>&nbsp;<span class="builtintype" id="5982215">uint</span><span class="op" id="5982219">)</span>&nbsp;<span class="op" id="5982221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982224">*</span><span class="ident" id="5982225"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982192">pte</a></span>&nbsp;<span class="op" id="5982229">=</span>&nbsp;<span class="ident" id="5982231"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981960">ptEntry</a></span><span class="op" id="5982238">(</span><span class="builtintype" id="5982239">uint32</span><span class="op" id="5982245">(</span><span class="op" id="5982246">*</span><span class="ident" id="5982247"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982192">pte</a></span><span class="op" id="5982250">)</span>&nbsp;<span class="op" id="5982252">|</span>&nbsp;<span class="op" id="5982254">(</span><span class="ident" id="5982255"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982078">u32one</a></span>&nbsp;<span class="op" id="5982262">&lt;&lt;</span>&nbsp;<span class="ident" id="5982265"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982213">n</a></span><span class="op" id="5982266">)</span><span class="op" id="5982267">)</span><br>
<span class="lineno"></span><span class="op" id="5982269">}</span><br>
<span class="lineno"></span><span class="keyword" id="5982271">func</span>&nbsp;<span class="op" id="5982276">(</span><span class="ident" id="5982277">pte</span>&nbsp;<span class="ident" id="5982281"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981960">ptEntry</a></span><span class="op" id="5982288">)</span>&nbsp;<span class="ident" id="5982290">pn</span><span class="op" id="5982292">(</span><span class="op" id="5982293">)</span>&nbsp;<span class="builtintype" id="5982295">uint32</span>&nbsp;<span class="op" id="5982302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982305">return</span>&nbsp;<span class="builtintype" id="5982312">uint32</span><span class="op" id="5982318">(</span><span class="ident" id="5982319"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982277">pte</a></span>&nbsp;<span class="op" id="5982323">/</span>&nbsp;<span class="ident" id="5982325"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span><span class="op" id="5982333">)</span><br>
<span class="lineno">55</span><span class="op" id="5982335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5982338">func</span>&nbsp;<span class="op" id="5982343">(</span><span class="ident" id="5982344">pte</span>&nbsp;<span class="ident" id="5982348"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981960">ptEntry</a></span><span class="op" id="5982355">)</span>&nbsp;<span class="ident" id="5982357">test</span><span class="op" id="5982361">(</span><span class="ident" id="5982362">addr</span>&nbsp;<span class="builtintype" id="5982367">uint32</span><span class="op" id="5982373">,</span>&nbsp;<span class="ident" id="5982375">ring</span>&nbsp;<span class="builtintype" id="5982380">byte</span><span class="op" id="5982384">)</span>&nbsp;<span class="op" id="5982386">*</span><span class="ident" id="5982387"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span>&nbsp;<span class="op" id="5982393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982396">if</span>&nbsp;<span class="op" id="5982399">!</span><span class="ident" id="5982400"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982344">pte</a></span><span class="op" id="5982403">.</span><span class="ident" id="5982404">testBit</span><span class="op" id="5982411">(</span><span class="ident" id="5982412"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981985">pteValid</a></span><span class="op" id="5982420">)</span>&nbsp;<span class="op" id="5982422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982426">return</span>&nbsp;<span class="ident" id="5982433"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5966312">newPageFault</a></span><span class="op" id="5982445">(</span><span class="ident" id="5982446"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982362">addr</a></span><span class="op" id="5982450">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982456">if</span>&nbsp;<span class="ident" id="5982459"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982375">ring</a></span>&nbsp;<span class="op" id="5982464">&gt;</span>&nbsp;<span class="num" id="5982466">0</span>&nbsp;<span class="op" id="5982468">&amp;&amp;</span>&nbsp;<span class="op" id="5982471">!</span><span class="ident" id="5982472"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982344">pte</a></span><span class="op" id="5982475">.</span><span class="ident" id="5982476">testBit</span><span class="op" id="5982483">(</span><span class="ident" id="5982484"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982053">pteUser</a></span><span class="op" id="5982491">)</span>&nbsp;<span class="op" id="5982493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982497">return</span>&nbsp;<span class="ident" id="5982504"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5966312">newPageFault</a></span><span class="op" id="5982516">(</span><span class="ident" id="5982517"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982362">addr</a></span><span class="op" id="5982521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982527">return</span>&nbsp;<span class="ident" id="5982534">nil</span><br>
<span class="lineno">65</span><span class="op" id="5982538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5982541">//&nbsp;Translate&nbsp;transalate&nbsp;a&nbsp;virutal&nbsp;address&nbsp;into&nbsp;physical&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5982606">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;the&nbsp;translation&nbsp;fails</span><br>
<span class="lineno"></span><span class="keyword" id="5982654">func</span>&nbsp;<span class="op" id="5982659">(</span><span class="ident" id="5982660">pt</span>&nbsp;<span class="op" id="5982663">*</span><span class="ident" id="5982664"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981356">pageTable</a></span><span class="op" id="5982673">)</span>&nbsp;<span class="ident" id="5982675">Translate</span><span class="op" id="5982684">(</span><span class="ident" id="5982685">addr</span>&nbsp;<span class="builtintype" id="5982690">uint32</span><span class="op" id="5982696">,</span>&nbsp;<span class="ident" id="5982698">ring</span>&nbsp;<span class="builtintype" id="5982703">byte</span><span class="op" id="5982707">)</span>&nbsp;<span class="op" id="5982709">(</span><span class="builtintype" id="5982710">uint32</span><span class="op" id="5982716">,</span>&nbsp;<span class="op" id="5982718">*</span><span class="ident" id="5982719"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span><span class="op" id="5982724">)</span>&nbsp;<span class="op" id="5982726">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982729">vpn</span>&nbsp;<span class="op" id="5982733">:=</span>&nbsp;<span class="ident" id="5982736"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982685">addr</a></span>&nbsp;<span class="op" id="5982741">/</span>&nbsp;<span class="ident" id="5982743"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982753">off</span>&nbsp;<span class="op" id="5982757">:=</span>&nbsp;<span class="ident" id="5982760"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982685">addr</a></span>&nbsp;<span class="op" id="5982765">%</span>&nbsp;<span class="ident" id="5982767"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982778">index1</span>&nbsp;<span class="op" id="5982785">:=</span>&nbsp;<span class="ident" id="5982788"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982729">vpn</a></span>&nbsp;<span class="op" id="5982792">/</span>&nbsp;<span class="num" id="5982794">1024</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982800">index2</span>&nbsp;<span class="op" id="5982807">:=</span>&nbsp;<span class="ident" id="5982810"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982729">vpn</a></span>&nbsp;<span class="op" id="5982814">%</span>&nbsp;<span class="num" id="5982816">1024</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982823">//&nbsp;first&nbsp;level&nbsp;page&nbsp;table&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982856"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5982858">.</span><span class="ident" id="5982859">pte1Addr</span>&nbsp;<span class="op" id="5982868">=</span>&nbsp;<span class="ident" id="5982870"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5982872">.</span><span class="ident" id="5982873">root</span>&nbsp;<span class="op" id="5982878">+</span>&nbsp;<span class="ident" id="5982880"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982778">index1</a></span><span class="op" id="5982886">*</span><span class="num" id="5982887">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982890">w</span><span class="op" id="5982891">,</span>&nbsp;<span class="ident" id="5982893">e</span>&nbsp;<span class="op" id="5982895">:=</span>&nbsp;<span class="ident" id="5982898"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5982900">.</span><span class="ident" id="5982901">mem</span><span class="op" id="5982904">.</span><span class="ident" id="5982905">ReadWord</span><span class="op" id="5982913">(</span><span class="ident" id="5982914"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5982916">.</span><span class="ident" id="5982917">pte1Addr</span><span class="op" id="5982925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982928">if</span>&nbsp;<span class="ident" id="5982931"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span>&nbsp;<span class="op" id="5982933">!=</span>&nbsp;<span class="ident" id="5982936">nil</span>&nbsp;<span class="op" id="5982940">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982944">return</span>&nbsp;<span class="num" id="5982951">0</span><span class="op" id="5982952">,</span>&nbsp;<span class="ident" id="5982954"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982960"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5982962">.</span><span class="ident" id="5982963">pte1</span>&nbsp;<span class="op" id="5982968">=</span>&nbsp;<span class="ident" id="5982970"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981960">ptEntry</a></span><span class="op" id="5982977">(</span><span class="ident" id="5982978"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982890">w</a></span><span class="op" id="5982979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982982"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span>&nbsp;<span class="op" id="5982984">=</span>&nbsp;<span class="ident" id="5982986"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5982988">.</span><span class="ident" id="5982989">pte1</span><span class="op" id="5982993">.</span><span class="ident" id="5982994">test</span><span class="op" id="5982998">(</span><span class="ident" id="5982999"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982685">addr</a></span><span class="op" id="5983003">,</span>&nbsp;<span class="ident" id="5983005"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982698">ring</a></span><span class="op" id="5983009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983012">if</span>&nbsp;<span class="ident" id="5983015"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span>&nbsp;<span class="op" id="5983017">!=</span>&nbsp;<span class="ident" id="5983020">nil</span>&nbsp;<span class="op" id="5983024">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983028">return</span>&nbsp;<span class="num" id="5983035">0</span><span class="op" id="5983036">,</span>&nbsp;<span class="ident" id="5983038"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983045">pn1</span>&nbsp;<span class="op" id="5983049">:=</span>&nbsp;<span class="ident" id="5983052"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5983054">.</span><span class="ident" id="5983055">pte1</span><span class="op" id="5983059">.</span><span class="ident" id="5983060">pn</span><span class="op" id="5983062">(</span><span class="op" id="5983063">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983067"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5983069">.</span><span class="ident" id="5983070">pte2Addr</span>&nbsp;<span class="op" id="5983079">=</span>&nbsp;<span class="ident" id="5983081"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983045">pn1</a></span><span class="op" id="5983084">*</span><span class="ident" id="5983085"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span>&nbsp;<span class="op" id="5983094">+</span>&nbsp;<span class="ident" id="5983096"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982800">index2</a></span><span class="op" id="5983102">*</span><span class="num" id="5983103">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983106"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982890">w</a></span><span class="op" id="5983107">,</span>&nbsp;<span class="ident" id="5983109"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span>&nbsp;<span class="op" id="5983111">=</span>&nbsp;<span class="ident" id="5983113"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5983115">.</span><span class="ident" id="5983116">mem</span><span class="op" id="5983119">.</span><span class="ident" id="5983120">ReadWord</span><span class="op" id="5983128">(</span><span class="ident" id="5983129"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5983131">.</span><span class="ident" id="5983132">pte2Addr</span><span class="op" id="5983140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983143">if</span>&nbsp;<span class="ident" id="5983146"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span>&nbsp;<span class="op" id="5983148">!=</span>&nbsp;<span class="ident" id="5983151">nil</span>&nbsp;<span class="op" id="5983155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983159">return</span>&nbsp;<span class="num" id="5983166">0</span><span class="op" id="5983167">,</span>&nbsp;<span class="ident" id="5983169"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983172">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983175"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5983177">.</span><span class="ident" id="5983178">pte2</span>&nbsp;<span class="op" id="5983183">=</span>&nbsp;<span class="ident" id="5983185"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981960">ptEntry</a></span><span class="op" id="5983192">(</span><span class="ident" id="5983193"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982890">w</a></span><span class="op" id="5983194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983197"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span>&nbsp;<span class="op" id="5983199">=</span>&nbsp;<span class="ident" id="5983201"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5983203">.</span><span class="ident" id="5983204">pte2</span><span class="op" id="5983208">.</span><span class="ident" id="5983209">test</span><span class="op" id="5983213">(</span><span class="ident" id="5983214"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982685">addr</a></span><span class="op" id="5983218">,</span>&nbsp;<span class="ident" id="5983220"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982698">ring</a></span><span class="op" id="5983224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983227">if</span>&nbsp;<span class="ident" id="5983230"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span>&nbsp;<span class="op" id="5983232">!=</span>&nbsp;<span class="ident" id="5983235">nil</span>&nbsp;<span class="op" id="5983239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983243">return</span>&nbsp;<span class="num" id="5983250">0</span><span class="op" id="5983251">,</span>&nbsp;<span class="ident" id="5983253"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982893">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983256">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983260">ppn</span>&nbsp;<span class="op" id="5983264">:=</span>&nbsp;<span class="ident" id="5983267"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982660">pt</a></span><span class="op" id="5983269">.</span><span class="ident" id="5983270">pte2</span><span class="op" id="5983274">.</span><span class="ident" id="5983275">pn</span><span class="op" id="5983277">(</span><span class="op" id="5983278">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983282">return</span>&nbsp;<span class="ident" id="5983289"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983260">ppn</a></span><span class="op" id="5983292">*</span><span class="ident" id="5983293"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span>&nbsp;<span class="op" id="5983302">+</span>&nbsp;<span class="ident" id="5983304"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982753">off</a></span><span class="op" id="5983307">,</span>&nbsp;<span class="ident" id="5983309">nil</span><br>
<span class="lineno"></span><span class="op" id="5983313">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="5983316">func</span>&nbsp;<span class="op" id="5983321">(</span><span class="ident" id="5983322">pt</span>&nbsp;<span class="op" id="5983325">*</span><span class="ident" id="5983326"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981356">pageTable</a></span><span class="op" id="5983335">)</span>&nbsp;<span class="ident" id="5983337">updatePte</span><span class="op" id="5983346">(</span><span class="op" id="5983347">)</span>&nbsp;<span class="op" id="5983349">*</span><span class="ident" id="5983350"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span>&nbsp;<span class="op" id="5983356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983359">e</span>&nbsp;<span class="op" id="5983361">:=</span>&nbsp;<span class="ident" id="5983364"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983322">pt</a></span><span class="op" id="5983366">.</span><span class="ident" id="5983367">mem</span><span class="op" id="5983370">.</span><span class="ident" id="5983371">WriteWord</span><span class="op" id="5983380">(</span><span class="ident" id="5983381"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983322">pt</a></span><span class="op" id="5983383">.</span><span class="ident" id="5983384">pte1Addr</span><span class="op" id="5983392">,</span>&nbsp;<span class="builtintype" id="5983394">uint32</span><span class="op" id="5983400">(</span><span class="ident" id="5983401"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983322">pt</a></span><span class="op" id="5983403">.</span><span class="ident" id="5983404">pte1</span><span class="op" id="5983408">)</span><span class="op" id="5983409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983412">if</span>&nbsp;<span class="ident" id="5983415"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983359">e</a></span>&nbsp;<span class="op" id="5983417">!=</span>&nbsp;<span class="ident" id="5983420">nil</span>&nbsp;<span class="op" id="5983424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983428">return</span>&nbsp;<span class="ident" id="5983435"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983359">e</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983442"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983359">e</a></span>&nbsp;<span class="op" id="5983444">=</span>&nbsp;<span class="ident" id="5983446"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983322">pt</a></span><span class="op" id="5983448">.</span><span class="ident" id="5983449">mem</span><span class="op" id="5983452">.</span><span class="ident" id="5983453">WriteWord</span><span class="op" id="5983462">(</span><span class="ident" id="5983463"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983322">pt</a></span><span class="op" id="5983465">.</span><span class="ident" id="5983466">pte2Addr</span><span class="op" id="5983474">,</span>&nbsp;<span class="builtintype" id="5983476">uint32</span><span class="op" id="5983482">(</span><span class="ident" id="5983483"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983322">pt</a></span><span class="op" id="5983485">.</span><span class="ident" id="5983486">pte2</span><span class="op" id="5983490">)</span><span class="op" id="5983491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983494">if</span>&nbsp;<span class="ident" id="5983497"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983359">e</a></span>&nbsp;<span class="op" id="5983499">!=</span>&nbsp;<span class="ident" id="5983502">nil</span>&nbsp;<span class="op" id="5983506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983510">return</span>&nbsp;<span class="ident" id="5983517"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983359">e</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983524">return</span>&nbsp;<span class="ident" id="5983531">nil</span><br>
<span class="lineno"></span><span class="op" id="5983535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="5983538">//&nbsp;TranslateRead&nbsp;translates&nbsp;the&nbsp;address&nbsp;and&nbsp;sets&nbsp;the&nbsp;use&nbsp;bit.</span><br>
<span class="lineno"></span><span class="keyword" id="5983600">func</span>&nbsp;<span class="op" id="5983605">(</span><span class="ident" id="5983606">pt</span>&nbsp;<span class="op" id="5983609">*</span><span class="ident" id="5983610"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981356">pageTable</a></span><span class="op" id="5983619">)</span>&nbsp;<span class="ident" id="5983621">TranslateRead</span><span class="op" id="5983634">(</span><span class="ident" id="5983635">addr</span>&nbsp;<span class="builtintype" id="5983640">uint32</span><span class="op" id="5983646">,</span>&nbsp;<span class="ident" id="5983648">ring</span>&nbsp;<span class="builtintype" id="5983653">byte</span><span class="op" id="5983657">)</span>&nbsp;<span class="op" id="5983659">(</span><span class="builtintype" id="5983660">uint32</span><span class="op" id="5983666">,</span>&nbsp;<span class="op" id="5983668">*</span><span class="ident" id="5983669"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span><span class="op" id="5983674">)</span>&nbsp;<span class="op" id="5983676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983679">ret</span><span class="op" id="5983682">,</span>&nbsp;<span class="ident" id="5983684">e</span>&nbsp;<span class="op" id="5983686">:=</span>&nbsp;<span class="ident" id="5983689"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983606">pt</a></span><span class="op" id="5983691">.</span><span class="ident" id="5983692">Translate</span><span class="op" id="5983701">(</span><span class="ident" id="5983702"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983635">addr</a></span><span class="op" id="5983706">,</span>&nbsp;<span class="ident" id="5983708"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983648">ring</a></span><span class="op" id="5983712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983715">if</span>&nbsp;<span class="ident" id="5983718"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983684">e</a></span>&nbsp;<span class="op" id="5983720">!=</span>&nbsp;<span class="ident" id="5983723">nil</span>&nbsp;<span class="op" id="5983727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983731">return</span>&nbsp;<span class="num" id="5983738">0</span><span class="op" id="5983739">,</span>&nbsp;<span class="ident" id="5983741"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983684">e</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983748"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983606">pt</a></span><span class="op" id="5983750">.</span><span class="ident" id="5983751">pte1</span><span class="op" id="5983755">.</span><span class="ident" id="5983756">setBit</span><span class="op" id="5983762">(</span><span class="ident" id="5983763"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982019">pteUse</a></span><span class="op" id="5983769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983772"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983606">pt</a></span><span class="op" id="5983774">.</span><span class="ident" id="5983775">pte2</span><span class="op" id="5983779">.</span><span class="ident" id="5983780">setBit</span><span class="op" id="5983786">(</span><span class="ident" id="5983787"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982019">pteUse</a></span><span class="op" id="5983793">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983797"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983684">e</a></span>&nbsp;<span class="op" id="5983799">=</span>&nbsp;<span class="ident" id="5983801"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983606">pt</a></span><span class="op" id="5983803">.</span><span class="ident" id="5983804">updatePte</span><span class="op" id="5983813">(</span><span class="op" id="5983814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983817">if</span>&nbsp;<span class="ident" id="5983820"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983684">e</a></span>&nbsp;<span class="op" id="5983822">!=</span>&nbsp;<span class="ident" id="5983825">nil</span>&nbsp;<span class="op" id="5983829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983833">return</span>&nbsp;<span class="num" id="5983840">0</span><span class="op" id="5983841">,</span>&nbsp;<span class="ident" id="5983843"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983684">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983850">return</span>&nbsp;<span class="ident" id="5983857"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983679">ret</a></span><span class="op" id="5983860">,</span>&nbsp;<span class="ident" id="5983862">nil</span><br>
<span class="lineno"></span><span class="op" id="5983866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5983869">//&nbsp;TranslateWrite&nbsp;translates&nbsp;the&nbsp;address&nbsp;and&nbsp;sets&nbsp;the&nbsp;use&nbsp;and&nbsp;dirty&nbsp;bit</span><br>
<span class="lineno"></span><span class="keyword" id="5983941">func</span>&nbsp;<span class="op" id="5983946">(</span><span class="ident" id="5983947">pt</span>&nbsp;<span class="op" id="5983950">*</span><span class="ident" id="5983951"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5981356">pageTable</a></span><span class="op" id="5983960">)</span>&nbsp;<span class="ident" id="5983962">TranslateWrite</span><span class="op" id="5983976">(</span><span class="ident" id="5983977">addr</span>&nbsp;<span class="builtintype" id="5983982">uint32</span><span class="op" id="5983988">,</span>&nbsp;<span class="ident" id="5983990">ring</span>&nbsp;<span class="builtintype" id="5983995">byte</span><span class="op" id="5983999">)</span>&nbsp;<span class="op" id="5984001">(</span><span class="builtintype" id="5984002">uint32</span><span class="op" id="5984008">,</span>&nbsp;<span class="op" id="5984010">*</span><span class="ident" id="5984011"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span><span class="op" id="5984016">)</span>&nbsp;<span class="op" id="5984018">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984021">ret</span><span class="op" id="5984024">,</span>&nbsp;<span class="ident" id="5984026">e</span>&nbsp;<span class="op" id="5984028">:=</span>&nbsp;<span class="ident" id="5984031"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983947">pt</a></span><span class="op" id="5984033">.</span><span class="ident" id="5984034">Translate</span><span class="op" id="5984043">(</span><span class="ident" id="5984044"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983977">addr</a></span><span class="op" id="5984048">,</span>&nbsp;<span class="ident" id="5984050"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983990">ring</a></span><span class="op" id="5984054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984057">if</span>&nbsp;<span class="ident" id="5984060"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5984026">e</a></span>&nbsp;<span class="op" id="5984062">!=</span>&nbsp;<span class="ident" id="5984065">nil</span>&nbsp;<span class="op" id="5984069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984073">return</span>&nbsp;<span class="num" id="5984080">0</span><span class="op" id="5984081">,</span>&nbsp;<span class="ident" id="5984083"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5984026">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984090">if</span>&nbsp;<span class="ident" id="5984093"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983947">pt</a></span><span class="op" id="5984095">.</span><span class="ident" id="5984096">pte1</span><span class="op" id="5984100">.</span><span class="ident" id="5984101">testBit</span><span class="op" id="5984108">(</span><span class="ident" id="5984109"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982002">pteReadonly</a></span><span class="op" id="5984120">)</span>&nbsp;<span class="op" id="5984122">||</span>&nbsp;<span class="ident" id="5984125"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983947">pt</a></span><span class="op" id="5984127">.</span><span class="ident" id="5984128">pte2</span><span class="op" id="5984132">.</span><span class="ident" id="5984133">testBit</span><span class="op" id="5984140">(</span><span class="ident" id="5984141"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982002">pteReadonly</a></span><span class="op" id="5984152">)</span>&nbsp;<span class="op" id="5984154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984158">return</span>&nbsp;<span class="num" id="5984165">0</span><span class="op" id="5984166">,</span>&nbsp;<span class="ident" id="5984168"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5966424">newPageReadonly</a></span><span class="op" id="5984183">(</span><span class="ident" id="5984184"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983977">addr</a></span><span class="op" id="5984188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984195"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983947">pt</a></span><span class="op" id="5984197">.</span><span class="ident" id="5984198">pte1</span><span class="op" id="5984202">.</span><span class="ident" id="5984203">setBit</span><span class="op" id="5984209">(</span><span class="ident" id="5984210"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982019">pteUse</a></span><span class="op" id="5984216">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984219"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983947">pt</a></span><span class="op" id="5984221">.</span><span class="ident" id="5984222">pte1</span><span class="op" id="5984226">.</span><span class="ident" id="5984227">setBit</span><span class="op" id="5984233">(</span><span class="ident" id="5984234"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982036">pteDirty</a></span><span class="op" id="5984242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984245"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983947">pt</a></span><span class="op" id="5984247">.</span><span class="ident" id="5984248">pte2</span><span class="op" id="5984252">.</span><span class="ident" id="5984253">setBit</span><span class="op" id="5984259">(</span><span class="ident" id="5984260"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982019">pteUse</a></span><span class="op" id="5984266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984269"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983947">pt</a></span><span class="op" id="5984271">.</span><span class="ident" id="5984272">pte2</span><span class="op" id="5984276">.</span><span class="ident" id="5984277">setBit</span><span class="op" id="5984283">(</span><span class="ident" id="5984284"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5982036">pteDirty</a></span><span class="op" id="5984292">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984296"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5984026">e</a></span>&nbsp;<span class="op" id="5984298">=</span>&nbsp;<span class="ident" id="5984300"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5983947">pt</a></span><span class="op" id="5984302">.</span><span class="ident" id="5984303">updatePte</span><span class="op" id="5984312">(</span><span class="op" id="5984313">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984316">if</span>&nbsp;<span class="ident" id="5984319"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5984026">e</a></span>&nbsp;<span class="op" id="5984321">!=</span>&nbsp;<span class="ident" id="5984324">nil</span>&nbsp;<span class="op" id="5984328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984332">return</span>&nbsp;<span class="num" id="5984339">0</span><span class="op" id="5984340">,</span>&nbsp;<span class="ident" id="5984342"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5984026">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984349">return</span>&nbsp;<span class="ident" id="5984356"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5984021">ret</a></span><span class="op" id="5984359">,</span>&nbsp;<span class="ident" id="5984361">nil</span><br>
<span class="lineno">160</span><span class="op" id="5984365">}</span>
</div>
</body>
</html>
