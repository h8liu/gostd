<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7294664">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7294719">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7294773">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7294824">package</span>&nbsp;<span class="ident" id="7294832">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7294837">import</span>&nbsp;<span class="op" id="7294844">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7294847">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7294863">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7294873">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7294876">type</span>&nbsp;<span class="ident" id="7294881">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="7294910">struct</span>&nbsp;<span class="op" id="7294917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294920">in</span><span class="op" id="7294922">,</span>&nbsp;<span class="ident" id="7294924">out1</span><span class="op" id="7294928">,</span>&nbsp;<span class="ident" id="7294930">out2</span>&nbsp;<span class="builtintype" id="7294935">string</span><br>
<span class="lineno"></span><span class="op" id="7294942">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7294945">var</span>&nbsp;<span class="ident" id="7294949">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7294979">=</span>&nbsp;<span class="op" id="7294981">[</span><span class="op" id="7294982">]</span><span class="ident" id="7294983">testSplitPreMasterSecretTest</span><span class="op" id="7295011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295014">{</span><span class="string" id="7295015">&#34;&#34;</span><span class="op" id="7295017">,</span>&nbsp;<span class="string" id="7295019">&#34;&#34;</span><span class="op" id="7295021">,</span>&nbsp;<span class="string" id="7295023">&#34;&#34;</span><span class="op" id="7295025">}</span><span class="op" id="7295026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295029">{</span><span class="string" id="7295030">&#34;00&#34;</span><span class="op" id="7295034">,</span>&nbsp;<span class="string" id="7295036">&#34;00&#34;</span><span class="op" id="7295040">,</span>&nbsp;<span class="string" id="7295042">&#34;00&#34;</span><span class="op" id="7295046">}</span><span class="op" id="7295047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295050">{</span><span class="string" id="7295051">&#34;0011&#34;</span><span class="op" id="7295057">,</span>&nbsp;<span class="string" id="7295059">&#34;00&#34;</span><span class="op" id="7295063">,</span>&nbsp;<span class="string" id="7295065">&#34;11&#34;</span><span class="op" id="7295069">}</span><span class="op" id="7295070">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295073">{</span><span class="string" id="7295074">&#34;001122&#34;</span><span class="op" id="7295082">,</span>&nbsp;<span class="string" id="7295084">&#34;0011&#34;</span><span class="op" id="7295090">,</span>&nbsp;<span class="string" id="7295092">&#34;1122&#34;</span><span class="op" id="7295098">}</span><span class="op" id="7295099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295102">{</span><span class="string" id="7295103">&#34;00112233&#34;</span><span class="op" id="7295113">,</span>&nbsp;<span class="string" id="7295115">&#34;0011&#34;</span><span class="op" id="7295121">,</span>&nbsp;<span class="string" id="7295123">&#34;2233&#34;</span><span class="op" id="7295129">}</span><span class="op" id="7295130">,</span><br>
<span class="lineno"></span><span class="op" id="7295132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7295135">func</span>&nbsp;<span class="ident" id="7295140">TestSplitPreMasterSecret</span><span class="op" id="7295164">(</span><span class="ident" id="7295165">t</span>&nbsp;<span class="op" id="7295167">*</span><span class="ident" id="7295168">testing</span><span class="op" id="7295175">.</span><span class="ident" id="7295176">T</span><span class="op" id="7295177">)</span>&nbsp;<span class="op" id="7295179">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295182">for</span>&nbsp;<span class="ident" id="7295186">i</span><span class="op" id="7295187">,</span>&nbsp;<span class="ident" id="7295189">test</span>&nbsp;<span class="op" id="7295194">:=</span>&nbsp;<span class="keyword" id="7295197">range</span>&nbsp;<span class="ident" id="7295203">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7295233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295237">in</span><span class="op" id="7295239">,</span>&nbsp;<span class="ident" id="7295241">_</span>&nbsp;<span class="op" id="7295243">:=</span>&nbsp;<span class="ident" id="7295246">hex</span><span class="op" id="7295249">.</span><span class="ident" id="7295250">DecodeString</span><span class="op" id="7295262">(</span><span class="ident" id="7295263">test</span><span class="op" id="7295267">.</span><span class="ident" id="7295268">in</span><span class="op" id="7295270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295274">out1</span><span class="op" id="7295278">,</span>&nbsp;<span class="ident" id="7295280">out2</span>&nbsp;<span class="op" id="7295285">:=</span>&nbsp;<span class="ident" id="7295288">splitPreMasterSecret</span><span class="op" id="7295308">(</span><span class="ident" id="7295309">in</span><span class="op" id="7295311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295315">s1</span>&nbsp;<span class="op" id="7295318">:=</span>&nbsp;<span class="ident" id="7295321">hex</span><span class="op" id="7295324">.</span><span class="ident" id="7295325">EncodeToString</span><span class="op" id="7295339">(</span><span class="ident" id="7295340">out1</span><span class="op" id="7295344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295348">s2</span>&nbsp;<span class="op" id="7295351">:=</span>&nbsp;<span class="ident" id="7295354">hex</span><span class="op" id="7295357">.</span><span class="ident" id="7295358">EncodeToString</span><span class="op" id="7295372">(</span><span class="ident" id="7295373">out2</span><span class="op" id="7295377">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295381">if</span>&nbsp;<span class="ident" id="7295384">s1</span>&nbsp;<span class="op" id="7295387">!=</span>&nbsp;<span class="ident" id="7295390">test</span><span class="op" id="7295394">.</span><span class="ident" id="7295395">out1</span>&nbsp;<span class="op" id="7295400">||</span>&nbsp;<span class="ident" id="7295403">s2</span>&nbsp;<span class="op" id="7295406">!=</span>&nbsp;<span class="ident" id="7295409">test</span><span class="op" id="7295413">.</span><span class="ident" id="7295414">out2</span>&nbsp;<span class="op" id="7295419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295424">t</span><span class="op" id="7295425">.</span><span class="ident" id="7295426">Errorf</span><span class="op" id="7295432">(</span><span class="string" id="7295433">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="7295468">,</span>&nbsp;<span class="ident" id="7295470">i</span><span class="op" id="7295471">,</span>&nbsp;<span class="ident" id="7295473">s1</span><span class="op" id="7295475">,</span>&nbsp;<span class="ident" id="7295477">s2</span><span class="op" id="7295479">,</span>&nbsp;<span class="ident" id="7295481">test</span><span class="op" id="7295485">.</span><span class="ident" id="7295486">out1</span><span class="op" id="7295490">,</span>&nbsp;<span class="ident" id="7295492">test</span><span class="op" id="7295496">.</span><span class="ident" id="7295497">out2</span><span class="op" id="7295501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295508">}</span><br>
<span class="lineno"></span><span class="op" id="7295510">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7295513">type</span>&nbsp;<span class="ident" id="7295518">testKeysFromTest</span>&nbsp;<span class="keyword" id="7295535">struct</span>&nbsp;<span class="op" id="7295542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295545">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7295572">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295580">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7295607">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295615">clientRandom</span><span class="op" id="7295627">,</span>&nbsp;<span class="ident" id="7295629">serverRandom</span>&nbsp;<span class="builtintype" id="7295642">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295650">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7295677">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295685">clientMAC</span><span class="op" id="7295694">,</span>&nbsp;<span class="ident" id="7295696">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7295712">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295720">clientKey</span><span class="op" id="7295729">,</span>&nbsp;<span class="ident" id="7295731">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7295747">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295755">macLen</span><span class="op" id="7295761">,</span>&nbsp;<span class="ident" id="7295763">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7295782">int</span><br>
<span class="lineno"></span><span class="op" id="7295786">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7295789">func</span>&nbsp;<span class="ident" id="7295794">TestKeysFromPreMasterSecret</span><span class="op" id="7295821">(</span><span class="ident" id="7295822">t</span>&nbsp;<span class="op" id="7295824">*</span><span class="ident" id="7295825">testing</span><span class="op" id="7295832">.</span><span class="ident" id="7295833">T</span><span class="op" id="7295834">)</span>&nbsp;<span class="op" id="7295836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295839">for</span>&nbsp;<span class="ident" id="7295843">i</span><span class="op" id="7295844">,</span>&nbsp;<span class="ident" id="7295846">test</span>&nbsp;<span class="op" id="7295851">:=</span>&nbsp;<span class="keyword" id="7295854">range</span>&nbsp;<span class="ident" id="7295860">testKeysFromTests</span>&nbsp;<span class="op" id="7295878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295882">in</span><span class="op" id="7295884">,</span>&nbsp;<span class="ident" id="7295886">_</span>&nbsp;<span class="op" id="7295888">:=</span>&nbsp;<span class="ident" id="7295891">hex</span><span class="op" id="7295894">.</span><span class="ident" id="7295895">DecodeString</span><span class="op" id="7295907">(</span><span class="ident" id="7295908">test</span><span class="op" id="7295912">.</span><span class="ident" id="7295913">preMasterSecret</span><span class="op" id="7295928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295932">clientRandom</span><span class="op" id="7295944">,</span>&nbsp;<span class="ident" id="7295946">_</span>&nbsp;<span class="op" id="7295948">:=</span>&nbsp;<span class="ident" id="7295951">hex</span><span class="op" id="7295954">.</span><span class="ident" id="7295955">DecodeString</span><span class="op" id="7295967">(</span><span class="ident" id="7295968">test</span><span class="op" id="7295972">.</span><span class="ident" id="7295973">clientRandom</span><span class="op" id="7295985">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295989">serverRandom</span><span class="op" id="7296001">,</span>&nbsp;<span class="ident" id="7296003">_</span>&nbsp;<span class="op" id="7296005">:=</span>&nbsp;<span class="ident" id="7296008">hex</span><span class="op" id="7296011">.</span><span class="ident" id="7296012">DecodeString</span><span class="op" id="7296024">(</span><span class="ident" id="7296025">test</span><span class="op" id="7296029">.</span><span class="ident" id="7296030">serverRandom</span><span class="op" id="7296042">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296047">masterSecret</span>&nbsp;<span class="op" id="7296060">:=</span>&nbsp;<span class="ident" id="7296063">masterFromPreMasterSecret</span><span class="op" id="7296088">(</span><span class="ident" id="7296089">test</span><span class="op" id="7296093">.</span><span class="ident" id="7296094">version</span><span class="op" id="7296101">,</span>&nbsp;<span class="ident" id="7296103">in</span><span class="op" id="7296105">,</span>&nbsp;<span class="ident" id="7296107">clientRandom</span><span class="op" id="7296119">,</span>&nbsp;<span class="ident" id="7296121">serverRandom</span><span class="op" id="7296133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296137">if</span>&nbsp;<span class="ident" id="7296140">s</span>&nbsp;<span class="op" id="7296142">:=</span>&nbsp;<span class="ident" id="7296145">hex</span><span class="op" id="7296148">.</span><span class="ident" id="7296149">EncodeToString</span><span class="op" id="7296163">(</span><span class="ident" id="7296164">masterSecret</span><span class="op" id="7296176">)</span><span class="op" id="7296177">;</span>&nbsp;<span class="ident" id="7296179">s</span>&nbsp;<span class="op" id="7296181">!=</span>&nbsp;<span class="ident" id="7296184">test</span><span class="op" id="7296188">.</span><span class="ident" id="7296189">masterSecret</span>&nbsp;<span class="op" id="7296202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296207">t</span><span class="op" id="7296208">.</span><span class="ident" id="7296209">Errorf</span><span class="op" id="7296215">(</span><span class="string" id="7296216">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7296252">,</span>&nbsp;<span class="ident" id="7296254">i</span><span class="op" id="7296255">,</span>&nbsp;<span class="ident" id="7296257">s</span><span class="op" id="7296258">,</span>&nbsp;<span class="ident" id="7296260">test</span><span class="op" id="7296264">.</span><span class="ident" id="7296265">masterSecret</span><span class="op" id="7296277">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296282">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296298">clientMAC</span><span class="op" id="7296307">,</span>&nbsp;<span class="ident" id="7296309">serverMAC</span><span class="op" id="7296318">,</span>&nbsp;<span class="ident" id="7296320">clientKey</span><span class="op" id="7296329">,</span>&nbsp;<span class="ident" id="7296331">serverKey</span><span class="op" id="7296340">,</span>&nbsp;<span class="ident" id="7296342">_</span><span class="op" id="7296343">,</span>&nbsp;<span class="ident" id="7296345">_</span>&nbsp;<span class="op" id="7296347">:=</span>&nbsp;<span class="ident" id="7296350">keysFromMasterSecret</span><span class="op" id="7296370">(</span><span class="ident" id="7296371">test</span><span class="op" id="7296375">.</span><span class="ident" id="7296376">version</span><span class="op" id="7296383">,</span>&nbsp;<span class="ident" id="7296385">masterSecret</span><span class="op" id="7296397">,</span>&nbsp;<span class="ident" id="7296399">clientRandom</span><span class="op" id="7296411">,</span>&nbsp;<span class="ident" id="7296413">serverRandom</span><span class="op" id="7296425">,</span>&nbsp;<span class="ident" id="7296427">test</span><span class="op" id="7296431">.</span><span class="ident" id="7296432">macLen</span><span class="op" id="7296438">,</span>&nbsp;<span class="ident" id="7296440">test</span><span class="op" id="7296444">.</span><span class="ident" id="7296445">keyLen</span><span class="op" id="7296451">,</span>&nbsp;<span class="num" id="7296453">0</span><span class="op" id="7296454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296458">clientMACString</span>&nbsp;<span class="op" id="7296474">:=</span>&nbsp;<span class="ident" id="7296477">hex</span><span class="op" id="7296480">.</span><span class="ident" id="7296481">EncodeToString</span><span class="op" id="7296495">(</span><span class="ident" id="7296496">clientMAC</span><span class="op" id="7296505">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296509">serverMACString</span>&nbsp;<span class="op" id="7296525">:=</span>&nbsp;<span class="ident" id="7296528">hex</span><span class="op" id="7296531">.</span><span class="ident" id="7296532">EncodeToString</span><span class="op" id="7296546">(</span><span class="ident" id="7296547">serverMAC</span><span class="op" id="7296556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296560">clientKeyString</span>&nbsp;<span class="op" id="7296576">:=</span>&nbsp;<span class="ident" id="7296579">hex</span><span class="op" id="7296582">.</span><span class="ident" id="7296583">EncodeToString</span><span class="op" id="7296597">(</span><span class="ident" id="7296598">clientKey</span><span class="op" id="7296607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296611">serverKeyString</span>&nbsp;<span class="op" id="7296627">:=</span>&nbsp;<span class="ident" id="7296630">hex</span><span class="op" id="7296633">.</span><span class="ident" id="7296634">EncodeToString</span><span class="op" id="7296648">(</span><span class="ident" id="7296649">serverKey</span><span class="op" id="7296658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296662">if</span>&nbsp;<span class="ident" id="7296665">clientMACString</span>&nbsp;<span class="op" id="7296681">!=</span>&nbsp;<span class="ident" id="7296684">test</span><span class="op" id="7296688">.</span><span class="ident" id="7296689">clientMAC</span>&nbsp;<span class="op" id="7296699">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296705">serverMACString</span>&nbsp;<span class="op" id="7296721">!=</span>&nbsp;<span class="ident" id="7296724">test</span><span class="op" id="7296728">.</span><span class="ident" id="7296729">serverMAC</span>&nbsp;<span class="op" id="7296739">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296745">clientKeyString</span>&nbsp;<span class="op" id="7296761">!=</span>&nbsp;<span class="ident" id="7296764">test</span><span class="op" id="7296768">.</span><span class="ident" id="7296769">clientKey</span>&nbsp;<span class="op" id="7296779">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296785">serverKeyString</span>&nbsp;<span class="op" id="7296801">!=</span>&nbsp;<span class="ident" id="7296804">test</span><span class="op" id="7296808">.</span><span class="ident" id="7296809">serverKey</span>&nbsp;<span class="op" id="7296819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296824">t</span><span class="op" id="7296825">.</span><span class="ident" id="7296826">Errorf</span><span class="op" id="7296832">(</span><span class="string" id="7296833">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="7296884">,</span>&nbsp;<span class="ident" id="7296886">i</span><span class="op" id="7296887">,</span>&nbsp;<span class="ident" id="7296889">clientMACString</span><span class="op" id="7296904">,</span>&nbsp;<span class="ident" id="7296906">serverMACString</span><span class="op" id="7296921">,</span>&nbsp;<span class="ident" id="7296923">clientKeyString</span><span class="op" id="7296938">,</span>&nbsp;<span class="ident" id="7296940">serverKeyString</span><span class="op" id="7296955">,</span>&nbsp;<span class="ident" id="7296957">test</span><span class="op" id="7296961">.</span><span class="ident" id="7296962">clientMAC</span><span class="op" id="7296971">,</span>&nbsp;<span class="ident" id="7296973">test</span><span class="op" id="7296977">.</span><span class="ident" id="7296978">serverMAC</span><span class="op" id="7296987">,</span>&nbsp;<span class="ident" id="7296989">test</span><span class="op" id="7296993">.</span><span class="ident" id="7296994">clientKey</span><span class="op" id="7297003">,</span>&nbsp;<span class="ident" id="7297005">test</span><span class="op" id="7297009">.</span><span class="ident" id="7297010">serverKey</span><span class="op" id="7297019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297026">}</span><br>
<span class="lineno">70</span><span class="op" id="7297028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7297031">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="7297116">var</span>&nbsp;<span class="ident" id="7297120">testKeysFromTests</span>&nbsp;<span class="op" id="7297138">=</span>&nbsp;<span class="op" id="7297140">[</span><span class="op" id="7297141">]</span><span class="ident" id="7297142">testKeysFromTest</span><span class="op" id="7297158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297161">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297165">VersionTLS10</span><span class="op" id="7297177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297181">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="7297279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297283">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="7297349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297353">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="7297419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297423">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="7297521">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297525">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="7297567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297571">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="7297613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297617">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="7297651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297655">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="7297689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7297693">20</span><span class="op" id="7297695">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7297699">16</span><span class="op" id="7297701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297704">}</span><span class="op" id="7297705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297712">VersionTLS10</span><span class="op" id="7297724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297728">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="7297826">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297830">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="7297896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297900">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="7297966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297970">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="7298068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298072">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="7298114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298118">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="7298160">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298164">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="7298198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298202">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="7298236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7298240">20</span><span class="op" id="7298242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7298246">16</span><span class="op" id="7298248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298251">}</span><span class="op" id="7298252">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298259">VersionTLS10</span><span class="op" id="7298271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298275">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7298533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298537">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7298603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298607">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7298673">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298677">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="7298775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298779">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="7298821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298825">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="7298867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298871">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="7298905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298909">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="7298943">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7298947">20</span><span class="op" id="7298949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7298953">16</span><span class="op" id="7298955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298958">}</span><span class="op" id="7298959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298966">VersionSSL30</span><span class="op" id="7298978">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7298982">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7299240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299244">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7299310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299314">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7299380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299384">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="7299482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299486">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="7299528">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299532">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="7299574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299578">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="7299612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299616">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="7299650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7299654">20</span><span class="op" id="7299656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7299660">16</span><span class="op" id="7299662">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299665">}</span><span class="op" id="7299666">,</span><br>
<span class="lineno"></span><span class="op" id="7299668">}</span>
</div>
</body>
</html>
