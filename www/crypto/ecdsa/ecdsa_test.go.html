<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8676340">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8676395">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8676449">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8676500">package</span>&nbsp;<span class="ident" id="8676508">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8676515">import</span>&nbsp;<span class="op" id="8676522">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676525">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676534">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676552">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676571">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676586">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676601">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676618">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676635">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676651">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676659">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676665">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676677">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676683">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676694">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8676704">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8676707">func</span>&nbsp;<span class="ident" id="8676712">testKeyGeneration</span><span class="op" id="8676729">(</span><span class="ident" id="8676730">t</span>&nbsp;<span class="op" id="8676732">*</span><span class="ident" id="8676733"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676694">testing</a></span><span class="op" id="8676740">.</span><span class="ident" id="8676741">T</span><span class="op" id="8676742">,</span>&nbsp;<span class="ident" id="8676744">c</span>&nbsp;<span class="ident" id="8676746"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8676754">.</span><span class="ident" id="8676755">Curve</span><span class="op" id="8676760">,</span>&nbsp;<span class="ident" id="8676762">tag</span>&nbsp;<span class="builtintype" id="8676766">string</span><span class="op" id="8676772">)</span>&nbsp;<span class="op" id="8676774">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676777">priv</span><span class="op" id="8676781">,</span>&nbsp;<span class="ident" id="8676783">err</span>&nbsp;<span class="op" id="8676787">:=</span>&nbsp;<span class="ident" id="8676790"><a href="/crypto/ecdsa/ecdsa.go.html#4436615">GenerateKey</a></span><span class="op" id="8676801">(</span><span class="ident" id="8676802"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676744">c</a></span><span class="op" id="8676803">,</span>&nbsp;<span class="ident" id="8676805"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676571">rand</a></span><span class="op" id="8676809">.</span><span class="ident" id="8676810">Reader</span><span class="op" id="8676816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676819">if</span>&nbsp;<span class="ident" id="8676822"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676783">err</a></span>&nbsp;<span class="op" id="8676826">!=</span>&nbsp;<span class="ident" id="8676829">nil</span>&nbsp;<span class="op" id="8676833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676837"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676730">t</a></span><span class="op" id="8676838">.</span><span class="ident" id="8676839">Errorf</span><span class="op" id="8676845">(</span><span class="string" id="8676846">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8676861">,</span>&nbsp;<span class="ident" id="8676863"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676762">tag</a></span><span class="op" id="8676866">,</span>&nbsp;<span class="ident" id="8676868"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676783">err</a></span><span class="op" id="8676871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676875">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8676883">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676886">if</span>&nbsp;<span class="op" id="8676889">!</span><span class="ident" id="8676890"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676744">c</a></span><span class="op" id="8676891">.</span><span class="ident" id="8676892">IsOnCurve</span><span class="op" id="8676901">(</span><span class="ident" id="8676902"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676777">priv</a></span><span class="op" id="8676906">.</span><span class="ident" id="8676907">PublicKey</span><span class="op" id="8676916">.</span><span class="ident" id="8676917">X</span><span class="op" id="8676918">,</span>&nbsp;<span class="ident" id="8676920"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676777">priv</a></span><span class="op" id="8676924">.</span><span class="ident" id="8676925">PublicKey</span><span class="op" id="8676934">.</span><span class="ident" id="8676935">Y</span><span class="op" id="8676936">)</span>&nbsp;<span class="op" id="8676938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676942"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676730">t</a></span><span class="op" id="8676943">.</span><span class="ident" id="8676944">Errorf</span><span class="op" id="8676950">(</span><span class="string" id="8676951">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="8676979">,</span>&nbsp;<span class="ident" id="8676981"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676762">tag</a></span><span class="op" id="8676984">,</span>&nbsp;<span class="ident" id="8676986"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676783">err</a></span><span class="op" id="8676989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8676992">}</span><br>
<span class="lineno"></span><span class="op" id="8676994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8676997">func</span>&nbsp;<span class="ident" id="8677002">TestKeyGeneration</span><span class="op" id="8677019">(</span><span class="ident" id="8677020">t</span>&nbsp;<span class="op" id="8677022">*</span><span class="ident" id="8677023"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676694">testing</a></span><span class="op" id="8677030">.</span><span class="ident" id="8677031">T</span><span class="op" id="8677032">)</span>&nbsp;<span class="op" id="8677034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677037"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676712">testKeyGeneration</a></span><span class="op" id="8677054">(</span><span class="ident" id="8677055"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677020">t</a></span><span class="op" id="8677056">,</span>&nbsp;<span class="ident" id="8677058"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8677066">.</span><span class="ident" id="8677067">P224</span><span class="op" id="8677071">(</span><span class="op" id="8677072">)</span><span class="op" id="8677073">,</span>&nbsp;<span class="string" id="8677075">&#34;p224&#34;</span><span class="op" id="8677081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677084">if</span>&nbsp;<span class="ident" id="8677087"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676694">testing</a></span><span class="op" id="8677094">.</span><span class="ident" id="8677095">Short</span><span class="op" id="8677100">(</span><span class="op" id="8677101">)</span>&nbsp;<span class="op" id="8677103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677107">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677115">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677118"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676712">testKeyGeneration</a></span><span class="op" id="8677135">(</span><span class="ident" id="8677136"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677020">t</a></span><span class="op" id="8677137">,</span>&nbsp;<span class="ident" id="8677139"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8677147">.</span><span class="ident" id="8677148">P256</span><span class="op" id="8677152">(</span><span class="op" id="8677153">)</span><span class="op" id="8677154">,</span>&nbsp;<span class="string" id="8677156">&#34;p256&#34;</span><span class="op" id="8677162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677165"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676712">testKeyGeneration</a></span><span class="op" id="8677182">(</span><span class="ident" id="8677183"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677020">t</a></span><span class="op" id="8677184">,</span>&nbsp;<span class="ident" id="8677186"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8677194">.</span><span class="ident" id="8677195">P384</span><span class="op" id="8677199">(</span><span class="op" id="8677200">)</span><span class="op" id="8677201">,</span>&nbsp;<span class="string" id="8677203">&#34;p384&#34;</span><span class="op" id="8677209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677212"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676712">testKeyGeneration</a></span><span class="op" id="8677229">(</span><span class="ident" id="8677230"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677020">t</a></span><span class="op" id="8677231">,</span>&nbsp;<span class="ident" id="8677233"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8677241">.</span><span class="ident" id="8677242">P521</span><span class="op" id="8677246">(</span><span class="op" id="8677247">)</span><span class="op" id="8677248">,</span>&nbsp;<span class="string" id="8677250">&#34;p521&#34;</span><span class="op" id="8677256">)</span><br>
<span class="lineno"></span><span class="op" id="8677258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="8677261">func</span>&nbsp;<span class="ident" id="8677266">testSignAndVerify</span><span class="op" id="8677283">(</span><span class="ident" id="8677284">t</span>&nbsp;<span class="op" id="8677286">*</span><span class="ident" id="8677287"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676694">testing</a></span><span class="op" id="8677294">.</span><span class="ident" id="8677295">T</span><span class="op" id="8677296">,</span>&nbsp;<span class="ident" id="8677298">c</span>&nbsp;<span class="ident" id="8677300"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8677308">.</span><span class="ident" id="8677309">Curve</span><span class="op" id="8677314">,</span>&nbsp;<span class="ident" id="8677316">tag</span>&nbsp;<span class="builtintype" id="8677320">string</span><span class="op" id="8677326">)</span>&nbsp;<span class="op" id="8677328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677331">priv</span><span class="op" id="8677335">,</span>&nbsp;<span class="ident" id="8677337">_</span>&nbsp;<span class="op" id="8677339">:=</span>&nbsp;<span class="ident" id="8677342"><a href="/crypto/ecdsa/ecdsa.go.html#4436615">GenerateKey</a></span><span class="op" id="8677353">(</span><span class="ident" id="8677354"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677298">c</a></span><span class="op" id="8677355">,</span>&nbsp;<span class="ident" id="8677357"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676571">rand</a></span><span class="op" id="8677361">.</span><span class="ident" id="8677362">Reader</span><span class="op" id="8677368">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677372">hashed</span>&nbsp;<span class="op" id="8677379">:=</span>&nbsp;<span class="op" id="8677382">[</span><span class="op" id="8677383">]</span><span class="builtintype" id="8677384">byte</span><span class="op" id="8677388">(</span><span class="string" id="8677389">&#34;testing&#34;</span><span class="op" id="8677398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677401">r</span><span class="op" id="8677402">,</span>&nbsp;<span class="ident" id="8677404">s</span><span class="op" id="8677405">,</span>&nbsp;<span class="ident" id="8677407">err</span>&nbsp;<span class="op" id="8677411">:=</span>&nbsp;<span class="ident" id="8677414"><a href="/crypto/ecdsa/ecdsa.go.html#4438293">Sign</a></span><span class="op" id="8677418">(</span><span class="ident" id="8677419"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676571">rand</a></span><span class="op" id="8677423">.</span><span class="ident" id="8677424">Reader</span><span class="op" id="8677430">,</span>&nbsp;<span class="ident" id="8677432"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677331">priv</a></span><span class="op" id="8677436">,</span>&nbsp;<span class="ident" id="8677438"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677372">hashed</a></span><span class="op" id="8677444">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677447">if</span>&nbsp;<span class="ident" id="8677450"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677407">err</a></span>&nbsp;<span class="op" id="8677454">!=</span>&nbsp;<span class="ident" id="8677457">nil</span>&nbsp;<span class="op" id="8677461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677465"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677284">t</a></span><span class="op" id="8677466">.</span><span class="ident" id="8677467">Errorf</span><span class="op" id="8677473">(</span><span class="string" id="8677474">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8677497">,</span>&nbsp;<span class="ident" id="8677499"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677316">tag</a></span><span class="op" id="8677502">,</span>&nbsp;<span class="ident" id="8677504"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677407">err</a></span><span class="op" id="8677507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677511">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677523">if</span>&nbsp;<span class="op" id="8677526">!</span><span class="ident" id="8677527"><a href="/crypto/ecdsa/ecdsa.go.html#4438993">Verify</a></span><span class="op" id="8677533">(</span><span class="op" id="8677534">&amp;</span><span class="ident" id="8677535"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677331">priv</a></span><span class="op" id="8677539">.</span><span class="ident" id="8677540">PublicKey</span><span class="op" id="8677549">,</span>&nbsp;<span class="ident" id="8677551"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677372">hashed</a></span><span class="op" id="8677557">,</span>&nbsp;<span class="ident" id="8677559"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677401">r</a></span><span class="op" id="8677560">,</span>&nbsp;<span class="ident" id="8677562"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677404">s</a></span><span class="op" id="8677563">)</span>&nbsp;<span class="op" id="8677565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677569"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677284">t</a></span><span class="op" id="8677570">.</span><span class="ident" id="8677571">Errorf</span><span class="op" id="8677577">(</span><span class="string" id="8677578">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="8677597">,</span>&nbsp;<span class="ident" id="8677599"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677316">tag</a></span><span class="op" id="8677602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677609"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677372">hashed</a></span><span class="op" id="8677615">[</span><span class="num" id="8677616">0</span><span class="op" id="8677617">]</span>&nbsp;<span class="op" id="8677619">^=</span>&nbsp;<span class="num" id="8677622">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677628">if</span>&nbsp;<span class="ident" id="8677631"><a href="/crypto/ecdsa/ecdsa.go.html#4438993">Verify</a></span><span class="op" id="8677637">(</span><span class="op" id="8677638">&amp;</span><span class="ident" id="8677639"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677331">priv</a></span><span class="op" id="8677643">.</span><span class="ident" id="8677644">PublicKey</span><span class="op" id="8677653">,</span>&nbsp;<span class="ident" id="8677655"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677372">hashed</a></span><span class="op" id="8677661">,</span>&nbsp;<span class="ident" id="8677663"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677401">r</a></span><span class="op" id="8677664">,</span>&nbsp;<span class="ident" id="8677666"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677404">s</a></span><span class="op" id="8677667">)</span>&nbsp;<span class="op" id="8677669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677673"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677284">t</a></span><span class="op" id="8677674">.</span><span class="ident" id="8677675">Errorf</span><span class="op" id="8677681">(</span><span class="string" id="8677682">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="8677708">,</span>&nbsp;<span class="ident" id="8677710"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677316">tag</a></span><span class="op" id="8677713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677716">}</span><br>
<span class="lineno"></span><span class="op" id="8677718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="8677721">func</span>&nbsp;<span class="ident" id="8677726">TestSignAndVerify</span><span class="op" id="8677743">(</span><span class="ident" id="8677744">t</span>&nbsp;<span class="op" id="8677746">*</span><span class="ident" id="8677747"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676694">testing</a></span><span class="op" id="8677754">.</span><span class="ident" id="8677755">T</span><span class="op" id="8677756">)</span>&nbsp;<span class="op" id="8677758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677761"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677266">testSignAndVerify</a></span><span class="op" id="8677778">(</span><span class="ident" id="8677779"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677744">t</a></span><span class="op" id="8677780">,</span>&nbsp;<span class="ident" id="8677782"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8677790">.</span><span class="ident" id="8677791">P224</span><span class="op" id="8677795">(</span><span class="op" id="8677796">)</span><span class="op" id="8677797">,</span>&nbsp;<span class="string" id="8677799">&#34;p224&#34;</span><span class="op" id="8677805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677808">if</span>&nbsp;<span class="ident" id="8677811"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676694">testing</a></span><span class="op" id="8677818">.</span><span class="ident" id="8677819">Short</span><span class="op" id="8677824">(</span><span class="op" id="8677825">)</span>&nbsp;<span class="op" id="8677827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677831">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677839">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677842"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677266">testSignAndVerify</a></span><span class="op" id="8677859">(</span><span class="ident" id="8677860"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677744">t</a></span><span class="op" id="8677861">,</span>&nbsp;<span class="ident" id="8677863"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8677871">.</span><span class="ident" id="8677872">P256</span><span class="op" id="8677876">(</span><span class="op" id="8677877">)</span><span class="op" id="8677878">,</span>&nbsp;<span class="string" id="8677880">&#34;p256&#34;</span><span class="op" id="8677886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677889"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677266">testSignAndVerify</a></span><span class="op" id="8677906">(</span><span class="ident" id="8677907"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677744">t</a></span><span class="op" id="8677908">,</span>&nbsp;<span class="ident" id="8677910"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8677918">.</span><span class="ident" id="8677919">P384</span><span class="op" id="8677923">(</span><span class="op" id="8677924">)</span><span class="op" id="8677925">,</span>&nbsp;<span class="string" id="8677927">&#34;p384&#34;</span><span class="op" id="8677933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677936"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677266">testSignAndVerify</a></span><span class="op" id="8677953">(</span><span class="ident" id="8677954"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677744">t</a></span><span class="op" id="8677955">,</span>&nbsp;<span class="ident" id="8677957"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8677965">.</span><span class="ident" id="8677966">P521</span><span class="op" id="8677970">(</span><span class="op" id="8677971">)</span><span class="op" id="8677972">,</span>&nbsp;<span class="string" id="8677974">&#34;p521&#34;</span><span class="op" id="8677980">)</span><br>
<span class="lineno"></span><span class="op" id="8677982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="8677985">func</span>&nbsp;<span class="ident" id="8677990">fromHex</span><span class="op" id="8677997">(</span><span class="ident" id="8677998">s</span>&nbsp;<span class="builtintype" id="8678000">string</span><span class="op" id="8678006">)</span>&nbsp;<span class="op" id="8678008">*</span><span class="ident" id="8678009"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676665">big</a></span><span class="op" id="8678012">.</span><span class="ident" id="8678013">Int</span>&nbsp;<span class="op" id="8678017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678020">r</span><span class="op" id="8678021">,</span>&nbsp;<span class="ident" id="8678023">ok</span>&nbsp;<span class="op" id="8678026">:=</span>&nbsp;<span class="builtinfunc" id="8678029">new</span><span class="op" id="8678032">(</span><span class="ident" id="8678033"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676665">big</a></span><span class="op" id="8678036">.</span><span class="ident" id="8678037">Int</span><span class="op" id="8678040">)</span><span class="op" id="8678041">.</span><span class="ident" id="8678042">SetString</span><span class="op" id="8678051">(</span><span class="ident" id="8678052"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677998">s</a></span><span class="op" id="8678053">,</span>&nbsp;<span class="num" id="8678055">16</span><span class="op" id="8678057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678060">if</span>&nbsp;<span class="op" id="8678063">!</span><span class="ident" id="8678064"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678023">ok</a></span>&nbsp;<span class="op" id="8678067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8678071">panic</span><span class="op" id="8678076">(</span><span class="string" id="8678077">&#34;bad&nbsp;hex&#34;</span><span class="op" id="8678086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678089">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678092">return</span>&nbsp;<span class="ident" id="8678099"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678020">r</a></span><br>
<span class="lineno"></span><span class="op" id="8678101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8678104">func</span>&nbsp;<span class="ident" id="8678109">TestVectors</span><span class="op" id="8678120">(</span><span class="ident" id="8678121">t</span>&nbsp;<span class="op" id="8678123">*</span><span class="ident" id="8678124"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676694">testing</a></span><span class="op" id="8678131">.</span><span class="ident" id="8678132">T</span><span class="op" id="8678133">)</span>&nbsp;<span class="op" id="8678135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8678138">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8678196">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8678277">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8678281">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8678348">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678401">if</span>&nbsp;<span class="ident" id="8678404"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676694">testing</a></span><span class="op" id="8678411">.</span><span class="ident" id="8678412">Short</span><span class="op" id="8678417">(</span><span class="op" id="8678418">)</span>&nbsp;<span class="op" id="8678420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678424">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678436">f</span><span class="op" id="8678437">,</span>&nbsp;<span class="ident" id="8678439">err</span>&nbsp;<span class="op" id="8678443">:=</span>&nbsp;<span class="ident" id="8678446"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676677">os</a></span><span class="op" id="8678448">.</span><span class="ident" id="8678449">Open</span><span class="op" id="8678453">(</span><span class="string" id="8678454">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="8678479">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678482">if</span>&nbsp;<span class="ident" id="8678485"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678439">err</a></span>&nbsp;<span class="op" id="8678489">!=</span>&nbsp;<span class="ident" id="8678492">nil</span>&nbsp;<span class="op" id="8678496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678500"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678121">t</a></span><span class="op" id="8678501">.</span><span class="ident" id="8678502">Fatal</span><span class="op" id="8678507">(</span><span class="ident" id="8678508"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678439">err</a></span><span class="op" id="8678511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678518">buf</span>&nbsp;<span class="op" id="8678522">:=</span>&nbsp;<span class="ident" id="8678525"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676525">bufio</a></span><span class="op" id="8678530">.</span><span class="ident" id="8678531">NewReader</span><span class="op" id="8678540">(</span><span class="ident" id="8678541"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676534">bzip2</a></span><span class="op" id="8678546">.</span><span class="ident" id="8678547">NewReader</span><span class="op" id="8678556">(</span><span class="ident" id="8678557"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678436">f</a></span><span class="op" id="8678558">)</span><span class="op" id="8678559">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678563">lineNo</span>&nbsp;<span class="op" id="8678570">:=</span>&nbsp;<span class="num" id="8678573">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678576">var</span>&nbsp;<span class="ident" id="8678580">h</span>&nbsp;<span class="ident" id="8678582"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676651">hash</a></span><span class="op" id="8678586">.</span><span class="ident" id="8678587">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678593">var</span>&nbsp;<span class="ident" id="8678597">msg</span>&nbsp;<span class="op" id="8678601">[</span><span class="op" id="8678602">]</span><span class="builtintype" id="8678603">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678609">var</span>&nbsp;<span class="ident" id="8678613">hashed</span>&nbsp;<span class="op" id="8678620">[</span><span class="op" id="8678621">]</span><span class="builtintype" id="8678622">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678628">var</span>&nbsp;<span class="ident" id="8678632">r</span><span class="op" id="8678633">,</span>&nbsp;<span class="ident" id="8678635">s</span>&nbsp;<span class="op" id="8678637">*</span><span class="ident" id="8678638"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676665">big</a></span><span class="op" id="8678641">.</span><span class="ident" id="8678642">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678647">pub</span>&nbsp;<span class="op" id="8678651">:=</span>&nbsp;<span class="builtinfunc" id="8678654">new</span><span class="op" id="8678657">(</span><span class="ident" id="8678658"><a href="/crypto/ecdsa/ecdsa.go.html#4435283">PublicKey</a></span><span class="op" id="8678667">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678671">for</span>&nbsp;<span class="op" id="8678675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678679">line</span><span class="op" id="8678683">,</span>&nbsp;<span class="ident" id="8678685">err</span>&nbsp;<span class="op" id="8678689">:=</span>&nbsp;<span class="ident" id="8678692"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678518">buf</a></span><span class="op" id="8678695">.</span><span class="ident" id="8678696">ReadString</span><span class="op" id="8678706">(</span><span class="string" id="8678707">&#39;\n&#39;</span><span class="op" id="8678711">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678715">if</span>&nbsp;<span class="builtinfunc" id="8678718">len</span><span class="op" id="8678721">(</span><span class="ident" id="8678722"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8678726">)</span>&nbsp;<span class="op" id="8678728">==</span>&nbsp;<span class="num" id="8678731">0</span>&nbsp;<span class="op" id="8678733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678738">if</span>&nbsp;<span class="ident" id="8678741"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678685">err</a></span>&nbsp;<span class="op" id="8678745">==</span>&nbsp;<span class="ident" id="8678748"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676659">io</a></span><span class="op" id="8678750">.</span><span class="ident" id="8678751">EOF</span>&nbsp;<span class="op" id="8678755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678761">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678775"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678121">t</a></span><span class="op" id="8678776">.</span><span class="ident" id="8678777">Fatalf</span><span class="op" id="8678783">(</span><span class="string" id="8678784">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="8678814">,</span>&nbsp;<span class="ident" id="8678816"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678685">err</a></span><span class="op" id="8678819">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678827"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678563">lineNo</a></span><span class="op" id="8678833">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8678838">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678889">if</span>&nbsp;<span class="op" id="8678892">!</span><span class="ident" id="8678893"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676683">strings</a></span><span class="op" id="8678900">.</span><span class="ident" id="8678901">HasSuffix</span><span class="op" id="8678910">(</span><span class="ident" id="8678911"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8678915">,</span>&nbsp;<span class="string" id="8678917">&#34;\r\n&#34;</span><span class="op" id="8678923">)</span>&nbsp;<span class="op" id="8678925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678930"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678121">t</a></span><span class="op" id="8678931">.</span><span class="ident" id="8678932">Fatalf</span><span class="op" id="8678938">(</span><span class="string" id="8678939">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="8678985">,</span>&nbsp;<span class="ident" id="8678987"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678563">lineNo</a></span><span class="op" id="8678993">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679001"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span>&nbsp;<span class="op" id="8679006">=</span>&nbsp;<span class="ident" id="8679008"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679012">[</span><span class="op" id="8679013">:</span><span class="builtinfunc" id="8679014">len</span><span class="op" id="8679017">(</span><span class="ident" id="8679018"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679022">)</span><span class="op" id="8679023">-</span><span class="num" id="8679024">2</span><span class="op" id="8679025">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679030">if</span>&nbsp;<span class="builtinfunc" id="8679033">len</span><span class="op" id="8679036">(</span><span class="ident" id="8679037"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679041">)</span>&nbsp;<span class="op" id="8679043">==</span>&nbsp;<span class="num" id="8679046">0</span>&nbsp;<span class="op" id="8679048">||</span>&nbsp;<span class="ident" id="8679051"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679055">[</span><span class="num" id="8679056">0</span><span class="op" id="8679057">]</span>&nbsp;<span class="op" id="8679059">==</span>&nbsp;<span class="string" id="8679062">&#39;#&#39;</span>&nbsp;<span class="op" id="8679066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679071">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8679082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679087">if</span>&nbsp;<span class="ident" id="8679090"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679094">[</span><span class="num" id="8679095">0</span><span class="op" id="8679096">]</span>&nbsp;<span class="op" id="8679098">==</span>&nbsp;<span class="string" id="8679101">&#39;[&#39;</span>&nbsp;<span class="op" id="8679105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679110"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span>&nbsp;<span class="op" id="8679115">=</span>&nbsp;<span class="ident" id="8679117"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679121">[</span><span class="num" id="8679122">1</span>&nbsp;<span class="op" id="8679124">:</span>&nbsp;<span class="builtinfunc" id="8679126">len</span><span class="op" id="8679129">(</span><span class="ident" id="8679130"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679134">)</span><span class="op" id="8679135">-</span><span class="num" id="8679136">1</span><span class="op" id="8679137">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679142">parts</span>&nbsp;<span class="op" id="8679148">:=</span>&nbsp;<span class="ident" id="8679151"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676683">strings</a></span><span class="op" id="8679158">.</span><span class="ident" id="8679159">SplitN</span><span class="op" id="8679165">(</span><span class="ident" id="8679166"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679170">,</span>&nbsp;<span class="string" id="8679172">&#34;,&#34;</span><span class="op" id="8679175">,</span>&nbsp;<span class="num" id="8679177">2</span><span class="op" id="8679178">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679184">switch</span>&nbsp;<span class="ident" id="8679191"><a href="/crypto/ecdsa/ecdsa_test.go.html#8679142">parts</a></span><span class="op" id="8679196">[</span><span class="num" id="8679197">0</span><span class="op" id="8679198">]</span>&nbsp;<span class="op" id="8679200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679205">case</span>&nbsp;<span class="string" id="8679210">&#34;P-224&#34;</span><span class="op" id="8679217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679223"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678647">pub</a></span><span class="op" id="8679226">.</span><span class="ident" id="8679227">Curve</span>&nbsp;<span class="op" id="8679233">=</span>&nbsp;<span class="ident" id="8679235"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8679243">.</span><span class="ident" id="8679244">P224</span><span class="op" id="8679248">(</span><span class="op" id="8679249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679254">case</span>&nbsp;<span class="string" id="8679259">&#34;P-256&#34;</span><span class="op" id="8679266">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679272"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678647">pub</a></span><span class="op" id="8679275">.</span><span class="ident" id="8679276">Curve</span>&nbsp;<span class="op" id="8679282">=</span>&nbsp;<span class="ident" id="8679284"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8679292">.</span><span class="ident" id="8679293">P256</span><span class="op" id="8679297">(</span><span class="op" id="8679298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679303">case</span>&nbsp;<span class="string" id="8679308">&#34;P-384&#34;</span><span class="op" id="8679315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679321"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678647">pub</a></span><span class="op" id="8679324">.</span><span class="ident" id="8679325">Curve</span>&nbsp;<span class="op" id="8679331">=</span>&nbsp;<span class="ident" id="8679333"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8679341">.</span><span class="ident" id="8679342">P384</span><span class="op" id="8679346">(</span><span class="op" id="8679347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679352">case</span>&nbsp;<span class="string" id="8679357">&#34;P-521&#34;</span><span class="op" id="8679364">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679370"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678647">pub</a></span><span class="op" id="8679373">.</span><span class="ident" id="8679374">Curve</span>&nbsp;<span class="op" id="8679380">=</span>&nbsp;<span class="ident" id="8679382"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676552">elliptic</a></span><span class="op" id="8679390">.</span><span class="ident" id="8679391">P521</span><span class="op" id="8679395">(</span><span class="op" id="8679396">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679401">default</span><span class="op" id="8679408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679414"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678647">pub</a></span><span class="op" id="8679417">.</span><span class="ident" id="8679418">Curve</span>&nbsp;<span class="op" id="8679424">=</span>&nbsp;<span class="ident" id="8679426">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8679433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679439">switch</span>&nbsp;<span class="ident" id="8679446"><a href="/crypto/ecdsa/ecdsa_test.go.html#8679142">parts</a></span><span class="op" id="8679451">[</span><span class="num" id="8679452">1</span><span class="op" id="8679453">]</span>&nbsp;<span class="op" id="8679455">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679460">case</span>&nbsp;<span class="string" id="8679465">&#34;SHA-1&#34;</span><span class="op" id="8679472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679478"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678580">h</a></span>&nbsp;<span class="op" id="8679480">=</span>&nbsp;<span class="ident" id="8679482"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676586">sha1</a></span><span class="op" id="8679486">.</span><span class="ident" id="8679487">New</span><span class="op" id="8679490">(</span><span class="op" id="8679491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679496">case</span>&nbsp;<span class="string" id="8679501">&#34;SHA-224&#34;</span><span class="op" id="8679510">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679516"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678580">h</a></span>&nbsp;<span class="op" id="8679518">=</span>&nbsp;<span class="ident" id="8679520"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676601">sha256</a></span><span class="op" id="8679526">.</span><span class="ident" id="8679527">New224</span><span class="op" id="8679533">(</span><span class="op" id="8679534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679539">case</span>&nbsp;<span class="string" id="8679544">&#34;SHA-256&#34;</span><span class="op" id="8679553">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679559"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678580">h</a></span>&nbsp;<span class="op" id="8679561">=</span>&nbsp;<span class="ident" id="8679563"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676601">sha256</a></span><span class="op" id="8679569">.</span><span class="ident" id="8679570">New</span><span class="op" id="8679573">(</span><span class="op" id="8679574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679579">case</span>&nbsp;<span class="string" id="8679584">&#34;SHA-384&#34;</span><span class="op" id="8679593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679599"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678580">h</a></span>&nbsp;<span class="op" id="8679601">=</span>&nbsp;<span class="ident" id="8679603"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676618">sha512</a></span><span class="op" id="8679609">.</span><span class="ident" id="8679610">New384</span><span class="op" id="8679616">(</span><span class="op" id="8679617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679622">case</span>&nbsp;<span class="string" id="8679627">&#34;SHA-512&#34;</span><span class="op" id="8679636">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679642"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678580">h</a></span>&nbsp;<span class="op" id="8679644">=</span>&nbsp;<span class="ident" id="8679646"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676618">sha512</a></span><span class="op" id="8679652">.</span><span class="ident" id="8679653">New</span><span class="op" id="8679656">(</span><span class="op" id="8679657">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679662">default</span><span class="op" id="8679669">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679675"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678580">h</a></span>&nbsp;<span class="op" id="8679677">=</span>&nbsp;<span class="ident" id="8679679">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8679686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679692">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8679703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679708">if</span>&nbsp;<span class="ident" id="8679711"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678580">h</a></span>&nbsp;<span class="op" id="8679713">==</span>&nbsp;<span class="ident" id="8679716">nil</span>&nbsp;<span class="op" id="8679720">||</span>&nbsp;<span class="ident" id="8679723"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678647">pub</a></span><span class="op" id="8679726">.</span><span class="ident" id="8679727">Curve</span>&nbsp;<span class="op" id="8679733">==</span>&nbsp;<span class="ident" id="8679736">nil</span>&nbsp;<span class="op" id="8679740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679745">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8679756">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679761">switch</span>&nbsp;<span class="op" id="8679768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679772">case</span>&nbsp;<span class="ident" id="8679777"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676683">strings</a></span><span class="op" id="8679784">.</span><span class="ident" id="8679785">HasPrefix</span><span class="op" id="8679794">(</span><span class="ident" id="8679795"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679799">,</span>&nbsp;<span class="string" id="8679801">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="8679809">)</span><span class="op" id="8679810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679815">if</span>&nbsp;<span class="ident" id="8679818"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678597">msg</a></span><span class="op" id="8679821">,</span>&nbsp;<span class="ident" id="8679823"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678685">err</a></span>&nbsp;<span class="op" id="8679827">=</span>&nbsp;<span class="ident" id="8679829"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676635">hex</a></span><span class="op" id="8679832">.</span><span class="ident" id="8679833">DecodeString</span><span class="op" id="8679845">(</span><span class="ident" id="8679846"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679850">[</span><span class="num" id="8679851">6</span><span class="op" id="8679852">:</span><span class="op" id="8679853">]</span><span class="op" id="8679854">)</span><span class="op" id="8679855">;</span>&nbsp;<span class="ident" id="8679857"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678685">err</a></span>&nbsp;<span class="op" id="8679861">!=</span>&nbsp;<span class="ident" id="8679864">nil</span>&nbsp;<span class="op" id="8679868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679874"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678121">t</a></span><span class="op" id="8679875">.</span><span class="ident" id="8679876">Fatalf</span><span class="op" id="8679882">(</span><span class="string" id="8679883">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="8679924">,</span>&nbsp;<span class="ident" id="8679926"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678563">lineNo</a></span><span class="op" id="8679932">,</span>&nbsp;<span class="ident" id="8679934"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678685">err</a></span><span class="op" id="8679937">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8679942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679946">case</span>&nbsp;<span class="ident" id="8679951"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676683">strings</a></span><span class="op" id="8679958">.</span><span class="ident" id="8679959">HasPrefix</span><span class="op" id="8679968">(</span><span class="ident" id="8679969"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8679973">,</span>&nbsp;<span class="string" id="8679975">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="8679982">)</span><span class="op" id="8679983">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679988"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678647">pub</a></span><span class="op" id="8679991">.</span><span class="ident" id="8679992">X</span>&nbsp;<span class="op" id="8679994">=</span>&nbsp;<span class="ident" id="8679996"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677990">fromHex</a></span><span class="op" id="8680003">(</span><span class="ident" id="8680004"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8680008">[</span><span class="num" id="8680009">5</span><span class="op" id="8680010">:</span><span class="op" id="8680011">]</span><span class="op" id="8680012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8680016">case</span>&nbsp;<span class="ident" id="8680021"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676683">strings</a></span><span class="op" id="8680028">.</span><span class="ident" id="8680029">HasPrefix</span><span class="op" id="8680038">(</span><span class="ident" id="8680039"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8680043">,</span>&nbsp;<span class="string" id="8680045">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="8680052">)</span><span class="op" id="8680053">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8680058"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678647">pub</a></span><span class="op" id="8680061">.</span><span class="ident" id="8680062">Y</span>&nbsp;<span class="op" id="8680064">=</span>&nbsp;<span class="ident" id="8680066"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677990">fromHex</a></span><span class="op" id="8680073">(</span><span class="ident" id="8680074"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8680078">[</span><span class="num" id="8680079">5</span><span class="op" id="8680080">:</span><span class="op" id="8680081">]</span><span class="op" id="8680082">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8680086">case</span>&nbsp;<span class="ident" id="8680091"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676683">strings</a></span><span class="op" id="8680098">.</span><span class="ident" id="8680099">HasPrefix</span><span class="op" id="8680108">(</span><span class="ident" id="8680109"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8680113">,</span>&nbsp;<span class="string" id="8680115">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="8680121">)</span><span class="op" id="8680122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8680127"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678632">r</a></span>&nbsp;<span class="op" id="8680129">=</span>&nbsp;<span class="ident" id="8680131"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677990">fromHex</a></span><span class="op" id="8680138">(</span><span class="ident" id="8680139"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8680143">[</span><span class="num" id="8680144">4</span><span class="op" id="8680145">:</span><span class="op" id="8680146">]</span><span class="op" id="8680147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8680151">case</span>&nbsp;<span class="ident" id="8680156"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676683">strings</a></span><span class="op" id="8680163">.</span><span class="ident" id="8680164">HasPrefix</span><span class="op" id="8680173">(</span><span class="ident" id="8680174"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8680178">,</span>&nbsp;<span class="string" id="8680180">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="8680186">)</span><span class="op" id="8680187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8680192"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678635">s</a></span>&nbsp;<span class="op" id="8680194">=</span>&nbsp;<span class="ident" id="8680196"><a href="/crypto/ecdsa/ecdsa_test.go.html#8677990">fromHex</a></span><span class="op" id="8680203">(</span><span class="ident" id="8680204"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8680208">[</span><span class="num" id="8680209">4</span><span class="op" id="8680210">:</span><span class="op" id="8680211">]</span><span class="op" id="8680212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8680216">case</span>&nbsp;<span class="ident" id="8680221"><a href="/crypto/ecdsa/ecdsa_test.go.html#8676683">strings</a></span><span class="op" id="8680228">.</span><span class="ident" id="8680229">HasPrefix</span><span class="op" id="8680238">(</span><span class="ident" id="8680239"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8680243">,</span>&nbsp;<span class="string" id="8680245">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="8680256">)</span><span class="op" id="8680257">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8680262">expected</span>&nbsp;<span class="op" id="8680271">:=</span>&nbsp;<span class="ident" id="8680274"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8680278">[</span><span class="num" id="8680279">9</span><span class="op" id="8680280">]</span>&nbsp;<span class="op" id="8680282">==</span>&nbsp;<span class="string" id="8680285">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8680292"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678580">h</a></span><span class="op" id="8680293">.</span><span class="ident" id="8680294">Reset</span><span class="op" id="8680299">(</span><span class="op" id="8680300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8680305"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678580">h</a></span><span class="op" id="8680306">.</span><span class="ident" id="8680307">Write</span><span class="op" id="8680312">(</span><span class="ident" id="8680313"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678597">msg</a></span><span class="op" id="8680316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8680321">hashed</span>&nbsp;<span class="op" id="8680328">:=</span>&nbsp;<span class="ident" id="8680331"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678580">h</a></span><span class="op" id="8680332">.</span><span class="ident" id="8680333">Sum</span><span class="op" id="8680336">(</span><span class="ident" id="8680337"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678613">hashed</a></span><span class="op" id="8680343">[</span><span class="op" id="8680344">:</span><span class="num" id="8680345">0</span><span class="op" id="8680346">]</span><span class="op" id="8680347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8680352">if</span>&nbsp;<span class="ident" id="8680355"><a href="/crypto/ecdsa/ecdsa.go.html#4438993">Verify</a></span><span class="op" id="8680361">(</span><span class="ident" id="8680362"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678647">pub</a></span><span class="op" id="8680365">,</span>&nbsp;<span class="ident" id="8680367"><a href="/crypto/ecdsa/ecdsa_test.go.html#8680321">hashed</a></span><span class="op" id="8680373">,</span>&nbsp;<span class="ident" id="8680375"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678632">r</a></span><span class="op" id="8680376">,</span>&nbsp;<span class="ident" id="8680378"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678635">s</a></span><span class="op" id="8680379">)</span>&nbsp;<span class="op" id="8680381">!=</span>&nbsp;<span class="ident" id="8680384"><a href="/crypto/ecdsa/ecdsa_test.go.html#8680262">expected</a></span>&nbsp;<span class="op" id="8680393">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8680399"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678121">t</a></span><span class="op" id="8680400">.</span><span class="ident" id="8680401">Fatalf</span><span class="op" id="8680407">(</span><span class="string" id="8680408">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="8680437">,</span>&nbsp;<span class="ident" id="8680439"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678563">lineNo</a></span><span class="op" id="8680445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8680450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8680454">default</span><span class="op" id="8680461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8680466"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678121">t</a></span><span class="op" id="8680467">.</span><span class="ident" id="8680468">Fatalf</span><span class="op" id="8680474">(</span><span class="string" id="8680475">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="8680508">,</span>&nbsp;<span class="ident" id="8680510"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678563">lineNo</a></span><span class="op" id="8680516">,</span>&nbsp;<span class="ident" id="8680518"><a href="/crypto/ecdsa/ecdsa_test.go.html#8678679">line</a></span><span class="op" id="8680522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8680526">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8680529">}</span><br>
<span class="lineno"></span><span class="op" id="8680531">}</span>
</div>
</body>
</html>
