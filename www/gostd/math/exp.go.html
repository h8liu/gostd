<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html" class="current">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2288125">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2288180">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2288234">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2288285">package</span>&nbsp;<span class="ident" id="2288293">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2288299">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2288349">//</span><br>
<span class="lineno"></span><span class="comment" id="2288352">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="2288374">//&nbsp;&nbsp;&nbsp;&nbspExp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2288394">//&nbsp;&nbsp;&nbsp;&nbspExp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2288412">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="2288456">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="2288493">func</span>&nbsp;<span class="ident" id="2288498">Exp</span><span class="op" id="2288501">(</span><span class="ident" id="2288502">x</span>&nbsp;<span class="builtintype" id="2288504">float64</span><span class="op" id="2288511">)</span>&nbsp;<span class="builtintype" id="2288513">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2288522">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2288582">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="2288640">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2288699">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="2288729">//</span><br>
<span class="lineno"></span><span class="comment" id="2288732">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2288788">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2288857">//</span><br>
<span class="lineno"></span><span class="comment" id="2288860">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="2288916">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2288973">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2288990">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2289046">//</span><br>
<span class="lineno"></span><span class="comment" id="2289049">//</span><br>
<span class="lineno">30</span><span class="comment" id="2289052">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="2289062">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2289095">//</span><br>
<span class="lineno"></span><span class="comment" id="2289098">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="2289108">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="2289136">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="2289195">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2289243">//</span><br>
<span class="lineno"></span><span class="comment" id="2289246">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="2289295">//</span><br>
<span class="lineno">40</span><span class="comment" id="2289298">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2289357">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="2289375">//</span><br>
<span class="lineno"></span><span class="comment" id="2289378">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="2289444">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="2289478">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="2289492">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2289567">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2289635">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2289704">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="2289770">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2289791">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="2289861">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="2289928">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2289940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="2289992">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2290041">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2290085">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="2290132">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="2290167">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="2290204">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="2290240">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2290283">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="2290350">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2290394">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="2290408">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2290466">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="2290527">//</span><br>
<span class="lineno"></span><span class="comment" id="2290530">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="2290567">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="2290596">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="2290630">//</span><br>
<span class="lineno"></span><span class="comment" id="2290633">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2290651">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="2290693">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="2290721">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="2290774">//</span><br>
<span class="lineno"></span><span class="comment" id="2290777">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2290790">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2290860">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="2290900">//</span><br>
<span class="lineno"></span><span class="comment" id="2290903">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2290918">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="2290942">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="2291010">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="2291079">//</span><br>
<span class="lineno"></span><span class="comment" id="2291082">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2291096">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2291162">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2291226">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="2291292">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2291337">func</span>&nbsp;<span class="ident" id="2291342">exp</span><span class="op" id="2291345">(</span><span class="ident" id="2291346">x</span>&nbsp;<span class="builtintype" id="2291348">float64</span><span class="op" id="2291355">)</span>&nbsp;<span class="builtintype" id="2291357">float64</span>&nbsp;<span class="op" id="2291365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291368">const</span>&nbsp;<span class="op" id="2291374">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291378">Ln2Hi</span>&nbsp;<span class="op" id="2291384">=</span>&nbsp;<span class="num" id="2291386">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291415">Ln2Lo</span>&nbsp;<span class="op" id="2291421">=</span>&nbsp;<span class="num" id="2291423">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291452">Log2e</span>&nbsp;<span class="op" id="2291458">=</span>&nbsp;<span class="num" id="2291460">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291490">Overflow</span>&nbsp;&nbsp;<span class="op" id="2291500">=</span>&nbsp;<span class="num" id="2291502">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291531">Underflow</span>&nbsp;<span class="op" id="2291541">=</span>&nbsp;<span class="op" id="2291543">-</span><span class="num" id="2291544">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291573">NearZero</span>&nbsp;&nbsp;<span class="op" id="2291583">=</span>&nbsp;<span class="num" id="2291585">1.0</span>&nbsp;<span class="op" id="2291589">/</span>&nbsp;<span class="op" id="2291591">(</span><span class="num" id="2291592">1</span>&nbsp;<span class="op" id="2291594">&lt;&lt;</span>&nbsp;<span class="num" id="2291597">28</span><span class="op" id="2291599">)</span>&nbsp;<span class="comment" id="2291601">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291612">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2291616">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291634">switch</span>&nbsp;<span class="op" id="2291641">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291644">case</span>&nbsp;<span class="ident" id="2291649">IsNaN</span><span class="op" id="2291654">(</span><span class="ident" id="2291655">x</span><span class="op" id="2291656">)</span>&nbsp;<span class="op" id="2291658">||</span>&nbsp;<span class="ident" id="2291661">IsInf</span><span class="op" id="2291666">(</span><span class="ident" id="2291667">x</span><span class="op" id="2291668">,</span>&nbsp;<span class="num" id="2291670">1</span><span class="op" id="2291671">)</span><span class="op" id="2291672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291676">return</span>&nbsp;<span class="ident" id="2291683">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291686">case</span>&nbsp;<span class="ident" id="2291691">IsInf</span><span class="op" id="2291696">(</span><span class="ident" id="2291697">x</span><span class="op" id="2291698">,</span>&nbsp;<span class="op" id="2291700">-</span><span class="num" id="2291701">1</span><span class="op" id="2291702">)</span><span class="op" id="2291703">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291707">return</span>&nbsp;<span class="num" id="2291714">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291717">case</span>&nbsp;<span class="ident" id="2291722">x</span>&nbsp;<span class="op" id="2291724">&gt;</span>&nbsp;<span class="ident" id="2291726">Overflow</span><span class="op" id="2291734">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291738">return</span>&nbsp;<span class="ident" id="2291745">Inf</span><span class="op" id="2291748">(</span><span class="num" id="2291749">1</span><span class="op" id="2291750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291753">case</span>&nbsp;<span class="ident" id="2291758">x</span>&nbsp;<span class="op" id="2291760">&lt;</span>&nbsp;<span class="ident" id="2291762">Underflow</span><span class="op" id="2291771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291775">return</span>&nbsp;<span class="num" id="2291782">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291785">case</span>&nbsp;<span class="op" id="2291790">-</span><span class="ident" id="2291791">NearZero</span>&nbsp;<span class="op" id="2291800">&lt;</span>&nbsp;<span class="ident" id="2291802">x</span>&nbsp;<span class="op" id="2291804">&amp;&amp;</span>&nbsp;<span class="ident" id="2291807">x</span>&nbsp;<span class="op" id="2291809">&lt;</span>&nbsp;<span class="ident" id="2291811">NearZero</span><span class="op" id="2291819">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291823">return</span>&nbsp;<span class="num" id="2291830">1</span>&nbsp;<span class="op" id="2291832">+</span>&nbsp;<span class="ident" id="2291834">x</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2291841">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291898">var</span>&nbsp;<span class="ident" id="2291902">k</span>&nbsp;<span class="builtintype" id="2291904">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291909">switch</span>&nbsp;<span class="op" id="2291916">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291919">case</span>&nbsp;<span class="ident" id="2291924">x</span>&nbsp;<span class="op" id="2291926">&lt;</span>&nbsp;<span class="num" id="2291928">0</span><span class="op" id="2291929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291933">k</span>&nbsp;<span class="op" id="2291935">=</span>&nbsp;<span class="builtintype" id="2291937">int</span><span class="op" id="2291940">(</span><span class="ident" id="2291941">Log2e</span><span class="op" id="2291946">*</span><span class="ident" id="2291947">x</span>&nbsp;<span class="op" id="2291949">-</span>&nbsp;<span class="num" id="2291951">0.5</span><span class="op" id="2291954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291957">case</span>&nbsp;<span class="ident" id="2291962">x</span>&nbsp;<span class="op" id="2291964">&gt;</span>&nbsp;<span class="num" id="2291966">0</span><span class="op" id="2291967">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291971">k</span>&nbsp;<span class="op" id="2291973">=</span>&nbsp;<span class="builtintype" id="2291975">int</span><span class="op" id="2291978">(</span><span class="ident" id="2291979">Log2e</span><span class="op" id="2291984">*</span><span class="ident" id="2291985">x</span>&nbsp;<span class="op" id="2291987">+</span>&nbsp;<span class="num" id="2291989">0.5</span><span class="op" id="2291992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291995">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291998">hi</span>&nbsp;<span class="op" id="2292001">:=</span>&nbsp;<span class="ident" id="2292004">x</span>&nbsp;<span class="op" id="2292006">-</span>&nbsp;<span class="builtintype" id="2292008">float64</span><span class="op" id="2292015">(</span><span class="ident" id="2292016">k</span><span class="op" id="2292017">)</span><span class="op" id="2292018">*</span><span class="ident" id="2292019">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292026">lo</span>&nbsp;<span class="op" id="2292029">:=</span>&nbsp;<span class="builtintype" id="2292032">float64</span><span class="op" id="2292039">(</span><span class="ident" id="2292040">k</span><span class="op" id="2292041">)</span>&nbsp;<span class="op" id="2292043">*</span>&nbsp;<span class="ident" id="2292045">Ln2Lo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292053">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292065">return</span>&nbsp;<span class="ident" id="2292072">expmulti</span><span class="op" id="2292080">(</span><span class="ident" id="2292081">hi</span><span class="op" id="2292083">,</span>&nbsp;<span class="ident" id="2292085">lo</span><span class="op" id="2292087">,</span>&nbsp;<span class="ident" id="2292089">k</span><span class="op" id="2292090">)</span><br>
<span class="lineno">130</span><span class="op" id="2292092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2292095">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2292146">//</span><br>
<span class="lineno"></span><span class="comment" id="2292149">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="2292187">func</span>&nbsp;<span class="ident" id="2292192">Exp2</span><span class="op" id="2292196">(</span><span class="ident" id="2292197">x</span>&nbsp;<span class="builtintype" id="2292199">float64</span><span class="op" id="2292206">)</span>&nbsp;<span class="builtintype" id="2292208">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2292217">func</span>&nbsp;<span class="ident" id="2292222">exp2</span><span class="op" id="2292226">(</span><span class="ident" id="2292227">x</span>&nbsp;<span class="builtintype" id="2292229">float64</span><span class="op" id="2292236">)</span>&nbsp;<span class="builtintype" id="2292238">float64</span>&nbsp;<span class="op" id="2292246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292249">const</span>&nbsp;<span class="op" id="2292255">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292259">Ln2Hi</span>&nbsp;<span class="op" id="2292265">=</span>&nbsp;<span class="num" id="2292267">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292296">Ln2Lo</span>&nbsp;<span class="op" id="2292302">=</span>&nbsp;<span class="num" id="2292304">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292334">Overflow</span>&nbsp;&nbsp;<span class="op" id="2292344">=</span>&nbsp;<span class="num" id="2292346">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292371">Underflow</span>&nbsp;<span class="op" id="2292381">=</span>&nbsp;<span class="op" id="2292383">-</span><span class="num" id="2292384">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292396">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292400">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292418">switch</span>&nbsp;<span class="op" id="2292425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292428">case</span>&nbsp;<span class="ident" id="2292433">IsNaN</span><span class="op" id="2292438">(</span><span class="ident" id="2292439">x</span><span class="op" id="2292440">)</span>&nbsp;<span class="op" id="2292442">||</span>&nbsp;<span class="ident" id="2292445">IsInf</span><span class="op" id="2292450">(</span><span class="ident" id="2292451">x</span><span class="op" id="2292452">,</span>&nbsp;<span class="num" id="2292454">1</span><span class="op" id="2292455">)</span><span class="op" id="2292456">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292460">return</span>&nbsp;<span class="ident" id="2292467">x</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292470">case</span>&nbsp;<span class="ident" id="2292475">IsInf</span><span class="op" id="2292480">(</span><span class="ident" id="2292481">x</span><span class="op" id="2292482">,</span>&nbsp;<span class="op" id="2292484">-</span><span class="num" id="2292485">1</span><span class="op" id="2292486">)</span><span class="op" id="2292487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292491">return</span>&nbsp;<span class="num" id="2292498">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292501">case</span>&nbsp;<span class="ident" id="2292506">x</span>&nbsp;<span class="op" id="2292508">&gt;</span>&nbsp;<span class="ident" id="2292510">Overflow</span><span class="op" id="2292518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292522">return</span>&nbsp;<span class="ident" id="2292529">Inf</span><span class="op" id="2292532">(</span><span class="num" id="2292533">1</span><span class="op" id="2292534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292537">case</span>&nbsp;<span class="ident" id="2292542">x</span>&nbsp;<span class="op" id="2292544">&lt;</span>&nbsp;<span class="ident" id="2292546">Underflow</span><span class="op" id="2292555">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292559">return</span>&nbsp;<span class="num" id="2292566">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292573">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292636">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292685">var</span>&nbsp;<span class="ident" id="2292689">k</span>&nbsp;<span class="builtintype" id="2292691">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292696">switch</span>&nbsp;<span class="op" id="2292703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292706">case</span>&nbsp;<span class="ident" id="2292711">x</span>&nbsp;<span class="op" id="2292713">&gt;</span>&nbsp;<span class="num" id="2292715">0</span><span class="op" id="2292716">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292720">k</span>&nbsp;<span class="op" id="2292722">=</span>&nbsp;<span class="builtintype" id="2292724">int</span><span class="op" id="2292727">(</span><span class="ident" id="2292728">x</span>&nbsp;<span class="op" id="2292730">+</span>&nbsp;<span class="num" id="2292732">0.5</span><span class="op" id="2292735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292738">case</span>&nbsp;<span class="ident" id="2292743">x</span>&nbsp;<span class="op" id="2292745">&lt;</span>&nbsp;<span class="num" id="2292747">0</span><span class="op" id="2292748">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292752">k</span>&nbsp;<span class="op" id="2292754">=</span>&nbsp;<span class="builtintype" id="2292756">int</span><span class="op" id="2292759">(</span><span class="ident" id="2292760">x</span>&nbsp;<span class="op" id="2292762">-</span>&nbsp;<span class="num" id="2292764">0.5</span><span class="op" id="2292767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292773">t</span>&nbsp;<span class="op" id="2292775">:=</span>&nbsp;<span class="ident" id="2292778">x</span>&nbsp;<span class="op" id="2292780">-</span>&nbsp;<span class="builtintype" id="2292782">float64</span><span class="op" id="2292789">(</span><span class="ident" id="2292790">k</span><span class="op" id="2292791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292794">hi</span>&nbsp;<span class="op" id="2292797">:=</span>&nbsp;<span class="ident" id="2292800">t</span>&nbsp;<span class="op" id="2292802">*</span>&nbsp;<span class="ident" id="2292804">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292811">lo</span>&nbsp;<span class="op" id="2292814">:=</span>&nbsp;<span class="op" id="2292817">-</span><span class="ident" id="2292818">t</span>&nbsp;<span class="op" id="2292820">*</span>&nbsp;<span class="ident" id="2292822">Ln2Lo</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292830">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292842">return</span>&nbsp;<span class="ident" id="2292849">expmulti</span><span class="op" id="2292857">(</span><span class="ident" id="2292858">hi</span><span class="op" id="2292860">,</span>&nbsp;<span class="ident" id="2292862">lo</span><span class="op" id="2292864">,</span>&nbsp;<span class="ident" id="2292866">k</span><span class="op" id="2292867">)</span><br>
<span class="lineno"></span><span class="op" id="2292869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2292872">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="2292940">func</span>&nbsp;<span class="ident" id="2292945">expmulti</span><span class="op" id="2292953">(</span><span class="ident" id="2292954">hi</span><span class="op" id="2292956">,</span>&nbsp;<span class="ident" id="2292958">lo</span>&nbsp;<span class="builtintype" id="2292961">float64</span><span class="op" id="2292968">,</span>&nbsp;<span class="ident" id="2292970">k</span>&nbsp;<span class="builtintype" id="2292972">int</span><span class="op" id="2292975">)</span>&nbsp;<span class="builtintype" id="2292977">float64</span>&nbsp;<span class="op" id="2292985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292988">const</span>&nbsp;<span class="op" id="2292994">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292998">P1</span>&nbsp;<span class="op" id="2293001">=</span>&nbsp;<span class="num" id="2293003">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="2293031">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293062">P2</span>&nbsp;<span class="op" id="2293065">=</span>&nbsp;<span class="op" id="2293067">-</span><span class="num" id="2293068">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="2293095">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293126">P3</span>&nbsp;<span class="op" id="2293129">=</span>&nbsp;<span class="num" id="2293131">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="2293159">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293190">P4</span>&nbsp;<span class="op" id="2293193">=</span>&nbsp;<span class="op" id="2293195">-</span><span class="num" id="2293196">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="2293223">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293254">P5</span>&nbsp;<span class="op" id="2293257">=</span>&nbsp;<span class="num" id="2293259">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="2293287">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293317">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293321">r</span>&nbsp;<span class="op" id="2293323">:=</span>&nbsp;<span class="ident" id="2293326">hi</span>&nbsp;<span class="op" id="2293329">-</span>&nbsp;<span class="ident" id="2293331">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293335">t</span>&nbsp;<span class="op" id="2293337">:=</span>&nbsp;<span class="ident" id="2293340">r</span>&nbsp;<span class="op" id="2293342">*</span>&nbsp;<span class="ident" id="2293344">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293347">c</span>&nbsp;<span class="op" id="2293349">:=</span>&nbsp;<span class="ident" id="2293352">r</span>&nbsp;<span class="op" id="2293354">-</span>&nbsp;<span class="ident" id="2293356">t</span><span class="op" id="2293357">*</span><span class="op" id="2293358">(</span><span class="ident" id="2293359">P1</span><span class="op" id="2293361">+</span><span class="ident" id="2293362">t</span><span class="op" id="2293363">*</span><span class="op" id="2293364">(</span><span class="ident" id="2293365">P2</span><span class="op" id="2293367">+</span><span class="ident" id="2293368">t</span><span class="op" id="2293369">*</span><span class="op" id="2293370">(</span><span class="ident" id="2293371">P3</span><span class="op" id="2293373">+</span><span class="ident" id="2293374">t</span><span class="op" id="2293375">*</span><span class="op" id="2293376">(</span><span class="ident" id="2293377">P4</span><span class="op" id="2293379">+</span><span class="ident" id="2293380">t</span><span class="op" id="2293381">*</span><span class="ident" id="2293382">P5</span><span class="op" id="2293384">)</span><span class="op" id="2293385">)</span><span class="op" id="2293386">)</span><span class="op" id="2293387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293390">y</span>&nbsp;<span class="op" id="2293392">:=</span>&nbsp;<span class="num" id="2293395">1</span>&nbsp;<span class="op" id="2293397">-</span>&nbsp;<span class="op" id="2293399">(</span><span class="op" id="2293400">(</span><span class="ident" id="2293401">lo</span>&nbsp;<span class="op" id="2293404">-</span>&nbsp;<span class="op" id="2293406">(</span><span class="ident" id="2293407">r</span><span class="op" id="2293408">*</span><span class="ident" id="2293409">c</span><span class="op" id="2293410">)</span><span class="op" id="2293411">/</span><span class="op" id="2293412">(</span><span class="num" id="2293413">2</span><span class="op" id="2293414">-</span><span class="ident" id="2293415">c</span><span class="op" id="2293416">)</span><span class="op" id="2293417">)</span>&nbsp;<span class="op" id="2293419">-</span>&nbsp;<span class="ident" id="2293421">hi</span><span class="op" id="2293423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2293426">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293479">return</span>&nbsp;<span class="ident" id="2293486">Ldexp</span><span class="op" id="2293491">(</span><span class="ident" id="2293492">y</span><span class="op" id="2293493">,</span>&nbsp;<span class="ident" id="2293495">k</span><span class="op" id="2293496">)</span><br>
<span class="lineno"></span><span class="op" id="2293498">}</span>
</div>
</body>
</html>
