<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2318377">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2318432">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2318486">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2318537">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2318615">package</span>&nbsp;<span class="ident" id="2318623">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2318627">import</span>&nbsp;<span class="op" id="2318634">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2318637">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="2318647">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2318650">//&nbsp;The&nbsp;only&nbsp;signal&nbsp;values&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;present&nbsp;on&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span><span class="comment" id="2318716">//&nbsp;are&nbsp;Interrupt&nbsp;(send&nbsp;the&nbsp;process&nbsp;an&nbsp;interrupt)&nbsp;and&nbsp;Kill&nbsp;(force</span><br>
<span class="lineno">15</span><span class="comment" id="2318781">//&nbsp;the&nbsp;process&nbsp;to&nbsp;exit).</span><br>
<span class="lineno"></span><span class="keyword" id="2318806">var</span>&nbsp;<span class="op" id="2318810">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2318813">Interrupt</span>&nbsp;<span class="ident" id="2318823">Signal</span>&nbsp;<span class="op" id="2318830">=</span>&nbsp;<span class="ident" id="2318832">syscall</span><span class="op" id="2318839">.</span><span class="ident" id="2318840">SIGINT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2318848">Kill</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318858">Signal</span>&nbsp;<span class="op" id="2318865">=</span>&nbsp;<span class="ident" id="2318867">syscall</span><span class="op" id="2318874">.</span><span class="ident" id="2318875">SIGKILL</span><br>
<span class="lineno"></span><span class="op" id="2318883">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2318886">func</span>&nbsp;<span class="ident" id="2318891">startProcess</span><span class="op" id="2318903">(</span><span class="ident" id="2318904">name</span>&nbsp;<span class="builtintype" id="2318909">string</span><span class="op" id="2318915">,</span>&nbsp;<span class="ident" id="2318917">argv</span>&nbsp;<span class="op" id="2318922">[</span><span class="op" id="2318923">]</span><span class="builtintype" id="2318924">string</span><span class="op" id="2318930">,</span>&nbsp;<span class="ident" id="2318932">attr</span>&nbsp;<span class="op" id="2318937">*</span><span class="ident" id="2318938">ProcAttr</span><span class="op" id="2318946">)</span>&nbsp;<span class="op" id="2318948">(</span><span class="ident" id="2318949">p</span>&nbsp;<span class="op" id="2318951">*</span><span class="ident" id="2318952">Process</span><span class="op" id="2318959">,</span>&nbsp;<span class="ident" id="2318961">err</span>&nbsp;<span class="builtintype" id="2318965">error</span><span class="op" id="2318970">)</span>&nbsp;<span class="op" id="2318972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2318975">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;SysProcAttr&nbsp;(ie.&nbsp;no&nbsp;Chroot&nbsp;or&nbsp;changed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2319032">//&nbsp;UID/GID),&nbsp;double-check&nbsp;existence&nbsp;of&nbsp;the&nbsp;directory&nbsp;we&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2319094">//&nbsp;to&nbsp;chdir&nbsp;into.&nbsp;&nbsp;We&nbsp;can&nbsp;make&nbsp;the&nbsp;error&nbsp;clearer&nbsp;this&nbsp;way.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2319154">if</span>&nbsp;<span class="ident" id="2319157">attr</span>&nbsp;<span class="op" id="2319162">!=</span>&nbsp;<span class="ident" id="2319165">nil</span>&nbsp;<span class="op" id="2319169">&amp;&amp;</span>&nbsp;<span class="ident" id="2319172">attr</span><span class="op" id="2319176">.</span><span class="ident" id="2319177">Sys</span>&nbsp;<span class="op" id="2319181">==</span>&nbsp;<span class="ident" id="2319184">nil</span>&nbsp;<span class="op" id="2319188">&amp;&amp;</span>&nbsp;<span class="ident" id="2319191">attr</span><span class="op" id="2319195">.</span><span class="ident" id="2319196">Dir</span>&nbsp;<span class="op" id="2319200">!=</span>&nbsp;<span class="string" id="2319203">&#34;&#34;</span>&nbsp;<span class="op" id="2319206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2319210">if</span>&nbsp;<span class="ident" id="2319213">_</span><span class="op" id="2319214">,</span>&nbsp;<span class="ident" id="2319216">err</span>&nbsp;<span class="op" id="2319220">:=</span>&nbsp;<span class="ident" id="2319223">Stat</span><span class="op" id="2319227">(</span><span class="ident" id="2319228">attr</span><span class="op" id="2319232">.</span><span class="ident" id="2319233">Dir</span><span class="op" id="2319236">)</span><span class="op" id="2319237">;</span>&nbsp;<span class="ident" id="2319239">err</span>&nbsp;<span class="op" id="2319243">!=</span>&nbsp;<span class="ident" id="2319246">nil</span>&nbsp;<span class="op" id="2319250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319255">pe</span>&nbsp;<span class="op" id="2319258">:=</span>&nbsp;<span class="ident" id="2319261">err</span><span class="op" id="2319264">.</span><span class="op" id="2319265">(</span><span class="op" id="2319266">*</span><span class="ident" id="2319267">PathError</span><span class="op" id="2319276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319281">pe</span><span class="op" id="2319283">.</span><span class="ident" id="2319284">Op</span>&nbsp;<span class="op" id="2319287">=</span>&nbsp;<span class="string" id="2319289">&#34;chdir&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2319300">return</span>&nbsp;<span class="ident" id="2319307">nil</span><span class="op" id="2319310">,</span>&nbsp;<span class="ident" id="2319312">pe</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2319317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2319320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319324">sysattr</span>&nbsp;<span class="op" id="2319332">:=</span>&nbsp;<span class="op" id="2319335">&amp;</span><span class="ident" id="2319336">syscall</span><span class="op" id="2319343">.</span><span class="ident" id="2319344">ProcAttr</span><span class="op" id="2319352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319356">Dir</span><span class="op" id="2319359">:</span>&nbsp;<span class="ident" id="2319361">attr</span><span class="op" id="2319365">.</span><span class="ident" id="2319366">Dir</span><span class="op" id="2319369">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319373">Env</span><span class="op" id="2319376">:</span>&nbsp;<span class="ident" id="2319378">attr</span><span class="op" id="2319382">.</span><span class="ident" id="2319383">Env</span><span class="op" id="2319386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319390">Sys</span><span class="op" id="2319393">:</span>&nbsp;<span class="ident" id="2319395">attr</span><span class="op" id="2319399">.</span><span class="ident" id="2319400">Sys</span><span class="op" id="2319403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2319406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2319409">if</span>&nbsp;<span class="ident" id="2319412">sysattr</span><span class="op" id="2319419">.</span><span class="ident" id="2319420">Env</span>&nbsp;<span class="op" id="2319424">==</span>&nbsp;<span class="ident" id="2319427">nil</span>&nbsp;<span class="op" id="2319431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319435">sysattr</span><span class="op" id="2319442">.</span><span class="ident" id="2319443">Env</span>&nbsp;<span class="op" id="2319447">=</span>&nbsp;<span class="ident" id="2319449">Environ</span><span class="op" id="2319456">(</span><span class="op" id="2319457">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2319460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2319463">for</span>&nbsp;<span class="ident" id="2319467">_</span><span class="op" id="2319468">,</span>&nbsp;<span class="ident" id="2319470">f</span>&nbsp;<span class="op" id="2319472">:=</span>&nbsp;<span class="keyword" id="2319475">range</span>&nbsp;<span class="ident" id="2319481">attr</span><span class="op" id="2319485">.</span><span class="ident" id="2319486">Files</span>&nbsp;<span class="op" id="2319492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319496">sysattr</span><span class="op" id="2319503">.</span><span class="ident" id="2319504">Files</span>&nbsp;<span class="op" id="2319510">=</span>&nbsp;<span class="builtinfunc" id="2319512">append</span><span class="op" id="2319518">(</span><span class="ident" id="2319519">sysattr</span><span class="op" id="2319526">.</span><span class="ident" id="2319527">Files</span><span class="op" id="2319532">,</span>&nbsp;<span class="ident" id="2319534">f</span><span class="op" id="2319535">.</span><span class="ident" id="2319536">Fd</span><span class="op" id="2319538">(</span><span class="op" id="2319539">)</span><span class="op" id="2319540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2319543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319547">pid</span><span class="op" id="2319550">,</span>&nbsp;<span class="ident" id="2319552">h</span><span class="op" id="2319553">,</span>&nbsp;<span class="ident" id="2319555">e</span>&nbsp;<span class="op" id="2319557">:=</span>&nbsp;<span class="ident" id="2319560">syscall</span><span class="op" id="2319567">.</span><span class="ident" id="2319568">StartProcess</span><span class="op" id="2319580">(</span><span class="ident" id="2319581">name</span><span class="op" id="2319585">,</span>&nbsp;<span class="ident" id="2319587">argv</span><span class="op" id="2319591">,</span>&nbsp;<span class="ident" id="2319593">sysattr</span><span class="op" id="2319600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2319603">if</span>&nbsp;<span class="ident" id="2319606">e</span>&nbsp;<span class="op" id="2319608">!=</span>&nbsp;<span class="ident" id="2319611">nil</span>&nbsp;<span class="op" id="2319615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2319619">return</span>&nbsp;<span class="ident" id="2319626">nil</span><span class="op" id="2319629">,</span>&nbsp;<span class="op" id="2319631">&amp;</span><span class="ident" id="2319632">PathError</span><span class="op" id="2319641">{</span><span class="string" id="2319642">&#34;fork/exec&#34;</span><span class="op" id="2319653">,</span>&nbsp;<span class="ident" id="2319655">name</span><span class="op" id="2319659">,</span>&nbsp;<span class="ident" id="2319661">e</span><span class="op" id="2319662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2319665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2319668">return</span>&nbsp;<span class="ident" id="2319675">newProcess</span><span class="op" id="2319685">(</span><span class="ident" id="2319686">pid</span><span class="op" id="2319689">,</span>&nbsp;<span class="ident" id="2319691">h</span><span class="op" id="2319692">)</span><span class="op" id="2319693">,</span>&nbsp;<span class="ident" id="2319695">nil</span><br>
<span class="lineno">50</span><span class="op" id="2319699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2319702">func</span>&nbsp;<span class="op" id="2319707">(</span><span class="ident" id="2319708">p</span>&nbsp;<span class="op" id="2319710">*</span><span class="ident" id="2319711">Process</span><span class="op" id="2319718">)</span>&nbsp;<span class="ident" id="2319720">kill</span><span class="op" id="2319724">(</span><span class="op" id="2319725">)</span>&nbsp;<span class="builtintype" id="2319727">error</span>&nbsp;<span class="op" id="2319733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2319736">return</span>&nbsp;<span class="ident" id="2319743">p</span><span class="op" id="2319744">.</span><span class="ident" id="2319745">Signal</span><span class="op" id="2319751">(</span><span class="ident" id="2319752">Kill</span><span class="op" id="2319756">)</span><br>
<span class="lineno"></span><span class="op" id="2319758">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2319761">//&nbsp;ProcessState&nbsp;stores&nbsp;information&nbsp;about&nbsp;a&nbsp;process,&nbsp;as&nbsp;reported&nbsp;by&nbsp;Wait.</span><br>
<span class="lineno"></span><span class="keyword" id="2319834">type</span>&nbsp;<span class="ident" id="2319839">ProcessState</span>&nbsp;<span class="keyword" id="2319852">struct</span>&nbsp;<span class="op" id="2319859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319862">pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2319869">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2319888">//&nbsp;The&nbsp;process&#39;s&nbsp;id.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319910">status</span>&nbsp;<span class="ident" id="2319917">syscall</span><span class="op" id="2319924">.</span><span class="ident" id="2319925">WaitStatus</span>&nbsp;<span class="comment" id="2319936">//&nbsp;System-dependent&nbsp;status&nbsp;info.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2319970">rusage</span>&nbsp;<span class="op" id="2319977">*</span><span class="ident" id="2319978">syscall</span><span class="op" id="2319985">.</span><span class="ident" id="2319986">Rusage</span><br>
<span class="lineno"></span><span class="op" id="2319993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2319996">//&nbsp;Pid&nbsp;returns&nbsp;the&nbsp;process&nbsp;id&nbsp;of&nbsp;the&nbsp;exited&nbsp;process.</span><br>
<span class="lineno"></span><span class="keyword" id="2320049">func</span>&nbsp;<span class="op" id="2320054">(</span><span class="ident" id="2320055">p</span>&nbsp;<span class="op" id="2320057">*</span><span class="ident" id="2320058">ProcessState</span><span class="op" id="2320070">)</span>&nbsp;<span class="ident" id="2320072">Pid</span><span class="op" id="2320075">(</span><span class="op" id="2320076">)</span>&nbsp;<span class="builtintype" id="2320078">int</span>&nbsp;<span class="op" id="2320082">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320085">return</span>&nbsp;<span class="ident" id="2320092">p</span><span class="op" id="2320093">.</span><span class="ident" id="2320094">pid</span><br>
<span class="lineno"></span><span class="op" id="2320098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2320101">func</span>&nbsp;<span class="op" id="2320106">(</span><span class="ident" id="2320107">p</span>&nbsp;<span class="op" id="2320109">*</span><span class="ident" id="2320110">ProcessState</span><span class="op" id="2320122">)</span>&nbsp;<span class="ident" id="2320124">exited</span><span class="op" id="2320130">(</span><span class="op" id="2320131">)</span>&nbsp;<span class="builtintype" id="2320133">bool</span>&nbsp;<span class="op" id="2320138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320141">return</span>&nbsp;<span class="ident" id="2320148">p</span><span class="op" id="2320149">.</span><span class="ident" id="2320150">status</span><span class="op" id="2320156">.</span><span class="ident" id="2320157">Exited</span><span class="op" id="2320163">(</span><span class="op" id="2320164">)</span><br>
<span class="lineno">70</span><span class="op" id="2320166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2320169">func</span>&nbsp;<span class="op" id="2320174">(</span><span class="ident" id="2320175">p</span>&nbsp;<span class="op" id="2320177">*</span><span class="ident" id="2320178">ProcessState</span><span class="op" id="2320190">)</span>&nbsp;<span class="ident" id="2320192">success</span><span class="op" id="2320199">(</span><span class="op" id="2320200">)</span>&nbsp;<span class="builtintype" id="2320202">bool</span>&nbsp;<span class="op" id="2320207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320210">return</span>&nbsp;<span class="ident" id="2320217">p</span><span class="op" id="2320218">.</span><span class="ident" id="2320219">status</span><span class="op" id="2320225">.</span><span class="ident" id="2320226">ExitStatus</span><span class="op" id="2320236">(</span><span class="op" id="2320237">)</span>&nbsp;<span class="op" id="2320239">==</span>&nbsp;<span class="num" id="2320242">0</span><br>
<span class="lineno"></span><span class="op" id="2320244">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="2320247">func</span>&nbsp;<span class="op" id="2320252">(</span><span class="ident" id="2320253">p</span>&nbsp;<span class="op" id="2320255">*</span><span class="ident" id="2320256">ProcessState</span><span class="op" id="2320268">)</span>&nbsp;<span class="ident" id="2320270">sys</span><span class="op" id="2320273">(</span><span class="op" id="2320274">)</span>&nbsp;<span class="keyword" id="2320276">interface</span><span class="op" id="2320285">{</span><span class="op" id="2320286">}</span>&nbsp;<span class="op" id="2320288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320291">return</span>&nbsp;<span class="ident" id="2320298">p</span><span class="op" id="2320299">.</span><span class="ident" id="2320300">status</span><br>
<span class="lineno"></span><span class="op" id="2320307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="2320310">func</span>&nbsp;<span class="op" id="2320315">(</span><span class="ident" id="2320316">p</span>&nbsp;<span class="op" id="2320318">*</span><span class="ident" id="2320319">ProcessState</span><span class="op" id="2320331">)</span>&nbsp;<span class="ident" id="2320333">sysUsage</span><span class="op" id="2320341">(</span><span class="op" id="2320342">)</span>&nbsp;<span class="keyword" id="2320344">interface</span><span class="op" id="2320353">{</span><span class="op" id="2320354">}</span>&nbsp;<span class="op" id="2320356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320359">return</span>&nbsp;<span class="ident" id="2320366">p</span><span class="op" id="2320367">.</span><span class="ident" id="2320368">rusage</span><br>
<span class="lineno"></span><span class="op" id="2320375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2320378">//&nbsp;Convert&nbsp;i&nbsp;to&nbsp;decimal&nbsp;string.</span><br>
<span class="lineno">85</span><span class="keyword" id="2320410">func</span>&nbsp;<span class="ident" id="2320415">itod</span><span class="op" id="2320419">(</span><span class="ident" id="2320420">i</span>&nbsp;<span class="builtintype" id="2320422">int</span><span class="op" id="2320425">)</span>&nbsp;<span class="builtintype" id="2320427">string</span>&nbsp;<span class="op" id="2320434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320437">if</span>&nbsp;<span class="ident" id="2320440">i</span>&nbsp;<span class="op" id="2320442">==</span>&nbsp;<span class="num" id="2320445">0</span>&nbsp;<span class="op" id="2320447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320451">return</span>&nbsp;<span class="string" id="2320458">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2320463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320467">u</span>&nbsp;<span class="op" id="2320469">:=</span>&nbsp;<span class="ident" id="2320472">uint64</span><span class="op" id="2320478">(</span><span class="ident" id="2320479">i</span><span class="op" id="2320480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320483">if</span>&nbsp;<span class="ident" id="2320486">i</span>&nbsp;<span class="op" id="2320488">&lt;</span>&nbsp;<span class="num" id="2320490">0</span>&nbsp;<span class="op" id="2320492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320496">u</span>&nbsp;<span class="op" id="2320498">=</span>&nbsp;<span class="op" id="2320500">-</span><span class="ident" id="2320501">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2320504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2320508">//&nbsp;Assemble&nbsp;decimal&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320547">var</span>&nbsp;<span class="ident" id="2320551">b</span>&nbsp;<span class="op" id="2320553">[</span><span class="num" id="2320554">32</span><span class="op" id="2320556">]</span><span class="builtintype" id="2320557">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320563">bp</span>&nbsp;<span class="op" id="2320566">:=</span>&nbsp;<span class="builtinfunc" id="2320569">len</span><span class="op" id="2320572">(</span><span class="ident" id="2320573">b</span><span class="op" id="2320574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320577">for</span>&nbsp;<span class="op" id="2320581">;</span>&nbsp;<span class="ident" id="2320583">u</span>&nbsp;<span class="op" id="2320585">&gt;</span>&nbsp;<span class="num" id="2320587">0</span><span class="op" id="2320588">;</span>&nbsp;<span class="ident" id="2320590">u</span>&nbsp;<span class="op" id="2320592">/=</span>&nbsp;<span class="num" id="2320595">10</span>&nbsp;<span class="op" id="2320598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320602">bp</span><span class="op" id="2320604">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320609">b</span><span class="op" id="2320610">[</span><span class="ident" id="2320611">bp</span><span class="op" id="2320613">]</span>&nbsp;<span class="op" id="2320615">=</span>&nbsp;<span class="builtintype" id="2320617">byte</span><span class="op" id="2320621">(</span><span class="ident" id="2320622">u</span><span class="op" id="2320623">%</span><span class="num" id="2320624">10</span><span class="op" id="2320626">)</span>&nbsp;<span class="op" id="2320628">+</span>&nbsp;<span class="string" id="2320630">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2320635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320639">if</span>&nbsp;<span class="ident" id="2320642">i</span>&nbsp;<span class="op" id="2320644">&lt;</span>&nbsp;<span class="num" id="2320646">0</span>&nbsp;<span class="op" id="2320648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320652">bp</span><span class="op" id="2320654">--</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320659">b</span><span class="op" id="2320660">[</span><span class="ident" id="2320661">bp</span><span class="op" id="2320663">]</span>&nbsp;<span class="op" id="2320665">=</span>&nbsp;<span class="string" id="2320667">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2320672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320676">return</span>&nbsp;<span class="builtintype" id="2320683">string</span><span class="op" id="2320689">(</span><span class="ident" id="2320690">b</span><span class="op" id="2320691">[</span><span class="ident" id="2320692">bp</span><span class="op" id="2320694">:</span><span class="op" id="2320695">]</span><span class="op" id="2320696">)</span><br>
<span class="lineno"></span><span class="op" id="2320698">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="2320701">func</span>&nbsp;<span class="op" id="2320706">(</span><span class="ident" id="2320707">p</span>&nbsp;<span class="op" id="2320709">*</span><span class="ident" id="2320710">ProcessState</span><span class="op" id="2320722">)</span>&nbsp;<span class="ident" id="2320724">String</span><span class="op" id="2320730">(</span><span class="op" id="2320731">)</span>&nbsp;<span class="builtintype" id="2320733">string</span>&nbsp;<span class="op" id="2320740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320743">if</span>&nbsp;<span class="ident" id="2320746">p</span>&nbsp;<span class="op" id="2320748">==</span>&nbsp;<span class="ident" id="2320751">nil</span>&nbsp;<span class="op" id="2320755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320759">return</span>&nbsp;<span class="string" id="2320766">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2320775">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320778">status</span>&nbsp;<span class="op" id="2320785">:=</span>&nbsp;<span class="ident" id="2320788">p</span><span class="op" id="2320789">.</span><span class="ident" id="2320790">Sys</span><span class="op" id="2320793">(</span><span class="op" id="2320794">)</span><span class="op" id="2320795">.</span><span class="op" id="2320796">(</span><span class="ident" id="2320797">syscall</span><span class="op" id="2320804">.</span><span class="ident" id="2320805">WaitStatus</span><span class="op" id="2320815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320818">res</span>&nbsp;<span class="op" id="2320822">:=</span>&nbsp;<span class="string" id="2320825">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320829">switch</span>&nbsp;<span class="op" id="2320836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320839">case</span>&nbsp;<span class="ident" id="2320844">status</span><span class="op" id="2320850">.</span><span class="ident" id="2320851">Exited</span><span class="op" id="2320857">(</span><span class="op" id="2320858">)</span><span class="op" id="2320859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320863">res</span>&nbsp;<span class="op" id="2320867">=</span>&nbsp;<span class="string" id="2320869">&#34;exit&nbsp;status&nbsp;&#34;</span>&nbsp;<span class="op" id="2320884">+</span>&nbsp;<span class="ident" id="2320886">itod</span><span class="op" id="2320890">(</span><span class="ident" id="2320891">status</span><span class="op" id="2320897">.</span><span class="ident" id="2320898">ExitStatus</span><span class="op" id="2320908">(</span><span class="op" id="2320909">)</span><span class="op" id="2320910">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320913">case</span>&nbsp;<span class="ident" id="2320918">status</span><span class="op" id="2320924">.</span><span class="ident" id="2320925">Signaled</span><span class="op" id="2320933">(</span><span class="op" id="2320934">)</span><span class="op" id="2320935">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320939">res</span>&nbsp;<span class="op" id="2320943">=</span>&nbsp;<span class="string" id="2320945">&#34;signal:&nbsp;&#34;</span>&nbsp;<span class="op" id="2320956">+</span>&nbsp;<span class="ident" id="2320958">status</span><span class="op" id="2320964">.</span><span class="ident" id="2320965">Signal</span><span class="op" id="2320971">(</span><span class="op" id="2320972">)</span><span class="op" id="2320973">.</span><span class="ident" id="2320974">String</span><span class="op" id="2320980">(</span><span class="op" id="2320981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320984">case</span>&nbsp;<span class="ident" id="2320989">status</span><span class="op" id="2320995">.</span><span class="ident" id="2320996">Stopped</span><span class="op" id="2321003">(</span><span class="op" id="2321004">)</span><span class="op" id="2321005">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321009">res</span>&nbsp;<span class="op" id="2321013">=</span>&nbsp;<span class="string" id="2321015">&#34;stop&nbsp;signal:&nbsp;&#34;</span>&nbsp;<span class="op" id="2321031">+</span>&nbsp;<span class="ident" id="2321033">status</span><span class="op" id="2321039">.</span><span class="ident" id="2321040">StopSignal</span><span class="op" id="2321050">(</span><span class="op" id="2321051">)</span><span class="op" id="2321052">.</span><span class="ident" id="2321053">String</span><span class="op" id="2321059">(</span><span class="op" id="2321060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321064">if</span>&nbsp;<span class="ident" id="2321067">status</span><span class="op" id="2321073">.</span><span class="ident" id="2321074">StopSignal</span><span class="op" id="2321084">(</span><span class="op" id="2321085">)</span>&nbsp;<span class="op" id="2321087">==</span>&nbsp;<span class="ident" id="2321090">syscall</span><span class="op" id="2321097">.</span><span class="ident" id="2321098">SIGTRAP</span>&nbsp;<span class="op" id="2321106">&amp;&amp;</span>&nbsp;<span class="ident" id="2321109">status</span><span class="op" id="2321115">.</span><span class="ident" id="2321116">TrapCause</span><span class="op" id="2321125">(</span><span class="op" id="2321126">)</span>&nbsp;<span class="op" id="2321128">!=</span>&nbsp;<span class="num" id="2321131">0</span>&nbsp;<span class="op" id="2321133">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321138">res</span>&nbsp;<span class="op" id="2321142">+=</span>&nbsp;<span class="string" id="2321145">&#34;&nbsp;(trap&nbsp;&#34;</span>&nbsp;<span class="op" id="2321155">+</span>&nbsp;<span class="ident" id="2321157">itod</span><span class="op" id="2321161">(</span><span class="ident" id="2321162">status</span><span class="op" id="2321168">.</span><span class="ident" id="2321169">TrapCause</span><span class="op" id="2321178">(</span><span class="op" id="2321179">)</span><span class="op" id="2321180">)</span>&nbsp;<span class="op" id="2321182">+</span>&nbsp;<span class="string" id="2321184">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321193">case</span>&nbsp;<span class="ident" id="2321198">status</span><span class="op" id="2321204">.</span><span class="ident" id="2321205">Continued</span><span class="op" id="2321214">(</span><span class="op" id="2321215">)</span><span class="op" id="2321216">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321220">res</span>&nbsp;<span class="op" id="2321224">=</span>&nbsp;<span class="string" id="2321226">&#34;continued&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321239">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321242">if</span>&nbsp;<span class="ident" id="2321245">status</span><span class="op" id="2321251">.</span><span class="ident" id="2321252">CoreDump</span><span class="op" id="2321260">(</span><span class="op" id="2321261">)</span>&nbsp;<span class="op" id="2321263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321267">res</span>&nbsp;<span class="op" id="2321271">+=</span>&nbsp;<span class="string" id="2321274">&#34;&nbsp;(core&nbsp;dumped)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321295">return</span>&nbsp;<span class="ident" id="2321302">res</span><br>
<span class="lineno"></span><span class="op" id="2321306">}</span>
</div>
</body>
</html>
