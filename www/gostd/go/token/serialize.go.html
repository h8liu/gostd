<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/token</h2>
<ul>
<li><a href="/gostd/go/token/position.go.html">position.go</a></li>
<li><a href="/gostd/go/token/position_test.go.html">position_test.go</a></li>
<li><a href="/gostd/go/token/serialize.go.html" class="current">serialize.go</a></li>
<li><a href="/gostd/go/token/serialize_test.go.html">serialize_test.go</a></li>
<li><a href="/gostd/go/token/token.go.html">token.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4807176">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4807231">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4807285">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4807336">package</span>&nbsp;<span class="ident" id="4807344">token</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4807351">type</span>&nbsp;<span class="ident" id="4807356">serializedFile</span>&nbsp;<span class="keyword" id="4807371">struct</span>&nbsp;<span class="op" id="4807378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4807381">//&nbsp;fields&nbsp;correspond&nbsp;1:1&nbsp;to&nbsp;fields&nbsp;with&nbsp;same&nbsp;(lower-case)&nbsp;name&nbsp;in&nbsp;File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807453">Name</span>&nbsp;&nbsp;<span class="builtintype" id="4807459">string</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807467">Base</span>&nbsp;&nbsp;<span class="builtintype" id="4807473">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807478">Size</span>&nbsp;&nbsp;<span class="builtintype" id="4807484">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807489">Lines</span>&nbsp;<span class="op" id="4807495">[</span><span class="op" id="4807496">]</span><span class="builtintype" id="4807497">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807502">Infos</span>&nbsp;<span class="op" id="4807508">[</span><span class="op" id="4807509">]</span><span class="ident" id="4807510">lineInfo</span><br>
<span class="lineno"></span><span class="op" id="4807519">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4807522">type</span>&nbsp;<span class="ident" id="4807527">serializedFileSet</span>&nbsp;<span class="keyword" id="4807545">struct</span>&nbsp;<span class="op" id="4807552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807555">Base</span>&nbsp;&nbsp;<span class="builtintype" id="4807561">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807566">Files</span>&nbsp;<span class="op" id="4807572">[</span><span class="op" id="4807573">]</span><span class="ident" id="4807574">serializedFile</span><br>
<span class="lineno"></span><span class="op" id="4807589">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4807592">//&nbsp;Read&nbsp;calls&nbsp;decode&nbsp;to&nbsp;deserialize&nbsp;a&nbsp;file&nbsp;set&nbsp;into&nbsp;s;&nbsp;s&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4807666">func</span>&nbsp;<span class="op" id="4807671">(</span><span class="ident" id="4807672">s</span>&nbsp;<span class="op" id="4807674">*</span><span class="ident" id="4807675">FileSet</span><span class="op" id="4807682">)</span>&nbsp;<span class="ident" id="4807684">Read</span><span class="op" id="4807688">(</span><span class="ident" id="4807689">decode</span>&nbsp;<span class="keyword" id="4807696">func</span><span class="op" id="4807700">(</span><span class="keyword" id="4807701">interface</span><span class="op" id="4807710">{</span><span class="op" id="4807711">}</span><span class="op" id="4807712">)</span>&nbsp;<span class="builtintype" id="4807714">error</span><span class="op" id="4807719">)</span>&nbsp;<span class="builtintype" id="4807721">error</span>&nbsp;<span class="op" id="4807727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4807730">var</span>&nbsp;<span class="ident" id="4807734">ss</span>&nbsp;<span class="ident" id="4807737">serializedFileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4807756">if</span>&nbsp;<span class="ident" id="4807759">err</span>&nbsp;<span class="op" id="4807763">:=</span>&nbsp;<span class="ident" id="4807766">decode</span><span class="op" id="4807772">(</span><span class="op" id="4807773">&amp;</span><span class="ident" id="4807774">ss</span><span class="op" id="4807776">)</span><span class="op" id="4807777">;</span>&nbsp;<span class="ident" id="4807779">err</span>&nbsp;<span class="op" id="4807783">!=</span>&nbsp;<span class="builtintype" id="4807786">nil</span>&nbsp;<span class="op" id="4807790">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4807794">return</span>&nbsp;<span class="ident" id="4807801">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4807806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807810">s</span><span class="op" id="4807811">.</span><span class="ident" id="4807812">mutex</span><span class="op" id="4807817">.</span><span class="ident" id="4807818">Lock</span><span class="op" id="4807822">(</span><span class="op" id="4807823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807826">s</span><span class="op" id="4807827">.</span><span class="ident" id="4807828">base</span>&nbsp;<span class="op" id="4807833">=</span>&nbsp;<span class="ident" id="4807835">ss</span><span class="op" id="4807837">.</span><span class="ident" id="4807838">Base</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807844">files</span>&nbsp;<span class="op" id="4807850">:=</span>&nbsp;<span class="builtinfunc" id="4807853">make</span><span class="op" id="4807857">(</span><span class="op" id="4807858">[</span><span class="op" id="4807859">]</span><span class="op" id="4807860">*</span><span class="ident" id="4807861">File</span><span class="op" id="4807865">,</span>&nbsp;<span class="builtinfunc" id="4807867">len</span><span class="op" id="4807870">(</span><span class="ident" id="4807871">ss</span><span class="op" id="4807873">.</span><span class="ident" id="4807874">Files</span><span class="op" id="4807879">)</span><span class="op" id="4807880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4807883">for</span>&nbsp;<span class="ident" id="4807887">i</span>&nbsp;<span class="op" id="4807889">:=</span>&nbsp;<span class="num" id="4807892">0</span><span class="op" id="4807893">;</span>&nbsp;<span class="ident" id="4807895">i</span>&nbsp;<span class="op" id="4807897">&lt;</span>&nbsp;<span class="builtinfunc" id="4807899">len</span><span class="op" id="4807902">(</span><span class="ident" id="4807903">ss</span><span class="op" id="4807905">.</span><span class="ident" id="4807906">Files</span><span class="op" id="4807911">)</span><span class="op" id="4807912">;</span>&nbsp;<span class="ident" id="4807914">i</span><span class="op" id="4807915">++</span>&nbsp;<span class="op" id="4807918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807922">f</span>&nbsp;<span class="op" id="4807924">:=</span>&nbsp;<span class="op" id="4807927">&amp;</span><span class="ident" id="4807928">ss</span><span class="op" id="4807930">.</span><span class="ident" id="4807931">Files</span><span class="op" id="4807936">[</span><span class="ident" id="4807937">i</span><span class="op" id="4807938">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807942">files</span><span class="op" id="4807947">[</span><span class="ident" id="4807948">i</span><span class="op" id="4807949">]</span>&nbsp;<span class="op" id="4807951">=</span>&nbsp;<span class="op" id="4807953">&amp;</span><span class="ident" id="4807954">File</span><span class="op" id="4807958">{</span><span class="ident" id="4807959">s</span><span class="op" id="4807960">,</span>&nbsp;<span class="ident" id="4807962">f</span><span class="op" id="4807963">.</span><span class="ident" id="4807964">Name</span><span class="op" id="4807968">,</span>&nbsp;<span class="ident" id="4807970">f</span><span class="op" id="4807971">.</span><span class="ident" id="4807972">Base</span><span class="op" id="4807976">,</span>&nbsp;<span class="ident" id="4807978">f</span><span class="op" id="4807979">.</span><span class="ident" id="4807980">Size</span><span class="op" id="4807984">,</span>&nbsp;<span class="ident" id="4807986">f</span><span class="op" id="4807987">.</span><span class="ident" id="4807988">Lines</span><span class="op" id="4807993">,</span>&nbsp;<span class="ident" id="4807995">f</span><span class="op" id="4807996">.</span><span class="ident" id="4807997">Infos</span><span class="op" id="4808002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4808005">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4808008">s</span><span class="op" id="4808009">.</span><span class="ident" id="4808010">files</span>&nbsp;<span class="op" id="4808016">=</span>&nbsp;<span class="ident" id="4808018">files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4808025">s</span><span class="op" id="4808026">.</span><span class="ident" id="4808027">last</span>&nbsp;<span class="op" id="4808032">=</span>&nbsp;<span class="builtintype" id="4808034">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4808039">s</span><span class="op" id="4808040">.</span><span class="ident" id="4808041">mutex</span><span class="op" id="4808046">.</span><span class="ident" id="4808047">Unlock</span><span class="op" id="4808053">(</span><span class="op" id="4808054">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4808058">return</span>&nbsp;<span class="builtintype" id="4808065">nil</span><br>
<span class="lineno">40</span><span class="op" id="4808069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4808072">//&nbsp;Write&nbsp;calls&nbsp;encode&nbsp;to&nbsp;serialize&nbsp;the&nbsp;file&nbsp;set&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4808123">func</span>&nbsp;<span class="op" id="4808128">(</span><span class="ident" id="4808129">s</span>&nbsp;<span class="op" id="4808131">*</span><span class="ident" id="4808132">FileSet</span><span class="op" id="4808139">)</span>&nbsp;<span class="ident" id="4808141">Write</span><span class="op" id="4808146">(</span><span class="ident" id="4808147">encode</span>&nbsp;<span class="keyword" id="4808154">func</span><span class="op" id="4808158">(</span><span class="keyword" id="4808159">interface</span><span class="op" id="4808168">{</span><span class="op" id="4808169">}</span><span class="op" id="4808170">)</span>&nbsp;<span class="builtintype" id="4808172">error</span><span class="op" id="4808177">)</span>&nbsp;<span class="builtintype" id="4808179">error</span>&nbsp;<span class="op" id="4808185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4808188">var</span>&nbsp;<span class="ident" id="4808192">ss</span>&nbsp;<span class="ident" id="4808195">serializedFileSet</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4808215">s</span><span class="op" id="4808216">.</span><span class="ident" id="4808217">mutex</span><span class="op" id="4808222">.</span><span class="ident" id="4808223">Lock</span><span class="op" id="4808227">(</span><span class="op" id="4808228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4808231">ss</span><span class="op" id="4808233">.</span><span class="ident" id="4808234">Base</span>&nbsp;<span class="op" id="4808239">=</span>&nbsp;<span class="ident" id="4808241">s</span><span class="op" id="4808242">.</span><span class="ident" id="4808243">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4808249">files</span>&nbsp;<span class="op" id="4808255">:=</span>&nbsp;<span class="builtinfunc" id="4808258">make</span><span class="op" id="4808262">(</span><span class="op" id="4808263">[</span><span class="op" id="4808264">]</span><span class="ident" id="4808265">serializedFile</span><span class="op" id="4808279">,</span>&nbsp;<span class="builtinfunc" id="4808281">len</span><span class="op" id="4808284">(</span><span class="ident" id="4808285">s</span><span class="op" id="4808286">.</span><span class="ident" id="4808287">files</span><span class="op" id="4808292">)</span><span class="op" id="4808293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4808296">for</span>&nbsp;<span class="ident" id="4808300">i</span><span class="op" id="4808301">,</span>&nbsp;<span class="ident" id="4808303">f</span>&nbsp;<span class="op" id="4808305">:=</span>&nbsp;<span class="keyword" id="4808308">range</span>&nbsp;<span class="ident" id="4808314">s</span><span class="op" id="4808315">.</span><span class="ident" id="4808316">files</span>&nbsp;<span class="op" id="4808322">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4808326">files</span><span class="op" id="4808331">[</span><span class="ident" id="4808332">i</span><span class="op" id="4808333">]</span>&nbsp;<span class="op" id="4808335">=</span>&nbsp;<span class="ident" id="4808337">serializedFile</span><span class="op" id="4808351">{</span><span class="ident" id="4808352">f</span><span class="op" id="4808353">.</span><span class="ident" id="4808354">name</span><span class="op" id="4808358">,</span>&nbsp;<span class="ident" id="4808360">f</span><span class="op" id="4808361">.</span><span class="ident" id="4808362">base</span><span class="op" id="4808366">,</span>&nbsp;<span class="ident" id="4808368">f</span><span class="op" id="4808369">.</span><span class="ident" id="4808370">size</span><span class="op" id="4808374">,</span>&nbsp;<span class="ident" id="4808376">f</span><span class="op" id="4808377">.</span><span class="ident" id="4808378">lines</span><span class="op" id="4808383">,</span>&nbsp;<span class="ident" id="4808385">f</span><span class="op" id="4808386">.</span><span class="ident" id="4808387">infos</span><span class="op" id="4808392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4808395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4808398">ss</span><span class="op" id="4808400">.</span><span class="ident" id="4808401">Files</span>&nbsp;<span class="op" id="4808407">=</span>&nbsp;<span class="ident" id="4808409">files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4808416">s</span><span class="op" id="4808417">.</span><span class="ident" id="4808418">mutex</span><span class="op" id="4808423">.</span><span class="ident" id="4808424">Unlock</span><span class="op" id="4808430">(</span><span class="op" id="4808431">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4808435">return</span>&nbsp;<span class="ident" id="4808442">encode</span><span class="op" id="4808448">(</span><span class="ident" id="4808449">ss</span><span class="op" id="4808451">)</span><br>
<span class="lineno"></span><span class="op" id="4808453">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
