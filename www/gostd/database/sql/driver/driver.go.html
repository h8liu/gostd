<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>database/sql/driver</h2>
<ul>
<li><a href="/gostd/database/sql/driver/driver.go.html" class="current">driver.go</a></li>
<li><a href="/gostd/database/sql/driver/types.go.html">types.go</a></li>
<li><a href="/gostd/database/sql/driver/types_test.go.html">types_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5847751">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5847806">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5847860">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5847911">//&nbsp;Package&nbsp;driver&nbsp;defines&nbsp;interfaces&nbsp;to&nbsp;be&nbsp;implemented&nbsp;by&nbsp;database</span><br>
<span class="lineno"></span><span class="comment" id="5847978">//&nbsp;drivers&nbsp;as&nbsp;used&nbsp;by&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="comment" id="5848013">//</span><br>
<span class="lineno"></span><span class="comment" id="5848016">//&nbsp;Most&nbsp;code&nbsp;should&nbsp;use&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="keyword" id="5848053">package</span>&nbsp;<span class="ident" id="5848061">driver</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5848069">import</span>&nbsp;<span class="string" id="5848076">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5848086">//&nbsp;Value&nbsp;is&nbsp;a&nbsp;value&nbsp;that&nbsp;drivers&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.</span><br>
<span class="lineno"></span><span class="comment" id="5848143">//&nbsp;It&nbsp;is&nbsp;either&nbsp;nil&nbsp;or&nbsp;an&nbsp;instance&nbsp;of&nbsp;one&nbsp;of&nbsp;these&nbsp;types:</span><br>
<span class="lineno">15</span><span class="comment" id="5848201">//</span><br>
<span class="lineno"></span><span class="comment" id="5848204">//&nbsp;&nbsp;&nbsp;int64</span><br>
<span class="lineno"></span><span class="comment" id="5848215">//&nbsp;&nbsp;&nbsp;float64</span><br>
<span class="lineno"></span><span class="comment" id="5848228">//&nbsp;&nbsp;&nbsp;bool</span><br>
<span class="lineno"></span><span class="comment" id="5848238">//&nbsp;&nbsp;&nbsp;[]byte</span><br>
<span class="lineno">20</span><span class="comment" id="5848250">//&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;[*]&nbsp;everywhere&nbsp;except&nbsp;from&nbsp;Rows.Next.</span><br>
<span class="lineno"></span><span class="comment" id="5848302">//&nbsp;&nbsp;&nbsp;time.Time</span><br>
<span class="lineno"></span><span class="keyword" id="5848317">type</span>&nbsp;<span class="ident" id="5848322">Value</span>&nbsp;<span class="keyword" id="5848328">interface</span><span class="op" id="5848337">{</span><span class="op" id="5848338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5848341">//&nbsp;Driver&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;must&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;database</span><br>
<span class="lineno">25</span><span class="comment" id="5848407">//&nbsp;driver.</span><br>
<span class="lineno"></span><span class="keyword" id="5848418">type</span>&nbsp;<span class="ident" id="5848423">Driver</span>&nbsp;<span class="keyword" id="5848430">interface</span>&nbsp;<span class="op" id="5848440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848443">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;connection&nbsp;to&nbsp;the&nbsp;database.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848494">//&nbsp;The&nbsp;name&nbsp;is&nbsp;a&nbsp;string&nbsp;in&nbsp;a&nbsp;driver-specific&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848548">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848552">//&nbsp;Open&nbsp;may&nbsp;return&nbsp;a&nbsp;cached&nbsp;connection&nbsp;(one&nbsp;previously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848608">//&nbsp;closed),&nbsp;but&nbsp;doing&nbsp;so&nbsp;is&nbsp;unnecessary;&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848666">//&nbsp;maintains&nbsp;a&nbsp;pool&nbsp;of&nbsp;idle&nbsp;connections&nbsp;for&nbsp;efficient&nbsp;re-use.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848729">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848733">//&nbsp;The&nbsp;returned&nbsp;connection&nbsp;is&nbsp;only&nbsp;used&nbsp;by&nbsp;one&nbsp;goroutine&nbsp;at&nbsp;a</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5848796">//&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5848806">Open</span><span class="op" id="5848810">(</span><span class="ident" id="5848811">name</span>&nbsp;<span class="builtintype" id="5848816">string</span><span class="op" id="5848822">)</span>&nbsp;<span class="op" id="5848824">(</span><span class="ident" id="5848825">Conn</span><span class="op" id="5848829">,</span>&nbsp;<span class="builtintype" id="5848831">error</span><span class="op" id="5848836">)</span><br>
<span class="lineno"></span><span class="op" id="5848838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5848841">//&nbsp;ErrSkip&nbsp;may&nbsp;be&nbsp;returned&nbsp;by&nbsp;some&nbsp;optional&nbsp;interfaces&#39;&nbsp;methods&nbsp;to</span><br>
<span class="lineno">40</span><span class="comment" id="5848908">//&nbsp;indicate&nbsp;at&nbsp;runtime&nbsp;that&nbsp;the&nbsp;fast&nbsp;path&nbsp;is&nbsp;unavailable&nbsp;and&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5848977">//&nbsp;package&nbsp;should&nbsp;continue&nbsp;as&nbsp;if&nbsp;the&nbsp;optional&nbsp;interface&nbsp;was&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5849041">//&nbsp;implemented.&nbsp;ErrSkip&nbsp;is&nbsp;only&nbsp;supported&nbsp;where&nbsp;explicitly</span><br>
<span class="lineno"></span><span class="comment" id="5849100">//&nbsp;documented.</span><br>
<span class="lineno"></span><span class="keyword" id="5849115">var</span>&nbsp;<span class="ident" id="5849119">ErrSkip</span>&nbsp;<span class="op" id="5849127">=</span>&nbsp;<span class="ident" id="5849129">errors</span><span class="op" id="5849135">.</span><span class="ident" id="5849136">New</span><span class="op" id="5849139">(</span><span class="string" id="5849140">&#34;driver:&nbsp;skip&nbsp;fast-path;&nbsp;continue&nbsp;as&nbsp;if&nbsp;unimplemented&#34;</span><span class="op" id="5849194">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5849197">//&nbsp;ErrBadConn&nbsp;should&nbsp;be&nbsp;returned&nbsp;by&nbsp;a&nbsp;driver&nbsp;to&nbsp;signal&nbsp;to&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5849263">//&nbsp;package&nbsp;that&nbsp;a&nbsp;driver.Conn&nbsp;is&nbsp;in&nbsp;a&nbsp;bad&nbsp;state&nbsp;(such&nbsp;as&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="5849331">//&nbsp;having&nbsp;earlier&nbsp;closed&nbsp;the&nbsp;connection)&nbsp;and&nbsp;the&nbsp;sql&nbsp;package&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="5849399">//&nbsp;retry&nbsp;on&nbsp;a&nbsp;new&nbsp;connection.</span><br>
<span class="lineno">50</span><span class="comment" id="5849429">//</span><br>
<span class="lineno"></span><span class="comment" id="5849432">//&nbsp;To&nbsp;prevent&nbsp;duplicate&nbsp;operations,&nbsp;ErrBadConn&nbsp;should&nbsp;NOT&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="5849502">//&nbsp;if&nbsp;there&#39;s&nbsp;a&nbsp;possibility&nbsp;that&nbsp;the&nbsp;database&nbsp;server&nbsp;might&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="5849566">//&nbsp;performed&nbsp;the&nbsp;operation.&nbsp;Even&nbsp;if&nbsp;the&nbsp;server&nbsp;sends&nbsp;back&nbsp;an&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5849634">//&nbsp;you&nbsp;shouldn&#39;t&nbsp;return&nbsp;ErrBadConn.</span><br>
<span class="lineno">55</span><span class="keyword" id="5849670">var</span>&nbsp;<span class="ident" id="5849674">ErrBadConn</span>&nbsp;<span class="op" id="5849685">=</span>&nbsp;<span class="ident" id="5849687">errors</span><span class="op" id="5849693">.</span><span class="ident" id="5849694">New</span><span class="op" id="5849697">(</span><span class="string" id="5849698">&#34;driver:&nbsp;bad&nbsp;connection&#34;</span><span class="op" id="5849722">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5849725">//&nbsp;Execer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5849795">//</span><br>
<span class="lineno"></span><span class="comment" id="5849798">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Execer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Exec&nbsp;will</span><br>
<span class="lineno">60</span><span class="comment" id="5849869">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5849937">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5849951">//</span><br>
<span class="lineno"></span><span class="comment" id="5849954">//&nbsp;Exec&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno"></span><span class="keyword" id="5849982">type</span>&nbsp;<span class="ident" id="5849987">Execer</span>&nbsp;<span class="keyword" id="5849994">interface</span>&nbsp;<span class="op" id="5850004">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850007">Exec</span><span class="op" id="5850011">(</span><span class="ident" id="5850012">query</span>&nbsp;<span class="builtintype" id="5850018">string</span><span class="op" id="5850024">,</span>&nbsp;<span class="ident" id="5850026">args</span>&nbsp;<span class="op" id="5850031">[</span><span class="op" id="5850032">]</span><span class="ident" id="5850033">Value</span><span class="op" id="5850038">)</span>&nbsp;<span class="op" id="5850040">(</span><span class="ident" id="5850041">Result</span><span class="op" id="5850047">,</span>&nbsp;<span class="builtintype" id="5850049">error</span><span class="op" id="5850054">)</span><br>
<span class="lineno"></span><span class="op" id="5850056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5850059">//&nbsp;Queryer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5850130">//</span><br>
<span class="lineno">70</span><span class="comment" id="5850133">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Queryer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Query&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="5850206">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5850274">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5850288">//</span><br>
<span class="lineno"></span><span class="comment" id="5850291">//&nbsp;Query&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno">75</span><span class="keyword" id="5850320">type</span>&nbsp;<span class="ident" id="5850325">Queryer</span>&nbsp;<span class="keyword" id="5850333">interface</span>&nbsp;<span class="op" id="5850343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850346">Query</span><span class="op" id="5850351">(</span><span class="ident" id="5850352">query</span>&nbsp;<span class="builtintype" id="5850358">string</span><span class="op" id="5850364">,</span>&nbsp;<span class="ident" id="5850366">args</span>&nbsp;<span class="op" id="5850371">[</span><span class="op" id="5850372">]</span><span class="ident" id="5850373">Value</span><span class="op" id="5850378">)</span>&nbsp;<span class="op" id="5850380">(</span><span class="ident" id="5850381">Rows</span><span class="op" id="5850385">,</span>&nbsp;<span class="builtintype" id="5850387">error</span><span class="op" id="5850392">)</span><br>
<span class="lineno"></span><span class="op" id="5850394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5850397">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;connection&nbsp;to&nbsp;a&nbsp;database.&nbsp;It&nbsp;is&nbsp;not&nbsp;used&nbsp;concurrently</span><br>
<span class="lineno">80</span><span class="comment" id="5850464">//&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="5850491">//</span><br>
<span class="lineno"></span><span class="comment" id="5850494">//&nbsp;Conn&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;stateful.</span><br>
<span class="lineno"></span><span class="keyword" id="5850529">type</span>&nbsp;<span class="ident" id="5850534">Conn</span>&nbsp;<span class="keyword" id="5850539">interface</span>&nbsp;<span class="op" id="5850549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850552">//&nbsp;Prepare&nbsp;returns&nbsp;a&nbsp;prepared&nbsp;statement,&nbsp;bound&nbsp;to&nbsp;this&nbsp;connection.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5850620">Prepare</span><span class="op" id="5850627">(</span><span class="ident" id="5850628">query</span>&nbsp;<span class="builtintype" id="5850634">string</span><span class="op" id="5850640">)</span>&nbsp;<span class="op" id="5850642">(</span><span class="ident" id="5850643">Stmt</span><span class="op" id="5850647">,</span>&nbsp;<span class="builtintype" id="5850649">error</span><span class="op" id="5850654">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850658">//&nbsp;Close&nbsp;invalidates&nbsp;and&nbsp;potentially&nbsp;stops&nbsp;any&nbsp;current</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850714">//&nbsp;prepared&nbsp;statements&nbsp;and&nbsp;transactions,&nbsp;marking&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850769">//&nbsp;connection&nbsp;as&nbsp;no&nbsp;longer&nbsp;in&nbsp;use.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850805">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850809">//&nbsp;Because&nbsp;the&nbsp;sql&nbsp;package&nbsp;maintains&nbsp;a&nbsp;free&nbsp;pool&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850862">//&nbsp;connections&nbsp;and&nbsp;only&nbsp;calls&nbsp;Close&nbsp;when&nbsp;there&#39;s&nbsp;a&nbsp;surplus&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850925">//&nbsp;idle&nbsp;connections,&nbsp;it&nbsp;shouldn&#39;t&nbsp;be&nbsp;necessary&nbsp;for&nbsp;drivers&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850988">//&nbsp;do&nbsp;their&nbsp;own&nbsp;connection&nbsp;caching.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851025">Close</span><span class="op" id="5851030">(</span><span class="op" id="5851031">)</span>&nbsp;<span class="builtintype" id="5851033">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851041">//&nbsp;Begin&nbsp;starts&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;transaction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851089">Begin</span><span class="op" id="5851094">(</span><span class="op" id="5851095">)</span>&nbsp;<span class="op" id="5851097">(</span><span class="ident" id="5851098">Tx</span><span class="op" id="5851100">,</span>&nbsp;<span class="builtintype" id="5851102">error</span><span class="op" id="5851107">)</span><br>
<span class="lineno"></span><span class="op" id="5851109">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5851112">//&nbsp;Result&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;query&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="5851158">type</span>&nbsp;<span class="ident" id="5851163">Result</span>&nbsp;<span class="keyword" id="5851170">interface</span>&nbsp;<span class="op" id="5851180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851183">//&nbsp;LastInsertId&nbsp;returns&nbsp;the&nbsp;database&#39;s&nbsp;auto-generated&nbsp;ID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851241">//&nbsp;after,&nbsp;for&nbsp;example,&nbsp;an&nbsp;INSERT&nbsp;into&nbsp;a&nbsp;table&nbsp;with&nbsp;primary</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851301">//&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851310">LastInsertId</span><span class="op" id="5851322">(</span><span class="op" id="5851323">)</span>&nbsp;<span class="op" id="5851325">(</span><span class="ident" id="5851326">int64</span><span class="op" id="5851331">,</span>&nbsp;<span class="builtintype" id="5851333">error</span><span class="op" id="5851338">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851342">//&nbsp;RowsAffected&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;rows&nbsp;affected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851402">//&nbsp;query.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851413">RowsAffected</span><span class="op" id="5851425">(</span><span class="op" id="5851426">)</span>&nbsp;<span class="op" id="5851428">(</span><span class="ident" id="5851429">int64</span><span class="op" id="5851434">,</span>&nbsp;<span class="builtintype" id="5851436">error</span><span class="op" id="5851441">)</span><br>
<span class="lineno"></span><span class="op" id="5851443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5851446">//&nbsp;Stmt&nbsp;is&nbsp;a&nbsp;prepared&nbsp;statement.&nbsp;It&nbsp;is&nbsp;bound&nbsp;to&nbsp;a&nbsp;Conn&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5851509">//&nbsp;used&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;concurrently.</span><br>
<span class="lineno">115</span><span class="keyword" id="5851554">type</span>&nbsp;<span class="ident" id="5851559">Stmt</span>&nbsp;<span class="keyword" id="5851564">interface</span>&nbsp;<span class="op" id="5851574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851577">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;statement.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851609">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851613">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.1,&nbsp;a&nbsp;Stmt&nbsp;will&nbsp;not&nbsp;be&nbsp;closed&nbsp;if&nbsp;it&#39;s&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851672">//&nbsp;by&nbsp;any&nbsp;queries.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851692">Close</span><span class="op" id="5851697">(</span><span class="op" id="5851698">)</span>&nbsp;<span class="builtintype" id="5851700">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851708">//&nbsp;NumInput&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;placeholder&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851767">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851771">//&nbsp;If&nbsp;NumInput&nbsp;returns&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;sql&nbsp;package&nbsp;will&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851835">//&nbsp;argument&nbsp;counts&nbsp;from&nbsp;callers&nbsp;and&nbsp;return&nbsp;errors&nbsp;to&nbsp;the&nbsp;caller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851900">//&nbsp;before&nbsp;the&nbsp;statement&#39;s&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851961">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5851965">//&nbsp;NumInput&nbsp;may&nbsp;also&nbsp;return&nbsp;-1,&nbsp;if&nbsp;the&nbsp;driver&nbsp;doesn&#39;t&nbsp;know</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852025">//&nbsp;its&nbsp;number&nbsp;of&nbsp;placeholders.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852087">//&nbsp;will&nbsp;not&nbsp;sanity&nbsp;check&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;argument&nbsp;counts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852144">NumInput</span><span class="op" id="5852152">(</span><span class="op" id="5852153">)</span>&nbsp;<span class="builtintype" id="5852155">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852161">//&nbsp;Exec&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;doesn&#39;t&nbsp;return&nbsp;rows,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852218">//&nbsp;as&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852246">Exec</span><span class="op" id="5852250">(</span><span class="ident" id="5852251">args</span>&nbsp;<span class="op" id="5852256">[</span><span class="op" id="5852257">]</span><span class="ident" id="5852258">Value</span><span class="op" id="5852263">)</span>&nbsp;<span class="op" id="5852265">(</span><span class="ident" id="5852266">Result</span><span class="op" id="5852272">,</span>&nbsp;<span class="builtintype" id="5852274">error</span><span class="op" id="5852279">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852283">//&nbsp;Query&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;may&nbsp;return&nbsp;rows,&nbsp;such&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852342">//&nbsp;SELECT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852354">Query</span><span class="op" id="5852359">(</span><span class="ident" id="5852360">args</span>&nbsp;<span class="op" id="5852365">[</span><span class="op" id="5852366">]</span><span class="ident" id="5852367">Value</span><span class="op" id="5852372">)</span>&nbsp;<span class="op" id="5852374">(</span><span class="ident" id="5852375">Rows</span><span class="op" id="5852379">,</span>&nbsp;<span class="builtintype" id="5852381">error</span><span class="op" id="5852386">)</span><br>
<span class="lineno">140</span><span class="op" id="5852388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5852391">//&nbsp;ColumnConverter&nbsp;may&nbsp;be&nbsp;optionally&nbsp;implemented&nbsp;by&nbsp;Stmt&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5852455">//&nbsp;statement&nbsp;is&nbsp;aware&nbsp;of&nbsp;its&nbsp;own&nbsp;columns&#39;&nbsp;types&nbsp;and&nbsp;can&nbsp;convert&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5852524">//&nbsp;any&nbsp;type&nbsp;to&nbsp;a&nbsp;driver&nbsp;Value.</span><br>
<span class="lineno">145</span><span class="keyword" id="5852555">type</span>&nbsp;<span class="ident" id="5852560">ColumnConverter</span>&nbsp;<span class="keyword" id="5852576">interface</span>&nbsp;<span class="op" id="5852586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852589">//&nbsp;ColumnConverter&nbsp;returns&nbsp;a&nbsp;ValueConverter&nbsp;for&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852651">//&nbsp;column&nbsp;index.&nbsp;&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;specific&nbsp;column&nbsp;isn&#39;t&nbsp;known</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852715">//&nbsp;or&nbsp;shouldn&#39;t&nbsp;be&nbsp;handled&nbsp;specially,&nbsp;DefaultValueConverter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852776">//&nbsp;can&nbsp;be&nbsp;returned.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852797">ColumnConverter</span><span class="op" id="5852812">(</span><span class="ident" id="5852813">idx</span>&nbsp;<span class="builtintype" id="5852817">int</span><span class="op" id="5852820">)</span>&nbsp;<span class="ident" id="5852822">ValueConverter</span><br>
<span class="lineno"></span><span class="op" id="5852837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5852840">//&nbsp;Rows&nbsp;is&nbsp;an&nbsp;iterator&nbsp;over&nbsp;an&nbsp;executed&nbsp;query&#39;s&nbsp;results.</span><br>
<span class="lineno"></span><span class="keyword" id="5852897">type</span>&nbsp;<span class="ident" id="5852902">Rows</span>&nbsp;<span class="keyword" id="5852907">interface</span>&nbsp;<span class="op" id="5852917">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852920">//&nbsp;Columns&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;columns.&nbsp;The&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5852980">//&nbsp;columns&nbsp;of&nbsp;the&nbsp;result&nbsp;is&nbsp;inferred&nbsp;from&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853041">//&nbsp;slice.&nbsp;&nbsp;If&nbsp;a&nbsp;particular&nbsp;column&nbsp;name&nbsp;isn&#39;t&nbsp;known,&nbsp;an&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853103">//&nbsp;string&nbsp;should&nbsp;be&nbsp;returned&nbsp;for&nbsp;that&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853149">Columns</span><span class="op" id="5853156">(</span><span class="op" id="5853157">)</span>&nbsp;<span class="op" id="5853159">[</span><span class="op" id="5853160">]</span><span class="builtintype" id="5853161">string</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853170">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;rows&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853206">Close</span><span class="op" id="5853211">(</span><span class="op" id="5853212">)</span>&nbsp;<span class="builtintype" id="5853214">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853222">//&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;populate&nbsp;the&nbsp;next&nbsp;row&nbsp;of&nbsp;data&nbsp;into</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853279">//&nbsp;the&nbsp;provided&nbsp;slice.&nbsp;The&nbsp;provided&nbsp;slice&nbsp;will&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853339">//&nbsp;size&nbsp;as&nbsp;the&nbsp;Columns()&nbsp;are&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853375">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853379">//&nbsp;The&nbsp;dest&nbsp;slice&nbsp;may&nbsp;be&nbsp;populated&nbsp;only&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853425">//&nbsp;a&nbsp;driver&nbsp;Value&nbsp;type,&nbsp;but&nbsp;excluding&nbsp;string.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853472">//&nbsp;All&nbsp;string&nbsp;values&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853523">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5853527">//&nbsp;Next&nbsp;should&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853586">Next</span><span class="op" id="5853590">(</span><span class="ident" id="5853591">dest</span>&nbsp;<span class="op" id="5853596">[</span><span class="op" id="5853597">]</span><span class="ident" id="5853598">Value</span><span class="op" id="5853603">)</span>&nbsp;<span class="builtintype" id="5853605">error</span><br>
<span class="lineno"></span><span class="op" id="5853611">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="5853614">//&nbsp;Tx&nbsp;is&nbsp;a&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="5853638">type</span>&nbsp;<span class="ident" id="5853643">Tx</span>&nbsp;<span class="keyword" id="5853646">interface</span>&nbsp;<span class="op" id="5853656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853659">Commit</span><span class="op" id="5853665">(</span><span class="op" id="5853666">)</span>&nbsp;<span class="builtintype" id="5853668">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5853675">Rollback</span><span class="op" id="5853683">(</span><span class="op" id="5853684">)</span>&nbsp;<span class="builtintype" id="5853686">error</span><br>
<span class="lineno">180</span><span class="op" id="5853692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5853695">//&nbsp;RowsAffected&nbsp;implements&nbsp;Result&nbsp;for&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE&nbsp;operation</span><br>
<span class="lineno"></span><span class="comment" id="5853763">//&nbsp;which&nbsp;mutates&nbsp;a&nbsp;number&nbsp;of&nbsp;rows.</span><br>
<span class="lineno"></span><span class="keyword" id="5853798">type</span>&nbsp;<span class="ident" id="5853803">RowsAffected</span>&nbsp;<span class="ident" id="5853816">int64</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="5853823">var</span>&nbsp;<span class="ident" id="5853827">_</span>&nbsp;<span class="ident" id="5853829">Result</span>&nbsp;<span class="op" id="5853836">=</span>&nbsp;<span class="ident" id="5853838">RowsAffected</span><span class="op" id="5853850">(</span><span class="num" id="5853851">0</span><span class="op" id="5853852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5853855">func</span>&nbsp;<span class="op" id="5853860">(</span><span class="ident" id="5853861">RowsAffected</span><span class="op" id="5853873">)</span>&nbsp;<span class="ident" id="5853875">LastInsertId</span><span class="op" id="5853887">(</span><span class="op" id="5853888">)</span>&nbsp;<span class="op" id="5853890">(</span><span class="ident" id="5853891">int64</span><span class="op" id="5853896">,</span>&nbsp;<span class="builtintype" id="5853898">error</span><span class="op" id="5853903">)</span>&nbsp;<span class="op" id="5853905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5853908">return</span>&nbsp;<span class="num" id="5853915">0</span><span class="op" id="5853916">,</span>&nbsp;<span class="ident" id="5853918">errors</span><span class="op" id="5853924">.</span><span class="ident" id="5853925">New</span><span class="op" id="5853928">(</span><span class="string" id="5853929">&#34;no&nbsp;LastInsertId&nbsp;available&#34;</span><span class="op" id="5853956">)</span><br>
<span class="lineno">190</span><span class="op" id="5853958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5853961">func</span>&nbsp;<span class="op" id="5853966">(</span><span class="ident" id="5853967">v</span>&nbsp;<span class="ident" id="5853969">RowsAffected</span><span class="op" id="5853981">)</span>&nbsp;<span class="ident" id="5853983">RowsAffected</span><span class="op" id="5853995">(</span><span class="op" id="5853996">)</span>&nbsp;<span class="op" id="5853998">(</span><span class="ident" id="5853999">int64</span><span class="op" id="5854004">,</span>&nbsp;<span class="builtintype" id="5854006">error</span><span class="op" id="5854011">)</span>&nbsp;<span class="op" id="5854013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5854016">return</span>&nbsp;<span class="ident" id="5854023">int64</span><span class="op" id="5854028">(</span><span class="ident" id="5854029">v</span><span class="op" id="5854030">)</span><span class="op" id="5854031">,</span>&nbsp;<span class="builtintype" id="5854033">nil</span><br>
<span class="lineno"></span><span class="op" id="5854037">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="5854040">//&nbsp;ResultNoRows&nbsp;is&nbsp;a&nbsp;pre-defined&nbsp;Result&nbsp;for&nbsp;drivers&nbsp;to&nbsp;return&nbsp;when&nbsp;a&nbsp;DDL</span><br>
<span class="lineno"></span><span class="comment" id="5854113">//&nbsp;command&nbsp;(such&nbsp;as&nbsp;a&nbsp;CREATE&nbsp;TABLE)&nbsp;succeeds.&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;for&nbsp;both</span><br>
<span class="lineno"></span><span class="comment" id="5854188">//&nbsp;LastInsertId&nbsp;and&nbsp;RowsAffected.</span><br>
<span class="lineno"></span><span class="keyword" id="5854222">var</span>&nbsp;<span class="ident" id="5854226">ResultNoRows</span>&nbsp;<span class="ident" id="5854239">noRows</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="5854247">type</span>&nbsp;<span class="ident" id="5854252">noRows</span>&nbsp;<span class="keyword" id="5854259">struct</span><span class="op" id="5854265">{</span><span class="op" id="5854266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5854269">var</span>&nbsp;<span class="ident" id="5854273">_</span>&nbsp;<span class="ident" id="5854275">Result</span>&nbsp;<span class="op" id="5854282">=</span>&nbsp;<span class="ident" id="5854284">noRows</span><span class="op" id="5854290">{</span><span class="op" id="5854291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="5854294">func</span>&nbsp;<span class="op" id="5854299">(</span><span class="ident" id="5854300">noRows</span><span class="op" id="5854306">)</span>&nbsp;<span class="ident" id="5854308">LastInsertId</span><span class="op" id="5854320">(</span><span class="op" id="5854321">)</span>&nbsp;<span class="op" id="5854323">(</span><span class="ident" id="5854324">int64</span><span class="op" id="5854329">,</span>&nbsp;<span class="builtintype" id="5854331">error</span><span class="op" id="5854336">)</span>&nbsp;<span class="op" id="5854338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5854341">return</span>&nbsp;<span class="num" id="5854348">0</span><span class="op" id="5854349">,</span>&nbsp;<span class="ident" id="5854351">errors</span><span class="op" id="5854357">.</span><span class="ident" id="5854358">New</span><span class="op" id="5854361">(</span><span class="string" id="5854362">&#34;no&nbsp;LastInsertId&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5854409">)</span><br>
<span class="lineno"></span><span class="op" id="5854411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5854414">func</span>&nbsp;<span class="op" id="5854419">(</span><span class="ident" id="5854420">noRows</span><span class="op" id="5854426">)</span>&nbsp;<span class="ident" id="5854428">RowsAffected</span><span class="op" id="5854440">(</span><span class="op" id="5854441">)</span>&nbsp;<span class="op" id="5854443">(</span><span class="ident" id="5854444">int64</span><span class="op" id="5854449">,</span>&nbsp;<span class="builtintype" id="5854451">error</span><span class="op" id="5854456">)</span>&nbsp;<span class="op" id="5854458">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5854461">return</span>&nbsp;<span class="num" id="5854468">0</span><span class="op" id="5854469">,</span>&nbsp;<span class="ident" id="5854471">errors</span><span class="op" id="5854477">.</span><span class="ident" id="5854478">New</span><span class="op" id="5854481">(</span><span class="string" id="5854482">&#34;no&nbsp;RowsAffected&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5854529">)</span><br>
<span class="lineno"></span><span class="op" id="5854531">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
