<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5777465">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5777521">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5777575">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5777626">package</span>&nbsp;<span class="ident" id="5777634">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5777641">import</span>&nbsp;<span class="op" id="5777648">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777651">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777660">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777670">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777677">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777687">&#34;go/doc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777697">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777710">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777722">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777728">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777741">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777748">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777754">pathpkg</span>&nbsp;<span class="string" id="5777762">&#34;path&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777770">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777787">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777798">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777806">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777817">&#34;strings&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777828">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5777839">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5777854">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5777857">//&nbsp;A&nbsp;Context&nbsp;specifies&nbsp;the&nbsp;supporting&nbsp;context&nbsp;for&nbsp;a&nbsp;build.</span><br>
<span class="lineno">30</span><span class="keyword" id="5777916">type</span>&nbsp;<span class="ident" id="5777921">Context</span>&nbsp;<span class="keyword" id="5777929">struct</span>&nbsp;<span class="op" id="5777936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777939">GOARCH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5777951">string</span>&nbsp;<span class="comment" id="5777958">//&nbsp;target&nbsp;architecture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5777982">GOOS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5777994">string</span>&nbsp;<span class="comment" id="5778001">//&nbsp;target&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778029">GOROOT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5778041">string</span>&nbsp;<span class="comment" id="5778048">//&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778060">GOPATH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5778072">string</span>&nbsp;<span class="comment" id="5778079">//&nbsp;Go&nbsp;path</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778091">CgoEnabled</span>&nbsp;&nbsp;<span class="builtintype" id="5778103">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5778110">//&nbsp;whether&nbsp;cgo&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778138">UseAllFiles</span>&nbsp;<span class="builtintype" id="5778150">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5778157">//&nbsp;use&nbsp;files&nbsp;regardless&nbsp;of&nbsp;+build&nbsp;lines,&nbsp;file&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778210">Compiler</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5778222">string</span>&nbsp;<span class="comment" id="5778229">//&nbsp;compiler&nbsp;to&nbsp;assume&nbsp;when&nbsp;computing&nbsp;target&nbsp;paths</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778281">//&nbsp;The&nbsp;build&nbsp;and&nbsp;release&nbsp;tags&nbsp;specify&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778338">//&nbsp;that&nbsp;should&nbsp;be&nbsp;considered&nbsp;satisfied&nbsp;when&nbsp;processing&nbsp;+build&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778408">//&nbsp;Clients&nbsp;creating&nbsp;a&nbsp;new&nbsp;context&nbsp;may&nbsp;customize&nbsp;BuildTags,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778474">//&nbsp;defaults&nbsp;to&nbsp;empty,&nbsp;but&nbsp;it&nbsp;is&nbsp;usually&nbsp;an&nbsp;error&nbsp;to&nbsp;customize&nbsp;ReleaseTags,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778550">//&nbsp;which&nbsp;defaults&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;releases&nbsp;the&nbsp;current&nbsp;release&nbsp;is&nbsp;compatible&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778636">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;BuildTags&nbsp;and&nbsp;ReleaseTags,&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778704">//&nbsp;consider&nbsp;the&nbsp;values&nbsp;of&nbsp;GOARCH&nbsp;and&nbsp;GOOS&nbsp;as&nbsp;satisfied&nbsp;tags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778766">BuildTags</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5778778">[</span><span class="op" id="5778779">]</span><span class="builtintype" id="5778780">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5778788">ReleaseTags</span>&nbsp;<span class="op" id="5778800">[</span><span class="op" id="5778801">]</span><span class="builtintype" id="5778802">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778811">//&nbsp;The&nbsp;install&nbsp;suffix&nbsp;specifies&nbsp;a&nbsp;suffix&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;installation</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778892">//&nbsp;directory.&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;empty,&nbsp;but&nbsp;custom&nbsp;builds&nbsp;that&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5778967">//&nbsp;their&nbsp;outputs&nbsp;separate&nbsp;can&nbsp;set&nbsp;InstallSuffix&nbsp;to&nbsp;do&nbsp;so.&nbsp;For&nbsp;example,&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779044">//&nbsp;using&nbsp;the&nbsp;race&nbsp;detector,&nbsp;the&nbsp;go&nbsp;command&nbsp;uses&nbsp;InstallSuffix&nbsp;=&nbsp;&#34;race&#34;,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779120">//&nbsp;that&nbsp;on&nbsp;a&nbsp;Linux/386&nbsp;system,&nbsp;packages&nbsp;are&nbsp;written&nbsp;to&nbsp;a&nbsp;directory&nbsp;named</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779194">//&nbsp;&#34;linux_386_race&#34;&nbsp;instead&nbsp;of&nbsp;the&nbsp;usual&nbsp;&#34;linux_386&#34;.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779249">InstallSuffix</span>&nbsp;<span class="builtintype" id="5779263">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779272">//&nbsp;By&nbsp;default,&nbsp;Import&nbsp;uses&nbsp;the&nbsp;operating&nbsp;system&#39;s&nbsp;file&nbsp;system&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779341">//&nbsp;to&nbsp;read&nbsp;directories&nbsp;and&nbsp;files.&nbsp;&nbsp;To&nbsp;read&nbsp;from&nbsp;other&nbsp;sources,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779405">//&nbsp;callers&nbsp;can&nbsp;set&nbsp;the&nbsp;following&nbsp;functions.&nbsp;&nbsp;They&nbsp;all&nbsp;have&nbsp;default</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779473">//&nbsp;behaviors&nbsp;that&nbsp;use&nbsp;the&nbsp;local&nbsp;file&nbsp;system,&nbsp;so&nbsp;clients&nbsp;need&nbsp;only&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779544">//&nbsp;the&nbsp;functions&nbsp;whose&nbsp;behaviors&nbsp;they&nbsp;wish&nbsp;to&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779600">//&nbsp;JoinPath&nbsp;joins&nbsp;the&nbsp;sequence&nbsp;of&nbsp;path&nbsp;fragments&nbsp;into&nbsp;a&nbsp;single&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779670">//&nbsp;If&nbsp;JoinPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.Join.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779721">JoinPath</span>&nbsp;<span class="keyword" id="5779730">func</span><span class="op" id="5779734">(</span><span class="ident" id="5779735">elem</span>&nbsp;<span class="op" id="5779740">...</span><span class="builtintype" id="5779743">string</span><span class="op" id="5779749">)</span>&nbsp;<span class="builtintype" id="5779751">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779760">//&nbsp;SplitPathList&nbsp;splits&nbsp;the&nbsp;path&nbsp;list&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;individual&nbsp;paths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779833">//&nbsp;If&nbsp;SplitPathList&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5779894">SplitPathList</span>&nbsp;<span class="keyword" id="5779908">func</span><span class="op" id="5779912">(</span><span class="ident" id="5779913">list</span>&nbsp;<span class="builtintype" id="5779918">string</span><span class="op" id="5779924">)</span>&nbsp;<span class="op" id="5779926">[</span><span class="op" id="5779927">]</span><span class="builtintype" id="5779928">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779937">//&nbsp;IsAbsPath&nbsp;reports&nbsp;whether&nbsp;path&nbsp;is&nbsp;an&nbsp;absolute&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5779993">//&nbsp;If&nbsp;IsAbsPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780046">IsAbsPath</span>&nbsp;<span class="keyword" id="5780056">func</span><span class="op" id="5780060">(</span><span class="ident" id="5780061">path</span>&nbsp;<span class="builtintype" id="5780066">string</span><span class="op" id="5780072">)</span>&nbsp;<span class="builtintype" id="5780074">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780081">//&nbsp;IsDir&nbsp;reports&nbsp;whether&nbsp;the&nbsp;path&nbsp;names&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780135">//&nbsp;If&nbsp;IsDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;calls&nbsp;os.Stat&nbsp;and&nbsp;uses&nbsp;the&nbsp;result&#39;s&nbsp;IsDir&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780213">IsDir</span>&nbsp;<span class="keyword" id="5780219">func</span><span class="op" id="5780223">(</span><span class="ident" id="5780224">path</span>&nbsp;<span class="builtintype" id="5780229">string</span><span class="op" id="5780235">)</span>&nbsp;<span class="builtintype" id="5780237">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780244">//&nbsp;HasSubdir&nbsp;reports&nbsp;whether&nbsp;dir&nbsp;is&nbsp;a&nbsp;subdirectory&nbsp;of</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780299">//&nbsp;(perhaps&nbsp;multiple&nbsp;levels&nbsp;below)&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780341">//&nbsp;If&nbsp;so,&nbsp;HasSubdir&nbsp;sets&nbsp;rel&nbsp;to&nbsp;a&nbsp;slash-separated&nbsp;path&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780402">//&nbsp;can&nbsp;be&nbsp;joined&nbsp;to&nbsp;root&nbsp;to&nbsp;produce&nbsp;a&nbsp;path&nbsp;equivalent&nbsp;to&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780465">//&nbsp;If&nbsp;HasSubdir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;an&nbsp;implementation&nbsp;built&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780529">//&nbsp;filepath.EvalSymlinks.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780556">HasSubdir</span>&nbsp;<span class="keyword" id="5780566">func</span><span class="op" id="5780570">(</span><span class="ident" id="5780571">root</span><span class="op" id="5780575">,</span>&nbsp;<span class="ident" id="5780577">dir</span>&nbsp;<span class="builtintype" id="5780581">string</span><span class="op" id="5780587">)</span>&nbsp;<span class="op" id="5780589">(</span><span class="ident" id="5780590">rel</span>&nbsp;<span class="builtintype" id="5780594">string</span><span class="op" id="5780600">,</span>&nbsp;<span class="ident" id="5780602">ok</span>&nbsp;<span class="builtintype" id="5780605">bool</span><span class="op" id="5780609">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780613">//&nbsp;ReadDir&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;os.FileInfo,&nbsp;sorted&nbsp;by&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780673">//&nbsp;describing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780724">//&nbsp;If&nbsp;ReadDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780775">ReadDir</span>&nbsp;<span class="keyword" id="5780783">func</span><span class="op" id="5780787">(</span><span class="ident" id="5780788">dir</span>&nbsp;<span class="builtintype" id="5780792">string</span><span class="op" id="5780798">)</span>&nbsp;<span class="op" id="5780800">(</span><span class="ident" id="5780801">fi</span>&nbsp;<span class="op" id="5780804">[</span><span class="op" id="5780805">]</span><span class="ident" id="5780806">os</span><span class="op" id="5780808">.</span><span class="ident" id="5780809">FileInfo</span><span class="op" id="5780817">,</span>&nbsp;<span class="ident" id="5780819">err</span>&nbsp;<span class="builtintype" id="5780823">error</span><span class="op" id="5780828">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780832">//&nbsp;OpenFile&nbsp;opens&nbsp;a&nbsp;file&nbsp;(not&nbsp;a&nbsp;directory)&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5780889">//&nbsp;If&nbsp;OpenFile&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;os.Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5780934">OpenFile</span>&nbsp;<span class="keyword" id="5780943">func</span><span class="op" id="5780947">(</span><span class="ident" id="5780948">path</span>&nbsp;<span class="builtintype" id="5780953">string</span><span class="op" id="5780959">)</span>&nbsp;<span class="op" id="5780961">(</span><span class="ident" id="5780962">r</span>&nbsp;<span class="ident" id="5780964">io</span><span class="op" id="5780966">.</span><span class="ident" id="5780967">ReadCloser</span><span class="op" id="5780977">,</span>&nbsp;<span class="ident" id="5780979">err</span>&nbsp;<span class="builtintype" id="5780983">error</span><span class="op" id="5780988">)</span><br>
<span class="lineno">95</span><span class="op" id="5780990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5780993">//&nbsp;joinPath&nbsp;calls&nbsp;ctxt.JoinPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.Join.</span><br>
<span class="lineno"></span><span class="keyword" id="5781061">func</span>&nbsp;<span class="op" id="5781066">(</span><span class="ident" id="5781067">ctxt</span>&nbsp;<span class="op" id="5781072">*</span><span class="ident" id="5781073">Context</span><span class="op" id="5781080">)</span>&nbsp;<span class="ident" id="5781082">joinPath</span><span class="op" id="5781090">(</span><span class="ident" id="5781091">elem</span>&nbsp;<span class="op" id="5781096">...</span><span class="builtintype" id="5781099">string</span><span class="op" id="5781105">)</span>&nbsp;<span class="builtintype" id="5781107">string</span>&nbsp;<span class="op" id="5781114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781117">if</span>&nbsp;<span class="ident" id="5781120">f</span>&nbsp;<span class="op" id="5781122">:=</span>&nbsp;<span class="ident" id="5781125">ctxt</span><span class="op" id="5781129">.</span><span class="ident" id="5781130">JoinPath</span><span class="op" id="5781138">;</span>&nbsp;<span class="ident" id="5781140">f</span>&nbsp;<span class="op" id="5781142">!=</span>&nbsp;<span class="ident" id="5781145">nil</span>&nbsp;<span class="op" id="5781149">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781153">return</span>&nbsp;<span class="ident" id="5781160">f</span><span class="op" id="5781161">(</span><span class="ident" id="5781162">elem</span><span class="op" id="5781166">...</span><span class="op" id="5781169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5781172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781175">return</span>&nbsp;<span class="ident" id="5781182">filepath</span><span class="op" id="5781190">.</span><span class="ident" id="5781191">Join</span><span class="op" id="5781195">(</span><span class="ident" id="5781196">elem</span><span class="op" id="5781200">...</span><span class="op" id="5781203">)</span><br>
<span class="lineno"></span><span class="op" id="5781205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="5781208">//&nbsp;splitPathList&nbsp;calls&nbsp;ctxt.SplitPathList&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span><span class="keyword" id="5781291">func</span>&nbsp;<span class="op" id="5781296">(</span><span class="ident" id="5781297">ctxt</span>&nbsp;<span class="op" id="5781302">*</span><span class="ident" id="5781303">Context</span><span class="op" id="5781310">)</span>&nbsp;<span class="ident" id="5781312">splitPathList</span><span class="op" id="5781325">(</span><span class="ident" id="5781326">s</span>&nbsp;<span class="builtintype" id="5781328">string</span><span class="op" id="5781334">)</span>&nbsp;<span class="op" id="5781336">[</span><span class="op" id="5781337">]</span><span class="builtintype" id="5781338">string</span>&nbsp;<span class="op" id="5781345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781348">if</span>&nbsp;<span class="ident" id="5781351">f</span>&nbsp;<span class="op" id="5781353">:=</span>&nbsp;<span class="ident" id="5781356">ctxt</span><span class="op" id="5781360">.</span><span class="ident" id="5781361">SplitPathList</span><span class="op" id="5781374">;</span>&nbsp;<span class="ident" id="5781376">f</span>&nbsp;<span class="op" id="5781378">!=</span>&nbsp;<span class="ident" id="5781381">nil</span>&nbsp;<span class="op" id="5781385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781389">return</span>&nbsp;<span class="ident" id="5781396">f</span><span class="op" id="5781397">(</span><span class="ident" id="5781398">s</span><span class="op" id="5781399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5781402">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781405">return</span>&nbsp;<span class="ident" id="5781412">filepath</span><span class="op" id="5781420">.</span><span class="ident" id="5781421">SplitList</span><span class="op" id="5781430">(</span><span class="ident" id="5781431">s</span><span class="op" id="5781432">)</span><br>
<span class="lineno"></span><span class="op" id="5781434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5781437">//&nbsp;isAbsPath&nbsp;calls&nbsp;ctxt.IsAbsSPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span><span class="keyword" id="5781509">func</span>&nbsp;<span class="op" id="5781514">(</span><span class="ident" id="5781515">ctxt</span>&nbsp;<span class="op" id="5781520">*</span><span class="ident" id="5781521">Context</span><span class="op" id="5781528">)</span>&nbsp;<span class="ident" id="5781530">isAbsPath</span><span class="op" id="5781539">(</span><span class="ident" id="5781540">path</span>&nbsp;<span class="builtintype" id="5781545">string</span><span class="op" id="5781551">)</span>&nbsp;<span class="builtintype" id="5781553">bool</span>&nbsp;<span class="op" id="5781558">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781561">if</span>&nbsp;<span class="ident" id="5781564">f</span>&nbsp;<span class="op" id="5781566">:=</span>&nbsp;<span class="ident" id="5781569">ctxt</span><span class="op" id="5781573">.</span><span class="ident" id="5781574">IsAbsPath</span><span class="op" id="5781583">;</span>&nbsp;<span class="ident" id="5781585">f</span>&nbsp;<span class="op" id="5781587">!=</span>&nbsp;<span class="ident" id="5781590">nil</span>&nbsp;<span class="op" id="5781594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781598">return</span>&nbsp;<span class="ident" id="5781605">f</span><span class="op" id="5781606">(</span><span class="ident" id="5781607">path</span><span class="op" id="5781611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5781614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781617">return</span>&nbsp;<span class="ident" id="5781624">filepath</span><span class="op" id="5781632">.</span><span class="ident" id="5781633">IsAbs</span><span class="op" id="5781638">(</span><span class="ident" id="5781639">path</span><span class="op" id="5781643">)</span><br>
<span class="lineno"></span><span class="op" id="5781645">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="5781648">//&nbsp;isDir&nbsp;calls&nbsp;ctxt.IsDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses&nbsp;os.Stat.</span><br>
<span class="lineno"></span><span class="keyword" id="5781709">func</span>&nbsp;<span class="op" id="5781714">(</span><span class="ident" id="5781715">ctxt</span>&nbsp;<span class="op" id="5781720">*</span><span class="ident" id="5781721">Context</span><span class="op" id="5781728">)</span>&nbsp;<span class="ident" id="5781730">isDir</span><span class="op" id="5781735">(</span><span class="ident" id="5781736">path</span>&nbsp;<span class="builtintype" id="5781741">string</span><span class="op" id="5781747">)</span>&nbsp;<span class="builtintype" id="5781749">bool</span>&nbsp;<span class="op" id="5781754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781757">if</span>&nbsp;<span class="ident" id="5781760">f</span>&nbsp;<span class="op" id="5781762">:=</span>&nbsp;<span class="ident" id="5781765">ctxt</span><span class="op" id="5781769">.</span><span class="ident" id="5781770">IsDir</span><span class="op" id="5781775">;</span>&nbsp;<span class="ident" id="5781777">f</span>&nbsp;<span class="op" id="5781779">!=</span>&nbsp;<span class="ident" id="5781782">nil</span>&nbsp;<span class="op" id="5781786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781790">return</span>&nbsp;<span class="ident" id="5781797">f</span><span class="op" id="5781798">(</span><span class="ident" id="5781799">path</span><span class="op" id="5781803">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5781806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5781809">fi</span><span class="op" id="5781811">,</span>&nbsp;<span class="ident" id="5781813">err</span>&nbsp;<span class="op" id="5781817">:=</span>&nbsp;<span class="ident" id="5781820">os</span><span class="op" id="5781822">.</span><span class="ident" id="5781823">Stat</span><span class="op" id="5781827">(</span><span class="ident" id="5781828">path</span><span class="op" id="5781832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5781835">return</span>&nbsp;<span class="ident" id="5781842">err</span>&nbsp;<span class="op" id="5781846">==</span>&nbsp;<span class="ident" id="5781849">nil</span>&nbsp;<span class="op" id="5781853">&amp;&amp;</span>&nbsp;<span class="ident" id="5781856">fi</span><span class="op" id="5781858">.</span><span class="ident" id="5781859">IsDir</span><span class="op" id="5781864">(</span><span class="op" id="5781865">)</span><br>
<span class="lineno"></span><span class="op" id="5781867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5781870">//&nbsp;hasSubdir&nbsp;calls&nbsp;ctxt.HasSubdir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5781930">//&nbsp;the&nbsp;local&nbsp;file&nbsp;system&nbsp;to&nbsp;answer&nbsp;the&nbsp;question.</span><br>
<span class="lineno"></span><span class="keyword" id="5781979">func</span>&nbsp;<span class="op" id="5781984">(</span><span class="ident" id="5781985">ctxt</span>&nbsp;<span class="op" id="5781990">*</span><span class="ident" id="5781991">Context</span><span class="op" id="5781998">)</span>&nbsp;<span class="ident" id="5782000">hasSubdir</span><span class="op" id="5782009">(</span><span class="ident" id="5782010">root</span><span class="op" id="5782014">,</span>&nbsp;<span class="ident" id="5782016">dir</span>&nbsp;<span class="builtintype" id="5782020">string</span><span class="op" id="5782026">)</span>&nbsp;<span class="op" id="5782028">(</span><span class="ident" id="5782029">rel</span>&nbsp;<span class="builtintype" id="5782033">string</span><span class="op" id="5782039">,</span>&nbsp;<span class="ident" id="5782041">ok</span>&nbsp;<span class="builtintype" id="5782044">bool</span><span class="op" id="5782048">)</span>&nbsp;<span class="op" id="5782050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782053">if</span>&nbsp;<span class="ident" id="5782056">f</span>&nbsp;<span class="op" id="5782058">:=</span>&nbsp;<span class="ident" id="5782061">ctxt</span><span class="op" id="5782065">.</span><span class="ident" id="5782066">HasSubdir</span><span class="op" id="5782075">;</span>&nbsp;<span class="ident" id="5782077">f</span>&nbsp;<span class="op" id="5782079">!=</span>&nbsp;<span class="ident" id="5782082">nil</span>&nbsp;<span class="op" id="5782086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782090">return</span>&nbsp;<span class="ident" id="5782097">f</span><span class="op" id="5782098">(</span><span class="ident" id="5782099">root</span><span class="op" id="5782103">,</span>&nbsp;<span class="ident" id="5782105">dir</span><span class="op" id="5782108">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5782115">//&nbsp;Try&nbsp;using&nbsp;paths&nbsp;we&nbsp;received.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782148">if</span>&nbsp;<span class="ident" id="5782151">rel</span><span class="op" id="5782154">,</span>&nbsp;<span class="ident" id="5782156">ok</span>&nbsp;<span class="op" id="5782159">=</span>&nbsp;<span class="ident" id="5782161">hasSubdir</span><span class="op" id="5782170">(</span><span class="ident" id="5782171">root</span><span class="op" id="5782175">,</span>&nbsp;<span class="ident" id="5782177">dir</span><span class="op" id="5782180">)</span><span class="op" id="5782181">;</span>&nbsp;<span class="ident" id="5782183">ok</span>&nbsp;<span class="op" id="5782186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782190">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5782202">//&nbsp;Try&nbsp;expanding&nbsp;symlinks&nbsp;and&nbsp;comparing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5782243">//&nbsp;expanded&nbsp;against&nbsp;unexpanded&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5782279">//&nbsp;expanded&nbsp;against&nbsp;expanded.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782310">rootSym</span><span class="op" id="5782317">,</span>&nbsp;<span class="ident" id="5782319">_</span>&nbsp;<span class="op" id="5782321">:=</span>&nbsp;<span class="ident" id="5782324">filepath</span><span class="op" id="5782332">.</span><span class="ident" id="5782333">EvalSymlinks</span><span class="op" id="5782345">(</span><span class="ident" id="5782346">root</span><span class="op" id="5782350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782353">dirSym</span><span class="op" id="5782359">,</span>&nbsp;<span class="ident" id="5782361">_</span>&nbsp;<span class="op" id="5782363">:=</span>&nbsp;<span class="ident" id="5782366">filepath</span><span class="op" id="5782374">.</span><span class="ident" id="5782375">EvalSymlinks</span><span class="op" id="5782387">(</span><span class="ident" id="5782388">dir</span><span class="op" id="5782391">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782395">if</span>&nbsp;<span class="ident" id="5782398">rel</span><span class="op" id="5782401">,</span>&nbsp;<span class="ident" id="5782403">ok</span>&nbsp;<span class="op" id="5782406">=</span>&nbsp;<span class="ident" id="5782408">hasSubdir</span><span class="op" id="5782417">(</span><span class="ident" id="5782418">rootSym</span><span class="op" id="5782425">,</span>&nbsp;<span class="ident" id="5782427">dir</span><span class="op" id="5782430">)</span><span class="op" id="5782431">;</span>&nbsp;<span class="ident" id="5782433">ok</span>&nbsp;<span class="op" id="5782436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782440">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782451">if</span>&nbsp;<span class="ident" id="5782454">rel</span><span class="op" id="5782457">,</span>&nbsp;<span class="ident" id="5782459">ok</span>&nbsp;<span class="op" id="5782462">=</span>&nbsp;<span class="ident" id="5782464">hasSubdir</span><span class="op" id="5782473">(</span><span class="ident" id="5782474">root</span><span class="op" id="5782478">,</span>&nbsp;<span class="ident" id="5782480">dirSym</span><span class="op" id="5782486">)</span><span class="op" id="5782487">;</span>&nbsp;<span class="ident" id="5782489">ok</span>&nbsp;<span class="op" id="5782492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782496">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782507">return</span>&nbsp;<span class="ident" id="5782514">hasSubdir</span><span class="op" id="5782523">(</span><span class="ident" id="5782524">rootSym</span><span class="op" id="5782531">,</span>&nbsp;<span class="ident" id="5782533">dirSym</span><span class="op" id="5782539">)</span><br>
<span class="lineno">155</span><span class="op" id="5782541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5782544">func</span>&nbsp;<span class="ident" id="5782549">hasSubdir</span><span class="op" id="5782558">(</span><span class="ident" id="5782559">root</span><span class="op" id="5782563">,</span>&nbsp;<span class="ident" id="5782565">dir</span>&nbsp;<span class="builtintype" id="5782569">string</span><span class="op" id="5782575">)</span>&nbsp;<span class="op" id="5782577">(</span><span class="ident" id="5782578">rel</span>&nbsp;<span class="builtintype" id="5782582">string</span><span class="op" id="5782588">,</span>&nbsp;<span class="ident" id="5782590">ok</span>&nbsp;<span class="builtintype" id="5782593">bool</span><span class="op" id="5782597">)</span>&nbsp;<span class="op" id="5782599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782602">const</span>&nbsp;<span class="ident" id="5782608">sep</span>&nbsp;<span class="op" id="5782612">=</span>&nbsp;<span class="builtintype" id="5782614">string</span><span class="op" id="5782620">(</span><span class="ident" id="5782621">filepath</span><span class="op" id="5782629">.</span><span class="ident" id="5782630">Separator</span><span class="op" id="5782639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782642">root</span>&nbsp;<span class="op" id="5782647">=</span>&nbsp;<span class="ident" id="5782649">filepath</span><span class="op" id="5782657">.</span><span class="ident" id="5782658">Clean</span><span class="op" id="5782663">(</span><span class="ident" id="5782664">root</span><span class="op" id="5782668">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782671">if</span>&nbsp;<span class="op" id="5782674">!</span><span class="ident" id="5782675">strings</span><span class="op" id="5782682">.</span><span class="ident" id="5782683">HasSuffix</span><span class="op" id="5782692">(</span><span class="ident" id="5782693">root</span><span class="op" id="5782697">,</span>&nbsp;<span class="ident" id="5782699">sep</span><span class="op" id="5782702">)</span>&nbsp;<span class="op" id="5782704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782708">root</span>&nbsp;<span class="op" id="5782713">+=</span>&nbsp;<span class="ident" id="5782716">sep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5782724">dir</span>&nbsp;<span class="op" id="5782728">=</span>&nbsp;<span class="ident" id="5782730">filepath</span><span class="op" id="5782738">.</span><span class="ident" id="5782739">Clean</span><span class="op" id="5782744">(</span><span class="ident" id="5782745">dir</span><span class="op" id="5782748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782751">if</span>&nbsp;<span class="op" id="5782754">!</span><span class="ident" id="5782755">strings</span><span class="op" id="5782762">.</span><span class="ident" id="5782763">HasPrefix</span><span class="op" id="5782772">(</span><span class="ident" id="5782773">dir</span><span class="op" id="5782776">,</span>&nbsp;<span class="ident" id="5782778">root</span><span class="op" id="5782782">)</span>&nbsp;<span class="op" id="5782784">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782788">return</span>&nbsp;<span class="string" id="5782795">&#34;&#34;</span><span class="op" id="5782797">,</span>&nbsp;<span class="builtintype" id="5782799">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5782806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782809">return</span>&nbsp;<span class="ident" id="5782816">filepath</span><span class="op" id="5782824">.</span><span class="ident" id="5782825">ToSlash</span><span class="op" id="5782832">(</span><span class="ident" id="5782833">dir</span><span class="op" id="5782836">[</span><span class="builtinfunc" id="5782837">len</span><span class="op" id="5782840">(</span><span class="ident" id="5782841">root</span><span class="op" id="5782845">)</span><span class="op" id="5782846">:</span><span class="op" id="5782847">]</span><span class="op" id="5782848">)</span><span class="op" id="5782849">,</span>&nbsp;<span class="builtintype" id="5782851">true</span><br>
<span class="lineno"></span><span class="op" id="5782856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="5782859">//&nbsp;readDir&nbsp;calls&nbsp;ctxt.ReadDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno"></span><span class="keyword" id="5782926">func</span>&nbsp;<span class="op" id="5782931">(</span><span class="ident" id="5782932">ctxt</span>&nbsp;<span class="op" id="5782937">*</span><span class="ident" id="5782938">Context</span><span class="op" id="5782945">)</span>&nbsp;<span class="ident" id="5782947">readDir</span><span class="op" id="5782954">(</span><span class="ident" id="5782955">path</span>&nbsp;<span class="builtintype" id="5782960">string</span><span class="op" id="5782966">)</span>&nbsp;<span class="op" id="5782968">(</span><span class="op" id="5782969">[</span><span class="op" id="5782970">]</span><span class="ident" id="5782971">os</span><span class="op" id="5782973">.</span><span class="ident" id="5782974">FileInfo</span><span class="op" id="5782982">,</span>&nbsp;<span class="builtintype" id="5782984">error</span><span class="op" id="5782989">)</span>&nbsp;<span class="op" id="5782991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5782994">if</span>&nbsp;<span class="ident" id="5782997">f</span>&nbsp;<span class="op" id="5782999">:=</span>&nbsp;<span class="ident" id="5783002">ctxt</span><span class="op" id="5783006">.</span><span class="ident" id="5783007">ReadDir</span><span class="op" id="5783014">;</span>&nbsp;<span class="ident" id="5783016">f</span>&nbsp;<span class="op" id="5783018">!=</span>&nbsp;<span class="ident" id="5783021">nil</span>&nbsp;<span class="op" id="5783025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783029">return</span>&nbsp;<span class="ident" id="5783036">f</span><span class="op" id="5783037">(</span><span class="ident" id="5783038">path</span><span class="op" id="5783042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783045">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783048">return</span>&nbsp;<span class="ident" id="5783055">ioutil</span><span class="op" id="5783061">.</span><span class="ident" id="5783062">ReadDir</span><span class="op" id="5783069">(</span><span class="ident" id="5783070">path</span><span class="op" id="5783074">)</span><br>
<span class="lineno"></span><span class="op" id="5783076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5783079">//&nbsp;openFile&nbsp;calls&nbsp;ctxt.OpenFile&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;os.Open.</span><br>
<span class="lineno"></span><span class="keyword" id="5783141">func</span>&nbsp;<span class="op" id="5783146">(</span><span class="ident" id="5783147">ctxt</span>&nbsp;<span class="op" id="5783152">*</span><span class="ident" id="5783153">Context</span><span class="op" id="5783160">)</span>&nbsp;<span class="ident" id="5783162">openFile</span><span class="op" id="5783170">(</span><span class="ident" id="5783171">path</span>&nbsp;<span class="builtintype" id="5783176">string</span><span class="op" id="5783182">)</span>&nbsp;<span class="op" id="5783184">(</span><span class="ident" id="5783185">io</span><span class="op" id="5783187">.</span><span class="ident" id="5783188">ReadCloser</span><span class="op" id="5783198">,</span>&nbsp;<span class="builtintype" id="5783200">error</span><span class="op" id="5783205">)</span>&nbsp;<span class="op" id="5783207">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783210">if</span>&nbsp;<span class="ident" id="5783213">fn</span>&nbsp;<span class="op" id="5783216">:=</span>&nbsp;<span class="ident" id="5783219">ctxt</span><span class="op" id="5783223">.</span><span class="ident" id="5783224">OpenFile</span><span class="op" id="5783232">;</span>&nbsp;<span class="ident" id="5783234">fn</span>&nbsp;<span class="op" id="5783237">!=</span>&nbsp;<span class="ident" id="5783240">nil</span>&nbsp;<span class="op" id="5783244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783248">return</span>&nbsp;<span class="ident" id="5783255">fn</span><span class="op" id="5783257">(</span><span class="ident" id="5783258">path</span><span class="op" id="5783262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783269">f</span><span class="op" id="5783270">,</span>&nbsp;<span class="ident" id="5783272">err</span>&nbsp;<span class="op" id="5783276">:=</span>&nbsp;<span class="ident" id="5783279">os</span><span class="op" id="5783281">.</span><span class="ident" id="5783282">Open</span><span class="op" id="5783286">(</span><span class="ident" id="5783287">path</span><span class="op" id="5783291">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783294">if</span>&nbsp;<span class="ident" id="5783297">err</span>&nbsp;<span class="op" id="5783301">!=</span>&nbsp;<span class="ident" id="5783304">nil</span>&nbsp;<span class="op" id="5783308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783312">return</span>&nbsp;<span class="ident" id="5783319">nil</span><span class="op" id="5783322">,</span>&nbsp;<span class="ident" id="5783324">err</span>&nbsp;<span class="comment" id="5783328">//&nbsp;nil&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783349">return</span>&nbsp;<span class="ident" id="5783356">f</span><span class="op" id="5783357">,</span>&nbsp;<span class="ident" id="5783359">nil</span><br>
<span class="lineno"></span><span class="op" id="5783363">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5783366">//&nbsp;isFile&nbsp;determines&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;file&nbsp;by&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="5783432">//&nbsp;It&nbsp;reuses&nbsp;openFile&nbsp;instead&nbsp;of&nbsp;adding&nbsp;another&nbsp;function&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5783496">//&nbsp;list&nbsp;in&nbsp;Context.</span><br>
<span class="lineno"></span><span class="keyword" id="5783516">func</span>&nbsp;<span class="op" id="5783521">(</span><span class="ident" id="5783522">ctxt</span>&nbsp;<span class="op" id="5783527">*</span><span class="ident" id="5783528">Context</span><span class="op" id="5783535">)</span>&nbsp;<span class="ident" id="5783537">isFile</span><span class="op" id="5783543">(</span><span class="ident" id="5783544">path</span>&nbsp;<span class="builtintype" id="5783549">string</span><span class="op" id="5783555">)</span>&nbsp;<span class="builtintype" id="5783557">bool</span>&nbsp;<span class="op" id="5783562">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783565">f</span><span class="op" id="5783566">,</span>&nbsp;<span class="ident" id="5783568">err</span>&nbsp;<span class="op" id="5783572">:=</span>&nbsp;<span class="ident" id="5783575">ctxt</span><span class="op" id="5783579">.</span><span class="ident" id="5783580">openFile</span><span class="op" id="5783588">(</span><span class="ident" id="5783589">path</span><span class="op" id="5783593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783596">if</span>&nbsp;<span class="ident" id="5783599">err</span>&nbsp;<span class="op" id="5783603">!=</span>&nbsp;<span class="ident" id="5783606">nil</span>&nbsp;<span class="op" id="5783610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783614">return</span>&nbsp;<span class="builtintype" id="5783621">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5783628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5783631">f</span><span class="op" id="5783632">.</span><span class="ident" id="5783633">Close</span><span class="op" id="5783638">(</span><span class="op" id="5783639">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783642">return</span>&nbsp;<span class="builtintype" id="5783649">true</span><br>
<span class="lineno"></span><span class="op" id="5783654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5783657">//&nbsp;gopath&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;path&nbsp;directories.</span><br>
<span class="lineno"></span><span class="keyword" id="5783708">func</span>&nbsp;<span class="op" id="5783713">(</span><span class="ident" id="5783714">ctxt</span>&nbsp;<span class="op" id="5783719">*</span><span class="ident" id="5783720">Context</span><span class="op" id="5783727">)</span>&nbsp;<span class="ident" id="5783729">gopath</span><span class="op" id="5783735">(</span><span class="op" id="5783736">)</span>&nbsp;<span class="op" id="5783738">[</span><span class="op" id="5783739">]</span><span class="builtintype" id="5783740">string</span>&nbsp;<span class="op" id="5783747">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783750">var</span>&nbsp;<span class="ident" id="5783754">all</span>&nbsp;<span class="op" id="5783758">[</span><span class="op" id="5783759">]</span><span class="builtintype" id="5783760">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783768">for</span>&nbsp;<span class="ident" id="5783772">_</span><span class="op" id="5783773">,</span>&nbsp;<span class="ident" id="5783775">p</span>&nbsp;<span class="op" id="5783777">:=</span>&nbsp;<span class="keyword" id="5783780">range</span>&nbsp;<span class="ident" id="5783786">ctxt</span><span class="op" id="5783790">.</span><span class="ident" id="5783791">splitPathList</span><span class="op" id="5783804">(</span><span class="ident" id="5783805">ctxt</span><span class="op" id="5783809">.</span><span class="ident" id="5783810">GOPATH</span><span class="op" id="5783816">)</span>&nbsp;<span class="op" id="5783818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5783822">if</span>&nbsp;<span class="ident" id="5783825">p</span>&nbsp;<span class="op" id="5783827">==</span>&nbsp;<span class="string" id="5783830">&#34;&#34;</span>&nbsp;<span class="op" id="5783833">||</span>&nbsp;<span class="ident" id="5783836">p</span>&nbsp;<span class="op" id="5783838">==</span>&nbsp;<span class="ident" id="5783841">ctxt</span><span class="op" id="5783845">.</span><span class="ident" id="5783846">GOROOT</span>&nbsp;<span class="op" id="5783853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5783858">//&nbsp;Empty&nbsp;paths&nbsp;are&nbsp;uninteresting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5783895">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;the&nbsp;GOROOT,&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5783939">//&nbsp;People&nbsp;sometimes&nbsp;set&nbsp;GOPATH=$GOROOT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5783982">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this&nbsp;common&nbsp;mistake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5784032">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5784043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5784047">if</span>&nbsp;<span class="ident" id="5784050">strings</span><span class="op" id="5784057">.</span><span class="ident" id="5784058">HasPrefix</span><span class="op" id="5784067">(</span><span class="ident" id="5784068">p</span><span class="op" id="5784069">,</span>&nbsp;<span class="string" id="5784071">&#34;~&#34;</span><span class="op" id="5784074">)</span>&nbsp;<span class="op" id="5784076">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784081">//&nbsp;Path&nbsp;segments&nbsp;starting&nbsp;with&nbsp;~&nbsp;on&nbsp;Unix&nbsp;are&nbsp;almost&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784143">//&nbsp;users&nbsp;who&nbsp;have&nbsp;incorrectly&nbsp;quoted&nbsp;~&nbsp;while&nbsp;setting&nbsp;GOPATH,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784207">//&nbsp;preventing&nbsp;it&nbsp;from&nbsp;expanding&nbsp;to&nbsp;$HOME.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784252">//&nbsp;The&nbsp;situation&nbsp;is&nbsp;made&nbsp;more&nbsp;confusing&nbsp;by&nbsp;the&nbsp;fact&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784312">//&nbsp;bash&nbsp;allows&nbsp;quoted&nbsp;~&nbsp;in&nbsp;$PATH&nbsp;(most&nbsp;shells&nbsp;do&nbsp;not).</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784370">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this,&nbsp;and&nbsp;do&nbsp;not&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784437">//&nbsp;It&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;printing&nbsp;errors&nbsp;about&nbsp;it&nbsp;confuses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784500">//&nbsp;those&nbsp;users&nbsp;even&nbsp;more,&nbsp;because&nbsp;they&nbsp;think&nbsp;&#34;sure&nbsp;~&nbsp;exists!&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784566">//&nbsp;The&nbsp;go&nbsp;command&nbsp;diagnoses&nbsp;this&nbsp;situation&nbsp;and&nbsp;prints&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784625">//&nbsp;useful&nbsp;error.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784645">//&nbsp;On&nbsp;Windows,&nbsp;~&nbsp;is&nbsp;used&nbsp;in&nbsp;short&nbsp;names,&nbsp;such&nbsp;as&nbsp;c:\progra~1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5784709">//&nbsp;for&nbsp;c:\program&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5784737">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5784748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5784752">all</span>&nbsp;<span class="op" id="5784756">=</span>&nbsp;<span class="builtinfunc" id="5784758">append</span><span class="op" id="5784764">(</span><span class="ident" id="5784765">all</span><span class="op" id="5784768">,</span>&nbsp;<span class="ident" id="5784770">p</span><span class="op" id="5784771">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5784774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5784777">return</span>&nbsp;<span class="ident" id="5784784">all</span><br>
<span class="lineno"></span><span class="op" id="5784788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5784791">//&nbsp;SrcDirs&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;package&nbsp;source&nbsp;root&nbsp;directories.</span><br>
<span class="lineno">235</span><span class="comment" id="5784853">//&nbsp;It&nbsp;draws&nbsp;from&nbsp;the&nbsp;current&nbsp;Go&nbsp;root&nbsp;and&nbsp;Go&nbsp;path&nbsp;but&nbsp;omits&nbsp;directories</span><br>
<span class="lineno"></span><span class="comment" id="5784924">//&nbsp;that&nbsp;do&nbsp;not&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="5784946">func</span>&nbsp;<span class="op" id="5784951">(</span><span class="ident" id="5784952">ctxt</span>&nbsp;<span class="op" id="5784957">*</span><span class="ident" id="5784958">Context</span><span class="op" id="5784965">)</span>&nbsp;<span class="ident" id="5784967">SrcDirs</span><span class="op" id="5784974">(</span><span class="op" id="5784975">)</span>&nbsp;<span class="op" id="5784977">[</span><span class="op" id="5784978">]</span><span class="builtintype" id="5784979">string</span>&nbsp;<span class="op" id="5784986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5784989">var</span>&nbsp;<span class="ident" id="5784993">all</span>&nbsp;<span class="op" id="5784997">[</span><span class="op" id="5784998">]</span><span class="builtintype" id="5784999">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785007">if</span>&nbsp;<span class="ident" id="5785010">ctxt</span><span class="op" id="5785014">.</span><span class="ident" id="5785015">GOROOT</span>&nbsp;<span class="op" id="5785022">!=</span>&nbsp;<span class="string" id="5785025">&#34;&#34;</span>&nbsp;<span class="op" id="5785028">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785032">dir</span>&nbsp;<span class="op" id="5785036">:=</span>&nbsp;<span class="ident" id="5785039">ctxt</span><span class="op" id="5785043">.</span><span class="ident" id="5785044">joinPath</span><span class="op" id="5785052">(</span><span class="ident" id="5785053">ctxt</span><span class="op" id="5785057">.</span><span class="ident" id="5785058">GOROOT</span><span class="op" id="5785064">,</span>&nbsp;<span class="string" id="5785066">&#34;src&#34;</span><span class="op" id="5785071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785075">if</span>&nbsp;<span class="ident" id="5785078">ctxt</span><span class="op" id="5785082">.</span><span class="ident" id="5785083">isDir</span><span class="op" id="5785088">(</span><span class="ident" id="5785089">dir</span><span class="op" id="5785092">)</span>&nbsp;<span class="op" id="5785094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785099">all</span>&nbsp;<span class="op" id="5785103">=</span>&nbsp;<span class="builtinfunc" id="5785105">append</span><span class="op" id="5785111">(</span><span class="ident" id="5785112">all</span><span class="op" id="5785115">,</span>&nbsp;<span class="ident" id="5785117">dir</span><span class="op" id="5785120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785127">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785130">for</span>&nbsp;<span class="ident" id="5785134">_</span><span class="op" id="5785135">,</span>&nbsp;<span class="ident" id="5785137">p</span>&nbsp;<span class="op" id="5785139">:=</span>&nbsp;<span class="keyword" id="5785142">range</span>&nbsp;<span class="ident" id="5785148">ctxt</span><span class="op" id="5785152">.</span><span class="ident" id="5785153">gopath</span><span class="op" id="5785159">(</span><span class="op" id="5785160">)</span>&nbsp;<span class="op" id="5785162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785166">dir</span>&nbsp;<span class="op" id="5785170">:=</span>&nbsp;<span class="ident" id="5785173">ctxt</span><span class="op" id="5785177">.</span><span class="ident" id="5785178">joinPath</span><span class="op" id="5785186">(</span><span class="ident" id="5785187">p</span><span class="op" id="5785188">,</span>&nbsp;<span class="string" id="5785190">&#34;src&#34;</span><span class="op" id="5785195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785199">if</span>&nbsp;<span class="ident" id="5785202">ctxt</span><span class="op" id="5785206">.</span><span class="ident" id="5785207">isDir</span><span class="op" id="5785212">(</span><span class="ident" id="5785213">dir</span><span class="op" id="5785216">)</span>&nbsp;<span class="op" id="5785218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5785223">all</span>&nbsp;<span class="op" id="5785227">=</span>&nbsp;<span class="builtinfunc" id="5785229">append</span><span class="op" id="5785235">(</span><span class="ident" id="5785236">all</span><span class="op" id="5785239">,</span>&nbsp;<span class="ident" id="5785241">dir</span><span class="op" id="5785244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785248">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5785251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5785254">return</span>&nbsp;<span class="ident" id="5785261">all</span><br>
<span class="lineno"></span><span class="op" id="5785265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5785268">//&nbsp;Default&nbsp;is&nbsp;the&nbsp;default&nbsp;Context&nbsp;for&nbsp;builds.</span><br>
<span class="lineno">255</span><span class="comment" id="5785314">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;GOARCH,&nbsp;GOOS,&nbsp;GOROOT,&nbsp;and&nbsp;GOPATH&nbsp;environment&nbsp;variables</span><br>
<span class="lineno"></span><span class="comment" id="5785384">//&nbsp;if&nbsp;set,&nbsp;or&nbsp;else&nbsp;the&nbsp;compiled&nbsp;code&#39;s&nbsp;GOARCH,&nbsp;GOOS,&nbsp;and&nbsp;GOROOT.</span><br>
<span class="lineno"></span><span class="keyword" id="5785449">var</span>&nbsp;<span class="ident" id="5785453">Default</span>&nbsp;<span class="ident" id="5785461">Context</span>&nbsp;<span class="op" id="5785469">=</span>&nbsp;<span class="ident" id="5785471">defaultContext</span><span class="op" id="5785485">(</span><span class="op" id="5785486">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5785489">var</span>&nbsp;<span class="ident" id="5785493">cgoEnabled</span>&nbsp;<span class="op" id="5785504">=</span>&nbsp;<span class="keyword" id="5785506">map</span><span class="op" id="5785509">[</span><span class="builtintype" id="5785510">string</span><span class="op" id="5785516">]</span><span class="builtintype" id="5785517">bool</span><span class="op" id="5785521">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785524">&#34;darwin/386&#34;</span><span class="op" id="5785536">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785543">true</span><span class="op" id="5785547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785550">&#34;darwin/amd64&#34;</span><span class="op" id="5785564">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785569">true</span><span class="op" id="5785573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785576">&#34;dragonfly/386&#34;</span><span class="op" id="5785591">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785595">true</span><span class="op" id="5785599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785602">&#34;dragonfly/amd64&#34;</span><span class="op" id="5785619">:</span>&nbsp;<span class="builtintype" id="5785621">true</span><span class="op" id="5785625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785628">&#34;freebsd/386&#34;</span><span class="op" id="5785641">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785647">true</span><span class="op" id="5785651">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785654">&#34;freebsd/amd64&#34;</span><span class="op" id="5785669">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785673">true</span><span class="op" id="5785677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785680">&#34;freebsd/arm&#34;</span><span class="op" id="5785693">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785699">true</span><span class="op" id="5785703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785706">&#34;linux/386&#34;</span><span class="op" id="5785717">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785725">true</span><span class="op" id="5785729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785732">&#34;linux/amd64&#34;</span><span class="op" id="5785745">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785751">true</span><span class="op" id="5785755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785758">&#34;linux/arm&#34;</span><span class="op" id="5785769">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785777">true</span><span class="op" id="5785781">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785784">&#34;android/386&#34;</span><span class="op" id="5785797">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785803">true</span><span class="op" id="5785807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785810">&#34;android/amd64&#34;</span><span class="op" id="5785825">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785829">true</span><span class="op" id="5785833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785836">&#34;android/arm&#34;</span><span class="op" id="5785849">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785855">true</span><span class="op" id="5785859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785862">&#34;netbsd/386&#34;</span><span class="op" id="5785874">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785881">true</span><span class="op" id="5785885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785888">&#34;netbsd/amd64&#34;</span><span class="op" id="5785902">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785907">true</span><span class="op" id="5785911">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785914">&#34;netbsd/arm&#34;</span><span class="op" id="5785926">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785933">true</span><span class="op" id="5785937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785940">&#34;openbsd/386&#34;</span><span class="op" id="5785953">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785959">true</span><span class="op" id="5785963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785966">&#34;openbsd/amd64&#34;</span><span class="op" id="5785981">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5785985">true</span><span class="op" id="5785989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785992">&#34;windows/386&#34;</span><span class="op" id="5786005">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5786011">true</span><span class="op" id="5786015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5786018">&#34;windows/amd64&#34;</span><span class="op" id="5786033">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5786037">true</span><span class="op" id="5786041">,</span><br>
<span class="lineno">280</span><span class="op" id="5786043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5786046">func</span>&nbsp;<span class="ident" id="5786051">defaultContext</span><span class="op" id="5786065">(</span><span class="op" id="5786066">)</span>&nbsp;<span class="ident" id="5786068">Context</span>&nbsp;<span class="op" id="5786076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786079">var</span>&nbsp;<span class="ident" id="5786083">c</span>&nbsp;<span class="ident" id="5786085">Context</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786095">c</span><span class="op" id="5786096">.</span><span class="ident" id="5786097">GOARCH</span>&nbsp;<span class="op" id="5786104">=</span>&nbsp;<span class="ident" id="5786106">envOr</span><span class="op" id="5786111">(</span><span class="string" id="5786112">&#34;GOARCH&#34;</span><span class="op" id="5786120">,</span>&nbsp;<span class="ident" id="5786122">runtime</span><span class="op" id="5786129">.</span><span class="ident" id="5786130">GOARCH</span><span class="op" id="5786136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786139">c</span><span class="op" id="5786140">.</span><span class="ident" id="5786141">GOOS</span>&nbsp;<span class="op" id="5786146">=</span>&nbsp;<span class="ident" id="5786148">envOr</span><span class="op" id="5786153">(</span><span class="string" id="5786154">&#34;GOOS&#34;</span><span class="op" id="5786160">,</span>&nbsp;<span class="ident" id="5786162">runtime</span><span class="op" id="5786169">.</span><span class="ident" id="5786170">GOOS</span><span class="op" id="5786174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786177">c</span><span class="op" id="5786178">.</span><span class="ident" id="5786179">GOROOT</span>&nbsp;<span class="op" id="5786186">=</span>&nbsp;<span class="ident" id="5786188">runtime</span><span class="op" id="5786195">.</span><span class="ident" id="5786196">GOROOT</span><span class="op" id="5786202">(</span><span class="op" id="5786203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786206">c</span><span class="op" id="5786207">.</span><span class="ident" id="5786208">GOPATH</span>&nbsp;<span class="op" id="5786215">=</span>&nbsp;<span class="ident" id="5786217">envOr</span><span class="op" id="5786222">(</span><span class="string" id="5786223">&#34;GOPATH&#34;</span><span class="op" id="5786231">,</span>&nbsp;<span class="string" id="5786233">&#34;&#34;</span><span class="op" id="5786235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786238">c</span><span class="op" id="5786239">.</span><span class="ident" id="5786240">Compiler</span>&nbsp;<span class="op" id="5786249">=</span>&nbsp;<span class="ident" id="5786251">runtime</span><span class="op" id="5786258">.</span><span class="ident" id="5786259">Compiler</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786270">//&nbsp;Each&nbsp;major&nbsp;Go&nbsp;release&nbsp;in&nbsp;the&nbsp;Go&nbsp;1.x&nbsp;series&nbsp;should&nbsp;add&nbsp;a&nbsp;tag&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786340">//&nbsp;Old&nbsp;tags&nbsp;should&nbsp;not&nbsp;be&nbsp;removed.&nbsp;That&nbsp;is,&nbsp;the&nbsp;go1.x&nbsp;tag&nbsp;is&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786410">//&nbsp;in&nbsp;all&nbsp;releases&nbsp;&gt;=&nbsp;Go&nbsp;1.x.&nbsp;Code&nbsp;that&nbsp;requires&nbsp;Go&nbsp;1.x&nbsp;or&nbsp;later&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786483">//&nbsp;say&nbsp;&#34;+build&nbsp;go1.x&#34;,&nbsp;and&nbsp;code&nbsp;that&nbsp;should&nbsp;only&nbsp;be&nbsp;built&nbsp;before&nbsp;Go&nbsp;1.x</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786556">//&nbsp;(perhaps&nbsp;it&nbsp;is&nbsp;the&nbsp;stub&nbsp;to&nbsp;use&nbsp;in&nbsp;that&nbsp;case)&nbsp;should&nbsp;say&nbsp;&#34;+build&nbsp;!go1.x&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786633">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786637">//&nbsp;When&nbsp;we&nbsp;reach&nbsp;Go&nbsp;1.5&nbsp;the&nbsp;line&nbsp;will&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786681">//&nbsp;&nbsp;&nbsp;&nbspc.ReleaseTags&nbsp;=&nbsp;[]string{&#34;go1.1&#34;,&nbsp;&#34;go1.2&#34;,&nbsp;&#34;go1.3&#34;,&nbsp;&#34;go1.4&#34;,&nbsp;&#34;go1.5&#34;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786755">//&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786770">c</span><span class="op" id="5786771">.</span><span class="ident" id="5786772">ReleaseTags</span>&nbsp;<span class="op" id="5786784">=</span>&nbsp;<span class="op" id="5786786">[</span><span class="op" id="5786787">]</span><span class="builtintype" id="5786788">string</span><span class="op" id="5786794">{</span><span class="string" id="5786795">&#34;go1.1&#34;</span><span class="op" id="5786802">,</span>&nbsp;<span class="string" id="5786804">&#34;go1.2&#34;</span><span class="op" id="5786811">,</span>&nbsp;<span class="string" id="5786813">&#34;go1.3&#34;</span><span class="op" id="5786820">,</span>&nbsp;<span class="string" id="5786822">&#34;go1.4&#34;</span><span class="op" id="5786829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786833">switch</span>&nbsp;<span class="ident" id="5786840">os</span><span class="op" id="5786842">.</span><span class="ident" id="5786843">Getenv</span><span class="op" id="5786849">(</span><span class="string" id="5786850">&#34;CGO_ENABLED&#34;</span><span class="op" id="5786863">)</span>&nbsp;<span class="op" id="5786865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786868">case</span>&nbsp;<span class="string" id="5786873">&#34;1&#34;</span><span class="op" id="5786876">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786880">c</span><span class="op" id="5786881">.</span><span class="ident" id="5786882">CgoEnabled</span>&nbsp;<span class="op" id="5786893">=</span>&nbsp;<span class="builtintype" id="5786895">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786901">case</span>&nbsp;<span class="string" id="5786906">&#34;0&#34;</span><span class="op" id="5786909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786913">c</span><span class="op" id="5786914">.</span><span class="ident" id="5786915">CgoEnabled</span>&nbsp;<span class="op" id="5786926">=</span>&nbsp;<span class="builtintype" id="5786928">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786935">default</span><span class="op" id="5786942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5786946">//&nbsp;cgo&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;enabled&nbsp;for&nbsp;cross&nbsp;compilation&nbsp;builds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787011">if</span>&nbsp;<span class="ident" id="5787014">runtime</span><span class="op" id="5787021">.</span><span class="ident" id="5787022">GOARCH</span>&nbsp;<span class="op" id="5787029">==</span>&nbsp;<span class="ident" id="5787032">c</span><span class="op" id="5787033">.</span><span class="ident" id="5787034">GOARCH</span>&nbsp;<span class="op" id="5787041">&amp;&amp;</span>&nbsp;<span class="ident" id="5787044">runtime</span><span class="op" id="5787051">.</span><span class="ident" id="5787052">GOOS</span>&nbsp;<span class="op" id="5787057">==</span>&nbsp;<span class="ident" id="5787060">c</span><span class="op" id="5787061">.</span><span class="ident" id="5787062">GOOS</span>&nbsp;<span class="op" id="5787067">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787072">c</span><span class="op" id="5787073">.</span><span class="ident" id="5787074">CgoEnabled</span>&nbsp;<span class="op" id="5787085">=</span>&nbsp;<span class="ident" id="5787087">cgoEnabled</span><span class="op" id="5787097">[</span><span class="ident" id="5787098">c</span><span class="op" id="5787099">.</span><span class="ident" id="5787100">GOOS</span><span class="op" id="5787104">+</span><span class="string" id="5787105">&#34;/&#34;</span><span class="op" id="5787108">+</span><span class="ident" id="5787109">c</span><span class="op" id="5787110">.</span><span class="ident" id="5787111">GOARCH</span><span class="op" id="5787117">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787122">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787134">c</span><span class="op" id="5787135">.</span><span class="ident" id="5787136">CgoEnabled</span>&nbsp;<span class="op" id="5787147">=</span>&nbsp;<span class="builtintype" id="5787149">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787156">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787160">return</span>&nbsp;<span class="ident" id="5787167">c</span><br>
<span class="lineno"></span><span class="op" id="5787169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5787172">func</span>&nbsp;<span class="ident" id="5787177">envOr</span><span class="op" id="5787182">(</span><span class="ident" id="5787183">name</span><span class="op" id="5787187">,</span>&nbsp;<span class="ident" id="5787189">def</span>&nbsp;<span class="builtintype" id="5787193">string</span><span class="op" id="5787199">)</span>&nbsp;<span class="builtintype" id="5787201">string</span>&nbsp;<span class="op" id="5787208">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787211">s</span>&nbsp;<span class="op" id="5787213">:=</span>&nbsp;<span class="ident" id="5787216">os</span><span class="op" id="5787218">.</span><span class="ident" id="5787219">Getenv</span><span class="op" id="5787225">(</span><span class="ident" id="5787226">name</span><span class="op" id="5787230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787233">if</span>&nbsp;<span class="ident" id="5787236">s</span>&nbsp;<span class="op" id="5787238">==</span>&nbsp;<span class="string" id="5787241">&#34;&#34;</span>&nbsp;<span class="op" id="5787244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787248">return</span>&nbsp;<span class="ident" id="5787255">def</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787263">return</span>&nbsp;<span class="ident" id="5787270">s</span><br>
<span class="lineno">325</span><span class="op" id="5787272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5787275">//&nbsp;An&nbsp;ImportMode&nbsp;controls&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;Import&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="5787336">type</span>&nbsp;<span class="ident" id="5787341">ImportMode</span>&nbsp;<span class="builtintype" id="5787352">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="5787358">const</span>&nbsp;<span class="op" id="5787364">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787367">//&nbsp;If&nbsp;FindOnly&nbsp;is&nbsp;set,&nbsp;Import&nbsp;stops&nbsp;after&nbsp;locating&nbsp;the&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787433">//&nbsp;that&nbsp;should&nbsp;contain&nbsp;the&nbsp;sources&nbsp;for&nbsp;a&nbsp;package.&nbsp;&nbsp;It&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787497">//&nbsp;read&nbsp;any&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787534">FindOnly</span>&nbsp;<span class="ident" id="5787543">ImportMode</span>&nbsp;<span class="op" id="5787554">=</span>&nbsp;<span class="num" id="5787556">1</span>&nbsp;<span class="op" id="5787558">&lt;&lt;</span>&nbsp;<span class="ident" id="5787561">iota</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787568">//&nbsp;If&nbsp;AllowBinary&nbsp;is&nbsp;set,&nbsp;Import&nbsp;can&nbsp;be&nbsp;satisfied&nbsp;by&nbsp;a&nbsp;compiled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787633">//&nbsp;package&nbsp;object&nbsp;without&nbsp;corresponding&nbsp;sources.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787683">AllowBinary</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787697">//&nbsp;If&nbsp;ImportComment&nbsp;is&nbsp;set,&nbsp;parse&nbsp;import&nbsp;comments&nbsp;on&nbsp;package&nbsp;statements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787771">//&nbsp;Import&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;finds&nbsp;a&nbsp;comment&nbsp;it&nbsp;cannot&nbsp;understand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787842">//&nbsp;or&nbsp;finds&nbsp;conflicting&nbsp;comments&nbsp;in&nbsp;multiple&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787902">//&nbsp;See&nbsp;golang.org/s/go14customimport&nbsp;for&nbsp;more&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787962">ImportComment</span><br>
<span class="lineno">345</span><span class="op" id="5787976">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5787979">//&nbsp;A&nbsp;Package&nbsp;describes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="5788039">type</span>&nbsp;<span class="ident" id="5788044">Package</span>&nbsp;<span class="keyword" id="5788052">struct</span>&nbsp;<span class="op" id="5788059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788062">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788076">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788085">//&nbsp;directory&nbsp;containing&nbsp;package&nbsp;sources</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788126">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788140">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788149">//&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788166">ImportComment</span>&nbsp;<span class="builtintype" id="5788180">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788189">//&nbsp;path&nbsp;in&nbsp;import&nbsp;comment&nbsp;on&nbsp;package&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788237">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788251">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788260">//&nbsp;documentation&nbsp;synopsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788287">ImportPath</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788301">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788310">//&nbsp;import&nbsp;path&nbsp;of&nbsp;package&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788353">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788367">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788376">//&nbsp;root&nbsp;of&nbsp;Go&nbsp;tree&nbsp;where&nbsp;this&nbsp;package&nbsp;lives</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788421">SrcRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788435">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788444">//&nbsp;package&nbsp;source&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788494">PkgRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788508">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788517">//&nbsp;package&nbsp;install&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788568">BinDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788582">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788591">//&nbsp;command&nbsp;install&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788637">Goroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788651">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5788660">//&nbsp;package&nbsp;found&nbsp;in&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788689">PkgObj</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788703">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788712">//&nbsp;installed&nbsp;.a&nbsp;file</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788734">AllTags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5788748">[</span><span class="op" id="5788749">]</span><span class="builtintype" id="5788750">string</span>&nbsp;<span class="comment" id="5788757">//&nbsp;tags&nbsp;that&nbsp;can&nbsp;influence&nbsp;file&nbsp;selection&nbsp;in&nbsp;this&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788818">ConflictDir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788832">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788841">//&nbsp;this&nbsp;directory&nbsp;shadows&nbsp;Dir&nbsp;in&nbsp;$GOPATH</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5788884">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788901">GoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5788916">[</span><span class="op" id="5788917">]</span><span class="builtintype" id="5788918">string</span>&nbsp;<span class="comment" id="5788925">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;(excluding&nbsp;CgoFiles,&nbsp;TestGoFiles,&nbsp;XTestGoFiles)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788994">CgoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789009">[</span><span class="op" id="5789010">]</span><span class="builtintype" id="5789011">string</span>&nbsp;<span class="comment" id="5789018">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;that&nbsp;import&nbsp;&#34;C&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789055">IgnoredGoFiles</span>&nbsp;<span class="op" id="5789070">[</span><span class="op" id="5789071">]</span><span class="builtintype" id="5789072">string</span>&nbsp;<span class="comment" id="5789079">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;ignored&nbsp;for&nbsp;this&nbsp;build</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789123">CFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789138">[</span><span class="op" id="5789139">]</span><span class="builtintype" id="5789140">string</span>&nbsp;<span class="comment" id="5789147">//&nbsp;.c&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789167">CXXFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789182">[</span><span class="op" id="5789183">]</span><span class="builtintype" id="5789184">string</span>&nbsp;<span class="comment" id="5789191">//&nbsp;.cc,&nbsp;.cpp&nbsp;and&nbsp;.cxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789227">MFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789242">[</span><span class="op" id="5789243">]</span><span class="builtintype" id="5789244">string</span>&nbsp;<span class="comment" id="5789251">//&nbsp;.m&nbsp;(Objective-C)&nbsp;source&nbsp;files</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789285">HFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789300">[</span><span class="op" id="5789301">]</span><span class="builtintype" id="5789302">string</span>&nbsp;<span class="comment" id="5789309">//&nbsp;.h,&nbsp;.hh,&nbsp;.hpp&nbsp;and&nbsp;.hxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789349">SFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789364">[</span><span class="op" id="5789365">]</span><span class="builtintype" id="5789366">string</span>&nbsp;<span class="comment" id="5789373">//&nbsp;.s&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789393">SwigFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789408">[</span><span class="op" id="5789409">]</span><span class="builtintype" id="5789410">string</span>&nbsp;<span class="comment" id="5789417">//&nbsp;.swig&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789433">SwigCXXFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5789448">[</span><span class="op" id="5789449">]</span><span class="builtintype" id="5789450">string</span>&nbsp;<span class="comment" id="5789457">//&nbsp;.swigcxx&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789476">SysoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789491">[</span><span class="op" id="5789492">]</span><span class="builtintype" id="5789493">string</span>&nbsp;<span class="comment" id="5789500">//&nbsp;.syso&nbsp;system&nbsp;object&nbsp;files&nbsp;to&nbsp;add&nbsp;to&nbsp;archive</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5789549">//&nbsp;Cgo&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789568">CgoCFLAGS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789581">[</span><span class="op" id="5789582">]</span><span class="builtintype" id="5789583">string</span>&nbsp;<span class="comment" id="5789590">//&nbsp;Cgo&nbsp;CFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789616">CgoCPPFLAGS</span>&nbsp;&nbsp;<span class="op" id="5789629">[</span><span class="op" id="5789630">]</span><span class="builtintype" id="5789631">string</span>&nbsp;<span class="comment" id="5789638">//&nbsp;Cgo&nbsp;CPPFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789666">CgoCXXFLAGS</span>&nbsp;&nbsp;<span class="op" id="5789679">[</span><span class="op" id="5789680">]</span><span class="builtintype" id="5789681">string</span>&nbsp;<span class="comment" id="5789688">//&nbsp;Cgo&nbsp;CXXFLAGS&nbsp;directives</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789716">CgoLDFLAGS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5789729">[</span><span class="op" id="5789730">]</span><span class="builtintype" id="5789731">string</span>&nbsp;<span class="comment" id="5789738">//&nbsp;Cgo&nbsp;LDFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789765">CgoPkgConfig</span>&nbsp;<span class="op" id="5789778">[</span><span class="op" id="5789779">]</span><span class="builtintype" id="5789780">string</span>&nbsp;<span class="comment" id="5789787">//&nbsp;Cgo&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5789818">//&nbsp;Dependency&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789845">Imports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5789855">[</span><span class="op" id="5789856">]</span><span class="builtintype" id="5789857">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5789883">//&nbsp;imports&nbsp;from&nbsp;GoFiles,&nbsp;CgoFiles</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789918">ImportPos</span>&nbsp;<span class="keyword" id="5789928">map</span><span class="op" id="5789931">[</span><span class="builtintype" id="5789932">string</span><span class="op" id="5789938">]</span><span class="op" id="5789939">[</span><span class="op" id="5789940">]</span><span class="ident" id="5789941">token</span><span class="op" id="5789946">.</span><span class="ident" id="5789947">Position</span>&nbsp;<span class="comment" id="5789956">//&nbsp;line&nbsp;information&nbsp;for&nbsp;Imports</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5789990">//&nbsp;Test&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5790011">TestGoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790026">[</span><span class="op" id="5790027">]</span><span class="builtintype" id="5790028">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5790054">//&nbsp;_test.go&nbsp;files&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5790084">TestImports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790099">[</span><span class="op" id="5790100">]</span><span class="builtintype" id="5790101">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5790127">//&nbsp;imports&nbsp;from&nbsp;TestGoFiles</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5790156">TestImportPos</span>&nbsp;&nbsp;<span class="keyword" id="5790171">map</span><span class="op" id="5790174">[</span><span class="builtintype" id="5790175">string</span><span class="op" id="5790181">]</span><span class="op" id="5790182">[</span><span class="op" id="5790183">]</span><span class="ident" id="5790184">token</span><span class="op" id="5790189">.</span><span class="ident" id="5790190">Position</span>&nbsp;<span class="comment" id="5790199">//&nbsp;line&nbsp;information&nbsp;for&nbsp;TestImports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5790236">XTestGoFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5790251">[</span><span class="op" id="5790252">]</span><span class="builtintype" id="5790253">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5790279">//&nbsp;_test.go&nbsp;files&nbsp;outside&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5790314">XTestImports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5790329">[</span><span class="op" id="5790330">]</span><span class="builtintype" id="5790331">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5790357">//&nbsp;imports&nbsp;from&nbsp;XTestGoFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5790387">XTestImportPos</span>&nbsp;<span class="keyword" id="5790402">map</span><span class="op" id="5790405">[</span><span class="builtintype" id="5790406">string</span><span class="op" id="5790412">]</span><span class="op" id="5790413">[</span><span class="op" id="5790414">]</span><span class="ident" id="5790415">token</span><span class="op" id="5790420">.</span><span class="ident" id="5790421">Position</span>&nbsp;<span class="comment" id="5790430">//&nbsp;line&nbsp;information&nbsp;for&nbsp;XTestImports</span><br>
<span class="lineno"></span><span class="op" id="5790467">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5790470">//&nbsp;IsCommand&nbsp;reports&nbsp;whether&nbsp;the&nbsp;package&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5790527">//&nbsp;command&nbsp;to&nbsp;be&nbsp;installed&nbsp;(not&nbsp;just&nbsp;a&nbsp;library).</span><br>
<span class="lineno"></span><span class="comment" id="5790576">//&nbsp;Packages&nbsp;named&nbsp;&#34;main&#34;&nbsp;are&nbsp;treated&nbsp;as&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="5790626">func</span>&nbsp;<span class="op" id="5790631">(</span><span class="ident" id="5790632">p</span>&nbsp;<span class="op" id="5790634">*</span><span class="ident" id="5790635">Package</span><span class="op" id="5790642">)</span>&nbsp;<span class="ident" id="5790644">IsCommand</span><span class="op" id="5790653">(</span><span class="op" id="5790654">)</span>&nbsp;<span class="builtintype" id="5790656">bool</span>&nbsp;<span class="op" id="5790661">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790664">return</span>&nbsp;<span class="ident" id="5790671">p</span><span class="op" id="5790672">.</span><span class="ident" id="5790673">Name</span>&nbsp;<span class="op" id="5790678">==</span>&nbsp;<span class="string" id="5790681">&#34;main&#34;</span><br>
<span class="lineno"></span><span class="op" id="5790688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5790691">//&nbsp;ImportDir&nbsp;is&nbsp;like&nbsp;Import&nbsp;but&nbsp;processes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5790757">//&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno">405</span><span class="keyword" id="5790781">func</span>&nbsp;<span class="op" id="5790786">(</span><span class="ident" id="5790787">ctxt</span>&nbsp;<span class="op" id="5790792">*</span><span class="ident" id="5790793">Context</span><span class="op" id="5790800">)</span>&nbsp;<span class="ident" id="5790802">ImportDir</span><span class="op" id="5790811">(</span><span class="ident" id="5790812">dir</span>&nbsp;<span class="builtintype" id="5790816">string</span><span class="op" id="5790822">,</span>&nbsp;<span class="ident" id="5790824">mode</span>&nbsp;<span class="ident" id="5790829">ImportMode</span><span class="op" id="5790839">)</span>&nbsp;<span class="op" id="5790841">(</span><span class="op" id="5790842">*</span><span class="ident" id="5790843">Package</span><span class="op" id="5790850">,</span>&nbsp;<span class="builtintype" id="5790852">error</span><span class="op" id="5790857">)</span>&nbsp;<span class="op" id="5790859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790862">return</span>&nbsp;<span class="ident" id="5790869">ctxt</span><span class="op" id="5790873">.</span><span class="ident" id="5790874">Import</span><span class="op" id="5790880">(</span><span class="string" id="5790881">&#34;.&#34;</span><span class="op" id="5790884">,</span>&nbsp;<span class="ident" id="5790886">dir</span><span class="op" id="5790889">,</span>&nbsp;<span class="ident" id="5790891">mode</span><span class="op" id="5790895">)</span><br>
<span class="lineno"></span><span class="op" id="5790897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5790900">//&nbsp;NoGoError&nbsp;is&nbsp;the&nbsp;error&nbsp;used&nbsp;by&nbsp;Import&nbsp;to&nbsp;describe&nbsp;a&nbsp;directory</span><br>
<span class="lineno">410</span><span class="comment" id="5790965">//&nbsp;containing&nbsp;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files.&nbsp;(It&nbsp;may&nbsp;still&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="5791031">//&nbsp;test&nbsp;files,&nbsp;files&nbsp;hidden&nbsp;by&nbsp;build&nbsp;tags,&nbsp;and&nbsp;so&nbsp;on.)</span><br>
<span class="lineno"></span><span class="keyword" id="5791086">type</span>&nbsp;<span class="ident" id="5791091">NoGoError</span>&nbsp;<span class="keyword" id="5791101">struct</span>&nbsp;<span class="op" id="5791108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791111">Dir</span>&nbsp;<span class="builtintype" id="5791115">string</span><br>
<span class="lineno"></span><span class="op" id="5791122">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="5791125">func</span>&nbsp;<span class="op" id="5791130">(</span><span class="ident" id="5791131">e</span>&nbsp;<span class="op" id="5791133">*</span><span class="ident" id="5791134">NoGoError</span><span class="op" id="5791143">)</span>&nbsp;<span class="ident" id="5791145">Error</span><span class="op" id="5791150">(</span><span class="op" id="5791151">)</span>&nbsp;<span class="builtintype" id="5791153">string</span>&nbsp;<span class="op" id="5791160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791163">return</span>&nbsp;<span class="string" id="5791170">&#34;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="5791205">+</span>&nbsp;<span class="ident" id="5791207">e</span><span class="op" id="5791208">.</span><span class="ident" id="5791209">Dir</span><br>
<span class="lineno"></span><span class="op" id="5791213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="5791216">//&nbsp;MultiplePackageError&nbsp;describes&nbsp;a&nbsp;directory&nbsp;containing</span><br>
<span class="lineno"></span><span class="comment" id="5791273">//&nbsp;multiple&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;for&nbsp;multiple&nbsp;packages.</span><br>
<span class="lineno"></span><span class="keyword" id="5791334">type</span>&nbsp;<span class="ident" id="5791339">MultiplePackageError</span>&nbsp;<span class="keyword" id="5791360">struct</span>&nbsp;<span class="op" id="5791367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791370">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5791379">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5791388">//&nbsp;directory&nbsp;containing&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791419">Packages</span>&nbsp;<span class="op" id="5791428">[</span><span class="op" id="5791429">]</span><span class="builtintype" id="5791430">string</span>&nbsp;<span class="comment" id="5791437">//&nbsp;package&nbsp;names&nbsp;found</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791461">Files</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5791470">[</span><span class="op" id="5791471">]</span><span class="builtintype" id="5791472">string</span>&nbsp;<span class="comment" id="5791479">//&nbsp;corresponding&nbsp;files:&nbsp;Files[i]&nbsp;declares&nbsp;package&nbsp;Packages[i]</span><br>
<span class="lineno"></span><span class="op" id="5791541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5791544">func</span>&nbsp;<span class="op" id="5791549">(</span><span class="ident" id="5791550">e</span>&nbsp;<span class="op" id="5791552">*</span><span class="ident" id="5791553">MultiplePackageError</span><span class="op" id="5791573">)</span>&nbsp;<span class="ident" id="5791575">Error</span><span class="op" id="5791580">(</span><span class="op" id="5791581">)</span>&nbsp;<span class="builtintype" id="5791583">string</span>&nbsp;<span class="op" id="5791590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5791593">//&nbsp;Error&nbsp;string&nbsp;limited&nbsp;to&nbsp;two&nbsp;entries&nbsp;for&nbsp;compatibility.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791652">return</span>&nbsp;<span class="ident" id="5791659">fmt</span><span class="op" id="5791662">.</span><span class="ident" id="5791663">Sprintf</span><span class="op" id="5791670">(</span><span class="string" id="5791671">&#34;found&nbsp;packages&nbsp;%s&nbsp;(%s)&nbsp;and&nbsp;%s&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="5791713">,</span>&nbsp;<span class="ident" id="5791715">e</span><span class="op" id="5791716">.</span><span class="ident" id="5791717">Packages</span><span class="op" id="5791725">[</span><span class="num" id="5791726">0</span><span class="op" id="5791727">]</span><span class="op" id="5791728">,</span>&nbsp;<span class="ident" id="5791730">e</span><span class="op" id="5791731">.</span><span class="ident" id="5791732">Files</span><span class="op" id="5791737">[</span><span class="num" id="5791738">0</span><span class="op" id="5791739">]</span><span class="op" id="5791740">,</span>&nbsp;<span class="ident" id="5791742">e</span><span class="op" id="5791743">.</span><span class="ident" id="5791744">Packages</span><span class="op" id="5791752">[</span><span class="num" id="5791753">1</span><span class="op" id="5791754">]</span><span class="op" id="5791755">,</span>&nbsp;<span class="ident" id="5791757">e</span><span class="op" id="5791758">.</span><span class="ident" id="5791759">Files</span><span class="op" id="5791764">[</span><span class="num" id="5791765">1</span><span class="op" id="5791766">]</span><span class="op" id="5791767">,</span>&nbsp;<span class="ident" id="5791769">e</span><span class="op" id="5791770">.</span><span class="ident" id="5791771">Dir</span><span class="op" id="5791774">)</span><br>
<span class="lineno"></span><span class="op" id="5791776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5791779">func</span>&nbsp;<span class="ident" id="5791784">nameExt</span><span class="op" id="5791791">(</span><span class="ident" id="5791792">name</span>&nbsp;<span class="builtintype" id="5791797">string</span><span class="op" id="5791803">)</span>&nbsp;<span class="builtintype" id="5791805">string</span>&nbsp;<span class="op" id="5791812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791815">i</span>&nbsp;<span class="op" id="5791817">:=</span>&nbsp;<span class="ident" id="5791820">strings</span><span class="op" id="5791827">.</span><span class="ident" id="5791828">LastIndex</span><span class="op" id="5791837">(</span><span class="ident" id="5791838">name</span><span class="op" id="5791842">,</span>&nbsp;<span class="string" id="5791844">&#34;.&#34;</span><span class="op" id="5791847">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791850">if</span>&nbsp;<span class="ident" id="5791853">i</span>&nbsp;<span class="op" id="5791855">&lt;</span>&nbsp;<span class="num" id="5791857">0</span>&nbsp;<span class="op" id="5791859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791863">return</span>&nbsp;<span class="string" id="5791870">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5791874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791877">return</span>&nbsp;<span class="ident" id="5791884">name</span><span class="op" id="5791888">[</span><span class="ident" id="5791889">i</span><span class="op" id="5791890">:</span><span class="op" id="5791891">]</span><br>
<span class="lineno"></span><span class="op" id="5791893">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="5791896">//&nbsp;Import&nbsp;returns&nbsp;details&nbsp;about&nbsp;the&nbsp;Go&nbsp;package&nbsp;named&nbsp;by&nbsp;the&nbsp;import&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="5791969">//&nbsp;interpreting&nbsp;local&nbsp;import&nbsp;paths&nbsp;relative&nbsp;to&nbsp;the&nbsp;srcDir&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="5792038">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;a&nbsp;local&nbsp;import&nbsp;path&nbsp;naming&nbsp;a&nbsp;package&nbsp;that&nbsp;can&nbsp;be&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="5792114">//&nbsp;using&nbsp;a&nbsp;standard&nbsp;import&nbsp;path,&nbsp;the&nbsp;returned&nbsp;package&nbsp;will&nbsp;set&nbsp;p.ImportPath</span><br>
<span class="lineno">445</span><span class="comment" id="5792190">//&nbsp;to&nbsp;that&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="5792207">//</span><br>
<span class="lineno"></span><span class="comment" id="5792210">//&nbsp;In&nbsp;the&nbsp;directory&nbsp;containing&nbsp;the&nbsp;package,&nbsp;.go,&nbsp;.c,&nbsp;.h,&nbsp;and&nbsp;.s&nbsp;files&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="5792284">//&nbsp;considered&nbsp;part&nbsp;of&nbsp;the&nbsp;package&nbsp;except&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="5792330">//</span><br>
<span class="lineno">450</span><span class="comment" id="5792333">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;.go&nbsp;files&nbsp;in&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span><span class="comment" id="5792373">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;starting&nbsp;with&nbsp;_&nbsp;or&nbsp;.&nbsp;(likely&nbsp;editor&nbsp;temporary&nbsp;files)</span><br>
<span class="lineno"></span><span class="comment" id="5792437">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;with&nbsp;build&nbsp;constraints&nbsp;not&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;context</span><br>
<span class="lineno"></span><span class="comment" id="5792500">//</span><br>
<span class="lineno"></span><span class="comment" id="5792503">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;Import&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;and&nbsp;a&nbsp;non-nil</span><br>
<span class="lineno">455</span><span class="comment" id="5792571">//&nbsp;*Package&nbsp;containing&nbsp;partial&nbsp;information.</span><br>
<span class="lineno"></span><span class="comment" id="5792615">//</span><br>
<span class="lineno"></span><span class="keyword" id="5792618">func</span>&nbsp;<span class="op" id="5792623">(</span><span class="ident" id="5792624">ctxt</span>&nbsp;<span class="op" id="5792629">*</span><span class="ident" id="5792630">Context</span><span class="op" id="5792637">)</span>&nbsp;<span class="ident" id="5792639">Import</span><span class="op" id="5792645">(</span><span class="ident" id="5792646">path</span>&nbsp;<span class="builtintype" id="5792651">string</span><span class="op" id="5792657">,</span>&nbsp;<span class="ident" id="5792659">srcDir</span>&nbsp;<span class="builtintype" id="5792666">string</span><span class="op" id="5792672">,</span>&nbsp;<span class="ident" id="5792674">mode</span>&nbsp;<span class="ident" id="5792679">ImportMode</span><span class="op" id="5792689">)</span>&nbsp;<span class="op" id="5792691">(</span><span class="op" id="5792692">*</span><span class="ident" id="5792693">Package</span><span class="op" id="5792700">,</span>&nbsp;<span class="builtintype" id="5792702">error</span><span class="op" id="5792707">)</span>&nbsp;<span class="op" id="5792709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792712">p</span>&nbsp;<span class="op" id="5792714">:=</span>&nbsp;<span class="op" id="5792717">&amp;</span><span class="ident" id="5792718">Package</span><span class="op" id="5792725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792729">ImportPath</span><span class="op" id="5792739">:</span>&nbsp;<span class="ident" id="5792741">path</span><span class="op" id="5792745">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792751">if</span>&nbsp;<span class="ident" id="5792754">path</span>&nbsp;<span class="op" id="5792759">==</span>&nbsp;<span class="string" id="5792762">&#34;&#34;</span>&nbsp;<span class="op" id="5792765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792769">return</span>&nbsp;<span class="ident" id="5792776">p</span><span class="op" id="5792777">,</span>&nbsp;<span class="ident" id="5792779">fmt</span><span class="op" id="5792782">.</span><span class="ident" id="5792783">Errorf</span><span class="op" id="5792789">(</span><span class="string" id="5792790">&#34;import&nbsp;%q:&nbsp;invalid&nbsp;import&nbsp;path&#34;</span><span class="op" id="5792822">,</span>&nbsp;<span class="ident" id="5792824">path</span><span class="op" id="5792828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792835">var</span>&nbsp;<span class="ident" id="5792839">pkga</span>&nbsp;<span class="builtintype" id="5792844">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792852">var</span>&nbsp;<span class="ident" id="5792856">pkgerr</span>&nbsp;<span class="builtintype" id="5792863">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792870">switch</span>&nbsp;<span class="ident" id="5792877">ctxt</span><span class="op" id="5792881">.</span><span class="ident" id="5792882">Compiler</span>&nbsp;<span class="op" id="5792891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792894">case</span>&nbsp;<span class="string" id="5792899">&#34;gccgo&#34;</span><span class="op" id="5792906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792910">dir</span><span class="op" id="5792913">,</span>&nbsp;<span class="ident" id="5792915">elem</span>&nbsp;<span class="op" id="5792920">:=</span>&nbsp;<span class="ident" id="5792923">pathpkg</span><span class="op" id="5792930">.</span><span class="ident" id="5792931">Split</span><span class="op" id="5792936">(</span><span class="ident" id="5792937">p</span><span class="op" id="5792938">.</span><span class="ident" id="5792939">ImportPath</span><span class="op" id="5792949">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792953">pkga</span>&nbsp;<span class="op" id="5792958">=</span>&nbsp;<span class="string" id="5792960">&#34;pkg/gccgo_&#34;</span>&nbsp;<span class="op" id="5792973">+</span>&nbsp;<span class="ident" id="5792975">ctxt</span><span class="op" id="5792979">.</span><span class="ident" id="5792980">GOOS</span>&nbsp;<span class="op" id="5792985">+</span>&nbsp;<span class="string" id="5792987">&#34;_&#34;</span>&nbsp;<span class="op" id="5792991">+</span>&nbsp;<span class="ident" id="5792993">ctxt</span><span class="op" id="5792997">.</span><span class="ident" id="5792998">GOARCH</span>&nbsp;<span class="op" id="5793005">+</span>&nbsp;<span class="string" id="5793007">&#34;/&#34;</span>&nbsp;<span class="op" id="5793011">+</span>&nbsp;<span class="ident" id="5793013">dir</span>&nbsp;<span class="op" id="5793017">+</span>&nbsp;<span class="string" id="5793019">&#34;lib&#34;</span>&nbsp;<span class="op" id="5793025">+</span>&nbsp;<span class="ident" id="5793027">elem</span>&nbsp;<span class="op" id="5793032">+</span>&nbsp;<span class="string" id="5793034">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793040">case</span>&nbsp;<span class="string" id="5793045">&#34;gc&#34;</span><span class="op" id="5793049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793053">suffix</span>&nbsp;<span class="op" id="5793060">:=</span>&nbsp;<span class="string" id="5793063">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793068">if</span>&nbsp;<span class="ident" id="5793071">ctxt</span><span class="op" id="5793075">.</span><span class="ident" id="5793076">InstallSuffix</span>&nbsp;<span class="op" id="5793090">!=</span>&nbsp;<span class="string" id="5793093">&#34;&#34;</span>&nbsp;<span class="op" id="5793096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793101">suffix</span>&nbsp;<span class="op" id="5793108">=</span>&nbsp;<span class="string" id="5793110">&#34;_&#34;</span>&nbsp;<span class="op" id="5793114">+</span>&nbsp;<span class="ident" id="5793116">ctxt</span><span class="op" id="5793120">.</span><span class="ident" id="5793121">InstallSuffix</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793141">pkga</span>&nbsp;<span class="op" id="5793146">=</span>&nbsp;<span class="string" id="5793148">&#34;pkg/&#34;</span>&nbsp;<span class="op" id="5793155">+</span>&nbsp;<span class="ident" id="5793157">ctxt</span><span class="op" id="5793161">.</span><span class="ident" id="5793162">GOOS</span>&nbsp;<span class="op" id="5793167">+</span>&nbsp;<span class="string" id="5793169">&#34;_&#34;</span>&nbsp;<span class="op" id="5793173">+</span>&nbsp;<span class="ident" id="5793175">ctxt</span><span class="op" id="5793179">.</span><span class="ident" id="5793180">GOARCH</span>&nbsp;<span class="op" id="5793187">+</span>&nbsp;<span class="ident" id="5793189">suffix</span>&nbsp;<span class="op" id="5793196">+</span>&nbsp;<span class="string" id="5793198">&#34;/&#34;</span>&nbsp;<span class="op" id="5793202">+</span>&nbsp;<span class="ident" id="5793204">p</span><span class="op" id="5793205">.</span><span class="ident" id="5793206">ImportPath</span>&nbsp;<span class="op" id="5793217">+</span>&nbsp;<span class="string" id="5793219">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793225">default</span><span class="op" id="5793232">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5793236">//&nbsp;Save&nbsp;error&nbsp;for&nbsp;end&nbsp;of&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793273">pkgerr</span>&nbsp;<span class="op" id="5793280">=</span>&nbsp;<span class="ident" id="5793282">fmt</span><span class="op" id="5793285">.</span><span class="ident" id="5793286">Errorf</span><span class="op" id="5793292">(</span><span class="string" id="5793293">&#34;import&nbsp;%q:&nbsp;unknown&nbsp;compiler&nbsp;%q&#34;</span><span class="op" id="5793325">,</span>&nbsp;<span class="ident" id="5793327">path</span><span class="op" id="5793331">,</span>&nbsp;<span class="ident" id="5793333">ctxt</span><span class="op" id="5793337">.</span><span class="ident" id="5793338">Compiler</span><span class="op" id="5793346">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793353">binaryOnly</span>&nbsp;<span class="op" id="5793364">:=</span>&nbsp;<span class="builtintype" id="5793367">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793374">if</span>&nbsp;<span class="ident" id="5793377">IsLocalImport</span><span class="op" id="5793390">(</span><span class="ident" id="5793391">path</span><span class="op" id="5793395">)</span>&nbsp;<span class="op" id="5793397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793401">pkga</span>&nbsp;<span class="op" id="5793406">=</span>&nbsp;<span class="string" id="5793408">&#34;&#34;</span>&nbsp;<span class="comment" id="5793411">//&nbsp;local&nbsp;imports&nbsp;have&nbsp;no&nbsp;installed&nbsp;path</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793453">if</span>&nbsp;<span class="ident" id="5793456">srcDir</span>&nbsp;<span class="op" id="5793463">==</span>&nbsp;<span class="string" id="5793466">&#34;&#34;</span>&nbsp;<span class="op" id="5793469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793474">return</span>&nbsp;<span class="ident" id="5793481">p</span><span class="op" id="5793482">,</span>&nbsp;<span class="ident" id="5793484">fmt</span><span class="op" id="5793487">.</span><span class="ident" id="5793488">Errorf</span><span class="op" id="5793494">(</span><span class="string" id="5793495">&#34;import&nbsp;%q:&nbsp;import&nbsp;relative&nbsp;to&nbsp;unknown&nbsp;directory&#34;</span><span class="op" id="5793544">,</span>&nbsp;<span class="ident" id="5793546">path</span><span class="op" id="5793550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793558">if</span>&nbsp;<span class="op" id="5793561">!</span><span class="ident" id="5793562">ctxt</span><span class="op" id="5793566">.</span><span class="ident" id="5793567">isAbsPath</span><span class="op" id="5793576">(</span><span class="ident" id="5793577">path</span><span class="op" id="5793581">)</span>&nbsp;<span class="op" id="5793583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793588">p</span><span class="op" id="5793589">.</span><span class="ident" id="5793590">Dir</span>&nbsp;<span class="op" id="5793594">=</span>&nbsp;<span class="ident" id="5793596">ctxt</span><span class="op" id="5793600">.</span><span class="ident" id="5793601">joinPath</span><span class="op" id="5793609">(</span><span class="ident" id="5793610">srcDir</span><span class="op" id="5793616">,</span>&nbsp;<span class="ident" id="5793618">path</span><span class="op" id="5793622">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5793630">//&nbsp;Determine&nbsp;canonical&nbsp;import&nbsp;path,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793676">if</span>&nbsp;<span class="ident" id="5793679">ctxt</span><span class="op" id="5793683">.</span><span class="ident" id="5793684">GOROOT</span>&nbsp;<span class="op" id="5793691">!=</span>&nbsp;<span class="string" id="5793694">&#34;&#34;</span>&nbsp;<span class="op" id="5793697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793702">root</span>&nbsp;<span class="op" id="5793707">:=</span>&nbsp;<span class="ident" id="5793710">ctxt</span><span class="op" id="5793714">.</span><span class="ident" id="5793715">joinPath</span><span class="op" id="5793723">(</span><span class="ident" id="5793724">ctxt</span><span class="op" id="5793728">.</span><span class="ident" id="5793729">GOROOT</span><span class="op" id="5793735">,</span>&nbsp;<span class="string" id="5793737">&#34;src&#34;</span><span class="op" id="5793742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793747">if</span>&nbsp;<span class="ident" id="5793750">sub</span><span class="op" id="5793753">,</span>&nbsp;<span class="ident" id="5793755">ok</span>&nbsp;<span class="op" id="5793758">:=</span>&nbsp;<span class="ident" id="5793761">ctxt</span><span class="op" id="5793765">.</span><span class="ident" id="5793766">hasSubdir</span><span class="op" id="5793775">(</span><span class="ident" id="5793776">root</span><span class="op" id="5793780">,</span>&nbsp;<span class="ident" id="5793782">p</span><span class="op" id="5793783">.</span><span class="ident" id="5793784">Dir</span><span class="op" id="5793787">)</span><span class="op" id="5793788">;</span>&nbsp;<span class="ident" id="5793790">ok</span>&nbsp;<span class="op" id="5793793">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793799">p</span><span class="op" id="5793800">.</span><span class="ident" id="5793801">Goroot</span>&nbsp;<span class="op" id="5793808">=</span>&nbsp;<span class="builtintype" id="5793810">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793819">p</span><span class="op" id="5793820">.</span><span class="ident" id="5793821">ImportPath</span>&nbsp;<span class="op" id="5793832">=</span>&nbsp;<span class="ident" id="5793834">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793842">p</span><span class="op" id="5793843">.</span><span class="ident" id="5793844">Root</span>&nbsp;<span class="op" id="5793849">=</span>&nbsp;<span class="ident" id="5793851">ctxt</span><span class="op" id="5793855">.</span><span class="ident" id="5793856">GOROOT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793867">goto</span>&nbsp;<span class="ident" id="5793872">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793881">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793889">all</span>&nbsp;<span class="op" id="5793893">:=</span>&nbsp;<span class="ident" id="5793896">ctxt</span><span class="op" id="5793900">.</span><span class="ident" id="5793901">gopath</span><span class="op" id="5793907">(</span><span class="op" id="5793908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793912">for</span>&nbsp;<span class="ident" id="5793916">i</span><span class="op" id="5793917">,</span>&nbsp;<span class="ident" id="5793919">root</span>&nbsp;<span class="op" id="5793924">:=</span>&nbsp;<span class="keyword" id="5793927">range</span>&nbsp;<span class="ident" id="5793933">all</span>&nbsp;<span class="op" id="5793937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793942">rootsrc</span>&nbsp;<span class="op" id="5793950">:=</span>&nbsp;<span class="ident" id="5793953">ctxt</span><span class="op" id="5793957">.</span><span class="ident" id="5793958">joinPath</span><span class="op" id="5793966">(</span><span class="ident" id="5793967">root</span><span class="op" id="5793971">,</span>&nbsp;<span class="string" id="5793973">&#34;src&#34;</span><span class="op" id="5793978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793983">if</span>&nbsp;<span class="ident" id="5793986">sub</span><span class="op" id="5793989">,</span>&nbsp;<span class="ident" id="5793991">ok</span>&nbsp;<span class="op" id="5793994">:=</span>&nbsp;<span class="ident" id="5793997">ctxt</span><span class="op" id="5794001">.</span><span class="ident" id="5794002">hasSubdir</span><span class="op" id="5794011">(</span><span class="ident" id="5794012">rootsrc</span><span class="op" id="5794019">,</span>&nbsp;<span class="ident" id="5794021">p</span><span class="op" id="5794022">.</span><span class="ident" id="5794023">Dir</span><span class="op" id="5794026">)</span><span class="op" id="5794027">;</span>&nbsp;<span class="ident" id="5794029">ok</span>&nbsp;<span class="op" id="5794032">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794038">//&nbsp;We&nbsp;found&nbsp;a&nbsp;potential&nbsp;import&nbsp;path&nbsp;for&nbsp;dir,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794087">//&nbsp;but&nbsp;check&nbsp;that&nbsp;using&nbsp;it&nbsp;wouldn&#39;t&nbsp;find&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794142">//&nbsp;else&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794161">if</span>&nbsp;<span class="ident" id="5794164">ctxt</span><span class="op" id="5794168">.</span><span class="ident" id="5794169">GOROOT</span>&nbsp;<span class="op" id="5794176">!=</span>&nbsp;<span class="string" id="5794179">&#34;&#34;</span>&nbsp;<span class="op" id="5794182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794189">if</span>&nbsp;<span class="ident" id="5794192">dir</span>&nbsp;<span class="op" id="5794196">:=</span>&nbsp;<span class="ident" id="5794199">ctxt</span><span class="op" id="5794203">.</span><span class="ident" id="5794204">joinPath</span><span class="op" id="5794212">(</span><span class="ident" id="5794213">ctxt</span><span class="op" id="5794217">.</span><span class="ident" id="5794218">GOROOT</span><span class="op" id="5794224">,</span>&nbsp;<span class="string" id="5794226">&#34;src&#34;</span><span class="op" id="5794231">,</span>&nbsp;<span class="ident" id="5794233">sub</span><span class="op" id="5794236">)</span><span class="op" id="5794237">;</span>&nbsp;<span class="ident" id="5794239">ctxt</span><span class="op" id="5794243">.</span><span class="ident" id="5794244">isDir</span><span class="op" id="5794249">(</span><span class="ident" id="5794250">dir</span><span class="op" id="5794253">)</span>&nbsp;<span class="op" id="5794255">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794263">p</span><span class="op" id="5794264">.</span><span class="ident" id="5794265">ConflictDir</span>&nbsp;<span class="op" id="5794277">=</span>&nbsp;<span class="ident" id="5794279">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794289">goto</span>&nbsp;<span class="ident" id="5794294">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794317">for</span>&nbsp;<span class="ident" id="5794321">_</span><span class="op" id="5794322">,</span>&nbsp;<span class="ident" id="5794324">earlyRoot</span>&nbsp;<span class="op" id="5794334">:=</span>&nbsp;<span class="keyword" id="5794337">range</span>&nbsp;<span class="ident" id="5794343">all</span><span class="op" id="5794346">[</span><span class="op" id="5794347">:</span><span class="ident" id="5794348">i</span><span class="op" id="5794349">]</span>&nbsp;<span class="op" id="5794351">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794358">if</span>&nbsp;<span class="ident" id="5794361">dir</span>&nbsp;<span class="op" id="5794365">:=</span>&nbsp;<span class="ident" id="5794368">ctxt</span><span class="op" id="5794372">.</span><span class="ident" id="5794373">joinPath</span><span class="op" id="5794381">(</span><span class="ident" id="5794382">earlyRoot</span><span class="op" id="5794391">,</span>&nbsp;<span class="string" id="5794393">&#34;src&#34;</span><span class="op" id="5794398">,</span>&nbsp;<span class="ident" id="5794400">sub</span><span class="op" id="5794403">)</span><span class="op" id="5794404">;</span>&nbsp;<span class="ident" id="5794406">ctxt</span><span class="op" id="5794410">.</span><span class="ident" id="5794411">isDir</span><span class="op" id="5794416">(</span><span class="ident" id="5794417">dir</span><span class="op" id="5794420">)</span>&nbsp;<span class="op" id="5794422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794430">p</span><span class="op" id="5794431">.</span><span class="ident" id="5794432">ConflictDir</span>&nbsp;<span class="op" id="5794444">=</span>&nbsp;<span class="ident" id="5794446">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794456">goto</span>&nbsp;<span class="ident" id="5794461">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794478">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794485">//&nbsp;sub&nbsp;would&nbsp;not&nbsp;name&nbsp;some&nbsp;other&nbsp;directory&nbsp;instead&nbsp;of&nbsp;this&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794553">//&nbsp;Record&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794571">p</span><span class="op" id="5794572">.</span><span class="ident" id="5794573">ImportPath</span>&nbsp;<span class="op" id="5794584">=</span>&nbsp;<span class="ident" id="5794586">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794594">p</span><span class="op" id="5794595">.</span><span class="ident" id="5794596">Root</span>&nbsp;<span class="op" id="5794601">=</span>&nbsp;<span class="ident" id="5794603">root</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794612">goto</span>&nbsp;<span class="ident" id="5794617">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794634">//&nbsp;It&#39;s&nbsp;okay&nbsp;that&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;a&nbsp;root&nbsp;containing&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794692">//&nbsp;Keep&nbsp;going&nbsp;with&nbsp;the&nbsp;information&nbsp;we&nbsp;have.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794737">}</span>&nbsp;<span class="keyword" id="5794739">else</span>&nbsp;<span class="op" id="5794744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794748">if</span>&nbsp;<span class="ident" id="5794751">strings</span><span class="op" id="5794758">.</span><span class="ident" id="5794759">HasPrefix</span><span class="op" id="5794768">(</span><span class="ident" id="5794769">path</span><span class="op" id="5794773">,</span>&nbsp;<span class="string" id="5794775">&#34;/&#34;</span><span class="op" id="5794778">)</span>&nbsp;<span class="op" id="5794780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794785">return</span>&nbsp;<span class="ident" id="5794792">p</span><span class="op" id="5794793">,</span>&nbsp;<span class="ident" id="5794795">fmt</span><span class="op" id="5794798">.</span><span class="ident" id="5794799">Errorf</span><span class="op" id="5794805">(</span><span class="string" id="5794806">&#34;import&nbsp;%q:&nbsp;cannot&nbsp;import&nbsp;absolute&nbsp;path&#34;</span><span class="op" id="5794846">,</span>&nbsp;<span class="ident" id="5794848">path</span><span class="op" id="5794852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794861">//&nbsp;tried&nbsp;records&nbsp;the&nbsp;location&nbsp;of&nbsp;unsuccessful&nbsp;package&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794925">var</span>&nbsp;<span class="ident" id="5794929">tried</span>&nbsp;<span class="keyword" id="5794935">struct</span>&nbsp;<span class="op" id="5794942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794947">goroot</span>&nbsp;<span class="builtintype" id="5794954">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794964">gopath</span>&nbsp;<span class="op" id="5794971">[</span><span class="op" id="5794972">]</span><span class="builtintype" id="5794973">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794982">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794987">//&nbsp;Determine&nbsp;directory&nbsp;from&nbsp;import&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795030">if</span>&nbsp;<span class="ident" id="5795033">ctxt</span><span class="op" id="5795037">.</span><span class="ident" id="5795038">GOROOT</span>&nbsp;<span class="op" id="5795045">!=</span>&nbsp;<span class="string" id="5795048">&#34;&#34;</span>&nbsp;<span class="op" id="5795051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795056">dir</span>&nbsp;<span class="op" id="5795060">:=</span>&nbsp;<span class="ident" id="5795063">ctxt</span><span class="op" id="5795067">.</span><span class="ident" id="5795068">joinPath</span><span class="op" id="5795076">(</span><span class="ident" id="5795077">ctxt</span><span class="op" id="5795081">.</span><span class="ident" id="5795082">GOROOT</span><span class="op" id="5795088">,</span>&nbsp;<span class="string" id="5795090">&#34;src&#34;</span><span class="op" id="5795095">,</span>&nbsp;<span class="ident" id="5795097">path</span><span class="op" id="5795101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795106">isDir</span>&nbsp;<span class="op" id="5795112">:=</span>&nbsp;<span class="ident" id="5795115">ctxt</span><span class="op" id="5795119">.</span><span class="ident" id="5795120">isDir</span><span class="op" id="5795125">(</span><span class="ident" id="5795126">dir</span><span class="op" id="5795129">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795134">binaryOnly</span>&nbsp;<span class="op" id="5795145">=</span>&nbsp;<span class="op" id="5795147">!</span><span class="ident" id="5795148">isDir</span>&nbsp;<span class="op" id="5795154">&amp;&amp;</span>&nbsp;<span class="ident" id="5795157">mode</span><span class="op" id="5795161">&amp;</span><span class="ident" id="5795162">AllowBinary</span>&nbsp;<span class="op" id="5795174">!=</span>&nbsp;<span class="num" id="5795177">0</span>&nbsp;<span class="op" id="5795179">&amp;&amp;</span>&nbsp;<span class="ident" id="5795182">pkga</span>&nbsp;<span class="op" id="5795187">!=</span>&nbsp;<span class="string" id="5795190">&#34;&#34;</span>&nbsp;<span class="op" id="5795193">&amp;&amp;</span>&nbsp;<span class="ident" id="5795196">ctxt</span><span class="op" id="5795200">.</span><span class="ident" id="5795201">isFile</span><span class="op" id="5795207">(</span><span class="ident" id="5795208">ctxt</span><span class="op" id="5795212">.</span><span class="ident" id="5795213">joinPath</span><span class="op" id="5795221">(</span><span class="ident" id="5795222">ctxt</span><span class="op" id="5795226">.</span><span class="ident" id="5795227">GOROOT</span><span class="op" id="5795233">,</span>&nbsp;<span class="ident" id="5795235">pkga</span><span class="op" id="5795239">)</span><span class="op" id="5795240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795245">if</span>&nbsp;<span class="ident" id="5795248">isDir</span>&nbsp;<span class="op" id="5795254">||</span>&nbsp;<span class="ident" id="5795257">binaryOnly</span>&nbsp;<span class="op" id="5795268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795274">p</span><span class="op" id="5795275">.</span><span class="ident" id="5795276">Dir</span>&nbsp;<span class="op" id="5795280">=</span>&nbsp;<span class="ident" id="5795282">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795290">p</span><span class="op" id="5795291">.</span><span class="ident" id="5795292">Goroot</span>&nbsp;<span class="op" id="5795299">=</span>&nbsp;<span class="builtintype" id="5795301">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795310">p</span><span class="op" id="5795311">.</span><span class="ident" id="5795312">Root</span>&nbsp;<span class="op" id="5795317">=</span>&nbsp;<span class="ident" id="5795319">ctxt</span><span class="op" id="5795323">.</span><span class="ident" id="5795324">GOROOT</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795335">goto</span>&nbsp;<span class="ident" id="5795340">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795354">tried</span><span class="op" id="5795359">.</span><span class="ident" id="5795360">goroot</span>&nbsp;<span class="op" id="5795367">=</span>&nbsp;<span class="ident" id="5795369">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795379">for</span>&nbsp;<span class="ident" id="5795383">_</span><span class="op" id="5795384">,</span>&nbsp;<span class="ident" id="5795386">root</span>&nbsp;<span class="op" id="5795391">:=</span>&nbsp;<span class="keyword" id="5795394">range</span>&nbsp;<span class="ident" id="5795400">ctxt</span><span class="op" id="5795404">.</span><span class="ident" id="5795405">gopath</span><span class="op" id="5795411">(</span><span class="op" id="5795412">)</span>&nbsp;<span class="op" id="5795414">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795419">dir</span>&nbsp;<span class="op" id="5795423">:=</span>&nbsp;<span class="ident" id="5795426">ctxt</span><span class="op" id="5795430">.</span><span class="ident" id="5795431">joinPath</span><span class="op" id="5795439">(</span><span class="ident" id="5795440">root</span><span class="op" id="5795444">,</span>&nbsp;<span class="string" id="5795446">&#34;src&#34;</span><span class="op" id="5795451">,</span>&nbsp;<span class="ident" id="5795453">path</span><span class="op" id="5795457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795462">isDir</span>&nbsp;<span class="op" id="5795468">:=</span>&nbsp;<span class="ident" id="5795471">ctxt</span><span class="op" id="5795475">.</span><span class="ident" id="5795476">isDir</span><span class="op" id="5795481">(</span><span class="ident" id="5795482">dir</span><span class="op" id="5795485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795490">binaryOnly</span>&nbsp;<span class="op" id="5795501">=</span>&nbsp;<span class="op" id="5795503">!</span><span class="ident" id="5795504">isDir</span>&nbsp;<span class="op" id="5795510">&amp;&amp;</span>&nbsp;<span class="ident" id="5795513">mode</span><span class="op" id="5795517">&amp;</span><span class="ident" id="5795518">AllowBinary</span>&nbsp;<span class="op" id="5795530">!=</span>&nbsp;<span class="num" id="5795533">0</span>&nbsp;<span class="op" id="5795535">&amp;&amp;</span>&nbsp;<span class="ident" id="5795538">pkga</span>&nbsp;<span class="op" id="5795543">!=</span>&nbsp;<span class="string" id="5795546">&#34;&#34;</span>&nbsp;<span class="op" id="5795549">&amp;&amp;</span>&nbsp;<span class="ident" id="5795552">ctxt</span><span class="op" id="5795556">.</span><span class="ident" id="5795557">isFile</span><span class="op" id="5795563">(</span><span class="ident" id="5795564">ctxt</span><span class="op" id="5795568">.</span><span class="ident" id="5795569">joinPath</span><span class="op" id="5795577">(</span><span class="ident" id="5795578">root</span><span class="op" id="5795582">,</span>&nbsp;<span class="ident" id="5795584">pkga</span><span class="op" id="5795588">)</span><span class="op" id="5795589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795594">if</span>&nbsp;<span class="ident" id="5795597">isDir</span>&nbsp;<span class="op" id="5795603">||</span>&nbsp;<span class="ident" id="5795606">binaryOnly</span>&nbsp;<span class="op" id="5795617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795623">p</span><span class="op" id="5795624">.</span><span class="ident" id="5795625">Dir</span>&nbsp;<span class="op" id="5795629">=</span>&nbsp;<span class="ident" id="5795631">dir</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795639">p</span><span class="op" id="5795640">.</span><span class="ident" id="5795641">Root</span>&nbsp;<span class="op" id="5795646">=</span>&nbsp;<span class="ident" id="5795648">root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795657">goto</span>&nbsp;<span class="ident" id="5795662">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795676">tried</span><span class="op" id="5795681">.</span><span class="ident" id="5795682">gopath</span>&nbsp;<span class="op" id="5795689">=</span>&nbsp;<span class="builtinfunc" id="5795691">append</span><span class="op" id="5795697">(</span><span class="ident" id="5795698">tried</span><span class="op" id="5795703">.</span><span class="ident" id="5795704">gopath</span><span class="op" id="5795710">,</span>&nbsp;<span class="ident" id="5795712">dir</span><span class="op" id="5795715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795719">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5795724">//&nbsp;package&nbsp;was&nbsp;not&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795751">var</span>&nbsp;<span class="ident" id="5795755">paths</span>&nbsp;<span class="op" id="5795761">[</span><span class="op" id="5795762">]</span><span class="builtintype" id="5795763">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795772">if</span>&nbsp;<span class="ident" id="5795775">tried</span><span class="op" id="5795780">.</span><span class="ident" id="5795781">goroot</span>&nbsp;<span class="op" id="5795788">!=</span>&nbsp;<span class="string" id="5795791">&#34;&#34;</span>&nbsp;<span class="op" id="5795794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795799">paths</span>&nbsp;<span class="op" id="5795805">=</span>&nbsp;<span class="builtinfunc" id="5795807">append</span><span class="op" id="5795813">(</span><span class="ident" id="5795814">paths</span><span class="op" id="5795819">,</span>&nbsp;<span class="ident" id="5795821">fmt</span><span class="op" id="5795824">.</span><span class="ident" id="5795825">Sprintf</span><span class="op" id="5795832">(</span><span class="string" id="5795833">&#34;\t%s&nbsp;(from&nbsp;$GOROOT)&#34;</span><span class="op" id="5795854">,</span>&nbsp;<span class="ident" id="5795856">tried</span><span class="op" id="5795861">.</span><span class="ident" id="5795862">goroot</span><span class="op" id="5795868">)</span><span class="op" id="5795869">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795873">}</span>&nbsp;<span class="keyword" id="5795875">else</span>&nbsp;<span class="op" id="5795880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795885">paths</span>&nbsp;<span class="op" id="5795891">=</span>&nbsp;<span class="builtinfunc" id="5795893">append</span><span class="op" id="5795899">(</span><span class="ident" id="5795900">paths</span><span class="op" id="5795905">,</span>&nbsp;<span class="string" id="5795907">&#34;\t($GOROOT&nbsp;not&nbsp;set)&#34;</span><span class="op" id="5795928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795936">var</span>&nbsp;<span class="ident" id="5795940">i</span>&nbsp;<span class="builtintype" id="5795942">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795948">var</span>&nbsp;<span class="ident" id="5795952">format</span>&nbsp;<span class="op" id="5795959">=</span>&nbsp;<span class="string" id="5795961">&#34;\t%s&nbsp;(from&nbsp;$GOPATH)&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795985">for</span>&nbsp;<span class="op" id="5795989">;</span>&nbsp;<span class="ident" id="5795991">i</span>&nbsp;<span class="op" id="5795993">&lt;</span>&nbsp;<span class="builtinfunc" id="5795995">len</span><span class="op" id="5795998">(</span><span class="ident" id="5795999">tried</span><span class="op" id="5796004">.</span><span class="ident" id="5796005">gopath</span><span class="op" id="5796011">)</span><span class="op" id="5796012">;</span>&nbsp;<span class="ident" id="5796014">i</span><span class="op" id="5796015">++</span>&nbsp;<span class="op" id="5796018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796023">if</span>&nbsp;<span class="ident" id="5796026">i</span>&nbsp;<span class="op" id="5796028">&gt;</span>&nbsp;<span class="num" id="5796030">0</span>&nbsp;<span class="op" id="5796032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796038">format</span>&nbsp;<span class="op" id="5796045">=</span>&nbsp;<span class="string" id="5796047">&#34;\t%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796062">paths</span>&nbsp;<span class="op" id="5796068">=</span>&nbsp;<span class="builtinfunc" id="5796070">append</span><span class="op" id="5796076">(</span><span class="ident" id="5796077">paths</span><span class="op" id="5796082">,</span>&nbsp;<span class="ident" id="5796084">fmt</span><span class="op" id="5796087">.</span><span class="ident" id="5796088">Sprintf</span><span class="op" id="5796095">(</span><span class="ident" id="5796096">format</span><span class="op" id="5796102">,</span>&nbsp;<span class="ident" id="5796104">tried</span><span class="op" id="5796109">.</span><span class="ident" id="5796110">gopath</span><span class="op" id="5796116">[</span><span class="ident" id="5796117">i</span><span class="op" id="5796118">]</span><span class="op" id="5796119">)</span><span class="op" id="5796120">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796128">if</span>&nbsp;<span class="ident" id="5796131">i</span>&nbsp;<span class="op" id="5796133">==</span>&nbsp;<span class="num" id="5796136">0</span>&nbsp;<span class="op" id="5796138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796143">paths</span>&nbsp;<span class="op" id="5796149">=</span>&nbsp;<span class="builtinfunc" id="5796151">append</span><span class="op" id="5796157">(</span><span class="ident" id="5796158">paths</span><span class="op" id="5796163">,</span>&nbsp;<span class="string" id="5796165">&#34;\t($GOPATH&nbsp;not&nbsp;set)&#34;</span><span class="op" id="5796186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796194">return</span>&nbsp;<span class="ident" id="5796201">p</span><span class="op" id="5796202">,</span>&nbsp;<span class="ident" id="5796204">fmt</span><span class="op" id="5796207">.</span><span class="ident" id="5796208">Errorf</span><span class="op" id="5796214">(</span><span class="string" id="5796215">&#34;cannot&nbsp;find&nbsp;package&nbsp;%q&nbsp;in&nbsp;any&nbsp;of:\n%s&#34;</span><span class="op" id="5796254">,</span>&nbsp;<span class="ident" id="5796256">path</span><span class="op" id="5796260">,</span>&nbsp;<span class="ident" id="5796262">strings</span><span class="op" id="5796269">.</span><span class="ident" id="5796270">Join</span><span class="op" id="5796274">(</span><span class="ident" id="5796275">paths</span><span class="op" id="5796280">,</span>&nbsp;<span class="string" id="5796282">&#34;\n&#34;</span><span class="op" id="5796286">)</span><span class="op" id="5796287">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="5796293">Found</span><span class="op" id="5796298">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796301">if</span>&nbsp;<span class="ident" id="5796304">p</span><span class="op" id="5796305">.</span><span class="ident" id="5796306">Root</span>&nbsp;<span class="op" id="5796311">!=</span>&nbsp;<span class="string" id="5796314">&#34;&#34;</span>&nbsp;<span class="op" id="5796317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796321">p</span><span class="op" id="5796322">.</span><span class="ident" id="5796323">SrcRoot</span>&nbsp;<span class="op" id="5796331">=</span>&nbsp;<span class="ident" id="5796333">ctxt</span><span class="op" id="5796337">.</span><span class="ident" id="5796338">joinPath</span><span class="op" id="5796346">(</span><span class="ident" id="5796347">p</span><span class="op" id="5796348">.</span><span class="ident" id="5796349">Root</span><span class="op" id="5796353">,</span>&nbsp;<span class="string" id="5796355">&#34;src&#34;</span><span class="op" id="5796360">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796364">p</span><span class="op" id="5796365">.</span><span class="ident" id="5796366">PkgRoot</span>&nbsp;<span class="op" id="5796374">=</span>&nbsp;<span class="ident" id="5796376">ctxt</span><span class="op" id="5796380">.</span><span class="ident" id="5796381">joinPath</span><span class="op" id="5796389">(</span><span class="ident" id="5796390">p</span><span class="op" id="5796391">.</span><span class="ident" id="5796392">Root</span><span class="op" id="5796396">,</span>&nbsp;<span class="string" id="5796398">&#34;pkg&#34;</span><span class="op" id="5796403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796407">p</span><span class="op" id="5796408">.</span><span class="ident" id="5796409">BinDir</span>&nbsp;<span class="op" id="5796416">=</span>&nbsp;<span class="ident" id="5796418">ctxt</span><span class="op" id="5796422">.</span><span class="ident" id="5796423">joinPath</span><span class="op" id="5796431">(</span><span class="ident" id="5796432">p</span><span class="op" id="5796433">.</span><span class="ident" id="5796434">Root</span><span class="op" id="5796438">,</span>&nbsp;<span class="string" id="5796440">&#34;bin&#34;</span><span class="op" id="5796445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796449">if</span>&nbsp;<span class="ident" id="5796452">pkga</span>&nbsp;<span class="op" id="5796457">!=</span>&nbsp;<span class="string" id="5796460">&#34;&#34;</span>&nbsp;<span class="op" id="5796463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796468">p</span><span class="op" id="5796469">.</span><span class="ident" id="5796470">PkgObj</span>&nbsp;<span class="op" id="5796477">=</span>&nbsp;<span class="ident" id="5796479">ctxt</span><span class="op" id="5796483">.</span><span class="ident" id="5796484">joinPath</span><span class="op" id="5796492">(</span><span class="ident" id="5796493">p</span><span class="op" id="5796494">.</span><span class="ident" id="5796495">Root</span><span class="op" id="5796499">,</span>&nbsp;<span class="ident" id="5796501">pkga</span><span class="op" id="5796505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796509">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796516">if</span>&nbsp;<span class="ident" id="5796519">mode</span><span class="op" id="5796523">&amp;</span><span class="ident" id="5796524">FindOnly</span>&nbsp;<span class="op" id="5796533">!=</span>&nbsp;<span class="num" id="5796536">0</span>&nbsp;<span class="op" id="5796538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796542">return</span>&nbsp;<span class="ident" id="5796549">p</span><span class="op" id="5796550">,</span>&nbsp;<span class="ident" id="5796552">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796560">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796563">if</span>&nbsp;<span class="ident" id="5796566">binaryOnly</span>&nbsp;<span class="op" id="5796577">&amp;&amp;</span>&nbsp;<span class="op" id="5796580">(</span><span class="ident" id="5796581">mode</span><span class="op" id="5796585">&amp;</span><span class="ident" id="5796586">AllowBinary</span><span class="op" id="5796597">)</span>&nbsp;<span class="op" id="5796599">!=</span>&nbsp;<span class="num" id="5796602">0</span>&nbsp;<span class="op" id="5796604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796608">return</span>&nbsp;<span class="ident" id="5796615">p</span><span class="op" id="5796616">,</span>&nbsp;<span class="ident" id="5796618">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796630">dirs</span><span class="op" id="5796634">,</span>&nbsp;<span class="ident" id="5796636">err</span>&nbsp;<span class="op" id="5796640">:=</span>&nbsp;<span class="ident" id="5796643">ctxt</span><span class="op" id="5796647">.</span><span class="ident" id="5796648">readDir</span><span class="op" id="5796655">(</span><span class="ident" id="5796656">p</span><span class="op" id="5796657">.</span><span class="ident" id="5796658">Dir</span><span class="op" id="5796661">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796664">if</span>&nbsp;<span class="ident" id="5796667">err</span>&nbsp;<span class="op" id="5796671">!=</span>&nbsp;<span class="ident" id="5796674">nil</span>&nbsp;<span class="op" id="5796678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796682">return</span>&nbsp;<span class="ident" id="5796689">p</span><span class="op" id="5796690">,</span>&nbsp;<span class="ident" id="5796692">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796701">var</span>&nbsp;<span class="ident" id="5796705">Sfiles</span>&nbsp;<span class="op" id="5796712">[</span><span class="op" id="5796713">]</span><span class="builtintype" id="5796714">string</span>&nbsp;<span class="comment" id="5796721">//&nbsp;files&nbsp;with&nbsp;&#34;.S&#34;&nbsp;(capital&nbsp;S)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796753">var</span>&nbsp;<span class="ident" id="5796757">firstFile</span><span class="op" id="5796766">,</span>&nbsp;<span class="ident" id="5796768">firstCommentFile</span>&nbsp;<span class="builtintype" id="5796785">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796793">imported</span>&nbsp;<span class="op" id="5796802">:=</span>&nbsp;<span class="builtinfunc" id="5796805">make</span><span class="op" id="5796809">(</span><span class="keyword" id="5796810">map</span><span class="op" id="5796813">[</span><span class="builtintype" id="5796814">string</span><span class="op" id="5796820">]</span><span class="op" id="5796821">[</span><span class="op" id="5796822">]</span><span class="ident" id="5796823">token</span><span class="op" id="5796828">.</span><span class="ident" id="5796829">Position</span><span class="op" id="5796837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796840">testImported</span>&nbsp;<span class="op" id="5796853">:=</span>&nbsp;<span class="builtinfunc" id="5796856">make</span><span class="op" id="5796860">(</span><span class="keyword" id="5796861">map</span><span class="op" id="5796864">[</span><span class="builtintype" id="5796865">string</span><span class="op" id="5796871">]</span><span class="op" id="5796872">[</span><span class="op" id="5796873">]</span><span class="ident" id="5796874">token</span><span class="op" id="5796879">.</span><span class="ident" id="5796880">Position</span><span class="op" id="5796888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796891">xTestImported</span>&nbsp;<span class="op" id="5796905">:=</span>&nbsp;<span class="builtinfunc" id="5796908">make</span><span class="op" id="5796912">(</span><span class="keyword" id="5796913">map</span><span class="op" id="5796916">[</span><span class="builtintype" id="5796917">string</span><span class="op" id="5796923">]</span><span class="op" id="5796924">[</span><span class="op" id="5796925">]</span><span class="ident" id="5796926">token</span><span class="op" id="5796931">.</span><span class="ident" id="5796932">Position</span><span class="op" id="5796940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796943">allTags</span>&nbsp;<span class="op" id="5796951">:=</span>&nbsp;<span class="builtinfunc" id="5796954">make</span><span class="op" id="5796958">(</span><span class="keyword" id="5796959">map</span><span class="op" id="5796962">[</span><span class="builtintype" id="5796963">string</span><span class="op" id="5796969">]</span><span class="builtintype" id="5796970">bool</span><span class="op" id="5796974">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796977">fset</span>&nbsp;<span class="op" id="5796982">:=</span>&nbsp;<span class="ident" id="5796985">token</span><span class="op" id="5796990">.</span><span class="ident" id="5796991">NewFileSet</span><span class="op" id="5797001">(</span><span class="op" id="5797002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797005">for</span>&nbsp;<span class="ident" id="5797009">_</span><span class="op" id="5797010">,</span>&nbsp;<span class="ident" id="5797012">d</span>&nbsp;<span class="op" id="5797014">:=</span>&nbsp;<span class="keyword" id="5797017">range</span>&nbsp;<span class="ident" id="5797023">dirs</span>&nbsp;<span class="op" id="5797028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797032">if</span>&nbsp;<span class="ident" id="5797035">d</span><span class="op" id="5797036">.</span><span class="ident" id="5797037">IsDir</span><span class="op" id="5797042">(</span><span class="op" id="5797043">)</span>&nbsp;<span class="op" id="5797045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797050">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5797061">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797066">name</span>&nbsp;<span class="op" id="5797071">:=</span>&nbsp;<span class="ident" id="5797074">d</span><span class="op" id="5797075">.</span><span class="ident" id="5797076">Name</span><span class="op" id="5797080">(</span><span class="op" id="5797081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797085">ext</span>&nbsp;<span class="op" id="5797089">:=</span>&nbsp;<span class="ident" id="5797092">nameExt</span><span class="op" id="5797099">(</span><span class="ident" id="5797100">name</span><span class="op" id="5797104">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797109">match</span><span class="op" id="5797114">,</span>&nbsp;<span class="ident" id="5797116">data</span><span class="op" id="5797120">,</span>&nbsp;<span class="ident" id="5797122">filename</span><span class="op" id="5797130">,</span>&nbsp;<span class="ident" id="5797132">err</span>&nbsp;<span class="op" id="5797136">:=</span>&nbsp;<span class="ident" id="5797139">ctxt</span><span class="op" id="5797143">.</span><span class="ident" id="5797144">matchFile</span><span class="op" id="5797153">(</span><span class="ident" id="5797154">p</span><span class="op" id="5797155">.</span><span class="ident" id="5797156">Dir</span><span class="op" id="5797159">,</span>&nbsp;<span class="ident" id="5797161">name</span><span class="op" id="5797165">,</span>&nbsp;<span class="builtintype" id="5797167">true</span><span class="op" id="5797171">,</span>&nbsp;<span class="ident" id="5797173">allTags</span><span class="op" id="5797180">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797184">if</span>&nbsp;<span class="ident" id="5797187">err</span>&nbsp;<span class="op" id="5797191">!=</span>&nbsp;<span class="ident" id="5797194">nil</span>&nbsp;<span class="op" id="5797198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797203">return</span>&nbsp;<span class="ident" id="5797210">p</span><span class="op" id="5797211">,</span>&nbsp;<span class="ident" id="5797213">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5797219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797223">if</span>&nbsp;<span class="op" id="5797226">!</span><span class="ident" id="5797227">match</span>&nbsp;<span class="op" id="5797233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797238">if</span>&nbsp;<span class="ident" id="5797241">ext</span>&nbsp;<span class="op" id="5797245">==</span>&nbsp;<span class="string" id="5797248">&#34;.go&#34;</span>&nbsp;<span class="op" id="5797254">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797260">p</span><span class="op" id="5797261">.</span><span class="ident" id="5797262">IgnoredGoFiles</span>&nbsp;<span class="op" id="5797277">=</span>&nbsp;<span class="builtinfunc" id="5797279">append</span><span class="op" id="5797285">(</span><span class="ident" id="5797286">p</span><span class="op" id="5797287">.</span><span class="ident" id="5797288">IgnoredGoFiles</span><span class="op" id="5797302">,</span>&nbsp;<span class="ident" id="5797304">name</span><span class="op" id="5797308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5797313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797318">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5797329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5797334">//&nbsp;Going&nbsp;to&nbsp;save&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;non-Go&nbsp;files,&nbsp;can&nbsp;stop&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797397">switch</span>&nbsp;<span class="ident" id="5797404">ext</span>&nbsp;<span class="op" id="5797408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797412">case</span>&nbsp;<span class="string" id="5797417">&#34;.c&#34;</span><span class="op" id="5797421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797426">p</span><span class="op" id="5797427">.</span><span class="ident" id="5797428">CFiles</span>&nbsp;<span class="op" id="5797435">=</span>&nbsp;<span class="builtinfunc" id="5797437">append</span><span class="op" id="5797443">(</span><span class="ident" id="5797444">p</span><span class="op" id="5797445">.</span><span class="ident" id="5797446">CFiles</span><span class="op" id="5797452">,</span>&nbsp;<span class="ident" id="5797454">name</span><span class="op" id="5797458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797463">continue</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797474">case</span>&nbsp;<span class="string" id="5797479">&#34;.cc&#34;</span><span class="op" id="5797484">,</span>&nbsp;<span class="string" id="5797486">&#34;.cpp&#34;</span><span class="op" id="5797492">,</span>&nbsp;<span class="string" id="5797494">&#34;.cxx&#34;</span><span class="op" id="5797500">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797505">p</span><span class="op" id="5797506">.</span><span class="ident" id="5797507">CXXFiles</span>&nbsp;<span class="op" id="5797516">=</span>&nbsp;<span class="builtinfunc" id="5797518">append</span><span class="op" id="5797524">(</span><span class="ident" id="5797525">p</span><span class="op" id="5797526">.</span><span class="ident" id="5797527">CXXFiles</span><span class="op" id="5797535">,</span>&nbsp;<span class="ident" id="5797537">name</span><span class="op" id="5797541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797546">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797557">case</span>&nbsp;<span class="string" id="5797562">&#34;.m&#34;</span><span class="op" id="5797566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797571">p</span><span class="op" id="5797572">.</span><span class="ident" id="5797573">MFiles</span>&nbsp;<span class="op" id="5797580">=</span>&nbsp;<span class="builtinfunc" id="5797582">append</span><span class="op" id="5797588">(</span><span class="ident" id="5797589">p</span><span class="op" id="5797590">.</span><span class="ident" id="5797591">MFiles</span><span class="op" id="5797597">,</span>&nbsp;<span class="ident" id="5797599">name</span><span class="op" id="5797603">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797608">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797619">case</span>&nbsp;<span class="string" id="5797624">&#34;.h&#34;</span><span class="op" id="5797628">,</span>&nbsp;<span class="string" id="5797630">&#34;.hh&#34;</span><span class="op" id="5797635">,</span>&nbsp;<span class="string" id="5797637">&#34;.hpp&#34;</span><span class="op" id="5797643">,</span>&nbsp;<span class="string" id="5797645">&#34;.hxx&#34;</span><span class="op" id="5797651">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797656">p</span><span class="op" id="5797657">.</span><span class="ident" id="5797658">HFiles</span>&nbsp;<span class="op" id="5797665">=</span>&nbsp;<span class="builtinfunc" id="5797667">append</span><span class="op" id="5797673">(</span><span class="ident" id="5797674">p</span><span class="op" id="5797675">.</span><span class="ident" id="5797676">HFiles</span><span class="op" id="5797682">,</span>&nbsp;<span class="ident" id="5797684">name</span><span class="op" id="5797688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797693">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797704">case</span>&nbsp;<span class="string" id="5797709">&#34;.s&#34;</span><span class="op" id="5797713">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797718">p</span><span class="op" id="5797719">.</span><span class="ident" id="5797720">SFiles</span>&nbsp;<span class="op" id="5797727">=</span>&nbsp;<span class="builtinfunc" id="5797729">append</span><span class="op" id="5797735">(</span><span class="ident" id="5797736">p</span><span class="op" id="5797737">.</span><span class="ident" id="5797738">SFiles</span><span class="op" id="5797744">,</span>&nbsp;<span class="ident" id="5797746">name</span><span class="op" id="5797750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797755">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797766">case</span>&nbsp;<span class="string" id="5797771">&#34;.S&#34;</span><span class="op" id="5797775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797780">Sfiles</span>&nbsp;<span class="op" id="5797787">=</span>&nbsp;<span class="builtinfunc" id="5797789">append</span><span class="op" id="5797795">(</span><span class="ident" id="5797796">Sfiles</span><span class="op" id="5797802">,</span>&nbsp;<span class="ident" id="5797804">name</span><span class="op" id="5797808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797813">continue</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797824">case</span>&nbsp;<span class="string" id="5797829">&#34;.swig&#34;</span><span class="op" id="5797836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797841">p</span><span class="op" id="5797842">.</span><span class="ident" id="5797843">SwigFiles</span>&nbsp;<span class="op" id="5797853">=</span>&nbsp;<span class="builtinfunc" id="5797855">append</span><span class="op" id="5797861">(</span><span class="ident" id="5797862">p</span><span class="op" id="5797863">.</span><span class="ident" id="5797864">SwigFiles</span><span class="op" id="5797873">,</span>&nbsp;<span class="ident" id="5797875">name</span><span class="op" id="5797879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797884">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797895">case</span>&nbsp;<span class="string" id="5797900">&#34;.swigcxx&#34;</span><span class="op" id="5797910">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5797915">p</span><span class="op" id="5797916">.</span><span class="ident" id="5797917">SwigCXXFiles</span>&nbsp;<span class="op" id="5797930">=</span>&nbsp;<span class="builtinfunc" id="5797932">append</span><span class="op" id="5797938">(</span><span class="ident" id="5797939">p</span><span class="op" id="5797940">.</span><span class="ident" id="5797941">SwigCXXFiles</span><span class="op" id="5797953">,</span>&nbsp;<span class="ident" id="5797955">name</span><span class="op" id="5797959">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797964">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5797975">case</span>&nbsp;<span class="string" id="5797980">&#34;.syso&#34;</span><span class="op" id="5797987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5797992">//&nbsp;binary&nbsp;objects&nbsp;to&nbsp;add&nbsp;to&nbsp;package&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5798039">//&nbsp;Likely&nbsp;of&nbsp;the&nbsp;form&nbsp;foo_windows.syso,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5798086">//&nbsp;the&nbsp;name&nbsp;was&nbsp;vetted&nbsp;above&nbsp;with&nbsp;goodOSArchFile.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798139">p</span><span class="op" id="5798140">.</span><span class="ident" id="5798141">SysoFiles</span>&nbsp;<span class="op" id="5798151">=</span>&nbsp;<span class="builtinfunc" id="5798153">append</span><span class="op" id="5798159">(</span><span class="ident" id="5798160">p</span><span class="op" id="5798161">.</span><span class="ident" id="5798162">SysoFiles</span><span class="op" id="5798171">,</span>&nbsp;<span class="ident" id="5798173">name</span><span class="op" id="5798177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798182">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5798193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798198">pf</span><span class="op" id="5798200">,</span>&nbsp;<span class="ident" id="5798202">err</span>&nbsp;<span class="op" id="5798206">:=</span>&nbsp;<span class="ident" id="5798209">parser</span><span class="op" id="5798215">.</span><span class="ident" id="5798216">ParseFile</span><span class="op" id="5798225">(</span><span class="ident" id="5798226">fset</span><span class="op" id="5798230">,</span>&nbsp;<span class="ident" id="5798232">filename</span><span class="op" id="5798240">,</span>&nbsp;<span class="ident" id="5798242">data</span><span class="op" id="5798246">,</span>&nbsp;<span class="ident" id="5798248">parser</span><span class="op" id="5798254">.</span><span class="ident" id="5798255">ImportsOnly</span><span class="op" id="5798266">|</span><span class="ident" id="5798267">parser</span><span class="op" id="5798273">.</span><span class="ident" id="5798274">ParseComments</span><span class="op" id="5798287">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798291">if</span>&nbsp;<span class="ident" id="5798294">err</span>&nbsp;<span class="op" id="5798298">!=</span>&nbsp;<span class="ident" id="5798301">nil</span>&nbsp;<span class="op" id="5798305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798310">return</span>&nbsp;<span class="ident" id="5798317">p</span><span class="op" id="5798318">,</span>&nbsp;<span class="ident" id="5798320">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5798326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798331">pkg</span>&nbsp;<span class="op" id="5798335">:=</span>&nbsp;<span class="ident" id="5798338">pf</span><span class="op" id="5798340">.</span><span class="ident" id="5798341">Name</span><span class="op" id="5798345">.</span><span class="ident" id="5798346">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798353">if</span>&nbsp;<span class="ident" id="5798356">pkg</span>&nbsp;<span class="op" id="5798360">==</span>&nbsp;<span class="string" id="5798363">&#34;documentation&#34;</span>&nbsp;<span class="op" id="5798379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798384">p</span><span class="op" id="5798385">.</span><span class="ident" id="5798386">IgnoredGoFiles</span>&nbsp;<span class="op" id="5798401">=</span>&nbsp;<span class="builtinfunc" id="5798403">append</span><span class="op" id="5798409">(</span><span class="ident" id="5798410">p</span><span class="op" id="5798411">.</span><span class="ident" id="5798412">IgnoredGoFiles</span><span class="op" id="5798426">,</span>&nbsp;<span class="ident" id="5798428">name</span><span class="op" id="5798432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798437">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5798448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798453">isTest</span>&nbsp;<span class="op" id="5798460">:=</span>&nbsp;<span class="ident" id="5798463">strings</span><span class="op" id="5798470">.</span><span class="ident" id="5798471">HasSuffix</span><span class="op" id="5798480">(</span><span class="ident" id="5798481">name</span><span class="op" id="5798485">,</span>&nbsp;<span class="string" id="5798487">&#34;_test.go&#34;</span><span class="op" id="5798497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798501">isXTest</span>&nbsp;<span class="op" id="5798509">:=</span>&nbsp;<span class="builtintype" id="5798512">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798520">if</span>&nbsp;<span class="ident" id="5798523">isTest</span>&nbsp;<span class="op" id="5798530">&amp;&amp;</span>&nbsp;<span class="ident" id="5798533">strings</span><span class="op" id="5798540">.</span><span class="ident" id="5798541">HasSuffix</span><span class="op" id="5798550">(</span><span class="ident" id="5798551">pkg</span><span class="op" id="5798554">,</span>&nbsp;<span class="string" id="5798556">&#34;_test&#34;</span><span class="op" id="5798563">)</span>&nbsp;<span class="op" id="5798565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798570">isXTest</span>&nbsp;<span class="op" id="5798578">=</span>&nbsp;<span class="builtintype" id="5798580">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798588">pkg</span>&nbsp;<span class="op" id="5798592">=</span>&nbsp;<span class="ident" id="5798594">pkg</span><span class="op" id="5798597">[</span><span class="op" id="5798598">:</span><span class="builtinfunc" id="5798599">len</span><span class="op" id="5798602">(</span><span class="ident" id="5798603">pkg</span><span class="op" id="5798606">)</span><span class="op" id="5798607">-</span><span class="builtinfunc" id="5798608">len</span><span class="op" id="5798611">(</span><span class="string" id="5798612">&#34;_test&#34;</span><span class="op" id="5798619">)</span><span class="op" id="5798620">]</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5798624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798629">if</span>&nbsp;<span class="ident" id="5798632">p</span><span class="op" id="5798633">.</span><span class="ident" id="5798634">Name</span>&nbsp;<span class="op" id="5798639">==</span>&nbsp;<span class="string" id="5798642">&#34;&#34;</span>&nbsp;<span class="op" id="5798645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798650">p</span><span class="op" id="5798651">.</span><span class="ident" id="5798652">Name</span>&nbsp;<span class="op" id="5798657">=</span>&nbsp;<span class="ident" id="5798659">pkg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798666">firstFile</span>&nbsp;<span class="op" id="5798676">=</span>&nbsp;<span class="ident" id="5798678">name</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5798685">}</span>&nbsp;<span class="keyword" id="5798687">else</span>&nbsp;<span class="keyword" id="5798692">if</span>&nbsp;<span class="ident" id="5798695">pkg</span>&nbsp;<span class="op" id="5798699">!=</span>&nbsp;<span class="ident" id="5798702">p</span><span class="op" id="5798703">.</span><span class="ident" id="5798704">Name</span>&nbsp;<span class="op" id="5798709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798714">return</span>&nbsp;<span class="ident" id="5798721">p</span><span class="op" id="5798722">,</span>&nbsp;<span class="op" id="5798724">&amp;</span><span class="ident" id="5798725">MultiplePackageError</span><span class="op" id="5798745">{</span><span class="ident" id="5798746">p</span><span class="op" id="5798747">.</span><span class="ident" id="5798748">Dir</span><span class="op" id="5798751">,</span>&nbsp;<span class="op" id="5798753">[</span><span class="op" id="5798754">]</span><span class="builtintype" id="5798755">string</span><span class="op" id="5798761">{</span><span class="ident" id="5798762">firstFile</span><span class="op" id="5798771">,</span>&nbsp;<span class="ident" id="5798773">name</span><span class="op" id="5798777">}</span><span class="op" id="5798778">,</span>&nbsp;<span class="op" id="5798780">[</span><span class="op" id="5798781">]</span><span class="builtintype" id="5798782">string</span><span class="op" id="5798788">{</span><span class="ident" id="5798789">p</span><span class="op" id="5798790">.</span><span class="ident" id="5798791">Name</span><span class="op" id="5798795">,</span>&nbsp;<span class="ident" id="5798797">pkg</span><span class="op" id="5798800">}</span><span class="op" id="5798801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5798805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798809">if</span>&nbsp;<span class="ident" id="5798812">pf</span><span class="op" id="5798814">.</span><span class="ident" id="5798815">Doc</span>&nbsp;<span class="op" id="5798819">!=</span>&nbsp;<span class="ident" id="5798822">nil</span>&nbsp;<span class="op" id="5798826">&amp;&amp;</span>&nbsp;<span class="ident" id="5798829">p</span><span class="op" id="5798830">.</span><span class="ident" id="5798831">Doc</span>&nbsp;<span class="op" id="5798835">==</span>&nbsp;<span class="string" id="5798838">&#34;&#34;</span>&nbsp;<span class="op" id="5798841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798846">p</span><span class="op" id="5798847">.</span><span class="ident" id="5798848">Doc</span>&nbsp;<span class="op" id="5798852">=</span>&nbsp;<span class="ident" id="5798854">doc</span><span class="op" id="5798857">.</span><span class="ident" id="5798858">Synopsis</span><span class="op" id="5798866">(</span><span class="ident" id="5798867">pf</span><span class="op" id="5798869">.</span><span class="ident" id="5798870">Doc</span><span class="op" id="5798873">.</span><span class="ident" id="5798874">Text</span><span class="op" id="5798878">(</span><span class="op" id="5798879">)</span><span class="op" id="5798880">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5798884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798889">if</span>&nbsp;<span class="ident" id="5798892">mode</span><span class="op" id="5798896">&amp;</span><span class="ident" id="5798897">ImportComment</span>&nbsp;<span class="op" id="5798911">!=</span>&nbsp;<span class="num" id="5798914">0</span>&nbsp;<span class="op" id="5798916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798921">qcom</span><span class="op" id="5798925">,</span>&nbsp;<span class="ident" id="5798927">line</span>&nbsp;<span class="op" id="5798932">:=</span>&nbsp;<span class="ident" id="5798935">findImportComment</span><span class="op" id="5798952">(</span><span class="ident" id="5798953">data</span><span class="op" id="5798957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5798962">if</span>&nbsp;<span class="ident" id="5798965">line</span>&nbsp;<span class="op" id="5798970">!=</span>&nbsp;<span class="num" id="5798973">0</span>&nbsp;<span class="op" id="5798975">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5798981">com</span><span class="op" id="5798984">,</span>&nbsp;<span class="ident" id="5798986">err</span>&nbsp;<span class="op" id="5798990">:=</span>&nbsp;<span class="ident" id="5798993">strconv</span><span class="op" id="5799000">.</span><span class="ident" id="5799001">Unquote</span><span class="op" id="5799008">(</span><span class="ident" id="5799009">qcom</span><span class="op" id="5799013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799019">if</span>&nbsp;<span class="ident" id="5799022">err</span>&nbsp;<span class="op" id="5799026">!=</span>&nbsp;<span class="ident" id="5799029">nil</span>&nbsp;<span class="op" id="5799033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799040">return</span>&nbsp;<span class="ident" id="5799047">p</span><span class="op" id="5799048">,</span>&nbsp;<span class="ident" id="5799050">fmt</span><span class="op" id="5799053">.</span><span class="ident" id="5799054">Errorf</span><span class="op" id="5799060">(</span><span class="string" id="5799061">&#34;%s:%d:&nbsp;cannot&nbsp;parse&nbsp;import&nbsp;comment&#34;</span><span class="op" id="5799097">,</span>&nbsp;<span class="ident" id="5799099">filename</span><span class="op" id="5799107">,</span>&nbsp;<span class="ident" id="5799109">line</span><span class="op" id="5799113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5799119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799125">if</span>&nbsp;<span class="ident" id="5799128">p</span><span class="op" id="5799129">.</span><span class="ident" id="5799130">ImportComment</span>&nbsp;<span class="op" id="5799144">==</span>&nbsp;<span class="string" id="5799147">&#34;&#34;</span>&nbsp;<span class="op" id="5799150">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5799157">p</span><span class="op" id="5799158">.</span><span class="ident" id="5799159">ImportComment</span>&nbsp;<span class="op" id="5799173">=</span>&nbsp;<span class="ident" id="5799175">com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5799184">firstCommentFile</span>&nbsp;<span class="op" id="5799201">=</span>&nbsp;<span class="ident" id="5799203">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5799212">}</span>&nbsp;<span class="keyword" id="5799214">else</span>&nbsp;<span class="keyword" id="5799219">if</span>&nbsp;<span class="ident" id="5799222">p</span><span class="op" id="5799223">.</span><span class="ident" id="5799224">ImportComment</span>&nbsp;<span class="op" id="5799238">!=</span>&nbsp;<span class="ident" id="5799241">com</span>&nbsp;<span class="op" id="5799245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799252">return</span>&nbsp;<span class="ident" id="5799259">p</span><span class="op" id="5799260">,</span>&nbsp;<span class="ident" id="5799262">fmt</span><span class="op" id="5799265">.</span><span class="ident" id="5799266">Errorf</span><span class="op" id="5799272">(</span><span class="string" id="5799273">&#34;found&nbsp;import&nbsp;comments&nbsp;%q&nbsp;(%s)&nbsp;and&nbsp;%q&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="5799322">,</span>&nbsp;<span class="ident" id="5799324">p</span><span class="op" id="5799325">.</span><span class="ident" id="5799326">ImportComment</span><span class="op" id="5799339">,</span>&nbsp;<span class="ident" id="5799341">firstCommentFile</span><span class="op" id="5799357">,</span>&nbsp;<span class="ident" id="5799359">com</span><span class="op" id="5799362">,</span>&nbsp;<span class="ident" id="5799364">name</span><span class="op" id="5799368">,</span>&nbsp;<span class="ident" id="5799370">p</span><span class="op" id="5799371">.</span><span class="ident" id="5799372">Dir</span><span class="op" id="5799375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5799381">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5799386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5799390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5799395">//&nbsp;Record&nbsp;imports&nbsp;and&nbsp;information&nbsp;about&nbsp;cgo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5799442">isCgo</span>&nbsp;<span class="op" id="5799448">:=</span>&nbsp;<span class="builtintype" id="5799451">false</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799459">for</span>&nbsp;<span class="ident" id="5799463">_</span><span class="op" id="5799464">,</span>&nbsp;<span class="ident" id="5799466">decl</span>&nbsp;<span class="op" id="5799471">:=</span>&nbsp;<span class="keyword" id="5799474">range</span>&nbsp;<span class="ident" id="5799480">pf</span><span class="op" id="5799482">.</span><span class="ident" id="5799483">Decls</span>&nbsp;<span class="op" id="5799489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5799494">d</span><span class="op" id="5799495">,</span>&nbsp;<span class="ident" id="5799497">ok</span>&nbsp;<span class="op" id="5799500">:=</span>&nbsp;<span class="ident" id="5799503">decl</span><span class="op" id="5799507">.</span><span class="op" id="5799508">(</span><span class="op" id="5799509">*</span><span class="ident" id="5799510">ast</span><span class="op" id="5799513">.</span><span class="ident" id="5799514">GenDecl</span><span class="op" id="5799521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799526">if</span>&nbsp;<span class="op" id="5799529">!</span><span class="ident" id="5799530">ok</span>&nbsp;<span class="op" id="5799533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799539">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5799551">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799556">for</span>&nbsp;<span class="ident" id="5799560">_</span><span class="op" id="5799561">,</span>&nbsp;<span class="ident" id="5799563">dspec</span>&nbsp;<span class="op" id="5799569">:=</span>&nbsp;<span class="keyword" id="5799572">range</span>&nbsp;<span class="ident" id="5799578">d</span><span class="op" id="5799579">.</span><span class="ident" id="5799580">Specs</span>&nbsp;<span class="op" id="5799586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5799592">spec</span><span class="op" id="5799596">,</span>&nbsp;<span class="ident" id="5799598">ok</span>&nbsp;<span class="op" id="5799601">:=</span>&nbsp;<span class="ident" id="5799604">dspec</span><span class="op" id="5799609">.</span><span class="op" id="5799610">(</span><span class="op" id="5799611">*</span><span class="ident" id="5799612">ast</span><span class="op" id="5799615">.</span><span class="ident" id="5799616">ImportSpec</span><span class="op" id="5799626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799632">if</span>&nbsp;<span class="op" id="5799635">!</span><span class="ident" id="5799636">ok</span>&nbsp;<span class="op" id="5799639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799646">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5799659">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5799665">quoted</span>&nbsp;<span class="op" id="5799672">:=</span>&nbsp;<span class="ident" id="5799675">spec</span><span class="op" id="5799679">.</span><span class="ident" id="5799680">Path</span><span class="op" id="5799684">.</span><span class="ident" id="5799685">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5799695">path</span><span class="op" id="5799699">,</span>&nbsp;<span class="ident" id="5799701">err</span>&nbsp;<span class="op" id="5799705">:=</span>&nbsp;<span class="ident" id="5799708">strconv</span><span class="op" id="5799715">.</span><span class="ident" id="5799716">Unquote</span><span class="op" id="5799723">(</span><span class="ident" id="5799724">quoted</span><span class="op" id="5799730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799736">if</span>&nbsp;<span class="ident" id="5799739">err</span>&nbsp;<span class="op" id="5799743">!=</span>&nbsp;<span class="ident" id="5799746">nil</span>&nbsp;<span class="op" id="5799750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5799757">log</span><span class="op" id="5799760">.</span><span class="ident" id="5799761">Panicf</span><span class="op" id="5799767">(</span><span class="string" id="5799768">&#34;%s:&nbsp;parser&nbsp;returned&nbsp;invalid&nbsp;quoted&nbsp;string:&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="5799817">,</span>&nbsp;<span class="ident" id="5799819">filename</span><span class="op" id="5799827">,</span>&nbsp;<span class="ident" id="5799829">quoted</span><span class="op" id="5799835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5799841">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5799847">if</span>&nbsp;<span class="ident" id="5799850">isXTest</span>&nbsp;<span class="op" id="5799858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5799865">xTestImported</span><span class="op" id="5799878">[</span><span class="ident" id="5799879">path</span><span class="op" id="5799883">]</span>&nbsp;<span class="op" id="5799885">=</span>&nbsp;<span class="builtinfunc" id="5799887">append</span><span class="op" id="5799893">(</span><span class="ident" id="5799894">xTestImported</span><span class="op" id="5799907">[</span><span class="ident" id="5799908">path</span><span class="op" id="5799912">]</span><span class="op" id="5799913">,</span>&nbsp;<span class="ident" id="5799915">fset</span><span class="op" id="5799919">.</span><span class="ident" id="5799920">Position</span><span class="op" id="5799928">(</span><span class="ident" id="5799929">spec</span><span class="op" id="5799933">.</span><span class="ident" id="5799934">Pos</span><span class="op" id="5799937">(</span><span class="op" id="5799938">)</span><span class="op" id="5799939">)</span><span class="op" id="5799940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5799946">}</span>&nbsp;<span class="keyword" id="5799948">else</span>&nbsp;<span class="keyword" id="5799953">if</span>&nbsp;<span class="ident" id="5799956">isTest</span>&nbsp;<span class="op" id="5799963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5799970">testImported</span><span class="op" id="5799982">[</span><span class="ident" id="5799983">path</span><span class="op" id="5799987">]</span>&nbsp;<span class="op" id="5799989">=</span>&nbsp;<span class="builtinfunc" id="5799991">append</span><span class="op" id="5799997">(</span><span class="ident" id="5799998">testImported</span><span class="op" id="5800010">[</span><span class="ident" id="5800011">path</span><span class="op" id="5800015">]</span><span class="op" id="5800016">,</span>&nbsp;<span class="ident" id="5800018">fset</span><span class="op" id="5800022">.</span><span class="ident" id="5800023">Position</span><span class="op" id="5800031">(</span><span class="ident" id="5800032">spec</span><span class="op" id="5800036">.</span><span class="ident" id="5800037">Pos</span><span class="op" id="5800040">(</span><span class="op" id="5800041">)</span><span class="op" id="5800042">)</span><span class="op" id="5800043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800049">}</span>&nbsp;<span class="keyword" id="5800051">else</span>&nbsp;<span class="op" id="5800056">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5800063">imported</span><span class="op" id="5800071">[</span><span class="ident" id="5800072">path</span><span class="op" id="5800076">]</span>&nbsp;<span class="op" id="5800078">=</span>&nbsp;<span class="builtinfunc" id="5800080">append</span><span class="op" id="5800086">(</span><span class="ident" id="5800087">imported</span><span class="op" id="5800095">[</span><span class="ident" id="5800096">path</span><span class="op" id="5800100">]</span><span class="op" id="5800101">,</span>&nbsp;<span class="ident" id="5800103">fset</span><span class="op" id="5800107">.</span><span class="ident" id="5800108">Position</span><span class="op" id="5800116">(</span><span class="ident" id="5800117">spec</span><span class="op" id="5800121">.</span><span class="ident" id="5800122">Pos</span><span class="op" id="5800125">(</span><span class="op" id="5800126">)</span><span class="op" id="5800127">)</span><span class="op" id="5800128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800140">if</span>&nbsp;<span class="ident" id="5800143">path</span>&nbsp;<span class="op" id="5800148">==</span>&nbsp;<span class="string" id="5800151">&#34;C&#34;</span>&nbsp;<span class="op" id="5800155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800162">if</span>&nbsp;<span class="ident" id="5800165">isTest</span>&nbsp;<span class="op" id="5800172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800180">return</span>&nbsp;<span class="ident" id="5800187">p</span><span class="op" id="5800188">,</span>&nbsp;<span class="ident" id="5800190">fmt</span><span class="op" id="5800193">.</span><span class="ident" id="5800194">Errorf</span><span class="op" id="5800200">(</span><span class="string" id="5800201">&#34;use&nbsp;of&nbsp;cgo&nbsp;in&nbsp;test&nbsp;%s&nbsp;not&nbsp;supported&#34;</span><span class="op" id="5800238">,</span>&nbsp;<span class="ident" id="5800240">filename</span><span class="op" id="5800248">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5800262">cg</span>&nbsp;<span class="op" id="5800265">:=</span>&nbsp;<span class="ident" id="5800268">spec</span><span class="op" id="5800272">.</span><span class="ident" id="5800273">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800282">if</span>&nbsp;<span class="ident" id="5800285">cg</span>&nbsp;<span class="op" id="5800288">==</span>&nbsp;<span class="ident" id="5800291">nil</span>&nbsp;<span class="op" id="5800295">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5800298">len</span><span class="op" id="5800301">(</span><span class="ident" id="5800302">d</span><span class="op" id="5800303">.</span><span class="ident" id="5800304">Specs</span><span class="op" id="5800309">)</span>&nbsp;<span class="op" id="5800311">==</span>&nbsp;<span class="num" id="5800314">1</span>&nbsp;<span class="op" id="5800316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5800324">cg</span>&nbsp;<span class="op" id="5800327">=</span>&nbsp;<span class="ident" id="5800329">d</span><span class="op" id="5800330">.</span><span class="ident" id="5800331">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800340">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800347">if</span>&nbsp;<span class="ident" id="5800350">cg</span>&nbsp;<span class="op" id="5800353">!=</span>&nbsp;<span class="ident" id="5800356">nil</span>&nbsp;<span class="op" id="5800360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800368">if</span>&nbsp;<span class="ident" id="5800371">err</span>&nbsp;<span class="op" id="5800375">:=</span>&nbsp;<span class="ident" id="5800378">ctxt</span><span class="op" id="5800382">.</span><span class="ident" id="5800383">saveCgo</span><span class="op" id="5800390">(</span><span class="ident" id="5800391">filename</span><span class="op" id="5800399">,</span>&nbsp;<span class="ident" id="5800401">p</span><span class="op" id="5800402">,</span>&nbsp;<span class="ident" id="5800404">cg</span><span class="op" id="5800406">)</span><span class="op" id="5800407">;</span>&nbsp;<span class="ident" id="5800409">err</span>&nbsp;<span class="op" id="5800413">!=</span>&nbsp;<span class="ident" id="5800416">nil</span>&nbsp;<span class="op" id="5800420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800429">return</span>&nbsp;<span class="ident" id="5800436">p</span><span class="op" id="5800437">,</span>&nbsp;<span class="ident" id="5800439">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800456">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5800463">isCgo</span>&nbsp;<span class="op" id="5800469">=</span>&nbsp;<span class="builtintype" id="5800471">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800493">if</span>&nbsp;<span class="ident" id="5800496">isCgo</span>&nbsp;<span class="op" id="5800502">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5800507">allTags</span><span class="op" id="5800514">[</span><span class="string" id="5800515">&#34;cgo&#34;</span><span class="op" id="5800520">]</span>&nbsp;<span class="op" id="5800522">=</span>&nbsp;<span class="builtintype" id="5800524">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800532">if</span>&nbsp;<span class="ident" id="5800535">ctxt</span><span class="op" id="5800539">.</span><span class="ident" id="5800540">CgoEnabled</span>&nbsp;<span class="op" id="5800551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5800557">p</span><span class="op" id="5800558">.</span><span class="ident" id="5800559">CgoFiles</span>&nbsp;<span class="op" id="5800568">=</span>&nbsp;<span class="builtinfunc" id="5800570">append</span><span class="op" id="5800576">(</span><span class="ident" id="5800577">p</span><span class="op" id="5800578">.</span><span class="ident" id="5800579">CgoFiles</span><span class="op" id="5800587">,</span>&nbsp;<span class="ident" id="5800589">name</span><span class="op" id="5800593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800598">}</span>&nbsp;<span class="keyword" id="5800600">else</span>&nbsp;<span class="op" id="5800605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5800611">p</span><span class="op" id="5800612">.</span><span class="ident" id="5800613">IgnoredGoFiles</span>&nbsp;<span class="op" id="5800628">=</span>&nbsp;<span class="builtinfunc" id="5800630">append</span><span class="op" id="5800636">(</span><span class="ident" id="5800637">p</span><span class="op" id="5800638">.</span><span class="ident" id="5800639">IgnoredGoFiles</span><span class="op" id="5800653">,</span>&nbsp;<span class="ident" id="5800655">name</span><span class="op" id="5800659">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800668">}</span>&nbsp;<span class="keyword" id="5800670">else</span>&nbsp;<span class="keyword" id="5800675">if</span>&nbsp;<span class="ident" id="5800678">isXTest</span>&nbsp;<span class="op" id="5800686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5800691">p</span><span class="op" id="5800692">.</span><span class="ident" id="5800693">XTestGoFiles</span>&nbsp;<span class="op" id="5800706">=</span>&nbsp;<span class="builtinfunc" id="5800708">append</span><span class="op" id="5800714">(</span><span class="ident" id="5800715">p</span><span class="op" id="5800716">.</span><span class="ident" id="5800717">XTestGoFiles</span><span class="op" id="5800729">,</span>&nbsp;<span class="ident" id="5800731">name</span><span class="op" id="5800735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800739">}</span>&nbsp;<span class="keyword" id="5800741">else</span>&nbsp;<span class="keyword" id="5800746">if</span>&nbsp;<span class="ident" id="5800749">isTest</span>&nbsp;<span class="op" id="5800756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5800761">p</span><span class="op" id="5800762">.</span><span class="ident" id="5800763">TestGoFiles</span>&nbsp;<span class="op" id="5800775">=</span>&nbsp;<span class="builtinfunc" id="5800777">append</span><span class="op" id="5800783">(</span><span class="ident" id="5800784">p</span><span class="op" id="5800785">.</span><span class="ident" id="5800786">TestGoFiles</span><span class="op" id="5800797">,</span>&nbsp;<span class="ident" id="5800799">name</span><span class="op" id="5800803">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800807">}</span>&nbsp;<span class="keyword" id="5800809">else</span>&nbsp;<span class="op" id="5800814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5800819">p</span><span class="op" id="5800820">.</span><span class="ident" id="5800821">GoFiles</span>&nbsp;<span class="op" id="5800829">=</span>&nbsp;<span class="builtinfunc" id="5800831">append</span><span class="op" id="5800837">(</span><span class="ident" id="5800838">p</span><span class="op" id="5800839">.</span><span class="ident" id="5800840">GoFiles</span><span class="op" id="5800847">,</span>&nbsp;<span class="ident" id="5800849">name</span><span class="op" id="5800853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800863">if</span>&nbsp;<span class="builtinfunc" id="5800866">len</span><span class="op" id="5800869">(</span><span class="ident" id="5800870">p</span><span class="op" id="5800871">.</span><span class="ident" id="5800872">GoFiles</span><span class="op" id="5800879">)</span><span class="op" id="5800880">+</span><span class="builtinfunc" id="5800881">len</span><span class="op" id="5800884">(</span><span class="ident" id="5800885">p</span><span class="op" id="5800886">.</span><span class="ident" id="5800887">CgoFiles</span><span class="op" id="5800895">)</span><span class="op" id="5800896">+</span><span class="builtinfunc" id="5800897">len</span><span class="op" id="5800900">(</span><span class="ident" id="5800901">p</span><span class="op" id="5800902">.</span><span class="ident" id="5800903">TestGoFiles</span><span class="op" id="5800914">)</span><span class="op" id="5800915">+</span><span class="builtinfunc" id="5800916">len</span><span class="op" id="5800919">(</span><span class="ident" id="5800920">p</span><span class="op" id="5800921">.</span><span class="ident" id="5800922">XTestGoFiles</span><span class="op" id="5800934">)</span>&nbsp;<span class="op" id="5800936">==</span>&nbsp;<span class="num" id="5800939">0</span>&nbsp;<span class="op" id="5800941">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800945">return</span>&nbsp;<span class="ident" id="5800952">p</span><span class="op" id="5800953">,</span>&nbsp;<span class="op" id="5800955">&amp;</span><span class="ident" id="5800956">NoGoError</span><span class="op" id="5800965">{</span><span class="ident" id="5800966">p</span><span class="op" id="5800967">.</span><span class="ident" id="5800968">Dir</span><span class="op" id="5800971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5800974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5800978">for</span>&nbsp;<span class="ident" id="5800982">tag</span>&nbsp;<span class="op" id="5800986">:=</span>&nbsp;<span class="keyword" id="5800989">range</span>&nbsp;<span class="ident" id="5800995">allTags</span>&nbsp;<span class="op" id="5801003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801007">p</span><span class="op" id="5801008">.</span><span class="ident" id="5801009">AllTags</span>&nbsp;<span class="op" id="5801017">=</span>&nbsp;<span class="builtinfunc" id="5801019">append</span><span class="op" id="5801025">(</span><span class="ident" id="5801026">p</span><span class="op" id="5801027">.</span><span class="ident" id="5801028">AllTags</span><span class="op" id="5801035">,</span>&nbsp;<span class="ident" id="5801037">tag</span><span class="op" id="5801040">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5801043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801046">sort</span><span class="op" id="5801050">.</span><span class="ident" id="5801051">Strings</span><span class="op" id="5801058">(</span><span class="ident" id="5801059">p</span><span class="op" id="5801060">.</span><span class="ident" id="5801061">AllTags</span><span class="op" id="5801068">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801072">p</span><span class="op" id="5801073">.</span><span class="ident" id="5801074">Imports</span><span class="op" id="5801081">,</span>&nbsp;<span class="ident" id="5801083">p</span><span class="op" id="5801084">.</span><span class="ident" id="5801085">ImportPos</span>&nbsp;<span class="op" id="5801095">=</span>&nbsp;<span class="ident" id="5801097">cleanImports</span><span class="op" id="5801109">(</span><span class="ident" id="5801110">imported</span><span class="op" id="5801118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801121">p</span><span class="op" id="5801122">.</span><span class="ident" id="5801123">TestImports</span><span class="op" id="5801134">,</span>&nbsp;<span class="ident" id="5801136">p</span><span class="op" id="5801137">.</span><span class="ident" id="5801138">TestImportPos</span>&nbsp;<span class="op" id="5801152">=</span>&nbsp;<span class="ident" id="5801154">cleanImports</span><span class="op" id="5801166">(</span><span class="ident" id="5801167">testImported</span><span class="op" id="5801179">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801182">p</span><span class="op" id="5801183">.</span><span class="ident" id="5801184">XTestImports</span><span class="op" id="5801196">,</span>&nbsp;<span class="ident" id="5801198">p</span><span class="op" id="5801199">.</span><span class="ident" id="5801200">XTestImportPos</span>&nbsp;<span class="op" id="5801215">=</span>&nbsp;<span class="ident" id="5801217">cleanImports</span><span class="op" id="5801229">(</span><span class="ident" id="5801230">xTestImported</span><span class="op" id="5801243">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5801247">//&nbsp;add&nbsp;the&nbsp;.S&nbsp;files&nbsp;only&nbsp;if&nbsp;we&nbsp;are&nbsp;using&nbsp;cgo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5801293">//&nbsp;(which&nbsp;means&nbsp;gcc&nbsp;will&nbsp;compile&nbsp;them).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5801334">//&nbsp;The&nbsp;standard&nbsp;assemblers&nbsp;expect&nbsp;.s&nbsp;files.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5801379">if</span>&nbsp;<span class="builtinfunc" id="5801382">len</span><span class="op" id="5801385">(</span><span class="ident" id="5801386">p</span><span class="op" id="5801387">.</span><span class="ident" id="5801388">CgoFiles</span><span class="op" id="5801396">)</span>&nbsp;<span class="op" id="5801398">&gt;</span>&nbsp;<span class="num" id="5801400">0</span>&nbsp;<span class="op" id="5801402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801406">p</span><span class="op" id="5801407">.</span><span class="ident" id="5801408">SFiles</span>&nbsp;<span class="op" id="5801415">=</span>&nbsp;<span class="builtinfunc" id="5801417">append</span><span class="op" id="5801423">(</span><span class="ident" id="5801424">p</span><span class="op" id="5801425">.</span><span class="ident" id="5801426">SFiles</span><span class="op" id="5801432">,</span>&nbsp;<span class="ident" id="5801434">Sfiles</span><span class="op" id="5801440">...</span><span class="op" id="5801443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801447">sort</span><span class="op" id="5801451">.</span><span class="ident" id="5801452">Strings</span><span class="op" id="5801459">(</span><span class="ident" id="5801460">p</span><span class="op" id="5801461">.</span><span class="ident" id="5801462">SFiles</span><span class="op" id="5801468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5801471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5801475">return</span>&nbsp;<span class="ident" id="5801482">p</span><span class="op" id="5801483">,</span>&nbsp;<span class="ident" id="5801485">pkgerr</span><br>
<span class="lineno"></span><span class="op" id="5801492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5801495">func</span>&nbsp;<span class="ident" id="5801500">findImportComment</span><span class="op" id="5801517">(</span><span class="ident" id="5801518">data</span>&nbsp;<span class="op" id="5801523">[</span><span class="op" id="5801524">]</span><span class="builtintype" id="5801525">byte</span><span class="op" id="5801529">)</span>&nbsp;<span class="op" id="5801531">(</span><span class="ident" id="5801532">s</span>&nbsp;<span class="builtintype" id="5801534">string</span><span class="op" id="5801540">,</span>&nbsp;<span class="ident" id="5801542">line</span>&nbsp;<span class="builtintype" id="5801547">int</span><span class="op" id="5801550">)</span>&nbsp;<span class="op" id="5801552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5801555">//&nbsp;expect&nbsp;keyword&nbsp;package</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801582">word</span><span class="op" id="5801586">,</span>&nbsp;<span class="ident" id="5801588">data</span>&nbsp;<span class="op" id="5801593">:=</span>&nbsp;<span class="ident" id="5801596">parseWord</span><span class="op" id="5801605">(</span><span class="ident" id="5801606">data</span><span class="op" id="5801610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5801613">if</span>&nbsp;<span class="builtintype" id="5801616">string</span><span class="op" id="5801622">(</span><span class="ident" id="5801623">word</span><span class="op" id="5801627">)</span>&nbsp;<span class="op" id="5801629">!=</span>&nbsp;<span class="string" id="5801632">&#34;package&#34;</span>&nbsp;<span class="op" id="5801642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5801646">return</span>&nbsp;<span class="string" id="5801653">&#34;&#34;</span><span class="op" id="5801655">,</span>&nbsp;<span class="num" id="5801657">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5801660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5801664">//&nbsp;expect&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801688">_</span><span class="op" id="5801689">,</span>&nbsp;<span class="ident" id="5801691">data</span>&nbsp;<span class="op" id="5801696">=</span>&nbsp;<span class="ident" id="5801698">parseWord</span><span class="op" id="5801707">(</span><span class="ident" id="5801708">data</span><span class="op" id="5801712">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5801716">//&nbsp;now&nbsp;ready&nbsp;for&nbsp;import&nbsp;comment,&nbsp;a&nbsp;//&nbsp;or&nbsp;/*&nbsp;*/&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5801772">//&nbsp;beginning&nbsp;and&nbsp;ending&nbsp;on&nbsp;the&nbsp;current&nbsp;line.</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5801818">for</span>&nbsp;<span class="builtinfunc" id="5801822">len</span><span class="op" id="5801825">(</span><span class="ident" id="5801826">data</span><span class="op" id="5801830">)</span>&nbsp;<span class="op" id="5801832">&gt;</span>&nbsp;<span class="num" id="5801834">0</span>&nbsp;<span class="op" id="5801836">&amp;&amp;</span>&nbsp;<span class="op" id="5801839">(</span><span class="ident" id="5801840">data</span><span class="op" id="5801844">[</span><span class="num" id="5801845">0</span><span class="op" id="5801846">]</span>&nbsp;<span class="op" id="5801848">==</span>&nbsp;<span class="string" id="5801851">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5801855">||</span>&nbsp;<span class="ident" id="5801858">data</span><span class="op" id="5801862">[</span><span class="num" id="5801863">0</span><span class="op" id="5801864">]</span>&nbsp;<span class="op" id="5801866">==</span>&nbsp;<span class="string" id="5801869">&#39;\t&#39;</span>&nbsp;<span class="op" id="5801874">||</span>&nbsp;<span class="ident" id="5801877">data</span><span class="op" id="5801881">[</span><span class="num" id="5801882">0</span><span class="op" id="5801883">]</span>&nbsp;<span class="op" id="5801885">==</span>&nbsp;<span class="string" id="5801888">&#39;\r&#39;</span><span class="op" id="5801892">)</span>&nbsp;<span class="op" id="5801894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801898">data</span>&nbsp;<span class="op" id="5801903">=</span>&nbsp;<span class="ident" id="5801905">data</span><span class="op" id="5801909">[</span><span class="num" id="5801910">1</span><span class="op" id="5801911">:</span><span class="op" id="5801912">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5801915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5801919">var</span>&nbsp;<span class="ident" id="5801923">comment</span>&nbsp;<span class="op" id="5801931">[</span><span class="op" id="5801932">]</span><span class="builtintype" id="5801933">byte</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5801939">switch</span>&nbsp;<span class="op" id="5801946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5801949">case</span>&nbsp;<span class="ident" id="5801954">bytes</span><span class="op" id="5801959">.</span><span class="ident" id="5801960">HasPrefix</span><span class="op" id="5801969">(</span><span class="ident" id="5801970">data</span><span class="op" id="5801974">,</span>&nbsp;<span class="ident" id="5801976">slashSlash</span><span class="op" id="5801986">)</span><span class="op" id="5801987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801991">i</span>&nbsp;<span class="op" id="5801993">:=</span>&nbsp;<span class="ident" id="5801996">bytes</span><span class="op" id="5802001">.</span><span class="ident" id="5802002">Index</span><span class="op" id="5802007">(</span><span class="ident" id="5802008">data</span><span class="op" id="5802012">,</span>&nbsp;<span class="ident" id="5802014">newline</span><span class="op" id="5802021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802025">if</span>&nbsp;<span class="ident" id="5802028">i</span>&nbsp;<span class="op" id="5802030">&lt;</span>&nbsp;<span class="num" id="5802032">0</span>&nbsp;<span class="op" id="5802034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802039">i</span>&nbsp;<span class="op" id="5802041">=</span>&nbsp;<span class="builtinfunc" id="5802043">len</span><span class="op" id="5802046">(</span><span class="ident" id="5802047">data</span><span class="op" id="5802051">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802059">comment</span>&nbsp;<span class="op" id="5802067">=</span>&nbsp;<span class="ident" id="5802069">data</span><span class="op" id="5802073">[</span><span class="num" id="5802074">2</span><span class="op" id="5802075">:</span><span class="ident" id="5802076">i</span><span class="op" id="5802077">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802080">case</span>&nbsp;<span class="ident" id="5802085">bytes</span><span class="op" id="5802090">.</span><span class="ident" id="5802091">HasPrefix</span><span class="op" id="5802100">(</span><span class="ident" id="5802101">data</span><span class="op" id="5802105">,</span>&nbsp;<span class="ident" id="5802107">slashStar</span><span class="op" id="5802116">)</span><span class="op" id="5802117">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802121">data</span>&nbsp;<span class="op" id="5802126">=</span>&nbsp;<span class="ident" id="5802128">data</span><span class="op" id="5802132">[</span><span class="num" id="5802133">2</span><span class="op" id="5802134">:</span><span class="op" id="5802135">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802139">i</span>&nbsp;<span class="op" id="5802141">:=</span>&nbsp;<span class="ident" id="5802144">bytes</span><span class="op" id="5802149">.</span><span class="ident" id="5802150">Index</span><span class="op" id="5802155">(</span><span class="ident" id="5802156">data</span><span class="op" id="5802160">,</span>&nbsp;<span class="ident" id="5802162">starSlash</span><span class="op" id="5802171">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802175">if</span>&nbsp;<span class="ident" id="5802178">i</span>&nbsp;<span class="op" id="5802180">&lt;</span>&nbsp;<span class="num" id="5802182">0</span>&nbsp;<span class="op" id="5802184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5802189">//&nbsp;malformed&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802213">return</span>&nbsp;<span class="string" id="5802220">&#34;&#34;</span><span class="op" id="5802222">,</span>&nbsp;<span class="num" id="5802224">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802232">comment</span>&nbsp;<span class="op" id="5802240">=</span>&nbsp;<span class="ident" id="5802242">data</span><span class="op" id="5802246">[</span><span class="op" id="5802247">:</span><span class="ident" id="5802248">i</span><span class="op" id="5802249">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802253">if</span>&nbsp;<span class="ident" id="5802256">bytes</span><span class="op" id="5802261">.</span><span class="ident" id="5802262">Contains</span><span class="op" id="5802270">(</span><span class="ident" id="5802271">comment</span><span class="op" id="5802278">,</span>&nbsp;<span class="ident" id="5802280">newline</span><span class="op" id="5802287">)</span>&nbsp;<span class="op" id="5802289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802294">return</span>&nbsp;<span class="string" id="5802301">&#34;&#34;</span><span class="op" id="5802303">,</span>&nbsp;<span class="num" id="5802305">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802315">comment</span>&nbsp;<span class="op" id="5802323">=</span>&nbsp;<span class="ident" id="5802325">bytes</span><span class="op" id="5802330">.</span><span class="ident" id="5802331">TrimSpace</span><span class="op" id="5802340">(</span><span class="ident" id="5802341">comment</span><span class="op" id="5802348">)</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5802352">//&nbsp;split&nbsp;comment&nbsp;into&nbsp;`import`,&nbsp;`&#34;pkg&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802393">word</span><span class="op" id="5802397">,</span>&nbsp;<span class="ident" id="5802399">arg</span>&nbsp;<span class="op" id="5802403">:=</span>&nbsp;<span class="ident" id="5802406">parseWord</span><span class="op" id="5802415">(</span><span class="ident" id="5802416">comment</span><span class="op" id="5802423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802426">if</span>&nbsp;<span class="builtintype" id="5802429">string</span><span class="op" id="5802435">(</span><span class="ident" id="5802436">word</span><span class="op" id="5802440">)</span>&nbsp;<span class="op" id="5802442">!=</span>&nbsp;<span class="string" id="5802445">&#34;import&#34;</span>&nbsp;<span class="op" id="5802454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802458">return</span>&nbsp;<span class="string" id="5802465">&#34;&#34;</span><span class="op" id="5802467">,</span>&nbsp;<span class="num" id="5802469">0</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802476">line</span>&nbsp;<span class="op" id="5802481">=</span>&nbsp;<span class="num" id="5802483">1</span>&nbsp;<span class="op" id="5802485">+</span>&nbsp;<span class="ident" id="5802487">bytes</span><span class="op" id="5802492">.</span><span class="ident" id="5802493">Count</span><span class="op" id="5802498">(</span><span class="ident" id="5802499">data</span><span class="op" id="5802503">[</span><span class="op" id="5802504">:</span><span class="builtinfunc" id="5802505">cap</span><span class="op" id="5802508">(</span><span class="ident" id="5802509">data</span><span class="op" id="5802513">)</span><span class="op" id="5802514">-</span><span class="builtinfunc" id="5802515">cap</span><span class="op" id="5802518">(</span><span class="ident" id="5802519">arg</span><span class="op" id="5802522">)</span><span class="op" id="5802523">]</span><span class="op" id="5802524">,</span>&nbsp;<span class="ident" id="5802526">newline</span><span class="op" id="5802533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802536">return</span>&nbsp;<span class="ident" id="5802543">strings</span><span class="op" id="5802550">.</span><span class="ident" id="5802551">TrimSpace</span><span class="op" id="5802560">(</span><span class="builtintype" id="5802561">string</span><span class="op" id="5802567">(</span><span class="ident" id="5802568">arg</span><span class="op" id="5802571">)</span><span class="op" id="5802572">)</span><span class="op" id="5802573">,</span>&nbsp;<span class="ident" id="5802575">line</span><br>
<span class="lineno"></span><span class="op" id="5802580">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="5802583">var</span>&nbsp;<span class="op" id="5802587">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802590">slashSlash</span>&nbsp;<span class="op" id="5802601">=</span>&nbsp;<span class="op" id="5802603">[</span><span class="op" id="5802604">]</span><span class="builtintype" id="5802605">byte</span><span class="op" id="5802609">(</span><span class="string" id="5802610">&#34;//&#34;</span><span class="op" id="5802614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802617">slashStar</span>&nbsp;&nbsp;<span class="op" id="5802628">=</span>&nbsp;<span class="op" id="5802630">[</span><span class="op" id="5802631">]</span><span class="builtintype" id="5802632">byte</span><span class="op" id="5802636">(</span><span class="string" id="5802637">&#34;/*&#34;</span><span class="op" id="5802641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802644">starSlash</span>&nbsp;&nbsp;<span class="op" id="5802655">=</span>&nbsp;<span class="op" id="5802657">[</span><span class="op" id="5802658">]</span><span class="builtintype" id="5802659">byte</span><span class="op" id="5802663">(</span><span class="string" id="5802664">&#34;*/&#34;</span><span class="op" id="5802668">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802671">newline</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5802682">=</span>&nbsp;<span class="op" id="5802684">[</span><span class="op" id="5802685">]</span><span class="builtintype" id="5802686">byte</span><span class="op" id="5802690">(</span><span class="string" id="5802691">&#34;\n&#34;</span><span class="op" id="5802695">)</span><br>
<span class="lineno"></span><span class="op" id="5802697">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5802700">//&nbsp;skipSpaceOrComment&nbsp;returns&nbsp;data&nbsp;with&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="5802780">func</span>&nbsp;<span class="ident" id="5802785">skipSpaceOrComment</span><span class="op" id="5802803">(</span><span class="ident" id="5802804">data</span>&nbsp;<span class="op" id="5802809">[</span><span class="op" id="5802810">]</span><span class="builtintype" id="5802811">byte</span><span class="op" id="5802815">)</span>&nbsp;<span class="op" id="5802817">[</span><span class="op" id="5802818">]</span><span class="builtintype" id="5802819">byte</span>&nbsp;<span class="op" id="5802824">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802827">for</span>&nbsp;<span class="builtinfunc" id="5802831">len</span><span class="op" id="5802834">(</span><span class="ident" id="5802835">data</span><span class="op" id="5802839">)</span>&nbsp;<span class="op" id="5802841">&gt;</span>&nbsp;<span class="num" id="5802843">0</span>&nbsp;<span class="op" id="5802845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802849">switch</span>&nbsp;<span class="ident" id="5802856">data</span><span class="op" id="5802860">[</span><span class="num" id="5802861">0</span><span class="op" id="5802862">]</span>&nbsp;<span class="op" id="5802864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802868">case</span>&nbsp;<span class="string" id="5802873">&#39;&nbsp;&#39;</span><span class="op" id="5802876">,</span>&nbsp;<span class="string" id="5802878">&#39;\t&#39;</span><span class="op" id="5802882">,</span>&nbsp;<span class="string" id="5802884">&#39;\r&#39;</span><span class="op" id="5802888">,</span>&nbsp;<span class="string" id="5802890">&#39;\n&#39;</span><span class="op" id="5802894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802899">data</span>&nbsp;<span class="op" id="5802904">=</span>&nbsp;<span class="ident" id="5802906">data</span><span class="op" id="5802910">[</span><span class="num" id="5802911">1</span><span class="op" id="5802912">:</span><span class="op" id="5802913">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802918">continue</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802929">case</span>&nbsp;<span class="string" id="5802934">&#39;/&#39;</span><span class="op" id="5802937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802942">if</span>&nbsp;<span class="ident" id="5802945">bytes</span><span class="op" id="5802950">.</span><span class="ident" id="5802951">HasPrefix</span><span class="op" id="5802960">(</span><span class="ident" id="5802961">data</span><span class="op" id="5802965">,</span>&nbsp;<span class="ident" id="5802967">slashSlash</span><span class="op" id="5802977">)</span>&nbsp;<span class="op" id="5802979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802985">i</span>&nbsp;<span class="op" id="5802987">:=</span>&nbsp;<span class="ident" id="5802990">bytes</span><span class="op" id="5802995">.</span><span class="ident" id="5802996">Index</span><span class="op" id="5803001">(</span><span class="ident" id="5803002">data</span><span class="op" id="5803006">,</span>&nbsp;<span class="ident" id="5803008">newline</span><span class="op" id="5803015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803021">if</span>&nbsp;<span class="ident" id="5803024">i</span>&nbsp;<span class="op" id="5803026">&lt;</span>&nbsp;<span class="num" id="5803028">0</span>&nbsp;<span class="op" id="5803030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803037">return</span>&nbsp;<span class="ident" id="5803044">nil</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803058">data</span>&nbsp;<span class="op" id="5803063">=</span>&nbsp;<span class="ident" id="5803065">data</span><span class="op" id="5803069">[</span><span class="ident" id="5803070">i</span><span class="op" id="5803071">+</span><span class="num" id="5803072">1</span><span class="op" id="5803073">:</span><span class="op" id="5803074">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803080">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803097">if</span>&nbsp;<span class="ident" id="5803100">bytes</span><span class="op" id="5803105">.</span><span class="ident" id="5803106">HasPrefix</span><span class="op" id="5803115">(</span><span class="ident" id="5803116">data</span><span class="op" id="5803120">,</span>&nbsp;<span class="ident" id="5803122">slashStar</span><span class="op" id="5803131">)</span>&nbsp;<span class="op" id="5803133">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803139">data</span>&nbsp;<span class="op" id="5803144">=</span>&nbsp;<span class="ident" id="5803146">data</span><span class="op" id="5803150">[</span><span class="num" id="5803151">2</span><span class="op" id="5803152">:</span><span class="op" id="5803153">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803159">i</span>&nbsp;<span class="op" id="5803161">:=</span>&nbsp;<span class="ident" id="5803164">bytes</span><span class="op" id="5803169">.</span><span class="ident" id="5803170">Index</span><span class="op" id="5803175">(</span><span class="ident" id="5803176">data</span><span class="op" id="5803180">,</span>&nbsp;<span class="ident" id="5803182">starSlash</span><span class="op" id="5803191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803197">if</span>&nbsp;<span class="ident" id="5803200">i</span>&nbsp;<span class="op" id="5803202">&lt;</span>&nbsp;<span class="num" id="5803204">0</span>&nbsp;<span class="op" id="5803206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803213">return</span>&nbsp;<span class="ident" id="5803220">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803228">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803234">data</span>&nbsp;<span class="op" id="5803239">=</span>&nbsp;<span class="ident" id="5803241">data</span><span class="op" id="5803245">[</span><span class="ident" id="5803246">i</span><span class="op" id="5803247">+</span><span class="num" id="5803248">2</span><span class="op" id="5803249">:</span><span class="op" id="5803250">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803256">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803276">break</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803286">return</span>&nbsp;<span class="ident" id="5803293">data</span><br>
<span class="lineno"></span><span class="op" id="5803298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5803301">//&nbsp;parseWord&nbsp;skips&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;in&nbsp;data</span><br>
<span class="lineno">880</span><span class="comment" id="5803359">//&nbsp;and&nbsp;then&nbsp;parses&nbsp;the&nbsp;beginning&nbsp;of&nbsp;data&nbsp;as&nbsp;an&nbsp;identifier&nbsp;or&nbsp;keyword,</span><br>
<span class="lineno"></span><span class="comment" id="5803429">//&nbsp;returning&nbsp;that&nbsp;word&nbsp;and&nbsp;what&nbsp;remains&nbsp;after&nbsp;the&nbsp;word.</span><br>
<span class="lineno"></span><span class="keyword" id="5803485">func</span>&nbsp;<span class="ident" id="5803490">parseWord</span><span class="op" id="5803499">(</span><span class="ident" id="5803500">data</span>&nbsp;<span class="op" id="5803505">[</span><span class="op" id="5803506">]</span><span class="builtintype" id="5803507">byte</span><span class="op" id="5803511">)</span>&nbsp;<span class="op" id="5803513">(</span><span class="ident" id="5803514">word</span><span class="op" id="5803518">,</span>&nbsp;<span class="ident" id="5803520">rest</span>&nbsp;<span class="op" id="5803525">[</span><span class="op" id="5803526">]</span><span class="builtintype" id="5803527">byte</span><span class="op" id="5803531">)</span>&nbsp;<span class="op" id="5803533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803536">data</span>&nbsp;<span class="op" id="5803541">=</span>&nbsp;<span class="ident" id="5803543">skipSpaceOrComment</span><span class="op" id="5803561">(</span><span class="ident" id="5803562">data</span><span class="op" id="5803566">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5803570">//&nbsp;Parse&nbsp;past&nbsp;leading&nbsp;word&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803610">rest</span>&nbsp;<span class="op" id="5803615">=</span>&nbsp;<span class="ident" id="5803617">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803623">for</span>&nbsp;<span class="op" id="5803627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803631">r</span><span class="op" id="5803632">,</span>&nbsp;<span class="ident" id="5803634">size</span>&nbsp;<span class="op" id="5803639">:=</span>&nbsp;<span class="ident" id="5803642">utf8</span><span class="op" id="5803646">.</span><span class="ident" id="5803647">DecodeRune</span><span class="op" id="5803657">(</span><span class="ident" id="5803658">rest</span><span class="op" id="5803662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803666">if</span>&nbsp;<span class="ident" id="5803669">unicode</span><span class="op" id="5803676">.</span><span class="ident" id="5803677">IsLetter</span><span class="op" id="5803685">(</span><span class="ident" id="5803686">r</span><span class="op" id="5803687">)</span>&nbsp;<span class="op" id="5803689">||</span>&nbsp;<span class="string" id="5803692">&#39;0&#39;</span>&nbsp;<span class="op" id="5803696">&lt;=</span>&nbsp;<span class="ident" id="5803699">r</span>&nbsp;<span class="op" id="5803701">&amp;&amp;</span>&nbsp;<span class="ident" id="5803704">r</span>&nbsp;<span class="op" id="5803706">&lt;=</span>&nbsp;<span class="string" id="5803709">&#39;9&#39;</span>&nbsp;<span class="op" id="5803713">||</span>&nbsp;<span class="ident" id="5803716">r</span>&nbsp;<span class="op" id="5803718">==</span>&nbsp;<span class="string" id="5803721">&#39;_&#39;</span>&nbsp;<span class="op" id="5803725">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803730">rest</span>&nbsp;<span class="op" id="5803735">=</span>&nbsp;<span class="ident" id="5803737">rest</span><span class="op" id="5803741">[</span><span class="ident" id="5803742">size</span><span class="op" id="5803746">:</span><span class="op" id="5803747">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803752">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803767">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803774">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803778">word</span>&nbsp;<span class="op" id="5803783">=</span>&nbsp;<span class="ident" id="5803785">data</span><span class="op" id="5803789">[</span><span class="op" id="5803790">:</span><span class="builtinfunc" id="5803791">len</span><span class="op" id="5803794">(</span><span class="ident" id="5803795">data</span><span class="op" id="5803799">)</span><span class="op" id="5803800">-</span><span class="builtinfunc" id="5803801">len</span><span class="op" id="5803804">(</span><span class="ident" id="5803805">rest</span><span class="op" id="5803809">)</span><span class="op" id="5803810">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803813">if</span>&nbsp;<span class="builtinfunc" id="5803816">len</span><span class="op" id="5803819">(</span><span class="ident" id="5803820">word</span><span class="op" id="5803824">)</span>&nbsp;<span class="op" id="5803826">==</span>&nbsp;<span class="num" id="5803829">0</span>&nbsp;<span class="op" id="5803831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803835">return</span>&nbsp;<span class="ident" id="5803842">nil</span><span class="op" id="5803845">,</span>&nbsp;<span class="ident" id="5803847">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803852">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803856">return</span>&nbsp;<span class="ident" id="5803863">word</span><span class="op" id="5803867">,</span>&nbsp;<span class="ident" id="5803869">rest</span><br>
<span class="lineno"></span><span class="op" id="5803874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5803877">//&nbsp;MatchFile&nbsp;reports&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno">905</span><span class="comment" id="5803958">//&nbsp;matches&nbsp;the&nbsp;context&nbsp;and&nbsp;would&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;Package&nbsp;created&nbsp;by&nbsp;ImportDir</span><br>
<span class="lineno"></span><span class="comment" id="5804037">//&nbsp;of&nbsp;that&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="5804059">//</span><br>
<span class="lineno"></span><span class="comment" id="5804062">//&nbsp;MatchFile&nbsp;considers&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;and&nbsp;may&nbsp;use&nbsp;ctxt.OpenFile&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5804135">//&nbsp;read&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;content.</span><br>
<span class="lineno">910</span><span class="keyword" id="5804178">func</span>&nbsp;<span class="op" id="5804183">(</span><span class="ident" id="5804184">ctxt</span>&nbsp;<span class="op" id="5804189">*</span><span class="ident" id="5804190">Context</span><span class="op" id="5804197">)</span>&nbsp;<span class="ident" id="5804199">MatchFile</span><span class="op" id="5804208">(</span><span class="ident" id="5804209">dir</span><span class="op" id="5804212">,</span>&nbsp;<span class="ident" id="5804214">name</span>&nbsp;<span class="builtintype" id="5804219">string</span><span class="op" id="5804225">)</span>&nbsp;<span class="op" id="5804227">(</span><span class="ident" id="5804228">match</span>&nbsp;<span class="builtintype" id="5804234">bool</span><span class="op" id="5804238">,</span>&nbsp;<span class="ident" id="5804240">err</span>&nbsp;<span class="builtintype" id="5804244">error</span><span class="op" id="5804249">)</span>&nbsp;<span class="op" id="5804251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804254">match</span><span class="op" id="5804259">,</span>&nbsp;<span class="ident" id="5804261">_</span><span class="op" id="5804262">,</span>&nbsp;<span class="ident" id="5804264">_</span><span class="op" id="5804265">,</span>&nbsp;<span class="ident" id="5804267">err</span>&nbsp;<span class="op" id="5804271">=</span>&nbsp;<span class="ident" id="5804273">ctxt</span><span class="op" id="5804277">.</span><span class="ident" id="5804278">matchFile</span><span class="op" id="5804287">(</span><span class="ident" id="5804288">dir</span><span class="op" id="5804291">,</span>&nbsp;<span class="ident" id="5804293">name</span><span class="op" id="5804297">,</span>&nbsp;<span class="builtintype" id="5804299">false</span><span class="op" id="5804304">,</span>&nbsp;<span class="ident" id="5804306">nil</span><span class="op" id="5804309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804312">return</span><br>
<span class="lineno"></span><span class="op" id="5804319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="comment" id="5804322">//&nbsp;matchFile&nbsp;determines&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="5804406">//&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;package&nbsp;being&nbsp;constructed.</span><br>
<span class="lineno"></span><span class="comment" id="5804462">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;data&nbsp;read&nbsp;from&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5804505">//&nbsp;If&nbsp;returnImports&nbsp;is&nbsp;true&nbsp;and&nbsp;name&nbsp;denotes&nbsp;a&nbsp;Go&nbsp;program,&nbsp;matchFile&nbsp;reads</span><br>
<span class="lineno"></span><span class="comment" id="5804580">//&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;imports&nbsp;(and&nbsp;returns&nbsp;that&nbsp;data)&nbsp;even&nbsp;though&nbsp;it&nbsp;only</span><br>
<span class="lineno">920</span><span class="comment" id="5804656">//&nbsp;considers&nbsp;text&nbsp;until&nbsp;the&nbsp;first&nbsp;non-comment.</span><br>
<span class="lineno"></span><span class="comment" id="5804703">//&nbsp;If&nbsp;allTags&nbsp;is&nbsp;non-nil,&nbsp;matchFile&nbsp;records&nbsp;any&nbsp;encountered&nbsp;build&nbsp;tag</span><br>
<span class="lineno"></span><span class="comment" id="5804773">//&nbsp;by&nbsp;setting&nbsp;allTags[tag]&nbsp;=&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="5804808">func</span>&nbsp;<span class="op" id="5804813">(</span><span class="ident" id="5804814">ctxt</span>&nbsp;<span class="op" id="5804819">*</span><span class="ident" id="5804820">Context</span><span class="op" id="5804827">)</span>&nbsp;<span class="ident" id="5804829">matchFile</span><span class="op" id="5804838">(</span><span class="ident" id="5804839">dir</span><span class="op" id="5804842">,</span>&nbsp;<span class="ident" id="5804844">name</span>&nbsp;<span class="builtintype" id="5804849">string</span><span class="op" id="5804855">,</span>&nbsp;<span class="ident" id="5804857">returnImports</span>&nbsp;<span class="builtintype" id="5804871">bool</span><span class="op" id="5804875">,</span>&nbsp;<span class="ident" id="5804877">allTags</span>&nbsp;<span class="keyword" id="5804885">map</span><span class="op" id="5804888">[</span><span class="builtintype" id="5804889">string</span><span class="op" id="5804895">]</span><span class="builtintype" id="5804896">bool</span><span class="op" id="5804900">)</span>&nbsp;<span class="op" id="5804902">(</span><span class="ident" id="5804903">match</span>&nbsp;<span class="builtintype" id="5804909">bool</span><span class="op" id="5804913">,</span>&nbsp;<span class="ident" id="5804915">data</span>&nbsp;<span class="op" id="5804920">[</span><span class="op" id="5804921">]</span><span class="builtintype" id="5804922">byte</span><span class="op" id="5804926">,</span>&nbsp;<span class="ident" id="5804928">filename</span>&nbsp;<span class="builtintype" id="5804937">string</span><span class="op" id="5804943">,</span>&nbsp;<span class="ident" id="5804945">err</span>&nbsp;<span class="builtintype" id="5804949">error</span><span class="op" id="5804954">)</span>&nbsp;<span class="op" id="5804956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804959">if</span>&nbsp;<span class="ident" id="5804962">strings</span><span class="op" id="5804969">.</span><span class="ident" id="5804970">HasPrefix</span><span class="op" id="5804979">(</span><span class="ident" id="5804980">name</span><span class="op" id="5804984">,</span>&nbsp;<span class="string" id="5804986">&#34;_&#34;</span><span class="op" id="5804989">)</span>&nbsp;<span class="op" id="5804991">||</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804996">strings</span><span class="op" id="5805003">.</span><span class="ident" id="5805004">HasPrefix</span><span class="op" id="5805013">(</span><span class="ident" id="5805014">name</span><span class="op" id="5805018">,</span>&nbsp;<span class="string" id="5805020">&#34;.&#34;</span><span class="op" id="5805023">)</span>&nbsp;<span class="op" id="5805025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805029">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805041">i</span>&nbsp;<span class="op" id="5805043">:=</span>&nbsp;<span class="ident" id="5805046">strings</span><span class="op" id="5805053">.</span><span class="ident" id="5805054">LastIndex</span><span class="op" id="5805063">(</span><span class="ident" id="5805064">name</span><span class="op" id="5805068">,</span>&nbsp;<span class="string" id="5805070">&#34;.&#34;</span><span class="op" id="5805073">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805076">if</span>&nbsp;<span class="ident" id="5805079">i</span>&nbsp;<span class="op" id="5805081">&lt;</span>&nbsp;<span class="num" id="5805083">0</span>&nbsp;<span class="op" id="5805085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805089">i</span>&nbsp;<span class="op" id="5805091">=</span>&nbsp;<span class="builtinfunc" id="5805093">len</span><span class="op" id="5805096">(</span><span class="ident" id="5805097">name</span><span class="op" id="5805101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805107">ext</span>&nbsp;<span class="op" id="5805111">:=</span>&nbsp;<span class="ident" id="5805114">name</span><span class="op" id="5805118">[</span><span class="ident" id="5805119">i</span><span class="op" id="5805120">:</span><span class="op" id="5805121">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805125">if</span>&nbsp;<span class="op" id="5805128">!</span><span class="ident" id="5805129">ctxt</span><span class="op" id="5805133">.</span><span class="ident" id="5805134">goodOSArchFile</span><span class="op" id="5805148">(</span><span class="ident" id="5805149">name</span><span class="op" id="5805153">,</span>&nbsp;<span class="ident" id="5805155">allTags</span><span class="op" id="5805162">)</span>&nbsp;<span class="op" id="5805164">&amp;&amp;</span>&nbsp;<span class="op" id="5805167">!</span><span class="ident" id="5805168">ctxt</span><span class="op" id="5805172">.</span><span class="ident" id="5805173">UseAllFiles</span>&nbsp;<span class="op" id="5805185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805189">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805201">switch</span>&nbsp;<span class="ident" id="5805208">ext</span>&nbsp;<span class="op" id="5805212">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805215">case</span>&nbsp;<span class="string" id="5805220">&#34;.go&#34;</span><span class="op" id="5805225">,</span>&nbsp;<span class="string" id="5805227">&#34;.c&#34;</span><span class="op" id="5805231">,</span>&nbsp;<span class="string" id="5805233">&#34;.cc&#34;</span><span class="op" id="5805238">,</span>&nbsp;<span class="string" id="5805240">&#34;.cxx&#34;</span><span class="op" id="5805246">,</span>&nbsp;<span class="string" id="5805248">&#34;.cpp&#34;</span><span class="op" id="5805254">,</span>&nbsp;<span class="string" id="5805256">&#34;.m&#34;</span><span class="op" id="5805260">,</span>&nbsp;<span class="string" id="5805262">&#34;.s&#34;</span><span class="op" id="5805266">,</span>&nbsp;<span class="string" id="5805268">&#34;.h&#34;</span><span class="op" id="5805272">,</span>&nbsp;<span class="string" id="5805274">&#34;.hh&#34;</span><span class="op" id="5805279">,</span>&nbsp;<span class="string" id="5805281">&#34;.hpp&#34;</span><span class="op" id="5805287">,</span>&nbsp;<span class="string" id="5805289">&#34;.hxx&#34;</span><span class="op" id="5805295">,</span>&nbsp;<span class="string" id="5805297">&#34;.S&#34;</span><span class="op" id="5805301">,</span>&nbsp;<span class="string" id="5805303">&#34;.swig&#34;</span><span class="op" id="5805310">,</span>&nbsp;<span class="string" id="5805312">&#34;.swigcxx&#34;</span><span class="op" id="5805322">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5805326">//&nbsp;tentatively&nbsp;okay&nbsp;-&nbsp;read&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805367">case</span>&nbsp;<span class="string" id="5805372">&#34;.syso&#34;</span><span class="op" id="5805379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5805383">//&nbsp;binary,&nbsp;no&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805407">match</span>&nbsp;<span class="op" id="5805413">=</span>&nbsp;<span class="builtintype" id="5805415">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805422">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805430">default</span><span class="op" id="5805437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5805441">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805451">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805459">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805463">filename</span>&nbsp;<span class="op" id="5805472">=</span>&nbsp;<span class="ident" id="5805474">ctxt</span><span class="op" id="5805478">.</span><span class="ident" id="5805479">joinPath</span><span class="op" id="5805487">(</span><span class="ident" id="5805488">dir</span><span class="op" id="5805491">,</span>&nbsp;<span class="ident" id="5805493">name</span><span class="op" id="5805497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805500">f</span><span class="op" id="5805501">,</span>&nbsp;<span class="ident" id="5805503">err</span>&nbsp;<span class="op" id="5805507">:=</span>&nbsp;<span class="ident" id="5805510">ctxt</span><span class="op" id="5805514">.</span><span class="ident" id="5805515">openFile</span><span class="op" id="5805523">(</span><span class="ident" id="5805524">filename</span><span class="op" id="5805532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805535">if</span>&nbsp;<span class="ident" id="5805538">err</span>&nbsp;<span class="op" id="5805542">!=</span>&nbsp;<span class="ident" id="5805545">nil</span>&nbsp;<span class="op" id="5805549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805553">return</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805565">if</span>&nbsp;<span class="ident" id="5805568">strings</span><span class="op" id="5805575">.</span><span class="ident" id="5805576">HasSuffix</span><span class="op" id="5805585">(</span><span class="ident" id="5805586">filename</span><span class="op" id="5805594">,</span>&nbsp;<span class="string" id="5805596">&#34;.go&#34;</span><span class="op" id="5805601">)</span>&nbsp;<span class="op" id="5805603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805607">data</span><span class="op" id="5805611">,</span>&nbsp;<span class="ident" id="5805613">err</span>&nbsp;<span class="op" id="5805617">=</span>&nbsp;<span class="ident" id="5805619">readImports</span><span class="op" id="5805630">(</span><span class="ident" id="5805631">f</span><span class="op" id="5805632">,</span>&nbsp;<span class="builtintype" id="5805634">false</span><span class="op" id="5805639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805642">}</span>&nbsp;<span class="keyword" id="5805644">else</span>&nbsp;<span class="op" id="5805649">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805653">data</span><span class="op" id="5805657">,</span>&nbsp;<span class="ident" id="5805659">err</span>&nbsp;<span class="op" id="5805663">=</span>&nbsp;<span class="ident" id="5805665">readComments</span><span class="op" id="5805677">(</span><span class="ident" id="5805678">f</span><span class="op" id="5805679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805685">f</span><span class="op" id="5805686">.</span><span class="ident" id="5805687">Close</span><span class="op" id="5805692">(</span><span class="op" id="5805693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805696">if</span>&nbsp;<span class="ident" id="5805699">err</span>&nbsp;<span class="op" id="5805703">!=</span>&nbsp;<span class="ident" id="5805706">nil</span>&nbsp;<span class="op" id="5805710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805714">err</span>&nbsp;<span class="op" id="5805718">=</span>&nbsp;<span class="ident" id="5805720">fmt</span><span class="op" id="5805723">.</span><span class="ident" id="5805724">Errorf</span><span class="op" id="5805730">(</span><span class="string" id="5805731">&#34;read&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="5805744">,</span>&nbsp;<span class="ident" id="5805746">filename</span><span class="op" id="5805754">,</span>&nbsp;<span class="ident" id="5805756">err</span><span class="op" id="5805759">)</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805763">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5805775">//&nbsp;Look&nbsp;for&nbsp;+build&nbsp;comments&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805834">if</span>&nbsp;<span class="op" id="5805837">!</span><span class="ident" id="5805838">ctxt</span><span class="op" id="5805842">.</span><span class="ident" id="5805843">shouldBuild</span><span class="op" id="5805854">(</span><span class="ident" id="5805855">data</span><span class="op" id="5805859">,</span>&nbsp;<span class="ident" id="5805861">allTags</span><span class="op" id="5805868">)</span>&nbsp;<span class="op" id="5805870">&amp;&amp;</span>&nbsp;<span class="op" id="5805873">!</span><span class="ident" id="5805874">ctxt</span><span class="op" id="5805878">.</span><span class="ident" id="5805879">UseAllFiles</span>&nbsp;<span class="op" id="5805891">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805895">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805907">match</span>&nbsp;<span class="op" id="5805913">=</span>&nbsp;<span class="builtintype" id="5805915">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805921">return</span><br>
<span class="lineno">975</span><span class="op" id="5805928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5805931">func</span>&nbsp;<span class="ident" id="5805936">cleanImports</span><span class="op" id="5805948">(</span><span class="ident" id="5805949">m</span>&nbsp;<span class="keyword" id="5805951">map</span><span class="op" id="5805954">[</span><span class="builtintype" id="5805955">string</span><span class="op" id="5805961">]</span><span class="op" id="5805962">[</span><span class="op" id="5805963">]</span><span class="ident" id="5805964">token</span><span class="op" id="5805969">.</span><span class="ident" id="5805970">Position</span><span class="op" id="5805978">)</span>&nbsp;<span class="op" id="5805980">(</span><span class="op" id="5805981">[</span><span class="op" id="5805982">]</span><span class="builtintype" id="5805983">string</span><span class="op" id="5805989">,</span>&nbsp;<span class="keyword" id="5805991">map</span><span class="op" id="5805994">[</span><span class="builtintype" id="5805995">string</span><span class="op" id="5806001">]</span><span class="op" id="5806002">[</span><span class="op" id="5806003">]</span><span class="ident" id="5806004">token</span><span class="op" id="5806009">.</span><span class="ident" id="5806010">Position</span><span class="op" id="5806018">)</span>&nbsp;<span class="op" id="5806020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806023">all</span>&nbsp;<span class="op" id="5806027">:=</span>&nbsp;<span class="builtinfunc" id="5806030">make</span><span class="op" id="5806034">(</span><span class="op" id="5806035">[</span><span class="op" id="5806036">]</span><span class="builtintype" id="5806037">string</span><span class="op" id="5806043">,</span>&nbsp;<span class="num" id="5806045">0</span><span class="op" id="5806046">,</span>&nbsp;<span class="builtinfunc" id="5806048">len</span><span class="op" id="5806051">(</span><span class="ident" id="5806052">m</span><span class="op" id="5806053">)</span><span class="op" id="5806054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806057">for</span>&nbsp;<span class="ident" id="5806061">path</span>&nbsp;<span class="op" id="5806066">:=</span>&nbsp;<span class="keyword" id="5806069">range</span>&nbsp;<span class="ident" id="5806075">m</span>&nbsp;<span class="op" id="5806077">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806081">all</span>&nbsp;<span class="op" id="5806085">=</span>&nbsp;<span class="builtinfunc" id="5806087">append</span><span class="op" id="5806093">(</span><span class="ident" id="5806094">all</span><span class="op" id="5806097">,</span>&nbsp;<span class="ident" id="5806099">path</span><span class="op" id="5806103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5806106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806109">sort</span><span class="op" id="5806113">.</span><span class="ident" id="5806114">Strings</span><span class="op" id="5806121">(</span><span class="ident" id="5806122">all</span><span class="op" id="5806125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806128">return</span>&nbsp;<span class="ident" id="5806135">all</span><span class="op" id="5806138">,</span>&nbsp;<span class="ident" id="5806140">m</span><br>
<span class="lineno"></span><span class="op" id="5806142">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="5806145">//&nbsp;Import&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.Import.</span><br>
<span class="lineno"></span><span class="keyword" id="5806188">func</span>&nbsp;<span class="ident" id="5806193">Import</span><span class="op" id="5806199">(</span><span class="ident" id="5806200">path</span><span class="op" id="5806204">,</span>&nbsp;<span class="ident" id="5806206">srcDir</span>&nbsp;<span class="builtintype" id="5806213">string</span><span class="op" id="5806219">,</span>&nbsp;<span class="ident" id="5806221">mode</span>&nbsp;<span class="ident" id="5806226">ImportMode</span><span class="op" id="5806236">)</span>&nbsp;<span class="op" id="5806238">(</span><span class="op" id="5806239">*</span><span class="ident" id="5806240">Package</span><span class="op" id="5806247">,</span>&nbsp;<span class="builtintype" id="5806249">error</span><span class="op" id="5806254">)</span>&nbsp;<span class="op" id="5806256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806259">return</span>&nbsp;<span class="ident" id="5806266">Default</span><span class="op" id="5806273">.</span><span class="ident" id="5806274">Import</span><span class="op" id="5806280">(</span><span class="ident" id="5806281">path</span><span class="op" id="5806285">,</span>&nbsp;<span class="ident" id="5806287">srcDir</span><span class="op" id="5806293">,</span>&nbsp;<span class="ident" id="5806295">mode</span><span class="op" id="5806299">)</span><br>
<span class="lineno"></span><span class="op" id="5806301">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span><span class="comment" id="5806304">//&nbsp;ImportDir&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.ImportDir.</span><br>
<span class="lineno"></span><span class="keyword" id="5806353">func</span>&nbsp;<span class="ident" id="5806358">ImportDir</span><span class="op" id="5806367">(</span><span class="ident" id="5806368">dir</span>&nbsp;<span class="builtintype" id="5806372">string</span><span class="op" id="5806378">,</span>&nbsp;<span class="ident" id="5806380">mode</span>&nbsp;<span class="ident" id="5806385">ImportMode</span><span class="op" id="5806395">)</span>&nbsp;<span class="op" id="5806397">(</span><span class="op" id="5806398">*</span><span class="ident" id="5806399">Package</span><span class="op" id="5806406">,</span>&nbsp;<span class="builtintype" id="5806408">error</span><span class="op" id="5806413">)</span>&nbsp;<span class="op" id="5806415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806418">return</span>&nbsp;<span class="ident" id="5806425">Default</span><span class="op" id="5806432">.</span><span class="ident" id="5806433">ImportDir</span><span class="op" id="5806442">(</span><span class="ident" id="5806443">dir</span><span class="op" id="5806446">,</span>&nbsp;<span class="ident" id="5806448">mode</span><span class="op" id="5806452">)</span><br>
<span class="lineno"></span><span class="op" id="5806454">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="keyword" id="5806457">var</span>&nbsp;<span class="ident" id="5806461">slashslash</span>&nbsp;<span class="op" id="5806472">=</span>&nbsp;<span class="op" id="5806474">[</span><span class="op" id="5806475">]</span><span class="builtintype" id="5806476">byte</span><span class="op" id="5806480">(</span><span class="string" id="5806481">&#34;//&#34;</span><span class="op" id="5806485">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5806488">//&nbsp;shouldBuild&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;this&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="5806548">//&nbsp;The&nbsp;rule&nbsp;is&nbsp;that&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments</span><br>
<span class="lineno">1000</span><span class="comment" id="5806609">//&nbsp;and&nbsp;blank&nbsp;lines,&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="5806668">//&nbsp;(to&nbsp;avoid&nbsp;including&nbsp;a&nbsp;Go&nbsp;package&nbsp;clause&nbsp;doc&nbsp;comment),</span><br>
<span class="lineno"></span><span class="comment" id="5806725">//&nbsp;lines&nbsp;beginning&nbsp;with&nbsp;&#39;//&nbsp;+build&#39;&nbsp;are&nbsp;taken&nbsp;as&nbsp;build&nbsp;directives.</span><br>
<span class="lineno"></span><span class="comment" id="5806792">//</span><br>
<span class="lineno"></span><span class="comment" id="5806795">//&nbsp;The&nbsp;file&nbsp;is&nbsp;accepted&nbsp;only&nbsp;if&nbsp;each&nbsp;such&nbsp;line&nbsp;lists&nbsp;something</span><br>
<span class="lineno">1005</span><span class="comment" id="5806858">//&nbsp;matching&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="5806894">//</span><br>
<span class="lineno"></span><span class="comment" id="5806897">//&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;+build&nbsp;windows&nbsp;linux</span><br>
<span class="lineno"></span><span class="comment" id="5806924">//</span><br>
<span class="lineno"></span><span class="comment" id="5806927">//&nbsp;marks&nbsp;the&nbsp;file&nbsp;as&nbsp;applicable&nbsp;only&nbsp;on&nbsp;Windows&nbsp;and&nbsp;Linux.</span><br>
<span class="lineno">1010</span><span class="comment" id="5806986">//</span><br>
<span class="lineno"></span><span class="keyword" id="5806989">func</span>&nbsp;<span class="op" id="5806994">(</span><span class="ident" id="5806995">ctxt</span>&nbsp;<span class="op" id="5807000">*</span><span class="ident" id="5807001">Context</span><span class="op" id="5807008">)</span>&nbsp;<span class="ident" id="5807010">shouldBuild</span><span class="op" id="5807021">(</span><span class="ident" id="5807022">content</span>&nbsp;<span class="op" id="5807030">[</span><span class="op" id="5807031">]</span><span class="builtintype" id="5807032">byte</span><span class="op" id="5807036">,</span>&nbsp;<span class="ident" id="5807038">allTags</span>&nbsp;<span class="keyword" id="5807046">map</span><span class="op" id="5807049">[</span><span class="builtintype" id="5807050">string</span><span class="op" id="5807056">]</span><span class="builtintype" id="5807057">bool</span><span class="op" id="5807061">)</span>&nbsp;<span class="builtintype" id="5807063">bool</span>&nbsp;<span class="op" id="5807068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5807071">//&nbsp;Pass&nbsp;1.&nbsp;Identify&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments&nbsp;and&nbsp;blank&nbsp;lines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5807136">//&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807180">end</span>&nbsp;<span class="op" id="5807184">:=</span>&nbsp;<span class="num" id="5807187">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807190">p</span>&nbsp;<span class="op" id="5807192">:=</span>&nbsp;<span class="ident" id="5807195">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807204">for</span>&nbsp;<span class="builtinfunc" id="5807208">len</span><span class="op" id="5807211">(</span><span class="ident" id="5807212">p</span><span class="op" id="5807213">)</span>&nbsp;<span class="op" id="5807215">&gt;</span>&nbsp;<span class="num" id="5807217">0</span>&nbsp;<span class="op" id="5807219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807223">line</span>&nbsp;<span class="op" id="5807228">:=</span>&nbsp;<span class="ident" id="5807231">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807235">if</span>&nbsp;<span class="ident" id="5807238">i</span>&nbsp;<span class="op" id="5807240">:=</span>&nbsp;<span class="ident" id="5807243">bytes</span><span class="op" id="5807248">.</span><span class="ident" id="5807249">IndexByte</span><span class="op" id="5807258">(</span><span class="ident" id="5807259">line</span><span class="op" id="5807263">,</span>&nbsp;<span class="string" id="5807265">&#39;\n&#39;</span><span class="op" id="5807269">)</span><span class="op" id="5807270">;</span>&nbsp;<span class="ident" id="5807272">i</span>&nbsp;<span class="op" id="5807274">&gt;=</span>&nbsp;<span class="num" id="5807277">0</span>&nbsp;<span class="op" id="5807279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807284">line</span><span class="op" id="5807288">,</span>&nbsp;<span class="ident" id="5807290">p</span>&nbsp;<span class="op" id="5807292">=</span>&nbsp;<span class="ident" id="5807294">line</span><span class="op" id="5807298">[</span><span class="op" id="5807299">:</span><span class="ident" id="5807300">i</span><span class="op" id="5807301">]</span><span class="op" id="5807302">,</span>&nbsp;<span class="ident" id="5807304">p</span><span class="op" id="5807305">[</span><span class="ident" id="5807306">i</span><span class="op" id="5807307">+</span><span class="num" id="5807308">1</span><span class="op" id="5807309">:</span><span class="op" id="5807310">]</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5807314">}</span>&nbsp;<span class="keyword" id="5807316">else</span>&nbsp;<span class="op" id="5807321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807326">p</span>&nbsp;<span class="op" id="5807328">=</span>&nbsp;<span class="ident" id="5807330">p</span><span class="op" id="5807331">[</span><span class="builtinfunc" id="5807332">len</span><span class="op" id="5807335">(</span><span class="ident" id="5807336">p</span><span class="op" id="5807337">)</span><span class="op" id="5807338">:</span><span class="op" id="5807339">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5807343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807347">line</span>&nbsp;<span class="op" id="5807352">=</span>&nbsp;<span class="ident" id="5807354">bytes</span><span class="op" id="5807359">.</span><span class="ident" id="5807360">TrimSpace</span><span class="op" id="5807369">(</span><span class="ident" id="5807370">line</span><span class="op" id="5807374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807378">if</span>&nbsp;<span class="builtinfunc" id="5807381">len</span><span class="op" id="5807384">(</span><span class="ident" id="5807385">line</span><span class="op" id="5807389">)</span>&nbsp;<span class="op" id="5807391">==</span>&nbsp;<span class="num" id="5807394">0</span>&nbsp;<span class="op" id="5807396">{</span>&nbsp;<span class="comment" id="5807398">//&nbsp;Blank&nbsp;line</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807415">end</span>&nbsp;<span class="op" id="5807419">=</span>&nbsp;<span class="builtinfunc" id="5807421">len</span><span class="op" id="5807424">(</span><span class="ident" id="5807425">content</span><span class="op" id="5807432">)</span>&nbsp;<span class="op" id="5807434">-</span>&nbsp;<span class="builtinfunc" id="5807436">len</span><span class="op" id="5807439">(</span><span class="ident" id="5807440">p</span><span class="op" id="5807441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807446">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5807457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807461">if</span>&nbsp;<span class="op" id="5807464">!</span><span class="ident" id="5807465">bytes</span><span class="op" id="5807470">.</span><span class="ident" id="5807471">HasPrefix</span><span class="op" id="5807480">(</span><span class="ident" id="5807481">line</span><span class="op" id="5807485">,</span>&nbsp;<span class="ident" id="5807487">slashslash</span><span class="op" id="5807497">)</span>&nbsp;<span class="op" id="5807499">{</span>&nbsp;<span class="comment" id="5807501">//&nbsp;Not&nbsp;comment&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807524">break</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5807532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5807535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807538">content</span>&nbsp;<span class="op" id="5807546">=</span>&nbsp;<span class="ident" id="5807548">content</span><span class="op" id="5807555">[</span><span class="op" id="5807556">:</span><span class="ident" id="5807557">end</span><span class="op" id="5807560">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5807564">//&nbsp;Pass&nbsp;2.&nbsp;&nbsp;Process&nbsp;each&nbsp;line&nbsp;in&nbsp;the&nbsp;run.</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807607">p</span>&nbsp;<span class="op" id="5807609">=</span>&nbsp;<span class="ident" id="5807611">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807620">allok</span>&nbsp;<span class="op" id="5807626">:=</span>&nbsp;<span class="builtintype" id="5807629">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807635">for</span>&nbsp;<span class="builtinfunc" id="5807639">len</span><span class="op" id="5807642">(</span><span class="ident" id="5807643">p</span><span class="op" id="5807644">)</span>&nbsp;<span class="op" id="5807646">&gt;</span>&nbsp;<span class="num" id="5807648">0</span>&nbsp;<span class="op" id="5807650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807654">line</span>&nbsp;<span class="op" id="5807659">:=</span>&nbsp;<span class="ident" id="5807662">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807666">if</span>&nbsp;<span class="ident" id="5807669">i</span>&nbsp;<span class="op" id="5807671">:=</span>&nbsp;<span class="ident" id="5807674">bytes</span><span class="op" id="5807679">.</span><span class="ident" id="5807680">IndexByte</span><span class="op" id="5807689">(</span><span class="ident" id="5807690">line</span><span class="op" id="5807694">,</span>&nbsp;<span class="string" id="5807696">&#39;\n&#39;</span><span class="op" id="5807700">)</span><span class="op" id="5807701">;</span>&nbsp;<span class="ident" id="5807703">i</span>&nbsp;<span class="op" id="5807705">&gt;=</span>&nbsp;<span class="num" id="5807708">0</span>&nbsp;<span class="op" id="5807710">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807715">line</span><span class="op" id="5807719">,</span>&nbsp;<span class="ident" id="5807721">p</span>&nbsp;<span class="op" id="5807723">=</span>&nbsp;<span class="ident" id="5807725">line</span><span class="op" id="5807729">[</span><span class="op" id="5807730">:</span><span class="ident" id="5807731">i</span><span class="op" id="5807732">]</span><span class="op" id="5807733">,</span>&nbsp;<span class="ident" id="5807735">p</span><span class="op" id="5807736">[</span><span class="ident" id="5807737">i</span><span class="op" id="5807738">+</span><span class="num" id="5807739">1</span><span class="op" id="5807740">:</span><span class="op" id="5807741">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5807745">}</span>&nbsp;<span class="keyword" id="5807747">else</span>&nbsp;<span class="op" id="5807752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807757">p</span>&nbsp;<span class="op" id="5807759">=</span>&nbsp;<span class="ident" id="5807761">p</span><span class="op" id="5807762">[</span><span class="builtinfunc" id="5807763">len</span><span class="op" id="5807766">(</span><span class="ident" id="5807767">p</span><span class="op" id="5807768">)</span><span class="op" id="5807769">:</span><span class="op" id="5807770">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5807774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807778">line</span>&nbsp;<span class="op" id="5807783">=</span>&nbsp;<span class="ident" id="5807785">bytes</span><span class="op" id="5807790">.</span><span class="ident" id="5807791">TrimSpace</span><span class="op" id="5807800">(</span><span class="ident" id="5807801">line</span><span class="op" id="5807805">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807809">if</span>&nbsp;<span class="ident" id="5807812">bytes</span><span class="op" id="5807817">.</span><span class="ident" id="5807818">HasPrefix</span><span class="op" id="5807827">(</span><span class="ident" id="5807828">line</span><span class="op" id="5807832">,</span>&nbsp;<span class="ident" id="5807834">slashslash</span><span class="op" id="5807844">)</span>&nbsp;<span class="op" id="5807846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807851">line</span>&nbsp;<span class="op" id="5807856">=</span>&nbsp;<span class="ident" id="5807858">bytes</span><span class="op" id="5807863">.</span><span class="ident" id="5807864">TrimSpace</span><span class="op" id="5807873">(</span><span class="ident" id="5807874">line</span><span class="op" id="5807878">[</span><span class="builtinfunc" id="5807879">len</span><span class="op" id="5807882">(</span><span class="ident" id="5807883">slashslash</span><span class="op" id="5807893">)</span><span class="op" id="5807894">:</span><span class="op" id="5807895">]</span><span class="op" id="5807896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807901">if</span>&nbsp;<span class="builtinfunc" id="5807904">len</span><span class="op" id="5807907">(</span><span class="ident" id="5807908">line</span><span class="op" id="5807912">)</span>&nbsp;<span class="op" id="5807914">&gt;</span>&nbsp;<span class="num" id="5807916">0</span>&nbsp;<span class="op" id="5807918">&amp;&amp;</span>&nbsp;<span class="ident" id="5807921">line</span><span class="op" id="5807925">[</span><span class="num" id="5807926">0</span><span class="op" id="5807927">]</span>&nbsp;<span class="op" id="5807929">==</span>&nbsp;<span class="string" id="5807932">&#39;+&#39;</span>&nbsp;<span class="op" id="5807936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5807942">//&nbsp;Looks&nbsp;like&nbsp;a&nbsp;comment&nbsp;+line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807977">f</span>&nbsp;<span class="op" id="5807979">:=</span>&nbsp;<span class="ident" id="5807982">strings</span><span class="op" id="5807989">.</span><span class="ident" id="5807990">Fields</span><span class="op" id="5807996">(</span><span class="builtintype" id="5807997">string</span><span class="op" id="5808003">(</span><span class="ident" id="5808004">line</span><span class="op" id="5808008">)</span><span class="op" id="5808009">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5808015">if</span>&nbsp;<span class="ident" id="5808018">f</span><span class="op" id="5808019">[</span><span class="num" id="5808020">0</span><span class="op" id="5808021">]</span>&nbsp;<span class="op" id="5808023">==</span>&nbsp;<span class="string" id="5808026">&#34;+build&#34;</span>&nbsp;<span class="op" id="5808035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5808042">ok</span>&nbsp;<span class="op" id="5808045">:=</span>&nbsp;<span class="builtintype" id="5808048">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5808059">for</span>&nbsp;<span class="ident" id="5808063">_</span><span class="op" id="5808064">,</span>&nbsp;<span class="ident" id="5808066">tok</span>&nbsp;<span class="op" id="5808070">:=</span>&nbsp;<span class="keyword" id="5808073">range</span>&nbsp;<span class="ident" id="5808079">f</span><span class="op" id="5808080">[</span><span class="num" id="5808081">1</span><span class="op" id="5808082">:</span><span class="op" id="5808083">]</span>&nbsp;<span class="op" id="5808085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5808093">if</span>&nbsp;<span class="ident" id="5808096">ctxt</span><span class="op" id="5808100">.</span><span class="ident" id="5808101">match</span><span class="op" id="5808106">(</span><span class="ident" id="5808107">tok</span><span class="op" id="5808110">,</span>&nbsp;<span class="ident" id="5808112">allTags</span><span class="op" id="5808119">)</span>&nbsp;<span class="op" id="5808121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5808130">ok</span>&nbsp;<span class="op" id="5808133">=</span>&nbsp;<span class="builtintype" id="5808135">true</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5808146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5808153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5808160">if</span>&nbsp;<span class="op" id="5808163">!</span><span class="ident" id="5808164">ok</span>&nbsp;<span class="op" id="5808167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5808175">allok</span>&nbsp;<span class="op" id="5808181">=</span>&nbsp;<span class="builtintype" id="5808183">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5808194">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5808200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5808205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5808209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5808212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5808216">return</span>&nbsp;<span class="ident" id="5808223">allok</span><br>
<span class="lineno"></span><span class="op" id="5808229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5808232">//&nbsp;saveCgo&nbsp;saves&nbsp;the&nbsp;information&nbsp;from&nbsp;the&nbsp;#cgo&nbsp;lines&nbsp;in&nbsp;the&nbsp;import&nbsp;&#34;C&#34;&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5808312">//&nbsp;These&nbsp;lines&nbsp;set&nbsp;CFLAGS,&nbsp;CPPFLAGS,&nbsp;CXXFLAGS&nbsp;and&nbsp;LDFLAGS&nbsp;and&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno">1070</span><span class="comment" id="5808396">//&nbsp;that&nbsp;affect&nbsp;the&nbsp;way&nbsp;cgo&#39;s&nbsp;C&nbsp;code&nbsp;is&nbsp;built.</span><br>
<span class="lineno"></span><span class="comment" id="5808442">//</span><br>
<span class="lineno"></span><span class="comment" id="5808445">//&nbsp;TODO(rsc):&nbsp;This&nbsp;duplicates&nbsp;code&nbsp;in&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="comment" id="5808488">//&nbsp;Once&nbsp;the&nbsp;dust&nbsp;settles,&nbsp;remove&nbsp;this&nbsp;code&nbsp;from&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="keyword" id="5808541">func</span>&nbsp;<span class="op" id="5808546">(</span><span class="ident" id="5808547">ctxt</span>&nbsp;<span class="op" id="5808552">*</span><span class="ident" id="5808553">Context</span><span class="op" id="5808560">)</span>&nbsp;<span class="ident" id="5808562">saveCgo</span><span class="op" id="5808569">(</span><span class="ident" id="5808570">filename</span>&nbsp;<span class="builtintype" id="5808579">string</span><span class="op" id="5808585">,</span>&nbsp;<span class="ident" id="5808587">di</span>&nbsp;<span class="op" id="5808590">*</span><span class="ident" id="5808591">Package</span><span class="op" id="5808598">,</span>&nbsp;<span class="ident" id="5808600">cg</span>&nbsp;<span class="op" id="5808603">*</span><span class="ident" id="5808604">ast</span><span class="op" id="5808607">.</span><span class="ident" id="5808608">CommentGroup</span><span class="op" id="5808620">)</span>&nbsp;<span class="builtintype" id="5808622">error</span>&nbsp;<span class="op" id="5808628">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5808631">text</span>&nbsp;<span class="op" id="5808636">:=</span>&nbsp;<span class="ident" id="5808639">cg</span><span class="op" id="5808641">.</span><span class="ident" id="5808642">Text</span><span class="op" id="5808646">(</span><span class="op" id="5808647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5808650">for</span>&nbsp;<span class="ident" id="5808654">_</span><span class="op" id="5808655">,</span>&nbsp;<span class="ident" id="5808657">line</span>&nbsp;<span class="op" id="5808662">:=</span>&nbsp;<span class="keyword" id="5808665">range</span>&nbsp;<span class="ident" id="5808671">strings</span><span class="op" id="5808678">.</span><span class="ident" id="5808679">Split</span><span class="op" id="5808684">(</span><span class="ident" id="5808685">text</span><span class="op" id="5808689">,</span>&nbsp;<span class="string" id="5808691">&#34;\n&#34;</span><span class="op" id="5808695">)</span>&nbsp;<span class="op" id="5808697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5808701">orig</span>&nbsp;<span class="op" id="5808706">:=</span>&nbsp;<span class="ident" id="5808709">line</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5808717">//&nbsp;Line&nbsp;is</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5808730">//&nbsp;&nbsp;&nbsp;&nbsp#cgo&nbsp;[GOOS/GOARCH...]&nbsp;LDFLAGS:&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5808772">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5808777">line</span>&nbsp;<span class="op" id="5808782">=</span>&nbsp;<span class="ident" id="5808784">strings</span><span class="op" id="5808791">.</span><span class="ident" id="5808792">TrimSpace</span><span class="op" id="5808801">(</span><span class="ident" id="5808802">line</span><span class="op" id="5808806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5808810">if</span>&nbsp;<span class="builtinfunc" id="5808813">len</span><span class="op" id="5808816">(</span><span class="ident" id="5808817">line</span><span class="op" id="5808821">)</span>&nbsp;<span class="op" id="5808823">&lt;</span>&nbsp;<span class="num" id="5808825">5</span>&nbsp;<span class="op" id="5808827">||</span>&nbsp;<span class="ident" id="5808830">line</span><span class="op" id="5808834">[</span><span class="op" id="5808835">:</span><span class="num" id="5808836">4</span><span class="op" id="5808837">]</span>&nbsp;<span class="op" id="5808839">!=</span>&nbsp;<span class="string" id="5808842">&#34;#cgo&#34;</span>&nbsp;<span class="op" id="5808849">||</span>&nbsp;<span class="op" id="5808852">(</span><span class="ident" id="5808853">line</span><span class="op" id="5808857">[</span><span class="num" id="5808858">4</span><span class="op" id="5808859">]</span>&nbsp;<span class="op" id="5808861">!=</span>&nbsp;<span class="string" id="5808864">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5808868">&amp;&amp;</span>&nbsp;<span class="ident" id="5808871">line</span><span class="op" id="5808875">[</span><span class="num" id="5808876">4</span><span class="op" id="5808877">]</span>&nbsp;<span class="op" id="5808879">!=</span>&nbsp;<span class="string" id="5808882">&#39;\t&#39;</span><span class="op" id="5808886">)</span>&nbsp;<span class="op" id="5808888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5808893">continue</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5808904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5808909">//&nbsp;Split&nbsp;at&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5808930">line</span>&nbsp;<span class="op" id="5808935">=</span>&nbsp;<span class="ident" id="5808937">strings</span><span class="op" id="5808944">.</span><span class="ident" id="5808945">TrimSpace</span><span class="op" id="5808954">(</span><span class="ident" id="5808955">line</span><span class="op" id="5808959">[</span><span class="num" id="5808960">4</span><span class="op" id="5808961">:</span><span class="op" id="5808962">]</span><span class="op" id="5808963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5808967">i</span>&nbsp;<span class="op" id="5808969">:=</span>&nbsp;<span class="ident" id="5808972">strings</span><span class="op" id="5808979">.</span><span class="ident" id="5808980">Index</span><span class="op" id="5808985">(</span><span class="ident" id="5808986">line</span><span class="op" id="5808990">,</span>&nbsp;<span class="string" id="5808992">&#34;:&#34;</span><span class="op" id="5808995">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5808999">if</span>&nbsp;<span class="ident" id="5809002">i</span>&nbsp;<span class="op" id="5809004">&lt;</span>&nbsp;<span class="num" id="5809006">0</span>&nbsp;<span class="op" id="5809008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809013">return</span>&nbsp;<span class="ident" id="5809020">fmt</span><span class="op" id="5809023">.</span><span class="ident" id="5809024">Errorf</span><span class="op" id="5809030">(</span><span class="string" id="5809031">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5809058">,</span>&nbsp;<span class="ident" id="5809060">filename</span><span class="op" id="5809068">,</span>&nbsp;<span class="ident" id="5809070">orig</span><span class="op" id="5809074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5809078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5809082">line</span><span class="op" id="5809086">,</span>&nbsp;<span class="ident" id="5809088">argstr</span>&nbsp;<span class="op" id="5809095">:=</span>&nbsp;<span class="ident" id="5809098">line</span><span class="op" id="5809102">[</span><span class="op" id="5809103">:</span><span class="ident" id="5809104">i</span><span class="op" id="5809105">]</span><span class="op" id="5809106">,</span>&nbsp;<span class="ident" id="5809108">line</span><span class="op" id="5809112">[</span><span class="ident" id="5809113">i</span><span class="op" id="5809114">+</span><span class="num" id="5809115">1</span><span class="op" id="5809116">:</span><span class="op" id="5809117">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5809122">//&nbsp;Parse&nbsp;GOOS/GOARCH&nbsp;stuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5809152">f</span>&nbsp;<span class="op" id="5809154">:=</span>&nbsp;<span class="ident" id="5809157">strings</span><span class="op" id="5809164">.</span><span class="ident" id="5809165">Fields</span><span class="op" id="5809171">(</span><span class="ident" id="5809172">line</span><span class="op" id="5809176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809180">if</span>&nbsp;<span class="builtinfunc" id="5809183">len</span><span class="op" id="5809186">(</span><span class="ident" id="5809187">f</span><span class="op" id="5809188">)</span>&nbsp;<span class="op" id="5809190">&lt;</span>&nbsp;<span class="num" id="5809192">1</span>&nbsp;<span class="op" id="5809194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809199">return</span>&nbsp;<span class="ident" id="5809206">fmt</span><span class="op" id="5809209">.</span><span class="ident" id="5809210">Errorf</span><span class="op" id="5809216">(</span><span class="string" id="5809217">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5809244">,</span>&nbsp;<span class="ident" id="5809246">filename</span><span class="op" id="5809254">,</span>&nbsp;<span class="ident" id="5809256">orig</span><span class="op" id="5809260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5809264">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5809269">cond</span><span class="op" id="5809273">,</span>&nbsp;<span class="ident" id="5809275">verb</span>&nbsp;<span class="op" id="5809280">:=</span>&nbsp;<span class="ident" id="5809283">f</span><span class="op" id="5809284">[</span><span class="op" id="5809285">:</span><span class="builtinfunc" id="5809286">len</span><span class="op" id="5809289">(</span><span class="ident" id="5809290">f</span><span class="op" id="5809291">)</span><span class="op" id="5809292">-</span><span class="num" id="5809293">1</span><span class="op" id="5809294">]</span><span class="op" id="5809295">,</span>&nbsp;<span class="ident" id="5809297">f</span><span class="op" id="5809298">[</span><span class="builtinfunc" id="5809299">len</span><span class="op" id="5809302">(</span><span class="ident" id="5809303">f</span><span class="op" id="5809304">)</span><span class="op" id="5809305">-</span><span class="num" id="5809306">1</span><span class="op" id="5809307">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809311">if</span>&nbsp;<span class="builtinfunc" id="5809314">len</span><span class="op" id="5809317">(</span><span class="ident" id="5809318">cond</span><span class="op" id="5809322">)</span>&nbsp;<span class="op" id="5809324">&gt;</span>&nbsp;<span class="num" id="5809326">0</span>&nbsp;<span class="op" id="5809328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5809333">ok</span>&nbsp;<span class="op" id="5809336">:=</span>&nbsp;<span class="builtintype" id="5809339">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809348">for</span>&nbsp;<span class="ident" id="5809352">_</span><span class="op" id="5809353">,</span>&nbsp;<span class="ident" id="5809355">c</span>&nbsp;<span class="op" id="5809357">:=</span>&nbsp;<span class="keyword" id="5809360">range</span>&nbsp;<span class="ident" id="5809366">cond</span>&nbsp;<span class="op" id="5809371">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809377">if</span>&nbsp;<span class="ident" id="5809380">ctxt</span><span class="op" id="5809384">.</span><span class="ident" id="5809385">match</span><span class="op" id="5809390">(</span><span class="ident" id="5809391">c</span><span class="op" id="5809392">,</span>&nbsp;<span class="ident" id="5809394">nil</span><span class="op" id="5809397">)</span>&nbsp;<span class="op" id="5809399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5809406">ok</span>&nbsp;<span class="op" id="5809409">=</span>&nbsp;<span class="builtintype" id="5809411">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809421">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5809431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5809436">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809441">if</span>&nbsp;<span class="op" id="5809444">!</span><span class="ident" id="5809445">ok</span>&nbsp;<span class="op" id="5809448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809454">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5809466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5809470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5809475">args</span><span class="op" id="5809479">,</span>&nbsp;<span class="ident" id="5809481">err</span>&nbsp;<span class="op" id="5809485">:=</span>&nbsp;<span class="ident" id="5809488">splitQuoted</span><span class="op" id="5809499">(</span><span class="ident" id="5809500">argstr</span><span class="op" id="5809506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809510">if</span>&nbsp;<span class="ident" id="5809513">err</span>&nbsp;<span class="op" id="5809517">!=</span>&nbsp;<span class="ident" id="5809520">nil</span>&nbsp;<span class="op" id="5809524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809529">return</span>&nbsp;<span class="ident" id="5809536">fmt</span><span class="op" id="5809539">.</span><span class="ident" id="5809540">Errorf</span><span class="op" id="5809546">(</span><span class="string" id="5809547">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5809574">,</span>&nbsp;<span class="ident" id="5809576">filename</span><span class="op" id="5809584">,</span>&nbsp;<span class="ident" id="5809586">orig</span><span class="op" id="5809590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5809594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809598">for</span>&nbsp;<span class="ident" id="5809602">_</span><span class="op" id="5809603">,</span>&nbsp;<span class="ident" id="5809605">arg</span>&nbsp;<span class="op" id="5809609">:=</span>&nbsp;<span class="keyword" id="5809612">range</span>&nbsp;<span class="ident" id="5809618">args</span>&nbsp;<span class="op" id="5809623">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809628">if</span>&nbsp;<span class="op" id="5809631">!</span><span class="ident" id="5809632">safeCgoName</span><span class="op" id="5809643">(</span><span class="ident" id="5809644">arg</span><span class="op" id="5809647">)</span>&nbsp;<span class="op" id="5809649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809655">return</span>&nbsp;<span class="ident" id="5809662">fmt</span><span class="op" id="5809665">.</span><span class="ident" id="5809666">Errorf</span><span class="op" id="5809672">(</span><span class="string" id="5809673">&#34;%s:&nbsp;malformed&nbsp;#cgo&nbsp;argument:&nbsp;%s&#34;</span><span class="op" id="5809706">,</span>&nbsp;<span class="ident" id="5809708">filename</span><span class="op" id="5809716">,</span>&nbsp;<span class="ident" id="5809718">arg</span><span class="op" id="5809721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5809726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5809730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809735">switch</span>&nbsp;<span class="ident" id="5809742">verb</span>&nbsp;<span class="op" id="5809747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809751">case</span>&nbsp;<span class="string" id="5809756">&#34;CFLAGS&#34;</span><span class="op" id="5809764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5809769">di</span><span class="op" id="5809771">.</span><span class="ident" id="5809772">CgoCFLAGS</span>&nbsp;<span class="op" id="5809782">=</span>&nbsp;<span class="builtinfunc" id="5809784">append</span><span class="op" id="5809790">(</span><span class="ident" id="5809791">di</span><span class="op" id="5809793">.</span><span class="ident" id="5809794">CgoCFLAGS</span><span class="op" id="5809803">,</span>&nbsp;<span class="ident" id="5809805">args</span><span class="op" id="5809809">...</span><span class="op" id="5809812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809816">case</span>&nbsp;<span class="string" id="5809821">&#34;CPPFLAGS&#34;</span><span class="op" id="5809831">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5809836">di</span><span class="op" id="5809838">.</span><span class="ident" id="5809839">CgoCPPFLAGS</span>&nbsp;<span class="op" id="5809851">=</span>&nbsp;<span class="builtinfunc" id="5809853">append</span><span class="op" id="5809859">(</span><span class="ident" id="5809860">di</span><span class="op" id="5809862">.</span><span class="ident" id="5809863">CgoCPPFLAGS</span><span class="op" id="5809874">,</span>&nbsp;<span class="ident" id="5809876">args</span><span class="op" id="5809880">...</span><span class="op" id="5809883">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809887">case</span>&nbsp;<span class="string" id="5809892">&#34;CXXFLAGS&#34;</span><span class="op" id="5809902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5809907">di</span><span class="op" id="5809909">.</span><span class="ident" id="5809910">CgoCXXFLAGS</span>&nbsp;<span class="op" id="5809922">=</span>&nbsp;<span class="builtinfunc" id="5809924">append</span><span class="op" id="5809930">(</span><span class="ident" id="5809931">di</span><span class="op" id="5809933">.</span><span class="ident" id="5809934">CgoCXXFLAGS</span><span class="op" id="5809945">,</span>&nbsp;<span class="ident" id="5809947">args</span><span class="op" id="5809951">...</span><span class="op" id="5809954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5809958">case</span>&nbsp;<span class="string" id="5809963">&#34;LDFLAGS&#34;</span><span class="op" id="5809972">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5809977">di</span><span class="op" id="5809979">.</span><span class="ident" id="5809980">CgoLDFLAGS</span>&nbsp;<span class="op" id="5809991">=</span>&nbsp;<span class="builtinfunc" id="5809993">append</span><span class="op" id="5809999">(</span><span class="ident" id="5810000">di</span><span class="op" id="5810002">.</span><span class="ident" id="5810003">CgoLDFLAGS</span><span class="op" id="5810013">,</span>&nbsp;<span class="ident" id="5810015">args</span><span class="op" id="5810019">...</span><span class="op" id="5810022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5810026">case</span>&nbsp;<span class="string" id="5810031">&#34;pkg-config&#34;</span><span class="op" id="5810043">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5810048">di</span><span class="op" id="5810050">.</span><span class="ident" id="5810051">CgoPkgConfig</span>&nbsp;<span class="op" id="5810064">=</span>&nbsp;<span class="builtinfunc" id="5810066">append</span><span class="op" id="5810072">(</span><span class="ident" id="5810073">di</span><span class="op" id="5810075">.</span><span class="ident" id="5810076">CgoPkgConfig</span><span class="op" id="5810088">,</span>&nbsp;<span class="ident" id="5810090">args</span><span class="op" id="5810094">...</span><span class="op" id="5810097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5810101">default</span><span class="op" id="5810108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5810113">return</span>&nbsp;<span class="ident" id="5810120">fmt</span><span class="op" id="5810123">.</span><span class="ident" id="5810124">Errorf</span><span class="op" id="5810130">(</span><span class="string" id="5810131">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;verb:&nbsp;%s&#34;</span><span class="op" id="5810158">,</span>&nbsp;<span class="ident" id="5810160">filename</span><span class="op" id="5810168">,</span>&nbsp;<span class="ident" id="5810170">orig</span><span class="op" id="5810174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5810178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5810181">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5810184">return</span>&nbsp;<span class="ident" id="5810191">nil</span><br>
<span class="lineno"></span><span class="op" id="5810195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5810198">//&nbsp;NOTE:&nbsp;$&nbsp;is&nbsp;not&nbsp;safe&nbsp;for&nbsp;the&nbsp;shell,&nbsp;but&nbsp;it&nbsp;is&nbsp;allowed&nbsp;here&nbsp;because&nbsp;of&nbsp;linker&nbsp;options&nbsp;like&nbsp;-Wl,$ORIGIN.</span><br>
<span class="lineno"></span><span class="comment" id="5810303">//&nbsp;We&nbsp;never&nbsp;pass&nbsp;these&nbsp;arguments&nbsp;to&nbsp;a&nbsp;shell&nbsp;(just&nbsp;to&nbsp;programs&nbsp;we&nbsp;construct&nbsp;argv&nbsp;for),&nbsp;so&nbsp;this&nbsp;should&nbsp;be&nbsp;okay.</span><br>
<span class="lineno">1145</span><span class="comment" id="5810413">//&nbsp;See&nbsp;golang.org/issue/6038.</span><br>
<span class="lineno"></span><span class="keyword" id="5810443">var</span>&nbsp;<span class="ident" id="5810447">safeBytes</span>&nbsp;<span class="op" id="5810457">=</span>&nbsp;<span class="op" id="5810459">[</span><span class="op" id="5810460">]</span><span class="builtintype" id="5810461">byte</span><span class="op" id="5810465">(</span><span class="string" id="5810466">&#34;+-.,/0123456789=ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz:$&#34;</span><span class="op" id="5810539">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5810542">func</span>&nbsp;<span class="ident" id="5810547">safeCgoName</span><span class="op" id="5810558">(</span><span class="ident" id="5810559">s</span>&nbsp;<span class="builtintype" id="5810561">string</span><span class="op" id="5810567">)</span>&nbsp;<span class="builtintype" id="5810569">bool</span>&nbsp;<span class="op" id="5810574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5810577">if</span>&nbsp;<span class="ident" id="5810580">s</span>&nbsp;<span class="op" id="5810582">==</span>&nbsp;<span class="string" id="5810585">&#34;&#34;</span>&nbsp;<span class="op" id="5810588">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5810592">return</span>&nbsp;<span class="builtintype" id="5810599">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5810606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5810609">for</span>&nbsp;<span class="ident" id="5810613">i</span>&nbsp;<span class="op" id="5810615">:=</span>&nbsp;<span class="num" id="5810618">0</span><span class="op" id="5810619">;</span>&nbsp;<span class="ident" id="5810621">i</span>&nbsp;<span class="op" id="5810623">&lt;</span>&nbsp;<span class="builtinfunc" id="5810625">len</span><span class="op" id="5810628">(</span><span class="ident" id="5810629">s</span><span class="op" id="5810630">)</span><span class="op" id="5810631">;</span>&nbsp;<span class="ident" id="5810633">i</span><span class="op" id="5810634">++</span>&nbsp;<span class="op" id="5810637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5810641">if</span>&nbsp;<span class="ident" id="5810644">c</span>&nbsp;<span class="op" id="5810646">:=</span>&nbsp;<span class="ident" id="5810649">s</span><span class="op" id="5810650">[</span><span class="ident" id="5810651">i</span><span class="op" id="5810652">]</span><span class="op" id="5810653">;</span>&nbsp;<span class="ident" id="5810655">c</span>&nbsp;<span class="op" id="5810657">&lt;</span>&nbsp;<span class="num" id="5810659">0x80</span>&nbsp;<span class="op" id="5810664">&amp;&amp;</span>&nbsp;<span class="ident" id="5810667">bytes</span><span class="op" id="5810672">.</span><span class="ident" id="5810673">IndexByte</span><span class="op" id="5810682">(</span><span class="ident" id="5810683">safeBytes</span><span class="op" id="5810692">,</span>&nbsp;<span class="ident" id="5810694">c</span><span class="op" id="5810695">)</span>&nbsp;<span class="op" id="5810697">&lt;</span>&nbsp;<span class="num" id="5810699">0</span>&nbsp;<span class="op" id="5810701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5810706">return</span>&nbsp;<span class="builtintype" id="5810713">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5810721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5810724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5810727">return</span>&nbsp;<span class="builtintype" id="5810734">true</span><br>
<span class="lineno"></span><span class="op" id="5810739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="5810742">//&nbsp;splitQuoted&nbsp;splits&nbsp;the&nbsp;string&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive</span><br>
<span class="lineno"></span><span class="comment" id="5810825">//&nbsp;white&nbsp;space&nbsp;characters&nbsp;while&nbsp;taking&nbsp;into&nbsp;account&nbsp;quotes&nbsp;and&nbsp;escaping,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5810902">//&nbsp;returns&nbsp;an&nbsp;array&nbsp;of&nbsp;substrings&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="5810990">//&nbsp;Single&nbsp;quotes&nbsp;and&nbsp;double&nbsp;quotes&nbsp;are&nbsp;recognized&nbsp;to&nbsp;prevent&nbsp;splitting&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5811072">//&nbsp;quoted&nbsp;region,&nbsp;and&nbsp;are&nbsp;removed&nbsp;from&nbsp;the&nbsp;resulting&nbsp;substrings.&nbsp;If&nbsp;a&nbsp;quote&nbsp;in&nbsp;s</span><br>
<span class="lineno">1165</span><span class="comment" id="5811153">//&nbsp;isn&#39;t&nbsp;closed&nbsp;err&nbsp;will&nbsp;be&nbsp;set&nbsp;and&nbsp;r&nbsp;will&nbsp;have&nbsp;the&nbsp;unclosed&nbsp;argument&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5811230">//&nbsp;last&nbsp;element.&nbsp;&nbsp;The&nbsp;backslash&nbsp;is&nbsp;used&nbsp;for&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="comment" id="5811284">//</span><br>
<span class="lineno"></span><span class="comment" id="5811287">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;following&nbsp;string:</span><br>
<span class="lineno"></span><span class="comment" id="5811325">//</span><br>
<span class="lineno">1170</span><span class="comment" id="5811328">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b:&#34;c&nbsp;d&#34;&nbsp;&#39;e&#39;&#39;f&#39;&nbsp;&nbsp;&#34;g\&#34;&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5811359">//</span><br>
<span class="lineno"></span><span class="comment" id="5811362">//&nbsp;Would&nbsp;be&nbsp;parsed&nbsp;as:</span><br>
<span class="lineno"></span><span class="comment" id="5811385">//</span><br>
<span class="lineno"></span><span class="comment" id="5811388">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]string{&#34;a&#34;,&nbsp;&#34;b:c&nbsp;d&#34;,&nbsp;&#34;ef&#34;,&nbsp;`g&#34;`}</span><br>
<span class="lineno">1175</span><span class="comment" id="5811430">//</span><br>
<span class="lineno"></span><span class="keyword" id="5811433">func</span>&nbsp;<span class="ident" id="5811438">splitQuoted</span><span class="op" id="5811449">(</span><span class="ident" id="5811450">s</span>&nbsp;<span class="builtintype" id="5811452">string</span><span class="op" id="5811458">)</span>&nbsp;<span class="op" id="5811460">(</span><span class="ident" id="5811461">r</span>&nbsp;<span class="op" id="5811463">[</span><span class="op" id="5811464">]</span><span class="builtintype" id="5811465">string</span><span class="op" id="5811471">,</span>&nbsp;<span class="ident" id="5811473">err</span>&nbsp;<span class="builtintype" id="5811477">error</span><span class="op" id="5811482">)</span>&nbsp;<span class="op" id="5811484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811487">var</span>&nbsp;<span class="ident" id="5811491">args</span>&nbsp;<span class="op" id="5811496">[</span><span class="op" id="5811497">]</span><span class="builtintype" id="5811498">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811506">arg</span>&nbsp;<span class="op" id="5811510">:=</span>&nbsp;<span class="builtinfunc" id="5811513">make</span><span class="op" id="5811517">(</span><span class="op" id="5811518">[</span><span class="op" id="5811519">]</span><span class="builtintype" id="5811520">rune</span><span class="op" id="5811524">,</span>&nbsp;<span class="builtinfunc" id="5811526">len</span><span class="op" id="5811529">(</span><span class="ident" id="5811530">s</span><span class="op" id="5811531">)</span><span class="op" id="5811532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811535">escaped</span>&nbsp;<span class="op" id="5811543">:=</span>&nbsp;<span class="builtintype" id="5811546">false</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811553">quoted</span>&nbsp;<span class="op" id="5811560">:=</span>&nbsp;<span class="builtintype" id="5811563">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811570">quote</span>&nbsp;<span class="op" id="5811576">:=</span>&nbsp;<span class="string" id="5811579">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811587">i</span>&nbsp;<span class="op" id="5811589">:=</span>&nbsp;<span class="num" id="5811592">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811595">for</span>&nbsp;<span class="ident" id="5811599">_</span><span class="op" id="5811600">,</span>&nbsp;<span class="builtintype" id="5811602">rune</span>&nbsp;<span class="op" id="5811607">:=</span>&nbsp;<span class="keyword" id="5811610">range</span>&nbsp;<span class="ident" id="5811616">s</span>&nbsp;<span class="op" id="5811618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811622">switch</span>&nbsp;<span class="op" id="5811629">{</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811633">case</span>&nbsp;<span class="ident" id="5811638">escaped</span><span class="op" id="5811645">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811650">escaped</span>&nbsp;<span class="op" id="5811658">=</span>&nbsp;<span class="builtintype" id="5811660">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811668">case</span>&nbsp;<span class="builtintype" id="5811673">rune</span>&nbsp;<span class="op" id="5811678">==</span>&nbsp;<span class="string" id="5811681">&#39;\\&#39;</span><span class="op" id="5811685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811690">escaped</span>&nbsp;<span class="op" id="5811698">=</span>&nbsp;<span class="builtintype" id="5811700">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811708">continue</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811719">case</span>&nbsp;<span class="ident" id="5811724">quote</span>&nbsp;<span class="op" id="5811730">!=</span>&nbsp;<span class="string" id="5811733">&#39;\x00&#39;</span><span class="op" id="5811739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811744">if</span>&nbsp;<span class="builtintype" id="5811747">rune</span>&nbsp;<span class="op" id="5811752">==</span>&nbsp;<span class="ident" id="5811755">quote</span>&nbsp;<span class="op" id="5811761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811767">quote</span>&nbsp;<span class="op" id="5811773">=</span>&nbsp;<span class="string" id="5811775">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811786">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5811798">}</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811802">case</span>&nbsp;<span class="builtintype" id="5811807">rune</span>&nbsp;<span class="op" id="5811812">==</span>&nbsp;<span class="string" id="5811815">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5811819">||</span>&nbsp;<span class="builtintype" id="5811822">rune</span>&nbsp;<span class="op" id="5811827">==</span>&nbsp;<span class="string" id="5811830">&#39;\&#39;&#39;</span><span class="op" id="5811834">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811839">quoted</span>&nbsp;<span class="op" id="5811846">=</span>&nbsp;<span class="builtintype" id="5811848">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811856">quote</span>&nbsp;<span class="op" id="5811862">=</span>&nbsp;<span class="builtintype" id="5811864">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811872">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811883">case</span>&nbsp;<span class="ident" id="5811888">unicode</span><span class="op" id="5811895">.</span><span class="ident" id="5811896">IsSpace</span><span class="op" id="5811903">(</span><span class="builtintype" id="5811904">rune</span><span class="op" id="5811908">)</span><span class="op" id="5811909">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5811914">if</span>&nbsp;<span class="ident" id="5811917">quoted</span>&nbsp;<span class="op" id="5811924">||</span>&nbsp;<span class="ident" id="5811927">i</span>&nbsp;<span class="op" id="5811929">&gt;</span>&nbsp;<span class="num" id="5811931">0</span>&nbsp;<span class="op" id="5811933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811939">quoted</span>&nbsp;<span class="op" id="5811946">=</span>&nbsp;<span class="builtintype" id="5811948">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811958">args</span>&nbsp;<span class="op" id="5811963">=</span>&nbsp;<span class="builtinfunc" id="5811965">append</span><span class="op" id="5811971">(</span><span class="ident" id="5811972">args</span><span class="op" id="5811976">,</span>&nbsp;<span class="builtintype" id="5811978">string</span><span class="op" id="5811984">(</span><span class="ident" id="5811985">arg</span><span class="op" id="5811988">[</span><span class="op" id="5811989">:</span><span class="ident" id="5811990">i</span><span class="op" id="5811991">]</span><span class="op" id="5811992">)</span><span class="op" id="5811993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5811999">i</span>&nbsp;<span class="op" id="5812001">=</span>&nbsp;<span class="num" id="5812003">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5812008">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812013">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5812024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5812028">arg</span><span class="op" id="5812031">[</span><span class="ident" id="5812032">i</span><span class="op" id="5812033">]</span>&nbsp;<span class="op" id="5812035">=</span>&nbsp;<span class="builtintype" id="5812037">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5812044">i</span><span class="op" id="5812045">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5812049">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812052">if</span>&nbsp;<span class="ident" id="5812055">quoted</span>&nbsp;<span class="op" id="5812062">||</span>&nbsp;<span class="ident" id="5812065">i</span>&nbsp;<span class="op" id="5812067">&gt;</span>&nbsp;<span class="num" id="5812069">0</span>&nbsp;<span class="op" id="5812071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5812075">args</span>&nbsp;<span class="op" id="5812080">=</span>&nbsp;<span class="builtinfunc" id="5812082">append</span><span class="op" id="5812088">(</span><span class="ident" id="5812089">args</span><span class="op" id="5812093">,</span>&nbsp;<span class="builtintype" id="5812095">string</span><span class="op" id="5812101">(</span><span class="ident" id="5812102">arg</span><span class="op" id="5812105">[</span><span class="op" id="5812106">:</span><span class="ident" id="5812107">i</span><span class="op" id="5812108">]</span><span class="op" id="5812109">)</span><span class="op" id="5812110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5812113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812116">if</span>&nbsp;<span class="ident" id="5812119">quote</span>&nbsp;<span class="op" id="5812125">!=</span>&nbsp;<span class="num" id="5812128">0</span>&nbsp;<span class="op" id="5812130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5812134">err</span>&nbsp;<span class="op" id="5812138">=</span>&nbsp;<span class="ident" id="5812140">errors</span><span class="op" id="5812146">.</span><span class="ident" id="5812147">New</span><span class="op" id="5812150">(</span><span class="string" id="5812151">&#34;unclosed&nbsp;quote&#34;</span><span class="op" id="5812167">)</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5812170">}</span>&nbsp;<span class="keyword" id="5812172">else</span>&nbsp;<span class="keyword" id="5812177">if</span>&nbsp;<span class="ident" id="5812180">escaped</span>&nbsp;<span class="op" id="5812188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5812192">err</span>&nbsp;<span class="op" id="5812196">=</span>&nbsp;<span class="ident" id="5812198">errors</span><span class="op" id="5812204">.</span><span class="ident" id="5812205">New</span><span class="op" id="5812208">(</span><span class="string" id="5812209">&#34;unfinished&nbsp;escaping&#34;</span><span class="op" id="5812230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5812233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812236">return</span>&nbsp;<span class="ident" id="5812243">args</span><span class="op" id="5812247">,</span>&nbsp;<span class="ident" id="5812249">err</span><br>
<span class="lineno"></span><span class="op" id="5812253">}</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span><span class="comment" id="5812256">//&nbsp;match&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;name&nbsp;is&nbsp;one&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="5812301">//</span><br>
<span class="lineno"></span><span class="comment" id="5812304">//&nbsp;&nbsp;&nbsp;&nbsp$GOOS</span><br>
<span class="lineno"></span><span class="comment" id="5812313">//&nbsp;&nbsp;&nbsp;&nbsp$GOARCH</span><br>
<span class="lineno">1225</span><span class="comment" id="5812324">//&nbsp;&nbsp;&nbsp;&nbspcgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;enabled)</span><br>
<span class="lineno"></span><span class="comment" id="5812351">//&nbsp;&nbsp;&nbsp;&nbsp!cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;disabled)</span><br>
<span class="lineno"></span><span class="comment" id="5812380">//&nbsp;&nbsp;&nbsp;&nbspctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="5812397">//&nbsp;&nbsp;&nbsp;&nbsp!ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="5812415">//&nbsp;&nbsp;&nbsp;&nbsptag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno">1230</span><span class="comment" id="5812479">//&nbsp;&nbsp;&nbsp;&nbsp!tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;not&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno"></span><span class="comment" id="5812548">//&nbsp;&nbsp;&nbsp;&nbspa&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;any&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="5812590">//</span><br>
<span class="lineno"></span><span class="keyword" id="5812593">func</span>&nbsp;<span class="op" id="5812598">(</span><span class="ident" id="5812599">ctxt</span>&nbsp;<span class="op" id="5812604">*</span><span class="ident" id="5812605">Context</span><span class="op" id="5812612">)</span>&nbsp;<span class="ident" id="5812614">match</span><span class="op" id="5812619">(</span><span class="ident" id="5812620">name</span>&nbsp;<span class="builtintype" id="5812625">string</span><span class="op" id="5812631">,</span>&nbsp;<span class="ident" id="5812633">allTags</span>&nbsp;<span class="keyword" id="5812641">map</span><span class="op" id="5812644">[</span><span class="builtintype" id="5812645">string</span><span class="op" id="5812651">]</span><span class="builtintype" id="5812652">bool</span><span class="op" id="5812656">)</span>&nbsp;<span class="builtintype" id="5812658">bool</span>&nbsp;<span class="op" id="5812663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812666">if</span>&nbsp;<span class="ident" id="5812669">name</span>&nbsp;<span class="op" id="5812674">==</span>&nbsp;<span class="string" id="5812677">&#34;&#34;</span>&nbsp;<span class="op" id="5812680">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812684">if</span>&nbsp;<span class="ident" id="5812687">allTags</span>&nbsp;<span class="op" id="5812695">!=</span>&nbsp;<span class="ident" id="5812698">nil</span>&nbsp;<span class="op" id="5812702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5812707">allTags</span><span class="op" id="5812714">[</span><span class="ident" id="5812715">name</span><span class="op" id="5812719">]</span>&nbsp;<span class="op" id="5812721">=</span>&nbsp;<span class="builtintype" id="5812723">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5812730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812734">return</span>&nbsp;<span class="builtintype" id="5812741">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5812748">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812751">if</span>&nbsp;<span class="ident" id="5812754">i</span>&nbsp;<span class="op" id="5812756">:=</span>&nbsp;<span class="ident" id="5812759">strings</span><span class="op" id="5812766">.</span><span class="ident" id="5812767">Index</span><span class="op" id="5812772">(</span><span class="ident" id="5812773">name</span><span class="op" id="5812777">,</span>&nbsp;<span class="string" id="5812779">&#34;,&#34;</span><span class="op" id="5812782">)</span><span class="op" id="5812783">;</span>&nbsp;<span class="ident" id="5812785">i</span>&nbsp;<span class="op" id="5812787">&gt;=</span>&nbsp;<span class="num" id="5812790">0</span>&nbsp;<span class="op" id="5812792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5812796">//&nbsp;comma-separated&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5812822">ok1</span>&nbsp;<span class="op" id="5812826">:=</span>&nbsp;<span class="ident" id="5812829">ctxt</span><span class="op" id="5812833">.</span><span class="ident" id="5812834">match</span><span class="op" id="5812839">(</span><span class="ident" id="5812840">name</span><span class="op" id="5812844">[</span><span class="op" id="5812845">:</span><span class="ident" id="5812846">i</span><span class="op" id="5812847">]</span><span class="op" id="5812848">,</span>&nbsp;<span class="ident" id="5812850">allTags</span><span class="op" id="5812857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5812861">ok2</span>&nbsp;<span class="op" id="5812865">:=</span>&nbsp;<span class="ident" id="5812868">ctxt</span><span class="op" id="5812872">.</span><span class="ident" id="5812873">match</span><span class="op" id="5812878">(</span><span class="ident" id="5812879">name</span><span class="op" id="5812883">[</span><span class="ident" id="5812884">i</span><span class="op" id="5812885">+</span><span class="num" id="5812886">1</span><span class="op" id="5812887">:</span><span class="op" id="5812888">]</span><span class="op" id="5812889">,</span>&nbsp;<span class="ident" id="5812891">allTags</span><span class="op" id="5812898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812902">return</span>&nbsp;<span class="ident" id="5812909">ok1</span>&nbsp;<span class="op" id="5812913">&amp;&amp;</span>&nbsp;<span class="ident" id="5812916">ok2</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5812921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812924">if</span>&nbsp;<span class="ident" id="5812927">strings</span><span class="op" id="5812934">.</span><span class="ident" id="5812935">HasPrefix</span><span class="op" id="5812944">(</span><span class="ident" id="5812945">name</span><span class="op" id="5812949">,</span>&nbsp;<span class="string" id="5812951">&#34;!!&#34;</span><span class="op" id="5812955">)</span>&nbsp;<span class="op" id="5812957">{</span>&nbsp;<span class="comment" id="5812959">//&nbsp;bad&nbsp;syntax,&nbsp;reject&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5812990">return</span>&nbsp;<span class="builtintype" id="5812997">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813007">if</span>&nbsp;<span class="ident" id="5813010">strings</span><span class="op" id="5813017">.</span><span class="ident" id="5813018">HasPrefix</span><span class="op" id="5813027">(</span><span class="ident" id="5813028">name</span><span class="op" id="5813032">,</span>&nbsp;<span class="string" id="5813034">&#34;!&#34;</span><span class="op" id="5813037">)</span>&nbsp;<span class="op" id="5813039">{</span>&nbsp;<span class="comment" id="5813041">//&nbsp;negation</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813055">return</span>&nbsp;<span class="builtinfunc" id="5813062">len</span><span class="op" id="5813065">(</span><span class="ident" id="5813066">name</span><span class="op" id="5813070">)</span>&nbsp;<span class="op" id="5813072">&gt;</span>&nbsp;<span class="num" id="5813074">1</span>&nbsp;<span class="op" id="5813076">&amp;&amp;</span>&nbsp;<span class="op" id="5813079">!</span><span class="ident" id="5813080">ctxt</span><span class="op" id="5813084">.</span><span class="ident" id="5813085">match</span><span class="op" id="5813090">(</span><span class="ident" id="5813091">name</span><span class="op" id="5813095">[</span><span class="num" id="5813096">1</span><span class="op" id="5813097">:</span><span class="op" id="5813098">]</span><span class="op" id="5813099">,</span>&nbsp;<span class="ident" id="5813101">allTags</span><span class="op" id="5813108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813115">if</span>&nbsp;<span class="ident" id="5813118">allTags</span>&nbsp;<span class="op" id="5813126">!=</span>&nbsp;<span class="ident" id="5813129">nil</span>&nbsp;<span class="op" id="5813133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5813137">allTags</span><span class="op" id="5813144">[</span><span class="ident" id="5813145">name</span><span class="op" id="5813149">]</span>&nbsp;<span class="op" id="5813151">=</span>&nbsp;<span class="builtintype" id="5813153">true</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5813163">//&nbsp;Tags&nbsp;must&nbsp;be&nbsp;letters,&nbsp;digits,&nbsp;underscores&nbsp;or&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5813218">//&nbsp;Unlike&nbsp;in&nbsp;Go&nbsp;identifiers,&nbsp;all&nbsp;digits&nbsp;are&nbsp;fine&nbsp;(e.g.,&nbsp;&#34;386&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813283">for</span>&nbsp;<span class="ident" id="5813287">_</span><span class="op" id="5813288">,</span>&nbsp;<span class="ident" id="5813290">c</span>&nbsp;<span class="op" id="5813292">:=</span>&nbsp;<span class="keyword" id="5813295">range</span>&nbsp;<span class="ident" id="5813301">name</span>&nbsp;<span class="op" id="5813306">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813310">if</span>&nbsp;<span class="op" id="5813313">!</span><span class="ident" id="5813314">unicode</span><span class="op" id="5813321">.</span><span class="ident" id="5813322">IsLetter</span><span class="op" id="5813330">(</span><span class="ident" id="5813331">c</span><span class="op" id="5813332">)</span>&nbsp;<span class="op" id="5813334">&amp;&amp;</span>&nbsp;<span class="op" id="5813337">!</span><span class="ident" id="5813338">unicode</span><span class="op" id="5813345">.</span><span class="ident" id="5813346">IsDigit</span><span class="op" id="5813353">(</span><span class="ident" id="5813354">c</span><span class="op" id="5813355">)</span>&nbsp;<span class="op" id="5813357">&amp;&amp;</span>&nbsp;<span class="ident" id="5813360">c</span>&nbsp;<span class="op" id="5813362">!=</span>&nbsp;<span class="string" id="5813365">&#39;_&#39;</span>&nbsp;<span class="op" id="5813369">&amp;&amp;</span>&nbsp;<span class="ident" id="5813372">c</span>&nbsp;<span class="op" id="5813374">!=</span>&nbsp;<span class="string" id="5813377">&#39;.&#39;</span>&nbsp;<span class="op" id="5813381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813386">return</span>&nbsp;<span class="builtintype" id="5813393">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5813408">//&nbsp;special&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813425">if</span>&nbsp;<span class="ident" id="5813428">ctxt</span><span class="op" id="5813432">.</span><span class="ident" id="5813433">CgoEnabled</span>&nbsp;<span class="op" id="5813444">&amp;&amp;</span>&nbsp;<span class="ident" id="5813447">name</span>&nbsp;<span class="op" id="5813452">==</span>&nbsp;<span class="string" id="5813455">&#34;cgo&#34;</span>&nbsp;<span class="op" id="5813461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813465">return</span>&nbsp;<span class="builtintype" id="5813472">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813481">if</span>&nbsp;<span class="ident" id="5813484">name</span>&nbsp;<span class="op" id="5813489">==</span>&nbsp;<span class="ident" id="5813492">ctxt</span><span class="op" id="5813496">.</span><span class="ident" id="5813497">GOOS</span>&nbsp;<span class="op" id="5813502">||</span>&nbsp;<span class="ident" id="5813505">name</span>&nbsp;<span class="op" id="5813510">==</span>&nbsp;<span class="ident" id="5813513">ctxt</span><span class="op" id="5813517">.</span><span class="ident" id="5813518">GOARCH</span>&nbsp;<span class="op" id="5813525">||</span>&nbsp;<span class="ident" id="5813528">name</span>&nbsp;<span class="op" id="5813533">==</span>&nbsp;<span class="ident" id="5813536">ctxt</span><span class="op" id="5813540">.</span><span class="ident" id="5813541">Compiler</span>&nbsp;<span class="op" id="5813550">{</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813554">return</span>&nbsp;<span class="builtintype" id="5813561">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813570">if</span>&nbsp;<span class="ident" id="5813573">ctxt</span><span class="op" id="5813577">.</span><span class="ident" id="5813578">GOOS</span>&nbsp;<span class="op" id="5813583">==</span>&nbsp;<span class="string" id="5813586">&#34;android&#34;</span>&nbsp;<span class="op" id="5813596">&amp;&amp;</span>&nbsp;<span class="ident" id="5813599">name</span>&nbsp;<span class="op" id="5813604">==</span>&nbsp;<span class="string" id="5813607">&#34;linux&#34;</span>&nbsp;<span class="op" id="5813615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813619">return</span>&nbsp;<span class="builtintype" id="5813626">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813632">}</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5813636">//&nbsp;other&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813651">for</span>&nbsp;<span class="ident" id="5813655">_</span><span class="op" id="5813656">,</span>&nbsp;<span class="ident" id="5813658">tag</span>&nbsp;<span class="op" id="5813662">:=</span>&nbsp;<span class="keyword" id="5813665">range</span>&nbsp;<span class="ident" id="5813671">ctxt</span><span class="op" id="5813675">.</span><span class="ident" id="5813676">BuildTags</span>&nbsp;<span class="op" id="5813686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813690">if</span>&nbsp;<span class="ident" id="5813693">tag</span>&nbsp;<span class="op" id="5813697">==</span>&nbsp;<span class="ident" id="5813700">name</span>&nbsp;<span class="op" id="5813705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813710">return</span>&nbsp;<span class="builtintype" id="5813717">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813730">for</span>&nbsp;<span class="ident" id="5813734">_</span><span class="op" id="5813735">,</span>&nbsp;<span class="ident" id="5813737">tag</span>&nbsp;<span class="op" id="5813741">:=</span>&nbsp;<span class="keyword" id="5813744">range</span>&nbsp;<span class="ident" id="5813750">ctxt</span><span class="op" id="5813754">.</span><span class="ident" id="5813755">ReleaseTags</span>&nbsp;<span class="op" id="5813767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813771">if</span>&nbsp;<span class="ident" id="5813774">tag</span>&nbsp;<span class="op" id="5813778">==</span>&nbsp;<span class="ident" id="5813781">name</span>&nbsp;<span class="op" id="5813786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813791">return</span>&nbsp;<span class="builtintype" id="5813798">true</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5813808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5813812">return</span>&nbsp;<span class="builtintype" id="5813819">false</span><br>
<span class="lineno"></span><span class="op" id="5813825">}</span><br>
<span class="lineno">1290</span><br>
<span class="lineno"></span><span class="comment" id="5813828">//&nbsp;goodOSArchFile&nbsp;returns&nbsp;false&nbsp;if&nbsp;the&nbsp;name&nbsp;contains&nbsp;a&nbsp;$GOOS&nbsp;or&nbsp;$GOARCH</span><br>
<span class="lineno"></span><span class="comment" id="5813900">//&nbsp;suffix&nbsp;which&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;current&nbsp;system.</span><br>
<span class="lineno"></span><span class="comment" id="5813951">//&nbsp;The&nbsp;recognized&nbsp;name&nbsp;formats&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="5813987">//</span><br>
<span class="lineno">1295</span><span class="comment" id="5813990">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS).*</span><br>
<span class="lineno"></span><span class="comment" id="5814012">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="5814036">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="5814068">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="5814095">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH)_test.*</span><br>
<span class="lineno">1300</span><span class="comment" id="5814124">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="5814161">//</span><br>
<span class="lineno"></span><span class="comment" id="5814164">//&nbsp;An&nbsp;exception:&nbsp;if&nbsp;GOOS=android,&nbsp;then&nbsp;files&nbsp;with&nbsp;GOOS=linux&nbsp;are&nbsp;also&nbsp;matched.</span><br>
<span class="lineno"></span><span class="keyword" id="5814243">func</span>&nbsp;<span class="op" id="5814248">(</span><span class="ident" id="5814249">ctxt</span>&nbsp;<span class="op" id="5814254">*</span><span class="ident" id="5814255">Context</span><span class="op" id="5814262">)</span>&nbsp;<span class="ident" id="5814264">goodOSArchFile</span><span class="op" id="5814278">(</span><span class="ident" id="5814279">name</span>&nbsp;<span class="builtintype" id="5814284">string</span><span class="op" id="5814290">,</span>&nbsp;<span class="ident" id="5814292">allTags</span>&nbsp;<span class="keyword" id="5814300">map</span><span class="op" id="5814303">[</span><span class="builtintype" id="5814304">string</span><span class="op" id="5814310">]</span><span class="builtintype" id="5814311">bool</span><span class="op" id="5814315">)</span>&nbsp;<span class="builtintype" id="5814317">bool</span>&nbsp;<span class="op" id="5814322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5814325">if</span>&nbsp;<span class="ident" id="5814328">dot</span>&nbsp;<span class="op" id="5814332">:=</span>&nbsp;<span class="ident" id="5814335">strings</span><span class="op" id="5814342">.</span><span class="ident" id="5814343">Index</span><span class="op" id="5814348">(</span><span class="ident" id="5814349">name</span><span class="op" id="5814353">,</span>&nbsp;<span class="string" id="5814355">&#34;.&#34;</span><span class="op" id="5814358">)</span><span class="op" id="5814359">;</span>&nbsp;<span class="ident" id="5814361">dot</span>&nbsp;<span class="op" id="5814365">!=</span>&nbsp;<span class="op" id="5814368">-</span><span class="num" id="5814369">1</span>&nbsp;<span class="op" id="5814371">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814375">name</span>&nbsp;<span class="op" id="5814380">=</span>&nbsp;<span class="ident" id="5814382">name</span><span class="op" id="5814386">[</span><span class="op" id="5814387">:</span><span class="ident" id="5814388">dot</span><span class="op" id="5814391">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5814394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814398">//&nbsp;Before&nbsp;Go&nbsp;1.4,&nbsp;a&nbsp;file&nbsp;called&nbsp;&#34;linux.go&#34;&nbsp;would&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;having&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814474">//&nbsp;build&nbsp;tag&nbsp;&#34;linux&#34;&nbsp;in&nbsp;that&nbsp;file.&nbsp;For&nbsp;Go&nbsp;1.4&nbsp;and&nbsp;beyond,&nbsp;we&nbsp;require&nbsp;this</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814549">//&nbsp;auto-tagging&nbsp;to&nbsp;apply&nbsp;only&nbsp;to&nbsp;files&nbsp;with&nbsp;a&nbsp;non-empty&nbsp;prefix,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814617">//&nbsp;&#34;foo_linux.go&#34;&nbsp;is&nbsp;tagged&nbsp;but&nbsp;&#34;linux.go&#34;&nbsp;is&nbsp;not.&nbsp;This&nbsp;allows&nbsp;new&nbsp;operating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814695">//&nbsp;sytems,&nbsp;such&nbsp;as&nbsp;android,&nbsp;to&nbsp;arrive&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;code&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814770">//&nbsp;innocuous&nbsp;source&nbsp;code&nbsp;in&nbsp;&#34;android.go&#34;.&nbsp;The&nbsp;easiest&nbsp;fix:&nbsp;cut&nbsp;everything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5814845">//&nbsp;in&nbsp;the&nbsp;name&nbsp;before&nbsp;the&nbsp;initial&nbsp;_.</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814883">i</span>&nbsp;<span class="op" id="5814885">:=</span>&nbsp;<span class="ident" id="5814888">strings</span><span class="op" id="5814895">.</span><span class="ident" id="5814896">Index</span><span class="op" id="5814901">(</span><span class="ident" id="5814902">name</span><span class="op" id="5814906">,</span>&nbsp;<span class="string" id="5814908">&#34;_&#34;</span><span class="op" id="5814911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5814914">if</span>&nbsp;<span class="ident" id="5814917">i</span>&nbsp;<span class="op" id="5814919">&lt;</span>&nbsp;<span class="num" id="5814921">0</span>&nbsp;<span class="op" id="5814923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5814927">return</span>&nbsp;<span class="builtintype" id="5814934">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5814940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814943">name</span>&nbsp;<span class="op" id="5814948">=</span>&nbsp;<span class="ident" id="5814950">name</span><span class="op" id="5814954">[</span><span class="ident" id="5814955">i</span><span class="op" id="5814956">:</span><span class="op" id="5814957">]</span>&nbsp;<span class="comment" id="5814959">//&nbsp;ignore&nbsp;everything&nbsp;before&nbsp;first&nbsp;_</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5814997">l</span>&nbsp;<span class="op" id="5814999">:=</span>&nbsp;<span class="ident" id="5815002">strings</span><span class="op" id="5815009">.</span><span class="ident" id="5815010">Split</span><span class="op" id="5815015">(</span><span class="ident" id="5815016">name</span><span class="op" id="5815020">,</span>&nbsp;<span class="string" id="5815022">&#34;_&#34;</span><span class="op" id="5815025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815028">if</span>&nbsp;<span class="ident" id="5815031">n</span>&nbsp;<span class="op" id="5815033">:=</span>&nbsp;<span class="builtinfunc" id="5815036">len</span><span class="op" id="5815039">(</span><span class="ident" id="5815040">l</span><span class="op" id="5815041">)</span><span class="op" id="5815042">;</span>&nbsp;<span class="ident" id="5815044">n</span>&nbsp;<span class="op" id="5815046">&gt;</span>&nbsp;<span class="num" id="5815048">0</span>&nbsp;<span class="op" id="5815050">&amp;&amp;</span>&nbsp;<span class="ident" id="5815053">l</span><span class="op" id="5815054">[</span><span class="ident" id="5815055">n</span><span class="op" id="5815056">-</span><span class="num" id="5815057">1</span><span class="op" id="5815058">]</span>&nbsp;<span class="op" id="5815060">==</span>&nbsp;<span class="string" id="5815063">&#34;test&#34;</span>&nbsp;<span class="op" id="5815070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815074">l</span>&nbsp;<span class="op" id="5815076">=</span>&nbsp;<span class="ident" id="5815078">l</span><span class="op" id="5815079">[</span><span class="op" id="5815080">:</span><span class="ident" id="5815081">n</span><span class="op" id="5815082">-</span><span class="num" id="5815083">1</span><span class="op" id="5815084">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815087">}</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815090">n</span>&nbsp;<span class="op" id="5815092">:=</span>&nbsp;<span class="builtinfunc" id="5815095">len</span><span class="op" id="5815098">(</span><span class="ident" id="5815099">l</span><span class="op" id="5815100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815103">if</span>&nbsp;<span class="ident" id="5815106">n</span>&nbsp;<span class="op" id="5815108">&gt;=</span>&nbsp;<span class="num" id="5815111">2</span>&nbsp;<span class="op" id="5815113">&amp;&amp;</span>&nbsp;<span class="ident" id="5815116">knownOS</span><span class="op" id="5815123">[</span><span class="ident" id="5815124">l</span><span class="op" id="5815125">[</span><span class="ident" id="5815126">n</span><span class="op" id="5815127">-</span><span class="num" id="5815128">2</span><span class="op" id="5815129">]</span><span class="op" id="5815130">]</span>&nbsp;<span class="op" id="5815132">&amp;&amp;</span>&nbsp;<span class="ident" id="5815135">knownArch</span><span class="op" id="5815144">[</span><span class="ident" id="5815145">l</span><span class="op" id="5815146">[</span><span class="ident" id="5815147">n</span><span class="op" id="5815148">-</span><span class="num" id="5815149">1</span><span class="op" id="5815150">]</span><span class="op" id="5815151">]</span>&nbsp;<span class="op" id="5815153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815157">if</span>&nbsp;<span class="ident" id="5815160">allTags</span>&nbsp;<span class="op" id="5815168">!=</span>&nbsp;<span class="ident" id="5815171">nil</span>&nbsp;<span class="op" id="5815175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815180">allTags</span><span class="op" id="5815187">[</span><span class="ident" id="5815188">l</span><span class="op" id="5815189">[</span><span class="ident" id="5815190">n</span><span class="op" id="5815191">-</span><span class="num" id="5815192">2</span><span class="op" id="5815193">]</span><span class="op" id="5815194">]</span>&nbsp;<span class="op" id="5815196">=</span>&nbsp;<span class="builtintype" id="5815198">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815206">allTags</span><span class="op" id="5815213">[</span><span class="ident" id="5815214">l</span><span class="op" id="5815215">[</span><span class="ident" id="5815216">n</span><span class="op" id="5815217">-</span><span class="num" id="5815218">1</span><span class="op" id="5815219">]</span><span class="op" id="5815220">]</span>&nbsp;<span class="op" id="5815222">=</span>&nbsp;<span class="builtintype" id="5815224">true</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815235">if</span>&nbsp;<span class="ident" id="5815238">l</span><span class="op" id="5815239">[</span><span class="ident" id="5815240">n</span><span class="op" id="5815241">-</span><span class="num" id="5815242">1</span><span class="op" id="5815243">]</span>&nbsp;<span class="op" id="5815245">!=</span>&nbsp;<span class="ident" id="5815248">ctxt</span><span class="op" id="5815252">.</span><span class="ident" id="5815253">GOARCH</span>&nbsp;<span class="op" id="5815260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815265">return</span>&nbsp;<span class="builtintype" id="5815272">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815284">if</span>&nbsp;<span class="ident" id="5815287">ctxt</span><span class="op" id="5815291">.</span><span class="ident" id="5815292">GOOS</span>&nbsp;<span class="op" id="5815297">==</span>&nbsp;<span class="string" id="5815300">&#34;android&#34;</span>&nbsp;<span class="op" id="5815310">&amp;&amp;</span>&nbsp;<span class="ident" id="5815313">l</span><span class="op" id="5815314">[</span><span class="ident" id="5815315">n</span><span class="op" id="5815316">-</span><span class="num" id="5815317">2</span><span class="op" id="5815318">]</span>&nbsp;<span class="op" id="5815320">==</span>&nbsp;<span class="string" id="5815323">&#34;linux&#34;</span>&nbsp;<span class="op" id="5815331">{</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815336">return</span>&nbsp;<span class="builtintype" id="5815343">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815354">return</span>&nbsp;<span class="ident" id="5815361">l</span><span class="op" id="5815362">[</span><span class="ident" id="5815363">n</span><span class="op" id="5815364">-</span><span class="num" id="5815365">2</span><span class="op" id="5815366">]</span>&nbsp;<span class="op" id="5815368">==</span>&nbsp;<span class="ident" id="5815371">ctxt</span><span class="op" id="5815375">.</span><span class="ident" id="5815376">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815385">if</span>&nbsp;<span class="ident" id="5815388">n</span>&nbsp;<span class="op" id="5815390">&gt;=</span>&nbsp;<span class="num" id="5815393">1</span>&nbsp;<span class="op" id="5815395">&amp;&amp;</span>&nbsp;<span class="ident" id="5815398">knownOS</span><span class="op" id="5815405">[</span><span class="ident" id="5815406">l</span><span class="op" id="5815407">[</span><span class="ident" id="5815408">n</span><span class="op" id="5815409">-</span><span class="num" id="5815410">1</span><span class="op" id="5815411">]</span><span class="op" id="5815412">]</span>&nbsp;<span class="op" id="5815414">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815418">if</span>&nbsp;<span class="ident" id="5815421">allTags</span>&nbsp;<span class="op" id="5815429">!=</span>&nbsp;<span class="ident" id="5815432">nil</span>&nbsp;<span class="op" id="5815436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815441">allTags</span><span class="op" id="5815448">[</span><span class="ident" id="5815449">l</span><span class="op" id="5815450">[</span><span class="ident" id="5815451">n</span><span class="op" id="5815452">-</span><span class="num" id="5815453">1</span><span class="op" id="5815454">]</span><span class="op" id="5815455">]</span>&nbsp;<span class="op" id="5815457">=</span>&nbsp;<span class="builtintype" id="5815459">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815470">if</span>&nbsp;<span class="ident" id="5815473">ctxt</span><span class="op" id="5815477">.</span><span class="ident" id="5815478">GOOS</span>&nbsp;<span class="op" id="5815483">==</span>&nbsp;<span class="string" id="5815486">&#34;android&#34;</span>&nbsp;<span class="op" id="5815496">&amp;&amp;</span>&nbsp;<span class="ident" id="5815499">l</span><span class="op" id="5815500">[</span><span class="ident" id="5815501">n</span><span class="op" id="5815502">-</span><span class="num" id="5815503">1</span><span class="op" id="5815504">]</span>&nbsp;<span class="op" id="5815506">==</span>&nbsp;<span class="string" id="5815509">&#34;linux&#34;</span>&nbsp;<span class="op" id="5815517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815522">return</span>&nbsp;<span class="builtintype" id="5815529">true</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815540">return</span>&nbsp;<span class="ident" id="5815547">l</span><span class="op" id="5815548">[</span><span class="ident" id="5815549">n</span><span class="op" id="5815550">-</span><span class="num" id="5815551">1</span><span class="op" id="5815552">]</span>&nbsp;<span class="op" id="5815554">==</span>&nbsp;<span class="ident" id="5815557">ctxt</span><span class="op" id="5815561">.</span><span class="ident" id="5815562">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815571">if</span>&nbsp;<span class="ident" id="5815574">n</span>&nbsp;<span class="op" id="5815576">&gt;=</span>&nbsp;<span class="num" id="5815579">1</span>&nbsp;<span class="op" id="5815581">&amp;&amp;</span>&nbsp;<span class="ident" id="5815584">knownArch</span><span class="op" id="5815593">[</span><span class="ident" id="5815594">l</span><span class="op" id="5815595">[</span><span class="ident" id="5815596">n</span><span class="op" id="5815597">-</span><span class="num" id="5815598">1</span><span class="op" id="5815599">]</span><span class="op" id="5815600">]</span>&nbsp;<span class="op" id="5815602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815606">if</span>&nbsp;<span class="ident" id="5815609">allTags</span>&nbsp;<span class="op" id="5815617">!=</span>&nbsp;<span class="ident" id="5815620">nil</span>&nbsp;<span class="op" id="5815624">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815629">allTags</span><span class="op" id="5815636">[</span><span class="ident" id="5815637">l</span><span class="op" id="5815638">[</span><span class="ident" id="5815639">n</span><span class="op" id="5815640">-</span><span class="num" id="5815641">1</span><span class="op" id="5815642">]</span><span class="op" id="5815643">]</span>&nbsp;<span class="op" id="5815645">=</span>&nbsp;<span class="builtintype" id="5815647">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815658">return</span>&nbsp;<span class="ident" id="5815665">l</span><span class="op" id="5815666">[</span><span class="ident" id="5815667">n</span><span class="op" id="5815668">-</span><span class="num" id="5815669">1</span><span class="op" id="5815670">]</span>&nbsp;<span class="op" id="5815672">==</span>&nbsp;<span class="ident" id="5815675">ctxt</span><span class="op" id="5815679">.</span><span class="ident" id="5815680">GOARCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815691">return</span>&nbsp;<span class="builtintype" id="5815698">true</span><br>
<span class="lineno">1355</span><span class="op" id="5815703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5815706">var</span>&nbsp;<span class="ident" id="5815710">knownOS</span>&nbsp;<span class="op" id="5815718">=</span>&nbsp;<span class="builtinfunc" id="5815720">make</span><span class="op" id="5815724">(</span><span class="keyword" id="5815725">map</span><span class="op" id="5815728">[</span><span class="builtintype" id="5815729">string</span><span class="op" id="5815735">]</span><span class="builtintype" id="5815736">bool</span><span class="op" id="5815740">)</span><br>
<span class="lineno"></span><span class="keyword" id="5815742">var</span>&nbsp;<span class="ident" id="5815746">knownArch</span>&nbsp;<span class="op" id="5815756">=</span>&nbsp;<span class="builtinfunc" id="5815758">make</span><span class="op" id="5815762">(</span><span class="keyword" id="5815763">map</span><span class="op" id="5815766">[</span><span class="builtintype" id="5815767">string</span><span class="op" id="5815773">]</span><span class="builtintype" id="5815774">bool</span><span class="op" id="5815778">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="5815781">func</span>&nbsp;<span class="ident" id="5815786">init</span><span class="op" id="5815790">(</span><span class="op" id="5815791">)</span>&nbsp;<span class="op" id="5815793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815796">for</span>&nbsp;<span class="ident" id="5815800">_</span><span class="op" id="5815801">,</span>&nbsp;<span class="ident" id="5815803">v</span>&nbsp;<span class="op" id="5815805">:=</span>&nbsp;<span class="keyword" id="5815808">range</span>&nbsp;<span class="ident" id="5815814">strings</span><span class="op" id="5815821">.</span><span class="ident" id="5815822">Fields</span><span class="op" id="5815828">(</span><span class="ident" id="5815829">goosList</span><span class="op" id="5815837">)</span>&nbsp;<span class="op" id="5815839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815843">knownOS</span><span class="op" id="5815850">[</span><span class="ident" id="5815851">v</span><span class="op" id="5815852">]</span>&nbsp;<span class="op" id="5815854">=</span>&nbsp;<span class="builtintype" id="5815856">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5815865">for</span>&nbsp;<span class="ident" id="5815869">_</span><span class="op" id="5815870">,</span>&nbsp;<span class="ident" id="5815872">v</span>&nbsp;<span class="op" id="5815874">:=</span>&nbsp;<span class="keyword" id="5815877">range</span>&nbsp;<span class="ident" id="5815883">strings</span><span class="op" id="5815890">.</span><span class="ident" id="5815891">Fields</span><span class="op" id="5815897">(</span><span class="ident" id="5815898">goarchList</span><span class="op" id="5815908">)</span>&nbsp;<span class="op" id="5815910">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5815914">knownArch</span><span class="op" id="5815923">[</span><span class="ident" id="5815924">v</span><span class="op" id="5815925">]</span>&nbsp;<span class="op" id="5815927">=</span>&nbsp;<span class="builtintype" id="5815929">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5815935">}</span><br>
<span class="lineno"></span><span class="op" id="5815937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5815940">//&nbsp;ToolDir&nbsp;is&nbsp;the&nbsp;directory&nbsp;containing&nbsp;build&nbsp;tools.</span><br>
<span class="lineno">1370</span><span class="keyword" id="5815992">var</span>&nbsp;<span class="ident" id="5815996">ToolDir</span>&nbsp;<span class="op" id="5816004">=</span>&nbsp;<span class="ident" id="5816006">filepath</span><span class="op" id="5816014">.</span><span class="ident" id="5816015">Join</span><span class="op" id="5816019">(</span><span class="ident" id="5816020">runtime</span><span class="op" id="5816027">.</span><span class="ident" id="5816028">GOROOT</span><span class="op" id="5816034">(</span><span class="op" id="5816035">)</span><span class="op" id="5816036">,</span>&nbsp;<span class="string" id="5816038">&#34;pkg/tool/&#34;</span><span class="op" id="5816049">+</span><span class="ident" id="5816050">runtime</span><span class="op" id="5816057">.</span><span class="ident" id="5816058">GOOS</span><span class="op" id="5816062">+</span><span class="string" id="5816063">&#34;_&#34;</span><span class="op" id="5816066">+</span><span class="ident" id="5816067">runtime</span><span class="op" id="5816074">.</span><span class="ident" id="5816075">GOARCH</span><span class="op" id="5816081">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5816084">//&nbsp;IsLocalImport&nbsp;reports&nbsp;whether&nbsp;the&nbsp;import&nbsp;path&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5816136">//&nbsp;a&nbsp;local&nbsp;import&nbsp;path,&nbsp;like&nbsp;&#34;.&#34;,&nbsp;&#34;..&#34;,&nbsp;&#34;./foo&#34;,&nbsp;or&nbsp;&#34;../foo&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5816198">func</span>&nbsp;<span class="ident" id="5816203">IsLocalImport</span><span class="op" id="5816216">(</span><span class="ident" id="5816217">path</span>&nbsp;<span class="builtintype" id="5816222">string</span><span class="op" id="5816228">)</span>&nbsp;<span class="builtintype" id="5816230">bool</span>&nbsp;<span class="op" id="5816235">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816238">return</span>&nbsp;<span class="ident" id="5816245">path</span>&nbsp;<span class="op" id="5816250">==</span>&nbsp;<span class="string" id="5816253">&#34;.&#34;</span>&nbsp;<span class="op" id="5816257">||</span>&nbsp;<span class="ident" id="5816260">path</span>&nbsp;<span class="op" id="5816265">==</span>&nbsp;<span class="string" id="5816268">&#34;..&#34;</span>&nbsp;<span class="op" id="5816273">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5816278">strings</span><span class="op" id="5816285">.</span><span class="ident" id="5816286">HasPrefix</span><span class="op" id="5816295">(</span><span class="ident" id="5816296">path</span><span class="op" id="5816300">,</span>&nbsp;<span class="string" id="5816302">&#34;./&#34;</span><span class="op" id="5816306">)</span>&nbsp;<span class="op" id="5816308">||</span>&nbsp;<span class="ident" id="5816311">strings</span><span class="op" id="5816318">.</span><span class="ident" id="5816319">HasPrefix</span><span class="op" id="5816328">(</span><span class="ident" id="5816329">path</span><span class="op" id="5816333">,</span>&nbsp;<span class="string" id="5816335">&#34;../&#34;</span><span class="op" id="5816340">)</span><br>
<span class="lineno"></span><span class="op" id="5816342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5816345">//&nbsp;ArchChar&nbsp;returns&nbsp;the&nbsp;architecture&nbsp;character&nbsp;for&nbsp;the&nbsp;given&nbsp;goarch.</span><br>
<span class="lineno">1380</span><span class="comment" id="5816414">//&nbsp;For&nbsp;example,&nbsp;ArchChar(&#34;amd64&#34;)&nbsp;returns&nbsp;&#34;6&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5816461">func</span>&nbsp;<span class="ident" id="5816466">ArchChar</span><span class="op" id="5816474">(</span><span class="ident" id="5816475">goarch</span>&nbsp;<span class="builtintype" id="5816482">string</span><span class="op" id="5816488">)</span>&nbsp;<span class="op" id="5816490">(</span><span class="builtintype" id="5816491">string</span><span class="op" id="5816497">,</span>&nbsp;<span class="builtintype" id="5816499">error</span><span class="op" id="5816504">)</span>&nbsp;<span class="op" id="5816506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816509">switch</span>&nbsp;<span class="ident" id="5816516">goarch</span>&nbsp;<span class="op" id="5816523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816526">case</span>&nbsp;<span class="string" id="5816531">&#34;386&#34;</span><span class="op" id="5816536">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816540">return</span>&nbsp;<span class="string" id="5816547">&#34;8&#34;</span><span class="op" id="5816550">,</span>&nbsp;<span class="ident" id="5816552">nil</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816557">case</span>&nbsp;<span class="string" id="5816562">&#34;amd64&#34;</span><span class="op" id="5816569">,</span>&nbsp;<span class="string" id="5816571">&#34;amd64p32&#34;</span><span class="op" id="5816581">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816585">return</span>&nbsp;<span class="string" id="5816592">&#34;6&#34;</span><span class="op" id="5816595">,</span>&nbsp;<span class="ident" id="5816597">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816602">case</span>&nbsp;<span class="string" id="5816607">&#34;arm&#34;</span><span class="op" id="5816612">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816616">return</span>&nbsp;<span class="string" id="5816623">&#34;5&#34;</span><span class="op" id="5816626">,</span>&nbsp;<span class="ident" id="5816628">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5816633">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5816636">return</span>&nbsp;<span class="string" id="5816643">&#34;&#34;</span><span class="op" id="5816645">,</span>&nbsp;<span class="ident" id="5816647">errors</span><span class="op" id="5816653">.</span><span class="ident" id="5816654">New</span><span class="op" id="5816657">(</span><span class="string" id="5816658">&#34;unsupported&nbsp;GOARCH&nbsp;&#34;</span>&nbsp;<span class="op" id="5816680">+</span>&nbsp;<span class="ident" id="5816682">goarch</span><span class="op" id="5816688">)</span><br>
<span class="lineno"></span><span class="op" id="5816690">}</span>
</div>
</body>
</html>
