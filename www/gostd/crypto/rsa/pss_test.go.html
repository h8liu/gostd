<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8206233">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8206288">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8206342">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8206393">package</span>&nbsp;<span class="ident" id="8206401">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8206406">import</span>&nbsp;<span class="op" id="8206413">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206416">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206425">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206434">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206452">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206462">_</span>&nbsp;<span class="string" id="8206464">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206478">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206493">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206508">_</span>&nbsp;<span class="string" id="8206510">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206527">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206543">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206555">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206561">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206572">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8206583">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8206593">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8206596">func</span>&nbsp;<span class="ident" id="8206601">TestEMSAPSS</span><span class="op" id="8206612">(</span><span class="ident" id="8206613">t</span>&nbsp;<span class="op" id="8206615">*</span><span class="ident" id="8206616">testing</span><span class="op" id="8206623">.</span><span class="ident" id="8206624">T</span><span class="op" id="8206625">)</span>&nbsp;<span class="op" id="8206627">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8206630">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206733">msg</span>&nbsp;<span class="op" id="8206737">:=</span>&nbsp;<span class="op" id="8206740">[</span><span class="op" id="8206741">]</span><span class="builtintype" id="8206742">byte</span><span class="op" id="8206746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8206750">0x85</span><span class="op" id="8206754">,</span>&nbsp;<span class="num" id="8206756">0x9e</span><span class="op" id="8206760">,</span>&nbsp;<span class="num" id="8206762">0xef</span><span class="op" id="8206766">,</span>&nbsp;<span class="num" id="8206768">0x2f</span><span class="op" id="8206772">,</span>&nbsp;<span class="num" id="8206774">0xd7</span><span class="op" id="8206778">,</span>&nbsp;<span class="num" id="8206780">0x8a</span><span class="op" id="8206784">,</span>&nbsp;<span class="num" id="8206786">0xca</span><span class="op" id="8206790">,</span>&nbsp;<span class="num" id="8206792">0x00</span><span class="op" id="8206796">,</span>&nbsp;<span class="num" id="8206798">0x30</span><span class="op" id="8206802">,</span>&nbsp;<span class="num" id="8206804">0x8b</span><span class="op" id="8206808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8206812">0xdc</span><span class="op" id="8206816">,</span>&nbsp;<span class="num" id="8206818">0x47</span><span class="op" id="8206822">,</span>&nbsp;<span class="num" id="8206824">0x11</span><span class="op" id="8206828">,</span>&nbsp;<span class="num" id="8206830">0x93</span><span class="op" id="8206834">,</span>&nbsp;<span class="num" id="8206836">0xbf</span><span class="op" id="8206840">,</span>&nbsp;<span class="num" id="8206842">0x55</span><span class="op" id="8206846">,</span>&nbsp;<span class="num" id="8206848">0xbf</span><span class="op" id="8206852">,</span>&nbsp;<span class="num" id="8206854">0x9d</span><span class="op" id="8206858">,</span>&nbsp;<span class="num" id="8206860">0x78</span><span class="op" id="8206864">,</span>&nbsp;<span class="num" id="8206866">0xdb</span><span class="op" id="8206870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8206874">0x8f</span><span class="op" id="8206878">,</span>&nbsp;<span class="num" id="8206880">0x8a</span><span class="op" id="8206884">,</span>&nbsp;<span class="num" id="8206886">0x67</span><span class="op" id="8206890">,</span>&nbsp;<span class="num" id="8206892">0x2b</span><span class="op" id="8206896">,</span>&nbsp;<span class="num" id="8206898">0x48</span><span class="op" id="8206902">,</span>&nbsp;<span class="num" id="8206904">0x46</span><span class="op" id="8206908">,</span>&nbsp;<span class="num" id="8206910">0x34</span><span class="op" id="8206914">,</span>&nbsp;<span class="num" id="8206916">0xf3</span><span class="op" id="8206920">,</span>&nbsp;<span class="num" id="8206922">0xc9</span><span class="op" id="8206926">,</span>&nbsp;<span class="num" id="8206928">0xc2</span><span class="op" id="8206932">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8206936">0x6e</span><span class="op" id="8206940">,</span>&nbsp;<span class="num" id="8206942">0x64</span><span class="op" id="8206946">,</span>&nbsp;<span class="num" id="8206948">0x78</span><span class="op" id="8206952">,</span>&nbsp;<span class="num" id="8206954">0xae</span><span class="op" id="8206958">,</span>&nbsp;<span class="num" id="8206960">0x10</span><span class="op" id="8206964">,</span>&nbsp;<span class="num" id="8206966">0x26</span><span class="op" id="8206970">,</span>&nbsp;<span class="num" id="8206972">0x0f</span><span class="op" id="8206976">,</span>&nbsp;<span class="num" id="8206978">0xe0</span><span class="op" id="8206982">,</span>&nbsp;<span class="num" id="8206984">0xdd</span><span class="op" id="8206988">,</span>&nbsp;<span class="num" id="8206990">0x8c</span><span class="op" id="8206994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8206998">0x08</span><span class="op" id="8207002">,</span>&nbsp;<span class="num" id="8207004">0x2e</span><span class="op" id="8207008">,</span>&nbsp;<span class="num" id="8207010">0x53</span><span class="op" id="8207014">,</span>&nbsp;<span class="num" id="8207016">0xa5</span><span class="op" id="8207020">,</span>&nbsp;<span class="num" id="8207022">0x29</span><span class="op" id="8207026">,</span>&nbsp;<span class="num" id="8207028">0x3a</span><span class="op" id="8207032">,</span>&nbsp;<span class="num" id="8207034">0xf2</span><span class="op" id="8207038">,</span>&nbsp;<span class="num" id="8207040">0x17</span><span class="op" id="8207044">,</span>&nbsp;<span class="num" id="8207046">0x3c</span><span class="op" id="8207050">,</span>&nbsp;<span class="num" id="8207052">0xd5</span><span class="op" id="8207056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207060">0x0c</span><span class="op" id="8207064">,</span>&nbsp;<span class="num" id="8207066">0x6d</span><span class="op" id="8207070">,</span>&nbsp;<span class="num" id="8207072">0x5d</span><span class="op" id="8207076">,</span>&nbsp;<span class="num" id="8207078">0x35</span><span class="op" id="8207082">,</span>&nbsp;<span class="num" id="8207084">0x4f</span><span class="op" id="8207088">,</span>&nbsp;<span class="num" id="8207090">0xeb</span><span class="op" id="8207094">,</span>&nbsp;<span class="num" id="8207096">0xf7</span><span class="op" id="8207100">,</span>&nbsp;<span class="num" id="8207102">0x8b</span><span class="op" id="8207106">,</span>&nbsp;<span class="num" id="8207108">0x26</span><span class="op" id="8207112">,</span>&nbsp;<span class="num" id="8207114">0x02</span><span class="op" id="8207118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207122">0x1c</span><span class="op" id="8207126">,</span>&nbsp;<span class="num" id="8207128">0x25</span><span class="op" id="8207132">,</span>&nbsp;<span class="num" id="8207134">0xc0</span><span class="op" id="8207138">,</span>&nbsp;<span class="num" id="8207140">0x27</span><span class="op" id="8207144">,</span>&nbsp;<span class="num" id="8207146">0x12</span><span class="op" id="8207150">,</span>&nbsp;<span class="num" id="8207152">0xe7</span><span class="op" id="8207156">,</span>&nbsp;<span class="num" id="8207158">0x8c</span><span class="op" id="8207162">,</span>&nbsp;<span class="num" id="8207164">0xd4</span><span class="op" id="8207168">,</span>&nbsp;<span class="num" id="8207170">0x69</span><span class="op" id="8207174">,</span>&nbsp;<span class="num" id="8207176">0x4c</span><span class="op" id="8207180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207184">0x9f</span><span class="op" id="8207188">,</span>&nbsp;<span class="num" id="8207190">0x46</span><span class="op" id="8207194">,</span>&nbsp;<span class="num" id="8207196">0x97</span><span class="op" id="8207200">,</span>&nbsp;<span class="num" id="8207202">0x77</span><span class="op" id="8207206">,</span>&nbsp;<span class="num" id="8207208">0xe4</span><span class="op" id="8207212">,</span>&nbsp;<span class="num" id="8207214">0x51</span><span class="op" id="8207218">,</span>&nbsp;<span class="num" id="8207220">0xe7</span><span class="op" id="8207224">,</span>&nbsp;<span class="num" id="8207226">0xf8</span><span class="op" id="8207230">,</span>&nbsp;<span class="num" id="8207232">0xe9</span><span class="op" id="8207236">,</span>&nbsp;<span class="num" id="8207238">0xe0</span><span class="op" id="8207242">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207246">0x4c</span><span class="op" id="8207250">,</span>&nbsp;<span class="num" id="8207252">0xd3</span><span class="op" id="8207256">,</span>&nbsp;<span class="num" id="8207258">0x73</span><span class="op" id="8207262">,</span>&nbsp;<span class="num" id="8207264">0x9c</span><span class="op" id="8207268">,</span>&nbsp;<span class="num" id="8207270">0x6b</span><span class="op" id="8207274">,</span>&nbsp;<span class="num" id="8207276">0xbf</span><span class="op" id="8207280">,</span>&nbsp;<span class="num" id="8207282">0xed</span><span class="op" id="8207286">,</span>&nbsp;<span class="num" id="8207288">0xae</span><span class="op" id="8207292">,</span>&nbsp;<span class="num" id="8207294">0x48</span><span class="op" id="8207298">,</span>&nbsp;<span class="num" id="8207300">0x7f</span><span class="op" id="8207304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207308">0xb5</span><span class="op" id="8207312">,</span>&nbsp;<span class="num" id="8207314">0x56</span><span class="op" id="8207318">,</span>&nbsp;<span class="num" id="8207320">0x44</span><span class="op" id="8207324">,</span>&nbsp;<span class="num" id="8207326">0xe9</span><span class="op" id="8207330">,</span>&nbsp;<span class="num" id="8207332">0xca</span><span class="op" id="8207336">,</span>&nbsp;<span class="num" id="8207338">0x74</span><span class="op" id="8207342">,</span>&nbsp;<span class="num" id="8207344">0xff</span><span class="op" id="8207348">,</span>&nbsp;<span class="num" id="8207350">0x77</span><span class="op" id="8207354">,</span>&nbsp;<span class="num" id="8207356">0xa5</span><span class="op" id="8207360">,</span>&nbsp;<span class="num" id="8207362">0x3c</span><span class="op" id="8207366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207370">0xb7</span><span class="op" id="8207374">,</span>&nbsp;<span class="num" id="8207376">0x29</span><span class="op" id="8207380">,</span>&nbsp;<span class="num" id="8207382">0x80</span><span class="op" id="8207386">,</span>&nbsp;<span class="num" id="8207388">0x2f</span><span class="op" id="8207392">,</span>&nbsp;<span class="num" id="8207394">0x6e</span><span class="op" id="8207398">,</span>&nbsp;<span class="num" id="8207400">0xd4</span><span class="op" id="8207404">,</span>&nbsp;<span class="num" id="8207406">0xa5</span><span class="op" id="8207410">,</span>&nbsp;<span class="num" id="8207412">0xff</span><span class="op" id="8207416">,</span>&nbsp;<span class="num" id="8207418">0xa8</span><span class="op" id="8207422">,</span>&nbsp;<span class="num" id="8207424">0xba</span><span class="op" id="8207428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207432">0x15</span><span class="op" id="8207436">,</span>&nbsp;<span class="num" id="8207438">0x98</span><span class="op" id="8207442">,</span>&nbsp;<span class="num" id="8207444">0x90</span><span class="op" id="8207448">,</span>&nbsp;<span class="num" id="8207450">0xfc</span><span class="op" id="8207454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207457">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207460">salt</span>&nbsp;<span class="op" id="8207465">:=</span>&nbsp;<span class="op" id="8207468">[</span><span class="op" id="8207469">]</span><span class="builtintype" id="8207470">byte</span><span class="op" id="8207474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207478">0xe3</span><span class="op" id="8207482">,</span>&nbsp;<span class="num" id="8207484">0xb5</span><span class="op" id="8207488">,</span>&nbsp;<span class="num" id="8207490">0xd5</span><span class="op" id="8207494">,</span>&nbsp;<span class="num" id="8207496">0xd0</span><span class="op" id="8207500">,</span>&nbsp;<span class="num" id="8207502">0x02</span><span class="op" id="8207506">,</span>&nbsp;<span class="num" id="8207508">0xc1</span><span class="op" id="8207512">,</span>&nbsp;<span class="num" id="8207514">0xbc</span><span class="op" id="8207518">,</span>&nbsp;<span class="num" id="8207520">0xe5</span><span class="op" id="8207524">,</span>&nbsp;<span class="num" id="8207526">0x0c</span><span class="op" id="8207530">,</span>&nbsp;<span class="num" id="8207532">0x2b</span><span class="op" id="8207536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207540">0x65</span><span class="op" id="8207544">,</span>&nbsp;<span class="num" id="8207546">0xef</span><span class="op" id="8207550">,</span>&nbsp;<span class="num" id="8207552">0x88</span><span class="op" id="8207556">,</span>&nbsp;<span class="num" id="8207558">0xa1</span><span class="op" id="8207562">,</span>&nbsp;<span class="num" id="8207564">0x88</span><span class="op" id="8207568">,</span>&nbsp;<span class="num" id="8207570">0xd8</span><span class="op" id="8207574">,</span>&nbsp;<span class="num" id="8207576">0x3b</span><span class="op" id="8207580">,</span>&nbsp;<span class="num" id="8207582">0xce</span><span class="op" id="8207586">,</span>&nbsp;<span class="num" id="8207588">0x7e</span><span class="op" id="8207592">,</span>&nbsp;<span class="num" id="8207594">0x61</span><span class="op" id="8207598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207604">expected</span>&nbsp;<span class="op" id="8207613">:=</span>&nbsp;<span class="op" id="8207616">[</span><span class="op" id="8207617">]</span><span class="builtintype" id="8207618">byte</span><span class="op" id="8207622">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207626">0x66</span><span class="op" id="8207630">,</span>&nbsp;<span class="num" id="8207632">0xe4</span><span class="op" id="8207636">,</span>&nbsp;<span class="num" id="8207638">0x67</span><span class="op" id="8207642">,</span>&nbsp;<span class="num" id="8207644">0x2e</span><span class="op" id="8207648">,</span>&nbsp;<span class="num" id="8207650">0x83</span><span class="op" id="8207654">,</span>&nbsp;<span class="num" id="8207656">0x6a</span><span class="op" id="8207660">,</span>&nbsp;<span class="num" id="8207662">0xd1</span><span class="op" id="8207666">,</span>&nbsp;<span class="num" id="8207668">0x21</span><span class="op" id="8207672">,</span>&nbsp;<span class="num" id="8207674">0xba</span><span class="op" id="8207678">,</span>&nbsp;<span class="num" id="8207680">0x24</span><span class="op" id="8207684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207688">0x4b</span><span class="op" id="8207692">,</span>&nbsp;<span class="num" id="8207694">0xed</span><span class="op" id="8207698">,</span>&nbsp;<span class="num" id="8207700">0x65</span><span class="op" id="8207704">,</span>&nbsp;<span class="num" id="8207706">0x76</span><span class="op" id="8207710">,</span>&nbsp;<span class="num" id="8207712">0xb8</span><span class="op" id="8207716">,</span>&nbsp;<span class="num" id="8207718">0x67</span><span class="op" id="8207722">,</span>&nbsp;<span class="num" id="8207724">0xd9</span><span class="op" id="8207728">,</span>&nbsp;<span class="num" id="8207730">0xa4</span><span class="op" id="8207734">,</span>&nbsp;<span class="num" id="8207736">0x47</span><span class="op" id="8207740">,</span>&nbsp;<span class="num" id="8207742">0xc2</span><span class="op" id="8207746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207750">0x8a</span><span class="op" id="8207754">,</span>&nbsp;<span class="num" id="8207756">0x6e</span><span class="op" id="8207760">,</span>&nbsp;<span class="num" id="8207762">0x66</span><span class="op" id="8207766">,</span>&nbsp;<span class="num" id="8207768">0xa5</span><span class="op" id="8207772">,</span>&nbsp;<span class="num" id="8207774">0xb8</span><span class="op" id="8207778">,</span>&nbsp;<span class="num" id="8207780">0x7d</span><span class="op" id="8207784">,</span>&nbsp;<span class="num" id="8207786">0xee</span><span class="op" id="8207790">,</span>&nbsp;<span class="num" id="8207792">0x7f</span><span class="op" id="8207796">,</span>&nbsp;<span class="num" id="8207798">0xbc</span><span class="op" id="8207802">,</span>&nbsp;<span class="num" id="8207804">0x7e</span><span class="op" id="8207808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207812">0x65</span><span class="op" id="8207816">,</span>&nbsp;<span class="num" id="8207818">0xaf</span><span class="op" id="8207822">,</span>&nbsp;<span class="num" id="8207824">0x50</span><span class="op" id="8207828">,</span>&nbsp;<span class="num" id="8207830">0x57</span><span class="op" id="8207834">,</span>&nbsp;<span class="num" id="8207836">0xf8</span><span class="op" id="8207840">,</span>&nbsp;<span class="num" id="8207842">0x6f</span><span class="op" id="8207846">,</span>&nbsp;<span class="num" id="8207848">0xae</span><span class="op" id="8207852">,</span>&nbsp;<span class="num" id="8207854">0x89</span><span class="op" id="8207858">,</span>&nbsp;<span class="num" id="8207860">0x84</span><span class="op" id="8207864">,</span>&nbsp;<span class="num" id="8207866">0xd9</span><span class="op" id="8207870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207874">0xba</span><span class="op" id="8207878">,</span>&nbsp;<span class="num" id="8207880">0x7f</span><span class="op" id="8207884">,</span>&nbsp;<span class="num" id="8207886">0x96</span><span class="op" id="8207890">,</span>&nbsp;<span class="num" id="8207892">0x9a</span><span class="op" id="8207896">,</span>&nbsp;<span class="num" id="8207898">0xd6</span><span class="op" id="8207902">,</span>&nbsp;<span class="num" id="8207904">0xfe</span><span class="op" id="8207908">,</span>&nbsp;<span class="num" id="8207910">0x02</span><span class="op" id="8207914">,</span>&nbsp;<span class="num" id="8207916">0xa4</span><span class="op" id="8207920">,</span>&nbsp;<span class="num" id="8207922">0xd7</span><span class="op" id="8207926">,</span>&nbsp;<span class="num" id="8207928">0x5f</span><span class="op" id="8207932">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207936">0x74</span><span class="op" id="8207940">,</span>&nbsp;<span class="num" id="8207942">0x45</span><span class="op" id="8207946">,</span>&nbsp;<span class="num" id="8207948">0xfe</span><span class="op" id="8207952">,</span>&nbsp;<span class="num" id="8207954">0xfd</span><span class="op" id="8207958">,</span>&nbsp;<span class="num" id="8207960">0xd8</span><span class="op" id="8207964">,</span>&nbsp;<span class="num" id="8207966">0x5b</span><span class="op" id="8207970">,</span>&nbsp;<span class="num" id="8207972">0x6d</span><span class="op" id="8207976">,</span>&nbsp;<span class="num" id="8207978">0x3a</span><span class="op" id="8207982">,</span>&nbsp;<span class="num" id="8207984">0x47</span><span class="op" id="8207988">,</span>&nbsp;<span class="num" id="8207990">0x7c</span><span class="op" id="8207994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8207998">0x28</span><span class="op" id="8208002">,</span>&nbsp;<span class="num" id="8208004">0xd2</span><span class="op" id="8208008">,</span>&nbsp;<span class="num" id="8208010">0x4b</span><span class="op" id="8208014">,</span>&nbsp;<span class="num" id="8208016">0xa1</span><span class="op" id="8208020">,</span>&nbsp;<span class="num" id="8208022">0xe3</span><span class="op" id="8208026">,</span>&nbsp;<span class="num" id="8208028">0x75</span><span class="op" id="8208032">,</span>&nbsp;<span class="num" id="8208034">0x6f</span><span class="op" id="8208038">,</span>&nbsp;<span class="num" id="8208040">0x79</span><span class="op" id="8208044">,</span>&nbsp;<span class="num" id="8208046">0x2d</span><span class="op" id="8208050">,</span>&nbsp;<span class="num" id="8208052">0xd1</span><span class="op" id="8208056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8208060">0xdc</span><span class="op" id="8208064">,</span>&nbsp;<span class="num" id="8208066">0xe8</span><span class="op" id="8208070">,</span>&nbsp;<span class="num" id="8208072">0xca</span><span class="op" id="8208076">,</span>&nbsp;<span class="num" id="8208078">0x94</span><span class="op" id="8208082">,</span>&nbsp;<span class="num" id="8208084">0x44</span><span class="op" id="8208088">,</span>&nbsp;<span class="num" id="8208090">0x0e</span><span class="op" id="8208094">,</span>&nbsp;<span class="num" id="8208096">0xcb</span><span class="op" id="8208100">,</span>&nbsp;<span class="num" id="8208102">0x52</span><span class="op" id="8208106">,</span>&nbsp;<span class="num" id="8208108">0x79</span><span class="op" id="8208112">,</span>&nbsp;<span class="num" id="8208114">0xec</span><span class="op" id="8208118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8208122">0xd3</span><span class="op" id="8208126">,</span>&nbsp;<span class="num" id="8208128">0x18</span><span class="op" id="8208132">,</span>&nbsp;<span class="num" id="8208134">0x3a</span><span class="op" id="8208138">,</span>&nbsp;<span class="num" id="8208140">0x31</span><span class="op" id="8208144">,</span>&nbsp;<span class="num" id="8208146">0x1f</span><span class="op" id="8208150">,</span>&nbsp;<span class="num" id="8208152">0xc8</span><span class="op" id="8208156">,</span>&nbsp;<span class="num" id="8208158">0x96</span><span class="op" id="8208162">,</span>&nbsp;<span class="num" id="8208164">0xda</span><span class="op" id="8208168">,</span>&nbsp;<span class="num" id="8208170">0x1c</span><span class="op" id="8208174">,</span>&nbsp;<span class="num" id="8208176">0xb3</span><span class="op" id="8208180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8208184">0x93</span><span class="op" id="8208188">,</span>&nbsp;<span class="num" id="8208190">0x11</span><span class="op" id="8208194">,</span>&nbsp;<span class="num" id="8208196">0xaf</span><span class="op" id="8208200">,</span>&nbsp;<span class="num" id="8208202">0x37</span><span class="op" id="8208206">,</span>&nbsp;<span class="num" id="8208208">0xea</span><span class="op" id="8208212">,</span>&nbsp;<span class="num" id="8208214">0x4a</span><span class="op" id="8208218">,</span>&nbsp;<span class="num" id="8208220">0x75</span><span class="op" id="8208224">,</span>&nbsp;<span class="num" id="8208226">0xe2</span><span class="op" id="8208230">,</span>&nbsp;<span class="num" id="8208232">0x4b</span><span class="op" id="8208236">,</span>&nbsp;<span class="num" id="8208238">0xdb</span><span class="op" id="8208242">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8208246">0xfd</span><span class="op" id="8208250">,</span>&nbsp;<span class="num" id="8208252">0x5c</span><span class="op" id="8208256">,</span>&nbsp;<span class="num" id="8208258">0x1d</span><span class="op" id="8208262">,</span>&nbsp;<span class="num" id="8208264">0xa0</span><span class="op" id="8208268">,</span>&nbsp;<span class="num" id="8208270">0xde</span><span class="op" id="8208274">,</span>&nbsp;<span class="num" id="8208276">0x7c</span><span class="op" id="8208280">,</span>&nbsp;<span class="num" id="8208282">0xec</span><span class="op" id="8208286">,</span>&nbsp;<span class="num" id="8208288">0xdf</span><span class="op" id="8208292">,</span>&nbsp;<span class="num" id="8208294">0x1a</span><span class="op" id="8208298">,</span>&nbsp;<span class="num" id="8208300">0x89</span><span class="op" id="8208304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8208308">0x6f</span><span class="op" id="8208312">,</span>&nbsp;<span class="num" id="8208314">0x9d</span><span class="op" id="8208318">,</span>&nbsp;<span class="num" id="8208320">0x8b</span><span class="op" id="8208324">,</span>&nbsp;<span class="num" id="8208326">0xc8</span><span class="op" id="8208330">,</span>&nbsp;<span class="num" id="8208332">0x16</span><span class="op" id="8208336">,</span>&nbsp;<span class="num" id="8208338">0xd9</span><span class="op" id="8208342">,</span>&nbsp;<span class="num" id="8208344">0x7c</span><span class="op" id="8208348">,</span>&nbsp;<span class="num" id="8208350">0xd7</span><span class="op" id="8208354">,</span>&nbsp;<span class="num" id="8208356">0xa2</span><span class="op" id="8208360">,</span>&nbsp;<span class="num" id="8208362">0xc4</span><span class="op" id="8208366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8208370">0x3b</span><span class="op" id="8208374">,</span>&nbsp;<span class="num" id="8208376">0xad</span><span class="op" id="8208380">,</span>&nbsp;<span class="num" id="8208382">0x54</span><span class="op" id="8208386">,</span>&nbsp;<span class="num" id="8208388">0x6f</span><span class="op" id="8208392">,</span>&nbsp;<span class="num" id="8208394">0xbe</span><span class="op" id="8208398">,</span>&nbsp;<span class="num" id="8208400">0x8c</span><span class="op" id="8208404">,</span>&nbsp;<span class="num" id="8208406">0xfe</span><span class="op" id="8208410">,</span>&nbsp;<span class="num" id="8208412">0xbc</span><span class="op" id="8208416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208423">hash</span>&nbsp;<span class="op" id="8208428">:=</span>&nbsp;<span class="ident" id="8208431">sha1</span><span class="op" id="8208435">.</span><span class="ident" id="8208436">New</span><span class="op" id="8208439">(</span><span class="op" id="8208440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208443">hash</span><span class="op" id="8208447">.</span><span class="ident" id="8208448">Write</span><span class="op" id="8208453">(</span><span class="ident" id="8208454">msg</span><span class="op" id="8208457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208460">hashed</span>&nbsp;<span class="op" id="8208467">:=</span>&nbsp;<span class="ident" id="8208470">hash</span><span class="op" id="8208474">.</span><span class="ident" id="8208475">Sum</span><span class="op" id="8208478">(</span><span class="ident" id="8208479">nil</span><span class="op" id="8208482">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208486">encoded</span><span class="op" id="8208493">,</span>&nbsp;<span class="ident" id="8208495">err</span>&nbsp;<span class="op" id="8208499">:=</span>&nbsp;<span class="ident" id="8208502">emsaPSSEncode</span><span class="op" id="8208515">(</span><span class="ident" id="8208516">hashed</span><span class="op" id="8208522">,</span>&nbsp;<span class="num" id="8208524">1023</span><span class="op" id="8208528">,</span>&nbsp;<span class="ident" id="8208530">salt</span><span class="op" id="8208534">,</span>&nbsp;<span class="ident" id="8208536">sha1</span><span class="op" id="8208540">.</span><span class="ident" id="8208541">New</span><span class="op" id="8208544">(</span><span class="op" id="8208545">)</span><span class="op" id="8208546">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208549">if</span>&nbsp;<span class="ident" id="8208552">err</span>&nbsp;<span class="op" id="8208556">!=</span>&nbsp;<span class="ident" id="8208559">nil</span>&nbsp;<span class="op" id="8208563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208567">t</span><span class="op" id="8208568">.</span><span class="ident" id="8208569">Errorf</span><span class="op" id="8208575">(</span><span class="string" id="8208576">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="8208608">,</span>&nbsp;<span class="ident" id="8208610">err</span><span class="op" id="8208613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208619">if</span>&nbsp;<span class="op" id="8208622">!</span><span class="ident" id="8208623">bytes</span><span class="op" id="8208628">.</span><span class="ident" id="8208629">Equal</span><span class="op" id="8208634">(</span><span class="ident" id="8208635">encoded</span><span class="op" id="8208642">,</span>&nbsp;<span class="ident" id="8208644">expected</span><span class="op" id="8208652">)</span>&nbsp;<span class="op" id="8208654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208658">t</span><span class="op" id="8208659">.</span><span class="ident" id="8208660">Errorf</span><span class="op" id="8208666">(</span><span class="string" id="8208667">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8208698">,</span>&nbsp;<span class="ident" id="8208700">encoded</span><span class="op" id="8208707">,</span>&nbsp;<span class="ident" id="8208709">expected</span><span class="op" id="8208717">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208724">if</span>&nbsp;<span class="ident" id="8208727">err</span>&nbsp;<span class="op" id="8208731">=</span>&nbsp;<span class="ident" id="8208733">emsaPSSVerify</span><span class="op" id="8208746">(</span><span class="ident" id="8208747">hashed</span><span class="op" id="8208753">,</span>&nbsp;<span class="ident" id="8208755">encoded</span><span class="op" id="8208762">,</span>&nbsp;<span class="num" id="8208764">1023</span><span class="op" id="8208768">,</span>&nbsp;<span class="builtinfunc" id="8208770">len</span><span class="op" id="8208773">(</span><span class="ident" id="8208774">salt</span><span class="op" id="8208778">)</span><span class="op" id="8208779">,</span>&nbsp;<span class="ident" id="8208781">sha1</span><span class="op" id="8208785">.</span><span class="ident" id="8208786">New</span><span class="op" id="8208789">(</span><span class="op" id="8208790">)</span><span class="op" id="8208791">)</span><span class="op" id="8208792">;</span>&nbsp;<span class="ident" id="8208794">err</span>&nbsp;<span class="op" id="8208798">!=</span>&nbsp;<span class="ident" id="8208801">nil</span>&nbsp;<span class="op" id="8208805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208809">t</span><span class="op" id="8208810">.</span><span class="ident" id="8208811">Errorf</span><span class="op" id="8208817">(</span><span class="string" id="8208818">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="8208840">,</span>&nbsp;<span class="ident" id="8208842">err</span><span class="op" id="8208845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208848">}</span><br>
<span class="lineno">75</span><span class="op" id="8208850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8208853">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="8208918">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="8208982">func</span>&nbsp;<span class="ident" id="8208987">TestPSSGolden</span><span class="op" id="8209000">(</span><span class="ident" id="8209001">t</span>&nbsp;<span class="op" id="8209003">*</span><span class="ident" id="8209004">testing</span><span class="op" id="8209011">.</span><span class="ident" id="8209012">T</span><span class="op" id="8209013">)</span>&nbsp;<span class="op" id="8209015">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209018">inFile</span><span class="op" id="8209024">,</span>&nbsp;<span class="ident" id="8209026">err</span>&nbsp;<span class="op" id="8209030">:=</span>&nbsp;<span class="ident" id="8209033">os</span><span class="op" id="8209035">.</span><span class="ident" id="8209036">Open</span><span class="op" id="8209040">(</span><span class="string" id="8209041">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="8209068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209071">if</span>&nbsp;<span class="ident" id="8209074">err</span>&nbsp;<span class="op" id="8209078">!=</span>&nbsp;<span class="ident" id="8209081">nil</span>&nbsp;<span class="op" id="8209085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209089">t</span><span class="op" id="8209090">.</span><span class="ident" id="8209091">Fatalf</span><span class="op" id="8209097">(</span><span class="string" id="8209098">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="8209129">,</span>&nbsp;<span class="ident" id="8209131">err</span><span class="op" id="8209134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209140">defer</span>&nbsp;<span class="ident" id="8209146">inFile</span><span class="op" id="8209152">.</span><span class="ident" id="8209153">Close</span><span class="op" id="8209158">(</span><span class="op" id="8209159">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209163">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209228">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209299">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8209369">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209404">const</span>&nbsp;<span class="ident" id="8209410">newKeyMarker</span>&nbsp;<span class="op" id="8209423">=</span>&nbsp;<span class="string" id="8209425">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209442">const</span>&nbsp;<span class="ident" id="8209448">newSignatureMarker</span>&nbsp;<span class="op" id="8209467">=</span>&nbsp;<span class="string" id="8209469">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209493">values</span>&nbsp;<span class="op" id="8209500">:=</span>&nbsp;<span class="builtinfunc" id="8209503">make</span><span class="op" id="8209507">(</span><span class="keyword" id="8209508">chan</span>&nbsp;<span class="builtintype" id="8209513">string</span><span class="op" id="8209519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209523">go</span>&nbsp;<span class="keyword" id="8209526">func</span><span class="op" id="8209530">(</span><span class="op" id="8209531">)</span>&nbsp;<span class="op" id="8209533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209537">defer</span>&nbsp;<span class="builtinfunc" id="8209543">close</span><span class="op" id="8209548">(</span><span class="ident" id="8209549">values</span><span class="op" id="8209555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209559">scanner</span>&nbsp;<span class="op" id="8209567">:=</span>&nbsp;<span class="ident" id="8209570">bufio</span><span class="op" id="8209575">.</span><span class="ident" id="8209576">NewScanner</span><span class="op" id="8209586">(</span><span class="ident" id="8209587">bzip2</span><span class="op" id="8209592">.</span><span class="ident" id="8209593">NewReader</span><span class="op" id="8209602">(</span><span class="ident" id="8209603">inFile</span><span class="op" id="8209609">)</span><span class="op" id="8209610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209614">var</span>&nbsp;<span class="ident" id="8209618">partialValue</span>&nbsp;<span class="builtintype" id="8209631">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209640">lastWasValue</span>&nbsp;<span class="op" id="8209653">:=</span>&nbsp;<span class="builtintype" id="8209656">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209664">for</span>&nbsp;<span class="ident" id="8209668">scanner</span><span class="op" id="8209675">.</span><span class="ident" id="8209676">Scan</span><span class="op" id="8209680">(</span><span class="op" id="8209681">)</span>&nbsp;<span class="op" id="8209683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209688">line</span>&nbsp;<span class="op" id="8209693">:=</span>&nbsp;<span class="ident" id="8209696">scanner</span><span class="op" id="8209703">.</span><span class="ident" id="8209704">Text</span><span class="op" id="8209708">(</span><span class="op" id="8209709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209714">switch</span>&nbsp;<span class="op" id="8209721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209726">case</span>&nbsp;<span class="builtinfunc" id="8209731">len</span><span class="op" id="8209734">(</span><span class="ident" id="8209735">line</span><span class="op" id="8209739">)</span>&nbsp;<span class="op" id="8209741">==</span>&nbsp;<span class="num" id="8209744">0</span><span class="op" id="8209745">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209751">if</span>&nbsp;<span class="builtinfunc" id="8209754">len</span><span class="op" id="8209757">(</span><span class="ident" id="8209758">partialValue</span><span class="op" id="8209770">)</span>&nbsp;<span class="op" id="8209772">&gt;</span>&nbsp;<span class="num" id="8209774">0</span>&nbsp;<span class="op" id="8209776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209783">values</span>&nbsp;<span class="op" id="8209790">&lt;-</span>&nbsp;<span class="ident" id="8209793">strings</span><span class="op" id="8209800">.</span><span class="ident" id="8209801">Replace</span><span class="op" id="8209808">(</span><span class="ident" id="8209809">partialValue</span><span class="op" id="8209821">,</span>&nbsp;<span class="string" id="8209823">&#34;&nbsp;&#34;</span><span class="op" id="8209826">,</span>&nbsp;<span class="string" id="8209828">&#34;&#34;</span><span class="op" id="8209830">,</span>&nbsp;<span class="op" id="8209832">-</span><span class="num" id="8209833">1</span><span class="op" id="8209834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209841">partialValue</span>&nbsp;<span class="op" id="8209854">=</span>&nbsp;<span class="string" id="8209856">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209864">lastWasValue</span>&nbsp;<span class="op" id="8209877">=</span>&nbsp;<span class="builtintype" id="8209879">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209888">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209894">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209906">case</span>&nbsp;<span class="ident" id="8209911">strings</span><span class="op" id="8209918">.</span><span class="ident" id="8209919">HasPrefix</span><span class="op" id="8209928">(</span><span class="ident" id="8209929">line</span><span class="op" id="8209933">,</span>&nbsp;<span class="string" id="8209935">&#34;#&nbsp;======&#34;</span><span class="op" id="8209945">)</span>&nbsp;<span class="op" id="8209947">&amp;&amp;</span>&nbsp;<span class="ident" id="8209950">lastWasValue</span><span class="op" id="8209962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209968">values</span>&nbsp;<span class="op" id="8209975">&lt;-</span>&nbsp;<span class="ident" id="8209978">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209995">lastWasValue</span>&nbsp;<span class="op" id="8210008">=</span>&nbsp;<span class="builtintype" id="8210010">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210019">case</span>&nbsp;<span class="ident" id="8210024">strings</span><span class="op" id="8210031">.</span><span class="ident" id="8210032">HasPrefix</span><span class="op" id="8210041">(</span><span class="ident" id="8210042">line</span><span class="op" id="8210046">,</span>&nbsp;<span class="string" id="8210048">&#34;#&nbsp;------&#34;</span><span class="op" id="8210058">)</span>&nbsp;<span class="op" id="8210060">&amp;&amp;</span>&nbsp;<span class="ident" id="8210063">lastWasValue</span><span class="op" id="8210075">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210081">values</span>&nbsp;<span class="op" id="8210088">&lt;-</span>&nbsp;<span class="ident" id="8210091">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210114">lastWasValue</span>&nbsp;<span class="op" id="8210127">=</span>&nbsp;<span class="builtintype" id="8210129">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210138">case</span>&nbsp;<span class="ident" id="8210143">strings</span><span class="op" id="8210150">.</span><span class="ident" id="8210151">HasPrefix</span><span class="op" id="8210160">(</span><span class="ident" id="8210161">line</span><span class="op" id="8210165">,</span>&nbsp;<span class="string" id="8210167">&#34;#&#34;</span><span class="op" id="8210170">)</span><span class="op" id="8210171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210177">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210189">default</span><span class="op" id="8210196">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210202">partialValue</span>&nbsp;<span class="op" id="8210215">+=</span>&nbsp;<span class="ident" id="8210218">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210234">if</span>&nbsp;<span class="ident" id="8210237">err</span>&nbsp;<span class="op" id="8210241">:=</span>&nbsp;<span class="ident" id="8210244">scanner</span><span class="op" id="8210251">.</span><span class="ident" id="8210252">Err</span><span class="op" id="8210255">(</span><span class="op" id="8210256">)</span><span class="op" id="8210257">;</span>&nbsp;<span class="ident" id="8210259">err</span>&nbsp;<span class="op" id="8210263">!=</span>&nbsp;<span class="ident" id="8210266">nil</span>&nbsp;<span class="op" id="8210270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8210275">panic</span><span class="op" id="8210280">(</span><span class="ident" id="8210281">err</span><span class="op" id="8210284">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210291">}</span><span class="op" id="8210292">(</span><span class="op" id="8210293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210297">var</span>&nbsp;<span class="ident" id="8210301">key</span>&nbsp;<span class="op" id="8210305">*</span><span class="ident" id="8210306">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210317">var</span>&nbsp;<span class="ident" id="8210321">hashed</span>&nbsp;<span class="op" id="8210328">[</span><span class="op" id="8210329">]</span><span class="builtintype" id="8210330">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210336">hash</span>&nbsp;<span class="op" id="8210341">:=</span>&nbsp;<span class="ident" id="8210344">crypto</span><span class="op" id="8210350">.</span><span class="ident" id="8210351">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210357">h</span>&nbsp;<span class="op" id="8210359">:=</span>&nbsp;<span class="ident" id="8210362">hash</span><span class="op" id="8210366">.</span><span class="ident" id="8210367">New</span><span class="op" id="8210370">(</span><span class="op" id="8210371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210374">opts</span>&nbsp;<span class="op" id="8210379">:=</span>&nbsp;<span class="op" id="8210382">&amp;</span><span class="ident" id="8210383">PSSOptions</span><span class="op" id="8210393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210397">SaltLength</span><span class="op" id="8210407">:</span>&nbsp;<span class="ident" id="8210409">PSSSaltLengthEqualsHash</span><span class="op" id="8210432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210435">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210439">for</span>&nbsp;<span class="ident" id="8210443">marker</span>&nbsp;<span class="op" id="8210450">:=</span>&nbsp;<span class="keyword" id="8210453">range</span>&nbsp;<span class="ident" id="8210459">values</span>&nbsp;<span class="op" id="8210466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210470">switch</span>&nbsp;<span class="ident" id="8210477">marker</span>&nbsp;<span class="op" id="8210484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210488">case</span>&nbsp;<span class="ident" id="8210493">newKeyMarker</span><span class="op" id="8210505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210510">key</span>&nbsp;<span class="op" id="8210514">=</span>&nbsp;<span class="builtinfunc" id="8210516">new</span><span class="op" id="8210519">(</span><span class="ident" id="8210520">PublicKey</span><span class="op" id="8210529">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210534">nHex</span><span class="op" id="8210538">,</span>&nbsp;<span class="ident" id="8210540">ok</span>&nbsp;<span class="op" id="8210543">:=</span>&nbsp;<span class="op" id="8210546">&lt;-</span><span class="ident" id="8210548">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210558">if</span>&nbsp;<span class="op" id="8210561">!</span><span class="ident" id="8210562">ok</span>&nbsp;<span class="op" id="8210565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210571">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210588">key</span><span class="op" id="8210591">.</span><span class="ident" id="8210592">N</span>&nbsp;<span class="op" id="8210594">=</span>&nbsp;<span class="ident" id="8210596">bigFromHex</span><span class="op" id="8210606">(</span><span class="ident" id="8210607">nHex</span><span class="op" id="8210611">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210616">key</span><span class="op" id="8210619">.</span><span class="ident" id="8210620">E</span>&nbsp;<span class="op" id="8210622">=</span>&nbsp;<span class="ident" id="8210624">intFromHex</span><span class="op" id="8210634">(</span><span class="op" id="8210635">&lt;-</span><span class="ident" id="8210637">values</span><span class="op" id="8210643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210648">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210697">for</span>&nbsp;<span class="ident" id="8210701">i</span>&nbsp;<span class="op" id="8210703">:=</span>&nbsp;<span class="num" id="8210706">0</span><span class="op" id="8210707">;</span>&nbsp;<span class="ident" id="8210709">i</span>&nbsp;<span class="op" id="8210711">&lt;</span>&nbsp;<span class="num" id="8210713">6</span><span class="op" id="8210714">;</span>&nbsp;<span class="ident" id="8210716">i</span><span class="op" id="8210717">++</span>&nbsp;<span class="op" id="8210720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210726">&lt;-</span><span class="ident" id="8210728">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210738">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210742">case</span>&nbsp;<span class="ident" id="8210747">newSignatureMarker</span><span class="op" id="8210765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210770">msg</span>&nbsp;<span class="op" id="8210774">:=</span>&nbsp;<span class="ident" id="8210777">fromHex</span><span class="op" id="8210784">(</span><span class="op" id="8210785">&lt;-</span><span class="ident" id="8210787">values</span><span class="op" id="8210793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210798">&lt;-</span><span class="ident" id="8210800">values</span>&nbsp;<span class="comment" id="8210807">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210823">sig</span>&nbsp;<span class="op" id="8210827">:=</span>&nbsp;<span class="ident" id="8210830">fromHex</span><span class="op" id="8210837">(</span><span class="op" id="8210838">&lt;-</span><span class="ident" id="8210840">values</span><span class="op" id="8210846">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210852">h</span><span class="op" id="8210853">.</span><span class="ident" id="8210854">Reset</span><span class="op" id="8210859">(</span><span class="op" id="8210860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210865">h</span><span class="op" id="8210866">.</span><span class="ident" id="8210867">Write</span><span class="op" id="8210872">(</span><span class="ident" id="8210873">msg</span><span class="op" id="8210876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210881">hashed</span>&nbsp;<span class="op" id="8210888">=</span>&nbsp;<span class="ident" id="8210890">h</span><span class="op" id="8210891">.</span><span class="ident" id="8210892">Sum</span><span class="op" id="8210895">(</span><span class="ident" id="8210896">hashed</span><span class="op" id="8210902">[</span><span class="op" id="8210903">:</span><span class="num" id="8210904">0</span><span class="op" id="8210905">]</span><span class="op" id="8210906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8210912">if</span>&nbsp;<span class="ident" id="8210915">err</span>&nbsp;<span class="op" id="8210919">:=</span>&nbsp;<span class="ident" id="8210922">VerifyPSS</span><span class="op" id="8210931">(</span><span class="ident" id="8210932">key</span><span class="op" id="8210935">,</span>&nbsp;<span class="ident" id="8210937">hash</span><span class="op" id="8210941">,</span>&nbsp;<span class="ident" id="8210943">hashed</span><span class="op" id="8210949">,</span>&nbsp;<span class="ident" id="8210951">sig</span><span class="op" id="8210954">,</span>&nbsp;<span class="ident" id="8210956">opts</span><span class="op" id="8210960">)</span><span class="op" id="8210961">;</span>&nbsp;<span class="ident" id="8210963">err</span>&nbsp;<span class="op" id="8210967">!=</span>&nbsp;<span class="ident" id="8210970">nil</span>&nbsp;<span class="op" id="8210974">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210980">t</span><span class="op" id="8210981">.</span><span class="ident" id="8210982">Error</span><span class="op" id="8210987">(</span><span class="ident" id="8210988">err</span><span class="op" id="8210991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211000">default</span><span class="op" id="8211007">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211012">t</span><span class="op" id="8211013">.</span><span class="ident" id="8211014">Fatalf</span><span class="op" id="8211020">(</span><span class="string" id="8211021">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="8211040">+</span>&nbsp;<span class="ident" id="8211042">marker</span><span class="op" id="8211048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211052">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211055">}</span><br>
<span class="lineno"></span><span class="op" id="8211057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8211060">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8211139">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="8211207">func</span>&nbsp;<span class="ident" id="8211212">TestPSSOpenSSL</span><span class="op" id="8211226">(</span><span class="ident" id="8211227">t</span>&nbsp;<span class="op" id="8211229">*</span><span class="ident" id="8211230">testing</span><span class="op" id="8211237">.</span><span class="ident" id="8211238">T</span><span class="op" id="8211239">)</span>&nbsp;<span class="op" id="8211241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211244">hash</span>&nbsp;<span class="op" id="8211249">:=</span>&nbsp;<span class="ident" id="8211252">crypto</span><span class="op" id="8211258">.</span><span class="ident" id="8211259">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211267">h</span>&nbsp;<span class="op" id="8211269">:=</span>&nbsp;<span class="ident" id="8211272">hash</span><span class="op" id="8211276">.</span><span class="ident" id="8211277">New</span><span class="op" id="8211280">(</span><span class="op" id="8211281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211284">h</span><span class="op" id="8211285">.</span><span class="ident" id="8211286">Write</span><span class="op" id="8211291">(</span><span class="op" id="8211292">[</span><span class="op" id="8211293">]</span><span class="builtintype" id="8211294">byte</span><span class="op" id="8211298">(</span><span class="string" id="8211299">&#34;testing&#34;</span><span class="op" id="8211308">)</span><span class="op" id="8211309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211312">hashed</span>&nbsp;<span class="op" id="8211319">:=</span>&nbsp;<span class="ident" id="8211322">h</span><span class="op" id="8211323">.</span><span class="ident" id="8211324">Sum</span><span class="op" id="8211327">(</span><span class="ident" id="8211328">nil</span><span class="op" id="8211331">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211335">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211444">sig</span>&nbsp;<span class="op" id="8211448">:=</span>&nbsp;<span class="op" id="8211451">[</span><span class="op" id="8211452">]</span><span class="builtintype" id="8211453">byte</span><span class="op" id="8211457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8211461">0x95</span><span class="op" id="8211465">,</span>&nbsp;<span class="num" id="8211467">0x59</span><span class="op" id="8211471">,</span>&nbsp;<span class="num" id="8211473">0x6f</span><span class="op" id="8211477">,</span>&nbsp;<span class="num" id="8211479">0xd3</span><span class="op" id="8211483">,</span>&nbsp;<span class="num" id="8211485">0x10</span><span class="op" id="8211489">,</span>&nbsp;<span class="num" id="8211491">0xa2</span><span class="op" id="8211495">,</span>&nbsp;<span class="num" id="8211497">0xe7</span><span class="op" id="8211501">,</span>&nbsp;<span class="num" id="8211503">0xa2</span><span class="op" id="8211507">,</span>&nbsp;<span class="num" id="8211509">0x92</span><span class="op" id="8211513">,</span>&nbsp;<span class="num" id="8211515">0x9d</span><span class="op" id="8211519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8211523">0x4a</span><span class="op" id="8211527">,</span>&nbsp;<span class="num" id="8211529">0x07</span><span class="op" id="8211533">,</span>&nbsp;<span class="num" id="8211535">0x2e</span><span class="op" id="8211539">,</span>&nbsp;<span class="num" id="8211541">0x2b</span><span class="op" id="8211545">,</span>&nbsp;<span class="num" id="8211547">0x27</span><span class="op" id="8211551">,</span>&nbsp;<span class="num" id="8211553">0xcc</span><span class="op" id="8211557">,</span>&nbsp;<span class="num" id="8211559">0x06</span><span class="op" id="8211563">,</span>&nbsp;<span class="num" id="8211565">0xc2</span><span class="op" id="8211569">,</span>&nbsp;<span class="num" id="8211571">0x87</span><span class="op" id="8211575">,</span>&nbsp;<span class="num" id="8211577">0x2c</span><span class="op" id="8211581">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8211585">0x52</span><span class="op" id="8211589">,</span>&nbsp;<span class="num" id="8211591">0xf0</span><span class="op" id="8211595">,</span>&nbsp;<span class="num" id="8211597">0x4a</span><span class="op" id="8211601">,</span>&nbsp;<span class="num" id="8211603">0xcc</span><span class="op" id="8211607">,</span>&nbsp;<span class="num" id="8211609">0x05</span><span class="op" id="8211613">,</span>&nbsp;<span class="num" id="8211615">0x94</span><span class="op" id="8211619">,</span>&nbsp;<span class="num" id="8211621">0xf2</span><span class="op" id="8211625">,</span>&nbsp;<span class="num" id="8211627">0xc3</span><span class="op" id="8211631">,</span>&nbsp;<span class="num" id="8211633">0x2e</span><span class="op" id="8211637">,</span>&nbsp;<span class="num" id="8211639">0x20</span><span class="op" id="8211643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8211647">0xd7</span><span class="op" id="8211651">,</span>&nbsp;<span class="num" id="8211653">0x3e</span><span class="op" id="8211657">,</span>&nbsp;<span class="num" id="8211659">0x66</span><span class="op" id="8211663">,</span>&nbsp;<span class="num" id="8211665">0x62</span><span class="op" id="8211669">,</span>&nbsp;<span class="num" id="8211671">0xb5</span><span class="op" id="8211675">,</span>&nbsp;<span class="num" id="8211677">0x95</span><span class="op" id="8211681">,</span>&nbsp;<span class="num" id="8211683">0x2b</span><span class="op" id="8211687">,</span>&nbsp;<span class="num" id="8211689">0xa3</span><span class="op" id="8211693">,</span>&nbsp;<span class="num" id="8211695">0x93</span><span class="op" id="8211699">,</span>&nbsp;<span class="num" id="8211701">0x9a</span><span class="op" id="8211705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8211709">0x66</span><span class="op" id="8211713">,</span>&nbsp;<span class="num" id="8211715">0x64</span><span class="op" id="8211719">,</span>&nbsp;<span class="num" id="8211721">0x25</span><span class="op" id="8211725">,</span>&nbsp;<span class="num" id="8211727">0xe0</span><span class="op" id="8211731">,</span>&nbsp;<span class="num" id="8211733">0x74</span><span class="op" id="8211737">,</span>&nbsp;<span class="num" id="8211739">0x66</span><span class="op" id="8211743">,</span>&nbsp;<span class="num" id="8211745">0x8c</span><span class="op" id="8211749">,</span>&nbsp;<span class="num" id="8211751">0x3e</span><span class="op" id="8211755">,</span>&nbsp;<span class="num" id="8211757">0x92</span><span class="op" id="8211761">,</span>&nbsp;<span class="num" id="8211763">0xeb</span><span class="op" id="8211767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8211771">0xc6</span><span class="op" id="8211775">,</span>&nbsp;<span class="num" id="8211777">0xe6</span><span class="op" id="8211781">,</span>&nbsp;<span class="num" id="8211783">0xc0</span><span class="op" id="8211787">,</span>&nbsp;<span class="num" id="8211789">0x44</span><span class="op" id="8211793">,</span>&nbsp;<span class="num" id="8211795">0xf3</span><span class="op" id="8211799">,</span>&nbsp;<span class="num" id="8211801">0xb4</span><span class="op" id="8211805">,</span>&nbsp;<span class="num" id="8211807">0xb4</span><span class="op" id="8211811">,</span>&nbsp;<span class="num" id="8211813">0x2e</span><span class="op" id="8211817">,</span>&nbsp;<span class="num" id="8211819">0x8c</span><span class="op" id="8211823">,</span>&nbsp;<span class="num" id="8211825">0x66</span><span class="op" id="8211829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8211833">0x0a</span><span class="op" id="8211837">,</span>&nbsp;<span class="num" id="8211839">0x37</span><span class="op" id="8211843">,</span>&nbsp;<span class="num" id="8211845">0x9c</span><span class="op" id="8211849">,</span>&nbsp;<span class="num" id="8211851">0x69</span><span class="op" id="8211855">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8211862">if</span>&nbsp;<span class="ident" id="8211865">err</span>&nbsp;<span class="op" id="8211869">:=</span>&nbsp;<span class="ident" id="8211872">VerifyPSS</span><span class="op" id="8211881">(</span><span class="op" id="8211882">&amp;</span><span class="ident" id="8211883">rsaPrivateKey</span><span class="op" id="8211896">.</span><span class="ident" id="8211897">PublicKey</span><span class="op" id="8211906">,</span>&nbsp;<span class="ident" id="8211908">hash</span><span class="op" id="8211912">,</span>&nbsp;<span class="ident" id="8211914">hashed</span><span class="op" id="8211920">,</span>&nbsp;<span class="ident" id="8211922">sig</span><span class="op" id="8211925">,</span>&nbsp;<span class="ident" id="8211927">nil</span><span class="op" id="8211930">)</span><span class="op" id="8211931">;</span>&nbsp;<span class="ident" id="8211933">err</span>&nbsp;<span class="op" id="8211937">!=</span>&nbsp;<span class="ident" id="8211940">nil</span>&nbsp;<span class="op" id="8211944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211948">t</span><span class="op" id="8211949">.</span><span class="ident" id="8211950">Error</span><span class="op" id="8211955">(</span><span class="ident" id="8211956">err</span><span class="op" id="8211959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211962">}</span><br>
<span class="lineno">190</span><span class="op" id="8211964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8211967">func</span>&nbsp;<span class="ident" id="8211972">TestPSSSigning</span><span class="op" id="8211986">(</span><span class="ident" id="8211987">t</span>&nbsp;<span class="op" id="8211989">*</span><span class="ident" id="8211990">testing</span><span class="op" id="8211997">.</span><span class="ident" id="8211998">T</span><span class="op" id="8211999">)</span>&nbsp;<span class="op" id="8212001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212004">var</span>&nbsp;<span class="ident" id="8212008">saltLengthCombinations</span>&nbsp;<span class="op" id="8212031">=</span>&nbsp;<span class="op" id="8212033">[</span><span class="op" id="8212034">]</span><span class="keyword" id="8212035">struct</span>&nbsp;<span class="op" id="8212042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212046">signSaltLength</span><span class="op" id="8212060">,</span>&nbsp;<span class="ident" id="8212062">verifySaltLength</span>&nbsp;<span class="builtintype" id="8212079">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212085">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8212118">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212124">}</span><span class="op" id="8212125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212129">{</span><span class="ident" id="8212130">PSSSaltLengthAuto</span><span class="op" id="8212147">,</span>&nbsp;<span class="ident" id="8212149">PSSSaltLengthAuto</span><span class="op" id="8212166">,</span>&nbsp;<span class="builtintype" id="8212168">true</span><span class="op" id="8212172">}</span><span class="op" id="8212173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212177">{</span><span class="ident" id="8212178">PSSSaltLengthEqualsHash</span><span class="op" id="8212201">,</span>&nbsp;<span class="ident" id="8212203">PSSSaltLengthAuto</span><span class="op" id="8212220">,</span>&nbsp;<span class="builtintype" id="8212222">true</span><span class="op" id="8212226">}</span><span class="op" id="8212227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212231">{</span><span class="ident" id="8212232">PSSSaltLengthEqualsHash</span><span class="op" id="8212255">,</span>&nbsp;<span class="ident" id="8212257">PSSSaltLengthEqualsHash</span><span class="op" id="8212280">,</span>&nbsp;<span class="builtintype" id="8212282">true</span><span class="op" id="8212286">}</span><span class="op" id="8212287">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212291">{</span><span class="ident" id="8212292">PSSSaltLengthEqualsHash</span><span class="op" id="8212315">,</span>&nbsp;<span class="num" id="8212317">8</span><span class="op" id="8212318">,</span>&nbsp;<span class="builtintype" id="8212320">false</span><span class="op" id="8212325">}</span><span class="op" id="8212326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212330">{</span><span class="ident" id="8212331">PSSSaltLengthAuto</span><span class="op" id="8212348">,</span>&nbsp;<span class="ident" id="8212350">PSSSaltLengthEqualsHash</span><span class="op" id="8212373">,</span>&nbsp;<span class="builtintype" id="8212375">false</span><span class="op" id="8212380">}</span><span class="op" id="8212381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212385">{</span><span class="num" id="8212386">8</span><span class="op" id="8212387">,</span>&nbsp;<span class="num" id="8212389">8</span><span class="op" id="8212390">,</span>&nbsp;<span class="builtintype" id="8212392">true</span><span class="op" id="8212396">}</span><span class="op" id="8212397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212404">hash</span>&nbsp;<span class="op" id="8212409">:=</span>&nbsp;<span class="ident" id="8212412">crypto</span><span class="op" id="8212418">.</span><span class="ident" id="8212419">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212424">h</span>&nbsp;<span class="op" id="8212426">:=</span>&nbsp;<span class="ident" id="8212429">hash</span><span class="op" id="8212433">.</span><span class="ident" id="8212434">New</span><span class="op" id="8212437">(</span><span class="op" id="8212438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212441">h</span><span class="op" id="8212442">.</span><span class="ident" id="8212443">Write</span><span class="op" id="8212448">(</span><span class="op" id="8212449">[</span><span class="op" id="8212450">]</span><span class="builtintype" id="8212451">byte</span><span class="op" id="8212455">(</span><span class="string" id="8212456">&#34;testing&#34;</span><span class="op" id="8212465">)</span><span class="op" id="8212466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212469">hashed</span>&nbsp;<span class="op" id="8212476">:=</span>&nbsp;<span class="ident" id="8212479">h</span><span class="op" id="8212480">.</span><span class="ident" id="8212481">Sum</span><span class="op" id="8212484">(</span><span class="ident" id="8212485">nil</span><span class="op" id="8212488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212491">var</span>&nbsp;<span class="ident" id="8212495">opts</span>&nbsp;<span class="ident" id="8212500">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212513">for</span>&nbsp;<span class="ident" id="8212517">i</span><span class="op" id="8212518">,</span>&nbsp;<span class="ident" id="8212520">test</span>&nbsp;<span class="op" id="8212525">:=</span>&nbsp;<span class="keyword" id="8212528">range</span>&nbsp;<span class="ident" id="8212534">saltLengthCombinations</span>&nbsp;<span class="op" id="8212557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212561">opts</span><span class="op" id="8212565">.</span><span class="ident" id="8212566">SaltLength</span>&nbsp;<span class="op" id="8212577">=</span>&nbsp;<span class="ident" id="8212579">test</span><span class="op" id="8212583">.</span><span class="ident" id="8212584">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212601">sig</span><span class="op" id="8212604">,</span>&nbsp;<span class="ident" id="8212606">err</span>&nbsp;<span class="op" id="8212610">:=</span>&nbsp;<span class="ident" id="8212613">SignPSS</span><span class="op" id="8212620">(</span><span class="ident" id="8212621">rand</span><span class="op" id="8212625">.</span><span class="ident" id="8212626">Reader</span><span class="op" id="8212632">,</span>&nbsp;<span class="ident" id="8212634">rsaPrivateKey</span><span class="op" id="8212647">,</span>&nbsp;<span class="ident" id="8212649">hash</span><span class="op" id="8212653">,</span>&nbsp;<span class="ident" id="8212655">hashed</span><span class="op" id="8212661">,</span>&nbsp;<span class="op" id="8212663">&amp;</span><span class="ident" id="8212664">opts</span><span class="op" id="8212668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212672">if</span>&nbsp;<span class="ident" id="8212675">err</span>&nbsp;<span class="op" id="8212679">!=</span>&nbsp;<span class="ident" id="8212682">nil</span>&nbsp;<span class="op" id="8212686">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212691">t</span><span class="op" id="8212692">.</span><span class="ident" id="8212693">Errorf</span><span class="op" id="8212699">(</span><span class="string" id="8212700">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8212730">,</span>&nbsp;<span class="ident" id="8212732">i</span><span class="op" id="8212733">,</span>&nbsp;<span class="ident" id="8212735">err</span><span class="op" id="8212738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212743">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212759">opts</span><span class="op" id="8212763">.</span><span class="ident" id="8212764">SaltLength</span>&nbsp;<span class="op" id="8212775">=</span>&nbsp;<span class="ident" id="8212777">test</span><span class="op" id="8212781">.</span><span class="ident" id="8212782">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212801">err</span>&nbsp;<span class="op" id="8212805">=</span>&nbsp;<span class="ident" id="8212807">VerifyPSS</span><span class="op" id="8212816">(</span><span class="op" id="8212817">&amp;</span><span class="ident" id="8212818">rsaPrivateKey</span><span class="op" id="8212831">.</span><span class="ident" id="8212832">PublicKey</span><span class="op" id="8212841">,</span>&nbsp;<span class="ident" id="8212843">hash</span><span class="op" id="8212847">,</span>&nbsp;<span class="ident" id="8212849">hashed</span><span class="op" id="8212855">,</span>&nbsp;<span class="ident" id="8212857">sig</span><span class="op" id="8212860">,</span>&nbsp;<span class="op" id="8212862">&amp;</span><span class="ident" id="8212863">opts</span><span class="op" id="8212867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8212871">if</span>&nbsp;<span class="op" id="8212874">(</span><span class="ident" id="8212875">err</span>&nbsp;<span class="op" id="8212879">==</span>&nbsp;<span class="ident" id="8212882">nil</span><span class="op" id="8212885">)</span>&nbsp;<span class="op" id="8212887">!=</span>&nbsp;<span class="ident" id="8212890">test</span><span class="op" id="8212894">.</span><span class="ident" id="8212895">good</span>&nbsp;<span class="op" id="8212900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212905">t</span><span class="op" id="8212906">.</span><span class="ident" id="8212907">Errorf</span><span class="op" id="8212913">(</span><span class="string" id="8212914">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="8212952">,</span>&nbsp;<span class="ident" id="8212954">i</span><span class="op" id="8212955">,</span>&nbsp;<span class="ident" id="8212957">test</span><span class="op" id="8212961">.</span><span class="ident" id="8212962">good</span><span class="op" id="8212966">,</span>&nbsp;<span class="ident" id="8212968">err</span><span class="op" id="8212971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212978">}</span><br>
<span class="lineno">225</span><span class="op" id="8212980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8212983">func</span>&nbsp;<span class="ident" id="8212988">bigFromHex</span><span class="op" id="8212998">(</span><span class="ident" id="8212999">hex</span>&nbsp;<span class="builtintype" id="8213003">string</span><span class="op" id="8213009">)</span>&nbsp;<span class="op" id="8213011">*</span><span class="ident" id="8213012">big</span><span class="op" id="8213015">.</span><span class="ident" id="8213016">Int</span>&nbsp;<span class="op" id="8213020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213023">n</span><span class="op" id="8213024">,</span>&nbsp;<span class="ident" id="8213026">ok</span>&nbsp;<span class="op" id="8213029">:=</span>&nbsp;<span class="builtinfunc" id="8213032">new</span><span class="op" id="8213035">(</span><span class="ident" id="8213036">big</span><span class="op" id="8213039">.</span><span class="ident" id="8213040">Int</span><span class="op" id="8213043">)</span><span class="op" id="8213044">.</span><span class="ident" id="8213045">SetString</span><span class="op" id="8213054">(</span><span class="ident" id="8213055">hex</span><span class="op" id="8213058">,</span>&nbsp;<span class="num" id="8213060">16</span><span class="op" id="8213062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213065">if</span>&nbsp;<span class="op" id="8213068">!</span><span class="ident" id="8213069">ok</span>&nbsp;<span class="op" id="8213072">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8213076">panic</span><span class="op" id="8213081">(</span><span class="string" id="8213082">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="8213094">+</span>&nbsp;<span class="ident" id="8213096">hex</span><span class="op" id="8213099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213105">return</span>&nbsp;<span class="ident" id="8213112">n</span><br>
<span class="lineno"></span><span class="op" id="8213114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8213117">func</span>&nbsp;<span class="ident" id="8213122">intFromHex</span><span class="op" id="8213132">(</span><span class="ident" id="8213133">hex</span>&nbsp;<span class="builtintype" id="8213137">string</span><span class="op" id="8213143">)</span>&nbsp;<span class="builtintype" id="8213145">int</span>&nbsp;<span class="op" id="8213149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213152">i</span><span class="op" id="8213153">,</span>&nbsp;<span class="ident" id="8213155">err</span>&nbsp;<span class="op" id="8213159">:=</span>&nbsp;<span class="ident" id="8213162">strconv</span><span class="op" id="8213169">.</span><span class="ident" id="8213170">ParseInt</span><span class="op" id="8213178">(</span><span class="ident" id="8213179">hex</span><span class="op" id="8213182">,</span>&nbsp;<span class="num" id="8213184">16</span><span class="op" id="8213186">,</span>&nbsp;<span class="num" id="8213188">32</span><span class="op" id="8213190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213193">if</span>&nbsp;<span class="ident" id="8213196">err</span>&nbsp;<span class="op" id="8213200">!=</span>&nbsp;<span class="ident" id="8213203">nil</span>&nbsp;<span class="op" id="8213207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8213211">panic</span><span class="op" id="8213216">(</span><span class="ident" id="8213217">err</span><span class="op" id="8213220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213223">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213226">return</span>&nbsp;<span class="builtintype" id="8213233">int</span><span class="op" id="8213236">(</span><span class="ident" id="8213237">i</span><span class="op" id="8213238">)</span><br>
<span class="lineno"></span><span class="op" id="8213240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8213243">func</span>&nbsp;<span class="ident" id="8213248">fromHex</span><span class="op" id="8213255">(</span><span class="ident" id="8213256">hexStr</span>&nbsp;<span class="builtintype" id="8213263">string</span><span class="op" id="8213269">)</span>&nbsp;<span class="op" id="8213271">[</span><span class="op" id="8213272">]</span><span class="builtintype" id="8213273">byte</span>&nbsp;<span class="op" id="8213278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213281">s</span><span class="op" id="8213282">,</span>&nbsp;<span class="ident" id="8213284">err</span>&nbsp;<span class="op" id="8213288">:=</span>&nbsp;<span class="ident" id="8213291">hex</span><span class="op" id="8213294">.</span><span class="ident" id="8213295">DecodeString</span><span class="op" id="8213307">(</span><span class="ident" id="8213308">hexStr</span><span class="op" id="8213314">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213317">if</span>&nbsp;<span class="ident" id="8213320">err</span>&nbsp;<span class="op" id="8213324">!=</span>&nbsp;<span class="ident" id="8213327">nil</span>&nbsp;<span class="op" id="8213331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8213335">panic</span><span class="op" id="8213340">(</span><span class="ident" id="8213341">err</span><span class="op" id="8213344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8213350">return</span>&nbsp;<span class="ident" id="8213357">s</span><br>
<span class="lineno"></span><span class="op" id="8213359">}</span>
</div>
</body>
</html>
