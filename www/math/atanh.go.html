<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2249401">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2249456">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2249510">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2249561">package</span>&nbsp;<span class="ident" id="2249569">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2249575">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2249635">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_atanh.c</span><br>
<span class="lineno"></span><span class="comment" id="2249695">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno">10</span><span class="comment" id="2249754">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="2249784">//</span><br>
<span class="lineno"></span><span class="comment" id="2249787">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2249843">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2249912">//</span><br>
<span class="lineno">15</span><span class="comment" id="2249915">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno"></span><span class="comment" id="2249974">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2250030">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2250087">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2250104">//&nbsp;====================================================</span><br>
<span class="lineno">20</span><span class="comment" id="2250160">//</span><br>
<span class="lineno"></span><span class="comment" id="2250163">//</span><br>
<span class="lineno"></span><span class="comment" id="2250166">//&nbsp;__ieee754_atanh(x)</span><br>
<span class="lineno"></span><span class="comment" id="2250188">//&nbsp;Method&nbsp;:</span><br>
<span class="lineno"></span><span class="comment" id="2250200">//&nbsp;&nbsp;&nbsp;&nbsp1.&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;positive&nbsp;by&nbsp;atanh(-x)&nbsp;=&nbsp;-atanh(x)</span><br>
<span class="lineno">25</span><span class="comment" id="2250252">//&nbsp;&nbsp;&nbsp;&nbsp2.&nbsp;For&nbsp;x&gt;=0.5</span><br>
<span class="lineno"></span><span class="comment" id="2250269">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2250329">//&nbsp;&nbsp;&nbsp;&nbspatanh(x)&nbsp;=&nbsp;---&nbsp;*&nbsp;log(1&nbsp;+&nbsp;-------)&nbsp;=&nbsp;0.5&nbsp;*&nbsp;log1p(2&nbsp;*&nbsp;--------)</span><br>
<span class="lineno"></span><span class="comment" id="2250394">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;-&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;-&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2250456">//</span><br>
<span class="lineno">30</span><span class="comment" id="2250459">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;x&lt;0.5</span><br>
<span class="lineno"></span><span class="comment" id="2250472">//&nbsp;&nbsp;&nbsp;&nbspatanh(x)&nbsp;=&nbsp;0.5*log1p(2x+2x*x/(1-x))</span><br>
<span class="lineno"></span><span class="comment" id="2250511">//</span><br>
<span class="lineno"></span><span class="comment" id="2250514">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2250532">//&nbsp;&nbsp;&nbsp;&nbspatanh(x)&nbsp;is&nbsp;NaN&nbsp;if&nbsp;|x|&nbsp;&gt;&nbsp;1&nbsp;with&nbsp;signal;</span><br>
<span class="lineno">35</span><span class="comment" id="2250575">//&nbsp;&nbsp;&nbsp;&nbspatanh(NaN)&nbsp;is&nbsp;that&nbsp;NaN&nbsp;with&nbsp;no&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2250617">//&nbsp;&nbsp;&nbsp;&nbspatanh(+-1)&nbsp;is&nbsp;+-INF&nbsp;with&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2250653">//</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2250657">//&nbsp;Atanh&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">40</span><span class="comment" id="2250711">//</span><br>
<span class="lineno"></span><span class="comment" id="2250714">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2250736">//&nbsp;&nbsp;&nbsp;&nbspAtanh(1)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2250755">//&nbsp;&nbsp;&nbsp;&nbspAtanh(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2250775">//&nbsp;&nbsp;&nbsp;&nbspAtanh(-1)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno">45</span><span class="comment" id="2250795">//&nbsp;&nbsp;&nbsp;&nbspAtanh(x)&nbsp;=&nbsp;NaN&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-1&nbsp;or&nbsp;x&nbsp;&gt;&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2250832">//&nbsp;&nbsp;&nbsp;&nbspAtanh(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2250852">func</span>&nbsp;<span class="ident" id="2250857">Atanh</span><span class="op" id="2250862">(</span><span class="ident" id="2250863">x</span>&nbsp;<span class="builtintype" id="2250865">float64</span><span class="op" id="2250872">)</span>&nbsp;<span class="builtintype" id="2250874">float64</span>&nbsp;<span class="op" id="2250882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250885">const</span>&nbsp;<span class="ident" id="2250891">NearZero</span>&nbsp;<span class="op" id="2250900">=</span>&nbsp;<span class="num" id="2250902">1.0</span>&nbsp;<span class="op" id="2250906">/</span>&nbsp;<span class="op" id="2250908">(</span><span class="num" id="2250909">1</span>&nbsp;<span class="op" id="2250911">&lt;&lt;</span>&nbsp;<span class="num" id="2250914">28</span><span class="op" id="2250916">)</span>&nbsp;<span class="comment" id="2250918">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2250929">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250947">switch</span>&nbsp;<span class="op" id="2250954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250957">case</span>&nbsp;<span class="ident" id="2250962"><a href="/math/atanh.go.html#2250863">x</a></span>&nbsp;<span class="op" id="2250964">&lt;</span>&nbsp;<span class="op" id="2250966">-</span><span class="num" id="2250967">1</span>&nbsp;<span class="op" id="2250969">||</span>&nbsp;<span class="ident" id="2250972"><a href="/math/atanh.go.html#2250863">x</a></span>&nbsp;<span class="op" id="2250974">&gt;</span>&nbsp;<span class="num" id="2250976">1</span>&nbsp;<span class="op" id="2250978">||</span>&nbsp;<span class="ident" id="2250981"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2250986">(</span><span class="ident" id="2250987"><a href="/math/atanh.go.html#2250863">x</a></span><span class="op" id="2250988">)</span><span class="op" id="2250989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250993">return</span>&nbsp;<span class="ident" id="2251000"><a href="/math/bits.go.html#2251945">NaN</a></span><span class="op" id="2251003">(</span><span class="op" id="2251004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251007">case</span>&nbsp;<span class="ident" id="2251012"><a href="/math/atanh.go.html#2250863">x</a></span>&nbsp;<span class="op" id="2251014">==</span>&nbsp;<span class="num" id="2251017">1</span><span class="op" id="2251018">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251022">return</span>&nbsp;<span class="ident" id="2251029"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2251032">(</span><span class="num" id="2251033">1</span><span class="op" id="2251034">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251037">case</span>&nbsp;<span class="ident" id="2251042"><a href="/math/atanh.go.html#2250863">x</a></span>&nbsp;<span class="op" id="2251044">==</span>&nbsp;<span class="op" id="2251047">-</span><span class="num" id="2251048">1</span><span class="op" id="2251049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251053">return</span>&nbsp;<span class="ident" id="2251060"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2251063">(</span><span class="op" id="2251064">-</span><span class="num" id="2251065">1</span><span class="op" id="2251066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2251072">sign</span>&nbsp;<span class="op" id="2251077">:=</span>&nbsp;<span class="builtintype" id="2251080">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251087">if</span>&nbsp;<span class="ident" id="2251090"><a href="/math/atanh.go.html#2250863">x</a></span>&nbsp;<span class="op" id="2251092">&lt;</span>&nbsp;<span class="num" id="2251094">0</span>&nbsp;<span class="op" id="2251096">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2251100"><a href="/math/atanh.go.html#2250863">x</a></span>&nbsp;<span class="op" id="2251102">=</span>&nbsp;<span class="op" id="2251104">-</span><span class="ident" id="2251105"><a href="/math/atanh.go.html#2250863">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2251109"><a href="/math/atanh.go.html#2251072">sign</a></span>&nbsp;<span class="op" id="2251114">=</span>&nbsp;<span class="builtintype" id="2251116">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251125">var</span>&nbsp;<span class="ident" id="2251129">temp</span>&nbsp;<span class="builtintype" id="2251134">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251143">switch</span>&nbsp;<span class="op" id="2251150">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251153">case</span>&nbsp;<span class="ident" id="2251158"><a href="/math/atanh.go.html#2250863">x</a></span>&nbsp;<span class="op" id="2251160">&lt;</span>&nbsp;<span class="ident" id="2251162"><a href="/math/atanh.go.html#2250891">NearZero</a></span><span class="op" id="2251170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2251174"><a href="/math/atanh.go.html#2251129">temp</a></span>&nbsp;<span class="op" id="2251179">=</span>&nbsp;<span class="ident" id="2251181"><a href="/math/atanh.go.html#2250863">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251184">case</span>&nbsp;<span class="ident" id="2251189"><a href="/math/atanh.go.html#2250863">x</a></span>&nbsp;<span class="op" id="2251191">&lt;</span>&nbsp;<span class="num" id="2251193">0.5</span><span class="op" id="2251196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2251200"><a href="/math/atanh.go.html#2251129">temp</a></span>&nbsp;<span class="op" id="2251205">=</span>&nbsp;<span class="ident" id="2251207"><a href="/math/atanh.go.html#2250863">x</a></span>&nbsp;<span class="op" id="2251209">+</span>&nbsp;<span class="ident" id="2251211"><a href="/math/atanh.go.html#2250863">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2251215"><a href="/math/atanh.go.html#2251129">temp</a></span>&nbsp;<span class="op" id="2251220">=</span>&nbsp;<span class="num" id="2251222">0.5</span>&nbsp;<span class="op" id="2251226">*</span>&nbsp;<span class="ident" id="2251228"><a href="/math/log1p.go.html#2346745">Log1p</a></span><span class="op" id="2251233">(</span><span class="ident" id="2251234"><a href="/math/atanh.go.html#2251129">temp</a></span><span class="op" id="2251238">+</span><span class="ident" id="2251239"><a href="/math/atanh.go.html#2251129">temp</a></span><span class="op" id="2251243">*</span><span class="ident" id="2251244"><a href="/math/atanh.go.html#2250863">x</a></span><span class="op" id="2251245">/</span><span class="op" id="2251246">(</span><span class="num" id="2251247">1</span><span class="op" id="2251248">-</span><span class="ident" id="2251249"><a href="/math/atanh.go.html#2250863">x</a></span><span class="op" id="2251250">)</span><span class="op" id="2251251">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251254">default</span><span class="op" id="2251261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2251265"><a href="/math/atanh.go.html#2251129">temp</a></span>&nbsp;<span class="op" id="2251270">=</span>&nbsp;<span class="num" id="2251272">0.5</span>&nbsp;<span class="op" id="2251276">*</span>&nbsp;<span class="ident" id="2251278"><a href="/math/log1p.go.html#2346745">Log1p</a></span><span class="op" id="2251283">(</span><span class="op" id="2251284">(</span><span class="ident" id="2251285"><a href="/math/atanh.go.html#2250863">x</a></span><span class="op" id="2251286">+</span><span class="ident" id="2251287"><a href="/math/atanh.go.html#2250863">x</a></span><span class="op" id="2251288">)</span><span class="op" id="2251289">/</span><span class="op" id="2251290">(</span><span class="num" id="2251291">1</span><span class="op" id="2251292">-</span><span class="ident" id="2251293"><a href="/math/atanh.go.html#2250863">x</a></span><span class="op" id="2251294">)</span><span class="op" id="2251295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251301">if</span>&nbsp;<span class="ident" id="2251304"><a href="/math/atanh.go.html#2251072">sign</a></span>&nbsp;<span class="op" id="2251309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2251313"><a href="/math/atanh.go.html#2251129">temp</a></span>&nbsp;<span class="op" id="2251318">=</span>&nbsp;<span class="op" id="2251320">-</span><span class="ident" id="2251321"><a href="/math/atanh.go.html#2251129">temp</a></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251330">return</span>&nbsp;<span class="ident" id="2251337"><a href="/math/atanh.go.html#2251129">temp</a></span><br>
<span class="lineno"></span><span class="op" id="2251342">}</span>
</div>
</body>
</html>
