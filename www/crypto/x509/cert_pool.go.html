<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4284190">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4284245">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4284299">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4284350">package</span>&nbsp;<span class="ident" id="4284358">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4284364">import</span>&nbsp;<span class="op" id="4284371">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4284374">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span><span class="op" id="4284389">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4284392">//&nbsp;CertPool&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4284430">type</span>&nbsp;<span class="ident" id="4284435">CertPool</span>&nbsp;<span class="keyword" id="4284444">struct</span>&nbsp;<span class="op" id="4284451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284454">bySubjectKeyId</span>&nbsp;<span class="keyword" id="4284469">map</span><span class="op" id="4284472">[</span><span class="builtintype" id="4284473">string</span><span class="op" id="4284479">]</span><span class="op" id="4284480">[</span><span class="op" id="4284481">]</span><span class="builtintype" id="4284482">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284487">byName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4284502">map</span><span class="op" id="4284505">[</span><span class="builtintype" id="4284506">string</span><span class="op" id="4284512">]</span><span class="op" id="4284513">[</span><span class="op" id="4284514">]</span><span class="builtintype" id="4284515">int</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284520">certs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4284535">[</span><span class="op" id="4284536">]</span><span class="op" id="4284537">*</span><span class="ident" id="4284538"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><br>
<span class="lineno"></span><span class="op" id="4284550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4284553">//&nbsp;NewCertPool&nbsp;returns&nbsp;a&nbsp;new,&nbsp;empty&nbsp;CertPool.</span><br>
<span class="lineno"></span><span class="keyword" id="4284599">func</span>&nbsp;<span class="ident" id="4284604">NewCertPool</span><span class="op" id="4284615">(</span><span class="op" id="4284616">)</span>&nbsp;<span class="op" id="4284618">*</span><span class="ident" id="4284619"><a href="/crypto/x509/cert_pool.go.html#4284435">CertPool</a></span>&nbsp;<span class="op" id="4284628">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4284631">return</span>&nbsp;<span class="op" id="4284638">&amp;</span><span class="ident" id="4284639"><a href="/crypto/x509/cert_pool.go.html#4284435">CertPool</a></span><span class="op" id="4284647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4284651">make</span><span class="op" id="4284655">(</span><span class="keyword" id="4284656">map</span><span class="op" id="4284659">[</span><span class="builtintype" id="4284660">string</span><span class="op" id="4284666">]</span><span class="op" id="4284667">[</span><span class="op" id="4284668">]</span><span class="builtintype" id="4284669">int</span><span class="op" id="4284672">)</span><span class="op" id="4284673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4284677">make</span><span class="op" id="4284681">(</span><span class="keyword" id="4284682">map</span><span class="op" id="4284685">[</span><span class="builtintype" id="4284686">string</span><span class="op" id="4284692">]</span><span class="op" id="4284693">[</span><span class="op" id="4284694">]</span><span class="builtintype" id="4284695">int</span><span class="op" id="4284698">)</span><span class="op" id="4284699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284703">nil</span><span class="op" id="4284706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4284709">}</span><br>
<span class="lineno">25</span><span class="op" id="4284711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4284714">//&nbsp;findVerifiedParents&nbsp;attempts&nbsp;to&nbsp;find&nbsp;certificates&nbsp;in&nbsp;s&nbsp;which&nbsp;have&nbsp;signed&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4284794">//&nbsp;given&nbsp;certificate.&nbsp;If&nbsp;any&nbsp;candidates&nbsp;were&nbsp;rejected&nbsp;then&nbsp;errCert&nbsp;will&nbsp;be&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="4284873">//&nbsp;to&nbsp;one&nbsp;of&nbsp;them,&nbsp;arbitrarily,&nbsp;and&nbsp;err&nbsp;will&nbsp;contain&nbsp;the&nbsp;reason&nbsp;that&nbsp;it&nbsp;was</span><br>
<span class="lineno">30</span><span class="comment" id="4284949">//&nbsp;rejected.</span><br>
<span class="lineno"></span><span class="keyword" id="4284962">func</span>&nbsp;<span class="op" id="4284967">(</span><span class="ident" id="4284968">s</span>&nbsp;<span class="op" id="4284970">*</span><span class="ident" id="4284971"><a href="/crypto/x509/cert_pool.go.html#4284435">CertPool</a></span><span class="op" id="4284979">)</span>&nbsp;<span class="ident" id="4284981">findVerifiedParents</span><span class="op" id="4285000">(</span><span class="ident" id="4285001">cert</span>&nbsp;<span class="op" id="4285006">*</span><span class="ident" id="4285007"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4285018">)</span>&nbsp;<span class="op" id="4285020">(</span><span class="ident" id="4285021">parents</span>&nbsp;<span class="op" id="4285029">[</span><span class="op" id="4285030">]</span><span class="builtintype" id="4285031">int</span><span class="op" id="4285034">,</span>&nbsp;<span class="ident" id="4285036">errCert</span>&nbsp;<span class="op" id="4285044">*</span><span class="ident" id="4285045"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4285056">,</span>&nbsp;<span class="ident" id="4285058">err</span>&nbsp;<span class="builtintype" id="4285062">error</span><span class="op" id="4285067">)</span>&nbsp;<span class="op" id="4285069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285072">if</span>&nbsp;<span class="ident" id="4285075"><a href="/crypto/x509/cert_pool.go.html#4284968">s</a></span>&nbsp;<span class="op" id="4285077">==</span>&nbsp;<span class="ident" id="4285080">nil</span>&nbsp;<span class="op" id="4285084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285088">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4285096">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285099">var</span>&nbsp;<span class="ident" id="4285103">candidates</span>&nbsp;<span class="op" id="4285114">[</span><span class="op" id="4285115">]</span><span class="builtintype" id="4285116">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285122">if</span>&nbsp;<span class="builtinfunc" id="4285125">len</span><span class="op" id="4285128">(</span><span class="ident" id="4285129"><a href="/crypto/x509/cert_pool.go.html#4285001">cert</a></span><span class="op" id="4285133">.</span><span class="ident" id="4285134">AuthorityKeyId</span><span class="op" id="4285148">)</span>&nbsp;<span class="op" id="4285150">&gt;</span>&nbsp;<span class="num" id="4285152">0</span>&nbsp;<span class="op" id="4285154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285158"><a href="/crypto/x509/cert_pool.go.html#4285103">candidates</a></span>&nbsp;<span class="op" id="4285169">=</span>&nbsp;<span class="ident" id="4285171"><a href="/crypto/x509/cert_pool.go.html#4284968">s</a></span><span class="op" id="4285172">.</span><span class="ident" id="4285173">bySubjectKeyId</span><span class="op" id="4285187">[</span><span class="builtintype" id="4285188">string</span><span class="op" id="4285194">(</span><span class="ident" id="4285195"><a href="/crypto/x509/cert_pool.go.html#4285001">cert</a></span><span class="op" id="4285199">.</span><span class="ident" id="4285200">AuthorityKeyId</span><span class="op" id="4285214">)</span><span class="op" id="4285215">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4285218">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285221">if</span>&nbsp;<span class="builtinfunc" id="4285224">len</span><span class="op" id="4285227">(</span><span class="ident" id="4285228"><a href="/crypto/x509/cert_pool.go.html#4285103">candidates</a></span><span class="op" id="4285238">)</span>&nbsp;<span class="op" id="4285240">==</span>&nbsp;<span class="num" id="4285243">0</span>&nbsp;<span class="op" id="4285245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285249"><a href="/crypto/x509/cert_pool.go.html#4285103">candidates</a></span>&nbsp;<span class="op" id="4285260">=</span>&nbsp;<span class="ident" id="4285262"><a href="/crypto/x509/cert_pool.go.html#4284968">s</a></span><span class="op" id="4285263">.</span><span class="ident" id="4285264">byName</span><span class="op" id="4285270">[</span><span class="builtintype" id="4285271">string</span><span class="op" id="4285277">(</span><span class="ident" id="4285278"><a href="/crypto/x509/cert_pool.go.html#4285001">cert</a></span><span class="op" id="4285282">.</span><span class="ident" id="4285283">RawIssuer</span><span class="op" id="4285292">)</span><span class="op" id="4285293">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4285296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285300">for</span>&nbsp;<span class="ident" id="4285304">_</span><span class="op" id="4285305">,</span>&nbsp;<span class="ident" id="4285307">c</span>&nbsp;<span class="op" id="4285309">:=</span>&nbsp;<span class="keyword" id="4285312">range</span>&nbsp;<span class="ident" id="4285318"><a href="/crypto/x509/cert_pool.go.html#4285103">candidates</a></span>&nbsp;<span class="op" id="4285329">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285333">if</span>&nbsp;<span class="ident" id="4285336"><a href="/crypto/x509/cert_pool.go.html#4285058">err</a></span>&nbsp;<span class="op" id="4285340">=</span>&nbsp;<span class="ident" id="4285342"><a href="/crypto/x509/cert_pool.go.html#4285001">cert</a></span><span class="op" id="4285346">.</span><span class="ident" id="4285347">CheckSignatureFrom</span><span class="op" id="4285365">(</span><span class="ident" id="4285366"><a href="/crypto/x509/cert_pool.go.html#4284968">s</a></span><span class="op" id="4285367">.</span><span class="ident" id="4285368">certs</span><span class="op" id="4285373">[</span><span class="ident" id="4285374"><a href="/crypto/x509/cert_pool.go.html#4285307">c</a></span><span class="op" id="4285375">]</span><span class="op" id="4285376">)</span><span class="op" id="4285377">;</span>&nbsp;<span class="ident" id="4285379"><a href="/crypto/x509/cert_pool.go.html#4285058">err</a></span>&nbsp;<span class="op" id="4285383">==</span>&nbsp;<span class="ident" id="4285386">nil</span>&nbsp;<span class="op" id="4285390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285395"><a href="/crypto/x509/cert_pool.go.html#4285021">parents</a></span>&nbsp;<span class="op" id="4285403">=</span>&nbsp;<span class="builtinfunc" id="4285405">append</span><span class="op" id="4285411">(</span><span class="ident" id="4285412"><a href="/crypto/x509/cert_pool.go.html#4285021">parents</a></span><span class="op" id="4285419">,</span>&nbsp;<span class="ident" id="4285421"><a href="/crypto/x509/cert_pool.go.html#4285307">c</a></span><span class="op" id="4285422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4285426">}</span>&nbsp;<span class="keyword" id="4285428">else</span>&nbsp;<span class="op" id="4285433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285438"><a href="/crypto/x509/cert_pool.go.html#4285036">errCert</a></span>&nbsp;<span class="op" id="4285446">=</span>&nbsp;<span class="ident" id="4285448"><a href="/crypto/x509/cert_pool.go.html#4284968">s</a></span><span class="op" id="4285449">.</span><span class="ident" id="4285450">certs</span><span class="op" id="4285455">[</span><span class="ident" id="4285456"><a href="/crypto/x509/cert_pool.go.html#4285307">c</a></span><span class="op" id="4285457">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4285461">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4285464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285468">return</span><br>
<span class="lineno"></span><span class="op" id="4285475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="4285478">//&nbsp;AddCert&nbsp;adds&nbsp;a&nbsp;certificate&nbsp;to&nbsp;a&nbsp;pool.</span><br>
<span class="lineno"></span><span class="keyword" id="4285519">func</span>&nbsp;<span class="op" id="4285524">(</span><span class="ident" id="4285525">s</span>&nbsp;<span class="op" id="4285527">*</span><span class="ident" id="4285528"><a href="/crypto/x509/cert_pool.go.html#4284435">CertPool</a></span><span class="op" id="4285536">)</span>&nbsp;<span class="ident" id="4285538">AddCert</span><span class="op" id="4285545">(</span><span class="ident" id="4285546">cert</span>&nbsp;<span class="op" id="4285551">*</span><span class="ident" id="4285552"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4285563">)</span>&nbsp;<span class="op" id="4285565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285568">if</span>&nbsp;<span class="ident" id="4285571"><a href="/crypto/x509/cert_pool.go.html#4285546">cert</a></span>&nbsp;<span class="op" id="4285576">==</span>&nbsp;<span class="ident" id="4285579">nil</span>&nbsp;<span class="op" id="4285583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4285587">panic</span><span class="op" id="4285592">(</span><span class="string" id="4285593">&#34;adding&nbsp;nil&nbsp;Certificate&nbsp;to&nbsp;CertPool&#34;</span><span class="op" id="4285629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4285632">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4285636">//&nbsp;Check&nbsp;that&nbsp;the&nbsp;certificate&nbsp;isn&#39;t&nbsp;being&nbsp;added&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285692">for</span>&nbsp;<span class="ident" id="4285696">_</span><span class="op" id="4285697">,</span>&nbsp;<span class="ident" id="4285699">c</span>&nbsp;<span class="op" id="4285701">:=</span>&nbsp;<span class="keyword" id="4285704">range</span>&nbsp;<span class="ident" id="4285710"><a href="/crypto/x509/cert_pool.go.html#4285525">s</a></span><span class="op" id="4285711">.</span><span class="ident" id="4285712">certs</span>&nbsp;<span class="op" id="4285718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285722">if</span>&nbsp;<span class="ident" id="4285725"><a href="/crypto/x509/cert_pool.go.html#4285699">c</a></span><span class="op" id="4285726">.</span><span class="ident" id="4285727">Equal</span><span class="op" id="4285732">(</span><span class="ident" id="4285733"><a href="/crypto/x509/cert_pool.go.html#4285546">cert</a></span><span class="op" id="4285737">)</span>&nbsp;<span class="op" id="4285739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285744">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4285753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4285756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285760">n</span>&nbsp;<span class="op" id="4285762">:=</span>&nbsp;<span class="builtinfunc" id="4285765">len</span><span class="op" id="4285768">(</span><span class="ident" id="4285769"><a href="/crypto/x509/cert_pool.go.html#4285525">s</a></span><span class="op" id="4285770">.</span><span class="ident" id="4285771">certs</span><span class="op" id="4285776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285779"><a href="/crypto/x509/cert_pool.go.html#4285525">s</a></span><span class="op" id="4285780">.</span><span class="ident" id="4285781">certs</span>&nbsp;<span class="op" id="4285787">=</span>&nbsp;<span class="builtinfunc" id="4285789">append</span><span class="op" id="4285795">(</span><span class="ident" id="4285796"><a href="/crypto/x509/cert_pool.go.html#4285525">s</a></span><span class="op" id="4285797">.</span><span class="ident" id="4285798">certs</span><span class="op" id="4285803">,</span>&nbsp;<span class="ident" id="4285805"><a href="/crypto/x509/cert_pool.go.html#4285546">cert</a></span><span class="op" id="4285809">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285813">if</span>&nbsp;<span class="builtinfunc" id="4285816">len</span><span class="op" id="4285819">(</span><span class="ident" id="4285820"><a href="/crypto/x509/cert_pool.go.html#4285546">cert</a></span><span class="op" id="4285824">.</span><span class="ident" id="4285825">SubjectKeyId</span><span class="op" id="4285837">)</span>&nbsp;<span class="op" id="4285839">&gt;</span>&nbsp;<span class="num" id="4285841">0</span>&nbsp;<span class="op" id="4285843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285847">keyId</span>&nbsp;<span class="op" id="4285853">:=</span>&nbsp;<span class="builtintype" id="4285856">string</span><span class="op" id="4285862">(</span><span class="ident" id="4285863"><a href="/crypto/x509/cert_pool.go.html#4285546">cert</a></span><span class="op" id="4285867">.</span><span class="ident" id="4285868">SubjectKeyId</span><span class="op" id="4285880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285884"><a href="/crypto/x509/cert_pool.go.html#4285525">s</a></span><span class="op" id="4285885">.</span><span class="ident" id="4285886">bySubjectKeyId</span><span class="op" id="4285900">[</span><span class="ident" id="4285901"><a href="/crypto/x509/cert_pool.go.html#4285847">keyId</a></span><span class="op" id="4285906">]</span>&nbsp;<span class="op" id="4285908">=</span>&nbsp;<span class="builtinfunc" id="4285910">append</span><span class="op" id="4285916">(</span><span class="ident" id="4285917"><a href="/crypto/x509/cert_pool.go.html#4285525">s</a></span><span class="op" id="4285918">.</span><span class="ident" id="4285919">bySubjectKeyId</span><span class="op" id="4285933">[</span><span class="ident" id="4285934"><a href="/crypto/x509/cert_pool.go.html#4285847">keyId</a></span><span class="op" id="4285939">]</span><span class="op" id="4285940">,</span>&nbsp;<span class="ident" id="4285942"><a href="/crypto/x509/cert_pool.go.html#4285760">n</a></span><span class="op" id="4285943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4285946">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285949">name</span>&nbsp;<span class="op" id="4285954">:=</span>&nbsp;<span class="builtintype" id="4285957">string</span><span class="op" id="4285963">(</span><span class="ident" id="4285964"><a href="/crypto/x509/cert_pool.go.html#4285546">cert</a></span><span class="op" id="4285968">.</span><span class="ident" id="4285969">RawSubject</span><span class="op" id="4285979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4285982"><a href="/crypto/x509/cert_pool.go.html#4285525">s</a></span><span class="op" id="4285983">.</span><span class="ident" id="4285984">byName</span><span class="op" id="4285990">[</span><span class="ident" id="4285991"><a href="/crypto/x509/cert_pool.go.html#4285949">name</a></span><span class="op" id="4285995">]</span>&nbsp;<span class="op" id="4285997">=</span>&nbsp;<span class="builtinfunc" id="4285999">append</span><span class="op" id="4286005">(</span><span class="ident" id="4286006"><a href="/crypto/x509/cert_pool.go.html#4285525">s</a></span><span class="op" id="4286007">.</span><span class="ident" id="4286008">byName</span><span class="op" id="4286014">[</span><span class="ident" id="4286015"><a href="/crypto/x509/cert_pool.go.html#4285949">name</a></span><span class="op" id="4286019">]</span><span class="op" id="4286020">,</span>&nbsp;<span class="ident" id="4286022"><a href="/crypto/x509/cert_pool.go.html#4285760">n</a></span><span class="op" id="4286023">)</span><br>
<span class="lineno"></span><span class="op" id="4286025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4286028">//&nbsp;AppendCertsFromPEM&nbsp;attempts&nbsp;to&nbsp;parse&nbsp;a&nbsp;series&nbsp;of&nbsp;PEM&nbsp;encoded&nbsp;certificates.</span><br>
<span class="lineno">80</span><span class="comment" id="4286106">//&nbsp;It&nbsp;appends&nbsp;any&nbsp;certificates&nbsp;found&nbsp;to&nbsp;s&nbsp;and&nbsp;returns&nbsp;true&nbsp;if&nbsp;any&nbsp;certificates</span><br>
<span class="lineno"></span><span class="comment" id="4286185">//&nbsp;were&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="4286214">//</span><br>
<span class="lineno"></span><span class="comment" id="4286217">//&nbsp;On&nbsp;many&nbsp;Linux&nbsp;systems,&nbsp;/etc/ssl/cert.pem&nbsp;will&nbsp;contain&nbsp;the&nbsp;system&nbsp;wide&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="4286294">//&nbsp;of&nbsp;root&nbsp;CAs&nbsp;in&nbsp;a&nbsp;format&nbsp;suitable&nbsp;for&nbsp;this&nbsp;function.</span><br>
<span class="lineno">85</span><span class="keyword" id="4286349">func</span>&nbsp;<span class="op" id="4286354">(</span><span class="ident" id="4286355">s</span>&nbsp;<span class="op" id="4286357">*</span><span class="ident" id="4286358"><a href="/crypto/x509/cert_pool.go.html#4284435">CertPool</a></span><span class="op" id="4286366">)</span>&nbsp;<span class="ident" id="4286368">AppendCertsFromPEM</span><span class="op" id="4286386">(</span><span class="ident" id="4286387">pemCerts</span>&nbsp;<span class="op" id="4286396">[</span><span class="op" id="4286397">]</span><span class="builtintype" id="4286398">byte</span><span class="op" id="4286402">)</span>&nbsp;<span class="op" id="4286404">(</span><span class="ident" id="4286405">ok</span>&nbsp;<span class="builtintype" id="4286408">bool</span><span class="op" id="4286412">)</span>&nbsp;<span class="op" id="4286414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286417">for</span>&nbsp;<span class="builtinfunc" id="4286421">len</span><span class="op" id="4286424">(</span><span class="ident" id="4286425"><a href="/crypto/x509/cert_pool.go.html#4286387">pemCerts</a></span><span class="op" id="4286433">)</span>&nbsp;<span class="op" id="4286435">&gt;</span>&nbsp;<span class="num" id="4286437">0</span>&nbsp;<span class="op" id="4286439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286443">var</span>&nbsp;<span class="ident" id="4286447">block</span>&nbsp;<span class="op" id="4286453">*</span><span class="ident" id="4286454"><a href="/crypto/x509/cert_pool.go.html#4284374">pem</a></span><span class="op" id="4286457">.</span><span class="ident" id="4286458">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286466"><a href="/crypto/x509/cert_pool.go.html#4286447">block</a></span><span class="op" id="4286471">,</span>&nbsp;<span class="ident" id="4286473"><a href="/crypto/x509/cert_pool.go.html#4286387">pemCerts</a></span>&nbsp;<span class="op" id="4286482">=</span>&nbsp;<span class="ident" id="4286484"><a href="/crypto/x509/cert_pool.go.html#4284374">pem</a></span><span class="op" id="4286487">.</span><span class="ident" id="4286488">Decode</span><span class="op" id="4286494">(</span><span class="ident" id="4286495"><a href="/crypto/x509/cert_pool.go.html#4286387">pemCerts</a></span><span class="op" id="4286503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286507">if</span>&nbsp;<span class="ident" id="4286510"><a href="/crypto/x509/cert_pool.go.html#4286447">block</a></span>&nbsp;<span class="op" id="4286516">==</span>&nbsp;<span class="ident" id="4286519">nil</span>&nbsp;<span class="op" id="4286523">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286528">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4286536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286540">if</span>&nbsp;<span class="ident" id="4286543"><a href="/crypto/x509/cert_pool.go.html#4286447">block</a></span><span class="op" id="4286548">.</span><span class="ident" id="4286549">Type</span>&nbsp;<span class="op" id="4286554">!=</span>&nbsp;<span class="string" id="4286557">&#34;CERTIFICATE&#34;</span>&nbsp;<span class="op" id="4286571">||</span>&nbsp;<span class="builtinfunc" id="4286574">len</span><span class="op" id="4286577">(</span><span class="ident" id="4286578"><a href="/crypto/x509/cert_pool.go.html#4286447">block</a></span><span class="op" id="4286583">.</span><span class="ident" id="4286584">Headers</span><span class="op" id="4286591">)</span>&nbsp;<span class="op" id="4286593">!=</span>&nbsp;<span class="num" id="4286596">0</span>&nbsp;<span class="op" id="4286598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286603">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4286614">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286619">cert</span><span class="op" id="4286623">,</span>&nbsp;<span class="ident" id="4286625">err</span>&nbsp;<span class="op" id="4286629">:=</span>&nbsp;<span class="ident" id="4286632"><a href="/crypto/x509/x509.go.html#4350518">ParseCertificate</a></span><span class="op" id="4286648">(</span><span class="ident" id="4286649"><a href="/crypto/x509/cert_pool.go.html#4286447">block</a></span><span class="op" id="4286654">.</span><span class="ident" id="4286655">Bytes</span><span class="op" id="4286660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286664">if</span>&nbsp;<span class="ident" id="4286667"><a href="/crypto/x509/cert_pool.go.html#4286625">err</a></span>&nbsp;<span class="op" id="4286671">!=</span>&nbsp;<span class="ident" id="4286674">nil</span>&nbsp;<span class="op" id="4286678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286683">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4286694">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286699"><a href="/crypto/x509/cert_pool.go.html#4286355">s</a></span><span class="op" id="4286700">.</span><span class="ident" id="4286701">AddCert</span><span class="op" id="4286708">(</span><span class="ident" id="4286709"><a href="/crypto/x509/cert_pool.go.html#4286619">cert</a></span><span class="op" id="4286713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286717"><a href="/crypto/x509/cert_pool.go.html#4286405">ok</a></span>&nbsp;<span class="op" id="4286720">=</span>&nbsp;<span class="ident" id="4286722">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4286728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286732">return</span><br>
<span class="lineno"></span><span class="op" id="4286739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4286742">//&nbsp;Subjects&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;the&nbsp;DER-encoded&nbsp;subjects&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4286800">//&nbsp;all&nbsp;of&nbsp;the&nbsp;certificates&nbsp;in&nbsp;the&nbsp;pool.</span><br>
<span class="lineno">110</span><span class="keyword" id="4286840">func</span>&nbsp;<span class="op" id="4286845">(</span><span class="ident" id="4286846">s</span>&nbsp;<span class="op" id="4286848">*</span><span class="ident" id="4286849"><a href="/crypto/x509/cert_pool.go.html#4284435">CertPool</a></span><span class="op" id="4286857">)</span>&nbsp;<span class="ident" id="4286859">Subjects</span><span class="op" id="4286867">(</span><span class="op" id="4286868">)</span>&nbsp;<span class="op" id="4286870">(</span><span class="ident" id="4286871">res</span>&nbsp;<span class="op" id="4286875">[</span><span class="op" id="4286876">]</span><span class="op" id="4286877">[</span><span class="op" id="4286878">]</span><span class="builtintype" id="4286879">byte</span><span class="op" id="4286883">)</span>&nbsp;<span class="op" id="4286885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286888"><a href="/crypto/x509/cert_pool.go.html#4286871">res</a></span>&nbsp;<span class="op" id="4286892">=</span>&nbsp;<span class="builtinfunc" id="4286894">make</span><span class="op" id="4286898">(</span><span class="op" id="4286899">[</span><span class="op" id="4286900">]</span><span class="op" id="4286901">[</span><span class="op" id="4286902">]</span><span class="builtintype" id="4286903">byte</span><span class="op" id="4286907">,</span>&nbsp;<span class="builtinfunc" id="4286909">len</span><span class="op" id="4286912">(</span><span class="ident" id="4286913"><a href="/crypto/x509/cert_pool.go.html#4286846">s</a></span><span class="op" id="4286914">.</span><span class="ident" id="4286915">certs</span><span class="op" id="4286920">)</span><span class="op" id="4286921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286924">for</span>&nbsp;<span class="ident" id="4286928">i</span><span class="op" id="4286929">,</span>&nbsp;<span class="ident" id="4286931">c</span>&nbsp;<span class="op" id="4286933">:=</span>&nbsp;<span class="keyword" id="4286936">range</span>&nbsp;<span class="ident" id="4286942"><a href="/crypto/x509/cert_pool.go.html#4286846">s</a></span><span class="op" id="4286943">.</span><span class="ident" id="4286944">certs</span>&nbsp;<span class="op" id="4286950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4286954"><a href="/crypto/x509/cert_pool.go.html#4286871">res</a></span><span class="op" id="4286957">[</span><span class="ident" id="4286958"><a href="/crypto/x509/cert_pool.go.html#4286928">i</a></span><span class="op" id="4286959">]</span>&nbsp;<span class="op" id="4286961">=</span>&nbsp;<span class="ident" id="4286963"><a href="/crypto/x509/cert_pool.go.html#4286931">c</a></span><span class="op" id="4286964">.</span><span class="ident" id="4286965">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4286977">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4286980">return</span><br>
<span class="lineno"></span><span class="op" id="4286987">}</span>
</div>
</body>
</html>
