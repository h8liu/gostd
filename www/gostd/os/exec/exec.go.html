<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5209424">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5209479">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5209533">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5209584">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5209660">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="5209734">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="5209750">package</span>&nbsp;<span class="ident" id="5209758">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5209764">import</span>&nbsp;<span class="op" id="5209771">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5209774">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5209783">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5209793">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5209799">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5209805">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5209822">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5209833">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5209844">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5209855">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5209863">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="5209873">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5209876">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="5209941">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="5209970">type</span>&nbsp;<span class="ident" id="5209975">Error</span>&nbsp;<span class="keyword" id="5209981">struct</span>&nbsp;<span class="op" id="5209988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209991">Name</span>&nbsp;<span class="builtintype" id="5209996">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210004">Err</span>&nbsp;&nbsp;<span class="builtintype" id="5210009">error</span><br>
<span class="lineno"></span><span class="op" id="5210015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="5210018">func</span>&nbsp;<span class="op" id="5210023">(</span><span class="ident" id="5210024">e</span>&nbsp;<span class="op" id="5210026">*</span><span class="ident" id="5210027">Error</span><span class="op" id="5210032">)</span>&nbsp;<span class="ident" id="5210034">Error</span><span class="op" id="5210039">(</span><span class="op" id="5210040">)</span>&nbsp;<span class="builtintype" id="5210042">string</span>&nbsp;<span class="op" id="5210049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210052">return</span>&nbsp;<span class="string" id="5210059">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="5210068">+</span>&nbsp;<span class="ident" id="5210070">strconv</span><span class="op" id="5210077">.</span><span class="ident" id="5210078">Quote</span><span class="op" id="5210083">(</span><span class="ident" id="5210084">e</span><span class="op" id="5210085">.</span><span class="ident" id="5210086">Name</span><span class="op" id="5210090">)</span>&nbsp;<span class="op" id="5210092">+</span>&nbsp;<span class="string" id="5210094">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="5210099">+</span>&nbsp;<span class="ident" id="5210101">e</span><span class="op" id="5210102">.</span><span class="ident" id="5210103">Err</span><span class="op" id="5210106">.</span><span class="ident" id="5210107">Error</span><span class="op" id="5210112">(</span><span class="op" id="5210113">)</span><br>
<span class="lineno"></span><span class="op" id="5210115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5210118">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="5210179">type</span>&nbsp;<span class="ident" id="5210184">Cmd</span>&nbsp;<span class="keyword" id="5210188">struct</span>&nbsp;<span class="op" id="5210195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210198">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210242">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210246">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210304">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210361">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210373">Path</span>&nbsp;<span class="builtintype" id="5210378">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210387">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210460">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210516">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210520">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210587">Args</span>&nbsp;<span class="op" id="5210592">[</span><span class="op" id="5210593">]</span><span class="builtintype" id="5210594">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210603">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210653">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210716">Env</span>&nbsp;<span class="op" id="5210720">[</span><span class="op" id="5210721">]</span><span class="builtintype" id="5210722">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210731">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210787">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210847">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210888">Dir</span>&nbsp;<span class="builtintype" id="5210892">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210901">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210951">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211025">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211096">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211123">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211185">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211254">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211328">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211394">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211470">Stdin</span>&nbsp;<span class="ident" id="5211476">io</span><span class="op" id="5211478">.</span><span class="ident" id="5211479">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211488">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211559">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211563">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211632">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211669">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211673">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211731">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211772">Stdout</span>&nbsp;<span class="ident" id="5211779">io</span><span class="op" id="5211781">.</span><span class="ident" id="5211782">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211790">Stderr</span>&nbsp;<span class="ident" id="5211797">io</span><span class="op" id="5211799">.</span><span class="ident" id="5211800">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211809">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211879">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211952">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212021">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212025">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212100">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212133">ExtraFiles</span>&nbsp;<span class="op" id="5212144">[</span><span class="op" id="5212145">]</span><span class="op" id="5212146">*</span><span class="ident" id="5212147">os</span><span class="op" id="5212149">.</span><span class="ident" id="5212150">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212157">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212227">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212296">SysProcAttr</span>&nbsp;<span class="op" id="5212308">*</span><span class="ident" id="5212309">syscall</span><span class="op" id="5212316">.</span><span class="ident" id="5212317">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212331">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212384">Process</span>&nbsp;<span class="op" id="5212392">*</span><span class="ident" id="5212393">os</span><span class="op" id="5212395">.</span><span class="ident" id="5212396">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212406">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212469">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212512">ProcessState</span>&nbsp;<span class="op" id="5212525">*</span><span class="ident" id="5212526">os</span><span class="op" id="5212528">.</span><span class="ident" id="5212529">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212544">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5212560">error</span>&nbsp;<span class="comment" id="5212566">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212594">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5212610">bool</span>&nbsp;&nbsp;<span class="comment" id="5212616">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212641">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5212657">[</span><span class="op" id="5212658">]</span><span class="op" id="5212659">*</span><span class="ident" id="5212660">os</span><span class="op" id="5212662">.</span><span class="ident" id="5212663">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212669">closeAfterStart</span>&nbsp;<span class="op" id="5212685">[</span><span class="op" id="5212686">]</span><span class="ident" id="5212687">io</span><span class="op" id="5212689">.</span><span class="ident" id="5212690">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212698">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="5212714">[</span><span class="op" id="5212715">]</span><span class="ident" id="5212716">io</span><span class="op" id="5212718">.</span><span class="ident" id="5212719">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212727">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5212743">[</span><span class="op" id="5212744">]</span><span class="keyword" id="5212745">func</span><span class="op" id="5212749">(</span><span class="op" id="5212750">)</span>&nbsp;<span class="builtintype" id="5212752">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212759">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5212775">chan</span>&nbsp;<span class="builtintype" id="5212780">error</span>&nbsp;<span class="comment" id="5212786">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="5212812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5212815">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5212883">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5212907">//</span><br>
<span class="lineno">110</span><span class="comment" id="5212910">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="5212971">//</span><br>
<span class="lineno"></span><span class="comment" id="5212974">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5213039">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5213109">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="5213127">//</span><br>
<span class="lineno"></span><span class="comment" id="5213130">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5213200">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5213266">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="5213328">func</span>&nbsp;<span class="ident" id="5213333">Command</span><span class="op" id="5213340">(</span><span class="ident" id="5213341">name</span>&nbsp;<span class="builtintype" id="5213346">string</span><span class="op" id="5213352">,</span>&nbsp;<span class="ident" id="5213354">arg</span>&nbsp;<span class="op" id="5213358">...</span><span class="builtintype" id="5213361">string</span><span class="op" id="5213367">)</span>&nbsp;<span class="op" id="5213369">*</span><span class="ident" id="5213370">Cmd</span>&nbsp;<span class="op" id="5213374">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213377">cmd</span>&nbsp;<span class="op" id="5213381">:=</span>&nbsp;<span class="op" id="5213384">&amp;</span><span class="ident" id="5213385">Cmd</span><span class="op" id="5213388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213392">Path</span><span class="op" id="5213396">:</span>&nbsp;<span class="ident" id="5213398">name</span><span class="op" id="5213402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213406">Args</span><span class="op" id="5213410">:</span>&nbsp;<span class="builtinfunc" id="5213412">append</span><span class="op" id="5213418">(</span><span class="op" id="5213419">[</span><span class="op" id="5213420">]</span><span class="builtintype" id="5213421">string</span><span class="op" id="5213427">{</span><span class="ident" id="5213428">name</span><span class="op" id="5213432">}</span><span class="op" id="5213433">,</span>&nbsp;<span class="ident" id="5213435">arg</span><span class="op" id="5213438">...</span><span class="op" id="5213441">)</span><span class="op" id="5213442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213448">if</span>&nbsp;<span class="ident" id="5213451">filepath</span><span class="op" id="5213459">.</span><span class="ident" id="5213460">Base</span><span class="op" id="5213464">(</span><span class="ident" id="5213465">name</span><span class="op" id="5213469">)</span>&nbsp;<span class="op" id="5213471">==</span>&nbsp;<span class="ident" id="5213474">name</span>&nbsp;<span class="op" id="5213479">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213483">if</span>&nbsp;<span class="ident" id="5213486">lp</span><span class="op" id="5213488">,</span>&nbsp;<span class="ident" id="5213490">err</span>&nbsp;<span class="op" id="5213494">:=</span>&nbsp;<span class="ident" id="5213497">LookPath</span><span class="op" id="5213505">(</span><span class="ident" id="5213506">name</span><span class="op" id="5213510">)</span><span class="op" id="5213511">;</span>&nbsp;<span class="ident" id="5213513">err</span>&nbsp;<span class="op" id="5213517">!=</span>&nbsp;<span class="ident" id="5213520">nil</span>&nbsp;<span class="op" id="5213524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213529">cmd</span><span class="op" id="5213532">.</span><span class="ident" id="5213533">lookPathErr</span>&nbsp;<span class="op" id="5213545">=</span>&nbsp;<span class="ident" id="5213547">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213553">}</span>&nbsp;<span class="keyword" id="5213555">else</span>&nbsp;<span class="op" id="5213560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213565">cmd</span><span class="op" id="5213568">.</span><span class="ident" id="5213569">Path</span>&nbsp;<span class="op" id="5213574">=</span>&nbsp;<span class="ident" id="5213576">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213581">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213587">return</span>&nbsp;<span class="ident" id="5213594">cmd</span><br>
<span class="lineno"></span><span class="op" id="5213598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5213601">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="5213672">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5213728">func</span>&nbsp;<span class="ident" id="5213733">interfaceEqual</span><span class="op" id="5213747">(</span><span class="ident" id="5213748">a</span><span class="op" id="5213749">,</span>&nbsp;<span class="ident" id="5213751">b</span>&nbsp;<span class="keyword" id="5213753">interface</span><span class="op" id="5213762">{</span><span class="op" id="5213763">}</span><span class="op" id="5213764">)</span>&nbsp;<span class="builtintype" id="5213766">bool</span>&nbsp;<span class="op" id="5213771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213774">defer</span>&nbsp;<span class="keyword" id="5213780">func</span><span class="op" id="5213784">(</span><span class="op" id="5213785">)</span>&nbsp;<span class="op" id="5213787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5213791">recover</span><span class="op" id="5213798">(</span><span class="op" id="5213799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213802">}</span><span class="op" id="5213803">(</span><span class="op" id="5213804">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213807">return</span>&nbsp;<span class="ident" id="5213814">a</span>&nbsp;<span class="op" id="5213816">==</span>&nbsp;<span class="ident" id="5213819">b</span><br>
<span class="lineno"></span><span class="op" id="5213821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5213824">func</span>&nbsp;<span class="op" id="5213829">(</span><span class="ident" id="5213830">c</span>&nbsp;<span class="op" id="5213832">*</span><span class="ident" id="5213833">Cmd</span><span class="op" id="5213836">)</span>&nbsp;<span class="ident" id="5213838">envv</span><span class="op" id="5213842">(</span><span class="op" id="5213843">)</span>&nbsp;<span class="op" id="5213845">[</span><span class="op" id="5213846">]</span><span class="builtintype" id="5213847">string</span>&nbsp;<span class="op" id="5213854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213857">if</span>&nbsp;<span class="ident" id="5213860">c</span><span class="op" id="5213861">.</span><span class="ident" id="5213862">Env</span>&nbsp;<span class="op" id="5213866">!=</span>&nbsp;<span class="ident" id="5213869">nil</span>&nbsp;<span class="op" id="5213873">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213877">return</span>&nbsp;<span class="ident" id="5213884">c</span><span class="op" id="5213885">.</span><span class="ident" id="5213886">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213894">return</span>&nbsp;<span class="ident" id="5213901">os</span><span class="op" id="5213903">.</span><span class="ident" id="5213904">Environ</span><span class="op" id="5213911">(</span><span class="op" id="5213912">)</span><br>
<span class="lineno"></span><span class="op" id="5213914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="5213917">func</span>&nbsp;<span class="op" id="5213922">(</span><span class="ident" id="5213923">c</span>&nbsp;<span class="op" id="5213925">*</span><span class="ident" id="5213926">Cmd</span><span class="op" id="5213929">)</span>&nbsp;<span class="ident" id="5213931">argv</span><span class="op" id="5213935">(</span><span class="op" id="5213936">)</span>&nbsp;<span class="op" id="5213938">[</span><span class="op" id="5213939">]</span><span class="builtintype" id="5213940">string</span>&nbsp;<span class="op" id="5213947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213950">if</span>&nbsp;<span class="builtinfunc" id="5213953">len</span><span class="op" id="5213956">(</span><span class="ident" id="5213957">c</span><span class="op" id="5213958">.</span><span class="ident" id="5213959">Args</span><span class="op" id="5213963">)</span>&nbsp;<span class="op" id="5213965">&gt;</span>&nbsp;<span class="num" id="5213967">0</span>&nbsp;<span class="op" id="5213969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213973">return</span>&nbsp;<span class="ident" id="5213980">c</span><span class="op" id="5213981">.</span><span class="ident" id="5213982">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213991">return</span>&nbsp;<span class="op" id="5213998">[</span><span class="op" id="5213999">]</span><span class="builtintype" id="5214000">string</span><span class="op" id="5214006">{</span><span class="ident" id="5214007">c</span><span class="op" id="5214008">.</span><span class="ident" id="5214009">Path</span><span class="op" id="5214013">}</span><br>
<span class="lineno">155</span><span class="op" id="5214015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5214018">func</span>&nbsp;<span class="op" id="5214023">(</span><span class="ident" id="5214024">c</span>&nbsp;<span class="op" id="5214026">*</span><span class="ident" id="5214027">Cmd</span><span class="op" id="5214030">)</span>&nbsp;<span class="ident" id="5214032">stdin</span><span class="op" id="5214037">(</span><span class="op" id="5214038">)</span>&nbsp;<span class="op" id="5214040">(</span><span class="ident" id="5214041">f</span>&nbsp;<span class="op" id="5214043">*</span><span class="ident" id="5214044">os</span><span class="op" id="5214046">.</span><span class="ident" id="5214047">File</span><span class="op" id="5214051">,</span>&nbsp;<span class="ident" id="5214053">err</span>&nbsp;<span class="builtintype" id="5214057">error</span><span class="op" id="5214062">)</span>&nbsp;<span class="op" id="5214064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214067">if</span>&nbsp;<span class="ident" id="5214070">c</span><span class="op" id="5214071">.</span><span class="ident" id="5214072">Stdin</span>&nbsp;<span class="op" id="5214078">==</span>&nbsp;<span class="ident" id="5214081">nil</span>&nbsp;<span class="op" id="5214085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214089">f</span><span class="op" id="5214090">,</span>&nbsp;<span class="ident" id="5214092">err</span>&nbsp;<span class="op" id="5214096">=</span>&nbsp;<span class="ident" id="5214098">os</span><span class="op" id="5214100">.</span><span class="ident" id="5214101">Open</span><span class="op" id="5214105">(</span><span class="ident" id="5214106">os</span><span class="op" id="5214108">.</span><span class="ident" id="5214109">DevNull</span><span class="op" id="5214116">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214120">if</span>&nbsp;<span class="ident" id="5214123">err</span>&nbsp;<span class="op" id="5214127">!=</span>&nbsp;<span class="ident" id="5214130">nil</span>&nbsp;<span class="op" id="5214134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214139">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214152">c</span><span class="op" id="5214153">.</span><span class="ident" id="5214154">closeAfterStart</span>&nbsp;<span class="op" id="5214170">=</span>&nbsp;<span class="builtinfunc" id="5214172">append</span><span class="op" id="5214178">(</span><span class="ident" id="5214179">c</span><span class="op" id="5214180">.</span><span class="ident" id="5214181">closeAfterStart</span><span class="op" id="5214196">,</span>&nbsp;<span class="ident" id="5214198">f</span><span class="op" id="5214199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214203">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214215">if</span>&nbsp;<span class="ident" id="5214218">f</span><span class="op" id="5214219">,</span>&nbsp;<span class="ident" id="5214221">ok</span>&nbsp;<span class="op" id="5214224">:=</span>&nbsp;<span class="ident" id="5214227">c</span><span class="op" id="5214228">.</span><span class="ident" id="5214229">Stdin</span><span class="op" id="5214234">.</span><span class="op" id="5214235">(</span><span class="op" id="5214236">*</span><span class="ident" id="5214237">os</span><span class="op" id="5214239">.</span><span class="ident" id="5214240">File</span><span class="op" id="5214244">)</span><span class="op" id="5214245">;</span>&nbsp;<span class="ident" id="5214247">ok</span>&nbsp;<span class="op" id="5214250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214254">return</span>&nbsp;<span class="ident" id="5214261">f</span><span class="op" id="5214262">,</span>&nbsp;<span class="ident" id="5214264">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214269">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214273">pr</span><span class="op" id="5214275">,</span>&nbsp;<span class="ident" id="5214277">pw</span><span class="op" id="5214279">,</span>&nbsp;<span class="ident" id="5214281">err</span>&nbsp;<span class="op" id="5214285">:=</span>&nbsp;<span class="ident" id="5214288">os</span><span class="op" id="5214290">.</span><span class="ident" id="5214291">Pipe</span><span class="op" id="5214295">(</span><span class="op" id="5214296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214299">if</span>&nbsp;<span class="ident" id="5214302">err</span>&nbsp;<span class="op" id="5214306">!=</span>&nbsp;<span class="ident" id="5214309">nil</span>&nbsp;<span class="op" id="5214313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214317">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214325">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214329">c</span><span class="op" id="5214330">.</span><span class="ident" id="5214331">closeAfterStart</span>&nbsp;<span class="op" id="5214347">=</span>&nbsp;<span class="builtinfunc" id="5214349">append</span><span class="op" id="5214355">(</span><span class="ident" id="5214356">c</span><span class="op" id="5214357">.</span><span class="ident" id="5214358">closeAfterStart</span><span class="op" id="5214373">,</span>&nbsp;<span class="ident" id="5214375">pr</span><span class="op" id="5214377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214380">c</span><span class="op" id="5214381">.</span><span class="ident" id="5214382">closeAfterWait</span>&nbsp;<span class="op" id="5214397">=</span>&nbsp;<span class="builtinfunc" id="5214399">append</span><span class="op" id="5214405">(</span><span class="ident" id="5214406">c</span><span class="op" id="5214407">.</span><span class="ident" id="5214408">closeAfterWait</span><span class="op" id="5214422">,</span>&nbsp;<span class="ident" id="5214424">pw</span><span class="op" id="5214426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214429">c</span><span class="op" id="5214430">.</span><span class="ident" id="5214431">goroutine</span>&nbsp;<span class="op" id="5214441">=</span>&nbsp;<span class="builtinfunc" id="5214443">append</span><span class="op" id="5214449">(</span><span class="ident" id="5214450">c</span><span class="op" id="5214451">.</span><span class="ident" id="5214452">goroutine</span><span class="op" id="5214461">,</span>&nbsp;<span class="keyword" id="5214463">func</span><span class="op" id="5214467">(</span><span class="op" id="5214468">)</span>&nbsp;<span class="builtintype" id="5214470">error</span>&nbsp;<span class="op" id="5214476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214480">_</span><span class="op" id="5214481">,</span>&nbsp;<span class="ident" id="5214483">err</span>&nbsp;<span class="op" id="5214487">:=</span>&nbsp;<span class="ident" id="5214490">io</span><span class="op" id="5214492">.</span><span class="ident" id="5214493">Copy</span><span class="op" id="5214497">(</span><span class="ident" id="5214498">pw</span><span class="op" id="5214500">,</span>&nbsp;<span class="ident" id="5214502">c</span><span class="op" id="5214503">.</span><span class="ident" id="5214504">Stdin</span><span class="op" id="5214509">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214513">if</span>&nbsp;<span class="ident" id="5214516">err1</span>&nbsp;<span class="op" id="5214521">:=</span>&nbsp;<span class="ident" id="5214524">pw</span><span class="op" id="5214526">.</span><span class="ident" id="5214527">Close</span><span class="op" id="5214532">(</span><span class="op" id="5214533">)</span><span class="op" id="5214534">;</span>&nbsp;<span class="ident" id="5214536">err</span>&nbsp;<span class="op" id="5214540">==</span>&nbsp;<span class="ident" id="5214543">nil</span>&nbsp;<span class="op" id="5214547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214552">err</span>&nbsp;<span class="op" id="5214556">=</span>&nbsp;<span class="ident" id="5214558">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214569">return</span>&nbsp;<span class="ident" id="5214576">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214581">}</span><span class="op" id="5214582">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214585">return</span>&nbsp;<span class="ident" id="5214592">pr</span><span class="op" id="5214594">,</span>&nbsp;<span class="ident" id="5214596">nil</span><br>
<span class="lineno"></span><span class="op" id="5214600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5214603">func</span>&nbsp;<span class="op" id="5214608">(</span><span class="ident" id="5214609">c</span>&nbsp;<span class="op" id="5214611">*</span><span class="ident" id="5214612">Cmd</span><span class="op" id="5214615">)</span>&nbsp;<span class="ident" id="5214617">stdout</span><span class="op" id="5214623">(</span><span class="op" id="5214624">)</span>&nbsp;<span class="op" id="5214626">(</span><span class="ident" id="5214627">f</span>&nbsp;<span class="op" id="5214629">*</span><span class="ident" id="5214630">os</span><span class="op" id="5214632">.</span><span class="ident" id="5214633">File</span><span class="op" id="5214637">,</span>&nbsp;<span class="ident" id="5214639">err</span>&nbsp;<span class="builtintype" id="5214643">error</span><span class="op" id="5214648">)</span>&nbsp;<span class="op" id="5214650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214653">return</span>&nbsp;<span class="ident" id="5214660">c</span><span class="op" id="5214661">.</span><span class="ident" id="5214662">writerDescriptor</span><span class="op" id="5214678">(</span><span class="ident" id="5214679">c</span><span class="op" id="5214680">.</span><span class="ident" id="5214681">Stdout</span><span class="op" id="5214687">)</span><br>
<span class="lineno">190</span><span class="op" id="5214689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5214692">func</span>&nbsp;<span class="op" id="5214697">(</span><span class="ident" id="5214698">c</span>&nbsp;<span class="op" id="5214700">*</span><span class="ident" id="5214701">Cmd</span><span class="op" id="5214704">)</span>&nbsp;<span class="ident" id="5214706">stderr</span><span class="op" id="5214712">(</span><span class="op" id="5214713">)</span>&nbsp;<span class="op" id="5214715">(</span><span class="ident" id="5214716">f</span>&nbsp;<span class="op" id="5214718">*</span><span class="ident" id="5214719">os</span><span class="op" id="5214721">.</span><span class="ident" id="5214722">File</span><span class="op" id="5214726">,</span>&nbsp;<span class="ident" id="5214728">err</span>&nbsp;<span class="builtintype" id="5214732">error</span><span class="op" id="5214737">)</span>&nbsp;<span class="op" id="5214739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214742">if</span>&nbsp;<span class="ident" id="5214745">c</span><span class="op" id="5214746">.</span><span class="ident" id="5214747">Stderr</span>&nbsp;<span class="op" id="5214754">!=</span>&nbsp;<span class="ident" id="5214757">nil</span>&nbsp;<span class="op" id="5214761">&amp;&amp;</span>&nbsp;<span class="ident" id="5214764">interfaceEqual</span><span class="op" id="5214778">(</span><span class="ident" id="5214779">c</span><span class="op" id="5214780">.</span><span class="ident" id="5214781">Stderr</span><span class="op" id="5214787">,</span>&nbsp;<span class="ident" id="5214789">c</span><span class="op" id="5214790">.</span><span class="ident" id="5214791">Stdout</span><span class="op" id="5214797">)</span>&nbsp;<span class="op" id="5214799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214803">return</span>&nbsp;<span class="ident" id="5214810">c</span><span class="op" id="5214811">.</span><span class="ident" id="5214812">childFiles</span><span class="op" id="5214822">[</span><span class="num" id="5214823">1</span><span class="op" id="5214824">]</span><span class="op" id="5214825">,</span>&nbsp;<span class="ident" id="5214827">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214835">return</span>&nbsp;<span class="ident" id="5214842">c</span><span class="op" id="5214843">.</span><span class="ident" id="5214844">writerDescriptor</span><span class="op" id="5214860">(</span><span class="ident" id="5214861">c</span><span class="op" id="5214862">.</span><span class="ident" id="5214863">Stderr</span><span class="op" id="5214869">)</span><br>
<span class="lineno"></span><span class="op" id="5214871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5214874">func</span>&nbsp;<span class="op" id="5214879">(</span><span class="ident" id="5214880">c</span>&nbsp;<span class="op" id="5214882">*</span><span class="ident" id="5214883">Cmd</span><span class="op" id="5214886">)</span>&nbsp;<span class="ident" id="5214888">writerDescriptor</span><span class="op" id="5214904">(</span><span class="ident" id="5214905">w</span>&nbsp;<span class="ident" id="5214907">io</span><span class="op" id="5214909">.</span><span class="ident" id="5214910">Writer</span><span class="op" id="5214916">)</span>&nbsp;<span class="op" id="5214918">(</span><span class="ident" id="5214919">f</span>&nbsp;<span class="op" id="5214921">*</span><span class="ident" id="5214922">os</span><span class="op" id="5214924">.</span><span class="ident" id="5214925">File</span><span class="op" id="5214929">,</span>&nbsp;<span class="ident" id="5214931">err</span>&nbsp;<span class="builtintype" id="5214935">error</span><span class="op" id="5214940">)</span>&nbsp;<span class="op" id="5214942">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214945">if</span>&nbsp;<span class="ident" id="5214948">w</span>&nbsp;<span class="op" id="5214950">==</span>&nbsp;<span class="ident" id="5214953">nil</span>&nbsp;<span class="op" id="5214957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214961">f</span><span class="op" id="5214962">,</span>&nbsp;<span class="ident" id="5214964">err</span>&nbsp;<span class="op" id="5214968">=</span>&nbsp;<span class="ident" id="5214970">os</span><span class="op" id="5214972">.</span><span class="ident" id="5214973">OpenFile</span><span class="op" id="5214981">(</span><span class="ident" id="5214982">os</span><span class="op" id="5214984">.</span><span class="ident" id="5214985">DevNull</span><span class="op" id="5214992">,</span>&nbsp;<span class="ident" id="5214994">os</span><span class="op" id="5214996">.</span><span class="ident" id="5214997">O_WRONLY</span><span class="op" id="5215005">,</span>&nbsp;<span class="num" id="5215007">0</span><span class="op" id="5215008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215012">if</span>&nbsp;<span class="ident" id="5215015">err</span>&nbsp;<span class="op" id="5215019">!=</span>&nbsp;<span class="ident" id="5215022">nil</span>&nbsp;<span class="op" id="5215026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215031">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215040">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215044">c</span><span class="op" id="5215045">.</span><span class="ident" id="5215046">closeAfterStart</span>&nbsp;<span class="op" id="5215062">=</span>&nbsp;<span class="builtinfunc" id="5215064">append</span><span class="op" id="5215070">(</span><span class="ident" id="5215071">c</span><span class="op" id="5215072">.</span><span class="ident" id="5215073">closeAfterStart</span><span class="op" id="5215088">,</span>&nbsp;<span class="ident" id="5215090">f</span><span class="op" id="5215091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215095">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215107">if</span>&nbsp;<span class="ident" id="5215110">f</span><span class="op" id="5215111">,</span>&nbsp;<span class="ident" id="5215113">ok</span>&nbsp;<span class="op" id="5215116">:=</span>&nbsp;<span class="ident" id="5215119">w</span><span class="op" id="5215120">.</span><span class="op" id="5215121">(</span><span class="op" id="5215122">*</span><span class="ident" id="5215123">os</span><span class="op" id="5215125">.</span><span class="ident" id="5215126">File</span><span class="op" id="5215130">)</span><span class="op" id="5215131">;</span>&nbsp;<span class="ident" id="5215133">ok</span>&nbsp;<span class="op" id="5215136">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215140">return</span>&nbsp;<span class="ident" id="5215147">f</span><span class="op" id="5215148">,</span>&nbsp;<span class="ident" id="5215150">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215159">pr</span><span class="op" id="5215161">,</span>&nbsp;<span class="ident" id="5215163">pw</span><span class="op" id="5215165">,</span>&nbsp;<span class="ident" id="5215167">err</span>&nbsp;<span class="op" id="5215171">:=</span>&nbsp;<span class="ident" id="5215174">os</span><span class="op" id="5215176">.</span><span class="ident" id="5215177">Pipe</span><span class="op" id="5215181">(</span><span class="op" id="5215182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215185">if</span>&nbsp;<span class="ident" id="5215188">err</span>&nbsp;<span class="op" id="5215192">!=</span>&nbsp;<span class="ident" id="5215195">nil</span>&nbsp;<span class="op" id="5215199">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215203">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215215">c</span><span class="op" id="5215216">.</span><span class="ident" id="5215217">closeAfterStart</span>&nbsp;<span class="op" id="5215233">=</span>&nbsp;<span class="builtinfunc" id="5215235">append</span><span class="op" id="5215241">(</span><span class="ident" id="5215242">c</span><span class="op" id="5215243">.</span><span class="ident" id="5215244">closeAfterStart</span><span class="op" id="5215259">,</span>&nbsp;<span class="ident" id="5215261">pw</span><span class="op" id="5215263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215266">c</span><span class="op" id="5215267">.</span><span class="ident" id="5215268">closeAfterWait</span>&nbsp;<span class="op" id="5215283">=</span>&nbsp;<span class="builtinfunc" id="5215285">append</span><span class="op" id="5215291">(</span><span class="ident" id="5215292">c</span><span class="op" id="5215293">.</span><span class="ident" id="5215294">closeAfterWait</span><span class="op" id="5215308">,</span>&nbsp;<span class="ident" id="5215310">pr</span><span class="op" id="5215312">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215315">c</span><span class="op" id="5215316">.</span><span class="ident" id="5215317">goroutine</span>&nbsp;<span class="op" id="5215327">=</span>&nbsp;<span class="builtinfunc" id="5215329">append</span><span class="op" id="5215335">(</span><span class="ident" id="5215336">c</span><span class="op" id="5215337">.</span><span class="ident" id="5215338">goroutine</span><span class="op" id="5215347">,</span>&nbsp;<span class="keyword" id="5215349">func</span><span class="op" id="5215353">(</span><span class="op" id="5215354">)</span>&nbsp;<span class="builtintype" id="5215356">error</span>&nbsp;<span class="op" id="5215362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215366">_</span><span class="op" id="5215367">,</span>&nbsp;<span class="ident" id="5215369">err</span>&nbsp;<span class="op" id="5215373">:=</span>&nbsp;<span class="ident" id="5215376">io</span><span class="op" id="5215378">.</span><span class="ident" id="5215379">Copy</span><span class="op" id="5215383">(</span><span class="ident" id="5215384">w</span><span class="op" id="5215385">,</span>&nbsp;<span class="ident" id="5215387">pr</span><span class="op" id="5215389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215393">return</span>&nbsp;<span class="ident" id="5215400">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215405">}</span><span class="op" id="5215406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215409">return</span>&nbsp;<span class="ident" id="5215416">pw</span><span class="op" id="5215418">,</span>&nbsp;<span class="ident" id="5215420">nil</span><br>
<span class="lineno">225</span><span class="op" id="5215424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5215427">func</span>&nbsp;<span class="op" id="5215432">(</span><span class="ident" id="5215433">c</span>&nbsp;<span class="op" id="5215435">*</span><span class="ident" id="5215436">Cmd</span><span class="op" id="5215439">)</span>&nbsp;<span class="ident" id="5215441">closeDescriptors</span><span class="op" id="5215457">(</span><span class="ident" id="5215458">closers</span>&nbsp;<span class="op" id="5215466">[</span><span class="op" id="5215467">]</span><span class="ident" id="5215468">io</span><span class="op" id="5215470">.</span><span class="ident" id="5215471">Closer</span><span class="op" id="5215477">)</span>&nbsp;<span class="op" id="5215479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215482">for</span>&nbsp;<span class="ident" id="5215486">_</span><span class="op" id="5215487">,</span>&nbsp;<span class="ident" id="5215489">fd</span>&nbsp;<span class="op" id="5215492">:=</span>&nbsp;<span class="keyword" id="5215495">range</span>&nbsp;<span class="ident" id="5215501">closers</span>&nbsp;<span class="op" id="5215509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215513">fd</span><span class="op" id="5215515">.</span><span class="ident" id="5215516">Close</span><span class="op" id="5215521">(</span><span class="op" id="5215522">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215525">}</span><br>
<span class="lineno"></span><span class="op" id="5215527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5215530">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5215596">//</span><br>
<span class="lineno">235</span><span class="comment" id="5215599">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5215665">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5215730">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="5215741">//</span><br>
<span class="lineno"></span><span class="comment" id="5215744">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="5215813">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5215870">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="5215900">func</span>&nbsp;<span class="op" id="5215905">(</span><span class="ident" id="5215906">c</span>&nbsp;<span class="op" id="5215908">*</span><span class="ident" id="5215909">Cmd</span><span class="op" id="5215912">)</span>&nbsp;<span class="ident" id="5215914">Run</span><span class="op" id="5215917">(</span><span class="op" id="5215918">)</span>&nbsp;<span class="builtintype" id="5215920">error</span>&nbsp;<span class="op" id="5215926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215929">if</span>&nbsp;<span class="ident" id="5215932">err</span>&nbsp;<span class="op" id="5215936">:=</span>&nbsp;<span class="ident" id="5215939">c</span><span class="op" id="5215940">.</span><span class="ident" id="5215941">Start</span><span class="op" id="5215946">(</span><span class="op" id="5215947">)</span><span class="op" id="5215948">;</span>&nbsp;<span class="ident" id="5215950">err</span>&nbsp;<span class="op" id="5215954">!=</span>&nbsp;<span class="ident" id="5215957">nil</span>&nbsp;<span class="op" id="5215961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215965">return</span>&nbsp;<span class="ident" id="5215972">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215980">return</span>&nbsp;<span class="ident" id="5215987">c</span><span class="op" id="5215988">.</span><span class="ident" id="5215989">Wait</span><span class="op" id="5215993">(</span><span class="op" id="5215994">)</span><br>
<span class="lineno"></span><span class="op" id="5215996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5215999">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="5216063">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="5216114">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="5216196">func</span>&nbsp;<span class="ident" id="5216201">lookExtensions</span><span class="op" id="5216215">(</span><span class="ident" id="5216216">path</span><span class="op" id="5216220">,</span>&nbsp;<span class="ident" id="5216222">dir</span>&nbsp;<span class="builtintype" id="5216226">string</span><span class="op" id="5216232">)</span>&nbsp;<span class="op" id="5216234">(</span><span class="builtintype" id="5216235">string</span><span class="op" id="5216241">,</span>&nbsp;<span class="builtintype" id="5216243">error</span><span class="op" id="5216248">)</span>&nbsp;<span class="op" id="5216250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216253">if</span>&nbsp;<span class="ident" id="5216256">filepath</span><span class="op" id="5216264">.</span><span class="ident" id="5216265">Base</span><span class="op" id="5216269">(</span><span class="ident" id="5216270">path</span><span class="op" id="5216274">)</span>&nbsp;<span class="op" id="5216276">==</span>&nbsp;<span class="ident" id="5216279">path</span>&nbsp;<span class="op" id="5216284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216288">path</span>&nbsp;<span class="op" id="5216293">=</span>&nbsp;<span class="ident" id="5216295">filepath</span><span class="op" id="5216303">.</span><span class="ident" id="5216304">Join</span><span class="op" id="5216308">(</span><span class="string" id="5216309">&#34;.&#34;</span><span class="op" id="5216312">,</span>&nbsp;<span class="ident" id="5216314">path</span><span class="op" id="5216318">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216324">if</span>&nbsp;<span class="ident" id="5216327">dir</span>&nbsp;<span class="op" id="5216331">==</span>&nbsp;<span class="string" id="5216334">&#34;&#34;</span>&nbsp;<span class="op" id="5216337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216341">return</span>&nbsp;<span class="ident" id="5216348">LookPath</span><span class="op" id="5216356">(</span><span class="ident" id="5216357">path</span><span class="op" id="5216361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216367">if</span>&nbsp;<span class="ident" id="5216370">filepath</span><span class="op" id="5216378">.</span><span class="ident" id="5216379">VolumeName</span><span class="op" id="5216389">(</span><span class="ident" id="5216390">path</span><span class="op" id="5216394">)</span>&nbsp;<span class="op" id="5216396">!=</span>&nbsp;<span class="string" id="5216399">&#34;&#34;</span>&nbsp;<span class="op" id="5216402">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216406">return</span>&nbsp;<span class="ident" id="5216413">LookPath</span><span class="op" id="5216421">(</span><span class="ident" id="5216422">path</span><span class="op" id="5216426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216432">if</span>&nbsp;<span class="builtinfunc" id="5216435">len</span><span class="op" id="5216438">(</span><span class="ident" id="5216439">path</span><span class="op" id="5216443">)</span>&nbsp;<span class="op" id="5216445">&gt;</span>&nbsp;<span class="num" id="5216447">1</span>&nbsp;<span class="op" id="5216449">&amp;&amp;</span>&nbsp;<span class="ident" id="5216452">os</span><span class="op" id="5216454">.</span><span class="ident" id="5216455">IsPathSeparator</span><span class="op" id="5216470">(</span><span class="ident" id="5216471">path</span><span class="op" id="5216475">[</span><span class="num" id="5216476">0</span><span class="op" id="5216477">]</span><span class="op" id="5216478">)</span>&nbsp;<span class="op" id="5216480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216484">return</span>&nbsp;<span class="ident" id="5216491">LookPath</span><span class="op" id="5216499">(</span><span class="ident" id="5216500">path</span><span class="op" id="5216504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216507">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216510">dirandpath</span>&nbsp;<span class="op" id="5216521">:=</span>&nbsp;<span class="ident" id="5216524">filepath</span><span class="op" id="5216532">.</span><span class="ident" id="5216533">Join</span><span class="op" id="5216537">(</span><span class="ident" id="5216538">dir</span><span class="op" id="5216541">,</span>&nbsp;<span class="ident" id="5216543">path</span><span class="op" id="5216547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5216550">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216608">lp</span><span class="op" id="5216610">,</span>&nbsp;<span class="ident" id="5216612">err</span>&nbsp;<span class="op" id="5216616">:=</span>&nbsp;<span class="ident" id="5216619">LookPath</span><span class="op" id="5216627">(</span><span class="ident" id="5216628">dirandpath</span><span class="op" id="5216638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216641">if</span>&nbsp;<span class="ident" id="5216644">err</span>&nbsp;<span class="op" id="5216648">!=</span>&nbsp;<span class="ident" id="5216651">nil</span>&nbsp;<span class="op" id="5216655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216659">return</span>&nbsp;<span class="string" id="5216666">&#34;&#34;</span><span class="op" id="5216668">,</span>&nbsp;<span class="ident" id="5216670">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216678">ext</span>&nbsp;<span class="op" id="5216682">:=</span>&nbsp;<span class="ident" id="5216685">strings</span><span class="op" id="5216692">.</span><span class="ident" id="5216693">TrimPrefix</span><span class="op" id="5216703">(</span><span class="ident" id="5216704">lp</span><span class="op" id="5216706">,</span>&nbsp;<span class="ident" id="5216708">dirandpath</span><span class="op" id="5216718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216721">return</span>&nbsp;<span class="ident" id="5216728">path</span>&nbsp;<span class="op" id="5216733">+</span>&nbsp;<span class="ident" id="5216735">ext</span><span class="op" id="5216738">,</span>&nbsp;<span class="ident" id="5216740">nil</span><br>
<span class="lineno"></span><span class="op" id="5216744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="5216747">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5216823">//</span><br>
<span class="lineno"></span><span class="comment" id="5216826">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="5216904">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5216931">func</span>&nbsp;<span class="op" id="5216936">(</span><span class="ident" id="5216937">c</span>&nbsp;<span class="op" id="5216939">*</span><span class="ident" id="5216940">Cmd</span><span class="op" id="5216943">)</span>&nbsp;<span class="ident" id="5216945">Start</span><span class="op" id="5216950">(</span><span class="op" id="5216951">)</span>&nbsp;<span class="builtintype" id="5216953">error</span>&nbsp;<span class="op" id="5216959">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216962">if</span>&nbsp;<span class="ident" id="5216965">c</span><span class="op" id="5216966">.</span><span class="ident" id="5216967">lookPathErr</span>&nbsp;<span class="op" id="5216979">!=</span>&nbsp;<span class="ident" id="5216982">nil</span>&nbsp;<span class="op" id="5216986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216990">c</span><span class="op" id="5216991">.</span><span class="ident" id="5216992">closeDescriptors</span><span class="op" id="5217008">(</span><span class="ident" id="5217009">c</span><span class="op" id="5217010">.</span><span class="ident" id="5217011">closeAfterStart</span><span class="op" id="5217026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217030">c</span><span class="op" id="5217031">.</span><span class="ident" id="5217032">closeDescriptors</span><span class="op" id="5217048">(</span><span class="ident" id="5217049">c</span><span class="op" id="5217050">.</span><span class="ident" id="5217051">closeAfterWait</span><span class="op" id="5217065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217069">return</span>&nbsp;<span class="ident" id="5217076">c</span><span class="op" id="5217077">.</span><span class="ident" id="5217078">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217091">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217094">if</span>&nbsp;<span class="ident" id="5217097">runtime</span><span class="op" id="5217104">.</span><span class="ident" id="5217105">GOOS</span>&nbsp;<span class="op" id="5217110">==</span>&nbsp;<span class="string" id="5217113">&#34;windows&#34;</span>&nbsp;<span class="op" id="5217123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217127">lp</span><span class="op" id="5217129">,</span>&nbsp;<span class="ident" id="5217131">err</span>&nbsp;<span class="op" id="5217135">:=</span>&nbsp;<span class="ident" id="5217138">lookExtensions</span><span class="op" id="5217152">(</span><span class="ident" id="5217153">c</span><span class="op" id="5217154">.</span><span class="ident" id="5217155">Path</span><span class="op" id="5217159">,</span>&nbsp;<span class="ident" id="5217161">c</span><span class="op" id="5217162">.</span><span class="ident" id="5217163">Dir</span><span class="op" id="5217166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217170">if</span>&nbsp;<span class="ident" id="5217173">err</span>&nbsp;<span class="op" id="5217177">!=</span>&nbsp;<span class="ident" id="5217180">nil</span>&nbsp;<span class="op" id="5217184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217189">c</span><span class="op" id="5217190">.</span><span class="ident" id="5217191">closeDescriptors</span><span class="op" id="5217207">(</span><span class="ident" id="5217208">c</span><span class="op" id="5217209">.</span><span class="ident" id="5217210">closeAfterStart</span><span class="op" id="5217225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217230">c</span><span class="op" id="5217231">.</span><span class="ident" id="5217232">closeDescriptors</span><span class="op" id="5217248">(</span><span class="ident" id="5217249">c</span><span class="op" id="5217250">.</span><span class="ident" id="5217251">closeAfterWait</span><span class="op" id="5217265">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217270">return</span>&nbsp;<span class="ident" id="5217277">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217287">c</span><span class="op" id="5217288">.</span><span class="ident" id="5217289">Path</span>&nbsp;<span class="op" id="5217294">=</span>&nbsp;<span class="ident" id="5217296">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217303">if</span>&nbsp;<span class="ident" id="5217306">c</span><span class="op" id="5217307">.</span><span class="ident" id="5217308">Process</span>&nbsp;<span class="op" id="5217316">!=</span>&nbsp;<span class="ident" id="5217319">nil</span>&nbsp;<span class="op" id="5217323">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217327">return</span>&nbsp;<span class="ident" id="5217334">errors</span><span class="op" id="5217340">.</span><span class="ident" id="5217341">New</span><span class="op" id="5217344">(</span><span class="string" id="5217345">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="5217368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217375">type</span>&nbsp;<span class="ident" id="5217380">F</span>&nbsp;<span class="keyword" id="5217382">func</span><span class="op" id="5217386">(</span><span class="op" id="5217387">*</span><span class="ident" id="5217388">Cmd</span><span class="op" id="5217391">)</span>&nbsp;<span class="op" id="5217393">(</span><span class="op" id="5217394">*</span><span class="ident" id="5217395">os</span><span class="op" id="5217397">.</span><span class="ident" id="5217398">File</span><span class="op" id="5217402">,</span>&nbsp;<span class="builtintype" id="5217404">error</span><span class="op" id="5217409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217412">for</span>&nbsp;<span class="ident" id="5217416">_</span><span class="op" id="5217417">,</span>&nbsp;<span class="ident" id="5217419">setupFd</span>&nbsp;<span class="op" id="5217427">:=</span>&nbsp;<span class="keyword" id="5217430">range</span>&nbsp;<span class="op" id="5217436">[</span><span class="op" id="5217437">]</span><span class="ident" id="5217438">F</span><span class="op" id="5217439">{</span><span class="op" id="5217440">(</span><span class="op" id="5217441">*</span><span class="ident" id="5217442">Cmd</span><span class="op" id="5217445">)</span><span class="op" id="5217446">.</span><span class="ident" id="5217447">stdin</span><span class="op" id="5217452">,</span>&nbsp;<span class="op" id="5217454">(</span><span class="op" id="5217455">*</span><span class="ident" id="5217456">Cmd</span><span class="op" id="5217459">)</span><span class="op" id="5217460">.</span><span class="ident" id="5217461">stdout</span><span class="op" id="5217467">,</span>&nbsp;<span class="op" id="5217469">(</span><span class="op" id="5217470">*</span><span class="ident" id="5217471">Cmd</span><span class="op" id="5217474">)</span><span class="op" id="5217475">.</span><span class="ident" id="5217476">stderr</span><span class="op" id="5217482">}</span>&nbsp;<span class="op" id="5217484">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217488">fd</span><span class="op" id="5217490">,</span>&nbsp;<span class="ident" id="5217492">err</span>&nbsp;<span class="op" id="5217496">:=</span>&nbsp;<span class="ident" id="5217499">setupFd</span><span class="op" id="5217506">(</span><span class="ident" id="5217507">c</span><span class="op" id="5217508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217512">if</span>&nbsp;<span class="ident" id="5217515">err</span>&nbsp;<span class="op" id="5217519">!=</span>&nbsp;<span class="ident" id="5217522">nil</span>&nbsp;<span class="op" id="5217526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217531">c</span><span class="op" id="5217532">.</span><span class="ident" id="5217533">closeDescriptors</span><span class="op" id="5217549">(</span><span class="ident" id="5217550">c</span><span class="op" id="5217551">.</span><span class="ident" id="5217552">closeAfterStart</span><span class="op" id="5217567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217572">c</span><span class="op" id="5217573">.</span><span class="ident" id="5217574">closeDescriptors</span><span class="op" id="5217590">(</span><span class="ident" id="5217591">c</span><span class="op" id="5217592">.</span><span class="ident" id="5217593">closeAfterWait</span><span class="op" id="5217607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217612">return</span>&nbsp;<span class="ident" id="5217619">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217629">c</span><span class="op" id="5217630">.</span><span class="ident" id="5217631">childFiles</span>&nbsp;<span class="op" id="5217642">=</span>&nbsp;<span class="builtinfunc" id="5217644">append</span><span class="op" id="5217650">(</span><span class="ident" id="5217651">c</span><span class="op" id="5217652">.</span><span class="ident" id="5217653">childFiles</span><span class="op" id="5217663">,</span>&nbsp;<span class="ident" id="5217665">fd</span><span class="op" id="5217667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217673">c</span><span class="op" id="5217674">.</span><span class="ident" id="5217675">childFiles</span>&nbsp;<span class="op" id="5217686">=</span>&nbsp;<span class="builtinfunc" id="5217688">append</span><span class="op" id="5217694">(</span><span class="ident" id="5217695">c</span><span class="op" id="5217696">.</span><span class="ident" id="5217697">childFiles</span><span class="op" id="5217707">,</span>&nbsp;<span class="ident" id="5217709">c</span><span class="op" id="5217710">.</span><span class="ident" id="5217711">ExtraFiles</span><span class="op" id="5217721">...</span><span class="op" id="5217724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217728">var</span>&nbsp;<span class="ident" id="5217732">err</span>&nbsp;<span class="builtintype" id="5217736">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217743">c</span><span class="op" id="5217744">.</span><span class="ident" id="5217745">Process</span><span class="op" id="5217752">,</span>&nbsp;<span class="ident" id="5217754">err</span>&nbsp;<span class="op" id="5217758">=</span>&nbsp;<span class="ident" id="5217760">os</span><span class="op" id="5217762">.</span><span class="ident" id="5217763">StartProcess</span><span class="op" id="5217775">(</span><span class="ident" id="5217776">c</span><span class="op" id="5217777">.</span><span class="ident" id="5217778">Path</span><span class="op" id="5217782">,</span>&nbsp;<span class="ident" id="5217784">c</span><span class="op" id="5217785">.</span><span class="ident" id="5217786">argv</span><span class="op" id="5217790">(</span><span class="op" id="5217791">)</span><span class="op" id="5217792">,</span>&nbsp;<span class="op" id="5217794">&amp;</span><span class="ident" id="5217795">os</span><span class="op" id="5217797">.</span><span class="ident" id="5217798">ProcAttr</span><span class="op" id="5217806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217810">Dir</span><span class="op" id="5217813">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5217817">c</span><span class="op" id="5217818">.</span><span class="ident" id="5217819">Dir</span><span class="op" id="5217822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217826">Files</span><span class="op" id="5217831">:</span>&nbsp;<span class="ident" id="5217833">c</span><span class="op" id="5217834">.</span><span class="ident" id="5217835">childFiles</span><span class="op" id="5217845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217849">Env</span><span class="op" id="5217852">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5217856">c</span><span class="op" id="5217857">.</span><span class="ident" id="5217858">envv</span><span class="op" id="5217862">(</span><span class="op" id="5217863">)</span><span class="op" id="5217864">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217868">Sys</span><span class="op" id="5217871">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5217875">c</span><span class="op" id="5217876">.</span><span class="ident" id="5217877">SysProcAttr</span><span class="op" id="5217888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217891">}</span><span class="op" id="5217892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217895">if</span>&nbsp;<span class="ident" id="5217898">err</span>&nbsp;<span class="op" id="5217902">!=</span>&nbsp;<span class="ident" id="5217905">nil</span>&nbsp;<span class="op" id="5217909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217913">c</span><span class="op" id="5217914">.</span><span class="ident" id="5217915">closeDescriptors</span><span class="op" id="5217931">(</span><span class="ident" id="5217932">c</span><span class="op" id="5217933">.</span><span class="ident" id="5217934">closeAfterStart</span><span class="op" id="5217949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217953">c</span><span class="op" id="5217954">.</span><span class="ident" id="5217955">closeDescriptors</span><span class="op" id="5217971">(</span><span class="ident" id="5217972">c</span><span class="op" id="5217973">.</span><span class="ident" id="5217974">closeAfterWait</span><span class="op" id="5217988">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217992">return</span>&nbsp;<span class="ident" id="5217999">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5218004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218008">c</span><span class="op" id="5218009">.</span><span class="ident" id="5218010">closeDescriptors</span><span class="op" id="5218026">(</span><span class="ident" id="5218027">c</span><span class="op" id="5218028">.</span><span class="ident" id="5218029">closeAfterStart</span><span class="op" id="5218044">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218048">c</span><span class="op" id="5218049">.</span><span class="ident" id="5218050">errch</span>&nbsp;<span class="op" id="5218056">=</span>&nbsp;<span class="builtinfunc" id="5218058">make</span><span class="op" id="5218062">(</span><span class="keyword" id="5218063">chan</span>&nbsp;<span class="builtintype" id="5218068">error</span><span class="op" id="5218073">,</span>&nbsp;<span class="builtinfunc" id="5218075">len</span><span class="op" id="5218078">(</span><span class="ident" id="5218079">c</span><span class="op" id="5218080">.</span><span class="ident" id="5218081">goroutine</span><span class="op" id="5218090">)</span><span class="op" id="5218091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218094">for</span>&nbsp;<span class="ident" id="5218098">_</span><span class="op" id="5218099">,</span>&nbsp;<span class="ident" id="5218101">fn</span>&nbsp;<span class="op" id="5218104">:=</span>&nbsp;<span class="keyword" id="5218107">range</span>&nbsp;<span class="ident" id="5218113">c</span><span class="op" id="5218114">.</span><span class="ident" id="5218115">goroutine</span>&nbsp;<span class="op" id="5218125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218129">go</span>&nbsp;<span class="keyword" id="5218132">func</span><span class="op" id="5218136">(</span><span class="ident" id="5218137">fn</span>&nbsp;<span class="keyword" id="5218140">func</span><span class="op" id="5218144">(</span><span class="op" id="5218145">)</span>&nbsp;<span class="builtintype" id="5218147">error</span><span class="op" id="5218152">)</span>&nbsp;<span class="op" id="5218154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218159">c</span><span class="op" id="5218160">.</span><span class="ident" id="5218161">errch</span>&nbsp;<span class="op" id="5218167">&lt;-</span>&nbsp;<span class="ident" id="5218170">fn</span><span class="op" id="5218172">(</span><span class="op" id="5218173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5218177">}</span><span class="op" id="5218178">(</span><span class="ident" id="5218179">fn</span><span class="op" id="5218181">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5218184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218188">return</span>&nbsp;<span class="ident" id="5218195">nil</span><br>
<span class="lineno"></span><span class="op" id="5218199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="5218202">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5218261">type</span>&nbsp;<span class="ident" id="5218266">ExitError</span>&nbsp;<span class="keyword" id="5218276">struct</span>&nbsp;<span class="op" id="5218283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5218286">*</span><span class="ident" id="5218287">os</span><span class="op" id="5218289">.</span><span class="ident" id="5218290">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="5218303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="5218306">func</span>&nbsp;<span class="op" id="5218311">(</span><span class="ident" id="5218312">e</span>&nbsp;<span class="op" id="5218314">*</span><span class="ident" id="5218315">ExitError</span><span class="op" id="5218324">)</span>&nbsp;<span class="ident" id="5218326">Error</span><span class="op" id="5218331">(</span><span class="op" id="5218332">)</span>&nbsp;<span class="builtintype" id="5218334">string</span>&nbsp;<span class="op" id="5218341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218344">return</span>&nbsp;<span class="ident" id="5218351">e</span><span class="op" id="5218352">.</span><span class="ident" id="5218353">ProcessState</span><span class="op" id="5218365">.</span><span class="ident" id="5218366">String</span><span class="op" id="5218372">(</span><span class="op" id="5218373">)</span><br>
<span class="lineno"></span><span class="op" id="5218375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5218378">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="5218417">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="5218456">//</span><br>
<span class="lineno"></span><span class="comment" id="5218459">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5218525">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5218590">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="5218601">//</span><br>
<span class="lineno"></span><span class="comment" id="5218604">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5218673">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5218730">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="5218760">//</span><br>
<span class="lineno">355</span><span class="comment" id="5218763">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="5218819">func</span>&nbsp;<span class="op" id="5218824">(</span><span class="ident" id="5218825">c</span>&nbsp;<span class="op" id="5218827">*</span><span class="ident" id="5218828">Cmd</span><span class="op" id="5218831">)</span>&nbsp;<span class="ident" id="5218833">Wait</span><span class="op" id="5218837">(</span><span class="op" id="5218838">)</span>&nbsp;<span class="builtintype" id="5218840">error</span>&nbsp;<span class="op" id="5218846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218849">if</span>&nbsp;<span class="ident" id="5218852">c</span><span class="op" id="5218853">.</span><span class="ident" id="5218854">Process</span>&nbsp;<span class="op" id="5218862">==</span>&nbsp;<span class="ident" id="5218865">nil</span>&nbsp;<span class="op" id="5218869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218873">return</span>&nbsp;<span class="ident" id="5218880">errors</span><span class="op" id="5218886">.</span><span class="ident" id="5218887">New</span><span class="op" id="5218890">(</span><span class="string" id="5218891">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="5218910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5218913">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218916">if</span>&nbsp;<span class="ident" id="5218919">c</span><span class="op" id="5218920">.</span><span class="ident" id="5218921">finished</span>&nbsp;<span class="op" id="5218930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218934">return</span>&nbsp;<span class="ident" id="5218941">errors</span><span class="op" id="5218947">.</span><span class="ident" id="5218948">New</span><span class="op" id="5218951">(</span><span class="string" id="5218952">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="5218983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5218986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218989">c</span><span class="op" id="5218990">.</span><span class="ident" id="5218991">finished</span>&nbsp;<span class="op" id="5219000">=</span>&nbsp;<span class="builtintype" id="5219002">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219008">state</span><span class="op" id="5219013">,</span>&nbsp;<span class="ident" id="5219015">err</span>&nbsp;<span class="op" id="5219019">:=</span>&nbsp;<span class="ident" id="5219022">c</span><span class="op" id="5219023">.</span><span class="ident" id="5219024">Process</span><span class="op" id="5219031">.</span><span class="ident" id="5219032">Wait</span><span class="op" id="5219036">(</span><span class="op" id="5219037">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219040">c</span><span class="op" id="5219041">.</span><span class="ident" id="5219042">ProcessState</span>&nbsp;<span class="op" id="5219055">=</span>&nbsp;<span class="ident" id="5219057">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219065">var</span>&nbsp;<span class="ident" id="5219069">copyError</span>&nbsp;<span class="builtintype" id="5219079">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219086">for</span>&nbsp;<span class="keyword" id="5219090">range</span>&nbsp;<span class="ident" id="5219096">c</span><span class="op" id="5219097">.</span><span class="ident" id="5219098">goroutine</span>&nbsp;<span class="op" id="5219108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219112">if</span>&nbsp;<span class="ident" id="5219115">err</span>&nbsp;<span class="op" id="5219119">:=</span>&nbsp;<span class="op" id="5219122">&lt;-</span><span class="ident" id="5219124">c</span><span class="op" id="5219125">.</span><span class="ident" id="5219126">errch</span><span class="op" id="5219131">;</span>&nbsp;<span class="ident" id="5219133">err</span>&nbsp;<span class="op" id="5219137">!=</span>&nbsp;<span class="ident" id="5219140">nil</span>&nbsp;<span class="op" id="5219144">&amp;&amp;</span>&nbsp;<span class="ident" id="5219147">copyError</span>&nbsp;<span class="op" id="5219157">==</span>&nbsp;<span class="ident" id="5219160">nil</span>&nbsp;<span class="op" id="5219164">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219169">copyError</span>&nbsp;<span class="op" id="5219179">=</span>&nbsp;<span class="ident" id="5219181">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219194">c</span><span class="op" id="5219195">.</span><span class="ident" id="5219196">closeDescriptors</span><span class="op" id="5219212">(</span><span class="ident" id="5219213">c</span><span class="op" id="5219214">.</span><span class="ident" id="5219215">closeAfterWait</span><span class="op" id="5219229">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219233">if</span>&nbsp;<span class="ident" id="5219236">err</span>&nbsp;<span class="op" id="5219240">!=</span>&nbsp;<span class="ident" id="5219243">nil</span>&nbsp;<span class="op" id="5219247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219251">return</span>&nbsp;<span class="ident" id="5219258">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219263">}</span>&nbsp;<span class="keyword" id="5219265">else</span>&nbsp;<span class="keyword" id="5219270">if</span>&nbsp;<span class="op" id="5219273">!</span><span class="ident" id="5219274">state</span><span class="op" id="5219279">.</span><span class="ident" id="5219280">Success</span><span class="op" id="5219287">(</span><span class="op" id="5219288">)</span>&nbsp;<span class="op" id="5219290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219294">return</span>&nbsp;<span class="op" id="5219301">&amp;</span><span class="ident" id="5219302">ExitError</span><span class="op" id="5219311">{</span><span class="ident" id="5219312">state</span><span class="op" id="5219317">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219324">return</span>&nbsp;<span class="ident" id="5219331">copyError</span><br>
<span class="lineno"></span><span class="op" id="5219341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5219344">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5219404">func</span>&nbsp;<span class="op" id="5219409">(</span><span class="ident" id="5219410">c</span>&nbsp;<span class="op" id="5219412">*</span><span class="ident" id="5219413">Cmd</span><span class="op" id="5219416">)</span>&nbsp;<span class="ident" id="5219418">Output</span><span class="op" id="5219424">(</span><span class="op" id="5219425">)</span>&nbsp;<span class="op" id="5219427">(</span><span class="op" id="5219428">[</span><span class="op" id="5219429">]</span><span class="builtintype" id="5219430">byte</span><span class="op" id="5219434">,</span>&nbsp;<span class="builtintype" id="5219436">error</span><span class="op" id="5219441">)</span>&nbsp;<span class="op" id="5219443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219446">if</span>&nbsp;<span class="ident" id="5219449">c</span><span class="op" id="5219450">.</span><span class="ident" id="5219451">Stdout</span>&nbsp;<span class="op" id="5219458">!=</span>&nbsp;<span class="ident" id="5219461">nil</span>&nbsp;<span class="op" id="5219465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219469">return</span>&nbsp;<span class="ident" id="5219476">nil</span><span class="op" id="5219479">,</span>&nbsp;<span class="ident" id="5219481">errors</span><span class="op" id="5219487">.</span><span class="ident" id="5219488">New</span><span class="op" id="5219491">(</span><span class="string" id="5219492">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5219518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219521">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219524">var</span>&nbsp;<span class="ident" id="5219528">b</span>&nbsp;<span class="ident" id="5219530">bytes</span><span class="op" id="5219535">.</span><span class="ident" id="5219536">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219544">c</span><span class="op" id="5219545">.</span><span class="ident" id="5219546">Stdout</span>&nbsp;<span class="op" id="5219553">=</span>&nbsp;<span class="op" id="5219555">&amp;</span><span class="ident" id="5219556">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219559">err</span>&nbsp;<span class="op" id="5219563">:=</span>&nbsp;<span class="ident" id="5219566">c</span><span class="op" id="5219567">.</span><span class="ident" id="5219568">Run</span><span class="op" id="5219571">(</span><span class="op" id="5219572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219575">return</span>&nbsp;<span class="ident" id="5219582">b</span><span class="op" id="5219583">.</span><span class="ident" id="5219584">Bytes</span><span class="op" id="5219589">(</span><span class="op" id="5219590">)</span><span class="op" id="5219591">,</span>&nbsp;<span class="ident" id="5219593">err</span><br>
<span class="lineno"></span><span class="op" id="5219597">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5219600">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="5219669">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5219699">func</span>&nbsp;<span class="op" id="5219704">(</span><span class="ident" id="5219705">c</span>&nbsp;<span class="op" id="5219707">*</span><span class="ident" id="5219708">Cmd</span><span class="op" id="5219711">)</span>&nbsp;<span class="ident" id="5219713">CombinedOutput</span><span class="op" id="5219727">(</span><span class="op" id="5219728">)</span>&nbsp;<span class="op" id="5219730">(</span><span class="op" id="5219731">[</span><span class="op" id="5219732">]</span><span class="builtintype" id="5219733">byte</span><span class="op" id="5219737">,</span>&nbsp;<span class="builtintype" id="5219739">error</span><span class="op" id="5219744">)</span>&nbsp;<span class="op" id="5219746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219749">if</span>&nbsp;<span class="ident" id="5219752">c</span><span class="op" id="5219753">.</span><span class="ident" id="5219754">Stdout</span>&nbsp;<span class="op" id="5219761">!=</span>&nbsp;<span class="ident" id="5219764">nil</span>&nbsp;<span class="op" id="5219768">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219772">return</span>&nbsp;<span class="ident" id="5219779">nil</span><span class="op" id="5219782">,</span>&nbsp;<span class="ident" id="5219784">errors</span><span class="op" id="5219790">.</span><span class="ident" id="5219791">New</span><span class="op" id="5219794">(</span><span class="string" id="5219795">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5219821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219827">if</span>&nbsp;<span class="ident" id="5219830">c</span><span class="op" id="5219831">.</span><span class="ident" id="5219832">Stderr</span>&nbsp;<span class="op" id="5219839">!=</span>&nbsp;<span class="ident" id="5219842">nil</span>&nbsp;<span class="op" id="5219846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219850">return</span>&nbsp;<span class="ident" id="5219857">nil</span><span class="op" id="5219860">,</span>&nbsp;<span class="ident" id="5219862">errors</span><span class="op" id="5219868">.</span><span class="ident" id="5219869">New</span><span class="op" id="5219872">(</span><span class="string" id="5219873">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5219899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219902">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219905">var</span>&nbsp;<span class="ident" id="5219909">b</span>&nbsp;<span class="ident" id="5219911">bytes</span><span class="op" id="5219916">.</span><span class="ident" id="5219917">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219925">c</span><span class="op" id="5219926">.</span><span class="ident" id="5219927">Stdout</span>&nbsp;<span class="op" id="5219934">=</span>&nbsp;<span class="op" id="5219936">&amp;</span><span class="ident" id="5219937">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219940">c</span><span class="op" id="5219941">.</span><span class="ident" id="5219942">Stderr</span>&nbsp;<span class="op" id="5219949">=</span>&nbsp;<span class="op" id="5219951">&amp;</span><span class="ident" id="5219952">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219955">err</span>&nbsp;<span class="op" id="5219959">:=</span>&nbsp;<span class="ident" id="5219962">c</span><span class="op" id="5219963">.</span><span class="ident" id="5219964">Run</span><span class="op" id="5219967">(</span><span class="op" id="5219968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219971">return</span>&nbsp;<span class="ident" id="5219978">b</span><span class="op" id="5219979">.</span><span class="ident" id="5219980">Bytes</span><span class="op" id="5219985">(</span><span class="op" id="5219986">)</span><span class="op" id="5219987">,</span>&nbsp;<span class="ident" id="5219989">err</span><br>
<span class="lineno">410</span><span class="op" id="5219993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5219996">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5220064">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5220107">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="5220182">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="5220250">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5220326">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="5220372">func</span>&nbsp;<span class="op" id="5220377">(</span><span class="ident" id="5220378">c</span>&nbsp;<span class="op" id="5220380">*</span><span class="ident" id="5220381">Cmd</span><span class="op" id="5220384">)</span>&nbsp;<span class="ident" id="5220386">StdinPipe</span><span class="op" id="5220395">(</span><span class="op" id="5220396">)</span>&nbsp;<span class="op" id="5220398">(</span><span class="ident" id="5220399">io</span><span class="op" id="5220401">.</span><span class="ident" id="5220402">WriteCloser</span><span class="op" id="5220413">,</span>&nbsp;<span class="builtintype" id="5220415">error</span><span class="op" id="5220420">)</span>&nbsp;<span class="op" id="5220422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220425">if</span>&nbsp;<span class="ident" id="5220428">c</span><span class="op" id="5220429">.</span><span class="ident" id="5220430">Stdin</span>&nbsp;<span class="op" id="5220436">!=</span>&nbsp;<span class="ident" id="5220439">nil</span>&nbsp;<span class="op" id="5220443">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220447">return</span>&nbsp;<span class="ident" id="5220454">nil</span><span class="op" id="5220457">,</span>&nbsp;<span class="ident" id="5220459">errors</span><span class="op" id="5220465">.</span><span class="ident" id="5220466">New</span><span class="op" id="5220469">(</span><span class="string" id="5220470">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="5220495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220501">if</span>&nbsp;<span class="ident" id="5220504">c</span><span class="op" id="5220505">.</span><span class="ident" id="5220506">Process</span>&nbsp;<span class="op" id="5220514">!=</span>&nbsp;<span class="ident" id="5220517">nil</span>&nbsp;<span class="op" id="5220521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220525">return</span>&nbsp;<span class="ident" id="5220532">nil</span><span class="op" id="5220535">,</span>&nbsp;<span class="ident" id="5220537">errors</span><span class="op" id="5220543">.</span><span class="ident" id="5220544">New</span><span class="op" id="5220547">(</span><span class="string" id="5220548">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5220587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220590">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220593">pr</span><span class="op" id="5220595">,</span>&nbsp;<span class="ident" id="5220597">pw</span><span class="op" id="5220599">,</span>&nbsp;<span class="ident" id="5220601">err</span>&nbsp;<span class="op" id="5220605">:=</span>&nbsp;<span class="ident" id="5220608">os</span><span class="op" id="5220610">.</span><span class="ident" id="5220611">Pipe</span><span class="op" id="5220615">(</span><span class="op" id="5220616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220619">if</span>&nbsp;<span class="ident" id="5220622">err</span>&nbsp;<span class="op" id="5220626">!=</span>&nbsp;<span class="ident" id="5220629">nil</span>&nbsp;<span class="op" id="5220633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220637">return</span>&nbsp;<span class="ident" id="5220644">nil</span><span class="op" id="5220647">,</span>&nbsp;<span class="ident" id="5220649">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220657">c</span><span class="op" id="5220658">.</span><span class="ident" id="5220659">Stdin</span>&nbsp;<span class="op" id="5220665">=</span>&nbsp;<span class="ident" id="5220667">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220671">c</span><span class="op" id="5220672">.</span><span class="ident" id="5220673">closeAfterStart</span>&nbsp;<span class="op" id="5220689">=</span>&nbsp;<span class="builtinfunc" id="5220691">append</span><span class="op" id="5220697">(</span><span class="ident" id="5220698">c</span><span class="op" id="5220699">.</span><span class="ident" id="5220700">closeAfterStart</span><span class="op" id="5220715">,</span>&nbsp;<span class="ident" id="5220717">pr</span><span class="op" id="5220719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220722">wc</span>&nbsp;<span class="op" id="5220725">:=</span>&nbsp;<span class="op" id="5220728">&amp;</span><span class="ident" id="5220729">closeOnce</span><span class="op" id="5220738">{</span><span class="ident" id="5220739">File</span><span class="op" id="5220743">:</span>&nbsp;<span class="ident" id="5220745">pw</span><span class="op" id="5220747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220750">c</span><span class="op" id="5220751">.</span><span class="ident" id="5220752">closeAfterWait</span>&nbsp;<span class="op" id="5220767">=</span>&nbsp;<span class="builtinfunc" id="5220769">append</span><span class="op" id="5220775">(</span><span class="ident" id="5220776">c</span><span class="op" id="5220777">.</span><span class="ident" id="5220778">closeAfterWait</span><span class="op" id="5220792">,</span>&nbsp;<span class="ident" id="5220794">wc</span><span class="op" id="5220796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220799">return</span>&nbsp;<span class="ident" id="5220806">wc</span><span class="op" id="5220808">,</span>&nbsp;<span class="ident" id="5220810">nil</span><br>
<span class="lineno"></span><span class="op" id="5220814">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="5220817">type</span>&nbsp;<span class="ident" id="5220822">closeOnce</span>&nbsp;<span class="keyword" id="5220832">struct</span>&nbsp;<span class="op" id="5220839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220842">*</span><span class="ident" id="5220843">os</span><span class="op" id="5220845">.</span><span class="ident" id="5220846">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220853">once</span>&nbsp;<span class="ident" id="5220858">sync</span><span class="op" id="5220862">.</span><span class="ident" id="5220863">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220869">err</span>&nbsp;&nbsp;<span class="builtintype" id="5220874">error</span><br>
<span class="lineno"></span><span class="op" id="5220880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5220883">func</span>&nbsp;<span class="op" id="5220888">(</span><span class="ident" id="5220889">c</span>&nbsp;<span class="op" id="5220891">*</span><span class="ident" id="5220892">closeOnce</span><span class="op" id="5220901">)</span>&nbsp;<span class="ident" id="5220903">Close</span><span class="op" id="5220908">(</span><span class="op" id="5220909">)</span>&nbsp;<span class="builtintype" id="5220911">error</span>&nbsp;<span class="op" id="5220917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220920">c</span><span class="op" id="5220921">.</span><span class="ident" id="5220922">once</span><span class="op" id="5220926">.</span><span class="ident" id="5220927">Do</span><span class="op" id="5220929">(</span><span class="ident" id="5220930">c</span><span class="op" id="5220931">.</span><span class="builtinfunc" id="5220932">close</span><span class="op" id="5220937">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220940">return</span>&nbsp;<span class="ident" id="5220947">c</span><span class="op" id="5220948">.</span><span class="ident" id="5220949">err</span><br>
<span class="lineno"></span><span class="op" id="5220953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5220956">func</span>&nbsp;<span class="op" id="5220961">(</span><span class="ident" id="5220962">c</span>&nbsp;<span class="op" id="5220964">*</span><span class="ident" id="5220965">closeOnce</span><span class="op" id="5220974">)</span>&nbsp;<span class="builtinfunc" id="5220976">close</span><span class="op" id="5220981">(</span><span class="op" id="5220982">)</span>&nbsp;<span class="op" id="5220984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220987">c</span><span class="op" id="5220988">.</span><span class="ident" id="5220989">err</span>&nbsp;<span class="op" id="5220993">=</span>&nbsp;<span class="ident" id="5220995">c</span><span class="op" id="5220996">.</span><span class="ident" id="5220997">File</span><span class="op" id="5221001">.</span><span class="ident" id="5221002">Close</span><span class="op" id="5221007">(</span><span class="op" id="5221008">)</span><br>
<span class="lineno">450</span><span class="op" id="5221010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5221013">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5221082">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5221126">//</span><br>
<span class="lineno">455</span><span class="comment" id="5221129">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5221204">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5221275">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5221354">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5221429">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="5221469">func</span>&nbsp;<span class="op" id="5221474">(</span><span class="ident" id="5221475">c</span>&nbsp;<span class="op" id="5221477">*</span><span class="ident" id="5221478">Cmd</span><span class="op" id="5221481">)</span>&nbsp;<span class="ident" id="5221483">StdoutPipe</span><span class="op" id="5221493">(</span><span class="op" id="5221494">)</span>&nbsp;<span class="op" id="5221496">(</span><span class="ident" id="5221497">io</span><span class="op" id="5221499">.</span><span class="ident" id="5221500">ReadCloser</span><span class="op" id="5221510">,</span>&nbsp;<span class="builtintype" id="5221512">error</span><span class="op" id="5221517">)</span>&nbsp;<span class="op" id="5221519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221522">if</span>&nbsp;<span class="ident" id="5221525">c</span><span class="op" id="5221526">.</span><span class="ident" id="5221527">Stdout</span>&nbsp;<span class="op" id="5221534">!=</span>&nbsp;<span class="ident" id="5221537">nil</span>&nbsp;<span class="op" id="5221541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221545">return</span>&nbsp;<span class="ident" id="5221552">nil</span><span class="op" id="5221555">,</span>&nbsp;<span class="ident" id="5221557">errors</span><span class="op" id="5221563">.</span><span class="ident" id="5221564">New</span><span class="op" id="5221567">(</span><span class="string" id="5221568">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5221594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221600">if</span>&nbsp;<span class="ident" id="5221603">c</span><span class="op" id="5221604">.</span><span class="ident" id="5221605">Process</span>&nbsp;<span class="op" id="5221613">!=</span>&nbsp;<span class="ident" id="5221616">nil</span>&nbsp;<span class="op" id="5221620">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221624">return</span>&nbsp;<span class="ident" id="5221631">nil</span><span class="op" id="5221634">,</span>&nbsp;<span class="ident" id="5221636">errors</span><span class="op" id="5221642">.</span><span class="ident" id="5221643">New</span><span class="op" id="5221646">(</span><span class="string" id="5221647">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5221687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221693">pr</span><span class="op" id="5221695">,</span>&nbsp;<span class="ident" id="5221697">pw</span><span class="op" id="5221699">,</span>&nbsp;<span class="ident" id="5221701">err</span>&nbsp;<span class="op" id="5221705">:=</span>&nbsp;<span class="ident" id="5221708">os</span><span class="op" id="5221710">.</span><span class="ident" id="5221711">Pipe</span><span class="op" id="5221715">(</span><span class="op" id="5221716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221719">if</span>&nbsp;<span class="ident" id="5221722">err</span>&nbsp;<span class="op" id="5221726">!=</span>&nbsp;<span class="ident" id="5221729">nil</span>&nbsp;<span class="op" id="5221733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221737">return</span>&nbsp;<span class="ident" id="5221744">nil</span><span class="op" id="5221747">,</span>&nbsp;<span class="ident" id="5221749">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221757">c</span><span class="op" id="5221758">.</span><span class="ident" id="5221759">Stdout</span>&nbsp;<span class="op" id="5221766">=</span>&nbsp;<span class="ident" id="5221768">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221772">c</span><span class="op" id="5221773">.</span><span class="ident" id="5221774">closeAfterStart</span>&nbsp;<span class="op" id="5221790">=</span>&nbsp;<span class="builtinfunc" id="5221792">append</span><span class="op" id="5221798">(</span><span class="ident" id="5221799">c</span><span class="op" id="5221800">.</span><span class="ident" id="5221801">closeAfterStart</span><span class="op" id="5221816">,</span>&nbsp;<span class="ident" id="5221818">pw</span><span class="op" id="5221820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221823">c</span><span class="op" id="5221824">.</span><span class="ident" id="5221825">closeAfterWait</span>&nbsp;<span class="op" id="5221840">=</span>&nbsp;<span class="builtinfunc" id="5221842">append</span><span class="op" id="5221848">(</span><span class="ident" id="5221849">c</span><span class="op" id="5221850">.</span><span class="ident" id="5221851">closeAfterWait</span><span class="op" id="5221865">,</span>&nbsp;<span class="ident" id="5221867">pr</span><span class="op" id="5221869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221872">return</span>&nbsp;<span class="ident" id="5221879">pr</span><span class="op" id="5221881">,</span>&nbsp;<span class="ident" id="5221883">nil</span><br>
<span class="lineno">475</span><span class="op" id="5221887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5221890">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5221959">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5222002">//</span><br>
<span class="lineno">480</span><span class="comment" id="5222005">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5222080">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5222151">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5222230">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5222304">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="5222355">func</span>&nbsp;<span class="op" id="5222360">(</span><span class="ident" id="5222361">c</span>&nbsp;<span class="op" id="5222363">*</span><span class="ident" id="5222364">Cmd</span><span class="op" id="5222367">)</span>&nbsp;<span class="ident" id="5222369">StderrPipe</span><span class="op" id="5222379">(</span><span class="op" id="5222380">)</span>&nbsp;<span class="op" id="5222382">(</span><span class="ident" id="5222383">io</span><span class="op" id="5222385">.</span><span class="ident" id="5222386">ReadCloser</span><span class="op" id="5222396">,</span>&nbsp;<span class="builtintype" id="5222398">error</span><span class="op" id="5222403">)</span>&nbsp;<span class="op" id="5222405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222408">if</span>&nbsp;<span class="ident" id="5222411">c</span><span class="op" id="5222412">.</span><span class="ident" id="5222413">Stderr</span>&nbsp;<span class="op" id="5222420">!=</span>&nbsp;<span class="ident" id="5222423">nil</span>&nbsp;<span class="op" id="5222427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222431">return</span>&nbsp;<span class="ident" id="5222438">nil</span><span class="op" id="5222441">,</span>&nbsp;<span class="ident" id="5222443">errors</span><span class="op" id="5222449">.</span><span class="ident" id="5222450">New</span><span class="op" id="5222453">(</span><span class="string" id="5222454">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5222480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5222483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222486">if</span>&nbsp;<span class="ident" id="5222489">c</span><span class="op" id="5222490">.</span><span class="ident" id="5222491">Process</span>&nbsp;<span class="op" id="5222499">!=</span>&nbsp;<span class="ident" id="5222502">nil</span>&nbsp;<span class="op" id="5222506">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222510">return</span>&nbsp;<span class="ident" id="5222517">nil</span><span class="op" id="5222520">,</span>&nbsp;<span class="ident" id="5222522">errors</span><span class="op" id="5222528">.</span><span class="ident" id="5222529">New</span><span class="op" id="5222532">(</span><span class="string" id="5222533">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5222573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5222576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222579">pr</span><span class="op" id="5222581">,</span>&nbsp;<span class="ident" id="5222583">pw</span><span class="op" id="5222585">,</span>&nbsp;<span class="ident" id="5222587">err</span>&nbsp;<span class="op" id="5222591">:=</span>&nbsp;<span class="ident" id="5222594">os</span><span class="op" id="5222596">.</span><span class="ident" id="5222597">Pipe</span><span class="op" id="5222601">(</span><span class="op" id="5222602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222605">if</span>&nbsp;<span class="ident" id="5222608">err</span>&nbsp;<span class="op" id="5222612">!=</span>&nbsp;<span class="ident" id="5222615">nil</span>&nbsp;<span class="op" id="5222619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222623">return</span>&nbsp;<span class="ident" id="5222630">nil</span><span class="op" id="5222633">,</span>&nbsp;<span class="ident" id="5222635">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5222640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222643">c</span><span class="op" id="5222644">.</span><span class="ident" id="5222645">Stderr</span>&nbsp;<span class="op" id="5222652">=</span>&nbsp;<span class="ident" id="5222654">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222658">c</span><span class="op" id="5222659">.</span><span class="ident" id="5222660">closeAfterStart</span>&nbsp;<span class="op" id="5222676">=</span>&nbsp;<span class="builtinfunc" id="5222678">append</span><span class="op" id="5222684">(</span><span class="ident" id="5222685">c</span><span class="op" id="5222686">.</span><span class="ident" id="5222687">closeAfterStart</span><span class="op" id="5222702">,</span>&nbsp;<span class="ident" id="5222704">pw</span><span class="op" id="5222706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222709">c</span><span class="op" id="5222710">.</span><span class="ident" id="5222711">closeAfterWait</span>&nbsp;<span class="op" id="5222726">=</span>&nbsp;<span class="builtinfunc" id="5222728">append</span><span class="op" id="5222734">(</span><span class="ident" id="5222735">c</span><span class="op" id="5222736">.</span><span class="ident" id="5222737">closeAfterWait</span><span class="op" id="5222751">,</span>&nbsp;<span class="ident" id="5222753">pr</span><span class="op" id="5222755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222758">return</span>&nbsp;<span class="ident" id="5222765">pr</span><span class="op" id="5222767">,</span>&nbsp;<span class="ident" id="5222769">nil</span><br>
<span class="lineno">500</span><span class="op" id="5222773">}</span>
</div>
</body>
</html>
