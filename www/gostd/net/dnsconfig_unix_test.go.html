<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8196179">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8196234">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8196288">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8196339">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8196404">package</span>&nbsp;<span class="ident" id="8196412">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8196417">import</span>&nbsp;<span class="op" id="8196424">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8196427">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8196438">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8196448">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8196451">var</span>&nbsp;<span class="ident" id="8196455">dnsReadConfigTests</span>&nbsp;<span class="op" id="8196474">=</span>&nbsp;<span class="op" id="8196476">[</span><span class="op" id="8196477">]</span><span class="keyword" id="8196478">struct</span>&nbsp;<span class="op" id="8196485">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196488">name</span>&nbsp;<span class="builtintype" id="8196493">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196501">conf</span>&nbsp;<span class="ident" id="8196506">dnsConfig</span><br>
<span class="lineno"></span><span class="op" id="8196516">}</span><span class="op" id="8196517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196524">name</span><span class="op" id="8196528">:</span>&nbsp;<span class="string" id="8196530">&#34;testdata/resolv.conf&#34;</span><span class="op" id="8196552">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196556">conf</span><span class="op" id="8196560">:</span>&nbsp;<span class="ident" id="8196562">dnsConfig</span><span class="op" id="8196571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196576">servers</span><span class="op" id="8196583">:</span>&nbsp;&nbsp;<span class="op" id="8196586">[</span><span class="op" id="8196587">]</span><span class="builtintype" id="8196588">string</span><span class="op" id="8196594">{</span><span class="string" id="8196595">&#34;8.8.8.8&#34;</span><span class="op" id="8196604">,</span>&nbsp;<span class="string" id="8196606">&#34;2001:4860:4860::8888&#34;</span><span class="op" id="8196628">,</span>&nbsp;<span class="string" id="8196630">&#34;fe80::1%lo0&#34;</span><span class="op" id="8196643">}</span><span class="op" id="8196644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196649">search</span><span class="op" id="8196655">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8196659">[</span><span class="op" id="8196660">]</span><span class="builtintype" id="8196661">string</span><span class="op" id="8196667">{</span><span class="string" id="8196668">&#34;localdomain&#34;</span><span class="op" id="8196681">}</span><span class="op" id="8196682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196687">ndots</span><span class="op" id="8196692">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8196697">5</span><span class="op" id="8196698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196703">timeout</span><span class="op" id="8196710">:</span>&nbsp;&nbsp;<span class="num" id="8196713">10</span><span class="op" id="8196715">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196720">attempts</span><span class="op" id="8196728">:</span>&nbsp;<span class="num" id="8196730">3</span><span class="op" id="8196731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196736">rotate</span><span class="op" id="8196742">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8196746">true</span><span class="op" id="8196750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196754">}</span><span class="op" id="8196755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196758">}</span><span class="op" id="8196759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196762">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196766">name</span><span class="op" id="8196770">:</span>&nbsp;<span class="string" id="8196772">&#34;testdata/domain-resolv.conf&#34;</span><span class="op" id="8196801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196805">conf</span><span class="op" id="8196809">:</span>&nbsp;<span class="ident" id="8196811">dnsConfig</span><span class="op" id="8196820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196825">servers</span><span class="op" id="8196832">:</span>&nbsp;&nbsp;<span class="op" id="8196835">[</span><span class="op" id="8196836">]</span><span class="builtintype" id="8196837">string</span><span class="op" id="8196843">{</span><span class="string" id="8196844">&#34;8.8.8.8&#34;</span><span class="op" id="8196853">}</span><span class="op" id="8196854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196859">search</span><span class="op" id="8196865">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8196869">[</span><span class="op" id="8196870">]</span><span class="builtintype" id="8196871">string</span><span class="op" id="8196877">{</span><span class="string" id="8196878">&#34;localdomain&#34;</span><span class="op" id="8196891">}</span><span class="op" id="8196892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196897">ndots</span><span class="op" id="8196902">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8196907">1</span><span class="op" id="8196908">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196913">timeout</span><span class="op" id="8196920">:</span>&nbsp;&nbsp;<span class="num" id="8196923">5</span><span class="op" id="8196924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196929">attempts</span><span class="op" id="8196937">:</span>&nbsp;<span class="num" id="8196939">2</span><span class="op" id="8196940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196944">}</span><span class="op" id="8196945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196948">}</span><span class="op" id="8196949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196952">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196956">name</span><span class="op" id="8196960">:</span>&nbsp;<span class="string" id="8196962">&#34;testdata/search-resolv.conf&#34;</span><span class="op" id="8196991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196995">conf</span><span class="op" id="8196999">:</span>&nbsp;<span class="ident" id="8197001">dnsConfig</span><span class="op" id="8197010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197015">servers</span><span class="op" id="8197022">:</span>&nbsp;&nbsp;<span class="op" id="8197025">[</span><span class="op" id="8197026">]</span><span class="builtintype" id="8197027">string</span><span class="op" id="8197033">{</span><span class="string" id="8197034">&#34;8.8.8.8&#34;</span><span class="op" id="8197043">}</span><span class="op" id="8197044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197049">search</span><span class="op" id="8197055">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8197059">[</span><span class="op" id="8197060">]</span><span class="builtintype" id="8197061">string</span><span class="op" id="8197067">{</span><span class="string" id="8197068">&#34;test&#34;</span><span class="op" id="8197074">,</span>&nbsp;<span class="string" id="8197076">&#34;invalid&#34;</span><span class="op" id="8197085">}</span><span class="op" id="8197086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197091">ndots</span><span class="op" id="8197096">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8197101">1</span><span class="op" id="8197102">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197107">timeout</span><span class="op" id="8197114">:</span>&nbsp;&nbsp;<span class="num" id="8197117">5</span><span class="op" id="8197118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197123">attempts</span><span class="op" id="8197131">:</span>&nbsp;<span class="num" id="8197133">2</span><span class="op" id="8197134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197138">}</span><span class="op" id="8197139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197142">}</span><span class="op" id="8197143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197146">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197150">name</span><span class="op" id="8197154">:</span>&nbsp;<span class="string" id="8197156">&#34;testdata/empty-resolv.conf&#34;</span><span class="op" id="8197184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197188">conf</span><span class="op" id="8197192">:</span>&nbsp;<span class="ident" id="8197194">dnsConfig</span><span class="op" id="8197203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197208">ndots</span><span class="op" id="8197213">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8197218">1</span><span class="op" id="8197219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197224">timeout</span><span class="op" id="8197231">:</span>&nbsp;&nbsp;<span class="num" id="8197234">5</span><span class="op" id="8197235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197240">attempts</span><span class="op" id="8197248">:</span>&nbsp;<span class="num" id="8197250">2</span><span class="op" id="8197251">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197255">}</span><span class="op" id="8197256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197259">}</span><span class="op" id="8197260">,</span><br>
<span class="lineno"></span><span class="op" id="8197262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8197265">func</span>&nbsp;<span class="ident" id="8197270">TestDNSReadConfig</span><span class="op" id="8197287">(</span><span class="ident" id="8197288">t</span>&nbsp;<span class="op" id="8197290">*</span><span class="ident" id="8197291">testing</span><span class="op" id="8197298">.</span><span class="ident" id="8197299">T</span><span class="op" id="8197300">)</span>&nbsp;<span class="op" id="8197302">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8197305">for</span>&nbsp;<span class="ident" id="8197309">_</span><span class="op" id="8197310">,</span>&nbsp;<span class="ident" id="8197312">tt</span>&nbsp;<span class="op" id="8197315">:=</span>&nbsp;<span class="keyword" id="8197318">range</span>&nbsp;<span class="ident" id="8197324">dnsReadConfigTests</span>&nbsp;<span class="op" id="8197343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197347">conf</span><span class="op" id="8197351">,</span>&nbsp;<span class="ident" id="8197353">err</span>&nbsp;<span class="op" id="8197357">:=</span>&nbsp;<span class="ident" id="8197360">dnsReadConfig</span><span class="op" id="8197373">(</span><span class="ident" id="8197374">tt</span><span class="op" id="8197376">.</span><span class="ident" id="8197377">name</span><span class="op" id="8197381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8197385">if</span>&nbsp;<span class="ident" id="8197388">err</span>&nbsp;<span class="op" id="8197392">!=</span>&nbsp;<span class="ident" id="8197395">nil</span>&nbsp;<span class="op" id="8197399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197404">t</span><span class="op" id="8197405">.</span><span class="ident" id="8197406">Fatal</span><span class="op" id="8197411">(</span><span class="ident" id="8197412">err</span><span class="op" id="8197415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197419">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8197423">if</span>&nbsp;<span class="op" id="8197426">!</span><span class="ident" id="8197427">reflect</span><span class="op" id="8197434">.</span><span class="ident" id="8197435">DeepEqual</span><span class="op" id="8197444">(</span><span class="ident" id="8197445">conf</span><span class="op" id="8197449">,</span>&nbsp;<span class="op" id="8197451">&amp;</span><span class="ident" id="8197452">tt</span><span class="op" id="8197454">.</span><span class="ident" id="8197455">conf</span><span class="op" id="8197459">)</span>&nbsp;<span class="op" id="8197461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197466">t</span><span class="op" id="8197467">.</span><span class="ident" id="8197468">Errorf</span><span class="op" id="8197474">(</span><span class="string" id="8197475">&#34;got&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8197492">,</span>&nbsp;<span class="ident" id="8197494">conf</span><span class="op" id="8197498">,</span>&nbsp;<span class="op" id="8197500">&amp;</span><span class="ident" id="8197501">tt</span><span class="op" id="8197503">.</span><span class="ident" id="8197504">conf</span><span class="op" id="8197508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197515">}</span><br>
<span class="lineno"></span><span class="op" id="8197517">}</span>
</div>
</body>
</html>
