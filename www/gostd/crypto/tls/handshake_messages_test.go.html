<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8128861">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8128916">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8128970">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8129021">package</span>&nbsp;<span class="ident" id="8129029">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8129034">import</span>&nbsp;<span class="op" id="8129041">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8129044">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8129057">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8129068">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8129079">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="8129095">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8129098">var</span>&nbsp;<span class="ident" id="8129102">tests</span>&nbsp;<span class="op" id="8129108">=</span>&nbsp;<span class="op" id="8129110">[</span><span class="op" id="8129111">]</span><span class="keyword" id="8129112">interface</span><span class="op" id="8129121">{</span><span class="op" id="8129122">}</span><span class="op" id="8129123">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129126">&amp;</span><span class="ident" id="8129127">clientHelloMsg</span><span class="op" id="8129141">{</span><span class="op" id="8129142">}</span><span class="op" id="8129143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129146">&amp;</span><span class="ident" id="8129147">serverHelloMsg</span><span class="op" id="8129161">{</span><span class="op" id="8129162">}</span><span class="op" id="8129163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129166">&amp;</span><span class="ident" id="8129167">finishedMsg</span><span class="op" id="8129178">{</span><span class="op" id="8129179">}</span><span class="op" id="8129180">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129184">&amp;</span><span class="ident" id="8129185">certificateMsg</span><span class="op" id="8129199">{</span><span class="op" id="8129200">}</span><span class="op" id="8129201">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129204">&amp;</span><span class="ident" id="8129205">certificateRequestMsg</span><span class="op" id="8129226">{</span><span class="op" id="8129227">}</span><span class="op" id="8129228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129231">&amp;</span><span class="ident" id="8129232">certificateVerifyMsg</span><span class="op" id="8129252">{</span><span class="op" id="8129253">}</span><span class="op" id="8129254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129257">&amp;</span><span class="ident" id="8129258">certificateStatusMsg</span><span class="op" id="8129278">{</span><span class="op" id="8129279">}</span><span class="op" id="8129280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129283">&amp;</span><span class="ident" id="8129284">clientKeyExchangeMsg</span><span class="op" id="8129304">{</span><span class="op" id="8129305">}</span><span class="op" id="8129306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129309">&amp;</span><span class="ident" id="8129310">nextProtoMsg</span><span class="op" id="8129322">{</span><span class="op" id="8129323">}</span><span class="op" id="8129324">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129327">&amp;</span><span class="ident" id="8129328">newSessionTicketMsg</span><span class="op" id="8129347">{</span><span class="op" id="8129348">}</span><span class="op" id="8129349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129352">&amp;</span><span class="ident" id="8129353">sessionState</span><span class="op" id="8129365">{</span><span class="op" id="8129366">}</span><span class="op" id="8129367">,</span><br>
<span class="lineno"></span><span class="op" id="8129369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8129372">type</span>&nbsp;<span class="ident" id="8129377">testMessage</span>&nbsp;<span class="keyword" id="8129389">interface</span>&nbsp;<span class="op" id="8129399">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129402">marshal</span><span class="op" id="8129409">(</span><span class="op" id="8129410">)</span>&nbsp;<span class="op" id="8129412">[</span><span class="op" id="8129413">]</span><span class="builtintype" id="8129414">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129420">unmarshal</span><span class="op" id="8129429">(</span><span class="op" id="8129430">[</span><span class="op" id="8129431">]</span><span class="builtintype" id="8129432">byte</span><span class="op" id="8129436">)</span>&nbsp;<span class="builtintype" id="8129438">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129444">equal</span><span class="op" id="8129449">(</span><span class="keyword" id="8129450">interface</span><span class="op" id="8129459">{</span><span class="op" id="8129460">}</span><span class="op" id="8129461">)</span>&nbsp;<span class="builtintype" id="8129463">bool</span><br>
<span class="lineno"></span><span class="op" id="8129468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8129471">func</span>&nbsp;<span class="ident" id="8129476">TestMarshalUnmarshal</span><span class="op" id="8129496">(</span><span class="ident" id="8129497">t</span>&nbsp;<span class="op" id="8129499">*</span><span class="ident" id="8129500">testing</span><span class="op" id="8129507">.</span><span class="ident" id="8129508">T</span><span class="op" id="8129509">)</span>&nbsp;<span class="op" id="8129511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129514">rand</span>&nbsp;<span class="op" id="8129519">:=</span>&nbsp;<span class="ident" id="8129522">rand</span><span class="op" id="8129526">.</span><span class="ident" id="8129527">New</span><span class="op" id="8129530">(</span><span class="ident" id="8129531">rand</span><span class="op" id="8129535">.</span><span class="ident" id="8129536">NewSource</span><span class="op" id="8129545">(</span><span class="num" id="8129546">0</span><span class="op" id="8129547">)</span><span class="op" id="8129548">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8129552">for</span>&nbsp;<span class="ident" id="8129556">i</span><span class="op" id="8129557">,</span>&nbsp;<span class="ident" id="8129559">iface</span>&nbsp;<span class="op" id="8129565">:=</span>&nbsp;<span class="keyword" id="8129568">range</span>&nbsp;<span class="ident" id="8129574">tests</span>&nbsp;<span class="op" id="8129580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129584">ty</span>&nbsp;<span class="op" id="8129587">:=</span>&nbsp;<span class="ident" id="8129590">reflect</span><span class="op" id="8129597">.</span><span class="ident" id="8129598">ValueOf</span><span class="op" id="8129605">(</span><span class="ident" id="8129606">iface</span><span class="op" id="8129611">)</span><span class="op" id="8129612">.</span><span class="ident" id="8129613">Type</span><span class="op" id="8129617">(</span><span class="op" id="8129618">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129623">n</span>&nbsp;<span class="op" id="8129625">:=</span>&nbsp;<span class="num" id="8129628">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8129634">if</span>&nbsp;<span class="ident" id="8129637">testing</span><span class="op" id="8129644">.</span><span class="ident" id="8129645">Short</span><span class="op" id="8129650">(</span><span class="op" id="8129651">)</span>&nbsp;<span class="op" id="8129653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129658">n</span>&nbsp;<span class="op" id="8129660">=</span>&nbsp;<span class="num" id="8129662">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129666">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8129670">for</span>&nbsp;<span class="ident" id="8129674">j</span>&nbsp;<span class="op" id="8129676">:=</span>&nbsp;<span class="num" id="8129679">0</span><span class="op" id="8129680">;</span>&nbsp;<span class="ident" id="8129682">j</span>&nbsp;<span class="op" id="8129684">&lt;</span>&nbsp;<span class="ident" id="8129686">n</span><span class="op" id="8129687">;</span>&nbsp;<span class="ident" id="8129689">j</span><span class="op" id="8129690">++</span>&nbsp;<span class="op" id="8129693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129698">v</span><span class="op" id="8129699">,</span>&nbsp;<span class="ident" id="8129701">ok</span>&nbsp;<span class="op" id="8129704">:=</span>&nbsp;<span class="ident" id="8129707">quick</span><span class="op" id="8129712">.</span><span class="ident" id="8129713">Value</span><span class="op" id="8129718">(</span><span class="ident" id="8129719">ty</span><span class="op" id="8129721">,</span>&nbsp;<span class="ident" id="8129723">rand</span><span class="op" id="8129727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8129732">if</span>&nbsp;<span class="op" id="8129735">!</span><span class="ident" id="8129736">ok</span>&nbsp;<span class="op" id="8129739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129745">t</span><span class="op" id="8129746">.</span><span class="ident" id="8129747">Errorf</span><span class="op" id="8129753">(</span><span class="string" id="8129754">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="8129783">,</span>&nbsp;<span class="ident" id="8129785">i</span><span class="op" id="8129786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8129792">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8129801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129807">m1</span>&nbsp;<span class="op" id="8129810">:=</span>&nbsp;<span class="ident" id="8129813">v</span><span class="op" id="8129814">.</span><span class="ident" id="8129815">Interface</span><span class="op" id="8129824">(</span><span class="op" id="8129825">)</span><span class="op" id="8129826">.</span><span class="op" id="8129827">(</span><span class="ident" id="8129828">testMessage</span><span class="op" id="8129839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129844">marshaled</span>&nbsp;<span class="op" id="8129854">:=</span>&nbsp;<span class="ident" id="8129857">m1</span><span class="op" id="8129859">.</span><span class="ident" id="8129860">marshal</span><span class="op" id="8129867">(</span><span class="op" id="8129868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129873">m2</span>&nbsp;<span class="op" id="8129876">:=</span>&nbsp;<span class="ident" id="8129879">iface</span><span class="op" id="8129884">.</span><span class="op" id="8129885">(</span><span class="ident" id="8129886">testMessage</span><span class="op" id="8129897">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8129902">if</span>&nbsp;<span class="op" id="8129905">!</span><span class="ident" id="8129906">m2</span><span class="op" id="8129908">.</span><span class="ident" id="8129909">unmarshal</span><span class="op" id="8129918">(</span><span class="ident" id="8129919">marshaled</span><span class="op" id="8129928">)</span>&nbsp;<span class="op" id="8129930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129936">t</span><span class="op" id="8129937">.</span><span class="ident" id="8129938">Errorf</span><span class="op" id="8129944">(</span><span class="string" id="8129945">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="8129977">,</span>&nbsp;<span class="ident" id="8129979">i</span><span class="op" id="8129980">,</span>&nbsp;<span class="ident" id="8129982">m1</span><span class="op" id="8129984">,</span>&nbsp;<span class="ident" id="8129986">marshaled</span><span class="op" id="8129995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8130001">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130015">m2</span><span class="op" id="8130017">.</span><span class="ident" id="8130018">marshal</span><span class="op" id="8130025">(</span><span class="op" id="8130026">)</span>&nbsp;<span class="comment" id="8130028">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8130076">if</span>&nbsp;<span class="op" id="8130079">!</span><span class="ident" id="8130080">m1</span><span class="op" id="8130082">.</span><span class="ident" id="8130083">equal</span><span class="op" id="8130088">(</span><span class="ident" id="8130089">m2</span><span class="op" id="8130091">)</span>&nbsp;<span class="op" id="8130093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130099">t</span><span class="op" id="8130100">.</span><span class="ident" id="8130101">Errorf</span><span class="op" id="8130107">(</span><span class="string" id="8130108">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="8130133">,</span>&nbsp;<span class="ident" id="8130135">i</span><span class="op" id="8130136">,</span>&nbsp;<span class="ident" id="8130138">m2</span><span class="op" id="8130140">,</span>&nbsp;<span class="ident" id="8130142">m1</span><span class="op" id="8130144">,</span>&nbsp;<span class="ident" id="8130146">marshaled</span><span class="op" id="8130155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8130161">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130170">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8130176">if</span>&nbsp;<span class="ident" id="8130179">i</span>&nbsp;<span class="op" id="8130181">&gt;=</span>&nbsp;<span class="num" id="8130184">3</span>&nbsp;<span class="op" id="8130186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8130192">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8130243">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8130291">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8130343">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8130389">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8130429">for</span>&nbsp;<span class="ident" id="8130433">j</span>&nbsp;<span class="op" id="8130435">:=</span>&nbsp;<span class="num" id="8130438">0</span><span class="op" id="8130439">;</span>&nbsp;<span class="ident" id="8130441">j</span>&nbsp;<span class="op" id="8130443">&lt;</span>&nbsp;<span class="builtinfunc" id="8130445">len</span><span class="op" id="8130448">(</span><span class="ident" id="8130449">marshaled</span><span class="op" id="8130458">)</span><span class="op" id="8130459">;</span>&nbsp;<span class="ident" id="8130461">j</span><span class="op" id="8130462">++</span>&nbsp;<span class="op" id="8130465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8130472">if</span>&nbsp;<span class="ident" id="8130475">m2</span><span class="op" id="8130477">.</span><span class="ident" id="8130478">unmarshal</span><span class="op" id="8130487">(</span><span class="ident" id="8130488">marshaled</span><span class="op" id="8130497">[</span><span class="num" id="8130498">0</span><span class="op" id="8130499">:</span><span class="ident" id="8130500">j</span><span class="op" id="8130501">]</span><span class="op" id="8130502">)</span>&nbsp;<span class="op" id="8130504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130512">t</span><span class="op" id="8130513">.</span><span class="ident" id="8130514">Errorf</span><span class="op" id="8130520">(</span><span class="string" id="8130521">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="8130567">,</span>&nbsp;<span class="ident" id="8130569">i</span><span class="op" id="8130570">,</span>&nbsp;<span class="ident" id="8130572">j</span><span class="op" id="8130573">,</span>&nbsp;<span class="ident" id="8130575">m1</span><span class="op" id="8130577">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8130585">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130611">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130614">}</span><br>
<span class="lineno"></span><span class="op" id="8130616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8130619">func</span>&nbsp;<span class="ident" id="8130624">TestFuzz</span><span class="op" id="8130632">(</span><span class="ident" id="8130633">t</span>&nbsp;<span class="op" id="8130635">*</span><span class="ident" id="8130636">testing</span><span class="op" id="8130643">.</span><span class="ident" id="8130644">T</span><span class="op" id="8130645">)</span>&nbsp;<span class="op" id="8130647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130650">rand</span>&nbsp;<span class="op" id="8130655">:=</span>&nbsp;<span class="ident" id="8130658">rand</span><span class="op" id="8130662">.</span><span class="ident" id="8130663">New</span><span class="op" id="8130666">(</span><span class="ident" id="8130667">rand</span><span class="op" id="8130671">.</span><span class="ident" id="8130672">NewSource</span><span class="op" id="8130681">(</span><span class="num" id="8130682">0</span><span class="op" id="8130683">)</span><span class="op" id="8130684">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8130687">for</span>&nbsp;<span class="ident" id="8130691">_</span><span class="op" id="8130692">,</span>&nbsp;<span class="ident" id="8130694">iface</span>&nbsp;<span class="op" id="8130700">:=</span>&nbsp;<span class="keyword" id="8130703">range</span>&nbsp;<span class="ident" id="8130709">tests</span>&nbsp;<span class="op" id="8130715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130719">m</span>&nbsp;<span class="op" id="8130721">:=</span>&nbsp;<span class="ident" id="8130724">iface</span><span class="op" id="8130729">.</span><span class="op" id="8130730">(</span><span class="ident" id="8130731">testMessage</span><span class="op" id="8130742">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8130747">for</span>&nbsp;<span class="ident" id="8130751">j</span>&nbsp;<span class="op" id="8130753">:=</span>&nbsp;<span class="num" id="8130756">0</span><span class="op" id="8130757">;</span>&nbsp;<span class="ident" id="8130759">j</span>&nbsp;<span class="op" id="8130761">&lt;</span>&nbsp;<span class="num" id="8130763">1000</span><span class="op" id="8130767">;</span>&nbsp;<span class="ident" id="8130769">j</span><span class="op" id="8130770">++</span>&nbsp;<span class="op" id="8130773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8130778">len</span>&nbsp;<span class="op" id="8130782">:=</span>&nbsp;<span class="ident" id="8130785">rand</span><span class="op" id="8130789">.</span><span class="ident" id="8130790">Intn</span><span class="op" id="8130794">(</span><span class="num" id="8130795">100</span><span class="op" id="8130798">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130803">bytes</span>&nbsp;<span class="op" id="8130809">:=</span>&nbsp;<span class="ident" id="8130812">randomBytes</span><span class="op" id="8130823">(</span><span class="builtinfunc" id="8130824">len</span><span class="op" id="8130827">,</span>&nbsp;<span class="ident" id="8130829">rand</span><span class="op" id="8130833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8130838">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130898">m</span><span class="op" id="8130899">.</span><span class="ident" id="8130900">unmarshal</span><span class="op" id="8130909">(</span><span class="ident" id="8130910">bytes</span><span class="op" id="8130915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130922">}</span><br>
<span class="lineno">95</span><span class="op" id="8130924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8130927">func</span>&nbsp;<span class="ident" id="8130932">randomBytes</span><span class="op" id="8130943">(</span><span class="ident" id="8130944">n</span>&nbsp;<span class="builtintype" id="8130946">int</span><span class="op" id="8130949">,</span>&nbsp;<span class="ident" id="8130951">rand</span>&nbsp;<span class="op" id="8130956">*</span><span class="ident" id="8130957">rand</span><span class="op" id="8130961">.</span><span class="ident" id="8130962">Rand</span><span class="op" id="8130966">)</span>&nbsp;<span class="op" id="8130968">[</span><span class="op" id="8130969">]</span><span class="builtintype" id="8130970">byte</span>&nbsp;<span class="op" id="8130975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130978">r</span>&nbsp;<span class="op" id="8130980">:=</span>&nbsp;<span class="builtinfunc" id="8130983">make</span><span class="op" id="8130987">(</span><span class="op" id="8130988">[</span><span class="op" id="8130989">]</span><span class="builtintype" id="8130990">byte</span><span class="op" id="8130994">,</span>&nbsp;<span class="ident" id="8130996">n</span><span class="op" id="8130997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131000">for</span>&nbsp;<span class="ident" id="8131004">i</span>&nbsp;<span class="op" id="8131006">:=</span>&nbsp;<span class="num" id="8131009">0</span><span class="op" id="8131010">;</span>&nbsp;<span class="ident" id="8131012">i</span>&nbsp;<span class="op" id="8131014">&lt;</span>&nbsp;<span class="ident" id="8131016">n</span><span class="op" id="8131017">;</span>&nbsp;<span class="ident" id="8131019">i</span><span class="op" id="8131020">++</span>&nbsp;<span class="op" id="8131023">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131027">r</span><span class="op" id="8131028">[</span><span class="ident" id="8131029">i</span><span class="op" id="8131030">]</span>&nbsp;<span class="op" id="8131032">=</span>&nbsp;<span class="builtintype" id="8131034">byte</span><span class="op" id="8131038">(</span><span class="ident" id="8131039">rand</span><span class="op" id="8131043">.</span><span class="ident" id="8131044">Int31</span><span class="op" id="8131049">(</span><span class="op" id="8131050">)</span><span class="op" id="8131051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8131054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131057">return</span>&nbsp;<span class="ident" id="8131064">r</span><br>
<span class="lineno"></span><span class="op" id="8131066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="8131069">func</span>&nbsp;<span class="ident" id="8131074">randomString</span><span class="op" id="8131086">(</span><span class="ident" id="8131087">n</span>&nbsp;<span class="builtintype" id="8131089">int</span><span class="op" id="8131092">,</span>&nbsp;<span class="ident" id="8131094">rand</span>&nbsp;<span class="op" id="8131099">*</span><span class="ident" id="8131100">rand</span><span class="op" id="8131104">.</span><span class="ident" id="8131105">Rand</span><span class="op" id="8131109">)</span>&nbsp;<span class="builtintype" id="8131111">string</span>&nbsp;<span class="op" id="8131118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131121">b</span>&nbsp;<span class="op" id="8131123">:=</span>&nbsp;<span class="ident" id="8131126">randomBytes</span><span class="op" id="8131137">(</span><span class="ident" id="8131138">n</span><span class="op" id="8131139">,</span>&nbsp;<span class="ident" id="8131141">rand</span><span class="op" id="8131145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131148">return</span>&nbsp;<span class="builtintype" id="8131155">string</span><span class="op" id="8131161">(</span><span class="ident" id="8131162">b</span><span class="op" id="8131163">)</span><br>
<span class="lineno"></span><span class="op" id="8131165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8131168">func</span>&nbsp;<span class="op" id="8131173">(</span><span class="op" id="8131174">*</span><span class="ident" id="8131175">clientHelloMsg</span><span class="op" id="8131189">)</span>&nbsp;<span class="ident" id="8131191">Generate</span><span class="op" id="8131199">(</span><span class="ident" id="8131200">rand</span>&nbsp;<span class="op" id="8131205">*</span><span class="ident" id="8131206">rand</span><span class="op" id="8131210">.</span><span class="ident" id="8131211">Rand</span><span class="op" id="8131215">,</span>&nbsp;<span class="ident" id="8131217">size</span>&nbsp;<span class="builtintype" id="8131222">int</span><span class="op" id="8131225">)</span>&nbsp;<span class="ident" id="8131227">reflect</span><span class="op" id="8131234">.</span><span class="ident" id="8131235">Value</span>&nbsp;<span class="op" id="8131241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131244">m</span>&nbsp;<span class="op" id="8131246">:=</span>&nbsp;<span class="op" id="8131249">&amp;</span><span class="ident" id="8131250">clientHelloMsg</span><span class="op" id="8131264">{</span><span class="op" id="8131265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131268">m</span><span class="op" id="8131269">.</span><span class="ident" id="8131270">vers</span>&nbsp;<span class="op" id="8131275">=</span>&nbsp;<span class="builtintype" id="8131277">uint16</span><span class="op" id="8131283">(</span><span class="ident" id="8131284">rand</span><span class="op" id="8131288">.</span><span class="ident" id="8131289">Intn</span><span class="op" id="8131293">(</span><span class="num" id="8131294">65536</span><span class="op" id="8131299">)</span><span class="op" id="8131300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131303">m</span><span class="op" id="8131304">.</span><span class="ident" id="8131305">random</span>&nbsp;<span class="op" id="8131312">=</span>&nbsp;<span class="ident" id="8131314">randomBytes</span><span class="op" id="8131325">(</span><span class="num" id="8131326">32</span><span class="op" id="8131328">,</span>&nbsp;<span class="ident" id="8131330">rand</span><span class="op" id="8131334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131337">m</span><span class="op" id="8131338">.</span><span class="ident" id="8131339">sessionId</span>&nbsp;<span class="op" id="8131349">=</span>&nbsp;<span class="ident" id="8131351">randomBytes</span><span class="op" id="8131362">(</span><span class="ident" id="8131363">rand</span><span class="op" id="8131367">.</span><span class="ident" id="8131368">Intn</span><span class="op" id="8131372">(</span><span class="num" id="8131373">32</span><span class="op" id="8131375">)</span><span class="op" id="8131376">,</span>&nbsp;<span class="ident" id="8131378">rand</span><span class="op" id="8131382">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131385">m</span><span class="op" id="8131386">.</span><span class="ident" id="8131387">cipherSuites</span>&nbsp;<span class="op" id="8131400">=</span>&nbsp;<span class="builtinfunc" id="8131402">make</span><span class="op" id="8131406">(</span><span class="op" id="8131407">[</span><span class="op" id="8131408">]</span><span class="builtintype" id="8131409">uint16</span><span class="op" id="8131415">,</span>&nbsp;<span class="ident" id="8131417">rand</span><span class="op" id="8131421">.</span><span class="ident" id="8131422">Intn</span><span class="op" id="8131426">(</span><span class="num" id="8131427">63</span><span class="op" id="8131429">)</span><span class="op" id="8131430">+</span><span class="num" id="8131431">1</span><span class="op" id="8131432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131435">for</span>&nbsp;<span class="ident" id="8131439">i</span>&nbsp;<span class="op" id="8131441">:=</span>&nbsp;<span class="num" id="8131444">0</span><span class="op" id="8131445">;</span>&nbsp;<span class="ident" id="8131447">i</span>&nbsp;<span class="op" id="8131449">&lt;</span>&nbsp;<span class="builtinfunc" id="8131451">len</span><span class="op" id="8131454">(</span><span class="ident" id="8131455">m</span><span class="op" id="8131456">.</span><span class="ident" id="8131457">cipherSuites</span><span class="op" id="8131469">)</span><span class="op" id="8131470">;</span>&nbsp;<span class="ident" id="8131472">i</span><span class="op" id="8131473">++</span>&nbsp;<span class="op" id="8131476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131480">m</span><span class="op" id="8131481">.</span><span class="ident" id="8131482">cipherSuites</span><span class="op" id="8131494">[</span><span class="ident" id="8131495">i</span><span class="op" id="8131496">]</span>&nbsp;<span class="op" id="8131498">=</span>&nbsp;<span class="builtintype" id="8131500">uint16</span><span class="op" id="8131506">(</span><span class="ident" id="8131507">rand</span><span class="op" id="8131511">.</span><span class="ident" id="8131512">Int31</span><span class="op" id="8131517">(</span><span class="op" id="8131518">)</span><span class="op" id="8131519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8131522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131525">m</span><span class="op" id="8131526">.</span><span class="ident" id="8131527">compressionMethods</span>&nbsp;<span class="op" id="8131546">=</span>&nbsp;<span class="ident" id="8131548">randomBytes</span><span class="op" id="8131559">(</span><span class="ident" id="8131560">rand</span><span class="op" id="8131564">.</span><span class="ident" id="8131565">Intn</span><span class="op" id="8131569">(</span><span class="num" id="8131570">63</span><span class="op" id="8131572">)</span><span class="op" id="8131573">+</span><span class="num" id="8131574">1</span><span class="op" id="8131575">,</span>&nbsp;<span class="ident" id="8131577">rand</span><span class="op" id="8131581">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131584">if</span>&nbsp;<span class="ident" id="8131587">rand</span><span class="op" id="8131591">.</span><span class="ident" id="8131592">Intn</span><span class="op" id="8131596">(</span><span class="num" id="8131597">10</span><span class="op" id="8131599">)</span>&nbsp;<span class="op" id="8131601">&gt;</span>&nbsp;<span class="num" id="8131603">5</span>&nbsp;<span class="op" id="8131605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131609">m</span><span class="op" id="8131610">.</span><span class="ident" id="8131611">nextProtoNeg</span>&nbsp;<span class="op" id="8131624">=</span>&nbsp;<span class="builtintype" id="8131626">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8131632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131635">if</span>&nbsp;<span class="ident" id="8131638">rand</span><span class="op" id="8131642">.</span><span class="ident" id="8131643">Intn</span><span class="op" id="8131647">(</span><span class="num" id="8131648">10</span><span class="op" id="8131650">)</span>&nbsp;<span class="op" id="8131652">&gt;</span>&nbsp;<span class="num" id="8131654">5</span>&nbsp;<span class="op" id="8131656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131660">m</span><span class="op" id="8131661">.</span><span class="ident" id="8131662">serverName</span>&nbsp;<span class="op" id="8131673">=</span>&nbsp;<span class="ident" id="8131675">randomString</span><span class="op" id="8131687">(</span><span class="ident" id="8131688">rand</span><span class="op" id="8131692">.</span><span class="ident" id="8131693">Intn</span><span class="op" id="8131697">(</span><span class="num" id="8131698">255</span><span class="op" id="8131701">)</span><span class="op" id="8131702">,</span>&nbsp;<span class="ident" id="8131704">rand</span><span class="op" id="8131708">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8131711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131714">m</span><span class="op" id="8131715">.</span><span class="ident" id="8131716">ocspStapling</span>&nbsp;<span class="op" id="8131729">=</span>&nbsp;<span class="ident" id="8131731">rand</span><span class="op" id="8131735">.</span><span class="ident" id="8131736">Intn</span><span class="op" id="8131740">(</span><span class="num" id="8131741">10</span><span class="op" id="8131743">)</span>&nbsp;<span class="op" id="8131745">&gt;</span>&nbsp;<span class="num" id="8131747">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131750">m</span><span class="op" id="8131751">.</span><span class="ident" id="8131752">supportedPoints</span>&nbsp;<span class="op" id="8131768">=</span>&nbsp;<span class="ident" id="8131770">randomBytes</span><span class="op" id="8131781">(</span><span class="ident" id="8131782">rand</span><span class="op" id="8131786">.</span><span class="ident" id="8131787">Intn</span><span class="op" id="8131791">(</span><span class="num" id="8131792">5</span><span class="op" id="8131793">)</span><span class="op" id="8131794">+</span><span class="num" id="8131795">1</span><span class="op" id="8131796">,</span>&nbsp;<span class="ident" id="8131798">rand</span><span class="op" id="8131802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131805">m</span><span class="op" id="8131806">.</span><span class="ident" id="8131807">supportedCurves</span>&nbsp;<span class="op" id="8131823">=</span>&nbsp;<span class="builtinfunc" id="8131825">make</span><span class="op" id="8131829">(</span><span class="op" id="8131830">[</span><span class="op" id="8131831">]</span><span class="ident" id="8131832">CurveID</span><span class="op" id="8131839">,</span>&nbsp;<span class="ident" id="8131841">rand</span><span class="op" id="8131845">.</span><span class="ident" id="8131846">Intn</span><span class="op" id="8131850">(</span><span class="num" id="8131851">5</span><span class="op" id="8131852">)</span><span class="op" id="8131853">+</span><span class="num" id="8131854">1</span><span class="op" id="8131855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131858">for</span>&nbsp;<span class="ident" id="8131862">i</span>&nbsp;<span class="op" id="8131864">:=</span>&nbsp;<span class="keyword" id="8131867">range</span>&nbsp;<span class="ident" id="8131873">m</span><span class="op" id="8131874">.</span><span class="ident" id="8131875">supportedCurves</span>&nbsp;<span class="op" id="8131891">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131895">m</span><span class="op" id="8131896">.</span><span class="ident" id="8131897">supportedCurves</span><span class="op" id="8131912">[</span><span class="ident" id="8131913">i</span><span class="op" id="8131914">]</span>&nbsp;<span class="op" id="8131916">=</span>&nbsp;<span class="ident" id="8131918">CurveID</span><span class="op" id="8131925">(</span><span class="ident" id="8131926">rand</span><span class="op" id="8131930">.</span><span class="ident" id="8131931">Intn</span><span class="op" id="8131935">(</span><span class="num" id="8131936">30000</span><span class="op" id="8131941">)</span><span class="op" id="8131942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8131945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131948">if</span>&nbsp;<span class="ident" id="8131951">rand</span><span class="op" id="8131955">.</span><span class="ident" id="8131956">Intn</span><span class="op" id="8131960">(</span><span class="num" id="8131961">10</span><span class="op" id="8131963">)</span>&nbsp;<span class="op" id="8131965">&gt;</span>&nbsp;<span class="num" id="8131967">5</span>&nbsp;<span class="op" id="8131969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131973">m</span><span class="op" id="8131974">.</span><span class="ident" id="8131975">ticketSupported</span>&nbsp;<span class="op" id="8131991">=</span>&nbsp;<span class="builtintype" id="8131993">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132000">if</span>&nbsp;<span class="ident" id="8132003">rand</span><span class="op" id="8132007">.</span><span class="ident" id="8132008">Intn</span><span class="op" id="8132012">(</span><span class="num" id="8132013">10</span><span class="op" id="8132015">)</span>&nbsp;<span class="op" id="8132017">&gt;</span>&nbsp;<span class="num" id="8132019">5</span>&nbsp;<span class="op" id="8132021">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132026">m</span><span class="op" id="8132027">.</span><span class="ident" id="8132028">sessionTicket</span>&nbsp;<span class="op" id="8132042">=</span>&nbsp;<span class="ident" id="8132044">randomBytes</span><span class="op" id="8132055">(</span><span class="ident" id="8132056">rand</span><span class="op" id="8132060">.</span><span class="ident" id="8132061">Intn</span><span class="op" id="8132065">(</span><span class="num" id="8132066">300</span><span class="op" id="8132069">)</span><span class="op" id="8132070">,</span>&nbsp;<span class="ident" id="8132072">rand</span><span class="op" id="8132076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132086">if</span>&nbsp;<span class="ident" id="8132089">rand</span><span class="op" id="8132093">.</span><span class="ident" id="8132094">Intn</span><span class="op" id="8132098">(</span><span class="num" id="8132099">10</span><span class="op" id="8132101">)</span>&nbsp;<span class="op" id="8132103">&gt;</span>&nbsp;<span class="num" id="8132105">5</span>&nbsp;<span class="op" id="8132107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132111">m</span><span class="op" id="8132112">.</span><span class="ident" id="8132113">signatureAndHashes</span>&nbsp;<span class="op" id="8132132">=</span>&nbsp;<span class="ident" id="8132134">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132170">m</span><span class="op" id="8132171">.</span><span class="ident" id="8132172">alpnProtocols</span>&nbsp;<span class="op" id="8132186">=</span>&nbsp;<span class="builtinfunc" id="8132188">make</span><span class="op" id="8132192">(</span><span class="op" id="8132193">[</span><span class="op" id="8132194">]</span><span class="builtintype" id="8132195">string</span><span class="op" id="8132201">,</span>&nbsp;<span class="ident" id="8132203">rand</span><span class="op" id="8132207">.</span><span class="ident" id="8132208">Intn</span><span class="op" id="8132212">(</span><span class="num" id="8132213">5</span><span class="op" id="8132214">)</span><span class="op" id="8132215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132218">for</span>&nbsp;<span class="ident" id="8132222">i</span>&nbsp;<span class="op" id="8132224">:=</span>&nbsp;<span class="keyword" id="8132227">range</span>&nbsp;<span class="ident" id="8132233">m</span><span class="op" id="8132234">.</span><span class="ident" id="8132235">alpnProtocols</span>&nbsp;<span class="op" id="8132249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132253">m</span><span class="op" id="8132254">.</span><span class="ident" id="8132255">alpnProtocols</span><span class="op" id="8132268">[</span><span class="ident" id="8132269">i</span><span class="op" id="8132270">]</span>&nbsp;<span class="op" id="8132272">=</span>&nbsp;<span class="ident" id="8132274">randomString</span><span class="op" id="8132286">(</span><span class="ident" id="8132287">rand</span><span class="op" id="8132291">.</span><span class="ident" id="8132292">Intn</span><span class="op" id="8132296">(</span><span class="num" id="8132297">20</span><span class="op" id="8132299">)</span><span class="op" id="8132300">+</span><span class="num" id="8132301">1</span><span class="op" id="8132302">,</span>&nbsp;<span class="ident" id="8132304">rand</span><span class="op" id="8132308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132311">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132315">return</span>&nbsp;<span class="ident" id="8132322">reflect</span><span class="op" id="8132329">.</span><span class="ident" id="8132330">ValueOf</span><span class="op" id="8132337">(</span><span class="ident" id="8132338">m</span><span class="op" id="8132339">)</span><br>
<span class="lineno"></span><span class="op" id="8132341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8132344">func</span>&nbsp;<span class="op" id="8132349">(</span><span class="op" id="8132350">*</span><span class="ident" id="8132351">serverHelloMsg</span><span class="op" id="8132365">)</span>&nbsp;<span class="ident" id="8132367">Generate</span><span class="op" id="8132375">(</span><span class="ident" id="8132376">rand</span>&nbsp;<span class="op" id="8132381">*</span><span class="ident" id="8132382">rand</span><span class="op" id="8132386">.</span><span class="ident" id="8132387">Rand</span><span class="op" id="8132391">,</span>&nbsp;<span class="ident" id="8132393">size</span>&nbsp;<span class="builtintype" id="8132398">int</span><span class="op" id="8132401">)</span>&nbsp;<span class="ident" id="8132403">reflect</span><span class="op" id="8132410">.</span><span class="ident" id="8132411">Value</span>&nbsp;<span class="op" id="8132417">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132420">m</span>&nbsp;<span class="op" id="8132422">:=</span>&nbsp;<span class="op" id="8132425">&amp;</span><span class="ident" id="8132426">serverHelloMsg</span><span class="op" id="8132440">{</span><span class="op" id="8132441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132444">m</span><span class="op" id="8132445">.</span><span class="ident" id="8132446">vers</span>&nbsp;<span class="op" id="8132451">=</span>&nbsp;<span class="builtintype" id="8132453">uint16</span><span class="op" id="8132459">(</span><span class="ident" id="8132460">rand</span><span class="op" id="8132464">.</span><span class="ident" id="8132465">Intn</span><span class="op" id="8132469">(</span><span class="num" id="8132470">65536</span><span class="op" id="8132475">)</span><span class="op" id="8132476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132479">m</span><span class="op" id="8132480">.</span><span class="ident" id="8132481">random</span>&nbsp;<span class="op" id="8132488">=</span>&nbsp;<span class="ident" id="8132490">randomBytes</span><span class="op" id="8132501">(</span><span class="num" id="8132502">32</span><span class="op" id="8132504">,</span>&nbsp;<span class="ident" id="8132506">rand</span><span class="op" id="8132510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132513">m</span><span class="op" id="8132514">.</span><span class="ident" id="8132515">sessionId</span>&nbsp;<span class="op" id="8132525">=</span>&nbsp;<span class="ident" id="8132527">randomBytes</span><span class="op" id="8132538">(</span><span class="ident" id="8132539">rand</span><span class="op" id="8132543">.</span><span class="ident" id="8132544">Intn</span><span class="op" id="8132548">(</span><span class="num" id="8132549">32</span><span class="op" id="8132551">)</span><span class="op" id="8132552">,</span>&nbsp;<span class="ident" id="8132554">rand</span><span class="op" id="8132558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132561">m</span><span class="op" id="8132562">.</span><span class="ident" id="8132563">cipherSuite</span>&nbsp;<span class="op" id="8132575">=</span>&nbsp;<span class="builtintype" id="8132577">uint16</span><span class="op" id="8132583">(</span><span class="ident" id="8132584">rand</span><span class="op" id="8132588">.</span><span class="ident" id="8132589">Int31</span><span class="op" id="8132594">(</span><span class="op" id="8132595">)</span><span class="op" id="8132596">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132599">m</span><span class="op" id="8132600">.</span><span class="ident" id="8132601">compressionMethod</span>&nbsp;<span class="op" id="8132619">=</span>&nbsp;<span class="builtintype" id="8132621">uint8</span><span class="op" id="8132626">(</span><span class="ident" id="8132627">rand</span><span class="op" id="8132631">.</span><span class="ident" id="8132632">Intn</span><span class="op" id="8132636">(</span><span class="num" id="8132637">256</span><span class="op" id="8132640">)</span><span class="op" id="8132641">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132645">if</span>&nbsp;<span class="ident" id="8132648">rand</span><span class="op" id="8132652">.</span><span class="ident" id="8132653">Intn</span><span class="op" id="8132657">(</span><span class="num" id="8132658">10</span><span class="op" id="8132660">)</span>&nbsp;<span class="op" id="8132662">&gt;</span>&nbsp;<span class="num" id="8132664">5</span>&nbsp;<span class="op" id="8132666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132670">m</span><span class="op" id="8132671">.</span><span class="ident" id="8132672">nextProtoNeg</span>&nbsp;<span class="op" id="8132685">=</span>&nbsp;<span class="builtintype" id="8132687">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132695">n</span>&nbsp;<span class="op" id="8132697">:=</span>&nbsp;<span class="ident" id="8132700">rand</span><span class="op" id="8132704">.</span><span class="ident" id="8132705">Intn</span><span class="op" id="8132709">(</span><span class="num" id="8132710">10</span><span class="op" id="8132712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132716">m</span><span class="op" id="8132717">.</span><span class="ident" id="8132718">nextProtos</span>&nbsp;<span class="op" id="8132729">=</span>&nbsp;<span class="builtinfunc" id="8132731">make</span><span class="op" id="8132735">(</span><span class="op" id="8132736">[</span><span class="op" id="8132737">]</span><span class="builtintype" id="8132738">string</span><span class="op" id="8132744">,</span>&nbsp;<span class="ident" id="8132746">n</span><span class="op" id="8132747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132751">for</span>&nbsp;<span class="ident" id="8132755">i</span>&nbsp;<span class="op" id="8132757">:=</span>&nbsp;<span class="num" id="8132760">0</span><span class="op" id="8132761">;</span>&nbsp;<span class="ident" id="8132763">i</span>&nbsp;<span class="op" id="8132765">&lt;</span>&nbsp;<span class="ident" id="8132767">n</span><span class="op" id="8132768">;</span>&nbsp;<span class="ident" id="8132770">i</span><span class="op" id="8132771">++</span>&nbsp;<span class="op" id="8132774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132779">m</span><span class="op" id="8132780">.</span><span class="ident" id="8132781">nextProtos</span><span class="op" id="8132791">[</span><span class="ident" id="8132792">i</span><span class="op" id="8132793">]</span>&nbsp;<span class="op" id="8132795">=</span>&nbsp;<span class="ident" id="8132797">randomString</span><span class="op" id="8132809">(</span><span class="num" id="8132810">20</span><span class="op" id="8132812">,</span>&nbsp;<span class="ident" id="8132814">rand</span><span class="op" id="8132818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132822">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132829">if</span>&nbsp;<span class="ident" id="8132832">rand</span><span class="op" id="8132836">.</span><span class="ident" id="8132837">Intn</span><span class="op" id="8132841">(</span><span class="num" id="8132842">10</span><span class="op" id="8132844">)</span>&nbsp;<span class="op" id="8132846">&gt;</span>&nbsp;<span class="num" id="8132848">5</span>&nbsp;<span class="op" id="8132850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132854">m</span><span class="op" id="8132855">.</span><span class="ident" id="8132856">ocspStapling</span>&nbsp;<span class="op" id="8132869">=</span>&nbsp;<span class="builtintype" id="8132871">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132877">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132880">if</span>&nbsp;<span class="ident" id="8132883">rand</span><span class="op" id="8132887">.</span><span class="ident" id="8132888">Intn</span><span class="op" id="8132892">(</span><span class="num" id="8132893">10</span><span class="op" id="8132895">)</span>&nbsp;<span class="op" id="8132897">&gt;</span>&nbsp;<span class="num" id="8132899">5</span>&nbsp;<span class="op" id="8132901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132905">m</span><span class="op" id="8132906">.</span><span class="ident" id="8132907">ticketSupported</span>&nbsp;<span class="op" id="8132923">=</span>&nbsp;<span class="builtintype" id="8132925">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132934">m</span><span class="op" id="8132935">.</span><span class="ident" id="8132936">alpnProtocol</span>&nbsp;<span class="op" id="8132949">=</span>&nbsp;<span class="ident" id="8132951">randomString</span><span class="op" id="8132963">(</span><span class="ident" id="8132964">rand</span><span class="op" id="8132968">.</span><span class="ident" id="8132969">Intn</span><span class="op" id="8132973">(</span><span class="num" id="8132974">32</span><span class="op" id="8132976">)</span><span class="op" id="8132977">+</span><span class="num" id="8132978">1</span><span class="op" id="8132979">,</span>&nbsp;<span class="ident" id="8132981">rand</span><span class="op" id="8132985">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132989">return</span>&nbsp;<span class="ident" id="8132996">reflect</span><span class="op" id="8133003">.</span><span class="ident" id="8133004">ValueOf</span><span class="op" id="8133011">(</span><span class="ident" id="8133012">m</span><span class="op" id="8133013">)</span><br>
<span class="lineno"></span><span class="op" id="8133015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8133018">func</span>&nbsp;<span class="op" id="8133023">(</span><span class="op" id="8133024">*</span><span class="ident" id="8133025">certificateMsg</span><span class="op" id="8133039">)</span>&nbsp;<span class="ident" id="8133041">Generate</span><span class="op" id="8133049">(</span><span class="ident" id="8133050">rand</span>&nbsp;<span class="op" id="8133055">*</span><span class="ident" id="8133056">rand</span><span class="op" id="8133060">.</span><span class="ident" id="8133061">Rand</span><span class="op" id="8133065">,</span>&nbsp;<span class="ident" id="8133067">size</span>&nbsp;<span class="builtintype" id="8133072">int</span><span class="op" id="8133075">)</span>&nbsp;<span class="ident" id="8133077">reflect</span><span class="op" id="8133084">.</span><span class="ident" id="8133085">Value</span>&nbsp;<span class="op" id="8133091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133094">m</span>&nbsp;<span class="op" id="8133096">:=</span>&nbsp;<span class="op" id="8133099">&amp;</span><span class="ident" id="8133100">certificateMsg</span><span class="op" id="8133114">{</span><span class="op" id="8133115">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133118">numCerts</span>&nbsp;<span class="op" id="8133127">:=</span>&nbsp;<span class="ident" id="8133130">rand</span><span class="op" id="8133134">.</span><span class="ident" id="8133135">Intn</span><span class="op" id="8133139">(</span><span class="num" id="8133140">20</span><span class="op" id="8133142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133145">m</span><span class="op" id="8133146">.</span><span class="ident" id="8133147">certificates</span>&nbsp;<span class="op" id="8133160">=</span>&nbsp;<span class="builtinfunc" id="8133162">make</span><span class="op" id="8133166">(</span><span class="op" id="8133167">[</span><span class="op" id="8133168">]</span><span class="op" id="8133169">[</span><span class="op" id="8133170">]</span><span class="builtintype" id="8133171">byte</span><span class="op" id="8133175">,</span>&nbsp;<span class="ident" id="8133177">numCerts</span><span class="op" id="8133185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8133188">for</span>&nbsp;<span class="ident" id="8133192">i</span>&nbsp;<span class="op" id="8133194">:=</span>&nbsp;<span class="num" id="8133197">0</span><span class="op" id="8133198">;</span>&nbsp;<span class="ident" id="8133200">i</span>&nbsp;<span class="op" id="8133202">&lt;</span>&nbsp;<span class="ident" id="8133204">numCerts</span><span class="op" id="8133212">;</span>&nbsp;<span class="ident" id="8133214">i</span><span class="op" id="8133215">++</span>&nbsp;<span class="op" id="8133218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133222">m</span><span class="op" id="8133223">.</span><span class="ident" id="8133224">certificates</span><span class="op" id="8133236">[</span><span class="ident" id="8133237">i</span><span class="op" id="8133238">]</span>&nbsp;<span class="op" id="8133240">=</span>&nbsp;<span class="ident" id="8133242">randomBytes</span><span class="op" id="8133253">(</span><span class="ident" id="8133254">rand</span><span class="op" id="8133258">.</span><span class="ident" id="8133259">Intn</span><span class="op" id="8133263">(</span><span class="num" id="8133264">10</span><span class="op" id="8133266">)</span><span class="op" id="8133267">+</span><span class="num" id="8133268">1</span><span class="op" id="8133269">,</span>&nbsp;<span class="ident" id="8133271">rand</span><span class="op" id="8133275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8133278">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8133281">return</span>&nbsp;<span class="ident" id="8133288">reflect</span><span class="op" id="8133295">.</span><span class="ident" id="8133296">ValueOf</span><span class="op" id="8133303">(</span><span class="ident" id="8133304">m</span><span class="op" id="8133305">)</span><br>
<span class="lineno"></span><span class="op" id="8133307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8133310">func</span>&nbsp;<span class="op" id="8133315">(</span><span class="op" id="8133316">*</span><span class="ident" id="8133317">certificateRequestMsg</span><span class="op" id="8133338">)</span>&nbsp;<span class="ident" id="8133340">Generate</span><span class="op" id="8133348">(</span><span class="ident" id="8133349">rand</span>&nbsp;<span class="op" id="8133354">*</span><span class="ident" id="8133355">rand</span><span class="op" id="8133359">.</span><span class="ident" id="8133360">Rand</span><span class="op" id="8133364">,</span>&nbsp;<span class="ident" id="8133366">size</span>&nbsp;<span class="builtintype" id="8133371">int</span><span class="op" id="8133374">)</span>&nbsp;<span class="ident" id="8133376">reflect</span><span class="op" id="8133383">.</span><span class="ident" id="8133384">Value</span>&nbsp;<span class="op" id="8133390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133393">m</span>&nbsp;<span class="op" id="8133395">:=</span>&nbsp;<span class="op" id="8133398">&amp;</span><span class="ident" id="8133399">certificateRequestMsg</span><span class="op" id="8133420">{</span><span class="op" id="8133421">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133424">m</span><span class="op" id="8133425">.</span><span class="ident" id="8133426">certificateTypes</span>&nbsp;<span class="op" id="8133443">=</span>&nbsp;<span class="ident" id="8133445">randomBytes</span><span class="op" id="8133456">(</span><span class="ident" id="8133457">rand</span><span class="op" id="8133461">.</span><span class="ident" id="8133462">Intn</span><span class="op" id="8133466">(</span><span class="num" id="8133467">5</span><span class="op" id="8133468">)</span><span class="op" id="8133469">+</span><span class="num" id="8133470">1</span><span class="op" id="8133471">,</span>&nbsp;<span class="ident" id="8133473">rand</span><span class="op" id="8133477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133480">numCAs</span>&nbsp;<span class="op" id="8133487">:=</span>&nbsp;<span class="ident" id="8133490">rand</span><span class="op" id="8133494">.</span><span class="ident" id="8133495">Intn</span><span class="op" id="8133499">(</span><span class="num" id="8133500">100</span><span class="op" id="8133503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133506">m</span><span class="op" id="8133507">.</span><span class="ident" id="8133508">certificateAuthorities</span>&nbsp;<span class="op" id="8133531">=</span>&nbsp;<span class="builtinfunc" id="8133533">make</span><span class="op" id="8133537">(</span><span class="op" id="8133538">[</span><span class="op" id="8133539">]</span><span class="op" id="8133540">[</span><span class="op" id="8133541">]</span><span class="builtintype" id="8133542">byte</span><span class="op" id="8133546">,</span>&nbsp;<span class="ident" id="8133548">numCAs</span><span class="op" id="8133554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8133557">for</span>&nbsp;<span class="ident" id="8133561">i</span>&nbsp;<span class="op" id="8133563">:=</span>&nbsp;<span class="num" id="8133566">0</span><span class="op" id="8133567">;</span>&nbsp;<span class="ident" id="8133569">i</span>&nbsp;<span class="op" id="8133571">&lt;</span>&nbsp;<span class="ident" id="8133573">numCAs</span><span class="op" id="8133579">;</span>&nbsp;<span class="ident" id="8133581">i</span><span class="op" id="8133582">++</span>&nbsp;<span class="op" id="8133585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133589">m</span><span class="op" id="8133590">.</span><span class="ident" id="8133591">certificateAuthorities</span><span class="op" id="8133613">[</span><span class="ident" id="8133614">i</span><span class="op" id="8133615">]</span>&nbsp;<span class="op" id="8133617">=</span>&nbsp;<span class="ident" id="8133619">randomBytes</span><span class="op" id="8133630">(</span><span class="ident" id="8133631">rand</span><span class="op" id="8133635">.</span><span class="ident" id="8133636">Intn</span><span class="op" id="8133640">(</span><span class="num" id="8133641">15</span><span class="op" id="8133643">)</span><span class="op" id="8133644">+</span><span class="num" id="8133645">1</span><span class="op" id="8133646">,</span>&nbsp;<span class="ident" id="8133648">rand</span><span class="op" id="8133652">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8133655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8133658">return</span>&nbsp;<span class="ident" id="8133665">reflect</span><span class="op" id="8133672">.</span><span class="ident" id="8133673">ValueOf</span><span class="op" id="8133680">(</span><span class="ident" id="8133681">m</span><span class="op" id="8133682">)</span><br>
<span class="lineno"></span><span class="op" id="8133684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8133687">func</span>&nbsp;<span class="op" id="8133692">(</span><span class="op" id="8133693">*</span><span class="ident" id="8133694">certificateVerifyMsg</span><span class="op" id="8133714">)</span>&nbsp;<span class="ident" id="8133716">Generate</span><span class="op" id="8133724">(</span><span class="ident" id="8133725">rand</span>&nbsp;<span class="op" id="8133730">*</span><span class="ident" id="8133731">rand</span><span class="op" id="8133735">.</span><span class="ident" id="8133736">Rand</span><span class="op" id="8133740">,</span>&nbsp;<span class="ident" id="8133742">size</span>&nbsp;<span class="builtintype" id="8133747">int</span><span class="op" id="8133750">)</span>&nbsp;<span class="ident" id="8133752">reflect</span><span class="op" id="8133759">.</span><span class="ident" id="8133760">Value</span>&nbsp;<span class="op" id="8133766">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133769">m</span>&nbsp;<span class="op" id="8133771">:=</span>&nbsp;<span class="op" id="8133774">&amp;</span><span class="ident" id="8133775">certificateVerifyMsg</span><span class="op" id="8133795">{</span><span class="op" id="8133796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133799">m</span><span class="op" id="8133800">.</span><span class="ident" id="8133801">signature</span>&nbsp;<span class="op" id="8133811">=</span>&nbsp;<span class="ident" id="8133813">randomBytes</span><span class="op" id="8133824">(</span><span class="ident" id="8133825">rand</span><span class="op" id="8133829">.</span><span class="ident" id="8133830">Intn</span><span class="op" id="8133834">(</span><span class="num" id="8133835">15</span><span class="op" id="8133837">)</span><span class="op" id="8133838">+</span><span class="num" id="8133839">1</span><span class="op" id="8133840">,</span>&nbsp;<span class="ident" id="8133842">rand</span><span class="op" id="8133846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8133849">return</span>&nbsp;<span class="ident" id="8133856">reflect</span><span class="op" id="8133863">.</span><span class="ident" id="8133864">ValueOf</span><span class="op" id="8133871">(</span><span class="ident" id="8133872">m</span><span class="op" id="8133873">)</span><br>
<span class="lineno"></span><span class="op" id="8133875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="8133878">func</span>&nbsp;<span class="op" id="8133883">(</span><span class="op" id="8133884">*</span><span class="ident" id="8133885">certificateStatusMsg</span><span class="op" id="8133905">)</span>&nbsp;<span class="ident" id="8133907">Generate</span><span class="op" id="8133915">(</span><span class="ident" id="8133916">rand</span>&nbsp;<span class="op" id="8133921">*</span><span class="ident" id="8133922">rand</span><span class="op" id="8133926">.</span><span class="ident" id="8133927">Rand</span><span class="op" id="8133931">,</span>&nbsp;<span class="ident" id="8133933">size</span>&nbsp;<span class="builtintype" id="8133938">int</span><span class="op" id="8133941">)</span>&nbsp;<span class="ident" id="8133943">reflect</span><span class="op" id="8133950">.</span><span class="ident" id="8133951">Value</span>&nbsp;<span class="op" id="8133957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8133960">m</span>&nbsp;<span class="op" id="8133962">:=</span>&nbsp;<span class="op" id="8133965">&amp;</span><span class="ident" id="8133966">certificateStatusMsg</span><span class="op" id="8133986">{</span><span class="op" id="8133987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8133990">if</span>&nbsp;<span class="ident" id="8133993">rand</span><span class="op" id="8133997">.</span><span class="ident" id="8133998">Intn</span><span class="op" id="8134002">(</span><span class="num" id="8134003">10</span><span class="op" id="8134005">)</span>&nbsp;<span class="op" id="8134007">&gt;</span>&nbsp;<span class="num" id="8134009">5</span>&nbsp;<span class="op" id="8134011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134015">m</span><span class="op" id="8134016">.</span><span class="ident" id="8134017">statusType</span>&nbsp;<span class="op" id="8134028">=</span>&nbsp;<span class="ident" id="8134030">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134047">m</span><span class="op" id="8134048">.</span><span class="ident" id="8134049">response</span>&nbsp;<span class="op" id="8134058">=</span>&nbsp;<span class="ident" id="8134060">randomBytes</span><span class="op" id="8134071">(</span><span class="ident" id="8134072">rand</span><span class="op" id="8134076">.</span><span class="ident" id="8134077">Intn</span><span class="op" id="8134081">(</span><span class="num" id="8134082">10</span><span class="op" id="8134084">)</span><span class="op" id="8134085">+</span><span class="num" id="8134086">1</span><span class="op" id="8134087">,</span>&nbsp;<span class="ident" id="8134089">rand</span><span class="op" id="8134093">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8134096">}</span>&nbsp;<span class="keyword" id="8134098">else</span>&nbsp;<span class="op" id="8134103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134107">m</span><span class="op" id="8134108">.</span><span class="ident" id="8134109">statusType</span>&nbsp;<span class="op" id="8134120">=</span>&nbsp;<span class="num" id="8134122">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8134126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8134129">return</span>&nbsp;<span class="ident" id="8134136">reflect</span><span class="op" id="8134143">.</span><span class="ident" id="8134144">ValueOf</span><span class="op" id="8134151">(</span><span class="ident" id="8134152">m</span><span class="op" id="8134153">)</span><br>
<span class="lineno"></span><span class="op" id="8134155">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="8134158">func</span>&nbsp;<span class="op" id="8134163">(</span><span class="op" id="8134164">*</span><span class="ident" id="8134165">clientKeyExchangeMsg</span><span class="op" id="8134185">)</span>&nbsp;<span class="ident" id="8134187">Generate</span><span class="op" id="8134195">(</span><span class="ident" id="8134196">rand</span>&nbsp;<span class="op" id="8134201">*</span><span class="ident" id="8134202">rand</span><span class="op" id="8134206">.</span><span class="ident" id="8134207">Rand</span><span class="op" id="8134211">,</span>&nbsp;<span class="ident" id="8134213">size</span>&nbsp;<span class="builtintype" id="8134218">int</span><span class="op" id="8134221">)</span>&nbsp;<span class="ident" id="8134223">reflect</span><span class="op" id="8134230">.</span><span class="ident" id="8134231">Value</span>&nbsp;<span class="op" id="8134237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134240">m</span>&nbsp;<span class="op" id="8134242">:=</span>&nbsp;<span class="op" id="8134245">&amp;</span><span class="ident" id="8134246">clientKeyExchangeMsg</span><span class="op" id="8134266">{</span><span class="op" id="8134267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134270">m</span><span class="op" id="8134271">.</span><span class="ident" id="8134272">ciphertext</span>&nbsp;<span class="op" id="8134283">=</span>&nbsp;<span class="ident" id="8134285">randomBytes</span><span class="op" id="8134296">(</span><span class="ident" id="8134297">rand</span><span class="op" id="8134301">.</span><span class="ident" id="8134302">Intn</span><span class="op" id="8134306">(</span><span class="num" id="8134307">1000</span><span class="op" id="8134311">)</span><span class="op" id="8134312">+</span><span class="num" id="8134313">1</span><span class="op" id="8134314">,</span>&nbsp;<span class="ident" id="8134316">rand</span><span class="op" id="8134320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8134323">return</span>&nbsp;<span class="ident" id="8134330">reflect</span><span class="op" id="8134337">.</span><span class="ident" id="8134338">ValueOf</span><span class="op" id="8134345">(</span><span class="ident" id="8134346">m</span><span class="op" id="8134347">)</span><br>
<span class="lineno">220</span><span class="op" id="8134349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8134352">func</span>&nbsp;<span class="op" id="8134357">(</span><span class="op" id="8134358">*</span><span class="ident" id="8134359">finishedMsg</span><span class="op" id="8134370">)</span>&nbsp;<span class="ident" id="8134372">Generate</span><span class="op" id="8134380">(</span><span class="ident" id="8134381">rand</span>&nbsp;<span class="op" id="8134386">*</span><span class="ident" id="8134387">rand</span><span class="op" id="8134391">.</span><span class="ident" id="8134392">Rand</span><span class="op" id="8134396">,</span>&nbsp;<span class="ident" id="8134398">size</span>&nbsp;<span class="builtintype" id="8134403">int</span><span class="op" id="8134406">)</span>&nbsp;<span class="ident" id="8134408">reflect</span><span class="op" id="8134415">.</span><span class="ident" id="8134416">Value</span>&nbsp;<span class="op" id="8134422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134425">m</span>&nbsp;<span class="op" id="8134427">:=</span>&nbsp;<span class="op" id="8134430">&amp;</span><span class="ident" id="8134431">finishedMsg</span><span class="op" id="8134442">{</span><span class="op" id="8134443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134446">m</span><span class="op" id="8134447">.</span><span class="ident" id="8134448">verifyData</span>&nbsp;<span class="op" id="8134459">=</span>&nbsp;<span class="ident" id="8134461">randomBytes</span><span class="op" id="8134472">(</span><span class="num" id="8134473">12</span><span class="op" id="8134475">,</span>&nbsp;<span class="ident" id="8134477">rand</span><span class="op" id="8134481">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8134484">return</span>&nbsp;<span class="ident" id="8134491">reflect</span><span class="op" id="8134498">.</span><span class="ident" id="8134499">ValueOf</span><span class="op" id="8134506">(</span><span class="ident" id="8134507">m</span><span class="op" id="8134508">)</span><br>
<span class="lineno"></span><span class="op" id="8134510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8134513">func</span>&nbsp;<span class="op" id="8134518">(</span><span class="op" id="8134519">*</span><span class="ident" id="8134520">nextProtoMsg</span><span class="op" id="8134532">)</span>&nbsp;<span class="ident" id="8134534">Generate</span><span class="op" id="8134542">(</span><span class="ident" id="8134543">rand</span>&nbsp;<span class="op" id="8134548">*</span><span class="ident" id="8134549">rand</span><span class="op" id="8134553">.</span><span class="ident" id="8134554">Rand</span><span class="op" id="8134558">,</span>&nbsp;<span class="ident" id="8134560">size</span>&nbsp;<span class="builtintype" id="8134565">int</span><span class="op" id="8134568">)</span>&nbsp;<span class="ident" id="8134570">reflect</span><span class="op" id="8134577">.</span><span class="ident" id="8134578">Value</span>&nbsp;<span class="op" id="8134584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134587">m</span>&nbsp;<span class="op" id="8134589">:=</span>&nbsp;<span class="op" id="8134592">&amp;</span><span class="ident" id="8134593">nextProtoMsg</span><span class="op" id="8134605">{</span><span class="op" id="8134606">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134609">m</span><span class="op" id="8134610">.</span><span class="ident" id="8134611">proto</span>&nbsp;<span class="op" id="8134617">=</span>&nbsp;<span class="ident" id="8134619">randomString</span><span class="op" id="8134631">(</span><span class="ident" id="8134632">rand</span><span class="op" id="8134636">.</span><span class="ident" id="8134637">Intn</span><span class="op" id="8134641">(</span><span class="num" id="8134642">255</span><span class="op" id="8134645">)</span><span class="op" id="8134646">,</span>&nbsp;<span class="ident" id="8134648">rand</span><span class="op" id="8134652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8134655">return</span>&nbsp;<span class="ident" id="8134662">reflect</span><span class="op" id="8134669">.</span><span class="ident" id="8134670">ValueOf</span><span class="op" id="8134677">(</span><span class="ident" id="8134678">m</span><span class="op" id="8134679">)</span><br>
<span class="lineno"></span><span class="op" id="8134681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8134684">func</span>&nbsp;<span class="op" id="8134689">(</span><span class="op" id="8134690">*</span><span class="ident" id="8134691">newSessionTicketMsg</span><span class="op" id="8134710">)</span>&nbsp;<span class="ident" id="8134712">Generate</span><span class="op" id="8134720">(</span><span class="ident" id="8134721">rand</span>&nbsp;<span class="op" id="8134726">*</span><span class="ident" id="8134727">rand</span><span class="op" id="8134731">.</span><span class="ident" id="8134732">Rand</span><span class="op" id="8134736">,</span>&nbsp;<span class="ident" id="8134738">size</span>&nbsp;<span class="builtintype" id="8134743">int</span><span class="op" id="8134746">)</span>&nbsp;<span class="ident" id="8134748">reflect</span><span class="op" id="8134755">.</span><span class="ident" id="8134756">Value</span>&nbsp;<span class="op" id="8134762">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134765">m</span>&nbsp;<span class="op" id="8134767">:=</span>&nbsp;<span class="op" id="8134770">&amp;</span><span class="ident" id="8134771">newSessionTicketMsg</span><span class="op" id="8134790">{</span><span class="op" id="8134791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134794">m</span><span class="op" id="8134795">.</span><span class="ident" id="8134796">ticket</span>&nbsp;<span class="op" id="8134803">=</span>&nbsp;<span class="ident" id="8134805">randomBytes</span><span class="op" id="8134816">(</span><span class="ident" id="8134817">rand</span><span class="op" id="8134821">.</span><span class="ident" id="8134822">Intn</span><span class="op" id="8134826">(</span><span class="num" id="8134827">4</span><span class="op" id="8134828">)</span><span class="op" id="8134829">,</span>&nbsp;<span class="ident" id="8134831">rand</span><span class="op" id="8134835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8134838">return</span>&nbsp;<span class="ident" id="8134845">reflect</span><span class="op" id="8134852">.</span><span class="ident" id="8134853">ValueOf</span><span class="op" id="8134860">(</span><span class="ident" id="8134861">m</span><span class="op" id="8134862">)</span><br>
<span class="lineno"></span><span class="op" id="8134864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8134867">func</span>&nbsp;<span class="op" id="8134872">(</span><span class="op" id="8134873">*</span><span class="ident" id="8134874">sessionState</span><span class="op" id="8134886">)</span>&nbsp;<span class="ident" id="8134888">Generate</span><span class="op" id="8134896">(</span><span class="ident" id="8134897">rand</span>&nbsp;<span class="op" id="8134902">*</span><span class="ident" id="8134903">rand</span><span class="op" id="8134907">.</span><span class="ident" id="8134908">Rand</span><span class="op" id="8134912">,</span>&nbsp;<span class="ident" id="8134914">size</span>&nbsp;<span class="builtintype" id="8134919">int</span><span class="op" id="8134922">)</span>&nbsp;<span class="ident" id="8134924">reflect</span><span class="op" id="8134931">.</span><span class="ident" id="8134932">Value</span>&nbsp;<span class="op" id="8134938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134941">s</span>&nbsp;<span class="op" id="8134943">:=</span>&nbsp;<span class="op" id="8134946">&amp;</span><span class="ident" id="8134947">sessionState</span><span class="op" id="8134959">{</span><span class="op" id="8134960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134963">s</span><span class="op" id="8134964">.</span><span class="ident" id="8134965">vers</span>&nbsp;<span class="op" id="8134970">=</span>&nbsp;<span class="builtintype" id="8134972">uint16</span><span class="op" id="8134978">(</span><span class="ident" id="8134979">rand</span><span class="op" id="8134983">.</span><span class="ident" id="8134984">Intn</span><span class="op" id="8134988">(</span><span class="num" id="8134989">10000</span><span class="op" id="8134994">)</span><span class="op" id="8134995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8134998">s</span><span class="op" id="8134999">.</span><span class="ident" id="8135000">cipherSuite</span>&nbsp;<span class="op" id="8135012">=</span>&nbsp;<span class="builtintype" id="8135014">uint16</span><span class="op" id="8135020">(</span><span class="ident" id="8135021">rand</span><span class="op" id="8135025">.</span><span class="ident" id="8135026">Intn</span><span class="op" id="8135030">(</span><span class="num" id="8135031">10000</span><span class="op" id="8135036">)</span><span class="op" id="8135037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135040">s</span><span class="op" id="8135041">.</span><span class="ident" id="8135042">masterSecret</span>&nbsp;<span class="op" id="8135055">=</span>&nbsp;<span class="ident" id="8135057">randomBytes</span><span class="op" id="8135068">(</span><span class="ident" id="8135069">rand</span><span class="op" id="8135073">.</span><span class="ident" id="8135074">Intn</span><span class="op" id="8135078">(</span><span class="num" id="8135079">100</span><span class="op" id="8135082">)</span><span class="op" id="8135083">,</span>&nbsp;<span class="ident" id="8135085">rand</span><span class="op" id="8135089">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135092">numCerts</span>&nbsp;<span class="op" id="8135101">:=</span>&nbsp;<span class="ident" id="8135104">rand</span><span class="op" id="8135108">.</span><span class="ident" id="8135109">Intn</span><span class="op" id="8135113">(</span><span class="num" id="8135114">20</span><span class="op" id="8135116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135119">s</span><span class="op" id="8135120">.</span><span class="ident" id="8135121">certificates</span>&nbsp;<span class="op" id="8135134">=</span>&nbsp;<span class="builtinfunc" id="8135136">make</span><span class="op" id="8135140">(</span><span class="op" id="8135141">[</span><span class="op" id="8135142">]</span><span class="op" id="8135143">[</span><span class="op" id="8135144">]</span><span class="builtintype" id="8135145">byte</span><span class="op" id="8135149">,</span>&nbsp;<span class="ident" id="8135151">numCerts</span><span class="op" id="8135159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8135162">for</span>&nbsp;<span class="ident" id="8135166">i</span>&nbsp;<span class="op" id="8135168">:=</span>&nbsp;<span class="num" id="8135171">0</span><span class="op" id="8135172">;</span>&nbsp;<span class="ident" id="8135174">i</span>&nbsp;<span class="op" id="8135176">&lt;</span>&nbsp;<span class="ident" id="8135178">numCerts</span><span class="op" id="8135186">;</span>&nbsp;<span class="ident" id="8135188">i</span><span class="op" id="8135189">++</span>&nbsp;<span class="op" id="8135192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8135196">s</span><span class="op" id="8135197">.</span><span class="ident" id="8135198">certificates</span><span class="op" id="8135210">[</span><span class="ident" id="8135211">i</span><span class="op" id="8135212">]</span>&nbsp;<span class="op" id="8135214">=</span>&nbsp;<span class="ident" id="8135216">randomBytes</span><span class="op" id="8135227">(</span><span class="ident" id="8135228">rand</span><span class="op" id="8135232">.</span><span class="ident" id="8135233">Intn</span><span class="op" id="8135237">(</span><span class="num" id="8135238">10</span><span class="op" id="8135240">)</span><span class="op" id="8135241">+</span><span class="num" id="8135242">1</span><span class="op" id="8135243">,</span>&nbsp;<span class="ident" id="8135245">rand</span><span class="op" id="8135249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8135252">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8135255">return</span>&nbsp;<span class="ident" id="8135262">reflect</span><span class="op" id="8135269">.</span><span class="ident" id="8135270">ValueOf</span><span class="op" id="8135277">(</span><span class="ident" id="8135278">s</span><span class="op" id="8135279">)</span><br>
<span class="lineno"></span><span class="op" id="8135281">}</span>
</div>
</body>
</html>
