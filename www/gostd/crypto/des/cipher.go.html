<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html" class="current">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4326944">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4326999">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4327053">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4327104">package</span>&nbsp;<span class="ident" id="4327112">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4327117">import</span>&nbsp;<span class="op" id="4327124">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4327127">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4327144">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4327154">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4327157">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4327189">const</span>&nbsp;<span class="ident" id="4327195">BlockSize</span>&nbsp;<span class="op" id="4327205">=</span>&nbsp;<span class="num" id="4327207">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4327210">type</span>&nbsp;<span class="ident" id="4327215">KeySizeError</span>&nbsp;<span class="builtintype" id="4327228">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4327233">func</span>&nbsp;<span class="op" id="4327238">(</span><span class="ident" id="4327239">k</span>&nbsp;<span class="ident" id="4327241">KeySizeError</span><span class="op" id="4327253">)</span>&nbsp;<span class="ident" id="4327255">Error</span><span class="op" id="4327260">(</span><span class="op" id="4327261">)</span>&nbsp;<span class="builtintype" id="4327263">string</span>&nbsp;<span class="op" id="4327270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327273">return</span>&nbsp;<span class="string" id="4327280">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="4327312">+</span>&nbsp;<span class="ident" id="4327314">strconv</span><span class="op" id="4327321">.</span><span class="ident" id="4327322">Itoa</span><span class="op" id="4327326">(</span><span class="builtintype" id="4327327">int</span><span class="op" id="4327330">(</span><span class="ident" id="4327331">k</span><span class="op" id="4327332">)</span><span class="op" id="4327333">)</span><br>
<span class="lineno"></span><span class="op" id="4327335">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4327338">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4327385">type</span>&nbsp;<span class="ident" id="4327390">desCipher</span>&nbsp;<span class="keyword" id="4327400">struct</span>&nbsp;<span class="op" id="4327407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327410">subkeys</span>&nbsp;<span class="op" id="4327418">[</span><span class="num" id="4327419">16</span><span class="op" id="4327421">]</span><span class="builtintype" id="4327422">uint64</span><br>
<span class="lineno"></span><span class="op" id="4327429">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4327432">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4327485">func</span>&nbsp;<span class="ident" id="4327490">NewCipher</span><span class="op" id="4327499">(</span><span class="ident" id="4327500">key</span>&nbsp;<span class="op" id="4327504">[</span><span class="op" id="4327505">]</span><span class="builtintype" id="4327506">byte</span><span class="op" id="4327510">)</span>&nbsp;<span class="op" id="4327512">(</span><span class="ident" id="4327513">cipher</span><span class="op" id="4327519">.</span><span class="ident" id="4327520">Block</span><span class="op" id="4327525">,</span>&nbsp;<span class="builtintype" id="4327527">error</span><span class="op" id="4327532">)</span>&nbsp;<span class="op" id="4327534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327537">if</span>&nbsp;<span class="builtinfunc" id="4327540">len</span><span class="op" id="4327543">(</span><span class="ident" id="4327544">key</span><span class="op" id="4327547">)</span>&nbsp;<span class="op" id="4327549">!=</span>&nbsp;<span class="num" id="4327552">8</span>&nbsp;<span class="op" id="4327554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327558">return</span>&nbsp;<span class="builtintype" id="4327565">nil</span><span class="op" id="4327568">,</span>&nbsp;<span class="ident" id="4327570">KeySizeError</span><span class="op" id="4327582">(</span><span class="builtinfunc" id="4327583">len</span><span class="op" id="4327586">(</span><span class="ident" id="4327587">key</span><span class="op" id="4327590">)</span><span class="op" id="4327591">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4327594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327598">c</span>&nbsp;<span class="op" id="4327600">:=</span>&nbsp;<span class="builtinfunc" id="4327603">new</span><span class="op" id="4327606">(</span><span class="ident" id="4327607">desCipher</span><span class="op" id="4327616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327619">c</span><span class="op" id="4327620">.</span><span class="ident" id="4327621">generateSubkeys</span><span class="op" id="4327636">(</span><span class="ident" id="4327637">key</span><span class="op" id="4327640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327643">return</span>&nbsp;<span class="ident" id="4327650">c</span><span class="op" id="4327651">,</span>&nbsp;<span class="builtintype" id="4327653">nil</span><br>
<span class="lineno">35</span><span class="op" id="4327657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4327660">func</span>&nbsp;<span class="op" id="4327665">(</span><span class="ident" id="4327666">c</span>&nbsp;<span class="op" id="4327668">*</span><span class="ident" id="4327669">desCipher</span><span class="op" id="4327678">)</span>&nbsp;<span class="ident" id="4327680">BlockSize</span><span class="op" id="4327689">(</span><span class="op" id="4327690">)</span>&nbsp;<span class="builtintype" id="4327692">int</span>&nbsp;<span class="op" id="4327696">{</span>&nbsp;<span class="keyword" id="4327698">return</span>&nbsp;<span class="ident" id="4327705">BlockSize</span>&nbsp;<span class="op" id="4327715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4327718">func</span>&nbsp;<span class="op" id="4327723">(</span><span class="ident" id="4327724">c</span>&nbsp;<span class="op" id="4327726">*</span><span class="ident" id="4327727">desCipher</span><span class="op" id="4327736">)</span>&nbsp;<span class="ident" id="4327738">Encrypt</span><span class="op" id="4327745">(</span><span class="ident" id="4327746">dst</span><span class="op" id="4327749">,</span>&nbsp;<span class="ident" id="4327751">src</span>&nbsp;<span class="op" id="4327755">[</span><span class="op" id="4327756">]</span><span class="builtintype" id="4327757">byte</span><span class="op" id="4327761">)</span>&nbsp;<span class="op" id="4327763">{</span>&nbsp;<span class="ident" id="4327765">encryptBlock</span><span class="op" id="4327777">(</span><span class="ident" id="4327778">c</span><span class="op" id="4327779">.</span><span class="ident" id="4327780">subkeys</span><span class="op" id="4327787">[</span><span class="op" id="4327788">:</span><span class="op" id="4327789">]</span><span class="op" id="4327790">,</span>&nbsp;<span class="ident" id="4327792">dst</span><span class="op" id="4327795">,</span>&nbsp;<span class="ident" id="4327797">src</span><span class="op" id="4327800">)</span>&nbsp;<span class="op" id="4327802">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4327805">func</span>&nbsp;<span class="op" id="4327810">(</span><span class="ident" id="4327811">c</span>&nbsp;<span class="op" id="4327813">*</span><span class="ident" id="4327814">desCipher</span><span class="op" id="4327823">)</span>&nbsp;<span class="ident" id="4327825">Decrypt</span><span class="op" id="4327832">(</span><span class="ident" id="4327833">dst</span><span class="op" id="4327836">,</span>&nbsp;<span class="ident" id="4327838">src</span>&nbsp;<span class="op" id="4327842">[</span><span class="op" id="4327843">]</span><span class="builtintype" id="4327844">byte</span><span class="op" id="4327848">)</span>&nbsp;<span class="op" id="4327850">{</span>&nbsp;<span class="ident" id="4327852">decryptBlock</span><span class="op" id="4327864">(</span><span class="ident" id="4327865">c</span><span class="op" id="4327866">.</span><span class="ident" id="4327867">subkeys</span><span class="op" id="4327874">[</span><span class="op" id="4327875">:</span><span class="op" id="4327876">]</span><span class="op" id="4327877">,</span>&nbsp;<span class="ident" id="4327879">dst</span><span class="op" id="4327882">,</span>&nbsp;<span class="ident" id="4327884">src</span><span class="op" id="4327887">)</span>&nbsp;<span class="op" id="4327889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4327892">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4327953">type</span>&nbsp;<span class="ident" id="4327958">tripleDESCipher</span>&nbsp;<span class="keyword" id="4327974">struct</span>&nbsp;<span class="op" id="4327981">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327984">cipher1</span><span class="op" id="4327991">,</span>&nbsp;<span class="ident" id="4327993">cipher2</span><span class="op" id="4328000">,</span>&nbsp;<span class="ident" id="4328002">cipher3</span>&nbsp;<span class="ident" id="4328010">desCipher</span><br>
<span class="lineno"></span><span class="op" id="4328020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4328023">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4328085">func</span>&nbsp;<span class="ident" id="4328090">NewTripleDESCipher</span><span class="op" id="4328108">(</span><span class="ident" id="4328109">key</span>&nbsp;<span class="op" id="4328113">[</span><span class="op" id="4328114">]</span><span class="builtintype" id="4328115">byte</span><span class="op" id="4328119">)</span>&nbsp;<span class="op" id="4328121">(</span><span class="ident" id="4328122">cipher</span><span class="op" id="4328128">.</span><span class="ident" id="4328129">Block</span><span class="op" id="4328134">,</span>&nbsp;<span class="builtintype" id="4328136">error</span><span class="op" id="4328141">)</span>&nbsp;<span class="op" id="4328143">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4328146">if</span>&nbsp;<span class="builtinfunc" id="4328149">len</span><span class="op" id="4328152">(</span><span class="ident" id="4328153">key</span><span class="op" id="4328156">)</span>&nbsp;<span class="op" id="4328158">!=</span>&nbsp;<span class="num" id="4328161">24</span>&nbsp;<span class="op" id="4328164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4328168">return</span>&nbsp;<span class="builtintype" id="4328175">nil</span><span class="op" id="4328178">,</span>&nbsp;<span class="ident" id="4328180">KeySizeError</span><span class="op" id="4328192">(</span><span class="builtinfunc" id="4328193">len</span><span class="op" id="4328196">(</span><span class="ident" id="4328197">key</span><span class="op" id="4328200">)</span><span class="op" id="4328201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328208">c</span>&nbsp;<span class="op" id="4328210">:=</span>&nbsp;<span class="builtinfunc" id="4328213">new</span><span class="op" id="4328216">(</span><span class="ident" id="4328217">tripleDESCipher</span><span class="op" id="4328232">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328235">c</span><span class="op" id="4328236">.</span><span class="ident" id="4328237">cipher1</span><span class="op" id="4328244">.</span><span class="ident" id="4328245">generateSubkeys</span><span class="op" id="4328260">(</span><span class="ident" id="4328261">key</span><span class="op" id="4328264">[</span><span class="op" id="4328265">:</span><span class="num" id="4328266">8</span><span class="op" id="4328267">]</span><span class="op" id="4328268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328271">c</span><span class="op" id="4328272">.</span><span class="ident" id="4328273">cipher2</span><span class="op" id="4328280">.</span><span class="ident" id="4328281">generateSubkeys</span><span class="op" id="4328296">(</span><span class="ident" id="4328297">key</span><span class="op" id="4328300">[</span><span class="num" id="4328301">8</span><span class="op" id="4328302">:</span><span class="num" id="4328303">16</span><span class="op" id="4328305">]</span><span class="op" id="4328306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328309">c</span><span class="op" id="4328310">.</span><span class="ident" id="4328311">cipher3</span><span class="op" id="4328318">.</span><span class="ident" id="4328319">generateSubkeys</span><span class="op" id="4328334">(</span><span class="ident" id="4328335">key</span><span class="op" id="4328338">[</span><span class="num" id="4328339">16</span><span class="op" id="4328341">:</span><span class="op" id="4328342">]</span><span class="op" id="4328343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4328346">return</span>&nbsp;<span class="ident" id="4328353">c</span><span class="op" id="4328354">,</span>&nbsp;<span class="builtintype" id="4328356">nil</span><br>
<span class="lineno"></span><span class="op" id="4328360">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4328363">func</span>&nbsp;<span class="op" id="4328368">(</span><span class="ident" id="4328369">c</span>&nbsp;<span class="op" id="4328371">*</span><span class="ident" id="4328372">tripleDESCipher</span><span class="op" id="4328387">)</span>&nbsp;<span class="ident" id="4328389">BlockSize</span><span class="op" id="4328398">(</span><span class="op" id="4328399">)</span>&nbsp;<span class="builtintype" id="4328401">int</span>&nbsp;<span class="op" id="4328405">{</span>&nbsp;<span class="keyword" id="4328407">return</span>&nbsp;<span class="ident" id="4328414">BlockSize</span>&nbsp;<span class="op" id="4328424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4328427">func</span>&nbsp;<span class="op" id="4328432">(</span><span class="ident" id="4328433">c</span>&nbsp;<span class="op" id="4328435">*</span><span class="ident" id="4328436">tripleDESCipher</span><span class="op" id="4328451">)</span>&nbsp;<span class="ident" id="4328453">Encrypt</span><span class="op" id="4328460">(</span><span class="ident" id="4328461">dst</span><span class="op" id="4328464">,</span>&nbsp;<span class="ident" id="4328466">src</span>&nbsp;<span class="op" id="4328470">[</span><span class="op" id="4328471">]</span><span class="builtintype" id="4328472">byte</span><span class="op" id="4328476">)</span>&nbsp;<span class="op" id="4328478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328481">c</span><span class="op" id="4328482">.</span><span class="ident" id="4328483">cipher1</span><span class="op" id="4328490">.</span><span class="ident" id="4328491">Encrypt</span><span class="op" id="4328498">(</span><span class="ident" id="4328499">dst</span><span class="op" id="4328502">,</span>&nbsp;<span class="ident" id="4328504">src</span><span class="op" id="4328507">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328510">c</span><span class="op" id="4328511">.</span><span class="ident" id="4328512">cipher2</span><span class="op" id="4328519">.</span><span class="ident" id="4328520">Decrypt</span><span class="op" id="4328527">(</span><span class="ident" id="4328528">dst</span><span class="op" id="4328531">,</span>&nbsp;<span class="ident" id="4328533">dst</span><span class="op" id="4328536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328539">c</span><span class="op" id="4328540">.</span><span class="ident" id="4328541">cipher3</span><span class="op" id="4328548">.</span><span class="ident" id="4328549">Encrypt</span><span class="op" id="4328556">(</span><span class="ident" id="4328557">dst</span><span class="op" id="4328560">,</span>&nbsp;<span class="ident" id="4328562">dst</span><span class="op" id="4328565">)</span><br>
<span class="lineno"></span><span class="op" id="4328567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4328570">func</span>&nbsp;<span class="op" id="4328575">(</span><span class="ident" id="4328576">c</span>&nbsp;<span class="op" id="4328578">*</span><span class="ident" id="4328579">tripleDESCipher</span><span class="op" id="4328594">)</span>&nbsp;<span class="ident" id="4328596">Decrypt</span><span class="op" id="4328603">(</span><span class="ident" id="4328604">dst</span><span class="op" id="4328607">,</span>&nbsp;<span class="ident" id="4328609">src</span>&nbsp;<span class="op" id="4328613">[</span><span class="op" id="4328614">]</span><span class="builtintype" id="4328615">byte</span><span class="op" id="4328619">)</span>&nbsp;<span class="op" id="4328621">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328624">c</span><span class="op" id="4328625">.</span><span class="ident" id="4328626">cipher3</span><span class="op" id="4328633">.</span><span class="ident" id="4328634">Decrypt</span><span class="op" id="4328641">(</span><span class="ident" id="4328642">dst</span><span class="op" id="4328645">,</span>&nbsp;<span class="ident" id="4328647">src</span><span class="op" id="4328650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328653">c</span><span class="op" id="4328654">.</span><span class="ident" id="4328655">cipher2</span><span class="op" id="4328662">.</span><span class="ident" id="4328663">Encrypt</span><span class="op" id="4328670">(</span><span class="ident" id="4328671">dst</span><span class="op" id="4328674">,</span>&nbsp;<span class="ident" id="4328676">dst</span><span class="op" id="4328679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328682">c</span><span class="op" id="4328683">.</span><span class="ident" id="4328684">cipher1</span><span class="op" id="4328691">.</span><span class="ident" id="4328692">Decrypt</span><span class="op" id="4328699">(</span><span class="ident" id="4328700">dst</span><span class="op" id="4328703">,</span>&nbsp;<span class="ident" id="4328705">dst</span><span class="op" id="4328708">)</span><br>
<span class="lineno"></span><span class="op" id="4328710">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
