<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html" class="current">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4805013">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4805069">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4805123">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4805174">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4805244">package</span>&nbsp;<span class="ident" id="4805252">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4805258">import</span>&nbsp;<span class="op" id="4805265">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4805268">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4805278">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4805284">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4805294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4805297">//&nbsp;ErrNotFound&nbsp;is&nbsp;the&nbsp;error&nbsp;resulting&nbsp;if&nbsp;a&nbsp;path&nbsp;search&nbsp;failed&nbsp;to&nbsp;find&nbsp;an&nbsp;executable&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4805387">var</span>&nbsp;<span class="ident" id="4805391">ErrNotFound</span>&nbsp;<span class="op" id="4805403">=</span>&nbsp;<span class="ident" id="4805405">errors</span><span class="op" id="4805411">.</span><span class="ident" id="4805412">New</span><span class="op" id="4805415">(</span><span class="string" id="4805416">&#34;executable&nbsp;file&nbsp;not&nbsp;found&nbsp;in&nbsp;$PATH&#34;</span><span class="op" id="4805452">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4805455">func</span>&nbsp;<span class="ident" id="4805460">findExecutable</span><span class="op" id="4805474">(</span><span class="ident" id="4805475">file</span>&nbsp;<span class="builtintype" id="4805480">string</span><span class="op" id="4805486">)</span>&nbsp;<span class="builtintype" id="4805488">error</span>&nbsp;<span class="op" id="4805494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4805497">d</span><span class="op" id="4805498">,</span>&nbsp;<span class="ident" id="4805500">err</span>&nbsp;<span class="op" id="4805504">:=</span>&nbsp;<span class="ident" id="4805507">os</span><span class="op" id="4805509">.</span><span class="ident" id="4805510">Stat</span><span class="op" id="4805514">(</span><span class="ident" id="4805515">file</span><span class="op" id="4805519">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805522">if</span>&nbsp;<span class="ident" id="4805525">err</span>&nbsp;<span class="op" id="4805529">!=</span>&nbsp;<span class="ident" id="4805532">nil</span>&nbsp;<span class="op" id="4805536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805540">return</span>&nbsp;<span class="ident" id="4805547">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805555">if</span>&nbsp;<span class="ident" id="4805558">m</span>&nbsp;<span class="op" id="4805560">:=</span>&nbsp;<span class="ident" id="4805563">d</span><span class="op" id="4805564">.</span><span class="ident" id="4805565">Mode</span><span class="op" id="4805569">(</span><span class="op" id="4805570">)</span><span class="op" id="4805571">;</span>&nbsp;<span class="op" id="4805573">!</span><span class="ident" id="4805574">m</span><span class="op" id="4805575">.</span><span class="ident" id="4805576">IsDir</span><span class="op" id="4805581">(</span><span class="op" id="4805582">)</span>&nbsp;<span class="op" id="4805584">&amp;&amp;</span>&nbsp;<span class="ident" id="4805587">m</span><span class="op" id="4805588">&amp;</span><span class="num" id="4805589">0111</span>&nbsp;<span class="op" id="4805594">!=</span>&nbsp;<span class="num" id="4805597">0</span>&nbsp;<span class="op" id="4805599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805603">return</span>&nbsp;<span class="ident" id="4805610">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4805615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4805618">return</span>&nbsp;<span class="ident" id="4805625">os</span><span class="op" id="4805627">.</span><span class="ident" id="4805628">ErrPermission</span><br>
<span class="lineno"></span><span class="op" id="4805642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4805645">//&nbsp;LookPath&nbsp;searches&nbsp;for&nbsp;an&nbsp;executable&nbsp;binary&nbsp;named&nbsp;file</span><br>
<span class="lineno">30</span><span class="comment" id="4805702">//&nbsp;in&nbsp;the&nbsp;directories&nbsp;named&nbsp;by&nbsp;the&nbsp;PATH&nbsp;environment&nbsp;variable.</span><br>
<span class="lineno"></span><span class="comment" id="4805764">//&nbsp;If&nbsp;file&nbsp;contains&nbsp;a&nbsp;slash,&nbsp;it&nbsp;is&nbsp;tried&nbsp;directly&nbsp;and&nbsp;the&nbsp;PATH&nbsp;is&nbsp;not&nbsp;consulted.</span><br>
<span class="lineno"></span><span class="comment" id="4805845">//&nbsp;The&nbsp;result&nbsp;may&nbsp;be&nbsp;an&nbsp;absolute&nbsp;path&nbsp;or&nbsp;a&nbsp;path&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="4805928">func</span>&nbsp;<span class="ident" id="4805933">LookPath</span><span class="op" id="4805941">(</span><span class="ident" id="4805942">file</span>&nbsp;<span class="builtintype" id="4805947">string</span><span class="op" id="4805953">)</span>&nbsp;<span class="op" id="4805955">(</span><span class="builtintype" id="4805956">string</span><span class="op" id="4805962">,</span>&nbsp;<span class="builtintype" id="4805964">error</span><span class="op" id="4805969">)</span>&nbsp;<span class="op" id="4805971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4805974">//&nbsp;NOTE(rsc):&nbsp;I&nbsp;wish&nbsp;we&nbsp;could&nbsp;use&nbsp;the&nbsp;Plan&nbsp;9&nbsp;behavior&nbsp;here</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4806034">//&nbsp;(only&nbsp;bypass&nbsp;the&nbsp;path&nbsp;if&nbsp;file&nbsp;begins&nbsp;with&nbsp;/&nbsp;or&nbsp;./&nbsp;or&nbsp;../)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4806096">//&nbsp;but&nbsp;that&nbsp;would&nbsp;not&nbsp;match&nbsp;all&nbsp;the&nbsp;Unix&nbsp;shells.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806147">if</span>&nbsp;<span class="ident" id="4806150">strings</span><span class="op" id="4806157">.</span><span class="ident" id="4806158">Contains</span><span class="op" id="4806166">(</span><span class="ident" id="4806167">file</span><span class="op" id="4806171">,</span>&nbsp;<span class="string" id="4806173">&#34;/&#34;</span><span class="op" id="4806176">)</span>&nbsp;<span class="op" id="4806178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806182">err</span>&nbsp;<span class="op" id="4806186">:=</span>&nbsp;<span class="ident" id="4806189">findExecutable</span><span class="op" id="4806203">(</span><span class="ident" id="4806204">file</span><span class="op" id="4806208">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806212">if</span>&nbsp;<span class="ident" id="4806215">err</span>&nbsp;<span class="op" id="4806219">==</span>&nbsp;<span class="ident" id="4806222">nil</span>&nbsp;<span class="op" id="4806226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806231">return</span>&nbsp;<span class="ident" id="4806238">file</span><span class="op" id="4806242">,</span>&nbsp;<span class="ident" id="4806244">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806254">return</span>&nbsp;<span class="string" id="4806261">&#34;&#34;</span><span class="op" id="4806263">,</span>&nbsp;<span class="op" id="4806265">&amp;</span><span class="ident" id="4806266">Error</span><span class="op" id="4806271">{</span><span class="ident" id="4806272">file</span><span class="op" id="4806276">,</span>&nbsp;<span class="ident" id="4806278">err</span><span class="op" id="4806281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806284">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806287">pathenv</span>&nbsp;<span class="op" id="4806295">:=</span>&nbsp;<span class="ident" id="4806298">os</span><span class="op" id="4806300">.</span><span class="ident" id="4806301">Getenv</span><span class="op" id="4806307">(</span><span class="string" id="4806308">&#34;PATH&#34;</span><span class="op" id="4806314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806317">if</span>&nbsp;<span class="ident" id="4806320">pathenv</span>&nbsp;<span class="op" id="4806328">==</span>&nbsp;<span class="string" id="4806331">&#34;&#34;</span>&nbsp;<span class="op" id="4806334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806338">return</span>&nbsp;<span class="string" id="4806345">&#34;&#34;</span><span class="op" id="4806347">,</span>&nbsp;<span class="op" id="4806349">&amp;</span><span class="ident" id="4806350">Error</span><span class="op" id="4806355">{</span><span class="ident" id="4806356">file</span><span class="op" id="4806360">,</span>&nbsp;<span class="ident" id="4806362">ErrNotFound</span><span class="op" id="4806373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806379">for</span>&nbsp;<span class="ident" id="4806383">_</span><span class="op" id="4806384">,</span>&nbsp;<span class="ident" id="4806386">dir</span>&nbsp;<span class="op" id="4806390">:=</span>&nbsp;<span class="keyword" id="4806393">range</span>&nbsp;<span class="ident" id="4806399">strings</span><span class="op" id="4806406">.</span><span class="ident" id="4806407">Split</span><span class="op" id="4806412">(</span><span class="ident" id="4806413">pathenv</span><span class="op" id="4806420">,</span>&nbsp;<span class="string" id="4806422">&#34;:&#34;</span><span class="op" id="4806425">)</span>&nbsp;<span class="op" id="4806427">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806431">if</span>&nbsp;<span class="ident" id="4806434">dir</span>&nbsp;<span class="op" id="4806438">==</span>&nbsp;<span class="string" id="4806441">&#34;&#34;</span>&nbsp;<span class="op" id="4806444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4806449">//&nbsp;Unix&nbsp;shell&nbsp;semantics:&nbsp;path&nbsp;element&nbsp;&#34;&#34;&nbsp;means&nbsp;&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806503">dir</span>&nbsp;<span class="op" id="4806507">=</span>&nbsp;<span class="string" id="4806509">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4806519">path</span>&nbsp;<span class="op" id="4806524">:=</span>&nbsp;<span class="ident" id="4806527">dir</span>&nbsp;<span class="op" id="4806531">+</span>&nbsp;<span class="string" id="4806533">&#34;/&#34;</span>&nbsp;<span class="op" id="4806537">+</span>&nbsp;<span class="ident" id="4806539">file</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806546">if</span>&nbsp;<span class="ident" id="4806549">err</span>&nbsp;<span class="op" id="4806553">:=</span>&nbsp;<span class="ident" id="4806556">findExecutable</span><span class="op" id="4806570">(</span><span class="ident" id="4806571">path</span><span class="op" id="4806575">)</span><span class="op" id="4806576">;</span>&nbsp;<span class="ident" id="4806578">err</span>&nbsp;<span class="op" id="4806582">==</span>&nbsp;<span class="ident" id="4806585">nil</span>&nbsp;<span class="op" id="4806589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806594">return</span>&nbsp;<span class="ident" id="4806601">path</span><span class="op" id="4806605">,</span>&nbsp;<span class="ident" id="4806607">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4806616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4806619">return</span>&nbsp;<span class="string" id="4806626">&#34;&#34;</span><span class="op" id="4806628">,</span>&nbsp;<span class="op" id="4806630">&amp;</span><span class="ident" id="4806631">Error</span><span class="op" id="4806636">{</span><span class="ident" id="4806637">file</span><span class="op" id="4806641">,</span>&nbsp;<span class="ident" id="4806643">ErrNotFound</span><span class="op" id="4806654">}</span><br>
<span class="lineno">60</span><span class="op" id="4806656">}</span>
</div>
</body>
</html>
