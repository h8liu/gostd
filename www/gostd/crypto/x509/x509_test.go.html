<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html" class="current">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7290438">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7290493">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7290547">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7290598">package</span>&nbsp;<span class="ident" id="7290606">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7290612">import</span>&nbsp;<span class="op" id="7290619">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290622">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290631">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290645">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290661">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290680">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290695">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7290709">_</span>&nbsp;<span class="string" id="7290711">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7290728">_</span>&nbsp;<span class="string" id="7290730">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290747">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290767">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290784">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290803">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290819">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290835">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290847">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290854">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290865">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290876">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290887">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290898">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7290905">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7290908">func</span>&nbsp;<span class="ident" id="7290913">TestParsePKCS1PrivateKey</span><span class="op" id="7290937">(</span><span class="ident" id="7290938">t</span>&nbsp;<span class="op" id="7290940">*</span><span class="ident" id="7290941">testing</span><span class="op" id="7290948">.</span><span class="ident" id="7290949">T</span><span class="op" id="7290950">)</span>&nbsp;<span class="op" id="7290952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7290955">block</span><span class="op" id="7290960">,</span>&nbsp;<span class="ident" id="7290962">_</span>&nbsp;<span class="op" id="7290964">:=</span>&nbsp;<span class="ident" id="7290967">pem</span><span class="op" id="7290970">.</span><span class="ident" id="7290971">Decode</span><span class="op" id="7290977">(</span><span class="op" id="7290978">[</span><span class="op" id="7290979">]</span><span class="builtintype" id="7290980">byte</span><span class="op" id="7290984">(</span><span class="ident" id="7290985">pemPrivateKey</span><span class="op" id="7290998">)</span><span class="op" id="7290999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291002">priv</span><span class="op" id="7291006">,</span>&nbsp;<span class="ident" id="7291008">err</span>&nbsp;<span class="op" id="7291012">:=</span>&nbsp;<span class="ident" id="7291015">ParsePKCS1PrivateKey</span><span class="op" id="7291035">(</span><span class="ident" id="7291036">block</span><span class="op" id="7291041">.</span><span class="ident" id="7291042">Bytes</span><span class="op" id="7291047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291050">if</span>&nbsp;<span class="ident" id="7291053">err</span>&nbsp;<span class="op" id="7291057">!=</span>&nbsp;<span class="ident" id="7291060">nil</span>&nbsp;<span class="op" id="7291064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291068">t</span><span class="op" id="7291069">.</span><span class="ident" id="7291070">Errorf</span><span class="op" id="7291076">(</span><span class="string" id="7291077">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7291110">,</span>&nbsp;<span class="ident" id="7291112">err</span><span class="op" id="7291115">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291119">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291130">if</span>&nbsp;<span class="ident" id="7291133">priv</span><span class="op" id="7291137">.</span><span class="ident" id="7291138">PublicKey</span><span class="op" id="7291147">.</span><span class="ident" id="7291148">N</span><span class="op" id="7291149">.</span><span class="ident" id="7291150">Cmp</span><span class="op" id="7291153">(</span><span class="ident" id="7291154">rsaPrivateKey</span><span class="op" id="7291167">.</span><span class="ident" id="7291168">PublicKey</span><span class="op" id="7291177">.</span><span class="ident" id="7291178">N</span><span class="op" id="7291179">)</span>&nbsp;<span class="op" id="7291181">!=</span>&nbsp;<span class="num" id="7291184">0</span>&nbsp;<span class="op" id="7291186">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291191">priv</span><span class="op" id="7291195">.</span><span class="ident" id="7291196">PublicKey</span><span class="op" id="7291205">.</span><span class="ident" id="7291206">E</span>&nbsp;<span class="op" id="7291208">!=</span>&nbsp;<span class="ident" id="7291211">rsaPrivateKey</span><span class="op" id="7291224">.</span><span class="ident" id="7291225">PublicKey</span><span class="op" id="7291234">.</span><span class="ident" id="7291235">E</span>&nbsp;<span class="op" id="7291237">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291242">priv</span><span class="op" id="7291246">.</span><span class="ident" id="7291247">D</span><span class="op" id="7291248">.</span><span class="ident" id="7291249">Cmp</span><span class="op" id="7291252">(</span><span class="ident" id="7291253">rsaPrivateKey</span><span class="op" id="7291266">.</span><span class="ident" id="7291267">D</span><span class="op" id="7291268">)</span>&nbsp;<span class="op" id="7291270">!=</span>&nbsp;<span class="num" id="7291273">0</span>&nbsp;<span class="op" id="7291275">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291280">priv</span><span class="op" id="7291284">.</span><span class="ident" id="7291285">Primes</span><span class="op" id="7291291">[</span><span class="num" id="7291292">0</span><span class="op" id="7291293">]</span><span class="op" id="7291294">.</span><span class="ident" id="7291295">Cmp</span><span class="op" id="7291298">(</span><span class="ident" id="7291299">rsaPrivateKey</span><span class="op" id="7291312">.</span><span class="ident" id="7291313">Primes</span><span class="op" id="7291319">[</span><span class="num" id="7291320">0</span><span class="op" id="7291321">]</span><span class="op" id="7291322">)</span>&nbsp;<span class="op" id="7291324">!=</span>&nbsp;<span class="num" id="7291327">0</span>&nbsp;<span class="op" id="7291329">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291334">priv</span><span class="op" id="7291338">.</span><span class="ident" id="7291339">Primes</span><span class="op" id="7291345">[</span><span class="num" id="7291346">1</span><span class="op" id="7291347">]</span><span class="op" id="7291348">.</span><span class="ident" id="7291349">Cmp</span><span class="op" id="7291352">(</span><span class="ident" id="7291353">rsaPrivateKey</span><span class="op" id="7291366">.</span><span class="ident" id="7291367">Primes</span><span class="op" id="7291373">[</span><span class="num" id="7291374">1</span><span class="op" id="7291375">]</span><span class="op" id="7291376">)</span>&nbsp;<span class="op" id="7291378">!=</span>&nbsp;<span class="num" id="7291381">0</span>&nbsp;<span class="op" id="7291383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291387">t</span><span class="op" id="7291388">.</span><span class="ident" id="7291389">Errorf</span><span class="op" id="7291395">(</span><span class="string" id="7291396">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7291414">,</span>&nbsp;<span class="ident" id="7291416">priv</span><span class="op" id="7291420">,</span>&nbsp;<span class="ident" id="7291422">rsaPrivateKey</span><span class="op" id="7291435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291438">}</span><br>
<span class="lineno"></span><span class="op" id="7291440">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7291443">func</span>&nbsp;<span class="ident" id="7291448">TestParsePKIXPublicKey</span><span class="op" id="7291470">(</span><span class="ident" id="7291471">t</span>&nbsp;<span class="op" id="7291473">*</span><span class="ident" id="7291474">testing</span><span class="op" id="7291481">.</span><span class="ident" id="7291482">T</span><span class="op" id="7291483">)</span>&nbsp;<span class="op" id="7291485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291488">block</span><span class="op" id="7291493">,</span>&nbsp;<span class="ident" id="7291495">_</span>&nbsp;<span class="op" id="7291497">:=</span>&nbsp;<span class="ident" id="7291500">pem</span><span class="op" id="7291503">.</span><span class="ident" id="7291504">Decode</span><span class="op" id="7291510">(</span><span class="op" id="7291511">[</span><span class="op" id="7291512">]</span><span class="builtintype" id="7291513">byte</span><span class="op" id="7291517">(</span><span class="ident" id="7291518">pemPublicKey</span><span class="op" id="7291530">)</span><span class="op" id="7291531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291534">pub</span><span class="op" id="7291537">,</span>&nbsp;<span class="ident" id="7291539">err</span>&nbsp;<span class="op" id="7291543">:=</span>&nbsp;<span class="ident" id="7291546">ParsePKIXPublicKey</span><span class="op" id="7291564">(</span><span class="ident" id="7291565">block</span><span class="op" id="7291570">.</span><span class="ident" id="7291571">Bytes</span><span class="op" id="7291576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291579">if</span>&nbsp;<span class="ident" id="7291582">err</span>&nbsp;<span class="op" id="7291586">!=</span>&nbsp;<span class="ident" id="7291589">nil</span>&nbsp;<span class="op" id="7291593">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291597">t</span><span class="op" id="7291598">.</span><span class="ident" id="7291599">Errorf</span><span class="op" id="7291605">(</span><span class="string" id="7291606">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7291642">,</span>&nbsp;<span class="ident" id="7291644">err</span><span class="op" id="7291647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291651">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291662">rsaPub</span><span class="op" id="7291668">,</span>&nbsp;<span class="ident" id="7291670">ok</span>&nbsp;<span class="op" id="7291673">:=</span>&nbsp;<span class="ident" id="7291676">pub</span><span class="op" id="7291679">.</span><span class="op" id="7291680">(</span><span class="op" id="7291681">*</span><span class="ident" id="7291682">rsa</span><span class="op" id="7291685">.</span><span class="ident" id="7291686">PublicKey</span><span class="op" id="7291695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291698">if</span>&nbsp;<span class="op" id="7291701">!</span><span class="ident" id="7291702">ok</span>&nbsp;<span class="op" id="7291705">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291709">t</span><span class="op" id="7291710">.</span><span class="ident" id="7291711">Errorf</span><span class="op" id="7291717">(</span><span class="string" id="7291718">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="7291784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291788">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291800">pubBytes2</span><span class="op" id="7291809">,</span>&nbsp;<span class="ident" id="7291811">err</span>&nbsp;<span class="op" id="7291815">:=</span>&nbsp;<span class="ident" id="7291818">MarshalPKIXPublicKey</span><span class="op" id="7291838">(</span><span class="ident" id="7291839">rsaPub</span><span class="op" id="7291845">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291848">if</span>&nbsp;<span class="ident" id="7291851">err</span>&nbsp;<span class="op" id="7291855">!=</span>&nbsp;<span class="ident" id="7291858">nil</span>&nbsp;<span class="op" id="7291862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291866">t</span><span class="op" id="7291867">.</span><span class="ident" id="7291868">Errorf</span><span class="op" id="7291874">(</span><span class="string" id="7291875">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="7291933">,</span>&nbsp;<span class="ident" id="7291935">err</span><span class="op" id="7291938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291942">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291953">if</span>&nbsp;<span class="op" id="7291956">!</span><span class="ident" id="7291957">bytes</span><span class="op" id="7291962">.</span><span class="ident" id="7291963">Equal</span><span class="op" id="7291968">(</span><span class="ident" id="7291969">pubBytes2</span><span class="op" id="7291978">,</span>&nbsp;<span class="ident" id="7291980">block</span><span class="op" id="7291985">.</span><span class="ident" id="7291986">Bytes</span><span class="op" id="7291991">)</span>&nbsp;<span class="op" id="7291993">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291997">t</span><span class="op" id="7291998">.</span><span class="ident" id="7291999">Errorf</span><span class="op" id="7292005">(</span><span class="string" id="7292006">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7292067">,</span>&nbsp;<span class="ident" id="7292069">pubBytes2</span><span class="op" id="7292078">,</span>&nbsp;<span class="ident" id="7292080">block</span><span class="op" id="7292085">.</span><span class="ident" id="7292086">Bytes</span><span class="op" id="7292091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292094">}</span><br>
<span class="lineno"></span><span class="op" id="7292096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7292099">var</span>&nbsp;<span class="ident" id="7292103">pemPublicKey</span>&nbsp;<span class="op" id="7292116">=</span>&nbsp;<span class="string" id="7292118">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7292573">var</span>&nbsp;<span class="ident" id="7292577">pemPrivateKey</span>&nbsp;<span class="op" id="7292591">=</span>&nbsp;<span class="string" id="7292593">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="7293090">func</span>&nbsp;<span class="ident" id="7293095">bigFromString</span><span class="op" id="7293108">(</span><span class="ident" id="7293109">s</span>&nbsp;<span class="builtintype" id="7293111">string</span><span class="op" id="7293117">)</span>&nbsp;<span class="op" id="7293119">*</span><span class="ident" id="7293120">big</span><span class="op" id="7293123">.</span><span class="ident" id="7293124">Int</span>&nbsp;<span class="op" id="7293128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293131">ret</span>&nbsp;<span class="op" id="7293135">:=</span>&nbsp;<span class="builtinfunc" id="7293138">new</span><span class="op" id="7293141">(</span><span class="ident" id="7293142">big</span><span class="op" id="7293145">.</span><span class="ident" id="7293146">Int</span><span class="op" id="7293149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293152">ret</span><span class="op" id="7293155">.</span><span class="ident" id="7293156">SetString</span><span class="op" id="7293165">(</span><span class="ident" id="7293166">s</span><span class="op" id="7293167">,</span>&nbsp;<span class="num" id="7293169">10</span><span class="op" id="7293171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293174">return</span>&nbsp;<span class="ident" id="7293181">ret</span><br>
<span class="lineno">95</span><span class="op" id="7293185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7293188">func</span>&nbsp;<span class="ident" id="7293193">fromBase10</span><span class="op" id="7293203">(</span><span class="ident" id="7293204">base10</span>&nbsp;<span class="builtintype" id="7293211">string</span><span class="op" id="7293217">)</span>&nbsp;<span class="op" id="7293219">*</span><span class="ident" id="7293220">big</span><span class="op" id="7293223">.</span><span class="ident" id="7293224">Int</span>&nbsp;<span class="op" id="7293228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293231">i</span>&nbsp;<span class="op" id="7293233">:=</span>&nbsp;<span class="builtinfunc" id="7293236">new</span><span class="op" id="7293239">(</span><span class="ident" id="7293240">big</span><span class="op" id="7293243">.</span><span class="ident" id="7293244">Int</span><span class="op" id="7293247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293250">i</span><span class="op" id="7293251">.</span><span class="ident" id="7293252">SetString</span><span class="op" id="7293261">(</span><span class="ident" id="7293262">base10</span><span class="op" id="7293268">,</span>&nbsp;<span class="num" id="7293270">10</span><span class="op" id="7293272">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293275">return</span>&nbsp;<span class="ident" id="7293282">i</span><br>
<span class="lineno"></span><span class="op" id="7293284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7293287">func</span>&nbsp;<span class="ident" id="7293292">bigFromHexString</span><span class="op" id="7293308">(</span><span class="ident" id="7293309">s</span>&nbsp;<span class="builtintype" id="7293311">string</span><span class="op" id="7293317">)</span>&nbsp;<span class="op" id="7293319">*</span><span class="ident" id="7293320">big</span><span class="op" id="7293323">.</span><span class="ident" id="7293324">Int</span>&nbsp;<span class="op" id="7293328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293331">ret</span>&nbsp;<span class="op" id="7293335">:=</span>&nbsp;<span class="builtinfunc" id="7293338">new</span><span class="op" id="7293341">(</span><span class="ident" id="7293342">big</span><span class="op" id="7293345">.</span><span class="ident" id="7293346">Int</span><span class="op" id="7293349">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293352">ret</span><span class="op" id="7293355">.</span><span class="ident" id="7293356">SetString</span><span class="op" id="7293365">(</span><span class="ident" id="7293366">s</span><span class="op" id="7293367">,</span>&nbsp;<span class="num" id="7293369">16</span><span class="op" id="7293371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293374">return</span>&nbsp;<span class="ident" id="7293381">ret</span><br>
<span class="lineno"></span><span class="op" id="7293385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7293388">var</span>&nbsp;<span class="ident" id="7293392">rsaPrivateKey</span>&nbsp;<span class="op" id="7293406">=</span>&nbsp;<span class="op" id="7293408">&amp;</span><span class="ident" id="7293409">rsa</span><span class="op" id="7293412">.</span><span class="ident" id="7293413">PrivateKey</span><span class="op" id="7293423">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293426">PublicKey</span><span class="op" id="7293435">:</span>&nbsp;<span class="ident" id="7293437">rsa</span><span class="op" id="7293440">.</span><span class="ident" id="7293441">PublicKey</span><span class="op" id="7293450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293454">N</span><span class="op" id="7293455">:</span>&nbsp;<span class="ident" id="7293457">bigFromString</span><span class="op" id="7293470">(</span><span class="string" id="7293471">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7293627">)</span><span class="op" id="7293628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293632">E</span><span class="op" id="7293633">:</span>&nbsp;<span class="num" id="7293635">65537</span><span class="op" id="7293640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293643">}</span><span class="op" id="7293644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293647">D</span><span class="op" id="7293648">:</span>&nbsp;<span class="ident" id="7293650">bigFromString</span><span class="op" id="7293663">(</span><span class="string" id="7293664">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7293820">)</span><span class="op" id="7293821">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293824">Primes</span><span class="op" id="7293830">:</span>&nbsp;<span class="op" id="7293832">[</span><span class="op" id="7293833">]</span><span class="op" id="7293834">*</span><span class="ident" id="7293835">big</span><span class="op" id="7293838">.</span><span class="ident" id="7293839">Int</span><span class="op" id="7293842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293846">bigFromString</span><span class="op" id="7293859">(</span><span class="string" id="7293860">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7293939">)</span><span class="op" id="7293940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293944">bigFromString</span><span class="op" id="7293957">(</span><span class="string" id="7293958">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7294037">)</span><span class="op" id="7294038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294041">}</span><span class="op" id="7294042">,</span><br>
<span class="lineno"></span><span class="op" id="7294044">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7294047">func</span>&nbsp;<span class="ident" id="7294052">TestMarshalRSAPrivateKey</span><span class="op" id="7294076">(</span><span class="ident" id="7294077">t</span>&nbsp;<span class="op" id="7294079">*</span><span class="ident" id="7294080">testing</span><span class="op" id="7294087">.</span><span class="ident" id="7294088">T</span><span class="op" id="7294089">)</span>&nbsp;<span class="op" id="7294091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294094">priv</span>&nbsp;<span class="op" id="7294099">:=</span>&nbsp;<span class="op" id="7294102">&amp;</span><span class="ident" id="7294103">rsa</span><span class="op" id="7294106">.</span><span class="ident" id="7294107">PrivateKey</span><span class="op" id="7294117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294121">PublicKey</span><span class="op" id="7294130">:</span>&nbsp;<span class="ident" id="7294132">rsa</span><span class="op" id="7294135">.</span><span class="ident" id="7294136">PublicKey</span><span class="op" id="7294145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294150">N</span><span class="op" id="7294151">:</span>&nbsp;<span class="ident" id="7294153">fromBase10</span><span class="op" id="7294163">(</span><span class="string" id="7294164">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="7294783">)</span><span class="op" id="7294784">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294789">E</span><span class="op" id="7294790">:</span>&nbsp;<span class="num" id="7294792">3</span><span class="op" id="7294793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294797">}</span><span class="op" id="7294798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294802">D</span><span class="op" id="7294803">:</span>&nbsp;<span class="ident" id="7294805">fromBase10</span><span class="op" id="7294815">(</span><span class="string" id="7294816">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="7295435">)</span><span class="op" id="7295436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295440">Primes</span><span class="op" id="7295446">:</span>&nbsp;<span class="op" id="7295448">[</span><span class="op" id="7295449">]</span><span class="op" id="7295450">*</span><span class="ident" id="7295451">big</span><span class="op" id="7295454">.</span><span class="ident" id="7295455">Int</span><span class="op" id="7295458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295463">fromBase10</span><span class="op" id="7295473">(</span><span class="string" id="7295474">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="7295684">)</span><span class="op" id="7295685">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295690">fromBase10</span><span class="op" id="7295700">(</span><span class="string" id="7295701">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="7295908">)</span><span class="op" id="7295909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295914">fromBase10</span><span class="op" id="7295924">(</span><span class="string" id="7295925">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="7296132">)</span><span class="op" id="7296133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296137">}</span><span class="op" id="7296138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296145">derBytes</span>&nbsp;<span class="op" id="7296154">:=</span>&nbsp;<span class="ident" id="7296157">MarshalPKCS1PrivateKey</span><span class="op" id="7296179">(</span><span class="ident" id="7296180">priv</span><span class="op" id="7296184">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296188">priv2</span><span class="op" id="7296193">,</span>&nbsp;<span class="ident" id="7296195">err</span>&nbsp;<span class="op" id="7296199">:=</span>&nbsp;<span class="ident" id="7296202">ParsePKCS1PrivateKey</span><span class="op" id="7296222">(</span><span class="ident" id="7296223">derBytes</span><span class="op" id="7296231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296234">if</span>&nbsp;<span class="ident" id="7296237">err</span>&nbsp;<span class="op" id="7296241">!=</span>&nbsp;<span class="ident" id="7296244">nil</span>&nbsp;<span class="op" id="7296248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296252">t</span><span class="op" id="7296253">.</span><span class="ident" id="7296254">Errorf</span><span class="op" id="7296260">(</span><span class="string" id="7296261">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7296295">,</span>&nbsp;<span class="ident" id="7296297">err</span><span class="op" id="7296300">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296304">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296315">if</span>&nbsp;<span class="ident" id="7296318">priv</span><span class="op" id="7296322">.</span><span class="ident" id="7296323">PublicKey</span><span class="op" id="7296332">.</span><span class="ident" id="7296333">N</span><span class="op" id="7296334">.</span><span class="ident" id="7296335">Cmp</span><span class="op" id="7296338">(</span><span class="ident" id="7296339">priv2</span><span class="op" id="7296344">.</span><span class="ident" id="7296345">PublicKey</span><span class="op" id="7296354">.</span><span class="ident" id="7296355">N</span><span class="op" id="7296356">)</span>&nbsp;<span class="op" id="7296358">!=</span>&nbsp;<span class="num" id="7296361">0</span>&nbsp;<span class="op" id="7296363">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296368">priv</span><span class="op" id="7296372">.</span><span class="ident" id="7296373">PublicKey</span><span class="op" id="7296382">.</span><span class="ident" id="7296383">E</span>&nbsp;<span class="op" id="7296385">!=</span>&nbsp;<span class="ident" id="7296388">priv2</span><span class="op" id="7296393">.</span><span class="ident" id="7296394">PublicKey</span><span class="op" id="7296403">.</span><span class="ident" id="7296404">E</span>&nbsp;<span class="op" id="7296406">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296411">priv</span><span class="op" id="7296415">.</span><span class="ident" id="7296416">D</span><span class="op" id="7296417">.</span><span class="ident" id="7296418">Cmp</span><span class="op" id="7296421">(</span><span class="ident" id="7296422">priv2</span><span class="op" id="7296427">.</span><span class="ident" id="7296428">D</span><span class="op" id="7296429">)</span>&nbsp;<span class="op" id="7296431">!=</span>&nbsp;<span class="num" id="7296434">0</span>&nbsp;<span class="op" id="7296436">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7296441">len</span><span class="op" id="7296444">(</span><span class="ident" id="7296445">priv2</span><span class="op" id="7296450">.</span><span class="ident" id="7296451">Primes</span><span class="op" id="7296457">)</span>&nbsp;<span class="op" id="7296459">!=</span>&nbsp;<span class="num" id="7296462">3</span>&nbsp;<span class="op" id="7296464">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296469">priv</span><span class="op" id="7296473">.</span><span class="ident" id="7296474">Primes</span><span class="op" id="7296480">[</span><span class="num" id="7296481">0</span><span class="op" id="7296482">]</span><span class="op" id="7296483">.</span><span class="ident" id="7296484">Cmp</span><span class="op" id="7296487">(</span><span class="ident" id="7296488">priv2</span><span class="op" id="7296493">.</span><span class="ident" id="7296494">Primes</span><span class="op" id="7296500">[</span><span class="num" id="7296501">0</span><span class="op" id="7296502">]</span><span class="op" id="7296503">)</span>&nbsp;<span class="op" id="7296505">!=</span>&nbsp;<span class="num" id="7296508">0</span>&nbsp;<span class="op" id="7296510">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296515">priv</span><span class="op" id="7296519">.</span><span class="ident" id="7296520">Primes</span><span class="op" id="7296526">[</span><span class="num" id="7296527">1</span><span class="op" id="7296528">]</span><span class="op" id="7296529">.</span><span class="ident" id="7296530">Cmp</span><span class="op" id="7296533">(</span><span class="ident" id="7296534">priv2</span><span class="op" id="7296539">.</span><span class="ident" id="7296540">Primes</span><span class="op" id="7296546">[</span><span class="num" id="7296547">1</span><span class="op" id="7296548">]</span><span class="op" id="7296549">)</span>&nbsp;<span class="op" id="7296551">!=</span>&nbsp;<span class="num" id="7296554">0</span>&nbsp;<span class="op" id="7296556">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296561">priv</span><span class="op" id="7296565">.</span><span class="ident" id="7296566">Primes</span><span class="op" id="7296572">[</span><span class="num" id="7296573">2</span><span class="op" id="7296574">]</span><span class="op" id="7296575">.</span><span class="ident" id="7296576">Cmp</span><span class="op" id="7296579">(</span><span class="ident" id="7296580">priv2</span><span class="op" id="7296585">.</span><span class="ident" id="7296586">Primes</span><span class="op" id="7296592">[</span><span class="num" id="7296593">2</span><span class="op" id="7296594">]</span><span class="op" id="7296595">)</span>&nbsp;<span class="op" id="7296597">!=</span>&nbsp;<span class="num" id="7296600">0</span>&nbsp;<span class="op" id="7296602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296606">t</span><span class="op" id="7296607">.</span><span class="ident" id="7296608">Errorf</span><span class="op" id="7296614">(</span><span class="string" id="7296615">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7296633">,</span>&nbsp;<span class="ident" id="7296635">priv</span><span class="op" id="7296639">,</span>&nbsp;<span class="ident" id="7296641">priv2</span><span class="op" id="7296646">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296649">}</span><br>
<span class="lineno"></span><span class="op" id="7296651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7296654">type</span>&nbsp;<span class="ident" id="7296659">matchHostnamesTest</span>&nbsp;<span class="keyword" id="7296678">struct</span>&nbsp;<span class="op" id="7296685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296688">pattern</span><span class="op" id="7296695">,</span>&nbsp;<span class="ident" id="7296697">host</span>&nbsp;<span class="builtintype" id="7296702">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296710">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7296724">bool</span><br>
<span class="lineno"></span><span class="op" id="7296729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7296732">var</span>&nbsp;<span class="ident" id="7296736">matchHostnamesTests</span>&nbsp;<span class="op" id="7296756">=</span>&nbsp;<span class="op" id="7296758">[</span><span class="op" id="7296759">]</span><span class="ident" id="7296760">matchHostnamesTest</span><span class="op" id="7296778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296781">{</span><span class="string" id="7296782">&#34;a.b.c&#34;</span><span class="op" id="7296789">,</span>&nbsp;<span class="string" id="7296791">&#34;a.b.c&#34;</span><span class="op" id="7296798">,</span>&nbsp;<span class="builtintype" id="7296800">true</span><span class="op" id="7296804">}</span><span class="op" id="7296805">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296808">{</span><span class="string" id="7296809">&#34;a.b.c&#34;</span><span class="op" id="7296816">,</span>&nbsp;<span class="string" id="7296818">&#34;b.b.c&#34;</span><span class="op" id="7296825">,</span>&nbsp;<span class="builtintype" id="7296827">false</span><span class="op" id="7296832">}</span><span class="op" id="7296833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296836">{</span><span class="string" id="7296837">&#34;&#34;</span><span class="op" id="7296839">,</span>&nbsp;<span class="string" id="7296841">&#34;b.b.c&#34;</span><span class="op" id="7296848">,</span>&nbsp;<span class="builtintype" id="7296850">false</span><span class="op" id="7296855">}</span><span class="op" id="7296856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296859">{</span><span class="string" id="7296860">&#34;a.b.c&#34;</span><span class="op" id="7296867">,</span>&nbsp;<span class="string" id="7296869">&#34;&#34;</span><span class="op" id="7296871">,</span>&nbsp;<span class="builtintype" id="7296873">false</span><span class="op" id="7296878">}</span><span class="op" id="7296879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296882">{</span><span class="string" id="7296883">&#34;example.com&#34;</span><span class="op" id="7296896">,</span>&nbsp;<span class="string" id="7296898">&#34;example.com&#34;</span><span class="op" id="7296911">,</span>&nbsp;<span class="builtintype" id="7296913">true</span><span class="op" id="7296917">}</span><span class="op" id="7296918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296921">{</span><span class="string" id="7296922">&#34;example.com&#34;</span><span class="op" id="7296935">,</span>&nbsp;<span class="string" id="7296937">&#34;www.example.com&#34;</span><span class="op" id="7296954">,</span>&nbsp;<span class="builtintype" id="7296956">false</span><span class="op" id="7296961">}</span><span class="op" id="7296962">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296965">{</span><span class="string" id="7296966">&#34;*.example.com&#34;</span><span class="op" id="7296981">,</span>&nbsp;<span class="string" id="7296983">&#34;www.example.com&#34;</span><span class="op" id="7297000">,</span>&nbsp;<span class="builtintype" id="7297002">true</span><span class="op" id="7297006">}</span><span class="op" id="7297007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297010">{</span><span class="string" id="7297011">&#34;*.example.com&#34;</span><span class="op" id="7297026">,</span>&nbsp;<span class="string" id="7297028">&#34;xyz.www.example.com&#34;</span><span class="op" id="7297049">,</span>&nbsp;<span class="builtintype" id="7297051">false</span><span class="op" id="7297056">}</span><span class="op" id="7297057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297060">{</span><span class="string" id="7297061">&#34;*.*.example.com&#34;</span><span class="op" id="7297078">,</span>&nbsp;<span class="string" id="7297080">&#34;xyz.www.example.com&#34;</span><span class="op" id="7297101">,</span>&nbsp;<span class="builtintype" id="7297103">true</span><span class="op" id="7297107">}</span><span class="op" id="7297108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297111">{</span><span class="string" id="7297112">&#34;*.www.*.com&#34;</span><span class="op" id="7297125">,</span>&nbsp;<span class="string" id="7297127">&#34;xyz.www.example.com&#34;</span><span class="op" id="7297148">,</span>&nbsp;<span class="builtintype" id="7297150">true</span><span class="op" id="7297154">}</span><span class="op" id="7297155">,</span><br>
<span class="lineno"></span><span class="op" id="7297157">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7297160">func</span>&nbsp;<span class="ident" id="7297165">TestMatchHostnames</span><span class="op" id="7297183">(</span><span class="ident" id="7297184">t</span>&nbsp;<span class="op" id="7297186">*</span><span class="ident" id="7297187">testing</span><span class="op" id="7297194">.</span><span class="ident" id="7297195">T</span><span class="op" id="7297196">)</span>&nbsp;<span class="op" id="7297198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297201">for</span>&nbsp;<span class="ident" id="7297205">i</span><span class="op" id="7297206">,</span>&nbsp;<span class="ident" id="7297208">test</span>&nbsp;<span class="op" id="7297213">:=</span>&nbsp;<span class="keyword" id="7297216">range</span>&nbsp;<span class="ident" id="7297222">matchHostnamesTests</span>&nbsp;<span class="op" id="7297242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297246">r</span>&nbsp;<span class="op" id="7297248">:=</span>&nbsp;<span class="ident" id="7297251">matchHostnames</span><span class="op" id="7297265">(</span><span class="ident" id="7297266">test</span><span class="op" id="7297270">.</span><span class="ident" id="7297271">pattern</span><span class="op" id="7297278">,</span>&nbsp;<span class="ident" id="7297280">test</span><span class="op" id="7297284">.</span><span class="ident" id="7297285">host</span><span class="op" id="7297289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297293">if</span>&nbsp;<span class="ident" id="7297296">r</span>&nbsp;<span class="op" id="7297298">!=</span>&nbsp;<span class="ident" id="7297301">test</span><span class="op" id="7297305">.</span><span class="ident" id="7297306">ok</span>&nbsp;<span class="op" id="7297309">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297314">t</span><span class="op" id="7297315">.</span><span class="ident" id="7297316">Errorf</span><span class="op" id="7297322">(</span><span class="string" id="7297323">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="7297354">,</span>&nbsp;<span class="ident" id="7297356">i</span><span class="op" id="7297357">,</span>&nbsp;<span class="ident" id="7297359">r</span><span class="op" id="7297360">,</span>&nbsp;<span class="ident" id="7297362">test</span><span class="op" id="7297366">.</span><span class="ident" id="7297367">ok</span><span class="op" id="7297369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297376">}</span><br>
<span class="lineno"></span><span class="op" id="7297378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="7297381">func</span>&nbsp;<span class="ident" id="7297386">TestMatchIP</span><span class="op" id="7297397">(</span><span class="ident" id="7297398">t</span>&nbsp;<span class="op" id="7297400">*</span><span class="ident" id="7297401">testing</span><span class="op" id="7297408">.</span><span class="ident" id="7297409">T</span><span class="op" id="7297410">)</span>&nbsp;<span class="op" id="7297412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7297415">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297459">c</span>&nbsp;<span class="op" id="7297461">:=</span>&nbsp;<span class="op" id="7297464">&amp;</span><span class="ident" id="7297465">Certificate</span><span class="op" id="7297476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297480">DNSNames</span><span class="op" id="7297488">:</span>&nbsp;<span class="op" id="7297490">[</span><span class="op" id="7297491">]</span><span class="builtintype" id="7297492">string</span><span class="op" id="7297498">{</span><span class="string" id="7297499">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7297514">}</span><span class="op" id="7297515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297519">Subject</span><span class="op" id="7297526">:</span>&nbsp;<span class="ident" id="7297528">pkix</span><span class="op" id="7297532">.</span><span class="ident" id="7297533">Name</span><span class="op" id="7297537">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297542">CommonName</span><span class="op" id="7297552">:</span>&nbsp;<span class="string" id="7297554">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7297569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297573">}</span><span class="op" id="7297574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297580">err</span>&nbsp;<span class="op" id="7297584">:=</span>&nbsp;<span class="ident" id="7297587">c</span><span class="op" id="7297588">.</span><span class="ident" id="7297589">VerifyHostname</span><span class="op" id="7297603">(</span><span class="string" id="7297604">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="7297622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297625">if</span>&nbsp;<span class="ident" id="7297628">err</span>&nbsp;<span class="op" id="7297632">!=</span>&nbsp;<span class="ident" id="7297635">nil</span>&nbsp;<span class="op" id="7297639">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297643">t</span><span class="op" id="7297644">.</span><span class="ident" id="7297645">Fatalf</span><span class="op" id="7297651">(</span><span class="string" id="7297652">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="7297690">,</span>&nbsp;<span class="ident" id="7297692">err</span><span class="op" id="7297695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7297702">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7297775">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297795">c</span>&nbsp;<span class="op" id="7297797">=</span>&nbsp;<span class="op" id="7297799">&amp;</span><span class="ident" id="7297800">Certificate</span><span class="op" id="7297811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297815">DNSNames</span><span class="op" id="7297823">:</span>&nbsp;<span class="op" id="7297825">[</span><span class="op" id="7297826">]</span><span class="builtintype" id="7297827">string</span><span class="op" id="7297833">{</span><span class="string" id="7297834">&#34;*.2.3.4&#34;</span><span class="op" id="7297843">}</span><span class="op" id="7297844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297848">Subject</span><span class="op" id="7297855">:</span>&nbsp;<span class="ident" id="7297857">pkix</span><span class="op" id="7297861">.</span><span class="ident" id="7297862">Name</span><span class="op" id="7297866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297871">CommonName</span><span class="op" id="7297881">:</span>&nbsp;<span class="string" id="7297883">&#34;*.2.3.4&#34;</span><span class="op" id="7297892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297896">}</span><span class="op" id="7297897">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297903">err</span>&nbsp;<span class="op" id="7297907">=</span>&nbsp;<span class="ident" id="7297909">c</span><span class="op" id="7297910">.</span><span class="ident" id="7297911">VerifyHostname</span><span class="op" id="7297925">(</span><span class="string" id="7297926">&#34;1.2.3.4&#34;</span><span class="op" id="7297935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297938">if</span>&nbsp;<span class="ident" id="7297941">err</span>&nbsp;<span class="op" id="7297945">==</span>&nbsp;<span class="ident" id="7297948">nil</span>&nbsp;<span class="op" id="7297952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297956">t</span><span class="op" id="7297957">.</span><span class="ident" id="7297958">Fatalf</span><span class="op" id="7297964">(</span><span class="string" id="7297965">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="7298018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298021">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298025">c</span>&nbsp;<span class="op" id="7298027">=</span>&nbsp;<span class="op" id="7298029">&amp;</span><span class="ident" id="7298030">Certificate</span><span class="op" id="7298041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298045">IPAddresses</span><span class="op" id="7298056">:</span>&nbsp;<span class="op" id="7298058">[</span><span class="op" id="7298059">]</span><span class="ident" id="7298060">net</span><span class="op" id="7298063">.</span><span class="ident" id="7298064">IP</span><span class="op" id="7298066">{</span><span class="ident" id="7298067">net</span><span class="op" id="7298070">.</span><span class="ident" id="7298071">ParseIP</span><span class="op" id="7298078">(</span><span class="string" id="7298079">&#34;127.0.0.1&#34;</span><span class="op" id="7298090">)</span><span class="op" id="7298091">,</span>&nbsp;<span class="ident" id="7298093">net</span><span class="op" id="7298096">.</span><span class="ident" id="7298097">ParseIP</span><span class="op" id="7298104">(</span><span class="string" id="7298105">&#34;::1&#34;</span><span class="op" id="7298110">)</span><span class="op" id="7298111">}</span><span class="op" id="7298112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298118">err</span>&nbsp;<span class="op" id="7298122">=</span>&nbsp;<span class="ident" id="7298124">c</span><span class="op" id="7298125">.</span><span class="ident" id="7298126">VerifyHostname</span><span class="op" id="7298140">(</span><span class="string" id="7298141">&#34;127.0.0.1&#34;</span><span class="op" id="7298152">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298155">if</span>&nbsp;<span class="ident" id="7298158">err</span>&nbsp;<span class="op" id="7298162">!=</span>&nbsp;<span class="ident" id="7298165">nil</span>&nbsp;<span class="op" id="7298169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298173">t</span><span class="op" id="7298174">.</span><span class="ident" id="7298175">Fatalf</span><span class="op" id="7298181">(</span><span class="string" id="7298182">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="7298213">,</span>&nbsp;<span class="ident" id="7298215">err</span><span class="op" id="7298218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298224">err</span>&nbsp;<span class="op" id="7298228">=</span>&nbsp;<span class="ident" id="7298230">c</span><span class="op" id="7298231">.</span><span class="ident" id="7298232">VerifyHostname</span><span class="op" id="7298246">(</span><span class="string" id="7298247">&#34;::1&#34;</span><span class="op" id="7298252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298255">if</span>&nbsp;<span class="ident" id="7298258">err</span>&nbsp;<span class="op" id="7298262">!=</span>&nbsp;<span class="ident" id="7298265">nil</span>&nbsp;<span class="op" id="7298269">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298273">t</span><span class="op" id="7298274">.</span><span class="ident" id="7298275">Fatalf</span><span class="op" id="7298281">(</span><span class="string" id="7298282">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="7298307">,</span>&nbsp;<span class="ident" id="7298309">err</span><span class="op" id="7298312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298318">err</span>&nbsp;<span class="op" id="7298322">=</span>&nbsp;<span class="ident" id="7298324">c</span><span class="op" id="7298325">.</span><span class="ident" id="7298326">VerifyHostname</span><span class="op" id="7298340">(</span><span class="string" id="7298341">&#34;[::1]&#34;</span><span class="op" id="7298348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298351">if</span>&nbsp;<span class="ident" id="7298354">err</span>&nbsp;<span class="op" id="7298358">!=</span>&nbsp;<span class="ident" id="7298361">nil</span>&nbsp;<span class="op" id="7298365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298369">t</span><span class="op" id="7298370">.</span><span class="ident" id="7298371">Fatalf</span><span class="op" id="7298377">(</span><span class="string" id="7298378">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="7298405">,</span>&nbsp;<span class="ident" id="7298407">err</span><span class="op" id="7298410">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298413">}</span><br>
<span class="lineno"></span><span class="op" id="7298415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7298418">func</span>&nbsp;<span class="ident" id="7298423">TestCertificateParse</span><span class="op" id="7298443">(</span><span class="ident" id="7298444">t</span>&nbsp;<span class="op" id="7298446">*</span><span class="ident" id="7298447">testing</span><span class="op" id="7298454">.</span><span class="ident" id="7298455">T</span><span class="op" id="7298456">)</span>&nbsp;<span class="op" id="7298458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298461">s</span><span class="op" id="7298462">,</span>&nbsp;<span class="ident" id="7298464">_</span>&nbsp;<span class="op" id="7298466">:=</span>&nbsp;<span class="ident" id="7298469">hex</span><span class="op" id="7298472">.</span><span class="ident" id="7298473">DecodeString</span><span class="op" id="7298485">(</span><span class="ident" id="7298486">certBytes</span><span class="op" id="7298495">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298498">certs</span><span class="op" id="7298503">,</span>&nbsp;<span class="ident" id="7298505">err</span>&nbsp;<span class="op" id="7298509">:=</span>&nbsp;<span class="ident" id="7298512">ParseCertificates</span><span class="op" id="7298529">(</span><span class="ident" id="7298530">s</span><span class="op" id="7298531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298534">if</span>&nbsp;<span class="ident" id="7298537">err</span>&nbsp;<span class="op" id="7298541">!=</span>&nbsp;<span class="ident" id="7298544">nil</span>&nbsp;<span class="op" id="7298548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298552">t</span><span class="op" id="7298553">.</span><span class="ident" id="7298554">Error</span><span class="op" id="7298559">(</span><span class="ident" id="7298560">err</span><span class="op" id="7298563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298569">if</span>&nbsp;<span class="builtinfunc" id="7298572">len</span><span class="op" id="7298575">(</span><span class="ident" id="7298576">certs</span><span class="op" id="7298581">)</span>&nbsp;<span class="op" id="7298583">!=</span>&nbsp;<span class="num" id="7298586">2</span>&nbsp;<span class="op" id="7298588">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298592">t</span><span class="op" id="7298593">.</span><span class="ident" id="7298594">Errorf</span><span class="op" id="7298600">(</span><span class="string" id="7298601">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="7298639">,</span>&nbsp;<span class="builtinfunc" id="7298641">len</span><span class="op" id="7298644">(</span><span class="ident" id="7298645">certs</span><span class="op" id="7298650">)</span><span class="op" id="7298651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298655">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298667">err</span>&nbsp;<span class="op" id="7298671">=</span>&nbsp;<span class="ident" id="7298673">certs</span><span class="op" id="7298678">[</span><span class="num" id="7298679">0</span><span class="op" id="7298680">]</span><span class="op" id="7298681">.</span><span class="ident" id="7298682">CheckSignatureFrom</span><span class="op" id="7298700">(</span><span class="ident" id="7298701">certs</span><span class="op" id="7298706">[</span><span class="num" id="7298707">1</span><span class="op" id="7298708">]</span><span class="op" id="7298709">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298712">if</span>&nbsp;<span class="ident" id="7298715">err</span>&nbsp;<span class="op" id="7298719">!=</span>&nbsp;<span class="ident" id="7298722">nil</span>&nbsp;<span class="op" id="7298726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298730">t</span><span class="op" id="7298731">.</span><span class="ident" id="7298732">Error</span><span class="op" id="7298737">(</span><span class="ident" id="7298738">err</span><span class="op" id="7298741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298748">if</span>&nbsp;<span class="ident" id="7298751">err</span>&nbsp;<span class="op" id="7298755">:=</span>&nbsp;<span class="ident" id="7298758">certs</span><span class="op" id="7298763">[</span><span class="num" id="7298764">0</span><span class="op" id="7298765">]</span><span class="op" id="7298766">.</span><span class="ident" id="7298767">VerifyHostname</span><span class="op" id="7298781">(</span><span class="string" id="7298782">&#34;mail.google.com&#34;</span><span class="op" id="7298799">)</span><span class="op" id="7298800">;</span>&nbsp;<span class="ident" id="7298802">err</span>&nbsp;<span class="op" id="7298806">!=</span>&nbsp;<span class="ident" id="7298809">nil</span>&nbsp;<span class="op" id="7298813">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298817">t</span><span class="op" id="7298818">.</span><span class="ident" id="7298819">Error</span><span class="op" id="7298824">(</span><span class="ident" id="7298825">err</span><span class="op" id="7298828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298835">const</span>&nbsp;<span class="ident" id="7298841">expectedExtensions</span>&nbsp;<span class="op" id="7298860">=</span>&nbsp;<span class="num" id="7298862">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298865">if</span>&nbsp;<span class="ident" id="7298868">n</span>&nbsp;<span class="op" id="7298870">:=</span>&nbsp;<span class="builtinfunc" id="7298873">len</span><span class="op" id="7298876">(</span><span class="ident" id="7298877">certs</span><span class="op" id="7298882">[</span><span class="num" id="7298883">0</span><span class="op" id="7298884">]</span><span class="op" id="7298885">.</span><span class="ident" id="7298886">Extensions</span><span class="op" id="7298896">)</span><span class="op" id="7298897">;</span>&nbsp;<span class="ident" id="7298899">n</span>&nbsp;<span class="op" id="7298901">!=</span>&nbsp;<span class="ident" id="7298904">expectedExtensions</span>&nbsp;<span class="op" id="7298923">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298927">t</span><span class="op" id="7298928">.</span><span class="ident" id="7298929">Errorf</span><span class="op" id="7298935">(</span><span class="string" id="7298936">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7298964">,</span>&nbsp;<span class="ident" id="7298966">expectedExtensions</span><span class="op" id="7298984">,</span>&nbsp;<span class="ident" id="7298986">n</span><span class="op" id="7298987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298990">}</span><br>
<span class="lineno"></span><span class="op" id="7298992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7298995">var</span>&nbsp;<span class="ident" id="7298999">certBytes</span>&nbsp;<span class="op" id="7299009">=</span>&nbsp;<span class="string" id="7299011">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="7299092">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299095">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="7299176">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299179">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="7299260">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299263">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="7299344">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299347">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="7299428">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299431">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="7299512">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299515">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="7299596">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299599">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="7299680">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299683">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="7299764">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299767">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="7299848">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299851">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="7299932">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7299935">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="7300016">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300019">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="7300100">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300103">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="7300184">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300187">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="7300268">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300271">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="7300352">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300355">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="7300436">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300439">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="7300520">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300523">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="7300604">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300607">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="7300688">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300691">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="7300772">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300775">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="7300856">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300859">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="7300940">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300943">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="7301024">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301027">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="7301108">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301111">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="7301192">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301195">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="7301276">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301279">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="7301360">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301363">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="7301444">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301447">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="7301528">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301531">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="7301612">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301615">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="7301696">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301699">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="7301780">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301783">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="7301864">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301867">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="7301948">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301951">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="7302032">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302035">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="7302116">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302119">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="7302200">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302203">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="7302284">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302287">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="7302368">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302371">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="7302452">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302455">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7302487">func</span>&nbsp;<span class="ident" id="7302492">TestCreateSelfSignedCertificate</span><span class="op" id="7302523">(</span><span class="ident" id="7302524">t</span>&nbsp;<span class="op" id="7302526">*</span><span class="ident" id="7302527">testing</span><span class="op" id="7302534">.</span><span class="ident" id="7302535">T</span><span class="op" id="7302536">)</span>&nbsp;<span class="op" id="7302538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302541">random</span>&nbsp;<span class="op" id="7302548">:=</span>&nbsp;<span class="ident" id="7302551">rand</span><span class="op" id="7302555">.</span><span class="ident" id="7302556">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302565">block</span><span class="op" id="7302570">,</span>&nbsp;<span class="ident" id="7302572">_</span>&nbsp;<span class="op" id="7302574">:=</span>&nbsp;<span class="ident" id="7302577">pem</span><span class="op" id="7302580">.</span><span class="ident" id="7302581">Decode</span><span class="op" id="7302587">(</span><span class="op" id="7302588">[</span><span class="op" id="7302589">]</span><span class="builtintype" id="7302590">byte</span><span class="op" id="7302594">(</span><span class="ident" id="7302595">pemPrivateKey</span><span class="op" id="7302608">)</span><span class="op" id="7302609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302612">rsaPriv</span><span class="op" id="7302619">,</span>&nbsp;<span class="ident" id="7302621">err</span>&nbsp;<span class="op" id="7302625">:=</span>&nbsp;<span class="ident" id="7302628">ParsePKCS1PrivateKey</span><span class="op" id="7302648">(</span><span class="ident" id="7302649">block</span><span class="op" id="7302654">.</span><span class="ident" id="7302655">Bytes</span><span class="op" id="7302660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7302663">if</span>&nbsp;<span class="ident" id="7302666">err</span>&nbsp;<span class="op" id="7302670">!=</span>&nbsp;<span class="ident" id="7302673">nil</span>&nbsp;<span class="op" id="7302677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302681">t</span><span class="op" id="7302682">.</span><span class="ident" id="7302683">Fatalf</span><span class="op" id="7302689">(</span><span class="string" id="7302690">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7302723">,</span>&nbsp;<span class="ident" id="7302725">err</span><span class="op" id="7302728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7302731">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302735">ecdsaPriv</span><span class="op" id="7302744">,</span>&nbsp;<span class="ident" id="7302746">err</span>&nbsp;<span class="op" id="7302750">:=</span>&nbsp;<span class="ident" id="7302753">ecdsa</span><span class="op" id="7302758">.</span><span class="ident" id="7302759">GenerateKey</span><span class="op" id="7302770">(</span><span class="ident" id="7302771">elliptic</span><span class="op" id="7302779">.</span><span class="ident" id="7302780">P256</span><span class="op" id="7302784">(</span><span class="op" id="7302785">)</span><span class="op" id="7302786">,</span>&nbsp;<span class="ident" id="7302788">rand</span><span class="op" id="7302792">.</span><span class="ident" id="7302793">Reader</span><span class="op" id="7302799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7302802">if</span>&nbsp;<span class="ident" id="7302805">err</span>&nbsp;<span class="op" id="7302809">!=</span>&nbsp;<span class="ident" id="7302812">nil</span>&nbsp;<span class="op" id="7302816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302820">t</span><span class="op" id="7302821">.</span><span class="ident" id="7302822">Fatalf</span><span class="op" id="7302828">(</span><span class="string" id="7302829">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7302863">,</span>&nbsp;<span class="ident" id="7302865">err</span><span class="op" id="7302868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7302871">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302875">tests</span>&nbsp;<span class="op" id="7302881">:=</span>&nbsp;<span class="op" id="7302884">[</span><span class="op" id="7302885">]</span><span class="keyword" id="7302886">struct</span>&nbsp;<span class="op" id="7302893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302897">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7302907">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302916">pub</span><span class="op" id="7302919">,</span>&nbsp;<span class="ident" id="7302921">priv</span>&nbsp;<span class="keyword" id="7302926">interface</span><span class="op" id="7302935">{</span><span class="op" id="7302936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302940">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="7302950">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302957">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7302967">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7302987">}</span><span class="op" id="7302988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7302992">{</span><span class="string" id="7302993">&#34;RSA/RSA&#34;</span><span class="op" id="7303002">,</span>&nbsp;<span class="op" id="7303004">&amp;</span><span class="ident" id="7303005">rsaPriv</span><span class="op" id="7303012">.</span><span class="ident" id="7303013">PublicKey</span><span class="op" id="7303022">,</span>&nbsp;<span class="ident" id="7303024">rsaPriv</span><span class="op" id="7303031">,</span>&nbsp;<span class="builtintype" id="7303033">true</span><span class="op" id="7303037">,</span>&nbsp;<span class="ident" id="7303039">SHA1WithRSA</span><span class="op" id="7303050">}</span><span class="op" id="7303051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7303055">{</span><span class="string" id="7303056">&#34;RSA/ECDSA&#34;</span><span class="op" id="7303067">,</span>&nbsp;<span class="op" id="7303069">&amp;</span><span class="ident" id="7303070">rsaPriv</span><span class="op" id="7303077">.</span><span class="ident" id="7303078">PublicKey</span><span class="op" id="7303087">,</span>&nbsp;<span class="ident" id="7303089">ecdsaPriv</span><span class="op" id="7303098">,</span>&nbsp;<span class="builtintype" id="7303100">false</span><span class="op" id="7303105">,</span>&nbsp;<span class="ident" id="7303107">ECDSAWithSHA384</span><span class="op" id="7303122">}</span><span class="op" id="7303123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7303127">{</span><span class="string" id="7303128">&#34;ECDSA/RSA&#34;</span><span class="op" id="7303139">,</span>&nbsp;<span class="op" id="7303141">&amp;</span><span class="ident" id="7303142">ecdsaPriv</span><span class="op" id="7303151">.</span><span class="ident" id="7303152">PublicKey</span><span class="op" id="7303161">,</span>&nbsp;<span class="ident" id="7303163">rsaPriv</span><span class="op" id="7303170">,</span>&nbsp;<span class="builtintype" id="7303172">false</span><span class="op" id="7303177">,</span>&nbsp;<span class="ident" id="7303179">SHA256WithRSA</span><span class="op" id="7303192">}</span><span class="op" id="7303193">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7303197">{</span><span class="string" id="7303198">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="7303211">,</span>&nbsp;<span class="op" id="7303213">&amp;</span><span class="ident" id="7303214">ecdsaPriv</span><span class="op" id="7303223">.</span><span class="ident" id="7303224">PublicKey</span><span class="op" id="7303233">,</span>&nbsp;<span class="ident" id="7303235">ecdsaPriv</span><span class="op" id="7303244">,</span>&nbsp;<span class="builtintype" id="7303246">true</span><span class="op" id="7303250">,</span>&nbsp;<span class="ident" id="7303252">ECDSAWithSHA1</span><span class="op" id="7303265">}</span><span class="op" id="7303266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7303269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303273">testExtKeyUsage</span>&nbsp;<span class="op" id="7303289">:=</span>&nbsp;<span class="op" id="7303292">[</span><span class="op" id="7303293">]</span><span class="ident" id="7303294">ExtKeyUsage</span><span class="op" id="7303305">{</span><span class="ident" id="7303306">ExtKeyUsageClientAuth</span><span class="op" id="7303327">,</span>&nbsp;<span class="ident" id="7303329">ExtKeyUsageServerAuth</span><span class="op" id="7303350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303353">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="7303376">:=</span>&nbsp;<span class="op" id="7303379">[</span><span class="op" id="7303380">]</span><span class="ident" id="7303381">asn1</span><span class="op" id="7303385">.</span><span class="ident" id="7303386">ObjectIdentifier</span><span class="op" id="7303402">{</span><span class="op" id="7303403">[</span><span class="op" id="7303404">]</span><span class="builtintype" id="7303405">int</span><span class="op" id="7303408">{</span><span class="num" id="7303409">1</span><span class="op" id="7303410">,</span>&nbsp;<span class="num" id="7303412">2</span><span class="op" id="7303413">,</span>&nbsp;<span class="num" id="7303415">3</span><span class="op" id="7303416">}</span><span class="op" id="7303417">,</span>&nbsp;<span class="op" id="7303419">[</span><span class="op" id="7303420">]</span><span class="builtintype" id="7303421">int</span><span class="op" id="7303424">{</span><span class="num" id="7303425">2</span><span class="op" id="7303426">,</span>&nbsp;<span class="num" id="7303428">59</span><span class="op" id="7303430">,</span>&nbsp;<span class="num" id="7303432">1</span><span class="op" id="7303433">}</span><span class="op" id="7303434">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303437">extraExtensionData</span>&nbsp;<span class="op" id="7303456">:=</span>&nbsp;<span class="op" id="7303459">[</span><span class="op" id="7303460">]</span><span class="builtintype" id="7303461">byte</span><span class="op" id="7303465">(</span><span class="string" id="7303466">&#34;extra&nbsp;extension&#34;</span><span class="op" id="7303483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7303487">for</span>&nbsp;<span class="ident" id="7303491">_</span><span class="op" id="7303492">,</span>&nbsp;<span class="ident" id="7303494">test</span>&nbsp;<span class="op" id="7303499">:=</span>&nbsp;<span class="keyword" id="7303502">range</span>&nbsp;<span class="ident" id="7303508">tests</span>&nbsp;<span class="op" id="7303514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303518">commonName</span>&nbsp;<span class="op" id="7303529">:=</span>&nbsp;<span class="string" id="7303532">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303553">template</span>&nbsp;<span class="op" id="7303562">:=</span>&nbsp;<span class="ident" id="7303565">Certificate</span><span class="op" id="7303576">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303581">SerialNumber</span><span class="op" id="7303593">:</span>&nbsp;<span class="ident" id="7303595">big</span><span class="op" id="7303598">.</span><span class="ident" id="7303599">NewInt</span><span class="op" id="7303605">(</span><span class="num" id="7303606">1</span><span class="op" id="7303607">)</span><span class="op" id="7303608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303613">Subject</span><span class="op" id="7303620">:</span>&nbsp;<span class="ident" id="7303622">pkix</span><span class="op" id="7303626">.</span><span class="ident" id="7303627">Name</span><span class="op" id="7303631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303637">CommonName</span><span class="op" id="7303647">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7303651">commonName</span><span class="op" id="7303661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303667">Organization</span><span class="op" id="7303679">:</span>&nbsp;<span class="op" id="7303681">[</span><span class="op" id="7303682">]</span><span class="builtintype" id="7303683">string</span><span class="op" id="7303689">{</span><span class="string" id="7303690">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7303702">}</span><span class="op" id="7303703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7303708">}</span><span class="op" id="7303709">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303714">NotBefore</span><span class="op" id="7303723">:</span>&nbsp;<span class="ident" id="7303725">time</span><span class="op" id="7303729">.</span><span class="ident" id="7303730">Unix</span><span class="op" id="7303734">(</span><span class="num" id="7303735">1000</span><span class="op" id="7303739">,</span>&nbsp;<span class="num" id="7303741">0</span><span class="op" id="7303742">)</span><span class="op" id="7303743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303748">NotAfter</span><span class="op" id="7303756">:</span>&nbsp;&nbsp;<span class="ident" id="7303759">time</span><span class="op" id="7303763">.</span><span class="ident" id="7303764">Unix</span><span class="op" id="7303768">(</span><span class="num" id="7303769">100000</span><span class="op" id="7303775">,</span>&nbsp;<span class="num" id="7303777">0</span><span class="op" id="7303778">)</span><span class="op" id="7303779">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303785">SignatureAlgorithm</span><span class="op" id="7303803">:</span>&nbsp;<span class="ident" id="7303805">test</span><span class="op" id="7303809">.</span><span class="ident" id="7303810">sigAlgo</span><span class="op" id="7303817">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303823">SubjectKeyId</span><span class="op" id="7303835">:</span>&nbsp;<span class="op" id="7303837">[</span><span class="op" id="7303838">]</span><span class="builtintype" id="7303839">byte</span><span class="op" id="7303843">{</span><span class="num" id="7303844">1</span><span class="op" id="7303845">,</span>&nbsp;<span class="num" id="7303847">2</span><span class="op" id="7303848">,</span>&nbsp;<span class="num" id="7303850">3</span><span class="op" id="7303851">,</span>&nbsp;<span class="num" id="7303853">4</span><span class="op" id="7303854">}</span><span class="op" id="7303855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303860">KeyUsage</span><span class="op" id="7303868">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7303874">KeyUsageCertSign</span><span class="op" id="7303890">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303896">ExtKeyUsage</span><span class="op" id="7303907">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7303916">testExtKeyUsage</span><span class="op" id="7303931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303936">UnknownExtKeyUsage</span><span class="op" id="7303954">:</span>&nbsp;<span class="ident" id="7303956">testUnknownExtKeyUsage</span><span class="op" id="7303978">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303984">BasicConstraintsValid</span><span class="op" id="7304005">:</span>&nbsp;<span class="builtintype" id="7304007">true</span><span class="op" id="7304011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304016">IsCA</span><span class="op" id="7304020">:</span>&nbsp;<span class="builtintype" id="7304022">true</span><span class="op" id="7304026">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304032">OCSPServer</span><span class="op" id="7304042">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304055">[</span><span class="op" id="7304056">]</span><span class="builtintype" id="7304057">string</span><span class="op" id="7304063">{</span><span class="string" id="7304064">&#34;http://ocsp.example.com&#34;</span><span class="op" id="7304089">}</span><span class="op" id="7304090">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304095">IssuingCertificateURL</span><span class="op" id="7304116">:</span>&nbsp;<span class="op" id="7304118">[</span><span class="op" id="7304119">]</span><span class="builtintype" id="7304120">string</span><span class="op" id="7304126">{</span><span class="string" id="7304127">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="7304159">}</span><span class="op" id="7304160">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304166">DNSNames</span><span class="op" id="7304174">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304182">[</span><span class="op" id="7304183">]</span><span class="builtintype" id="7304184">string</span><span class="op" id="7304190">{</span><span class="string" id="7304191">&#34;test.example.com&#34;</span><span class="op" id="7304209">}</span><span class="op" id="7304210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304215">EmailAddresses</span><span class="op" id="7304229">:</span>&nbsp;<span class="op" id="7304231">[</span><span class="op" id="7304232">]</span><span class="builtintype" id="7304233">string</span><span class="op" id="7304239">{</span><span class="string" id="7304240">&#34;gopher@golang.org&#34;</span><span class="op" id="7304259">}</span><span class="op" id="7304260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304265">IPAddresses</span><span class="op" id="7304276">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304281">[</span><span class="op" id="7304282">]</span><span class="ident" id="7304283">net</span><span class="op" id="7304286">.</span><span class="ident" id="7304287">IP</span><span class="op" id="7304289">{</span><span class="ident" id="7304290">net</span><span class="op" id="7304293">.</span><span class="ident" id="7304294">IPv4</span><span class="op" id="7304298">(</span><span class="num" id="7304299">127</span><span class="op" id="7304302">,</span>&nbsp;<span class="num" id="7304304">0</span><span class="op" id="7304305">,</span>&nbsp;<span class="num" id="7304307">0</span><span class="op" id="7304308">,</span>&nbsp;<span class="num" id="7304310">1</span><span class="op" id="7304311">)</span><span class="op" id="7304312">.</span><span class="ident" id="7304313">To4</span><span class="op" id="7304316">(</span><span class="op" id="7304317">)</span><span class="op" id="7304318">,</span>&nbsp;<span class="ident" id="7304320">net</span><span class="op" id="7304323">.</span><span class="ident" id="7304324">ParseIP</span><span class="op" id="7304331">(</span><span class="string" id="7304332">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7304354">)</span><span class="op" id="7304355">}</span><span class="op" id="7304356">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304362">PolicyIdentifiers</span><span class="op" id="7304379">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7304383">[</span><span class="op" id="7304384">]</span><span class="ident" id="7304385">asn1</span><span class="op" id="7304389">.</span><span class="ident" id="7304390">ObjectIdentifier</span><span class="op" id="7304406">{</span><span class="op" id="7304407">[</span><span class="op" id="7304408">]</span><span class="builtintype" id="7304409">int</span><span class="op" id="7304412">{</span><span class="num" id="7304413">1</span><span class="op" id="7304414">,</span>&nbsp;<span class="num" id="7304416">2</span><span class="op" id="7304417">,</span>&nbsp;<span class="num" id="7304419">3</span><span class="op" id="7304420">}</span><span class="op" id="7304421">}</span><span class="op" id="7304422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304427">PermittedDNSDomains</span><span class="op" id="7304446">:</span>&nbsp;<span class="op" id="7304448">[</span><span class="op" id="7304449">]</span><span class="builtintype" id="7304450">string</span><span class="op" id="7304456">{</span><span class="string" id="7304457">&#34;.example.com&#34;</span><span class="op" id="7304471">,</span>&nbsp;<span class="string" id="7304473">&#34;example.com&#34;</span><span class="op" id="7304486">}</span><span class="op" id="7304487">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304493">CRLDistributionPoints</span><span class="op" id="7304514">:</span>&nbsp;<span class="op" id="7304516">[</span><span class="op" id="7304517">]</span><span class="builtintype" id="7304518">string</span><span class="op" id="7304524">{</span><span class="string" id="7304525">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="7304558">,</span>&nbsp;<span class="string" id="7304560">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="7304593">}</span><span class="op" id="7304594">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304600">ExtraExtensions</span><span class="op" id="7304615">:</span>&nbsp;<span class="op" id="7304617">[</span><span class="op" id="7304618">]</span><span class="ident" id="7304619">pkix</span><span class="op" id="7304623">.</span><span class="ident" id="7304624">Extension</span><span class="op" id="7304633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7304639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304646">Id</span><span class="op" id="7304648">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304653">[</span><span class="op" id="7304654">]</span><span class="builtintype" id="7304655">int</span><span class="op" id="7304658">{</span><span class="num" id="7304659">1</span><span class="op" id="7304660">,</span>&nbsp;<span class="num" id="7304662">2</span><span class="op" id="7304663">,</span>&nbsp;<span class="num" id="7304665">3</span><span class="op" id="7304666">,</span>&nbsp;<span class="num" id="7304668">4</span><span class="op" id="7304669">}</span><span class="op" id="7304670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304677">Value</span><span class="op" id="7304682">:</span>&nbsp;<span class="ident" id="7304684">extraExtensionData</span><span class="op" id="7304702">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7304708">}</span><span class="op" id="7304709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7304715">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7304778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304785">Id</span><span class="op" id="7304787">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7304795">oidExtensionSubjectKeyId</span><span class="op" id="7304819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304826">Critical</span><span class="op" id="7304834">:</span>&nbsp;<span class="builtintype" id="7304836">false</span><span class="op" id="7304841">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304848">Value</span><span class="op" id="7304853">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7304858">[</span><span class="op" id="7304859">]</span><span class="builtintype" id="7304860">byte</span><span class="op" id="7304864">{</span><span class="num" id="7304865">0x04</span><span class="op" id="7304869">,</span>&nbsp;<span class="num" id="7304871">0x04</span><span class="op" id="7304875">,</span>&nbsp;<span class="num" id="7304877">4</span><span class="op" id="7304878">,</span>&nbsp;<span class="num" id="7304880">3</span><span class="op" id="7304881">,</span>&nbsp;<span class="num" id="7304883">2</span><span class="op" id="7304884">,</span>&nbsp;<span class="num" id="7304886">1</span><span class="op" id="7304887">}</span><span class="op" id="7304888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7304894">}</span><span class="op" id="7304895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7304900">}</span><span class="op" id="7304901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7304905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304910">derBytes</span><span class="op" id="7304918">,</span>&nbsp;<span class="ident" id="7304920">err</span>&nbsp;<span class="op" id="7304924">:=</span>&nbsp;<span class="ident" id="7304927">CreateCertificate</span><span class="op" id="7304944">(</span><span class="ident" id="7304945">random</span><span class="op" id="7304951">,</span>&nbsp;<span class="op" id="7304953">&amp;</span><span class="ident" id="7304954">template</span><span class="op" id="7304962">,</span>&nbsp;<span class="op" id="7304964">&amp;</span><span class="ident" id="7304965">template</span><span class="op" id="7304973">,</span>&nbsp;<span class="ident" id="7304975">test</span><span class="op" id="7304979">.</span><span class="ident" id="7304980">pub</span><span class="op" id="7304983">,</span>&nbsp;<span class="ident" id="7304985">test</span><span class="op" id="7304989">.</span><span class="ident" id="7304990">priv</span><span class="op" id="7304994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7304998">if</span>&nbsp;<span class="ident" id="7305001">err</span>&nbsp;<span class="op" id="7305005">!=</span>&nbsp;<span class="ident" id="7305008">nil</span>&nbsp;<span class="op" id="7305012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305017">t</span><span class="op" id="7305018">.</span><span class="ident" id="7305019">Errorf</span><span class="op" id="7305025">(</span><span class="string" id="7305026">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7305064">,</span>&nbsp;<span class="ident" id="7305066">test</span><span class="op" id="7305070">.</span><span class="ident" id="7305071">name</span><span class="op" id="7305075">,</span>&nbsp;<span class="ident" id="7305077">err</span><span class="op" id="7305080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305085">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305096">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305101">cert</span><span class="op" id="7305105">,</span>&nbsp;<span class="ident" id="7305107">err</span>&nbsp;<span class="op" id="7305111">:=</span>&nbsp;<span class="ident" id="7305114">ParseCertificate</span><span class="op" id="7305130">(</span><span class="ident" id="7305131">derBytes</span><span class="op" id="7305139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305143">if</span>&nbsp;<span class="ident" id="7305146">err</span>&nbsp;<span class="op" id="7305150">!=</span>&nbsp;<span class="ident" id="7305153">nil</span>&nbsp;<span class="op" id="7305157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305162">t</span><span class="op" id="7305163">.</span><span class="ident" id="7305164">Errorf</span><span class="op" id="7305170">(</span><span class="string" id="7305171">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7305208">,</span>&nbsp;<span class="ident" id="7305210">test</span><span class="op" id="7305214">.</span><span class="ident" id="7305215">name</span><span class="op" id="7305219">,</span>&nbsp;<span class="ident" id="7305221">err</span><span class="op" id="7305224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305229">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305245">if</span>&nbsp;<span class="builtinfunc" id="7305248">len</span><span class="op" id="7305251">(</span><span class="ident" id="7305252">cert</span><span class="op" id="7305256">.</span><span class="ident" id="7305257">PolicyIdentifiers</span><span class="op" id="7305274">)</span>&nbsp;<span class="op" id="7305276">!=</span>&nbsp;<span class="num" id="7305279">1</span>&nbsp;<span class="op" id="7305281">||</span>&nbsp;<span class="op" id="7305284">!</span><span class="ident" id="7305285">cert</span><span class="op" id="7305289">.</span><span class="ident" id="7305290">PolicyIdentifiers</span><span class="op" id="7305307">[</span><span class="num" id="7305308">0</span><span class="op" id="7305309">]</span><span class="op" id="7305310">.</span><span class="ident" id="7305311">Equal</span><span class="op" id="7305316">(</span><span class="ident" id="7305317">template</span><span class="op" id="7305325">.</span><span class="ident" id="7305326">PolicyIdentifiers</span><span class="op" id="7305343">[</span><span class="num" id="7305344">0</span><span class="op" id="7305345">]</span><span class="op" id="7305346">)</span>&nbsp;<span class="op" id="7305348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305353">t</span><span class="op" id="7305354">.</span><span class="ident" id="7305355">Errorf</span><span class="op" id="7305361">(</span><span class="string" id="7305362">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7305420">,</span>&nbsp;<span class="ident" id="7305422">test</span><span class="op" id="7305426">.</span><span class="ident" id="7305427">name</span><span class="op" id="7305431">,</span>&nbsp;<span class="ident" id="7305433">cert</span><span class="op" id="7305437">.</span><span class="ident" id="7305438">PolicyIdentifiers</span><span class="op" id="7305455">,</span>&nbsp;<span class="ident" id="7305457">template</span><span class="op" id="7305465">.</span><span class="ident" id="7305466">PolicyIdentifiers</span><span class="op" id="7305483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305487">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305492">if</span>&nbsp;<span class="builtinfunc" id="7305495">len</span><span class="op" id="7305498">(</span><span class="ident" id="7305499">cert</span><span class="op" id="7305503">.</span><span class="ident" id="7305504">PermittedDNSDomains</span><span class="op" id="7305523">)</span>&nbsp;<span class="op" id="7305525">!=</span>&nbsp;<span class="num" id="7305528">2</span>&nbsp;<span class="op" id="7305530">||</span>&nbsp;<span class="ident" id="7305533">cert</span><span class="op" id="7305537">.</span><span class="ident" id="7305538">PermittedDNSDomains</span><span class="op" id="7305557">[</span><span class="num" id="7305558">0</span><span class="op" id="7305559">]</span>&nbsp;<span class="op" id="7305561">!=</span>&nbsp;<span class="string" id="7305564">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="7305579">||</span>&nbsp;<span class="ident" id="7305582">cert</span><span class="op" id="7305586">.</span><span class="ident" id="7305587">PermittedDNSDomains</span><span class="op" id="7305606">[</span><span class="num" id="7305607">1</span><span class="op" id="7305608">]</span>&nbsp;<span class="op" id="7305610">!=</span>&nbsp;<span class="string" id="7305613">&#34;example.com&#34;</span>&nbsp;<span class="op" id="7305627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305632">t</span><span class="op" id="7305633">.</span><span class="ident" id="7305634">Errorf</span><span class="op" id="7305640">(</span><span class="string" id="7305641">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="7305684">,</span>&nbsp;<span class="ident" id="7305686">test</span><span class="op" id="7305690">.</span><span class="ident" id="7305691">name</span><span class="op" id="7305695">,</span>&nbsp;<span class="ident" id="7305697">cert</span><span class="op" id="7305701">.</span><span class="ident" id="7305702">PermittedDNSDomains</span><span class="op" id="7305721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305730">if</span>&nbsp;<span class="ident" id="7305733">cert</span><span class="op" id="7305737">.</span><span class="ident" id="7305738">Subject</span><span class="op" id="7305745">.</span><span class="ident" id="7305746">CommonName</span>&nbsp;<span class="op" id="7305757">!=</span>&nbsp;<span class="ident" id="7305760">commonName</span>&nbsp;<span class="op" id="7305771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305776">t</span><span class="op" id="7305777">.</span><span class="ident" id="7305778">Errorf</span><span class="op" id="7305784">(</span><span class="string" id="7305785">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7305857">,</span>&nbsp;<span class="ident" id="7305859">test</span><span class="op" id="7305863">.</span><span class="ident" id="7305864">name</span><span class="op" id="7305868">,</span>&nbsp;<span class="ident" id="7305870">cert</span><span class="op" id="7305874">.</span><span class="ident" id="7305875">Subject</span><span class="op" id="7305882">.</span><span class="ident" id="7305883">CommonName</span><span class="op" id="7305893">,</span>&nbsp;<span class="ident" id="7305895">commonName</span><span class="op" id="7305905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305914">if</span>&nbsp;<span class="ident" id="7305917">cert</span><span class="op" id="7305921">.</span><span class="ident" id="7305922">Issuer</span><span class="op" id="7305928">.</span><span class="ident" id="7305929">CommonName</span>&nbsp;<span class="op" id="7305940">!=</span>&nbsp;<span class="ident" id="7305943">commonName</span>&nbsp;<span class="op" id="7305954">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305959">t</span><span class="op" id="7305960">.</span><span class="ident" id="7305961">Errorf</span><span class="op" id="7305967">(</span><span class="string" id="7305968">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7306039">,</span>&nbsp;<span class="ident" id="7306041">test</span><span class="op" id="7306045">.</span><span class="ident" id="7306046">name</span><span class="op" id="7306050">,</span>&nbsp;<span class="ident" id="7306052">cert</span><span class="op" id="7306056">.</span><span class="ident" id="7306057">Issuer</span><span class="op" id="7306063">.</span><span class="ident" id="7306064">CommonName</span><span class="op" id="7306074">,</span>&nbsp;<span class="ident" id="7306076">commonName</span><span class="op" id="7306086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306095">if</span>&nbsp;<span class="ident" id="7306098">cert</span><span class="op" id="7306102">.</span><span class="ident" id="7306103">SignatureAlgorithm</span>&nbsp;<span class="op" id="7306122">!=</span>&nbsp;<span class="ident" id="7306125">test</span><span class="op" id="7306129">.</span><span class="ident" id="7306130">sigAlgo</span>&nbsp;<span class="op" id="7306138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306143">t</span><span class="op" id="7306144">.</span><span class="ident" id="7306145">Errorf</span><span class="op" id="7306151">(</span><span class="string" id="7306152">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7306221">,</span>&nbsp;<span class="ident" id="7306223">test</span><span class="op" id="7306227">.</span><span class="ident" id="7306228">name</span><span class="op" id="7306232">,</span>&nbsp;<span class="ident" id="7306234">cert</span><span class="op" id="7306238">.</span><span class="ident" id="7306239">SignatureAlgorithm</span><span class="op" id="7306257">,</span>&nbsp;<span class="ident" id="7306259">test</span><span class="op" id="7306263">.</span><span class="ident" id="7306264">sigAlgo</span><span class="op" id="7306271">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306280">if</span>&nbsp;<span class="op" id="7306283">!</span><span class="ident" id="7306284">reflect</span><span class="op" id="7306291">.</span><span class="ident" id="7306292">DeepEqual</span><span class="op" id="7306301">(</span><span class="ident" id="7306302">cert</span><span class="op" id="7306306">.</span><span class="ident" id="7306307">ExtKeyUsage</span><span class="op" id="7306318">,</span>&nbsp;<span class="ident" id="7306320">testExtKeyUsage</span><span class="op" id="7306335">)</span>&nbsp;<span class="op" id="7306337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306342">t</span><span class="op" id="7306343">.</span><span class="ident" id="7306344">Errorf</span><span class="op" id="7306350">(</span><span class="string" id="7306351">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7306427">,</span>&nbsp;<span class="ident" id="7306429">test</span><span class="op" id="7306433">.</span><span class="ident" id="7306434">name</span><span class="op" id="7306438">,</span>&nbsp;<span class="ident" id="7306440">cert</span><span class="op" id="7306444">.</span><span class="ident" id="7306445">ExtKeyUsage</span><span class="op" id="7306456">,</span>&nbsp;<span class="ident" id="7306458">testExtKeyUsage</span><span class="op" id="7306473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306477">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306482">if</span>&nbsp;<span class="op" id="7306485">!</span><span class="ident" id="7306486">reflect</span><span class="op" id="7306493">.</span><span class="ident" id="7306494">DeepEqual</span><span class="op" id="7306503">(</span><span class="ident" id="7306504">cert</span><span class="op" id="7306508">.</span><span class="ident" id="7306509">UnknownExtKeyUsage</span><span class="op" id="7306527">,</span>&nbsp;<span class="ident" id="7306529">testUnknownExtKeyUsage</span><span class="op" id="7306551">)</span>&nbsp;<span class="op" id="7306553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306558">t</span><span class="op" id="7306559">.</span><span class="ident" id="7306560">Errorf</span><span class="op" id="7306566">(</span><span class="string" id="7306567">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7306651">,</span>&nbsp;<span class="ident" id="7306653">test</span><span class="op" id="7306657">.</span><span class="ident" id="7306658">name</span><span class="op" id="7306662">,</span>&nbsp;<span class="ident" id="7306664">cert</span><span class="op" id="7306668">.</span><span class="ident" id="7306669">UnknownExtKeyUsage</span><span class="op" id="7306687">,</span>&nbsp;<span class="ident" id="7306689">testUnknownExtKeyUsage</span><span class="op" id="7306711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306720">if</span>&nbsp;<span class="op" id="7306723">!</span><span class="ident" id="7306724">reflect</span><span class="op" id="7306731">.</span><span class="ident" id="7306732">DeepEqual</span><span class="op" id="7306741">(</span><span class="ident" id="7306742">cert</span><span class="op" id="7306746">.</span><span class="ident" id="7306747">OCSPServer</span><span class="op" id="7306757">,</span>&nbsp;<span class="ident" id="7306759">template</span><span class="op" id="7306767">.</span><span class="ident" id="7306768">OCSPServer</span><span class="op" id="7306778">)</span>&nbsp;<span class="op" id="7306780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306785">t</span><span class="op" id="7306786">.</span><span class="ident" id="7306787">Errorf</span><span class="op" id="7306793">(</span><span class="string" id="7306794">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7306850">,</span>&nbsp;<span class="ident" id="7306852">test</span><span class="op" id="7306856">.</span><span class="ident" id="7306857">name</span><span class="op" id="7306861">,</span>&nbsp;<span class="ident" id="7306863">cert</span><span class="op" id="7306867">.</span><span class="ident" id="7306868">OCSPServer</span><span class="op" id="7306878">,</span>&nbsp;<span class="ident" id="7306880">template</span><span class="op" id="7306888">.</span><span class="ident" id="7306889">OCSPServer</span><span class="op" id="7306899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306908">if</span>&nbsp;<span class="op" id="7306911">!</span><span class="ident" id="7306912">reflect</span><span class="op" id="7306919">.</span><span class="ident" id="7306920">DeepEqual</span><span class="op" id="7306929">(</span><span class="ident" id="7306930">cert</span><span class="op" id="7306934">.</span><span class="ident" id="7306935">IssuingCertificateURL</span><span class="op" id="7306956">,</span>&nbsp;<span class="ident" id="7306958">template</span><span class="op" id="7306966">.</span><span class="ident" id="7306967">IssuingCertificateURL</span><span class="op" id="7306988">)</span>&nbsp;<span class="op" id="7306990">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306995">t</span><span class="op" id="7306996">.</span><span class="ident" id="7306997">Errorf</span><span class="op" id="7307003">(</span><span class="string" id="7307004">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7307072">,</span>&nbsp;<span class="ident" id="7307074">test</span><span class="op" id="7307078">.</span><span class="ident" id="7307079">name</span><span class="op" id="7307083">,</span>&nbsp;<span class="ident" id="7307085">cert</span><span class="op" id="7307089">.</span><span class="ident" id="7307090">IssuingCertificateURL</span><span class="op" id="7307111">,</span>&nbsp;<span class="ident" id="7307113">template</span><span class="op" id="7307121">.</span><span class="ident" id="7307122">IssuingCertificateURL</span><span class="op" id="7307143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307152">if</span>&nbsp;<span class="op" id="7307155">!</span><span class="ident" id="7307156">reflect</span><span class="op" id="7307163">.</span><span class="ident" id="7307164">DeepEqual</span><span class="op" id="7307173">(</span><span class="ident" id="7307174">cert</span><span class="op" id="7307178">.</span><span class="ident" id="7307179">DNSNames</span><span class="op" id="7307187">,</span>&nbsp;<span class="ident" id="7307189">template</span><span class="op" id="7307197">.</span><span class="ident" id="7307198">DNSNames</span><span class="op" id="7307206">)</span>&nbsp;<span class="op" id="7307208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307213">t</span><span class="op" id="7307214">.</span><span class="ident" id="7307215">Errorf</span><span class="op" id="7307221">(</span><span class="string" id="7307222">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7307279">,</span>&nbsp;<span class="ident" id="7307281">test</span><span class="op" id="7307285">.</span><span class="ident" id="7307286">name</span><span class="op" id="7307290">,</span>&nbsp;<span class="ident" id="7307292">cert</span><span class="op" id="7307296">.</span><span class="ident" id="7307297">DNSNames</span><span class="op" id="7307305">,</span>&nbsp;<span class="ident" id="7307307">template</span><span class="op" id="7307315">.</span><span class="ident" id="7307316">DNSNames</span><span class="op" id="7307324">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307333">if</span>&nbsp;<span class="op" id="7307336">!</span><span class="ident" id="7307337">reflect</span><span class="op" id="7307344">.</span><span class="ident" id="7307345">DeepEqual</span><span class="op" id="7307354">(</span><span class="ident" id="7307355">cert</span><span class="op" id="7307359">.</span><span class="ident" id="7307360">EmailAddresses</span><span class="op" id="7307374">,</span>&nbsp;<span class="ident" id="7307376">template</span><span class="op" id="7307384">.</span><span class="ident" id="7307385">EmailAddresses</span><span class="op" id="7307399">)</span>&nbsp;<span class="op" id="7307401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307406">t</span><span class="op" id="7307407">.</span><span class="ident" id="7307408">Errorf</span><span class="op" id="7307414">(</span><span class="string" id="7307415">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7307469">,</span>&nbsp;<span class="ident" id="7307471">test</span><span class="op" id="7307475">.</span><span class="ident" id="7307476">name</span><span class="op" id="7307480">,</span>&nbsp;<span class="ident" id="7307482">cert</span><span class="op" id="7307486">.</span><span class="ident" id="7307487">EmailAddresses</span><span class="op" id="7307501">,</span>&nbsp;<span class="ident" id="7307503">template</span><span class="op" id="7307511">.</span><span class="ident" id="7307512">EmailAddresses</span><span class="op" id="7307526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307530">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307535">if</span>&nbsp;<span class="op" id="7307538">!</span><span class="ident" id="7307539">reflect</span><span class="op" id="7307546">.</span><span class="ident" id="7307547">DeepEqual</span><span class="op" id="7307556">(</span><span class="ident" id="7307557">cert</span><span class="op" id="7307561">.</span><span class="ident" id="7307562">IPAddresses</span><span class="op" id="7307573">,</span>&nbsp;<span class="ident" id="7307575">template</span><span class="op" id="7307583">.</span><span class="ident" id="7307584">IPAddresses</span><span class="op" id="7307595">)</span>&nbsp;<span class="op" id="7307597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307602">t</span><span class="op" id="7307603">.</span><span class="ident" id="7307604">Errorf</span><span class="op" id="7307610">(</span><span class="string" id="7307611">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7307662">,</span>&nbsp;<span class="ident" id="7307664">test</span><span class="op" id="7307668">.</span><span class="ident" id="7307669">name</span><span class="op" id="7307673">,</span>&nbsp;<span class="ident" id="7307675">cert</span><span class="op" id="7307679">.</span><span class="ident" id="7307680">IPAddresses</span><span class="op" id="7307691">,</span>&nbsp;<span class="ident" id="7307693">template</span><span class="op" id="7307701">.</span><span class="ident" id="7307702">IPAddresses</span><span class="op" id="7307713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307722">if</span>&nbsp;<span class="op" id="7307725">!</span><span class="ident" id="7307726">reflect</span><span class="op" id="7307733">.</span><span class="ident" id="7307734">DeepEqual</span><span class="op" id="7307743">(</span><span class="ident" id="7307744">cert</span><span class="op" id="7307748">.</span><span class="ident" id="7307749">CRLDistributionPoints</span><span class="op" id="7307770">,</span>&nbsp;<span class="ident" id="7307772">template</span><span class="op" id="7307780">.</span><span class="ident" id="7307781">CRLDistributionPoints</span><span class="op" id="7307802">)</span>&nbsp;<span class="op" id="7307804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307809">t</span><span class="op" id="7307810">.</span><span class="ident" id="7307811">Errorf</span><span class="op" id="7307817">(</span><span class="string" id="7307818">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7307885">,</span>&nbsp;<span class="ident" id="7307887">test</span><span class="op" id="7307891">.</span><span class="ident" id="7307892">name</span><span class="op" id="7307896">,</span>&nbsp;<span class="ident" id="7307898">cert</span><span class="op" id="7307902">.</span><span class="ident" id="7307903">CRLDistributionPoints</span><span class="op" id="7307924">,</span>&nbsp;<span class="ident" id="7307926">template</span><span class="op" id="7307934">.</span><span class="ident" id="7307935">CRLDistributionPoints</span><span class="op" id="7307956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307965">if</span>&nbsp;<span class="op" id="7307968">!</span><span class="ident" id="7307969">bytes</span><span class="op" id="7307974">.</span><span class="ident" id="7307975">Equal</span><span class="op" id="7307980">(</span><span class="ident" id="7307981">cert</span><span class="op" id="7307985">.</span><span class="ident" id="7307986">SubjectKeyId</span><span class="op" id="7307998">,</span>&nbsp;<span class="op" id="7308000">[</span><span class="op" id="7308001">]</span><span class="builtintype" id="7308002">byte</span><span class="op" id="7308006">{</span><span class="num" id="7308007">4</span><span class="op" id="7308008">,</span>&nbsp;<span class="num" id="7308010">3</span><span class="op" id="7308011">,</span>&nbsp;<span class="num" id="7308013">2</span><span class="op" id="7308014">,</span>&nbsp;<span class="num" id="7308016">1</span><span class="op" id="7308017">}</span><span class="op" id="7308018">)</span>&nbsp;<span class="op" id="7308020">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308025">t</span><span class="op" id="7308026">.</span><span class="ident" id="7308027">Errorf</span><span class="op" id="7308033">(</span><span class="string" id="7308034">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="7308084">,</span>&nbsp;<span class="ident" id="7308086">test</span><span class="op" id="7308090">.</span><span class="ident" id="7308091">name</span><span class="op" id="7308095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308104">if</span>&nbsp;<span class="ident" id="7308107">bytes</span><span class="op" id="7308112">.</span><span class="ident" id="7308113">Index</span><span class="op" id="7308118">(</span><span class="ident" id="7308119">derBytes</span><span class="op" id="7308127">,</span>&nbsp;<span class="ident" id="7308129">extraExtensionData</span><span class="op" id="7308147">)</span>&nbsp;<span class="op" id="7308149">==</span>&nbsp;<span class="op" id="7308152">-</span><span class="num" id="7308153">1</span>&nbsp;<span class="op" id="7308155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308160">t</span><span class="op" id="7308161">.</span><span class="ident" id="7308162">Errorf</span><span class="op" id="7308168">(</span><span class="string" id="7308169">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="7308216">,</span>&nbsp;<span class="ident" id="7308218">test</span><span class="op" id="7308222">.</span><span class="ident" id="7308223">name</span><span class="op" id="7308227">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308236">if</span>&nbsp;<span class="ident" id="7308239">test</span><span class="op" id="7308243">.</span><span class="ident" id="7308244">checkSig</span>&nbsp;<span class="op" id="7308253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308258">err</span>&nbsp;<span class="op" id="7308262">=</span>&nbsp;<span class="ident" id="7308264">cert</span><span class="op" id="7308268">.</span><span class="ident" id="7308269">CheckSignatureFrom</span><span class="op" id="7308287">(</span><span class="ident" id="7308288">cert</span><span class="op" id="7308292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308297">if</span>&nbsp;<span class="ident" id="7308300">err</span>&nbsp;<span class="op" id="7308304">!=</span>&nbsp;<span class="ident" id="7308307">nil</span>&nbsp;<span class="op" id="7308311">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308317">t</span><span class="op" id="7308318">.</span><span class="ident" id="7308319">Errorf</span><span class="op" id="7308325">(</span><span class="string" id="7308326">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7308365">,</span>&nbsp;<span class="ident" id="7308367">test</span><span class="op" id="7308371">.</span><span class="ident" id="7308372">name</span><span class="op" id="7308376">,</span>&nbsp;<span class="ident" id="7308378">err</span><span class="op" id="7308381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308393">}</span><br>
<span class="lineno"></span><span class="op" id="7308395">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="7308398">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="7308459">var</span>&nbsp;<span class="ident" id="7308463">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="7308480">=</span>&nbsp;<span class="string" id="7308482">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7309261">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="7309324">var</span>&nbsp;<span class="ident" id="7309328">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="7309351">=</span>&nbsp;<span class="string" id="7309353">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7310132">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="7310195">var</span>&nbsp;<span class="ident" id="7310199">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="7310222">=</span>&nbsp;<span class="string" id="7310224">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="7311084">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="7311147">var</span>&nbsp;<span class="ident" id="7311151">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="7311174">=</span>&nbsp;<span class="string" id="7311176">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="7312137">var</span>&nbsp;<span class="ident" id="7312141">ecdsaTests</span>&nbsp;<span class="op" id="7312152">=</span>&nbsp;<span class="op" id="7312154">[</span><span class="op" id="7312155">]</span><span class="keyword" id="7312156">struct</span>&nbsp;<span class="op" id="7312163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312166">sigAlgo</span>&nbsp;<span class="ident" id="7312174">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312194">pemCert</span>&nbsp;<span class="builtintype" id="7312202">string</span><br>
<span class="lineno"></span><span class="op" id="7312209">}</span><span class="op" id="7312210">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312213">{</span><span class="ident" id="7312214">ECDSAWithSHA1</span><span class="op" id="7312227">,</span>&nbsp;<span class="ident" id="7312229">ecdsaSHA1CertPem</span><span class="op" id="7312245">}</span><span class="op" id="7312246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312249">{</span><span class="ident" id="7312250">ECDSAWithSHA256</span><span class="op" id="7312265">,</span>&nbsp;<span class="ident" id="7312267">ecdsaSHA256p256CertPem</span><span class="op" id="7312289">}</span><span class="op" id="7312290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312293">{</span><span class="ident" id="7312294">ECDSAWithSHA256</span><span class="op" id="7312309">,</span>&nbsp;<span class="ident" id="7312311">ecdsaSHA256p384CertPem</span><span class="op" id="7312333">}</span><span class="op" id="7312334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312337">{</span><span class="ident" id="7312338">ECDSAWithSHA384</span><span class="op" id="7312353">,</span>&nbsp;<span class="ident" id="7312355">ecdsaSHA384p521CertPem</span><span class="op" id="7312377">}</span><span class="op" id="7312378">,</span><br>
<span class="lineno"></span><span class="op" id="7312380">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="7312383">func</span>&nbsp;<span class="ident" id="7312388">TestECDSA</span><span class="op" id="7312397">(</span><span class="ident" id="7312398">t</span>&nbsp;<span class="op" id="7312400">*</span><span class="ident" id="7312401">testing</span><span class="op" id="7312408">.</span><span class="ident" id="7312409">T</span><span class="op" id="7312410">)</span>&nbsp;<span class="op" id="7312412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312415">for</span>&nbsp;<span class="ident" id="7312419">i</span><span class="op" id="7312420">,</span>&nbsp;<span class="ident" id="7312422">test</span>&nbsp;<span class="op" id="7312427">:=</span>&nbsp;<span class="keyword" id="7312430">range</span>&nbsp;<span class="ident" id="7312436">ecdsaTests</span>&nbsp;<span class="op" id="7312447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312451">pemBlock</span><span class="op" id="7312459">,</span>&nbsp;<span class="ident" id="7312461">_</span>&nbsp;<span class="op" id="7312463">:=</span>&nbsp;<span class="ident" id="7312466">pem</span><span class="op" id="7312469">.</span><span class="ident" id="7312470">Decode</span><span class="op" id="7312476">(</span><span class="op" id="7312477">[</span><span class="op" id="7312478">]</span><span class="builtintype" id="7312479">byte</span><span class="op" id="7312483">(</span><span class="ident" id="7312484">test</span><span class="op" id="7312488">.</span><span class="ident" id="7312489">pemCert</span><span class="op" id="7312496">)</span><span class="op" id="7312497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312501">cert</span><span class="op" id="7312505">,</span>&nbsp;<span class="ident" id="7312507">err</span>&nbsp;<span class="op" id="7312511">:=</span>&nbsp;<span class="ident" id="7312514">ParseCertificate</span><span class="op" id="7312530">(</span><span class="ident" id="7312531">pemBlock</span><span class="op" id="7312539">.</span><span class="ident" id="7312540">Bytes</span><span class="op" id="7312545">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312549">if</span>&nbsp;<span class="ident" id="7312552">err</span>&nbsp;<span class="op" id="7312556">!=</span>&nbsp;<span class="ident" id="7312559">nil</span>&nbsp;<span class="op" id="7312563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312568">t</span><span class="op" id="7312569">.</span><span class="ident" id="7312570">Errorf</span><span class="op" id="7312576">(</span><span class="string" id="7312577">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7312614">,</span>&nbsp;<span class="ident" id="7312616">i</span><span class="op" id="7312617">,</span>&nbsp;<span class="ident" id="7312619">err</span><span class="op" id="7312622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312627">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312642">if</span>&nbsp;<span class="ident" id="7312645">sa</span>&nbsp;<span class="op" id="7312648">:=</span>&nbsp;<span class="ident" id="7312651">cert</span><span class="op" id="7312655">.</span><span class="ident" id="7312656">SignatureAlgorithm</span><span class="op" id="7312674">;</span>&nbsp;<span class="ident" id="7312676">sa</span>&nbsp;<span class="op" id="7312679">!=</span>&nbsp;<span class="ident" id="7312682">test</span><span class="op" id="7312686">.</span><span class="ident" id="7312687">sigAlgo</span>&nbsp;<span class="op" id="7312695">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312700">t</span><span class="op" id="7312701">.</span><span class="ident" id="7312702">Errorf</span><span class="op" id="7312708">(</span><span class="string" id="7312709">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7312749">,</span>&nbsp;<span class="ident" id="7312751">i</span><span class="op" id="7312752">,</span>&nbsp;<span class="ident" id="7312754">sa</span><span class="op" id="7312756">,</span>&nbsp;<span class="ident" id="7312758">test</span><span class="op" id="7312762">.</span><span class="ident" id="7312763">sigAlgo</span><span class="op" id="7312770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312778">if</span>&nbsp;<span class="ident" id="7312781">parsedKey</span><span class="op" id="7312790">,</span>&nbsp;<span class="ident" id="7312792">ok</span>&nbsp;<span class="op" id="7312795">:=</span>&nbsp;<span class="ident" id="7312798">cert</span><span class="op" id="7312802">.</span><span class="ident" id="7312803">PublicKey</span><span class="op" id="7312812">.</span><span class="op" id="7312813">(</span><span class="op" id="7312814">*</span><span class="ident" id="7312815">ecdsa</span><span class="op" id="7312820">.</span><span class="ident" id="7312821">PublicKey</span><span class="op" id="7312830">)</span><span class="op" id="7312831">;</span>&nbsp;<span class="op" id="7312833">!</span><span class="ident" id="7312834">ok</span>&nbsp;<span class="op" id="7312837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312842">t</span><span class="op" id="7312843">.</span><span class="ident" id="7312844">Errorf</span><span class="op" id="7312850">(</span><span class="string" id="7312851">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="7312898">,</span>&nbsp;<span class="ident" id="7312900">i</span><span class="op" id="7312901">,</span>&nbsp;<span class="ident" id="7312903">parsedKey</span><span class="op" id="7312912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312916">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312920">if</span>&nbsp;<span class="ident" id="7312923">pka</span>&nbsp;<span class="op" id="7312927">:=</span>&nbsp;<span class="ident" id="7312930">cert</span><span class="op" id="7312934">.</span><span class="ident" id="7312935">PublicKeyAlgorithm</span><span class="op" id="7312953">;</span>&nbsp;<span class="ident" id="7312955">pka</span>&nbsp;<span class="op" id="7312959">!=</span>&nbsp;<span class="ident" id="7312962">ECDSA</span>&nbsp;<span class="op" id="7312968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312973">t</span><span class="op" id="7312974">.</span><span class="ident" id="7312975">Errorf</span><span class="op" id="7312981">(</span><span class="string" id="7312982">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="7313026">,</span>&nbsp;<span class="ident" id="7313028">i</span><span class="op" id="7313029">,</span>&nbsp;<span class="ident" id="7313031">pka</span><span class="op" id="7313034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7313038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7313042">if</span>&nbsp;<span class="ident" id="7313045">err</span>&nbsp;<span class="op" id="7313049">=</span>&nbsp;<span class="ident" id="7313051">cert</span><span class="op" id="7313055">.</span><span class="ident" id="7313056">CheckSignatureFrom</span><span class="op" id="7313074">(</span><span class="ident" id="7313075">cert</span><span class="op" id="7313079">)</span><span class="op" id="7313080">;</span>&nbsp;<span class="ident" id="7313082">err</span>&nbsp;<span class="op" id="7313086">!=</span>&nbsp;<span class="ident" id="7313089">nil</span>&nbsp;<span class="op" id="7313093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7313098">t</span><span class="op" id="7313099">.</span><span class="ident" id="7313100">Errorf</span><span class="op" id="7313106">(</span><span class="string" id="7313107">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7313148">,</span>&nbsp;<span class="ident" id="7313150">i</span><span class="op" id="7313151">,</span>&nbsp;<span class="ident" id="7313153">err</span><span class="op" id="7313156">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7313160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7313163">}</span><br>
<span class="lineno"></span><span class="op" id="7313165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7313168">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="7313215">var</span>&nbsp;<span class="ident" id="7313219">dsaCertPem</span>&nbsp;<span class="op" id="7313230">=</span>&nbsp;<span class="string" id="7313232">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="7314700">func</span>&nbsp;<span class="ident" id="7314705">TestParseCertificateWithDsaPublicKey</span><span class="op" id="7314741">(</span><span class="ident" id="7314742">t</span>&nbsp;<span class="op" id="7314744">*</span><span class="ident" id="7314745">testing</span><span class="op" id="7314752">.</span><span class="ident" id="7314753">T</span><span class="op" id="7314754">)</span>&nbsp;<span class="op" id="7314756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7314759">expectedKey</span>&nbsp;<span class="op" id="7314771">:=</span>&nbsp;<span class="op" id="7314774">&amp;</span><span class="ident" id="7314775">dsa</span><span class="op" id="7314778">.</span><span class="ident" id="7314779">PublicKey</span><span class="op" id="7314788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7314792">Parameters</span><span class="op" id="7314802">:</span>&nbsp;<span class="ident" id="7314804">dsa</span><span class="op" id="7314807">.</span><span class="ident" id="7314808">Parameters</span><span class="op" id="7314818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7314823">P</span><span class="op" id="7314824">:</span>&nbsp;<span class="ident" id="7314826">bigFromHexString</span><span class="op" id="7314842">(</span><span class="string" id="7314843">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="7315103">)</span><span class="op" id="7315104">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315109">Q</span><span class="op" id="7315110">:</span>&nbsp;<span class="ident" id="7315112">bigFromHexString</span><span class="op" id="7315128">(</span><span class="string" id="7315129">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="7315173">)</span><span class="op" id="7315174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315179">G</span><span class="op" id="7315180">:</span>&nbsp;<span class="ident" id="7315182">bigFromHexString</span><span class="op" id="7315198">(</span><span class="string" id="7315199">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="7315459">)</span><span class="op" id="7315460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7315464">}</span><span class="op" id="7315465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315469">Y</span><span class="op" id="7315470">:</span>&nbsp;<span class="ident" id="7315472">bigFromHexString</span><span class="op" id="7315488">(</span><span class="string" id="7315489">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="7315747">)</span><span class="op" id="7315748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7315751">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315754">pemBlock</span><span class="op" id="7315762">,</span>&nbsp;<span class="ident" id="7315764">_</span>&nbsp;<span class="op" id="7315766">:=</span>&nbsp;<span class="ident" id="7315769">pem</span><span class="op" id="7315772">.</span><span class="ident" id="7315773">Decode</span><span class="op" id="7315779">(</span><span class="op" id="7315780">[</span><span class="op" id="7315781">]</span><span class="builtintype" id="7315782">byte</span><span class="op" id="7315786">(</span><span class="ident" id="7315787">dsaCertPem</span><span class="op" id="7315797">)</span><span class="op" id="7315798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315801">cert</span><span class="op" id="7315805">,</span>&nbsp;<span class="ident" id="7315807">err</span>&nbsp;<span class="op" id="7315811">:=</span>&nbsp;<span class="ident" id="7315814">ParseCertificate</span><span class="op" id="7315830">(</span><span class="ident" id="7315831">pemBlock</span><span class="op" id="7315839">.</span><span class="ident" id="7315840">Bytes</span><span class="op" id="7315845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7315848">if</span>&nbsp;<span class="ident" id="7315851">err</span>&nbsp;<span class="op" id="7315855">!=</span>&nbsp;<span class="ident" id="7315858">nil</span>&nbsp;<span class="op" id="7315862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315866">t</span><span class="op" id="7315867">.</span><span class="ident" id="7315868">Fatalf</span><span class="op" id="7315874">(</span><span class="string" id="7315875">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7315908">,</span>&nbsp;<span class="ident" id="7315910">err</span><span class="op" id="7315913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7315916">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7315919">if</span>&nbsp;<span class="ident" id="7315922">cert</span><span class="op" id="7315926">.</span><span class="ident" id="7315927">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="7315946">!=</span>&nbsp;<span class="ident" id="7315949">DSA</span>&nbsp;<span class="op" id="7315953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315957">t</span><span class="op" id="7315958">.</span><span class="ident" id="7315959">Errorf</span><span class="op" id="7315965">(</span><span class="string" id="7315966">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="7316000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7316003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316006">parsedKey</span><span class="op" id="7316015">,</span>&nbsp;<span class="ident" id="7316017">ok</span>&nbsp;<span class="op" id="7316020">:=</span>&nbsp;<span class="ident" id="7316023">cert</span><span class="op" id="7316027">.</span><span class="ident" id="7316028">PublicKey</span><span class="op" id="7316037">.</span><span class="op" id="7316038">(</span><span class="op" id="7316039">*</span><span class="ident" id="7316040">dsa</span><span class="op" id="7316043">.</span><span class="ident" id="7316044">PublicKey</span><span class="op" id="7316053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7316056">if</span>&nbsp;<span class="op" id="7316059">!</span><span class="ident" id="7316060">ok</span>&nbsp;<span class="op" id="7316063">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316067">t</span><span class="op" id="7316068">.</span><span class="ident" id="7316069">Fatalf</span><span class="op" id="7316075">(</span><span class="string" id="7316076">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7316110">,</span>&nbsp;<span class="ident" id="7316112">err</span><span class="op" id="7316115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7316118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7316121">if</span>&nbsp;<span class="ident" id="7316124">expectedKey</span><span class="op" id="7316135">.</span><span class="ident" id="7316136">Y</span><span class="op" id="7316137">.</span><span class="ident" id="7316138">Cmp</span><span class="op" id="7316141">(</span><span class="ident" id="7316142">parsedKey</span><span class="op" id="7316151">.</span><span class="ident" id="7316152">Y</span><span class="op" id="7316153">)</span>&nbsp;<span class="op" id="7316155">!=</span>&nbsp;<span class="num" id="7316158">0</span>&nbsp;<span class="op" id="7316160">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316165">expectedKey</span><span class="op" id="7316176">.</span><span class="ident" id="7316177">P</span><span class="op" id="7316178">.</span><span class="ident" id="7316179">Cmp</span><span class="op" id="7316182">(</span><span class="ident" id="7316183">parsedKey</span><span class="op" id="7316192">.</span><span class="ident" id="7316193">P</span><span class="op" id="7316194">)</span>&nbsp;<span class="op" id="7316196">!=</span>&nbsp;<span class="num" id="7316199">0</span>&nbsp;<span class="op" id="7316201">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316206">expectedKey</span><span class="op" id="7316217">.</span><span class="ident" id="7316218">Q</span><span class="op" id="7316219">.</span><span class="ident" id="7316220">Cmp</span><span class="op" id="7316223">(</span><span class="ident" id="7316224">parsedKey</span><span class="op" id="7316233">.</span><span class="ident" id="7316234">Q</span><span class="op" id="7316235">)</span>&nbsp;<span class="op" id="7316237">!=</span>&nbsp;<span class="num" id="7316240">0</span>&nbsp;<span class="op" id="7316242">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316247">expectedKey</span><span class="op" id="7316258">.</span><span class="ident" id="7316259">G</span><span class="op" id="7316260">.</span><span class="ident" id="7316261">Cmp</span><span class="op" id="7316264">(</span><span class="ident" id="7316265">parsedKey</span><span class="op" id="7316274">.</span><span class="ident" id="7316275">G</span><span class="op" id="7316276">)</span>&nbsp;<span class="op" id="7316278">!=</span>&nbsp;<span class="num" id="7316281">0</span>&nbsp;<span class="op" id="7316283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316287">t</span><span class="op" id="7316288">.</span><span class="ident" id="7316289">Fatal</span><span class="op" id="7316294">(</span><span class="string" id="7316295">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="7316333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7316336">}</span><br>
<span class="lineno"></span><span class="op" id="7316338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="7316341">func</span>&nbsp;<span class="ident" id="7316346">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="7316391">(</span><span class="ident" id="7316392">t</span>&nbsp;<span class="op" id="7316394">*</span><span class="ident" id="7316395">testing</span><span class="op" id="7316402">.</span><span class="ident" id="7316403">T</span><span class="op" id="7316404">)</span>&nbsp;<span class="op" id="7316406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316409">pemBlock</span><span class="op" id="7316417">,</span>&nbsp;<span class="ident" id="7316419">_</span>&nbsp;<span class="op" id="7316421">:=</span>&nbsp;<span class="ident" id="7316424">pem</span><span class="op" id="7316427">.</span><span class="ident" id="7316428">Decode</span><span class="op" id="7316434">(</span><span class="op" id="7316435">[</span><span class="op" id="7316436">]</span><span class="builtintype" id="7316437">byte</span><span class="op" id="7316441">(</span><span class="ident" id="7316442">dsaCertPem</span><span class="op" id="7316452">)</span><span class="op" id="7316453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316456">cert</span><span class="op" id="7316460">,</span>&nbsp;<span class="ident" id="7316462">err</span>&nbsp;<span class="op" id="7316466">:=</span>&nbsp;<span class="ident" id="7316469">ParseCertificate</span><span class="op" id="7316485">(</span><span class="ident" id="7316486">pemBlock</span><span class="op" id="7316494">.</span><span class="ident" id="7316495">Bytes</span><span class="op" id="7316500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7316503">if</span>&nbsp;<span class="ident" id="7316506">err</span>&nbsp;<span class="op" id="7316510">!=</span>&nbsp;<span class="ident" id="7316513">nil</span>&nbsp;<span class="op" id="7316517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316521">t</span><span class="op" id="7316522">.</span><span class="ident" id="7316523">Fatalf</span><span class="op" id="7316529">(</span><span class="string" id="7316530">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7316563">,</span>&nbsp;<span class="ident" id="7316565">err</span><span class="op" id="7316568">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7316571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7316574">if</span>&nbsp;<span class="ident" id="7316577">cert</span><span class="op" id="7316581">.</span><span class="ident" id="7316582">SignatureAlgorithm</span>&nbsp;<span class="op" id="7316601">!=</span>&nbsp;<span class="ident" id="7316604">DSAWithSHA1</span>&nbsp;<span class="op" id="7316616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316620">t</span><span class="op" id="7316621">.</span><span class="ident" id="7316622">Errorf</span><span class="op" id="7316628">(</span><span class="string" id="7316629">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="7316677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7316680">}</span><br>
<span class="lineno"></span><span class="op" id="7316682">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7316685">func</span>&nbsp;<span class="ident" id="7316690">TestVerifyCertificateWithDSASignature</span><span class="op" id="7316727">(</span><span class="ident" id="7316728">t</span>&nbsp;<span class="op" id="7316730">*</span><span class="ident" id="7316731">testing</span><span class="op" id="7316738">.</span><span class="ident" id="7316739">T</span><span class="op" id="7316740">)</span>&nbsp;<span class="op" id="7316742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316745">pemBlock</span><span class="op" id="7316753">,</span>&nbsp;<span class="ident" id="7316755">_</span>&nbsp;<span class="op" id="7316757">:=</span>&nbsp;<span class="ident" id="7316760">pem</span><span class="op" id="7316763">.</span><span class="ident" id="7316764">Decode</span><span class="op" id="7316770">(</span><span class="op" id="7316771">[</span><span class="op" id="7316772">]</span><span class="builtintype" id="7316773">byte</span><span class="op" id="7316777">(</span><span class="ident" id="7316778">dsaCertPem</span><span class="op" id="7316788">)</span><span class="op" id="7316789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316792">cert</span><span class="op" id="7316796">,</span>&nbsp;<span class="ident" id="7316798">err</span>&nbsp;<span class="op" id="7316802">:=</span>&nbsp;<span class="ident" id="7316805">ParseCertificate</span><span class="op" id="7316821">(</span><span class="ident" id="7316822">pemBlock</span><span class="op" id="7316830">.</span><span class="ident" id="7316831">Bytes</span><span class="op" id="7316836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7316839">if</span>&nbsp;<span class="ident" id="7316842">err</span>&nbsp;<span class="op" id="7316846">!=</span>&nbsp;<span class="ident" id="7316849">nil</span>&nbsp;<span class="op" id="7316853">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316857">t</span><span class="op" id="7316858">.</span><span class="ident" id="7316859">Fatalf</span><span class="op" id="7316865">(</span><span class="string" id="7316866">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7316899">,</span>&nbsp;<span class="ident" id="7316901">err</span><span class="op" id="7316904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7316907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7316910">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7316939">if</span>&nbsp;<span class="ident" id="7316942">err</span>&nbsp;<span class="op" id="7316946">=</span>&nbsp;<span class="ident" id="7316948">cert</span><span class="op" id="7316952">.</span><span class="ident" id="7316953">CheckSignatureFrom</span><span class="op" id="7316971">(</span><span class="ident" id="7316972">cert</span><span class="op" id="7316976">)</span><span class="op" id="7316977">;</span>&nbsp;<span class="ident" id="7316979">err</span>&nbsp;<span class="op" id="7316983">!=</span>&nbsp;<span class="ident" id="7316986">nil</span>&nbsp;<span class="op" id="7316990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316994">t</span><span class="op" id="7316995">.</span><span class="ident" id="7316996">Fatalf</span><span class="op" id="7317002">(</span><span class="string" id="7317003">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7317044">,</span>&nbsp;<span class="ident" id="7317046">err</span><span class="op" id="7317049">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317052">}</span><br>
<span class="lineno"></span><span class="op" id="7317054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7317057">const</span>&nbsp;<span class="ident" id="7317063">pemCertificate</span>&nbsp;<span class="op" id="7317078">=</span>&nbsp;<span class="string" id="7317080">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="7317798">func</span>&nbsp;<span class="ident" id="7317803">TestCRLCreation</span><span class="op" id="7317818">(</span><span class="ident" id="7317819">t</span>&nbsp;<span class="op" id="7317821">*</span><span class="ident" id="7317822">testing</span><span class="op" id="7317829">.</span><span class="ident" id="7317830">T</span><span class="op" id="7317831">)</span>&nbsp;<span class="op" id="7317833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317836">block</span><span class="op" id="7317841">,</span>&nbsp;<span class="ident" id="7317843">_</span>&nbsp;<span class="op" id="7317845">:=</span>&nbsp;<span class="ident" id="7317848">pem</span><span class="op" id="7317851">.</span><span class="ident" id="7317852">Decode</span><span class="op" id="7317858">(</span><span class="op" id="7317859">[</span><span class="op" id="7317860">]</span><span class="builtintype" id="7317861">byte</span><span class="op" id="7317865">(</span><span class="ident" id="7317866">pemPrivateKey</span><span class="op" id="7317879">)</span><span class="op" id="7317880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317883">priv</span><span class="op" id="7317887">,</span>&nbsp;<span class="ident" id="7317889">_</span>&nbsp;<span class="op" id="7317891">:=</span>&nbsp;<span class="ident" id="7317894">ParsePKCS1PrivateKey</span><span class="op" id="7317914">(</span><span class="ident" id="7317915">block</span><span class="op" id="7317920">.</span><span class="ident" id="7317921">Bytes</span><span class="op" id="7317926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317929">block</span><span class="op" id="7317934">,</span>&nbsp;<span class="ident" id="7317936">_</span>&nbsp;<span class="op" id="7317938">=</span>&nbsp;<span class="ident" id="7317940">pem</span><span class="op" id="7317943">.</span><span class="ident" id="7317944">Decode</span><span class="op" id="7317950">(</span><span class="op" id="7317951">[</span><span class="op" id="7317952">]</span><span class="builtintype" id="7317953">byte</span><span class="op" id="7317957">(</span><span class="ident" id="7317958">pemCertificate</span><span class="op" id="7317972">)</span><span class="op" id="7317973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317976">cert</span><span class="op" id="7317980">,</span>&nbsp;<span class="ident" id="7317982">_</span>&nbsp;<span class="op" id="7317984">:=</span>&nbsp;<span class="ident" id="7317987">ParseCertificate</span><span class="op" id="7318003">(</span><span class="ident" id="7318004">block</span><span class="op" id="7318009">.</span><span class="ident" id="7318010">Bytes</span><span class="op" id="7318015">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318019">now</span>&nbsp;<span class="op" id="7318023">:=</span>&nbsp;<span class="ident" id="7318026">time</span><span class="op" id="7318030">.</span><span class="ident" id="7318031">Unix</span><span class="op" id="7318035">(</span><span class="num" id="7318036">1000</span><span class="op" id="7318040">,</span>&nbsp;<span class="num" id="7318042">0</span><span class="op" id="7318043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318046">expiry</span>&nbsp;<span class="op" id="7318053">:=</span>&nbsp;<span class="ident" id="7318056">time</span><span class="op" id="7318060">.</span><span class="ident" id="7318061">Unix</span><span class="op" id="7318065">(</span><span class="num" id="7318066">10000</span><span class="op" id="7318071">,</span>&nbsp;<span class="num" id="7318073">0</span><span class="op" id="7318074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318078">revokedCerts</span>&nbsp;<span class="op" id="7318091">:=</span>&nbsp;<span class="op" id="7318094">[</span><span class="op" id="7318095">]</span><span class="ident" id="7318096">pkix</span><span class="op" id="7318100">.</span><span class="ident" id="7318101">RevokedCertificate</span><span class="op" id="7318119">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318128">SerialNumber</span><span class="op" id="7318140">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7318144">big</span><span class="op" id="7318147">.</span><span class="ident" id="7318148">NewInt</span><span class="op" id="7318154">(</span><span class="num" id="7318155">1</span><span class="op" id="7318156">)</span><span class="op" id="7318157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318162">RevocationTime</span><span class="op" id="7318176">:</span>&nbsp;<span class="ident" id="7318178">now</span><span class="op" id="7318181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318185">}</span><span class="op" id="7318186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318190">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318195">SerialNumber</span><span class="op" id="7318207">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7318211">big</span><span class="op" id="7318214">.</span><span class="ident" id="7318215">NewInt</span><span class="op" id="7318221">(</span><span class="num" id="7318222">42</span><span class="op" id="7318224">)</span><span class="op" id="7318225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318230">RevocationTime</span><span class="op" id="7318244">:</span>&nbsp;<span class="ident" id="7318246">now</span><span class="op" id="7318249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318253">}</span><span class="op" id="7318254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318261">crlBytes</span><span class="op" id="7318269">,</span>&nbsp;<span class="ident" id="7318271">err</span>&nbsp;<span class="op" id="7318275">:=</span>&nbsp;<span class="ident" id="7318278">cert</span><span class="op" id="7318282">.</span><span class="ident" id="7318283">CreateCRL</span><span class="op" id="7318292">(</span><span class="ident" id="7318293">rand</span><span class="op" id="7318297">.</span><span class="ident" id="7318298">Reader</span><span class="op" id="7318304">,</span>&nbsp;<span class="ident" id="7318306">priv</span><span class="op" id="7318310">,</span>&nbsp;<span class="ident" id="7318312">revokedCerts</span><span class="op" id="7318324">,</span>&nbsp;<span class="ident" id="7318326">now</span><span class="op" id="7318329">,</span>&nbsp;<span class="ident" id="7318331">expiry</span><span class="op" id="7318337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318340">if</span>&nbsp;<span class="ident" id="7318343">err</span>&nbsp;<span class="op" id="7318347">!=</span>&nbsp;<span class="ident" id="7318350">nil</span>&nbsp;<span class="op" id="7318354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318358">t</span><span class="op" id="7318359">.</span><span class="ident" id="7318360">Errorf</span><span class="op" id="7318366">(</span><span class="string" id="7318367">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7318391">,</span>&nbsp;<span class="ident" id="7318393">err</span><span class="op" id="7318396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318403">_</span><span class="op" id="7318404">,</span>&nbsp;<span class="ident" id="7318406">err</span>&nbsp;<span class="op" id="7318410">=</span>&nbsp;<span class="ident" id="7318412">ParseDERCRL</span><span class="op" id="7318423">(</span><span class="ident" id="7318424">crlBytes</span><span class="op" id="7318432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318435">if</span>&nbsp;<span class="ident" id="7318438">err</span>&nbsp;<span class="op" id="7318442">!=</span>&nbsp;<span class="ident" id="7318445">nil</span>&nbsp;<span class="op" id="7318449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318453">t</span><span class="op" id="7318454">.</span><span class="ident" id="7318455">Errorf</span><span class="op" id="7318461">(</span><span class="string" id="7318462">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7318487">,</span>&nbsp;<span class="ident" id="7318489">err</span><span class="op" id="7318492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318495">}</span><br>
<span class="lineno"></span><span class="op" id="7318497">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7318500">func</span>&nbsp;<span class="ident" id="7318505">fromBase64</span><span class="op" id="7318515">(</span><span class="ident" id="7318516">in</span>&nbsp;<span class="builtintype" id="7318519">string</span><span class="op" id="7318525">)</span>&nbsp;<span class="op" id="7318527">[</span><span class="op" id="7318528">]</span><span class="builtintype" id="7318529">byte</span>&nbsp;<span class="op" id="7318534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318537">out</span>&nbsp;<span class="op" id="7318541">:=</span>&nbsp;<span class="builtinfunc" id="7318544">make</span><span class="op" id="7318548">(</span><span class="op" id="7318549">[</span><span class="op" id="7318550">]</span><span class="builtintype" id="7318551">byte</span><span class="op" id="7318555">,</span>&nbsp;<span class="ident" id="7318557">base64</span><span class="op" id="7318563">.</span><span class="ident" id="7318564">StdEncoding</span><span class="op" id="7318575">.</span><span class="ident" id="7318576">DecodedLen</span><span class="op" id="7318586">(</span><span class="builtinfunc" id="7318587">len</span><span class="op" id="7318590">(</span><span class="ident" id="7318591">in</span><span class="op" id="7318593">)</span><span class="op" id="7318594">)</span><span class="op" id="7318595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318598">n</span><span class="op" id="7318599">,</span>&nbsp;<span class="ident" id="7318601">err</span>&nbsp;<span class="op" id="7318605">:=</span>&nbsp;<span class="ident" id="7318608">base64</span><span class="op" id="7318614">.</span><span class="ident" id="7318615">StdEncoding</span><span class="op" id="7318626">.</span><span class="ident" id="7318627">Decode</span><span class="op" id="7318633">(</span><span class="ident" id="7318634">out</span><span class="op" id="7318637">,</span>&nbsp;<span class="op" id="7318639">[</span><span class="op" id="7318640">]</span><span class="builtintype" id="7318641">byte</span><span class="op" id="7318645">(</span><span class="ident" id="7318646">in</span><span class="op" id="7318648">)</span><span class="op" id="7318649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318652">if</span>&nbsp;<span class="ident" id="7318655">err</span>&nbsp;<span class="op" id="7318659">!=</span>&nbsp;<span class="ident" id="7318662">nil</span>&nbsp;<span class="op" id="7318666">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7318670">panic</span><span class="op" id="7318675">(</span><span class="string" id="7318676">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="7318701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318707">return</span>&nbsp;<span class="ident" id="7318714">out</span><span class="op" id="7318717">[</span><span class="op" id="7318718">:</span><span class="ident" id="7318719">n</span><span class="op" id="7318720">]</span><br>
<span class="lineno"></span><span class="op" id="7318722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="7318725">func</span>&nbsp;<span class="ident" id="7318730">TestParseDERCRL</span><span class="op" id="7318745">(</span><span class="ident" id="7318746">t</span>&nbsp;<span class="op" id="7318748">*</span><span class="ident" id="7318749">testing</span><span class="op" id="7318756">.</span><span class="ident" id="7318757">T</span><span class="op" id="7318758">)</span>&nbsp;<span class="op" id="7318760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318763">derBytes</span>&nbsp;<span class="op" id="7318772">:=</span>&nbsp;<span class="ident" id="7318775">fromBase64</span><span class="op" id="7318785">(</span><span class="ident" id="7318786">derCRLBase64</span><span class="op" id="7318798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318801">certList</span><span class="op" id="7318809">,</span>&nbsp;<span class="ident" id="7318811">err</span>&nbsp;<span class="op" id="7318815">:=</span>&nbsp;<span class="ident" id="7318818">ParseDERCRL</span><span class="op" id="7318829">(</span><span class="ident" id="7318830">derBytes</span><span class="op" id="7318838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318841">if</span>&nbsp;<span class="ident" id="7318844">err</span>&nbsp;<span class="op" id="7318848">!=</span>&nbsp;<span class="ident" id="7318851">nil</span>&nbsp;<span class="op" id="7318855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318859">t</span><span class="op" id="7318860">.</span><span class="ident" id="7318861">Errorf</span><span class="op" id="7318867">(</span><span class="string" id="7318868">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7318887">,</span>&nbsp;<span class="ident" id="7318889">err</span><span class="op" id="7318892">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318896">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318907">numCerts</span>&nbsp;<span class="op" id="7318916">:=</span>&nbsp;<span class="builtinfunc" id="7318919">len</span><span class="op" id="7318922">(</span><span class="ident" id="7318923">certList</span><span class="op" id="7318931">.</span><span class="ident" id="7318932">TBSCertList</span><span class="op" id="7318943">.</span><span class="ident" id="7318944">RevokedCertificates</span><span class="op" id="7318963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318966">expected</span>&nbsp;<span class="op" id="7318975">:=</span>&nbsp;<span class="num" id="7318978">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318982">if</span>&nbsp;<span class="ident" id="7318985">numCerts</span>&nbsp;<span class="op" id="7318994">!=</span>&nbsp;<span class="ident" id="7318997">expected</span>&nbsp;<span class="op" id="7319006">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319010">t</span><span class="op" id="7319011">.</span><span class="ident" id="7319012">Errorf</span><span class="op" id="7319018">(</span><span class="string" id="7319019">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7319073">,</span>&nbsp;<span class="ident" id="7319075">numCerts</span><span class="op" id="7319083">,</span>&nbsp;<span class="ident" id="7319085">expected</span><span class="op" id="7319093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319100">if</span>&nbsp;<span class="ident" id="7319103">certList</span><span class="op" id="7319111">.</span><span class="ident" id="7319112">HasExpired</span><span class="op" id="7319122">(</span><span class="ident" id="7319123">time</span><span class="op" id="7319127">.</span><span class="ident" id="7319128">Unix</span><span class="op" id="7319132">(</span><span class="num" id="7319133">1302517272</span><span class="op" id="7319143">,</span>&nbsp;<span class="num" id="7319145">0</span><span class="op" id="7319146">)</span><span class="op" id="7319147">)</span>&nbsp;<span class="op" id="7319149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319153">t</span><span class="op" id="7319154">.</span><span class="ident" id="7319155">Errorf</span><span class="op" id="7319161">(</span><span class="string" id="7319162">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7319200">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7319207">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7319266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="7319269">func</span>&nbsp;<span class="ident" id="7319274">TestCRLWithoutExpiry</span><span class="op" id="7319294">(</span><span class="ident" id="7319295">t</span>&nbsp;<span class="op" id="7319297">*</span><span class="ident" id="7319298">testing</span><span class="op" id="7319305">.</span><span class="ident" id="7319306">T</span><span class="op" id="7319307">)</span>&nbsp;<span class="op" id="7319309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319312">derBytes</span>&nbsp;<span class="op" id="7319321">:=</span>&nbsp;<span class="ident" id="7319324">fromBase64</span><span class="op" id="7319334">(</span><span class="string" id="7319335">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="7319629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319632">certList</span><span class="op" id="7319640">,</span>&nbsp;<span class="ident" id="7319642">err</span>&nbsp;<span class="op" id="7319646">:=</span>&nbsp;<span class="ident" id="7319649">ParseDERCRL</span><span class="op" id="7319660">(</span><span class="ident" id="7319661">derBytes</span><span class="op" id="7319669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319672">if</span>&nbsp;<span class="ident" id="7319675">err</span>&nbsp;<span class="op" id="7319679">!=</span>&nbsp;<span class="ident" id="7319682">nil</span>&nbsp;<span class="op" id="7319686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319690">t</span><span class="op" id="7319691">.</span><span class="ident" id="7319692">Fatal</span><span class="op" id="7319697">(</span><span class="ident" id="7319698">err</span><span class="op" id="7319701">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319707">if</span>&nbsp;<span class="op" id="7319710">!</span><span class="ident" id="7319711">certList</span><span class="op" id="7319719">.</span><span class="ident" id="7319720">TBSCertList</span><span class="op" id="7319731">.</span><span class="ident" id="7319732">NextUpdate</span><span class="op" id="7319742">.</span><span class="ident" id="7319743">IsZero</span><span class="op" id="7319749">(</span><span class="op" id="7319750">)</span>&nbsp;<span class="op" id="7319752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319756">t</span><span class="op" id="7319757">.</span><span class="ident" id="7319758">Errorf</span><span class="op" id="7319764">(</span><span class="string" id="7319765">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="7319799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319802">}</span><br>
<span class="lineno"></span><span class="op" id="7319804">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="7319807">func</span>&nbsp;<span class="ident" id="7319812">TestParsePEMCRL</span><span class="op" id="7319827">(</span><span class="ident" id="7319828">t</span>&nbsp;<span class="op" id="7319830">*</span><span class="ident" id="7319831">testing</span><span class="op" id="7319838">.</span><span class="ident" id="7319839">T</span><span class="op" id="7319840">)</span>&nbsp;<span class="op" id="7319842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319845">pemBytes</span>&nbsp;<span class="op" id="7319854">:=</span>&nbsp;<span class="ident" id="7319857">fromBase64</span><span class="op" id="7319867">(</span><span class="ident" id="7319868">pemCRLBase64</span><span class="op" id="7319880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319883">certList</span><span class="op" id="7319891">,</span>&nbsp;<span class="ident" id="7319893">err</span>&nbsp;<span class="op" id="7319897">:=</span>&nbsp;<span class="ident" id="7319900">ParseCRL</span><span class="op" id="7319908">(</span><span class="ident" id="7319909">pemBytes</span><span class="op" id="7319917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319920">if</span>&nbsp;<span class="ident" id="7319923">err</span>&nbsp;<span class="op" id="7319927">!=</span>&nbsp;<span class="ident" id="7319930">nil</span>&nbsp;<span class="op" id="7319934">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319938">t</span><span class="op" id="7319939">.</span><span class="ident" id="7319940">Errorf</span><span class="op" id="7319946">(</span><span class="string" id="7319947">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7319966">,</span>&nbsp;<span class="ident" id="7319968">err</span><span class="op" id="7319971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319975">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319986">numCerts</span>&nbsp;<span class="op" id="7319995">:=</span>&nbsp;<span class="builtinfunc" id="7319998">len</span><span class="op" id="7320001">(</span><span class="ident" id="7320002">certList</span><span class="op" id="7320010">.</span><span class="ident" id="7320011">TBSCertList</span><span class="op" id="7320022">.</span><span class="ident" id="7320023">RevokedCertificates</span><span class="op" id="7320042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320045">expected</span>&nbsp;<span class="op" id="7320054">:=</span>&nbsp;<span class="num" id="7320057">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320060">if</span>&nbsp;<span class="ident" id="7320063">numCerts</span>&nbsp;<span class="op" id="7320072">!=</span>&nbsp;<span class="ident" id="7320075">expected</span>&nbsp;<span class="op" id="7320084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320088">t</span><span class="op" id="7320089">.</span><span class="ident" id="7320090">Errorf</span><span class="op" id="7320096">(</span><span class="string" id="7320097">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7320151">,</span>&nbsp;<span class="ident" id="7320153">numCerts</span><span class="op" id="7320161">,</span>&nbsp;<span class="ident" id="7320163">expected</span><span class="op" id="7320171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320178">if</span>&nbsp;<span class="ident" id="7320181">certList</span><span class="op" id="7320189">.</span><span class="ident" id="7320190">HasExpired</span><span class="op" id="7320200">(</span><span class="ident" id="7320201">time</span><span class="op" id="7320205">.</span><span class="ident" id="7320206">Unix</span><span class="op" id="7320210">(</span><span class="num" id="7320211">1302517272</span><span class="op" id="7320221">,</span>&nbsp;<span class="num" id="7320223">0</span><span class="op" id="7320224">)</span><span class="op" id="7320225">)</span>&nbsp;<span class="op" id="7320227">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320231">t</span><span class="op" id="7320232">.</span><span class="ident" id="7320233">Errorf</span><span class="op" id="7320239">(</span><span class="string" id="7320240">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7320278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7320285">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7320344">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="7320347">func</span>&nbsp;<span class="ident" id="7320352">TestImports</span><span class="op" id="7320363">(</span><span class="ident" id="7320364">t</span>&nbsp;<span class="op" id="7320366">*</span><span class="ident" id="7320367">testing</span><span class="op" id="7320374">.</span><span class="ident" id="7320375">T</span><span class="op" id="7320376">)</span>&nbsp;<span class="op" id="7320378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320381">switch</span>&nbsp;<span class="ident" id="7320388">runtime</span><span class="op" id="7320395">.</span><span class="ident" id="7320396">GOOS</span>&nbsp;<span class="op" id="7320401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320404">case</span>&nbsp;<span class="string" id="7320409">&#34;android&#34;</span><span class="op" id="7320418">,</span>&nbsp;<span class="string" id="7320420">&#34;nacl&#34;</span><span class="op" id="7320426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320430">t</span><span class="op" id="7320431">.</span><span class="ident" id="7320432">Skipf</span><span class="op" id="7320437">(</span><span class="string" id="7320438">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="7320454">,</span>&nbsp;<span class="ident" id="7320456">runtime</span><span class="op" id="7320463">.</span><span class="ident" id="7320464">GOOS</span><span class="op" id="7320468">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320475">if</span>&nbsp;<span class="ident" id="7320478">err</span>&nbsp;<span class="op" id="7320482">:=</span>&nbsp;<span class="ident" id="7320485">exec</span><span class="op" id="7320489">.</span><span class="ident" id="7320490">Command</span><span class="op" id="7320497">(</span><span class="string" id="7320498">&#34;go&#34;</span><span class="op" id="7320502">,</span>&nbsp;<span class="string" id="7320504">&#34;run&#34;</span><span class="op" id="7320509">,</span>&nbsp;<span class="string" id="7320511">&#34;x509_test_import.go&#34;</span><span class="op" id="7320532">)</span><span class="op" id="7320533">.</span><span class="ident" id="7320534">Run</span><span class="op" id="7320537">(</span><span class="op" id="7320538">)</span><span class="op" id="7320539">;</span>&nbsp;<span class="ident" id="7320541">err</span>&nbsp;<span class="op" id="7320545">!=</span>&nbsp;<span class="ident" id="7320548">nil</span>&nbsp;<span class="op" id="7320552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320556">t</span><span class="op" id="7320557">.</span><span class="ident" id="7320558">Errorf</span><span class="op" id="7320564">(</span><span class="string" id="7320565">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="7320604">,</span>&nbsp;<span class="ident" id="7320606">err</span><span class="op" id="7320609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320612">}</span><br>
<span class="lineno">750</span><span class="op" id="7320614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7320617">const</span>&nbsp;<span class="ident" id="7320623">derCRLBase64</span>&nbsp;<span class="op" id="7320636">=</span>&nbsp;<span class="string" id="7320638">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7325314">const</span>&nbsp;<span class="ident" id="7325320">pemCRLBase64</span>&nbsp;<span class="op" id="7325333">=</span>&nbsp;<span class="string" id="7325335">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="7326339">func</span>&nbsp;<span class="ident" id="7326344">TestCreateCertificateRequest</span><span class="op" id="7326372">(</span><span class="ident" id="7326373">t</span>&nbsp;<span class="op" id="7326375">*</span><span class="ident" id="7326376">testing</span><span class="op" id="7326383">.</span><span class="ident" id="7326384">T</span><span class="op" id="7326385">)</span>&nbsp;<span class="op" id="7326387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7326390">random</span>&nbsp;<span class="op" id="7326397">:=</span>&nbsp;<span class="ident" id="7326400">rand</span><span class="op" id="7326404">.</span><span class="ident" id="7326405">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7326414">block</span><span class="op" id="7326419">,</span>&nbsp;<span class="ident" id="7326421">_</span>&nbsp;<span class="op" id="7326423">:=</span>&nbsp;<span class="ident" id="7326426">pem</span><span class="op" id="7326429">.</span><span class="ident" id="7326430">Decode</span><span class="op" id="7326436">(</span><span class="op" id="7326437">[</span><span class="op" id="7326438">]</span><span class="builtintype" id="7326439">byte</span><span class="op" id="7326443">(</span><span class="ident" id="7326444">pemPrivateKey</span><span class="op" id="7326457">)</span><span class="op" id="7326458">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7326461">rsaPriv</span><span class="op" id="7326468">,</span>&nbsp;<span class="ident" id="7326470">err</span>&nbsp;<span class="op" id="7326474">:=</span>&nbsp;<span class="ident" id="7326477">ParsePKCS1PrivateKey</span><span class="op" id="7326497">(</span><span class="ident" id="7326498">block</span><span class="op" id="7326503">.</span><span class="ident" id="7326504">Bytes</span><span class="op" id="7326509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7326512">if</span>&nbsp;<span class="ident" id="7326515">err</span>&nbsp;<span class="op" id="7326519">!=</span>&nbsp;<span class="ident" id="7326522">nil</span>&nbsp;<span class="op" id="7326526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7326530">t</span><span class="op" id="7326531">.</span><span class="ident" id="7326532">Fatalf</span><span class="op" id="7326538">(</span><span class="string" id="7326539">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7326572">,</span>&nbsp;<span class="ident" id="7326574">err</span><span class="op" id="7326577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7326580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7326584">ecdsa256Priv</span><span class="op" id="7326596">,</span>&nbsp;<span class="ident" id="7326598">err</span>&nbsp;<span class="op" id="7326602">:=</span>&nbsp;<span class="ident" id="7326605">ecdsa</span><span class="op" id="7326610">.</span><span class="ident" id="7326611">GenerateKey</span><span class="op" id="7326622">(</span><span class="ident" id="7326623">elliptic</span><span class="op" id="7326631">.</span><span class="ident" id="7326632">P256</span><span class="op" id="7326636">(</span><span class="op" id="7326637">)</span><span class="op" id="7326638">,</span>&nbsp;<span class="ident" id="7326640">rand</span><span class="op" id="7326644">.</span><span class="ident" id="7326645">Reader</span><span class="op" id="7326651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7326654">if</span>&nbsp;<span class="ident" id="7326657">err</span>&nbsp;<span class="op" id="7326661">!=</span>&nbsp;<span class="ident" id="7326664">nil</span>&nbsp;<span class="op" id="7326668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7326672">t</span><span class="op" id="7326673">.</span><span class="ident" id="7326674">Fatalf</span><span class="op" id="7326680">(</span><span class="string" id="7326681">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7326715">,</span>&nbsp;<span class="ident" id="7326717">err</span><span class="op" id="7326720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7326723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7326727">ecdsa384Priv</span><span class="op" id="7326739">,</span>&nbsp;<span class="ident" id="7326741">err</span>&nbsp;<span class="op" id="7326745">:=</span>&nbsp;<span class="ident" id="7326748">ecdsa</span><span class="op" id="7326753">.</span><span class="ident" id="7326754">GenerateKey</span><span class="op" id="7326765">(</span><span class="ident" id="7326766">elliptic</span><span class="op" id="7326774">.</span><span class="ident" id="7326775">P384</span><span class="op" id="7326779">(</span><span class="op" id="7326780">)</span><span class="op" id="7326781">,</span>&nbsp;<span class="ident" id="7326783">rand</span><span class="op" id="7326787">.</span><span class="ident" id="7326788">Reader</span><span class="op" id="7326794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7326797">if</span>&nbsp;<span class="ident" id="7326800">err</span>&nbsp;<span class="op" id="7326804">!=</span>&nbsp;<span class="ident" id="7326807">nil</span>&nbsp;<span class="op" id="7326811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7326815">t</span><span class="op" id="7326816">.</span><span class="ident" id="7326817">Fatalf</span><span class="op" id="7326823">(</span><span class="string" id="7326824">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7326858">,</span>&nbsp;<span class="ident" id="7326860">err</span><span class="op" id="7326863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7326866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7326870">ecdsa521Priv</span><span class="op" id="7326882">,</span>&nbsp;<span class="ident" id="7326884">err</span>&nbsp;<span class="op" id="7326888">:=</span>&nbsp;<span class="ident" id="7326891">ecdsa</span><span class="op" id="7326896">.</span><span class="ident" id="7326897">GenerateKey</span><span class="op" id="7326908">(</span><span class="ident" id="7326909">elliptic</span><span class="op" id="7326917">.</span><span class="ident" id="7326918">P521</span><span class="op" id="7326922">(</span><span class="op" id="7326923">)</span><span class="op" id="7326924">,</span>&nbsp;<span class="ident" id="7326926">rand</span><span class="op" id="7326930">.</span><span class="ident" id="7326931">Reader</span><span class="op" id="7326937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7326940">if</span>&nbsp;<span class="ident" id="7326943">err</span>&nbsp;<span class="op" id="7326947">!=</span>&nbsp;<span class="ident" id="7326950">nil</span>&nbsp;<span class="op" id="7326954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7326958">t</span><span class="op" id="7326959">.</span><span class="ident" id="7326960">Fatalf</span><span class="op" id="7326966">(</span><span class="string" id="7326967">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7327001">,</span>&nbsp;<span class="ident" id="7327003">err</span><span class="op" id="7327006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7327009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327013">tests</span>&nbsp;<span class="op" id="7327019">:=</span>&nbsp;<span class="op" id="7327022">[</span><span class="op" id="7327023">]</span><span class="keyword" id="7327024">struct</span>&nbsp;<span class="op" id="7327031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327035">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7327043">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327052">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7327060">interface</span><span class="op" id="7327069">{</span><span class="op" id="7327070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327074">sigAlgo</span>&nbsp;<span class="ident" id="7327082">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7327102">}</span><span class="op" id="7327103">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7327107">{</span><span class="string" id="7327108">&#34;RSA&#34;</span><span class="op" id="7327113">,</span>&nbsp;<span class="ident" id="7327115">rsaPriv</span><span class="op" id="7327122">,</span>&nbsp;<span class="ident" id="7327124">SHA1WithRSA</span><span class="op" id="7327135">}</span><span class="op" id="7327136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7327140">{</span><span class="string" id="7327141">&#34;ECDSA-256&#34;</span><span class="op" id="7327152">,</span>&nbsp;<span class="ident" id="7327154">ecdsa256Priv</span><span class="op" id="7327166">,</span>&nbsp;<span class="ident" id="7327168">ECDSAWithSHA1</span><span class="op" id="7327181">}</span><span class="op" id="7327182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7327186">{</span><span class="string" id="7327187">&#34;ECDSA-384&#34;</span><span class="op" id="7327198">,</span>&nbsp;<span class="ident" id="7327200">ecdsa384Priv</span><span class="op" id="7327212">,</span>&nbsp;<span class="ident" id="7327214">ECDSAWithSHA1</span><span class="op" id="7327227">}</span><span class="op" id="7327228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7327232">{</span><span class="string" id="7327233">&#34;ECDSA-521&#34;</span><span class="op" id="7327244">,</span>&nbsp;<span class="ident" id="7327246">ecdsa521Priv</span><span class="op" id="7327258">,</span>&nbsp;<span class="ident" id="7327260">ECDSAWithSHA1</span><span class="op" id="7327273">}</span><span class="op" id="7327274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7327277">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7327281">for</span>&nbsp;<span class="ident" id="7327285">_</span><span class="op" id="7327286">,</span>&nbsp;<span class="ident" id="7327288">test</span>&nbsp;<span class="op" id="7327293">:=</span>&nbsp;<span class="keyword" id="7327296">range</span>&nbsp;<span class="ident" id="7327302">tests</span>&nbsp;<span class="op" id="7327308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327312">template</span>&nbsp;<span class="op" id="7327321">:=</span>&nbsp;<span class="ident" id="7327324">CertificateRequest</span><span class="op" id="7327342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327347">Subject</span><span class="op" id="7327354">:</span>&nbsp;<span class="ident" id="7327356">pkix</span><span class="op" id="7327360">.</span><span class="ident" id="7327361">Name</span><span class="op" id="7327365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327371">CommonName</span><span class="op" id="7327381">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7327385">&#34;test.example.com&#34;</span><span class="op" id="7327403">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327409">Organization</span><span class="op" id="7327421">:</span>&nbsp;<span class="op" id="7327423">[</span><span class="op" id="7327424">]</span><span class="builtintype" id="7327425">string</span><span class="op" id="7327431">{</span><span class="string" id="7327432">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7327444">}</span><span class="op" id="7327445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7327450">}</span><span class="op" id="7327451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327456">SignatureAlgorithm</span><span class="op" id="7327474">:</span>&nbsp;<span class="ident" id="7327476">test</span><span class="op" id="7327480">.</span><span class="ident" id="7327481">sigAlgo</span><span class="op" id="7327488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327493">DNSNames</span><span class="op" id="7327501">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7327513">[</span><span class="op" id="7327514">]</span><span class="builtintype" id="7327515">string</span><span class="op" id="7327521">{</span><span class="string" id="7327522">&#34;test.example.com&#34;</span><span class="op" id="7327540">}</span><span class="op" id="7327541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327546">EmailAddresses</span><span class="op" id="7327560">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7327566">[</span><span class="op" id="7327567">]</span><span class="builtintype" id="7327568">string</span><span class="op" id="7327574">{</span><span class="string" id="7327575">&#34;gopher@golang.org&#34;</span><span class="op" id="7327594">}</span><span class="op" id="7327595">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327600">IPAddresses</span><span class="op" id="7327611">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7327620">[</span><span class="op" id="7327621">]</span><span class="ident" id="7327622">net</span><span class="op" id="7327625">.</span><span class="ident" id="7327626">IP</span><span class="op" id="7327628">{</span><span class="ident" id="7327629">net</span><span class="op" id="7327632">.</span><span class="ident" id="7327633">IPv4</span><span class="op" id="7327637">(</span><span class="num" id="7327638">127</span><span class="op" id="7327641">,</span>&nbsp;<span class="num" id="7327643">0</span><span class="op" id="7327644">,</span>&nbsp;<span class="num" id="7327646">0</span><span class="op" id="7327647">,</span>&nbsp;<span class="num" id="7327649">1</span><span class="op" id="7327650">)</span><span class="op" id="7327651">.</span><span class="ident" id="7327652">To4</span><span class="op" id="7327655">(</span><span class="op" id="7327656">)</span><span class="op" id="7327657">,</span>&nbsp;<span class="ident" id="7327659">net</span><span class="op" id="7327662">.</span><span class="ident" id="7327663">ParseIP</span><span class="op" id="7327670">(</span><span class="string" id="7327671">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7327693">)</span><span class="op" id="7327694">}</span><span class="op" id="7327695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7327699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327704">derBytes</span><span class="op" id="7327712">,</span>&nbsp;<span class="ident" id="7327714">err</span>&nbsp;<span class="op" id="7327718">:=</span>&nbsp;<span class="ident" id="7327721">CreateCertificateRequest</span><span class="op" id="7327745">(</span><span class="ident" id="7327746">random</span><span class="op" id="7327752">,</span>&nbsp;<span class="op" id="7327754">&amp;</span><span class="ident" id="7327755">template</span><span class="op" id="7327763">,</span>&nbsp;<span class="ident" id="7327765">test</span><span class="op" id="7327769">.</span><span class="ident" id="7327770">priv</span><span class="op" id="7327774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7327778">if</span>&nbsp;<span class="ident" id="7327781">err</span>&nbsp;<span class="op" id="7327785">!=</span>&nbsp;<span class="ident" id="7327788">nil</span>&nbsp;<span class="op" id="7327792">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327797">t</span><span class="op" id="7327798">.</span><span class="ident" id="7327799">Errorf</span><span class="op" id="7327805">(</span><span class="string" id="7327806">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7327852">,</span>&nbsp;<span class="ident" id="7327854">test</span><span class="op" id="7327858">.</span><span class="ident" id="7327859">name</span><span class="op" id="7327863">,</span>&nbsp;<span class="ident" id="7327865">err</span><span class="op" id="7327868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7327873">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7327884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327889">out</span><span class="op" id="7327892">,</span>&nbsp;<span class="ident" id="7327894">err</span>&nbsp;<span class="op" id="7327898">:=</span>&nbsp;<span class="ident" id="7327901">ParseCertificateRequest</span><span class="op" id="7327924">(</span><span class="ident" id="7327925">derBytes</span><span class="op" id="7327933">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7327937">if</span>&nbsp;<span class="ident" id="7327940">err</span>&nbsp;<span class="op" id="7327944">!=</span>&nbsp;<span class="ident" id="7327947">nil</span>&nbsp;<span class="op" id="7327951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7327956">t</span><span class="op" id="7327957">.</span><span class="ident" id="7327958">Errorf</span><span class="op" id="7327964">(</span><span class="string" id="7327965">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7328011">,</span>&nbsp;<span class="ident" id="7328013">test</span><span class="op" id="7328017">.</span><span class="ident" id="7328018">name</span><span class="op" id="7328022">,</span>&nbsp;<span class="ident" id="7328024">err</span><span class="op" id="7328027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7328032">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7328043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7328048">if</span>&nbsp;<span class="ident" id="7328051">out</span><span class="op" id="7328054">.</span><span class="ident" id="7328055">Subject</span><span class="op" id="7328062">.</span><span class="ident" id="7328063">CommonName</span>&nbsp;<span class="op" id="7328074">!=</span>&nbsp;<span class="ident" id="7328077">template</span><span class="op" id="7328085">.</span><span class="ident" id="7328086">Subject</span><span class="op" id="7328093">.</span><span class="ident" id="7328094">CommonName</span>&nbsp;<span class="op" id="7328105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7328110">t</span><span class="op" id="7328111">.</span><span class="ident" id="7328112">Errorf</span><span class="op" id="7328118">(</span><span class="string" id="7328119">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7328196">,</span>&nbsp;<span class="ident" id="7328198">test</span><span class="op" id="7328202">.</span><span class="ident" id="7328203">name</span><span class="op" id="7328207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7328211">}</span>&nbsp;<span class="keyword" id="7328213">else</span>&nbsp;<span class="keyword" id="7328218">if</span>&nbsp;<span class="builtinfunc" id="7328221">len</span><span class="op" id="7328224">(</span><span class="ident" id="7328225">out</span><span class="op" id="7328228">.</span><span class="ident" id="7328229">Subject</span><span class="op" id="7328236">.</span><span class="ident" id="7328237">Organization</span><span class="op" id="7328249">)</span>&nbsp;<span class="op" id="7328251">!=</span>&nbsp;<span class="builtinfunc" id="7328254">len</span><span class="op" id="7328257">(</span><span class="ident" id="7328258">template</span><span class="op" id="7328266">.</span><span class="ident" id="7328267">Subject</span><span class="op" id="7328274">.</span><span class="ident" id="7328275">Organization</span><span class="op" id="7328287">)</span>&nbsp;<span class="op" id="7328289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7328294">t</span><span class="op" id="7328295">.</span><span class="ident" id="7328296">Errorf</span><span class="op" id="7328302">(</span><span class="string" id="7328303">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7328382">,</span>&nbsp;<span class="ident" id="7328384">test</span><span class="op" id="7328388">.</span><span class="ident" id="7328389">name</span><span class="op" id="7328393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7328397">}</span>&nbsp;<span class="keyword" id="7328399">else</span>&nbsp;<span class="keyword" id="7328404">if</span>&nbsp;<span class="builtinfunc" id="7328407">len</span><span class="op" id="7328410">(</span><span class="ident" id="7328411">out</span><span class="op" id="7328414">.</span><span class="ident" id="7328415">DNSNames</span><span class="op" id="7328423">)</span>&nbsp;<span class="op" id="7328425">!=</span>&nbsp;<span class="builtinfunc" id="7328428">len</span><span class="op" id="7328431">(</span><span class="ident" id="7328432">template</span><span class="op" id="7328440">.</span><span class="ident" id="7328441">DNSNames</span><span class="op" id="7328449">)</span>&nbsp;<span class="op" id="7328451">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7328456">t</span><span class="op" id="7328457">.</span><span class="ident" id="7328458">Errorf</span><span class="op" id="7328464">(</span><span class="string" id="7328465">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7328522">,</span>&nbsp;<span class="ident" id="7328524">test</span><span class="op" id="7328528">.</span><span class="ident" id="7328529">name</span><span class="op" id="7328533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7328537">}</span>&nbsp;<span class="keyword" id="7328539">else</span>&nbsp;<span class="keyword" id="7328544">if</span>&nbsp;<span class="builtinfunc" id="7328547">len</span><span class="op" id="7328550">(</span><span class="ident" id="7328551">out</span><span class="op" id="7328554">.</span><span class="ident" id="7328555">EmailAddresses</span><span class="op" id="7328569">)</span>&nbsp;<span class="op" id="7328571">!=</span>&nbsp;<span class="builtinfunc" id="7328574">len</span><span class="op" id="7328577">(</span><span class="ident" id="7328578">template</span><span class="op" id="7328586">.</span><span class="ident" id="7328587">EmailAddresses</span><span class="op" id="7328601">)</span>&nbsp;<span class="op" id="7328603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7328608">t</span><span class="op" id="7328609">.</span><span class="ident" id="7328610">Errorf</span><span class="op" id="7328616">(</span><span class="string" id="7328617">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7328686">,</span>&nbsp;<span class="ident" id="7328688">test</span><span class="op" id="7328692">.</span><span class="ident" id="7328693">name</span><span class="op" id="7328697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7328701">}</span>&nbsp;<span class="keyword" id="7328703">else</span>&nbsp;<span class="keyword" id="7328708">if</span>&nbsp;<span class="builtinfunc" id="7328711">len</span><span class="op" id="7328714">(</span><span class="ident" id="7328715">out</span><span class="op" id="7328718">.</span><span class="ident" id="7328719">IPAddresses</span><span class="op" id="7328730">)</span>&nbsp;<span class="op" id="7328732">!=</span>&nbsp;<span class="builtinfunc" id="7328735">len</span><span class="op" id="7328738">(</span><span class="ident" id="7328739">template</span><span class="op" id="7328747">.</span><span class="ident" id="7328748">IPAddresses</span><span class="op" id="7328759">)</span>&nbsp;<span class="op" id="7328761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7328766">t</span><span class="op" id="7328767">.</span><span class="ident" id="7328768">Errorf</span><span class="op" id="7328774">(</span><span class="string" id="7328775">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7328844">,</span>&nbsp;<span class="ident" id="7328846">test</span><span class="op" id="7328850">.</span><span class="ident" id="7328851">name</span><span class="op" id="7328855">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7328859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7328862">}</span><br>
<span class="lineno"></span><span class="op" id="7328864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7328867">func</span>&nbsp;<span class="ident" id="7328872">marshalAndParseCSR</span><span class="op" id="7328890">(</span><span class="ident" id="7328891">t</span>&nbsp;<span class="op" id="7328893">*</span><span class="ident" id="7328894">testing</span><span class="op" id="7328901">.</span><span class="ident" id="7328902">T</span><span class="op" id="7328903">,</span>&nbsp;<span class="ident" id="7328905">template</span>&nbsp;<span class="op" id="7328914">*</span><span class="ident" id="7328915">CertificateRequest</span><span class="op" id="7328933">)</span>&nbsp;<span class="op" id="7328935">*</span><span class="ident" id="7328936">CertificateRequest</span>&nbsp;<span class="op" id="7328955">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7328958">block</span><span class="op" id="7328963">,</span>&nbsp;<span class="ident" id="7328965">_</span>&nbsp;<span class="op" id="7328967">:=</span>&nbsp;<span class="ident" id="7328970">pem</span><span class="op" id="7328973">.</span><span class="ident" id="7328974">Decode</span><span class="op" id="7328980">(</span><span class="op" id="7328981">[</span><span class="op" id="7328982">]</span><span class="builtintype" id="7328983">byte</span><span class="op" id="7328987">(</span><span class="ident" id="7328988">pemPrivateKey</span><span class="op" id="7329001">)</span><span class="op" id="7329002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329005">rsaPriv</span><span class="op" id="7329012">,</span>&nbsp;<span class="ident" id="7329014">err</span>&nbsp;<span class="op" id="7329018">:=</span>&nbsp;<span class="ident" id="7329021">ParsePKCS1PrivateKey</span><span class="op" id="7329041">(</span><span class="ident" id="7329042">block</span><span class="op" id="7329047">.</span><span class="ident" id="7329048">Bytes</span><span class="op" id="7329053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7329056">if</span>&nbsp;<span class="ident" id="7329059">err</span>&nbsp;<span class="op" id="7329063">!=</span>&nbsp;<span class="ident" id="7329066">nil</span>&nbsp;<span class="op" id="7329070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329074">t</span><span class="op" id="7329075">.</span><span class="ident" id="7329076">Fatal</span><span class="op" id="7329081">(</span><span class="ident" id="7329082">err</span><span class="op" id="7329085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329088">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329092">derBytes</span><span class="op" id="7329100">,</span>&nbsp;<span class="ident" id="7329102">err</span>&nbsp;<span class="op" id="7329106">:=</span>&nbsp;<span class="ident" id="7329109">CreateCertificateRequest</span><span class="op" id="7329133">(</span><span class="ident" id="7329134">rand</span><span class="op" id="7329138">.</span><span class="ident" id="7329139">Reader</span><span class="op" id="7329145">,</span>&nbsp;<span class="ident" id="7329147">template</span><span class="op" id="7329155">,</span>&nbsp;<span class="ident" id="7329157">rsaPriv</span><span class="op" id="7329164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7329167">if</span>&nbsp;<span class="ident" id="7329170">err</span>&nbsp;<span class="op" id="7329174">!=</span>&nbsp;<span class="ident" id="7329177">nil</span>&nbsp;<span class="op" id="7329181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329185">t</span><span class="op" id="7329186">.</span><span class="ident" id="7329187">Fatal</span><span class="op" id="7329192">(</span><span class="ident" id="7329193">err</span><span class="op" id="7329196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329199">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329203">csr</span><span class="op" id="7329206">,</span>&nbsp;<span class="ident" id="7329208">err</span>&nbsp;<span class="op" id="7329212">:=</span>&nbsp;<span class="ident" id="7329215">ParseCertificateRequest</span><span class="op" id="7329238">(</span><span class="ident" id="7329239">derBytes</span><span class="op" id="7329247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7329250">if</span>&nbsp;<span class="ident" id="7329253">err</span>&nbsp;<span class="op" id="7329257">!=</span>&nbsp;<span class="ident" id="7329260">nil</span>&nbsp;<span class="op" id="7329264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329268">t</span><span class="op" id="7329269">.</span><span class="ident" id="7329270">Fatal</span><span class="op" id="7329275">(</span><span class="ident" id="7329276">err</span><span class="op" id="7329279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329282">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7329286">return</span>&nbsp;<span class="ident" id="7329293">csr</span><br>
<span class="lineno"></span><span class="op" id="7329297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7329300">func</span>&nbsp;<span class="ident" id="7329305">TestCertificateRequestOverrides</span><span class="op" id="7329336">(</span><span class="ident" id="7329337">t</span>&nbsp;<span class="op" id="7329339">*</span><span class="ident" id="7329340">testing</span><span class="op" id="7329347">.</span><span class="ident" id="7329348">T</span><span class="op" id="7329349">)</span>&nbsp;<span class="op" id="7329351">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329354">sanContents</span><span class="op" id="7329365">,</span>&nbsp;<span class="ident" id="7329367">err</span>&nbsp;<span class="op" id="7329371">:=</span>&nbsp;<span class="ident" id="7329374">marshalSANs</span><span class="op" id="7329385">(</span><span class="op" id="7329386">[</span><span class="op" id="7329387">]</span><span class="builtintype" id="7329388">string</span><span class="op" id="7329394">{</span><span class="string" id="7329395">&#34;foo.example.com&#34;</span><span class="op" id="7329412">}</span><span class="op" id="7329413">,</span>&nbsp;<span class="ident" id="7329415">nil</span><span class="op" id="7329418">,</span>&nbsp;<span class="ident" id="7329420">nil</span><span class="op" id="7329423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7329426">if</span>&nbsp;<span class="ident" id="7329429">err</span>&nbsp;<span class="op" id="7329433">!=</span>&nbsp;<span class="ident" id="7329436">nil</span>&nbsp;<span class="op" id="7329440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329444">t</span><span class="op" id="7329445">.</span><span class="ident" id="7329446">Fatal</span><span class="op" id="7329451">(</span><span class="ident" id="7329452">err</span><span class="op" id="7329455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329462">template</span>&nbsp;<span class="op" id="7329471">:=</span>&nbsp;<span class="ident" id="7329474">CertificateRequest</span><span class="op" id="7329492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329496">Subject</span><span class="op" id="7329503">:</span>&nbsp;<span class="ident" id="7329505">pkix</span><span class="op" id="7329509">.</span><span class="ident" id="7329510">Name</span><span class="op" id="7329514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329519">CommonName</span><span class="op" id="7329529">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7329533">&#34;test.example.com&#34;</span><span class="op" id="7329551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329556">Organization</span><span class="op" id="7329568">:</span>&nbsp;<span class="op" id="7329570">[</span><span class="op" id="7329571">]</span><span class="builtintype" id="7329572">string</span><span class="op" id="7329578">{</span><span class="string" id="7329579">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7329591">}</span><span class="op" id="7329592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329596">}</span><span class="op" id="7329597">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329601">DNSNames</span><span class="op" id="7329609">:</span>&nbsp;<span class="op" id="7329611">[</span><span class="op" id="7329612">]</span><span class="builtintype" id="7329613">string</span><span class="op" id="7329619">{</span><span class="string" id="7329620">&#34;test.example.com&#34;</span><span class="op" id="7329638">}</span><span class="op" id="7329639">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7329644">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7329709">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329724">ExtraExtensions</span><span class="op" id="7329739">:</span>&nbsp;<span class="op" id="7329741">[</span><span class="op" id="7329742">]</span><span class="ident" id="7329743">pkix</span><span class="op" id="7329747">.</span><span class="ident" id="7329748">Extension</span><span class="op" id="7329757">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329768">Id</span><span class="op" id="7329770">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7329775">oidExtensionSubjectAltName</span><span class="op" id="7329801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329807">Value</span><span class="op" id="7329812">:</span>&nbsp;<span class="ident" id="7329814">sanContents</span><span class="op" id="7329825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329830">}</span><span class="op" id="7329831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329835">}</span><span class="op" id="7329836">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329843">csr</span>&nbsp;<span class="op" id="7329847">:=</span>&nbsp;<span class="ident" id="7329850">marshalAndParseCSR</span><span class="op" id="7329868">(</span><span class="ident" id="7329869">t</span><span class="op" id="7329870">,</span>&nbsp;<span class="op" id="7329872">&amp;</span><span class="ident" id="7329873">template</span><span class="op" id="7329881">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7329885">if</span>&nbsp;<span class="builtinfunc" id="7329888">len</span><span class="op" id="7329891">(</span><span class="ident" id="7329892">csr</span><span class="op" id="7329895">.</span><span class="ident" id="7329896">DNSNames</span><span class="op" id="7329904">)</span>&nbsp;<span class="op" id="7329906">!=</span>&nbsp;<span class="num" id="7329909">1</span>&nbsp;<span class="op" id="7329911">||</span>&nbsp;<span class="ident" id="7329914">csr</span><span class="op" id="7329917">.</span><span class="ident" id="7329918">DNSNames</span><span class="op" id="7329926">[</span><span class="num" id="7329927">0</span><span class="op" id="7329928">]</span>&nbsp;<span class="op" id="7329930">!=</span>&nbsp;<span class="string" id="7329933">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="7329951">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329955">t</span><span class="op" id="7329956">.</span><span class="ident" id="7329957">Errorf</span><span class="op" id="7329963">(</span><span class="string" id="7329964">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7330011">,</span>&nbsp;<span class="ident" id="7330013">csr</span><span class="op" id="7330016">.</span><span class="ident" id="7330017">DNSNames</span><span class="op" id="7330025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7330032">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7330100">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7330170">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330206">template</span><span class="op" id="7330214">.</span><span class="ident" id="7330215">Attributes</span>&nbsp;<span class="op" id="7330226">=</span>&nbsp;<span class="op" id="7330228">[</span><span class="op" id="7330229">]</span><span class="ident" id="7330230">pkix</span><span class="op" id="7330234">.</span><span class="ident" id="7330235">AttributeTypeAndValueSET</span><span class="op" id="7330259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330268">Type</span><span class="op" id="7330272">:</span>&nbsp;<span class="ident" id="7330274">oidExtensionRequest</span><span class="op" id="7330293">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330298">Value</span><span class="op" id="7330303">:</span>&nbsp;<span class="op" id="7330305">[</span><span class="op" id="7330306">]</span><span class="op" id="7330307">[</span><span class="op" id="7330308">]</span><span class="ident" id="7330309">pkix</span><span class="op" id="7330313">.</span><span class="ident" id="7330314">AttributeTypeAndValue</span><span class="op" id="7330335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330356">Type</span><span class="op" id="7330360">:</span>&nbsp;&nbsp;<span class="ident" id="7330363">oidExtensionAuthorityInfoAccess</span><span class="op" id="7330394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330402">Value</span><span class="op" id="7330407">:</span>&nbsp;<span class="op" id="7330409">[</span><span class="op" id="7330410">]</span><span class="builtintype" id="7330411">byte</span><span class="op" id="7330415">(</span><span class="string" id="7330416">&#34;foo&#34;</span><span class="op" id="7330421">)</span><span class="op" id="7330422">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330429">}</span><span class="op" id="7330430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330436">}</span><span class="op" id="7330437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330442">}</span><span class="op" id="7330443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330447">}</span><span class="op" id="7330448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330451">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330455">csr</span>&nbsp;<span class="op" id="7330459">=</span>&nbsp;<span class="ident" id="7330461">marshalAndParseCSR</span><span class="op" id="7330479">(</span><span class="ident" id="7330480">t</span><span class="op" id="7330481">,</span>&nbsp;<span class="op" id="7330483">&amp;</span><span class="ident" id="7330484">template</span><span class="op" id="7330492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330495">if</span>&nbsp;<span class="ident" id="7330498">l</span>&nbsp;<span class="op" id="7330500">:=</span>&nbsp;<span class="builtinfunc" id="7330503">len</span><span class="op" id="7330506">(</span><span class="ident" id="7330507">csr</span><span class="op" id="7330510">.</span><span class="ident" id="7330511">Attributes</span><span class="op" id="7330521">)</span><span class="op" id="7330522">;</span>&nbsp;<span class="ident" id="7330524">l</span>&nbsp;<span class="op" id="7330526">!=</span>&nbsp;<span class="num" id="7330529">1</span>&nbsp;<span class="op" id="7330531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330535">t</span><span class="op" id="7330536">.</span><span class="ident" id="7330537">Errorf</span><span class="op" id="7330543">(</span><span class="string" id="7330544">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="7330582">,</span>&nbsp;<span class="ident" id="7330584">l</span><span class="op" id="7330585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330588">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330592">if</span>&nbsp;<span class="op" id="7330595">!</span><span class="ident" id="7330596">csr</span><span class="op" id="7330599">.</span><span class="ident" id="7330600">Attributes</span><span class="op" id="7330610">[</span><span class="num" id="7330611">0</span><span class="op" id="7330612">]</span><span class="op" id="7330613">.</span><span class="ident" id="7330614">Type</span><span class="op" id="7330618">.</span><span class="ident" id="7330619">Equal</span><span class="op" id="7330624">(</span><span class="ident" id="7330625">oidExtensionRequest</span><span class="op" id="7330644">)</span>&nbsp;<span class="op" id="7330646">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7330651">len</span><span class="op" id="7330654">(</span><span class="ident" id="7330655">csr</span><span class="op" id="7330658">.</span><span class="ident" id="7330659">Attributes</span><span class="op" id="7330669">[</span><span class="num" id="7330670">0</span><span class="op" id="7330671">]</span><span class="op" id="7330672">.</span><span class="ident" id="7330673">Value</span><span class="op" id="7330678">)</span>&nbsp;<span class="op" id="7330680">!=</span>&nbsp;<span class="num" id="7330683">1</span>&nbsp;<span class="op" id="7330685">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7330690">len</span><span class="op" id="7330693">(</span><span class="ident" id="7330694">csr</span><span class="op" id="7330697">.</span><span class="ident" id="7330698">Attributes</span><span class="op" id="7330708">[</span><span class="num" id="7330709">0</span><span class="op" id="7330710">]</span><span class="op" id="7330711">.</span><span class="ident" id="7330712">Value</span><span class="op" id="7330717">[</span><span class="num" id="7330718">0</span><span class="op" id="7330719">]</span><span class="op" id="7330720">)</span>&nbsp;<span class="op" id="7330722">!=</span>&nbsp;<span class="num" id="7330725">2</span>&nbsp;<span class="op" id="7330727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330731">t</span><span class="op" id="7330732">.</span><span class="ident" id="7330733">Errorf</span><span class="op" id="7330739">(</span><span class="string" id="7330740">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="7330763">,</span>&nbsp;<span class="ident" id="7330765">csr</span><span class="op" id="7330768">.</span><span class="ident" id="7330769">Attributes</span><span class="op" id="7330779">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330786">sanContents2</span><span class="op" id="7330798">,</span>&nbsp;<span class="ident" id="7330800">err</span>&nbsp;<span class="op" id="7330804">:=</span>&nbsp;<span class="ident" id="7330807">marshalSANs</span><span class="op" id="7330818">(</span><span class="op" id="7330819">[</span><span class="op" id="7330820">]</span><span class="builtintype" id="7330821">string</span><span class="op" id="7330827">{</span><span class="string" id="7330828">&#34;foo2.example.com&#34;</span><span class="op" id="7330846">}</span><span class="op" id="7330847">,</span>&nbsp;<span class="ident" id="7330849">nil</span><span class="op" id="7330852">,</span>&nbsp;<span class="ident" id="7330854">nil</span><span class="op" id="7330857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330860">if</span>&nbsp;<span class="ident" id="7330863">err</span>&nbsp;<span class="op" id="7330867">!=</span>&nbsp;<span class="ident" id="7330870">nil</span>&nbsp;<span class="op" id="7330874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330878">t</span><span class="op" id="7330879">.</span><span class="ident" id="7330880">Fatal</span><span class="op" id="7330885">(</span><span class="ident" id="7330886">err</span><span class="op" id="7330889">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7330896">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330967">template</span><span class="op" id="7330975">.</span><span class="ident" id="7330976">Attributes</span><span class="op" id="7330986">[</span><span class="num" id="7330987">0</span><span class="op" id="7330988">]</span><span class="op" id="7330989">.</span><span class="ident" id="7330990">Value</span><span class="op" id="7330995">[</span><span class="num" id="7330996">0</span><span class="op" id="7330997">]</span>&nbsp;<span class="op" id="7330999">=</span>&nbsp;<span class="builtinfunc" id="7331001">append</span><span class="op" id="7331007">(</span><span class="ident" id="7331008">template</span><span class="op" id="7331016">.</span><span class="ident" id="7331017">Attributes</span><span class="op" id="7331027">[</span><span class="num" id="7331028">0</span><span class="op" id="7331029">]</span><span class="op" id="7331030">.</span><span class="ident" id="7331031">Value</span><span class="op" id="7331036">[</span><span class="num" id="7331037">0</span><span class="op" id="7331038">]</span><span class="op" id="7331039">,</span>&nbsp;<span class="ident" id="7331041">pkix</span><span class="op" id="7331045">.</span><span class="ident" id="7331046">AttributeTypeAndValue</span><span class="op" id="7331067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331071">Type</span><span class="op" id="7331075">:</span>&nbsp;&nbsp;<span class="ident" id="7331078">oidExtensionSubjectAltName</span><span class="op" id="7331104">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331108">Value</span><span class="op" id="7331113">:</span>&nbsp;<span class="ident" id="7331115">sanContents2</span><span class="op" id="7331127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331130">}</span><span class="op" id="7331131">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331135">csr</span>&nbsp;<span class="op" id="7331139">=</span>&nbsp;<span class="ident" id="7331141">marshalAndParseCSR</span><span class="op" id="7331159">(</span><span class="ident" id="7331160">t</span><span class="op" id="7331161">,</span>&nbsp;<span class="op" id="7331163">&amp;</span><span class="ident" id="7331164">template</span><span class="op" id="7331172">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331176">if</span>&nbsp;<span class="builtinfunc" id="7331179">len</span><span class="op" id="7331182">(</span><span class="ident" id="7331183">csr</span><span class="op" id="7331186">.</span><span class="ident" id="7331187">DNSNames</span><span class="op" id="7331195">)</span>&nbsp;<span class="op" id="7331197">!=</span>&nbsp;<span class="num" id="7331200">1</span>&nbsp;<span class="op" id="7331202">||</span>&nbsp;<span class="ident" id="7331205">csr</span><span class="op" id="7331208">.</span><span class="ident" id="7331209">DNSNames</span><span class="op" id="7331217">[</span><span class="num" id="7331218">0</span><span class="op" id="7331219">]</span>&nbsp;<span class="op" id="7331221">!=</span>&nbsp;<span class="string" id="7331224">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="7331243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331247">t</span><span class="op" id="7331248">.</span><span class="ident" id="7331249">Errorf</span><span class="op" id="7331255">(</span><span class="string" id="7331256">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7331311">,</span>&nbsp;<span class="ident" id="7331313">csr</span><span class="op" id="7331316">.</span><span class="ident" id="7331317">DNSNames</span><span class="op" id="7331325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331328">}</span><br>
<span class="lineno"></span><span class="op" id="7331330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="7331333">func</span>&nbsp;<span class="ident" id="7331338">TestParseCertificateRequest</span><span class="op" id="7331365">(</span><span class="ident" id="7331366">t</span>&nbsp;<span class="op" id="7331368">*</span><span class="ident" id="7331369">testing</span><span class="op" id="7331376">.</span><span class="ident" id="7331377">T</span><span class="op" id="7331378">)</span>&nbsp;<span class="op" id="7331380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331383">csrBytes</span>&nbsp;<span class="op" id="7331392">:=</span>&nbsp;<span class="ident" id="7331395">fromBase64</span><span class="op" id="7331405">(</span><span class="ident" id="7331406">csrBase64</span><span class="op" id="7331415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331418">csr</span><span class="op" id="7331421">,</span>&nbsp;<span class="ident" id="7331423">err</span>&nbsp;<span class="op" id="7331427">:=</span>&nbsp;<span class="ident" id="7331430">ParseCertificateRequest</span><span class="op" id="7331453">(</span><span class="ident" id="7331454">csrBytes</span><span class="op" id="7331462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331465">if</span>&nbsp;<span class="ident" id="7331468">err</span>&nbsp;<span class="op" id="7331472">!=</span>&nbsp;<span class="ident" id="7331475">nil</span>&nbsp;<span class="op" id="7331479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331483">t</span><span class="op" id="7331484">.</span><span class="ident" id="7331485">Fatalf</span><span class="op" id="7331491">(</span><span class="string" id="7331492">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="7331517">,</span>&nbsp;<span class="ident" id="7331519">err</span><span class="op" id="7331522">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331529">if</span>&nbsp;<span class="builtinfunc" id="7331532">len</span><span class="op" id="7331535">(</span><span class="ident" id="7331536">csr</span><span class="op" id="7331539">.</span><span class="ident" id="7331540">EmailAddresses</span><span class="op" id="7331554">)</span>&nbsp;<span class="op" id="7331556">!=</span>&nbsp;<span class="num" id="7331559">1</span>&nbsp;<span class="op" id="7331561">||</span>&nbsp;<span class="ident" id="7331564">csr</span><span class="op" id="7331567">.</span><span class="ident" id="7331568">EmailAddresses</span><span class="op" id="7331582">[</span><span class="num" id="7331583">0</span><span class="op" id="7331584">]</span>&nbsp;<span class="op" id="7331586">!=</span>&nbsp;<span class="string" id="7331589">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="7331609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331613">t</span><span class="op" id="7331614">.</span><span class="ident" id="7331615">Errorf</span><span class="op" id="7331621">(</span><span class="string" id="7331622">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7331659">,</span>&nbsp;<span class="ident" id="7331661">csr</span><span class="op" id="7331664">.</span><span class="ident" id="7331665">EmailAddresses</span><span class="op" id="7331679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331682">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331686">if</span>&nbsp;<span class="builtinfunc" id="7331689">len</span><span class="op" id="7331692">(</span><span class="ident" id="7331693">csr</span><span class="op" id="7331696">.</span><span class="ident" id="7331697">DNSNames</span><span class="op" id="7331705">)</span>&nbsp;<span class="op" id="7331707">!=</span>&nbsp;<span class="num" id="7331710">1</span>&nbsp;<span class="op" id="7331712">||</span>&nbsp;<span class="ident" id="7331715">csr</span><span class="op" id="7331718">.</span><span class="ident" id="7331719">DNSNames</span><span class="op" id="7331727">[</span><span class="num" id="7331728">0</span><span class="op" id="7331729">]</span>&nbsp;<span class="op" id="7331731">!=</span>&nbsp;<span class="string" id="7331734">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="7331753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331757">t</span><span class="op" id="7331758">.</span><span class="ident" id="7331759">Errorf</span><span class="op" id="7331765">(</span><span class="string" id="7331766">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7331797">,</span>&nbsp;<span class="ident" id="7331799">csr</span><span class="op" id="7331802">.</span><span class="ident" id="7331803">DNSNames</span><span class="op" id="7331811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331818">if</span>&nbsp;<span class="builtinfunc" id="7331821">len</span><span class="op" id="7331824">(</span><span class="ident" id="7331825">csr</span><span class="op" id="7331828">.</span><span class="ident" id="7331829">Subject</span><span class="op" id="7331836">.</span><span class="ident" id="7331837">Country</span><span class="op" id="7331844">)</span>&nbsp;<span class="op" id="7331846">!=</span>&nbsp;<span class="num" id="7331849">1</span>&nbsp;<span class="op" id="7331851">||</span>&nbsp;<span class="ident" id="7331854">csr</span><span class="op" id="7331857">.</span><span class="ident" id="7331858">Subject</span><span class="op" id="7331865">.</span><span class="ident" id="7331866">Country</span><span class="op" id="7331873">[</span><span class="num" id="7331874">0</span><span class="op" id="7331875">]</span>&nbsp;<span class="op" id="7331877">!=</span>&nbsp;<span class="string" id="7331880">&#34;AU&#34;</span>&nbsp;<span class="op" id="7331885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331889">t</span><span class="op" id="7331890">.</span><span class="ident" id="7331891">Errorf</span><span class="op" id="7331897">(</span><span class="string" id="7331898">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7331926">,</span>&nbsp;<span class="ident" id="7331928">csr</span><span class="op" id="7331931">.</span><span class="ident" id="7331932">Subject</span><span class="op" id="7331939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331946">found</span>&nbsp;<span class="op" id="7331952">:=</span>&nbsp;<span class="builtintype" id="7331955">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331962">for</span>&nbsp;<span class="ident" id="7331966">_</span><span class="op" id="7331967">,</span>&nbsp;<span class="ident" id="7331969">e</span>&nbsp;<span class="op" id="7331971">:=</span>&nbsp;<span class="keyword" id="7331974">range</span>&nbsp;<span class="ident" id="7331980">csr</span><span class="op" id="7331983">.</span><span class="ident" id="7331984">Extensions</span>&nbsp;<span class="op" id="7331995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331999">if</span>&nbsp;<span class="ident" id="7332002">e</span><span class="op" id="7332003">.</span><span class="ident" id="7332004">Id</span><span class="op" id="7332006">.</span><span class="ident" id="7332007">Equal</span><span class="op" id="7332012">(</span><span class="ident" id="7332013">oidExtensionBasicConstraints</span><span class="op" id="7332041">)</span>&nbsp;<span class="op" id="7332043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332048">found</span>&nbsp;<span class="op" id="7332054">=</span>&nbsp;<span class="builtintype" id="7332056">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332064">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332072">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332078">if</span>&nbsp;<span class="op" id="7332081">!</span><span class="ident" id="7332082">found</span>&nbsp;<span class="op" id="7332088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332092">t</span><span class="op" id="7332093">.</span><span class="ident" id="7332094">Errorf</span><span class="op" id="7332100">(</span><span class="string" id="7332101">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="7332147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332150">}</span><br>
<span class="lineno"></span><span class="op" id="7332152">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="7332155">func</span>&nbsp;<span class="ident" id="7332160">TestMaxPathLen</span><span class="op" id="7332174">(</span><span class="ident" id="7332175">t</span>&nbsp;<span class="op" id="7332177">*</span><span class="ident" id="7332178">testing</span><span class="op" id="7332185">.</span><span class="ident" id="7332186">T</span><span class="op" id="7332187">)</span>&nbsp;<span class="op" id="7332189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332192">block</span><span class="op" id="7332197">,</span>&nbsp;<span class="ident" id="7332199">_</span>&nbsp;<span class="op" id="7332201">:=</span>&nbsp;<span class="ident" id="7332204">pem</span><span class="op" id="7332207">.</span><span class="ident" id="7332208">Decode</span><span class="op" id="7332214">(</span><span class="op" id="7332215">[</span><span class="op" id="7332216">]</span><span class="builtintype" id="7332217">byte</span><span class="op" id="7332221">(</span><span class="ident" id="7332222">pemPrivateKey</span><span class="op" id="7332235">)</span><span class="op" id="7332236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332239">rsaPriv</span><span class="op" id="7332246">,</span>&nbsp;<span class="ident" id="7332248">err</span>&nbsp;<span class="op" id="7332252">:=</span>&nbsp;<span class="ident" id="7332255">ParsePKCS1PrivateKey</span><span class="op" id="7332275">(</span><span class="ident" id="7332276">block</span><span class="op" id="7332281">.</span><span class="ident" id="7332282">Bytes</span><span class="op" id="7332287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332290">if</span>&nbsp;<span class="ident" id="7332293">err</span>&nbsp;<span class="op" id="7332297">!=</span>&nbsp;<span class="ident" id="7332300">nil</span>&nbsp;<span class="op" id="7332304">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332308">t</span><span class="op" id="7332309">.</span><span class="ident" id="7332310">Fatalf</span><span class="op" id="7332316">(</span><span class="string" id="7332317">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7332350">,</span>&nbsp;<span class="ident" id="7332352">err</span><span class="op" id="7332355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332362">template</span>&nbsp;<span class="op" id="7332371">:=</span>&nbsp;<span class="op" id="7332374">&amp;</span><span class="ident" id="7332375">Certificate</span><span class="op" id="7332386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332390">SerialNumber</span><span class="op" id="7332402">:</span>&nbsp;<span class="ident" id="7332404">big</span><span class="op" id="7332407">.</span><span class="ident" id="7332408">NewInt</span><span class="op" id="7332414">(</span><span class="num" id="7332415">1</span><span class="op" id="7332416">)</span><span class="op" id="7332417">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332421">Subject</span><span class="op" id="7332428">:</span>&nbsp;<span class="ident" id="7332430">pkix</span><span class="op" id="7332434">.</span><span class="ident" id="7332435">Name</span><span class="op" id="7332439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332444">CommonName</span><span class="op" id="7332454">:</span>&nbsp;<span class="string" id="7332456">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7332468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332472">}</span><span class="op" id="7332473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332477">NotBefore</span><span class="op" id="7332486">:</span>&nbsp;<span class="ident" id="7332488">time</span><span class="op" id="7332492">.</span><span class="ident" id="7332493">Unix</span><span class="op" id="7332497">(</span><span class="num" id="7332498">1000</span><span class="op" id="7332502">,</span>&nbsp;<span class="num" id="7332504">0</span><span class="op" id="7332505">)</span><span class="op" id="7332506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332510">NotAfter</span><span class="op" id="7332518">:</span>&nbsp;&nbsp;<span class="ident" id="7332521">time</span><span class="op" id="7332525">.</span><span class="ident" id="7332526">Unix</span><span class="op" id="7332530">(</span><span class="num" id="7332531">100000</span><span class="op" id="7332537">,</span>&nbsp;<span class="num" id="7332539">0</span><span class="op" id="7332540">)</span><span class="op" id="7332541">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332546">BasicConstraintsValid</span><span class="op" id="7332567">:</span>&nbsp;<span class="builtintype" id="7332569">true</span><span class="op" id="7332573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332577">IsCA</span><span class="op" id="7332581">:</span>&nbsp;<span class="builtintype" id="7332583">true</span><span class="op" id="7332587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332594">serialiseAndParse</span>&nbsp;<span class="op" id="7332612">:=</span>&nbsp;<span class="keyword" id="7332615">func</span><span class="op" id="7332619">(</span><span class="ident" id="7332620">template</span>&nbsp;<span class="op" id="7332629">*</span><span class="ident" id="7332630">Certificate</span><span class="op" id="7332641">)</span>&nbsp;<span class="op" id="7332643">*</span><span class="ident" id="7332644">Certificate</span>&nbsp;<span class="op" id="7332656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332660">derBytes</span><span class="op" id="7332668">,</span>&nbsp;<span class="ident" id="7332670">err</span>&nbsp;<span class="op" id="7332674">:=</span>&nbsp;<span class="ident" id="7332677">CreateCertificate</span><span class="op" id="7332694">(</span><span class="ident" id="7332695">rand</span><span class="op" id="7332699">.</span><span class="ident" id="7332700">Reader</span><span class="op" id="7332706">,</span>&nbsp;<span class="ident" id="7332708">template</span><span class="op" id="7332716">,</span>&nbsp;<span class="ident" id="7332718">template</span><span class="op" id="7332726">,</span>&nbsp;<span class="op" id="7332728">&amp;</span><span class="ident" id="7332729">rsaPriv</span><span class="op" id="7332736">.</span><span class="ident" id="7332737">PublicKey</span><span class="op" id="7332746">,</span>&nbsp;<span class="ident" id="7332748">rsaPriv</span><span class="op" id="7332755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332759">if</span>&nbsp;<span class="ident" id="7332762">err</span>&nbsp;<span class="op" id="7332766">!=</span>&nbsp;<span class="ident" id="7332769">nil</span>&nbsp;<span class="op" id="7332773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332778">t</span><span class="op" id="7332779">.</span><span class="ident" id="7332780">Fatalf</span><span class="op" id="7332786">(</span><span class="string" id="7332787">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7332821">,</span>&nbsp;<span class="ident" id="7332823">err</span><span class="op" id="7332826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332831">return</span>&nbsp;<span class="ident" id="7332838">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332849">cert</span><span class="op" id="7332853">,</span>&nbsp;<span class="ident" id="7332855">err</span>&nbsp;<span class="op" id="7332859">:=</span>&nbsp;<span class="ident" id="7332862">ParseCertificate</span><span class="op" id="7332878">(</span><span class="ident" id="7332879">derBytes</span><span class="op" id="7332887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332891">if</span>&nbsp;<span class="ident" id="7332894">err</span>&nbsp;<span class="op" id="7332898">!=</span>&nbsp;<span class="ident" id="7332901">nil</span>&nbsp;<span class="op" id="7332905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332910">t</span><span class="op" id="7332911">.</span><span class="ident" id="7332912">Fatalf</span><span class="op" id="7332918">(</span><span class="string" id="7332919">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7332952">,</span>&nbsp;<span class="ident" id="7332954">err</span><span class="op" id="7332957">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332962">return</span>&nbsp;<span class="ident" id="7332969">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332980">return</span>&nbsp;<span class="ident" id="7332987">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332993">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332997">cert1</span>&nbsp;<span class="op" id="7333003">:=</span>&nbsp;<span class="ident" id="7333006">serialiseAndParse</span><span class="op" id="7333023">(</span><span class="ident" id="7333024">template</span><span class="op" id="7333032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333035">if</span>&nbsp;<span class="ident" id="7333038">m</span>&nbsp;<span class="op" id="7333040">:=</span>&nbsp;<span class="ident" id="7333043">cert1</span><span class="op" id="7333048">.</span><span class="ident" id="7333049">MaxPathLen</span><span class="op" id="7333059">;</span>&nbsp;<span class="ident" id="7333061">m</span>&nbsp;<span class="op" id="7333063">!=</span>&nbsp;<span class="op" id="7333066">-</span><span class="num" id="7333067">1</span>&nbsp;<span class="op" id="7333069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333073">t</span><span class="op" id="7333074">.</span><span class="ident" id="7333075">Errorf</span><span class="op" id="7333081">(</span><span class="string" id="7333082">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7333131">,</span>&nbsp;<span class="ident" id="7333133">m</span><span class="op" id="7333134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333137">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333140">if</span>&nbsp;<span class="ident" id="7333143">cert1</span><span class="op" id="7333148">.</span><span class="ident" id="7333149">MaxPathLenZero</span>&nbsp;<span class="op" id="7333164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333168">t</span><span class="op" id="7333169">.</span><span class="ident" id="7333170">Errorf</span><span class="op" id="7333176">(</span><span class="string" id="7333177">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7333225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333232">template</span><span class="op" id="7333240">.</span><span class="ident" id="7333241">MaxPathLen</span>&nbsp;<span class="op" id="7333252">=</span>&nbsp;<span class="num" id="7333254">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333257">cert2</span>&nbsp;<span class="op" id="7333263">:=</span>&nbsp;<span class="ident" id="7333266">serialiseAndParse</span><span class="op" id="7333283">(</span><span class="ident" id="7333284">template</span><span class="op" id="7333292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333295">if</span>&nbsp;<span class="ident" id="7333298">m</span>&nbsp;<span class="op" id="7333300">:=</span>&nbsp;<span class="ident" id="7333303">cert2</span><span class="op" id="7333308">.</span><span class="ident" id="7333309">MaxPathLen</span><span class="op" id="7333319">;</span>&nbsp;<span class="ident" id="7333321">m</span>&nbsp;<span class="op" id="7333323">!=</span>&nbsp;<span class="num" id="7333326">1</span>&nbsp;<span class="op" id="7333328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333332">t</span><span class="op" id="7333333">.</span><span class="ident" id="7333334">Errorf</span><span class="op" id="7333340">(</span><span class="string" id="7333341">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="7333391">,</span>&nbsp;<span class="ident" id="7333393">m</span><span class="op" id="7333394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333400">if</span>&nbsp;<span class="ident" id="7333403">cert2</span><span class="op" id="7333408">.</span><span class="ident" id="7333409">MaxPathLenZero</span>&nbsp;<span class="op" id="7333424">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333428">t</span><span class="op" id="7333429">.</span><span class="ident" id="7333430">Errorf</span><span class="op" id="7333436">(</span><span class="string" id="7333437">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7333484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333491">template</span><span class="op" id="7333499">.</span><span class="ident" id="7333500">MaxPathLen</span>&nbsp;<span class="op" id="7333511">=</span>&nbsp;<span class="num" id="7333513">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333516">template</span><span class="op" id="7333524">.</span><span class="ident" id="7333525">MaxPathLenZero</span>&nbsp;<span class="op" id="7333540">=</span>&nbsp;<span class="builtintype" id="7333542">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333548">cert3</span>&nbsp;<span class="op" id="7333554">:=</span>&nbsp;<span class="ident" id="7333557">serialiseAndParse</span><span class="op" id="7333574">(</span><span class="ident" id="7333575">template</span><span class="op" id="7333583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333586">if</span>&nbsp;<span class="ident" id="7333589">m</span>&nbsp;<span class="op" id="7333591">:=</span>&nbsp;<span class="ident" id="7333594">cert3</span><span class="op" id="7333599">.</span><span class="ident" id="7333600">MaxPathLen</span><span class="op" id="7333610">;</span>&nbsp;<span class="ident" id="7333612">m</span>&nbsp;<span class="op" id="7333614">!=</span>&nbsp;<span class="num" id="7333617">0</span>&nbsp;<span class="op" id="7333619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333623">t</span><span class="op" id="7333624">.</span><span class="ident" id="7333625">Errorf</span><span class="op" id="7333631">(</span><span class="string" id="7333632">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7333676">,</span>&nbsp;<span class="ident" id="7333678">m</span><span class="op" id="7333679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333685">if</span>&nbsp;<span class="op" id="7333688">!</span><span class="ident" id="7333689">cert3</span><span class="op" id="7333694">.</span><span class="ident" id="7333695">MaxPathLenZero</span>&nbsp;<span class="op" id="7333710">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333714">t</span><span class="op" id="7333715">.</span><span class="ident" id="7333716">Errorf</span><span class="op" id="7333722">(</span><span class="string" id="7333723">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7333783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333786">}</span><br>
<span class="lineno"></span><span class="op" id="7333788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7333791">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="7333831">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="7333932">//</span><br>
<span class="lineno"></span><span class="comment" id="7333935">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="7333985">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="7334001">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="7334034">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="7334100">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="7334167">const</span>&nbsp;<span class="ident" id="7334173">csrBase64</span>&nbsp;<span class="op" id="7334183">=</span>&nbsp;<span class="string" id="7334185">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
