<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2126625">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2126680">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2126734">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2126785">package</span>&nbsp;<span class="ident" id="2126793">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2126802">//&nbsp;An&nbsp;extFloat&nbsp;represents&nbsp;an&nbsp;extended&nbsp;floating-point&nbsp;number,&nbsp;with&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2126873">//&nbsp;precision&nbsp;than&nbsp;a&nbsp;float64.&nbsp;It&nbsp;does&nbsp;not&nbsp;try&nbsp;to&nbsp;save&nbsp;bits:&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2126936">//&nbsp;number&nbsp;represented&nbsp;by&nbsp;the&nbsp;structure&nbsp;is&nbsp;mant*(2^exp),&nbsp;with&nbsp;a&nbsp;negative</span><br>
<span class="lineno">10</span><span class="comment" id="2127008">//&nbsp;sign&nbsp;if&nbsp;neg&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="2127032">type</span>&nbsp;<span class="ident" id="2127037">extFloat</span>&nbsp;<span class="keyword" id="2127046">struct</span>&nbsp;<span class="op" id="2127053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127056">mant</span>&nbsp;<span class="ident" id="2127061">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127069">exp</span>&nbsp;&nbsp;<span class="builtintype" id="2127074">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127079">neg</span>&nbsp;&nbsp;<span class="builtintype" id="2127084">bool</span><br>
<span class="lineno">15</span><span class="op" id="2127089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2127092">//&nbsp;Powers&nbsp;of&nbsp;ten&nbsp;taken&nbsp;from&nbsp;double-conversion&nbsp;library.</span><br>
<span class="lineno"></span><span class="comment" id="2127147">//&nbsp;http://code.google.com/p/double-conversion/</span><br>
<span class="lineno"></span><span class="keyword" id="2127194">const</span>&nbsp;<span class="op" id="2127200">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127203">firstPowerOfTen</span>&nbsp;<span class="op" id="2127219">=</span>&nbsp;<span class="op" id="2127221">-</span><span class="num" id="2127222">348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2127227">stepPowerOfTen</span>&nbsp;&nbsp;<span class="op" id="2127243">=</span>&nbsp;<span class="num" id="2127245">8</span><br>
<span class="lineno"></span><span class="op" id="2127247">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2127250">var</span>&nbsp;<span class="ident" id="2127254">smallPowersOfTen</span>&nbsp;<span class="op" id="2127271">=</span>&nbsp;<span class="op" id="2127273">[</span><span class="op" id="2127274">...</span><span class="op" id="2127277">]</span><span class="ident" id="2127278">extFloat</span><span class="op" id="2127286">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127289">{</span><span class="num" id="2127290">1</span>&nbsp;<span class="op" id="2127292">&lt;&lt;</span>&nbsp;<span class="num" id="2127295">63</span><span class="op" id="2127297">,</span>&nbsp;<span class="op" id="2127299">-</span><span class="num" id="2127300">63</span><span class="op" id="2127302">,</span>&nbsp;<span class="ident" id="2127304">false</span><span class="op" id="2127309">}</span><span class="op" id="2127310">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2127319">//&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127325">{</span><span class="num" id="2127326">0xa</span>&nbsp;<span class="op" id="2127330">&lt;&lt;</span>&nbsp;<span class="num" id="2127333">60</span><span class="op" id="2127335">,</span>&nbsp;<span class="op" id="2127337">-</span><span class="num" id="2127338">60</span><span class="op" id="2127340">,</span>&nbsp;<span class="ident" id="2127342">false</span><span class="op" id="2127347">}</span><span class="op" id="2127348">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2127355">//&nbsp;1e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127363">{</span><span class="num" id="2127364">0x64</span>&nbsp;<span class="op" id="2127369">&lt;&lt;</span>&nbsp;<span class="num" id="2127372">57</span><span class="op" id="2127374">,</span>&nbsp;<span class="op" id="2127376">-</span><span class="num" id="2127377">57</span><span class="op" id="2127379">,</span>&nbsp;<span class="ident" id="2127381">false</span><span class="op" id="2127386">}</span><span class="op" id="2127387">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2127393">//&nbsp;1e2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127401">{</span><span class="num" id="2127402">0x3e8</span>&nbsp;<span class="op" id="2127408">&lt;&lt;</span>&nbsp;<span class="num" id="2127411">54</span><span class="op" id="2127413">,</span>&nbsp;<span class="op" id="2127415">-</span><span class="num" id="2127416">54</span><span class="op" id="2127418">,</span>&nbsp;<span class="ident" id="2127420">false</span><span class="op" id="2127425">}</span><span class="op" id="2127426">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2127431">//&nbsp;1e3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127439">{</span><span class="num" id="2127440">0x2710</span>&nbsp;<span class="op" id="2127447">&lt;&lt;</span>&nbsp;<span class="num" id="2127450">50</span><span class="op" id="2127452">,</span>&nbsp;<span class="op" id="2127454">-</span><span class="num" id="2127455">50</span><span class="op" id="2127457">,</span>&nbsp;<span class="ident" id="2127459">false</span><span class="op" id="2127464">}</span><span class="op" id="2127465">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2127469">//&nbsp;1e4</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127477">{</span><span class="num" id="2127478">0x186a0</span>&nbsp;<span class="op" id="2127486">&lt;&lt;</span>&nbsp;<span class="num" id="2127489">47</span><span class="op" id="2127491">,</span>&nbsp;<span class="op" id="2127493">-</span><span class="num" id="2127494">47</span><span class="op" id="2127496">,</span>&nbsp;<span class="ident" id="2127498">false</span><span class="op" id="2127503">}</span><span class="op" id="2127504">,</span>&nbsp;&nbsp;<span class="comment" id="2127507">//&nbsp;1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127515">{</span><span class="num" id="2127516">0xf4240</span>&nbsp;<span class="op" id="2127524">&lt;&lt;</span>&nbsp;<span class="num" id="2127527">44</span><span class="op" id="2127529">,</span>&nbsp;<span class="op" id="2127531">-</span><span class="num" id="2127532">44</span><span class="op" id="2127534">,</span>&nbsp;<span class="ident" id="2127536">false</span><span class="op" id="2127541">}</span><span class="op" id="2127542">,</span>&nbsp;&nbsp;<span class="comment" id="2127545">//&nbsp;1e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127553">{</span><span class="num" id="2127554">0x989680</span>&nbsp;<span class="op" id="2127563">&lt;&lt;</span>&nbsp;<span class="num" id="2127566">40</span><span class="op" id="2127568">,</span>&nbsp;<span class="op" id="2127570">-</span><span class="num" id="2127571">40</span><span class="op" id="2127573">,</span>&nbsp;<span class="ident" id="2127575">false</span><span class="op" id="2127580">}</span><span class="op" id="2127581">,</span>&nbsp;<span class="comment" id="2127583">//&nbsp;1e7</span><br>
<span class="lineno"></span><span class="op" id="2127590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="2127593">var</span>&nbsp;<span class="ident" id="2127597">powersOfTen</span>&nbsp;<span class="op" id="2127609">=</span>&nbsp;<span class="op" id="2127611">[</span><span class="op" id="2127612">...</span><span class="op" id="2127615">]</span><span class="ident" id="2127616">extFloat</span><span class="op" id="2127624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127627">{</span><span class="num" id="2127628">0xfa8fd5a0081c0288</span><span class="op" id="2127646">,</span>&nbsp;<span class="op" id="2127648">-</span><span class="num" id="2127649">1220</span><span class="op" id="2127653">,</span>&nbsp;<span class="ident" id="2127655">false</span><span class="op" id="2127660">}</span><span class="op" id="2127661">,</span>&nbsp;<span class="comment" id="2127663">//&nbsp;10^-348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127675">{</span><span class="num" id="2127676">0xbaaee17fa23ebf76</span><span class="op" id="2127694">,</span>&nbsp;<span class="op" id="2127696">-</span><span class="num" id="2127697">1193</span><span class="op" id="2127701">,</span>&nbsp;<span class="ident" id="2127703">false</span><span class="op" id="2127708">}</span><span class="op" id="2127709">,</span>&nbsp;<span class="comment" id="2127711">//&nbsp;10^-340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127723">{</span><span class="num" id="2127724">0x8b16fb203055ac76</span><span class="op" id="2127742">,</span>&nbsp;<span class="op" id="2127744">-</span><span class="num" id="2127745">1166</span><span class="op" id="2127749">,</span>&nbsp;<span class="ident" id="2127751">false</span><span class="op" id="2127756">}</span><span class="op" id="2127757">,</span>&nbsp;<span class="comment" id="2127759">//&nbsp;10^-332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127771">{</span><span class="num" id="2127772">0xcf42894a5dce35ea</span><span class="op" id="2127790">,</span>&nbsp;<span class="op" id="2127792">-</span><span class="num" id="2127793">1140</span><span class="op" id="2127797">,</span>&nbsp;<span class="ident" id="2127799">false</span><span class="op" id="2127804">}</span><span class="op" id="2127805">,</span>&nbsp;<span class="comment" id="2127807">//&nbsp;10^-324</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127819">{</span><span class="num" id="2127820">0x9a6bb0aa55653b2d</span><span class="op" id="2127838">,</span>&nbsp;<span class="op" id="2127840">-</span><span class="num" id="2127841">1113</span><span class="op" id="2127845">,</span>&nbsp;<span class="ident" id="2127847">false</span><span class="op" id="2127852">}</span><span class="op" id="2127853">,</span>&nbsp;<span class="comment" id="2127855">//&nbsp;10^-316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127867">{</span><span class="num" id="2127868">0xe61acf033d1a45df</span><span class="op" id="2127886">,</span>&nbsp;<span class="op" id="2127888">-</span><span class="num" id="2127889">1087</span><span class="op" id="2127893">,</span>&nbsp;<span class="ident" id="2127895">false</span><span class="op" id="2127900">}</span><span class="op" id="2127901">,</span>&nbsp;<span class="comment" id="2127903">//&nbsp;10^-308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127915">{</span><span class="num" id="2127916">0xab70fe17c79ac6ca</span><span class="op" id="2127934">,</span>&nbsp;<span class="op" id="2127936">-</span><span class="num" id="2127937">1060</span><span class="op" id="2127941">,</span>&nbsp;<span class="ident" id="2127943">false</span><span class="op" id="2127948">}</span><span class="op" id="2127949">,</span>&nbsp;<span class="comment" id="2127951">//&nbsp;10^-300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2127963">{</span><span class="num" id="2127964">0xff77b1fcbebcdc4f</span><span class="op" id="2127982">,</span>&nbsp;<span class="op" id="2127984">-</span><span class="num" id="2127985">1034</span><span class="op" id="2127989">,</span>&nbsp;<span class="ident" id="2127991">false</span><span class="op" id="2127996">}</span><span class="op" id="2127997">,</span>&nbsp;<span class="comment" id="2127999">//&nbsp;10^-292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128011">{</span><span class="num" id="2128012">0xbe5691ef416bd60c</span><span class="op" id="2128030">,</span>&nbsp;<span class="op" id="2128032">-</span><span class="num" id="2128033">1007</span><span class="op" id="2128037">,</span>&nbsp;<span class="ident" id="2128039">false</span><span class="op" id="2128044">}</span><span class="op" id="2128045">,</span>&nbsp;<span class="comment" id="2128047">//&nbsp;10^-284</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128059">{</span><span class="num" id="2128060">0x8dd01fad907ffc3c</span><span class="op" id="2128078">,</span>&nbsp;<span class="op" id="2128080">-</span><span class="num" id="2128081">980</span><span class="op" id="2128084">,</span>&nbsp;<span class="ident" id="2128086">false</span><span class="op" id="2128091">}</span><span class="op" id="2128092">,</span>&nbsp;&nbsp;<span class="comment" id="2128095">//&nbsp;10^-276</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128107">{</span><span class="num" id="2128108">0xd3515c2831559a83</span><span class="op" id="2128126">,</span>&nbsp;<span class="op" id="2128128">-</span><span class="num" id="2128129">954</span><span class="op" id="2128132">,</span>&nbsp;<span class="ident" id="2128134">false</span><span class="op" id="2128139">}</span><span class="op" id="2128140">,</span>&nbsp;&nbsp;<span class="comment" id="2128143">//&nbsp;10^-268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128155">{</span><span class="num" id="2128156">0x9d71ac8fada6c9b5</span><span class="op" id="2128174">,</span>&nbsp;<span class="op" id="2128176">-</span><span class="num" id="2128177">927</span><span class="op" id="2128180">,</span>&nbsp;<span class="ident" id="2128182">false</span><span class="op" id="2128187">}</span><span class="op" id="2128188">,</span>&nbsp;&nbsp;<span class="comment" id="2128191">//&nbsp;10^-260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128203">{</span><span class="num" id="2128204">0xea9c227723ee8bcb</span><span class="op" id="2128222">,</span>&nbsp;<span class="op" id="2128224">-</span><span class="num" id="2128225">901</span><span class="op" id="2128228">,</span>&nbsp;<span class="ident" id="2128230">false</span><span class="op" id="2128235">}</span><span class="op" id="2128236">,</span>&nbsp;&nbsp;<span class="comment" id="2128239">//&nbsp;10^-252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128251">{</span><span class="num" id="2128252">0xaecc49914078536d</span><span class="op" id="2128270">,</span>&nbsp;<span class="op" id="2128272">-</span><span class="num" id="2128273">874</span><span class="op" id="2128276">,</span>&nbsp;<span class="ident" id="2128278">false</span><span class="op" id="2128283">}</span><span class="op" id="2128284">,</span>&nbsp;&nbsp;<span class="comment" id="2128287">//&nbsp;10^-244</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128299">{</span><span class="num" id="2128300">0x823c12795db6ce57</span><span class="op" id="2128318">,</span>&nbsp;<span class="op" id="2128320">-</span><span class="num" id="2128321">847</span><span class="op" id="2128324">,</span>&nbsp;<span class="ident" id="2128326">false</span><span class="op" id="2128331">}</span><span class="op" id="2128332">,</span>&nbsp;&nbsp;<span class="comment" id="2128335">//&nbsp;10^-236</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128347">{</span><span class="num" id="2128348">0xc21094364dfb5637</span><span class="op" id="2128366">,</span>&nbsp;<span class="op" id="2128368">-</span><span class="num" id="2128369">821</span><span class="op" id="2128372">,</span>&nbsp;<span class="ident" id="2128374">false</span><span class="op" id="2128379">}</span><span class="op" id="2128380">,</span>&nbsp;&nbsp;<span class="comment" id="2128383">//&nbsp;10^-228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128395">{</span><span class="num" id="2128396">0x9096ea6f3848984f</span><span class="op" id="2128414">,</span>&nbsp;<span class="op" id="2128416">-</span><span class="num" id="2128417">794</span><span class="op" id="2128420">,</span>&nbsp;<span class="ident" id="2128422">false</span><span class="op" id="2128427">}</span><span class="op" id="2128428">,</span>&nbsp;&nbsp;<span class="comment" id="2128431">//&nbsp;10^-220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128443">{</span><span class="num" id="2128444">0xd77485cb25823ac7</span><span class="op" id="2128462">,</span>&nbsp;<span class="op" id="2128464">-</span><span class="num" id="2128465">768</span><span class="op" id="2128468">,</span>&nbsp;<span class="ident" id="2128470">false</span><span class="op" id="2128475">}</span><span class="op" id="2128476">,</span>&nbsp;&nbsp;<span class="comment" id="2128479">//&nbsp;10^-212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128491">{</span><span class="num" id="2128492">0xa086cfcd97bf97f4</span><span class="op" id="2128510">,</span>&nbsp;<span class="op" id="2128512">-</span><span class="num" id="2128513">741</span><span class="op" id="2128516">,</span>&nbsp;<span class="ident" id="2128518">false</span><span class="op" id="2128523">}</span><span class="op" id="2128524">,</span>&nbsp;&nbsp;<span class="comment" id="2128527">//&nbsp;10^-204</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128539">{</span><span class="num" id="2128540">0xef340a98172aace5</span><span class="op" id="2128558">,</span>&nbsp;<span class="op" id="2128560">-</span><span class="num" id="2128561">715</span><span class="op" id="2128564">,</span>&nbsp;<span class="ident" id="2128566">false</span><span class="op" id="2128571">}</span><span class="op" id="2128572">,</span>&nbsp;&nbsp;<span class="comment" id="2128575">//&nbsp;10^-196</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128587">{</span><span class="num" id="2128588">0xb23867fb2a35b28e</span><span class="op" id="2128606">,</span>&nbsp;<span class="op" id="2128608">-</span><span class="num" id="2128609">688</span><span class="op" id="2128612">,</span>&nbsp;<span class="ident" id="2128614">false</span><span class="op" id="2128619">}</span><span class="op" id="2128620">,</span>&nbsp;&nbsp;<span class="comment" id="2128623">//&nbsp;10^-188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128635">{</span><span class="num" id="2128636">0x84c8d4dfd2c63f3b</span><span class="op" id="2128654">,</span>&nbsp;<span class="op" id="2128656">-</span><span class="num" id="2128657">661</span><span class="op" id="2128660">,</span>&nbsp;<span class="ident" id="2128662">false</span><span class="op" id="2128667">}</span><span class="op" id="2128668">,</span>&nbsp;&nbsp;<span class="comment" id="2128671">//&nbsp;10^-180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128683">{</span><span class="num" id="2128684">0xc5dd44271ad3cdba</span><span class="op" id="2128702">,</span>&nbsp;<span class="op" id="2128704">-</span><span class="num" id="2128705">635</span><span class="op" id="2128708">,</span>&nbsp;<span class="ident" id="2128710">false</span><span class="op" id="2128715">}</span><span class="op" id="2128716">,</span>&nbsp;&nbsp;<span class="comment" id="2128719">//&nbsp;10^-172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128731">{</span><span class="num" id="2128732">0x936b9fcebb25c996</span><span class="op" id="2128750">,</span>&nbsp;<span class="op" id="2128752">-</span><span class="num" id="2128753">608</span><span class="op" id="2128756">,</span>&nbsp;<span class="ident" id="2128758">false</span><span class="op" id="2128763">}</span><span class="op" id="2128764">,</span>&nbsp;&nbsp;<span class="comment" id="2128767">//&nbsp;10^-164</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128779">{</span><span class="num" id="2128780">0xdbac6c247d62a584</span><span class="op" id="2128798">,</span>&nbsp;<span class="op" id="2128800">-</span><span class="num" id="2128801">582</span><span class="op" id="2128804">,</span>&nbsp;<span class="ident" id="2128806">false</span><span class="op" id="2128811">}</span><span class="op" id="2128812">,</span>&nbsp;&nbsp;<span class="comment" id="2128815">//&nbsp;10^-156</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128827">{</span><span class="num" id="2128828">0xa3ab66580d5fdaf6</span><span class="op" id="2128846">,</span>&nbsp;<span class="op" id="2128848">-</span><span class="num" id="2128849">555</span><span class="op" id="2128852">,</span>&nbsp;<span class="ident" id="2128854">false</span><span class="op" id="2128859">}</span><span class="op" id="2128860">,</span>&nbsp;&nbsp;<span class="comment" id="2128863">//&nbsp;10^-148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128875">{</span><span class="num" id="2128876">0xf3e2f893dec3f126</span><span class="op" id="2128894">,</span>&nbsp;<span class="op" id="2128896">-</span><span class="num" id="2128897">529</span><span class="op" id="2128900">,</span>&nbsp;<span class="ident" id="2128902">false</span><span class="op" id="2128907">}</span><span class="op" id="2128908">,</span>&nbsp;&nbsp;<span class="comment" id="2128911">//&nbsp;10^-140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128923">{</span><span class="num" id="2128924">0xb5b5ada8aaff80b8</span><span class="op" id="2128942">,</span>&nbsp;<span class="op" id="2128944">-</span><span class="num" id="2128945">502</span><span class="op" id="2128948">,</span>&nbsp;<span class="ident" id="2128950">false</span><span class="op" id="2128955">}</span><span class="op" id="2128956">,</span>&nbsp;&nbsp;<span class="comment" id="2128959">//&nbsp;10^-132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2128971">{</span><span class="num" id="2128972">0x87625f056c7c4a8b</span><span class="op" id="2128990">,</span>&nbsp;<span class="op" id="2128992">-</span><span class="num" id="2128993">475</span><span class="op" id="2128996">,</span>&nbsp;<span class="ident" id="2128998">false</span><span class="op" id="2129003">}</span><span class="op" id="2129004">,</span>&nbsp;&nbsp;<span class="comment" id="2129007">//&nbsp;10^-124</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129019">{</span><span class="num" id="2129020">0xc9bcff6034c13053</span><span class="op" id="2129038">,</span>&nbsp;<span class="op" id="2129040">-</span><span class="num" id="2129041">449</span><span class="op" id="2129044">,</span>&nbsp;<span class="ident" id="2129046">false</span><span class="op" id="2129051">}</span><span class="op" id="2129052">,</span>&nbsp;&nbsp;<span class="comment" id="2129055">//&nbsp;10^-116</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129067">{</span><span class="num" id="2129068">0x964e858c91ba2655</span><span class="op" id="2129086">,</span>&nbsp;<span class="op" id="2129088">-</span><span class="num" id="2129089">422</span><span class="op" id="2129092">,</span>&nbsp;<span class="ident" id="2129094">false</span><span class="op" id="2129099">}</span><span class="op" id="2129100">,</span>&nbsp;&nbsp;<span class="comment" id="2129103">//&nbsp;10^-108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129115">{</span><span class="num" id="2129116">0xdff9772470297ebd</span><span class="op" id="2129134">,</span>&nbsp;<span class="op" id="2129136">-</span><span class="num" id="2129137">396</span><span class="op" id="2129140">,</span>&nbsp;<span class="ident" id="2129142">false</span><span class="op" id="2129147">}</span><span class="op" id="2129148">,</span>&nbsp;&nbsp;<span class="comment" id="2129151">//&nbsp;10^-100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129163">{</span><span class="num" id="2129164">0xa6dfbd9fb8e5b88f</span><span class="op" id="2129182">,</span>&nbsp;<span class="op" id="2129184">-</span><span class="num" id="2129185">369</span><span class="op" id="2129188">,</span>&nbsp;<span class="ident" id="2129190">false</span><span class="op" id="2129195">}</span><span class="op" id="2129196">,</span>&nbsp;&nbsp;<span class="comment" id="2129199">//&nbsp;10^-92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129210">{</span><span class="num" id="2129211">0xf8a95fcf88747d94</span><span class="op" id="2129229">,</span>&nbsp;<span class="op" id="2129231">-</span><span class="num" id="2129232">343</span><span class="op" id="2129235">,</span>&nbsp;<span class="ident" id="2129237">false</span><span class="op" id="2129242">}</span><span class="op" id="2129243">,</span>&nbsp;&nbsp;<span class="comment" id="2129246">//&nbsp;10^-84</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129257">{</span><span class="num" id="2129258">0xb94470938fa89bcf</span><span class="op" id="2129276">,</span>&nbsp;<span class="op" id="2129278">-</span><span class="num" id="2129279">316</span><span class="op" id="2129282">,</span>&nbsp;<span class="ident" id="2129284">false</span><span class="op" id="2129289">}</span><span class="op" id="2129290">,</span>&nbsp;&nbsp;<span class="comment" id="2129293">//&nbsp;10^-76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129304">{</span><span class="num" id="2129305">0x8a08f0f8bf0f156b</span><span class="op" id="2129323">,</span>&nbsp;<span class="op" id="2129325">-</span><span class="num" id="2129326">289</span><span class="op" id="2129329">,</span>&nbsp;<span class="ident" id="2129331">false</span><span class="op" id="2129336">}</span><span class="op" id="2129337">,</span>&nbsp;&nbsp;<span class="comment" id="2129340">//&nbsp;10^-68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129351">{</span><span class="num" id="2129352">0xcdb02555653131b6</span><span class="op" id="2129370">,</span>&nbsp;<span class="op" id="2129372">-</span><span class="num" id="2129373">263</span><span class="op" id="2129376">,</span>&nbsp;<span class="ident" id="2129378">false</span><span class="op" id="2129383">}</span><span class="op" id="2129384">,</span>&nbsp;&nbsp;<span class="comment" id="2129387">//&nbsp;10^-60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129398">{</span><span class="num" id="2129399">0x993fe2c6d07b7fac</span><span class="op" id="2129417">,</span>&nbsp;<span class="op" id="2129419">-</span><span class="num" id="2129420">236</span><span class="op" id="2129423">,</span>&nbsp;<span class="ident" id="2129425">false</span><span class="op" id="2129430">}</span><span class="op" id="2129431">,</span>&nbsp;&nbsp;<span class="comment" id="2129434">//&nbsp;10^-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129445">{</span><span class="num" id="2129446">0xe45c10c42a2b3b06</span><span class="op" id="2129464">,</span>&nbsp;<span class="op" id="2129466">-</span><span class="num" id="2129467">210</span><span class="op" id="2129470">,</span>&nbsp;<span class="ident" id="2129472">false</span><span class="op" id="2129477">}</span><span class="op" id="2129478">,</span>&nbsp;&nbsp;<span class="comment" id="2129481">//&nbsp;10^-44</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129492">{</span><span class="num" id="2129493">0xaa242499697392d3</span><span class="op" id="2129511">,</span>&nbsp;<span class="op" id="2129513">-</span><span class="num" id="2129514">183</span><span class="op" id="2129517">,</span>&nbsp;<span class="ident" id="2129519">false</span><span class="op" id="2129524">}</span><span class="op" id="2129525">,</span>&nbsp;&nbsp;<span class="comment" id="2129528">//&nbsp;10^-36</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129539">{</span><span class="num" id="2129540">0xfd87b5f28300ca0e</span><span class="op" id="2129558">,</span>&nbsp;<span class="op" id="2129560">-</span><span class="num" id="2129561">157</span><span class="op" id="2129564">,</span>&nbsp;<span class="ident" id="2129566">false</span><span class="op" id="2129571">}</span><span class="op" id="2129572">,</span>&nbsp;&nbsp;<span class="comment" id="2129575">//&nbsp;10^-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129586">{</span><span class="num" id="2129587">0xbce5086492111aeb</span><span class="op" id="2129605">,</span>&nbsp;<span class="op" id="2129607">-</span><span class="num" id="2129608">130</span><span class="op" id="2129611">,</span>&nbsp;<span class="ident" id="2129613">false</span><span class="op" id="2129618">}</span><span class="op" id="2129619">,</span>&nbsp;&nbsp;<span class="comment" id="2129622">//&nbsp;10^-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129633">{</span><span class="num" id="2129634">0x8cbccc096f5088cc</span><span class="op" id="2129652">,</span>&nbsp;<span class="op" id="2129654">-</span><span class="num" id="2129655">103</span><span class="op" id="2129658">,</span>&nbsp;<span class="ident" id="2129660">false</span><span class="op" id="2129665">}</span><span class="op" id="2129666">,</span>&nbsp;&nbsp;<span class="comment" id="2129669">//&nbsp;10^-12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129680">{</span><span class="num" id="2129681">0xd1b71758e219652c</span><span class="op" id="2129699">,</span>&nbsp;<span class="op" id="2129701">-</span><span class="num" id="2129702">77</span><span class="op" id="2129704">,</span>&nbsp;<span class="ident" id="2129706">false</span><span class="op" id="2129711">}</span><span class="op" id="2129712">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2129716">//&nbsp;10^-4</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129726">{</span><span class="num" id="2129727">0x9c40000000000000</span><span class="op" id="2129745">,</span>&nbsp;<span class="op" id="2129747">-</span><span class="num" id="2129748">50</span><span class="op" id="2129750">,</span>&nbsp;<span class="ident" id="2129752">false</span><span class="op" id="2129757">}</span><span class="op" id="2129758">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2129762">//&nbsp;10^4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129771">{</span><span class="num" id="2129772">0xe8d4a51000000000</span><span class="op" id="2129790">,</span>&nbsp;<span class="op" id="2129792">-</span><span class="num" id="2129793">24</span><span class="op" id="2129795">,</span>&nbsp;<span class="ident" id="2129797">false</span><span class="op" id="2129802">}</span><span class="op" id="2129803">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2129807">//&nbsp;10^12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129817">{</span><span class="num" id="2129818">0xad78ebc5ac620000</span><span class="op" id="2129836">,</span>&nbsp;<span class="num" id="2129838">3</span><span class="op" id="2129839">,</span>&nbsp;<span class="ident" id="2129841">false</span><span class="op" id="2129846">}</span><span class="op" id="2129847">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2129853">//&nbsp;10^20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129863">{</span><span class="num" id="2129864">0x813f3978f8940984</span><span class="op" id="2129882">,</span>&nbsp;<span class="num" id="2129884">30</span><span class="op" id="2129886">,</span>&nbsp;<span class="ident" id="2129888">false</span><span class="op" id="2129893">}</span><span class="op" id="2129894">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2129899">//&nbsp;10^28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129909">{</span><span class="num" id="2129910">0xc097ce7bc90715b3</span><span class="op" id="2129928">,</span>&nbsp;<span class="num" id="2129930">56</span><span class="op" id="2129932">,</span>&nbsp;<span class="ident" id="2129934">false</span><span class="op" id="2129939">}</span><span class="op" id="2129940">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2129945">//&nbsp;10^36</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2129955">{</span><span class="num" id="2129956">0x8f7e32ce7bea5c70</span><span class="op" id="2129974">,</span>&nbsp;<span class="num" id="2129976">83</span><span class="op" id="2129978">,</span>&nbsp;<span class="ident" id="2129980">false</span><span class="op" id="2129985">}</span><span class="op" id="2129986">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2129991">//&nbsp;10^44</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130001">{</span><span class="num" id="2130002">0xd5d238a4abe98068</span><span class="op" id="2130020">,</span>&nbsp;<span class="num" id="2130022">109</span><span class="op" id="2130025">,</span>&nbsp;<span class="ident" id="2130027">false</span><span class="op" id="2130032">}</span><span class="op" id="2130033">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130037">//&nbsp;10^52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130047">{</span><span class="num" id="2130048">0x9f4f2726179a2245</span><span class="op" id="2130066">,</span>&nbsp;<span class="num" id="2130068">136</span><span class="op" id="2130071">,</span>&nbsp;<span class="ident" id="2130073">false</span><span class="op" id="2130078">}</span><span class="op" id="2130079">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130083">//&nbsp;10^60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130093">{</span><span class="num" id="2130094">0xed63a231d4c4fb27</span><span class="op" id="2130112">,</span>&nbsp;<span class="num" id="2130114">162</span><span class="op" id="2130117">,</span>&nbsp;<span class="ident" id="2130119">false</span><span class="op" id="2130124">}</span><span class="op" id="2130125">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130129">//&nbsp;10^68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130139">{</span><span class="num" id="2130140">0xb0de65388cc8ada8</span><span class="op" id="2130158">,</span>&nbsp;<span class="num" id="2130160">189</span><span class="op" id="2130163">,</span>&nbsp;<span class="ident" id="2130165">false</span><span class="op" id="2130170">}</span><span class="op" id="2130171">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130175">//&nbsp;10^76</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130185">{</span><span class="num" id="2130186">0x83c7088e1aab65db</span><span class="op" id="2130204">,</span>&nbsp;<span class="num" id="2130206">216</span><span class="op" id="2130209">,</span>&nbsp;<span class="ident" id="2130211">false</span><span class="op" id="2130216">}</span><span class="op" id="2130217">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130221">//&nbsp;10^84</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130231">{</span><span class="num" id="2130232">0xc45d1df942711d9a</span><span class="op" id="2130250">,</span>&nbsp;<span class="num" id="2130252">242</span><span class="op" id="2130255">,</span>&nbsp;<span class="ident" id="2130257">false</span><span class="op" id="2130262">}</span><span class="op" id="2130263">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130267">//&nbsp;10^92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130277">{</span><span class="num" id="2130278">0x924d692ca61be758</span><span class="op" id="2130296">,</span>&nbsp;<span class="num" id="2130298">269</span><span class="op" id="2130301">,</span>&nbsp;<span class="ident" id="2130303">false</span><span class="op" id="2130308">}</span><span class="op" id="2130309">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130313">//&nbsp;10^100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130324">{</span><span class="num" id="2130325">0xda01ee641a708dea</span><span class="op" id="2130343">,</span>&nbsp;<span class="num" id="2130345">295</span><span class="op" id="2130348">,</span>&nbsp;<span class="ident" id="2130350">false</span><span class="op" id="2130355">}</span><span class="op" id="2130356">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130360">//&nbsp;10^108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130371">{</span><span class="num" id="2130372">0xa26da3999aef774a</span><span class="op" id="2130390">,</span>&nbsp;<span class="num" id="2130392">322</span><span class="op" id="2130395">,</span>&nbsp;<span class="ident" id="2130397">false</span><span class="op" id="2130402">}</span><span class="op" id="2130403">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130407">//&nbsp;10^116</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130418">{</span><span class="num" id="2130419">0xf209787bb47d6b85</span><span class="op" id="2130437">,</span>&nbsp;<span class="num" id="2130439">348</span><span class="op" id="2130442">,</span>&nbsp;<span class="ident" id="2130444">false</span><span class="op" id="2130449">}</span><span class="op" id="2130450">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130454">//&nbsp;10^124</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130465">{</span><span class="num" id="2130466">0xb454e4a179dd1877</span><span class="op" id="2130484">,</span>&nbsp;<span class="num" id="2130486">375</span><span class="op" id="2130489">,</span>&nbsp;<span class="ident" id="2130491">false</span><span class="op" id="2130496">}</span><span class="op" id="2130497">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130501">//&nbsp;10^132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130512">{</span><span class="num" id="2130513">0x865b86925b9bc5c2</span><span class="op" id="2130531">,</span>&nbsp;<span class="num" id="2130533">402</span><span class="op" id="2130536">,</span>&nbsp;<span class="ident" id="2130538">false</span><span class="op" id="2130543">}</span><span class="op" id="2130544">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130548">//&nbsp;10^140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130559">{</span><span class="num" id="2130560">0xc83553c5c8965d3d</span><span class="op" id="2130578">,</span>&nbsp;<span class="num" id="2130580">428</span><span class="op" id="2130583">,</span>&nbsp;<span class="ident" id="2130585">false</span><span class="op" id="2130590">}</span><span class="op" id="2130591">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130595">//&nbsp;10^148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130606">{</span><span class="num" id="2130607">0x952ab45cfa97a0b3</span><span class="op" id="2130625">,</span>&nbsp;<span class="num" id="2130627">455</span><span class="op" id="2130630">,</span>&nbsp;<span class="ident" id="2130632">false</span><span class="op" id="2130637">}</span><span class="op" id="2130638">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130642">//&nbsp;10^156</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130653">{</span><span class="num" id="2130654">0xde469fbd99a05fe3</span><span class="op" id="2130672">,</span>&nbsp;<span class="num" id="2130674">481</span><span class="op" id="2130677">,</span>&nbsp;<span class="ident" id="2130679">false</span><span class="op" id="2130684">}</span><span class="op" id="2130685">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130689">//&nbsp;10^164</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130700">{</span><span class="num" id="2130701">0xa59bc234db398c25</span><span class="op" id="2130719">,</span>&nbsp;<span class="num" id="2130721">508</span><span class="op" id="2130724">,</span>&nbsp;<span class="ident" id="2130726">false</span><span class="op" id="2130731">}</span><span class="op" id="2130732">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130736">//&nbsp;10^172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130747">{</span><span class="num" id="2130748">0xf6c69a72a3989f5c</span><span class="op" id="2130766">,</span>&nbsp;<span class="num" id="2130768">534</span><span class="op" id="2130771">,</span>&nbsp;<span class="ident" id="2130773">false</span><span class="op" id="2130778">}</span><span class="op" id="2130779">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130783">//&nbsp;10^180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130794">{</span><span class="num" id="2130795">0xb7dcbf5354e9bece</span><span class="op" id="2130813">,</span>&nbsp;<span class="num" id="2130815">561</span><span class="op" id="2130818">,</span>&nbsp;<span class="ident" id="2130820">false</span><span class="op" id="2130825">}</span><span class="op" id="2130826">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130830">//&nbsp;10^188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130841">{</span><span class="num" id="2130842">0x88fcf317f22241e2</span><span class="op" id="2130860">,</span>&nbsp;<span class="num" id="2130862">588</span><span class="op" id="2130865">,</span>&nbsp;<span class="ident" id="2130867">false</span><span class="op" id="2130872">}</span><span class="op" id="2130873">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130877">//&nbsp;10^196</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130888">{</span><span class="num" id="2130889">0xcc20ce9bd35c78a5</span><span class="op" id="2130907">,</span>&nbsp;<span class="num" id="2130909">614</span><span class="op" id="2130912">,</span>&nbsp;<span class="ident" id="2130914">false</span><span class="op" id="2130919">}</span><span class="op" id="2130920">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130924">//&nbsp;10^204</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130935">{</span><span class="num" id="2130936">0x98165af37b2153df</span><span class="op" id="2130954">,</span>&nbsp;<span class="num" id="2130956">641</span><span class="op" id="2130959">,</span>&nbsp;<span class="ident" id="2130961">false</span><span class="op" id="2130966">}</span><span class="op" id="2130967">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2130971">//&nbsp;10^212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130982">{</span><span class="num" id="2130983">0xe2a0b5dc971f303a</span><span class="op" id="2131001">,</span>&nbsp;<span class="num" id="2131003">667</span><span class="op" id="2131006">,</span>&nbsp;<span class="ident" id="2131008">false</span><span class="op" id="2131013">}</span><span class="op" id="2131014">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131018">//&nbsp;10^220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131029">{</span><span class="num" id="2131030">0xa8d9d1535ce3b396</span><span class="op" id="2131048">,</span>&nbsp;<span class="num" id="2131050">694</span><span class="op" id="2131053">,</span>&nbsp;<span class="ident" id="2131055">false</span><span class="op" id="2131060">}</span><span class="op" id="2131061">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131065">//&nbsp;10^228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131076">{</span><span class="num" id="2131077">0xfb9b7cd9a4a7443c</span><span class="op" id="2131095">,</span>&nbsp;<span class="num" id="2131097">720</span><span class="op" id="2131100">,</span>&nbsp;<span class="ident" id="2131102">false</span><span class="op" id="2131107">}</span><span class="op" id="2131108">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131112">//&nbsp;10^236</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131123">{</span><span class="num" id="2131124">0xbb764c4ca7a44410</span><span class="op" id="2131142">,</span>&nbsp;<span class="num" id="2131144">747</span><span class="op" id="2131147">,</span>&nbsp;<span class="ident" id="2131149">false</span><span class="op" id="2131154">}</span><span class="op" id="2131155">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131159">//&nbsp;10^244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131170">{</span><span class="num" id="2131171">0x8bab8eefb6409c1a</span><span class="op" id="2131189">,</span>&nbsp;<span class="num" id="2131191">774</span><span class="op" id="2131194">,</span>&nbsp;<span class="ident" id="2131196">false</span><span class="op" id="2131201">}</span><span class="op" id="2131202">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131206">//&nbsp;10^252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131217">{</span><span class="num" id="2131218">0xd01fef10a657842c</span><span class="op" id="2131236">,</span>&nbsp;<span class="num" id="2131238">800</span><span class="op" id="2131241">,</span>&nbsp;<span class="ident" id="2131243">false</span><span class="op" id="2131248">}</span><span class="op" id="2131249">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131253">//&nbsp;10^260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131264">{</span><span class="num" id="2131265">0x9b10a4e5e9913129</span><span class="op" id="2131283">,</span>&nbsp;<span class="num" id="2131285">827</span><span class="op" id="2131288">,</span>&nbsp;<span class="ident" id="2131290">false</span><span class="op" id="2131295">}</span><span class="op" id="2131296">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131300">//&nbsp;10^268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131311">{</span><span class="num" id="2131312">0xe7109bfba19c0c9d</span><span class="op" id="2131330">,</span>&nbsp;<span class="num" id="2131332">853</span><span class="op" id="2131335">,</span>&nbsp;<span class="ident" id="2131337">false</span><span class="op" id="2131342">}</span><span class="op" id="2131343">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131347">//&nbsp;10^276</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131358">{</span><span class="num" id="2131359">0xac2820d9623bf429</span><span class="op" id="2131377">,</span>&nbsp;<span class="num" id="2131379">880</span><span class="op" id="2131382">,</span>&nbsp;<span class="ident" id="2131384">false</span><span class="op" id="2131389">}</span><span class="op" id="2131390">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131394">//&nbsp;10^284</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131405">{</span><span class="num" id="2131406">0x80444b5e7aa7cf85</span><span class="op" id="2131424">,</span>&nbsp;<span class="num" id="2131426">907</span><span class="op" id="2131429">,</span>&nbsp;<span class="ident" id="2131431">false</span><span class="op" id="2131436">}</span><span class="op" id="2131437">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131441">//&nbsp;10^292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131452">{</span><span class="num" id="2131453">0xbf21e44003acdd2d</span><span class="op" id="2131471">,</span>&nbsp;<span class="num" id="2131473">933</span><span class="op" id="2131476">,</span>&nbsp;<span class="ident" id="2131478">false</span><span class="op" id="2131483">}</span><span class="op" id="2131484">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131488">//&nbsp;10^300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131499">{</span><span class="num" id="2131500">0x8e679c2f5e44ff8f</span><span class="op" id="2131518">,</span>&nbsp;<span class="num" id="2131520">960</span><span class="op" id="2131523">,</span>&nbsp;<span class="ident" id="2131525">false</span><span class="op" id="2131530">}</span><span class="op" id="2131531">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131535">//&nbsp;10^308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131546">{</span><span class="num" id="2131547">0xd433179d9c8cb841</span><span class="op" id="2131565">,</span>&nbsp;<span class="num" id="2131567">986</span><span class="op" id="2131570">,</span>&nbsp;<span class="ident" id="2131572">false</span><span class="op" id="2131577">}</span><span class="op" id="2131578">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2131582">//&nbsp;10^316</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131593">{</span><span class="num" id="2131594">0x9e19db92b4e31ba9</span><span class="op" id="2131612">,</span>&nbsp;<span class="num" id="2131614">1013</span><span class="op" id="2131618">,</span>&nbsp;<span class="ident" id="2131620">false</span><span class="op" id="2131625">}</span><span class="op" id="2131626">,</span>&nbsp;&nbsp;<span class="comment" id="2131629">//&nbsp;10^324</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131640">{</span><span class="num" id="2131641">0xeb96bf6ebadf77d9</span><span class="op" id="2131659">,</span>&nbsp;<span class="num" id="2131661">1039</span><span class="op" id="2131665">,</span>&nbsp;<span class="ident" id="2131667">false</span><span class="op" id="2131672">}</span><span class="op" id="2131673">,</span>&nbsp;&nbsp;<span class="comment" id="2131676">//&nbsp;10^332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131687">{</span><span class="num" id="2131688">0xaf87023b9bf0ee6b</span><span class="op" id="2131706">,</span>&nbsp;<span class="num" id="2131708">1066</span><span class="op" id="2131712">,</span>&nbsp;<span class="ident" id="2131714">false</span><span class="op" id="2131719">}</span><span class="op" id="2131720">,</span>&nbsp;&nbsp;<span class="comment" id="2131723">//&nbsp;10^340</span><br>
<span class="lineno"></span><span class="op" id="2131733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2131736">//&nbsp;floatBits&nbsp;returns&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;float64&nbsp;that&nbsp;best&nbsp;approximates</span><br>
<span class="lineno"></span><span class="comment" id="2131804">//&nbsp;the&nbsp;extFloat&nbsp;passed&nbsp;as&nbsp;receiver.&nbsp;Overflow&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2131867">//&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;is&nbsp;±Inf.</span><br>
<span class="lineno"></span><span class="keyword" id="2131902">func</span>&nbsp;<span class="op" id="2131907">(</span><span class="ident" id="2131908">f</span>&nbsp;<span class="op" id="2131910">*</span><span class="ident" id="2131911">extFloat</span><span class="op" id="2131919">)</span>&nbsp;<span class="ident" id="2131921">floatBits</span><span class="op" id="2131930">(</span><span class="ident" id="2131931">flt</span>&nbsp;<span class="op" id="2131935">*</span><span class="ident" id="2131936">floatInfo</span><span class="op" id="2131945">)</span>&nbsp;<span class="op" id="2131947">(</span><span class="ident" id="2131948">bits</span>&nbsp;<span class="ident" id="2131953">uint64</span><span class="op" id="2131959">,</span>&nbsp;<span class="ident" id="2131961">overflow</span>&nbsp;<span class="builtintype" id="2131970">bool</span><span class="op" id="2131974">)</span>&nbsp;<span class="op" id="2131976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131979">f</span><span class="op" id="2131980">.</span><span class="ident" id="2131981">Normalize</span><span class="op" id="2131990">(</span><span class="op" id="2131991">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131995">exp</span>&nbsp;<span class="op" id="2131999">:=</span>&nbsp;<span class="ident" id="2132002">f</span><span class="op" id="2132003">.</span><span class="ident" id="2132004">exp</span>&nbsp;<span class="op" id="2132008">+</span>&nbsp;<span class="num" id="2132010">63</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2132015">//&nbsp;Exponent&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132039">if</span>&nbsp;<span class="ident" id="2132042">exp</span>&nbsp;<span class="op" id="2132046">&lt;</span>&nbsp;<span class="ident" id="2132048">flt</span><span class="op" id="2132051">.</span><span class="ident" id="2132052">bias</span><span class="op" id="2132056">+</span><span class="num" id="2132057">1</span>&nbsp;<span class="op" id="2132059">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132063">n</span>&nbsp;<span class="op" id="2132065">:=</span>&nbsp;<span class="ident" id="2132068">flt</span><span class="op" id="2132071">.</span><span class="ident" id="2132072">bias</span>&nbsp;<span class="op" id="2132077">+</span>&nbsp;<span class="num" id="2132079">1</span>&nbsp;<span class="op" id="2132081">-</span>&nbsp;<span class="ident" id="2132083">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132089">f</span><span class="op" id="2132090">.</span><span class="ident" id="2132091">mant</span>&nbsp;<span class="op" id="2132096">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2132100">uint</span><span class="op" id="2132104">(</span><span class="ident" id="2132105">n</span><span class="op" id="2132106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132110">exp</span>&nbsp;<span class="op" id="2132114">+=</span>&nbsp;<span class="ident" id="2132117">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2132124">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits&nbsp;from&nbsp;the&nbsp;64-bit&nbsp;mantissa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132182">mant</span>&nbsp;<span class="op" id="2132187">:=</span>&nbsp;<span class="ident" id="2132190">f</span><span class="op" id="2132191">.</span><span class="ident" id="2132192">mant</span>&nbsp;<span class="op" id="2132197">&gt;&gt;</span>&nbsp;<span class="op" id="2132200">(</span><span class="num" id="2132201">63</span>&nbsp;<span class="op" id="2132204">-</span>&nbsp;<span class="ident" id="2132206">flt</span><span class="op" id="2132209">.</span><span class="ident" id="2132210">mantbits</span><span class="op" id="2132218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132221">if</span>&nbsp;<span class="ident" id="2132224">f</span><span class="op" id="2132225">.</span><span class="ident" id="2132226">mant</span><span class="op" id="2132230">&amp;</span><span class="op" id="2132231">(</span><span class="num" id="2132232">1</span><span class="op" id="2132233">&lt;&lt;</span><span class="op" id="2132235">(</span><span class="num" id="2132236">62</span><span class="op" id="2132238">-</span><span class="ident" id="2132239">flt</span><span class="op" id="2132242">.</span><span class="ident" id="2132243">mantbits</span><span class="op" id="2132251">)</span><span class="op" id="2132252">)</span>&nbsp;<span class="op" id="2132254">!=</span>&nbsp;<span class="num" id="2132257">0</span>&nbsp;<span class="op" id="2132259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2132263">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132278">mant</span>&nbsp;<span class="op" id="2132283">+=</span>&nbsp;<span class="num" id="2132286">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2132293">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132342">if</span>&nbsp;<span class="ident" id="2132345">mant</span>&nbsp;<span class="op" id="2132350">==</span>&nbsp;<span class="num" id="2132353">2</span><span class="op" id="2132354">&lt;&lt;</span><span class="ident" id="2132356">flt</span><span class="op" id="2132359">.</span><span class="ident" id="2132360">mantbits</span>&nbsp;<span class="op" id="2132369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132373">mant</span>&nbsp;<span class="op" id="2132378">&gt;&gt;=</span>&nbsp;<span class="num" id="2132382">1</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132386">exp</span><span class="op" id="2132389">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2132397">//&nbsp;Infinities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132413">if</span>&nbsp;<span class="ident" id="2132416">exp</span><span class="op" id="2132419">-</span><span class="ident" id="2132420">flt</span><span class="op" id="2132423">.</span><span class="ident" id="2132424">bias</span>&nbsp;<span class="op" id="2132429">&gt;=</span>&nbsp;<span class="num" id="2132432">1</span><span class="op" id="2132433">&lt;&lt;</span><span class="ident" id="2132435">flt</span><span class="op" id="2132438">.</span><span class="ident" id="2132439">expbits</span><span class="op" id="2132446">-</span><span class="num" id="2132447">1</span>&nbsp;<span class="op" id="2132449">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2132453">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132464">mant</span>&nbsp;<span class="op" id="2132469">=</span>&nbsp;<span class="num" id="2132471">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132475">exp</span>&nbsp;<span class="op" id="2132479">=</span>&nbsp;<span class="num" id="2132481">1</span><span class="op" id="2132482">&lt;&lt;</span><span class="ident" id="2132484">flt</span><span class="op" id="2132487">.</span><span class="ident" id="2132488">expbits</span>&nbsp;<span class="op" id="2132496">-</span>&nbsp;<span class="num" id="2132498">1</span>&nbsp;<span class="op" id="2132500">+</span>&nbsp;<span class="ident" id="2132502">flt</span><span class="op" id="2132505">.</span><span class="ident" id="2132506">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132513">overflow</span>&nbsp;<span class="op" id="2132522">=</span>&nbsp;<span class="ident" id="2132524">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132530">}</span>&nbsp;<span class="keyword" id="2132532">else</span>&nbsp;<span class="keyword" id="2132537">if</span>&nbsp;<span class="ident" id="2132540">mant</span><span class="op" id="2132544">&amp;</span><span class="op" id="2132545">(</span><span class="num" id="2132546">1</span><span class="op" id="2132547">&lt;&lt;</span><span class="ident" id="2132549">flt</span><span class="op" id="2132552">.</span><span class="ident" id="2132553">mantbits</span><span class="op" id="2132561">)</span>&nbsp;<span class="op" id="2132563">==</span>&nbsp;<span class="num" id="2132566">0</span>&nbsp;<span class="op" id="2132568">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2132572">//&nbsp;Denormalized?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132591">exp</span>&nbsp;<span class="op" id="2132595">=</span>&nbsp;<span class="ident" id="2132597">flt</span><span class="op" id="2132600">.</span><span class="ident" id="2132601">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2132610">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132629">bits</span>&nbsp;<span class="op" id="2132634">=</span>&nbsp;<span class="ident" id="2132636">mant</span>&nbsp;<span class="op" id="2132641">&amp;</span>&nbsp;<span class="op" id="2132643">(</span><span class="ident" id="2132644">uint64</span><span class="op" id="2132650">(</span><span class="num" id="2132651">1</span><span class="op" id="2132652">)</span><span class="op" id="2132653">&lt;&lt;</span><span class="ident" id="2132655">flt</span><span class="op" id="2132658">.</span><span class="ident" id="2132659">mantbits</span>&nbsp;<span class="op" id="2132668">-</span>&nbsp;<span class="num" id="2132670">1</span><span class="op" id="2132671">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132674">bits</span>&nbsp;<span class="op" id="2132679">|=</span>&nbsp;<span class="ident" id="2132682">uint64</span><span class="op" id="2132688">(</span><span class="op" id="2132689">(</span><span class="ident" id="2132690">exp</span><span class="op" id="2132693">-</span><span class="ident" id="2132694">flt</span><span class="op" id="2132697">.</span><span class="ident" id="2132698">bias</span><span class="op" id="2132702">)</span><span class="op" id="2132703">&amp;</span><span class="op" id="2132704">(</span><span class="num" id="2132705">1</span><span class="op" id="2132706">&lt;&lt;</span><span class="ident" id="2132708">flt</span><span class="op" id="2132711">.</span><span class="ident" id="2132712">expbits</span><span class="op" id="2132719">-</span><span class="num" id="2132720">1</span><span class="op" id="2132721">)</span><span class="op" id="2132722">)</span>&nbsp;<span class="op" id="2132724">&lt;&lt;</span>&nbsp;<span class="ident" id="2132727">flt</span><span class="op" id="2132730">.</span><span class="ident" id="2132731">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132741">if</span>&nbsp;<span class="ident" id="2132744">f</span><span class="op" id="2132745">.</span><span class="ident" id="2132746">neg</span>&nbsp;<span class="op" id="2132750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132754">bits</span>&nbsp;<span class="op" id="2132759">|=</span>&nbsp;<span class="num" id="2132762">1</span>&nbsp;<span class="op" id="2132764">&lt;&lt;</span>&nbsp;<span class="op" id="2132767">(</span><span class="ident" id="2132768">flt</span><span class="op" id="2132771">.</span><span class="ident" id="2132772">mantbits</span>&nbsp;<span class="op" id="2132781">+</span>&nbsp;<span class="ident" id="2132783">flt</span><span class="op" id="2132786">.</span><span class="ident" id="2132787">expbits</span><span class="op" id="2132794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132800">return</span><br>
<span class="lineno">170</span><span class="op" id="2132807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2132810">//&nbsp;AssignComputeBounds&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;floating&nbsp;point&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2132868">//&nbsp;defined&nbsp;by&nbsp;mant,&nbsp;exp&nbsp;and&nbsp;precision&nbsp;given&nbsp;by&nbsp;flt.&nbsp;It&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2132931">//&nbsp;lower,&nbsp;upper&nbsp;such&nbsp;that&nbsp;any&nbsp;number&nbsp;in&nbsp;the&nbsp;closed&nbsp;interval</span><br>
<span class="lineno">175</span><span class="comment" id="2132991">//&nbsp;[lower,&nbsp;upper]&nbsp;is&nbsp;converted&nbsp;back&nbsp;to&nbsp;the&nbsp;same&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="2133062">func</span>&nbsp;<span class="op" id="2133067">(</span><span class="ident" id="2133068">f</span>&nbsp;<span class="op" id="2133070">*</span><span class="ident" id="2133071">extFloat</span><span class="op" id="2133079">)</span>&nbsp;<span class="ident" id="2133081">AssignComputeBounds</span><span class="op" id="2133100">(</span><span class="ident" id="2133101">mant</span>&nbsp;<span class="ident" id="2133106">uint64</span><span class="op" id="2133112">,</span>&nbsp;<span class="ident" id="2133114">exp</span>&nbsp;<span class="builtintype" id="2133118">int</span><span class="op" id="2133121">,</span>&nbsp;<span class="ident" id="2133123">neg</span>&nbsp;<span class="builtintype" id="2133127">bool</span><span class="op" id="2133131">,</span>&nbsp;<span class="ident" id="2133133">flt</span>&nbsp;<span class="op" id="2133137">*</span><span class="ident" id="2133138">floatInfo</span><span class="op" id="2133147">)</span>&nbsp;<span class="op" id="2133149">(</span><span class="ident" id="2133150">lower</span><span class="op" id="2133155">,</span>&nbsp;<span class="ident" id="2133157">upper</span>&nbsp;<span class="ident" id="2133163">extFloat</span><span class="op" id="2133171">)</span>&nbsp;<span class="op" id="2133173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133176">f</span><span class="op" id="2133177">.</span><span class="ident" id="2133178">mant</span>&nbsp;<span class="op" id="2133183">=</span>&nbsp;<span class="ident" id="2133185">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133191">f</span><span class="op" id="2133192">.</span><span class="ident" id="2133193">exp</span>&nbsp;<span class="op" id="2133197">=</span>&nbsp;<span class="ident" id="2133199">exp</span>&nbsp;<span class="op" id="2133203">-</span>&nbsp;<span class="builtintype" id="2133205">int</span><span class="op" id="2133208">(</span><span class="ident" id="2133209">flt</span><span class="op" id="2133212">.</span><span class="ident" id="2133213">mantbits</span><span class="op" id="2133221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133224">f</span><span class="op" id="2133225">.</span><span class="ident" id="2133226">neg</span>&nbsp;<span class="op" id="2133230">=</span>&nbsp;<span class="ident" id="2133232">neg</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2133237">if</span>&nbsp;<span class="ident" id="2133240">f</span><span class="op" id="2133241">.</span><span class="ident" id="2133242">exp</span>&nbsp;<span class="op" id="2133246">&lt;=</span>&nbsp;<span class="num" id="2133249">0</span>&nbsp;<span class="op" id="2133251">&amp;&amp;</span>&nbsp;<span class="ident" id="2133254">mant</span>&nbsp;<span class="op" id="2133259">==</span>&nbsp;<span class="op" id="2133262">(</span><span class="ident" id="2133263">mant</span><span class="op" id="2133267">&gt;&gt;</span><span class="builtintype" id="2133269">uint</span><span class="op" id="2133273">(</span><span class="op" id="2133274">-</span><span class="ident" id="2133275">f</span><span class="op" id="2133276">.</span><span class="ident" id="2133277">exp</span><span class="op" id="2133280">)</span><span class="op" id="2133281">)</span><span class="op" id="2133282">&lt;&lt;</span><span class="builtintype" id="2133284">uint</span><span class="op" id="2133288">(</span><span class="op" id="2133289">-</span><span class="ident" id="2133290">f</span><span class="op" id="2133291">.</span><span class="ident" id="2133292">exp</span><span class="op" id="2133295">)</span>&nbsp;<span class="op" id="2133297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2133301">//&nbsp;An&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133323">f</span><span class="op" id="2133324">.</span><span class="ident" id="2133325">mant</span>&nbsp;<span class="op" id="2133330">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2133334">uint</span><span class="op" id="2133338">(</span><span class="op" id="2133339">-</span><span class="ident" id="2133340">f</span><span class="op" id="2133341">.</span><span class="ident" id="2133342">exp</span><span class="op" id="2133345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133349">f</span><span class="op" id="2133350">.</span><span class="ident" id="2133351">exp</span>&nbsp;<span class="op" id="2133355">=</span>&nbsp;<span class="num" id="2133357">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2133361">return</span>&nbsp;<span class="op" id="2133368">*</span><span class="ident" id="2133369">f</span><span class="op" id="2133370">,</span>&nbsp;<span class="op" id="2133372">*</span><span class="ident" id="2133373">f</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2133376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133379">expBiased</span>&nbsp;<span class="op" id="2133389">:=</span>&nbsp;<span class="ident" id="2133392">exp</span>&nbsp;<span class="op" id="2133396">-</span>&nbsp;<span class="ident" id="2133398">flt</span><span class="op" id="2133401">.</span><span class="ident" id="2133402">bias</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133409">upper</span>&nbsp;<span class="op" id="2133415">=</span>&nbsp;<span class="ident" id="2133417">extFloat</span><span class="op" id="2133425">{</span><span class="ident" id="2133426">mant</span><span class="op" id="2133430">:</span>&nbsp;<span class="num" id="2133432">2</span><span class="op" id="2133433">*</span><span class="ident" id="2133434">f</span><span class="op" id="2133435">.</span><span class="ident" id="2133436">mant</span>&nbsp;<span class="op" id="2133441">+</span>&nbsp;<span class="num" id="2133443">1</span><span class="op" id="2133444">,</span>&nbsp;<span class="ident" id="2133446">exp</span><span class="op" id="2133449">:</span>&nbsp;<span class="ident" id="2133451">f</span><span class="op" id="2133452">.</span><span class="ident" id="2133453">exp</span>&nbsp;<span class="op" id="2133457">-</span>&nbsp;<span class="num" id="2133459">1</span><span class="op" id="2133460">,</span>&nbsp;<span class="ident" id="2133462">neg</span><span class="op" id="2133465">:</span>&nbsp;<span class="ident" id="2133467">f</span><span class="op" id="2133468">.</span><span class="ident" id="2133469">neg</span><span class="op" id="2133472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2133475">if</span>&nbsp;<span class="ident" id="2133478">mant</span>&nbsp;<span class="op" id="2133483">!=</span>&nbsp;<span class="num" id="2133486">1</span><span class="op" id="2133487">&lt;&lt;</span><span class="ident" id="2133489">flt</span><span class="op" id="2133492">.</span><span class="ident" id="2133493">mantbits</span>&nbsp;<span class="op" id="2133502">||</span>&nbsp;<span class="ident" id="2133505">expBiased</span>&nbsp;<span class="op" id="2133515">==</span>&nbsp;<span class="num" id="2133518">1</span>&nbsp;<span class="op" id="2133520">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133524">lower</span>&nbsp;<span class="op" id="2133530">=</span>&nbsp;<span class="ident" id="2133532">extFloat</span><span class="op" id="2133540">{</span><span class="ident" id="2133541">mant</span><span class="op" id="2133545">:</span>&nbsp;<span class="num" id="2133547">2</span><span class="op" id="2133548">*</span><span class="ident" id="2133549">f</span><span class="op" id="2133550">.</span><span class="ident" id="2133551">mant</span>&nbsp;<span class="op" id="2133556">-</span>&nbsp;<span class="num" id="2133558">1</span><span class="op" id="2133559">,</span>&nbsp;<span class="ident" id="2133561">exp</span><span class="op" id="2133564">:</span>&nbsp;<span class="ident" id="2133566">f</span><span class="op" id="2133567">.</span><span class="ident" id="2133568">exp</span>&nbsp;<span class="op" id="2133572">-</span>&nbsp;<span class="num" id="2133574">1</span><span class="op" id="2133575">,</span>&nbsp;<span class="ident" id="2133577">neg</span><span class="op" id="2133580">:</span>&nbsp;<span class="ident" id="2133582">f</span><span class="op" id="2133583">.</span><span class="ident" id="2133584">neg</span><span class="op" id="2133587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2133590">}</span>&nbsp;<span class="keyword" id="2133592">else</span>&nbsp;<span class="op" id="2133597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133601">lower</span>&nbsp;<span class="op" id="2133607">=</span>&nbsp;<span class="ident" id="2133609">extFloat</span><span class="op" id="2133617">{</span><span class="ident" id="2133618">mant</span><span class="op" id="2133622">:</span>&nbsp;<span class="num" id="2133624">4</span><span class="op" id="2133625">*</span><span class="ident" id="2133626">f</span><span class="op" id="2133627">.</span><span class="ident" id="2133628">mant</span>&nbsp;<span class="op" id="2133633">-</span>&nbsp;<span class="num" id="2133635">1</span><span class="op" id="2133636">,</span>&nbsp;<span class="ident" id="2133638">exp</span><span class="op" id="2133641">:</span>&nbsp;<span class="ident" id="2133643">f</span><span class="op" id="2133644">.</span><span class="ident" id="2133645">exp</span>&nbsp;<span class="op" id="2133649">-</span>&nbsp;<span class="num" id="2133651">2</span><span class="op" id="2133652">,</span>&nbsp;<span class="ident" id="2133654">neg</span><span class="op" id="2133657">:</span>&nbsp;<span class="ident" id="2133659">f</span><span class="op" id="2133660">.</span><span class="ident" id="2133661">neg</span><span class="op" id="2133664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2133667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2133670">return</span><br>
<span class="lineno">195</span><span class="op" id="2133677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2133680">//&nbsp;Normalize&nbsp;normalizes&nbsp;f&nbsp;so&nbsp;that&nbsp;the&nbsp;highest&nbsp;bit&nbsp;of&nbsp;the&nbsp;mantissa&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2133749">//&nbsp;set,&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;by&nbsp;which&nbsp;the&nbsp;mantissa&nbsp;was&nbsp;left-shifted.</span><br>
<span class="lineno"></span><span class="keyword" id="2133820">func</span>&nbsp;<span class="op" id="2133825">(</span><span class="ident" id="2133826">f</span>&nbsp;<span class="op" id="2133828">*</span><span class="ident" id="2133829">extFloat</span><span class="op" id="2133837">)</span>&nbsp;<span class="ident" id="2133839">Normalize</span><span class="op" id="2133848">(</span><span class="op" id="2133849">)</span>&nbsp;<span class="op" id="2133851">(</span><span class="ident" id="2133852">shift</span>&nbsp;<span class="builtintype" id="2133858">uint</span><span class="op" id="2133862">)</span>&nbsp;<span class="op" id="2133864">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133867">mant</span><span class="op" id="2133871">,</span>&nbsp;<span class="ident" id="2133873">exp</span>&nbsp;<span class="op" id="2133877">:=</span>&nbsp;<span class="ident" id="2133880">f</span><span class="op" id="2133881">.</span><span class="ident" id="2133882">mant</span><span class="op" id="2133886">,</span>&nbsp;<span class="ident" id="2133888">f</span><span class="op" id="2133889">.</span><span class="ident" id="2133890">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2133895">if</span>&nbsp;<span class="ident" id="2133898">mant</span>&nbsp;<span class="op" id="2133903">==</span>&nbsp;<span class="num" id="2133906">0</span>&nbsp;<span class="op" id="2133908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2133912">return</span>&nbsp;<span class="num" id="2133919">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2133922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2133925">if</span>&nbsp;<span class="ident" id="2133928">mant</span><span class="op" id="2133932">&gt;&gt;</span><span class="op" id="2133934">(</span><span class="num" id="2133935">64</span><span class="op" id="2133937">-</span><span class="num" id="2133938">32</span><span class="op" id="2133940">)</span>&nbsp;<span class="op" id="2133942">==</span>&nbsp;<span class="num" id="2133945">0</span>&nbsp;<span class="op" id="2133947">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133951">mant</span>&nbsp;<span class="op" id="2133956">&lt;&lt;=</span>&nbsp;<span class="num" id="2133960">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2133965">exp</span>&nbsp;<span class="op" id="2133969">-=</span>&nbsp;<span class="num" id="2133972">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2133976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2133979">if</span>&nbsp;<span class="ident" id="2133982">mant</span><span class="op" id="2133986">&gt;&gt;</span><span class="op" id="2133988">(</span><span class="num" id="2133989">64</span><span class="op" id="2133991">-</span><span class="num" id="2133992">16</span><span class="op" id="2133994">)</span>&nbsp;<span class="op" id="2133996">==</span>&nbsp;<span class="num" id="2133999">0</span>&nbsp;<span class="op" id="2134001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134005">mant</span>&nbsp;<span class="op" id="2134010">&lt;&lt;=</span>&nbsp;<span class="num" id="2134014">16</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134019">exp</span>&nbsp;<span class="op" id="2134023">-=</span>&nbsp;<span class="num" id="2134026">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2134030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2134033">if</span>&nbsp;<span class="ident" id="2134036">mant</span><span class="op" id="2134040">&gt;&gt;</span><span class="op" id="2134042">(</span><span class="num" id="2134043">64</span><span class="op" id="2134045">-</span><span class="num" id="2134046">8</span><span class="op" id="2134047">)</span>&nbsp;<span class="op" id="2134049">==</span>&nbsp;<span class="num" id="2134052">0</span>&nbsp;<span class="op" id="2134054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134058">mant</span>&nbsp;<span class="op" id="2134063">&lt;&lt;=</span>&nbsp;<span class="num" id="2134067">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134071">exp</span>&nbsp;<span class="op" id="2134075">-=</span>&nbsp;<span class="num" id="2134078">8</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2134081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2134084">if</span>&nbsp;<span class="ident" id="2134087">mant</span><span class="op" id="2134091">&gt;&gt;</span><span class="op" id="2134093">(</span><span class="num" id="2134094">64</span><span class="op" id="2134096">-</span><span class="num" id="2134097">4</span><span class="op" id="2134098">)</span>&nbsp;<span class="op" id="2134100">==</span>&nbsp;<span class="num" id="2134103">0</span>&nbsp;<span class="op" id="2134105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134109">mant</span>&nbsp;<span class="op" id="2134114">&lt;&lt;=</span>&nbsp;<span class="num" id="2134118">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134122">exp</span>&nbsp;<span class="op" id="2134126">-=</span>&nbsp;<span class="num" id="2134129">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2134132">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2134135">if</span>&nbsp;<span class="ident" id="2134138">mant</span><span class="op" id="2134142">&gt;&gt;</span><span class="op" id="2134144">(</span><span class="num" id="2134145">64</span><span class="op" id="2134147">-</span><span class="num" id="2134148">2</span><span class="op" id="2134149">)</span>&nbsp;<span class="op" id="2134151">==</span>&nbsp;<span class="num" id="2134154">0</span>&nbsp;<span class="op" id="2134156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134160">mant</span>&nbsp;<span class="op" id="2134165">&lt;&lt;=</span>&nbsp;<span class="num" id="2134169">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134173">exp</span>&nbsp;<span class="op" id="2134177">-=</span>&nbsp;<span class="num" id="2134180">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2134183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2134186">if</span>&nbsp;<span class="ident" id="2134189">mant</span><span class="op" id="2134193">&gt;&gt;</span><span class="op" id="2134195">(</span><span class="num" id="2134196">64</span><span class="op" id="2134198">-</span><span class="num" id="2134199">1</span><span class="op" id="2134200">)</span>&nbsp;<span class="op" id="2134202">==</span>&nbsp;<span class="num" id="2134205">0</span>&nbsp;<span class="op" id="2134207">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134211">mant</span>&nbsp;<span class="op" id="2134216">&lt;&lt;=</span>&nbsp;<span class="num" id="2134220">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134224">exp</span>&nbsp;<span class="op" id="2134228">-=</span>&nbsp;<span class="num" id="2134231">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2134234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134237">shift</span>&nbsp;<span class="op" id="2134243">=</span>&nbsp;<span class="builtintype" id="2134245">uint</span><span class="op" id="2134249">(</span><span class="ident" id="2134250">f</span><span class="op" id="2134251">.</span><span class="ident" id="2134252">exp</span>&nbsp;<span class="op" id="2134256">-</span>&nbsp;<span class="ident" id="2134258">exp</span><span class="op" id="2134261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134264">f</span><span class="op" id="2134265">.</span><span class="ident" id="2134266">mant</span><span class="op" id="2134270">,</span>&nbsp;<span class="ident" id="2134272">f</span><span class="op" id="2134273">.</span><span class="ident" id="2134274">exp</span>&nbsp;<span class="op" id="2134278">=</span>&nbsp;<span class="ident" id="2134280">mant</span><span class="op" id="2134284">,</span>&nbsp;<span class="ident" id="2134286">exp</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2134291">return</span><br>
<span class="lineno"></span><span class="op" id="2134298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2134301">//&nbsp;Multiply&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;product&nbsp;f*g:&nbsp;the&nbsp;result&nbsp;is&nbsp;correctly&nbsp;rounded,</span><br>
<span class="lineno"></span><span class="comment" id="2134373">//&nbsp;but&nbsp;not&nbsp;normalized.</span><br>
<span class="lineno">235</span><span class="keyword" id="2134396">func</span>&nbsp;<span class="op" id="2134401">(</span><span class="ident" id="2134402">f</span>&nbsp;<span class="op" id="2134404">*</span><span class="ident" id="2134405">extFloat</span><span class="op" id="2134413">)</span>&nbsp;<span class="ident" id="2134415">Multiply</span><span class="op" id="2134423">(</span><span class="ident" id="2134424">g</span>&nbsp;<span class="ident" id="2134426">extFloat</span><span class="op" id="2134434">)</span>&nbsp;<span class="op" id="2134436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134439">fhi</span><span class="op" id="2134442">,</span>&nbsp;<span class="ident" id="2134444">flo</span>&nbsp;<span class="op" id="2134448">:=</span>&nbsp;<span class="ident" id="2134451">f</span><span class="op" id="2134452">.</span><span class="ident" id="2134453">mant</span><span class="op" id="2134457">&gt;&gt;</span><span class="num" id="2134459">32</span><span class="op" id="2134461">,</span>&nbsp;<span class="ident" id="2134463">uint64</span><span class="op" id="2134469">(</span><span class="builtintype" id="2134470">uint32</span><span class="op" id="2134476">(</span><span class="ident" id="2134477">f</span><span class="op" id="2134478">.</span><span class="ident" id="2134479">mant</span><span class="op" id="2134483">)</span><span class="op" id="2134484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134487">ghi</span><span class="op" id="2134490">,</span>&nbsp;<span class="ident" id="2134492">glo</span>&nbsp;<span class="op" id="2134496">:=</span>&nbsp;<span class="ident" id="2134499">g</span><span class="op" id="2134500">.</span><span class="ident" id="2134501">mant</span><span class="op" id="2134505">&gt;&gt;</span><span class="num" id="2134507">32</span><span class="op" id="2134509">,</span>&nbsp;<span class="ident" id="2134511">uint64</span><span class="op" id="2134517">(</span><span class="builtintype" id="2134518">uint32</span><span class="op" id="2134524">(</span><span class="ident" id="2134525">g</span><span class="op" id="2134526">.</span><span class="ident" id="2134527">mant</span><span class="op" id="2134531">)</span><span class="op" id="2134532">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2134536">//&nbsp;Cross&nbsp;products.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134556">cross1</span>&nbsp;<span class="op" id="2134563">:=</span>&nbsp;<span class="ident" id="2134566">fhi</span>&nbsp;<span class="op" id="2134570">*</span>&nbsp;<span class="ident" id="2134572">glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134577">cross2</span>&nbsp;<span class="op" id="2134584">:=</span>&nbsp;<span class="ident" id="2134587">flo</span>&nbsp;<span class="op" id="2134591">*</span>&nbsp;<span class="ident" id="2134593">ghi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2134599">//&nbsp;f.mant*g.mant&nbsp;is&nbsp;fhi*ghi&nbsp;&lt;&lt;&nbsp;64&nbsp;+&nbsp;(cross1+cross2)&nbsp;&lt;&lt;&nbsp;32&nbsp;+&nbsp;flo*glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134668">f</span><span class="op" id="2134669">.</span><span class="ident" id="2134670">mant</span>&nbsp;<span class="op" id="2134675">=</span>&nbsp;<span class="ident" id="2134677">fhi</span><span class="op" id="2134680">*</span><span class="ident" id="2134681">ghi</span>&nbsp;<span class="op" id="2134685">+</span>&nbsp;<span class="op" id="2134687">(</span><span class="ident" id="2134688">cross1</span>&nbsp;<span class="op" id="2134695">&gt;&gt;</span>&nbsp;<span class="num" id="2134698">32</span><span class="op" id="2134700">)</span>&nbsp;<span class="op" id="2134702">+</span>&nbsp;<span class="op" id="2134704">(</span><span class="ident" id="2134705">cross2</span>&nbsp;<span class="op" id="2134712">&gt;&gt;</span>&nbsp;<span class="num" id="2134715">32</span><span class="op" id="2134717">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134720">rem</span>&nbsp;<span class="op" id="2134724">:=</span>&nbsp;<span class="ident" id="2134727">uint64</span><span class="op" id="2134733">(</span><span class="builtintype" id="2134734">uint32</span><span class="op" id="2134740">(</span><span class="ident" id="2134741">cross1</span><span class="op" id="2134747">)</span><span class="op" id="2134748">)</span>&nbsp;<span class="op" id="2134750">+</span>&nbsp;<span class="ident" id="2134752">uint64</span><span class="op" id="2134758">(</span><span class="builtintype" id="2134759">uint32</span><span class="op" id="2134765">(</span><span class="ident" id="2134766">cross2</span><span class="op" id="2134772">)</span><span class="op" id="2134773">)</span>&nbsp;<span class="op" id="2134775">+</span>&nbsp;<span class="op" id="2134777">(</span><span class="op" id="2134778">(</span><span class="ident" id="2134779">flo</span>&nbsp;<span class="op" id="2134783">*</span>&nbsp;<span class="ident" id="2134785">glo</span><span class="op" id="2134788">)</span>&nbsp;<span class="op" id="2134790">&gt;&gt;</span>&nbsp;<span class="num" id="2134793">32</span><span class="op" id="2134795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2134798">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134812">rem</span>&nbsp;<span class="op" id="2134816">+=</span>&nbsp;<span class="op" id="2134819">(</span><span class="num" id="2134820">1</span>&nbsp;<span class="op" id="2134822">&lt;&lt;</span>&nbsp;<span class="num" id="2134825">31</span><span class="op" id="2134827">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134831">f</span><span class="op" id="2134832">.</span><span class="ident" id="2134833">mant</span>&nbsp;<span class="op" id="2134838">+=</span>&nbsp;<span class="op" id="2134841">(</span><span class="ident" id="2134842">rem</span>&nbsp;<span class="op" id="2134846">&gt;&gt;</span>&nbsp;<span class="num" id="2134849">32</span><span class="op" id="2134851">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2134854">f</span><span class="op" id="2134855">.</span><span class="ident" id="2134856">exp</span>&nbsp;<span class="op" id="2134860">=</span>&nbsp;<span class="ident" id="2134862">f</span><span class="op" id="2134863">.</span><span class="ident" id="2134864">exp</span>&nbsp;<span class="op" id="2134868">+</span>&nbsp;<span class="ident" id="2134870">g</span><span class="op" id="2134871">.</span><span class="ident" id="2134872">exp</span>&nbsp;<span class="op" id="2134876">+</span>&nbsp;<span class="num" id="2134878">64</span><br>
<span class="lineno"></span><span class="op" id="2134881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2134884">var</span>&nbsp;<span class="ident" id="2134888">uint64pow10</span>&nbsp;<span class="op" id="2134900">=</span>&nbsp;<span class="op" id="2134902">[</span><span class="op" id="2134903">...</span><span class="op" id="2134906">]</span><span class="ident" id="2134907">uint64</span><span class="op" id="2134913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2134916">1</span><span class="op" id="2134917">,</span>&nbsp;<span class="num" id="2134919">1e1</span><span class="op" id="2134922">,</span>&nbsp;<span class="num" id="2134924">1e2</span><span class="op" id="2134927">,</span>&nbsp;<span class="num" id="2134929">1e3</span><span class="op" id="2134932">,</span>&nbsp;<span class="num" id="2134934">1e4</span><span class="op" id="2134937">,</span>&nbsp;<span class="num" id="2134939">1e5</span><span class="op" id="2134942">,</span>&nbsp;<span class="num" id="2134944">1e6</span><span class="op" id="2134947">,</span>&nbsp;<span class="num" id="2134949">1e7</span><span class="op" id="2134952">,</span>&nbsp;<span class="num" id="2134954">1e8</span><span class="op" id="2134957">,</span>&nbsp;<span class="num" id="2134959">1e9</span><span class="op" id="2134962">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2134965">1e10</span><span class="op" id="2134969">,</span>&nbsp;<span class="num" id="2134971">1e11</span><span class="op" id="2134975">,</span>&nbsp;<span class="num" id="2134977">1e12</span><span class="op" id="2134981">,</span>&nbsp;<span class="num" id="2134983">1e13</span><span class="op" id="2134987">,</span>&nbsp;<span class="num" id="2134989">1e14</span><span class="op" id="2134993">,</span>&nbsp;<span class="num" id="2134995">1e15</span><span class="op" id="2134999">,</span>&nbsp;<span class="num" id="2135001">1e16</span><span class="op" id="2135005">,</span>&nbsp;<span class="num" id="2135007">1e17</span><span class="op" id="2135011">,</span>&nbsp;<span class="num" id="2135013">1e18</span><span class="op" id="2135017">,</span>&nbsp;<span class="num" id="2135019">1e19</span><span class="op" id="2135023">,</span><br>
<span class="lineno"></span><span class="op" id="2135025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2135028">//&nbsp;AssignDecimal&nbsp;sets&nbsp;f&nbsp;to&nbsp;an&nbsp;approximate&nbsp;value&nbsp;mantissa*10^exp.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2135096">//&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;f&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="2135166">//&nbsp;best&nbsp;approximation&nbsp;of&nbsp;d&nbsp;after&nbsp;being&nbsp;rounded&nbsp;to&nbsp;a&nbsp;float64&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2135229">//&nbsp;float32&nbsp;depending&nbsp;on&nbsp;flt.</span><br>
<span class="lineno"></span><span class="keyword" id="2135258">func</span>&nbsp;<span class="op" id="2135263">(</span><span class="ident" id="2135264">f</span>&nbsp;<span class="op" id="2135266">*</span><span class="ident" id="2135267">extFloat</span><span class="op" id="2135275">)</span>&nbsp;<span class="ident" id="2135277">AssignDecimal</span><span class="op" id="2135290">(</span><span class="ident" id="2135291">mantissa</span>&nbsp;<span class="ident" id="2135300">uint64</span><span class="op" id="2135306">,</span>&nbsp;<span class="ident" id="2135308">exp10</span>&nbsp;<span class="builtintype" id="2135314">int</span><span class="op" id="2135317">,</span>&nbsp;<span class="ident" id="2135319">neg</span>&nbsp;<span class="builtintype" id="2135323">bool</span><span class="op" id="2135327">,</span>&nbsp;<span class="ident" id="2135329">trunc</span>&nbsp;<span class="builtintype" id="2135335">bool</span><span class="op" id="2135339">,</span>&nbsp;<span class="ident" id="2135341">flt</span>&nbsp;<span class="op" id="2135345">*</span><span class="ident" id="2135346">floatInfo</span><span class="op" id="2135355">)</span>&nbsp;<span class="op" id="2135357">(</span><span class="ident" id="2135358">ok</span>&nbsp;<span class="builtintype" id="2135361">bool</span><span class="op" id="2135365">)</span>&nbsp;<span class="op" id="2135367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2135370">const</span>&nbsp;<span class="ident" id="2135376">uint64digits</span>&nbsp;<span class="op" id="2135389">=</span>&nbsp;<span class="num" id="2135391">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2135395">const</span>&nbsp;<span class="ident" id="2135401">errorscale</span>&nbsp;<span class="op" id="2135412">=</span>&nbsp;<span class="num" id="2135414">8</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2135417">errors</span>&nbsp;<span class="op" id="2135424">:=</span>&nbsp;<span class="num" id="2135427">0</span>&nbsp;<span class="comment" id="2135429">//&nbsp;An&nbsp;upper&nbsp;bound&nbsp;for&nbsp;error,&nbsp;computed&nbsp;in&nbsp;errorscale*ulp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2135487">if</span>&nbsp;<span class="ident" id="2135490">trunc</span>&nbsp;<span class="op" id="2135496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2135500">//&nbsp;the&nbsp;decimal&nbsp;number&nbsp;was&nbsp;truncated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2135539">errors</span>&nbsp;<span class="op" id="2135546">+=</span>&nbsp;<span class="ident" id="2135549">errorscale</span>&nbsp;<span class="op" id="2135560">/</span>&nbsp;<span class="num" id="2135562">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2135565">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2135569">f</span><span class="op" id="2135570">.</span><span class="ident" id="2135571">mant</span>&nbsp;<span class="op" id="2135576">=</span>&nbsp;<span class="ident" id="2135578">mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2135588">f</span><span class="op" id="2135589">.</span><span class="ident" id="2135590">exp</span>&nbsp;<span class="op" id="2135594">=</span>&nbsp;<span class="num" id="2135596">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2135599">f</span><span class="op" id="2135600">.</span><span class="ident" id="2135601">neg</span>&nbsp;<span class="op" id="2135605">=</span>&nbsp;<span class="ident" id="2135607">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2135613">//&nbsp;Multiply&nbsp;by&nbsp;powers&nbsp;of&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2135644">i</span>&nbsp;<span class="op" id="2135646">:=</span>&nbsp;<span class="op" id="2135649">(</span><span class="ident" id="2135650">exp10</span>&nbsp;<span class="op" id="2135656">-</span>&nbsp;<span class="ident" id="2135658">firstPowerOfTen</span><span class="op" id="2135673">)</span>&nbsp;<span class="op" id="2135675">/</span>&nbsp;<span class="ident" id="2135677">stepPowerOfTen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2135693">if</span>&nbsp;<span class="ident" id="2135696">exp10</span>&nbsp;<span class="op" id="2135702">&lt;</span>&nbsp;<span class="ident" id="2135704">firstPowerOfTen</span>&nbsp;<span class="op" id="2135720">||</span>&nbsp;<span class="ident" id="2135723">i</span>&nbsp;<span class="op" id="2135725">&gt;=</span>&nbsp;<span class="builtinfunc" id="2135728">len</span><span class="op" id="2135731">(</span><span class="ident" id="2135732">powersOfTen</span><span class="op" id="2135743">)</span>&nbsp;<span class="op" id="2135745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2135749">return</span>&nbsp;<span class="ident" id="2135756">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2135763">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2135766">adjExp</span>&nbsp;<span class="op" id="2135773">:=</span>&nbsp;<span class="op" id="2135776">(</span><span class="ident" id="2135777">exp10</span>&nbsp;<span class="op" id="2135783">-</span>&nbsp;<span class="ident" id="2135785">firstPowerOfTen</span><span class="op" id="2135800">)</span>&nbsp;<span class="op" id="2135802">%</span>&nbsp;<span class="ident" id="2135804">stepPowerOfTen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2135821">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;exp%step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2135849">if</span>&nbsp;<span class="ident" id="2135852">adjExp</span>&nbsp;<span class="op" id="2135859">&lt;</span>&nbsp;<span class="ident" id="2135861">uint64digits</span>&nbsp;<span class="op" id="2135874">&amp;&amp;</span>&nbsp;<span class="ident" id="2135877">mantissa</span>&nbsp;<span class="op" id="2135886">&lt;</span>&nbsp;<span class="ident" id="2135888">uint64pow10</span><span class="op" id="2135899">[</span><span class="ident" id="2135900">uint64digits</span><span class="op" id="2135912">-</span><span class="ident" id="2135913">adjExp</span><span class="op" id="2135919">]</span>&nbsp;<span class="op" id="2135921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2135925">//&nbsp;We&nbsp;can&nbsp;multiply&nbsp;the&nbsp;mantissa&nbsp;exactly.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2135968">f</span><span class="op" id="2135969">.</span><span class="ident" id="2135970">mant</span>&nbsp;<span class="op" id="2135975">*=</span>&nbsp;<span class="ident" id="2135978">uint64pow10</span><span class="op" id="2135989">[</span><span class="ident" id="2135990">adjExp</span><span class="op" id="2135996">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136000">f</span><span class="op" id="2136001">.</span><span class="ident" id="2136002">Normalize</span><span class="op" id="2136011">(</span><span class="op" id="2136012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136015">}</span>&nbsp;<span class="keyword" id="2136017">else</span>&nbsp;<span class="op" id="2136022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136026">f</span><span class="op" id="2136027">.</span><span class="ident" id="2136028">Normalize</span><span class="op" id="2136037">(</span><span class="op" id="2136038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136042">f</span><span class="op" id="2136043">.</span><span class="ident" id="2136044">Multiply</span><span class="op" id="2136052">(</span><span class="ident" id="2136053">smallPowersOfTen</span><span class="op" id="2136069">[</span><span class="ident" id="2136070">adjExp</span><span class="op" id="2136076">]</span><span class="op" id="2136077">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136081">errors</span>&nbsp;<span class="op" id="2136088">+=</span>&nbsp;<span class="ident" id="2136091">errorscale</span>&nbsp;<span class="op" id="2136102">/</span>&nbsp;<span class="num" id="2136104">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2136111">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;10&nbsp;to&nbsp;the&nbsp;exp&nbsp;-&nbsp;exp%step.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136156">f</span><span class="op" id="2136157">.</span><span class="ident" id="2136158">Multiply</span><span class="op" id="2136166">(</span><span class="ident" id="2136167">powersOfTen</span><span class="op" id="2136178">[</span><span class="ident" id="2136179">i</span><span class="op" id="2136180">]</span><span class="op" id="2136181">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2136184">if</span>&nbsp;<span class="ident" id="2136187">errors</span>&nbsp;<span class="op" id="2136194">&gt;</span>&nbsp;<span class="num" id="2136196">0</span>&nbsp;<span class="op" id="2136198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136202">errors</span>&nbsp;<span class="op" id="2136209">+=</span>&nbsp;<span class="num" id="2136212">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136218">errors</span>&nbsp;<span class="op" id="2136225">+=</span>&nbsp;<span class="ident" id="2136228">errorscale</span>&nbsp;<span class="op" id="2136239">/</span>&nbsp;<span class="num" id="2136241">2</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2136245">//&nbsp;Normalize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136259">shift</span>&nbsp;<span class="op" id="2136265">:=</span>&nbsp;<span class="ident" id="2136268">f</span><span class="op" id="2136269">.</span><span class="ident" id="2136270">Normalize</span><span class="op" id="2136279">(</span><span class="op" id="2136280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136283">errors</span>&nbsp;<span class="op" id="2136290">&lt;&lt;=</span>&nbsp;<span class="ident" id="2136294">shift</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2136302">//&nbsp;Now&nbsp;f&nbsp;is&nbsp;a&nbsp;good&nbsp;approximation&nbsp;of&nbsp;the&nbsp;decimal.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2136352">//&nbsp;Check&nbsp;whether&nbsp;the&nbsp;error&nbsp;is&nbsp;too&nbsp;large:&nbsp;that&nbsp;is,&nbsp;if&nbsp;the&nbsp;mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2136419">//&nbsp;is&nbsp;perturbated&nbsp;by&nbsp;the&nbsp;error,&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;will&nbsp;change.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2136487">//&nbsp;The&nbsp;64&nbsp;bits&nbsp;mantissa&nbsp;is&nbsp;1&nbsp;+&nbsp;52&nbsp;bits&nbsp;for&nbsp;float64&nbsp;+&nbsp;11&nbsp;extra&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2136556">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2136560">//&nbsp;In&nbsp;many&nbsp;cases&nbsp;the&nbsp;approximation&nbsp;will&nbsp;be&nbsp;good&nbsp;enough.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136617">denormalExp</span>&nbsp;<span class="op" id="2136629">:=</span>&nbsp;<span class="ident" id="2136632">flt</span><span class="op" id="2136635">.</span><span class="ident" id="2136636">bias</span>&nbsp;<span class="op" id="2136641">-</span>&nbsp;<span class="num" id="2136643">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2136647">var</span>&nbsp;<span class="ident" id="2136651">extrabits</span>&nbsp;<span class="builtintype" id="2136661">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2136667">if</span>&nbsp;<span class="ident" id="2136670">f</span><span class="op" id="2136671">.</span><span class="ident" id="2136672">exp</span>&nbsp;<span class="op" id="2136676">&lt;=</span>&nbsp;<span class="ident" id="2136679">denormalExp</span>&nbsp;<span class="op" id="2136691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2136695">//&nbsp;f.mant&nbsp;*&nbsp;2^f.exp&nbsp;is&nbsp;smaller&nbsp;than&nbsp;2^(flt.bias+1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136749">extrabits</span>&nbsp;<span class="op" id="2136759">=</span>&nbsp;<span class="builtintype" id="2136761">uint</span><span class="op" id="2136765">(</span><span class="num" id="2136766">63</span>&nbsp;<span class="op" id="2136769">-</span>&nbsp;<span class="ident" id="2136771">flt</span><span class="op" id="2136774">.</span><span class="ident" id="2136775">mantbits</span>&nbsp;<span class="op" id="2136784">+</span>&nbsp;<span class="num" id="2136786">1</span>&nbsp;<span class="op" id="2136788">+</span>&nbsp;<span class="builtintype" id="2136790">uint</span><span class="op" id="2136794">(</span><span class="ident" id="2136795">denormalExp</span><span class="op" id="2136806">-</span><span class="ident" id="2136807">f</span><span class="op" id="2136808">.</span><span class="ident" id="2136809">exp</span><span class="op" id="2136812">)</span><span class="op" id="2136813">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136816">}</span>&nbsp;<span class="keyword" id="2136818">else</span>&nbsp;<span class="op" id="2136823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136827">extrabits</span>&nbsp;<span class="op" id="2136837">=</span>&nbsp;<span class="builtintype" id="2136839">uint</span><span class="op" id="2136843">(</span><span class="num" id="2136844">63</span>&nbsp;<span class="op" id="2136847">-</span>&nbsp;<span class="ident" id="2136849">flt</span><span class="op" id="2136852">.</span><span class="ident" id="2136853">mantbits</span><span class="op" id="2136861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2136864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136868">halfway</span>&nbsp;<span class="op" id="2136876">:=</span>&nbsp;<span class="ident" id="2136879">uint64</span><span class="op" id="2136885">(</span><span class="num" id="2136886">1</span><span class="op" id="2136887">)</span>&nbsp;<span class="op" id="2136889">&lt;&lt;</span>&nbsp;<span class="op" id="2136892">(</span><span class="ident" id="2136893">extrabits</span>&nbsp;<span class="op" id="2136903">-</span>&nbsp;<span class="num" id="2136905">1</span><span class="op" id="2136906">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2136909">mant_extra</span>&nbsp;<span class="op" id="2136920">:=</span>&nbsp;<span class="ident" id="2136923">f</span><span class="op" id="2136924">.</span><span class="ident" id="2136925">mant</span>&nbsp;<span class="op" id="2136930">&amp;</span>&nbsp;<span class="op" id="2136932">(</span><span class="num" id="2136933">1</span><span class="op" id="2136934">&lt;&lt;</span><span class="ident" id="2136936">extrabits</span>&nbsp;<span class="op" id="2136946">-</span>&nbsp;<span class="num" id="2136948">1</span><span class="op" id="2136949">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2136953">//&nbsp;Do&nbsp;a&nbsp;signed&nbsp;comparison&nbsp;here!&nbsp;If&nbsp;the&nbsp;error&nbsp;estimate&nbsp;could&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2137019">//&nbsp;the&nbsp;mantissa&nbsp;round&nbsp;differently&nbsp;for&nbsp;the&nbsp;conversion&nbsp;to&nbsp;double,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2137084">//&nbsp;then&nbsp;we&nbsp;can&#39;t&nbsp;give&nbsp;a&nbsp;definite&nbsp;answer.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2137126">if</span>&nbsp;<span class="ident" id="2137129">int64</span><span class="op" id="2137134">(</span><span class="ident" id="2137135">halfway</span><span class="op" id="2137142">)</span><span class="op" id="2137143">-</span><span class="ident" id="2137144">int64</span><span class="op" id="2137149">(</span><span class="ident" id="2137150">errors</span><span class="op" id="2137156">)</span>&nbsp;<span class="op" id="2137158">&lt;</span>&nbsp;<span class="ident" id="2137160">int64</span><span class="op" id="2137165">(</span><span class="ident" id="2137166">mant_extra</span><span class="op" id="2137176">)</span>&nbsp;<span class="op" id="2137178">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2137183">int64</span><span class="op" id="2137188">(</span><span class="ident" id="2137189">mant_extra</span><span class="op" id="2137199">)</span>&nbsp;<span class="op" id="2137201">&lt;</span>&nbsp;<span class="ident" id="2137203">int64</span><span class="op" id="2137208">(</span><span class="ident" id="2137209">halfway</span><span class="op" id="2137216">)</span><span class="op" id="2137217">+</span><span class="ident" id="2137218">int64</span><span class="op" id="2137223">(</span><span class="ident" id="2137224">errors</span><span class="op" id="2137230">)</span>&nbsp;<span class="op" id="2137232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2137236">return</span>&nbsp;<span class="ident" id="2137243">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2137250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2137253">return</span>&nbsp;<span class="ident" id="2137260">true</span><br>
<span class="lineno">330</span><span class="op" id="2137265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2137268">//&nbsp;Frexp10&nbsp;is&nbsp;an&nbsp;analogue&nbsp;of&nbsp;math.Frexp&nbsp;for&nbsp;decimal&nbsp;powers.&nbsp;It&nbsp;scales</span><br>
<span class="lineno"></span><span class="comment" id="2137338">//&nbsp;f&nbsp;by&nbsp;an&nbsp;approximate&nbsp;power&nbsp;of&nbsp;ten&nbsp;10^-exp,&nbsp;and&nbsp;returns&nbsp;exp10,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2137405">//&nbsp;that&nbsp;f*10^exp10&nbsp;has&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;the&nbsp;old&nbsp;f,&nbsp;up&nbsp;to&nbsp;an&nbsp;ulp,</span><br>
<span class="lineno">335</span><span class="comment" id="2137471">//&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;index&nbsp;of&nbsp;10^-exp&nbsp;in&nbsp;the&nbsp;powersOfTen&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="2137532">func</span>&nbsp;<span class="op" id="2137537">(</span><span class="ident" id="2137538">f</span>&nbsp;<span class="op" id="2137540">*</span><span class="ident" id="2137541">extFloat</span><span class="op" id="2137549">)</span>&nbsp;<span class="ident" id="2137551">frexp10</span><span class="op" id="2137558">(</span><span class="op" id="2137559">)</span>&nbsp;<span class="op" id="2137561">(</span><span class="ident" id="2137562">exp10</span><span class="op" id="2137567">,</span>&nbsp;<span class="ident" id="2137569">index</span>&nbsp;<span class="builtintype" id="2137575">int</span><span class="op" id="2137578">)</span>&nbsp;<span class="op" id="2137580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2137583">//&nbsp;The&nbsp;constants&nbsp;expMin&nbsp;and&nbsp;expMax&nbsp;constrain&nbsp;the&nbsp;final&nbsp;value&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2137652">//&nbsp;binary&nbsp;exponent&nbsp;of&nbsp;f.&nbsp;We&nbsp;want&nbsp;a&nbsp;small&nbsp;integral&nbsp;part&nbsp;in&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2137722">//&nbsp;because&nbsp;finding&nbsp;digits&nbsp;of&nbsp;an&nbsp;integer&nbsp;requires&nbsp;divisions,&nbsp;whereas</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2137791">//&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part&nbsp;can&nbsp;be&nbsp;found&nbsp;by&nbsp;repeatedly&nbsp;multiplying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2137864">//&nbsp;by&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2137875">const</span>&nbsp;<span class="ident" id="2137881">expMin</span>&nbsp;<span class="op" id="2137888">=</span>&nbsp;<span class="op" id="2137890">-</span><span class="num" id="2137891">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2137895">const</span>&nbsp;<span class="ident" id="2137901">expMax</span>&nbsp;<span class="op" id="2137908">=</span>&nbsp;<span class="op" id="2137910">-</span><span class="num" id="2137911">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2137915">//&nbsp;Find&nbsp;power&nbsp;of&nbsp;ten&nbsp;such&nbsp;that&nbsp;x&nbsp;*&nbsp;10^n&nbsp;has&nbsp;a&nbsp;binary&nbsp;exponent</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2137978">//&nbsp;between&nbsp;expMin&nbsp;and&nbsp;expMax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138009">approxExp10</span>&nbsp;<span class="op" id="2138021">:=</span>&nbsp;<span class="op" id="2138024">(</span><span class="op" id="2138025">(</span><span class="ident" id="2138026">expMin</span><span class="op" id="2138032">+</span><span class="ident" id="2138033">expMax</span><span class="op" id="2138039">)</span><span class="op" id="2138040">/</span><span class="num" id="2138041">2</span>&nbsp;<span class="op" id="2138043">-</span>&nbsp;<span class="ident" id="2138045">f</span><span class="op" id="2138046">.</span><span class="ident" id="2138047">exp</span><span class="op" id="2138050">)</span>&nbsp;<span class="op" id="2138052">*</span>&nbsp;<span class="num" id="2138054">28</span>&nbsp;<span class="op" id="2138057">/</span>&nbsp;<span class="num" id="2138059">93</span>&nbsp;<span class="comment" id="2138062">//&nbsp;log(10)/log(2)&nbsp;is&nbsp;close&nbsp;to&nbsp;93/28.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138100">i</span>&nbsp;<span class="op" id="2138102">:=</span>&nbsp;<span class="op" id="2138105">(</span><span class="ident" id="2138106">approxExp10</span>&nbsp;<span class="op" id="2138118">-</span>&nbsp;<span class="ident" id="2138120">firstPowerOfTen</span><span class="op" id="2138135">)</span>&nbsp;<span class="op" id="2138137">/</span>&nbsp;<span class="ident" id="2138139">stepPowerOfTen</span><br>
<span class="lineno"></span><span class="ident" id="2138154">Loop</span><span class="op" id="2138158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138161">for</span>&nbsp;<span class="op" id="2138165">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138169">exp</span>&nbsp;<span class="op" id="2138173">:=</span>&nbsp;<span class="ident" id="2138176">f</span><span class="op" id="2138177">.</span><span class="ident" id="2138178">exp</span>&nbsp;<span class="op" id="2138182">+</span>&nbsp;<span class="ident" id="2138184">powersOfTen</span><span class="op" id="2138195">[</span><span class="ident" id="2138196">i</span><span class="op" id="2138197">]</span><span class="op" id="2138198">.</span><span class="ident" id="2138199">exp</span>&nbsp;<span class="op" id="2138203">+</span>&nbsp;<span class="num" id="2138205">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138210">switch</span>&nbsp;<span class="op" id="2138217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138221">case</span>&nbsp;<span class="ident" id="2138226">exp</span>&nbsp;<span class="op" id="2138230">&lt;</span>&nbsp;<span class="ident" id="2138232">expMin</span><span class="op" id="2138238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138243">i</span><span class="op" id="2138244">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138249">case</span>&nbsp;<span class="ident" id="2138254">exp</span>&nbsp;<span class="op" id="2138258">&gt;</span>&nbsp;<span class="ident" id="2138260">expMax</span><span class="op" id="2138266">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138271">i</span><span class="op" id="2138272">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138277">default</span><span class="op" id="2138284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138289">break</span>&nbsp;<span class="ident" id="2138295">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138305">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2138308">//&nbsp;Apply&nbsp;the&nbsp;desired&nbsp;decimal&nbsp;shift&nbsp;on&nbsp;f.&nbsp;It&nbsp;will&nbsp;have&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2138372">//&nbsp;in&nbsp;the&nbsp;desired&nbsp;range.&nbsp;This&nbsp;is&nbsp;multiplication&nbsp;by&nbsp;10^-exp10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138435">f</span><span class="op" id="2138436">.</span><span class="ident" id="2138437">Multiply</span><span class="op" id="2138445">(</span><span class="ident" id="2138446">powersOfTen</span><span class="op" id="2138457">[</span><span class="ident" id="2138458">i</span><span class="op" id="2138459">]</span><span class="op" id="2138460">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138464">return</span>&nbsp;<span class="op" id="2138471">-</span><span class="op" id="2138472">(</span><span class="ident" id="2138473">firstPowerOfTen</span>&nbsp;<span class="op" id="2138489">+</span>&nbsp;<span class="ident" id="2138491">i</span><span class="op" id="2138492">*</span><span class="ident" id="2138493">stepPowerOfTen</span><span class="op" id="2138507">)</span><span class="op" id="2138508">,</span>&nbsp;<span class="ident" id="2138510">i</span><br>
<span class="lineno">365</span><span class="op" id="2138512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2138515">//&nbsp;frexp10Many&nbsp;applies&nbsp;a&nbsp;common&nbsp;shift&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;a,&nbsp;b,&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2138583">func</span>&nbsp;<span class="ident" id="2138588">frexp10Many</span><span class="op" id="2138599">(</span><span class="ident" id="2138600">a</span><span class="op" id="2138601">,</span>&nbsp;<span class="ident" id="2138603">b</span><span class="op" id="2138604">,</span>&nbsp;<span class="ident" id="2138606">c</span>&nbsp;<span class="op" id="2138608">*</span><span class="ident" id="2138609">extFloat</span><span class="op" id="2138617">)</span>&nbsp;<span class="op" id="2138619">(</span><span class="ident" id="2138620">exp10</span>&nbsp;<span class="builtintype" id="2138626">int</span><span class="op" id="2138629">)</span>&nbsp;<span class="op" id="2138631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138634">exp10</span><span class="op" id="2138639">,</span>&nbsp;<span class="ident" id="2138641">i</span>&nbsp;<span class="op" id="2138643">:=</span>&nbsp;<span class="ident" id="2138646">c</span><span class="op" id="2138647">.</span><span class="ident" id="2138648">frexp10</span><span class="op" id="2138655">(</span><span class="op" id="2138656">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138659">a</span><span class="op" id="2138660">.</span><span class="ident" id="2138661">Multiply</span><span class="op" id="2138669">(</span><span class="ident" id="2138670">powersOfTen</span><span class="op" id="2138681">[</span><span class="ident" id="2138682">i</span><span class="op" id="2138683">]</span><span class="op" id="2138684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138687">b</span><span class="op" id="2138688">.</span><span class="ident" id="2138689">Multiply</span><span class="op" id="2138697">(</span><span class="ident" id="2138698">powersOfTen</span><span class="op" id="2138709">[</span><span class="ident" id="2138710">i</span><span class="op" id="2138711">]</span><span class="op" id="2138712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138715">return</span><br>
<span class="lineno"></span><span class="op" id="2138722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2138725">//&nbsp;FixedDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;first&nbsp;n&nbsp;significant&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="2138784">//&nbsp;of&nbsp;the&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f.&nbsp;It&nbsp;returns&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="2138840">//&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;sure&nbsp;of&nbsp;the&nbsp;answer.</span><br>
<span class="lineno"></span><span class="keyword" id="2138879">func</span>&nbsp;<span class="op" id="2138884">(</span><span class="ident" id="2138885">f</span>&nbsp;<span class="op" id="2138887">*</span><span class="ident" id="2138888">extFloat</span><span class="op" id="2138896">)</span>&nbsp;<span class="ident" id="2138898">FixedDecimal</span><span class="op" id="2138910">(</span><span class="ident" id="2138911">d</span>&nbsp;<span class="op" id="2138913">*</span><span class="ident" id="2138914">decimalSlice</span><span class="op" id="2138926">,</span>&nbsp;<span class="ident" id="2138928">n</span>&nbsp;<span class="builtintype" id="2138930">int</span><span class="op" id="2138933">)</span>&nbsp;<span class="builtintype" id="2138935">bool</span>&nbsp;<span class="op" id="2138940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138943">if</span>&nbsp;<span class="ident" id="2138946">f</span><span class="op" id="2138947">.</span><span class="ident" id="2138948">mant</span>&nbsp;<span class="op" id="2138953">==</span>&nbsp;<span class="num" id="2138956">0</span>&nbsp;<span class="op" id="2138958">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138962">d</span><span class="op" id="2138963">.</span><span class="ident" id="2138964">nd</span>&nbsp;<span class="op" id="2138967">=</span>&nbsp;<span class="num" id="2138969">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138973">d</span><span class="op" id="2138974">.</span><span class="ident" id="2138975">dp</span>&nbsp;<span class="op" id="2138978">=</span>&nbsp;<span class="num" id="2138980">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138984">d</span><span class="op" id="2138985">.</span><span class="ident" id="2138986">neg</span>&nbsp;<span class="op" id="2138990">=</span>&nbsp;<span class="ident" id="2138992">f</span><span class="op" id="2138993">.</span><span class="ident" id="2138994">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139000">return</span>&nbsp;<span class="ident" id="2139007">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139013">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139016">if</span>&nbsp;<span class="ident" id="2139019">n</span>&nbsp;<span class="op" id="2139021">==</span>&nbsp;<span class="num" id="2139024">0</span>&nbsp;<span class="op" id="2139026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2139030">panic</span><span class="op" id="2139035">(</span><span class="string" id="2139036">&#34;strconv:&nbsp;internal&nbsp;error:&nbsp;extFloat.FixedDecimal&nbsp;called&nbsp;with&nbsp;n&nbsp;==&nbsp;0&#34;</span><span class="op" id="2139103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2139109">//&nbsp;Multiply&nbsp;by&nbsp;an&nbsp;appropriate&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;have&nbsp;a&nbsp;reasonable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2139174">//&nbsp;number&nbsp;to&nbsp;process.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139197">f</span><span class="op" id="2139198">.</span><span class="ident" id="2139199">Normalize</span><span class="op" id="2139208">(</span><span class="op" id="2139209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139212">exp10</span><span class="op" id="2139217">,</span>&nbsp;<span class="ident" id="2139219">_</span>&nbsp;<span class="op" id="2139221">:=</span>&nbsp;<span class="ident" id="2139224">f</span><span class="op" id="2139225">.</span><span class="ident" id="2139226">frexp10</span><span class="op" id="2139233">(</span><span class="op" id="2139234">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139238">shift</span>&nbsp;<span class="op" id="2139244">:=</span>&nbsp;<span class="builtintype" id="2139247">uint</span><span class="op" id="2139251">(</span><span class="op" id="2139252">-</span><span class="ident" id="2139253">f</span><span class="op" id="2139254">.</span><span class="ident" id="2139255">exp</span><span class="op" id="2139258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139261">integer</span>&nbsp;<span class="op" id="2139269">:=</span>&nbsp;<span class="builtintype" id="2139272">uint32</span><span class="op" id="2139278">(</span><span class="ident" id="2139279">f</span><span class="op" id="2139280">.</span><span class="ident" id="2139281">mant</span>&nbsp;<span class="op" id="2139286">&gt;&gt;</span>&nbsp;<span class="ident" id="2139289">shift</span><span class="op" id="2139294">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139297">fraction</span>&nbsp;<span class="op" id="2139306">:=</span>&nbsp;<span class="ident" id="2139309">f</span><span class="op" id="2139310">.</span><span class="ident" id="2139311">mant</span>&nbsp;<span class="op" id="2139316">-</span>&nbsp;<span class="op" id="2139318">(</span><span class="ident" id="2139319">uint64</span><span class="op" id="2139325">(</span><span class="ident" id="2139326">integer</span><span class="op" id="2139333">)</span>&nbsp;<span class="op" id="2139335">&lt;&lt;</span>&nbsp;<span class="ident" id="2139338">shift</span><span class="op" id="2139343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139346">ε</span>&nbsp;<span class="op" id="2139349">:=</span>&nbsp;<span class="ident" id="2139352">uint64</span><span class="op" id="2139358">(</span><span class="num" id="2139359">1</span><span class="op" id="2139360">)</span>&nbsp;<span class="comment" id="2139362">//&nbsp;ε&nbsp;is&nbsp;the&nbsp;uncertainty&nbsp;we&nbsp;have&nbsp;on&nbsp;the&nbsp;mantissa&nbsp;of&nbsp;f.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2139419">//&nbsp;Write&nbsp;exactly&nbsp;n&nbsp;digits&nbsp;to&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139452">needed</span>&nbsp;<span class="op" id="2139459">:=</span>&nbsp;<span class="ident" id="2139462">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2139471">//&nbsp;how&nbsp;many&nbsp;digits&nbsp;are&nbsp;left&nbsp;to&nbsp;write.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139510">integerDigits</span>&nbsp;<span class="op" id="2139524">:=</span>&nbsp;<span class="num" id="2139527">0</span>&nbsp;<span class="comment" id="2139529">//&nbsp;the&nbsp;number&nbsp;of&nbsp;decimal&nbsp;digits&nbsp;of&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139574">pow10</span>&nbsp;<span class="op" id="2139580">:=</span>&nbsp;<span class="ident" id="2139583">uint64</span><span class="op" id="2139589">(</span><span class="num" id="2139590">1</span><span class="op" id="2139591">)</span>&nbsp;<span class="comment" id="2139593">//&nbsp;the&nbsp;power&nbsp;of&nbsp;ten&nbsp;by&nbsp;which&nbsp;f&nbsp;was&nbsp;scaled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139637">for</span>&nbsp;<span class="ident" id="2139641">i</span><span class="op" id="2139642">,</span>&nbsp;<span class="ident" id="2139644">pow</span>&nbsp;<span class="op" id="2139648">:=</span>&nbsp;<span class="num" id="2139651">0</span><span class="op" id="2139652">,</span>&nbsp;<span class="ident" id="2139654">uint64</span><span class="op" id="2139660">(</span><span class="num" id="2139661">1</span><span class="op" id="2139662">)</span><span class="op" id="2139663">;</span>&nbsp;<span class="ident" id="2139665">i</span>&nbsp;<span class="op" id="2139667">&lt;</span>&nbsp;<span class="num" id="2139669">20</span><span class="op" id="2139671">;</span>&nbsp;<span class="ident" id="2139673">i</span><span class="op" id="2139674">++</span>&nbsp;<span class="op" id="2139677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139681">if</span>&nbsp;<span class="ident" id="2139684">pow</span>&nbsp;<span class="op" id="2139688">&gt;</span>&nbsp;<span class="ident" id="2139690">uint64</span><span class="op" id="2139696">(</span><span class="ident" id="2139697">integer</span><span class="op" id="2139704">)</span>&nbsp;<span class="op" id="2139706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139711">integerDigits</span>&nbsp;<span class="op" id="2139725">=</span>&nbsp;<span class="ident" id="2139727">i</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139732">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139744">pow</span>&nbsp;<span class="op" id="2139748">*=</span>&nbsp;<span class="num" id="2139751">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139758">rest</span>&nbsp;<span class="op" id="2139763">:=</span>&nbsp;<span class="ident" id="2139766">integer</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139775">if</span>&nbsp;<span class="ident" id="2139778">integerDigits</span>&nbsp;<span class="op" id="2139792">&gt;</span>&nbsp;<span class="ident" id="2139794">needed</span>&nbsp;<span class="op" id="2139801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2139805">//&nbsp;the&nbsp;integral&nbsp;part&nbsp;is&nbsp;already&nbsp;large,&nbsp;trim&nbsp;the&nbsp;last&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139868">pow10</span>&nbsp;<span class="op" id="2139874">=</span>&nbsp;<span class="ident" id="2139876">uint64pow10</span><span class="op" id="2139887">[</span><span class="ident" id="2139888">integerDigits</span><span class="op" id="2139901">-</span><span class="ident" id="2139902">needed</span><span class="op" id="2139908">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139912">integer</span>&nbsp;<span class="op" id="2139920">/=</span>&nbsp;<span class="builtintype" id="2139923">uint32</span><span class="op" id="2139929">(</span><span class="ident" id="2139930">pow10</span><span class="op" id="2139935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139939">rest</span>&nbsp;<span class="op" id="2139944">-=</span>&nbsp;<span class="ident" id="2139947">integer</span>&nbsp;<span class="op" id="2139955">*</span>&nbsp;<span class="builtintype" id="2139957">uint32</span><span class="op" id="2139963">(</span><span class="ident" id="2139964">pow10</span><span class="op" id="2139969">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139972">}</span>&nbsp;<span class="keyword" id="2139974">else</span>&nbsp;<span class="op" id="2139979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139983">rest</span>&nbsp;<span class="op" id="2139988">=</span>&nbsp;<span class="num" id="2139990">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2139997">//&nbsp;Write&nbsp;the&nbsp;digits&nbsp;of&nbsp;integer:&nbsp;the&nbsp;digits&nbsp;of&nbsp;rest&nbsp;are&nbsp;omitted.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140062">var</span>&nbsp;<span class="ident" id="2140066">buf</span>&nbsp;<span class="op" id="2140070">[</span><span class="num" id="2140071">32</span><span class="op" id="2140073">]</span><span class="builtintype" id="2140074">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140080">pos</span>&nbsp;<span class="op" id="2140084">:=</span>&nbsp;<span class="builtinfunc" id="2140087">len</span><span class="op" id="2140090">(</span><span class="ident" id="2140091">buf</span><span class="op" id="2140094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140097">for</span>&nbsp;<span class="ident" id="2140101">v</span>&nbsp;<span class="op" id="2140103">:=</span>&nbsp;<span class="ident" id="2140106">integer</span><span class="op" id="2140113">;</span>&nbsp;<span class="ident" id="2140115">v</span>&nbsp;<span class="op" id="2140117">&gt;</span>&nbsp;<span class="num" id="2140119">0</span><span class="op" id="2140120">;</span>&nbsp;<span class="op" id="2140122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140126">v1</span>&nbsp;<span class="op" id="2140129">:=</span>&nbsp;<span class="ident" id="2140132">v</span>&nbsp;<span class="op" id="2140134">/</span>&nbsp;<span class="num" id="2140136">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140141">v</span>&nbsp;<span class="op" id="2140143">-=</span>&nbsp;<span class="num" id="2140146">10</span>&nbsp;<span class="op" id="2140149">*</span>&nbsp;<span class="ident" id="2140151">v1</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140156">pos</span><span class="op" id="2140159">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140164">buf</span><span class="op" id="2140167">[</span><span class="ident" id="2140168">pos</span><span class="op" id="2140171">]</span>&nbsp;<span class="op" id="2140173">=</span>&nbsp;<span class="builtintype" id="2140175">byte</span><span class="op" id="2140179">(</span><span class="ident" id="2140180">v</span>&nbsp;<span class="op" id="2140182">+</span>&nbsp;<span class="string" id="2140184">&#39;0&#39;</span><span class="op" id="2140187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140191">v</span>&nbsp;<span class="op" id="2140193">=</span>&nbsp;<span class="ident" id="2140195">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2140199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140202">for</span>&nbsp;<span class="ident" id="2140206">i</span>&nbsp;<span class="op" id="2140208">:=</span>&nbsp;<span class="ident" id="2140211">pos</span><span class="op" id="2140214">;</span>&nbsp;<span class="ident" id="2140216">i</span>&nbsp;<span class="op" id="2140218">&lt;</span>&nbsp;<span class="builtinfunc" id="2140220">len</span><span class="op" id="2140223">(</span><span class="ident" id="2140224">buf</span><span class="op" id="2140227">)</span><span class="op" id="2140228">;</span>&nbsp;<span class="ident" id="2140230">i</span><span class="op" id="2140231">++</span>&nbsp;<span class="op" id="2140234">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140238">d</span><span class="op" id="2140239">.</span><span class="ident" id="2140240">d</span><span class="op" id="2140241">[</span><span class="ident" id="2140242">i</span><span class="op" id="2140243">-</span><span class="ident" id="2140244">pos</span><span class="op" id="2140247">]</span>&nbsp;<span class="op" id="2140249">=</span>&nbsp;<span class="ident" id="2140251">buf</span><span class="op" id="2140254">[</span><span class="ident" id="2140255">i</span><span class="op" id="2140256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2140259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140262">nd</span>&nbsp;<span class="op" id="2140265">:=</span>&nbsp;<span class="builtinfunc" id="2140268">len</span><span class="op" id="2140271">(</span><span class="ident" id="2140272">buf</span><span class="op" id="2140275">)</span>&nbsp;<span class="op" id="2140277">-</span>&nbsp;<span class="ident" id="2140279">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140284">d</span><span class="op" id="2140285">.</span><span class="ident" id="2140286">nd</span>&nbsp;<span class="op" id="2140289">=</span>&nbsp;<span class="ident" id="2140291">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140295">d</span><span class="op" id="2140296">.</span><span class="ident" id="2140297">dp</span>&nbsp;<span class="op" id="2140300">=</span>&nbsp;<span class="ident" id="2140302">integerDigits</span>&nbsp;<span class="op" id="2140316">+</span>&nbsp;<span class="ident" id="2140318">exp10</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140325">needed</span>&nbsp;<span class="op" id="2140332">-=</span>&nbsp;<span class="ident" id="2140335">nd</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140340">if</span>&nbsp;<span class="ident" id="2140343">needed</span>&nbsp;<span class="op" id="2140350">&gt;</span>&nbsp;<span class="num" id="2140352">0</span>&nbsp;<span class="op" id="2140354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140358">if</span>&nbsp;<span class="ident" id="2140361">rest</span>&nbsp;<span class="op" id="2140366">!=</span>&nbsp;<span class="num" id="2140369">0</span>&nbsp;<span class="op" id="2140371">||</span>&nbsp;<span class="ident" id="2140374">pow10</span>&nbsp;<span class="op" id="2140380">!=</span>&nbsp;<span class="num" id="2140383">1</span>&nbsp;<span class="op" id="2140385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2140390">panic</span><span class="op" id="2140395">(</span><span class="string" id="2140396">&#34;strconv:&nbsp;internal&nbsp;error,&nbsp;rest&nbsp;!=&nbsp;0&nbsp;but&nbsp;needed&nbsp;&gt;&nbsp;0&#34;</span><span class="op" id="2140447">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2140451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2140455">//&nbsp;Emit&nbsp;digits&nbsp;for&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;Each&nbsp;time,&nbsp;10*fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2140520">//&nbsp;fits&nbsp;in&nbsp;a&nbsp;uint64&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140560">for</span>&nbsp;<span class="ident" id="2140564">needed</span>&nbsp;<span class="op" id="2140571">&gt;</span>&nbsp;<span class="num" id="2140573">0</span>&nbsp;<span class="op" id="2140575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140580">fraction</span>&nbsp;<span class="op" id="2140589">*=</span>&nbsp;<span class="num" id="2140592">10</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140598">ε</span>&nbsp;<span class="op" id="2140601">*=</span>&nbsp;<span class="num" id="2140604">10</span>&nbsp;<span class="comment" id="2140607">//&nbsp;the&nbsp;uncertainty&nbsp;scales&nbsp;as&nbsp;we&nbsp;multiply&nbsp;by&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140659">if</span>&nbsp;<span class="num" id="2140662">2</span><span class="op" id="2140663">*</span><span class="ident" id="2140664">ε</span>&nbsp;<span class="op" id="2140667">&gt;</span>&nbsp;<span class="num" id="2140669">1</span><span class="op" id="2140670">&lt;&lt;</span><span class="ident" id="2140672">shift</span>&nbsp;<span class="op" id="2140678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2140684">//&nbsp;the&nbsp;error&nbsp;is&nbsp;so&nbsp;large&nbsp;it&nbsp;could&nbsp;modify&nbsp;which&nbsp;digit&nbsp;to&nbsp;write,&nbsp;abort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2140758">return</span>&nbsp;<span class="ident" id="2140765">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2140774">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140779">digit</span>&nbsp;<span class="op" id="2140785">:=</span>&nbsp;<span class="ident" id="2140788">fraction</span>&nbsp;<span class="op" id="2140797">&gt;&gt;</span>&nbsp;<span class="ident" id="2140800">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140809">d</span><span class="op" id="2140810">.</span><span class="ident" id="2140811">d</span><span class="op" id="2140812">[</span><span class="ident" id="2140813">nd</span><span class="op" id="2140815">]</span>&nbsp;<span class="op" id="2140817">=</span>&nbsp;<span class="builtintype" id="2140819">byte</span><span class="op" id="2140823">(</span><span class="ident" id="2140824">digit</span>&nbsp;<span class="op" id="2140830">+</span>&nbsp;<span class="string" id="2140832">&#39;0&#39;</span><span class="op" id="2140835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140840">fraction</span>&nbsp;<span class="op" id="2140849">-=</span>&nbsp;<span class="ident" id="2140852">digit</span>&nbsp;<span class="op" id="2140858">&lt;&lt;</span>&nbsp;<span class="ident" id="2140861">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140870">nd</span><span class="op" id="2140872">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140878">needed</span><span class="op" id="2140884">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2140889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2140893">d</span><span class="op" id="2140894">.</span><span class="ident" id="2140895">nd</span>&nbsp;<span class="op" id="2140898">=</span>&nbsp;<span class="ident" id="2140900">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2140904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2140908">//&nbsp;We&nbsp;have&nbsp;written&nbsp;a&nbsp;truncation&nbsp;of&nbsp;f&nbsp;(a&nbsp;numerator&nbsp;/&nbsp;10^d.dp).&nbsp;The&nbsp;remaining&nbsp;part</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2140990">//&nbsp;can&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;small&nbsp;number&nbsp;(&lt;&nbsp;1)&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;last&nbsp;digit&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141074">//&nbsp;numerator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141089">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141093">//&nbsp;If&nbsp;rest&nbsp;&gt;&nbsp;0,&nbsp;the&nbsp;amount&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141125">//&nbsp;&nbsp;&nbsp;&nbsp;(rest&lt;&lt;shift&nbsp;|&nbsp;fraction)&nbsp;/&nbsp;(pow10&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141176">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141229">//&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fact&nbsp;that&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;guarantees&nbsp;that&nbsp;pow10&nbsp;&lt;&lt;&nbsp;shift&nbsp;does&nbsp;not&nbsp;overflow&nbsp;a&nbsp;uint64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141315">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141319">//&nbsp;If&nbsp;rest&nbsp;=&nbsp;0,&nbsp;pow10&nbsp;==&nbsp;1&nbsp;and&nbsp;the&nbsp;amount&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141365">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;/&nbsp;(1&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141396">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141449">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141453">//&nbsp;We&nbsp;pass&nbsp;this&nbsp;information&nbsp;to&nbsp;the&nbsp;rounding&nbsp;routine&nbsp;for&nbsp;adjustment.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141523">ok</span>&nbsp;<span class="op" id="2141526">:=</span>&nbsp;<span class="ident" id="2141529">adjustLastDigitFixed</span><span class="op" id="2141549">(</span><span class="ident" id="2141550">d</span><span class="op" id="2141551">,</span>&nbsp;<span class="ident" id="2141553">uint64</span><span class="op" id="2141559">(</span><span class="ident" id="2141560">rest</span><span class="op" id="2141564">)</span><span class="op" id="2141565">&lt;&lt;</span><span class="ident" id="2141567">shift</span><span class="op" id="2141572">|</span><span class="ident" id="2141573">fraction</span><span class="op" id="2141581">,</span>&nbsp;<span class="ident" id="2141583">pow10</span><span class="op" id="2141588">,</span>&nbsp;<span class="ident" id="2141590">shift</span><span class="op" id="2141595">,</span>&nbsp;<span class="ident" id="2141597">ε</span><span class="op" id="2141599">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141602">if</span>&nbsp;<span class="op" id="2141605">!</span><span class="ident" id="2141606">ok</span>&nbsp;<span class="op" id="2141609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141613">return</span>&nbsp;<span class="ident" id="2141620">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2141627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2141630">//&nbsp;Trim&nbsp;trailing&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141655">for</span>&nbsp;<span class="ident" id="2141659">i</span>&nbsp;<span class="op" id="2141661">:=</span>&nbsp;<span class="ident" id="2141664">d</span><span class="op" id="2141665">.</span><span class="ident" id="2141666">nd</span>&nbsp;<span class="op" id="2141669">-</span>&nbsp;<span class="num" id="2141671">1</span><span class="op" id="2141672">;</span>&nbsp;<span class="ident" id="2141674">i</span>&nbsp;<span class="op" id="2141676">&gt;=</span>&nbsp;<span class="num" id="2141679">0</span><span class="op" id="2141680">;</span>&nbsp;<span class="ident" id="2141682">i</span><span class="op" id="2141683">--</span>&nbsp;<span class="op" id="2141686">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141690">if</span>&nbsp;<span class="ident" id="2141693">d</span><span class="op" id="2141694">.</span><span class="ident" id="2141695">d</span><span class="op" id="2141696">[</span><span class="ident" id="2141697">i</span><span class="op" id="2141698">]</span>&nbsp;<span class="op" id="2141700">!=</span>&nbsp;<span class="string" id="2141703">&#39;0&#39;</span>&nbsp;<span class="op" id="2141707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2141712">d</span><span class="op" id="2141713">.</span><span class="ident" id="2141714">nd</span>&nbsp;<span class="op" id="2141717">=</span>&nbsp;<span class="ident" id="2141719">i</span>&nbsp;<span class="op" id="2141721">+</span>&nbsp;<span class="num" id="2141723">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141728">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2141736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2141739">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2141742">return</span>&nbsp;<span class="ident" id="2141749">true</span><br>
<span class="lineno"></span><span class="op" id="2141754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2141757">//&nbsp;adjustLastDigitFixed&nbsp;assumes&nbsp;d&nbsp;contains&nbsp;the&nbsp;representation&nbsp;of&nbsp;the&nbsp;integral&nbsp;part</span><br>
<span class="lineno"></span><span class="comment" id="2141840">//&nbsp;of&nbsp;some&nbsp;number,&nbsp;whose&nbsp;fractional&nbsp;part&nbsp;is&nbsp;num&nbsp;/&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift).&nbsp;The&nbsp;numerator</span><br>
<span class="lineno">490</span><span class="comment" id="2141920">//&nbsp;num&nbsp;is&nbsp;only&nbsp;known&nbsp;up&nbsp;to&nbsp;an&nbsp;uncertainty&nbsp;of&nbsp;size&nbsp;ε,&nbsp;assumed&nbsp;to&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2141998">//&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift)/2.</span><br>
<span class="lineno"></span><span class="comment" id="2142019">//</span><br>
<span class="lineno"></span><span class="comment" id="2142022">//&nbsp;It&nbsp;will&nbsp;increase&nbsp;the&nbsp;last&nbsp;digit&nbsp;by&nbsp;one&nbsp;to&nbsp;account&nbsp;for&nbsp;correct&nbsp;rounding,&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="2142107">//&nbsp;when&nbsp;the&nbsp;fractional&nbsp;part&nbsp;is&nbsp;greater&nbsp;than&nbsp;1/2,&nbsp;and&nbsp;will&nbsp;return&nbsp;false&nbsp;if&nbsp;ε&nbsp;is&nbsp;such</span><br>
<span class="lineno">495</span><span class="comment" id="2142192">//&nbsp;that&nbsp;no&nbsp;correct&nbsp;answer&nbsp;can&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="keyword" id="2142232">func</span>&nbsp;<span class="ident" id="2142237">adjustLastDigitFixed</span><span class="op" id="2142257">(</span><span class="ident" id="2142258">d</span>&nbsp;<span class="op" id="2142260">*</span><span class="ident" id="2142261">decimalSlice</span><span class="op" id="2142273">,</span>&nbsp;<span class="ident" id="2142275">num</span><span class="op" id="2142278">,</span>&nbsp;<span class="ident" id="2142280">den</span>&nbsp;<span class="ident" id="2142284">uint64</span><span class="op" id="2142290">,</span>&nbsp;<span class="ident" id="2142292">shift</span>&nbsp;<span class="builtintype" id="2142298">uint</span><span class="op" id="2142302">,</span>&nbsp;<span class="ident" id="2142304">ε</span>&nbsp;<span class="ident" id="2142307">uint64</span><span class="op" id="2142313">)</span>&nbsp;<span class="builtintype" id="2142315">bool</span>&nbsp;<span class="op" id="2142320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142323">if</span>&nbsp;<span class="ident" id="2142326">num</span>&nbsp;<span class="op" id="2142330">&gt;</span>&nbsp;<span class="ident" id="2142332">den</span><span class="op" id="2142335">&lt;&lt;</span><span class="ident" id="2142337">shift</span>&nbsp;<span class="op" id="2142343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2142347">panic</span><span class="op" id="2142352">(</span><span class="string" id="2142353">&#34;strconv:&nbsp;num&nbsp;&gt;&nbsp;den&lt;&lt;shift&nbsp;in&nbsp;adjustLastDigitFixed&#34;</span><span class="op" id="2142404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142407">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142410">if</span>&nbsp;<span class="num" id="2142413">2</span><span class="op" id="2142414">*</span><span class="ident" id="2142415">ε</span>&nbsp;<span class="op" id="2142418">&gt;</span>&nbsp;<span class="ident" id="2142420">den</span><span class="op" id="2142423">&lt;&lt;</span><span class="ident" id="2142425">shift</span>&nbsp;<span class="op" id="2142431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2142435">panic</span><span class="op" id="2142440">(</span><span class="string" id="2142441">&#34;strconv:&nbsp;ε&nbsp;&gt;&nbsp;(den&lt;&lt;shift)/2&#34;</span><span class="op" id="2142471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142477">if</span>&nbsp;<span class="num" id="2142480">2</span><span class="op" id="2142481">*</span><span class="op" id="2142482">(</span><span class="ident" id="2142483">num</span><span class="op" id="2142486">+</span><span class="ident" id="2142487">ε</span><span class="op" id="2142489">)</span>&nbsp;<span class="op" id="2142491">&lt;</span>&nbsp;<span class="ident" id="2142493">den</span><span class="op" id="2142496">&lt;&lt;</span><span class="ident" id="2142498">shift</span>&nbsp;<span class="op" id="2142504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142508">return</span>&nbsp;<span class="ident" id="2142515">true</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142524">if</span>&nbsp;<span class="num" id="2142527">2</span><span class="op" id="2142528">*</span><span class="op" id="2142529">(</span><span class="ident" id="2142530">num</span><span class="op" id="2142533">-</span><span class="ident" id="2142534">ε</span><span class="op" id="2142536">)</span>&nbsp;<span class="op" id="2142538">&gt;</span>&nbsp;<span class="ident" id="2142540">den</span><span class="op" id="2142543">&lt;&lt;</span><span class="ident" id="2142545">shift</span>&nbsp;<span class="op" id="2142551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2142555">//&nbsp;increment&nbsp;d&nbsp;by&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142578">i</span>&nbsp;<span class="op" id="2142580">:=</span>&nbsp;<span class="ident" id="2142583">d</span><span class="op" id="2142584">.</span><span class="ident" id="2142585">nd</span>&nbsp;<span class="op" id="2142588">-</span>&nbsp;<span class="num" id="2142590">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142594">for</span>&nbsp;<span class="op" id="2142598">;</span>&nbsp;<span class="ident" id="2142600">i</span>&nbsp;<span class="op" id="2142602">&gt;=</span>&nbsp;<span class="num" id="2142605">0</span><span class="op" id="2142606">;</span>&nbsp;<span class="ident" id="2142608">i</span><span class="op" id="2142609">--</span>&nbsp;<span class="op" id="2142612">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142617">if</span>&nbsp;<span class="ident" id="2142620">d</span><span class="op" id="2142621">.</span><span class="ident" id="2142622">d</span><span class="op" id="2142623">[</span><span class="ident" id="2142624">i</span><span class="op" id="2142625">]</span>&nbsp;<span class="op" id="2142627">==</span>&nbsp;<span class="string" id="2142630">&#39;9&#39;</span>&nbsp;<span class="op" id="2142634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142640">d</span><span class="op" id="2142641">.</span><span class="ident" id="2142642">nd</span><span class="op" id="2142644">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142650">}</span>&nbsp;<span class="keyword" id="2142652">else</span>&nbsp;<span class="op" id="2142657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142663">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142672">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142680">if</span>&nbsp;<span class="ident" id="2142683">i</span>&nbsp;<span class="op" id="2142685">&lt;</span>&nbsp;<span class="num" id="2142687">0</span>&nbsp;<span class="op" id="2142689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142694">d</span><span class="op" id="2142695">.</span><span class="ident" id="2142696">d</span><span class="op" id="2142697">[</span><span class="num" id="2142698">0</span><span class="op" id="2142699">]</span>&nbsp;<span class="op" id="2142701">=</span>&nbsp;<span class="string" id="2142703">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142710">d</span><span class="op" id="2142711">.</span><span class="ident" id="2142712">nd</span>&nbsp;<span class="op" id="2142715">=</span>&nbsp;<span class="num" id="2142717">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142722">d</span><span class="op" id="2142723">.</span><span class="ident" id="2142724">dp</span><span class="op" id="2142726">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142731">}</span>&nbsp;<span class="keyword" id="2142733">else</span>&nbsp;<span class="op" id="2142738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2142743">d</span><span class="op" id="2142744">.</span><span class="ident" id="2142745">d</span><span class="op" id="2142746">[</span><span class="ident" id="2142747">i</span><span class="op" id="2142748">]</span><span class="op" id="2142749">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142758">return</span>&nbsp;<span class="ident" id="2142765">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2142771">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2142774">return</span>&nbsp;<span class="ident" id="2142781">false</span><br>
<span class="lineno"></span><span class="op" id="2142787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2142790">//&nbsp;ShortestDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;shortest&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2142862">//&nbsp;which&nbsp;belongs&nbsp;to&nbsp;the&nbsp;open&nbsp;interval&nbsp;(lower,&nbsp;upper),&nbsp;where&nbsp;f&nbsp;is&nbsp;supposed</span><br>
<span class="lineno">530</span><span class="comment" id="2142936">//&nbsp;to&nbsp;lie.&nbsp;It&nbsp;returns&nbsp;false&nbsp;whenever&nbsp;the&nbsp;result&nbsp;is&nbsp;unsure.&nbsp;The&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="2143014">//&nbsp;uses&nbsp;the&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="2143044">func</span>&nbsp;<span class="op" id="2143049">(</span><span class="ident" id="2143050">f</span>&nbsp;<span class="op" id="2143052">*</span><span class="ident" id="2143053">extFloat</span><span class="op" id="2143061">)</span>&nbsp;<span class="ident" id="2143063">ShortestDecimal</span><span class="op" id="2143078">(</span><span class="ident" id="2143079">d</span>&nbsp;<span class="op" id="2143081">*</span><span class="ident" id="2143082">decimalSlice</span><span class="op" id="2143094">,</span>&nbsp;<span class="ident" id="2143096">lower</span><span class="op" id="2143101">,</span>&nbsp;<span class="ident" id="2143103">upper</span>&nbsp;<span class="op" id="2143109">*</span><span class="ident" id="2143110">extFloat</span><span class="op" id="2143118">)</span>&nbsp;<span class="builtintype" id="2143120">bool</span>&nbsp;<span class="op" id="2143125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143128">if</span>&nbsp;<span class="ident" id="2143131">f</span><span class="op" id="2143132">.</span><span class="ident" id="2143133">mant</span>&nbsp;<span class="op" id="2143138">==</span>&nbsp;<span class="num" id="2143141">0</span>&nbsp;<span class="op" id="2143143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143147">d</span><span class="op" id="2143148">.</span><span class="ident" id="2143149">nd</span>&nbsp;<span class="op" id="2143152">=</span>&nbsp;<span class="num" id="2143154">0</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143158">d</span><span class="op" id="2143159">.</span><span class="ident" id="2143160">dp</span>&nbsp;<span class="op" id="2143163">=</span>&nbsp;<span class="num" id="2143165">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143169">d</span><span class="op" id="2143170">.</span><span class="ident" id="2143171">neg</span>&nbsp;<span class="op" id="2143175">=</span>&nbsp;<span class="ident" id="2143177">f</span><span class="op" id="2143178">.</span><span class="ident" id="2143179">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143185">return</span>&nbsp;<span class="ident" id="2143192">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2143198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143201">if</span>&nbsp;<span class="ident" id="2143204">f</span><span class="op" id="2143205">.</span><span class="ident" id="2143206">exp</span>&nbsp;<span class="op" id="2143210">==</span>&nbsp;<span class="num" id="2143213">0</span>&nbsp;<span class="op" id="2143215">&amp;&amp;</span>&nbsp;<span class="op" id="2143218">*</span><span class="ident" id="2143219">lower</span>&nbsp;<span class="op" id="2143225">==</span>&nbsp;<span class="op" id="2143228">*</span><span class="ident" id="2143229">f</span>&nbsp;<span class="op" id="2143231">&amp;&amp;</span>&nbsp;<span class="op" id="2143234">*</span><span class="ident" id="2143235">lower</span>&nbsp;<span class="op" id="2143241">==</span>&nbsp;<span class="op" id="2143244">*</span><span class="ident" id="2143245">upper</span>&nbsp;<span class="op" id="2143251">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2143255">//&nbsp;an&nbsp;exact&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143278">var</span>&nbsp;<span class="ident" id="2143282">buf</span>&nbsp;<span class="op" id="2143286">[</span><span class="num" id="2143287">24</span><span class="op" id="2143289">]</span><span class="builtintype" id="2143290">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143297">n</span>&nbsp;<span class="op" id="2143299">:=</span>&nbsp;<span class="builtinfunc" id="2143302">len</span><span class="op" id="2143305">(</span><span class="ident" id="2143306">buf</span><span class="op" id="2143309">)</span>&nbsp;<span class="op" id="2143311">-</span>&nbsp;<span class="num" id="2143313">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143317">for</span>&nbsp;<span class="ident" id="2143321">v</span>&nbsp;<span class="op" id="2143323">:=</span>&nbsp;<span class="ident" id="2143326">f</span><span class="op" id="2143327">.</span><span class="ident" id="2143328">mant</span><span class="op" id="2143332">;</span>&nbsp;<span class="ident" id="2143334">v</span>&nbsp;<span class="op" id="2143336">&gt;</span>&nbsp;<span class="num" id="2143338">0</span><span class="op" id="2143339">;</span>&nbsp;<span class="op" id="2143341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143346">v1</span>&nbsp;<span class="op" id="2143349">:=</span>&nbsp;<span class="ident" id="2143352">v</span>&nbsp;<span class="op" id="2143354">/</span>&nbsp;<span class="num" id="2143356">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143362">v</span>&nbsp;<span class="op" id="2143364">-=</span>&nbsp;<span class="num" id="2143367">10</span>&nbsp;<span class="op" id="2143370">*</span>&nbsp;<span class="ident" id="2143372">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143378">buf</span><span class="op" id="2143381">[</span><span class="ident" id="2143382">n</span><span class="op" id="2143383">]</span>&nbsp;<span class="op" id="2143385">=</span>&nbsp;<span class="builtintype" id="2143387">byte</span><span class="op" id="2143391">(</span><span class="ident" id="2143392">v</span>&nbsp;<span class="op" id="2143394">+</span>&nbsp;<span class="string" id="2143396">&#39;0&#39;</span><span class="op" id="2143399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143404">n</span><span class="op" id="2143405">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143411">v</span>&nbsp;<span class="op" id="2143413">=</span>&nbsp;<span class="ident" id="2143415">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2143420">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143424">nd</span>&nbsp;<span class="op" id="2143427">:=</span>&nbsp;<span class="builtinfunc" id="2143430">len</span><span class="op" id="2143433">(</span><span class="ident" id="2143434">buf</span><span class="op" id="2143437">)</span>&nbsp;<span class="op" id="2143439">-</span>&nbsp;<span class="ident" id="2143441">n</span>&nbsp;<span class="op" id="2143443">-</span>&nbsp;<span class="num" id="2143445">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143449">for</span>&nbsp;<span class="ident" id="2143453">i</span>&nbsp;<span class="op" id="2143455">:=</span>&nbsp;<span class="num" id="2143458">0</span><span class="op" id="2143459">;</span>&nbsp;<span class="ident" id="2143461">i</span>&nbsp;<span class="op" id="2143463">&lt;</span>&nbsp;<span class="ident" id="2143465">nd</span><span class="op" id="2143467">;</span>&nbsp;<span class="ident" id="2143469">i</span><span class="op" id="2143470">++</span>&nbsp;<span class="op" id="2143473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143478">d</span><span class="op" id="2143479">.</span><span class="ident" id="2143480">d</span><span class="op" id="2143481">[</span><span class="ident" id="2143482">i</span><span class="op" id="2143483">]</span>&nbsp;<span class="op" id="2143485">=</span>&nbsp;<span class="ident" id="2143487">buf</span><span class="op" id="2143490">[</span><span class="ident" id="2143491">n</span><span class="op" id="2143492">+</span><span class="num" id="2143493">1</span><span class="op" id="2143494">+</span><span class="ident" id="2143495">i</span><span class="op" id="2143496">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2143500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143504">d</span><span class="op" id="2143505">.</span><span class="ident" id="2143506">nd</span><span class="op" id="2143508">,</span>&nbsp;<span class="ident" id="2143510">d</span><span class="op" id="2143511">.</span><span class="ident" id="2143512">dp</span>&nbsp;<span class="op" id="2143515">=</span>&nbsp;<span class="ident" id="2143517">nd</span><span class="op" id="2143519">,</span>&nbsp;<span class="ident" id="2143521">nd</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143526">for</span>&nbsp;<span class="ident" id="2143530">d</span><span class="op" id="2143531">.</span><span class="ident" id="2143532">nd</span>&nbsp;<span class="op" id="2143535">&gt;</span>&nbsp;<span class="num" id="2143537">0</span>&nbsp;<span class="op" id="2143539">&amp;&amp;</span>&nbsp;<span class="ident" id="2143542">d</span><span class="op" id="2143543">.</span><span class="ident" id="2143544">d</span><span class="op" id="2143545">[</span><span class="ident" id="2143546">d</span><span class="op" id="2143547">.</span><span class="ident" id="2143548">nd</span><span class="op" id="2143550">-</span><span class="num" id="2143551">1</span><span class="op" id="2143552">]</span>&nbsp;<span class="op" id="2143554">==</span>&nbsp;<span class="string" id="2143557">&#39;0&#39;</span>&nbsp;<span class="op" id="2143561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143566">d</span><span class="op" id="2143567">.</span><span class="ident" id="2143568">nd</span><span class="op" id="2143570">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2143575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143579">if</span>&nbsp;<span class="ident" id="2143582">d</span><span class="op" id="2143583">.</span><span class="ident" id="2143584">nd</span>&nbsp;<span class="op" id="2143587">==</span>&nbsp;<span class="num" id="2143590">0</span>&nbsp;<span class="op" id="2143592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143597">d</span><span class="op" id="2143598">.</span><span class="ident" id="2143599">dp</span>&nbsp;<span class="op" id="2143602">=</span>&nbsp;<span class="num" id="2143604">0</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2143608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143612">d</span><span class="op" id="2143613">.</span><span class="ident" id="2143614">neg</span>&nbsp;<span class="op" id="2143618">=</span>&nbsp;<span class="ident" id="2143620">f</span><span class="op" id="2143621">.</span><span class="ident" id="2143622">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143628">return</span>&nbsp;<span class="ident" id="2143635">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2143641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143644">upper</span><span class="op" id="2143649">.</span><span class="ident" id="2143650">Normalize</span><span class="op" id="2143659">(</span><span class="op" id="2143660">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2143663">//&nbsp;Uniformize&nbsp;exponents.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143689">if</span>&nbsp;<span class="ident" id="2143692">f</span><span class="op" id="2143693">.</span><span class="ident" id="2143694">exp</span>&nbsp;<span class="op" id="2143698">&gt;</span>&nbsp;<span class="ident" id="2143700">upper</span><span class="op" id="2143705">.</span><span class="ident" id="2143706">exp</span>&nbsp;<span class="op" id="2143710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143714">f</span><span class="op" id="2143715">.</span><span class="ident" id="2143716">mant</span>&nbsp;<span class="op" id="2143721">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2143725">uint</span><span class="op" id="2143729">(</span><span class="ident" id="2143730">f</span><span class="op" id="2143731">.</span><span class="ident" id="2143732">exp</span>&nbsp;<span class="op" id="2143736">-</span>&nbsp;<span class="ident" id="2143738">upper</span><span class="op" id="2143743">.</span><span class="ident" id="2143744">exp</span><span class="op" id="2143747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143751">f</span><span class="op" id="2143752">.</span><span class="ident" id="2143753">exp</span>&nbsp;<span class="op" id="2143757">=</span>&nbsp;<span class="ident" id="2143759">upper</span><span class="op" id="2143764">.</span><span class="ident" id="2143765">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2143770">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2143773">if</span>&nbsp;<span class="ident" id="2143776">lower</span><span class="op" id="2143781">.</span><span class="ident" id="2143782">exp</span>&nbsp;<span class="op" id="2143786">&gt;</span>&nbsp;<span class="ident" id="2143788">upper</span><span class="op" id="2143793">.</span><span class="ident" id="2143794">exp</span>&nbsp;<span class="op" id="2143798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143802">lower</span><span class="op" id="2143807">.</span><span class="ident" id="2143808">mant</span>&nbsp;<span class="op" id="2143813">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2143817">uint</span><span class="op" id="2143821">(</span><span class="ident" id="2143822">lower</span><span class="op" id="2143827">.</span><span class="ident" id="2143828">exp</span>&nbsp;<span class="op" id="2143832">-</span>&nbsp;<span class="ident" id="2143834">upper</span><span class="op" id="2143839">.</span><span class="ident" id="2143840">exp</span><span class="op" id="2143843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143847">lower</span><span class="op" id="2143852">.</span><span class="ident" id="2143853">exp</span>&nbsp;<span class="op" id="2143857">=</span>&nbsp;<span class="ident" id="2143859">upper</span><span class="op" id="2143864">.</span><span class="ident" id="2143865">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2143870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143874">exp10</span>&nbsp;<span class="op" id="2143880">:=</span>&nbsp;<span class="ident" id="2143883">frexp10Many</span><span class="op" id="2143894">(</span><span class="ident" id="2143895">lower</span><span class="op" id="2143900">,</span>&nbsp;<span class="ident" id="2143902">f</span><span class="op" id="2143903">,</span>&nbsp;<span class="ident" id="2143905">upper</span><span class="op" id="2143910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2143913">//&nbsp;Take&nbsp;a&nbsp;safety&nbsp;margin&nbsp;due&nbsp;to&nbsp;rounding&nbsp;in&nbsp;frexp10Many,&nbsp;but&nbsp;we&nbsp;lose&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2143993">upper</span><span class="op" id="2143998">.</span><span class="ident" id="2143999">mant</span><span class="op" id="2144003">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144007">lower</span><span class="op" id="2144012">.</span><span class="ident" id="2144013">mant</span><span class="op" id="2144017">--</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2144022">//&nbsp;The&nbsp;shortest&nbsp;representation&nbsp;of&nbsp;f&nbsp;is&nbsp;either&nbsp;rounded&nbsp;up&nbsp;or&nbsp;down,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2144093">//&nbsp;in&nbsp;any&nbsp;case,&nbsp;it&nbsp;is&nbsp;a&nbsp;truncation&nbsp;of&nbsp;upper.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144139">shift</span>&nbsp;<span class="op" id="2144145">:=</span>&nbsp;<span class="builtintype" id="2144148">uint</span><span class="op" id="2144152">(</span><span class="op" id="2144153">-</span><span class="ident" id="2144154">upper</span><span class="op" id="2144159">.</span><span class="ident" id="2144160">exp</span><span class="op" id="2144163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144166">integer</span>&nbsp;<span class="op" id="2144174">:=</span>&nbsp;<span class="builtintype" id="2144177">uint32</span><span class="op" id="2144183">(</span><span class="ident" id="2144184">upper</span><span class="op" id="2144189">.</span><span class="ident" id="2144190">mant</span>&nbsp;<span class="op" id="2144195">&gt;&gt;</span>&nbsp;<span class="ident" id="2144198">shift</span><span class="op" id="2144203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144206">fraction</span>&nbsp;<span class="op" id="2144215">:=</span>&nbsp;<span class="ident" id="2144218">upper</span><span class="op" id="2144223">.</span><span class="ident" id="2144224">mant</span>&nbsp;<span class="op" id="2144229">-</span>&nbsp;<span class="op" id="2144231">(</span><span class="ident" id="2144232">uint64</span><span class="op" id="2144238">(</span><span class="ident" id="2144239">integer</span><span class="op" id="2144246">)</span>&nbsp;<span class="op" id="2144248">&lt;&lt;</span>&nbsp;<span class="ident" id="2144251">shift</span><span class="op" id="2144256">)</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2144260">//&nbsp;How&nbsp;far&nbsp;we&nbsp;can&nbsp;go&nbsp;down&nbsp;from&nbsp;upper&nbsp;until&nbsp;the&nbsp;result&nbsp;is&nbsp;wrong.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144325">allowance</span>&nbsp;<span class="op" id="2144335">:=</span>&nbsp;<span class="ident" id="2144338">upper</span><span class="op" id="2144343">.</span><span class="ident" id="2144344">mant</span>&nbsp;<span class="op" id="2144349">-</span>&nbsp;<span class="ident" id="2144351">lower</span><span class="op" id="2144356">.</span><span class="ident" id="2144357">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2144363">//&nbsp;How&nbsp;far&nbsp;we&nbsp;should&nbsp;go&nbsp;to&nbsp;get&nbsp;a&nbsp;very&nbsp;precise&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144418">targetDiff</span>&nbsp;<span class="op" id="2144429">:=</span>&nbsp;<span class="ident" id="2144432">upper</span><span class="op" id="2144437">.</span><span class="ident" id="2144438">mant</span>&nbsp;<span class="op" id="2144443">-</span>&nbsp;<span class="ident" id="2144445">f</span><span class="op" id="2144446">.</span><span class="ident" id="2144447">mant</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2144454">//&nbsp;Count&nbsp;integral&nbsp;digits:&nbsp;there&nbsp;are&nbsp;at&nbsp;most&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2144503">var</span>&nbsp;<span class="ident" id="2144507">integerDigits</span>&nbsp;<span class="builtintype" id="2144521">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2144526">for</span>&nbsp;<span class="ident" id="2144530">i</span><span class="op" id="2144531">,</span>&nbsp;<span class="ident" id="2144533">pow</span>&nbsp;<span class="op" id="2144537">:=</span>&nbsp;<span class="num" id="2144540">0</span><span class="op" id="2144541">,</span>&nbsp;<span class="ident" id="2144543">uint64</span><span class="op" id="2144549">(</span><span class="num" id="2144550">1</span><span class="op" id="2144551">)</span><span class="op" id="2144552">;</span>&nbsp;<span class="ident" id="2144554">i</span>&nbsp;<span class="op" id="2144556">&lt;</span>&nbsp;<span class="num" id="2144558">20</span><span class="op" id="2144560">;</span>&nbsp;<span class="ident" id="2144562">i</span><span class="op" id="2144563">++</span>&nbsp;<span class="op" id="2144566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2144570">if</span>&nbsp;<span class="ident" id="2144573">pow</span>&nbsp;<span class="op" id="2144577">&gt;</span>&nbsp;<span class="ident" id="2144579">uint64</span><span class="op" id="2144585">(</span><span class="ident" id="2144586">integer</span><span class="op" id="2144593">)</span>&nbsp;<span class="op" id="2144595">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144600">integerDigits</span>&nbsp;<span class="op" id="2144614">=</span>&nbsp;<span class="ident" id="2144616">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2144621">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2144629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144633">pow</span>&nbsp;<span class="op" id="2144637">*=</span>&nbsp;<span class="num" id="2144640">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2144644">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2144647">for</span>&nbsp;<span class="ident" id="2144651">i</span>&nbsp;<span class="op" id="2144653">:=</span>&nbsp;<span class="num" id="2144656">0</span><span class="op" id="2144657">;</span>&nbsp;<span class="ident" id="2144659">i</span>&nbsp;<span class="op" id="2144661">&lt;</span>&nbsp;<span class="ident" id="2144663">integerDigits</span><span class="op" id="2144676">;</span>&nbsp;<span class="ident" id="2144678">i</span><span class="op" id="2144679">++</span>&nbsp;<span class="op" id="2144682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144686">pow</span>&nbsp;<span class="op" id="2144690">:=</span>&nbsp;<span class="ident" id="2144693">uint64pow10</span><span class="op" id="2144704">[</span><span class="ident" id="2144705">integerDigits</span><span class="op" id="2144718">-</span><span class="ident" id="2144719">i</span><span class="op" id="2144720">-</span><span class="num" id="2144721">1</span><span class="op" id="2144722">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144726">digit</span>&nbsp;<span class="op" id="2144732">:=</span>&nbsp;<span class="ident" id="2144735">integer</span>&nbsp;<span class="op" id="2144743">/</span>&nbsp;<span class="builtintype" id="2144745">uint32</span><span class="op" id="2144751">(</span><span class="ident" id="2144752">pow</span><span class="op" id="2144755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144759">d</span><span class="op" id="2144760">.</span><span class="ident" id="2144761">d</span><span class="op" id="2144762">[</span><span class="ident" id="2144763">i</span><span class="op" id="2144764">]</span>&nbsp;<span class="op" id="2144766">=</span>&nbsp;<span class="builtintype" id="2144768">byte</span><span class="op" id="2144772">(</span><span class="ident" id="2144773">digit</span>&nbsp;<span class="op" id="2144779">+</span>&nbsp;<span class="string" id="2144781">&#39;0&#39;</span><span class="op" id="2144784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144788">integer</span>&nbsp;<span class="op" id="2144796">-=</span>&nbsp;<span class="ident" id="2144799">digit</span>&nbsp;<span class="op" id="2144805">*</span>&nbsp;<span class="builtintype" id="2144807">uint32</span><span class="op" id="2144813">(</span><span class="ident" id="2144814">pow</span><span class="op" id="2144817">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2144821">//&nbsp;evaluate&nbsp;whether&nbsp;we&nbsp;should&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2144859">if</span>&nbsp;<span class="ident" id="2144862">currentDiff</span>&nbsp;<span class="op" id="2144874">:=</span>&nbsp;<span class="ident" id="2144877">uint64</span><span class="op" id="2144883">(</span><span class="ident" id="2144884">integer</span><span class="op" id="2144891">)</span><span class="op" id="2144892">&lt;&lt;</span><span class="ident" id="2144894">shift</span>&nbsp;<span class="op" id="2144900">+</span>&nbsp;<span class="ident" id="2144902">fraction</span><span class="op" id="2144910">;</span>&nbsp;<span class="ident" id="2144912">currentDiff</span>&nbsp;<span class="op" id="2144924">&lt;</span>&nbsp;<span class="ident" id="2144926">allowance</span>&nbsp;<span class="op" id="2144936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144941">d</span><span class="op" id="2144942">.</span><span class="ident" id="2144943">nd</span>&nbsp;<span class="op" id="2144946">=</span>&nbsp;<span class="ident" id="2144948">i</span>&nbsp;<span class="op" id="2144950">+</span>&nbsp;<span class="num" id="2144952">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144957">d</span><span class="op" id="2144958">.</span><span class="ident" id="2144959">dp</span>&nbsp;<span class="op" id="2144962">=</span>&nbsp;<span class="ident" id="2144964">integerDigits</span>&nbsp;<span class="op" id="2144978">+</span>&nbsp;<span class="ident" id="2144980">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2144989">d</span><span class="op" id="2144990">.</span><span class="ident" id="2144991">neg</span>&nbsp;<span class="op" id="2144995">=</span>&nbsp;<span class="ident" id="2144997">f</span><span class="op" id="2144998">.</span><span class="ident" id="2144999">neg</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2145006">//&nbsp;Sometimes&nbsp;allowance&nbsp;is&nbsp;so&nbsp;large&nbsp;the&nbsp;last&nbsp;digit&nbsp;might&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2145076">//&nbsp;decremented&nbsp;to&nbsp;get&nbsp;closer&nbsp;to&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2145114">return</span>&nbsp;<span class="ident" id="2145121">adjustLastDigit</span><span class="op" id="2145136">(</span><span class="ident" id="2145137">d</span><span class="op" id="2145138">,</span>&nbsp;<span class="ident" id="2145140">currentDiff</span><span class="op" id="2145151">,</span>&nbsp;<span class="ident" id="2145153">targetDiff</span><span class="op" id="2145163">,</span>&nbsp;<span class="ident" id="2145165">allowance</span><span class="op" id="2145174">,</span>&nbsp;<span class="ident" id="2145176">pow</span><span class="op" id="2145179">&lt;&lt;</span><span class="ident" id="2145181">shift</span><span class="op" id="2145186">,</span>&nbsp;<span class="num" id="2145188">2</span><span class="op" id="2145189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2145193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2145196">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145199">d</span><span class="op" id="2145200">.</span><span class="ident" id="2145201">nd</span>&nbsp;<span class="op" id="2145204">=</span>&nbsp;<span class="ident" id="2145206">integerDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145221">d</span><span class="op" id="2145222">.</span><span class="ident" id="2145223">dp</span>&nbsp;<span class="op" id="2145226">=</span>&nbsp;<span class="ident" id="2145228">d</span><span class="op" id="2145229">.</span><span class="ident" id="2145230">nd</span>&nbsp;<span class="op" id="2145233">+</span>&nbsp;<span class="ident" id="2145235">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145242">d</span><span class="op" id="2145243">.</span><span class="ident" id="2145244">neg</span>&nbsp;<span class="op" id="2145248">=</span>&nbsp;<span class="ident" id="2145250">f</span><span class="op" id="2145251">.</span><span class="ident" id="2145252">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2145258">//&nbsp;Compute&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;At&nbsp;each&nbsp;step&nbsp;fraction&nbsp;does&nbsp;not</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2145332">//&nbsp;overflow.&nbsp;The&nbsp;choice&nbsp;of&nbsp;minExp&nbsp;implies&nbsp;that&nbsp;fraction&nbsp;is&nbsp;less&nbsp;than&nbsp;2^60.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2145408">var</span>&nbsp;<span class="ident" id="2145412">digit</span>&nbsp;<span class="builtintype" id="2145418">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145423">multiplier</span>&nbsp;<span class="op" id="2145434">:=</span>&nbsp;<span class="ident" id="2145437">uint64</span><span class="op" id="2145443">(</span><span class="num" id="2145444">1</span><span class="op" id="2145445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2145448">for</span>&nbsp;<span class="op" id="2145452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145456">fraction</span>&nbsp;<span class="op" id="2145465">*=</span>&nbsp;<span class="num" id="2145468">10</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145473">multiplier</span>&nbsp;<span class="op" id="2145484">*=</span>&nbsp;<span class="num" id="2145487">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145492">digit</span>&nbsp;<span class="op" id="2145498">=</span>&nbsp;<span class="builtintype" id="2145500">int</span><span class="op" id="2145503">(</span><span class="ident" id="2145504">fraction</span>&nbsp;<span class="op" id="2145513">&gt;&gt;</span>&nbsp;<span class="ident" id="2145516">shift</span><span class="op" id="2145521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145525">d</span><span class="op" id="2145526">.</span><span class="ident" id="2145527">d</span><span class="op" id="2145528">[</span><span class="ident" id="2145529">d</span><span class="op" id="2145530">.</span><span class="ident" id="2145531">nd</span><span class="op" id="2145533">]</span>&nbsp;<span class="op" id="2145535">=</span>&nbsp;<span class="builtintype" id="2145537">byte</span><span class="op" id="2145541">(</span><span class="ident" id="2145542">digit</span>&nbsp;<span class="op" id="2145548">+</span>&nbsp;<span class="string" id="2145550">&#39;0&#39;</span><span class="op" id="2145553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145557">d</span><span class="op" id="2145558">.</span><span class="ident" id="2145559">nd</span><span class="op" id="2145561">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145566">fraction</span>&nbsp;<span class="op" id="2145575">-=</span>&nbsp;<span class="ident" id="2145578">uint64</span><span class="op" id="2145584">(</span><span class="ident" id="2145585">digit</span><span class="op" id="2145590">)</span>&nbsp;<span class="op" id="2145592">&lt;&lt;</span>&nbsp;<span class="ident" id="2145595">shift</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2145603">if</span>&nbsp;<span class="ident" id="2145606">fraction</span>&nbsp;<span class="op" id="2145615">&lt;</span>&nbsp;<span class="ident" id="2145617">allowance</span><span class="op" id="2145626">*</span><span class="ident" id="2145627">multiplier</span>&nbsp;<span class="op" id="2145638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2145643">//&nbsp;We&nbsp;are&nbsp;in&nbsp;the&nbsp;admissible&nbsp;range.&nbsp;Note&nbsp;that&nbsp;if&nbsp;allowance&nbsp;is&nbsp;about&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2145716">//&nbsp;overflow,&nbsp;that&nbsp;is,&nbsp;allowance&nbsp;&gt;&nbsp;2^64/10,&nbsp;the&nbsp;condition&nbsp;is&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2145793">//&nbsp;true&nbsp;due&nbsp;to&nbsp;the&nbsp;limited&nbsp;range&nbsp;of&nbsp;fraction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2145842">return</span>&nbsp;<span class="ident" id="2145849">adjustLastDigit</span><span class="op" id="2145864">(</span><span class="ident" id="2145865">d</span><span class="op" id="2145866">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2145872">fraction</span><span class="op" id="2145880">,</span>&nbsp;<span class="ident" id="2145882">targetDiff</span><span class="op" id="2145892">*</span><span class="ident" id="2145893">multiplier</span><span class="op" id="2145903">,</span>&nbsp;<span class="ident" id="2145905">allowance</span><span class="op" id="2145914">*</span><span class="ident" id="2145915">multiplier</span><span class="op" id="2145925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2145931">1</span><span class="op" id="2145932">&lt;&lt;</span><span class="ident" id="2145934">shift</span><span class="op" id="2145939">,</span>&nbsp;<span class="ident" id="2145941">multiplier</span><span class="op" id="2145951">*</span><span class="num" id="2145952">2</span><span class="op" id="2145953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2145957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2145960">}</span><br>
<span class="lineno"></span><span class="op" id="2145962">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2145965">//&nbsp;adjustLastDigit&nbsp;modifies&nbsp;d&nbsp;=&nbsp;x-currentDiff*ε,&nbsp;to&nbsp;get&nbsp;closest&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2146033">//&nbsp;d&nbsp;=&nbsp;x-targetDiff*ε,&nbsp;without&nbsp;becoming&nbsp;smaller&nbsp;than&nbsp;x-maxDiff*ε.</span><br>
<span class="lineno"></span><span class="comment" id="2146101">//&nbsp;It&nbsp;assumes&nbsp;that&nbsp;a&nbsp;decimal&nbsp;digit&nbsp;is&nbsp;worth&nbsp;ulpDecimal*ε,&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2146169">//&nbsp;all&nbsp;data&nbsp;is&nbsp;known&nbsp;with&nbsp;a&nbsp;error&nbsp;estimate&nbsp;of&nbsp;ulpBinary*ε.</span><br>
<span class="lineno">645</span><span class="keyword" id="2146229">func</span>&nbsp;<span class="ident" id="2146234">adjustLastDigit</span><span class="op" id="2146249">(</span><span class="ident" id="2146250">d</span>&nbsp;<span class="op" id="2146252">*</span><span class="ident" id="2146253">decimalSlice</span><span class="op" id="2146265">,</span>&nbsp;<span class="ident" id="2146267">currentDiff</span><span class="op" id="2146278">,</span>&nbsp;<span class="ident" id="2146280">targetDiff</span><span class="op" id="2146290">,</span>&nbsp;<span class="ident" id="2146292">maxDiff</span><span class="op" id="2146299">,</span>&nbsp;<span class="ident" id="2146301">ulpDecimal</span><span class="op" id="2146311">,</span>&nbsp;<span class="ident" id="2146313">ulpBinary</span>&nbsp;<span class="ident" id="2146323">uint64</span><span class="op" id="2146329">)</span>&nbsp;<span class="builtintype" id="2146331">bool</span>&nbsp;<span class="op" id="2146336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2146339">if</span>&nbsp;<span class="ident" id="2146342">ulpDecimal</span>&nbsp;<span class="op" id="2146353">&lt;</span>&nbsp;<span class="num" id="2146355">2</span><span class="op" id="2146356">*</span><span class="ident" id="2146357">ulpBinary</span>&nbsp;<span class="op" id="2146367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2146371">//&nbsp;Approximation&nbsp;is&nbsp;too&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2146403">return</span>&nbsp;<span class="ident" id="2146410">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2146417">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2146420">for</span>&nbsp;<span class="ident" id="2146424">currentDiff</span><span class="op" id="2146435">+</span><span class="ident" id="2146436">ulpDecimal</span><span class="op" id="2146446">/</span><span class="num" id="2146447">2</span><span class="op" id="2146448">+</span><span class="ident" id="2146449">ulpBinary</span>&nbsp;<span class="op" id="2146459">&lt;</span>&nbsp;<span class="ident" id="2146461">targetDiff</span>&nbsp;<span class="op" id="2146472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2146476">d</span><span class="op" id="2146477">.</span><span class="ident" id="2146478">d</span><span class="op" id="2146479">[</span><span class="ident" id="2146480">d</span><span class="op" id="2146481">.</span><span class="ident" id="2146482">nd</span><span class="op" id="2146484">-</span><span class="num" id="2146485">1</span><span class="op" id="2146486">]</span><span class="op" id="2146487">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2146492">currentDiff</span>&nbsp;<span class="op" id="2146504">+=</span>&nbsp;<span class="ident" id="2146507">ulpDecimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2146519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2146522">if</span>&nbsp;<span class="ident" id="2146525">currentDiff</span><span class="op" id="2146536">+</span><span class="ident" id="2146537">ulpDecimal</span>&nbsp;<span class="op" id="2146548">&lt;=</span>&nbsp;<span class="ident" id="2146551">targetDiff</span><span class="op" id="2146561">+</span><span class="ident" id="2146562">ulpDecimal</span><span class="op" id="2146572">/</span><span class="num" id="2146573">2</span><span class="op" id="2146574">+</span><span class="ident" id="2146575">ulpBinary</span>&nbsp;<span class="op" id="2146585">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2146589">//&nbsp;we&nbsp;have&nbsp;two&nbsp;choices,&nbsp;and&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2146642">return</span>&nbsp;<span class="ident" id="2146649">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2146656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2146659">if</span>&nbsp;<span class="ident" id="2146662">currentDiff</span>&nbsp;<span class="op" id="2146674">&lt;</span>&nbsp;<span class="ident" id="2146676">ulpBinary</span>&nbsp;<span class="op" id="2146686">||</span>&nbsp;<span class="ident" id="2146689">currentDiff</span>&nbsp;<span class="op" id="2146701">&gt;</span>&nbsp;<span class="ident" id="2146703">maxDiff</span><span class="op" id="2146710">-</span><span class="ident" id="2146711">ulpBinary</span>&nbsp;<span class="op" id="2146721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2146725">//&nbsp;we&nbsp;went&nbsp;too&nbsp;far</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2146746">return</span>&nbsp;<span class="ident" id="2146753">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2146760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2146763">if</span>&nbsp;<span class="ident" id="2146766">d</span><span class="op" id="2146767">.</span><span class="ident" id="2146768">nd</span>&nbsp;<span class="op" id="2146771">==</span>&nbsp;<span class="num" id="2146774">1</span>&nbsp;<span class="op" id="2146776">&amp;&amp;</span>&nbsp;<span class="ident" id="2146779">d</span><span class="op" id="2146780">.</span><span class="ident" id="2146781">d</span><span class="op" id="2146782">[</span><span class="num" id="2146783">0</span><span class="op" id="2146784">]</span>&nbsp;<span class="op" id="2146786">==</span>&nbsp;<span class="string" id="2146789">&#39;0&#39;</span>&nbsp;<span class="op" id="2146793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2146797">//&nbsp;the&nbsp;number&nbsp;has&nbsp;actually&nbsp;reached&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2146840">d</span><span class="op" id="2146841">.</span><span class="ident" id="2146842">nd</span>&nbsp;<span class="op" id="2146845">=</span>&nbsp;<span class="num" id="2146847">0</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2146851">d</span><span class="op" id="2146852">.</span><span class="ident" id="2146853">dp</span>&nbsp;<span class="op" id="2146856">=</span>&nbsp;<span class="num" id="2146858">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2146861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2146864">return</span>&nbsp;<span class="ident" id="2146871">true</span><br>
<span class="lineno"></span><span class="op" id="2146876">}</span>
</div>
</body>
</html>
