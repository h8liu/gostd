<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1677258">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1677313">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1677367">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1677418">package</span>&nbsp;<span class="ident" id="1677426">sync</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1677432">import</span>&nbsp;<span class="op" id="1677439">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1677442">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1677453">&#34;sync/atomic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1677468">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="1677477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1677480">//&nbsp;A&nbsp;Pool&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;temporary&nbsp;objects&nbsp;that&nbsp;may&nbsp;be&nbsp;individually&nbsp;saved&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1677555">//&nbsp;retrieved.</span><br>
<span class="lineno">15</span><span class="comment" id="1677569">//</span><br>
<span class="lineno"></span><span class="comment" id="1677572">//&nbsp;Any&nbsp;item&nbsp;stored&nbsp;in&nbsp;the&nbsp;Pool&nbsp;may&nbsp;be&nbsp;removed&nbsp;automatically&nbsp;at&nbsp;any&nbsp;time&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="1677652">//&nbsp;notification.&nbsp;If&nbsp;the&nbsp;Pool&nbsp;holds&nbsp;the&nbsp;only&nbsp;reference&nbsp;when&nbsp;this&nbsp;happens,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1677729">//&nbsp;item&nbsp;might&nbsp;be&nbsp;deallocated.</span><br>
<span class="lineno"></span><span class="comment" id="1677759">//</span><br>
<span class="lineno">20</span><span class="comment" id="1677762">//&nbsp;A&nbsp;Pool&nbsp;is&nbsp;safe&nbsp;for&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="1677827">//</span><br>
<span class="lineno"></span><span class="comment" id="1677830">//&nbsp;Pool&#39;s&nbsp;purpose&nbsp;is&nbsp;to&nbsp;cache&nbsp;allocated&nbsp;but&nbsp;unused&nbsp;items&nbsp;for&nbsp;later&nbsp;reuse,</span><br>
<span class="lineno"></span><span class="comment" id="1677904">//&nbsp;relieving&nbsp;pressure&nbsp;on&nbsp;the&nbsp;garbage&nbsp;collector.&nbsp;That&nbsp;is,&nbsp;it&nbsp;makes&nbsp;it&nbsp;easy&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1677981">//&nbsp;build&nbsp;efficient,&nbsp;thread-safe&nbsp;free&nbsp;lists.&nbsp;However,&nbsp;it&nbsp;is&nbsp;not&nbsp;suitable&nbsp;for&nbsp;all</span><br>
<span class="lineno">25</span><span class="comment" id="1678061">//&nbsp;free&nbsp;lists.</span><br>
<span class="lineno"></span><span class="comment" id="1678076">//</span><br>
<span class="lineno"></span><span class="comment" id="1678079">//&nbsp;An&nbsp;appropriate&nbsp;use&nbsp;of&nbsp;a&nbsp;Pool&nbsp;is&nbsp;to&nbsp;manage&nbsp;a&nbsp;group&nbsp;of&nbsp;temporary&nbsp;items</span><br>
<span class="lineno"></span><span class="comment" id="1678151">//&nbsp;silently&nbsp;shared&nbsp;among&nbsp;and&nbsp;potentially&nbsp;reused&nbsp;by&nbsp;concurrent&nbsp;independent</span><br>
<span class="lineno"></span><span class="comment" id="1678225">//&nbsp;clients&nbsp;of&nbsp;a&nbsp;package.&nbsp;Pool&nbsp;provides&nbsp;a&nbsp;way&nbsp;to&nbsp;amortize&nbsp;allocation&nbsp;overhead</span><br>
<span class="lineno">30</span><span class="comment" id="1678302">//&nbsp;across&nbsp;many&nbsp;clients.</span><br>
<span class="lineno"></span><span class="comment" id="1678326">//</span><br>
<span class="lineno"></span><span class="comment" id="1678329">//&nbsp;An&nbsp;example&nbsp;of&nbsp;good&nbsp;use&nbsp;of&nbsp;a&nbsp;Pool&nbsp;is&nbsp;in&nbsp;the&nbsp;fmt&nbsp;package,&nbsp;which&nbsp;maintains&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1678406">//&nbsp;dynamically-sized&nbsp;store&nbsp;of&nbsp;temporary&nbsp;output&nbsp;buffers.&nbsp;The&nbsp;store&nbsp;scales&nbsp;under</span><br>
<span class="lineno"></span><span class="comment" id="1678485">//&nbsp;load&nbsp;(when&nbsp;many&nbsp;goroutines&nbsp;are&nbsp;actively&nbsp;printing)&nbsp;and&nbsp;shrinks&nbsp;when</span><br>
<span class="lineno">35</span><span class="comment" id="1678555">//&nbsp;quiescent.</span><br>
<span class="lineno"></span><span class="comment" id="1678569">//</span><br>
<span class="lineno"></span><span class="comment" id="1678572">//&nbsp;On&nbsp;the&nbsp;other&nbsp;hand,&nbsp;a&nbsp;free&nbsp;list&nbsp;maintained&nbsp;as&nbsp;part&nbsp;of&nbsp;a&nbsp;short-lived&nbsp;object&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1678652">//&nbsp;not&nbsp;a&nbsp;suitable&nbsp;use&nbsp;for&nbsp;a&nbsp;Pool,&nbsp;since&nbsp;the&nbsp;overhead&nbsp;does&nbsp;not&nbsp;amortize&nbsp;well&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="1678731">//&nbsp;that&nbsp;scenario.&nbsp;It&nbsp;is&nbsp;more&nbsp;efficient&nbsp;to&nbsp;have&nbsp;such&nbsp;objects&nbsp;implement&nbsp;their&nbsp;own</span><br>
<span class="lineno">40</span><span class="comment" id="1678811">//&nbsp;free&nbsp;list.</span><br>
<span class="lineno"></span><span class="comment" id="1678825">//</span><br>
<span class="lineno"></span><span class="keyword" id="1678828">type</span>&nbsp;<span class="ident" id="1678833">Pool</span>&nbsp;<span class="keyword" id="1678838">struct</span>&nbsp;<span class="op" id="1678845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1678848">local</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1678858"><a href="/sync/pool.go.html#1677468">unsafe</a></span><span class="op" id="1678864">.</span><span class="ident" id="1678865">Pointer</span>&nbsp;<span class="comment" id="1678873">//&nbsp;local&nbsp;fixed-size&nbsp;per-P&nbsp;pool,&nbsp;actual&nbsp;type&nbsp;is&nbsp;[P]poolLocal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1678934">localSize</span>&nbsp;<span class="builtintype" id="1678944">uintptr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1678959">//&nbsp;size&nbsp;of&nbsp;the&nbsp;local&nbsp;array</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1678988">//&nbsp;New&nbsp;optionally&nbsp;specifies&nbsp;a&nbsp;function&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1679040">//&nbsp;a&nbsp;value&nbsp;when&nbsp;Get&nbsp;would&nbsp;otherwise&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1679089">//&nbsp;It&nbsp;may&nbsp;not&nbsp;be&nbsp;changed&nbsp;concurrently&nbsp;with&nbsp;calls&nbsp;to&nbsp;Get.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679147">New</span>&nbsp;<span class="keyword" id="1679151">func</span><span class="op" id="1679155">(</span><span class="op" id="1679156">)</span>&nbsp;<span class="keyword" id="1679158">interface</span><span class="op" id="1679167">{</span><span class="op" id="1679168">}</span><br>
<span class="lineno">50</span><span class="op" id="1679170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1679173">//&nbsp;Local&nbsp;per-P&nbsp;Pool&nbsp;appendix.</span><br>
<span class="lineno"></span><span class="keyword" id="1679203">type</span>&nbsp;<span class="ident" id="1679208">poolLocal</span>&nbsp;<span class="keyword" id="1679218">struct</span>&nbsp;<span class="op" id="1679225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679228">private</span>&nbsp;<span class="keyword" id="1679236">interface</span><span class="op" id="1679245">{</span><span class="op" id="1679246">}</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1679250">//&nbsp;Can&nbsp;be&nbsp;used&nbsp;only&nbsp;by&nbsp;the&nbsp;respective&nbsp;P.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679292">shared</span>&nbsp;&nbsp;<span class="op" id="1679300">[</span><span class="op" id="1679301">]</span><span class="keyword" id="1679302">interface</span><span class="op" id="1679311">{</span><span class="op" id="1679312">}</span>&nbsp;<span class="comment" id="1679314">//&nbsp;Can&nbsp;be&nbsp;used&nbsp;by&nbsp;any&nbsp;P.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679340"><a href="/sync/mutex.go.html#1673941">Mutex</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1679362">//&nbsp;Protects&nbsp;shared.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679383">pad</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1679391">[</span><span class="num" id="1679392">128</span><span class="op" id="1679395">]</span><span class="builtintype" id="1679396">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1679405">//&nbsp;Prevents&nbsp;false&nbsp;sharing.</span><br>
<span class="lineno"></span><span class="op" id="1679432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="1679435">//&nbsp;Put&nbsp;adds&nbsp;x&nbsp;to&nbsp;the&nbsp;pool.</span><br>
<span class="lineno"></span><span class="keyword" id="1679462">func</span>&nbsp;<span class="op" id="1679467">(</span><span class="ident" id="1679468">p</span>&nbsp;<span class="op" id="1679470">*</span><span class="ident" id="1679471"><a href="/sync/pool.go.html#1678833">Pool</a></span><span class="op" id="1679475">)</span>&nbsp;<span class="ident" id="1679477">Put</span><span class="op" id="1679480">(</span><span class="ident" id="1679481">x</span>&nbsp;<span class="keyword" id="1679483">interface</span><span class="op" id="1679492">{</span><span class="op" id="1679493">}</span><span class="op" id="1679494">)</span>&nbsp;<span class="op" id="1679496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1679499">if</span>&nbsp;<span class="ident" id="1679502"><a href="/sync/race0.go.html#1684026">raceenabled</a></span>&nbsp;<span class="op" id="1679514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1679518">//&nbsp;Under&nbsp;race&nbsp;detector&nbsp;the&nbsp;Pool&nbsp;degenerates&nbsp;into&nbsp;no-op.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1679576">//&nbsp;It&#39;s&nbsp;conforming,&nbsp;simple&nbsp;and&nbsp;does&nbsp;not&nbsp;introduce&nbsp;excessive</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1679638">//&nbsp;happens-before&nbsp;edges&nbsp;between&nbsp;unrelated&nbsp;goroutines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1679694">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1679702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1679705">if</span>&nbsp;<span class="ident" id="1679708"><a href="/sync/pool.go.html#1679481">x</a></span>&nbsp;<span class="op" id="1679710">==</span>&nbsp;<span class="ident" id="1679713">nil</span>&nbsp;<span class="op" id="1679717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1679721">return</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1679729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679732">l</span>&nbsp;<span class="op" id="1679734">:=</span>&nbsp;<span class="ident" id="1679737"><a href="/sync/pool.go.html#1679468">p</a></span><span class="op" id="1679738">.</span><span class="ident" id="1679739">pin</span><span class="op" id="1679742">(</span><span class="op" id="1679743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1679746">if</span>&nbsp;<span class="ident" id="1679749"><a href="/sync/pool.go.html#1679732">l</a></span><span class="op" id="1679750">.</span><span class="ident" id="1679751">private</span>&nbsp;<span class="op" id="1679759">==</span>&nbsp;<span class="ident" id="1679762">nil</span>&nbsp;<span class="op" id="1679766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679770"><a href="/sync/pool.go.html#1679732">l</a></span><span class="op" id="1679771">.</span><span class="ident" id="1679772">private</span>&nbsp;<span class="op" id="1679780">=</span>&nbsp;<span class="ident" id="1679782"><a href="/sync/pool.go.html#1679481">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679786"><a href="/sync/pool.go.html#1679481">x</a></span>&nbsp;<span class="op" id="1679788">=</span>&nbsp;<span class="ident" id="1679790">nil</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1679795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679798"><a href="/sync/pool.go.html#1683785">runtime_procUnpin</a></span><span class="op" id="1679815">(</span><span class="op" id="1679816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1679819">if</span>&nbsp;<span class="ident" id="1679822"><a href="/sync/pool.go.html#1679481">x</a></span>&nbsp;<span class="op" id="1679824">==</span>&nbsp;<span class="ident" id="1679827">nil</span>&nbsp;<span class="op" id="1679831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1679835">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1679843">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679846"><a href="/sync/pool.go.html#1679732">l</a></span><span class="op" id="1679847">.</span><span class="ident" id="1679848">Lock</span><span class="op" id="1679852">(</span><span class="op" id="1679853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679856"><a href="/sync/pool.go.html#1679732">l</a></span><span class="op" id="1679857">.</span><span class="ident" id="1679858">shared</span>&nbsp;<span class="op" id="1679865">=</span>&nbsp;<span class="builtinfunc" id="1679867">append</span><span class="op" id="1679873">(</span><span class="ident" id="1679874"><a href="/sync/pool.go.html#1679732">l</a></span><span class="op" id="1679875">.</span><span class="ident" id="1679876">shared</span><span class="op" id="1679882">,</span>&nbsp;<span class="ident" id="1679884"><a href="/sync/pool.go.html#1679481">x</a></span><span class="op" id="1679885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679888"><a href="/sync/pool.go.html#1679732">l</a></span><span class="op" id="1679889">.</span><span class="ident" id="1679890">Unlock</span><span class="op" id="1679896">(</span><span class="op" id="1679897">)</span><br>
<span class="lineno"></span><span class="op" id="1679899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1679902">//&nbsp;Get&nbsp;selects&nbsp;an&nbsp;arbitrary&nbsp;item&nbsp;from&nbsp;the&nbsp;Pool,&nbsp;removes&nbsp;it&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1679970">//&nbsp;Pool,&nbsp;and&nbsp;returns&nbsp;it&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span><span class="comment" id="1680009">//&nbsp;Get&nbsp;may&nbsp;choose&nbsp;to&nbsp;ignore&nbsp;the&nbsp;pool&nbsp;and&nbsp;treat&nbsp;it&nbsp;as&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="1680069">//&nbsp;Callers&nbsp;should&nbsp;not&nbsp;assume&nbsp;any&nbsp;relation&nbsp;between&nbsp;values&nbsp;passed&nbsp;to&nbsp;Put&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1680144">//&nbsp;the&nbsp;values&nbsp;returned&nbsp;by&nbsp;Get.</span><br>
<span class="lineno">90</span><span class="comment" id="1680175">//</span><br>
<span class="lineno"></span><span class="comment" id="1680178">//&nbsp;If&nbsp;Get&nbsp;would&nbsp;otherwise&nbsp;return&nbsp;nil&nbsp;and&nbsp;p.New&nbsp;is&nbsp;non-nil,&nbsp;Get&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="1680249">//&nbsp;the&nbsp;result&nbsp;of&nbsp;calling&nbsp;p.New.</span><br>
<span class="lineno"></span><span class="keyword" id="1680281">func</span>&nbsp;<span class="op" id="1680286">(</span><span class="ident" id="1680287">p</span>&nbsp;<span class="op" id="1680289">*</span><span class="ident" id="1680290"><a href="/sync/pool.go.html#1678833">Pool</a></span><span class="op" id="1680294">)</span>&nbsp;<span class="ident" id="1680296">Get</span><span class="op" id="1680299">(</span><span class="op" id="1680300">)</span>&nbsp;<span class="keyword" id="1680302">interface</span><span class="op" id="1680311">{</span><span class="op" id="1680312">}</span>&nbsp;<span class="op" id="1680314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680317">if</span>&nbsp;<span class="ident" id="1680320"><a href="/sync/race0.go.html#1684026">raceenabled</a></span>&nbsp;<span class="op" id="1680332">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680336">if</span>&nbsp;<span class="ident" id="1680339"><a href="/sync/pool.go.html#1680287">p</a></span><span class="op" id="1680340">.</span><span class="ident" id="1680341">New</span>&nbsp;<span class="op" id="1680345">!=</span>&nbsp;<span class="ident" id="1680348">nil</span>&nbsp;<span class="op" id="1680352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680357">return</span>&nbsp;<span class="ident" id="1680364"><a href="/sync/pool.go.html#1680287">p</a></span><span class="op" id="1680365">.</span><span class="ident" id="1680366">New</span><span class="op" id="1680369">(</span><span class="op" id="1680370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1680374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680378">return</span>&nbsp;<span class="ident" id="1680385">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1680390">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680393">l</span>&nbsp;<span class="op" id="1680395">:=</span>&nbsp;<span class="ident" id="1680398"><a href="/sync/pool.go.html#1680287">p</a></span><span class="op" id="1680399">.</span><span class="ident" id="1680400">pin</span><span class="op" id="1680403">(</span><span class="op" id="1680404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680407">x</span>&nbsp;<span class="op" id="1680409">:=</span>&nbsp;<span class="ident" id="1680412"><a href="/sync/pool.go.html#1680393">l</a></span><span class="op" id="1680413">.</span><span class="ident" id="1680414">private</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680423"><a href="/sync/pool.go.html#1680393">l</a></span><span class="op" id="1680424">.</span><span class="ident" id="1680425">private</span>&nbsp;<span class="op" id="1680433">=</span>&nbsp;<span class="ident" id="1680435">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680440"><a href="/sync/pool.go.html#1683785">runtime_procUnpin</a></span><span class="op" id="1680457">(</span><span class="op" id="1680458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680461">if</span>&nbsp;<span class="ident" id="1680464"><a href="/sync/pool.go.html#1680407">x</a></span>&nbsp;<span class="op" id="1680466">!=</span>&nbsp;<span class="ident" id="1680469">nil</span>&nbsp;<span class="op" id="1680473">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680477">return</span>&nbsp;<span class="ident" id="1680484"><a href="/sync/pool.go.html#1680407">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1680487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680490"><a href="/sync/pool.go.html#1680393">l</a></span><span class="op" id="1680491">.</span><span class="ident" id="1680492">Lock</span><span class="op" id="1680496">(</span><span class="op" id="1680497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680500">last</span>&nbsp;<span class="op" id="1680505">:=</span>&nbsp;<span class="builtinfunc" id="1680508">len</span><span class="op" id="1680511">(</span><span class="ident" id="1680512"><a href="/sync/pool.go.html#1680393">l</a></span><span class="op" id="1680513">.</span><span class="ident" id="1680514">shared</span><span class="op" id="1680520">)</span>&nbsp;<span class="op" id="1680522">-</span>&nbsp;<span class="num" id="1680524">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680527">if</span>&nbsp;<span class="ident" id="1680530"><a href="/sync/pool.go.html#1680500">last</a></span>&nbsp;<span class="op" id="1680535">&gt;=</span>&nbsp;<span class="num" id="1680538">0</span>&nbsp;<span class="op" id="1680540">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680544"><a href="/sync/pool.go.html#1680407">x</a></span>&nbsp;<span class="op" id="1680546">=</span>&nbsp;<span class="ident" id="1680548"><a href="/sync/pool.go.html#1680393">l</a></span><span class="op" id="1680549">.</span><span class="ident" id="1680550">shared</span><span class="op" id="1680556">[</span><span class="ident" id="1680557"><a href="/sync/pool.go.html#1680500">last</a></span><span class="op" id="1680561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680565"><a href="/sync/pool.go.html#1680393">l</a></span><span class="op" id="1680566">.</span><span class="ident" id="1680567">shared</span>&nbsp;<span class="op" id="1680574">=</span>&nbsp;<span class="ident" id="1680576"><a href="/sync/pool.go.html#1680393">l</a></span><span class="op" id="1680577">.</span><span class="ident" id="1680578">shared</span><span class="op" id="1680584">[</span><span class="op" id="1680585">:</span><span class="ident" id="1680586"><a href="/sync/pool.go.html#1680500">last</a></span><span class="op" id="1680590">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1680593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680596"><a href="/sync/pool.go.html#1680393">l</a></span><span class="op" id="1680597">.</span><span class="ident" id="1680598">Unlock</span><span class="op" id="1680604">(</span><span class="op" id="1680605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680608">if</span>&nbsp;<span class="ident" id="1680611"><a href="/sync/pool.go.html#1680407">x</a></span>&nbsp;<span class="op" id="1680613">!=</span>&nbsp;<span class="ident" id="1680616">nil</span>&nbsp;<span class="op" id="1680620">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680624">return</span>&nbsp;<span class="ident" id="1680631"><a href="/sync/pool.go.html#1680407">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1680634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680637">return</span>&nbsp;<span class="ident" id="1680644"><a href="/sync/pool.go.html#1680287">p</a></span><span class="op" id="1680645">.</span><span class="ident" id="1680646">getSlow</span><span class="op" id="1680653">(</span><span class="op" id="1680654">)</span><br>
<span class="lineno"></span><span class="op" id="1680656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="1680659">func</span>&nbsp;<span class="op" id="1680664">(</span><span class="ident" id="1680665">p</span>&nbsp;<span class="op" id="1680667">*</span><span class="ident" id="1680668"><a href="/sync/pool.go.html#1678833">Pool</a></span><span class="op" id="1680672">)</span>&nbsp;<span class="ident" id="1680674">getSlow</span><span class="op" id="1680681">(</span><span class="op" id="1680682">)</span>&nbsp;<span class="op" id="1680684">(</span><span class="ident" id="1680685">x</span>&nbsp;<span class="keyword" id="1680687">interface</span><span class="op" id="1680696">{</span><span class="op" id="1680697">}</span><span class="op" id="1680698">)</span>&nbsp;<span class="op" id="1680700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1680703">//&nbsp;See&nbsp;the&nbsp;comment&nbsp;in&nbsp;pin&nbsp;regarding&nbsp;ordering&nbsp;of&nbsp;the&nbsp;loads.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680763">size</span>&nbsp;<span class="op" id="1680768">:=</span>&nbsp;<span class="ident" id="1680771"><a href="/sync/pool.go.html#1677453">atomic</a></span><span class="op" id="1680777">.</span><span class="ident" id="1680778">LoadUintptr</span><span class="op" id="1680789">(</span><span class="op" id="1680790">&amp;</span><span class="ident" id="1680791"><a href="/sync/pool.go.html#1680665">p</a></span><span class="op" id="1680792">.</span><span class="ident" id="1680793">localSize</span><span class="op" id="1680802">)</span>&nbsp;<span class="comment" id="1680804">//&nbsp;load-acquire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680821">local</span>&nbsp;<span class="op" id="1680827">:=</span>&nbsp;<span class="ident" id="1680830"><a href="/sync/pool.go.html#1680665">p</a></span><span class="op" id="1680831">.</span><span class="ident" id="1680832">local</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1680862">//&nbsp;load-consume</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1680879">//&nbsp;Try&nbsp;to&nbsp;steal&nbsp;one&nbsp;element&nbsp;from&nbsp;other&nbsp;procs.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680926">pid</span>&nbsp;<span class="op" id="1680930">:=</span>&nbsp;<span class="ident" id="1680933"><a href="/sync/pool.go.html#1683758">runtime_procPin</a></span><span class="op" id="1680948">(</span><span class="op" id="1680949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680952"><a href="/sync/pool.go.html#1683785">runtime_procUnpin</a></span><span class="op" id="1680969">(</span><span class="op" id="1680970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680973">for</span>&nbsp;<span class="ident" id="1680977">i</span>&nbsp;<span class="op" id="1680979">:=</span>&nbsp;<span class="num" id="1680982">0</span><span class="op" id="1680983">;</span>&nbsp;<span class="ident" id="1680985"><a href="/sync/pool.go.html#1680977">i</a></span>&nbsp;<span class="op" id="1680987">&lt;</span>&nbsp;<span class="builtintype" id="1680989">int</span><span class="op" id="1680992">(</span><span class="ident" id="1680993"><a href="/sync/pool.go.html#1680763">size</a></span><span class="op" id="1680997">)</span><span class="op" id="1680998">;</span>&nbsp;<span class="ident" id="1681000"><a href="/sync/pool.go.html#1680977">i</a></span><span class="op" id="1681001">++</span>&nbsp;<span class="op" id="1681004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681008">l</span>&nbsp;<span class="op" id="1681010">:=</span>&nbsp;<span class="ident" id="1681013"><a href="/sync/pool.go.html#1683588">indexLocal</a></span><span class="op" id="1681023">(</span><span class="ident" id="1681024"><a href="/sync/pool.go.html#1680821">local</a></span><span class="op" id="1681029">,</span>&nbsp;<span class="op" id="1681031">(</span><span class="ident" id="1681032"><a href="/sync/pool.go.html#1680926">pid</a></span><span class="op" id="1681035">+</span><span class="ident" id="1681036"><a href="/sync/pool.go.html#1680977">i</a></span><span class="op" id="1681037">+</span><span class="num" id="1681038">1</span><span class="op" id="1681039">)</span><span class="op" id="1681040">%</span><span class="builtintype" id="1681041">int</span><span class="op" id="1681044">(</span><span class="ident" id="1681045"><a href="/sync/pool.go.html#1680763">size</a></span><span class="op" id="1681049">)</span><span class="op" id="1681050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681054"><a href="/sync/pool.go.html#1681008">l</a></span><span class="op" id="1681055">.</span><span class="ident" id="1681056">Lock</span><span class="op" id="1681060">(</span><span class="op" id="1681061">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681065">last</span>&nbsp;<span class="op" id="1681070">:=</span>&nbsp;<span class="builtinfunc" id="1681073">len</span><span class="op" id="1681076">(</span><span class="ident" id="1681077"><a href="/sync/pool.go.html#1681008">l</a></span><span class="op" id="1681078">.</span><span class="ident" id="1681079">shared</span><span class="op" id="1681085">)</span>&nbsp;<span class="op" id="1681087">-</span>&nbsp;<span class="num" id="1681089">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681093">if</span>&nbsp;<span class="ident" id="1681096"><a href="/sync/pool.go.html#1681065">last</a></span>&nbsp;<span class="op" id="1681101">&gt;=</span>&nbsp;<span class="num" id="1681104">0</span>&nbsp;<span class="op" id="1681106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681111"><a href="/sync/pool.go.html#1680685">x</a></span>&nbsp;<span class="op" id="1681113">=</span>&nbsp;<span class="ident" id="1681115"><a href="/sync/pool.go.html#1681008">l</a></span><span class="op" id="1681116">.</span><span class="ident" id="1681117">shared</span><span class="op" id="1681123">[</span><span class="ident" id="1681124"><a href="/sync/pool.go.html#1681065">last</a></span><span class="op" id="1681128">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681133"><a href="/sync/pool.go.html#1681008">l</a></span><span class="op" id="1681134">.</span><span class="ident" id="1681135">shared</span>&nbsp;<span class="op" id="1681142">=</span>&nbsp;<span class="ident" id="1681144"><a href="/sync/pool.go.html#1681008">l</a></span><span class="op" id="1681145">.</span><span class="ident" id="1681146">shared</span><span class="op" id="1681152">[</span><span class="op" id="1681153">:</span><span class="ident" id="1681154"><a href="/sync/pool.go.html#1681065">last</a></span><span class="op" id="1681158">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681163"><a href="/sync/pool.go.html#1681008">l</a></span><span class="op" id="1681164">.</span><span class="ident" id="1681165">Unlock</span><span class="op" id="1681171">(</span><span class="op" id="1681172">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681177">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1681185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681189"><a href="/sync/pool.go.html#1681008">l</a></span><span class="op" id="1681190">.</span><span class="ident" id="1681191">Unlock</span><span class="op" id="1681197">(</span><span class="op" id="1681198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1681201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681205">if</span>&nbsp;<span class="ident" id="1681208"><a href="/sync/pool.go.html#1680685">x</a></span>&nbsp;<span class="op" id="1681210">==</span>&nbsp;<span class="ident" id="1681213">nil</span>&nbsp;<span class="op" id="1681217">&amp;&amp;</span>&nbsp;<span class="ident" id="1681220"><a href="/sync/pool.go.html#1680665">p</a></span><span class="op" id="1681221">.</span><span class="ident" id="1681222">New</span>&nbsp;<span class="op" id="1681226">!=</span>&nbsp;<span class="ident" id="1681229">nil</span>&nbsp;<span class="op" id="1681233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681237"><a href="/sync/pool.go.html#1680685">x</a></span>&nbsp;<span class="op" id="1681239">=</span>&nbsp;<span class="ident" id="1681241"><a href="/sync/pool.go.html#1680665">p</a></span><span class="op" id="1681242">.</span><span class="ident" id="1681243">New</span><span class="op" id="1681246">(</span><span class="op" id="1681247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1681250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681253">return</span>&nbsp;<span class="ident" id="1681260"><a href="/sync/pool.go.html#1680685">x</a></span><br>
<span class="lineno"></span><span class="op" id="1681262">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="1681265">//&nbsp;pin&nbsp;pins&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;P,&nbsp;disables&nbsp;preemption&nbsp;and&nbsp;returns&nbsp;poolLocal&nbsp;pool&nbsp;for&nbsp;the&nbsp;P.</span><br>
<span class="lineno"></span><span class="comment" id="1681363">//&nbsp;Caller&nbsp;must&nbsp;call&nbsp;runtime_procUnpin()&nbsp;when&nbsp;done&nbsp;with&nbsp;the&nbsp;pool.</span><br>
<span class="lineno"></span><span class="keyword" id="1681428">func</span>&nbsp;<span class="op" id="1681433">(</span><span class="ident" id="1681434">p</span>&nbsp;<span class="op" id="1681436">*</span><span class="ident" id="1681437"><a href="/sync/pool.go.html#1678833">Pool</a></span><span class="op" id="1681441">)</span>&nbsp;<span class="ident" id="1681443">pin</span><span class="op" id="1681446">(</span><span class="op" id="1681447">)</span>&nbsp;<span class="op" id="1681449">*</span><span class="ident" id="1681450"><a href="/sync/pool.go.html#1679208">poolLocal</a></span>&nbsp;<span class="op" id="1681460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681463">pid</span>&nbsp;<span class="op" id="1681467">:=</span>&nbsp;<span class="ident" id="1681470"><a href="/sync/pool.go.html#1683758">runtime_procPin</a></span><span class="op" id="1681485">(</span><span class="op" id="1681486">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1681489">//&nbsp;In&nbsp;pinSlow&nbsp;we&nbsp;store&nbsp;to&nbsp;localSize&nbsp;and&nbsp;then&nbsp;to&nbsp;local,&nbsp;here&nbsp;we&nbsp;load&nbsp;in&nbsp;opposite&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1681577">//&nbsp;Since&nbsp;we&#39;ve&nbsp;disabled&nbsp;preemption,&nbsp;GC&nbsp;can&nbsp;not&nbsp;happen&nbsp;in&nbsp;between.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1681644">//&nbsp;Thus&nbsp;here&nbsp;we&nbsp;must&nbsp;observe&nbsp;local&nbsp;at&nbsp;least&nbsp;as&nbsp;large&nbsp;localSize.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1681709">//&nbsp;We&nbsp;can&nbsp;observe&nbsp;a&nbsp;newer/larger&nbsp;local,&nbsp;it&nbsp;is&nbsp;fine&nbsp;(we&nbsp;must&nbsp;observe&nbsp;its&nbsp;zero-initialized-ness).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681806">s</span>&nbsp;<span class="op" id="1681808">:=</span>&nbsp;<span class="ident" id="1681811"><a href="/sync/pool.go.html#1677453">atomic</a></span><span class="op" id="1681817">.</span><span class="ident" id="1681818">LoadUintptr</span><span class="op" id="1681829">(</span><span class="op" id="1681830">&amp;</span><span class="ident" id="1681831"><a href="/sync/pool.go.html#1681434">p</a></span><span class="op" id="1681832">.</span><span class="ident" id="1681833">localSize</span><span class="op" id="1681842">)</span>&nbsp;<span class="comment" id="1681844">//&nbsp;load-acquire</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681861">l</span>&nbsp;<span class="op" id="1681863">:=</span>&nbsp;<span class="ident" id="1681866"><a href="/sync/pool.go.html#1681434">p</a></span><span class="op" id="1681867">.</span><span class="ident" id="1681868">local</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1681899">//&nbsp;load-consume</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681916">if</span>&nbsp;<span class="builtintype" id="1681919">uintptr</span><span class="op" id="1681926">(</span><span class="ident" id="1681927"><a href="/sync/pool.go.html#1681463">pid</a></span><span class="op" id="1681930">)</span>&nbsp;<span class="op" id="1681932">&lt;</span>&nbsp;<span class="ident" id="1681934"><a href="/sync/pool.go.html#1681806">s</a></span>&nbsp;<span class="op" id="1681936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681940">return</span>&nbsp;<span class="ident" id="1681947"><a href="/sync/pool.go.html#1683588">indexLocal</a></span><span class="op" id="1681957">(</span><span class="ident" id="1681958"><a href="/sync/pool.go.html#1681861">l</a></span><span class="op" id="1681959">,</span>&nbsp;<span class="ident" id="1681961"><a href="/sync/pool.go.html#1681463">pid</a></span><span class="op" id="1681964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1681967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681970">return</span>&nbsp;<span class="ident" id="1681977"><a href="/sync/pool.go.html#1681434">p</a></span><span class="op" id="1681978">.</span><span class="ident" id="1681979">pinSlow</span><span class="op" id="1681986">(</span><span class="op" id="1681987">)</span><br>
<span class="lineno">160</span><span class="op" id="1681989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1681992">func</span>&nbsp;<span class="op" id="1681997">(</span><span class="ident" id="1681998">p</span>&nbsp;<span class="op" id="1682000">*</span><span class="ident" id="1682001"><a href="/sync/pool.go.html#1678833">Pool</a></span><span class="op" id="1682005">)</span>&nbsp;<span class="ident" id="1682007">pinSlow</span><span class="op" id="1682014">(</span><span class="op" id="1682015">)</span>&nbsp;<span class="op" id="1682017">*</span><span class="ident" id="1682018"><a href="/sync/pool.go.html#1679208">poolLocal</a></span>&nbsp;<span class="op" id="1682028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682031">//&nbsp;Retry&nbsp;under&nbsp;the&nbsp;mutex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682058">//&nbsp;Can&nbsp;not&nbsp;lock&nbsp;the&nbsp;mutex&nbsp;while&nbsp;pinned.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682099"><a href="/sync/pool.go.html#1683785">runtime_procUnpin</a></span><span class="op" id="1682116">(</span><span class="op" id="1682117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682120"><a href="/sync/pool.go.html#1683484">allPoolsMu</a></span><span class="op" id="1682130">.</span><span class="ident" id="1682131">Lock</span><span class="op" id="1682135">(</span><span class="op" id="1682136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682139">defer</span>&nbsp;<span class="ident" id="1682145"><a href="/sync/pool.go.html#1683484">allPoolsMu</a></span><span class="op" id="1682155">.</span><span class="ident" id="1682156">Unlock</span><span class="op" id="1682162">(</span><span class="op" id="1682163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682166">pid</span>&nbsp;<span class="op" id="1682170">:=</span>&nbsp;<span class="ident" id="1682173"><a href="/sync/pool.go.html#1683758">runtime_procPin</a></span><span class="op" id="1682188">(</span><span class="op" id="1682189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682192">//&nbsp;poolCleanup&nbsp;won&#39;t&nbsp;be&nbsp;called&nbsp;while&nbsp;we&nbsp;are&nbsp;pinned.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682245">s</span>&nbsp;<span class="op" id="1682247">:=</span>&nbsp;<span class="ident" id="1682250"><a href="/sync/pool.go.html#1681998">p</a></span><span class="op" id="1682251">.</span><span class="ident" id="1682252">localSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682263">l</span>&nbsp;<span class="op" id="1682265">:=</span>&nbsp;<span class="ident" id="1682268"><a href="/sync/pool.go.html#1681998">p</a></span><span class="op" id="1682269">.</span><span class="ident" id="1682270">local</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682277">if</span>&nbsp;<span class="builtintype" id="1682280">uintptr</span><span class="op" id="1682287">(</span><span class="ident" id="1682288"><a href="/sync/pool.go.html#1682166">pid</a></span><span class="op" id="1682291">)</span>&nbsp;<span class="op" id="1682293">&lt;</span>&nbsp;<span class="ident" id="1682295"><a href="/sync/pool.go.html#1682245">s</a></span>&nbsp;<span class="op" id="1682297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682301">return</span>&nbsp;<span class="ident" id="1682308"><a href="/sync/pool.go.html#1683588">indexLocal</a></span><span class="op" id="1682318">(</span><span class="ident" id="1682319"><a href="/sync/pool.go.html#1682263">l</a></span><span class="op" id="1682320">,</span>&nbsp;<span class="ident" id="1682322"><a href="/sync/pool.go.html#1682166">pid</a></span><span class="op" id="1682325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1682328">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682331">if</span>&nbsp;<span class="ident" id="1682334"><a href="/sync/pool.go.html#1681998">p</a></span><span class="op" id="1682335">.</span><span class="ident" id="1682336">local</span>&nbsp;<span class="op" id="1682342">==</span>&nbsp;<span class="ident" id="1682345">nil</span>&nbsp;<span class="op" id="1682349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682353"><a href="/sync/pool.go.html#1683502">allPools</a></span>&nbsp;<span class="op" id="1682362">=</span>&nbsp;<span class="builtinfunc" id="1682364">append</span><span class="op" id="1682370">(</span><span class="ident" id="1682371"><a href="/sync/pool.go.html#1683502">allPools</a></span><span class="op" id="1682379">,</span>&nbsp;<span class="ident" id="1682381"><a href="/sync/pool.go.html#1681998">p</a></span><span class="op" id="1682382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1682385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682388">//&nbsp;If&nbsp;GOMAXPROCS&nbsp;changes&nbsp;between&nbsp;GCs,&nbsp;we&nbsp;re-allocate&nbsp;the&nbsp;array&nbsp;and&nbsp;lose&nbsp;the&nbsp;old&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682474">size</span>&nbsp;<span class="op" id="1682479">:=</span>&nbsp;<span class="ident" id="1682482"><a href="/sync/pool.go.html#1677442">runtime</a></span><span class="op" id="1682489">.</span><span class="ident" id="1682490">GOMAXPROCS</span><span class="op" id="1682500">(</span><span class="num" id="1682501">0</span><span class="op" id="1682502">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682505">local</span>&nbsp;<span class="op" id="1682511">:=</span>&nbsp;<span class="builtinfunc" id="1682514">make</span><span class="op" id="1682518">(</span><span class="op" id="1682519">[</span><span class="op" id="1682520">]</span><span class="ident" id="1682521"><a href="/sync/pool.go.html#1679208">poolLocal</a></span><span class="op" id="1682530">,</span>&nbsp;<span class="ident" id="1682532"><a href="/sync/pool.go.html#1682474">size</a></span><span class="op" id="1682536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682539"><a href="/sync/pool.go.html#1677453">atomic</a></span><span class="op" id="1682545">.</span><span class="ident" id="1682546">StorePointer</span><span class="op" id="1682558">(</span><span class="op" id="1682559">(</span><span class="op" id="1682560">*</span><span class="ident" id="1682561"><a href="/sync/pool.go.html#1677468">unsafe</a></span><span class="op" id="1682567">.</span><span class="ident" id="1682568">Pointer</span><span class="op" id="1682575">)</span><span class="op" id="1682576">(</span><span class="op" id="1682577">&amp;</span><span class="ident" id="1682578"><a href="/sync/pool.go.html#1681998">p</a></span><span class="op" id="1682579">.</span><span class="ident" id="1682580">local</span><span class="op" id="1682585">)</span><span class="op" id="1682586">,</span>&nbsp;<span class="ident" id="1682588"><a href="/sync/pool.go.html#1677468">unsafe</a></span><span class="op" id="1682594">.</span><span class="ident" id="1682595">Pointer</span><span class="op" id="1682602">(</span><span class="op" id="1682603">&amp;</span><span class="ident" id="1682604"><a href="/sync/pool.go.html#1682505">local</a></span><span class="op" id="1682609">[</span><span class="num" id="1682610">0</span><span class="op" id="1682611">]</span><span class="op" id="1682612">)</span><span class="op" id="1682613">)</span>&nbsp;<span class="comment" id="1682615">//&nbsp;store-release</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682633"><a href="/sync/pool.go.html#1677453">atomic</a></span><span class="op" id="1682639">.</span><span class="ident" id="1682640">StoreUintptr</span><span class="op" id="1682652">(</span><span class="op" id="1682653">&amp;</span><span class="ident" id="1682654"><a href="/sync/pool.go.html#1681998">p</a></span><span class="op" id="1682655">.</span><span class="ident" id="1682656">localSize</span><span class="op" id="1682665">,</span>&nbsp;<span class="builtintype" id="1682667">uintptr</span><span class="op" id="1682674">(</span><span class="ident" id="1682675"><a href="/sync/pool.go.html#1682474">size</a></span><span class="op" id="1682679">)</span><span class="op" id="1682680">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1682709">//&nbsp;store-release</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682727">return</span>&nbsp;<span class="op" id="1682734">&amp;</span><span class="ident" id="1682735"><a href="/sync/pool.go.html#1682505">local</a></span><span class="op" id="1682740">[</span><span class="ident" id="1682741"><a href="/sync/pool.go.html#1682166">pid</a></span><span class="op" id="1682744">]</span><br>
<span class="lineno"></span><span class="op" id="1682746">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="1682749">func</span>&nbsp;<span class="ident" id="1682754">poolCleanup</span><span class="op" id="1682765">(</span><span class="op" id="1682766">)</span>&nbsp;<span class="op" id="1682768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682771">//&nbsp;This&nbsp;function&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;world&nbsp;stopped,&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682865">//&nbsp;It&nbsp;must&nbsp;not&nbsp;allocate&nbsp;and&nbsp;probably&nbsp;should&nbsp;not&nbsp;call&nbsp;any&nbsp;runtime&nbsp;functions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682942">//&nbsp;Defensively&nbsp;zero&nbsp;out&nbsp;everything,&nbsp;2&nbsp;reasons:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682990">//&nbsp;1.&nbsp;To&nbsp;prevent&nbsp;false&nbsp;retention&nbsp;of&nbsp;whole&nbsp;Pools.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1683040">//&nbsp;2.&nbsp;If&nbsp;GC&nbsp;happens&nbsp;while&nbsp;a&nbsp;goroutine&nbsp;works&nbsp;with&nbsp;l.shared&nbsp;in&nbsp;Put/Get,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1683111">//&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;will&nbsp;retain&nbsp;whole&nbsp;Pool.&nbsp;So&nbsp;next&nbsp;cycle&nbsp;memory&nbsp;consumption&nbsp;would&nbsp;be&nbsp;doubled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683196">for</span>&nbsp;<span class="ident" id="1683200">i</span><span class="op" id="1683201">,</span>&nbsp;<span class="ident" id="1683203">p</span>&nbsp;<span class="op" id="1683205">:=</span>&nbsp;<span class="keyword" id="1683208">range</span>&nbsp;<span class="ident" id="1683214"><a href="/sync/pool.go.html#1683502">allPools</a></span>&nbsp;<span class="op" id="1683223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683227"><a href="/sync/pool.go.html#1683502">allPools</a></span><span class="op" id="1683235">[</span><span class="ident" id="1683236"><a href="/sync/pool.go.html#1683200">i</a></span><span class="op" id="1683237">]</span>&nbsp;<span class="op" id="1683239">=</span>&nbsp;<span class="ident" id="1683241">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683247">for</span>&nbsp;<span class="ident" id="1683251">i</span>&nbsp;<span class="op" id="1683253">:=</span>&nbsp;<span class="num" id="1683256">0</span><span class="op" id="1683257">;</span>&nbsp;<span class="ident" id="1683259"><a href="/sync/pool.go.html#1683251">i</a></span>&nbsp;<span class="op" id="1683261">&lt;</span>&nbsp;<span class="builtintype" id="1683263">int</span><span class="op" id="1683266">(</span><span class="ident" id="1683267"><a href="/sync/pool.go.html#1683203">p</a></span><span class="op" id="1683268">.</span><span class="ident" id="1683269">localSize</span><span class="op" id="1683278">)</span><span class="op" id="1683279">;</span>&nbsp;<span class="ident" id="1683281"><a href="/sync/pool.go.html#1683251">i</a></span><span class="op" id="1683282">++</span>&nbsp;<span class="op" id="1683285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683290">l</span>&nbsp;<span class="op" id="1683292">:=</span>&nbsp;<span class="ident" id="1683295"><a href="/sync/pool.go.html#1683588">indexLocal</a></span><span class="op" id="1683305">(</span><span class="ident" id="1683306"><a href="/sync/pool.go.html#1683203">p</a></span><span class="op" id="1683307">.</span><span class="ident" id="1683308">local</span><span class="op" id="1683313">,</span>&nbsp;<span class="ident" id="1683315"><a href="/sync/pool.go.html#1683251">i</a></span><span class="op" id="1683316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683321"><a href="/sync/pool.go.html#1683290">l</a></span><span class="op" id="1683322">.</span><span class="ident" id="1683323">private</span>&nbsp;<span class="op" id="1683331">=</span>&nbsp;<span class="ident" id="1683333">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683340">for</span>&nbsp;<span class="ident" id="1683344">j</span>&nbsp;<span class="op" id="1683346">:=</span>&nbsp;<span class="keyword" id="1683349">range</span>&nbsp;<span class="ident" id="1683355"><a href="/sync/pool.go.html#1683290">l</a></span><span class="op" id="1683356">.</span><span class="ident" id="1683357">shared</span>&nbsp;<span class="op" id="1683364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683370"><a href="/sync/pool.go.html#1683290">l</a></span><span class="op" id="1683371">.</span><span class="ident" id="1683372">shared</span><span class="op" id="1683378">[</span><span class="ident" id="1683379"><a href="/sync/pool.go.html#1683344">j</a></span><span class="op" id="1683380">]</span>&nbsp;<span class="op" id="1683382">=</span>&nbsp;<span class="ident" id="1683384">nil</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683396"><a href="/sync/pool.go.html#1683290">l</a></span><span class="op" id="1683397">.</span><span class="ident" id="1683398">shared</span>&nbsp;<span class="op" id="1683405">=</span>&nbsp;<span class="ident" id="1683407">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683417"><a href="/sync/pool.go.html#1683203">p</a></span><span class="op" id="1683418">.</span><span class="ident" id="1683419">local</span>&nbsp;<span class="op" id="1683425">=</span>&nbsp;<span class="ident" id="1683427">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683433"><a href="/sync/pool.go.html#1683203">p</a></span><span class="op" id="1683434">.</span><span class="ident" id="1683435">localSize</span>&nbsp;<span class="op" id="1683445">=</span>&nbsp;<span class="num" id="1683447">0</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683453"><a href="/sync/pool.go.html#1683502">allPools</a></span>&nbsp;<span class="op" id="1683462">=</span>&nbsp;<span class="op" id="1683464">[</span><span class="op" id="1683465">]</span><span class="op" id="1683466">*</span><span class="ident" id="1683467"><a href="/sync/pool.go.html#1678833">Pool</a></span><span class="op" id="1683471">{</span><span class="op" id="1683472">}</span><br>
<span class="lineno"></span><span class="op" id="1683474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1683477">var</span>&nbsp;<span class="op" id="1683481">(</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683484">allPoolsMu</span>&nbsp;<span class="ident" id="1683495"><a href="/sync/mutex.go.html#1673941">Mutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683502">allPools</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1683513">[</span><span class="op" id="1683514">]</span><span class="op" id="1683515">*</span><span class="ident" id="1683516"><a href="/sync/pool.go.html#1678833">Pool</a></span><br>
<span class="lineno"></span><span class="op" id="1683521">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1683524">func</span>&nbsp;<span class="ident" id="1683529">init</span><span class="op" id="1683533">(</span><span class="op" id="1683534">)</span>&nbsp;<span class="op" id="1683536">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683539"><a href="/sync/pool.go.html#1683709">runtime_registerPoolCleanup</a></span><span class="op" id="1683566">(</span><span class="ident" id="1683567"><a href="/sync/pool.go.html#1682754">poolCleanup</a></span><span class="op" id="1683578">)</span><br>
<span class="lineno"></span><span class="op" id="1683580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1683583">func</span>&nbsp;<span class="ident" id="1683588">indexLocal</span><span class="op" id="1683598">(</span><span class="ident" id="1683599">l</span>&nbsp;<span class="ident" id="1683601"><a href="/sync/pool.go.html#1677468">unsafe</a></span><span class="op" id="1683607">.</span><span class="ident" id="1683608">Pointer</span><span class="op" id="1683615">,</span>&nbsp;<span class="ident" id="1683617">i</span>&nbsp;<span class="builtintype" id="1683619">int</span><span class="op" id="1683622">)</span>&nbsp;<span class="op" id="1683624">*</span><span class="ident" id="1683625"><a href="/sync/pool.go.html#1679208">poolLocal</a></span>&nbsp;<span class="op" id="1683635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683638">return</span>&nbsp;<span class="op" id="1683645">&amp;</span><span class="op" id="1683646">(</span><span class="op" id="1683647">*</span><span class="op" id="1683648">[</span><span class="num" id="1683649">1000000</span><span class="op" id="1683656">]</span><span class="ident" id="1683657"><a href="/sync/pool.go.html#1679208">poolLocal</a></span><span class="op" id="1683666">)</span><span class="op" id="1683667">(</span><span class="ident" id="1683668"><a href="/sync/pool.go.html#1683599">l</a></span><span class="op" id="1683669">)</span><span class="op" id="1683670">[</span><span class="ident" id="1683671"><a href="/sync/pool.go.html#1683617">i</a></span><span class="op" id="1683672">]</span><br>
<span class="lineno">220</span><span class="op" id="1683674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1683677">//&nbsp;Implemented&nbsp;in&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="keyword" id="1683704">func</span>&nbsp;<span class="ident" id="1683709">runtime_registerPoolCleanup</span><span class="op" id="1683736">(</span><span class="ident" id="1683737">cleanup</span>&nbsp;<span class="keyword" id="1683745">func</span><span class="op" id="1683749">(</span><span class="op" id="1683750">)</span><span class="op" id="1683751">)</span><br>
<span class="lineno"></span><span class="keyword" id="1683753">func</span>&nbsp;<span class="ident" id="1683758">runtime_procPin</span><span class="op" id="1683773">(</span><span class="op" id="1683774">)</span>&nbsp;<span class="builtintype" id="1683776">int</span><br>
<span class="lineno">225</span><span class="keyword" id="1683780">func</span>&nbsp;<span class="ident" id="1683785">runtime_procUnpin</span><span class="op" id="1683802">(</span><span class="op" id="1683803">)</span>
</div>
</body>
</html>
