<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2326294">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2326349">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2326403">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2326454">package</span>&nbsp;<span class="ident" id="2326462">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2326468">//&nbsp;Ldexp&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;Frexp.</span><br>
<span class="lineno"></span><span class="comment" id="2326502">//&nbsp;It&nbsp;returns&nbsp;frac&nbsp;×&nbsp;2**exp.</span><br>
<span class="lineno"></span><span class="comment" id="2326532">//</span><br>
<span class="lineno">10</span><span class="comment" id="2326535">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2326557">//&nbsp;&nbsp;&nbsp;&nbspLdexp(±0,&nbsp;exp)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2326582">//&nbsp;&nbsp;&nbsp;&nbspLdexp(±Inf,&nbsp;exp)&nbsp;=&nbsp;±Inf</span><br>
<span class="lineno"></span><span class="comment" id="2326611">//&nbsp;&nbsp;&nbsp;&nbspLdexp(NaN,&nbsp;exp)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2326636">func</span>&nbsp;<span class="ident" id="2326641">Ldexp</span><span class="op" id="2326646">(</span><span class="ident" id="2326647">frac</span>&nbsp;<span class="builtintype" id="2326652">float64</span><span class="op" id="2326659">,</span>&nbsp;<span class="ident" id="2326661">exp</span>&nbsp;<span class="builtintype" id="2326665">int</span><span class="op" id="2326668">)</span>&nbsp;<span class="builtintype" id="2326670">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="2326679">func</span>&nbsp;<span class="ident" id="2326684">ldexp</span><span class="op" id="2326689">(</span><span class="ident" id="2326690">frac</span>&nbsp;<span class="builtintype" id="2326695">float64</span><span class="op" id="2326702">,</span>&nbsp;<span class="ident" id="2326704">exp</span>&nbsp;<span class="builtintype" id="2326708">int</span><span class="op" id="2326711">)</span>&nbsp;<span class="builtintype" id="2326713">float64</span>&nbsp;<span class="op" id="2326721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2326724">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326742">switch</span>&nbsp;<span class="op" id="2326749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326752">case</span>&nbsp;<span class="ident" id="2326757"><a href="/math/ldexp.go.html#2326690">frac</a></span>&nbsp;<span class="op" id="2326762">==</span>&nbsp;<span class="num" id="2326765">0</span><span class="op" id="2326766">:</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326770">return</span>&nbsp;<span class="ident" id="2326777"><a href="/math/ldexp.go.html#2326690">frac</a></span>&nbsp;<span class="comment" id="2326782">//&nbsp;correctly&nbsp;return&nbsp;-0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326806">case</span>&nbsp;<span class="ident" id="2326811"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2326816">(</span><span class="ident" id="2326817"><a href="/math/ldexp.go.html#2326690">frac</a></span><span class="op" id="2326821">,</span>&nbsp;<span class="num" id="2326823">0</span><span class="op" id="2326824">)</span>&nbsp;<span class="op" id="2326826">||</span>&nbsp;<span class="ident" id="2326829"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2326834">(</span><span class="ident" id="2326835"><a href="/math/ldexp.go.html#2326690">frac</a></span><span class="op" id="2326839">)</span><span class="op" id="2326840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326844">return</span>&nbsp;<span class="ident" id="2326851"><a href="/math/ldexp.go.html#2326690">frac</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2326857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326860"><a href="/math/ldexp.go.html#2326690">frac</a></span><span class="op" id="2326864">,</span>&nbsp;<span class="ident" id="2326866">e</span>&nbsp;<span class="op" id="2326868">:=</span>&nbsp;<span class="ident" id="2326871"><a href="/math/bits.go.html#2253000">normalize</a></span><span class="op" id="2326880">(</span><span class="ident" id="2326881"><a href="/math/ldexp.go.html#2326690">frac</a></span><span class="op" id="2326885">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326888"><a href="/math/ldexp.go.html#2326704">exp</a></span>&nbsp;<span class="op" id="2326892">+=</span>&nbsp;<span class="ident" id="2326895"><a href="/math/ldexp.go.html#2326866">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326898">x</span>&nbsp;<span class="op" id="2326900">:=</span>&nbsp;<span class="ident" id="2326903"><a href="/math/unsafe.go.html#2380703">Float64bits</a></span><span class="op" id="2326914">(</span><span class="ident" id="2326915"><a href="/math/ldexp.go.html#2326690">frac</a></span><span class="op" id="2326919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2326922"><a href="/math/ldexp.go.html#2326704">exp</a></span>&nbsp;<span class="op" id="2326926">+=</span>&nbsp;<span class="builtintype" id="2326929">int</span><span class="op" id="2326932">(</span><span class="ident" id="2326933"><a href="/math/ldexp.go.html#2326898">x</a></span><span class="op" id="2326934">&gt;&gt;</span><span class="ident" id="2326936"><a href="/math/bits.go.html#2251639">shift</a></span><span class="op" id="2326941">)</span><span class="op" id="2326942">&amp;</span><span class="ident" id="2326943"><a href="/math/bits.go.html#2251621">mask</a></span>&nbsp;<span class="op" id="2326948">-</span>&nbsp;<span class="ident" id="2326950"><a href="/math/bits.go.html#2251663">bias</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326956">if</span>&nbsp;<span class="ident" id="2326959"><a href="/math/ldexp.go.html#2326704">exp</a></span>&nbsp;<span class="op" id="2326963">&lt;</span>&nbsp;<span class="op" id="2326965">-</span><span class="num" id="2326966">1074</span>&nbsp;<span class="op" id="2326971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2326975">return</span>&nbsp;<span class="ident" id="2326982"><a href="/math/copysign.go.html#2257108">Copysign</a></span><span class="op" id="2326990">(</span><span class="num" id="2326991">0</span><span class="op" id="2326992">,</span>&nbsp;<span class="ident" id="2326994"><a href="/math/ldexp.go.html#2326690">frac</a></span><span class="op" id="2326998">)</span>&nbsp;<span class="comment" id="2327000">//&nbsp;underflow</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2327014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327017">if</span>&nbsp;<span class="ident" id="2327020"><a href="/math/ldexp.go.html#2326704">exp</a></span>&nbsp;<span class="op" id="2327024">&gt;</span>&nbsp;<span class="num" id="2327026">1023</span>&nbsp;<span class="op" id="2327031">{</span>&nbsp;<span class="comment" id="2327033">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327047">if</span>&nbsp;<span class="ident" id="2327050"><a href="/math/ldexp.go.html#2326690">frac</a></span>&nbsp;<span class="op" id="2327055">&lt;</span>&nbsp;<span class="num" id="2327057">0</span>&nbsp;<span class="op" id="2327059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327064">return</span>&nbsp;<span class="ident" id="2327071"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2327074">(</span><span class="op" id="2327075">-</span><span class="num" id="2327076">1</span><span class="op" id="2327077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2327081">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327085">return</span>&nbsp;<span class="ident" id="2327092"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2327095">(</span><span class="num" id="2327096">1</span><span class="op" id="2327097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2327100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327103">var</span>&nbsp;<span class="ident" id="2327107">m</span>&nbsp;<span class="builtintype" id="2327109">float64</span>&nbsp;<span class="op" id="2327117">=</span>&nbsp;<span class="num" id="2327119">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327122">if</span>&nbsp;<span class="ident" id="2327125"><a href="/math/ldexp.go.html#2326704">exp</a></span>&nbsp;<span class="op" id="2327129">&lt;</span>&nbsp;<span class="op" id="2327131">-</span><span class="num" id="2327132">1022</span>&nbsp;<span class="op" id="2327137">{</span>&nbsp;<span class="comment" id="2327139">//&nbsp;denormal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327153"><a href="/math/ldexp.go.html#2326704">exp</a></span>&nbsp;<span class="op" id="2327157">+=</span>&nbsp;<span class="num" id="2327160">52</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327165"><a href="/math/ldexp.go.html#2327107">m</a></span>&nbsp;<span class="op" id="2327167">=</span>&nbsp;<span class="num" id="2327169">1.0</span>&nbsp;<span class="op" id="2327173">/</span>&nbsp;<span class="op" id="2327175">(</span><span class="num" id="2327176">1</span>&nbsp;<span class="op" id="2327178">&lt;&lt;</span>&nbsp;<span class="num" id="2327181">52</span><span class="op" id="2327183">)</span>&nbsp;<span class="comment" id="2327185">//&nbsp;2**-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2327196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327199"><a href="/math/ldexp.go.html#2326898">x</a></span>&nbsp;<span class="op" id="2327201">&amp;^=</span>&nbsp;<span class="ident" id="2327205"><a href="/math/bits.go.html#2251621">mask</a></span>&nbsp;<span class="op" id="2327210">&lt;&lt;</span>&nbsp;<span class="ident" id="2327213"><a href="/math/bits.go.html#2251639">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327220"><a href="/math/ldexp.go.html#2326898">x</a></span>&nbsp;<span class="op" id="2327222">|=</span>&nbsp;<span class="ident" id="2327225">uint64</span><span class="op" id="2327231">(</span><span class="ident" id="2327232"><a href="/math/ldexp.go.html#2326704">exp</a></span><span class="op" id="2327235">+</span><span class="ident" id="2327236"><a href="/math/bits.go.html#2251663">bias</a></span><span class="op" id="2327240">)</span>&nbsp;<span class="op" id="2327242">&lt;&lt;</span>&nbsp;<span class="ident" id="2327245"><a href="/math/bits.go.html#2251639">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327252">return</span>&nbsp;<span class="ident" id="2327259"><a href="/math/ldexp.go.html#2327107">m</a></span>&nbsp;<span class="op" id="2327261">*</span>&nbsp;<span class="ident" id="2327263"><a href="/math/unsafe.go.html#2380889">Float64frombits</a></span><span class="op" id="2327278">(</span><span class="ident" id="2327279"><a href="/math/ldexp.go.html#2326898">x</a></span><span class="op" id="2327280">)</span><br>
<span class="lineno">45</span><span class="op" id="2327282">}</span>
</div>
</body>
</html>
