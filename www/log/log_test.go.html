<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7776859">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7776914">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7776968">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7777019">package</span>&nbsp;<span class="ident" id="7777027">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7777032">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7777064">import</span>&nbsp;<span class="op" id="7777071">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7777074">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7777083">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7777089">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7777099">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7777109">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7777112">const</span>&nbsp;<span class="op" id="7777118">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777121">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777135">=</span>&nbsp;<span class="string" id="7777137">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777183">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777197">=</span>&nbsp;<span class="string" id="7777199">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777235">Rmicroseconds</span>&nbsp;<span class="op" id="7777249">=</span>&nbsp;<span class="string" id="7777251">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777287">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777301">=</span>&nbsp;<span class="string" id="7777303">`(54|56):`</span>&nbsp;<span class="comment" id="7777314">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777376">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777390">=</span>&nbsp;<span class="string" id="7777392">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7777418">+</span>&nbsp;<span class="ident" id="7777420">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777427">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777441">=</span>&nbsp;<span class="string" id="7777443">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7777466">+</span>&nbsp;<span class="ident" id="7777468">Rline</span><br>
<span class="lineno"></span><span class="op" id="7777474">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7777477">type</span>&nbsp;<span class="ident" id="7777482">tester</span>&nbsp;<span class="keyword" id="7777489">struct</span>&nbsp;<span class="op" id="7777496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777499">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7777507">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777512">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="7777520">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7777528">pattern</span>&nbsp;<span class="builtintype" id="7777536">string</span>&nbsp;<span class="comment" id="7777543">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="7777616">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="7777619">var</span>&nbsp;<span class="ident" id="7777623">tests</span>&nbsp;<span class="op" id="7777629">=</span>&nbsp;<span class="op" id="7777631">[</span><span class="op" id="7777632">]</span><span class="ident" id="7777633">tester</span><span class="op" id="7777639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7777642">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777665">{</span><span class="num" id="7777666">0</span><span class="op" id="7777667">,</span>&nbsp;<span class="string" id="7777669">&#34;&#34;</span><span class="op" id="7777671">,</span>&nbsp;<span class="string" id="7777673">&#34;&#34;</span><span class="op" id="7777675">}</span><span class="op" id="7777676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777679">{</span><span class="num" id="7777680">0</span><span class="op" id="7777681">,</span>&nbsp;<span class="string" id="7777683">&#34;XXX&#34;</span><span class="op" id="7777688">,</span>&nbsp;<span class="string" id="7777690">&#34;XXX&#34;</span><span class="op" id="7777695">}</span><span class="op" id="7777696">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777699">{</span><span class="ident" id="7777700">Ldate</span><span class="op" id="7777705">,</span>&nbsp;<span class="string" id="7777707">&#34;&#34;</span><span class="op" id="7777709">,</span>&nbsp;<span class="ident" id="7777711">Rdate</span>&nbsp;<span class="op" id="7777717">+</span>&nbsp;<span class="string" id="7777719">&#34;&nbsp;&#34;</span><span class="op" id="7777722">}</span><span class="op" id="7777723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777726">{</span><span class="ident" id="7777727">Ltime</span><span class="op" id="7777732">,</span>&nbsp;<span class="string" id="7777734">&#34;&#34;</span><span class="op" id="7777736">,</span>&nbsp;<span class="ident" id="7777738">Rtime</span>&nbsp;<span class="op" id="7777744">+</span>&nbsp;<span class="string" id="7777746">&#34;&nbsp;&#34;</span><span class="op" id="7777749">}</span><span class="op" id="7777750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777753">{</span><span class="ident" id="7777754">Ltime</span>&nbsp;<span class="op" id="7777760">|</span>&nbsp;<span class="ident" id="7777762">Lmicroseconds</span><span class="op" id="7777775">,</span>&nbsp;<span class="string" id="7777777">&#34;&#34;</span><span class="op" id="7777779">,</span>&nbsp;<span class="ident" id="7777781">Rtime</span>&nbsp;<span class="op" id="7777787">+</span>&nbsp;<span class="ident" id="7777789">Rmicroseconds</span>&nbsp;<span class="op" id="7777803">+</span>&nbsp;<span class="string" id="7777805">&#34;&nbsp;&#34;</span><span class="op" id="7777808">}</span><span class="op" id="7777809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777812">{</span><span class="ident" id="7777813">Lmicroseconds</span><span class="op" id="7777826">,</span>&nbsp;<span class="string" id="7777828">&#34;&#34;</span><span class="op" id="7777830">,</span>&nbsp;<span class="ident" id="7777832">Rtime</span>&nbsp;<span class="op" id="7777838">+</span>&nbsp;<span class="ident" id="7777840">Rmicroseconds</span>&nbsp;<span class="op" id="7777854">+</span>&nbsp;<span class="string" id="7777856">&#34;&nbsp;&#34;</span><span class="op" id="7777859">}</span><span class="op" id="7777860">,</span>&nbsp;<span class="comment" id="7777862">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777888">{</span><span class="ident" id="7777889">Llongfile</span><span class="op" id="7777898">,</span>&nbsp;<span class="string" id="7777900">&#34;&#34;</span><span class="op" id="7777902">,</span>&nbsp;<span class="ident" id="7777904">Rlongfile</span>&nbsp;<span class="op" id="7777914">+</span>&nbsp;<span class="string" id="7777916">&#34;&nbsp;&#34;</span><span class="op" id="7777919">}</span><span class="op" id="7777920">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777923">{</span><span class="ident" id="7777924">Lshortfile</span><span class="op" id="7777934">,</span>&nbsp;<span class="string" id="7777936">&#34;&#34;</span><span class="op" id="7777938">,</span>&nbsp;<span class="ident" id="7777940">Rshortfile</span>&nbsp;<span class="op" id="7777951">+</span>&nbsp;<span class="string" id="7777953">&#34;&nbsp;&#34;</span><span class="op" id="7777956">}</span><span class="op" id="7777957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7777960">{</span><span class="ident" id="7777961">Llongfile</span>&nbsp;<span class="op" id="7777971">|</span>&nbsp;<span class="ident" id="7777973">Lshortfile</span><span class="op" id="7777983">,</span>&nbsp;<span class="string" id="7777985">&#34;&#34;</span><span class="op" id="7777987">,</span>&nbsp;<span class="ident" id="7777989">Rshortfile</span>&nbsp;<span class="op" id="7778000">+</span>&nbsp;<span class="string" id="7778002">&#34;&nbsp;&#34;</span><span class="op" id="7778005">}</span><span class="op" id="7778006">,</span>&nbsp;<span class="comment" id="7778008">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7778041">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778065">{</span><span class="ident" id="7778066">Ldate</span>&nbsp;<span class="op" id="7778072">|</span>&nbsp;<span class="ident" id="7778074">Ltime</span>&nbsp;<span class="op" id="7778080">|</span>&nbsp;<span class="ident" id="7778082">Lmicroseconds</span>&nbsp;<span class="op" id="7778096">|</span>&nbsp;<span class="ident" id="7778098">Llongfile</span><span class="op" id="7778107">,</span>&nbsp;<span class="string" id="7778109">&#34;XXX&#34;</span><span class="op" id="7778114">,</span>&nbsp;<span class="string" id="7778116">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7778122">+</span>&nbsp;<span class="ident" id="7778124">Rdate</span>&nbsp;<span class="op" id="7778130">+</span>&nbsp;<span class="string" id="7778132">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7778136">+</span>&nbsp;<span class="ident" id="7778138">Rtime</span>&nbsp;<span class="op" id="7778144">+</span>&nbsp;<span class="ident" id="7778146">Rmicroseconds</span>&nbsp;<span class="op" id="7778160">+</span>&nbsp;<span class="string" id="7778162">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7778166">+</span>&nbsp;<span class="ident" id="7778168">Rlongfile</span>&nbsp;<span class="op" id="7778178">+</span>&nbsp;<span class="string" id="7778180">&#34;&nbsp;&#34;</span><span class="op" id="7778183">}</span><span class="op" id="7778184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778187">{</span><span class="ident" id="7778188">Ldate</span>&nbsp;<span class="op" id="7778194">|</span>&nbsp;<span class="ident" id="7778196">Ltime</span>&nbsp;<span class="op" id="7778202">|</span>&nbsp;<span class="ident" id="7778204">Lmicroseconds</span>&nbsp;<span class="op" id="7778218">|</span>&nbsp;<span class="ident" id="7778220">Lshortfile</span><span class="op" id="7778230">,</span>&nbsp;<span class="string" id="7778232">&#34;XXX&#34;</span><span class="op" id="7778237">,</span>&nbsp;<span class="string" id="7778239">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7778245">+</span>&nbsp;<span class="ident" id="7778247">Rdate</span>&nbsp;<span class="op" id="7778253">+</span>&nbsp;<span class="string" id="7778255">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7778259">+</span>&nbsp;<span class="ident" id="7778261">Rtime</span>&nbsp;<span class="op" id="7778267">+</span>&nbsp;<span class="ident" id="7778269">Rmicroseconds</span>&nbsp;<span class="op" id="7778283">+</span>&nbsp;<span class="string" id="7778285">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7778289">+</span>&nbsp;<span class="ident" id="7778291">Rshortfile</span>&nbsp;<span class="op" id="7778302">+</span>&nbsp;<span class="string" id="7778304">&#34;&nbsp;&#34;</span><span class="op" id="7778307">}</span><span class="op" id="7778308">,</span><br>
<span class="lineno">45</span><span class="op" id="7778310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7778313">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="7778395">func</span>&nbsp;<span class="ident" id="7778400">testPrint</span><span class="op" id="7778409">(</span><span class="ident" id="7778410">t</span>&nbsp;<span class="op" id="7778412">*</span><span class="ident" id="7778413">testing</span><span class="op" id="7778420">.</span><span class="ident" id="7778421">T</span><span class="op" id="7778422">,</span>&nbsp;<span class="ident" id="7778424">flag</span>&nbsp;<span class="builtintype" id="7778429">int</span><span class="op" id="7778432">,</span>&nbsp;<span class="ident" id="7778434">prefix</span>&nbsp;<span class="builtintype" id="7778441">string</span><span class="op" id="7778447">,</span>&nbsp;<span class="ident" id="7778449">pattern</span>&nbsp;<span class="builtintype" id="7778457">string</span><span class="op" id="7778463">,</span>&nbsp;<span class="ident" id="7778465">useFormat</span>&nbsp;<span class="builtintype" id="7778475">bool</span><span class="op" id="7778479">)</span>&nbsp;<span class="op" id="7778481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778484">buf</span>&nbsp;<span class="op" id="7778488">:=</span>&nbsp;<span class="builtinfunc" id="7778491">new</span><span class="op" id="7778494">(</span><span class="ident" id="7778495">bytes</span><span class="op" id="7778500">.</span><span class="ident" id="7778501">Buffer</span><span class="op" id="7778507">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778510">SetOutput</span><span class="op" id="7778519">(</span><span class="ident" id="7778520">buf</span><span class="op" id="7778523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778526">SetFlags</span><span class="op" id="7778534">(</span><span class="ident" id="7778535">flag</span><span class="op" id="7778539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778542">SetPrefix</span><span class="op" id="7778551">(</span><span class="ident" id="7778552">prefix</span><span class="op" id="7778558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778561">if</span>&nbsp;<span class="ident" id="7778564">useFormat</span>&nbsp;<span class="op" id="7778574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778578">Printf</span><span class="op" id="7778584">(</span><span class="string" id="7778585">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="7778601">,</span>&nbsp;<span class="num" id="7778603">23</span><span class="op" id="7778605">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778608">}</span>&nbsp;<span class="keyword" id="7778610">else</span>&nbsp;<span class="op" id="7778615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778619">Println</span><span class="op" id="7778626">(</span><span class="string" id="7778627">&#34;hello&#34;</span><span class="op" id="7778634">,</span>&nbsp;<span class="num" id="7778636">23</span><span class="op" id="7778638">,</span>&nbsp;<span class="string" id="7778640">&#34;world&#34;</span><span class="op" id="7778647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778653">line</span>&nbsp;<span class="op" id="7778658">:=</span>&nbsp;<span class="ident" id="7778661">buf</span><span class="op" id="7778664">.</span><span class="ident" id="7778665">String</span><span class="op" id="7778671">(</span><span class="op" id="7778672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778675">line</span>&nbsp;<span class="op" id="7778680">=</span>&nbsp;<span class="ident" id="7778682">line</span><span class="op" id="7778686">[</span><span class="num" id="7778687">0</span>&nbsp;<span class="op" id="7778689">:</span>&nbsp;<span class="builtinfunc" id="7778691">len</span><span class="op" id="7778694">(</span><span class="ident" id="7778695">line</span><span class="op" id="7778699">)</span><span class="op" id="7778700">-</span><span class="num" id="7778701">1</span><span class="op" id="7778702">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778705">pattern</span>&nbsp;<span class="op" id="7778713">=</span>&nbsp;<span class="string" id="7778715">&#34;^&#34;</span>&nbsp;<span class="op" id="7778719">+</span>&nbsp;<span class="ident" id="7778721">pattern</span>&nbsp;<span class="op" id="7778729">+</span>&nbsp;<span class="string" id="7778731">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778750">matched</span><span class="op" id="7778757">,</span>&nbsp;<span class="ident" id="7778759">err4</span>&nbsp;<span class="op" id="7778764">:=</span>&nbsp;<span class="ident" id="7778767">regexp</span><span class="op" id="7778773">.</span><span class="ident" id="7778774">MatchString</span><span class="op" id="7778785">(</span><span class="ident" id="7778786">pattern</span><span class="op" id="7778793">,</span>&nbsp;<span class="ident" id="7778795">line</span><span class="op" id="7778799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778802">if</span>&nbsp;<span class="ident" id="7778805">err4</span>&nbsp;<span class="op" id="7778810">!=</span>&nbsp;<span class="ident" id="7778813">nil</span>&nbsp;<span class="op" id="7778817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778821">t</span><span class="op" id="7778822">.</span><span class="ident" id="7778823">Fatal</span><span class="op" id="7778828">(</span><span class="string" id="7778829">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="7778855">,</span>&nbsp;<span class="ident" id="7778857">err4</span><span class="op" id="7778861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778864">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7778867">if</span>&nbsp;<span class="op" id="7778870">!</span><span class="ident" id="7778871">matched</span>&nbsp;<span class="op" id="7778879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778883">t</span><span class="op" id="7778884">.</span><span class="ident" id="7778885">Errorf</span><span class="op" id="7778891">(</span><span class="string" id="7778892">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7778926">,</span>&nbsp;<span class="ident" id="7778928">pattern</span><span class="op" id="7778935">,</span>&nbsp;<span class="ident" id="7778937">line</span><span class="op" id="7778941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7778944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7778947">SetOutput</span><span class="op" id="7778956">(</span><span class="ident" id="7778957">os</span><span class="op" id="7778959">.</span><span class="ident" id="7778960">Stderr</span><span class="op" id="7778966">)</span><br>
<span class="lineno"></span><span class="op" id="7778968">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7778971">func</span>&nbsp;<span class="ident" id="7778976">TestAll</span><span class="op" id="7778983">(</span><span class="ident" id="7778984">t</span>&nbsp;<span class="op" id="7778986">*</span><span class="ident" id="7778987">testing</span><span class="op" id="7778994">.</span><span class="ident" id="7778995">T</span><span class="op" id="7778996">)</span>&nbsp;<span class="op" id="7778998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779001">for</span>&nbsp;<span class="ident" id="7779005">_</span><span class="op" id="7779006">,</span>&nbsp;<span class="ident" id="7779008">testcase</span>&nbsp;<span class="op" id="7779017">:=</span>&nbsp;<span class="keyword" id="7779020">range</span>&nbsp;<span class="ident" id="7779026">tests</span>&nbsp;<span class="op" id="7779032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779036">testPrint</span><span class="op" id="7779045">(</span><span class="ident" id="7779046">t</span><span class="op" id="7779047">,</span>&nbsp;<span class="ident" id="7779049">testcase</span><span class="op" id="7779057">.</span><span class="ident" id="7779058">flag</span><span class="op" id="7779062">,</span>&nbsp;<span class="ident" id="7779064">testcase</span><span class="op" id="7779072">.</span><span class="ident" id="7779073">prefix</span><span class="op" id="7779079">,</span>&nbsp;<span class="ident" id="7779081">testcase</span><span class="op" id="7779089">.</span><span class="ident" id="7779090">pattern</span><span class="op" id="7779097">,</span>&nbsp;<span class="ident" id="7779099">false</span><span class="op" id="7779104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779108">testPrint</span><span class="op" id="7779117">(</span><span class="ident" id="7779118">t</span><span class="op" id="7779119">,</span>&nbsp;<span class="ident" id="7779121">testcase</span><span class="op" id="7779129">.</span><span class="ident" id="7779130">flag</span><span class="op" id="7779134">,</span>&nbsp;<span class="ident" id="7779136">testcase</span><span class="op" id="7779144">.</span><span class="ident" id="7779145">prefix</span><span class="op" id="7779151">,</span>&nbsp;<span class="ident" id="7779153">testcase</span><span class="op" id="7779161">.</span><span class="ident" id="7779162">pattern</span><span class="op" id="7779169">,</span>&nbsp;<span class="ident" id="7779171">true</span><span class="op" id="7779175">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779178">}</span><br>
<span class="lineno"></span><span class="op" id="7779180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7779183">func</span>&nbsp;<span class="ident" id="7779188">TestOutput</span><span class="op" id="7779198">(</span><span class="ident" id="7779199">t</span>&nbsp;<span class="op" id="7779201">*</span><span class="ident" id="7779202">testing</span><span class="op" id="7779209">.</span><span class="ident" id="7779210">T</span><span class="op" id="7779211">)</span>&nbsp;<span class="op" id="7779213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779216">const</span>&nbsp;<span class="ident" id="7779222">testString</span>&nbsp;<span class="op" id="7779233">=</span>&nbsp;<span class="string" id="7779235">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779243">var</span>&nbsp;<span class="ident" id="7779247">b</span>&nbsp;<span class="ident" id="7779249">bytes</span><span class="op" id="7779254">.</span><span class="ident" id="7779255">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779263">l</span>&nbsp;<span class="op" id="7779265">:=</span>&nbsp;<span class="ident" id="7779268">New</span><span class="op" id="7779271">(</span><span class="op" id="7779272">&amp;</span><span class="ident" id="7779273">b</span><span class="op" id="7779274">,</span>&nbsp;<span class="string" id="7779276">&#34;&#34;</span><span class="op" id="7779278">,</span>&nbsp;<span class="num" id="7779280">0</span><span class="op" id="7779281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779284">l</span><span class="op" id="7779285">.</span><span class="ident" id="7779286">Println</span><span class="op" id="7779293">(</span><span class="ident" id="7779294">testString</span><span class="op" id="7779304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779307">if</span>&nbsp;<span class="ident" id="7779310">expect</span>&nbsp;<span class="op" id="7779317">:=</span>&nbsp;<span class="ident" id="7779320">testString</span>&nbsp;<span class="op" id="7779331">+</span>&nbsp;<span class="string" id="7779333">&#34;\n&#34;</span><span class="op" id="7779337">;</span>&nbsp;<span class="ident" id="7779339">b</span><span class="op" id="7779340">.</span><span class="ident" id="7779341">String</span><span class="op" id="7779347">(</span><span class="op" id="7779348">)</span>&nbsp;<span class="op" id="7779350">!=</span>&nbsp;<span class="ident" id="7779353">expect</span>&nbsp;<span class="op" id="7779360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779364">t</span><span class="op" id="7779365">.</span><span class="ident" id="7779366">Errorf</span><span class="op" id="7779372">(</span><span class="string" id="7779373">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7779407">,</span>&nbsp;<span class="ident" id="7779409">expect</span><span class="op" id="7779415">,</span>&nbsp;<span class="ident" id="7779417">b</span><span class="op" id="7779418">.</span><span class="ident" id="7779419">String</span><span class="op" id="7779425">(</span><span class="op" id="7779426">)</span><span class="op" id="7779427">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779430">}</span><br>
<span class="lineno"></span><span class="op" id="7779432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7779435">func</span>&nbsp;<span class="ident" id="7779440">TestFlagAndPrefixSetting</span><span class="op" id="7779464">(</span><span class="ident" id="7779465">t</span>&nbsp;<span class="op" id="7779467">*</span><span class="ident" id="7779468">testing</span><span class="op" id="7779475">.</span><span class="ident" id="7779476">T</span><span class="op" id="7779477">)</span>&nbsp;<span class="op" id="7779479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779482">var</span>&nbsp;<span class="ident" id="7779486">b</span>&nbsp;<span class="ident" id="7779488">bytes</span><span class="op" id="7779493">.</span><span class="ident" id="7779494">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779502">l</span>&nbsp;<span class="op" id="7779504">:=</span>&nbsp;<span class="ident" id="7779507">New</span><span class="op" id="7779510">(</span><span class="op" id="7779511">&amp;</span><span class="ident" id="7779512">b</span><span class="op" id="7779513">,</span>&nbsp;<span class="string" id="7779515">&#34;Test:&#34;</span><span class="op" id="7779522">,</span>&nbsp;<span class="ident" id="7779524">LstdFlags</span><span class="op" id="7779533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779536">f</span>&nbsp;<span class="op" id="7779538">:=</span>&nbsp;<span class="ident" id="7779541">l</span><span class="op" id="7779542">.</span><span class="ident" id="7779543">Flags</span><span class="op" id="7779548">(</span><span class="op" id="7779549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779552">if</span>&nbsp;<span class="ident" id="7779555">f</span>&nbsp;<span class="op" id="7779557">!=</span>&nbsp;<span class="ident" id="7779560">LstdFlags</span>&nbsp;<span class="op" id="7779570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779574">t</span><span class="op" id="7779575">.</span><span class="ident" id="7779576">Errorf</span><span class="op" id="7779582">(</span><span class="string" id="7779583">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7779612">,</span>&nbsp;<span class="ident" id="7779614">LstdFlags</span><span class="op" id="7779623">,</span>&nbsp;<span class="ident" id="7779625">f</span><span class="op" id="7779626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779629">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779632">l</span><span class="op" id="7779633">.</span><span class="ident" id="7779634">SetFlags</span><span class="op" id="7779642">(</span><span class="ident" id="7779643">f</span>&nbsp;<span class="op" id="7779645">|</span>&nbsp;<span class="ident" id="7779647">Lmicroseconds</span><span class="op" id="7779660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779663">f</span>&nbsp;<span class="op" id="7779665">=</span>&nbsp;<span class="ident" id="7779667">l</span><span class="op" id="7779668">.</span><span class="ident" id="7779669">Flags</span><span class="op" id="7779674">(</span><span class="op" id="7779675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779678">if</span>&nbsp;<span class="ident" id="7779681">f</span>&nbsp;<span class="op" id="7779683">!=</span>&nbsp;<span class="ident" id="7779686">LstdFlags</span><span class="op" id="7779695">|</span><span class="ident" id="7779696">Lmicroseconds</span>&nbsp;<span class="op" id="7779710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779714">t</span><span class="op" id="7779715">.</span><span class="ident" id="7779716">Errorf</span><span class="op" id="7779722">(</span><span class="string" id="7779723">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7779752">,</span>&nbsp;<span class="ident" id="7779754">LstdFlags</span><span class="op" id="7779763">|</span><span class="ident" id="7779764">Lmicroseconds</span><span class="op" id="7779777">,</span>&nbsp;<span class="ident" id="7779779">f</span><span class="op" id="7779780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779783">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779786">p</span>&nbsp;<span class="op" id="7779788">:=</span>&nbsp;<span class="ident" id="7779791">l</span><span class="op" id="7779792">.</span><span class="ident" id="7779793">Prefix</span><span class="op" id="7779799">(</span><span class="op" id="7779800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779803">if</span>&nbsp;<span class="ident" id="7779806">p</span>&nbsp;<span class="op" id="7779808">!=</span>&nbsp;<span class="string" id="7779811">&#34;Test:&#34;</span>&nbsp;<span class="op" id="7779819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779823">t</span><span class="op" id="7779824">.</span><span class="ident" id="7779825">Errorf</span><span class="op" id="7779831">(</span><span class="string" id="7779832">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7779865">,</span>&nbsp;<span class="ident" id="7779867">p</span><span class="op" id="7779868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779874">l</span><span class="op" id="7779875">.</span><span class="ident" id="7779876">SetPrefix</span><span class="op" id="7779885">(</span><span class="string" id="7779886">&#34;Reality:&#34;</span><span class="op" id="7779896">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779899">p</span>&nbsp;<span class="op" id="7779901">=</span>&nbsp;<span class="ident" id="7779903">l</span><span class="op" id="7779904">.</span><span class="ident" id="7779905">Prefix</span><span class="op" id="7779911">(</span><span class="op" id="7779912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7779915">if</span>&nbsp;<span class="ident" id="7779918">p</span>&nbsp;<span class="op" id="7779920">!=</span>&nbsp;<span class="string" id="7779923">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="7779934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7779938">t</span><span class="op" id="7779939">.</span><span class="ident" id="7779940">Errorf</span><span class="op" id="7779946">(</span><span class="string" id="7779947">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7779983">,</span>&nbsp;<span class="ident" id="7779985">p</span><span class="op" id="7779986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7779989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7779992">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780072">l</span><span class="op" id="7780073">.</span><span class="ident" id="7780074">Print</span><span class="op" id="7780079">(</span><span class="string" id="7780080">&#34;hello&#34;</span><span class="op" id="7780087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780090">pattern</span>&nbsp;<span class="op" id="7780098">:=</span>&nbsp;<span class="string" id="7780101">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="7780113">+</span>&nbsp;<span class="ident" id="7780115">Rdate</span>&nbsp;<span class="op" id="7780121">+</span>&nbsp;<span class="string" id="7780123">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7780127">+</span>&nbsp;<span class="ident" id="7780129">Rtime</span>&nbsp;<span class="op" id="7780135">+</span>&nbsp;<span class="ident" id="7780137">Rmicroseconds</span>&nbsp;<span class="op" id="7780151">+</span>&nbsp;<span class="string" id="7780153">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780165">matched</span><span class="op" id="7780172">,</span>&nbsp;<span class="ident" id="7780174">err</span>&nbsp;<span class="op" id="7780178">:=</span>&nbsp;<span class="ident" id="7780181">regexp</span><span class="op" id="7780187">.</span><span class="ident" id="7780188">Match</span><span class="op" id="7780193">(</span><span class="ident" id="7780194">pattern</span><span class="op" id="7780201">,</span>&nbsp;<span class="ident" id="7780203">b</span><span class="op" id="7780204">.</span><span class="ident" id="7780205">Bytes</span><span class="op" id="7780210">(</span><span class="op" id="7780211">)</span><span class="op" id="7780212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7780215">if</span>&nbsp;<span class="ident" id="7780218">err</span>&nbsp;<span class="op" id="7780222">!=</span>&nbsp;<span class="ident" id="7780225">nil</span>&nbsp;<span class="op" id="7780229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780233">t</span><span class="op" id="7780234">.</span><span class="ident" id="7780235">Fatalf</span><span class="op" id="7780241">(</span><span class="string" id="7780242">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="7780274">,</span>&nbsp;<span class="ident" id="7780276">pattern</span><span class="op" id="7780283">,</span>&nbsp;<span class="ident" id="7780285">err</span><span class="op" id="7780288">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7780294">if</span>&nbsp;<span class="op" id="7780297">!</span><span class="ident" id="7780298">matched</span>&nbsp;<span class="op" id="7780306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7780310">t</span><span class="op" id="7780311">.</span><span class="ident" id="7780312">Error</span><span class="op" id="7780317">(</span><span class="string" id="7780318">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="7780349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7780352">}</span><br>
<span class="lineno"></span><span class="op" id="7780354">}</span>
</div>
</body>
</html>
