<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8484738">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8484794">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8484848">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8484899">package</span>&nbsp;<span class="ident" id="8484907">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8484913">import</span>&nbsp;<span class="op" id="8484920">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8484923">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8484932">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8484949">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8484956">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8484963">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8484969">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8484980">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8484991">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8485002">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8485009">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8485012">var</span>&nbsp;<span class="ident" id="8485016">writeSetCookiesTests</span>&nbsp;<span class="op" id="8485037">=</span>&nbsp;<span class="op" id="8485039">[</span><span class="op" id="8485040">]</span><span class="keyword" id="8485041">struct</span>&nbsp;<span class="op" id="8485048">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485051">Cookie</span>&nbsp;<span class="op" id="8485058">*</span><span class="ident" id="8485059">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8485067">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8485074">string</span><br>
<span class="lineno"></span><span class="op" id="8485081">}</span><span class="op" id="8485082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485089">&amp;</span><span class="ident" id="8485090">Cookie</span><span class="op" id="8485096">{</span><span class="ident" id="8485097">Name</span><span class="op" id="8485101">:</span>&nbsp;<span class="string" id="8485103">&#34;cookie-1&#34;</span><span class="op" id="8485113">,</span>&nbsp;<span class="ident" id="8485115">Value</span><span class="op" id="8485120">:</span>&nbsp;<span class="string" id="8485122">&#34;v$1&#34;</span><span class="op" id="8485127">}</span><span class="op" id="8485128">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8485132">&#34;cookie-1=v$1&#34;</span><span class="op" id="8485146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485149">}</span><span class="op" id="8485150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485157">&amp;</span><span class="ident" id="8485158">Cookie</span><span class="op" id="8485164">{</span><span class="ident" id="8485165">Name</span><span class="op" id="8485169">:</span>&nbsp;<span class="string" id="8485171">&#34;cookie-2&#34;</span><span class="op" id="8485181">,</span>&nbsp;<span class="ident" id="8485183">Value</span><span class="op" id="8485188">:</span>&nbsp;<span class="string" id="8485190">&#34;two&#34;</span><span class="op" id="8485195">,</span>&nbsp;<span class="ident" id="8485197">MaxAge</span><span class="op" id="8485203">:</span>&nbsp;<span class="num" id="8485205">3600</span><span class="op" id="8485209">}</span><span class="op" id="8485210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8485214">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="8485242">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485245">}</span><span class="op" id="8485246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485253">&amp;</span><span class="ident" id="8485254">Cookie</span><span class="op" id="8485260">{</span><span class="ident" id="8485261">Name</span><span class="op" id="8485265">:</span>&nbsp;<span class="string" id="8485267">&#34;cookie-3&#34;</span><span class="op" id="8485277">,</span>&nbsp;<span class="ident" id="8485279">Value</span><span class="op" id="8485284">:</span>&nbsp;<span class="string" id="8485286">&#34;three&#34;</span><span class="op" id="8485293">,</span>&nbsp;<span class="ident" id="8485295">Domain</span><span class="op" id="8485301">:</span>&nbsp;<span class="string" id="8485303">&#34;.example.com&#34;</span><span class="op" id="8485317">}</span><span class="op" id="8485318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8485322">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="8485358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485361">}</span><span class="op" id="8485362">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485369">&amp;</span><span class="ident" id="8485370">Cookie</span><span class="op" id="8485376">{</span><span class="ident" id="8485377">Name</span><span class="op" id="8485381">:</span>&nbsp;<span class="string" id="8485383">&#34;cookie-4&#34;</span><span class="op" id="8485393">,</span>&nbsp;<span class="ident" id="8485395">Value</span><span class="op" id="8485400">:</span>&nbsp;<span class="string" id="8485402">&#34;four&#34;</span><span class="op" id="8485408">,</span>&nbsp;<span class="ident" id="8485410">Path</span><span class="op" id="8485414">:</span>&nbsp;<span class="string" id="8485416">&#34;/restricted/&#34;</span><span class="op" id="8485430">}</span><span class="op" id="8485431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8485435">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="8485469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485472">}</span><span class="op" id="8485473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485476">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485480">&amp;</span><span class="ident" id="8485481">Cookie</span><span class="op" id="8485487">{</span><span class="ident" id="8485488">Name</span><span class="op" id="8485492">:</span>&nbsp;<span class="string" id="8485494">&#34;cookie-5&#34;</span><span class="op" id="8485504">,</span>&nbsp;<span class="ident" id="8485506">Value</span><span class="op" id="8485511">:</span>&nbsp;<span class="string" id="8485513">&#34;five&#34;</span><span class="op" id="8485519">,</span>&nbsp;<span class="ident" id="8485521">Domain</span><span class="op" id="8485527">:</span>&nbsp;<span class="string" id="8485529">&#34;wrong;bad.abc&#34;</span><span class="op" id="8485544">}</span><span class="op" id="8485545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8485549">&#34;cookie-5=five&#34;</span><span class="op" id="8485564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485567">}</span><span class="op" id="8485568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485575">&amp;</span><span class="ident" id="8485576">Cookie</span><span class="op" id="8485582">{</span><span class="ident" id="8485583">Name</span><span class="op" id="8485587">:</span>&nbsp;<span class="string" id="8485589">&#34;cookie-6&#34;</span><span class="op" id="8485599">,</span>&nbsp;<span class="ident" id="8485601">Value</span><span class="op" id="8485606">:</span>&nbsp;<span class="string" id="8485608">&#34;six&#34;</span><span class="op" id="8485613">,</span>&nbsp;<span class="ident" id="8485615">Domain</span><span class="op" id="8485621">:</span>&nbsp;<span class="string" id="8485623">&#34;bad-.abc&#34;</span><span class="op" id="8485633">}</span><span class="op" id="8485634">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8485638">&#34;cookie-6=six&#34;</span><span class="op" id="8485652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485655">}</span><span class="op" id="8485656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485663">&amp;</span><span class="ident" id="8485664">Cookie</span><span class="op" id="8485670">{</span><span class="ident" id="8485671">Name</span><span class="op" id="8485675">:</span>&nbsp;<span class="string" id="8485677">&#34;cookie-7&#34;</span><span class="op" id="8485687">,</span>&nbsp;<span class="ident" id="8485689">Value</span><span class="op" id="8485694">:</span>&nbsp;<span class="string" id="8485696">&#34;seven&#34;</span><span class="op" id="8485703">,</span>&nbsp;<span class="ident" id="8485705">Domain</span><span class="op" id="8485711">:</span>&nbsp;<span class="string" id="8485713">&#34;127.0.0.1&#34;</span><span class="op" id="8485724">}</span><span class="op" id="8485725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8485729">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="8485763">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485766">}</span><span class="op" id="8485767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485774">&amp;</span><span class="ident" id="8485775">Cookie</span><span class="op" id="8485781">{</span><span class="ident" id="8485782">Name</span><span class="op" id="8485786">:</span>&nbsp;<span class="string" id="8485788">&#34;cookie-8&#34;</span><span class="op" id="8485798">,</span>&nbsp;<span class="ident" id="8485800">Value</span><span class="op" id="8485805">:</span>&nbsp;<span class="string" id="8485807">&#34;eight&#34;</span><span class="op" id="8485814">,</span>&nbsp;<span class="ident" id="8485816">Domain</span><span class="op" id="8485822">:</span>&nbsp;<span class="string" id="8485824">&#34;::1&#34;</span><span class="op" id="8485829">}</span><span class="op" id="8485830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8485834">&#34;cookie-8=eight&#34;</span><span class="op" id="8485850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485853">}</span><span class="op" id="8485854">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8485857">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8485929">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8485992">&amp;</span><span class="ident" id="8485993">Cookie</span><span class="op" id="8485999">{</span><span class="ident" id="8486000">Name</span><span class="op" id="8486004">:</span>&nbsp;<span class="string" id="8486006">&#34;special-1&#34;</span><span class="op" id="8486017">,</span>&nbsp;<span class="ident" id="8486019">Value</span><span class="op" id="8486024">:</span>&nbsp;<span class="string" id="8486026">&#34;a&nbsp;z&#34;</span><span class="op" id="8486031">}</span><span class="op" id="8486032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8486036">`special-1=a&nbsp;z`</span><span class="op" id="8486051">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486054">}</span><span class="op" id="8486055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486062">&amp;</span><span class="ident" id="8486063">Cookie</span><span class="op" id="8486069">{</span><span class="ident" id="8486070">Name</span><span class="op" id="8486074">:</span>&nbsp;<span class="string" id="8486076">&#34;special-2&#34;</span><span class="op" id="8486087">,</span>&nbsp;<span class="ident" id="8486089">Value</span><span class="op" id="8486094">:</span>&nbsp;<span class="string" id="8486096">&#34;&nbsp;z&#34;</span><span class="op" id="8486100">}</span><span class="op" id="8486101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8486105">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8486121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486124">}</span><span class="op" id="8486125">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486132">&amp;</span><span class="ident" id="8486133">Cookie</span><span class="op" id="8486139">{</span><span class="ident" id="8486140">Name</span><span class="op" id="8486144">:</span>&nbsp;<span class="string" id="8486146">&#34;special-3&#34;</span><span class="op" id="8486157">,</span>&nbsp;<span class="ident" id="8486159">Value</span><span class="op" id="8486164">:</span>&nbsp;<span class="string" id="8486166">&#34;a&nbsp;&#34;</span><span class="op" id="8486170">}</span><span class="op" id="8486171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8486175">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8486191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486194">}</span><span class="op" id="8486195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486198">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486202">&amp;</span><span class="ident" id="8486203">Cookie</span><span class="op" id="8486209">{</span><span class="ident" id="8486210">Name</span><span class="op" id="8486214">:</span>&nbsp;<span class="string" id="8486216">&#34;special-4&#34;</span><span class="op" id="8486227">,</span>&nbsp;<span class="ident" id="8486229">Value</span><span class="op" id="8486234">:</span>&nbsp;<span class="string" id="8486236">&#34;&nbsp;&#34;</span><span class="op" id="8486239">}</span><span class="op" id="8486240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8486244">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8486259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486262">}</span><span class="op" id="8486263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486270">&amp;</span><span class="ident" id="8486271">Cookie</span><span class="op" id="8486277">{</span><span class="ident" id="8486278">Name</span><span class="op" id="8486282">:</span>&nbsp;<span class="string" id="8486284">&#34;special-5&#34;</span><span class="op" id="8486295">,</span>&nbsp;<span class="ident" id="8486297">Value</span><span class="op" id="8486302">:</span>&nbsp;<span class="string" id="8486304">&#34;a,z&#34;</span><span class="op" id="8486309">}</span><span class="op" id="8486310">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8486314">`special-5=a,z`</span><span class="op" id="8486329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486332">}</span><span class="op" id="8486333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486340">&amp;</span><span class="ident" id="8486341">Cookie</span><span class="op" id="8486347">{</span><span class="ident" id="8486348">Name</span><span class="op" id="8486352">:</span>&nbsp;<span class="string" id="8486354">&#34;special-6&#34;</span><span class="op" id="8486365">,</span>&nbsp;<span class="ident" id="8486367">Value</span><span class="op" id="8486372">:</span>&nbsp;<span class="string" id="8486374">&#34;,z&#34;</span><span class="op" id="8486378">}</span><span class="op" id="8486379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8486383">`special-6=&#34;,z&#34;`</span><span class="op" id="8486399">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486402">}</span><span class="op" id="8486403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486410">&amp;</span><span class="ident" id="8486411">Cookie</span><span class="op" id="8486417">{</span><span class="ident" id="8486418">Name</span><span class="op" id="8486422">:</span>&nbsp;<span class="string" id="8486424">&#34;special-7&#34;</span><span class="op" id="8486435">,</span>&nbsp;<span class="ident" id="8486437">Value</span><span class="op" id="8486442">:</span>&nbsp;<span class="string" id="8486444">&#34;a,&#34;</span><span class="op" id="8486448">}</span><span class="op" id="8486449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8486453">`special-7=&#34;a,&#34;`</span><span class="op" id="8486469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486472">}</span><span class="op" id="8486473">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486480">&amp;</span><span class="ident" id="8486481">Cookie</span><span class="op" id="8486487">{</span><span class="ident" id="8486488">Name</span><span class="op" id="8486492">:</span>&nbsp;<span class="string" id="8486494">&#34;special-8&#34;</span><span class="op" id="8486505">,</span>&nbsp;<span class="ident" id="8486507">Value</span><span class="op" id="8486512">:</span>&nbsp;<span class="string" id="8486514">&#34;,&#34;</span><span class="op" id="8486517">}</span><span class="op" id="8486518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8486522">`special-8=&#34;,&#34;`</span><span class="op" id="8486537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486540">}</span><span class="op" id="8486541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486544">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486548">&amp;</span><span class="ident" id="8486549">Cookie</span><span class="op" id="8486555">{</span><span class="ident" id="8486556">Name</span><span class="op" id="8486560">:</span>&nbsp;<span class="string" id="8486562">&#34;empty-value&#34;</span><span class="op" id="8486575">,</span>&nbsp;<span class="ident" id="8486577">Value</span><span class="op" id="8486582">:</span>&nbsp;<span class="string" id="8486584">&#34;&#34;</span><span class="op" id="8486586">}</span><span class="op" id="8486587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8486591">`empty-value=`</span><span class="op" id="8486605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486608">}</span><span class="op" id="8486609">,</span><br>
<span class="lineno"></span><span class="op" id="8486611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="8486614">func</span>&nbsp;<span class="ident" id="8486619">TestWriteSetCookies</span><span class="op" id="8486638">(</span><span class="ident" id="8486639">t</span>&nbsp;<span class="op" id="8486641">*</span><span class="ident" id="8486642">testing</span><span class="op" id="8486649">.</span><span class="ident" id="8486650">T</span><span class="op" id="8486651">)</span>&nbsp;<span class="op" id="8486653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486656">defer</span>&nbsp;<span class="ident" id="8486662">log</span><span class="op" id="8486665">.</span><span class="ident" id="8486666">SetOutput</span><span class="op" id="8486675">(</span><span class="ident" id="8486676">os</span><span class="op" id="8486678">.</span><span class="ident" id="8486679">Stderr</span><span class="op" id="8486685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486688">var</span>&nbsp;<span class="ident" id="8486692">logbuf</span>&nbsp;<span class="ident" id="8486699">bytes</span><span class="op" id="8486704">.</span><span class="ident" id="8486705">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486713">log</span><span class="op" id="8486716">.</span><span class="ident" id="8486717">SetOutput</span><span class="op" id="8486726">(</span><span class="op" id="8486727">&amp;</span><span class="ident" id="8486728">logbuf</span><span class="op" id="8486734">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486738">for</span>&nbsp;<span class="ident" id="8486742">i</span><span class="op" id="8486743">,</span>&nbsp;<span class="ident" id="8486745">tt</span>&nbsp;<span class="op" id="8486748">:=</span>&nbsp;<span class="keyword" id="8486751">range</span>&nbsp;<span class="ident" id="8486757">writeSetCookiesTests</span>&nbsp;<span class="op" id="8486778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486782">if</span>&nbsp;<span class="ident" id="8486785">g</span><span class="op" id="8486786">,</span>&nbsp;<span class="ident" id="8486788">e</span>&nbsp;<span class="op" id="8486790">:=</span>&nbsp;<span class="ident" id="8486793">tt</span><span class="op" id="8486795">.</span><span class="ident" id="8486796">Cookie</span><span class="op" id="8486802">.</span><span class="ident" id="8486803">String</span><span class="op" id="8486809">(</span><span class="op" id="8486810">)</span><span class="op" id="8486811">,</span>&nbsp;<span class="ident" id="8486813">tt</span><span class="op" id="8486815">.</span><span class="ident" id="8486816">Raw</span><span class="op" id="8486819">;</span>&nbsp;<span class="ident" id="8486821">g</span>&nbsp;<span class="op" id="8486823">!=</span>&nbsp;<span class="ident" id="8486826">e</span>&nbsp;<span class="op" id="8486828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8486833">t</span><span class="op" id="8486834">.</span><span class="ident" id="8486835">Errorf</span><span class="op" id="8486841">(</span><span class="string" id="8486842">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8486879">,</span>&nbsp;<span class="ident" id="8486881">i</span><span class="op" id="8486882">,</span>&nbsp;<span class="ident" id="8486884">e</span><span class="op" id="8486885">,</span>&nbsp;<span class="ident" id="8486887">g</span><span class="op" id="8486888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486893">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486904">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8486907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8486911">if</span>&nbsp;<span class="ident" id="8486914">got</span><span class="op" id="8486917">,</span>&nbsp;<span class="ident" id="8486919">sub</span>&nbsp;<span class="op" id="8486923">:=</span>&nbsp;<span class="ident" id="8486926">logbuf</span><span class="op" id="8486932">.</span><span class="ident" id="8486933">String</span><span class="op" id="8486939">(</span><span class="op" id="8486940">)</span><span class="op" id="8486941">,</span>&nbsp;<span class="string" id="8486943">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="8486970">;</span>&nbsp;<span class="op" id="8486972">!</span><span class="ident" id="8486973">strings</span><span class="op" id="8486980">.</span><span class="ident" id="8486981">Contains</span><span class="op" id="8486989">(</span><span class="ident" id="8486990">got</span><span class="op" id="8486993">,</span>&nbsp;<span class="ident" id="8486995">sub</span><span class="op" id="8486998">)</span>&nbsp;<span class="op" id="8487000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487004">t</span><span class="op" id="8487005">.</span><span class="ident" id="8487006">Errorf</span><span class="op" id="8487012">(</span><span class="string" id="8487013">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8487060">,</span>&nbsp;<span class="ident" id="8487062">sub</span><span class="op" id="8487065">,</span>&nbsp;<span class="ident" id="8487067">got</span><span class="op" id="8487070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487073">}</span><br>
<span class="lineno">110</span><span class="op" id="8487075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8487078">type</span>&nbsp;<span class="ident" id="8487083">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="8487108">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8487116">func</span>&nbsp;<span class="op" id="8487121">(</span><span class="ident" id="8487122">ho</span>&nbsp;<span class="ident" id="8487125">headerOnlyResponseWriter</span><span class="op" id="8487149">)</span>&nbsp;<span class="ident" id="8487151">Header</span><span class="op" id="8487157">(</span><span class="op" id="8487158">)</span>&nbsp;<span class="ident" id="8487160">Header</span>&nbsp;<span class="op" id="8487167">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8487170">return</span>&nbsp;<span class="ident" id="8487177">Header</span><span class="op" id="8487183">(</span><span class="ident" id="8487184">ho</span><span class="op" id="8487186">)</span><br>
<span class="lineno"></span><span class="op" id="8487188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8487191">func</span>&nbsp;<span class="op" id="8487196">(</span><span class="ident" id="8487197">ho</span>&nbsp;<span class="ident" id="8487200">headerOnlyResponseWriter</span><span class="op" id="8487224">)</span>&nbsp;<span class="ident" id="8487226">Write</span><span class="op" id="8487231">(</span><span class="op" id="8487232">[</span><span class="op" id="8487233">]</span><span class="builtintype" id="8487234">byte</span><span class="op" id="8487238">)</span>&nbsp;<span class="op" id="8487240">(</span><span class="builtintype" id="8487241">int</span><span class="op" id="8487244">,</span>&nbsp;<span class="builtintype" id="8487246">error</span><span class="op" id="8487251">)</span>&nbsp;<span class="op" id="8487253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8487256">panic</span><span class="op" id="8487261">(</span><span class="string" id="8487262">&#34;NOIMPL&#34;</span><span class="op" id="8487270">)</span><br>
<span class="lineno">120</span><span class="op" id="8487272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8487275">func</span>&nbsp;<span class="op" id="8487280">(</span><span class="ident" id="8487281">ho</span>&nbsp;<span class="ident" id="8487284">headerOnlyResponseWriter</span><span class="op" id="8487308">)</span>&nbsp;<span class="ident" id="8487310">WriteHeader</span><span class="op" id="8487321">(</span><span class="builtintype" id="8487322">int</span><span class="op" id="8487325">)</span>&nbsp;<span class="op" id="8487327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8487330">panic</span><span class="op" id="8487335">(</span><span class="string" id="8487336">&#34;NOIMPL&#34;</span><span class="op" id="8487344">)</span><br>
<span class="lineno"></span><span class="op" id="8487346">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="8487349">func</span>&nbsp;<span class="ident" id="8487354">TestSetCookie</span><span class="op" id="8487367">(</span><span class="ident" id="8487368">t</span>&nbsp;<span class="op" id="8487370">*</span><span class="ident" id="8487371">testing</span><span class="op" id="8487378">.</span><span class="ident" id="8487379">T</span><span class="op" id="8487380">)</span>&nbsp;<span class="op" id="8487382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487385">m</span>&nbsp;<span class="op" id="8487387">:=</span>&nbsp;<span class="builtinfunc" id="8487390">make</span><span class="op" id="8487394">(</span><span class="ident" id="8487395">Header</span><span class="op" id="8487401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487404">SetCookie</span><span class="op" id="8487413">(</span><span class="ident" id="8487414">headerOnlyResponseWriter</span><span class="op" id="8487438">(</span><span class="ident" id="8487439">m</span><span class="op" id="8487440">)</span><span class="op" id="8487441">,</span>&nbsp;<span class="op" id="8487443">&amp;</span><span class="ident" id="8487444">Cookie</span><span class="op" id="8487450">{</span><span class="ident" id="8487451">Name</span><span class="op" id="8487455">:</span>&nbsp;<span class="string" id="8487457">&#34;cookie-1&#34;</span><span class="op" id="8487467">,</span>&nbsp;<span class="ident" id="8487469">Value</span><span class="op" id="8487474">:</span>&nbsp;<span class="string" id="8487476">&#34;one&#34;</span><span class="op" id="8487481">,</span>&nbsp;<span class="ident" id="8487483">Path</span><span class="op" id="8487487">:</span>&nbsp;<span class="string" id="8487489">&#34;/restricted/&#34;</span><span class="op" id="8487503">}</span><span class="op" id="8487504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487507">SetCookie</span><span class="op" id="8487516">(</span><span class="ident" id="8487517">headerOnlyResponseWriter</span><span class="op" id="8487541">(</span><span class="ident" id="8487542">m</span><span class="op" id="8487543">)</span><span class="op" id="8487544">,</span>&nbsp;<span class="op" id="8487546">&amp;</span><span class="ident" id="8487547">Cookie</span><span class="op" id="8487553">{</span><span class="ident" id="8487554">Name</span><span class="op" id="8487558">:</span>&nbsp;<span class="string" id="8487560">&#34;cookie-2&#34;</span><span class="op" id="8487570">,</span>&nbsp;<span class="ident" id="8487572">Value</span><span class="op" id="8487577">:</span>&nbsp;<span class="string" id="8487579">&#34;two&#34;</span><span class="op" id="8487584">,</span>&nbsp;<span class="ident" id="8487586">MaxAge</span><span class="op" id="8487592">:</span>&nbsp;<span class="num" id="8487594">3600</span><span class="op" id="8487598">}</span><span class="op" id="8487599">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8487602">if</span>&nbsp;<span class="ident" id="8487605">l</span>&nbsp;<span class="op" id="8487607">:=</span>&nbsp;<span class="builtinfunc" id="8487610">len</span><span class="op" id="8487613">(</span><span class="ident" id="8487614">m</span><span class="op" id="8487615">[</span><span class="string" id="8487616">&#34;Set-Cookie&#34;</span><span class="op" id="8487628">]</span><span class="op" id="8487629">)</span><span class="op" id="8487630">;</span>&nbsp;<span class="ident" id="8487632">l</span>&nbsp;<span class="op" id="8487634">!=</span>&nbsp;<span class="num" id="8487637">2</span>&nbsp;<span class="op" id="8487639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487643">t</span><span class="op" id="8487644">.</span><span class="ident" id="8487645">Fatalf</span><span class="op" id="8487651">(</span><span class="string" id="8487652">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8487681">,</span>&nbsp;<span class="num" id="8487683">2</span><span class="op" id="8487684">,</span>&nbsp;<span class="ident" id="8487686">l</span><span class="op" id="8487687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8487693">if</span>&nbsp;<span class="ident" id="8487696">g</span><span class="op" id="8487697">,</span>&nbsp;<span class="ident" id="8487699">e</span>&nbsp;<span class="op" id="8487701">:=</span>&nbsp;<span class="ident" id="8487704">m</span><span class="op" id="8487705">[</span><span class="string" id="8487706">&#34;Set-Cookie&#34;</span><span class="op" id="8487718">]</span><span class="op" id="8487719">[</span><span class="num" id="8487720">0</span><span class="op" id="8487721">]</span><span class="op" id="8487722">,</span>&nbsp;<span class="string" id="8487724">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="8487757">;</span>&nbsp;<span class="ident" id="8487759">g</span>&nbsp;<span class="op" id="8487761">!=</span>&nbsp;<span class="ident" id="8487764">e</span>&nbsp;<span class="op" id="8487766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487770">t</span><span class="op" id="8487771">.</span><span class="ident" id="8487772">Errorf</span><span class="op" id="8487778">(</span><span class="string" id="8487779">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8487807">,</span>&nbsp;<span class="ident" id="8487809">e</span><span class="op" id="8487810">,</span>&nbsp;<span class="ident" id="8487812">g</span><span class="op" id="8487813">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8487819">if</span>&nbsp;<span class="ident" id="8487822">g</span><span class="op" id="8487823">,</span>&nbsp;<span class="ident" id="8487825">e</span>&nbsp;<span class="op" id="8487827">:=</span>&nbsp;<span class="ident" id="8487830">m</span><span class="op" id="8487831">[</span><span class="string" id="8487832">&#34;Set-Cookie&#34;</span><span class="op" id="8487844">]</span><span class="op" id="8487845">[</span><span class="num" id="8487846">1</span><span class="op" id="8487847">]</span><span class="op" id="8487848">,</span>&nbsp;<span class="string" id="8487850">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="8487878">;</span>&nbsp;<span class="ident" id="8487880">g</span>&nbsp;<span class="op" id="8487882">!=</span>&nbsp;<span class="ident" id="8487885">e</span>&nbsp;<span class="op" id="8487887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487891">t</span><span class="op" id="8487892">.</span><span class="ident" id="8487893">Errorf</span><span class="op" id="8487899">(</span><span class="string" id="8487900">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8487928">,</span>&nbsp;<span class="ident" id="8487930">e</span><span class="op" id="8487931">,</span>&nbsp;<span class="ident" id="8487933">g</span><span class="op" id="8487934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8487937">}</span><br>
<span class="lineno"></span><span class="op" id="8487939">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8487942">var</span>&nbsp;<span class="ident" id="8487946">addCookieTests</span>&nbsp;<span class="op" id="8487961">=</span>&nbsp;<span class="op" id="8487963">[</span><span class="op" id="8487964">]</span><span class="keyword" id="8487965">struct</span>&nbsp;<span class="op" id="8487972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487975">Cookies</span>&nbsp;<span class="op" id="8487983">[</span><span class="op" id="8487984">]</span><span class="op" id="8487985">*</span><span class="ident" id="8487986">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8487994">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8488002">string</span><br>
<span class="lineno"></span><span class="op" id="8488009">}</span><span class="op" id="8488010">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488017">[</span><span class="op" id="8488018">]</span><span class="op" id="8488019">*</span><span class="ident" id="8488020">Cookie</span><span class="op" id="8488026">{</span><span class="op" id="8488027">}</span><span class="op" id="8488028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488032">&#34;&#34;</span><span class="op" id="8488034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488037">}</span><span class="op" id="8488038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488041">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488045">[</span><span class="op" id="8488046">]</span><span class="op" id="8488047">*</span><span class="ident" id="8488048">Cookie</span><span class="op" id="8488054">{</span><span class="op" id="8488055">{</span><span class="ident" id="8488056">Name</span><span class="op" id="8488060">:</span>&nbsp;<span class="string" id="8488062">&#34;cookie-1&#34;</span><span class="op" id="8488072">,</span>&nbsp;<span class="ident" id="8488074">Value</span><span class="op" id="8488079">:</span>&nbsp;<span class="string" id="8488081">&#34;v$1&#34;</span><span class="op" id="8488086">}</span><span class="op" id="8488087">}</span><span class="op" id="8488088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488092">&#34;cookie-1=v$1&#34;</span><span class="op" id="8488106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488109">}</span><span class="op" id="8488110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488117">[</span><span class="op" id="8488118">]</span><span class="op" id="8488119">*</span><span class="ident" id="8488120">Cookie</span><span class="op" id="8488126">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488131">{</span><span class="ident" id="8488132">Name</span><span class="op" id="8488136">:</span>&nbsp;<span class="string" id="8488138">&#34;cookie-1&#34;</span><span class="op" id="8488148">,</span>&nbsp;<span class="ident" id="8488150">Value</span><span class="op" id="8488155">:</span>&nbsp;<span class="string" id="8488157">&#34;v$1&#34;</span><span class="op" id="8488162">}</span><span class="op" id="8488163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488168">{</span><span class="ident" id="8488169">Name</span><span class="op" id="8488173">:</span>&nbsp;<span class="string" id="8488175">&#34;cookie-2&#34;</span><span class="op" id="8488185">,</span>&nbsp;<span class="ident" id="8488187">Value</span><span class="op" id="8488192">:</span>&nbsp;<span class="string" id="8488194">&#34;v$2&#34;</span><span class="op" id="8488199">}</span><span class="op" id="8488200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488205">{</span><span class="ident" id="8488206">Name</span><span class="op" id="8488210">:</span>&nbsp;<span class="string" id="8488212">&#34;cookie-3&#34;</span><span class="op" id="8488222">,</span>&nbsp;<span class="ident" id="8488224">Value</span><span class="op" id="8488229">:</span>&nbsp;<span class="string" id="8488231">&#34;v$3&#34;</span><span class="op" id="8488236">}</span><span class="op" id="8488237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488241">}</span><span class="op" id="8488242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8488246">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="8488288">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488291">}</span><span class="op" id="8488292">,</span><br>
<span class="lineno"></span><span class="op" id="8488294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8488297">func</span>&nbsp;<span class="ident" id="8488302">TestAddCookie</span><span class="op" id="8488315">(</span><span class="ident" id="8488316">t</span>&nbsp;<span class="op" id="8488318">*</span><span class="ident" id="8488319">testing</span><span class="op" id="8488326">.</span><span class="ident" id="8488327">T</span><span class="op" id="8488328">)</span>&nbsp;<span class="op" id="8488330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8488333">for</span>&nbsp;<span class="ident" id="8488337">i</span><span class="op" id="8488338">,</span>&nbsp;<span class="ident" id="8488340">tt</span>&nbsp;<span class="op" id="8488343">:=</span>&nbsp;<span class="keyword" id="8488346">range</span>&nbsp;<span class="ident" id="8488352">addCookieTests</span>&nbsp;<span class="op" id="8488367">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488371">req</span><span class="op" id="8488374">,</span>&nbsp;<span class="ident" id="8488376">_</span>&nbsp;<span class="op" id="8488378">:=</span>&nbsp;<span class="ident" id="8488381">NewRequest</span><span class="op" id="8488391">(</span><span class="string" id="8488392">&#34;GET&#34;</span><span class="op" id="8488397">,</span>&nbsp;<span class="string" id="8488399">&#34;http://example.com/&#34;</span><span class="op" id="8488420">,</span>&nbsp;<span class="ident" id="8488422">nil</span><span class="op" id="8488425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8488429">for</span>&nbsp;<span class="ident" id="8488433">_</span><span class="op" id="8488434">,</span>&nbsp;<span class="ident" id="8488436">c</span>&nbsp;<span class="op" id="8488438">:=</span>&nbsp;<span class="keyword" id="8488441">range</span>&nbsp;<span class="ident" id="8488447">tt</span><span class="op" id="8488449">.</span><span class="ident" id="8488450">Cookies</span>&nbsp;<span class="op" id="8488458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488463">req</span><span class="op" id="8488466">.</span><span class="ident" id="8488467">AddCookie</span><span class="op" id="8488476">(</span><span class="ident" id="8488477">c</span><span class="op" id="8488478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8488486">if</span>&nbsp;<span class="ident" id="8488489">g</span>&nbsp;<span class="op" id="8488491">:=</span>&nbsp;<span class="ident" id="8488494">req</span><span class="op" id="8488497">.</span><span class="ident" id="8488498">Header</span><span class="op" id="8488504">.</span><span class="ident" id="8488505">Get</span><span class="op" id="8488508">(</span><span class="string" id="8488509">&#34;Cookie&#34;</span><span class="op" id="8488517">)</span><span class="op" id="8488518">;</span>&nbsp;<span class="ident" id="8488520">g</span>&nbsp;<span class="op" id="8488522">!=</span>&nbsp;<span class="ident" id="8488525">tt</span><span class="op" id="8488527">.</span><span class="ident" id="8488528">Raw</span>&nbsp;<span class="op" id="8488532">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488537">t</span><span class="op" id="8488538">.</span><span class="ident" id="8488539">Errorf</span><span class="op" id="8488545">(</span><span class="string" id="8488546">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="8488578">,</span>&nbsp;<span class="ident" id="8488580">i</span><span class="op" id="8488581">,</span>&nbsp;<span class="ident" id="8488583">tt</span><span class="op" id="8488585">.</span><span class="ident" id="8488586">Raw</span><span class="op" id="8488589">,</span>&nbsp;<span class="ident" id="8488591">g</span><span class="op" id="8488592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8488597">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488611">}</span><br>
<span class="lineno"></span><span class="op" id="8488613">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="8488616">var</span>&nbsp;<span class="ident" id="8488620">readSetCookiesTests</span>&nbsp;<span class="op" id="8488640">=</span>&nbsp;<span class="op" id="8488642">[</span><span class="op" id="8488643">]</span><span class="keyword" id="8488644">struct</span>&nbsp;<span class="op" id="8488651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488654">Header</span>&nbsp;&nbsp;<span class="ident" id="8488662">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488670">Cookies</span>&nbsp;<span class="op" id="8488678">[</span><span class="op" id="8488679">]</span><span class="op" id="8488680">*</span><span class="ident" id="8488681">Cookie</span><br>
<span class="lineno"></span><span class="op" id="8488688">}</span><span class="op" id="8488689">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488696">Header</span><span class="op" id="8488702">{</span><span class="string" id="8488703">&#34;Set-Cookie&#34;</span><span class="op" id="8488715">:</span>&nbsp;<span class="op" id="8488717">{</span><span class="string" id="8488718">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8488732">}</span><span class="op" id="8488733">}</span><span class="op" id="8488734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488738">[</span><span class="op" id="8488739">]</span><span class="op" id="8488740">*</span><span class="ident" id="8488741">Cookie</span><span class="op" id="8488747">{</span><span class="op" id="8488748">{</span><span class="ident" id="8488749">Name</span><span class="op" id="8488753">:</span>&nbsp;<span class="string" id="8488755">&#34;Cookie-1&#34;</span><span class="op" id="8488765">,</span>&nbsp;<span class="ident" id="8488767">Value</span><span class="op" id="8488772">:</span>&nbsp;<span class="string" id="8488774">&#34;v$1&#34;</span><span class="op" id="8488779">,</span>&nbsp;<span class="ident" id="8488781">Raw</span><span class="op" id="8488784">:</span>&nbsp;<span class="string" id="8488786">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8488800">}</span><span class="op" id="8488801">}</span><span class="op" id="8488802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488805">}</span><span class="op" id="8488806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488809">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488813">Header</span><span class="op" id="8488819">{</span><span class="string" id="8488820">&#34;Set-Cookie&#34;</span><span class="op" id="8488832">:</span>&nbsp;<span class="op" id="8488834">{</span><span class="string" id="8488835">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="8488934">}</span><span class="op" id="8488935">}</span><span class="op" id="8488936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8488940">[</span><span class="op" id="8488941">]</span><span class="op" id="8488942">*</span><span class="ident" id="8488943">Cookie</span><span class="op" id="8488949">{</span><span class="op" id="8488950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488955">Name</span><span class="op" id="8488959">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488967">&#34;NID&#34;</span><span class="op" id="8488972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8488977">Value</span><span class="op" id="8488982">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488989">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="8489008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489013">Path</span><span class="op" id="8489017">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489025">&#34;/&#34;</span><span class="op" id="8489028">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489033">Domain</span><span class="op" id="8489039">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489045">&#34;.google.ch&#34;</span><span class="op" id="8489057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489062">HttpOnly</span><span class="op" id="8489070">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8489074">true</span><span class="op" id="8489078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489083">Expires</span><span class="op" id="8489090">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489095">time</span><span class="op" id="8489099">.</span><span class="ident" id="8489100">Date</span><span class="op" id="8489104">(</span><span class="num" id="8489105">2011</span><span class="op" id="8489109">,</span>&nbsp;<span class="num" id="8489111">11</span><span class="op" id="8489113">,</span>&nbsp;<span class="num" id="8489115">23</span><span class="op" id="8489117">,</span>&nbsp;<span class="num" id="8489119">1</span><span class="op" id="8489120">,</span>&nbsp;<span class="num" id="8489122">5</span><span class="op" id="8489123">,</span>&nbsp;<span class="num" id="8489125">3</span><span class="op" id="8489126">,</span>&nbsp;<span class="num" id="8489128">0</span><span class="op" id="8489129">,</span>&nbsp;<span class="ident" id="8489131">time</span><span class="op" id="8489135">.</span><span class="ident" id="8489136">UTC</span><span class="op" id="8489139">)</span><span class="op" id="8489140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489145">RawExpires</span><span class="op" id="8489155">:</span>&nbsp;<span class="string" id="8489157">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="8489188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489193">Raw</span><span class="op" id="8489196">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489205">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="8489304">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489308">}</span><span class="op" id="8489309">}</span><span class="op" id="8489310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489313">}</span><span class="op" id="8489314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489321">Header</span><span class="op" id="8489327">{</span><span class="string" id="8489328">&#34;Set-Cookie&#34;</span><span class="op" id="8489340">:</span>&nbsp;<span class="op" id="8489342">{</span><span class="string" id="8489343">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8489417">}</span><span class="op" id="8489418">}</span><span class="op" id="8489419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489423">[</span><span class="op" id="8489424">]</span><span class="op" id="8489425">*</span><span class="ident" id="8489426">Cookie</span><span class="op" id="8489432">{</span><span class="op" id="8489433">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489438">Name</span><span class="op" id="8489442">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489450">&#34;.ASPXAUTH&#34;</span><span class="op" id="8489461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489466">Value</span><span class="op" id="8489471">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489478">&#34;7E3AA&#34;</span><span class="op" id="8489485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489490">Path</span><span class="op" id="8489494">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489502">&#34;/&#34;</span><span class="op" id="8489505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489510">Expires</span><span class="op" id="8489517">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489522">time</span><span class="op" id="8489526">.</span><span class="ident" id="8489527">Date</span><span class="op" id="8489531">(</span><span class="num" id="8489532">2012</span><span class="op" id="8489536">,</span>&nbsp;<span class="num" id="8489538">3</span><span class="op" id="8489539">,</span>&nbsp;<span class="num" id="8489541">7</span><span class="op" id="8489542">,</span>&nbsp;<span class="num" id="8489544">14</span><span class="op" id="8489546">,</span>&nbsp;<span class="num" id="8489548">25</span><span class="op" id="8489550">,</span>&nbsp;<span class="num" id="8489552">6</span><span class="op" id="8489553">,</span>&nbsp;<span class="num" id="8489555">0</span><span class="op" id="8489556">,</span>&nbsp;<span class="ident" id="8489558">time</span><span class="op" id="8489562">.</span><span class="ident" id="8489563">UTC</span><span class="op" id="8489566">)</span><span class="op" id="8489567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489572">RawExpires</span><span class="op" id="8489582">:</span>&nbsp;<span class="string" id="8489584">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="8489615">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489620">HttpOnly</span><span class="op" id="8489628">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8489632">true</span><span class="op" id="8489636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489641">Raw</span><span class="op" id="8489644">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489653">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8489727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489731">}</span><span class="op" id="8489732">}</span><span class="op" id="8489733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489736">}</span><span class="op" id="8489737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489740">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489744">Header</span><span class="op" id="8489750">{</span><span class="string" id="8489751">&#34;Set-Cookie&#34;</span><span class="op" id="8489763">:</span>&nbsp;<span class="op" id="8489765">{</span><span class="string" id="8489766">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8489807">}</span><span class="op" id="8489808">}</span><span class="op" id="8489809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489813">[</span><span class="op" id="8489814">]</span><span class="op" id="8489815">*</span><span class="ident" id="8489816">Cookie</span><span class="op" id="8489822">{</span><span class="op" id="8489823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489828">Name</span><span class="op" id="8489832">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489838">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="8489857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489862">Value</span><span class="op" id="8489867">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489872">&#34;foo&#34;</span><span class="op" id="8489877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489882">Path</span><span class="op" id="8489886">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489892">&#34;/&#34;</span><span class="op" id="8489895">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489900">HttpOnly</span><span class="op" id="8489908">:</span>&nbsp;<span class="builtintype" id="8489910">true</span><span class="op" id="8489914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8489919">Raw</span><span class="op" id="8489922">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8489929">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8489970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489974">}</span><span class="op" id="8489975">}</span><span class="op" id="8489976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8489979">}</span><span class="op" id="8489980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8489983">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8490056">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490104">Header</span><span class="op" id="8490110">{</span><span class="string" id="8490111">&#34;Set-Cookie&#34;</span><span class="op" id="8490123">:</span>&nbsp;<span class="op" id="8490125">{</span><span class="string" id="8490126">`special-1=a&nbsp;z`</span><span class="op" id="8490141">}</span><span class="op" id="8490142">}</span><span class="op" id="8490143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490147">[</span><span class="op" id="8490148">]</span><span class="op" id="8490149">*</span><span class="ident" id="8490150">Cookie</span><span class="op" id="8490156">{</span><span class="op" id="8490157">{</span><span class="ident" id="8490158">Name</span><span class="op" id="8490162">:</span>&nbsp;<span class="string" id="8490164">&#34;special-1&#34;</span><span class="op" id="8490175">,</span>&nbsp;<span class="ident" id="8490177">Value</span><span class="op" id="8490182">:</span>&nbsp;<span class="string" id="8490184">&#34;a&nbsp;z&#34;</span><span class="op" id="8490189">,</span>&nbsp;<span class="ident" id="8490191">Raw</span><span class="op" id="8490194">:</span>&nbsp;<span class="string" id="8490196">`special-1=a&nbsp;z`</span><span class="op" id="8490211">}</span><span class="op" id="8490212">}</span><span class="op" id="8490213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490216">}</span><span class="op" id="8490217">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490224">Header</span><span class="op" id="8490230">{</span><span class="string" id="8490231">&#34;Set-Cookie&#34;</span><span class="op" id="8490243">:</span>&nbsp;<span class="op" id="8490245">{</span><span class="string" id="8490246">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8490262">}</span><span class="op" id="8490263">}</span><span class="op" id="8490264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490268">[</span><span class="op" id="8490269">]</span><span class="op" id="8490270">*</span><span class="ident" id="8490271">Cookie</span><span class="op" id="8490277">{</span><span class="op" id="8490278">{</span><span class="ident" id="8490279">Name</span><span class="op" id="8490283">:</span>&nbsp;<span class="string" id="8490285">&#34;special-2&#34;</span><span class="op" id="8490296">,</span>&nbsp;<span class="ident" id="8490298">Value</span><span class="op" id="8490303">:</span>&nbsp;<span class="string" id="8490305">&#34;&nbsp;z&#34;</span><span class="op" id="8490309">,</span>&nbsp;<span class="ident" id="8490311">Raw</span><span class="op" id="8490314">:</span>&nbsp;<span class="string" id="8490316">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8490332">}</span><span class="op" id="8490333">}</span><span class="op" id="8490334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490337">}</span><span class="op" id="8490338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490341">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490345">Header</span><span class="op" id="8490351">{</span><span class="string" id="8490352">&#34;Set-Cookie&#34;</span><span class="op" id="8490364">:</span>&nbsp;<span class="op" id="8490366">{</span><span class="string" id="8490367">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8490383">}</span><span class="op" id="8490384">}</span><span class="op" id="8490385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490389">[</span><span class="op" id="8490390">]</span><span class="op" id="8490391">*</span><span class="ident" id="8490392">Cookie</span><span class="op" id="8490398">{</span><span class="op" id="8490399">{</span><span class="ident" id="8490400">Name</span><span class="op" id="8490404">:</span>&nbsp;<span class="string" id="8490406">&#34;special-3&#34;</span><span class="op" id="8490417">,</span>&nbsp;<span class="ident" id="8490419">Value</span><span class="op" id="8490424">:</span>&nbsp;<span class="string" id="8490426">&#34;a&nbsp;&#34;</span><span class="op" id="8490430">,</span>&nbsp;<span class="ident" id="8490432">Raw</span><span class="op" id="8490435">:</span>&nbsp;<span class="string" id="8490437">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8490453">}</span><span class="op" id="8490454">}</span><span class="op" id="8490455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490458">}</span><span class="op" id="8490459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490466">Header</span><span class="op" id="8490472">{</span><span class="string" id="8490473">&#34;Set-Cookie&#34;</span><span class="op" id="8490485">:</span>&nbsp;<span class="op" id="8490487">{</span><span class="string" id="8490488">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8490503">}</span><span class="op" id="8490504">}</span><span class="op" id="8490505">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490509">[</span><span class="op" id="8490510">]</span><span class="op" id="8490511">*</span><span class="ident" id="8490512">Cookie</span><span class="op" id="8490518">{</span><span class="op" id="8490519">{</span><span class="ident" id="8490520">Name</span><span class="op" id="8490524">:</span>&nbsp;<span class="string" id="8490526">&#34;special-4&#34;</span><span class="op" id="8490537">,</span>&nbsp;<span class="ident" id="8490539">Value</span><span class="op" id="8490544">:</span>&nbsp;<span class="string" id="8490546">&#34;&nbsp;&#34;</span><span class="op" id="8490549">,</span>&nbsp;<span class="ident" id="8490551">Raw</span><span class="op" id="8490554">:</span>&nbsp;<span class="string" id="8490556">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8490571">}</span><span class="op" id="8490572">}</span><span class="op" id="8490573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490576">}</span><span class="op" id="8490577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490584">Header</span><span class="op" id="8490590">{</span><span class="string" id="8490591">&#34;Set-Cookie&#34;</span><span class="op" id="8490603">:</span>&nbsp;<span class="op" id="8490605">{</span><span class="string" id="8490606">`special-5=a,z`</span><span class="op" id="8490621">}</span><span class="op" id="8490622">}</span><span class="op" id="8490623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490627">[</span><span class="op" id="8490628">]</span><span class="op" id="8490629">*</span><span class="ident" id="8490630">Cookie</span><span class="op" id="8490636">{</span><span class="op" id="8490637">{</span><span class="ident" id="8490638">Name</span><span class="op" id="8490642">:</span>&nbsp;<span class="string" id="8490644">&#34;special-5&#34;</span><span class="op" id="8490655">,</span>&nbsp;<span class="ident" id="8490657">Value</span><span class="op" id="8490662">:</span>&nbsp;<span class="string" id="8490664">&#34;a,z&#34;</span><span class="op" id="8490669">,</span>&nbsp;<span class="ident" id="8490671">Raw</span><span class="op" id="8490674">:</span>&nbsp;<span class="string" id="8490676">`special-5=a,z`</span><span class="op" id="8490691">}</span><span class="op" id="8490692">}</span><span class="op" id="8490693">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490696">}</span><span class="op" id="8490697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490704">Header</span><span class="op" id="8490710">{</span><span class="string" id="8490711">&#34;Set-Cookie&#34;</span><span class="op" id="8490723">:</span>&nbsp;<span class="op" id="8490725">{</span><span class="string" id="8490726">`special-6=&#34;,z&#34;`</span><span class="op" id="8490742">}</span><span class="op" id="8490743">}</span><span class="op" id="8490744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490748">[</span><span class="op" id="8490749">]</span><span class="op" id="8490750">*</span><span class="ident" id="8490751">Cookie</span><span class="op" id="8490757">{</span><span class="op" id="8490758">{</span><span class="ident" id="8490759">Name</span><span class="op" id="8490763">:</span>&nbsp;<span class="string" id="8490765">&#34;special-6&#34;</span><span class="op" id="8490776">,</span>&nbsp;<span class="ident" id="8490778">Value</span><span class="op" id="8490783">:</span>&nbsp;<span class="string" id="8490785">&#34;,z&#34;</span><span class="op" id="8490789">,</span>&nbsp;<span class="ident" id="8490791">Raw</span><span class="op" id="8490794">:</span>&nbsp;<span class="string" id="8490796">`special-6=&#34;,z&#34;`</span><span class="op" id="8490812">}</span><span class="op" id="8490813">}</span><span class="op" id="8490814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490817">}</span><span class="op" id="8490818">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490825">Header</span><span class="op" id="8490831">{</span><span class="string" id="8490832">&#34;Set-Cookie&#34;</span><span class="op" id="8490844">:</span>&nbsp;<span class="op" id="8490846">{</span><span class="string" id="8490847">`special-7=a,`</span><span class="op" id="8490861">}</span><span class="op" id="8490862">}</span><span class="op" id="8490863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490867">[</span><span class="op" id="8490868">]</span><span class="op" id="8490869">*</span><span class="ident" id="8490870">Cookie</span><span class="op" id="8490876">{</span><span class="op" id="8490877">{</span><span class="ident" id="8490878">Name</span><span class="op" id="8490882">:</span>&nbsp;<span class="string" id="8490884">&#34;special-7&#34;</span><span class="op" id="8490895">,</span>&nbsp;<span class="ident" id="8490897">Value</span><span class="op" id="8490902">:</span>&nbsp;<span class="string" id="8490904">&#34;a,&#34;</span><span class="op" id="8490908">,</span>&nbsp;<span class="ident" id="8490910">Raw</span><span class="op" id="8490913">:</span>&nbsp;<span class="string" id="8490915">`special-7=a,`</span><span class="op" id="8490929">}</span><span class="op" id="8490930">}</span><span class="op" id="8490931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490934">}</span><span class="op" id="8490935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490938">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8490942">Header</span><span class="op" id="8490948">{</span><span class="string" id="8490949">&#34;Set-Cookie&#34;</span><span class="op" id="8490961">:</span>&nbsp;<span class="op" id="8490963">{</span><span class="string" id="8490964">`special-8=&#34;,&#34;`</span><span class="op" id="8490979">}</span><span class="op" id="8490980">}</span><span class="op" id="8490981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8490985">[</span><span class="op" id="8490986">]</span><span class="op" id="8490987">*</span><span class="ident" id="8490988">Cookie</span><span class="op" id="8490994">{</span><span class="op" id="8490995">{</span><span class="ident" id="8490996">Name</span><span class="op" id="8491000">:</span>&nbsp;<span class="string" id="8491002">&#34;special-8&#34;</span><span class="op" id="8491013">,</span>&nbsp;<span class="ident" id="8491015">Value</span><span class="op" id="8491020">:</span>&nbsp;<span class="string" id="8491022">&#34;,&#34;</span><span class="op" id="8491025">,</span>&nbsp;<span class="ident" id="8491027">Raw</span><span class="op" id="8491030">:</span>&nbsp;<span class="string" id="8491032">`special-8=&#34;,&#34;`</span><span class="op" id="8491047">}</span><span class="op" id="8491048">}</span><span class="op" id="8491049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8491052">}</span><span class="op" id="8491053">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8491057">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8491116">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8491179">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8491243">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8491254">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="8491398">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8491401">func</span>&nbsp;<span class="ident" id="8491406">toJSON</span><span class="op" id="8491412">(</span><span class="ident" id="8491413">v</span>&nbsp;<span class="keyword" id="8491415">interface</span><span class="op" id="8491424">{</span><span class="op" id="8491425">}</span><span class="op" id="8491426">)</span>&nbsp;<span class="builtintype" id="8491428">string</span>&nbsp;<span class="op" id="8491435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491438">b</span><span class="op" id="8491439">,</span>&nbsp;<span class="ident" id="8491441">err</span>&nbsp;<span class="op" id="8491445">:=</span>&nbsp;<span class="ident" id="8491448">json</span><span class="op" id="8491452">.</span><span class="ident" id="8491453">Marshal</span><span class="op" id="8491460">(</span><span class="ident" id="8491461">v</span><span class="op" id="8491462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491465">if</span>&nbsp;<span class="ident" id="8491468">err</span>&nbsp;<span class="op" id="8491472">!=</span>&nbsp;<span class="ident" id="8491475">nil</span>&nbsp;<span class="op" id="8491479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491483">return</span>&nbsp;<span class="ident" id="8491490">fmt</span><span class="op" id="8491493">.</span><span class="ident" id="8491494">Sprintf</span><span class="op" id="8491501">(</span><span class="string" id="8491502">&#34;%#v&#34;</span><span class="op" id="8491507">,</span>&nbsp;<span class="ident" id="8491509">v</span><span class="op" id="8491510">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8491513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491516">return</span>&nbsp;<span class="builtintype" id="8491523">string</span><span class="op" id="8491529">(</span><span class="ident" id="8491530">b</span><span class="op" id="8491531">)</span><br>
<span class="lineno"></span><span class="op" id="8491533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8491536">func</span>&nbsp;<span class="ident" id="8491541">TestReadSetCookies</span><span class="op" id="8491559">(</span><span class="ident" id="8491560">t</span>&nbsp;<span class="op" id="8491562">*</span><span class="ident" id="8491563">testing</span><span class="op" id="8491570">.</span><span class="ident" id="8491571">T</span><span class="op" id="8491572">)</span>&nbsp;<span class="op" id="8491574">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491577">for</span>&nbsp;<span class="ident" id="8491581">i</span><span class="op" id="8491582">,</span>&nbsp;<span class="ident" id="8491584">tt</span>&nbsp;<span class="op" id="8491587">:=</span>&nbsp;<span class="keyword" id="8491590">range</span>&nbsp;<span class="ident" id="8491596">readSetCookiesTests</span>&nbsp;<span class="op" id="8491616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491620">for</span>&nbsp;<span class="ident" id="8491624">n</span>&nbsp;<span class="op" id="8491626">:=</span>&nbsp;<span class="num" id="8491629">0</span><span class="op" id="8491630">;</span>&nbsp;<span class="ident" id="8491632">n</span>&nbsp;<span class="op" id="8491634">&lt;</span>&nbsp;<span class="num" id="8491636">2</span><span class="op" id="8491637">;</span>&nbsp;<span class="ident" id="8491639">n</span><span class="op" id="8491640">++</span>&nbsp;<span class="op" id="8491643">{</span>&nbsp;<span class="comment" id="8491645">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491701">c</span>&nbsp;<span class="op" id="8491703">:=</span>&nbsp;<span class="ident" id="8491706">readSetCookies</span><span class="op" id="8491720">(</span><span class="ident" id="8491721">tt</span><span class="op" id="8491723">.</span><span class="ident" id="8491724">Header</span><span class="op" id="8491730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491735">if</span>&nbsp;<span class="op" id="8491738">!</span><span class="ident" id="8491739">reflect</span><span class="op" id="8491746">.</span><span class="ident" id="8491747">DeepEqual</span><span class="op" id="8491756">(</span><span class="ident" id="8491757">c</span><span class="op" id="8491758">,</span>&nbsp;<span class="ident" id="8491760">tt</span><span class="op" id="8491762">.</span><span class="ident" id="8491763">Cookies</span><span class="op" id="8491770">)</span>&nbsp;<span class="op" id="8491772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491778">t</span><span class="op" id="8491779">.</span><span class="ident" id="8491780">Errorf</span><span class="op" id="8491786">(</span><span class="string" id="8491787">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="8491829">,</span>&nbsp;<span class="ident" id="8491831">i</span><span class="op" id="8491832">,</span>&nbsp;<span class="ident" id="8491834">toJSON</span><span class="op" id="8491840">(</span><span class="ident" id="8491841">c</span><span class="op" id="8491842">)</span><span class="op" id="8491843">,</span>&nbsp;<span class="ident" id="8491845">toJSON</span><span class="op" id="8491851">(</span><span class="ident" id="8491852">tt</span><span class="op" id="8491854">.</span><span class="ident" id="8491855">Cookies</span><span class="op" id="8491862">)</span><span class="op" id="8491863">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8491869">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8491881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8491885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8491888">}</span><br>
<span class="lineno"></span><span class="op" id="8491890">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="8491893">var</span>&nbsp;<span class="ident" id="8491897">readCookiesTests</span>&nbsp;<span class="op" id="8491914">=</span>&nbsp;<span class="op" id="8491916">[</span><span class="op" id="8491917">]</span><span class="keyword" id="8491918">struct</span>&nbsp;<span class="op" id="8491925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491928">Header</span>&nbsp;&nbsp;<span class="ident" id="8491936">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491944">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="8491952">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491960">Cookies</span>&nbsp;<span class="op" id="8491968">[</span><span class="op" id="8491969">]</span><span class="op" id="8491970">*</span><span class="ident" id="8491971">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="8491978">}</span><span class="op" id="8491979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8491982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8491986">Header</span><span class="op" id="8491992">{</span><span class="string" id="8491993">&#34;Cookie&#34;</span><span class="op" id="8492001">:</span>&nbsp;<span class="op" id="8492003">{</span><span class="string" id="8492004">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8492018">,</span>&nbsp;<span class="string" id="8492020">&#34;c2=v2&#34;</span><span class="op" id="8492027">}</span><span class="op" id="8492028">}</span><span class="op" id="8492029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8492033">&#34;&#34;</span><span class="op" id="8492035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492039">[</span><span class="op" id="8492040">]</span><span class="op" id="8492041">*</span><span class="ident" id="8492042">Cookie</span><span class="op" id="8492048">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492053">{</span><span class="ident" id="8492054">Name</span><span class="op" id="8492058">:</span>&nbsp;<span class="string" id="8492060">&#34;Cookie-1&#34;</span><span class="op" id="8492070">,</span>&nbsp;<span class="ident" id="8492072">Value</span><span class="op" id="8492077">:</span>&nbsp;<span class="string" id="8492079">&#34;v$1&#34;</span><span class="op" id="8492084">}</span><span class="op" id="8492085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492090">{</span><span class="ident" id="8492091">Name</span><span class="op" id="8492095">:</span>&nbsp;<span class="string" id="8492097">&#34;c2&#34;</span><span class="op" id="8492101">,</span>&nbsp;<span class="ident" id="8492103">Value</span><span class="op" id="8492108">:</span>&nbsp;<span class="string" id="8492110">&#34;v2&#34;</span><span class="op" id="8492114">}</span><span class="op" id="8492115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492119">}</span><span class="op" id="8492120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492123">}</span><span class="op" id="8492124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492127">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492131">Header</span><span class="op" id="8492137">{</span><span class="string" id="8492138">&#34;Cookie&#34;</span><span class="op" id="8492146">:</span>&nbsp;<span class="op" id="8492148">{</span><span class="string" id="8492149">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8492163">,</span>&nbsp;<span class="string" id="8492165">&#34;c2=v2&#34;</span><span class="op" id="8492172">}</span><span class="op" id="8492173">}</span><span class="op" id="8492174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8492178">&#34;c2&#34;</span><span class="op" id="8492182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492186">[</span><span class="op" id="8492187">]</span><span class="op" id="8492188">*</span><span class="ident" id="8492189">Cookie</span><span class="op" id="8492195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492200">{</span><span class="ident" id="8492201">Name</span><span class="op" id="8492205">:</span>&nbsp;<span class="string" id="8492207">&#34;c2&#34;</span><span class="op" id="8492211">,</span>&nbsp;<span class="ident" id="8492213">Value</span><span class="op" id="8492218">:</span>&nbsp;<span class="string" id="8492220">&#34;v2&#34;</span><span class="op" id="8492224">}</span><span class="op" id="8492225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492229">}</span><span class="op" id="8492230">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492233">}</span><span class="op" id="8492234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492241">Header</span><span class="op" id="8492247">{</span><span class="string" id="8492248">&#34;Cookie&#34;</span><span class="op" id="8492256">:</span>&nbsp;<span class="op" id="8492258">{</span><span class="string" id="8492259">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="8492280">}</span><span class="op" id="8492281">}</span><span class="op" id="8492282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8492286">&#34;&#34;</span><span class="op" id="8492288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492292">[</span><span class="op" id="8492293">]</span><span class="op" id="8492294">*</span><span class="ident" id="8492295">Cookie</span><span class="op" id="8492301">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492306">{</span><span class="ident" id="8492307">Name</span><span class="op" id="8492311">:</span>&nbsp;<span class="string" id="8492313">&#34;Cookie-1&#34;</span><span class="op" id="8492323">,</span>&nbsp;<span class="ident" id="8492325">Value</span><span class="op" id="8492330">:</span>&nbsp;<span class="string" id="8492332">&#34;v$1&#34;</span><span class="op" id="8492337">}</span><span class="op" id="8492338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492343">{</span><span class="ident" id="8492344">Name</span><span class="op" id="8492348">:</span>&nbsp;<span class="string" id="8492350">&#34;c2&#34;</span><span class="op" id="8492354">,</span>&nbsp;<span class="ident" id="8492356">Value</span><span class="op" id="8492361">:</span>&nbsp;<span class="string" id="8492363">&#34;v2&#34;</span><span class="op" id="8492367">}</span><span class="op" id="8492368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492372">}</span><span class="op" id="8492373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492376">}</span><span class="op" id="8492377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492380">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492384">Header</span><span class="op" id="8492390">{</span><span class="string" id="8492391">&#34;Cookie&#34;</span><span class="op" id="8492399">:</span>&nbsp;<span class="op" id="8492401">{</span><span class="string" id="8492402">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="8492423">}</span><span class="op" id="8492424">}</span><span class="op" id="8492425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8492429">&#34;c2&#34;</span><span class="op" id="8492433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492437">[</span><span class="op" id="8492438">]</span><span class="op" id="8492439">*</span><span class="ident" id="8492440">Cookie</span><span class="op" id="8492446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492451">{</span><span class="ident" id="8492452">Name</span><span class="op" id="8492456">:</span>&nbsp;<span class="string" id="8492458">&#34;c2&#34;</span><span class="op" id="8492462">,</span>&nbsp;<span class="ident" id="8492464">Value</span><span class="op" id="8492469">:</span>&nbsp;<span class="string" id="8492471">&#34;v2&#34;</span><span class="op" id="8492475">}</span><span class="op" id="8492476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492480">}</span><span class="op" id="8492481">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492484">}</span><span class="op" id="8492485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492492">Header</span><span class="op" id="8492498">{</span><span class="string" id="8492499">&#34;Cookie&#34;</span><span class="op" id="8492507">:</span>&nbsp;<span class="op" id="8492509">{</span><span class="string" id="8492510">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="8492535">}</span><span class="op" id="8492536">}</span><span class="op" id="8492537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8492541">&#34;&#34;</span><span class="op" id="8492543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492547">[</span><span class="op" id="8492548">]</span><span class="op" id="8492549">*</span><span class="ident" id="8492550">Cookie</span><span class="op" id="8492556">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492561">{</span><span class="ident" id="8492562">Name</span><span class="op" id="8492566">:</span>&nbsp;<span class="string" id="8492568">&#34;Cookie-1&#34;</span><span class="op" id="8492578">,</span>&nbsp;<span class="ident" id="8492580">Value</span><span class="op" id="8492585">:</span>&nbsp;<span class="string" id="8492587">&#34;v$1&#34;</span><span class="op" id="8492592">}</span><span class="op" id="8492593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492598">{</span><span class="ident" id="8492599">Name</span><span class="op" id="8492603">:</span>&nbsp;<span class="string" id="8492605">&#34;c2&#34;</span><span class="op" id="8492609">,</span>&nbsp;<span class="ident" id="8492611">Value</span><span class="op" id="8492616">:</span>&nbsp;<span class="string" id="8492618">&#34;v2&#34;</span><span class="op" id="8492622">}</span><span class="op" id="8492623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492627">}</span><span class="op" id="8492628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492631">}</span><span class="op" id="8492632">,</span><br>
<span class="lineno"></span><span class="op" id="8492634">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="8492637">func</span>&nbsp;<span class="ident" id="8492642">TestReadCookies</span><span class="op" id="8492657">(</span><span class="ident" id="8492658">t</span>&nbsp;<span class="op" id="8492660">*</span><span class="ident" id="8492661">testing</span><span class="op" id="8492668">.</span><span class="ident" id="8492669">T</span><span class="op" id="8492670">)</span>&nbsp;<span class="op" id="8492672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492675">for</span>&nbsp;<span class="ident" id="8492679">i</span><span class="op" id="8492680">,</span>&nbsp;<span class="ident" id="8492682">tt</span>&nbsp;<span class="op" id="8492685">:=</span>&nbsp;<span class="keyword" id="8492688">range</span>&nbsp;<span class="ident" id="8492694">readCookiesTests</span>&nbsp;<span class="op" id="8492711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492715">for</span>&nbsp;<span class="ident" id="8492719">n</span>&nbsp;<span class="op" id="8492721">:=</span>&nbsp;<span class="num" id="8492724">0</span><span class="op" id="8492725">;</span>&nbsp;<span class="ident" id="8492727">n</span>&nbsp;<span class="op" id="8492729">&lt;</span>&nbsp;<span class="num" id="8492731">2</span><span class="op" id="8492732">;</span>&nbsp;<span class="ident" id="8492734">n</span><span class="op" id="8492735">++</span>&nbsp;<span class="op" id="8492738">{</span>&nbsp;<span class="comment" id="8492740">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492793">c</span>&nbsp;<span class="op" id="8492795">:=</span>&nbsp;<span class="ident" id="8492798">readCookies</span><span class="op" id="8492809">(</span><span class="ident" id="8492810">tt</span><span class="op" id="8492812">.</span><span class="ident" id="8492813">Header</span><span class="op" id="8492819">,</span>&nbsp;<span class="ident" id="8492821">tt</span><span class="op" id="8492823">.</span><span class="ident" id="8492824">Filter</span><span class="op" id="8492830">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492835">if</span>&nbsp;<span class="op" id="8492838">!</span><span class="ident" id="8492839">reflect</span><span class="op" id="8492846">.</span><span class="ident" id="8492847">DeepEqual</span><span class="op" id="8492856">(</span><span class="ident" id="8492857">c</span><span class="op" id="8492858">,</span>&nbsp;<span class="ident" id="8492860">tt</span><span class="op" id="8492862">.</span><span class="ident" id="8492863">Cookies</span><span class="op" id="8492870">)</span>&nbsp;<span class="op" id="8492872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8492878">t</span><span class="op" id="8492879">.</span><span class="ident" id="8492880">Errorf</span><span class="op" id="8492886">(</span><span class="string" id="8492887">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="8492927">,</span>&nbsp;<span class="ident" id="8492929">i</span><span class="op" id="8492930">,</span>&nbsp;<span class="ident" id="8492932">toJSON</span><span class="op" id="8492938">(</span><span class="ident" id="8492939">c</span><span class="op" id="8492940">)</span><span class="op" id="8492941">,</span>&nbsp;<span class="ident" id="8492943">toJSON</span><span class="op" id="8492949">(</span><span class="ident" id="8492950">tt</span><span class="op" id="8492952">.</span><span class="ident" id="8492953">Cookies</span><span class="op" id="8492960">)</span><span class="op" id="8492961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8492967">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492983">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8492986">}</span><br>
<span class="lineno"></span><span class="op" id="8492988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8492991">func</span>&nbsp;<span class="ident" id="8492996">TestSetCookieDoubleQuotes</span><span class="op" id="8493021">(</span><span class="ident" id="8493022">t</span>&nbsp;<span class="op" id="8493024">*</span><span class="ident" id="8493025">testing</span><span class="op" id="8493032">.</span><span class="ident" id="8493033">T</span><span class="op" id="8493034">)</span>&nbsp;<span class="op" id="8493036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493039">res</span>&nbsp;<span class="op" id="8493043">:=</span>&nbsp;<span class="op" id="8493046">&amp;</span><span class="ident" id="8493047">Response</span><span class="op" id="8493055">{</span><span class="ident" id="8493056">Header</span><span class="op" id="8493062">:</span>&nbsp;<span class="ident" id="8493064">Header</span><span class="op" id="8493070">{</span><span class="op" id="8493071">}</span><span class="op" id="8493072">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493075">res</span><span class="op" id="8493078">.</span><span class="ident" id="8493079">Header</span><span class="op" id="8493085">.</span><span class="ident" id="8493086">Add</span><span class="op" id="8493089">(</span><span class="string" id="8493090">&#34;Set-Cookie&#34;</span><span class="op" id="8493102">,</span>&nbsp;<span class="string" id="8493104">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="8493130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493133">res</span><span class="op" id="8493136">.</span><span class="ident" id="8493137">Header</span><span class="op" id="8493143">.</span><span class="ident" id="8493144">Add</span><span class="op" id="8493147">(</span><span class="string" id="8493148">&#34;Set-Cookie&#34;</span><span class="op" id="8493160">,</span>&nbsp;<span class="string" id="8493162">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="8493197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493200">res</span><span class="op" id="8493203">.</span><span class="ident" id="8493204">Header</span><span class="op" id="8493210">.</span><span class="ident" id="8493211">Add</span><span class="op" id="8493214">(</span><span class="string" id="8493215">&#34;Set-Cookie&#34;</span><span class="op" id="8493227">,</span>&nbsp;<span class="string" id="8493229">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="8493261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493264">res</span><span class="op" id="8493267">.</span><span class="ident" id="8493268">Header</span><span class="op" id="8493274">.</span><span class="ident" id="8493275">Add</span><span class="op" id="8493278">(</span><span class="string" id="8493279">&#34;Set-Cookie&#34;</span><span class="op" id="8493291">,</span>&nbsp;<span class="string" id="8493293">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="8493323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493326">got</span>&nbsp;<span class="op" id="8493330">:=</span>&nbsp;<span class="ident" id="8493333">res</span><span class="op" id="8493336">.</span><span class="ident" id="8493337">Cookies</span><span class="op" id="8493344">(</span><span class="op" id="8493345">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493348">want</span>&nbsp;<span class="op" id="8493353">:=</span>&nbsp;<span class="op" id="8493356">[</span><span class="op" id="8493357">]</span><span class="op" id="8493358">*</span><span class="ident" id="8493359">Cookie</span><span class="op" id="8493365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493369">{</span><span class="ident" id="8493370">Name</span><span class="op" id="8493374">:</span>&nbsp;<span class="string" id="8493376">&#34;quoted0&#34;</span><span class="op" id="8493385">,</span>&nbsp;<span class="ident" id="8493387">Value</span><span class="op" id="8493392">:</span>&nbsp;<span class="string" id="8493394">&#34;none&#34;</span><span class="op" id="8493400">,</span>&nbsp;<span class="ident" id="8493402">MaxAge</span><span class="op" id="8493408">:</span>&nbsp;<span class="num" id="8493410">30</span><span class="op" id="8493412">}</span><span class="op" id="8493413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493417">{</span><span class="ident" id="8493418">Name</span><span class="op" id="8493422">:</span>&nbsp;<span class="string" id="8493424">&#34;quoted1&#34;</span><span class="op" id="8493433">,</span>&nbsp;<span class="ident" id="8493435">Value</span><span class="op" id="8493440">:</span>&nbsp;<span class="string" id="8493442">&#34;cookieValue&#34;</span><span class="op" id="8493455">,</span>&nbsp;<span class="ident" id="8493457">MaxAge</span><span class="op" id="8493463">:</span>&nbsp;<span class="num" id="8493465">31</span><span class="op" id="8493467">}</span><span class="op" id="8493468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493472">{</span><span class="ident" id="8493473">Name</span><span class="op" id="8493477">:</span>&nbsp;<span class="string" id="8493479">&#34;quoted2&#34;</span><span class="op" id="8493488">,</span>&nbsp;<span class="ident" id="8493490">Value</span><span class="op" id="8493495">:</span>&nbsp;<span class="string" id="8493497">&#34;cookieAV&#34;</span><span class="op" id="8493507">}</span><span class="op" id="8493508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493512">{</span><span class="ident" id="8493513">Name</span><span class="op" id="8493517">:</span>&nbsp;<span class="string" id="8493519">&#34;quoted3&#34;</span><span class="op" id="8493528">,</span>&nbsp;<span class="ident" id="8493530">Value</span><span class="op" id="8493535">:</span>&nbsp;<span class="string" id="8493537">&#34;both&#34;</span><span class="op" id="8493543">}</span><span class="op" id="8493544">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8493550">if</span>&nbsp;<span class="builtinfunc" id="8493553">len</span><span class="op" id="8493556">(</span><span class="ident" id="8493557">got</span><span class="op" id="8493560">)</span>&nbsp;<span class="op" id="8493562">!=</span>&nbsp;<span class="builtinfunc" id="8493565">len</span><span class="op" id="8493568">(</span><span class="ident" id="8493569">want</span><span class="op" id="8493573">)</span>&nbsp;<span class="op" id="8493575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493579">t</span><span class="op" id="8493580">.</span><span class="ident" id="8493581">Fatal</span><span class="op" id="8493586">(</span><span class="string" id="8493587">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8493612">,</span>&nbsp;<span class="builtinfunc" id="8493614">len</span><span class="op" id="8493617">(</span><span class="ident" id="8493618">got</span><span class="op" id="8493621">)</span><span class="op" id="8493622">,</span>&nbsp;<span class="builtinfunc" id="8493624">len</span><span class="op" id="8493627">(</span><span class="ident" id="8493628">want</span><span class="op" id="8493632">)</span><span class="op" id="8493633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8493639">for</span>&nbsp;<span class="ident" id="8493643">i</span><span class="op" id="8493644">,</span>&nbsp;<span class="ident" id="8493646">w</span>&nbsp;<span class="op" id="8493648">:=</span>&nbsp;<span class="keyword" id="8493651">range</span>&nbsp;<span class="ident" id="8493657">want</span>&nbsp;<span class="op" id="8493662">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493666">g</span>&nbsp;<span class="op" id="8493668">:=</span>&nbsp;<span class="ident" id="8493671">got</span><span class="op" id="8493674">[</span><span class="ident" id="8493675">i</span><span class="op" id="8493676">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8493680">if</span>&nbsp;<span class="ident" id="8493683">g</span><span class="op" id="8493684">.</span><span class="ident" id="8493685">Name</span>&nbsp;<span class="op" id="8493690">!=</span>&nbsp;<span class="ident" id="8493693">w</span><span class="op" id="8493694">.</span><span class="ident" id="8493695">Name</span>&nbsp;<span class="op" id="8493700">||</span>&nbsp;<span class="ident" id="8493703">g</span><span class="op" id="8493704">.</span><span class="ident" id="8493705">Value</span>&nbsp;<span class="op" id="8493711">!=</span>&nbsp;<span class="ident" id="8493714">w</span><span class="op" id="8493715">.</span><span class="ident" id="8493716">Value</span>&nbsp;<span class="op" id="8493722">||</span>&nbsp;<span class="ident" id="8493725">g</span><span class="op" id="8493726">.</span><span class="ident" id="8493727">MaxAge</span>&nbsp;<span class="op" id="8493734">!=</span>&nbsp;<span class="ident" id="8493737">w</span><span class="op" id="8493738">.</span><span class="ident" id="8493739">MaxAge</span>&nbsp;<span class="op" id="8493746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493751">t</span><span class="op" id="8493752">.</span><span class="ident" id="8493753">Errorf</span><span class="op" id="8493759">(</span><span class="string" id="8493760">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="8493791">,</span>&nbsp;<span class="ident" id="8493793">i</span><span class="op" id="8493794">,</span>&nbsp;<span class="ident" id="8493796">g</span><span class="op" id="8493797">,</span>&nbsp;<span class="ident" id="8493799">w</span><span class="op" id="8493800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493807">}</span><br>
<span class="lineno">360</span><span class="op" id="8493809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8493812">func</span>&nbsp;<span class="ident" id="8493817">TestCookieSanitizeValue</span><span class="op" id="8493840">(</span><span class="ident" id="8493841">t</span>&nbsp;<span class="op" id="8493843">*</span><span class="ident" id="8493844">testing</span><span class="op" id="8493851">.</span><span class="ident" id="8493852">T</span><span class="op" id="8493853">)</span>&nbsp;<span class="op" id="8493855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8493858">defer</span>&nbsp;<span class="ident" id="8493864">log</span><span class="op" id="8493867">.</span><span class="ident" id="8493868">SetOutput</span><span class="op" id="8493877">(</span><span class="ident" id="8493878">os</span><span class="op" id="8493880">.</span><span class="ident" id="8493881">Stderr</span><span class="op" id="8493887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8493890">var</span>&nbsp;<span class="ident" id="8493894">logbuf</span>&nbsp;<span class="ident" id="8493901">bytes</span><span class="op" id="8493906">.</span><span class="ident" id="8493907">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493915">log</span><span class="op" id="8493918">.</span><span class="ident" id="8493919">SetOutput</span><span class="op" id="8493928">(</span><span class="op" id="8493929">&amp;</span><span class="ident" id="8493930">logbuf</span><span class="op" id="8493936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493940">tests</span>&nbsp;<span class="op" id="8493946">:=</span>&nbsp;<span class="op" id="8493949">[</span><span class="op" id="8493950">]</span><span class="keyword" id="8493951">struct</span>&nbsp;<span class="op" id="8493958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8493962">in</span><span class="op" id="8493964">,</span>&nbsp;<span class="ident" id="8493966">want</span>&nbsp;<span class="builtintype" id="8493971">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493979">}</span><span class="op" id="8493980">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8493984">{</span><span class="string" id="8493985">&#34;foo&#34;</span><span class="op" id="8493990">,</span>&nbsp;<span class="string" id="8493992">&#34;foo&#34;</span><span class="op" id="8493997">}</span><span class="op" id="8493998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494002">{</span><span class="string" id="8494003">&#34;foo;bar&#34;</span><span class="op" id="8494012">,</span>&nbsp;<span class="string" id="8494014">&#34;foobar&#34;</span><span class="op" id="8494022">}</span><span class="op" id="8494023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494027">{</span><span class="string" id="8494028">&#34;foo\\bar&#34;</span><span class="op" id="8494038">,</span>&nbsp;<span class="string" id="8494040">&#34;foobar&#34;</span><span class="op" id="8494048">}</span><span class="op" id="8494049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494053">{</span><span class="string" id="8494054">&#34;foo\&#34;bar&#34;</span><span class="op" id="8494064">,</span>&nbsp;<span class="string" id="8494066">&#34;foobar&#34;</span><span class="op" id="8494074">}</span><span class="op" id="8494075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494079">{</span><span class="string" id="8494080">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="8494098">,</span>&nbsp;<span class="string" id="8494100">&#34;\x7e&#34;</span><span class="op" id="8494106">}</span><span class="op" id="8494107">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494111">{</span><span class="string" id="8494112">`&#34;withquotes&#34;`</span><span class="op" id="8494126">,</span>&nbsp;<span class="string" id="8494128">&#34;withquotes&#34;</span><span class="op" id="8494140">}</span><span class="op" id="8494141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494145">{</span><span class="string" id="8494146">&#34;a&nbsp;z&#34;</span><span class="op" id="8494151">,</span>&nbsp;<span class="string" id="8494153">&#34;a&nbsp;z&#34;</span><span class="op" id="8494158">}</span><span class="op" id="8494159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494163">{</span><span class="string" id="8494164">&#34;&nbsp;z&#34;</span><span class="op" id="8494168">,</span>&nbsp;<span class="string" id="8494170">`&#34;&nbsp;z&#34;`</span><span class="op" id="8494176">}</span><span class="op" id="8494177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494181">{</span><span class="string" id="8494182">&#34;a&nbsp;&#34;</span><span class="op" id="8494186">,</span>&nbsp;<span class="string" id="8494188">`&#34;a&nbsp;&#34;`</span><span class="op" id="8494194">}</span><span class="op" id="8494195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494198">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494201">for</span>&nbsp;<span class="ident" id="8494205">_</span><span class="op" id="8494206">,</span>&nbsp;<span class="ident" id="8494208">tt</span>&nbsp;<span class="op" id="8494211">:=</span>&nbsp;<span class="keyword" id="8494214">range</span>&nbsp;<span class="ident" id="8494220">tests</span>&nbsp;<span class="op" id="8494226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494230">if</span>&nbsp;<span class="ident" id="8494233">got</span>&nbsp;<span class="op" id="8494237">:=</span>&nbsp;<span class="ident" id="8494240">sanitizeCookieValue</span><span class="op" id="8494259">(</span><span class="ident" id="8494260">tt</span><span class="op" id="8494262">.</span><span class="ident" id="8494263">in</span><span class="op" id="8494265">)</span><span class="op" id="8494266">;</span>&nbsp;<span class="ident" id="8494268">got</span>&nbsp;<span class="op" id="8494272">!=</span>&nbsp;<span class="ident" id="8494275">tt</span><span class="op" id="8494277">.</span><span class="ident" id="8494278">want</span>&nbsp;<span class="op" id="8494283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494288">t</span><span class="op" id="8494289">.</span><span class="ident" id="8494290">Errorf</span><span class="op" id="8494296">(</span><span class="string" id="8494297">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8494336">,</span>&nbsp;<span class="ident" id="8494338">tt</span><span class="op" id="8494340">.</span><span class="ident" id="8494341">in</span><span class="op" id="8494343">,</span>&nbsp;<span class="ident" id="8494345">got</span><span class="op" id="8494348">,</span>&nbsp;<span class="ident" id="8494350">tt</span><span class="op" id="8494352">.</span><span class="ident" id="8494353">want</span><span class="op" id="8494357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494364">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494368">if</span>&nbsp;<span class="ident" id="8494371">got</span><span class="op" id="8494374">,</span>&nbsp;<span class="ident" id="8494376">sub</span>&nbsp;<span class="op" id="8494380">:=</span>&nbsp;<span class="ident" id="8494383">logbuf</span><span class="op" id="8494389">.</span><span class="ident" id="8494390">String</span><span class="op" id="8494396">(</span><span class="op" id="8494397">)</span><span class="op" id="8494398">,</span>&nbsp;<span class="string" id="8494400">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="8494424">;</span>&nbsp;<span class="op" id="8494426">!</span><span class="ident" id="8494427">strings</span><span class="op" id="8494434">.</span><span class="ident" id="8494435">Contains</span><span class="op" id="8494443">(</span><span class="ident" id="8494444">got</span><span class="op" id="8494447">,</span>&nbsp;<span class="ident" id="8494449">sub</span><span class="op" id="8494452">)</span>&nbsp;<span class="op" id="8494454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494458">t</span><span class="op" id="8494459">.</span><span class="ident" id="8494460">Errorf</span><span class="op" id="8494466">(</span><span class="string" id="8494467">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8494514">,</span>&nbsp;<span class="ident" id="8494516">sub</span><span class="op" id="8494519">,</span>&nbsp;<span class="ident" id="8494521">got</span><span class="op" id="8494524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494527">}</span><br>
<span class="lineno"></span><span class="op" id="8494529">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="8494532">func</span>&nbsp;<span class="ident" id="8494537">TestCookieSanitizePath</span><span class="op" id="8494559">(</span><span class="ident" id="8494560">t</span>&nbsp;<span class="op" id="8494562">*</span><span class="ident" id="8494563">testing</span><span class="op" id="8494570">.</span><span class="ident" id="8494571">T</span><span class="op" id="8494572">)</span>&nbsp;<span class="op" id="8494574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494577">defer</span>&nbsp;<span class="ident" id="8494583">log</span><span class="op" id="8494586">.</span><span class="ident" id="8494587">SetOutput</span><span class="op" id="8494596">(</span><span class="ident" id="8494597">os</span><span class="op" id="8494599">.</span><span class="ident" id="8494600">Stderr</span><span class="op" id="8494606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494609">var</span>&nbsp;<span class="ident" id="8494613">logbuf</span>&nbsp;<span class="ident" id="8494620">bytes</span><span class="op" id="8494625">.</span><span class="ident" id="8494626">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494634">log</span><span class="op" id="8494637">.</span><span class="ident" id="8494638">SetOutput</span><span class="op" id="8494647">(</span><span class="op" id="8494648">&amp;</span><span class="ident" id="8494649">logbuf</span><span class="op" id="8494655">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494659">tests</span>&nbsp;<span class="op" id="8494665">:=</span>&nbsp;<span class="op" id="8494668">[</span><span class="op" id="8494669">]</span><span class="keyword" id="8494670">struct</span>&nbsp;<span class="op" id="8494677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494681">in</span><span class="op" id="8494683">,</span>&nbsp;<span class="ident" id="8494685">want</span>&nbsp;<span class="builtintype" id="8494690">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494698">}</span><span class="op" id="8494699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494703">{</span><span class="string" id="8494704">&#34;/path&#34;</span><span class="op" id="8494711">,</span>&nbsp;<span class="string" id="8494713">&#34;/path&#34;</span><span class="op" id="8494720">}</span><span class="op" id="8494721">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494725">{</span><span class="string" id="8494726">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="8494745">,</span>&nbsp;<span class="string" id="8494747">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="8494766">}</span><span class="op" id="8494767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494771">{</span><span class="string" id="8494772">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="8494804">,</span>&nbsp;<span class="string" id="8494806">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="8494832">}</span><span class="op" id="8494833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494839">for</span>&nbsp;<span class="ident" id="8494843">_</span><span class="op" id="8494844">,</span>&nbsp;<span class="ident" id="8494846">tt</span>&nbsp;<span class="op" id="8494849">:=</span>&nbsp;<span class="keyword" id="8494852">range</span>&nbsp;<span class="ident" id="8494858">tests</span>&nbsp;<span class="op" id="8494864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8494868">if</span>&nbsp;<span class="ident" id="8494871">got</span>&nbsp;<span class="op" id="8494875">:=</span>&nbsp;<span class="ident" id="8494878">sanitizeCookiePath</span><span class="op" id="8494896">(</span><span class="ident" id="8494897">tt</span><span class="op" id="8494899">.</span><span class="ident" id="8494900">in</span><span class="op" id="8494902">)</span><span class="op" id="8494903">;</span>&nbsp;<span class="ident" id="8494905">got</span>&nbsp;<span class="op" id="8494909">!=</span>&nbsp;<span class="ident" id="8494912">tt</span><span class="op" id="8494914">.</span><span class="ident" id="8494915">want</span>&nbsp;<span class="op" id="8494920">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8494925">t</span><span class="op" id="8494926">.</span><span class="ident" id="8494927">Errorf</span><span class="op" id="8494933">(</span><span class="string" id="8494934">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8494972">,</span>&nbsp;<span class="ident" id="8494974">tt</span><span class="op" id="8494976">.</span><span class="ident" id="8494977">in</span><span class="op" id="8494979">,</span>&nbsp;<span class="ident" id="8494981">got</span><span class="op" id="8494984">,</span>&nbsp;<span class="ident" id="8494986">tt</span><span class="op" id="8494988">.</span><span class="ident" id="8494989">want</span><span class="op" id="8494993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8494997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8495000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8495004">if</span>&nbsp;<span class="ident" id="8495007">got</span><span class="op" id="8495010">,</span>&nbsp;<span class="ident" id="8495012">sub</span>&nbsp;<span class="op" id="8495016">:=</span>&nbsp;<span class="ident" id="8495019">logbuf</span><span class="op" id="8495025">.</span><span class="ident" id="8495026">String</span><span class="op" id="8495032">(</span><span class="op" id="8495033">)</span><span class="op" id="8495034">,</span>&nbsp;<span class="string" id="8495036">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="8495060">;</span>&nbsp;<span class="op" id="8495062">!</span><span class="ident" id="8495063">strings</span><span class="op" id="8495070">.</span><span class="ident" id="8495071">Contains</span><span class="op" id="8495079">(</span><span class="ident" id="8495080">got</span><span class="op" id="8495083">,</span>&nbsp;<span class="ident" id="8495085">sub</span><span class="op" id="8495088">)</span>&nbsp;<span class="op" id="8495090">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8495094">t</span><span class="op" id="8495095">.</span><span class="ident" id="8495096">Errorf</span><span class="op" id="8495102">(</span><span class="string" id="8495103">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8495150">,</span>&nbsp;<span class="ident" id="8495152">sub</span><span class="op" id="8495155">,</span>&nbsp;<span class="ident" id="8495157">got</span><span class="op" id="8495160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8495163">}</span><br>
<span class="lineno"></span><span class="op" id="8495165">}</span>
</div>
</body>
</html>
