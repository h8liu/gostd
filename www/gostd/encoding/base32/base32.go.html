<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html" class="current">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5453040">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5453095">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5453149">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5453200">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5453271">package</span>&nbsp;<span class="ident" id="5453279">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5453287">import</span>&nbsp;<span class="op" id="5453294">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5453297">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5453306">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5453312">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5453323">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5453333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5453336">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5453357">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5453425">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5453493">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="5453553">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="5453610">type</span>&nbsp;<span class="ident" id="5453615">Encoding</span>&nbsp;<span class="keyword" id="5453624">struct</span>&nbsp;<span class="op" id="5453631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5453634">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5453644">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5453652">decodeMap</span>&nbsp;<span class="op" id="5453662">[</span><span class="num" id="5453663">256</span><span class="op" id="5453666">]</span><span class="builtintype" id="5453667">byte</span><br>
<span class="lineno"></span><span class="op" id="5453672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5453675">const</span>&nbsp;<span class="ident" id="5453681">encodeStd</span>&nbsp;<span class="op" id="5453691">=</span>&nbsp;<span class="string" id="5453693">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="5453728">const</span>&nbsp;<span class="ident" id="5453734">encodeHex</span>&nbsp;<span class="op" id="5453744">=</span>&nbsp;<span class="string" id="5453746">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5453782">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="5453851">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5453886">func</span>&nbsp;<span class="ident" id="5453891">NewEncoding</span><span class="op" id="5453902">(</span><span class="ident" id="5453903">encoder</span>&nbsp;<span class="builtintype" id="5453911">string</span><span class="op" id="5453917">)</span>&nbsp;<span class="op" id="5453919">*</span><span class="ident" id="5453920">Encoding</span>&nbsp;<span class="op" id="5453929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5453932">e</span>&nbsp;<span class="op" id="5453934">:=</span>&nbsp;<span class="builtinfunc" id="5453937">new</span><span class="op" id="5453940">(</span><span class="ident" id="5453941">Encoding</span><span class="op" id="5453949">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5453952">e</span><span class="op" id="5453953">.</span><span class="ident" id="5453954">encode</span>&nbsp;<span class="op" id="5453961">=</span>&nbsp;<span class="ident" id="5453963">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5453972">for</span>&nbsp;<span class="ident" id="5453976">i</span>&nbsp;<span class="op" id="5453978">:=</span>&nbsp;<span class="num" id="5453981">0</span><span class="op" id="5453982">;</span>&nbsp;<span class="ident" id="5453984">i</span>&nbsp;<span class="op" id="5453986">&lt;</span>&nbsp;<span class="builtinfunc" id="5453988">len</span><span class="op" id="5453991">(</span><span class="ident" id="5453992">e</span><span class="op" id="5453993">.</span><span class="ident" id="5453994">decodeMap</span><span class="op" id="5454003">)</span><span class="op" id="5454004">;</span>&nbsp;<span class="ident" id="5454006">i</span><span class="op" id="5454007">++</span>&nbsp;<span class="op" id="5454010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5454014">e</span><span class="op" id="5454015">.</span><span class="ident" id="5454016">decodeMap</span><span class="op" id="5454025">[</span><span class="ident" id="5454026">i</span><span class="op" id="5454027">]</span>&nbsp;<span class="op" id="5454029">=</span>&nbsp;<span class="num" id="5454031">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5454037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5454040">for</span>&nbsp;<span class="ident" id="5454044">i</span>&nbsp;<span class="op" id="5454046">:=</span>&nbsp;<span class="num" id="5454049">0</span><span class="op" id="5454050">;</span>&nbsp;<span class="ident" id="5454052">i</span>&nbsp;<span class="op" id="5454054">&lt;</span>&nbsp;<span class="builtinfunc" id="5454056">len</span><span class="op" id="5454059">(</span><span class="ident" id="5454060">encoder</span><span class="op" id="5454067">)</span><span class="op" id="5454068">;</span>&nbsp;<span class="ident" id="5454070">i</span><span class="op" id="5454071">++</span>&nbsp;<span class="op" id="5454074">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5454078">e</span><span class="op" id="5454079">.</span><span class="ident" id="5454080">decodeMap</span><span class="op" id="5454089">[</span><span class="ident" id="5454090">encoder</span><span class="op" id="5454097">[</span><span class="ident" id="5454098">i</span><span class="op" id="5454099">]</span><span class="op" id="5454100">]</span>&nbsp;<span class="op" id="5454102">=</span>&nbsp;<span class="builtintype" id="5454104">byte</span><span class="op" id="5454108">(</span><span class="ident" id="5454109">i</span><span class="op" id="5454110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5454113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5454116">return</span>&nbsp;<span class="ident" id="5454123">e</span><br>
<span class="lineno"></span><span class="op" id="5454125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5454128">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5454190">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5454203">var</span>&nbsp;<span class="ident" id="5454207">StdEncoding</span>&nbsp;<span class="op" id="5454219">=</span>&nbsp;<span class="ident" id="5454221">NewEncoding</span><span class="op" id="5454232">(</span><span class="ident" id="5454233">encodeStd</span><span class="op" id="5454242">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5454245">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="5454314">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="5454346">var</span>&nbsp;<span class="ident" id="5454350">HexEncoding</span>&nbsp;<span class="op" id="5454362">=</span>&nbsp;<span class="ident" id="5454364">NewEncoding</span><span class="op" id="5454375">(</span><span class="ident" id="5454376">encodeHex</span><span class="op" id="5454385">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5454388">var</span>&nbsp;<span class="ident" id="5454392">removeNewlinesMapper</span>&nbsp;<span class="op" id="5454413">=</span>&nbsp;<span class="keyword" id="5454415">func</span><span class="op" id="5454419">(</span><span class="ident" id="5454420">r</span>&nbsp;<span class="builtintype" id="5454422">rune</span><span class="op" id="5454426">)</span>&nbsp;<span class="builtintype" id="5454428">rune</span>&nbsp;<span class="op" id="5454433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5454436">if</span>&nbsp;<span class="ident" id="5454439">r</span>&nbsp;<span class="op" id="5454441">==</span>&nbsp;<span class="string" id="5454444">&#39;\r&#39;</span>&nbsp;<span class="op" id="5454449">||</span>&nbsp;<span class="ident" id="5454452">r</span>&nbsp;<span class="op" id="5454454">==</span>&nbsp;<span class="string" id="5454457">&#39;\n&#39;</span>&nbsp;<span class="op" id="5454462">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5454466">return</span>&nbsp;<span class="op" id="5454473">-</span><span class="num" id="5454474">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5454477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5454480">return</span>&nbsp;<span class="ident" id="5454487">r</span><br>
<span class="lineno"></span><span class="op" id="5454489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="5454492">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5454511">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="5454565">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="5454603">//</span><br>
<span class="lineno"></span><span class="comment" id="5454606">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="5454664">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="5454725">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="5454779">func</span>&nbsp;<span class="op" id="5454784">(</span><span class="ident" id="5454785">enc</span>&nbsp;<span class="op" id="5454789">*</span><span class="ident" id="5454790">Encoding</span><span class="op" id="5454798">)</span>&nbsp;<span class="ident" id="5454800">Encode</span><span class="op" id="5454806">(</span><span class="ident" id="5454807">dst</span><span class="op" id="5454810">,</span>&nbsp;<span class="ident" id="5454812">src</span>&nbsp;<span class="op" id="5454816">[</span><span class="op" id="5454817">]</span><span class="builtintype" id="5454818">byte</span><span class="op" id="5454822">)</span>&nbsp;<span class="op" id="5454824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5454827">if</span>&nbsp;<span class="builtinfunc" id="5454830">len</span><span class="op" id="5454833">(</span><span class="ident" id="5454834">src</span><span class="op" id="5454837">)</span>&nbsp;<span class="op" id="5454839">==</span>&nbsp;<span class="num" id="5454842">0</span>&nbsp;<span class="op" id="5454844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5454848">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5454856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5454860">for</span>&nbsp;<span class="builtinfunc" id="5454864">len</span><span class="op" id="5454867">(</span><span class="ident" id="5454868">src</span><span class="op" id="5454871">)</span>&nbsp;<span class="op" id="5454873">&gt;</span>&nbsp;<span class="num" id="5454875">0</span>&nbsp;<span class="op" id="5454877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5454881">var</span>&nbsp;<span class="ident" id="5454885">b0</span><span class="op" id="5454887">,</span>&nbsp;<span class="ident" id="5454889">b1</span><span class="op" id="5454891">,</span>&nbsp;<span class="ident" id="5454893">b2</span><span class="op" id="5454895">,</span>&nbsp;<span class="ident" id="5454897">b3</span><span class="op" id="5454899">,</span>&nbsp;<span class="ident" id="5454901">b4</span><span class="op" id="5454903">,</span>&nbsp;<span class="ident" id="5454905">b5</span><span class="op" id="5454907">,</span>&nbsp;<span class="ident" id="5454909">b6</span><span class="op" id="5454911">,</span>&nbsp;<span class="ident" id="5454913">b7</span>&nbsp;<span class="builtintype" id="5454916">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5454924">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5454973">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5454998">switch</span>&nbsp;<span class="builtinfunc" id="5455005">len</span><span class="op" id="5455008">(</span><span class="ident" id="5455009">src</span><span class="op" id="5455012">)</span>&nbsp;<span class="op" id="5455014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455018">default</span><span class="op" id="5455025">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455030">b7</span>&nbsp;<span class="op" id="5455033">=</span>&nbsp;<span class="ident" id="5455035">src</span><span class="op" id="5455038">[</span><span class="num" id="5455039">4</span><span class="op" id="5455040">]</span>&nbsp;<span class="op" id="5455042">&amp;</span>&nbsp;<span class="num" id="5455044">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455052">b6</span>&nbsp;<span class="op" id="5455055">=</span>&nbsp;<span class="ident" id="5455057">src</span><span class="op" id="5455060">[</span><span class="num" id="5455061">4</span><span class="op" id="5455062">]</span>&nbsp;<span class="op" id="5455064">&gt;&gt;</span>&nbsp;<span class="num" id="5455067">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455072">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455086">case</span>&nbsp;<span class="num" id="5455091">4</span><span class="op" id="5455092">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455097">b6</span>&nbsp;<span class="op" id="5455100">|=</span>&nbsp;<span class="op" id="5455103">(</span><span class="ident" id="5455104">src</span><span class="op" id="5455107">[</span><span class="num" id="5455108">3</span><span class="op" id="5455109">]</span>&nbsp;<span class="op" id="5455111">&lt;&lt;</span>&nbsp;<span class="num" id="5455114">3</span><span class="op" id="5455115">)</span>&nbsp;<span class="op" id="5455117">&amp;</span>&nbsp;<span class="num" id="5455119">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455127">b5</span>&nbsp;<span class="op" id="5455130">=</span>&nbsp;<span class="op" id="5455132">(</span><span class="ident" id="5455133">src</span><span class="op" id="5455136">[</span><span class="num" id="5455137">3</span><span class="op" id="5455138">]</span>&nbsp;<span class="op" id="5455140">&gt;&gt;</span>&nbsp;<span class="num" id="5455143">2</span><span class="op" id="5455144">)</span>&nbsp;<span class="op" id="5455146">&amp;</span>&nbsp;<span class="num" id="5455148">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455156">b4</span>&nbsp;<span class="op" id="5455159">=</span>&nbsp;<span class="ident" id="5455161">src</span><span class="op" id="5455164">[</span><span class="num" id="5455165">3</span><span class="op" id="5455166">]</span>&nbsp;<span class="op" id="5455168">&gt;&gt;</span>&nbsp;<span class="num" id="5455171">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455176">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455190">case</span>&nbsp;<span class="num" id="5455195">3</span><span class="op" id="5455196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455201">b4</span>&nbsp;<span class="op" id="5455204">|=</span>&nbsp;<span class="op" id="5455207">(</span><span class="ident" id="5455208">src</span><span class="op" id="5455211">[</span><span class="num" id="5455212">2</span><span class="op" id="5455213">]</span>&nbsp;<span class="op" id="5455215">&lt;&lt;</span>&nbsp;<span class="num" id="5455218">1</span><span class="op" id="5455219">)</span>&nbsp;<span class="op" id="5455221">&amp;</span>&nbsp;<span class="num" id="5455223">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455231">b3</span>&nbsp;<span class="op" id="5455234">=</span>&nbsp;<span class="op" id="5455236">(</span><span class="ident" id="5455237">src</span><span class="op" id="5455240">[</span><span class="num" id="5455241">2</span><span class="op" id="5455242">]</span>&nbsp;<span class="op" id="5455244">&gt;&gt;</span>&nbsp;<span class="num" id="5455247">4</span><span class="op" id="5455248">)</span>&nbsp;<span class="op" id="5455250">&amp;</span>&nbsp;<span class="num" id="5455252">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455260">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455274">case</span>&nbsp;<span class="num" id="5455279">2</span><span class="op" id="5455280">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455285">b3</span>&nbsp;<span class="op" id="5455288">|=</span>&nbsp;<span class="op" id="5455291">(</span><span class="ident" id="5455292">src</span><span class="op" id="5455295">[</span><span class="num" id="5455296">1</span><span class="op" id="5455297">]</span>&nbsp;<span class="op" id="5455299">&lt;&lt;</span>&nbsp;<span class="num" id="5455302">4</span><span class="op" id="5455303">)</span>&nbsp;<span class="op" id="5455305">&amp;</span>&nbsp;<span class="num" id="5455307">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455315">b2</span>&nbsp;<span class="op" id="5455318">=</span>&nbsp;<span class="op" id="5455320">(</span><span class="ident" id="5455321">src</span><span class="op" id="5455324">[</span><span class="num" id="5455325">1</span><span class="op" id="5455326">]</span>&nbsp;<span class="op" id="5455328">&gt;&gt;</span>&nbsp;<span class="num" id="5455331">1</span><span class="op" id="5455332">)</span>&nbsp;<span class="op" id="5455334">&amp;</span>&nbsp;<span class="num" id="5455336">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455344">b1</span>&nbsp;<span class="op" id="5455347">=</span>&nbsp;<span class="op" id="5455349">(</span><span class="ident" id="5455350">src</span><span class="op" id="5455353">[</span><span class="num" id="5455354">1</span><span class="op" id="5455355">]</span>&nbsp;<span class="op" id="5455357">&gt;&gt;</span>&nbsp;<span class="num" id="5455360">6</span><span class="op" id="5455361">)</span>&nbsp;<span class="op" id="5455363">&amp;</span>&nbsp;<span class="num" id="5455365">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455373">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455387">case</span>&nbsp;<span class="num" id="5455392">1</span><span class="op" id="5455393">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455398">b1</span>&nbsp;<span class="op" id="5455401">|=</span>&nbsp;<span class="op" id="5455404">(</span><span class="ident" id="5455405">src</span><span class="op" id="5455408">[</span><span class="num" id="5455409">0</span><span class="op" id="5455410">]</span>&nbsp;<span class="op" id="5455412">&lt;&lt;</span>&nbsp;<span class="num" id="5455415">2</span><span class="op" id="5455416">)</span>&nbsp;<span class="op" id="5455418">&amp;</span>&nbsp;<span class="num" id="5455420">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455428">b0</span>&nbsp;<span class="op" id="5455431">=</span>&nbsp;<span class="ident" id="5455433">src</span><span class="op" id="5455436">[</span><span class="num" id="5455437">0</span><span class="op" id="5455438">]</span>&nbsp;<span class="op" id="5455440">&gt;&gt;</span>&nbsp;<span class="num" id="5455443">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5455447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5455452">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455503">dst</span><span class="op" id="5455506">[</span><span class="num" id="5455507">0</span><span class="op" id="5455508">]</span>&nbsp;<span class="op" id="5455510">=</span>&nbsp;<span class="ident" id="5455512">enc</span><span class="op" id="5455515">.</span><span class="ident" id="5455516">encode</span><span class="op" id="5455522">[</span><span class="ident" id="5455523">b0</span><span class="op" id="5455525">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455529">dst</span><span class="op" id="5455532">[</span><span class="num" id="5455533">1</span><span class="op" id="5455534">]</span>&nbsp;<span class="op" id="5455536">=</span>&nbsp;<span class="ident" id="5455538">enc</span><span class="op" id="5455541">.</span><span class="ident" id="5455542">encode</span><span class="op" id="5455548">[</span><span class="ident" id="5455549">b1</span><span class="op" id="5455551">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455555">dst</span><span class="op" id="5455558">[</span><span class="num" id="5455559">2</span><span class="op" id="5455560">]</span>&nbsp;<span class="op" id="5455562">=</span>&nbsp;<span class="ident" id="5455564">enc</span><span class="op" id="5455567">.</span><span class="ident" id="5455568">encode</span><span class="op" id="5455574">[</span><span class="ident" id="5455575">b2</span><span class="op" id="5455577">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455581">dst</span><span class="op" id="5455584">[</span><span class="num" id="5455585">3</span><span class="op" id="5455586">]</span>&nbsp;<span class="op" id="5455588">=</span>&nbsp;<span class="ident" id="5455590">enc</span><span class="op" id="5455593">.</span><span class="ident" id="5455594">encode</span><span class="op" id="5455600">[</span><span class="ident" id="5455601">b3</span><span class="op" id="5455603">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455607">dst</span><span class="op" id="5455610">[</span><span class="num" id="5455611">4</span><span class="op" id="5455612">]</span>&nbsp;<span class="op" id="5455614">=</span>&nbsp;<span class="ident" id="5455616">enc</span><span class="op" id="5455619">.</span><span class="ident" id="5455620">encode</span><span class="op" id="5455626">[</span><span class="ident" id="5455627">b4</span><span class="op" id="5455629">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455633">dst</span><span class="op" id="5455636">[</span><span class="num" id="5455637">5</span><span class="op" id="5455638">]</span>&nbsp;<span class="op" id="5455640">=</span>&nbsp;<span class="ident" id="5455642">enc</span><span class="op" id="5455645">.</span><span class="ident" id="5455646">encode</span><span class="op" id="5455652">[</span><span class="ident" id="5455653">b5</span><span class="op" id="5455655">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455659">dst</span><span class="op" id="5455662">[</span><span class="num" id="5455663">6</span><span class="op" id="5455664">]</span>&nbsp;<span class="op" id="5455666">=</span>&nbsp;<span class="ident" id="5455668">enc</span><span class="op" id="5455671">.</span><span class="ident" id="5455672">encode</span><span class="op" id="5455678">[</span><span class="ident" id="5455679">b6</span><span class="op" id="5455681">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455685">dst</span><span class="op" id="5455688">[</span><span class="num" id="5455689">7</span><span class="op" id="5455690">]</span>&nbsp;<span class="op" id="5455692">=</span>&nbsp;<span class="ident" id="5455694">enc</span><span class="op" id="5455697">.</span><span class="ident" id="5455698">encode</span><span class="op" id="5455704">[</span><span class="ident" id="5455705">b7</span><span class="op" id="5455707">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5455712">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455739">if</span>&nbsp;<span class="builtinfunc" id="5455742">len</span><span class="op" id="5455745">(</span><span class="ident" id="5455746">src</span><span class="op" id="5455749">)</span>&nbsp;<span class="op" id="5455751">&lt;</span>&nbsp;<span class="num" id="5455753">5</span>&nbsp;<span class="op" id="5455755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455760">dst</span><span class="op" id="5455763">[</span><span class="num" id="5455764">7</span><span class="op" id="5455765">]</span>&nbsp;<span class="op" id="5455767">=</span>&nbsp;<span class="string" id="5455769">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455776">if</span>&nbsp;<span class="builtinfunc" id="5455779">len</span><span class="op" id="5455782">(</span><span class="ident" id="5455783">src</span><span class="op" id="5455786">)</span>&nbsp;<span class="op" id="5455788">&lt;</span>&nbsp;<span class="num" id="5455790">4</span>&nbsp;<span class="op" id="5455792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455798">dst</span><span class="op" id="5455801">[</span><span class="num" id="5455802">6</span><span class="op" id="5455803">]</span>&nbsp;<span class="op" id="5455805">=</span>&nbsp;<span class="string" id="5455807">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455815">dst</span><span class="op" id="5455818">[</span><span class="num" id="5455819">5</span><span class="op" id="5455820">]</span>&nbsp;<span class="op" id="5455822">=</span>&nbsp;<span class="string" id="5455824">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455832">if</span>&nbsp;<span class="builtinfunc" id="5455835">len</span><span class="op" id="5455838">(</span><span class="ident" id="5455839">src</span><span class="op" id="5455842">)</span>&nbsp;<span class="op" id="5455844">&lt;</span>&nbsp;<span class="num" id="5455846">3</span>&nbsp;<span class="op" id="5455848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455855">dst</span><span class="op" id="5455858">[</span><span class="num" id="5455859">4</span><span class="op" id="5455860">]</span>&nbsp;<span class="op" id="5455862">=</span>&nbsp;<span class="string" id="5455864">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455873">if</span>&nbsp;<span class="builtinfunc" id="5455876">len</span><span class="op" id="5455879">(</span><span class="ident" id="5455880">src</span><span class="op" id="5455883">)</span>&nbsp;<span class="op" id="5455885">&lt;</span>&nbsp;<span class="num" id="5455887">2</span>&nbsp;<span class="op" id="5455889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455897">dst</span><span class="op" id="5455900">[</span><span class="num" id="5455901">3</span><span class="op" id="5455902">]</span>&nbsp;<span class="op" id="5455904">=</span>&nbsp;<span class="string" id="5455906">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455916">dst</span><span class="op" id="5455919">[</span><span class="num" id="5455920">2</span><span class="op" id="5455921">]</span>&nbsp;<span class="op" id="5455923">=</span>&nbsp;<span class="string" id="5455925">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5455934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5455940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5455945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5455950">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5455958">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455962">src</span>&nbsp;<span class="op" id="5455966">=</span>&nbsp;<span class="ident" id="5455968">src</span><span class="op" id="5455971">[</span><span class="num" id="5455972">5</span><span class="op" id="5455973">:</span><span class="op" id="5455974">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5455978">dst</span>&nbsp;<span class="op" id="5455982">=</span>&nbsp;<span class="ident" id="5455984">dst</span><span class="op" id="5455987">[</span><span class="num" id="5455988">8</span><span class="op" id="5455989">:</span><span class="op" id="5455990">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5455993">}</span><br>
<span class="lineno"></span><span class="op" id="5455995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5455998">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="5456052">func</span>&nbsp;<span class="op" id="5456057">(</span><span class="ident" id="5456058">enc</span>&nbsp;<span class="op" id="5456062">*</span><span class="ident" id="5456063">Encoding</span><span class="op" id="5456071">)</span>&nbsp;<span class="ident" id="5456073">EncodeToString</span><span class="op" id="5456087">(</span><span class="ident" id="5456088">src</span>&nbsp;<span class="op" id="5456092">[</span><span class="op" id="5456093">]</span><span class="builtintype" id="5456094">byte</span><span class="op" id="5456098">)</span>&nbsp;<span class="builtintype" id="5456100">string</span>&nbsp;<span class="op" id="5456107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456110">buf</span>&nbsp;<span class="op" id="5456114">:=</span>&nbsp;<span class="builtinfunc" id="5456117">make</span><span class="op" id="5456121">(</span><span class="op" id="5456122">[</span><span class="op" id="5456123">]</span><span class="builtintype" id="5456124">byte</span><span class="op" id="5456128">,</span>&nbsp;<span class="ident" id="5456130">enc</span><span class="op" id="5456133">.</span><span class="ident" id="5456134">EncodedLen</span><span class="op" id="5456144">(</span><span class="builtinfunc" id="5456145">len</span><span class="op" id="5456148">(</span><span class="ident" id="5456149">src</span><span class="op" id="5456152">)</span><span class="op" id="5456153">)</span><span class="op" id="5456154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456157">enc</span><span class="op" id="5456160">.</span><span class="ident" id="5456161">Encode</span><span class="op" id="5456167">(</span><span class="ident" id="5456168">buf</span><span class="op" id="5456171">,</span>&nbsp;<span class="ident" id="5456173">src</span><span class="op" id="5456176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456179">return</span>&nbsp;<span class="builtintype" id="5456186">string</span><span class="op" id="5456192">(</span><span class="ident" id="5456193">buf</span><span class="op" id="5456196">)</span><br>
<span class="lineno">140</span><span class="op" id="5456198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5456201">type</span>&nbsp;<span class="ident" id="5456206">encoder</span>&nbsp;<span class="keyword" id="5456214">struct</span>&nbsp;<span class="op" id="5456221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456224">err</span>&nbsp;&nbsp;<span class="builtintype" id="5456229">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456236">enc</span>&nbsp;&nbsp;<span class="op" id="5456241">*</span><span class="ident" id="5456242">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456252">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5456257">io</span><span class="op" id="5456259">.</span><span class="ident" id="5456260">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456268">buf</span>&nbsp;&nbsp;<span class="op" id="5456273">[</span><span class="num" id="5456274">5</span><span class="op" id="5456275">]</span><span class="builtintype" id="5456276">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5456284">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456324">nbuf</span>&nbsp;<span class="builtintype" id="5456329">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5456340">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456367">out</span>&nbsp;&nbsp;<span class="op" id="5456372">[</span><span class="num" id="5456373">1024</span><span class="op" id="5456377">]</span><span class="builtintype" id="5456378">byte</span>&nbsp;<span class="comment" id="5456383">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="5456400">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="5456403">func</span>&nbsp;<span class="op" id="5456408">(</span><span class="ident" id="5456409">e</span>&nbsp;<span class="op" id="5456411">*</span><span class="ident" id="5456412">encoder</span><span class="op" id="5456419">)</span>&nbsp;<span class="ident" id="5456421">Write</span><span class="op" id="5456426">(</span><span class="ident" id="5456427">p</span>&nbsp;<span class="op" id="5456429">[</span><span class="op" id="5456430">]</span><span class="builtintype" id="5456431">byte</span><span class="op" id="5456435">)</span>&nbsp;<span class="op" id="5456437">(</span><span class="ident" id="5456438">n</span>&nbsp;<span class="builtintype" id="5456440">int</span><span class="op" id="5456443">,</span>&nbsp;<span class="ident" id="5456445">err</span>&nbsp;<span class="builtintype" id="5456449">error</span><span class="op" id="5456454">)</span>&nbsp;<span class="op" id="5456456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456459">if</span>&nbsp;<span class="ident" id="5456462">e</span><span class="op" id="5456463">.</span><span class="ident" id="5456464">err</span>&nbsp;<span class="op" id="5456468">!=</span>&nbsp;<span class="ident" id="5456471">nil</span>&nbsp;<span class="op" id="5456475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456479">return</span>&nbsp;<span class="num" id="5456486">0</span><span class="op" id="5456487">,</span>&nbsp;<span class="ident" id="5456489">e</span><span class="op" id="5456490">.</span><span class="ident" id="5456491">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5456496">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5456500">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456520">if</span>&nbsp;<span class="ident" id="5456523">e</span><span class="op" id="5456524">.</span><span class="ident" id="5456525">nbuf</span>&nbsp;<span class="op" id="5456530">&gt;</span>&nbsp;<span class="num" id="5456532">0</span>&nbsp;<span class="op" id="5456534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456538">var</span>&nbsp;<span class="ident" id="5456542">i</span>&nbsp;<span class="builtintype" id="5456544">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456550">for</span>&nbsp;<span class="ident" id="5456554">i</span>&nbsp;<span class="op" id="5456556">=</span>&nbsp;<span class="num" id="5456558">0</span><span class="op" id="5456559">;</span>&nbsp;<span class="ident" id="5456561">i</span>&nbsp;<span class="op" id="5456563">&lt;</span>&nbsp;<span class="builtinfunc" id="5456565">len</span><span class="op" id="5456568">(</span><span class="ident" id="5456569">p</span><span class="op" id="5456570">)</span>&nbsp;<span class="op" id="5456572">&amp;&amp;</span>&nbsp;<span class="ident" id="5456575">e</span><span class="op" id="5456576">.</span><span class="ident" id="5456577">nbuf</span>&nbsp;<span class="op" id="5456582">&lt;</span>&nbsp;<span class="num" id="5456584">5</span><span class="op" id="5456585">;</span>&nbsp;<span class="ident" id="5456587">i</span><span class="op" id="5456588">++</span>&nbsp;<span class="op" id="5456591">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456596">e</span><span class="op" id="5456597">.</span><span class="ident" id="5456598">buf</span><span class="op" id="5456601">[</span><span class="ident" id="5456602">e</span><span class="op" id="5456603">.</span><span class="ident" id="5456604">nbuf</span><span class="op" id="5456608">]</span>&nbsp;<span class="op" id="5456610">=</span>&nbsp;<span class="ident" id="5456612">p</span><span class="op" id="5456613">[</span><span class="ident" id="5456614">i</span><span class="op" id="5456615">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456620">e</span><span class="op" id="5456621">.</span><span class="ident" id="5456622">nbuf</span><span class="op" id="5456626">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5456631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456635">n</span>&nbsp;<span class="op" id="5456637">+=</span>&nbsp;<span class="ident" id="5456640">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456644">p</span>&nbsp;<span class="op" id="5456646">=</span>&nbsp;<span class="ident" id="5456648">p</span><span class="op" id="5456649">[</span><span class="ident" id="5456650">i</span><span class="op" id="5456651">:</span><span class="op" id="5456652">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456656">if</span>&nbsp;<span class="ident" id="5456659">e</span><span class="op" id="5456660">.</span><span class="ident" id="5456661">nbuf</span>&nbsp;<span class="op" id="5456666">&lt;</span>&nbsp;<span class="num" id="5456668">5</span>&nbsp;<span class="op" id="5456670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456675">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5456684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456688">e</span><span class="op" id="5456689">.</span><span class="ident" id="5456690">enc</span><span class="op" id="5456693">.</span><span class="ident" id="5456694">Encode</span><span class="op" id="5456700">(</span><span class="ident" id="5456701">e</span><span class="op" id="5456702">.</span><span class="ident" id="5456703">out</span><span class="op" id="5456706">[</span><span class="num" id="5456707">0</span><span class="op" id="5456708">:</span><span class="op" id="5456709">]</span><span class="op" id="5456710">,</span>&nbsp;<span class="ident" id="5456712">e</span><span class="op" id="5456713">.</span><span class="ident" id="5456714">buf</span><span class="op" id="5456717">[</span><span class="num" id="5456718">0</span><span class="op" id="5456719">:</span><span class="op" id="5456720">]</span><span class="op" id="5456721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456725">if</span>&nbsp;<span class="ident" id="5456728">_</span><span class="op" id="5456729">,</span>&nbsp;<span class="ident" id="5456731">e</span><span class="op" id="5456732">.</span><span class="ident" id="5456733">err</span>&nbsp;<span class="op" id="5456737">=</span>&nbsp;<span class="ident" id="5456739">e</span><span class="op" id="5456740">.</span><span class="ident" id="5456741">w</span><span class="op" id="5456742">.</span><span class="ident" id="5456743">Write</span><span class="op" id="5456748">(</span><span class="ident" id="5456749">e</span><span class="op" id="5456750">.</span><span class="ident" id="5456751">out</span><span class="op" id="5456754">[</span><span class="num" id="5456755">0</span><span class="op" id="5456756">:</span><span class="num" id="5456757">8</span><span class="op" id="5456758">]</span><span class="op" id="5456759">)</span><span class="op" id="5456760">;</span>&nbsp;<span class="ident" id="5456762">e</span><span class="op" id="5456763">.</span><span class="ident" id="5456764">err</span>&nbsp;<span class="op" id="5456768">!=</span>&nbsp;<span class="ident" id="5456771">nil</span>&nbsp;<span class="op" id="5456775">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456780">return</span>&nbsp;<span class="ident" id="5456787">n</span><span class="op" id="5456788">,</span>&nbsp;<span class="ident" id="5456790">e</span><span class="op" id="5456791">.</span><span class="ident" id="5456792">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5456798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456802">e</span><span class="op" id="5456803">.</span><span class="ident" id="5456804">nbuf</span>&nbsp;<span class="op" id="5456809">=</span>&nbsp;<span class="num" id="5456811">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5456814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5456818">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456845">for</span>&nbsp;<span class="builtinfunc" id="5456849">len</span><span class="op" id="5456852">(</span><span class="ident" id="5456853">p</span><span class="op" id="5456854">)</span>&nbsp;<span class="op" id="5456856">&gt;=</span>&nbsp;<span class="num" id="5456859">5</span>&nbsp;<span class="op" id="5456861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456865">nn</span>&nbsp;<span class="op" id="5456868">:=</span>&nbsp;<span class="builtinfunc" id="5456871">len</span><span class="op" id="5456874">(</span><span class="ident" id="5456875">e</span><span class="op" id="5456876">.</span><span class="ident" id="5456877">out</span><span class="op" id="5456880">)</span>&nbsp;<span class="op" id="5456882">/</span>&nbsp;<span class="num" id="5456884">8</span>&nbsp;<span class="op" id="5456886">*</span>&nbsp;<span class="num" id="5456888">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456892">if</span>&nbsp;<span class="ident" id="5456895">nn</span>&nbsp;<span class="op" id="5456898">&gt;</span>&nbsp;<span class="builtinfunc" id="5456900">len</span><span class="op" id="5456903">(</span><span class="ident" id="5456904">p</span><span class="op" id="5456905">)</span>&nbsp;<span class="op" id="5456907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456912">nn</span>&nbsp;<span class="op" id="5456915">=</span>&nbsp;<span class="builtinfunc" id="5456917">len</span><span class="op" id="5456920">(</span><span class="ident" id="5456921">p</span><span class="op" id="5456922">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456927">nn</span>&nbsp;<span class="op" id="5456930">-=</span>&nbsp;<span class="ident" id="5456933">nn</span>&nbsp;<span class="op" id="5456936">%</span>&nbsp;<span class="num" id="5456938">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5456942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5456946">e</span><span class="op" id="5456947">.</span><span class="ident" id="5456948">enc</span><span class="op" id="5456951">.</span><span class="ident" id="5456952">Encode</span><span class="op" id="5456958">(</span><span class="ident" id="5456959">e</span><span class="op" id="5456960">.</span><span class="ident" id="5456961">out</span><span class="op" id="5456964">[</span><span class="num" id="5456965">0</span><span class="op" id="5456966">:</span><span class="op" id="5456967">]</span><span class="op" id="5456968">,</span>&nbsp;<span class="ident" id="5456970">p</span><span class="op" id="5456971">[</span><span class="num" id="5456972">0</span><span class="op" id="5456973">:</span><span class="ident" id="5456974">nn</span><span class="op" id="5456976">]</span><span class="op" id="5456977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5456981">if</span>&nbsp;<span class="ident" id="5456984">_</span><span class="op" id="5456985">,</span>&nbsp;<span class="ident" id="5456987">e</span><span class="op" id="5456988">.</span><span class="ident" id="5456989">err</span>&nbsp;<span class="op" id="5456993">=</span>&nbsp;<span class="ident" id="5456995">e</span><span class="op" id="5456996">.</span><span class="ident" id="5456997">w</span><span class="op" id="5456998">.</span><span class="ident" id="5456999">Write</span><span class="op" id="5457004">(</span><span class="ident" id="5457005">e</span><span class="op" id="5457006">.</span><span class="ident" id="5457007">out</span><span class="op" id="5457010">[</span><span class="num" id="5457011">0</span>&nbsp;<span class="op" id="5457013">:</span>&nbsp;<span class="ident" id="5457015">nn</span><span class="op" id="5457017">/</span><span class="num" id="5457018">5</span><span class="op" id="5457019">*</span><span class="num" id="5457020">8</span><span class="op" id="5457021">]</span><span class="op" id="5457022">)</span><span class="op" id="5457023">;</span>&nbsp;<span class="ident" id="5457025">e</span><span class="op" id="5457026">.</span><span class="ident" id="5457027">err</span>&nbsp;<span class="op" id="5457031">!=</span>&nbsp;<span class="ident" id="5457034">nil</span>&nbsp;<span class="op" id="5457038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5457043">return</span>&nbsp;<span class="ident" id="5457050">n</span><span class="op" id="5457051">,</span>&nbsp;<span class="ident" id="5457053">e</span><span class="op" id="5457054">.</span><span class="ident" id="5457055">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5457061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5457065">n</span>&nbsp;<span class="op" id="5457067">+=</span>&nbsp;<span class="ident" id="5457070">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5457075">p</span>&nbsp;<span class="op" id="5457077">=</span>&nbsp;<span class="ident" id="5457079">p</span><span class="op" id="5457080">[</span><span class="ident" id="5457081">nn</span><span class="op" id="5457083">:</span><span class="op" id="5457084">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5457087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5457091">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5457112">for</span>&nbsp;<span class="ident" id="5457116">i</span>&nbsp;<span class="op" id="5457118">:=</span>&nbsp;<span class="num" id="5457121">0</span><span class="op" id="5457122">;</span>&nbsp;<span class="ident" id="5457124">i</span>&nbsp;<span class="op" id="5457126">&lt;</span>&nbsp;<span class="builtinfunc" id="5457128">len</span><span class="op" id="5457131">(</span><span class="ident" id="5457132">p</span><span class="op" id="5457133">)</span><span class="op" id="5457134">;</span>&nbsp;<span class="ident" id="5457136">i</span><span class="op" id="5457137">++</span>&nbsp;<span class="op" id="5457140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5457144">e</span><span class="op" id="5457145">.</span><span class="ident" id="5457146">buf</span><span class="op" id="5457149">[</span><span class="ident" id="5457150">i</span><span class="op" id="5457151">]</span>&nbsp;<span class="op" id="5457153">=</span>&nbsp;<span class="ident" id="5457155">p</span><span class="op" id="5457156">[</span><span class="ident" id="5457157">i</span><span class="op" id="5457158">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5457161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5457164">e</span><span class="op" id="5457165">.</span><span class="ident" id="5457166">nbuf</span>&nbsp;<span class="op" id="5457171">=</span>&nbsp;<span class="builtinfunc" id="5457173">len</span><span class="op" id="5457176">(</span><span class="ident" id="5457177">p</span><span class="op" id="5457178">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5457181">n</span>&nbsp;<span class="op" id="5457183">+=</span>&nbsp;<span class="builtinfunc" id="5457186">len</span><span class="op" id="5457189">(</span><span class="ident" id="5457190">p</span><span class="op" id="5457191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5457194">return</span><br>
<span class="lineno"></span><span class="op" id="5457201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5457204">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="5457258">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="5457311">func</span>&nbsp;<span class="op" id="5457316">(</span><span class="ident" id="5457317">e</span>&nbsp;<span class="op" id="5457319">*</span><span class="ident" id="5457320">encoder</span><span class="op" id="5457327">)</span>&nbsp;<span class="ident" id="5457329">Close</span><span class="op" id="5457334">(</span><span class="op" id="5457335">)</span>&nbsp;<span class="builtintype" id="5457337">error</span>&nbsp;<span class="op" id="5457343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5457346">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5457403">if</span>&nbsp;<span class="ident" id="5457406">e</span><span class="op" id="5457407">.</span><span class="ident" id="5457408">err</span>&nbsp;<span class="op" id="5457412">==</span>&nbsp;<span class="ident" id="5457415">nil</span>&nbsp;<span class="op" id="5457419">&amp;&amp;</span>&nbsp;<span class="ident" id="5457422">e</span><span class="op" id="5457423">.</span><span class="ident" id="5457424">nbuf</span>&nbsp;<span class="op" id="5457429">&gt;</span>&nbsp;<span class="num" id="5457431">0</span>&nbsp;<span class="op" id="5457433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5457437">e</span><span class="op" id="5457438">.</span><span class="ident" id="5457439">enc</span><span class="op" id="5457442">.</span><span class="ident" id="5457443">Encode</span><span class="op" id="5457449">(</span><span class="ident" id="5457450">e</span><span class="op" id="5457451">.</span><span class="ident" id="5457452">out</span><span class="op" id="5457455">[</span><span class="num" id="5457456">0</span><span class="op" id="5457457">:</span><span class="op" id="5457458">]</span><span class="op" id="5457459">,</span>&nbsp;<span class="ident" id="5457461">e</span><span class="op" id="5457462">.</span><span class="ident" id="5457463">buf</span><span class="op" id="5457466">[</span><span class="num" id="5457467">0</span><span class="op" id="5457468">:</span><span class="ident" id="5457469">e</span><span class="op" id="5457470">.</span><span class="ident" id="5457471">nbuf</span><span class="op" id="5457475">]</span><span class="op" id="5457476">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5457480">e</span><span class="op" id="5457481">.</span><span class="ident" id="5457482">nbuf</span>&nbsp;<span class="op" id="5457487">=</span>&nbsp;<span class="num" id="5457489">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5457493">_</span><span class="op" id="5457494">,</span>&nbsp;<span class="ident" id="5457496">e</span><span class="op" id="5457497">.</span><span class="ident" id="5457498">err</span>&nbsp;<span class="op" id="5457502">=</span>&nbsp;<span class="ident" id="5457504">e</span><span class="op" id="5457505">.</span><span class="ident" id="5457506">w</span><span class="op" id="5457507">.</span><span class="ident" id="5457508">Write</span><span class="op" id="5457513">(</span><span class="ident" id="5457514">e</span><span class="op" id="5457515">.</span><span class="ident" id="5457516">out</span><span class="op" id="5457519">[</span><span class="num" id="5457520">0</span><span class="op" id="5457521">:</span><span class="num" id="5457522">8</span><span class="op" id="5457523">]</span><span class="op" id="5457524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5457527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5457530">return</span>&nbsp;<span class="ident" id="5457537">e</span><span class="op" id="5457538">.</span><span class="ident" id="5457539">err</span><br>
<span class="lineno"></span><span class="op" id="5457543">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="5457546">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5457614">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5457686">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="5457746">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="5457814">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="5457843">func</span>&nbsp;<span class="ident" id="5457848">NewEncoder</span><span class="op" id="5457858">(</span><span class="ident" id="5457859">enc</span>&nbsp;<span class="op" id="5457863">*</span><span class="ident" id="5457864">Encoding</span><span class="op" id="5457872">,</span>&nbsp;<span class="ident" id="5457874">w</span>&nbsp;<span class="ident" id="5457876">io</span><span class="op" id="5457878">.</span><span class="ident" id="5457879">Writer</span><span class="op" id="5457885">)</span>&nbsp;<span class="ident" id="5457887">io</span><span class="op" id="5457889">.</span><span class="ident" id="5457890">WriteCloser</span>&nbsp;<span class="op" id="5457902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5457905">return</span>&nbsp;<span class="op" id="5457912">&amp;</span><span class="ident" id="5457913">encoder</span><span class="op" id="5457920">{</span><span class="ident" id="5457921">enc</span><span class="op" id="5457924">:</span>&nbsp;<span class="ident" id="5457926">enc</span><span class="op" id="5457929">,</span>&nbsp;<span class="ident" id="5457931">w</span><span class="op" id="5457932">:</span>&nbsp;<span class="ident" id="5457934">w</span><span class="op" id="5457935">}</span><br>
<span class="lineno"></span><span class="op" id="5457937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5457940">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5458005">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="5458040">func</span>&nbsp;<span class="op" id="5458045">(</span><span class="ident" id="5458046">enc</span>&nbsp;<span class="op" id="5458050">*</span><span class="ident" id="5458051">Encoding</span><span class="op" id="5458059">)</span>&nbsp;<span class="ident" id="5458061">EncodedLen</span><span class="op" id="5458071">(</span><span class="ident" id="5458072">n</span>&nbsp;<span class="builtintype" id="5458074">int</span><span class="op" id="5458077">)</span>&nbsp;<span class="builtintype" id="5458079">int</span>&nbsp;<span class="op" id="5458083">{</span>&nbsp;<span class="keyword" id="5458085">return</span>&nbsp;<span class="op" id="5458092">(</span><span class="ident" id="5458093">n</span>&nbsp;<span class="op" id="5458095">+</span>&nbsp;<span class="num" id="5458097">4</span><span class="op" id="5458098">)</span>&nbsp;<span class="op" id="5458100">/</span>&nbsp;<span class="num" id="5458102">5</span>&nbsp;<span class="op" id="5458104">*</span>&nbsp;<span class="num" id="5458106">8</span>&nbsp;<span class="op" id="5458108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5458111">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5458130">type</span>&nbsp;<span class="ident" id="5458135">CorruptInputError</span>&nbsp;<span class="ident" id="5458153">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="5458160">func</span>&nbsp;<span class="op" id="5458165">(</span><span class="ident" id="5458166">e</span>&nbsp;<span class="ident" id="5458168">CorruptInputError</span><span class="op" id="5458185">)</span>&nbsp;<span class="ident" id="5458187">Error</span><span class="op" id="5458192">(</span><span class="op" id="5458193">)</span>&nbsp;<span class="builtintype" id="5458195">string</span>&nbsp;<span class="op" id="5458202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458205">return</span>&nbsp;<span class="string" id="5458212">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="5458249">+</span>&nbsp;<span class="ident" id="5458251">strconv</span><span class="op" id="5458258">.</span><span class="ident" id="5458259">FormatInt</span><span class="op" id="5458268">(</span><span class="ident" id="5458269">int64</span><span class="op" id="5458274">(</span><span class="ident" id="5458275">e</span><span class="op" id="5458276">)</span><span class="op" id="5458277">,</span>&nbsp;<span class="num" id="5458279">10</span><span class="op" id="5458281">)</span><br>
<span class="lineno"></span><span class="op" id="5458283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5458286">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="5458356">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5458424">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="5458494">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="5458551">func</span>&nbsp;<span class="op" id="5458556">(</span><span class="ident" id="5458557">enc</span>&nbsp;<span class="op" id="5458561">*</span><span class="ident" id="5458562">Encoding</span><span class="op" id="5458570">)</span>&nbsp;<span class="ident" id="5458572">decode</span><span class="op" id="5458578">(</span><span class="ident" id="5458579">dst</span><span class="op" id="5458582">,</span>&nbsp;<span class="ident" id="5458584">src</span>&nbsp;<span class="op" id="5458588">[</span><span class="op" id="5458589">]</span><span class="builtintype" id="5458590">byte</span><span class="op" id="5458594">)</span>&nbsp;<span class="op" id="5458596">(</span><span class="ident" id="5458597">n</span>&nbsp;<span class="builtintype" id="5458599">int</span><span class="op" id="5458602">,</span>&nbsp;<span class="ident" id="5458604">end</span>&nbsp;<span class="builtintype" id="5458608">bool</span><span class="op" id="5458612">,</span>&nbsp;<span class="ident" id="5458614">err</span>&nbsp;<span class="builtintype" id="5458618">error</span><span class="op" id="5458623">)</span>&nbsp;<span class="op" id="5458625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458628">olen</span>&nbsp;<span class="op" id="5458633">:=</span>&nbsp;<span class="builtinfunc" id="5458636">len</span><span class="op" id="5458639">(</span><span class="ident" id="5458640">src</span><span class="op" id="5458643">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458646">for</span>&nbsp;<span class="builtinfunc" id="5458650">len</span><span class="op" id="5458653">(</span><span class="ident" id="5458654">src</span><span class="op" id="5458657">)</span>&nbsp;<span class="op" id="5458659">&gt;</span>&nbsp;<span class="num" id="5458661">0</span>&nbsp;<span class="op" id="5458663">&amp;&amp;</span>&nbsp;<span class="op" id="5458666">!</span><span class="ident" id="5458667">end</span>&nbsp;<span class="op" id="5458671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5458675">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458721">var</span>&nbsp;<span class="ident" id="5458725">dbuf</span>&nbsp;<span class="op" id="5458730">[</span><span class="num" id="5458731">8</span><span class="op" id="5458732">]</span><span class="builtintype" id="5458733">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458740">dlen</span>&nbsp;<span class="op" id="5458745">:=</span>&nbsp;<span class="num" id="5458748">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458753">for</span>&nbsp;<span class="ident" id="5458757">j</span>&nbsp;<span class="op" id="5458759">:=</span>&nbsp;<span class="num" id="5458762">0</span><span class="op" id="5458763">;</span>&nbsp;<span class="ident" id="5458765">j</span>&nbsp;<span class="op" id="5458767">&lt;</span>&nbsp;<span class="num" id="5458769">8</span><span class="op" id="5458770">;</span>&nbsp;<span class="op" id="5458772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458777">if</span>&nbsp;<span class="builtinfunc" id="5458780">len</span><span class="op" id="5458783">(</span><span class="ident" id="5458784">src</span><span class="op" id="5458787">)</span>&nbsp;<span class="op" id="5458789">==</span>&nbsp;<span class="num" id="5458792">0</span>&nbsp;<span class="op" id="5458794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458800">return</span>&nbsp;<span class="ident" id="5458807">n</span><span class="op" id="5458808">,</span>&nbsp;<span class="builtintype" id="5458810">false</span><span class="op" id="5458815">,</span>&nbsp;<span class="ident" id="5458817">CorruptInputError</span><span class="op" id="5458834">(</span><span class="ident" id="5458835">olen</span>&nbsp;<span class="op" id="5458840">-</span>&nbsp;<span class="builtinfunc" id="5458842">len</span><span class="op" id="5458845">(</span><span class="ident" id="5458846">src</span><span class="op" id="5458849">)</span>&nbsp;<span class="op" id="5458851">-</span>&nbsp;<span class="ident" id="5458853">j</span><span class="op" id="5458854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5458859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458864">in</span>&nbsp;<span class="op" id="5458867">:=</span>&nbsp;<span class="ident" id="5458870">src</span><span class="op" id="5458873">[</span><span class="num" id="5458874">0</span><span class="op" id="5458875">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5458880">src</span>&nbsp;<span class="op" id="5458884">=</span>&nbsp;<span class="ident" id="5458886">src</span><span class="op" id="5458889">[</span><span class="num" id="5458890">1</span><span class="op" id="5458891">:</span><span class="op" id="5458892">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458897">if</span>&nbsp;<span class="ident" id="5458900">in</span>&nbsp;<span class="op" id="5458903">==</span>&nbsp;<span class="string" id="5458906">&#39;=&#39;</span>&nbsp;<span class="op" id="5458910">&amp;&amp;</span>&nbsp;<span class="ident" id="5458913">j</span>&nbsp;<span class="op" id="5458915">&gt;=</span>&nbsp;<span class="num" id="5458918">2</span>&nbsp;<span class="op" id="5458920">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5458923">len</span><span class="op" id="5458926">(</span><span class="ident" id="5458927">src</span><span class="op" id="5458930">)</span>&nbsp;<span class="op" id="5458932">&lt;</span>&nbsp;<span class="num" id="5458934">8</span>&nbsp;<span class="op" id="5458936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5458942">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5458991">if</span>&nbsp;<span class="builtinfunc" id="5458994">len</span><span class="op" id="5458997">(</span><span class="ident" id="5458998">src</span><span class="op" id="5459001">)</span><span class="op" id="5459002">+</span><span class="ident" id="5459003">j</span>&nbsp;<span class="op" id="5459005">&lt;</span>&nbsp;<span class="num" id="5459007">8</span><span class="op" id="5459008">-</span><span class="num" id="5459009">1</span>&nbsp;<span class="op" id="5459011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5459018">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459045">return</span>&nbsp;<span class="ident" id="5459052">n</span><span class="op" id="5459053">,</span>&nbsp;<span class="builtintype" id="5459055">false</span><span class="op" id="5459060">,</span>&nbsp;<span class="ident" id="5459062">CorruptInputError</span><span class="op" id="5459079">(</span><span class="ident" id="5459080">olen</span><span class="op" id="5459084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5459090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459096">for</span>&nbsp;<span class="ident" id="5459100">k</span>&nbsp;<span class="op" id="5459102">:=</span>&nbsp;<span class="num" id="5459105">0</span><span class="op" id="5459106">;</span>&nbsp;<span class="ident" id="5459108">k</span>&nbsp;<span class="op" id="5459110">&lt;</span>&nbsp;<span class="num" id="5459112">8</span><span class="op" id="5459113">-</span><span class="num" id="5459114">1</span><span class="op" id="5459115">-</span><span class="ident" id="5459116">j</span><span class="op" id="5459117">;</span>&nbsp;<span class="ident" id="5459119">k</span><span class="op" id="5459120">++</span>&nbsp;<span class="op" id="5459123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459130">if</span>&nbsp;<span class="builtinfunc" id="5459133">len</span><span class="op" id="5459136">(</span><span class="ident" id="5459137">src</span><span class="op" id="5459140">)</span>&nbsp;<span class="op" id="5459142">&gt;</span>&nbsp;<span class="ident" id="5459144">k</span>&nbsp;<span class="op" id="5459146">&amp;&amp;</span>&nbsp;<span class="ident" id="5459149">src</span><span class="op" id="5459152">[</span><span class="ident" id="5459153">k</span><span class="op" id="5459154">]</span>&nbsp;<span class="op" id="5459156">!=</span>&nbsp;<span class="string" id="5459159">&#39;=&#39;</span>&nbsp;<span class="op" id="5459163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5459171">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459198">return</span>&nbsp;<span class="ident" id="5459205">n</span><span class="op" id="5459206">,</span>&nbsp;<span class="builtintype" id="5459208">false</span><span class="op" id="5459213">,</span>&nbsp;<span class="ident" id="5459215">CorruptInputError</span><span class="op" id="5459232">(</span><span class="ident" id="5459233">olen</span>&nbsp;<span class="op" id="5459238">-</span>&nbsp;<span class="builtinfunc" id="5459240">len</span><span class="op" id="5459243">(</span><span class="ident" id="5459244">src</span><span class="op" id="5459247">)</span>&nbsp;<span class="op" id="5459249">+</span>&nbsp;<span class="ident" id="5459251">k</span>&nbsp;<span class="op" id="5459253">-</span>&nbsp;<span class="num" id="5459255">1</span><span class="op" id="5459256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5459263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5459269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459275">dlen</span><span class="op" id="5459279">,</span>&nbsp;<span class="ident" id="5459281">end</span>&nbsp;<span class="op" id="5459285">=</span>&nbsp;<span class="ident" id="5459287">j</span><span class="op" id="5459288">,</span>&nbsp;<span class="builtintype" id="5459290">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5459299">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5459374">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5459450">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5459522">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5459595">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459666">if</span>&nbsp;<span class="ident" id="5459669">dlen</span>&nbsp;<span class="op" id="5459674">==</span>&nbsp;<span class="num" id="5459677">1</span>&nbsp;<span class="op" id="5459679">||</span>&nbsp;<span class="ident" id="5459682">dlen</span>&nbsp;<span class="op" id="5459687">==</span>&nbsp;<span class="num" id="5459690">3</span>&nbsp;<span class="op" id="5459692">||</span>&nbsp;<span class="ident" id="5459695">dlen</span>&nbsp;<span class="op" id="5459700">==</span>&nbsp;<span class="num" id="5459703">6</span>&nbsp;<span class="op" id="5459705">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459712">return</span>&nbsp;<span class="ident" id="5459719">n</span><span class="op" id="5459720">,</span>&nbsp;<span class="builtintype" id="5459722">false</span><span class="op" id="5459727">,</span>&nbsp;<span class="ident" id="5459729">CorruptInputError</span><span class="op" id="5459746">(</span><span class="ident" id="5459747">olen</span>&nbsp;<span class="op" id="5459752">-</span>&nbsp;<span class="builtinfunc" id="5459754">len</span><span class="op" id="5459757">(</span><span class="ident" id="5459758">src</span><span class="op" id="5459761">)</span>&nbsp;<span class="op" id="5459763">-</span>&nbsp;<span class="num" id="5459765">1</span><span class="op" id="5459766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5459772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459778">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5459787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459792">dbuf</span><span class="op" id="5459796">[</span><span class="ident" id="5459797">j</span><span class="op" id="5459798">]</span>&nbsp;<span class="op" id="5459800">=</span>&nbsp;<span class="ident" id="5459802">enc</span><span class="op" id="5459805">.</span><span class="ident" id="5459806">decodeMap</span><span class="op" id="5459815">[</span><span class="ident" id="5459816">in</span><span class="op" id="5459818">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459823">if</span>&nbsp;<span class="ident" id="5459826">dbuf</span><span class="op" id="5459830">[</span><span class="ident" id="5459831">j</span><span class="op" id="5459832">]</span>&nbsp;<span class="op" id="5459834">==</span>&nbsp;<span class="num" id="5459837">0xFF</span>&nbsp;<span class="op" id="5459842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459848">return</span>&nbsp;<span class="ident" id="5459855">n</span><span class="op" id="5459856">,</span>&nbsp;<span class="builtintype" id="5459858">false</span><span class="op" id="5459863">,</span>&nbsp;<span class="ident" id="5459865">CorruptInputError</span><span class="op" id="5459882">(</span><span class="ident" id="5459883">olen</span>&nbsp;<span class="op" id="5459888">-</span>&nbsp;<span class="builtinfunc" id="5459890">len</span><span class="op" id="5459893">(</span><span class="ident" id="5459894">src</span><span class="op" id="5459897">)</span>&nbsp;<span class="op" id="5459899">-</span>&nbsp;<span class="num" id="5459901">1</span><span class="op" id="5459902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5459907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5459912">j</span><span class="op" id="5459913">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5459918">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5459923">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5459980">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5459993">switch</span>&nbsp;<span class="ident" id="5460000">dlen</span>&nbsp;<span class="op" id="5460005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460009">case</span>&nbsp;<span class="num" id="5460014">8</span><span class="op" id="5460015">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460020">dst</span><span class="op" id="5460023">[</span><span class="num" id="5460024">4</span><span class="op" id="5460025">]</span>&nbsp;<span class="op" id="5460027">=</span>&nbsp;<span class="ident" id="5460029">dbuf</span><span class="op" id="5460033">[</span><span class="num" id="5460034">6</span><span class="op" id="5460035">]</span><span class="op" id="5460036">&lt;&lt;</span><span class="num" id="5460038">5</span>&nbsp;<span class="op" id="5460040">|</span>&nbsp;<span class="ident" id="5460042">dbuf</span><span class="op" id="5460046">[</span><span class="num" id="5460047">7</span><span class="op" id="5460048">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460053">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460067">case</span>&nbsp;<span class="num" id="5460072">7</span><span class="op" id="5460073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460078">dst</span><span class="op" id="5460081">[</span><span class="num" id="5460082">3</span><span class="op" id="5460083">]</span>&nbsp;<span class="op" id="5460085">=</span>&nbsp;<span class="ident" id="5460087">dbuf</span><span class="op" id="5460091">[</span><span class="num" id="5460092">4</span><span class="op" id="5460093">]</span><span class="op" id="5460094">&lt;&lt;</span><span class="num" id="5460096">7</span>&nbsp;<span class="op" id="5460098">|</span>&nbsp;<span class="ident" id="5460100">dbuf</span><span class="op" id="5460104">[</span><span class="num" id="5460105">5</span><span class="op" id="5460106">]</span><span class="op" id="5460107">&lt;&lt;</span><span class="num" id="5460109">2</span>&nbsp;<span class="op" id="5460111">|</span>&nbsp;<span class="ident" id="5460113">dbuf</span><span class="op" id="5460117">[</span><span class="num" id="5460118">6</span><span class="op" id="5460119">]</span><span class="op" id="5460120">&gt;&gt;</span><span class="num" id="5460122">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460127">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460141">case</span>&nbsp;<span class="num" id="5460146">5</span><span class="op" id="5460147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460152">dst</span><span class="op" id="5460155">[</span><span class="num" id="5460156">2</span><span class="op" id="5460157">]</span>&nbsp;<span class="op" id="5460159">=</span>&nbsp;<span class="ident" id="5460161">dbuf</span><span class="op" id="5460165">[</span><span class="num" id="5460166">3</span><span class="op" id="5460167">]</span><span class="op" id="5460168">&lt;&lt;</span><span class="num" id="5460170">4</span>&nbsp;<span class="op" id="5460172">|</span>&nbsp;<span class="ident" id="5460174">dbuf</span><span class="op" id="5460178">[</span><span class="num" id="5460179">4</span><span class="op" id="5460180">]</span><span class="op" id="5460181">&gt;&gt;</span><span class="num" id="5460183">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460188">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460202">case</span>&nbsp;<span class="num" id="5460207">4</span><span class="op" id="5460208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460213">dst</span><span class="op" id="5460216">[</span><span class="num" id="5460217">1</span><span class="op" id="5460218">]</span>&nbsp;<span class="op" id="5460220">=</span>&nbsp;<span class="ident" id="5460222">dbuf</span><span class="op" id="5460226">[</span><span class="num" id="5460227">1</span><span class="op" id="5460228">]</span><span class="op" id="5460229">&lt;&lt;</span><span class="num" id="5460231">6</span>&nbsp;<span class="op" id="5460233">|</span>&nbsp;<span class="ident" id="5460235">dbuf</span><span class="op" id="5460239">[</span><span class="num" id="5460240">2</span><span class="op" id="5460241">]</span><span class="op" id="5460242">&lt;&lt;</span><span class="num" id="5460244">1</span>&nbsp;<span class="op" id="5460246">|</span>&nbsp;<span class="ident" id="5460248">dbuf</span><span class="op" id="5460252">[</span><span class="num" id="5460253">3</span><span class="op" id="5460254">]</span><span class="op" id="5460255">&gt;&gt;</span><span class="num" id="5460257">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460262">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460276">case</span>&nbsp;<span class="num" id="5460281">2</span><span class="op" id="5460282">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460287">dst</span><span class="op" id="5460290">[</span><span class="num" id="5460291">0</span><span class="op" id="5460292">]</span>&nbsp;<span class="op" id="5460294">=</span>&nbsp;<span class="ident" id="5460296">dbuf</span><span class="op" id="5460300">[</span><span class="num" id="5460301">0</span><span class="op" id="5460302">]</span><span class="op" id="5460303">&lt;&lt;</span><span class="num" id="5460305">3</span>&nbsp;<span class="op" id="5460307">|</span>&nbsp;<span class="ident" id="5460309">dbuf</span><span class="op" id="5460313">[</span><span class="num" id="5460314">1</span><span class="op" id="5460315">]</span><span class="op" id="5460316">&gt;&gt;</span><span class="num" id="5460318">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5460322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460326">dst</span>&nbsp;<span class="op" id="5460330">=</span>&nbsp;<span class="ident" id="5460332">dst</span><span class="op" id="5460335">[</span><span class="num" id="5460336">5</span><span class="op" id="5460337">:</span><span class="op" id="5460338">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460342">switch</span>&nbsp;<span class="ident" id="5460349">dlen</span>&nbsp;<span class="op" id="5460354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460358">case</span>&nbsp;<span class="num" id="5460363">2</span><span class="op" id="5460364">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460369">n</span>&nbsp;<span class="op" id="5460371">+=</span>&nbsp;<span class="num" id="5460374">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460378">case</span>&nbsp;<span class="num" id="5460383">4</span><span class="op" id="5460384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460389">n</span>&nbsp;<span class="op" id="5460391">+=</span>&nbsp;<span class="num" id="5460394">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460398">case</span>&nbsp;<span class="num" id="5460403">5</span><span class="op" id="5460404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460409">n</span>&nbsp;<span class="op" id="5460411">+=</span>&nbsp;<span class="num" id="5460414">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460418">case</span>&nbsp;<span class="num" id="5460423">7</span><span class="op" id="5460424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460429">n</span>&nbsp;<span class="op" id="5460431">+=</span>&nbsp;<span class="num" id="5460434">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460438">case</span>&nbsp;<span class="num" id="5460443">8</span><span class="op" id="5460444">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460449">n</span>&nbsp;<span class="op" id="5460451">+=</span>&nbsp;<span class="num" id="5460454">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5460458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5460461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460464">return</span>&nbsp;<span class="ident" id="5460471">n</span><span class="op" id="5460472">,</span>&nbsp;<span class="ident" id="5460474">end</span><span class="op" id="5460477">,</span>&nbsp;<span class="ident" id="5460479">nil</span><br>
<span class="lineno"></span><span class="op" id="5460483">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="5460486">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="5460551">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="5460620">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5460689">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="5460752">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="5460800">func</span>&nbsp;<span class="op" id="5460805">(</span><span class="ident" id="5460806">enc</span>&nbsp;<span class="op" id="5460810">*</span><span class="ident" id="5460811">Encoding</span><span class="op" id="5460819">)</span>&nbsp;<span class="ident" id="5460821">Decode</span><span class="op" id="5460827">(</span><span class="ident" id="5460828">dst</span><span class="op" id="5460831">,</span>&nbsp;<span class="ident" id="5460833">src</span>&nbsp;<span class="op" id="5460837">[</span><span class="op" id="5460838">]</span><span class="builtintype" id="5460839">byte</span><span class="op" id="5460843">)</span>&nbsp;<span class="op" id="5460845">(</span><span class="ident" id="5460846">n</span>&nbsp;<span class="builtintype" id="5460848">int</span><span class="op" id="5460851">,</span>&nbsp;<span class="ident" id="5460853">err</span>&nbsp;<span class="builtintype" id="5460857">error</span><span class="op" id="5460862">)</span>&nbsp;<span class="op" id="5460864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460867">src</span>&nbsp;<span class="op" id="5460871">=</span>&nbsp;<span class="ident" id="5460873">bytes</span><span class="op" id="5460878">.</span><span class="ident" id="5460879">Map</span><span class="op" id="5460882">(</span><span class="ident" id="5460883">removeNewlinesMapper</span><span class="op" id="5460903">,</span>&nbsp;<span class="ident" id="5460905">src</span><span class="op" id="5460908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460911">n</span><span class="op" id="5460912">,</span>&nbsp;<span class="ident" id="5460914">_</span><span class="op" id="5460915">,</span>&nbsp;<span class="ident" id="5460917">err</span>&nbsp;<span class="op" id="5460921">=</span>&nbsp;<span class="ident" id="5460923">enc</span><span class="op" id="5460926">.</span><span class="ident" id="5460927">decode</span><span class="op" id="5460933">(</span><span class="ident" id="5460934">dst</span><span class="op" id="5460937">,</span>&nbsp;<span class="ident" id="5460939">src</span><span class="op" id="5460942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460945">return</span><br>
<span class="lineno">325</span><span class="op" id="5460952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5460955">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5461025">func</span>&nbsp;<span class="op" id="5461030">(</span><span class="ident" id="5461031">enc</span>&nbsp;<span class="op" id="5461035">*</span><span class="ident" id="5461036">Encoding</span><span class="op" id="5461044">)</span>&nbsp;<span class="ident" id="5461046">DecodeString</span><span class="op" id="5461058">(</span><span class="ident" id="5461059">s</span>&nbsp;<span class="builtintype" id="5461061">string</span><span class="op" id="5461067">)</span>&nbsp;<span class="op" id="5461069">(</span><span class="op" id="5461070">[</span><span class="op" id="5461071">]</span><span class="builtintype" id="5461072">byte</span><span class="op" id="5461076">,</span>&nbsp;<span class="builtintype" id="5461078">error</span><span class="op" id="5461083">)</span>&nbsp;<span class="op" id="5461085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461088">s</span>&nbsp;<span class="op" id="5461090">=</span>&nbsp;<span class="ident" id="5461092">strings</span><span class="op" id="5461099">.</span><span class="ident" id="5461100">Map</span><span class="op" id="5461103">(</span><span class="ident" id="5461104">removeNewlinesMapper</span><span class="op" id="5461124">,</span>&nbsp;<span class="ident" id="5461126">s</span><span class="op" id="5461127">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461130">dbuf</span>&nbsp;<span class="op" id="5461135">:=</span>&nbsp;<span class="builtinfunc" id="5461138">make</span><span class="op" id="5461142">(</span><span class="op" id="5461143">[</span><span class="op" id="5461144">]</span><span class="builtintype" id="5461145">byte</span><span class="op" id="5461149">,</span>&nbsp;<span class="ident" id="5461151">enc</span><span class="op" id="5461154">.</span><span class="ident" id="5461155">DecodedLen</span><span class="op" id="5461165">(</span><span class="builtinfunc" id="5461166">len</span><span class="op" id="5461169">(</span><span class="ident" id="5461170">s</span><span class="op" id="5461171">)</span><span class="op" id="5461172">)</span><span class="op" id="5461173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461176">n</span><span class="op" id="5461177">,</span>&nbsp;<span class="ident" id="5461179">_</span><span class="op" id="5461180">,</span>&nbsp;<span class="ident" id="5461182">err</span>&nbsp;<span class="op" id="5461186">:=</span>&nbsp;<span class="ident" id="5461189">enc</span><span class="op" id="5461192">.</span><span class="ident" id="5461193">decode</span><span class="op" id="5461199">(</span><span class="ident" id="5461200">dbuf</span><span class="op" id="5461204">,</span>&nbsp;<span class="op" id="5461206">[</span><span class="op" id="5461207">]</span><span class="builtintype" id="5461208">byte</span><span class="op" id="5461212">(</span><span class="ident" id="5461213">s</span><span class="op" id="5461214">)</span><span class="op" id="5461215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461218">return</span>&nbsp;<span class="ident" id="5461225">dbuf</span><span class="op" id="5461229">[</span><span class="op" id="5461230">:</span><span class="ident" id="5461231">n</span><span class="op" id="5461232">]</span><span class="op" id="5461233">,</span>&nbsp;<span class="ident" id="5461235">err</span><br>
<span class="lineno"></span><span class="op" id="5461239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5461242">type</span>&nbsp;<span class="ident" id="5461247">decoder</span>&nbsp;<span class="keyword" id="5461255">struct</span>&nbsp;<span class="op" id="5461262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461265">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5461272">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461279">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5461286">*</span><span class="ident" id="5461287">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461297">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5461304">io</span><span class="op" id="5461306">.</span><span class="ident" id="5461307">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461315">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5461322">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5461333">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461356">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5461363">[</span><span class="num" id="5461364">1024</span><span class="op" id="5461368">]</span><span class="builtintype" id="5461369">byte</span>&nbsp;<span class="comment" id="5461374">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461393">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5461400">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461405">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5461412">[</span><span class="op" id="5461413">]</span><span class="builtintype" id="5461414">byte</span>&nbsp;<span class="comment" id="5461419">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461447">outbuf</span>&nbsp;<span class="op" id="5461454">[</span><span class="num" id="5461455">1024</span>&nbsp;<span class="op" id="5461460">/</span>&nbsp;<span class="num" id="5461462">8</span>&nbsp;<span class="op" id="5461464">*</span>&nbsp;<span class="num" id="5461466">5</span><span class="op" id="5461467">]</span><span class="builtintype" id="5461468">byte</span><br>
<span class="lineno"></span><span class="op" id="5461473">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="5461476">func</span>&nbsp;<span class="op" id="5461481">(</span><span class="ident" id="5461482">d</span>&nbsp;<span class="op" id="5461484">*</span><span class="ident" id="5461485">decoder</span><span class="op" id="5461492">)</span>&nbsp;<span class="ident" id="5461494">Read</span><span class="op" id="5461498">(</span><span class="ident" id="5461499">p</span>&nbsp;<span class="op" id="5461501">[</span><span class="op" id="5461502">]</span><span class="builtintype" id="5461503">byte</span><span class="op" id="5461507">)</span>&nbsp;<span class="op" id="5461509">(</span><span class="ident" id="5461510">n</span>&nbsp;<span class="builtintype" id="5461512">int</span><span class="op" id="5461515">,</span>&nbsp;<span class="ident" id="5461517">err</span>&nbsp;<span class="builtintype" id="5461521">error</span><span class="op" id="5461526">)</span>&nbsp;<span class="op" id="5461528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461531">if</span>&nbsp;<span class="ident" id="5461534">d</span><span class="op" id="5461535">.</span><span class="ident" id="5461536">err</span>&nbsp;<span class="op" id="5461540">!=</span>&nbsp;<span class="ident" id="5461543">nil</span>&nbsp;<span class="op" id="5461547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461551">return</span>&nbsp;<span class="num" id="5461558">0</span><span class="op" id="5461559">,</span>&nbsp;<span class="ident" id="5461561">d</span><span class="op" id="5461562">.</span><span class="ident" id="5461563">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5461568">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5461572">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461620">if</span>&nbsp;<span class="builtinfunc" id="5461623">len</span><span class="op" id="5461626">(</span><span class="ident" id="5461627">d</span><span class="op" id="5461628">.</span><span class="ident" id="5461629">out</span><span class="op" id="5461632">)</span>&nbsp;<span class="op" id="5461634">&gt;</span>&nbsp;<span class="num" id="5461636">0</span>&nbsp;<span class="op" id="5461638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461642">n</span>&nbsp;<span class="op" id="5461644">=</span>&nbsp;<span class="builtinfunc" id="5461646">copy</span><span class="op" id="5461650">(</span><span class="ident" id="5461651">p</span><span class="op" id="5461652">,</span>&nbsp;<span class="ident" id="5461654">d</span><span class="op" id="5461655">.</span><span class="ident" id="5461656">out</span><span class="op" id="5461659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461663">d</span><span class="op" id="5461664">.</span><span class="ident" id="5461665">out</span>&nbsp;<span class="op" id="5461669">=</span>&nbsp;<span class="ident" id="5461671">d</span><span class="op" id="5461672">.</span><span class="ident" id="5461673">out</span><span class="op" id="5461676">[</span><span class="ident" id="5461677">n</span><span class="op" id="5461678">:</span><span class="op" id="5461679">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461683">return</span>&nbsp;<span class="ident" id="5461690">n</span><span class="op" id="5461691">,</span>&nbsp;<span class="ident" id="5461693">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5461698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5461702">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461720">nn</span>&nbsp;<span class="op" id="5461723">:=</span>&nbsp;<span class="builtinfunc" id="5461726">len</span><span class="op" id="5461729">(</span><span class="ident" id="5461730">p</span><span class="op" id="5461731">)</span>&nbsp;<span class="op" id="5461733">/</span>&nbsp;<span class="num" id="5461735">5</span>&nbsp;<span class="op" id="5461737">*</span>&nbsp;<span class="num" id="5461739">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461742">if</span>&nbsp;<span class="ident" id="5461745">nn</span>&nbsp;<span class="op" id="5461748">&lt;</span>&nbsp;<span class="num" id="5461750">8</span>&nbsp;<span class="op" id="5461752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461756">nn</span>&nbsp;<span class="op" id="5461759">=</span>&nbsp;<span class="num" id="5461761">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5461764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461767">if</span>&nbsp;<span class="ident" id="5461770">nn</span>&nbsp;<span class="op" id="5461773">&gt;</span>&nbsp;<span class="builtinfunc" id="5461775">len</span><span class="op" id="5461778">(</span><span class="ident" id="5461779">d</span><span class="op" id="5461780">.</span><span class="ident" id="5461781">buf</span><span class="op" id="5461784">)</span>&nbsp;<span class="op" id="5461786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461790">nn</span>&nbsp;<span class="op" id="5461793">=</span>&nbsp;<span class="builtinfunc" id="5461795">len</span><span class="op" id="5461798">(</span><span class="ident" id="5461799">d</span><span class="op" id="5461800">.</span><span class="ident" id="5461801">buf</span><span class="op" id="5461804">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5461807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461810">nn</span><span class="op" id="5461812">,</span>&nbsp;<span class="ident" id="5461814">d</span><span class="op" id="5461815">.</span><span class="ident" id="5461816">err</span>&nbsp;<span class="op" id="5461820">=</span>&nbsp;<span class="ident" id="5461822">io</span><span class="op" id="5461824">.</span><span class="ident" id="5461825">ReadAtLeast</span><span class="op" id="5461836">(</span><span class="ident" id="5461837">d</span><span class="op" id="5461838">.</span><span class="ident" id="5461839">r</span><span class="op" id="5461840">,</span>&nbsp;<span class="ident" id="5461842">d</span><span class="op" id="5461843">.</span><span class="ident" id="5461844">buf</span><span class="op" id="5461847">[</span><span class="ident" id="5461848">d</span><span class="op" id="5461849">.</span><span class="ident" id="5461850">nbuf</span><span class="op" id="5461854">:</span><span class="ident" id="5461855">nn</span><span class="op" id="5461857">]</span><span class="op" id="5461858">,</span>&nbsp;<span class="num" id="5461860">8</span><span class="op" id="5461861">-</span><span class="ident" id="5461862">d</span><span class="op" id="5461863">.</span><span class="ident" id="5461864">nbuf</span><span class="op" id="5461868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461871">d</span><span class="op" id="5461872">.</span><span class="ident" id="5461873">nbuf</span>&nbsp;<span class="op" id="5461878">+=</span>&nbsp;<span class="ident" id="5461881">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461885">if</span>&nbsp;<span class="ident" id="5461888">d</span><span class="op" id="5461889">.</span><span class="ident" id="5461890">nbuf</span>&nbsp;<span class="op" id="5461895">&lt;</span>&nbsp;<span class="num" id="5461897">8</span>&nbsp;<span class="op" id="5461899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461903">return</span>&nbsp;<span class="num" id="5461910">0</span><span class="op" id="5461911">,</span>&nbsp;<span class="ident" id="5461913">d</span><span class="op" id="5461914">.</span><span class="ident" id="5461915">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5461920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5461924">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461988">nr</span>&nbsp;<span class="op" id="5461991">:=</span>&nbsp;<span class="ident" id="5461994">d</span><span class="op" id="5461995">.</span><span class="ident" id="5461996">nbuf</span>&nbsp;<span class="op" id="5462001">/</span>&nbsp;<span class="num" id="5462003">8</span>&nbsp;<span class="op" id="5462005">*</span>&nbsp;<span class="num" id="5462007">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462010">nw</span>&nbsp;<span class="op" id="5462013">:=</span>&nbsp;<span class="ident" id="5462016">d</span><span class="op" id="5462017">.</span><span class="ident" id="5462018">nbuf</span>&nbsp;<span class="op" id="5462023">/</span>&nbsp;<span class="num" id="5462025">8</span>&nbsp;<span class="op" id="5462027">*</span>&nbsp;<span class="num" id="5462029">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462032">if</span>&nbsp;<span class="ident" id="5462035">nw</span>&nbsp;<span class="op" id="5462038">&gt;</span>&nbsp;<span class="builtinfunc" id="5462040">len</span><span class="op" id="5462043">(</span><span class="ident" id="5462044">p</span><span class="op" id="5462045">)</span>&nbsp;<span class="op" id="5462047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462051">nw</span><span class="op" id="5462053">,</span>&nbsp;<span class="ident" id="5462055">d</span><span class="op" id="5462056">.</span><span class="ident" id="5462057">end</span><span class="op" id="5462060">,</span>&nbsp;<span class="ident" id="5462062">d</span><span class="op" id="5462063">.</span><span class="ident" id="5462064">err</span>&nbsp;<span class="op" id="5462068">=</span>&nbsp;<span class="ident" id="5462070">d</span><span class="op" id="5462071">.</span><span class="ident" id="5462072">enc</span><span class="op" id="5462075">.</span><span class="ident" id="5462076">decode</span><span class="op" id="5462082">(</span><span class="ident" id="5462083">d</span><span class="op" id="5462084">.</span><span class="ident" id="5462085">outbuf</span><span class="op" id="5462091">[</span><span class="num" id="5462092">0</span><span class="op" id="5462093">:</span><span class="op" id="5462094">]</span><span class="op" id="5462095">,</span>&nbsp;<span class="ident" id="5462097">d</span><span class="op" id="5462098">.</span><span class="ident" id="5462099">buf</span><span class="op" id="5462102">[</span><span class="num" id="5462103">0</span><span class="op" id="5462104">:</span><span class="ident" id="5462105">nr</span><span class="op" id="5462107">]</span><span class="op" id="5462108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462112">d</span><span class="op" id="5462113">.</span><span class="ident" id="5462114">out</span>&nbsp;<span class="op" id="5462118">=</span>&nbsp;<span class="ident" id="5462120">d</span><span class="op" id="5462121">.</span><span class="ident" id="5462122">outbuf</span><span class="op" id="5462128">[</span><span class="num" id="5462129">0</span><span class="op" id="5462130">:</span><span class="ident" id="5462131">nw</span><span class="op" id="5462133">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462137">n</span>&nbsp;<span class="op" id="5462139">=</span>&nbsp;<span class="builtinfunc" id="5462141">copy</span><span class="op" id="5462145">(</span><span class="ident" id="5462146">p</span><span class="op" id="5462147">,</span>&nbsp;<span class="ident" id="5462149">d</span><span class="op" id="5462150">.</span><span class="ident" id="5462151">out</span><span class="op" id="5462154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462158">d</span><span class="op" id="5462159">.</span><span class="ident" id="5462160">out</span>&nbsp;<span class="op" id="5462164">=</span>&nbsp;<span class="ident" id="5462166">d</span><span class="op" id="5462167">.</span><span class="ident" id="5462168">out</span><span class="op" id="5462171">[</span><span class="ident" id="5462172">n</span><span class="op" id="5462173">:</span><span class="op" id="5462174">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462177">}</span>&nbsp;<span class="keyword" id="5462179">else</span>&nbsp;<span class="op" id="5462184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462188">n</span><span class="op" id="5462189">,</span>&nbsp;<span class="ident" id="5462191">d</span><span class="op" id="5462192">.</span><span class="ident" id="5462193">end</span><span class="op" id="5462196">,</span>&nbsp;<span class="ident" id="5462198">d</span><span class="op" id="5462199">.</span><span class="ident" id="5462200">err</span>&nbsp;<span class="op" id="5462204">=</span>&nbsp;<span class="ident" id="5462206">d</span><span class="op" id="5462207">.</span><span class="ident" id="5462208">enc</span><span class="op" id="5462211">.</span><span class="ident" id="5462212">decode</span><span class="op" id="5462218">(</span><span class="ident" id="5462219">p</span><span class="op" id="5462220">,</span>&nbsp;<span class="ident" id="5462222">d</span><span class="op" id="5462223">.</span><span class="ident" id="5462224">buf</span><span class="op" id="5462227">[</span><span class="num" id="5462228">0</span><span class="op" id="5462229">:</span><span class="ident" id="5462230">nr</span><span class="op" id="5462232">]</span><span class="op" id="5462233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462239">d</span><span class="op" id="5462240">.</span><span class="ident" id="5462241">nbuf</span>&nbsp;<span class="op" id="5462246">-=</span>&nbsp;<span class="ident" id="5462249">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462253">for</span>&nbsp;<span class="ident" id="5462257">i</span>&nbsp;<span class="op" id="5462259">:=</span>&nbsp;<span class="num" id="5462262">0</span><span class="op" id="5462263">;</span>&nbsp;<span class="ident" id="5462265">i</span>&nbsp;<span class="op" id="5462267">&lt;</span>&nbsp;<span class="ident" id="5462269">d</span><span class="op" id="5462270">.</span><span class="ident" id="5462271">nbuf</span><span class="op" id="5462275">;</span>&nbsp;<span class="ident" id="5462277">i</span><span class="op" id="5462278">++</span>&nbsp;<span class="op" id="5462281">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462285">d</span><span class="op" id="5462286">.</span><span class="ident" id="5462287">buf</span><span class="op" id="5462290">[</span><span class="ident" id="5462291">i</span><span class="op" id="5462292">]</span>&nbsp;<span class="op" id="5462294">=</span>&nbsp;<span class="ident" id="5462296">d</span><span class="op" id="5462297">.</span><span class="ident" id="5462298">buf</span><span class="op" id="5462301">[</span><span class="ident" id="5462302">i</span><span class="op" id="5462303">+</span><span class="ident" id="5462304">nr</span><span class="op" id="5462306">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462313">if</span>&nbsp;<span class="ident" id="5462316">d</span><span class="op" id="5462317">.</span><span class="ident" id="5462318">err</span>&nbsp;<span class="op" id="5462322">==</span>&nbsp;<span class="ident" id="5462325">nil</span>&nbsp;<span class="op" id="5462329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462333">d</span><span class="op" id="5462334">.</span><span class="ident" id="5462335">err</span>&nbsp;<span class="op" id="5462339">=</span>&nbsp;<span class="ident" id="5462341">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462349">return</span>&nbsp;<span class="ident" id="5462356">n</span><span class="op" id="5462357">,</span>&nbsp;<span class="ident" id="5462359">d</span><span class="op" id="5462360">.</span><span class="ident" id="5462361">err</span><br>
<span class="lineno"></span><span class="op" id="5462365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5462368">type</span>&nbsp;<span class="ident" id="5462373">newlineFilteringReader</span>&nbsp;<span class="keyword" id="5462396">struct</span>&nbsp;<span class="op" id="5462403">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462406">wrapped</span>&nbsp;<span class="ident" id="5462414">io</span><span class="op" id="5462416">.</span><span class="ident" id="5462417">Reader</span><br>
<span class="lineno"></span><span class="op" id="5462424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5462427">func</span>&nbsp;<span class="op" id="5462432">(</span><span class="ident" id="5462433">r</span>&nbsp;<span class="op" id="5462435">*</span><span class="ident" id="5462436">newlineFilteringReader</span><span class="op" id="5462458">)</span>&nbsp;<span class="ident" id="5462460">Read</span><span class="op" id="5462464">(</span><span class="ident" id="5462465">p</span>&nbsp;<span class="op" id="5462467">[</span><span class="op" id="5462468">]</span><span class="builtintype" id="5462469">byte</span><span class="op" id="5462473">)</span>&nbsp;<span class="op" id="5462475">(</span><span class="builtintype" id="5462476">int</span><span class="op" id="5462479">,</span>&nbsp;<span class="builtintype" id="5462481">error</span><span class="op" id="5462486">)</span>&nbsp;<span class="op" id="5462488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462491">n</span><span class="op" id="5462492">,</span>&nbsp;<span class="ident" id="5462494">err</span>&nbsp;<span class="op" id="5462498">:=</span>&nbsp;<span class="ident" id="5462501">r</span><span class="op" id="5462502">.</span><span class="ident" id="5462503">wrapped</span><span class="op" id="5462510">.</span><span class="ident" id="5462511">Read</span><span class="op" id="5462515">(</span><span class="ident" id="5462516">p</span><span class="op" id="5462517">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462520">for</span>&nbsp;<span class="ident" id="5462524">n</span>&nbsp;<span class="op" id="5462526">&gt;</span>&nbsp;<span class="num" id="5462528">0</span>&nbsp;<span class="op" id="5462530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462534">offset</span>&nbsp;<span class="op" id="5462541">:=</span>&nbsp;<span class="num" id="5462544">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462548">for</span>&nbsp;<span class="ident" id="5462552">i</span><span class="op" id="5462553">,</span>&nbsp;<span class="ident" id="5462555">b</span>&nbsp;<span class="op" id="5462557">:=</span>&nbsp;<span class="keyword" id="5462560">range</span>&nbsp;<span class="ident" id="5462566">p</span><span class="op" id="5462567">[</span><span class="num" id="5462568">0</span><span class="op" id="5462569">:</span><span class="ident" id="5462570">n</span><span class="op" id="5462571">]</span>&nbsp;<span class="op" id="5462573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462578">if</span>&nbsp;<span class="ident" id="5462581">b</span>&nbsp;<span class="op" id="5462583">!=</span>&nbsp;<span class="string" id="5462586">&#39;\r&#39;</span>&nbsp;<span class="op" id="5462591">&amp;&amp;</span>&nbsp;<span class="ident" id="5462594">b</span>&nbsp;<span class="op" id="5462596">!=</span>&nbsp;<span class="string" id="5462599">&#39;\n&#39;</span>&nbsp;<span class="op" id="5462604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462610">if</span>&nbsp;<span class="ident" id="5462613">i</span>&nbsp;<span class="op" id="5462615">!=</span>&nbsp;<span class="ident" id="5462618">offset</span>&nbsp;<span class="op" id="5462625">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462632">p</span><span class="op" id="5462633">[</span><span class="ident" id="5462634">offset</span><span class="op" id="5462640">]</span>&nbsp;<span class="op" id="5462642">=</span>&nbsp;<span class="ident" id="5462644">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462656">offset</span><span class="op" id="5462662">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462672">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462676">if</span>&nbsp;<span class="ident" id="5462679">offset</span>&nbsp;<span class="op" id="5462686">&gt;</span>&nbsp;<span class="num" id="5462688">0</span>&nbsp;<span class="op" id="5462690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462695">return</span>&nbsp;<span class="ident" id="5462702">offset</span><span class="op" id="5462708">,</span>&nbsp;<span class="ident" id="5462710">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5462720">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462773">n</span><span class="op" id="5462774">,</span>&nbsp;<span class="ident" id="5462776">err</span>&nbsp;<span class="op" id="5462780">=</span>&nbsp;<span class="ident" id="5462782">r</span><span class="op" id="5462783">.</span><span class="ident" id="5462784">wrapped</span><span class="op" id="5462791">.</span><span class="ident" id="5462792">Read</span><span class="op" id="5462796">(</span><span class="ident" id="5462797">p</span><span class="op" id="5462798">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462804">return</span>&nbsp;<span class="ident" id="5462811">n</span><span class="op" id="5462812">,</span>&nbsp;<span class="ident" id="5462814">err</span><br>
<span class="lineno"></span><span class="op" id="5462818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5462821">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="5462875">func</span>&nbsp;<span class="ident" id="5462880">NewDecoder</span><span class="op" id="5462890">(</span><span class="ident" id="5462891">enc</span>&nbsp;<span class="op" id="5462895">*</span><span class="ident" id="5462896">Encoding</span><span class="op" id="5462904">,</span>&nbsp;<span class="ident" id="5462906">r</span>&nbsp;<span class="ident" id="5462908">io</span><span class="op" id="5462910">.</span><span class="ident" id="5462911">Reader</span><span class="op" id="5462917">)</span>&nbsp;<span class="ident" id="5462919">io</span><span class="op" id="5462921">.</span><span class="ident" id="5462922">Reader</span>&nbsp;<span class="op" id="5462929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462932">return</span>&nbsp;<span class="op" id="5462939">&amp;</span><span class="ident" id="5462940">decoder</span><span class="op" id="5462947">{</span><span class="ident" id="5462948">enc</span><span class="op" id="5462951">:</span>&nbsp;<span class="ident" id="5462953">enc</span><span class="op" id="5462956">,</span>&nbsp;<span class="ident" id="5462958">r</span><span class="op" id="5462959">:</span>&nbsp;<span class="op" id="5462961">&amp;</span><span class="ident" id="5462962">newlineFilteringReader</span><span class="op" id="5462984">{</span><span class="ident" id="5462985">r</span><span class="op" id="5462986">}</span><span class="op" id="5462987">}</span><br>
<span class="lineno"></span><span class="op" id="5462989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5462992">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="5463062">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5463114">func</span>&nbsp;<span class="op" id="5463119">(</span><span class="ident" id="5463120">enc</span>&nbsp;<span class="op" id="5463124">*</span><span class="ident" id="5463125">Encoding</span><span class="op" id="5463133">)</span>&nbsp;<span class="ident" id="5463135">DecodedLen</span><span class="op" id="5463145">(</span><span class="ident" id="5463146">n</span>&nbsp;<span class="builtintype" id="5463148">int</span><span class="op" id="5463151">)</span>&nbsp;<span class="builtintype" id="5463153">int</span>&nbsp;<span class="op" id="5463157">{</span>&nbsp;<span class="keyword" id="5463159">return</span>&nbsp;<span class="ident" id="5463166">n</span>&nbsp;<span class="op" id="5463168">/</span>&nbsp;<span class="num" id="5463170">8</span>&nbsp;<span class="op" id="5463172">*</span>&nbsp;<span class="num" id="5463174">5</span>&nbsp;<span class="op" id="5463176">}</span>
</div>
</body>
</html>
