<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/gzip</h2>
<ul>
<li><a href="/gostd/compress/gzip/gunzip.go.html">gunzip.go</a></li>
<li><a href="/gostd/compress/gzip/gunzip_test.go.html">gunzip_test.go</a></li>
<li><a href="/gostd/compress/gzip/gzip.go.html">gzip.go</a></li>
<li><a href="/gostd/compress/gzip/gzip_test.go.html">gzip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7330068">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7330123">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7330177">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7330228">package</span>&nbsp;<span class="ident" id="7330236">gzip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7330242">import</span>&nbsp;<span class="op" id="7330249">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7330252">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7330261">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7330270">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7330283">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7330294">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7330301">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="7330304">//&nbsp;TestEmpty&nbsp;tests&nbsp;that&nbsp;an&nbsp;empty&nbsp;payload&nbsp;still&nbsp;forms&nbsp;a&nbsp;valid&nbsp;GZIP&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="7330378">func</span>&nbsp;<span class="ident" id="7330383">TestEmpty</span><span class="op" id="7330392">(</span><span class="ident" id="7330393">t</span>&nbsp;<span class="op" id="7330395">*</span><span class="ident" id="7330396">testing</span><span class="op" id="7330403">.</span><span class="ident" id="7330404">T</span><span class="op" id="7330405">)</span>&nbsp;<span class="op" id="7330407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330410">buf</span>&nbsp;<span class="op" id="7330414">:=</span>&nbsp;<span class="builtinfunc" id="7330417">new</span><span class="op" id="7330420">(</span><span class="ident" id="7330421">bytes</span><span class="op" id="7330426">.</span><span class="ident" id="7330427">Buffer</span><span class="op" id="7330433">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330437">if</span>&nbsp;<span class="ident" id="7330440">err</span>&nbsp;<span class="op" id="7330444">:=</span>&nbsp;<span class="ident" id="7330447">NewWriter</span><span class="op" id="7330456">(</span><span class="ident" id="7330457">buf</span><span class="op" id="7330460">)</span><span class="op" id="7330461">.</span><span class="ident" id="7330462">Close</span><span class="op" id="7330467">(</span><span class="op" id="7330468">)</span><span class="op" id="7330469">;</span>&nbsp;<span class="ident" id="7330471">err</span>&nbsp;<span class="op" id="7330475">!=</span>&nbsp;<span class="ident" id="7330478">nil</span>&nbsp;<span class="op" id="7330482">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330486">t</span><span class="op" id="7330487">.</span><span class="ident" id="7330488">Fatalf</span><span class="op" id="7330494">(</span><span class="string" id="7330495">&#34;Writer.Close:&nbsp;%v&#34;</span><span class="op" id="7330513">,</span>&nbsp;<span class="ident" id="7330515">err</span><span class="op" id="7330518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330525">r</span><span class="op" id="7330526">,</span>&nbsp;<span class="ident" id="7330528">err</span>&nbsp;<span class="op" id="7330532">:=</span>&nbsp;<span class="ident" id="7330535">NewReader</span><span class="op" id="7330544">(</span><span class="ident" id="7330545">buf</span><span class="op" id="7330548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330551">if</span>&nbsp;<span class="ident" id="7330554">err</span>&nbsp;<span class="op" id="7330558">!=</span>&nbsp;<span class="ident" id="7330561">nil</span>&nbsp;<span class="op" id="7330565">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330569">t</span><span class="op" id="7330570">.</span><span class="ident" id="7330571">Fatalf</span><span class="op" id="7330577">(</span><span class="string" id="7330578">&#34;NewReader:&nbsp;%v&#34;</span><span class="op" id="7330593">,</span>&nbsp;<span class="ident" id="7330595">err</span><span class="op" id="7330598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330604">b</span><span class="op" id="7330605">,</span>&nbsp;<span class="ident" id="7330607">err</span>&nbsp;<span class="op" id="7330611">:=</span>&nbsp;<span class="ident" id="7330614">ioutil</span><span class="op" id="7330620">.</span><span class="ident" id="7330621">ReadAll</span><span class="op" id="7330628">(</span><span class="ident" id="7330629">r</span><span class="op" id="7330630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330633">if</span>&nbsp;<span class="ident" id="7330636">err</span>&nbsp;<span class="op" id="7330640">!=</span>&nbsp;<span class="ident" id="7330643">nil</span>&nbsp;<span class="op" id="7330647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330651">t</span><span class="op" id="7330652">.</span><span class="ident" id="7330653">Fatalf</span><span class="op" id="7330659">(</span><span class="string" id="7330660">&#34;ReadAll:&nbsp;%v&#34;</span><span class="op" id="7330673">,</span>&nbsp;<span class="ident" id="7330675">err</span><span class="op" id="7330678">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330684">if</span>&nbsp;<span class="builtinfunc" id="7330687">len</span><span class="op" id="7330690">(</span><span class="ident" id="7330691">b</span><span class="op" id="7330692">)</span>&nbsp;<span class="op" id="7330694">!=</span>&nbsp;<span class="num" id="7330697">0</span>&nbsp;<span class="op" id="7330699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330703">t</span><span class="op" id="7330704">.</span><span class="ident" id="7330705">Fatalf</span><span class="op" id="7330711">(</span><span class="string" id="7330712">&#34;got&nbsp;%d&nbsp;bytes,&nbsp;want&nbsp;0&#34;</span><span class="op" id="7330734">,</span>&nbsp;<span class="builtinfunc" id="7330736">len</span><span class="op" id="7330739">(</span><span class="ident" id="7330740">b</span><span class="op" id="7330741">)</span><span class="op" id="7330742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330748">if</span>&nbsp;<span class="ident" id="7330751">err</span>&nbsp;<span class="op" id="7330755">:=</span>&nbsp;<span class="ident" id="7330758">r</span><span class="op" id="7330759">.</span><span class="ident" id="7330760">Close</span><span class="op" id="7330765">(</span><span class="op" id="7330766">)</span><span class="op" id="7330767">;</span>&nbsp;<span class="ident" id="7330769">err</span>&nbsp;<span class="op" id="7330773">!=</span>&nbsp;<span class="ident" id="7330776">nil</span>&nbsp;<span class="op" id="7330780">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330784">t</span><span class="op" id="7330785">.</span><span class="ident" id="7330786">Fatalf</span><span class="op" id="7330792">(</span><span class="string" id="7330793">&#34;Reader.Close:&nbsp;%v&#34;</span><span class="op" id="7330811">,</span>&nbsp;<span class="ident" id="7330813">err</span><span class="op" id="7330816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330819">}</span><br>
<span class="lineno"></span><span class="op" id="7330821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7330824">//&nbsp;TestRoundTrip&nbsp;tests&nbsp;that&nbsp;gzipping&nbsp;and&nbsp;then&nbsp;gunzipping&nbsp;is&nbsp;the&nbsp;identity</span><br>
<span class="lineno">40</span><span class="comment" id="7330897">//&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="7330910">func</span>&nbsp;<span class="ident" id="7330915">TestRoundTrip</span><span class="op" id="7330928">(</span><span class="ident" id="7330929">t</span>&nbsp;<span class="op" id="7330931">*</span><span class="ident" id="7330932">testing</span><span class="op" id="7330939">.</span><span class="ident" id="7330940">T</span><span class="op" id="7330941">)</span>&nbsp;<span class="op" id="7330943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330946">buf</span>&nbsp;<span class="op" id="7330950">:=</span>&nbsp;<span class="builtinfunc" id="7330953">new</span><span class="op" id="7330956">(</span><span class="ident" id="7330957">bytes</span><span class="op" id="7330962">.</span><span class="ident" id="7330963">Buffer</span><span class="op" id="7330969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330973">w</span>&nbsp;<span class="op" id="7330975">:=</span>&nbsp;<span class="ident" id="7330978">NewWriter</span><span class="op" id="7330987">(</span><span class="ident" id="7330988">buf</span><span class="op" id="7330991">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330994">w</span><span class="op" id="7330995">.</span><span class="ident" id="7330996">Comment</span>&nbsp;<span class="op" id="7331004">=</span>&nbsp;<span class="string" id="7331006">&#34;comment&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331017">w</span><span class="op" id="7331018">.</span><span class="ident" id="7331019">Extra</span>&nbsp;<span class="op" id="7331025">=</span>&nbsp;<span class="op" id="7331027">[</span><span class="op" id="7331028">]</span><span class="builtintype" id="7331029">byte</span><span class="op" id="7331033">(</span><span class="string" id="7331034">&#34;extra&#34;</span><span class="op" id="7331041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331044">w</span><span class="op" id="7331045">.</span><span class="ident" id="7331046">ModTime</span>&nbsp;<span class="op" id="7331054">=</span>&nbsp;<span class="ident" id="7331056">time</span><span class="op" id="7331060">.</span><span class="ident" id="7331061">Unix</span><span class="op" id="7331065">(</span><span class="num" id="7331066">1e8</span><span class="op" id="7331069">,</span>&nbsp;<span class="num" id="7331071">0</span><span class="op" id="7331072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331075">w</span><span class="op" id="7331076">.</span><span class="ident" id="7331077">Name</span>&nbsp;<span class="op" id="7331082">=</span>&nbsp;<span class="string" id="7331084">&#34;name&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331092">if</span>&nbsp;<span class="ident" id="7331095">_</span><span class="op" id="7331096">,</span>&nbsp;<span class="ident" id="7331098">err</span>&nbsp;<span class="op" id="7331102">:=</span>&nbsp;<span class="ident" id="7331105">w</span><span class="op" id="7331106">.</span><span class="ident" id="7331107">Write</span><span class="op" id="7331112">(</span><span class="op" id="7331113">[</span><span class="op" id="7331114">]</span><span class="builtintype" id="7331115">byte</span><span class="op" id="7331119">(</span><span class="string" id="7331120">&#34;payload&#34;</span><span class="op" id="7331129">)</span><span class="op" id="7331130">)</span><span class="op" id="7331131">;</span>&nbsp;<span class="ident" id="7331133">err</span>&nbsp;<span class="op" id="7331137">!=</span>&nbsp;<span class="ident" id="7331140">nil</span>&nbsp;<span class="op" id="7331144">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331148">t</span><span class="op" id="7331149">.</span><span class="ident" id="7331150">Fatalf</span><span class="op" id="7331156">(</span><span class="string" id="7331157">&#34;Write:&nbsp;%v&#34;</span><span class="op" id="7331168">,</span>&nbsp;<span class="ident" id="7331170">err</span><span class="op" id="7331173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331179">if</span>&nbsp;<span class="ident" id="7331182">err</span>&nbsp;<span class="op" id="7331186">:=</span>&nbsp;<span class="ident" id="7331189">w</span><span class="op" id="7331190">.</span><span class="ident" id="7331191">Close</span><span class="op" id="7331196">(</span><span class="op" id="7331197">)</span><span class="op" id="7331198">;</span>&nbsp;<span class="ident" id="7331200">err</span>&nbsp;<span class="op" id="7331204">!=</span>&nbsp;<span class="ident" id="7331207">nil</span>&nbsp;<span class="op" id="7331211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331215">t</span><span class="op" id="7331216">.</span><span class="ident" id="7331217">Fatalf</span><span class="op" id="7331223">(</span><span class="string" id="7331224">&#34;Writer.Close:&nbsp;%v&#34;</span><span class="op" id="7331242">,</span>&nbsp;<span class="ident" id="7331244">err</span><span class="op" id="7331247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331250">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331254">r</span><span class="op" id="7331255">,</span>&nbsp;<span class="ident" id="7331257">err</span>&nbsp;<span class="op" id="7331261">:=</span>&nbsp;<span class="ident" id="7331264">NewReader</span><span class="op" id="7331273">(</span><span class="ident" id="7331274">buf</span><span class="op" id="7331277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331280">if</span>&nbsp;<span class="ident" id="7331283">err</span>&nbsp;<span class="op" id="7331287">!=</span>&nbsp;<span class="ident" id="7331290">nil</span>&nbsp;<span class="op" id="7331294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331298">t</span><span class="op" id="7331299">.</span><span class="ident" id="7331300">Fatalf</span><span class="op" id="7331306">(</span><span class="string" id="7331307">&#34;NewReader:&nbsp;%v&#34;</span><span class="op" id="7331322">,</span>&nbsp;<span class="ident" id="7331324">err</span><span class="op" id="7331327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331330">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331333">b</span><span class="op" id="7331334">,</span>&nbsp;<span class="ident" id="7331336">err</span>&nbsp;<span class="op" id="7331340">:=</span>&nbsp;<span class="ident" id="7331343">ioutil</span><span class="op" id="7331349">.</span><span class="ident" id="7331350">ReadAll</span><span class="op" id="7331357">(</span><span class="ident" id="7331358">r</span><span class="op" id="7331359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331362">if</span>&nbsp;<span class="ident" id="7331365">err</span>&nbsp;<span class="op" id="7331369">!=</span>&nbsp;<span class="ident" id="7331372">nil</span>&nbsp;<span class="op" id="7331376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331380">t</span><span class="op" id="7331381">.</span><span class="ident" id="7331382">Fatalf</span><span class="op" id="7331388">(</span><span class="string" id="7331389">&#34;ReadAll:&nbsp;%v&#34;</span><span class="op" id="7331402">,</span>&nbsp;<span class="ident" id="7331404">err</span><span class="op" id="7331407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331413">if</span>&nbsp;<span class="builtintype" id="7331416">string</span><span class="op" id="7331422">(</span><span class="ident" id="7331423">b</span><span class="op" id="7331424">)</span>&nbsp;<span class="op" id="7331426">!=</span>&nbsp;<span class="string" id="7331429">&#34;payload&#34;</span>&nbsp;<span class="op" id="7331439">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331443">t</span><span class="op" id="7331444">.</span><span class="ident" id="7331445">Fatalf</span><span class="op" id="7331451">(</span><span class="string" id="7331452">&#34;payload&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7331476">,</span>&nbsp;<span class="builtintype" id="7331478">string</span><span class="op" id="7331484">(</span><span class="ident" id="7331485">b</span><span class="op" id="7331486">)</span><span class="op" id="7331487">,</span>&nbsp;<span class="string" id="7331489">&#34;payload&#34;</span><span class="op" id="7331498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331504">if</span>&nbsp;<span class="ident" id="7331507">r</span><span class="op" id="7331508">.</span><span class="ident" id="7331509">Comment</span>&nbsp;<span class="op" id="7331517">!=</span>&nbsp;<span class="string" id="7331520">&#34;comment&#34;</span>&nbsp;<span class="op" id="7331530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331534">t</span><span class="op" id="7331535">.</span><span class="ident" id="7331536">Fatalf</span><span class="op" id="7331542">(</span><span class="string" id="7331543">&#34;comment&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7331567">,</span>&nbsp;<span class="ident" id="7331569">r</span><span class="op" id="7331570">.</span><span class="ident" id="7331571">Comment</span><span class="op" id="7331578">,</span>&nbsp;<span class="string" id="7331580">&#34;comment&#34;</span><span class="op" id="7331589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331592">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331595">if</span>&nbsp;<span class="builtintype" id="7331598">string</span><span class="op" id="7331604">(</span><span class="ident" id="7331605">r</span><span class="op" id="7331606">.</span><span class="ident" id="7331607">Extra</span><span class="op" id="7331612">)</span>&nbsp;<span class="op" id="7331614">!=</span>&nbsp;<span class="string" id="7331617">&#34;extra&#34;</span>&nbsp;<span class="op" id="7331625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331629">t</span><span class="op" id="7331630">.</span><span class="ident" id="7331631">Fatalf</span><span class="op" id="7331637">(</span><span class="string" id="7331638">&#34;extra&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7331660">,</span>&nbsp;<span class="ident" id="7331662">r</span><span class="op" id="7331663">.</span><span class="ident" id="7331664">Extra</span><span class="op" id="7331669">,</span>&nbsp;<span class="string" id="7331671">&#34;extra&#34;</span><span class="op" id="7331678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331684">if</span>&nbsp;<span class="ident" id="7331687">r</span><span class="op" id="7331688">.</span><span class="ident" id="7331689">ModTime</span><span class="op" id="7331696">.</span><span class="ident" id="7331697">Unix</span><span class="op" id="7331701">(</span><span class="op" id="7331702">)</span>&nbsp;<span class="op" id="7331704">!=</span>&nbsp;<span class="num" id="7331707">1e8</span>&nbsp;<span class="op" id="7331711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331715">t</span><span class="op" id="7331716">.</span><span class="ident" id="7331717">Fatalf</span><span class="op" id="7331723">(</span><span class="string" id="7331724">&#34;mtime&nbsp;is&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7331746">,</span>&nbsp;<span class="ident" id="7331748">r</span><span class="op" id="7331749">.</span><span class="ident" id="7331750">ModTime</span><span class="op" id="7331757">.</span><span class="ident" id="7331758">Unix</span><span class="op" id="7331762">(</span><span class="op" id="7331763">)</span><span class="op" id="7331764">,</span>&nbsp;<span class="builtintype" id="7331766">uint32</span><span class="op" id="7331772">(</span><span class="num" id="7331773">1e8</span><span class="op" id="7331776">)</span><span class="op" id="7331777">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331783">if</span>&nbsp;<span class="ident" id="7331786">r</span><span class="op" id="7331787">.</span><span class="ident" id="7331788">Name</span>&nbsp;<span class="op" id="7331793">!=</span>&nbsp;<span class="string" id="7331796">&#34;name&#34;</span>&nbsp;<span class="op" id="7331803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331807">t</span><span class="op" id="7331808">.</span><span class="ident" id="7331809">Fatalf</span><span class="op" id="7331815">(</span><span class="string" id="7331816">&#34;name&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7331837">,</span>&nbsp;<span class="ident" id="7331839">r</span><span class="op" id="7331840">.</span><span class="ident" id="7331841">Name</span><span class="op" id="7331845">,</span>&nbsp;<span class="string" id="7331847">&#34;name&#34;</span><span class="op" id="7331853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331859">if</span>&nbsp;<span class="ident" id="7331862">err</span>&nbsp;<span class="op" id="7331866">:=</span>&nbsp;<span class="ident" id="7331869">r</span><span class="op" id="7331870">.</span><span class="ident" id="7331871">Close</span><span class="op" id="7331876">(</span><span class="op" id="7331877">)</span><span class="op" id="7331878">;</span>&nbsp;<span class="ident" id="7331880">err</span>&nbsp;<span class="op" id="7331884">!=</span>&nbsp;<span class="ident" id="7331887">nil</span>&nbsp;<span class="op" id="7331891">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331895">t</span><span class="op" id="7331896">.</span><span class="ident" id="7331897">Fatalf</span><span class="op" id="7331903">(</span><span class="string" id="7331904">&#34;Reader.Close:&nbsp;%v&#34;</span><span class="op" id="7331922">,</span>&nbsp;<span class="ident" id="7331924">err</span><span class="op" id="7331927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331930">}</span><br>
<span class="lineno"></span><span class="op" id="7331932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7331935">//&nbsp;TestLatin1&nbsp;tests&nbsp;the&nbsp;internal&nbsp;functions&nbsp;for&nbsp;converting&nbsp;to&nbsp;and&nbsp;from&nbsp;Latin-1.</span><br>
<span class="lineno">85</span><span class="keyword" id="7332014">func</span>&nbsp;<span class="ident" id="7332019">TestLatin1</span><span class="op" id="7332029">(</span><span class="ident" id="7332030">t</span>&nbsp;<span class="op" id="7332032">*</span><span class="ident" id="7332033">testing</span><span class="op" id="7332040">.</span><span class="ident" id="7332041">T</span><span class="op" id="7332042">)</span>&nbsp;<span class="op" id="7332044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332047">latin1</span>&nbsp;<span class="op" id="7332054">:=</span>&nbsp;<span class="op" id="7332057">[</span><span class="op" id="7332058">]</span><span class="builtintype" id="7332059">byte</span><span class="op" id="7332063">{</span><span class="num" id="7332064">0xc4</span><span class="op" id="7332068">,</span>&nbsp;<span class="string" id="7332070">&#39;u&#39;</span><span class="op" id="7332073">,</span>&nbsp;<span class="num" id="7332075">0xdf</span><span class="op" id="7332079">,</span>&nbsp;<span class="string" id="7332081">&#39;e&#39;</span><span class="op" id="7332084">,</span>&nbsp;<span class="string" id="7332086">&#39;r&#39;</span><span class="op" id="7332089">,</span>&nbsp;<span class="string" id="7332091">&#39;u&#39;</span><span class="op" id="7332094">,</span>&nbsp;<span class="string" id="7332096">&#39;n&#39;</span><span class="op" id="7332099">,</span>&nbsp;<span class="string" id="7332101">&#39;g&#39;</span><span class="op" id="7332104">,</span>&nbsp;<span class="num" id="7332106">0</span><span class="op" id="7332107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332110">utf8</span>&nbsp;<span class="op" id="7332115">:=</span>&nbsp;<span class="string" id="7332118">&#34;Äußerung&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332132">z</span>&nbsp;<span class="op" id="7332134">:=</span>&nbsp;<span class="ident" id="7332137">Reader</span><span class="op" id="7332143">{</span><span class="ident" id="7332144">r</span><span class="op" id="7332145">:</span>&nbsp;<span class="ident" id="7332147">bufio</span><span class="op" id="7332152">.</span><span class="ident" id="7332153">NewReader</span><span class="op" id="7332162">(</span><span class="ident" id="7332163">bytes</span><span class="op" id="7332168">.</span><span class="ident" id="7332169">NewReader</span><span class="op" id="7332178">(</span><span class="ident" id="7332179">latin1</span><span class="op" id="7332185">)</span><span class="op" id="7332186">)</span><span class="op" id="7332187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332190">s</span><span class="op" id="7332191">,</span>&nbsp;<span class="ident" id="7332193">err</span>&nbsp;<span class="op" id="7332197">:=</span>&nbsp;<span class="ident" id="7332200">z</span><span class="op" id="7332201">.</span><span class="ident" id="7332202">readString</span><span class="op" id="7332212">(</span><span class="op" id="7332213">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332216">if</span>&nbsp;<span class="ident" id="7332219">err</span>&nbsp;<span class="op" id="7332223">!=</span>&nbsp;<span class="ident" id="7332226">nil</span>&nbsp;<span class="op" id="7332230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332234">t</span><span class="op" id="7332235">.</span><span class="ident" id="7332236">Fatalf</span><span class="op" id="7332242">(</span><span class="string" id="7332243">&#34;readString:&nbsp;%v&#34;</span><span class="op" id="7332259">,</span>&nbsp;<span class="ident" id="7332261">err</span><span class="op" id="7332264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332270">if</span>&nbsp;<span class="ident" id="7332273">s</span>&nbsp;<span class="op" id="7332275">!=</span>&nbsp;<span class="ident" id="7332278">utf8</span>&nbsp;<span class="op" id="7332283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332287">t</span><span class="op" id="7332288">.</span><span class="ident" id="7332289">Fatalf</span><span class="op" id="7332295">(</span><span class="string" id="7332296">&#34;read&nbsp;latin-1:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7332327">,</span>&nbsp;<span class="ident" id="7332329">s</span><span class="op" id="7332330">,</span>&nbsp;<span class="ident" id="7332332">utf8</span><span class="op" id="7332336">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332343">buf</span>&nbsp;<span class="op" id="7332347">:=</span>&nbsp;<span class="ident" id="7332350">bytes</span><span class="op" id="7332355">.</span><span class="ident" id="7332356">NewBuffer</span><span class="op" id="7332365">(</span><span class="builtinfunc" id="7332366">make</span><span class="op" id="7332370">(</span><span class="op" id="7332371">[</span><span class="op" id="7332372">]</span><span class="builtintype" id="7332373">byte</span><span class="op" id="7332377">,</span>&nbsp;<span class="num" id="7332379">0</span><span class="op" id="7332380">,</span>&nbsp;<span class="builtinfunc" id="7332382">len</span><span class="op" id="7332385">(</span><span class="ident" id="7332386">latin1</span><span class="op" id="7332392">)</span><span class="op" id="7332393">)</span><span class="op" id="7332394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332397">c</span>&nbsp;<span class="op" id="7332399">:=</span>&nbsp;<span class="ident" id="7332402">Writer</span><span class="op" id="7332408">{</span><span class="ident" id="7332409">w</span><span class="op" id="7332410">:</span>&nbsp;<span class="ident" id="7332412">buf</span><span class="op" id="7332415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332418">if</span>&nbsp;<span class="ident" id="7332421">err</span>&nbsp;<span class="op" id="7332425">=</span>&nbsp;<span class="ident" id="7332427">c</span><span class="op" id="7332428">.</span><span class="ident" id="7332429">writeString</span><span class="op" id="7332440">(</span><span class="ident" id="7332441">utf8</span><span class="op" id="7332445">)</span><span class="op" id="7332446">;</span>&nbsp;<span class="ident" id="7332448">err</span>&nbsp;<span class="op" id="7332452">!=</span>&nbsp;<span class="ident" id="7332455">nil</span>&nbsp;<span class="op" id="7332459">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332463">t</span><span class="op" id="7332464">.</span><span class="ident" id="7332465">Fatalf</span><span class="op" id="7332471">(</span><span class="string" id="7332472">&#34;writeString:&nbsp;%v&#34;</span><span class="op" id="7332489">,</span>&nbsp;<span class="ident" id="7332491">err</span><span class="op" id="7332494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332500">s</span>&nbsp;<span class="op" id="7332502">=</span>&nbsp;<span class="ident" id="7332504">buf</span><span class="op" id="7332507">.</span><span class="ident" id="7332508">String</span><span class="op" id="7332514">(</span><span class="op" id="7332515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332518">if</span>&nbsp;<span class="ident" id="7332521">s</span>&nbsp;<span class="op" id="7332523">!=</span>&nbsp;<span class="builtintype" id="7332526">string</span><span class="op" id="7332532">(</span><span class="ident" id="7332533">latin1</span><span class="op" id="7332539">)</span>&nbsp;<span class="op" id="7332541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332545">t</span><span class="op" id="7332546">.</span><span class="ident" id="7332547">Fatalf</span><span class="op" id="7332553">(</span><span class="string" id="7332554">&#34;write&nbsp;utf-8:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7332584">,</span>&nbsp;<span class="ident" id="7332586">s</span><span class="op" id="7332587">,</span>&nbsp;<span class="builtintype" id="7332589">string</span><span class="op" id="7332595">(</span><span class="ident" id="7332596">latin1</span><span class="op" id="7332602">)</span><span class="op" id="7332603">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332606">}</span><br>
<span class="lineno"></span><span class="op" id="7332608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7332611">//&nbsp;TestLatin1RoundTrip&nbsp;tests&nbsp;that&nbsp;metadata&nbsp;that&nbsp;is&nbsp;representable&nbsp;in&nbsp;Latin-1</span><br>
<span class="lineno"></span><span class="comment" id="7332687">//&nbsp;survives&nbsp;a&nbsp;round&nbsp;trip.</span><br>
<span class="lineno">110</span><span class="keyword" id="7332713">func</span>&nbsp;<span class="ident" id="7332718">TestLatin1RoundTrip</span><span class="op" id="7332737">(</span><span class="ident" id="7332738">t</span>&nbsp;<span class="op" id="7332740">*</span><span class="ident" id="7332741">testing</span><span class="op" id="7332748">.</span><span class="ident" id="7332749">T</span><span class="op" id="7332750">)</span>&nbsp;<span class="op" id="7332752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332755">testCases</span>&nbsp;<span class="op" id="7332765">:=</span>&nbsp;<span class="op" id="7332768">[</span><span class="op" id="7332769">]</span><span class="keyword" id="7332770">struct</span>&nbsp;<span class="op" id="7332777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332781">name</span>&nbsp;<span class="builtintype" id="7332786">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332795">ok</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7332800">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332806">}</span><span class="op" id="7332807">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332811">{</span><span class="string" id="7332812">&#34;&#34;</span><span class="op" id="7332814">,</span>&nbsp;<span class="builtintype" id="7332816">true</span><span class="op" id="7332820">}</span><span class="op" id="7332821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332825">{</span><span class="string" id="7332826">&#34;ASCII&nbsp;is&nbsp;OK&#34;</span><span class="op" id="7332839">,</span>&nbsp;<span class="builtintype" id="7332841">true</span><span class="op" id="7332845">}</span><span class="op" id="7332846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332850">{</span><span class="string" id="7332851">&#34;unless&nbsp;it&nbsp;contains&nbsp;a&nbsp;NUL\x00&#34;</span><span class="op" id="7332881">,</span>&nbsp;<span class="builtintype" id="7332883">false</span><span class="op" id="7332888">}</span><span class="op" id="7332889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332893">{</span><span class="string" id="7332894">&#34;no&nbsp;matter&nbsp;where&nbsp;\x00&nbsp;occurs&#34;</span><span class="op" id="7332923">,</span>&nbsp;<span class="builtintype" id="7332925">false</span><span class="op" id="7332930">}</span><span class="op" id="7332931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332935">{</span><span class="string" id="7332936">&#34;\x00\x00\x00&#34;</span><span class="op" id="7332950">,</span>&nbsp;<span class="builtintype" id="7332952">false</span><span class="op" id="7332957">}</span><span class="op" id="7332958">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332962">{</span><span class="string" id="7332963">&#34;Látin-1&nbsp;also&nbsp;passes&nbsp;(U+00E1)&#34;</span><span class="op" id="7332994">,</span>&nbsp;<span class="builtintype" id="7332996">true</span><span class="op" id="7333000">}</span><span class="op" id="7333001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333005">{</span><span class="string" id="7333006">&#34;but&nbsp;LĀtin&nbsp;Extended-A&nbsp;(U+0100)&nbsp;does&nbsp;not&#34;</span><span class="op" id="7333047">,</span>&nbsp;<span class="builtintype" id="7333049">false</span><span class="op" id="7333054">}</span><span class="op" id="7333055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333059">{</span><span class="string" id="7333060">&#34;neither&nbsp;does&nbsp;日本語&#34;</span><span class="op" id="7333084">,</span>&nbsp;<span class="builtintype" id="7333086">false</span><span class="op" id="7333091">}</span><span class="op" id="7333092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333096">{</span><span class="string" id="7333097">&#34;invalid&nbsp;UTF-8&nbsp;also&nbsp;\xffails&#34;</span><span class="op" id="7333126">,</span>&nbsp;<span class="builtintype" id="7333128">false</span><span class="op" id="7333133">}</span><span class="op" id="7333134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333138">{</span><span class="string" id="7333139">&#34;\x00&nbsp;as&nbsp;does&nbsp;Látin-1&nbsp;with&nbsp;NUL&#34;</span><span class="op" id="7333171">,</span>&nbsp;<span class="builtintype" id="7333173">false</span><span class="op" id="7333178">}</span><span class="op" id="7333179">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333185">for</span>&nbsp;<span class="ident" id="7333189">_</span><span class="op" id="7333190">,</span>&nbsp;<span class="ident" id="7333192">tc</span>&nbsp;<span class="op" id="7333195">:=</span>&nbsp;<span class="keyword" id="7333198">range</span>&nbsp;<span class="ident" id="7333204">testCases</span>&nbsp;<span class="op" id="7333214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333218">buf</span>&nbsp;<span class="op" id="7333222">:=</span>&nbsp;<span class="builtinfunc" id="7333225">new</span><span class="op" id="7333228">(</span><span class="ident" id="7333229">bytes</span><span class="op" id="7333234">.</span><span class="ident" id="7333235">Buffer</span><span class="op" id="7333241">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333246">w</span>&nbsp;<span class="op" id="7333248">:=</span>&nbsp;<span class="ident" id="7333251">NewWriter</span><span class="op" id="7333260">(</span><span class="ident" id="7333261">buf</span><span class="op" id="7333264">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333268">w</span><span class="op" id="7333269">.</span><span class="ident" id="7333270">Name</span>&nbsp;<span class="op" id="7333275">=</span>&nbsp;<span class="ident" id="7333277">tc</span><span class="op" id="7333279">.</span><span class="ident" id="7333280">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333287">err</span>&nbsp;<span class="op" id="7333291">:=</span>&nbsp;<span class="ident" id="7333294">w</span><span class="op" id="7333295">.</span><span class="ident" id="7333296">Close</span><span class="op" id="7333301">(</span><span class="op" id="7333302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333306">if</span>&nbsp;<span class="op" id="7333309">(</span><span class="ident" id="7333310">err</span>&nbsp;<span class="op" id="7333314">==</span>&nbsp;<span class="ident" id="7333317">nil</span><span class="op" id="7333320">)</span>&nbsp;<span class="op" id="7333322">!=</span>&nbsp;<span class="ident" id="7333325">tc</span><span class="op" id="7333327">.</span><span class="ident" id="7333328">ok</span>&nbsp;<span class="op" id="7333331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333336">t</span><span class="op" id="7333337">.</span><span class="ident" id="7333338">Errorf</span><span class="op" id="7333344">(</span><span class="string" id="7333345">&#34;Writer.Close:&nbsp;name&nbsp;=&nbsp;%q,&nbsp;err&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7333380">,</span>&nbsp;<span class="ident" id="7333382">tc</span><span class="op" id="7333384">.</span><span class="ident" id="7333385">name</span><span class="op" id="7333389">,</span>&nbsp;<span class="ident" id="7333391">err</span><span class="op" id="7333394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333399">continue</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333414">if</span>&nbsp;<span class="op" id="7333417">!</span><span class="ident" id="7333418">tc</span><span class="op" id="7333420">.</span><span class="ident" id="7333421">ok</span>&nbsp;<span class="op" id="7333424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333429">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333445">r</span><span class="op" id="7333446">,</span>&nbsp;<span class="ident" id="7333448">err</span>&nbsp;<span class="op" id="7333452">:=</span>&nbsp;<span class="ident" id="7333455">NewReader</span><span class="op" id="7333464">(</span><span class="ident" id="7333465">buf</span><span class="op" id="7333468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333472">if</span>&nbsp;<span class="ident" id="7333475">err</span>&nbsp;<span class="op" id="7333479">!=</span>&nbsp;<span class="ident" id="7333482">nil</span>&nbsp;<span class="op" id="7333486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333491">t</span><span class="op" id="7333492">.</span><span class="ident" id="7333493">Errorf</span><span class="op" id="7333499">(</span><span class="string" id="7333500">&#34;NewReader:&nbsp;%v&#34;</span><span class="op" id="7333515">,</span>&nbsp;<span class="ident" id="7333517">err</span><span class="op" id="7333520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333525">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333536">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333540">_</span><span class="op" id="7333541">,</span>&nbsp;<span class="ident" id="7333543">err</span>&nbsp;<span class="op" id="7333547">=</span>&nbsp;<span class="ident" id="7333549">ioutil</span><span class="op" id="7333555">.</span><span class="ident" id="7333556">ReadAll</span><span class="op" id="7333563">(</span><span class="ident" id="7333564">r</span><span class="op" id="7333565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333569">if</span>&nbsp;<span class="ident" id="7333572">err</span>&nbsp;<span class="op" id="7333576">!=</span>&nbsp;<span class="ident" id="7333579">nil</span>&nbsp;<span class="op" id="7333583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333588">t</span><span class="op" id="7333589">.</span><span class="ident" id="7333590">Errorf</span><span class="op" id="7333596">(</span><span class="string" id="7333597">&#34;ReadAll:&nbsp;%v&#34;</span><span class="op" id="7333610">,</span>&nbsp;<span class="ident" id="7333612">err</span><span class="op" id="7333615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333620">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333631">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333635">if</span>&nbsp;<span class="ident" id="7333638">r</span><span class="op" id="7333639">.</span><span class="ident" id="7333640">Name</span>&nbsp;<span class="op" id="7333645">!=</span>&nbsp;<span class="ident" id="7333648">tc</span><span class="op" id="7333650">.</span><span class="ident" id="7333651">name</span>&nbsp;<span class="op" id="7333656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333661">t</span><span class="op" id="7333662">.</span><span class="ident" id="7333663">Errorf</span><span class="op" id="7333669">(</span><span class="string" id="7333670">&#34;name&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7333691">,</span>&nbsp;<span class="ident" id="7333693">r</span><span class="op" id="7333694">.</span><span class="ident" id="7333695">Name</span><span class="op" id="7333699">,</span>&nbsp;<span class="ident" id="7333701">tc</span><span class="op" id="7333703">.</span><span class="ident" id="7333704">name</span><span class="op" id="7333708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333713">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333728">if</span>&nbsp;<span class="ident" id="7333731">err</span>&nbsp;<span class="op" id="7333735">:=</span>&nbsp;<span class="ident" id="7333738">r</span><span class="op" id="7333739">.</span><span class="ident" id="7333740">Close</span><span class="op" id="7333745">(</span><span class="op" id="7333746">)</span><span class="op" id="7333747">;</span>&nbsp;<span class="ident" id="7333749">err</span>&nbsp;<span class="op" id="7333753">!=</span>&nbsp;<span class="ident" id="7333756">nil</span>&nbsp;<span class="op" id="7333760">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333765">t</span><span class="op" id="7333766">.</span><span class="ident" id="7333767">Errorf</span><span class="op" id="7333773">(</span><span class="string" id="7333774">&#34;Reader.Close:&nbsp;%v&#34;</span><span class="op" id="7333792">,</span>&nbsp;<span class="ident" id="7333794">err</span><span class="op" id="7333797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333802">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333816">}</span><br>
<span class="lineno"></span><span class="op" id="7333818">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="7333821">func</span>&nbsp;<span class="ident" id="7333826">TestWriterFlush</span><span class="op" id="7333841">(</span><span class="ident" id="7333842">t</span>&nbsp;<span class="op" id="7333844">*</span><span class="ident" id="7333845">testing</span><span class="op" id="7333852">.</span><span class="ident" id="7333853">T</span><span class="op" id="7333854">)</span>&nbsp;<span class="op" id="7333856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333859">buf</span>&nbsp;<span class="op" id="7333863">:=</span>&nbsp;<span class="builtinfunc" id="7333866">new</span><span class="op" id="7333869">(</span><span class="ident" id="7333870">bytes</span><span class="op" id="7333875">.</span><span class="ident" id="7333876">Buffer</span><span class="op" id="7333882">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333886">w</span>&nbsp;<span class="op" id="7333888">:=</span>&nbsp;<span class="ident" id="7333891">NewWriter</span><span class="op" id="7333900">(</span><span class="ident" id="7333901">buf</span><span class="op" id="7333904">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333907">w</span><span class="op" id="7333908">.</span><span class="ident" id="7333909">Comment</span>&nbsp;<span class="op" id="7333917">=</span>&nbsp;<span class="string" id="7333919">&#34;comment&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333930">w</span><span class="op" id="7333931">.</span><span class="ident" id="7333932">Extra</span>&nbsp;<span class="op" id="7333938">=</span>&nbsp;<span class="op" id="7333940">[</span><span class="op" id="7333941">]</span><span class="builtintype" id="7333942">byte</span><span class="op" id="7333946">(</span><span class="string" id="7333947">&#34;extra&#34;</span><span class="op" id="7333954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333957">w</span><span class="op" id="7333958">.</span><span class="ident" id="7333959">ModTime</span>&nbsp;<span class="op" id="7333967">=</span>&nbsp;<span class="ident" id="7333969">time</span><span class="op" id="7333973">.</span><span class="ident" id="7333974">Unix</span><span class="op" id="7333978">(</span><span class="num" id="7333979">1e8</span><span class="op" id="7333982">,</span>&nbsp;<span class="num" id="7333984">0</span><span class="op" id="7333985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333988">w</span><span class="op" id="7333989">.</span><span class="ident" id="7333990">Name</span>&nbsp;<span class="op" id="7333995">=</span>&nbsp;<span class="string" id="7333997">&#34;name&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334006">n0</span>&nbsp;<span class="op" id="7334009">:=</span>&nbsp;<span class="ident" id="7334012">buf</span><span class="op" id="7334015">.</span><span class="ident" id="7334016">Len</span><span class="op" id="7334019">(</span><span class="op" id="7334020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334023">if</span>&nbsp;<span class="ident" id="7334026">n0</span>&nbsp;<span class="op" id="7334029">!=</span>&nbsp;<span class="num" id="7334032">0</span>&nbsp;<span class="op" id="7334034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334038">t</span><span class="op" id="7334039">.</span><span class="ident" id="7334040">Fatalf</span><span class="op" id="7334046">(</span><span class="string" id="7334047">&#34;buffer&nbsp;size&nbsp;=&nbsp;%d&nbsp;before&nbsp;writes;&nbsp;want&nbsp;0&#34;</span><span class="op" id="7334087">,</span>&nbsp;<span class="ident" id="7334089">n0</span><span class="op" id="7334091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334098">if</span>&nbsp;<span class="ident" id="7334101">err</span>&nbsp;<span class="op" id="7334105">:=</span>&nbsp;<span class="ident" id="7334108">w</span><span class="op" id="7334109">.</span><span class="ident" id="7334110">Flush</span><span class="op" id="7334115">(</span><span class="op" id="7334116">)</span><span class="op" id="7334117">;</span>&nbsp;<span class="ident" id="7334119">err</span>&nbsp;<span class="op" id="7334123">!=</span>&nbsp;<span class="ident" id="7334126">nil</span>&nbsp;<span class="op" id="7334130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334134">t</span><span class="op" id="7334135">.</span><span class="ident" id="7334136">Fatal</span><span class="op" id="7334141">(</span><span class="ident" id="7334142">err</span><span class="op" id="7334145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334152">n1</span>&nbsp;<span class="op" id="7334155">:=</span>&nbsp;<span class="ident" id="7334158">buf</span><span class="op" id="7334161">.</span><span class="ident" id="7334162">Len</span><span class="op" id="7334165">(</span><span class="op" id="7334166">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334169">if</span>&nbsp;<span class="ident" id="7334172">n1</span>&nbsp;<span class="op" id="7334175">==</span>&nbsp;<span class="num" id="7334178">0</span>&nbsp;<span class="op" id="7334180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334184">t</span><span class="op" id="7334185">.</span><span class="ident" id="7334186">Fatal</span><span class="op" id="7334191">(</span><span class="string" id="7334192">&#34;no&nbsp;data&nbsp;after&nbsp;first&nbsp;flush&#34;</span><span class="op" id="7334219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334226">w</span><span class="op" id="7334227">.</span><span class="ident" id="7334228">Write</span><span class="op" id="7334233">(</span><span class="op" id="7334234">[</span><span class="op" id="7334235">]</span><span class="builtintype" id="7334236">byte</span><span class="op" id="7334240">(</span><span class="string" id="7334241">&#34;x&#34;</span><span class="op" id="7334244">)</span><span class="op" id="7334245">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334249">n2</span>&nbsp;<span class="op" id="7334252">:=</span>&nbsp;<span class="ident" id="7334255">buf</span><span class="op" id="7334258">.</span><span class="ident" id="7334259">Len</span><span class="op" id="7334262">(</span><span class="op" id="7334263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334266">if</span>&nbsp;<span class="ident" id="7334269">n1</span>&nbsp;<span class="op" id="7334272">!=</span>&nbsp;<span class="ident" id="7334275">n2</span>&nbsp;<span class="op" id="7334278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334282">t</span><span class="op" id="7334283">.</span><span class="ident" id="7334284">Fatalf</span><span class="op" id="7334290">(</span><span class="string" id="7334291">&#34;after&nbsp;writing&nbsp;a&nbsp;single&nbsp;byte,&nbsp;size&nbsp;changed&nbsp;from&nbsp;%d&nbsp;to&nbsp;%d;&nbsp;want&nbsp;no&nbsp;change&#34;</span><span class="op" id="7334364">,</span>&nbsp;<span class="ident" id="7334366">n1</span><span class="op" id="7334368">,</span>&nbsp;<span class="ident" id="7334370">n2</span><span class="op" id="7334372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334375">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334379">if</span>&nbsp;<span class="ident" id="7334382">err</span>&nbsp;<span class="op" id="7334386">:=</span>&nbsp;<span class="ident" id="7334389">w</span><span class="op" id="7334390">.</span><span class="ident" id="7334391">Flush</span><span class="op" id="7334396">(</span><span class="op" id="7334397">)</span><span class="op" id="7334398">;</span>&nbsp;<span class="ident" id="7334400">err</span>&nbsp;<span class="op" id="7334404">!=</span>&nbsp;<span class="ident" id="7334407">nil</span>&nbsp;<span class="op" id="7334411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334415">t</span><span class="op" id="7334416">.</span><span class="ident" id="7334417">Fatal</span><span class="op" id="7334422">(</span><span class="ident" id="7334423">err</span><span class="op" id="7334426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334433">n3</span>&nbsp;<span class="op" id="7334436">:=</span>&nbsp;<span class="ident" id="7334439">buf</span><span class="op" id="7334442">.</span><span class="ident" id="7334443">Len</span><span class="op" id="7334446">(</span><span class="op" id="7334447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334450">if</span>&nbsp;<span class="ident" id="7334453">n2</span>&nbsp;<span class="op" id="7334456">==</span>&nbsp;<span class="ident" id="7334459">n3</span>&nbsp;<span class="op" id="7334462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334466">t</span><span class="op" id="7334467">.</span><span class="ident" id="7334468">Fatal</span><span class="op" id="7334473">(</span><span class="string" id="7334474">&#34;Flush&nbsp;didn&#39;t&nbsp;flush&nbsp;any&nbsp;data&#34;</span><span class="op" id="7334503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334506">}</span><br>
<span class="lineno"></span><span class="op" id="7334508">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="comment" id="7334511">//&nbsp;Multiple&nbsp;gzip&nbsp;files&nbsp;concatenated&nbsp;form&nbsp;a&nbsp;valid&nbsp;gzip&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="7334571">func</span>&nbsp;<span class="ident" id="7334576">TestConcat</span><span class="op" id="7334586">(</span><span class="ident" id="7334587">t</span>&nbsp;<span class="op" id="7334589">*</span><span class="ident" id="7334590">testing</span><span class="op" id="7334597">.</span><span class="ident" id="7334598">T</span><span class="op" id="7334599">)</span>&nbsp;<span class="op" id="7334601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334604">var</span>&nbsp;<span class="ident" id="7334608">buf</span>&nbsp;<span class="ident" id="7334612">bytes</span><span class="op" id="7334617">.</span><span class="ident" id="7334618">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334626">w</span>&nbsp;<span class="op" id="7334628">:=</span>&nbsp;<span class="ident" id="7334631">NewWriter</span><span class="op" id="7334640">(</span><span class="op" id="7334641">&amp;</span><span class="ident" id="7334642">buf</span><span class="op" id="7334645">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334648">w</span><span class="op" id="7334649">.</span><span class="ident" id="7334650">Write</span><span class="op" id="7334655">(</span><span class="op" id="7334656">[</span><span class="op" id="7334657">]</span><span class="builtintype" id="7334658">byte</span><span class="op" id="7334662">(</span><span class="string" id="7334663">&#34;hello&nbsp;&#34;</span><span class="op" id="7334671">)</span><span class="op" id="7334672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334675">w</span><span class="op" id="7334676">.</span><span class="ident" id="7334677">Close</span><span class="op" id="7334682">(</span><span class="op" id="7334683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334686">w</span>&nbsp;<span class="op" id="7334688">=</span>&nbsp;<span class="ident" id="7334690">NewWriter</span><span class="op" id="7334699">(</span><span class="op" id="7334700">&amp;</span><span class="ident" id="7334701">buf</span><span class="op" id="7334704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334707">w</span><span class="op" id="7334708">.</span><span class="ident" id="7334709">Write</span><span class="op" id="7334714">(</span><span class="op" id="7334715">[</span><span class="op" id="7334716">]</span><span class="builtintype" id="7334717">byte</span><span class="op" id="7334721">(</span><span class="string" id="7334722">&#34;world\n&#34;</span><span class="op" id="7334731">)</span><span class="op" id="7334732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334735">w</span><span class="op" id="7334736">.</span><span class="ident" id="7334737">Close</span><span class="op" id="7334742">(</span><span class="op" id="7334743">)</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334747">r</span><span class="op" id="7334748">,</span>&nbsp;<span class="ident" id="7334750">err</span>&nbsp;<span class="op" id="7334754">:=</span>&nbsp;<span class="ident" id="7334757">NewReader</span><span class="op" id="7334766">(</span><span class="op" id="7334767">&amp;</span><span class="ident" id="7334768">buf</span><span class="op" id="7334771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334774">data</span><span class="op" id="7334778">,</span>&nbsp;<span class="ident" id="7334780">err</span>&nbsp;<span class="op" id="7334784">:=</span>&nbsp;<span class="ident" id="7334787">ioutil</span><span class="op" id="7334793">.</span><span class="ident" id="7334794">ReadAll</span><span class="op" id="7334801">(</span><span class="ident" id="7334802">r</span><span class="op" id="7334803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334806">if</span>&nbsp;<span class="builtintype" id="7334809">string</span><span class="op" id="7334815">(</span><span class="ident" id="7334816">data</span><span class="op" id="7334820">)</span>&nbsp;<span class="op" id="7334822">!=</span>&nbsp;<span class="string" id="7334825">&#34;hello&nbsp;world\n&#34;</span>&nbsp;<span class="op" id="7334841">||</span>&nbsp;<span class="ident" id="7334844">err</span>&nbsp;<span class="op" id="7334848">!=</span>&nbsp;<span class="ident" id="7334851">nil</span>&nbsp;<span class="op" id="7334855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334859">t</span><span class="op" id="7334860">.</span><span class="ident" id="7334861">Fatalf</span><span class="op" id="7334867">(</span><span class="string" id="7334868">&#34;ReadAll&nbsp;=&nbsp;%q,&nbsp;%v,&nbsp;want&nbsp;%q,&nbsp;nil&#34;</span><span class="op" id="7334900">,</span>&nbsp;<span class="ident" id="7334902">data</span><span class="op" id="7334906">,</span>&nbsp;<span class="ident" id="7334908">err</span><span class="op" id="7334911">,</span>&nbsp;<span class="string" id="7334913">&#34;hello&nbsp;world&#34;</span><span class="op" id="7334926">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334929">}</span><br>
<span class="lineno"></span><span class="op" id="7334931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7334934">func</span>&nbsp;<span class="ident" id="7334939">TestWriterReset</span><span class="op" id="7334954">(</span><span class="ident" id="7334955">t</span>&nbsp;<span class="op" id="7334957">*</span><span class="ident" id="7334958">testing</span><span class="op" id="7334965">.</span><span class="ident" id="7334966">T</span><span class="op" id="7334967">)</span>&nbsp;<span class="op" id="7334969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334972">buf</span>&nbsp;<span class="op" id="7334976">:=</span>&nbsp;<span class="builtinfunc" id="7334979">new</span><span class="op" id="7334982">(</span><span class="ident" id="7334983">bytes</span><span class="op" id="7334988">.</span><span class="ident" id="7334989">Buffer</span><span class="op" id="7334995">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334998">buf2</span>&nbsp;<span class="op" id="7335003">:=</span>&nbsp;<span class="builtinfunc" id="7335006">new</span><span class="op" id="7335009">(</span><span class="ident" id="7335010">bytes</span><span class="op" id="7335015">.</span><span class="ident" id="7335016">Buffer</span><span class="op" id="7335022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335025">z</span>&nbsp;<span class="op" id="7335027">:=</span>&nbsp;<span class="ident" id="7335030">NewWriter</span><span class="op" id="7335039">(</span><span class="ident" id="7335040">buf</span><span class="op" id="7335043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335046">msg</span>&nbsp;<span class="op" id="7335050">:=</span>&nbsp;<span class="op" id="7335053">[</span><span class="op" id="7335054">]</span><span class="builtintype" id="7335055">byte</span><span class="op" id="7335059">(</span><span class="string" id="7335060">&#34;hello&nbsp;world&#34;</span><span class="op" id="7335073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335076">z</span><span class="op" id="7335077">.</span><span class="ident" id="7335078">Write</span><span class="op" id="7335083">(</span><span class="ident" id="7335084">msg</span><span class="op" id="7335087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335090">z</span><span class="op" id="7335091">.</span><span class="ident" id="7335092">Close</span><span class="op" id="7335097">(</span><span class="op" id="7335098">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335101">z</span><span class="op" id="7335102">.</span><span class="ident" id="7335103">Reset</span><span class="op" id="7335108">(</span><span class="ident" id="7335109">buf2</span><span class="op" id="7335113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335116">z</span><span class="op" id="7335117">.</span><span class="ident" id="7335118">Write</span><span class="op" id="7335123">(</span><span class="ident" id="7335124">msg</span><span class="op" id="7335127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335130">z</span><span class="op" id="7335131">.</span><span class="ident" id="7335132">Close</span><span class="op" id="7335137">(</span><span class="op" id="7335138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335141">if</span>&nbsp;<span class="ident" id="7335144">buf</span><span class="op" id="7335147">.</span><span class="ident" id="7335148">String</span><span class="op" id="7335154">(</span><span class="op" id="7335155">)</span>&nbsp;<span class="op" id="7335157">!=</span>&nbsp;<span class="ident" id="7335160">buf2</span><span class="op" id="7335164">.</span><span class="ident" id="7335165">String</span><span class="op" id="7335171">(</span><span class="op" id="7335172">)</span>&nbsp;<span class="op" id="7335174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335178">t</span><span class="op" id="7335179">.</span><span class="ident" id="7335180">Errorf</span><span class="op" id="7335186">(</span><span class="string" id="7335187">&#34;buf2&nbsp;%q&nbsp;!=&nbsp;original&nbsp;buf&nbsp;of&nbsp;%q&#34;</span><span class="op" id="7335218">,</span>&nbsp;<span class="ident" id="7335220">buf2</span><span class="op" id="7335224">.</span><span class="ident" id="7335225">String</span><span class="op" id="7335231">(</span><span class="op" id="7335232">)</span><span class="op" id="7335233">,</span>&nbsp;<span class="ident" id="7335235">buf</span><span class="op" id="7335238">.</span><span class="ident" id="7335239">String</span><span class="op" id="7335245">(</span><span class="op" id="7335246">)</span><span class="op" id="7335247">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335250">}</span><br>
<span class="lineno"></span><span class="op" id="7335252">}</span>
</div>
</body>
</html>
