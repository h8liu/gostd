<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html" class="current">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2264462">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2264517">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2264571">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2264622">package</span>&nbsp;<span class="ident" id="2264630">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2264636">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2264676">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2264736">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2264800">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2264858">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2264916">//</span><br>
<span class="lineno"></span><span class="comment" id="2264919">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="2264933">//</span><br>
<span class="lineno"></span><span class="comment" id="2264936">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="2264958">//</span><br>
<span class="lineno">20</span><span class="comment" id="2264961">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2264974">//</span><br>
<span class="lineno"></span><span class="comment" id="2264977">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="2265000">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2265017">//</span><br>
<span class="lineno">25</span><span class="comment" id="2265020">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2265036">//</span><br>
<span class="lineno"></span><span class="comment" id="2265039">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2265116">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="2265186">//</span><br>
<span class="lineno">30</span><span class="comment" id="2265189">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2265245">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2265295">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2265323">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2265377">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="2265405">//</span><br>
<span class="lineno"></span><span class="comment" id="2265408">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2265421">//</span><br>
<span class="lineno"></span><span class="comment" id="2265424">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2265464">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2265523">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="2265584">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2265645">//</span><br>
<span class="lineno"></span><span class="comment" id="2265648">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="2265726">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="2265802">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2265844">//</span><br>
<span class="lineno"></span><span class="comment" id="2265847">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="2265861">//</span><br>
<span class="lineno"></span><span class="comment" id="2265864">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="2265888">//</span><br>
<span class="lineno"></span><span class="comment" id="2265891">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2265904">//</span><br>
<span class="lineno"></span><span class="comment" id="2265907">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="2265930">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="2265947">//</span><br>
<span class="lineno"></span><span class="comment" id="2265950">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2265966">//</span><br>
<span class="lineno"></span><span class="comment" id="2265969">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2266046">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="2266116">//</span><br>
<span class="lineno"></span><span class="comment" id="2266119">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2266175">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2266227">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2266255">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="2266307">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2266335">//</span><br>
<span class="lineno"></span><span class="comment" id="2266338">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2266351">//</span><br>
<span class="lineno"></span><span class="comment" id="2266354">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="2266394">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2266453">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2266514">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="2266575">//</span><br>
<span class="lineno"></span><span class="comment" id="2266578">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="2266626">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2266690">//</span><br>
<span class="lineno"></span><span class="comment" id="2266693">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2266754">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2266824">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="2266899">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2266966">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2267039">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2267111">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2267125">//</span><br>
<span class="lineno">85</span><span class="comment" id="2267128">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2267194">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2267260">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2267273">//</span><br>
<span class="lineno"></span><span class="comment" id="2267276">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="2267300">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2267330">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2267350">var</span>&nbsp;<span class="ident" id="2267354">_sin</span>&nbsp;<span class="op" id="2267359">=</span>&nbsp;<span class="op" id="2267361">[</span><span class="op" id="2267362">...</span><span class="op" id="2267365">]</span><span class="builtintype" id="2267366">float64</span><span class="op" id="2267373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2267376">1.58962301576546568060E-10</span><span class="op" id="2267402">,</span>&nbsp;<span class="comment" id="2267404">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2267427">-</span><span class="num" id="2267428">2.50507477628578072866E-8</span><span class="op" id="2267453">,</span>&nbsp;<span class="comment" id="2267455">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2267478">2.75573136213857245213E-6</span><span class="op" id="2267503">,</span>&nbsp;&nbsp;<span class="comment" id="2267506">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2267529">-</span><span class="num" id="2267530">1.98412698295895385996E-4</span><span class="op" id="2267555">,</span>&nbsp;<span class="comment" id="2267557">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2267580">8.33333333332211858878E-3</span><span class="op" id="2267605">,</span>&nbsp;&nbsp;<span class="comment" id="2267608">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2267631">-</span><span class="num" id="2267632">1.66666666666666307295E-1</span><span class="op" id="2267657">,</span>&nbsp;<span class="comment" id="2267659">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="2267681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2267684">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2267704">var</span>&nbsp;<span class="ident" id="2267708">_cos</span>&nbsp;<span class="op" id="2267713">=</span>&nbsp;<span class="op" id="2267715">[</span><span class="op" id="2267716">...</span><span class="op" id="2267719">]</span><span class="builtintype" id="2267720">float64</span><span class="op" id="2267727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2267730">-</span><span class="num" id="2267731">1.13585365213876817300E-11</span><span class="op" id="2267757">,</span>&nbsp;<span class="comment" id="2267759">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2267782">2.08757008419747316778E-9</span><span class="op" id="2267807">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2267811">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2267834">-</span><span class="num" id="2267835">2.75573141792967388112E-7</span><span class="op" id="2267860">,</span>&nbsp;&nbsp;<span class="comment" id="2267863">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2267886">2.48015872888517045348E-5</span><span class="op" id="2267911">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2267915">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2267938">-</span><span class="num" id="2267939">1.38888888888730564116E-3</span><span class="op" id="2267964">,</span>&nbsp;&nbsp;<span class="comment" id="2267967">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2267990">4.16666666666665929218E-2</span><span class="op" id="2268015">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2268019">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="2268041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2268044">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2268096">//</span><br>
<span class="lineno"></span><span class="comment" id="2268099">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="2268121">//&nbsp;&nbsp;&nbsp;&nbsp;Cos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2268141">//&nbsp;&nbsp;&nbsp;&nbsp;Cos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2268159">func</span>&nbsp;<span class="ident" id="2268164">Cos</span><span class="op" id="2268167">(</span><span class="ident" id="2268168">x</span>&nbsp;<span class="builtintype" id="2268170">float64</span><span class="op" id="2268177">)</span>&nbsp;<span class="builtintype" id="2268179">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2268188">func</span>&nbsp;<span class="ident" id="2268193">cos</span><span class="op" id="2268196">(</span><span class="ident" id="2268197">x</span>&nbsp;<span class="builtintype" id="2268199">float64</span><span class="op" id="2268206">)</span>&nbsp;<span class="builtintype" id="2268208">float64</span>&nbsp;<span class="op" id="2268216">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2268219">const</span>&nbsp;<span class="op" id="2268225">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268229">PI4A</span>&nbsp;<span class="op" id="2268234">=</span>&nbsp;<span class="num" id="2268236">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2268290">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268343">PI4B</span>&nbsp;<span class="op" id="2268348">=</span>&nbsp;<span class="num" id="2268350">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2268404">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268429">PI4C</span>&nbsp;<span class="op" id="2268434">=</span>&nbsp;<span class="num" id="2268436">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2268490">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268515">M4PI</span>&nbsp;<span class="op" id="2268520">=</span>&nbsp;<span class="num" id="2268522">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2268576">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2268585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2268588">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2268606">switch</span>&nbsp;<span class="op" id="2268613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2268616">case</span>&nbsp;<span class="ident" id="2268621">IsNaN</span><span class="op" id="2268626">(</span><span class="ident" id="2268627">x</span><span class="op" id="2268628">)</span>&nbsp;<span class="op" id="2268630">||</span>&nbsp;<span class="ident" id="2268633">IsInf</span><span class="op" id="2268638">(</span><span class="ident" id="2268639">x</span><span class="op" id="2268640">,</span>&nbsp;<span class="num" id="2268642">0</span><span class="op" id="2268643">)</span><span class="op" id="2268644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2268648">return</span>&nbsp;<span class="ident" id="2268655">NaN</span><span class="op" id="2268658">(</span><span class="op" id="2268659">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2268662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2268666">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268693">sign</span>&nbsp;<span class="op" id="2268698">:=</span>&nbsp;<span class="builtintype" id="2268701">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2268708">if</span>&nbsp;<span class="ident" id="2268711">x</span>&nbsp;<span class="op" id="2268713">&lt;</span>&nbsp;<span class="num" id="2268715">0</span>&nbsp;<span class="op" id="2268717">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268721">x</span>&nbsp;<span class="op" id="2268723">=</span>&nbsp;<span class="op" id="2268725">-</span><span class="ident" id="2268726">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2268729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268733">j</span>&nbsp;<span class="op" id="2268735">:=</span>&nbsp;<span class="ident" id="2268738">int64</span><span class="op" id="2268743">(</span><span class="ident" id="2268744">x</span>&nbsp;<span class="op" id="2268746">*</span>&nbsp;<span class="ident" id="2268748">M4PI</span><span class="op" id="2268752">)</span>&nbsp;<span class="comment" id="2268754">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268824">y</span>&nbsp;<span class="op" id="2268826">:=</span>&nbsp;<span class="builtintype" id="2268829">float64</span><span class="op" id="2268836">(</span><span class="ident" id="2268837">j</span><span class="op" id="2268838">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2268845">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2268885">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2268909">if</span>&nbsp;<span class="ident" id="2268912">j</span><span class="op" id="2268913">&amp;</span><span class="num" id="2268914">1</span>&nbsp;<span class="op" id="2268916">==</span>&nbsp;<span class="num" id="2268919">1</span>&nbsp;<span class="op" id="2268921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268925">j</span>&nbsp;<span class="op" id="2268927">+=</span>&nbsp;<span class="num" id="2268930">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268934">y</span>&nbsp;<span class="op" id="2268936">+=</span>&nbsp;<span class="num" id="2268939">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2268942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2268945">j</span>&nbsp;<span class="op" id="2268947">&amp;=</span>&nbsp;<span class="num" id="2268950">7</span>&nbsp;<span class="comment" id="2268952">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2268996">if</span>&nbsp;<span class="ident" id="2268999">j</span>&nbsp;<span class="op" id="2269001">&gt;</span>&nbsp;<span class="num" id="2269003">3</span>&nbsp;<span class="op" id="2269005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269009">j</span>&nbsp;<span class="op" id="2269011">-=</span>&nbsp;<span class="num" id="2269014">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269018">sign</span>&nbsp;<span class="op" id="2269023">=</span>&nbsp;<span class="op" id="2269025">!</span><span class="ident" id="2269026">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2269032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2269035">if</span>&nbsp;<span class="ident" id="2269038">j</span>&nbsp;<span class="op" id="2269040">&gt;</span>&nbsp;<span class="num" id="2269042">1</span>&nbsp;<span class="op" id="2269044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269048">sign</span>&nbsp;<span class="op" id="2269053">=</span>&nbsp;<span class="op" id="2269055">!</span><span class="ident" id="2269056">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2269062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269066">z</span>&nbsp;<span class="op" id="2269068">:=</span>&nbsp;<span class="op" id="2269071">(</span><span class="op" id="2269072">(</span><span class="ident" id="2269073">x</span>&nbsp;<span class="op" id="2269075">-</span>&nbsp;<span class="ident" id="2269077">y</span><span class="op" id="2269078">*</span><span class="ident" id="2269079">PI4A</span><span class="op" id="2269083">)</span>&nbsp;<span class="op" id="2269085">-</span>&nbsp;<span class="ident" id="2269087">y</span><span class="op" id="2269088">*</span><span class="ident" id="2269089">PI4B</span><span class="op" id="2269093">)</span>&nbsp;<span class="op" id="2269095">-</span>&nbsp;<span class="ident" id="2269097">y</span><span class="op" id="2269098">*</span><span class="ident" id="2269099">PI4C</span>&nbsp;<span class="comment" id="2269104">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269146">zz</span>&nbsp;<span class="op" id="2269149">:=</span>&nbsp;<span class="ident" id="2269152">z</span>&nbsp;<span class="op" id="2269154">*</span>&nbsp;<span class="ident" id="2269156">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2269159">if</span>&nbsp;<span class="ident" id="2269162">j</span>&nbsp;<span class="op" id="2269164">==</span>&nbsp;<span class="num" id="2269167">1</span>&nbsp;<span class="op" id="2269169">||</span>&nbsp;<span class="ident" id="2269172">j</span>&nbsp;<span class="op" id="2269174">==</span>&nbsp;<span class="num" id="2269177">2</span>&nbsp;<span class="op" id="2269179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269183">y</span>&nbsp;<span class="op" id="2269185">=</span>&nbsp;<span class="ident" id="2269187">z</span>&nbsp;<span class="op" id="2269189">+</span>&nbsp;<span class="ident" id="2269191">z</span><span class="op" id="2269192">*</span><span class="ident" id="2269193">zz</span><span class="op" id="2269195">*</span><span class="op" id="2269196">(</span><span class="op" id="2269197">(</span><span class="op" id="2269198">(</span><span class="op" id="2269199">(</span><span class="op" id="2269200">(</span><span class="op" id="2269201">(</span><span class="ident" id="2269202">_sin</span><span class="op" id="2269206">[</span><span class="num" id="2269207">0</span><span class="op" id="2269208">]</span><span class="op" id="2269209">*</span><span class="ident" id="2269210">zz</span><span class="op" id="2269212">)</span><span class="op" id="2269213">+</span><span class="ident" id="2269214">_sin</span><span class="op" id="2269218">[</span><span class="num" id="2269219">1</span><span class="op" id="2269220">]</span><span class="op" id="2269221">)</span><span class="op" id="2269222">*</span><span class="ident" id="2269223">zz</span><span class="op" id="2269225">+</span><span class="ident" id="2269226">_sin</span><span class="op" id="2269230">[</span><span class="num" id="2269231">2</span><span class="op" id="2269232">]</span><span class="op" id="2269233">)</span><span class="op" id="2269234">*</span><span class="ident" id="2269235">zz</span><span class="op" id="2269237">+</span><span class="ident" id="2269238">_sin</span><span class="op" id="2269242">[</span><span class="num" id="2269243">3</span><span class="op" id="2269244">]</span><span class="op" id="2269245">)</span><span class="op" id="2269246">*</span><span class="ident" id="2269247">zz</span><span class="op" id="2269249">+</span><span class="ident" id="2269250">_sin</span><span class="op" id="2269254">[</span><span class="num" id="2269255">4</span><span class="op" id="2269256">]</span><span class="op" id="2269257">)</span><span class="op" id="2269258">*</span><span class="ident" id="2269259">zz</span><span class="op" id="2269261">+</span><span class="ident" id="2269262">_sin</span><span class="op" id="2269266">[</span><span class="num" id="2269267">5</span><span class="op" id="2269268">]</span><span class="op" id="2269269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2269272">}</span>&nbsp;<span class="keyword" id="2269274">else</span>&nbsp;<span class="op" id="2269279">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269283">y</span>&nbsp;<span class="op" id="2269285">=</span>&nbsp;<span class="num" id="2269287">1.0</span>&nbsp;<span class="op" id="2269291">-</span>&nbsp;<span class="num" id="2269293">0.5</span><span class="op" id="2269296">*</span><span class="ident" id="2269297">zz</span>&nbsp;<span class="op" id="2269300">+</span>&nbsp;<span class="ident" id="2269302">zz</span><span class="op" id="2269304">*</span><span class="ident" id="2269305">zz</span><span class="op" id="2269307">*</span><span class="op" id="2269308">(</span><span class="op" id="2269309">(</span><span class="op" id="2269310">(</span><span class="op" id="2269311">(</span><span class="op" id="2269312">(</span><span class="op" id="2269313">(</span><span class="ident" id="2269314">_cos</span><span class="op" id="2269318">[</span><span class="num" id="2269319">0</span><span class="op" id="2269320">]</span><span class="op" id="2269321">*</span><span class="ident" id="2269322">zz</span><span class="op" id="2269324">)</span><span class="op" id="2269325">+</span><span class="ident" id="2269326">_cos</span><span class="op" id="2269330">[</span><span class="num" id="2269331">1</span><span class="op" id="2269332">]</span><span class="op" id="2269333">)</span><span class="op" id="2269334">*</span><span class="ident" id="2269335">zz</span><span class="op" id="2269337">+</span><span class="ident" id="2269338">_cos</span><span class="op" id="2269342">[</span><span class="num" id="2269343">2</span><span class="op" id="2269344">]</span><span class="op" id="2269345">)</span><span class="op" id="2269346">*</span><span class="ident" id="2269347">zz</span><span class="op" id="2269349">+</span><span class="ident" id="2269350">_cos</span><span class="op" id="2269354">[</span><span class="num" id="2269355">3</span><span class="op" id="2269356">]</span><span class="op" id="2269357">)</span><span class="op" id="2269358">*</span><span class="ident" id="2269359">zz</span><span class="op" id="2269361">+</span><span class="ident" id="2269362">_cos</span><span class="op" id="2269366">[</span><span class="num" id="2269367">4</span><span class="op" id="2269368">]</span><span class="op" id="2269369">)</span><span class="op" id="2269370">*</span><span class="ident" id="2269371">zz</span><span class="op" id="2269373">+</span><span class="ident" id="2269374">_cos</span><span class="op" id="2269378">[</span><span class="num" id="2269379">5</span><span class="op" id="2269380">]</span><span class="op" id="2269381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2269384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2269387">if</span>&nbsp;<span class="ident" id="2269390">sign</span>&nbsp;<span class="op" id="2269395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269399">y</span>&nbsp;<span class="op" id="2269401">=</span>&nbsp;<span class="op" id="2269403">-</span><span class="ident" id="2269404">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2269407">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2269410">return</span>&nbsp;<span class="ident" id="2269417">y</span><br>
<span class="lineno"></span><span class="op" id="2269419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2269422">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2269472">//</span><br>
<span class="lineno">170</span><span class="comment" id="2269475">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2269497">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2269515">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2269535">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2269553">func</span>&nbsp;<span class="ident" id="2269558">Sin</span><span class="op" id="2269561">(</span><span class="ident" id="2269562">x</span>&nbsp;<span class="builtintype" id="2269564">float64</span><span class="op" id="2269571">)</span>&nbsp;<span class="builtintype" id="2269573">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2269582">func</span>&nbsp;<span class="ident" id="2269587">sin</span><span class="op" id="2269590">(</span><span class="ident" id="2269591">x</span>&nbsp;<span class="builtintype" id="2269593">float64</span><span class="op" id="2269600">)</span>&nbsp;<span class="builtintype" id="2269602">float64</span>&nbsp;<span class="op" id="2269610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2269613">const</span>&nbsp;<span class="op" id="2269619">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269623">PI4A</span>&nbsp;<span class="op" id="2269628">=</span>&nbsp;<span class="num" id="2269630">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2269684">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269737">PI4B</span>&nbsp;<span class="op" id="2269742">=</span>&nbsp;<span class="num" id="2269744">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2269798">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269823">PI4C</span>&nbsp;<span class="op" id="2269828">=</span>&nbsp;<span class="num" id="2269830">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2269884">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2269909">M4PI</span>&nbsp;<span class="op" id="2269914">=</span>&nbsp;<span class="num" id="2269916">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2269970">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2269979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2269982">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270000">switch</span>&nbsp;<span class="op" id="2270007">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270010">case</span>&nbsp;<span class="ident" id="2270015">x</span>&nbsp;<span class="op" id="2270017">==</span>&nbsp;<span class="num" id="2270020">0</span>&nbsp;<span class="op" id="2270022">||</span>&nbsp;<span class="ident" id="2270025">IsNaN</span><span class="op" id="2270030">(</span><span class="ident" id="2270031">x</span><span class="op" id="2270032">)</span><span class="op" id="2270033">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270037">return</span>&nbsp;<span class="ident" id="2270044">x</span>&nbsp;<span class="comment" id="2270046">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270070">case</span>&nbsp;<span class="ident" id="2270075">IsInf</span><span class="op" id="2270080">(</span><span class="ident" id="2270081">x</span><span class="op" id="2270082">,</span>&nbsp;<span class="num" id="2270084">0</span><span class="op" id="2270085">)</span><span class="op" id="2270086">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270090">return</span>&nbsp;<span class="ident" id="2270097">NaN</span><span class="op" id="2270100">(</span><span class="op" id="2270101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2270104">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2270108">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270153">sign</span>&nbsp;<span class="op" id="2270158">:=</span>&nbsp;<span class="builtintype" id="2270161">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270168">if</span>&nbsp;<span class="ident" id="2270171">x</span>&nbsp;<span class="op" id="2270173">&lt;</span>&nbsp;<span class="num" id="2270175">0</span>&nbsp;<span class="op" id="2270177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270181">x</span>&nbsp;<span class="op" id="2270183">=</span>&nbsp;<span class="op" id="2270185">-</span><span class="ident" id="2270186">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270190">sign</span>&nbsp;<span class="op" id="2270195">=</span>&nbsp;<span class="builtintype" id="2270197">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2270203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270207">j</span>&nbsp;<span class="op" id="2270209">:=</span>&nbsp;<span class="ident" id="2270212">int64</span><span class="op" id="2270217">(</span><span class="ident" id="2270218">x</span>&nbsp;<span class="op" id="2270220">*</span>&nbsp;<span class="ident" id="2270222">M4PI</span><span class="op" id="2270226">)</span>&nbsp;<span class="comment" id="2270228">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270298">y</span>&nbsp;<span class="op" id="2270300">:=</span>&nbsp;<span class="builtintype" id="2270303">float64</span><span class="op" id="2270310">(</span><span class="ident" id="2270311">j</span><span class="op" id="2270312">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2270319">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2270359">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270383">if</span>&nbsp;<span class="ident" id="2270386">j</span><span class="op" id="2270387">&amp;</span><span class="num" id="2270388">1</span>&nbsp;<span class="op" id="2270390">==</span>&nbsp;<span class="num" id="2270393">1</span>&nbsp;<span class="op" id="2270395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270399">j</span>&nbsp;<span class="op" id="2270401">+=</span>&nbsp;<span class="num" id="2270404">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270408">y</span>&nbsp;<span class="op" id="2270410">+=</span>&nbsp;<span class="num" id="2270413">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2270416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270419">j</span>&nbsp;<span class="op" id="2270421">&amp;=</span>&nbsp;<span class="num" id="2270424">7</span>&nbsp;<span class="comment" id="2270426">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2270470">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270492">if</span>&nbsp;<span class="ident" id="2270495">j</span>&nbsp;<span class="op" id="2270497">&gt;</span>&nbsp;<span class="num" id="2270499">3</span>&nbsp;<span class="op" id="2270501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270505">sign</span>&nbsp;<span class="op" id="2270510">=</span>&nbsp;<span class="op" id="2270512">!</span><span class="ident" id="2270513">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270520">j</span>&nbsp;<span class="op" id="2270522">-=</span>&nbsp;<span class="num" id="2270525">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2270528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270532">z</span>&nbsp;<span class="op" id="2270534">:=</span>&nbsp;<span class="op" id="2270537">(</span><span class="op" id="2270538">(</span><span class="ident" id="2270539">x</span>&nbsp;<span class="op" id="2270541">-</span>&nbsp;<span class="ident" id="2270543">y</span><span class="op" id="2270544">*</span><span class="ident" id="2270545">PI4A</span><span class="op" id="2270549">)</span>&nbsp;<span class="op" id="2270551">-</span>&nbsp;<span class="ident" id="2270553">y</span><span class="op" id="2270554">*</span><span class="ident" id="2270555">PI4B</span><span class="op" id="2270559">)</span>&nbsp;<span class="op" id="2270561">-</span>&nbsp;<span class="ident" id="2270563">y</span><span class="op" id="2270564">*</span><span class="ident" id="2270565">PI4C</span>&nbsp;<span class="comment" id="2270570">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270612">zz</span>&nbsp;<span class="op" id="2270615">:=</span>&nbsp;<span class="ident" id="2270618">z</span>&nbsp;<span class="op" id="2270620">*</span>&nbsp;<span class="ident" id="2270622">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270625">if</span>&nbsp;<span class="ident" id="2270628">j</span>&nbsp;<span class="op" id="2270630">==</span>&nbsp;<span class="num" id="2270633">1</span>&nbsp;<span class="op" id="2270635">||</span>&nbsp;<span class="ident" id="2270638">j</span>&nbsp;<span class="op" id="2270640">==</span>&nbsp;<span class="num" id="2270643">2</span>&nbsp;<span class="op" id="2270645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270649">y</span>&nbsp;<span class="op" id="2270651">=</span>&nbsp;<span class="num" id="2270653">1.0</span>&nbsp;<span class="op" id="2270657">-</span>&nbsp;<span class="num" id="2270659">0.5</span><span class="op" id="2270662">*</span><span class="ident" id="2270663">zz</span>&nbsp;<span class="op" id="2270666">+</span>&nbsp;<span class="ident" id="2270668">zz</span><span class="op" id="2270670">*</span><span class="ident" id="2270671">zz</span><span class="op" id="2270673">*</span><span class="op" id="2270674">(</span><span class="op" id="2270675">(</span><span class="op" id="2270676">(</span><span class="op" id="2270677">(</span><span class="op" id="2270678">(</span><span class="op" id="2270679">(</span><span class="ident" id="2270680">_cos</span><span class="op" id="2270684">[</span><span class="num" id="2270685">0</span><span class="op" id="2270686">]</span><span class="op" id="2270687">*</span><span class="ident" id="2270688">zz</span><span class="op" id="2270690">)</span><span class="op" id="2270691">+</span><span class="ident" id="2270692">_cos</span><span class="op" id="2270696">[</span><span class="num" id="2270697">1</span><span class="op" id="2270698">]</span><span class="op" id="2270699">)</span><span class="op" id="2270700">*</span><span class="ident" id="2270701">zz</span><span class="op" id="2270703">+</span><span class="ident" id="2270704">_cos</span><span class="op" id="2270708">[</span><span class="num" id="2270709">2</span><span class="op" id="2270710">]</span><span class="op" id="2270711">)</span><span class="op" id="2270712">*</span><span class="ident" id="2270713">zz</span><span class="op" id="2270715">+</span><span class="ident" id="2270716">_cos</span><span class="op" id="2270720">[</span><span class="num" id="2270721">3</span><span class="op" id="2270722">]</span><span class="op" id="2270723">)</span><span class="op" id="2270724">*</span><span class="ident" id="2270725">zz</span><span class="op" id="2270727">+</span><span class="ident" id="2270728">_cos</span><span class="op" id="2270732">[</span><span class="num" id="2270733">4</span><span class="op" id="2270734">]</span><span class="op" id="2270735">)</span><span class="op" id="2270736">*</span><span class="ident" id="2270737">zz</span><span class="op" id="2270739">+</span><span class="ident" id="2270740">_cos</span><span class="op" id="2270744">[</span><span class="num" id="2270745">5</span><span class="op" id="2270746">]</span><span class="op" id="2270747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2270750">}</span>&nbsp;<span class="keyword" id="2270752">else</span>&nbsp;<span class="op" id="2270757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270761">y</span>&nbsp;<span class="op" id="2270763">=</span>&nbsp;<span class="ident" id="2270765">z</span>&nbsp;<span class="op" id="2270767">+</span>&nbsp;<span class="ident" id="2270769">z</span><span class="op" id="2270770">*</span><span class="ident" id="2270771">zz</span><span class="op" id="2270773">*</span><span class="op" id="2270774">(</span><span class="op" id="2270775">(</span><span class="op" id="2270776">(</span><span class="op" id="2270777">(</span><span class="op" id="2270778">(</span><span class="op" id="2270779">(</span><span class="ident" id="2270780">_sin</span><span class="op" id="2270784">[</span><span class="num" id="2270785">0</span><span class="op" id="2270786">]</span><span class="op" id="2270787">*</span><span class="ident" id="2270788">zz</span><span class="op" id="2270790">)</span><span class="op" id="2270791">+</span><span class="ident" id="2270792">_sin</span><span class="op" id="2270796">[</span><span class="num" id="2270797">1</span><span class="op" id="2270798">]</span><span class="op" id="2270799">)</span><span class="op" id="2270800">*</span><span class="ident" id="2270801">zz</span><span class="op" id="2270803">+</span><span class="ident" id="2270804">_sin</span><span class="op" id="2270808">[</span><span class="num" id="2270809">2</span><span class="op" id="2270810">]</span><span class="op" id="2270811">)</span><span class="op" id="2270812">*</span><span class="ident" id="2270813">zz</span><span class="op" id="2270815">+</span><span class="ident" id="2270816">_sin</span><span class="op" id="2270820">[</span><span class="num" id="2270821">3</span><span class="op" id="2270822">]</span><span class="op" id="2270823">)</span><span class="op" id="2270824">*</span><span class="ident" id="2270825">zz</span><span class="op" id="2270827">+</span><span class="ident" id="2270828">_sin</span><span class="op" id="2270832">[</span><span class="num" id="2270833">4</span><span class="op" id="2270834">]</span><span class="op" id="2270835">)</span><span class="op" id="2270836">*</span><span class="ident" id="2270837">zz</span><span class="op" id="2270839">+</span><span class="ident" id="2270840">_sin</span><span class="op" id="2270844">[</span><span class="num" id="2270845">5</span><span class="op" id="2270846">]</span><span class="op" id="2270847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2270850">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270853">if</span>&nbsp;<span class="ident" id="2270856">sign</span>&nbsp;<span class="op" id="2270861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2270865">y</span>&nbsp;<span class="op" id="2270867">=</span>&nbsp;<span class="op" id="2270869">-</span><span class="ident" id="2270870">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2270873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2270876">return</span>&nbsp;<span class="ident" id="2270883">y</span><br>
<span class="lineno"></span><span class="op" id="2270885">}</span>
</div>
</body>
</html>
