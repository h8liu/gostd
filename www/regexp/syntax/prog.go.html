<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5282140">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5282195">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5282249">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5282300">package</span>&nbsp;<span class="ident" id="5282308">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5282316">import</span>&nbsp;<span class="op" id="5282323">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282326">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282335">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282346">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="5282356">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5282359">//&nbsp;Compiled&nbsp;program.</span><br>
<span class="lineno"></span><span class="comment" id="5282380">//&nbsp;May&nbsp;not&nbsp;belong&nbsp;in&nbsp;this&nbsp;package,&nbsp;but&nbsp;convenient&nbsp;for&nbsp;now.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5282440">//&nbsp;A&nbsp;Prog&nbsp;is&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="5282492">type</span>&nbsp;<span class="ident" id="5282497">Prog</span>&nbsp;<span class="keyword" id="5282502">struct</span>&nbsp;<span class="op" id="5282509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282512">Inst</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5282519">[</span><span class="op" id="5282520">]</span><span class="ident" id="5282521">Inst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282527">Start</span>&nbsp;&nbsp;<span class="builtintype" id="5282534">int</span>&nbsp;<span class="comment" id="5282538">//&nbsp;index&nbsp;of&nbsp;start&nbsp;instruction</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282569">NumCap</span>&nbsp;<span class="builtintype" id="5282576">int</span>&nbsp;<span class="comment" id="5282580">//&nbsp;number&nbsp;of&nbsp;InstCapture&nbsp;insts&nbsp;in&nbsp;re</span><br>
<span class="lineno"></span><span class="op" id="5282617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5282620">//&nbsp;An&nbsp;InstOp&nbsp;is&nbsp;an&nbsp;instruction&nbsp;opcode.</span><br>
<span class="lineno"></span><span class="keyword" id="5282659">type</span>&nbsp;<span class="ident" id="5282664">InstOp</span>&nbsp;<span class="builtintype" id="5282671">uint8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="5282678">const</span>&nbsp;<span class="op" id="5282684">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282687">InstAlt</span>&nbsp;<span class="ident" id="5282695">InstOp</span>&nbsp;<span class="op" id="5282702">=</span>&nbsp;<span class="ident" id="5282704">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282710">InstAltMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282724">InstCapture</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282737">InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282753">InstMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282764">InstFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282774">InstNop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282783">InstRune</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282793">InstRune1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282804">InstRuneAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5282817">InstRuneAnyNotNL</span><br>
<span class="lineno"></span><span class="op" id="5282834">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="5282837">var</span>&nbsp;<span class="ident" id="5282841">instOpNames</span>&nbsp;<span class="op" id="5282853">=</span>&nbsp;<span class="op" id="5282855">[</span><span class="op" id="5282856">]</span><span class="builtintype" id="5282857">string</span><span class="op" id="5282863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282866">&#34;InstAlt&#34;</span><span class="op" id="5282875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282878">&#34;InstAltMatch&#34;</span><span class="op" id="5282892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282895">&#34;InstCapture&#34;</span><span class="op" id="5282908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282911">&#34;InstEmptyWidth&#34;</span><span class="op" id="5282927">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282930">&#34;InstMatch&#34;</span><span class="op" id="5282941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282944">&#34;InstFail&#34;</span><span class="op" id="5282954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282957">&#34;InstNop&#34;</span><span class="op" id="5282966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282969">&#34;InstRune&#34;</span><span class="op" id="5282979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282982">&#34;InstRune1&#34;</span><span class="op" id="5282993">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5282996">&#34;InstRuneAny&#34;</span><span class="op" id="5283009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5283012">&#34;InstRuneAnyNotNL&#34;</span><span class="op" id="5283030">,</span><br>
<span class="lineno"></span><span class="op" id="5283032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5283035">func</span>&nbsp;<span class="op" id="5283040">(</span><span class="ident" id="5283041">i</span>&nbsp;<span class="ident" id="5283043">InstOp</span><span class="op" id="5283049">)</span>&nbsp;<span class="ident" id="5283051">String</span><span class="op" id="5283057">(</span><span class="op" id="5283058">)</span>&nbsp;<span class="builtintype" id="5283060">string</span>&nbsp;<span class="op" id="5283067">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283070">if</span>&nbsp;<span class="builtintype" id="5283073">uint</span><span class="op" id="5283077">(</span><span class="ident" id="5283078">i</span><span class="op" id="5283079">)</span>&nbsp;<span class="op" id="5283081">&gt;=</span>&nbsp;<span class="builtintype" id="5283084">uint</span><span class="op" id="5283088">(</span><span class="builtinfunc" id="5283089">len</span><span class="op" id="5283092">(</span><span class="ident" id="5283093">instOpNames</span><span class="op" id="5283104">)</span><span class="op" id="5283105">)</span>&nbsp;<span class="op" id="5283107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283111">return</span>&nbsp;<span class="string" id="5283118">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5283122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283125">return</span>&nbsp;<span class="ident" id="5283132">instOpNames</span><span class="op" id="5283143">[</span><span class="ident" id="5283144">i</span><span class="op" id="5283145">]</span><br>
<span class="lineno"></span><span class="op" id="5283147">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5283150">//&nbsp;An&nbsp;EmptyOp&nbsp;specifies&nbsp;a&nbsp;kind&nbsp;or&nbsp;mixture&nbsp;of&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="keyword" id="5283218">type</span>&nbsp;<span class="ident" id="5283223">EmptyOp</span>&nbsp;<span class="builtintype" id="5283231">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5283238">const</span>&nbsp;<span class="op" id="5283244">(</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283247">EmptyBeginLine</span>&nbsp;<span class="ident" id="5283262">EmptyOp</span>&nbsp;<span class="op" id="5283270">=</span>&nbsp;<span class="num" id="5283272">1</span>&nbsp;<span class="op" id="5283274">&lt;&lt;</span>&nbsp;<span class="ident" id="5283277">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283283">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283297">EmptyBeginText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283313">EmptyEndText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283327">EmptyWordBoundary</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283346">EmptyNoWordBoundary</span><br>
<span class="lineno"></span><span class="op" id="5283366">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5283369">//&nbsp;EmptyOpContext&nbsp;returns&nbsp;the&nbsp;zero-width&nbsp;assertions</span><br>
<span class="lineno"></span><span class="comment" id="5283421">//&nbsp;satisfied&nbsp;at&nbsp;the&nbsp;position&nbsp;between&nbsp;the&nbsp;runes&nbsp;r1&nbsp;and&nbsp;r2.</span><br>
<span class="lineno">75</span><span class="comment" id="5283479">//&nbsp;Passing&nbsp;r1&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5283530">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5283563">//&nbsp;Passing&nbsp;r2&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5283614">//&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="5283641">func</span>&nbsp;<span class="ident" id="5283646">EmptyOpContext</span><span class="op" id="5283660">(</span><span class="ident" id="5283661">r1</span><span class="op" id="5283663">,</span>&nbsp;<span class="ident" id="5283665">r2</span>&nbsp;<span class="builtintype" id="5283668">rune</span><span class="op" id="5283672">)</span>&nbsp;<span class="ident" id="5283674">EmptyOp</span>&nbsp;<span class="op" id="5283682">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283685">var</span>&nbsp;<span class="ident" id="5283689">op</span>&nbsp;<span class="ident" id="5283692">EmptyOp</span>&nbsp;<span class="op" id="5283700">=</span>&nbsp;<span class="ident" id="5283702">EmptyNoWordBoundary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283723">var</span>&nbsp;<span class="ident" id="5283727">boundary</span>&nbsp;<span class="builtintype" id="5283736">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283742">switch</span>&nbsp;<span class="op" id="5283749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283752">case</span>&nbsp;<span class="ident" id="5283757">IsWordChar</span><span class="op" id="5283767">(</span><span class="ident" id="5283768">r1</span><span class="op" id="5283770">)</span><span class="op" id="5283771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283775">boundary</span>&nbsp;<span class="op" id="5283784">=</span>&nbsp;<span class="num" id="5283786">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283789">case</span>&nbsp;<span class="ident" id="5283794">r1</span>&nbsp;<span class="op" id="5283797">==</span>&nbsp;<span class="string" id="5283800">&#39;\n&#39;</span><span class="op" id="5283804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283808">op</span>&nbsp;<span class="op" id="5283811">|=</span>&nbsp;<span class="ident" id="5283814">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283830">case</span>&nbsp;<span class="ident" id="5283835">r1</span>&nbsp;<span class="op" id="5283838">&lt;</span>&nbsp;<span class="num" id="5283840">0</span><span class="op" id="5283841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283845">op</span>&nbsp;<span class="op" id="5283848">|=</span>&nbsp;<span class="ident" id="5283851">EmptyBeginText</span>&nbsp;<span class="op" id="5283866">|</span>&nbsp;<span class="ident" id="5283868">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5283884">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283887">switch</span>&nbsp;<span class="op" id="5283894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283897">case</span>&nbsp;<span class="ident" id="5283902">IsWordChar</span><span class="op" id="5283912">(</span><span class="ident" id="5283913">r2</span><span class="op" id="5283915">)</span><span class="op" id="5283916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283920">boundary</span>&nbsp;<span class="op" id="5283929">^=</span>&nbsp;<span class="num" id="5283932">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283935">case</span>&nbsp;<span class="ident" id="5283940">r2</span>&nbsp;<span class="op" id="5283943">==</span>&nbsp;<span class="string" id="5283946">&#39;\n&#39;</span><span class="op" id="5283950">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283954">op</span>&nbsp;<span class="op" id="5283957">|=</span>&nbsp;<span class="ident" id="5283960">EmptyEndLine</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5283974">case</span>&nbsp;<span class="ident" id="5283979">r2</span>&nbsp;<span class="op" id="5283982">&lt;</span>&nbsp;<span class="num" id="5283984">0</span><span class="op" id="5283985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5283989">op</span>&nbsp;<span class="op" id="5283992">|=</span>&nbsp;<span class="ident" id="5283995">EmptyEndText</span>&nbsp;<span class="op" id="5284008">|</span>&nbsp;<span class="ident" id="5284010">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5284024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5284027">if</span>&nbsp;<span class="ident" id="5284030">boundary</span>&nbsp;<span class="op" id="5284039">!=</span>&nbsp;<span class="num" id="5284042">0</span>&nbsp;<span class="op" id="5284044">{</span>&nbsp;<span class="comment" id="5284046">//&nbsp;IsWordChar(r1)&nbsp;!=&nbsp;IsWordChar(r2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5284084">op</span>&nbsp;<span class="op" id="5284087">^=</span>&nbsp;<span class="op" id="5284090">(</span><span class="ident" id="5284091">EmptyWordBoundary</span>&nbsp;<span class="op" id="5284109">|</span>&nbsp;<span class="ident" id="5284111">EmptyNoWordBoundary</span><span class="op" id="5284130">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5284133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5284136">return</span>&nbsp;<span class="ident" id="5284143">op</span><br>
<span class="lineno"></span><span class="op" id="5284146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5284149">//&nbsp;IsWordChar&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;consider&nbsp;a&nbsp;``word&nbsp;character&#39;&#39;</span><br>
<span class="lineno">105</span><span class="comment" id="5284214">//&nbsp;during&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;the&nbsp;\b&nbsp;and&nbsp;\B&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="comment" id="5284279">//&nbsp;These&nbsp;assertions&nbsp;are&nbsp;ASCII-only:&nbsp;the&nbsp;word&nbsp;characters&nbsp;are&nbsp;[A-Za-z0-9_].</span><br>
<span class="lineno"></span><span class="keyword" id="5284353">func</span>&nbsp;<span class="ident" id="5284358">IsWordChar</span><span class="op" id="5284368">(</span><span class="ident" id="5284369">r</span>&nbsp;<span class="builtintype" id="5284371">rune</span><span class="op" id="5284375">)</span>&nbsp;<span class="builtintype" id="5284377">bool</span>&nbsp;<span class="op" id="5284382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5284385">return</span>&nbsp;<span class="string" id="5284392">&#39;A&#39;</span>&nbsp;<span class="op" id="5284396">&lt;=</span>&nbsp;<span class="ident" id="5284399">r</span>&nbsp;<span class="op" id="5284401">&amp;&amp;</span>&nbsp;<span class="ident" id="5284404">r</span>&nbsp;<span class="op" id="5284406">&lt;=</span>&nbsp;<span class="string" id="5284409">&#39;Z&#39;</span>&nbsp;<span class="op" id="5284413">||</span>&nbsp;<span class="string" id="5284416">&#39;a&#39;</span>&nbsp;<span class="op" id="5284420">&lt;=</span>&nbsp;<span class="ident" id="5284423">r</span>&nbsp;<span class="op" id="5284425">&amp;&amp;</span>&nbsp;<span class="ident" id="5284428">r</span>&nbsp;<span class="op" id="5284430">&lt;=</span>&nbsp;<span class="string" id="5284433">&#39;z&#39;</span>&nbsp;<span class="op" id="5284437">||</span>&nbsp;<span class="string" id="5284440">&#39;0&#39;</span>&nbsp;<span class="op" id="5284444">&lt;=</span>&nbsp;<span class="ident" id="5284447">r</span>&nbsp;<span class="op" id="5284449">&amp;&amp;</span>&nbsp;<span class="ident" id="5284452">r</span>&nbsp;<span class="op" id="5284454">&lt;=</span>&nbsp;<span class="string" id="5284457">&#39;9&#39;</span>&nbsp;<span class="op" id="5284461">||</span>&nbsp;<span class="ident" id="5284464">r</span>&nbsp;<span class="op" id="5284466">==</span>&nbsp;<span class="string" id="5284469">&#39;_&#39;</span><br>
<span class="lineno"></span><span class="op" id="5284473">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5284476">//&nbsp;An&nbsp;Inst&nbsp;is&nbsp;a&nbsp;single&nbsp;instruction&nbsp;in&nbsp;a&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="5284544">type</span>&nbsp;<span class="ident" id="5284549">Inst</span>&nbsp;<span class="keyword" id="5284554">struct</span>&nbsp;<span class="op" id="5284561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5284564">Op</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5284569">InstOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5284577">Out</span>&nbsp;&nbsp;<span class="builtintype" id="5284582">uint32</span>&nbsp;<span class="comment" id="5284589">//&nbsp;all&nbsp;but&nbsp;InstMatch,&nbsp;InstFail</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5284621">Arg</span>&nbsp;&nbsp;<span class="builtintype" id="5284626">uint32</span>&nbsp;<span class="comment" id="5284633">//&nbsp;InstAlt,&nbsp;InstAltMatch,&nbsp;InstCapture,&nbsp;InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5284688">Rune</span>&nbsp;<span class="op" id="5284693">[</span><span class="op" id="5284694">]</span><span class="builtintype" id="5284695">rune</span><br>
<span class="lineno"></span><span class="op" id="5284700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5284703">func</span>&nbsp;<span class="op" id="5284708">(</span><span class="ident" id="5284709">p</span>&nbsp;<span class="op" id="5284711">*</span><span class="ident" id="5284712">Prog</span><span class="op" id="5284716">)</span>&nbsp;<span class="ident" id="5284718">String</span><span class="op" id="5284724">(</span><span class="op" id="5284725">)</span>&nbsp;<span class="builtintype" id="5284727">string</span>&nbsp;<span class="op" id="5284734">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5284737">var</span>&nbsp;<span class="ident" id="5284741">b</span>&nbsp;<span class="ident" id="5284743">bytes</span><span class="op" id="5284748">.</span><span class="ident" id="5284749">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5284757">dumpProg</span><span class="op" id="5284765">(</span><span class="op" id="5284766">&amp;</span><span class="ident" id="5284767">b</span><span class="op" id="5284768">,</span>&nbsp;<span class="ident" id="5284770">p</span><span class="op" id="5284771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5284774">return</span>&nbsp;<span class="ident" id="5284781">b</span><span class="op" id="5284782">.</span><span class="ident" id="5284783">String</span><span class="op" id="5284789">(</span><span class="op" id="5284790">)</span><br>
<span class="lineno"></span><span class="op" id="5284792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5284795">//&nbsp;skipNop&nbsp;follows&nbsp;any&nbsp;no-op&nbsp;or&nbsp;capturing&nbsp;instructions</span><br>
<span class="lineno"></span><span class="comment" id="5284850">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;pc.</span><br>
<span class="lineno"></span><span class="keyword" id="5284883">func</span>&nbsp;<span class="op" id="5284888">(</span><span class="ident" id="5284889">p</span>&nbsp;<span class="op" id="5284891">*</span><span class="ident" id="5284892">Prog</span><span class="op" id="5284896">)</span>&nbsp;<span class="ident" id="5284898">skipNop</span><span class="op" id="5284905">(</span><span class="ident" id="5284906">pc</span>&nbsp;<span class="builtintype" id="5284909">uint32</span><span class="op" id="5284915">)</span>&nbsp;<span class="op" id="5284917">(</span><span class="op" id="5284918">*</span><span class="ident" id="5284919">Inst</span><span class="op" id="5284923">,</span>&nbsp;<span class="builtintype" id="5284925">uint32</span><span class="op" id="5284931">)</span>&nbsp;<span class="op" id="5284933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5284936">i</span>&nbsp;<span class="op" id="5284938">:=</span>&nbsp;<span class="op" id="5284941">&amp;</span><span class="ident" id="5284942">p</span><span class="op" id="5284943">.</span><span class="ident" id="5284944">Inst</span><span class="op" id="5284948">[</span><span class="ident" id="5284949">pc</span><span class="op" id="5284951">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5284954">for</span>&nbsp;<span class="ident" id="5284958">i</span><span class="op" id="5284959">.</span><span class="ident" id="5284960">Op</span>&nbsp;<span class="op" id="5284963">==</span>&nbsp;<span class="ident" id="5284966">InstNop</span>&nbsp;<span class="op" id="5284974">||</span>&nbsp;<span class="ident" id="5284977">i</span><span class="op" id="5284978">.</span><span class="ident" id="5284979">Op</span>&nbsp;<span class="op" id="5284982">==</span>&nbsp;<span class="ident" id="5284985">InstCapture</span>&nbsp;<span class="op" id="5284997">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5285001">pc</span>&nbsp;<span class="op" id="5285004">=</span>&nbsp;<span class="ident" id="5285006">i</span><span class="op" id="5285007">.</span><span class="ident" id="5285008">Out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5285014">i</span>&nbsp;<span class="op" id="5285016">=</span>&nbsp;<span class="op" id="5285018">&amp;</span><span class="ident" id="5285019">p</span><span class="op" id="5285020">.</span><span class="ident" id="5285021">Inst</span><span class="op" id="5285025">[</span><span class="ident" id="5285026">pc</span><span class="op" id="5285028">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5285031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5285034">return</span>&nbsp;<span class="ident" id="5285041">i</span><span class="op" id="5285042">,</span>&nbsp;<span class="ident" id="5285044">pc</span><br>
<span class="lineno"></span><span class="op" id="5285047">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="5285050">//&nbsp;op&nbsp;returns&nbsp;i.Op&nbsp;but&nbsp;merges&nbsp;all&nbsp;the&nbsp;Rune&nbsp;special&nbsp;cases&nbsp;into&nbsp;InstRune</span><br>
<span class="lineno"></span><span class="keyword" id="5285121">func</span>&nbsp;<span class="op" id="5285126">(</span><span class="ident" id="5285127">i</span>&nbsp;<span class="op" id="5285129">*</span><span class="ident" id="5285130">Inst</span><span class="op" id="5285134">)</span>&nbsp;<span class="ident" id="5285136">op</span><span class="op" id="5285138">(</span><span class="op" id="5285139">)</span>&nbsp;<span class="ident" id="5285141">InstOp</span>&nbsp;<span class="op" id="5285148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5285151">op</span>&nbsp;<span class="op" id="5285154">:=</span>&nbsp;<span class="ident" id="5285157">i</span><span class="op" id="5285158">.</span><span class="ident" id="5285159">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5285163">switch</span>&nbsp;<span class="ident" id="5285170">op</span>&nbsp;<span class="op" id="5285173">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5285176">case</span>&nbsp;<span class="ident" id="5285181">InstRune1</span><span class="op" id="5285190">,</span>&nbsp;<span class="ident" id="5285192">InstRuneAny</span><span class="op" id="5285203">,</span>&nbsp;<span class="ident" id="5285205">InstRuneAnyNotNL</span><span class="op" id="5285221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5285225">op</span>&nbsp;<span class="op" id="5285228">=</span>&nbsp;<span class="ident" id="5285230">InstRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5285240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5285243">return</span>&nbsp;<span class="ident" id="5285250">op</span><br>
<span class="lineno"></span><span class="op" id="5285253">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="5285256">//&nbsp;Prefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;all&nbsp;matches&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5285316">//&nbsp;regexp&nbsp;must&nbsp;start&nbsp;with.&nbsp;&nbsp;Complete&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="5285375">//&nbsp;is&nbsp;the&nbsp;entire&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5285399">func</span>&nbsp;<span class="op" id="5285404">(</span><span class="ident" id="5285405">p</span>&nbsp;<span class="op" id="5285407">*</span><span class="ident" id="5285408">Prog</span><span class="op" id="5285412">)</span>&nbsp;<span class="ident" id="5285414">Prefix</span><span class="op" id="5285420">(</span><span class="op" id="5285421">)</span>&nbsp;<span class="op" id="5285423">(</span><span class="ident" id="5285424">prefix</span>&nbsp;<span class="builtintype" id="5285431">string</span><span class="op" id="5285437">,</span>&nbsp;<span class="ident" id="5285439">complete</span>&nbsp;<span class="builtintype" id="5285448">bool</span><span class="op" id="5285452">)</span>&nbsp;<span class="op" id="5285454">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5285457">i</span><span class="op" id="5285458">,</span>&nbsp;<span class="ident" id="5285460">_</span>&nbsp;<span class="op" id="5285462">:=</span>&nbsp;<span class="ident" id="5285465">p</span><span class="op" id="5285466">.</span><span class="ident" id="5285467">skipNop</span><span class="op" id="5285474">(</span><span class="builtintype" id="5285475">uint32</span><span class="op" id="5285481">(</span><span class="ident" id="5285482">p</span><span class="op" id="5285483">.</span><span class="ident" id="5285484">Start</span><span class="op" id="5285489">)</span><span class="op" id="5285490">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5285494">//&nbsp;Avoid&nbsp;allocation&nbsp;of&nbsp;buffer&nbsp;if&nbsp;prefix&nbsp;is&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5285545">if</span>&nbsp;<span class="ident" id="5285548">i</span><span class="op" id="5285549">.</span><span class="ident" id="5285550">op</span><span class="op" id="5285552">(</span><span class="op" id="5285553">)</span>&nbsp;<span class="op" id="5285555">!=</span>&nbsp;<span class="ident" id="5285558">InstRune</span>&nbsp;<span class="op" id="5285567">||</span>&nbsp;<span class="builtinfunc" id="5285570">len</span><span class="op" id="5285573">(</span><span class="ident" id="5285574">i</span><span class="op" id="5285575">.</span><span class="ident" id="5285576">Rune</span><span class="op" id="5285580">)</span>&nbsp;<span class="op" id="5285582">!=</span>&nbsp;<span class="num" id="5285585">1</span>&nbsp;<span class="op" id="5285587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5285591">return</span>&nbsp;<span class="string" id="5285598">&#34;&#34;</span><span class="op" id="5285600">,</span>&nbsp;<span class="ident" id="5285602">i</span><span class="op" id="5285603">.</span><span class="ident" id="5285604">Op</span>&nbsp;<span class="op" id="5285607">==</span>&nbsp;<span class="ident" id="5285610">InstMatch</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5285621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5285625">//&nbsp;Have&nbsp;prefix;&nbsp;gather&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5285661">var</span>&nbsp;<span class="ident" id="5285665">buf</span>&nbsp;<span class="ident" id="5285669">bytes</span><span class="op" id="5285674">.</span><span class="ident" id="5285675">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5285683">for</span>&nbsp;<span class="ident" id="5285687">i</span><span class="op" id="5285688">.</span><span class="ident" id="5285689">op</span><span class="op" id="5285691">(</span><span class="op" id="5285692">)</span>&nbsp;<span class="op" id="5285694">==</span>&nbsp;<span class="ident" id="5285697">InstRune</span>&nbsp;<span class="op" id="5285706">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5285709">len</span><span class="op" id="5285712">(</span><span class="ident" id="5285713">i</span><span class="op" id="5285714">.</span><span class="ident" id="5285715">Rune</span><span class="op" id="5285719">)</span>&nbsp;<span class="op" id="5285721">==</span>&nbsp;<span class="num" id="5285724">1</span>&nbsp;<span class="op" id="5285726">&amp;&amp;</span>&nbsp;<span class="ident" id="5285729">Flags</span><span class="op" id="5285734">(</span><span class="ident" id="5285735">i</span><span class="op" id="5285736">.</span><span class="ident" id="5285737">Arg</span><span class="op" id="5285740">)</span><span class="op" id="5285741">&amp;</span><span class="ident" id="5285742">FoldCase</span>&nbsp;<span class="op" id="5285751">==</span>&nbsp;<span class="num" id="5285754">0</span>&nbsp;<span class="op" id="5285756">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5285760">buf</span><span class="op" id="5285763">.</span><span class="ident" id="5285764">WriteRune</span><span class="op" id="5285773">(</span><span class="ident" id="5285774">i</span><span class="op" id="5285775">.</span><span class="ident" id="5285776">Rune</span><span class="op" id="5285780">[</span><span class="num" id="5285781">0</span><span class="op" id="5285782">]</span><span class="op" id="5285783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5285787">i</span><span class="op" id="5285788">,</span>&nbsp;<span class="ident" id="5285790">_</span>&nbsp;<span class="op" id="5285792">=</span>&nbsp;<span class="ident" id="5285794">p</span><span class="op" id="5285795">.</span><span class="ident" id="5285796">skipNop</span><span class="op" id="5285803">(</span><span class="ident" id="5285804">i</span><span class="op" id="5285805">.</span><span class="ident" id="5285806">Out</span><span class="op" id="5285809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5285812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5285815">return</span>&nbsp;<span class="ident" id="5285822">buf</span><span class="op" id="5285825">.</span><span class="ident" id="5285826">String</span><span class="op" id="5285832">(</span><span class="op" id="5285833">)</span><span class="op" id="5285834">,</span>&nbsp;<span class="ident" id="5285836">i</span><span class="op" id="5285837">.</span><span class="ident" id="5285838">Op</span>&nbsp;<span class="op" id="5285841">==</span>&nbsp;<span class="ident" id="5285844">InstMatch</span><br>
<span class="lineno"></span><span class="op" id="5285854">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="5285857">//&nbsp;StartCond&nbsp;returns&nbsp;the&nbsp;leading&nbsp;empty-width&nbsp;conditions&nbsp;that&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="5285923">//&nbsp;be&nbsp;true&nbsp;in&nbsp;any&nbsp;match.&nbsp;&nbsp;It&nbsp;returns&nbsp;^EmptyOp(0)&nbsp;if&nbsp;no&nbsp;matches&nbsp;are&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="5286000">func</span>&nbsp;<span class="op" id="5286005">(</span><span class="ident" id="5286006">p</span>&nbsp;<span class="op" id="5286008">*</span><span class="ident" id="5286009">Prog</span><span class="op" id="5286013">)</span>&nbsp;<span class="ident" id="5286015">StartCond</span><span class="op" id="5286024">(</span><span class="op" id="5286025">)</span>&nbsp;<span class="ident" id="5286027">EmptyOp</span>&nbsp;<span class="op" id="5286035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286038">var</span>&nbsp;<span class="ident" id="5286042">flag</span>&nbsp;<span class="ident" id="5286047">EmptyOp</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5286056">pc</span>&nbsp;<span class="op" id="5286059">:=</span>&nbsp;<span class="builtintype" id="5286062">uint32</span><span class="op" id="5286068">(</span><span class="ident" id="5286069">p</span><span class="op" id="5286070">.</span><span class="ident" id="5286071">Start</span><span class="op" id="5286076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5286079">i</span>&nbsp;<span class="op" id="5286081">:=</span>&nbsp;<span class="op" id="5286084">&amp;</span><span class="ident" id="5286085">p</span><span class="op" id="5286086">.</span><span class="ident" id="5286087">Inst</span><span class="op" id="5286091">[</span><span class="ident" id="5286092">pc</span><span class="op" id="5286094">]</span><br>
<span class="lineno"></span><span class="ident" id="5286096">Loop</span><span class="op" id="5286100">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286103">for</span>&nbsp;<span class="op" id="5286107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286111">switch</span>&nbsp;<span class="ident" id="5286118">i</span><span class="op" id="5286119">.</span><span class="ident" id="5286120">Op</span>&nbsp;<span class="op" id="5286123">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286127">case</span>&nbsp;<span class="ident" id="5286132">InstEmptyWidth</span><span class="op" id="5286146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5286151">flag</span>&nbsp;<span class="op" id="5286156">|=</span>&nbsp;<span class="ident" id="5286159">EmptyOp</span><span class="op" id="5286166">(</span><span class="ident" id="5286167">i</span><span class="op" id="5286168">.</span><span class="ident" id="5286169">Arg</span><span class="op" id="5286172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286176">case</span>&nbsp;<span class="ident" id="5286181">InstFail</span><span class="op" id="5286189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286194">return</span>&nbsp;<span class="op" id="5286201">^</span><span class="ident" id="5286202">EmptyOp</span><span class="op" id="5286209">(</span><span class="num" id="5286210">0</span><span class="op" id="5286211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286215">case</span>&nbsp;<span class="ident" id="5286220">InstCapture</span><span class="op" id="5286231">,</span>&nbsp;<span class="ident" id="5286233">InstNop</span><span class="op" id="5286240">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5286245">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286255">default</span><span class="op" id="5286262">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286267">break</span>&nbsp;<span class="ident" id="5286273">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5286280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5286284">pc</span>&nbsp;<span class="op" id="5286287">=</span>&nbsp;<span class="ident" id="5286289">i</span><span class="op" id="5286290">.</span><span class="ident" id="5286291">Out</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5286297">i</span>&nbsp;<span class="op" id="5286299">=</span>&nbsp;<span class="op" id="5286301">&amp;</span><span class="ident" id="5286302">p</span><span class="op" id="5286303">.</span><span class="ident" id="5286304">Inst</span><span class="op" id="5286308">[</span><span class="ident" id="5286309">pc</span><span class="op" id="5286311">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5286314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286317">return</span>&nbsp;<span class="ident" id="5286324">flag</span><br>
<span class="lineno"></span><span class="op" id="5286329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="5286332">const</span>&nbsp;<span class="ident" id="5286338">noMatch</span>&nbsp;<span class="op" id="5286346">=</span>&nbsp;<span class="op" id="5286348">-</span><span class="num" id="5286349">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5286352">//&nbsp;MatchRune&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5286423">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="5286474">func</span>&nbsp;<span class="op" id="5286479">(</span><span class="ident" id="5286480">i</span>&nbsp;<span class="op" id="5286482">*</span><span class="ident" id="5286483">Inst</span><span class="op" id="5286487">)</span>&nbsp;<span class="ident" id="5286489">MatchRune</span><span class="op" id="5286498">(</span><span class="ident" id="5286499">r</span>&nbsp;<span class="builtintype" id="5286501">rune</span><span class="op" id="5286505">)</span>&nbsp;<span class="builtintype" id="5286507">bool</span>&nbsp;<span class="op" id="5286512">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286515">return</span>&nbsp;<span class="ident" id="5286522">i</span><span class="op" id="5286523">.</span><span class="ident" id="5286524">MatchRunePos</span><span class="op" id="5286536">(</span><span class="ident" id="5286537">r</span><span class="op" id="5286538">)</span>&nbsp;<span class="op" id="5286540">!=</span>&nbsp;<span class="ident" id="5286543">noMatch</span><br>
<span class="lineno"></span><span class="op" id="5286551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5286554">//&nbsp;MatchRunePos&nbsp;checks&nbsp;whether&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5286627">//&nbsp;If&nbsp;so,&nbsp;MatchRunePos&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;matching&nbsp;rune&nbsp;pair</span><br>
<span class="lineno">200</span><span class="comment" id="5286694">//&nbsp;(or,&nbsp;when&nbsp;len(i.Rune)&nbsp;==&nbsp;1,&nbsp;rune&nbsp;singleton).</span><br>
<span class="lineno"></span><span class="comment" id="5286742">//&nbsp;If&nbsp;not,&nbsp;MatchRunePos&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="comment" id="5286778">//&nbsp;MatchRunePos&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="5286839">func</span>&nbsp;<span class="op" id="5286844">(</span><span class="ident" id="5286845">i</span>&nbsp;<span class="op" id="5286847">*</span><span class="ident" id="5286848">Inst</span><span class="op" id="5286852">)</span>&nbsp;<span class="ident" id="5286854">MatchRunePos</span><span class="op" id="5286866">(</span><span class="ident" id="5286867">r</span>&nbsp;<span class="builtintype" id="5286869">rune</span><span class="op" id="5286873">)</span>&nbsp;<span class="builtintype" id="5286875">int</span>&nbsp;<span class="op" id="5286879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5286882">rune</span>&nbsp;<span class="op" id="5286887">:=</span>&nbsp;<span class="ident" id="5286890">i</span><span class="op" id="5286891">.</span><span class="ident" id="5286892">Rune</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5286899">//&nbsp;Special&nbsp;case:&nbsp;single-rune&nbsp;slice&nbsp;is&nbsp;from&nbsp;literal&nbsp;string,&nbsp;not&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5286975">if</span>&nbsp;<span class="builtinfunc" id="5286978">len</span><span class="op" id="5286981">(</span><span class="builtintype" id="5286982">rune</span><span class="op" id="5286986">)</span>&nbsp;<span class="op" id="5286988">==</span>&nbsp;<span class="num" id="5286991">1</span>&nbsp;<span class="op" id="5286993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5286997">r0</span>&nbsp;<span class="op" id="5287000">:=</span>&nbsp;<span class="builtintype" id="5287003">rune</span><span class="op" id="5287007">[</span><span class="num" id="5287008">0</span><span class="op" id="5287009">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287013">if</span>&nbsp;<span class="ident" id="5287016">r</span>&nbsp;<span class="op" id="5287018">==</span>&nbsp;<span class="ident" id="5287021">r0</span>&nbsp;<span class="op" id="5287024">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287029">return</span>&nbsp;<span class="num" id="5287036">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287044">if</span>&nbsp;<span class="ident" id="5287047">Flags</span><span class="op" id="5287052">(</span><span class="ident" id="5287053">i</span><span class="op" id="5287054">.</span><span class="ident" id="5287055">Arg</span><span class="op" id="5287058">)</span><span class="op" id="5287059">&amp;</span><span class="ident" id="5287060">FoldCase</span>&nbsp;<span class="op" id="5287069">!=</span>&nbsp;<span class="num" id="5287072">0</span>&nbsp;<span class="op" id="5287074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287079">for</span>&nbsp;<span class="ident" id="5287083">r1</span>&nbsp;<span class="op" id="5287086">:=</span>&nbsp;<span class="ident" id="5287089">unicode</span><span class="op" id="5287096">.</span><span class="ident" id="5287097">SimpleFold</span><span class="op" id="5287107">(</span><span class="ident" id="5287108">r0</span><span class="op" id="5287110">)</span><span class="op" id="5287111">;</span>&nbsp;<span class="ident" id="5287113">r1</span>&nbsp;<span class="op" id="5287116">!=</span>&nbsp;<span class="ident" id="5287119">r0</span><span class="op" id="5287121">;</span>&nbsp;<span class="ident" id="5287123">r1</span>&nbsp;<span class="op" id="5287126">=</span>&nbsp;<span class="ident" id="5287128">unicode</span><span class="op" id="5287135">.</span><span class="ident" id="5287136">SimpleFold</span><span class="op" id="5287146">(</span><span class="ident" id="5287147">r1</span><span class="op" id="5287149">)</span>&nbsp;<span class="op" id="5287151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287157">if</span>&nbsp;<span class="ident" id="5287160">r</span>&nbsp;<span class="op" id="5287162">==</span>&nbsp;<span class="ident" id="5287165">r1</span>&nbsp;<span class="op" id="5287168">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287175">return</span>&nbsp;<span class="num" id="5287182">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287201">return</span>&nbsp;<span class="ident" id="5287208">noMatch</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5287221">//&nbsp;Peek&nbsp;at&nbsp;the&nbsp;first&nbsp;few&nbsp;pairs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5287254">//&nbsp;Should&nbsp;handle&nbsp;ASCII&nbsp;well.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287284">for</span>&nbsp;<span class="ident" id="5287288">j</span>&nbsp;<span class="op" id="5287290">:=</span>&nbsp;<span class="num" id="5287293">0</span><span class="op" id="5287294">;</span>&nbsp;<span class="ident" id="5287296">j</span>&nbsp;<span class="op" id="5287298">&lt;</span>&nbsp;<span class="builtinfunc" id="5287300">len</span><span class="op" id="5287303">(</span><span class="builtintype" id="5287304">rune</span><span class="op" id="5287308">)</span>&nbsp;<span class="op" id="5287310">&amp;&amp;</span>&nbsp;<span class="ident" id="5287313">j</span>&nbsp;<span class="op" id="5287315">&lt;=</span>&nbsp;<span class="num" id="5287318">8</span><span class="op" id="5287319">;</span>&nbsp;<span class="ident" id="5287321">j</span>&nbsp;<span class="op" id="5287323">+=</span>&nbsp;<span class="num" id="5287326">2</span>&nbsp;<span class="op" id="5287328">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287332">if</span>&nbsp;<span class="ident" id="5287335">r</span>&nbsp;<span class="op" id="5287337">&lt;</span>&nbsp;<span class="builtintype" id="5287339">rune</span><span class="op" id="5287343">[</span><span class="ident" id="5287344">j</span><span class="op" id="5287345">]</span>&nbsp;<span class="op" id="5287347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287352">return</span>&nbsp;<span class="ident" id="5287359">noMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287373">if</span>&nbsp;<span class="ident" id="5287376">r</span>&nbsp;<span class="op" id="5287378">&lt;=</span>&nbsp;<span class="builtintype" id="5287381">rune</span><span class="op" id="5287385">[</span><span class="ident" id="5287386">j</span><span class="op" id="5287387">+</span><span class="num" id="5287388">1</span><span class="op" id="5287389">]</span>&nbsp;<span class="op" id="5287391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287396">return</span>&nbsp;<span class="ident" id="5287403">j</span>&nbsp;<span class="op" id="5287405">/</span>&nbsp;<span class="num" id="5287407">2</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5287418">//&nbsp;Otherwise&nbsp;binary&nbsp;search.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5287447">lo</span>&nbsp;<span class="op" id="5287450">:=</span>&nbsp;<span class="num" id="5287453">0</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5287456">hi</span>&nbsp;<span class="op" id="5287459">:=</span>&nbsp;<span class="builtinfunc" id="5287462">len</span><span class="op" id="5287465">(</span><span class="builtintype" id="5287466">rune</span><span class="op" id="5287470">)</span>&nbsp;<span class="op" id="5287472">/</span>&nbsp;<span class="num" id="5287474">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287477">for</span>&nbsp;<span class="ident" id="5287481">lo</span>&nbsp;<span class="op" id="5287484">&lt;</span>&nbsp;<span class="ident" id="5287486">hi</span>&nbsp;<span class="op" id="5287489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5287493">m</span>&nbsp;<span class="op" id="5287495">:=</span>&nbsp;<span class="ident" id="5287498">lo</span>&nbsp;<span class="op" id="5287501">+</span>&nbsp;<span class="op" id="5287503">(</span><span class="ident" id="5287504">hi</span><span class="op" id="5287506">-</span><span class="ident" id="5287507">lo</span><span class="op" id="5287509">)</span><span class="op" id="5287510">/</span><span class="num" id="5287511">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287515">if</span>&nbsp;<span class="ident" id="5287518">c</span>&nbsp;<span class="op" id="5287520">:=</span>&nbsp;<span class="builtintype" id="5287523">rune</span><span class="op" id="5287527">[</span><span class="num" id="5287528">2</span><span class="op" id="5287529">*</span><span class="ident" id="5287530">m</span><span class="op" id="5287531">]</span><span class="op" id="5287532">;</span>&nbsp;<span class="ident" id="5287534">c</span>&nbsp;<span class="op" id="5287536">&lt;=</span>&nbsp;<span class="ident" id="5287539">r</span>&nbsp;<span class="op" id="5287541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287546">if</span>&nbsp;<span class="ident" id="5287549">r</span>&nbsp;<span class="op" id="5287551">&lt;=</span>&nbsp;<span class="builtintype" id="5287554">rune</span><span class="op" id="5287558">[</span><span class="num" id="5287559">2</span><span class="op" id="5287560">*</span><span class="ident" id="5287561">m</span><span class="op" id="5287562">+</span><span class="num" id="5287563">1</span><span class="op" id="5287564">]</span>&nbsp;<span class="op" id="5287566">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287572">return</span>&nbsp;<span class="ident" id="5287579">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5287589">lo</span>&nbsp;<span class="op" id="5287592">=</span>&nbsp;<span class="ident" id="5287594">m</span>&nbsp;<span class="op" id="5287596">+</span>&nbsp;<span class="num" id="5287598">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287602">}</span>&nbsp;<span class="keyword" id="5287604">else</span>&nbsp;<span class="op" id="5287609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5287614">hi</span>&nbsp;<span class="op" id="5287617">=</span>&nbsp;<span class="ident" id="5287619">m</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287629">return</span>&nbsp;<span class="ident" id="5287636">noMatch</span><br>
<span class="lineno"></span><span class="op" id="5287644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="5287647">//&nbsp;As&nbsp;per&nbsp;re2&#39;s&nbsp;Prog::IsWordChar.&nbsp;Determines&nbsp;whether&nbsp;rune&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;word&nbsp;char.</span><br>
<span class="lineno"></span><span class="comment" id="5287728">//&nbsp;Since&nbsp;we&nbsp;act&nbsp;on&nbsp;runes,&nbsp;it&nbsp;would&nbsp;be&nbsp;easy&nbsp;to&nbsp;support&nbsp;Unicode&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="5287796">func</span>&nbsp;<span class="ident" id="5287801">wordRune</span><span class="op" id="5287809">(</span><span class="ident" id="5287810">r</span>&nbsp;<span class="builtintype" id="5287812">rune</span><span class="op" id="5287816">)</span>&nbsp;<span class="builtintype" id="5287818">bool</span>&nbsp;<span class="op" id="5287823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5287826">return</span>&nbsp;<span class="ident" id="5287833">r</span>&nbsp;<span class="op" id="5287835">==</span>&nbsp;<span class="string" id="5287838">&#39;_&#39;</span>&nbsp;<span class="op" id="5287842">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287847">(</span><span class="string" id="5287848">&#39;A&#39;</span>&nbsp;<span class="op" id="5287852">&lt;=</span>&nbsp;<span class="ident" id="5287855">r</span>&nbsp;<span class="op" id="5287857">&amp;&amp;</span>&nbsp;<span class="ident" id="5287860">r</span>&nbsp;<span class="op" id="5287862">&lt;=</span>&nbsp;<span class="string" id="5287865">&#39;Z&#39;</span><span class="op" id="5287868">)</span>&nbsp;<span class="op" id="5287870">||</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287875">(</span><span class="string" id="5287876">&#39;a&#39;</span>&nbsp;<span class="op" id="5287880">&lt;=</span>&nbsp;<span class="ident" id="5287883">r</span>&nbsp;<span class="op" id="5287885">&amp;&amp;</span>&nbsp;<span class="ident" id="5287888">r</span>&nbsp;<span class="op" id="5287890">&lt;=</span>&nbsp;<span class="string" id="5287893">&#39;z&#39;</span><span class="op" id="5287896">)</span>&nbsp;<span class="op" id="5287898">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5287903">(</span><span class="string" id="5287904">&#39;0&#39;</span>&nbsp;<span class="op" id="5287908">&lt;=</span>&nbsp;<span class="ident" id="5287911">r</span>&nbsp;<span class="op" id="5287913">&amp;&amp;</span>&nbsp;<span class="ident" id="5287916">r</span>&nbsp;<span class="op" id="5287918">&lt;=</span>&nbsp;<span class="string" id="5287921">&#39;9&#39;</span><span class="op" id="5287924">)</span><br>
<span class="lineno"></span><span class="op" id="5287926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5287929">//&nbsp;MatchEmptyWidth&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches</span><br>
<span class="lineno">260</span><span class="comment" id="5287988">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;between&nbsp;the&nbsp;runes&nbsp;before&nbsp;and&nbsp;after.</span><br>
<span class="lineno"></span><span class="comment" id="5288043">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstEmptyWidth.</span><br>
<span class="lineno"></span><span class="keyword" id="5288100">func</span>&nbsp;<span class="op" id="5288105">(</span><span class="ident" id="5288106">i</span>&nbsp;<span class="op" id="5288108">*</span><span class="ident" id="5288109">Inst</span><span class="op" id="5288113">)</span>&nbsp;<span class="ident" id="5288115">MatchEmptyWidth</span><span class="op" id="5288130">(</span><span class="ident" id="5288131">before</span>&nbsp;<span class="builtintype" id="5288138">rune</span><span class="op" id="5288142">,</span>&nbsp;<span class="ident" id="5288144">after</span>&nbsp;<span class="builtintype" id="5288150">rune</span><span class="op" id="5288154">)</span>&nbsp;<span class="builtintype" id="5288156">bool</span>&nbsp;<span class="op" id="5288161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288164">switch</span>&nbsp;<span class="ident" id="5288171">EmptyOp</span><span class="op" id="5288178">(</span><span class="ident" id="5288179">i</span><span class="op" id="5288180">.</span><span class="ident" id="5288181">Arg</span><span class="op" id="5288184">)</span>&nbsp;<span class="op" id="5288186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288189">case</span>&nbsp;<span class="ident" id="5288194">EmptyBeginLine</span><span class="op" id="5288208">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288212">return</span>&nbsp;<span class="ident" id="5288219">before</span>&nbsp;<span class="op" id="5288226">==</span>&nbsp;<span class="string" id="5288229">&#39;\n&#39;</span>&nbsp;<span class="op" id="5288234">||</span>&nbsp;<span class="ident" id="5288237">before</span>&nbsp;<span class="op" id="5288244">==</span>&nbsp;<span class="op" id="5288247">-</span><span class="num" id="5288248">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288251">case</span>&nbsp;<span class="ident" id="5288256">EmptyEndLine</span><span class="op" id="5288268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288272">return</span>&nbsp;<span class="ident" id="5288279">after</span>&nbsp;<span class="op" id="5288285">==</span>&nbsp;<span class="string" id="5288288">&#39;\n&#39;</span>&nbsp;<span class="op" id="5288293">||</span>&nbsp;<span class="ident" id="5288296">after</span>&nbsp;<span class="op" id="5288302">==</span>&nbsp;<span class="op" id="5288305">-</span><span class="num" id="5288306">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288309">case</span>&nbsp;<span class="ident" id="5288314">EmptyBeginText</span><span class="op" id="5288328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288332">return</span>&nbsp;<span class="ident" id="5288339">before</span>&nbsp;<span class="op" id="5288346">==</span>&nbsp;<span class="op" id="5288349">-</span><span class="num" id="5288350">1</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288353">case</span>&nbsp;<span class="ident" id="5288358">EmptyEndText</span><span class="op" id="5288370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288374">return</span>&nbsp;<span class="ident" id="5288381">after</span>&nbsp;<span class="op" id="5288387">==</span>&nbsp;<span class="op" id="5288390">-</span><span class="num" id="5288391">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288394">case</span>&nbsp;<span class="ident" id="5288399">EmptyWordBoundary</span><span class="op" id="5288416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288420">return</span>&nbsp;<span class="ident" id="5288427">wordRune</span><span class="op" id="5288435">(</span><span class="ident" id="5288436">before</span><span class="op" id="5288442">)</span>&nbsp;<span class="op" id="5288444">!=</span>&nbsp;<span class="ident" id="5288447">wordRune</span><span class="op" id="5288455">(</span><span class="ident" id="5288456">after</span><span class="op" id="5288461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288464">case</span>&nbsp;<span class="ident" id="5288469">EmptyNoWordBoundary</span><span class="op" id="5288488">:</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288492">return</span>&nbsp;<span class="ident" id="5288499">wordRune</span><span class="op" id="5288507">(</span><span class="ident" id="5288508">before</span><span class="op" id="5288514">)</span>&nbsp;<span class="op" id="5288516">==</span>&nbsp;<span class="ident" id="5288519">wordRune</span><span class="op" id="5288527">(</span><span class="ident" id="5288528">after</span><span class="op" id="5288533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5288536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5288539">panic</span><span class="op" id="5288544">(</span><span class="string" id="5288545">&#34;unknown&nbsp;empty&nbsp;width&nbsp;arg&#34;</span><span class="op" id="5288570">)</span><br>
<span class="lineno"></span><span class="op" id="5288572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="5288575">func</span>&nbsp;<span class="op" id="5288580">(</span><span class="ident" id="5288581">i</span>&nbsp;<span class="op" id="5288583">*</span><span class="ident" id="5288584">Inst</span><span class="op" id="5288588">)</span>&nbsp;<span class="ident" id="5288590">String</span><span class="op" id="5288596">(</span><span class="op" id="5288597">)</span>&nbsp;<span class="builtintype" id="5288599">string</span>&nbsp;<span class="op" id="5288606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288609">var</span>&nbsp;<span class="ident" id="5288613">b</span>&nbsp;<span class="ident" id="5288615">bytes</span><span class="op" id="5288620">.</span><span class="ident" id="5288621">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5288629">dumpInst</span><span class="op" id="5288637">(</span><span class="op" id="5288638">&amp;</span><span class="ident" id="5288639">b</span><span class="op" id="5288640">,</span>&nbsp;<span class="ident" id="5288642">i</span><span class="op" id="5288643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288646">return</span>&nbsp;<span class="ident" id="5288653">b</span><span class="op" id="5288654">.</span><span class="ident" id="5288655">String</span><span class="op" id="5288661">(</span><span class="op" id="5288662">)</span><br>
<span class="lineno"></span><span class="op" id="5288664">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="5288667">func</span>&nbsp;<span class="ident" id="5288672">bw</span><span class="op" id="5288674">(</span><span class="ident" id="5288675">b</span>&nbsp;<span class="op" id="5288677">*</span><span class="ident" id="5288678">bytes</span><span class="op" id="5288683">.</span><span class="ident" id="5288684">Buffer</span><span class="op" id="5288690">,</span>&nbsp;<span class="ident" id="5288692">args</span>&nbsp;<span class="op" id="5288697">...</span><span class="builtintype" id="5288700">string</span><span class="op" id="5288706">)</span>&nbsp;<span class="op" id="5288708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288711">for</span>&nbsp;<span class="ident" id="5288715">_</span><span class="op" id="5288716">,</span>&nbsp;<span class="ident" id="5288718">s</span>&nbsp;<span class="op" id="5288720">:=</span>&nbsp;<span class="keyword" id="5288723">range</span>&nbsp;<span class="ident" id="5288729">args</span>&nbsp;<span class="op" id="5288734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5288738">b</span><span class="op" id="5288739">.</span><span class="ident" id="5288740">WriteString</span><span class="op" id="5288751">(</span><span class="ident" id="5288752">s</span><span class="op" id="5288753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5288756">}</span><br>
<span class="lineno">290</span><span class="op" id="5288758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5288761">func</span>&nbsp;<span class="ident" id="5288766">dumpProg</span><span class="op" id="5288774">(</span><span class="ident" id="5288775">b</span>&nbsp;<span class="op" id="5288777">*</span><span class="ident" id="5288778">bytes</span><span class="op" id="5288783">.</span><span class="ident" id="5288784">Buffer</span><span class="op" id="5288790">,</span>&nbsp;<span class="ident" id="5288792">p</span>&nbsp;<span class="op" id="5288794">*</span><span class="ident" id="5288795">Prog</span><span class="op" id="5288799">)</span>&nbsp;<span class="op" id="5288801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288804">for</span>&nbsp;<span class="ident" id="5288808">j</span>&nbsp;<span class="op" id="5288810">:=</span>&nbsp;<span class="keyword" id="5288813">range</span>&nbsp;<span class="ident" id="5288819">p</span><span class="op" id="5288820">.</span><span class="ident" id="5288821">Inst</span>&nbsp;<span class="op" id="5288826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5288830">i</span>&nbsp;<span class="op" id="5288832">:=</span>&nbsp;<span class="op" id="5288835">&amp;</span><span class="ident" id="5288836">p</span><span class="op" id="5288837">.</span><span class="ident" id="5288838">Inst</span><span class="op" id="5288842">[</span><span class="ident" id="5288843">j</span><span class="op" id="5288844">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5288848">pc</span>&nbsp;<span class="op" id="5288851">:=</span>&nbsp;<span class="ident" id="5288854">strconv</span><span class="op" id="5288861">.</span><span class="ident" id="5288862">Itoa</span><span class="op" id="5288866">(</span><span class="ident" id="5288867">j</span><span class="op" id="5288868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288872">if</span>&nbsp;<span class="builtinfunc" id="5288875">len</span><span class="op" id="5288878">(</span><span class="ident" id="5288879">pc</span><span class="op" id="5288881">)</span>&nbsp;<span class="op" id="5288883">&lt;</span>&nbsp;<span class="num" id="5288885">3</span>&nbsp;<span class="op" id="5288887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5288892">b</span><span class="op" id="5288893">.</span><span class="ident" id="5288894">WriteString</span><span class="op" id="5288905">(</span><span class="string" id="5288906">&#34;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="5288911">[</span><span class="builtinfunc" id="5288912">len</span><span class="op" id="5288915">(</span><span class="ident" id="5288916">pc</span><span class="op" id="5288918">)</span><span class="op" id="5288919">:</span><span class="op" id="5288920">]</span><span class="op" id="5288921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5288925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5288929">if</span>&nbsp;<span class="ident" id="5288932">j</span>&nbsp;<span class="op" id="5288934">==</span>&nbsp;<span class="ident" id="5288937">p</span><span class="op" id="5288938">.</span><span class="ident" id="5288939">Start</span>&nbsp;<span class="op" id="5288945">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5288950">pc</span>&nbsp;<span class="op" id="5288953">+=</span>&nbsp;<span class="string" id="5288956">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5288962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5288966">bw</span><span class="op" id="5288968">(</span><span class="ident" id="5288969">b</span><span class="op" id="5288970">,</span>&nbsp;<span class="ident" id="5288972">pc</span><span class="op" id="5288974">,</span>&nbsp;<span class="string" id="5288976">&#34;\t&#34;</span><span class="op" id="5288980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5288984">dumpInst</span><span class="op" id="5288992">(</span><span class="ident" id="5288993">b</span><span class="op" id="5288994">,</span>&nbsp;<span class="ident" id="5288996">i</span><span class="op" id="5288997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289001">bw</span><span class="op" id="5289003">(</span><span class="ident" id="5289004">b</span><span class="op" id="5289005">,</span>&nbsp;<span class="string" id="5289007">&#34;\n&#34;</span><span class="op" id="5289011">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5289014">}</span><br>
<span class="lineno"></span><span class="op" id="5289016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5289019">func</span>&nbsp;<span class="ident" id="5289024">u32</span><span class="op" id="5289027">(</span><span class="ident" id="5289028">i</span>&nbsp;<span class="builtintype" id="5289030">uint32</span><span class="op" id="5289036">)</span>&nbsp;<span class="builtintype" id="5289038">string</span>&nbsp;<span class="op" id="5289045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289048">return</span>&nbsp;<span class="ident" id="5289055">strconv</span><span class="op" id="5289062">.</span><span class="ident" id="5289063">FormatUint</span><span class="op" id="5289073">(</span><span class="ident" id="5289074">uint64</span><span class="op" id="5289080">(</span><span class="ident" id="5289081">i</span><span class="op" id="5289082">)</span><span class="op" id="5289083">,</span>&nbsp;<span class="num" id="5289085">10</span><span class="op" id="5289087">)</span><br>
<span class="lineno">310</span><span class="op" id="5289089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5289092">func</span>&nbsp;<span class="ident" id="5289097">dumpInst</span><span class="op" id="5289105">(</span><span class="ident" id="5289106">b</span>&nbsp;<span class="op" id="5289108">*</span><span class="ident" id="5289109">bytes</span><span class="op" id="5289114">.</span><span class="ident" id="5289115">Buffer</span><span class="op" id="5289121">,</span>&nbsp;<span class="ident" id="5289123">i</span>&nbsp;<span class="op" id="5289125">*</span><span class="ident" id="5289126">Inst</span><span class="op" id="5289130">)</span>&nbsp;<span class="op" id="5289132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289135">switch</span>&nbsp;<span class="ident" id="5289142">i</span><span class="op" id="5289143">.</span><span class="ident" id="5289144">Op</span>&nbsp;<span class="op" id="5289147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289150">case</span>&nbsp;<span class="ident" id="5289155">InstAlt</span><span class="op" id="5289162">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289166">bw</span><span class="op" id="5289168">(</span><span class="ident" id="5289169">b</span><span class="op" id="5289170">,</span>&nbsp;<span class="string" id="5289172">&#34;alt&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5289181">,</span>&nbsp;<span class="ident" id="5289183">u32</span><span class="op" id="5289186">(</span><span class="ident" id="5289187">i</span><span class="op" id="5289188">.</span><span class="ident" id="5289189">Out</span><span class="op" id="5289192">)</span><span class="op" id="5289193">,</span>&nbsp;<span class="string" id="5289195">&#34;,&nbsp;&#34;</span><span class="op" id="5289199">,</span>&nbsp;<span class="ident" id="5289201">u32</span><span class="op" id="5289204">(</span><span class="ident" id="5289205">i</span><span class="op" id="5289206">.</span><span class="ident" id="5289207">Arg</span><span class="op" id="5289210">)</span><span class="op" id="5289211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289214">case</span>&nbsp;<span class="ident" id="5289219">InstAltMatch</span><span class="op" id="5289231">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289235">bw</span><span class="op" id="5289237">(</span><span class="ident" id="5289238">b</span><span class="op" id="5289239">,</span>&nbsp;<span class="string" id="5289241">&#34;altmatch&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5289255">,</span>&nbsp;<span class="ident" id="5289257">u32</span><span class="op" id="5289260">(</span><span class="ident" id="5289261">i</span><span class="op" id="5289262">.</span><span class="ident" id="5289263">Out</span><span class="op" id="5289266">)</span><span class="op" id="5289267">,</span>&nbsp;<span class="string" id="5289269">&#34;,&nbsp;&#34;</span><span class="op" id="5289273">,</span>&nbsp;<span class="ident" id="5289275">u32</span><span class="op" id="5289278">(</span><span class="ident" id="5289279">i</span><span class="op" id="5289280">.</span><span class="ident" id="5289281">Arg</span><span class="op" id="5289284">)</span><span class="op" id="5289285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289288">case</span>&nbsp;<span class="ident" id="5289293">InstCapture</span><span class="op" id="5289304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289308">bw</span><span class="op" id="5289310">(</span><span class="ident" id="5289311">b</span><span class="op" id="5289312">,</span>&nbsp;<span class="string" id="5289314">&#34;cap&nbsp;&#34;</span><span class="op" id="5289320">,</span>&nbsp;<span class="ident" id="5289322">u32</span><span class="op" id="5289325">(</span><span class="ident" id="5289326">i</span><span class="op" id="5289327">.</span><span class="ident" id="5289328">Arg</span><span class="op" id="5289331">)</span><span class="op" id="5289332">,</span>&nbsp;<span class="string" id="5289334">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5289340">,</span>&nbsp;<span class="ident" id="5289342">u32</span><span class="op" id="5289345">(</span><span class="ident" id="5289346">i</span><span class="op" id="5289347">.</span><span class="ident" id="5289348">Out</span><span class="op" id="5289351">)</span><span class="op" id="5289352">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289355">case</span>&nbsp;<span class="ident" id="5289360">InstEmptyWidth</span><span class="op" id="5289374">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289378">bw</span><span class="op" id="5289380">(</span><span class="ident" id="5289381">b</span><span class="op" id="5289382">,</span>&nbsp;<span class="string" id="5289384">&#34;empty&nbsp;&#34;</span><span class="op" id="5289392">,</span>&nbsp;<span class="ident" id="5289394">u32</span><span class="op" id="5289397">(</span><span class="ident" id="5289398">i</span><span class="op" id="5289399">.</span><span class="ident" id="5289400">Arg</span><span class="op" id="5289403">)</span><span class="op" id="5289404">,</span>&nbsp;<span class="string" id="5289406">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5289412">,</span>&nbsp;<span class="ident" id="5289414">u32</span><span class="op" id="5289417">(</span><span class="ident" id="5289418">i</span><span class="op" id="5289419">.</span><span class="ident" id="5289420">Out</span><span class="op" id="5289423">)</span><span class="op" id="5289424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289427">case</span>&nbsp;<span class="ident" id="5289432">InstMatch</span><span class="op" id="5289441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289445">bw</span><span class="op" id="5289447">(</span><span class="ident" id="5289448">b</span><span class="op" id="5289449">,</span>&nbsp;<span class="string" id="5289451">&#34;match&#34;</span><span class="op" id="5289458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289461">case</span>&nbsp;<span class="ident" id="5289466">InstFail</span><span class="op" id="5289474">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289478">bw</span><span class="op" id="5289480">(</span><span class="ident" id="5289481">b</span><span class="op" id="5289482">,</span>&nbsp;<span class="string" id="5289484">&#34;fail&#34;</span><span class="op" id="5289490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289493">case</span>&nbsp;<span class="ident" id="5289498">InstNop</span><span class="op" id="5289505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289509">bw</span><span class="op" id="5289511">(</span><span class="ident" id="5289512">b</span><span class="op" id="5289513">,</span>&nbsp;<span class="string" id="5289515">&#34;nop&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5289524">,</span>&nbsp;<span class="ident" id="5289526">u32</span><span class="op" id="5289529">(</span><span class="ident" id="5289530">i</span><span class="op" id="5289531">.</span><span class="ident" id="5289532">Out</span><span class="op" id="5289535">)</span><span class="op" id="5289536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289539">case</span>&nbsp;<span class="ident" id="5289544">InstRune</span><span class="op" id="5289552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289556">if</span>&nbsp;<span class="ident" id="5289559">i</span><span class="op" id="5289560">.</span><span class="ident" id="5289561">Rune</span>&nbsp;<span class="op" id="5289566">==</span>&nbsp;<span class="ident" id="5289569">nil</span>&nbsp;<span class="op" id="5289573">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5289578">//&nbsp;shouldn&#39;t&nbsp;happen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289601">bw</span><span class="op" id="5289603">(</span><span class="ident" id="5289604">b</span><span class="op" id="5289605">,</span>&nbsp;<span class="string" id="5289607">&#34;rune&nbsp;&lt;nil&gt;&#34;</span><span class="op" id="5289619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5289623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289627">bw</span><span class="op" id="5289629">(</span><span class="ident" id="5289630">b</span><span class="op" id="5289631">,</span>&nbsp;<span class="string" id="5289633">&#34;rune&nbsp;&#34;</span><span class="op" id="5289640">,</span>&nbsp;<span class="ident" id="5289642">strconv</span><span class="op" id="5289649">.</span><span class="ident" id="5289650">QuoteToASCII</span><span class="op" id="5289662">(</span><span class="builtintype" id="5289663">string</span><span class="op" id="5289669">(</span><span class="ident" id="5289670">i</span><span class="op" id="5289671">.</span><span class="ident" id="5289672">Rune</span><span class="op" id="5289676">)</span><span class="op" id="5289677">)</span><span class="op" id="5289678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289682">if</span>&nbsp;<span class="ident" id="5289685">Flags</span><span class="op" id="5289690">(</span><span class="ident" id="5289691">i</span><span class="op" id="5289692">.</span><span class="ident" id="5289693">Arg</span><span class="op" id="5289696">)</span><span class="op" id="5289697">&amp;</span><span class="ident" id="5289698">FoldCase</span>&nbsp;<span class="op" id="5289707">!=</span>&nbsp;<span class="num" id="5289710">0</span>&nbsp;<span class="op" id="5289712">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289717">bw</span><span class="op" id="5289719">(</span><span class="ident" id="5289720">b</span><span class="op" id="5289721">,</span>&nbsp;<span class="string" id="5289723">&#34;/i&#34;</span><span class="op" id="5289727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5289731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289735">bw</span><span class="op" id="5289737">(</span><span class="ident" id="5289738">b</span><span class="op" id="5289739">,</span>&nbsp;<span class="string" id="5289741">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5289747">,</span>&nbsp;<span class="ident" id="5289749">u32</span><span class="op" id="5289752">(</span><span class="ident" id="5289753">i</span><span class="op" id="5289754">.</span><span class="ident" id="5289755">Out</span><span class="op" id="5289758">)</span><span class="op" id="5289759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289762">case</span>&nbsp;<span class="ident" id="5289767">InstRune1</span><span class="op" id="5289776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289780">bw</span><span class="op" id="5289782">(</span><span class="ident" id="5289783">b</span><span class="op" id="5289784">,</span>&nbsp;<span class="string" id="5289786">&#34;rune1&nbsp;&#34;</span><span class="op" id="5289794">,</span>&nbsp;<span class="ident" id="5289796">strconv</span><span class="op" id="5289803">.</span><span class="ident" id="5289804">QuoteToASCII</span><span class="op" id="5289816">(</span><span class="builtintype" id="5289817">string</span><span class="op" id="5289823">(</span><span class="ident" id="5289824">i</span><span class="op" id="5289825">.</span><span class="ident" id="5289826">Rune</span><span class="op" id="5289830">)</span><span class="op" id="5289831">)</span><span class="op" id="5289832">,</span>&nbsp;<span class="string" id="5289834">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5289840">,</span>&nbsp;<span class="ident" id="5289842">u32</span><span class="op" id="5289845">(</span><span class="ident" id="5289846">i</span><span class="op" id="5289847">.</span><span class="ident" id="5289848">Out</span><span class="op" id="5289851">)</span><span class="op" id="5289852">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289855">case</span>&nbsp;<span class="ident" id="5289860">InstRuneAny</span><span class="op" id="5289871">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289875">bw</span><span class="op" id="5289877">(</span><span class="ident" id="5289878">b</span><span class="op" id="5289879">,</span>&nbsp;<span class="string" id="5289881">&#34;any&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5289890">,</span>&nbsp;<span class="ident" id="5289892">u32</span><span class="op" id="5289895">(</span><span class="ident" id="5289896">i</span><span class="op" id="5289897">.</span><span class="ident" id="5289898">Out</span><span class="op" id="5289901">)</span><span class="op" id="5289902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5289905">case</span>&nbsp;<span class="ident" id="5289910">InstRuneAnyNotNL</span><span class="op" id="5289926">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5289930">bw</span><span class="op" id="5289932">(</span><span class="ident" id="5289933">b</span><span class="op" id="5289934">,</span>&nbsp;<span class="string" id="5289936">&#34;anynotnl&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5289950">,</span>&nbsp;<span class="ident" id="5289952">u32</span><span class="op" id="5289955">(</span><span class="ident" id="5289956">i</span><span class="op" id="5289957">.</span><span class="ident" id="5289958">Out</span><span class="op" id="5289961">)</span><span class="op" id="5289962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5289965">}</span><br>
<span class="lineno">345</span><span class="op" id="5289967">}</span>
</div>
</body>
</html>
