<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing</h2>
<ul>
<li><a href="/gostd/testing/allocs.go.html">allocs.go</a></li>
<li><a href="/gostd/testing/allocs_test.go.html">allocs_test.go</a></li>
<li><a href="/gostd/testing/benchmark.go.html">benchmark.go</a></li>
<li><a href="/gostd/testing/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/testing/cover.go.html">cover.go</a></li>
<li><a href="/gostd/testing/example.go.html">example.go</a></li>
<li><a href="/gostd/testing/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/testing/testing.go.html">testing.go</a></li>
<li><a href="/gostd/testing/testing_test.go.html">testing_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6187586">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6187641">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6187695">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6187746">//&nbsp;Support&nbsp;for&nbsp;test&nbsp;coverage.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6187777">package</span>&nbsp;<span class="ident" id="6187785">testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6187794">import</span>&nbsp;<span class="op" id="6187801">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187804">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187811">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6187817">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span><span class="op" id="6187831">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6187834">//&nbsp;CoverBlock&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;for&nbsp;a&nbsp;single&nbsp;basic&nbsp;block.</span><br>
<span class="lineno"></span><span class="comment" id="6187900">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="6187979">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6188044">type</span>&nbsp;<span class="ident" id="6188049">CoverBlock</span>&nbsp;<span class="keyword" id="6188060">struct</span>&nbsp;<span class="op" id="6188067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188070">Line0</span>&nbsp;<span class="builtintype" id="6188076">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188084">Col0</span>&nbsp;&nbsp;<span class="builtintype" id="6188090">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188098">Line1</span>&nbsp;<span class="builtintype" id="6188104">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188112">Col1</span>&nbsp;&nbsp;<span class="builtintype" id="6188118">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188126">Stmts</span>&nbsp;<span class="builtintype" id="6188132">uint16</span><br>
<span class="lineno"></span><span class="op" id="6188139">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6188142">var</span>&nbsp;<span class="ident" id="6188146">cover</span>&nbsp;<span class="ident" id="6188152">Cover</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6188159">//&nbsp;Cover&nbsp;records&nbsp;information&nbsp;about&nbsp;test&nbsp;coverage&nbsp;checking.</span><br>
<span class="lineno"></span><span class="comment" id="6188218">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno">30</span><span class="comment" id="6188297">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6188362">type</span>&nbsp;<span class="ident" id="6188367">Cover</span>&nbsp;<span class="keyword" id="6188373">struct</span>&nbsp;<span class="op" id="6188380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188383">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6188399">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188407">Counters</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188423">map</span><span class="op" id="6188426">[</span><span class="builtintype" id="6188427">string</span><span class="op" id="6188433">]</span><span class="op" id="6188434">[</span><span class="op" id="6188435">]</span><span class="builtintype" id="6188436">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188444">Blocks</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6188460">map</span><span class="op" id="6188463">[</span><span class="builtintype" id="6188464">string</span><span class="op" id="6188470">]</span><span class="op" id="6188471">[</span><span class="op" id="6188472">]</span><span class="ident" id="6188473">CoverBlock</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188485">CoveredPackages</span>&nbsp;<span class="builtintype" id="6188501">string</span><br>
<span class="lineno"></span><span class="op" id="6188508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6188511">//&nbsp;Coverage&nbsp;reports&nbsp;the&nbsp;current&nbsp;code&nbsp;coverage&nbsp;as&nbsp;a&nbsp;fraction&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;1].</span><br>
<span class="lineno"></span><span class="comment" id="6188592">//&nbsp;If&nbsp;coverage&nbsp;is&nbsp;not&nbsp;enabled,&nbsp;Coverage&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="comment" id="6188643">//</span><br>
<span class="lineno"></span><span class="comment" id="6188646">//&nbsp;When&nbsp;running&nbsp;a&nbsp;large&nbsp;set&nbsp;of&nbsp;sequential&nbsp;test&nbsp;cases,&nbsp;checking&nbsp;Coverage&nbsp;after&nbsp;each&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="6188733">//&nbsp;can&nbsp;be&nbsp;useful&nbsp;for&nbsp;identifying&nbsp;which&nbsp;test&nbsp;cases&nbsp;exercise&nbsp;new&nbsp;code&nbsp;paths.</span><br>
<span class="lineno"></span><span class="comment" id="6188808">//&nbsp;It&nbsp;is&nbsp;not&nbsp;a&nbsp;replacement&nbsp;for&nbsp;the&nbsp;reports&nbsp;generated&nbsp;by&nbsp;&#39;go&nbsp;test&nbsp;-cover&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6188885">//&nbsp;&#39;go&nbsp;tool&nbsp;cover&#39;.</span><br>
<span class="lineno">45</span><span class="keyword" id="6188905">func</span>&nbsp;<span class="ident" id="6188910">Coverage</span><span class="op" id="6188918">(</span><span class="op" id="6188919">)</span>&nbsp;<span class="builtintype" id="6188921">float64</span>&nbsp;<span class="op" id="6188929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188932">var</span>&nbsp;<span class="ident" id="6188936">n</span><span class="op" id="6188937">,</span>&nbsp;<span class="ident" id="6188939">d</span>&nbsp;<span class="ident" id="6188941">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188948">for</span>&nbsp;<span class="ident" id="6188952">_</span><span class="op" id="6188953">,</span>&nbsp;<span class="ident" id="6188955">counters</span>&nbsp;<span class="op" id="6188964">:=</span>&nbsp;<span class="keyword" id="6188967">range</span>&nbsp;<span class="ident" id="6188973">cover</span><span class="op" id="6188978">.</span><span class="ident" id="6188979">Counters</span>&nbsp;<span class="op" id="6188988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188992">for</span>&nbsp;<span class="ident" id="6188996">i</span>&nbsp;<span class="op" id="6188998">:=</span>&nbsp;<span class="keyword" id="6189001">range</span>&nbsp;<span class="ident" id="6189007">counters</span>&nbsp;<span class="op" id="6189016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189021">if</span>&nbsp;<span class="ident" id="6189024">atomic</span><span class="op" id="6189030">.</span><span class="ident" id="6189031">LoadUint32</span><span class="op" id="6189041">(</span><span class="op" id="6189042">&amp;</span><span class="ident" id="6189043">counters</span><span class="op" id="6189051">[</span><span class="ident" id="6189052">i</span><span class="op" id="6189053">]</span><span class="op" id="6189054">)</span>&nbsp;<span class="op" id="6189056">&gt;</span>&nbsp;<span class="num" id="6189058">0</span>&nbsp;<span class="op" id="6189060">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189066">n</span><span class="op" id="6189067">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189078">d</span><span class="op" id="6189079">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189087">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189090">if</span>&nbsp;<span class="ident" id="6189093">d</span>&nbsp;<span class="op" id="6189095">==</span>&nbsp;<span class="num" id="6189098">0</span>&nbsp;<span class="op" id="6189100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189104">return</span>&nbsp;<span class="num" id="6189111">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189117">return</span>&nbsp;<span class="builtintype" id="6189124">float64</span><span class="op" id="6189131">(</span><span class="ident" id="6189132">n</span><span class="op" id="6189133">)</span>&nbsp;<span class="op" id="6189135">/</span>&nbsp;<span class="builtintype" id="6189137">float64</span><span class="op" id="6189144">(</span><span class="ident" id="6189145">d</span><span class="op" id="6189146">)</span><br>
<span class="lineno"></span><span class="op" id="6189148">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6189151">//&nbsp;RegisterCover&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;accumulators&nbsp;for&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="comment" id="6189222">//&nbsp;NOTE:&nbsp;This&nbsp;function&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="6189303">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6189368">func</span>&nbsp;<span class="ident" id="6189373">RegisterCover</span><span class="op" id="6189386">(</span><span class="ident" id="6189387">c</span>&nbsp;<span class="ident" id="6189389">Cover</span><span class="op" id="6189394">)</span>&nbsp;<span class="op" id="6189396">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189399">cover</span>&nbsp;<span class="op" id="6189405">=</span>&nbsp;<span class="ident" id="6189407">c</span><br>
<span class="lineno"></span><span class="op" id="6189409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6189412">//&nbsp;mustBeNil&nbsp;checks&nbsp;the&nbsp;error&nbsp;and,&nbsp;if&nbsp;present,&nbsp;reports&nbsp;it&nbsp;and&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="6189481">func</span>&nbsp;<span class="ident" id="6189486">mustBeNil</span><span class="op" id="6189495">(</span><span class="ident" id="6189496">err</span>&nbsp;<span class="builtintype" id="6189500">error</span><span class="op" id="6189505">)</span>&nbsp;<span class="op" id="6189507">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189510">if</span>&nbsp;<span class="ident" id="6189513">err</span>&nbsp;<span class="op" id="6189517">!=</span>&nbsp;<span class="ident" id="6189520">nil</span>&nbsp;<span class="op" id="6189524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189528">fmt</span><span class="op" id="6189531">.</span><span class="ident" id="6189532">Fprintf</span><span class="op" id="6189539">(</span><span class="ident" id="6189540">os</span><span class="op" id="6189542">.</span><span class="ident" id="6189543">Stderr</span><span class="op" id="6189549">,</span>&nbsp;<span class="string" id="6189551">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="6189566">,</span>&nbsp;<span class="ident" id="6189568">err</span><span class="op" id="6189571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189575">os</span><span class="op" id="6189577">.</span><span class="ident" id="6189578">Exit</span><span class="op" id="6189582">(</span><span class="num" id="6189583">2</span><span class="op" id="6189584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189587">}</span><br>
<span class="lineno"></span><span class="op" id="6189589">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6189592">//&nbsp;coverReport&nbsp;reports&nbsp;the&nbsp;coverage&nbsp;percentage&nbsp;and&nbsp;writes&nbsp;a&nbsp;coverage&nbsp;profile&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="6189683">func</span>&nbsp;<span class="ident" id="6189688">coverReport</span><span class="op" id="6189699">(</span><span class="op" id="6189700">)</span>&nbsp;<span class="op" id="6189702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189705">var</span>&nbsp;<span class="ident" id="6189709">f</span>&nbsp;<span class="op" id="6189711">*</span><span class="ident" id="6189712">os</span><span class="op" id="6189714">.</span><span class="ident" id="6189715">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189721">var</span>&nbsp;<span class="ident" id="6189725">err</span>&nbsp;<span class="builtintype" id="6189729">error</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189736">if</span>&nbsp;<span class="op" id="6189739">*</span><span class="ident" id="6189740">coverProfile</span>&nbsp;<span class="op" id="6189753">!=</span>&nbsp;<span class="string" id="6189756">&#34;&#34;</span>&nbsp;<span class="op" id="6189759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189763">f</span><span class="op" id="6189764">,</span>&nbsp;<span class="ident" id="6189766">err</span>&nbsp;<span class="op" id="6189770">=</span>&nbsp;<span class="ident" id="6189772">os</span><span class="op" id="6189774">.</span><span class="ident" id="6189775">Create</span><span class="op" id="6189781">(</span><span class="ident" id="6189782">toOutputDir</span><span class="op" id="6189793">(</span><span class="op" id="6189794">*</span><span class="ident" id="6189795">coverProfile</span><span class="op" id="6189807">)</span><span class="op" id="6189808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189812">mustBeNil</span><span class="op" id="6189821">(</span><span class="ident" id="6189822">err</span><span class="op" id="6189825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189829">fmt</span><span class="op" id="6189832">.</span><span class="ident" id="6189833">Fprintf</span><span class="op" id="6189840">(</span><span class="ident" id="6189841">f</span><span class="op" id="6189842">,</span>&nbsp;<span class="string" id="6189844">&#34;mode:&nbsp;%s\n&#34;</span><span class="op" id="6189856">,</span>&nbsp;<span class="ident" id="6189858">cover</span><span class="op" id="6189863">.</span><span class="ident" id="6189864">Mode</span><span class="op" id="6189868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189872">defer</span>&nbsp;<span class="keyword" id="6189878">func</span><span class="op" id="6189882">(</span><span class="op" id="6189883">)</span>&nbsp;<span class="op" id="6189885">{</span>&nbsp;<span class="ident" id="6189887">mustBeNil</span><span class="op" id="6189896">(</span><span class="ident" id="6189897">f</span><span class="op" id="6189898">.</span><span class="ident" id="6189899">Close</span><span class="op" id="6189904">(</span><span class="op" id="6189905">)</span><span class="op" id="6189906">)</span>&nbsp;<span class="op" id="6189908">}</span><span class="op" id="6189909">(</span><span class="op" id="6189910">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189917">var</span>&nbsp;<span class="ident" id="6189921">active</span><span class="op" id="6189927">,</span>&nbsp;<span class="ident" id="6189929">total</span>&nbsp;<span class="ident" id="6189935">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189942">var</span>&nbsp;<span class="ident" id="6189946">count</span>&nbsp;<span class="builtintype" id="6189952">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189960">for</span>&nbsp;<span class="ident" id="6189964">name</span><span class="op" id="6189968">,</span>&nbsp;<span class="ident" id="6189970">counts</span>&nbsp;<span class="op" id="6189977">:=</span>&nbsp;<span class="keyword" id="6189980">range</span>&nbsp;<span class="ident" id="6189986">cover</span><span class="op" id="6189991">.</span><span class="ident" id="6189992">Counters</span>&nbsp;<span class="op" id="6190001">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190005">blocks</span>&nbsp;<span class="op" id="6190012">:=</span>&nbsp;<span class="ident" id="6190015">cover</span><span class="op" id="6190020">.</span><span class="ident" id="6190021">Blocks</span><span class="op" id="6190027">[</span><span class="ident" id="6190028">name</span><span class="op" id="6190032">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190036">for</span>&nbsp;<span class="ident" id="6190040">i</span>&nbsp;<span class="op" id="6190042">:=</span>&nbsp;<span class="keyword" id="6190045">range</span>&nbsp;<span class="ident" id="6190051">counts</span>&nbsp;<span class="op" id="6190058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190063">stmts</span>&nbsp;<span class="op" id="6190069">:=</span>&nbsp;<span class="ident" id="6190072">int64</span><span class="op" id="6190077">(</span><span class="ident" id="6190078">blocks</span><span class="op" id="6190084">[</span><span class="ident" id="6190085">i</span><span class="op" id="6190086">]</span><span class="op" id="6190087">.</span><span class="ident" id="6190088">Stmts</span><span class="op" id="6190093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190098">total</span>&nbsp;<span class="op" id="6190104">+=</span>&nbsp;<span class="ident" id="6190107">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190116">count</span>&nbsp;<span class="op" id="6190122">=</span>&nbsp;<span class="ident" id="6190124">atomic</span><span class="op" id="6190130">.</span><span class="ident" id="6190131">LoadUint32</span><span class="op" id="6190141">(</span><span class="op" id="6190142">&amp;</span><span class="ident" id="6190143">counts</span><span class="op" id="6190149">[</span><span class="ident" id="6190150">i</span><span class="op" id="6190151">]</span><span class="op" id="6190152">)</span>&nbsp;<span class="comment" id="6190154">//&nbsp;For&nbsp;-mode=atomic.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190178">if</span>&nbsp;<span class="ident" id="6190181">count</span>&nbsp;<span class="op" id="6190187">&gt;</span>&nbsp;<span class="num" id="6190189">0</span>&nbsp;<span class="op" id="6190191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190197">active</span>&nbsp;<span class="op" id="6190204">+=</span>&nbsp;<span class="ident" id="6190207">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190221">if</span>&nbsp;<span class="ident" id="6190224">f</span>&nbsp;<span class="op" id="6190226">!=</span>&nbsp;<span class="ident" id="6190229">nil</span>&nbsp;<span class="op" id="6190233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190239">_</span><span class="op" id="6190240">,</span>&nbsp;<span class="ident" id="6190242">err</span>&nbsp;<span class="op" id="6190246">:=</span>&nbsp;<span class="ident" id="6190249">fmt</span><span class="op" id="6190252">.</span><span class="ident" id="6190253">Fprintf</span><span class="op" id="6190260">(</span><span class="ident" id="6190261">f</span><span class="op" id="6190262">,</span>&nbsp;<span class="string" id="6190264">&#34;%s:%d.%d,%d.%d&nbsp;%d&nbsp;%d\n&#34;</span><span class="op" id="6190288">,</span>&nbsp;<span class="ident" id="6190290">name</span><span class="op" id="6190294">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190301">blocks</span><span class="op" id="6190307">[</span><span class="ident" id="6190308">i</span><span class="op" id="6190309">]</span><span class="op" id="6190310">.</span><span class="ident" id="6190311">Line0</span><span class="op" id="6190316">,</span>&nbsp;<span class="ident" id="6190318">blocks</span><span class="op" id="6190324">[</span><span class="ident" id="6190325">i</span><span class="op" id="6190326">]</span><span class="op" id="6190327">.</span><span class="ident" id="6190328">Col0</span><span class="op" id="6190332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190339">blocks</span><span class="op" id="6190345">[</span><span class="ident" id="6190346">i</span><span class="op" id="6190347">]</span><span class="op" id="6190348">.</span><span class="ident" id="6190349">Line1</span><span class="op" id="6190354">,</span>&nbsp;<span class="ident" id="6190356">blocks</span><span class="op" id="6190362">[</span><span class="ident" id="6190363">i</span><span class="op" id="6190364">]</span><span class="op" id="6190365">.</span><span class="ident" id="6190366">Col1</span><span class="op" id="6190370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190377">stmts</span><span class="op" id="6190382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190389">count</span><span class="op" id="6190394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190400">mustBeNil</span><span class="op" id="6190409">(</span><span class="ident" id="6190410">err</span><span class="op" id="6190413">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190428">if</span>&nbsp;<span class="ident" id="6190431">total</span>&nbsp;<span class="op" id="6190437">==</span>&nbsp;<span class="num" id="6190440">0</span>&nbsp;<span class="op" id="6190442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190446">total</span>&nbsp;<span class="op" id="6190452">=</span>&nbsp;<span class="num" id="6190454">1</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190460">fmt</span><span class="op" id="6190463">.</span><span class="ident" id="6190464">Printf</span><span class="op" id="6190470">(</span><span class="string" id="6190471">&#34;coverage:&nbsp;%.1f%%&nbsp;of&nbsp;statements%s\n&#34;</span><span class="op" id="6190507">,</span>&nbsp;<span class="num" id="6190509">100</span><span class="op" id="6190512">*</span><span class="builtintype" id="6190513">float64</span><span class="op" id="6190520">(</span><span class="ident" id="6190521">active</span><span class="op" id="6190527">)</span><span class="op" id="6190528">/</span><span class="builtintype" id="6190529">float64</span><span class="op" id="6190536">(</span><span class="ident" id="6190537">total</span><span class="op" id="6190542">)</span><span class="op" id="6190543">,</span>&nbsp;<span class="ident" id="6190545">cover</span><span class="op" id="6190550">.</span><span class="ident" id="6190551">CoveredPackages</span><span class="op" id="6190566">)</span><br>
<span class="lineno"></span><span class="op" id="6190568">}</span>
</div>
</body>
</html>
