<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io/ioutil</h2>
<ul>
<li><a href="/gostd/io/ioutil/ioutil.go.html">ioutil.go</a></li>
<li><a href="/gostd/io/ioutil/ioutil_test.go.html">ioutil_test.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile.go.html">tempfile.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile_test.go.html">tempfile_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6702500">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6702555">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6702609">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6702660">package</span>&nbsp;<span class="ident" id="6702668">ioutil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6702676">import</span>&nbsp;<span class="op" id="6702683">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6702686">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6702692">&#34;path/filepath&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6702709">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6702719">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6702729">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6702732">func</span>&nbsp;<span class="ident" id="6702737">TestTempFile</span><span class="op" id="6702749">(</span><span class="ident" id="6702750">t</span>&nbsp;<span class="op" id="6702752">*</span><span class="ident" id="6702753">testing</span><span class="op" id="6702760">.</span><span class="ident" id="6702761">T</span><span class="op" id="6702762">)</span>&nbsp;<span class="op" id="6702764">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702767">f</span><span class="op" id="6702768">,</span>&nbsp;<span class="ident" id="6702770">err</span>&nbsp;<span class="op" id="6702774">:=</span>&nbsp;<span class="ident" id="6702777">TempFile</span><span class="op" id="6702785">(</span><span class="string" id="6702786">&#34;/_not_exists_&#34;</span><span class="op" id="6702801">,</span>&nbsp;<span class="string" id="6702803">&#34;foo&#34;</span><span class="op" id="6702808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702811">if</span>&nbsp;<span class="ident" id="6702814">f</span>&nbsp;<span class="op" id="6702816">!=</span>&nbsp;<span class="ident" id="6702819">nil</span>&nbsp;<span class="op" id="6702823">||</span>&nbsp;<span class="ident" id="6702826">err</span>&nbsp;<span class="op" id="6702830">==</span>&nbsp;<span class="ident" id="6702833">nil</span>&nbsp;<span class="op" id="6702837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702841">t</span><span class="op" id="6702842">.</span><span class="ident" id="6702843">Errorf</span><span class="op" id="6702849">(</span><span class="string" id="6702850">&#34;TempFile(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6702893">,</span>&nbsp;<span class="ident" id="6702895">f</span><span class="op" id="6702896">,</span>&nbsp;<span class="ident" id="6702898">err</span><span class="op" id="6702901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6702904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702908">dir</span>&nbsp;<span class="op" id="6702912">:=</span>&nbsp;<span class="ident" id="6702915">os</span><span class="op" id="6702917">.</span><span class="ident" id="6702918">TempDir</span><span class="op" id="6702925">(</span><span class="op" id="6702926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702929">f</span><span class="op" id="6702930">,</span>&nbsp;<span class="ident" id="6702932">err</span>&nbsp;<span class="op" id="6702936">=</span>&nbsp;<span class="ident" id="6702938">TempFile</span><span class="op" id="6702946">(</span><span class="ident" id="6702947">dir</span><span class="op" id="6702950">,</span>&nbsp;<span class="string" id="6702952">&#34;ioutil_test&#34;</span><span class="op" id="6702965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702968">if</span>&nbsp;<span class="ident" id="6702971">f</span>&nbsp;<span class="op" id="6702973">==</span>&nbsp;<span class="ident" id="6702976">nil</span>&nbsp;<span class="op" id="6702980">||</span>&nbsp;<span class="ident" id="6702983">err</span>&nbsp;<span class="op" id="6702987">!=</span>&nbsp;<span class="ident" id="6702990">nil</span>&nbsp;<span class="op" id="6702994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702998">t</span><span class="op" id="6702999">.</span><span class="ident" id="6703000">Errorf</span><span class="op" id="6703006">(</span><span class="string" id="6703007">&#34;TempFile(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6703046">,</span>&nbsp;<span class="ident" id="6703048">f</span><span class="op" id="6703049">,</span>&nbsp;<span class="ident" id="6703051">err</span><span class="op" id="6703054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703057">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703060">if</span>&nbsp;<span class="ident" id="6703063">f</span>&nbsp;<span class="op" id="6703065">!=</span>&nbsp;<span class="ident" id="6703068">nil</span>&nbsp;<span class="op" id="6703072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703076">f</span><span class="op" id="6703077">.</span><span class="ident" id="6703078">Close</span><span class="op" id="6703083">(</span><span class="op" id="6703084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703088">os</span><span class="op" id="6703090">.</span><span class="ident" id="6703091">Remove</span><span class="op" id="6703097">(</span><span class="ident" id="6703098">f</span><span class="op" id="6703099">.</span><span class="ident" id="6703100">Name</span><span class="op" id="6703104">(</span><span class="op" id="6703105">)</span><span class="op" id="6703106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703110">re</span>&nbsp;<span class="op" id="6703113">:=</span>&nbsp;<span class="ident" id="6703116">regexp</span><span class="op" id="6703122">.</span><span class="ident" id="6703123">MustCompile</span><span class="op" id="6703134">(</span><span class="string" id="6703135">&#34;^&#34;</span>&nbsp;<span class="op" id="6703139">+</span>&nbsp;<span class="ident" id="6703141">regexp</span><span class="op" id="6703147">.</span><span class="ident" id="6703148">QuoteMeta</span><span class="op" id="6703157">(</span><span class="ident" id="6703158">filepath</span><span class="op" id="6703166">.</span><span class="ident" id="6703167">Join</span><span class="op" id="6703171">(</span><span class="ident" id="6703172">dir</span><span class="op" id="6703175">,</span>&nbsp;<span class="string" id="6703177">&#34;ioutil_test&#34;</span><span class="op" id="6703190">)</span><span class="op" id="6703191">)</span>&nbsp;<span class="op" id="6703193">+</span>&nbsp;<span class="string" id="6703195">&#34;[0-9]+$&#34;</span><span class="op" id="6703204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703208">if</span>&nbsp;<span class="op" id="6703211">!</span><span class="ident" id="6703212">re</span><span class="op" id="6703214">.</span><span class="ident" id="6703215">MatchString</span><span class="op" id="6703226">(</span><span class="ident" id="6703227">f</span><span class="op" id="6703228">.</span><span class="ident" id="6703229">Name</span><span class="op" id="6703233">(</span><span class="op" id="6703234">)</span><span class="op" id="6703235">)</span>&nbsp;<span class="op" id="6703237">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703242">t</span><span class="op" id="6703243">.</span><span class="ident" id="6703244">Errorf</span><span class="op" id="6703250">(</span><span class="string" id="6703251">&#34;TempFile(`&#34;</span><span class="op" id="6703263">+</span><span class="ident" id="6703264">dir</span><span class="op" id="6703267">+</span><span class="string" id="6703268">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="6703307">,</span>&nbsp;<span class="ident" id="6703309">f</span><span class="op" id="6703310">.</span><span class="ident" id="6703311">Name</span><span class="op" id="6703315">(</span><span class="op" id="6703316">)</span><span class="op" id="6703317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703324">}</span><br>
<span class="lineno"></span><span class="op" id="6703326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6703329">func</span>&nbsp;<span class="ident" id="6703334">TestTempDir</span><span class="op" id="6703345">(</span><span class="ident" id="6703346">t</span>&nbsp;<span class="op" id="6703348">*</span><span class="ident" id="6703349">testing</span><span class="op" id="6703356">.</span><span class="ident" id="6703357">T</span><span class="op" id="6703358">)</span>&nbsp;<span class="op" id="6703360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703363">name</span><span class="op" id="6703367">,</span>&nbsp;<span class="ident" id="6703369">err</span>&nbsp;<span class="op" id="6703373">:=</span>&nbsp;<span class="ident" id="6703376">TempDir</span><span class="op" id="6703383">(</span><span class="string" id="6703384">&#34;/_not_exists_&#34;</span><span class="op" id="6703399">,</span>&nbsp;<span class="string" id="6703401">&#34;foo&#34;</span><span class="op" id="6703406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703409">if</span>&nbsp;<span class="ident" id="6703412">name</span>&nbsp;<span class="op" id="6703417">!=</span>&nbsp;<span class="string" id="6703420">&#34;&#34;</span>&nbsp;<span class="op" id="6703423">||</span>&nbsp;<span class="ident" id="6703426">err</span>&nbsp;<span class="op" id="6703430">==</span>&nbsp;<span class="ident" id="6703433">nil</span>&nbsp;<span class="op" id="6703437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703441">t</span><span class="op" id="6703442">.</span><span class="ident" id="6703443">Errorf</span><span class="op" id="6703449">(</span><span class="string" id="6703450">&#34;TempDir(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6703492">,</span>&nbsp;<span class="ident" id="6703494">name</span><span class="op" id="6703498">,</span>&nbsp;<span class="ident" id="6703500">err</span><span class="op" id="6703503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703506">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703510">dir</span>&nbsp;<span class="op" id="6703514">:=</span>&nbsp;<span class="ident" id="6703517">os</span><span class="op" id="6703519">.</span><span class="ident" id="6703520">TempDir</span><span class="op" id="6703527">(</span><span class="op" id="6703528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703531">name</span><span class="op" id="6703535">,</span>&nbsp;<span class="ident" id="6703537">err</span>&nbsp;<span class="op" id="6703541">=</span>&nbsp;<span class="ident" id="6703543">TempDir</span><span class="op" id="6703550">(</span><span class="ident" id="6703551">dir</span><span class="op" id="6703554">,</span>&nbsp;<span class="string" id="6703556">&#34;ioutil_test&#34;</span><span class="op" id="6703569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703572">if</span>&nbsp;<span class="ident" id="6703575">name</span>&nbsp;<span class="op" id="6703580">==</span>&nbsp;<span class="string" id="6703583">&#34;&#34;</span>&nbsp;<span class="op" id="6703586">||</span>&nbsp;<span class="ident" id="6703589">err</span>&nbsp;<span class="op" id="6703593">!=</span>&nbsp;<span class="ident" id="6703596">nil</span>&nbsp;<span class="op" id="6703600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703604">t</span><span class="op" id="6703605">.</span><span class="ident" id="6703606">Errorf</span><span class="op" id="6703612">(</span><span class="string" id="6703613">&#34;TempDir(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6703651">,</span>&nbsp;<span class="ident" id="6703653">name</span><span class="op" id="6703657">,</span>&nbsp;<span class="ident" id="6703659">err</span><span class="op" id="6703662">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703668">if</span>&nbsp;<span class="ident" id="6703671">name</span>&nbsp;<span class="op" id="6703676">!=</span>&nbsp;<span class="string" id="6703679">&#34;&#34;</span>&nbsp;<span class="op" id="6703682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703686">os</span><span class="op" id="6703688">.</span><span class="ident" id="6703689">Remove</span><span class="op" id="6703695">(</span><span class="ident" id="6703696">name</span><span class="op" id="6703700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703704">re</span>&nbsp;<span class="op" id="6703707">:=</span>&nbsp;<span class="ident" id="6703710">regexp</span><span class="op" id="6703716">.</span><span class="ident" id="6703717">MustCompile</span><span class="op" id="6703728">(</span><span class="string" id="6703729">&#34;^&#34;</span>&nbsp;<span class="op" id="6703733">+</span>&nbsp;<span class="ident" id="6703735">regexp</span><span class="op" id="6703741">.</span><span class="ident" id="6703742">QuoteMeta</span><span class="op" id="6703751">(</span><span class="ident" id="6703752">filepath</span><span class="op" id="6703760">.</span><span class="ident" id="6703761">Join</span><span class="op" id="6703765">(</span><span class="ident" id="6703766">dir</span><span class="op" id="6703769">,</span>&nbsp;<span class="string" id="6703771">&#34;ioutil_test&#34;</span><span class="op" id="6703784">)</span><span class="op" id="6703785">)</span>&nbsp;<span class="op" id="6703787">+</span>&nbsp;<span class="string" id="6703789">&#34;[0-9]+$&#34;</span><span class="op" id="6703798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703802">if</span>&nbsp;<span class="op" id="6703805">!</span><span class="ident" id="6703806">re</span><span class="op" id="6703808">.</span><span class="ident" id="6703809">MatchString</span><span class="op" id="6703820">(</span><span class="ident" id="6703821">name</span><span class="op" id="6703825">)</span>&nbsp;<span class="op" id="6703827">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703832">t</span><span class="op" id="6703833">.</span><span class="ident" id="6703834">Errorf</span><span class="op" id="6703840">(</span><span class="string" id="6703841">&#34;TempDir(`&#34;</span><span class="op" id="6703852">+</span><span class="ident" id="6703853">dir</span><span class="op" id="6703856">+</span><span class="string" id="6703857">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="6703896">,</span>&nbsp;<span class="ident" id="6703898">name</span><span class="op" id="6703902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703909">}</span><br>
<span class="lineno"></span><span class="op" id="6703911">}</span>
</div>
</body>
</html>
