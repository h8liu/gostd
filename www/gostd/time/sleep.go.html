<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html" class="current">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2603533">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2603588">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2603642">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2603693">package</span>&nbsp;<span class="ident" id="2603701">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2603707">//&nbsp;Sleep&nbsp;pauses&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;for&nbsp;at&nbsp;least&nbsp;the&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2603774">//&nbsp;A&nbsp;negative&nbsp;or&nbsp;zero&nbsp;duration&nbsp;causes&nbsp;Sleep&nbsp;to&nbsp;return&nbsp;immediately.</span><br>
<span class="lineno"></span><span class="keyword" id="2603841">func</span>&nbsp;<span class="ident" id="2603846">Sleep</span><span class="op" id="2603851">(</span><span class="ident" id="2603852">d</span>&nbsp;<span class="ident" id="2603854">Duration</span><span class="op" id="2603862">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2603865">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2603943">func</span>&nbsp;<span class="ident" id="2603948">runtimeNano</span><span class="op" id="2603959">(</span><span class="op" id="2603960">)</span>&nbsp;<span class="ident" id="2603962">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2603969">//&nbsp;Interface&nbsp;to&nbsp;timers&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno">15</span><span class="comment" id="2604024">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/runtime.h:/^struct.Timer$</span><br>
<span class="lineno"></span><span class="keyword" id="2604085">type</span>&nbsp;<span class="ident" id="2604090">runtimeTimer</span>&nbsp;<span class="keyword" id="2604103">struct</span>&nbsp;<span class="op" id="2604110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604113">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2604120">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604125">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2604132">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604139">period</span>&nbsp;<span class="ident" id="2604146">int64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604153">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2604160">func</span><span class="op" id="2604164">(</span><span class="keyword" id="2604165">interface</span><span class="op" id="2604174">{</span><span class="op" id="2604175">}</span><span class="op" id="2604176">,</span>&nbsp;<span class="builtintype" id="2604178">uintptr</span><span class="op" id="2604185">)</span>&nbsp;<span class="comment" id="2604187">//&nbsp;NOTE:&nbsp;must&nbsp;not&nbsp;be&nbsp;closure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604217">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2604224">interface</span><span class="op" id="2604233">{</span><span class="op" id="2604234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604237">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2604244">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2604252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2604255">//&nbsp;when&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;setting&nbsp;the&nbsp;&#39;when&#39;&nbsp;field&nbsp;of&nbsp;a&nbsp;runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="2604332">//&nbsp;It&nbsp;returns&nbsp;what&nbsp;the&nbsp;time&nbsp;will&nbsp;be,&nbsp;in&nbsp;nanoseconds,&nbsp;Duration&nbsp;d&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="comment" id="2604411">//&nbsp;If&nbsp;d&nbsp;is&nbsp;negative,&nbsp;it&nbsp;is&nbsp;ignored.&nbsp;&nbsp;If&nbsp;the&nbsp;returned&nbsp;value&nbsp;would&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2604489">//&nbsp;zero&nbsp;because&nbsp;of&nbsp;an&nbsp;overflow,&nbsp;MaxInt64&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="2604543">func</span>&nbsp;<span class="ident" id="2604548">when</span><span class="op" id="2604552">(</span><span class="ident" id="2604553">d</span>&nbsp;<span class="ident" id="2604555">Duration</span><span class="op" id="2604563">)</span>&nbsp;<span class="ident" id="2604565">int64</span>&nbsp;<span class="op" id="2604571">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604574">if</span>&nbsp;<span class="ident" id="2604577">d</span>&nbsp;<span class="op" id="2604579">&lt;=</span>&nbsp;<span class="num" id="2604582">0</span>&nbsp;<span class="op" id="2604584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604588">return</span>&nbsp;<span class="ident" id="2604595">runtimeNano</span><span class="op" id="2604606">(</span><span class="op" id="2604607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2604610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604613">t</span>&nbsp;<span class="op" id="2604615">:=</span>&nbsp;<span class="ident" id="2604618">runtimeNano</span><span class="op" id="2604629">(</span><span class="op" id="2604630">)</span>&nbsp;<span class="op" id="2604632">+</span>&nbsp;<span class="ident" id="2604634">int64</span><span class="op" id="2604639">(</span><span class="ident" id="2604640">d</span><span class="op" id="2604641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604644">if</span>&nbsp;<span class="ident" id="2604647">t</span>&nbsp;<span class="op" id="2604649">&lt;</span>&nbsp;<span class="num" id="2604651">0</span>&nbsp;<span class="op" id="2604653">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604657">t</span>&nbsp;<span class="op" id="2604659">=</span>&nbsp;<span class="num" id="2604661">1</span><span class="op" id="2604662">&lt;&lt;</span><span class="num" id="2604664">63</span>&nbsp;<span class="op" id="2604667">-</span>&nbsp;<span class="num" id="2604669">1</span>&nbsp;<span class="comment" id="2604671">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2604689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604692">return</span>&nbsp;<span class="ident" id="2604699">t</span><br>
<span class="lineno"></span><span class="op" id="2604701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2604704">func</span>&nbsp;<span class="ident" id="2604709">startTimer</span><span class="op" id="2604719">(</span><span class="op" id="2604720">*</span><span class="ident" id="2604721">runtimeTimer</span><span class="op" id="2604733">)</span><br>
<span class="lineno"></span><span class="keyword" id="2604735">func</span>&nbsp;<span class="ident" id="2604740">stopTimer</span><span class="op" id="2604749">(</span><span class="op" id="2604750">*</span><span class="ident" id="2604751">runtimeTimer</span><span class="op" id="2604763">)</span>&nbsp;<span class="builtintype" id="2604765">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2604771">//&nbsp;The&nbsp;Timer&nbsp;type&nbsp;represents&nbsp;a&nbsp;single&nbsp;event.</span><br>
<span class="lineno"></span><span class="comment" id="2604816">//&nbsp;When&nbsp;the&nbsp;Timer&nbsp;expires,&nbsp;the&nbsp;current&nbsp;time&nbsp;will&nbsp;be&nbsp;sent&nbsp;on&nbsp;C,</span><br>
<span class="lineno">45</span><span class="comment" id="2604879">//&nbsp;unless&nbsp;the&nbsp;Timer&nbsp;was&nbsp;created&nbsp;by&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="comment" id="2604925">//&nbsp;A&nbsp;Timer&nbsp;must&nbsp;be&nbsp;created&nbsp;with&nbsp;NewTimer&nbsp;or&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="keyword" id="2604980">type</span>&nbsp;<span class="ident" id="2604985">Timer</span>&nbsp;<span class="keyword" id="2604991">struct</span>&nbsp;<span class="op" id="2604998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605001">C</span>&nbsp;<span class="op" id="2605003">&lt;-</span><span class="keyword" id="2605005">chan</span>&nbsp;<span class="ident" id="2605010">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605016">r</span>&nbsp;<span class="ident" id="2605018">runtimeTimer</span><br>
<span class="lineno">50</span><span class="op" id="2605031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2605034">//&nbsp;Stop&nbsp;prevents&nbsp;the&nbsp;Timer&nbsp;from&nbsp;firing.</span><br>
<span class="lineno"></span><span class="comment" id="2605074">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;call&nbsp;stops&nbsp;the&nbsp;timer,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2605153">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno">55</span><span class="comment" id="2605181">//&nbsp;Stop&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;channel,&nbsp;to&nbsp;prevent&nbsp;a&nbsp;read&nbsp;from&nbsp;the&nbsp;channel&nbsp;succeeding</span><br>
<span class="lineno"></span><span class="comment" id="2605263">//&nbsp;incorrectly.</span><br>
<span class="lineno"></span><span class="keyword" id="2605279">func</span>&nbsp;<span class="op" id="2605284">(</span><span class="ident" id="2605285">t</span>&nbsp;<span class="op" id="2605287">*</span><span class="ident" id="2605288">Timer</span><span class="op" id="2605293">)</span>&nbsp;<span class="ident" id="2605295">Stop</span><span class="op" id="2605299">(</span><span class="op" id="2605300">)</span>&nbsp;<span class="builtintype" id="2605302">bool</span>&nbsp;<span class="op" id="2605307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605310">if</span>&nbsp;<span class="ident" id="2605313">t</span><span class="op" id="2605314">.</span><span class="ident" id="2605315">r</span><span class="op" id="2605316">.</span><span class="ident" id="2605317">f</span>&nbsp;<span class="op" id="2605319">==</span>&nbsp;<span class="ident" id="2605322">nil</span>&nbsp;<span class="op" id="2605326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2605330">panic</span><span class="op" id="2605335">(</span><span class="string" id="2605336">&#34;time:&nbsp;Stop&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2605378">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2605381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605384">return</span>&nbsp;<span class="ident" id="2605391">stopTimer</span><span class="op" id="2605400">(</span><span class="op" id="2605401">&amp;</span><span class="ident" id="2605402">t</span><span class="op" id="2605403">.</span><span class="ident" id="2605404">r</span><span class="op" id="2605405">)</span><br>
<span class="lineno"></span><span class="op" id="2605407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2605410">//&nbsp;NewTimer&nbsp;creates&nbsp;a&nbsp;new&nbsp;Timer&nbsp;that&nbsp;will&nbsp;send</span><br>
<span class="lineno">65</span><span class="comment" id="2605457">//&nbsp;the&nbsp;current&nbsp;time&nbsp;on&nbsp;its&nbsp;channel&nbsp;after&nbsp;at&nbsp;least&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="keyword" id="2605519">func</span>&nbsp;<span class="ident" id="2605524">NewTimer</span><span class="op" id="2605532">(</span><span class="ident" id="2605533">d</span>&nbsp;<span class="ident" id="2605535">Duration</span><span class="op" id="2605543">)</span>&nbsp;<span class="op" id="2605545">*</span><span class="ident" id="2605546">Timer</span>&nbsp;<span class="op" id="2605552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605555">c</span>&nbsp;<span class="op" id="2605557">:=</span>&nbsp;<span class="builtinfunc" id="2605560">make</span><span class="op" id="2605564">(</span><span class="keyword" id="2605565">chan</span>&nbsp;<span class="ident" id="2605570">Time</span><span class="op" id="2605574">,</span>&nbsp;<span class="num" id="2605576">1</span><span class="op" id="2605577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605580">t</span>&nbsp;<span class="op" id="2605582">:=</span>&nbsp;<span class="op" id="2605585">&amp;</span><span class="ident" id="2605586">Timer</span><span class="op" id="2605591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605595">C</span><span class="op" id="2605596">:</span>&nbsp;<span class="ident" id="2605598">c</span><span class="op" id="2605599">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605603">r</span><span class="op" id="2605604">:</span>&nbsp;<span class="ident" id="2605606">runtimeTimer</span><span class="op" id="2605618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605623">when</span><span class="op" id="2605627">:</span>&nbsp;<span class="ident" id="2605629">when</span><span class="op" id="2605633">(</span><span class="ident" id="2605634">d</span><span class="op" id="2605635">)</span><span class="op" id="2605636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605641">f</span><span class="op" id="2605642">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2605647">sendTime</span><span class="op" id="2605655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605660">arg</span><span class="op" id="2605663">:</span>&nbsp;&nbsp;<span class="ident" id="2605666">c</span><span class="op" id="2605667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2605671">}</span><span class="op" id="2605672">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2605675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605678">startTimer</span><span class="op" id="2605688">(</span><span class="op" id="2605689">&amp;</span><span class="ident" id="2605690">t</span><span class="op" id="2605691">.</span><span class="ident" id="2605692">r</span><span class="op" id="2605693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605696">return</span>&nbsp;<span class="ident" id="2605703">t</span><br>
<span class="lineno"></span><span class="op" id="2605705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2605708">//&nbsp;Reset&nbsp;changes&nbsp;the&nbsp;timer&nbsp;to&nbsp;expire&nbsp;after&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2605763">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;timer&nbsp;had&nbsp;been&nbsp;active,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;had</span><br>
<span class="lineno"></span><span class="comment" id="2605835">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno"></span><span class="keyword" id="2605863">func</span>&nbsp;<span class="op" id="2605868">(</span><span class="ident" id="2605869">t</span>&nbsp;<span class="op" id="2605871">*</span><span class="ident" id="2605872">Timer</span><span class="op" id="2605877">)</span>&nbsp;<span class="ident" id="2605879">Reset</span><span class="op" id="2605884">(</span><span class="ident" id="2605885">d</span>&nbsp;<span class="ident" id="2605887">Duration</span><span class="op" id="2605895">)</span>&nbsp;<span class="builtintype" id="2605897">bool</span>&nbsp;<span class="op" id="2605902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605905">if</span>&nbsp;<span class="ident" id="2605908">t</span><span class="op" id="2605909">.</span><span class="ident" id="2605910">r</span><span class="op" id="2605911">.</span><span class="ident" id="2605912">f</span>&nbsp;<span class="op" id="2605914">==</span>&nbsp;<span class="ident" id="2605917">nil</span>&nbsp;<span class="op" id="2605921">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2605925">panic</span><span class="op" id="2605930">(</span><span class="string" id="2605931">&#34;time:&nbsp;Reset&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2605974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2605977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605980">w</span>&nbsp;<span class="op" id="2605982">:=</span>&nbsp;<span class="ident" id="2605985">when</span><span class="op" id="2605989">(</span><span class="ident" id="2605990">d</span><span class="op" id="2605991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605994">active</span>&nbsp;<span class="op" id="2606001">:=</span>&nbsp;<span class="ident" id="2606004">stopTimer</span><span class="op" id="2606013">(</span><span class="op" id="2606014">&amp;</span><span class="ident" id="2606015">t</span><span class="op" id="2606016">.</span><span class="ident" id="2606017">r</span><span class="op" id="2606018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606021">t</span><span class="op" id="2606022">.</span><span class="ident" id="2606023">r</span><span class="op" id="2606024">.</span><span class="ident" id="2606025">when</span>&nbsp;<span class="op" id="2606030">=</span>&nbsp;<span class="ident" id="2606032">w</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606035">startTimer</span><span class="op" id="2606045">(</span><span class="op" id="2606046">&amp;</span><span class="ident" id="2606047">t</span><span class="op" id="2606048">.</span><span class="ident" id="2606049">r</span><span class="op" id="2606050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606053">return</span>&nbsp;<span class="ident" id="2606060">active</span><br>
<span class="lineno"></span><span class="op" id="2606067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2606070">func</span>&nbsp;<span class="ident" id="2606075">sendTime</span><span class="op" id="2606083">(</span><span class="ident" id="2606084">c</span>&nbsp;<span class="keyword" id="2606086">interface</span><span class="op" id="2606095">{</span><span class="op" id="2606096">}</span><span class="op" id="2606097">,</span>&nbsp;<span class="ident" id="2606099">seq</span>&nbsp;<span class="builtintype" id="2606103">uintptr</span><span class="op" id="2606110">)</span>&nbsp;<span class="op" id="2606112">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2606115">//&nbsp;Non-blocking&nbsp;send&nbsp;of&nbsp;time&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2606151">//&nbsp;Used&nbsp;in&nbsp;NewTimer,&nbsp;it&nbsp;cannot&nbsp;block&nbsp;anyway&nbsp;(buffer).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2606206">//&nbsp;Used&nbsp;in&nbsp;NewTicker,&nbsp;dropping&nbsp;sends&nbsp;on&nbsp;the&nbsp;floor&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2606260">//&nbsp;the&nbsp;desired&nbsp;behavior&nbsp;when&nbsp;the&nbsp;reader&nbsp;gets&nbsp;behind,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2606314">//&nbsp;because&nbsp;the&nbsp;sends&nbsp;are&nbsp;periodic.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606350">select</span>&nbsp;<span class="op" id="2606357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606360">case</span>&nbsp;<span class="ident" id="2606365">c</span><span class="op" id="2606366">.</span><span class="op" id="2606367">(</span><span class="keyword" id="2606368">chan</span>&nbsp;<span class="ident" id="2606373">Time</span><span class="op" id="2606377">)</span>&nbsp;<span class="op" id="2606379">&lt;-</span>&nbsp;<span class="ident" id="2606382">Now</span><span class="op" id="2606385">(</span><span class="op" id="2606386">)</span><span class="op" id="2606387">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606390">default</span><span class="op" id="2606397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2606400">}</span><br>
<span class="lineno"></span><span class="op" id="2606402">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2606405">//&nbsp;After&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;sends&nbsp;the&nbsp;current&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2606479">//&nbsp;on&nbsp;the&nbsp;returned&nbsp;channel.</span><br>
<span class="lineno"></span><span class="comment" id="2606507">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;NewTimer(d).C.</span><br>
<span class="lineno"></span><span class="keyword" id="2606545">func</span>&nbsp;<span class="ident" id="2606550">After</span><span class="op" id="2606555">(</span><span class="ident" id="2606556">d</span>&nbsp;<span class="ident" id="2606558">Duration</span><span class="op" id="2606566">)</span>&nbsp;<span class="op" id="2606568">&lt;-</span><span class="keyword" id="2606570">chan</span>&nbsp;<span class="ident" id="2606575">Time</span>&nbsp;<span class="op" id="2606580">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606583">return</span>&nbsp;<span class="ident" id="2606590">NewTimer</span><span class="op" id="2606598">(</span><span class="ident" id="2606599">d</span><span class="op" id="2606600">)</span><span class="op" id="2606601">.</span><span class="ident" id="2606602">C</span><br>
<span class="lineno"></span><span class="op" id="2606604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2606607">//&nbsp;AfterFunc&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;calls&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2606670">//&nbsp;in&nbsp;its&nbsp;own&nbsp;goroutine.&nbsp;It&nbsp;returns&nbsp;a&nbsp;Timer&nbsp;that&nbsp;can</span><br>
<span class="lineno">115</span><span class="comment" id="2606723">//&nbsp;be&nbsp;used&nbsp;to&nbsp;cancel&nbsp;the&nbsp;call&nbsp;using&nbsp;its&nbsp;Stop&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2606776">func</span>&nbsp;<span class="ident" id="2606781">AfterFunc</span><span class="op" id="2606790">(</span><span class="ident" id="2606791">d</span>&nbsp;<span class="ident" id="2606793">Duration</span><span class="op" id="2606801">,</span>&nbsp;<span class="ident" id="2606803">f</span>&nbsp;<span class="keyword" id="2606805">func</span><span class="op" id="2606809">(</span><span class="op" id="2606810">)</span><span class="op" id="2606811">)</span>&nbsp;<span class="op" id="2606813">*</span><span class="ident" id="2606814">Timer</span>&nbsp;<span class="op" id="2606820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606823">t</span>&nbsp;<span class="op" id="2606825">:=</span>&nbsp;<span class="op" id="2606828">&amp;</span><span class="ident" id="2606829">Timer</span><span class="op" id="2606834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606838">r</span><span class="op" id="2606839">:</span>&nbsp;<span class="ident" id="2606841">runtimeTimer</span><span class="op" id="2606853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606858">when</span><span class="op" id="2606862">:</span>&nbsp;<span class="ident" id="2606864">when</span><span class="op" id="2606868">(</span><span class="ident" id="2606869">d</span><span class="op" id="2606870">)</span><span class="op" id="2606871">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606876">f</span><span class="op" id="2606877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2606882">goFunc</span><span class="op" id="2606888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606893">arg</span><span class="op" id="2606896">:</span>&nbsp;&nbsp;<span class="ident" id="2606899">f</span><span class="op" id="2606900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2606904">}</span><span class="op" id="2606905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2606908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606911">startTimer</span><span class="op" id="2606921">(</span><span class="op" id="2606922">&amp;</span><span class="ident" id="2606923">t</span><span class="op" id="2606924">.</span><span class="ident" id="2606925">r</span><span class="op" id="2606926">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606929">return</span>&nbsp;<span class="ident" id="2606936">t</span><br>
<span class="lineno"></span><span class="op" id="2606938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2606941">func</span>&nbsp;<span class="ident" id="2606946">goFunc</span><span class="op" id="2606952">(</span><span class="ident" id="2606953">arg</span>&nbsp;<span class="keyword" id="2606957">interface</span><span class="op" id="2606966">{</span><span class="op" id="2606967">}</span><span class="op" id="2606968">,</span>&nbsp;<span class="ident" id="2606970">seq</span>&nbsp;<span class="builtintype" id="2606974">uintptr</span><span class="op" id="2606981">)</span>&nbsp;<span class="op" id="2606983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606986">go</span>&nbsp;<span class="ident" id="2606989">arg</span><span class="op" id="2606992">.</span><span class="op" id="2606993">(</span><span class="keyword" id="2606994">func</span><span class="op" id="2606998">(</span><span class="op" id="2606999">)</span><span class="op" id="2607000">)</span><span class="op" id="2607001">(</span><span class="op" id="2607002">)</span><br>
<span class="lineno">130</span><span class="op" id="2607004">}</span>
</div>
</body>
</html>
