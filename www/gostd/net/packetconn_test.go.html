<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html" class="current">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6728507">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6728563">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6728617">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6728668">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="6728747">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6728756">package</span>&nbsp;<span class="ident" id="6728764">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6728769">import</span>&nbsp;<span class="op" id="6728776">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6728779">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6728785">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6728796">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6728807">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6728818">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6728825">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6728828">func</span>&nbsp;<span class="ident" id="6728833">packetConnTestData</span><span class="op" id="6728851">(</span><span class="ident" id="6728852">t</span>&nbsp;<span class="op" id="6728854">*</span><span class="ident" id="6728855">testing</span><span class="op" id="6728862">.</span><span class="ident" id="6728863">T</span><span class="op" id="6728864">,</span>&nbsp;<span class="ident" id="6728866">net</span>&nbsp;<span class="builtintype" id="6728870">string</span><span class="op" id="6728876">,</span>&nbsp;<span class="ident" id="6728878">i</span>&nbsp;<span class="builtintype" id="6728880">int</span><span class="op" id="6728883">)</span>&nbsp;<span class="op" id="6728885">(</span><span class="op" id="6728886">[</span><span class="op" id="6728887">]</span><span class="builtintype" id="6728888">byte</span><span class="op" id="6728892">,</span>&nbsp;<span class="keyword" id="6728894">func</span><span class="op" id="6728898">(</span><span class="op" id="6728899">)</span><span class="op" id="6728900">)</span>&nbsp;<span class="op" id="6728902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728905">switch</span>&nbsp;<span class="ident" id="6728912">net</span>&nbsp;<span class="op" id="6728916">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728919">case</span>&nbsp;<span class="string" id="6728924">&#34;udp&#34;</span><span class="op" id="6728929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728933">return</span>&nbsp;<span class="op" id="6728940">[</span><span class="op" id="6728941">]</span><span class="builtintype" id="6728942">byte</span><span class="op" id="6728946">(</span><span class="string" id="6728947">&#34;UDP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6728968">)</span><span class="op" id="6728969">,</span>&nbsp;<span class="builtintype" id="6728971">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728976">case</span>&nbsp;<span class="string" id="6728981">&#34;ip&#34;</span><span class="op" id="6728985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728989">if</span>&nbsp;<span class="ident" id="6728992">skip</span><span class="op" id="6728996">,</span>&nbsp;<span class="ident" id="6728998">skipmsg</span>&nbsp;<span class="op" id="6729006">:=</span>&nbsp;<span class="ident" id="6729009">skipRawSocketTest</span><span class="op" id="6729026">(</span><span class="ident" id="6729027">t</span><span class="op" id="6729028">)</span><span class="op" id="6729029">;</span>&nbsp;<span class="ident" id="6729031">skip</span>&nbsp;<span class="op" id="6729036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729041">return</span>&nbsp;<span class="builtintype" id="6729048">nil</span><span class="op" id="6729051">,</span>&nbsp;<span class="keyword" id="6729053">func</span><span class="op" id="6729057">(</span><span class="op" id="6729058">)</span>&nbsp;<span class="op" id="6729060">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729066">t</span><span class="op" id="6729067">.</span><span class="ident" id="6729068">Logf</span><span class="op" id="6729072">(</span><span class="ident" id="6729073">skipmsg</span><span class="op" id="6729080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729093">b</span><span class="op" id="6729094">,</span>&nbsp;<span class="ident" id="6729096">err</span>&nbsp;<span class="op" id="6729100">:=</span>&nbsp;<span class="op" id="6729103">(</span><span class="op" id="6729104">&amp;</span><span class="ident" id="6729105">icmpMessage</span><span class="op" id="6729116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729121">Type</span><span class="op" id="6729125">:</span>&nbsp;<span class="ident" id="6729127">icmpv4EchoRequest</span><span class="op" id="6729144">,</span>&nbsp;<span class="ident" id="6729146">Code</span><span class="op" id="6729150">:</span>&nbsp;<span class="num" id="6729152">0</span><span class="op" id="6729153">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729158">Body</span><span class="op" id="6729162">:</span>&nbsp;<span class="op" id="6729164">&amp;</span><span class="ident" id="6729165">icmpEcho</span><span class="op" id="6729173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729179">ID</span><span class="op" id="6729181">:</span>&nbsp;<span class="ident" id="6729183">os</span><span class="op" id="6729185">.</span><span class="ident" id="6729186">Getpid</span><span class="op" id="6729192">(</span><span class="op" id="6729193">)</span>&nbsp;<span class="op" id="6729195">&amp;</span>&nbsp;<span class="num" id="6729197">0xffff</span><span class="op" id="6729203">,</span>&nbsp;<span class="ident" id="6729205">Seq</span><span class="op" id="6729208">:</span>&nbsp;<span class="ident" id="6729210">i</span>&nbsp;<span class="op" id="6729212">+</span>&nbsp;<span class="num" id="6729214">1</span><span class="op" id="6729215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729221">Data</span><span class="op" id="6729225">:</span>&nbsp;<span class="op" id="6729227">[</span><span class="op" id="6729228">]</span><span class="builtintype" id="6729229">byte</span><span class="op" id="6729233">(</span><span class="string" id="6729234">&#34;IP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6729254">)</span><span class="op" id="6729255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729260">}</span><span class="op" id="6729261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729265">}</span><span class="op" id="6729266">)</span><span class="op" id="6729267">.</span><span class="ident" id="6729268">Marshal</span><span class="op" id="6729275">(</span><span class="op" id="6729276">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729280">if</span>&nbsp;<span class="ident" id="6729283">err</span>&nbsp;<span class="op" id="6729287">!=</span>&nbsp;<span class="builtintype" id="6729290">nil</span>&nbsp;<span class="op" id="6729294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729299">return</span>&nbsp;<span class="builtintype" id="6729306">nil</span><span class="op" id="6729309">,</span>&nbsp;<span class="keyword" id="6729311">func</span><span class="op" id="6729315">(</span><span class="op" id="6729316">)</span>&nbsp;<span class="op" id="6729318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729324">t</span><span class="op" id="6729325">.</span><span class="ident" id="6729326">Fatalf</span><span class="op" id="6729332">(</span><span class="string" id="6729333">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6729365">,</span>&nbsp;<span class="ident" id="6729367">err</span><span class="op" id="6729370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729379">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729383">return</span>&nbsp;<span class="ident" id="6729390">b</span><span class="op" id="6729391">,</span>&nbsp;<span class="builtintype" id="6729393">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729398">case</span>&nbsp;<span class="string" id="6729403">&#34;unixgram&#34;</span><span class="op" id="6729413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729417">switch</span>&nbsp;<span class="ident" id="6729424">runtime</span><span class="op" id="6729431">.</span><span class="ident" id="6729432">GOOS</span>&nbsp;<span class="op" id="6729437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729441">case</span>&nbsp;<span class="string" id="6729446">&#34;nacl&#34;</span><span class="op" id="6729452">,</span>&nbsp;<span class="string" id="6729454">&#34;plan9&#34;</span><span class="op" id="6729461">,</span>&nbsp;<span class="string" id="6729463">&#34;windows&#34;</span><span class="op" id="6729472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729477">return</span>&nbsp;<span class="builtintype" id="6729484">nil</span><span class="op" id="6729487">,</span>&nbsp;<span class="keyword" id="6729489">func</span><span class="op" id="6729493">(</span><span class="op" id="6729494">)</span>&nbsp;<span class="op" id="6729496">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729502">t</span><span class="op" id="6729503">.</span><span class="ident" id="6729504">Logf</span><span class="op" id="6729508">(</span><span class="string" id="6729509">&#34;skipping&nbsp;%q&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6729533">,</span>&nbsp;<span class="ident" id="6729535">net</span><span class="op" id="6729538">,</span>&nbsp;<span class="ident" id="6729540">runtime</span><span class="op" id="6729547">.</span><span class="ident" id="6729548">GOOS</span><span class="op" id="6729552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729561">default</span><span class="op" id="6729568">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729573">return</span>&nbsp;<span class="op" id="6729580">[</span><span class="op" id="6729581">]</span><span class="builtintype" id="6729582">byte</span><span class="op" id="6729586">(</span><span class="string" id="6729587">&#34;UNIXGRAM&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6729613">)</span><span class="op" id="6729614">,</span>&nbsp;<span class="builtintype" id="6729616">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729622">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729625">default</span><span class="op" id="6729632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6729636">return</span>&nbsp;<span class="builtintype" id="6729643">nil</span><span class="op" id="6729646">,</span>&nbsp;<span class="keyword" id="6729648">func</span><span class="op" id="6729652">(</span><span class="op" id="6729653">)</span>&nbsp;<span class="op" id="6729655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729660">t</span><span class="op" id="6729661">.</span><span class="ident" id="6729662">Logf</span><span class="op" id="6729666">(</span><span class="string" id="6729667">&#34;skipping&nbsp;%q&nbsp;test&#34;</span><span class="op" id="6729685">,</span>&nbsp;<span class="ident" id="6729687">net</span><span class="op" id="6729690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729697">}</span><br>
<span class="lineno">55</span><span class="op" id="6729699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6729702">var</span>&nbsp;<span class="ident" id="6729706">packetConnTests</span>&nbsp;<span class="op" id="6729722">=</span>&nbsp;<span class="op" id="6729724">[</span><span class="op" id="6729725">]</span><span class="keyword" id="6729726">struct</span>&nbsp;<span class="op" id="6729733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729736">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6729742">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729750">addr1</span>&nbsp;<span class="builtintype" id="6729756">string</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729764">addr2</span>&nbsp;<span class="builtintype" id="6729770">string</span><br>
<span class="lineno"></span><span class="op" id="6729777">}</span><span class="op" id="6729778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729781">{</span><span class="string" id="6729782">&#34;udp&#34;</span><span class="op" id="6729787">,</span>&nbsp;<span class="string" id="6729789">&#34;127.0.0.1:0&#34;</span><span class="op" id="6729802">,</span>&nbsp;<span class="string" id="6729804">&#34;127.0.0.1:0&#34;</span><span class="op" id="6729817">}</span><span class="op" id="6729818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729821">{</span><span class="string" id="6729822">&#34;ip:icmp&#34;</span><span class="op" id="6729831">,</span>&nbsp;<span class="string" id="6729833">&#34;127.0.0.1&#34;</span><span class="op" id="6729844">,</span>&nbsp;<span class="string" id="6729846">&#34;127.0.0.1&#34;</span><span class="op" id="6729857">}</span><span class="op" id="6729858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6729861">{</span><span class="string" id="6729862">&#34;unixgram&#34;</span><span class="op" id="6729872">,</span>&nbsp;<span class="ident" id="6729874">testUnixAddr</span><span class="op" id="6729886">(</span><span class="op" id="6729887">)</span><span class="op" id="6729888">,</span>&nbsp;<span class="ident" id="6729890">testUnixAddr</span><span class="op" id="6729902">(</span><span class="op" id="6729903">)</span><span class="op" id="6729904">}</span><span class="op" id="6729905">,</span><br>
<span class="lineno">65</span><span class="op" id="6729907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6729910">func</span>&nbsp;<span class="ident" id="6729915">TestPacketConn</span><span class="op" id="6729929">(</span><span class="ident" id="6729930">t</span>&nbsp;<span class="op" id="6729932">*</span><span class="ident" id="6729933">testing</span><span class="op" id="6729940">.</span><span class="ident" id="6729941">T</span><span class="op" id="6729942">)</span>&nbsp;<span class="op" id="6729944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6729947">closer</span>&nbsp;<span class="op" id="6729954">:=</span>&nbsp;<span class="keyword" id="6729957">func</span><span class="op" id="6729961">(</span><span class="ident" id="6729962">c</span>&nbsp;<span class="ident" id="6729964">PacketConn</span><span class="op" id="6729974">,</span>&nbsp;<span class="ident" id="6729976">net</span><span class="op" id="6729979">,</span>&nbsp;<span class="ident" id="6729981">addr1</span><span class="op" id="6729986">,</span>&nbsp;<span class="ident" id="6729988">addr2</span>&nbsp;<span class="builtintype" id="6729994">string</span><span class="op" id="6730000">)</span>&nbsp;<span class="op" id="6730002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730006">c</span><span class="op" id="6730007">.</span><span class="ident" id="6730008">Close</span><span class="op" id="6730013">(</span><span class="op" id="6730014">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730018">switch</span>&nbsp;<span class="ident" id="6730025">net</span>&nbsp;<span class="op" id="6730029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730033">case</span>&nbsp;<span class="string" id="6730038">&#34;unixgram&#34;</span><span class="op" id="6730048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730053">os</span><span class="op" id="6730055">.</span><span class="ident" id="6730056">Remove</span><span class="op" id="6730062">(</span><span class="ident" id="6730063">addr1</span><span class="op" id="6730068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730073">os</span><span class="op" id="6730075">.</span><span class="ident" id="6730076">Remove</span><span class="op" id="6730082">(</span><span class="ident" id="6730083">addr2</span><span class="op" id="6730088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6730092">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6730095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730099">for</span>&nbsp;<span class="ident" id="6730103">i</span><span class="op" id="6730104">,</span>&nbsp;<span class="ident" id="6730106">tt</span>&nbsp;<span class="op" id="6730109">:=</span>&nbsp;<span class="keyword" id="6730112">range</span>&nbsp;<span class="ident" id="6730118">packetConnTests</span>&nbsp;<span class="op" id="6730134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730138">netstr</span>&nbsp;<span class="op" id="6730145">:=</span>&nbsp;<span class="ident" id="6730148">strings</span><span class="op" id="6730155">.</span><span class="ident" id="6730156">Split</span><span class="op" id="6730161">(</span><span class="ident" id="6730162">tt</span><span class="op" id="6730164">.</span><span class="ident" id="6730165">net</span><span class="op" id="6730168">,</span>&nbsp;<span class="string" id="6730170">&#34;:&#34;</span><span class="op" id="6730173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730177">wb</span><span class="op" id="6730179">,</span>&nbsp;<span class="ident" id="6730181">skipOrFatalFn</span>&nbsp;<span class="op" id="6730195">:=</span>&nbsp;<span class="ident" id="6730198">packetConnTestData</span><span class="op" id="6730216">(</span><span class="ident" id="6730217">t</span><span class="op" id="6730218">,</span>&nbsp;<span class="ident" id="6730220">netstr</span><span class="op" id="6730226">[</span><span class="num" id="6730227">0</span><span class="op" id="6730228">]</span><span class="op" id="6730229">,</span>&nbsp;<span class="ident" id="6730231">i</span><span class="op" id="6730232">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730236">if</span>&nbsp;<span class="ident" id="6730239">skipOrFatalFn</span>&nbsp;<span class="op" id="6730253">!=</span>&nbsp;<span class="builtintype" id="6730256">nil</span>&nbsp;<span class="op" id="6730260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730265">skipOrFatalFn</span><span class="op" id="6730278">(</span><span class="op" id="6730279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730284">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6730295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730300">c1</span><span class="op" id="6730302">,</span>&nbsp;<span class="ident" id="6730304">err</span>&nbsp;<span class="op" id="6730308">:=</span>&nbsp;<span class="ident" id="6730311">ListenPacket</span><span class="op" id="6730323">(</span><span class="ident" id="6730324">tt</span><span class="op" id="6730326">.</span><span class="ident" id="6730327">net</span><span class="op" id="6730330">,</span>&nbsp;<span class="ident" id="6730332">tt</span><span class="op" id="6730334">.</span><span class="ident" id="6730335">addr1</span><span class="op" id="6730340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730344">if</span>&nbsp;<span class="ident" id="6730347">err</span>&nbsp;<span class="op" id="6730351">!=</span>&nbsp;<span class="builtintype" id="6730354">nil</span>&nbsp;<span class="op" id="6730358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730363">t</span><span class="op" id="6730364">.</span><span class="ident" id="6730365">Fatalf</span><span class="op" id="6730371">(</span><span class="string" id="6730372">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6730397">,</span>&nbsp;<span class="ident" id="6730399">err</span><span class="op" id="6730402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6730406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730410">defer</span>&nbsp;<span class="ident" id="6730416">closer</span><span class="op" id="6730422">(</span><span class="ident" id="6730423">c1</span><span class="op" id="6730425">,</span>&nbsp;<span class="ident" id="6730427">netstr</span><span class="op" id="6730433">[</span><span class="num" id="6730434">0</span><span class="op" id="6730435">]</span><span class="op" id="6730436">,</span>&nbsp;<span class="ident" id="6730438">tt</span><span class="op" id="6730440">.</span><span class="ident" id="6730441">addr1</span><span class="op" id="6730446">,</span>&nbsp;<span class="ident" id="6730448">tt</span><span class="op" id="6730450">.</span><span class="ident" id="6730451">addr2</span><span class="op" id="6730456">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730460">c1</span><span class="op" id="6730462">.</span><span class="ident" id="6730463">LocalAddr</span><span class="op" id="6730472">(</span><span class="op" id="6730473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730477">c1</span><span class="op" id="6730479">.</span><span class="ident" id="6730480">SetDeadline</span><span class="op" id="6730491">(</span><span class="ident" id="6730492">time</span><span class="op" id="6730496">.</span><span class="ident" id="6730497">Now</span><span class="op" id="6730500">(</span><span class="op" id="6730501">)</span><span class="op" id="6730502">.</span><span class="ident" id="6730503">Add</span><span class="op" id="6730506">(</span><span class="num" id="6730507">100</span>&nbsp;<span class="op" id="6730511">*</span>&nbsp;<span class="ident" id="6730513">time</span><span class="op" id="6730517">.</span><span class="ident" id="6730518">Millisecond</span><span class="op" id="6730529">)</span><span class="op" id="6730530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730534">c1</span><span class="op" id="6730536">.</span><span class="ident" id="6730537">SetReadDeadline</span><span class="op" id="6730552">(</span><span class="ident" id="6730553">time</span><span class="op" id="6730557">.</span><span class="ident" id="6730558">Now</span><span class="op" id="6730561">(</span><span class="op" id="6730562">)</span><span class="op" id="6730563">.</span><span class="ident" id="6730564">Add</span><span class="op" id="6730567">(</span><span class="num" id="6730568">100</span>&nbsp;<span class="op" id="6730572">*</span>&nbsp;<span class="ident" id="6730574">time</span><span class="op" id="6730578">.</span><span class="ident" id="6730579">Millisecond</span><span class="op" id="6730590">)</span><span class="op" id="6730591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730595">c1</span><span class="op" id="6730597">.</span><span class="ident" id="6730598">SetWriteDeadline</span><span class="op" id="6730614">(</span><span class="ident" id="6730615">time</span><span class="op" id="6730619">.</span><span class="ident" id="6730620">Now</span><span class="op" id="6730623">(</span><span class="op" id="6730624">)</span><span class="op" id="6730625">.</span><span class="ident" id="6730626">Add</span><span class="op" id="6730629">(</span><span class="num" id="6730630">100</span>&nbsp;<span class="op" id="6730634">*</span>&nbsp;<span class="ident" id="6730636">time</span><span class="op" id="6730640">.</span><span class="ident" id="6730641">Millisecond</span><span class="op" id="6730652">)</span><span class="op" id="6730653">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730658">c2</span><span class="op" id="6730660">,</span>&nbsp;<span class="ident" id="6730662">err</span>&nbsp;<span class="op" id="6730666">:=</span>&nbsp;<span class="ident" id="6730669">ListenPacket</span><span class="op" id="6730681">(</span><span class="ident" id="6730682">tt</span><span class="op" id="6730684">.</span><span class="ident" id="6730685">net</span><span class="op" id="6730688">,</span>&nbsp;<span class="ident" id="6730690">tt</span><span class="op" id="6730692">.</span><span class="ident" id="6730693">addr2</span><span class="op" id="6730698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730702">if</span>&nbsp;<span class="ident" id="6730705">err</span>&nbsp;<span class="op" id="6730709">!=</span>&nbsp;<span class="builtintype" id="6730712">nil</span>&nbsp;<span class="op" id="6730716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730721">t</span><span class="op" id="6730722">.</span><span class="ident" id="6730723">Fatalf</span><span class="op" id="6730729">(</span><span class="string" id="6730730">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6730755">,</span>&nbsp;<span class="ident" id="6730757">err</span><span class="op" id="6730760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6730764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6730768">defer</span>&nbsp;<span class="ident" id="6730774">closer</span><span class="op" id="6730780">(</span><span class="ident" id="6730781">c2</span><span class="op" id="6730783">,</span>&nbsp;<span class="ident" id="6730785">netstr</span><span class="op" id="6730791">[</span><span class="num" id="6730792">0</span><span class="op" id="6730793">]</span><span class="op" id="6730794">,</span>&nbsp;<span class="ident" id="6730796">tt</span><span class="op" id="6730798">.</span><span class="ident" id="6730799">addr1</span><span class="op" id="6730804">,</span>&nbsp;<span class="ident" id="6730806">tt</span><span class="op" id="6730808">.</span><span class="ident" id="6730809">addr2</span><span class="op" id="6730814">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730818">c2</span><span class="op" id="6730820">.</span><span class="ident" id="6730821">LocalAddr</span><span class="op" id="6730830">(</span><span class="op" id="6730831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730835">c2</span><span class="op" id="6730837">.</span><span class="ident" id="6730838">SetDeadline</span><span class="op" id="6730849">(</span><span class="ident" id="6730850">time</span><span class="op" id="6730854">.</span><span class="ident" id="6730855">Now</span><span class="op" id="6730858">(</span><span class="op" id="6730859">)</span><span class="op" id="6730860">.</span><span class="ident" id="6730861">Add</span><span class="op" id="6730864">(</span><span class="num" id="6730865">100</span>&nbsp;<span class="op" id="6730869">*</span>&nbsp;<span class="ident" id="6730871">time</span><span class="op" id="6730875">.</span><span class="ident" id="6730876">Millisecond</span><span class="op" id="6730887">)</span><span class="op" id="6730888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730892">c2</span><span class="op" id="6730894">.</span><span class="ident" id="6730895">SetReadDeadline</span><span class="op" id="6730910">(</span><span class="ident" id="6730911">time</span><span class="op" id="6730915">.</span><span class="ident" id="6730916">Now</span><span class="op" id="6730919">(</span><span class="op" id="6730920">)</span><span class="op" id="6730921">.</span><span class="ident" id="6730922">Add</span><span class="op" id="6730925">(</span><span class="num" id="6730926">100</span>&nbsp;<span class="op" id="6730930">*</span>&nbsp;<span class="ident" id="6730932">time</span><span class="op" id="6730936">.</span><span class="ident" id="6730937">Millisecond</span><span class="op" id="6730948">)</span><span class="op" id="6730949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6730953">c2</span><span class="op" id="6730955">.</span><span class="ident" id="6730956">SetWriteDeadline</span><span class="op" id="6730972">(</span><span class="ident" id="6730973">time</span><span class="op" id="6730977">.</span><span class="ident" id="6730978">Now</span><span class="op" id="6730981">(</span><span class="op" id="6730982">)</span><span class="op" id="6730983">.</span><span class="ident" id="6730984">Add</span><span class="op" id="6730987">(</span><span class="num" id="6730988">100</span>&nbsp;<span class="op" id="6730992">*</span>&nbsp;<span class="ident" id="6730994">time</span><span class="op" id="6730998">.</span><span class="ident" id="6730999">Millisecond</span><span class="op" id="6731010">)</span><span class="op" id="6731011">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731016">if</span>&nbsp;<span class="ident" id="6731019">_</span><span class="op" id="6731020">,</span>&nbsp;<span class="ident" id="6731022">err</span>&nbsp;<span class="op" id="6731026">:=</span>&nbsp;<span class="ident" id="6731029">c1</span><span class="op" id="6731031">.</span><span class="ident" id="6731032">WriteTo</span><span class="op" id="6731039">(</span><span class="ident" id="6731040">wb</span><span class="op" id="6731042">,</span>&nbsp;<span class="ident" id="6731044">c2</span><span class="op" id="6731046">.</span><span class="ident" id="6731047">LocalAddr</span><span class="op" id="6731056">(</span><span class="op" id="6731057">)</span><span class="op" id="6731058">)</span><span class="op" id="6731059">;</span>&nbsp;<span class="ident" id="6731061">err</span>&nbsp;<span class="op" id="6731065">!=</span>&nbsp;<span class="builtintype" id="6731068">nil</span>&nbsp;<span class="op" id="6731072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731077">t</span><span class="op" id="6731078">.</span><span class="ident" id="6731079">Fatalf</span><span class="op" id="6731085">(</span><span class="string" id="6731086">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6731117">,</span>&nbsp;<span class="ident" id="6731119">err</span><span class="op" id="6731122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6731126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731130">rb2</span>&nbsp;<span class="op" id="6731134">:=</span>&nbsp;<span class="builtinfunc" id="6731137">make</span><span class="op" id="6731141">(</span><span class="op" id="6731142">[</span><span class="op" id="6731143">]</span><span class="builtintype" id="6731144">byte</span><span class="op" id="6731148">,</span>&nbsp;<span class="num" id="6731150">128</span><span class="op" id="6731153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731157">if</span>&nbsp;<span class="ident" id="6731160">_</span><span class="op" id="6731161">,</span>&nbsp;<span class="ident" id="6731163">_</span><span class="op" id="6731164">,</span>&nbsp;<span class="ident" id="6731166">err</span>&nbsp;<span class="op" id="6731170">:=</span>&nbsp;<span class="ident" id="6731173">c2</span><span class="op" id="6731175">.</span><span class="ident" id="6731176">ReadFrom</span><span class="op" id="6731184">(</span><span class="ident" id="6731185">rb2</span><span class="op" id="6731188">)</span><span class="op" id="6731189">;</span>&nbsp;<span class="ident" id="6731191">err</span>&nbsp;<span class="op" id="6731195">!=</span>&nbsp;<span class="builtintype" id="6731198">nil</span>&nbsp;<span class="op" id="6731202">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731207">t</span><span class="op" id="6731208">.</span><span class="ident" id="6731209">Fatalf</span><span class="op" id="6731215">(</span><span class="string" id="6731216">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6731248">,</span>&nbsp;<span class="ident" id="6731250">err</span><span class="op" id="6731253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6731257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731261">if</span>&nbsp;<span class="ident" id="6731264">_</span><span class="op" id="6731265">,</span>&nbsp;<span class="ident" id="6731267">err</span>&nbsp;<span class="op" id="6731271">:=</span>&nbsp;<span class="ident" id="6731274">c2</span><span class="op" id="6731276">.</span><span class="ident" id="6731277">WriteTo</span><span class="op" id="6731284">(</span><span class="ident" id="6731285">wb</span><span class="op" id="6731287">,</span>&nbsp;<span class="ident" id="6731289">c1</span><span class="op" id="6731291">.</span><span class="ident" id="6731292">LocalAddr</span><span class="op" id="6731301">(</span><span class="op" id="6731302">)</span><span class="op" id="6731303">)</span><span class="op" id="6731304">;</span>&nbsp;<span class="ident" id="6731306">err</span>&nbsp;<span class="op" id="6731310">!=</span>&nbsp;<span class="builtintype" id="6731313">nil</span>&nbsp;<span class="op" id="6731317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731322">t</span><span class="op" id="6731323">.</span><span class="ident" id="6731324">Fatalf</span><span class="op" id="6731330">(</span><span class="string" id="6731331">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6731362">,</span>&nbsp;<span class="ident" id="6731364">err</span><span class="op" id="6731367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6731371">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731375">rb1</span>&nbsp;<span class="op" id="6731379">:=</span>&nbsp;<span class="builtinfunc" id="6731382">make</span><span class="op" id="6731386">(</span><span class="op" id="6731387">[</span><span class="op" id="6731388">]</span><span class="builtintype" id="6731389">byte</span><span class="op" id="6731393">,</span>&nbsp;<span class="num" id="6731395">128</span><span class="op" id="6731398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731402">if</span>&nbsp;<span class="ident" id="6731405">_</span><span class="op" id="6731406">,</span>&nbsp;<span class="ident" id="6731408">_</span><span class="op" id="6731409">,</span>&nbsp;<span class="ident" id="6731411">err</span>&nbsp;<span class="op" id="6731415">:=</span>&nbsp;<span class="ident" id="6731418">c1</span><span class="op" id="6731420">.</span><span class="ident" id="6731421">ReadFrom</span><span class="op" id="6731429">(</span><span class="ident" id="6731430">rb1</span><span class="op" id="6731433">)</span><span class="op" id="6731434">;</span>&nbsp;<span class="ident" id="6731436">err</span>&nbsp;<span class="op" id="6731440">!=</span>&nbsp;<span class="builtintype" id="6731443">nil</span>&nbsp;<span class="op" id="6731447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731452">t</span><span class="op" id="6731453">.</span><span class="ident" id="6731454">Fatalf</span><span class="op" id="6731460">(</span><span class="string" id="6731461">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6731493">,</span>&nbsp;<span class="ident" id="6731495">err</span><span class="op" id="6731498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6731502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6731505">}</span><br>
<span class="lineno">120</span><span class="op" id="6731507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6731510">func</span>&nbsp;<span class="ident" id="6731515">TestConnAndPacketConn</span><span class="op" id="6731536">(</span><span class="ident" id="6731537">t</span>&nbsp;<span class="op" id="6731539">*</span><span class="ident" id="6731540">testing</span><span class="op" id="6731547">.</span><span class="ident" id="6731548">T</span><span class="op" id="6731549">)</span>&nbsp;<span class="op" id="6731551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731554">closer</span>&nbsp;<span class="op" id="6731561">:=</span>&nbsp;<span class="keyword" id="6731564">func</span><span class="op" id="6731568">(</span><span class="ident" id="6731569">c</span>&nbsp;<span class="ident" id="6731571">PacketConn</span><span class="op" id="6731581">,</span>&nbsp;<span class="ident" id="6731583">net</span><span class="op" id="6731586">,</span>&nbsp;<span class="ident" id="6731588">addr1</span><span class="op" id="6731593">,</span>&nbsp;<span class="ident" id="6731595">addr2</span>&nbsp;<span class="builtintype" id="6731601">string</span><span class="op" id="6731607">)</span>&nbsp;<span class="op" id="6731609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731613">c</span><span class="op" id="6731614">.</span><span class="ident" id="6731615">Close</span><span class="op" id="6731620">(</span><span class="op" id="6731621">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731625">switch</span>&nbsp;<span class="ident" id="6731632">net</span>&nbsp;<span class="op" id="6731636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731640">case</span>&nbsp;<span class="string" id="6731645">&#34;unixgram&#34;</span><span class="op" id="6731655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731660">os</span><span class="op" id="6731662">.</span><span class="ident" id="6731663">Remove</span><span class="op" id="6731669">(</span><span class="ident" id="6731670">addr1</span><span class="op" id="6731675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731680">os</span><span class="op" id="6731682">.</span><span class="ident" id="6731683">Remove</span><span class="op" id="6731689">(</span><span class="ident" id="6731690">addr2</span><span class="op" id="6731695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6731699">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6731702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731706">for</span>&nbsp;<span class="ident" id="6731710">i</span><span class="op" id="6731711">,</span>&nbsp;<span class="ident" id="6731713">tt</span>&nbsp;<span class="op" id="6731716">:=</span>&nbsp;<span class="keyword" id="6731719">range</span>&nbsp;<span class="ident" id="6731725">packetConnTests</span>&nbsp;<span class="op" id="6731741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731745">var</span>&nbsp;<span class="ident" id="6731749">wb</span>&nbsp;<span class="op" id="6731752">[</span><span class="op" id="6731753">]</span><span class="builtintype" id="6731754">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731761">netstr</span>&nbsp;<span class="op" id="6731768">:=</span>&nbsp;<span class="ident" id="6731771">strings</span><span class="op" id="6731778">.</span><span class="ident" id="6731779">Split</span><span class="op" id="6731784">(</span><span class="ident" id="6731785">tt</span><span class="op" id="6731787">.</span><span class="ident" id="6731788">net</span><span class="op" id="6731791">,</span>&nbsp;<span class="string" id="6731793">&#34;:&#34;</span><span class="op" id="6731796">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731800">wb</span><span class="op" id="6731802">,</span>&nbsp;<span class="ident" id="6731804">skipOrFatalFn</span>&nbsp;<span class="op" id="6731818">:=</span>&nbsp;<span class="ident" id="6731821">packetConnTestData</span><span class="op" id="6731839">(</span><span class="ident" id="6731840">t</span><span class="op" id="6731841">,</span>&nbsp;<span class="ident" id="6731843">netstr</span><span class="op" id="6731849">[</span><span class="num" id="6731850">0</span><span class="op" id="6731851">]</span><span class="op" id="6731852">,</span>&nbsp;<span class="ident" id="6731854">i</span><span class="op" id="6731855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731859">if</span>&nbsp;<span class="ident" id="6731862">skipOrFatalFn</span>&nbsp;<span class="op" id="6731876">!=</span>&nbsp;<span class="builtintype" id="6731879">nil</span>&nbsp;<span class="op" id="6731883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731888">skipOrFatalFn</span><span class="op" id="6731901">(</span><span class="op" id="6731902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731907">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6731918">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731923">c1</span><span class="op" id="6731925">,</span>&nbsp;<span class="ident" id="6731927">err</span>&nbsp;<span class="op" id="6731931">:=</span>&nbsp;<span class="ident" id="6731934">ListenPacket</span><span class="op" id="6731946">(</span><span class="ident" id="6731947">tt</span><span class="op" id="6731949">.</span><span class="ident" id="6731950">net</span><span class="op" id="6731953">,</span>&nbsp;<span class="ident" id="6731955">tt</span><span class="op" id="6731957">.</span><span class="ident" id="6731958">addr1</span><span class="op" id="6731963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6731967">if</span>&nbsp;<span class="ident" id="6731970">err</span>&nbsp;<span class="op" id="6731974">!=</span>&nbsp;<span class="builtintype" id="6731977">nil</span>&nbsp;<span class="op" id="6731981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6731986">t</span><span class="op" id="6731987">.</span><span class="ident" id="6731988">Fatalf</span><span class="op" id="6731994">(</span><span class="string" id="6731995">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6732020">,</span>&nbsp;<span class="ident" id="6732022">err</span><span class="op" id="6732025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6732029">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732033">defer</span>&nbsp;<span class="ident" id="6732039">closer</span><span class="op" id="6732045">(</span><span class="ident" id="6732046">c1</span><span class="op" id="6732048">,</span>&nbsp;<span class="ident" id="6732050">netstr</span><span class="op" id="6732056">[</span><span class="num" id="6732057">0</span><span class="op" id="6732058">]</span><span class="op" id="6732059">,</span>&nbsp;<span class="ident" id="6732061">tt</span><span class="op" id="6732063">.</span><span class="ident" id="6732064">addr1</span><span class="op" id="6732069">,</span>&nbsp;<span class="ident" id="6732071">tt</span><span class="op" id="6732073">.</span><span class="ident" id="6732074">addr2</span><span class="op" id="6732079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732083">c1</span><span class="op" id="6732085">.</span><span class="ident" id="6732086">LocalAddr</span><span class="op" id="6732095">(</span><span class="op" id="6732096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732100">c1</span><span class="op" id="6732102">.</span><span class="ident" id="6732103">SetDeadline</span><span class="op" id="6732114">(</span><span class="ident" id="6732115">time</span><span class="op" id="6732119">.</span><span class="ident" id="6732120">Now</span><span class="op" id="6732123">(</span><span class="op" id="6732124">)</span><span class="op" id="6732125">.</span><span class="ident" id="6732126">Add</span><span class="op" id="6732129">(</span><span class="num" id="6732130">100</span>&nbsp;<span class="op" id="6732134">*</span>&nbsp;<span class="ident" id="6732136">time</span><span class="op" id="6732140">.</span><span class="ident" id="6732141">Millisecond</span><span class="op" id="6732152">)</span><span class="op" id="6732153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732157">c1</span><span class="op" id="6732159">.</span><span class="ident" id="6732160">SetReadDeadline</span><span class="op" id="6732175">(</span><span class="ident" id="6732176">time</span><span class="op" id="6732180">.</span><span class="ident" id="6732181">Now</span><span class="op" id="6732184">(</span><span class="op" id="6732185">)</span><span class="op" id="6732186">.</span><span class="ident" id="6732187">Add</span><span class="op" id="6732190">(</span><span class="num" id="6732191">100</span>&nbsp;<span class="op" id="6732195">*</span>&nbsp;<span class="ident" id="6732197">time</span><span class="op" id="6732201">.</span><span class="ident" id="6732202">Millisecond</span><span class="op" id="6732213">)</span><span class="op" id="6732214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732218">c1</span><span class="op" id="6732220">.</span><span class="ident" id="6732221">SetWriteDeadline</span><span class="op" id="6732237">(</span><span class="ident" id="6732238">time</span><span class="op" id="6732242">.</span><span class="ident" id="6732243">Now</span><span class="op" id="6732246">(</span><span class="op" id="6732247">)</span><span class="op" id="6732248">.</span><span class="ident" id="6732249">Add</span><span class="op" id="6732252">(</span><span class="num" id="6732253">100</span>&nbsp;<span class="op" id="6732257">*</span>&nbsp;<span class="ident" id="6732259">time</span><span class="op" id="6732263">.</span><span class="ident" id="6732264">Millisecond</span><span class="op" id="6732275">)</span><span class="op" id="6732276">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732281">c2</span><span class="op" id="6732283">,</span>&nbsp;<span class="ident" id="6732285">err</span>&nbsp;<span class="op" id="6732289">:=</span>&nbsp;<span class="ident" id="6732292">Dial</span><span class="op" id="6732296">(</span><span class="ident" id="6732297">tt</span><span class="op" id="6732299">.</span><span class="ident" id="6732300">net</span><span class="op" id="6732303">,</span>&nbsp;<span class="ident" id="6732305">c1</span><span class="op" id="6732307">.</span><span class="ident" id="6732308">LocalAddr</span><span class="op" id="6732317">(</span><span class="op" id="6732318">)</span><span class="op" id="6732319">.</span><span class="ident" id="6732320">String</span><span class="op" id="6732326">(</span><span class="op" id="6732327">)</span><span class="op" id="6732328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732332">if</span>&nbsp;<span class="ident" id="6732335">err</span>&nbsp;<span class="op" id="6732339">!=</span>&nbsp;<span class="builtintype" id="6732342">nil</span>&nbsp;<span class="op" id="6732346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732351">t</span><span class="op" id="6732352">.</span><span class="ident" id="6732353">Fatalf</span><span class="op" id="6732359">(</span><span class="string" id="6732360">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6732377">,</span>&nbsp;<span class="ident" id="6732379">err</span><span class="op" id="6732382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6732386">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732390">defer</span>&nbsp;<span class="ident" id="6732396">c2</span><span class="op" id="6732398">.</span><span class="ident" id="6732399">Close</span><span class="op" id="6732404">(</span><span class="op" id="6732405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732409">c2</span><span class="op" id="6732411">.</span><span class="ident" id="6732412">LocalAddr</span><span class="op" id="6732421">(</span><span class="op" id="6732422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732426">c2</span><span class="op" id="6732428">.</span><span class="ident" id="6732429">RemoteAddr</span><span class="op" id="6732439">(</span><span class="op" id="6732440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732444">c2</span><span class="op" id="6732446">.</span><span class="ident" id="6732447">SetDeadline</span><span class="op" id="6732458">(</span><span class="ident" id="6732459">time</span><span class="op" id="6732463">.</span><span class="ident" id="6732464">Now</span><span class="op" id="6732467">(</span><span class="op" id="6732468">)</span><span class="op" id="6732469">.</span><span class="ident" id="6732470">Add</span><span class="op" id="6732473">(</span><span class="num" id="6732474">100</span>&nbsp;<span class="op" id="6732478">*</span>&nbsp;<span class="ident" id="6732480">time</span><span class="op" id="6732484">.</span><span class="ident" id="6732485">Millisecond</span><span class="op" id="6732496">)</span><span class="op" id="6732497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732501">c2</span><span class="op" id="6732503">.</span><span class="ident" id="6732504">SetReadDeadline</span><span class="op" id="6732519">(</span><span class="ident" id="6732520">time</span><span class="op" id="6732524">.</span><span class="ident" id="6732525">Now</span><span class="op" id="6732528">(</span><span class="op" id="6732529">)</span><span class="op" id="6732530">.</span><span class="ident" id="6732531">Add</span><span class="op" id="6732534">(</span><span class="num" id="6732535">100</span>&nbsp;<span class="op" id="6732539">*</span>&nbsp;<span class="ident" id="6732541">time</span><span class="op" id="6732545">.</span><span class="ident" id="6732546">Millisecond</span><span class="op" id="6732557">)</span><span class="op" id="6732558">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732562">c2</span><span class="op" id="6732564">.</span><span class="ident" id="6732565">SetWriteDeadline</span><span class="op" id="6732581">(</span><span class="ident" id="6732582">time</span><span class="op" id="6732586">.</span><span class="ident" id="6732587">Now</span><span class="op" id="6732590">(</span><span class="op" id="6732591">)</span><span class="op" id="6732592">.</span><span class="ident" id="6732593">Add</span><span class="op" id="6732596">(</span><span class="num" id="6732597">100</span>&nbsp;<span class="op" id="6732601">*</span>&nbsp;<span class="ident" id="6732603">time</span><span class="op" id="6732607">.</span><span class="ident" id="6732608">Millisecond</span><span class="op" id="6732619">)</span><span class="op" id="6732620">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732625">if</span>&nbsp;<span class="ident" id="6732628">_</span><span class="op" id="6732629">,</span>&nbsp;<span class="ident" id="6732631">err</span>&nbsp;<span class="op" id="6732635">:=</span>&nbsp;<span class="ident" id="6732638">c2</span><span class="op" id="6732640">.</span><span class="ident" id="6732641">Write</span><span class="op" id="6732646">(</span><span class="ident" id="6732647">wb</span><span class="op" id="6732649">)</span><span class="op" id="6732650">;</span>&nbsp;<span class="ident" id="6732652">err</span>&nbsp;<span class="op" id="6732656">!=</span>&nbsp;<span class="builtintype" id="6732659">nil</span>&nbsp;<span class="op" id="6732663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732668">t</span><span class="op" id="6732669">.</span><span class="ident" id="6732670">Fatalf</span><span class="op" id="6732676">(</span><span class="string" id="6732677">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6732700">,</span>&nbsp;<span class="ident" id="6732702">err</span><span class="op" id="6732705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6732709">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732713">rb1</span>&nbsp;<span class="op" id="6732717">:=</span>&nbsp;<span class="builtinfunc" id="6732720">make</span><span class="op" id="6732724">(</span><span class="op" id="6732725">[</span><span class="op" id="6732726">]</span><span class="builtintype" id="6732727">byte</span><span class="op" id="6732731">,</span>&nbsp;<span class="num" id="6732733">128</span><span class="op" id="6732736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732740">if</span>&nbsp;<span class="ident" id="6732743">_</span><span class="op" id="6732744">,</span>&nbsp;<span class="ident" id="6732746">_</span><span class="op" id="6732747">,</span>&nbsp;<span class="ident" id="6732749">err</span>&nbsp;<span class="op" id="6732753">:=</span>&nbsp;<span class="ident" id="6732756">c1</span><span class="op" id="6732758">.</span><span class="ident" id="6732759">ReadFrom</span><span class="op" id="6732767">(</span><span class="ident" id="6732768">rb1</span><span class="op" id="6732771">)</span><span class="op" id="6732772">;</span>&nbsp;<span class="ident" id="6732774">err</span>&nbsp;<span class="op" id="6732778">!=</span>&nbsp;<span class="builtintype" id="6732781">nil</span>&nbsp;<span class="op" id="6732785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732790">t</span><span class="op" id="6732791">.</span><span class="ident" id="6732792">Fatalf</span><span class="op" id="6732798">(</span><span class="string" id="6732799">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6732831">,</span>&nbsp;<span class="ident" id="6732833">err</span><span class="op" id="6732836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6732840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732844">var</span>&nbsp;<span class="ident" id="6732848">dst</span>&nbsp;<span class="ident" id="6732852">Addr</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732859">switch</span>&nbsp;<span class="ident" id="6732866">netstr</span><span class="op" id="6732872">[</span><span class="num" id="6732873">0</span><span class="op" id="6732874">]</span>&nbsp;<span class="op" id="6732876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732880">case</span>&nbsp;<span class="string" id="6732885">&#34;ip&#34;</span><span class="op" id="6732889">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732894">dst</span>&nbsp;<span class="op" id="6732898">=</span>&nbsp;<span class="op" id="6732900">&amp;</span><span class="ident" id="6732901">IPAddr</span><span class="op" id="6732907">{</span><span class="ident" id="6732908">IP</span><span class="op" id="6732910">:</span>&nbsp;<span class="ident" id="6732912">IPv4</span><span class="op" id="6732916">(</span><span class="num" id="6732917">127</span><span class="op" id="6732920">,</span>&nbsp;<span class="num" id="6732922">0</span><span class="op" id="6732923">,</span>&nbsp;<span class="num" id="6732925">0</span><span class="op" id="6732926">,</span>&nbsp;<span class="num" id="6732928">1</span><span class="op" id="6732929">)</span><span class="op" id="6732930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732934">case</span>&nbsp;<span class="string" id="6732939">&#34;unixgram&#34;</span><span class="op" id="6732949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732954">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6732965">default</span><span class="op" id="6732972">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6732977">dst</span>&nbsp;<span class="op" id="6732981">=</span>&nbsp;<span class="ident" id="6732983">c2</span><span class="op" id="6732985">.</span><span class="ident" id="6732986">LocalAddr</span><span class="op" id="6732995">(</span><span class="op" id="6732996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6733000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6733004">if</span>&nbsp;<span class="ident" id="6733007">_</span><span class="op" id="6733008">,</span>&nbsp;<span class="ident" id="6733010">err</span>&nbsp;<span class="op" id="6733014">:=</span>&nbsp;<span class="ident" id="6733017">c1</span><span class="op" id="6733019">.</span><span class="ident" id="6733020">WriteTo</span><span class="op" id="6733027">(</span><span class="ident" id="6733028">wb</span><span class="op" id="6733030">,</span>&nbsp;<span class="ident" id="6733032">dst</span><span class="op" id="6733035">)</span><span class="op" id="6733036">;</span>&nbsp;<span class="ident" id="6733038">err</span>&nbsp;<span class="op" id="6733042">!=</span>&nbsp;<span class="builtintype" id="6733045">nil</span>&nbsp;<span class="op" id="6733049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6733054">t</span><span class="op" id="6733055">.</span><span class="ident" id="6733056">Fatalf</span><span class="op" id="6733062">(</span><span class="string" id="6733063">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6733094">,</span>&nbsp;<span class="ident" id="6733096">err</span><span class="op" id="6733099">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6733103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6733107">rb2</span>&nbsp;<span class="op" id="6733111">:=</span>&nbsp;<span class="builtinfunc" id="6733114">make</span><span class="op" id="6733118">(</span><span class="op" id="6733119">[</span><span class="op" id="6733120">]</span><span class="builtintype" id="6733121">byte</span><span class="op" id="6733125">,</span>&nbsp;<span class="num" id="6733127">128</span><span class="op" id="6733130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6733134">if</span>&nbsp;<span class="ident" id="6733137">_</span><span class="op" id="6733138">,</span>&nbsp;<span class="ident" id="6733140">err</span>&nbsp;<span class="op" id="6733144">:=</span>&nbsp;<span class="ident" id="6733147">c2</span><span class="op" id="6733149">.</span><span class="ident" id="6733150">Read</span><span class="op" id="6733154">(</span><span class="ident" id="6733155">rb2</span><span class="op" id="6733158">)</span><span class="op" id="6733159">;</span>&nbsp;<span class="ident" id="6733161">err</span>&nbsp;<span class="op" id="6733165">!=</span>&nbsp;<span class="builtintype" id="6733168">nil</span>&nbsp;<span class="op" id="6733172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6733177">t</span><span class="op" id="6733178">.</span><span class="ident" id="6733179">Fatalf</span><span class="op" id="6733185">(</span><span class="string" id="6733186">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6733208">,</span>&nbsp;<span class="ident" id="6733210">err</span><span class="op" id="6733213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6733217">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6733220">}</span><br>
<span class="lineno"></span><span class="op" id="6733222">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
