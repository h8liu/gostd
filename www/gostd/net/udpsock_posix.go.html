<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3747152">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3747208">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3747262">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3747313">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3747391">package</span>&nbsp;<span class="ident" id="3747399">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3747404">import</span>&nbsp;<span class="op" id="3747411">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3747414">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3747425">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3747432">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3747435">func</span>&nbsp;<span class="ident" id="3747440">sockaddrToUDP</span><span class="op" id="3747453">(</span><span class="ident" id="3747454">sa</span>&nbsp;<span class="ident" id="3747457">syscall</span><span class="op" id="3747464">.</span><span class="ident" id="3747465">Sockaddr</span><span class="op" id="3747473">)</span>&nbsp;<span class="ident" id="3747475">Addr</span>&nbsp;<span class="op" id="3747480">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747483">switch</span>&nbsp;<span class="ident" id="3747490">sa</span>&nbsp;<span class="op" id="3747493">:=</span>&nbsp;<span class="ident" id="3747496">sa</span><span class="op" id="3747498">.</span><span class="op" id="3747499">(</span><span class="keyword" id="3747500">type</span><span class="op" id="3747504">)</span>&nbsp;<span class="op" id="3747506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747509">case</span>&nbsp;<span class="op" id="3747514">*</span><span class="ident" id="3747515">syscall</span><span class="op" id="3747522">.</span><span class="ident" id="3747523">SockaddrInet4</span><span class="op" id="3747536">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747540">return</span>&nbsp;<span class="op" id="3747547">&amp;</span><span class="ident" id="3747548">UDPAddr</span><span class="op" id="3747555">{</span><span class="ident" id="3747556">IP</span><span class="op" id="3747558">:</span>&nbsp;<span class="ident" id="3747560">sa</span><span class="op" id="3747562">.</span><span class="ident" id="3747563">Addr</span><span class="op" id="3747567">[</span><span class="num" id="3747568">0</span><span class="op" id="3747569">:</span><span class="op" id="3747570">]</span><span class="op" id="3747571">,</span>&nbsp;<span class="ident" id="3747573">Port</span><span class="op" id="3747577">:</span>&nbsp;<span class="ident" id="3747579">sa</span><span class="op" id="3747581">.</span><span class="ident" id="3747582">Port</span><span class="op" id="3747586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747589">case</span>&nbsp;<span class="op" id="3747594">*</span><span class="ident" id="3747595">syscall</span><span class="op" id="3747602">.</span><span class="ident" id="3747603">SockaddrInet6</span><span class="op" id="3747616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747620">return</span>&nbsp;<span class="op" id="3747627">&amp;</span><span class="ident" id="3747628">UDPAddr</span><span class="op" id="3747635">{</span><span class="ident" id="3747636">IP</span><span class="op" id="3747638">:</span>&nbsp;<span class="ident" id="3747640">sa</span><span class="op" id="3747642">.</span><span class="ident" id="3747643">Addr</span><span class="op" id="3747647">[</span><span class="num" id="3747648">0</span><span class="op" id="3747649">:</span><span class="op" id="3747650">]</span><span class="op" id="3747651">,</span>&nbsp;<span class="ident" id="3747653">Port</span><span class="op" id="3747657">:</span>&nbsp;<span class="ident" id="3747659">sa</span><span class="op" id="3747661">.</span><span class="ident" id="3747662">Port</span><span class="op" id="3747666">,</span>&nbsp;<span class="ident" id="3747668">Zone</span><span class="op" id="3747672">:</span>&nbsp;<span class="ident" id="3747674">zoneToString</span><span class="op" id="3747686">(</span><span class="builtintype" id="3747687">int</span><span class="op" id="3747690">(</span><span class="ident" id="3747691">sa</span><span class="op" id="3747693">.</span><span class="ident" id="3747694">ZoneId</span><span class="op" id="3747700">)</span><span class="op" id="3747701">)</span><span class="op" id="3747702">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747708">return</span>&nbsp;<span class="ident" id="3747715">nil</span><br>
<span class="lineno"></span><span class="op" id="3747719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3747722">func</span>&nbsp;<span class="op" id="3747727">(</span><span class="ident" id="3747728">a</span>&nbsp;<span class="op" id="3747730">*</span><span class="ident" id="3747731">UDPAddr</span><span class="op" id="3747738">)</span>&nbsp;<span class="ident" id="3747740">family</span><span class="op" id="3747746">(</span><span class="op" id="3747747">)</span>&nbsp;<span class="builtintype" id="3747749">int</span>&nbsp;<span class="op" id="3747753">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747756">if</span>&nbsp;<span class="ident" id="3747759">a</span>&nbsp;<span class="op" id="3747761">==</span>&nbsp;<span class="ident" id="3747764">nil</span>&nbsp;<span class="op" id="3747768">||</span>&nbsp;<span class="builtinfunc" id="3747771">len</span><span class="op" id="3747774">(</span><span class="ident" id="3747775">a</span><span class="op" id="3747776">.</span><span class="ident" id="3747777">IP</span><span class="op" id="3747779">)</span>&nbsp;<span class="op" id="3747781">&lt;=</span>&nbsp;<span class="ident" id="3747784">IPv4len</span>&nbsp;<span class="op" id="3747792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747796">return</span>&nbsp;<span class="ident" id="3747803">syscall</span><span class="op" id="3747810">.</span><span class="ident" id="3747811">AF_INET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747823">if</span>&nbsp;<span class="ident" id="3747826">a</span><span class="op" id="3747827">.</span><span class="ident" id="3747828">IP</span><span class="op" id="3747830">.</span><span class="ident" id="3747831">To4</span><span class="op" id="3747834">(</span><span class="op" id="3747835">)</span>&nbsp;<span class="op" id="3747837">!=</span>&nbsp;<span class="ident" id="3747840">nil</span>&nbsp;<span class="op" id="3747844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747848">return</span>&nbsp;<span class="ident" id="3747855">syscall</span><span class="op" id="3747862">.</span><span class="ident" id="3747863">AF_INET</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747875">return</span>&nbsp;<span class="ident" id="3747882">syscall</span><span class="op" id="3747889">.</span><span class="ident" id="3747890">AF_INET6</span><br>
<span class="lineno"></span><span class="op" id="3747899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3747902">func</span>&nbsp;<span class="op" id="3747907">(</span><span class="ident" id="3747908">a</span>&nbsp;<span class="op" id="3747910">*</span><span class="ident" id="3747911">UDPAddr</span><span class="op" id="3747918">)</span>&nbsp;<span class="ident" id="3747920">isWildcard</span><span class="op" id="3747930">(</span><span class="op" id="3747931">)</span>&nbsp;<span class="builtintype" id="3747933">bool</span>&nbsp;<span class="op" id="3747938">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747941">if</span>&nbsp;<span class="ident" id="3747944">a</span>&nbsp;<span class="op" id="3747946">==</span>&nbsp;<span class="ident" id="3747949">nil</span>&nbsp;<span class="op" id="3747953">||</span>&nbsp;<span class="ident" id="3747956">a</span><span class="op" id="3747957">.</span><span class="ident" id="3747958">IP</span>&nbsp;<span class="op" id="3747961">==</span>&nbsp;<span class="ident" id="3747964">nil</span>&nbsp;<span class="op" id="3747968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747972">return</span>&nbsp;<span class="builtintype" id="3747979">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3747985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3747988">return</span>&nbsp;<span class="ident" id="3747995">a</span><span class="op" id="3747996">.</span><span class="ident" id="3747997">IP</span><span class="op" id="3747999">.</span><span class="ident" id="3748000">IsUnspecified</span><span class="op" id="3748013">(</span><span class="op" id="3748014">)</span><br>
<span class="lineno"></span><span class="op" id="3748016">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3748019">func</span>&nbsp;<span class="op" id="3748024">(</span><span class="ident" id="3748025">a</span>&nbsp;<span class="op" id="3748027">*</span><span class="ident" id="3748028">UDPAddr</span><span class="op" id="3748035">)</span>&nbsp;<span class="ident" id="3748037">sockaddr</span><span class="op" id="3748045">(</span><span class="ident" id="3748046">family</span>&nbsp;<span class="builtintype" id="3748053">int</span><span class="op" id="3748056">)</span>&nbsp;<span class="op" id="3748058">(</span><span class="ident" id="3748059">syscall</span><span class="op" id="3748066">.</span><span class="ident" id="3748067">Sockaddr</span><span class="op" id="3748075">,</span>&nbsp;<span class="builtintype" id="3748077">error</span><span class="op" id="3748082">)</span>&nbsp;<span class="op" id="3748084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748087">if</span>&nbsp;<span class="ident" id="3748090">a</span>&nbsp;<span class="op" id="3748092">==</span>&nbsp;<span class="ident" id="3748095">nil</span>&nbsp;<span class="op" id="3748099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748103">return</span>&nbsp;<span class="ident" id="3748110">nil</span><span class="op" id="3748113">,</span>&nbsp;<span class="ident" id="3748115">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748120">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748123">return</span>&nbsp;<span class="ident" id="3748130">ipToSockaddr</span><span class="op" id="3748142">(</span><span class="ident" id="3748143">family</span><span class="op" id="3748149">,</span>&nbsp;<span class="ident" id="3748151">a</span><span class="op" id="3748152">.</span><span class="ident" id="3748153">IP</span><span class="op" id="3748155">,</span>&nbsp;<span class="ident" id="3748157">a</span><span class="op" id="3748158">.</span><span class="ident" id="3748159">Port</span><span class="op" id="3748163">,</span>&nbsp;<span class="ident" id="3748165">a</span><span class="op" id="3748166">.</span><span class="ident" id="3748167">Zone</span><span class="op" id="3748171">)</span><br>
<span class="lineno"></span><span class="op" id="3748173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3748176">//&nbsp;UDPConn&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;and&nbsp;PacketConn&nbsp;interfaces</span><br>
<span class="lineno"></span><span class="comment" id="3748247">//&nbsp;for&nbsp;UDP&nbsp;network&nbsp;connections.</span><br>
<span class="lineno">50</span><span class="keyword" id="3748279">type</span>&nbsp;<span class="ident" id="3748284">UDPConn</span>&nbsp;<span class="keyword" id="3748292">struct</span>&nbsp;<span class="op" id="3748299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748302">conn</span><br>
<span class="lineno"></span><span class="op" id="3748307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3748310">func</span>&nbsp;<span class="ident" id="3748315">newUDPConn</span><span class="op" id="3748325">(</span><span class="ident" id="3748326">fd</span>&nbsp;<span class="op" id="3748329">*</span><span class="ident" id="3748330">netFD</span><span class="op" id="3748335">)</span>&nbsp;<span class="op" id="3748337">*</span><span class="ident" id="3748338">UDPConn</span>&nbsp;<span class="op" id="3748346">{</span>&nbsp;<span class="keyword" id="3748348">return</span>&nbsp;<span class="op" id="3748355">&amp;</span><span class="ident" id="3748356">UDPConn</span><span class="op" id="3748363">{</span><span class="ident" id="3748364">conn</span><span class="op" id="3748368">{</span><span class="ident" id="3748369">fd</span><span class="op" id="3748371">}</span><span class="op" id="3748372">}</span>&nbsp;<span class="op" id="3748374">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3748377">//&nbsp;ReadFromUDP&nbsp;reads&nbsp;a&nbsp;UDP&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="3748447">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="3748518">//&nbsp;that&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="3748545">//</span><br>
<span class="lineno">60</span><span class="comment" id="3748548">//&nbsp;ReadFromUDP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3748612">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3748679">//&nbsp;SetReadDeadline.</span><br>
<span class="lineno"></span><span class="keyword" id="3748699">func</span>&nbsp;<span class="op" id="3748704">(</span><span class="ident" id="3748705">c</span>&nbsp;<span class="op" id="3748707">*</span><span class="ident" id="3748708">UDPConn</span><span class="op" id="3748715">)</span>&nbsp;<span class="ident" id="3748717">ReadFromUDP</span><span class="op" id="3748728">(</span><span class="ident" id="3748729">b</span>&nbsp;<span class="op" id="3748731">[</span><span class="op" id="3748732">]</span><span class="builtintype" id="3748733">byte</span><span class="op" id="3748737">)</span>&nbsp;<span class="op" id="3748739">(</span><span class="ident" id="3748740">n</span>&nbsp;<span class="builtintype" id="3748742">int</span><span class="op" id="3748745">,</span>&nbsp;<span class="ident" id="3748747">addr</span>&nbsp;<span class="op" id="3748752">*</span><span class="ident" id="3748753">UDPAddr</span><span class="op" id="3748760">,</span>&nbsp;<span class="ident" id="3748762">err</span>&nbsp;<span class="builtintype" id="3748766">error</span><span class="op" id="3748771">)</span>&nbsp;<span class="op" id="3748773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748776">if</span>&nbsp;<span class="op" id="3748779">!</span><span class="ident" id="3748780">c</span><span class="op" id="3748781">.</span><span class="ident" id="3748782">ok</span><span class="op" id="3748784">(</span><span class="op" id="3748785">)</span>&nbsp;<span class="op" id="3748787">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748791">return</span>&nbsp;<span class="num" id="3748798">0</span><span class="op" id="3748799">,</span>&nbsp;<span class="ident" id="3748801">nil</span><span class="op" id="3748804">,</span>&nbsp;<span class="ident" id="3748806">syscall</span><span class="op" id="3748813">.</span><span class="ident" id="3748814">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3748822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748825">n</span><span class="op" id="3748826">,</span>&nbsp;<span class="ident" id="3748828">sa</span><span class="op" id="3748830">,</span>&nbsp;<span class="ident" id="3748832">err</span>&nbsp;<span class="op" id="3748836">:=</span>&nbsp;<span class="ident" id="3748839">c</span><span class="op" id="3748840">.</span><span class="ident" id="3748841">fd</span><span class="op" id="3748843">.</span><span class="ident" id="3748844">readFrom</span><span class="op" id="3748852">(</span><span class="ident" id="3748853">b</span><span class="op" id="3748854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748857">switch</span>&nbsp;<span class="ident" id="3748864">sa</span>&nbsp;<span class="op" id="3748867">:=</span>&nbsp;<span class="ident" id="3748870">sa</span><span class="op" id="3748872">.</span><span class="op" id="3748873">(</span><span class="keyword" id="3748874">type</span><span class="op" id="3748878">)</span>&nbsp;<span class="op" id="3748880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748883">case</span>&nbsp;<span class="op" id="3748888">*</span><span class="ident" id="3748889">syscall</span><span class="op" id="3748896">.</span><span class="ident" id="3748897">SockaddrInet4</span><span class="op" id="3748910">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748914">addr</span>&nbsp;<span class="op" id="3748919">=</span>&nbsp;<span class="op" id="3748921">&amp;</span><span class="ident" id="3748922">UDPAddr</span><span class="op" id="3748929">{</span><span class="ident" id="3748930">IP</span><span class="op" id="3748932">:</span>&nbsp;<span class="ident" id="3748934">sa</span><span class="op" id="3748936">.</span><span class="ident" id="3748937">Addr</span><span class="op" id="3748941">[</span><span class="num" id="3748942">0</span><span class="op" id="3748943">:</span><span class="op" id="3748944">]</span><span class="op" id="3748945">,</span>&nbsp;<span class="ident" id="3748947">Port</span><span class="op" id="3748951">:</span>&nbsp;<span class="ident" id="3748953">sa</span><span class="op" id="3748955">.</span><span class="ident" id="3748956">Port</span><span class="op" id="3748960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3748963">case</span>&nbsp;<span class="op" id="3748968">*</span><span class="ident" id="3748969">syscall</span><span class="op" id="3748976">.</span><span class="ident" id="3748977">SockaddrInet6</span><span class="op" id="3748990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3748994">addr</span>&nbsp;<span class="op" id="3748999">=</span>&nbsp;<span class="op" id="3749001">&amp;</span><span class="ident" id="3749002">UDPAddr</span><span class="op" id="3749009">{</span><span class="ident" id="3749010">IP</span><span class="op" id="3749012">:</span>&nbsp;<span class="ident" id="3749014">sa</span><span class="op" id="3749016">.</span><span class="ident" id="3749017">Addr</span><span class="op" id="3749021">[</span><span class="num" id="3749022">0</span><span class="op" id="3749023">:</span><span class="op" id="3749024">]</span><span class="op" id="3749025">,</span>&nbsp;<span class="ident" id="3749027">Port</span><span class="op" id="3749031">:</span>&nbsp;<span class="ident" id="3749033">sa</span><span class="op" id="3749035">.</span><span class="ident" id="3749036">Port</span><span class="op" id="3749040">,</span>&nbsp;<span class="ident" id="3749042">Zone</span><span class="op" id="3749046">:</span>&nbsp;<span class="ident" id="3749048">zoneToString</span><span class="op" id="3749060">(</span><span class="builtintype" id="3749061">int</span><span class="op" id="3749064">(</span><span class="ident" id="3749065">sa</span><span class="op" id="3749067">.</span><span class="ident" id="3749068">ZoneId</span><span class="op" id="3749074">)</span><span class="op" id="3749075">)</span><span class="op" id="3749076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3749079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749082">return</span><br>
<span class="lineno">75</span><span class="op" id="3749089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3749092">//&nbsp;ReadFrom&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3749147">func</span>&nbsp;<span class="op" id="3749152">(</span><span class="ident" id="3749153">c</span>&nbsp;<span class="op" id="3749155">*</span><span class="ident" id="3749156">UDPConn</span><span class="op" id="3749163">)</span>&nbsp;<span class="ident" id="3749165">ReadFrom</span><span class="op" id="3749173">(</span><span class="ident" id="3749174">b</span>&nbsp;<span class="op" id="3749176">[</span><span class="op" id="3749177">]</span><span class="builtintype" id="3749178">byte</span><span class="op" id="3749182">)</span>&nbsp;<span class="op" id="3749184">(</span><span class="builtintype" id="3749185">int</span><span class="op" id="3749188">,</span>&nbsp;<span class="ident" id="3749190">Addr</span><span class="op" id="3749194">,</span>&nbsp;<span class="builtintype" id="3749196">error</span><span class="op" id="3749201">)</span>&nbsp;<span class="op" id="3749203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749206">if</span>&nbsp;<span class="op" id="3749209">!</span><span class="ident" id="3749210">c</span><span class="op" id="3749211">.</span><span class="ident" id="3749212">ok</span><span class="op" id="3749214">(</span><span class="op" id="3749215">)</span>&nbsp;<span class="op" id="3749217">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749221">return</span>&nbsp;<span class="num" id="3749228">0</span><span class="op" id="3749229">,</span>&nbsp;<span class="ident" id="3749231">nil</span><span class="op" id="3749234">,</span>&nbsp;<span class="ident" id="3749236">syscall</span><span class="op" id="3749243">.</span><span class="ident" id="3749244">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3749252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3749255">n</span><span class="op" id="3749256">,</span>&nbsp;<span class="ident" id="3749258">addr</span><span class="op" id="3749262">,</span>&nbsp;<span class="ident" id="3749264">err</span>&nbsp;<span class="op" id="3749268">:=</span>&nbsp;<span class="ident" id="3749271">c</span><span class="op" id="3749272">.</span><span class="ident" id="3749273">ReadFromUDP</span><span class="op" id="3749284">(</span><span class="ident" id="3749285">b</span><span class="op" id="3749286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749289">return</span>&nbsp;<span class="ident" id="3749296">n</span><span class="op" id="3749297">,</span>&nbsp;<span class="ident" id="3749299">addr</span><span class="op" id="3749303">.</span><span class="ident" id="3749304">toAddr</span><span class="op" id="3749310">(</span><span class="op" id="3749311">)</span><span class="op" id="3749312">,</span>&nbsp;<span class="ident" id="3749314">err</span><br>
<span class="lineno"></span><span class="op" id="3749318">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="3749321">//&nbsp;ReadMsgUDP&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3749389">//&nbsp;the&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;into&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3749457">//&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b,&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;oob,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3749525">//&nbsp;flags&nbsp;that&nbsp;were&nbsp;set&nbsp;on&nbsp;the&nbsp;packet&nbsp;and&nbsp;the&nbsp;source&nbsp;address&nbsp;of&nbsp;the</span><br>
<span class="lineno">90</span><span class="comment" id="3749592">//&nbsp;packet.</span><br>
<span class="lineno"></span><span class="keyword" id="3749603">func</span>&nbsp;<span class="op" id="3749608">(</span><span class="ident" id="3749609">c</span>&nbsp;<span class="op" id="3749611">*</span><span class="ident" id="3749612">UDPConn</span><span class="op" id="3749619">)</span>&nbsp;<span class="ident" id="3749621">ReadMsgUDP</span><span class="op" id="3749631">(</span><span class="ident" id="3749632">b</span><span class="op" id="3749633">,</span>&nbsp;<span class="ident" id="3749635">oob</span>&nbsp;<span class="op" id="3749639">[</span><span class="op" id="3749640">]</span><span class="builtintype" id="3749641">byte</span><span class="op" id="3749645">)</span>&nbsp;<span class="op" id="3749647">(</span><span class="ident" id="3749648">n</span><span class="op" id="3749649">,</span>&nbsp;<span class="ident" id="3749651">oobn</span><span class="op" id="3749655">,</span>&nbsp;<span class="ident" id="3749657">flags</span>&nbsp;<span class="builtintype" id="3749663">int</span><span class="op" id="3749666">,</span>&nbsp;<span class="ident" id="3749668">addr</span>&nbsp;<span class="op" id="3749673">*</span><span class="ident" id="3749674">UDPAddr</span><span class="op" id="3749681">,</span>&nbsp;<span class="ident" id="3749683">err</span>&nbsp;<span class="builtintype" id="3749687">error</span><span class="op" id="3749692">)</span>&nbsp;<span class="op" id="3749694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749697">if</span>&nbsp;<span class="op" id="3749700">!</span><span class="ident" id="3749701">c</span><span class="op" id="3749702">.</span><span class="ident" id="3749703">ok</span><span class="op" id="3749705">(</span><span class="op" id="3749706">)</span>&nbsp;<span class="op" id="3749708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749712">return</span>&nbsp;<span class="num" id="3749719">0</span><span class="op" id="3749720">,</span>&nbsp;<span class="num" id="3749722">0</span><span class="op" id="3749723">,</span>&nbsp;<span class="num" id="3749725">0</span><span class="op" id="3749726">,</span>&nbsp;<span class="ident" id="3749728">nil</span><span class="op" id="3749731">,</span>&nbsp;<span class="ident" id="3749733">syscall</span><span class="op" id="3749740">.</span><span class="ident" id="3749741">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3749749">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749752">var</span>&nbsp;<span class="ident" id="3749756">sa</span>&nbsp;<span class="ident" id="3749759">syscall</span><span class="op" id="3749766">.</span><span class="ident" id="3749767">Sockaddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3749777">n</span><span class="op" id="3749778">,</span>&nbsp;<span class="ident" id="3749780">oobn</span><span class="op" id="3749784">,</span>&nbsp;<span class="ident" id="3749786">flags</span><span class="op" id="3749791">,</span>&nbsp;<span class="ident" id="3749793">sa</span><span class="op" id="3749795">,</span>&nbsp;<span class="ident" id="3749797">err</span>&nbsp;<span class="op" id="3749801">=</span>&nbsp;<span class="ident" id="3749803">c</span><span class="op" id="3749804">.</span><span class="ident" id="3749805">fd</span><span class="op" id="3749807">.</span><span class="ident" id="3749808">readMsg</span><span class="op" id="3749815">(</span><span class="ident" id="3749816">b</span><span class="op" id="3749817">,</span>&nbsp;<span class="ident" id="3749819">oob</span><span class="op" id="3749822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749825">switch</span>&nbsp;<span class="ident" id="3749832">sa</span>&nbsp;<span class="op" id="3749835">:=</span>&nbsp;<span class="ident" id="3749838">sa</span><span class="op" id="3749840">.</span><span class="op" id="3749841">(</span><span class="keyword" id="3749842">type</span><span class="op" id="3749846">)</span>&nbsp;<span class="op" id="3749848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749851">case</span>&nbsp;<span class="op" id="3749856">*</span><span class="ident" id="3749857">syscall</span><span class="op" id="3749864">.</span><span class="ident" id="3749865">SockaddrInet4</span><span class="op" id="3749878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3749882">addr</span>&nbsp;<span class="op" id="3749887">=</span>&nbsp;<span class="op" id="3749889">&amp;</span><span class="ident" id="3749890">UDPAddr</span><span class="op" id="3749897">{</span><span class="ident" id="3749898">IP</span><span class="op" id="3749900">:</span>&nbsp;<span class="ident" id="3749902">sa</span><span class="op" id="3749904">.</span><span class="ident" id="3749905">Addr</span><span class="op" id="3749909">[</span><span class="num" id="3749910">0</span><span class="op" id="3749911">:</span><span class="op" id="3749912">]</span><span class="op" id="3749913">,</span>&nbsp;<span class="ident" id="3749915">Port</span><span class="op" id="3749919">:</span>&nbsp;<span class="ident" id="3749921">sa</span><span class="op" id="3749923">.</span><span class="ident" id="3749924">Port</span><span class="op" id="3749928">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3749931">case</span>&nbsp;<span class="op" id="3749936">*</span><span class="ident" id="3749937">syscall</span><span class="op" id="3749944">.</span><span class="ident" id="3749945">SockaddrInet6</span><span class="op" id="3749958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3749962">addr</span>&nbsp;<span class="op" id="3749967">=</span>&nbsp;<span class="op" id="3749969">&amp;</span><span class="ident" id="3749970">UDPAddr</span><span class="op" id="3749977">{</span><span class="ident" id="3749978">IP</span><span class="op" id="3749980">:</span>&nbsp;<span class="ident" id="3749982">sa</span><span class="op" id="3749984">.</span><span class="ident" id="3749985">Addr</span><span class="op" id="3749989">[</span><span class="num" id="3749990">0</span><span class="op" id="3749991">:</span><span class="op" id="3749992">]</span><span class="op" id="3749993">,</span>&nbsp;<span class="ident" id="3749995">Port</span><span class="op" id="3749999">:</span>&nbsp;<span class="ident" id="3750001">sa</span><span class="op" id="3750003">.</span><span class="ident" id="3750004">Port</span><span class="op" id="3750008">,</span>&nbsp;<span class="ident" id="3750010">Zone</span><span class="op" id="3750014">:</span>&nbsp;<span class="ident" id="3750016">zoneToString</span><span class="op" id="3750028">(</span><span class="builtintype" id="3750029">int</span><span class="op" id="3750032">(</span><span class="ident" id="3750033">sa</span><span class="op" id="3750035">.</span><span class="ident" id="3750036">ZoneId</span><span class="op" id="3750042">)</span><span class="op" id="3750043">)</span><span class="op" id="3750044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3750047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750050">return</span><br>
<span class="lineno"></span><span class="op" id="3750057">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3750060">//&nbsp;WriteToUDP&nbsp;writes&nbsp;a&nbsp;UDP&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload</span><br>
<span class="lineno"></span><span class="comment" id="3750129">//&nbsp;from&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="3750140">//</span><br>
<span class="lineno"></span><span class="comment" id="3750143">//&nbsp;WriteToUDP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno">110</span><span class="comment" id="3750206">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3750273">//&nbsp;SetWriteDeadline.&nbsp;&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts</span><br>
<span class="lineno"></span><span class="comment" id="3750342">//&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span><span class="keyword" id="3750355">func</span>&nbsp;<span class="op" id="3750360">(</span><span class="ident" id="3750361">c</span>&nbsp;<span class="op" id="3750363">*</span><span class="ident" id="3750364">UDPConn</span><span class="op" id="3750371">)</span>&nbsp;<span class="ident" id="3750373">WriteToUDP</span><span class="op" id="3750383">(</span><span class="ident" id="3750384">b</span>&nbsp;<span class="op" id="3750386">[</span><span class="op" id="3750387">]</span><span class="builtintype" id="3750388">byte</span><span class="op" id="3750392">,</span>&nbsp;<span class="ident" id="3750394">addr</span>&nbsp;<span class="op" id="3750399">*</span><span class="ident" id="3750400">UDPAddr</span><span class="op" id="3750407">)</span>&nbsp;<span class="op" id="3750409">(</span><span class="builtintype" id="3750410">int</span><span class="op" id="3750413">,</span>&nbsp;<span class="builtintype" id="3750415">error</span><span class="op" id="3750420">)</span>&nbsp;<span class="op" id="3750422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750425">if</span>&nbsp;<span class="op" id="3750428">!</span><span class="ident" id="3750429">c</span><span class="op" id="3750430">.</span><span class="ident" id="3750431">ok</span><span class="op" id="3750433">(</span><span class="op" id="3750434">)</span>&nbsp;<span class="op" id="3750436">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750440">return</span>&nbsp;<span class="num" id="3750447">0</span><span class="op" id="3750448">,</span>&nbsp;<span class="ident" id="3750450">syscall</span><span class="op" id="3750457">.</span><span class="ident" id="3750458">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3750466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750469">if</span>&nbsp;<span class="ident" id="3750472">c</span><span class="op" id="3750473">.</span><span class="ident" id="3750474">fd</span><span class="op" id="3750476">.</span><span class="ident" id="3750477">isConnected</span>&nbsp;<span class="op" id="3750489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750493">return</span>&nbsp;<span class="num" id="3750500">0</span><span class="op" id="3750501">,</span>&nbsp;<span class="op" id="3750503">&amp;</span><span class="ident" id="3750504">OpError</span><span class="op" id="3750511">{</span><span class="string" id="3750512">&#34;write&#34;</span><span class="op" id="3750519">,</span>&nbsp;<span class="ident" id="3750521">c</span><span class="op" id="3750522">.</span><span class="ident" id="3750523">fd</span><span class="op" id="3750525">.</span><span class="ident" id="3750526">net</span><span class="op" id="3750529">,</span>&nbsp;<span class="ident" id="3750531">addr</span><span class="op" id="3750535">,</span>&nbsp;<span class="ident" id="3750537">ErrWriteToConnected</span><span class="op" id="3750556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3750559">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750562">if</span>&nbsp;<span class="ident" id="3750565">addr</span>&nbsp;<span class="op" id="3750570">==</span>&nbsp;<span class="ident" id="3750573">nil</span>&nbsp;<span class="op" id="3750577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750581">return</span>&nbsp;<span class="num" id="3750588">0</span><span class="op" id="3750589">,</span>&nbsp;<span class="op" id="3750591">&amp;</span><span class="ident" id="3750592">OpError</span><span class="op" id="3750599">{</span><span class="ident" id="3750600">Op</span><span class="op" id="3750602">:</span>&nbsp;<span class="string" id="3750604">&#34;write&#34;</span><span class="op" id="3750611">,</span>&nbsp;<span class="ident" id="3750613">Net</span><span class="op" id="3750616">:</span>&nbsp;<span class="ident" id="3750618">c</span><span class="op" id="3750619">.</span><span class="ident" id="3750620">fd</span><span class="op" id="3750622">.</span><span class="ident" id="3750623">net</span><span class="op" id="3750626">,</span>&nbsp;<span class="ident" id="3750628">Addr</span><span class="op" id="3750632">:</span>&nbsp;<span class="ident" id="3750634">nil</span><span class="op" id="3750637">,</span>&nbsp;<span class="ident" id="3750639">Err</span><span class="op" id="3750642">:</span>&nbsp;<span class="ident" id="3750644">errMissingAddress</span><span class="op" id="3750661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3750664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3750667">sa</span><span class="op" id="3750669">,</span>&nbsp;<span class="ident" id="3750671">err</span>&nbsp;<span class="op" id="3750675">:=</span>&nbsp;<span class="ident" id="3750678">addr</span><span class="op" id="3750682">.</span><span class="ident" id="3750683">sockaddr</span><span class="op" id="3750691">(</span><span class="ident" id="3750692">c</span><span class="op" id="3750693">.</span><span class="ident" id="3750694">fd</span><span class="op" id="3750696">.</span><span class="ident" id="3750697">family</span><span class="op" id="3750703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750706">if</span>&nbsp;<span class="ident" id="3750709">err</span>&nbsp;<span class="op" id="3750713">!=</span>&nbsp;<span class="ident" id="3750716">nil</span>&nbsp;<span class="op" id="3750720">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750724">return</span>&nbsp;<span class="num" id="3750731">0</span><span class="op" id="3750732">,</span>&nbsp;<span class="op" id="3750734">&amp;</span><span class="ident" id="3750735">OpError</span><span class="op" id="3750742">{</span><span class="string" id="3750743">&#34;write&#34;</span><span class="op" id="3750750">,</span>&nbsp;<span class="ident" id="3750752">c</span><span class="op" id="3750753">.</span><span class="ident" id="3750754">fd</span><span class="op" id="3750756">.</span><span class="ident" id="3750757">net</span><span class="op" id="3750760">,</span>&nbsp;<span class="ident" id="3750762">addr</span><span class="op" id="3750766">,</span>&nbsp;<span class="ident" id="3750768">err</span><span class="op" id="3750771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3750774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750777">return</span>&nbsp;<span class="ident" id="3750784">c</span><span class="op" id="3750785">.</span><span class="ident" id="3750786">fd</span><span class="op" id="3750788">.</span><span class="ident" id="3750789">writeTo</span><span class="op" id="3750796">(</span><span class="ident" id="3750797">b</span><span class="op" id="3750798">,</span>&nbsp;<span class="ident" id="3750800">sa</span><span class="op" id="3750802">)</span><br>
<span class="lineno"></span><span class="op" id="3750804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="3750807">//&nbsp;WriteTo&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3750860">func</span>&nbsp;<span class="op" id="3750865">(</span><span class="ident" id="3750866">c</span>&nbsp;<span class="op" id="3750868">*</span><span class="ident" id="3750869">UDPConn</span><span class="op" id="3750876">)</span>&nbsp;<span class="ident" id="3750878">WriteTo</span><span class="op" id="3750885">(</span><span class="ident" id="3750886">b</span>&nbsp;<span class="op" id="3750888">[</span><span class="op" id="3750889">]</span><span class="builtintype" id="3750890">byte</span><span class="op" id="3750894">,</span>&nbsp;<span class="ident" id="3750896">addr</span>&nbsp;<span class="ident" id="3750901">Addr</span><span class="op" id="3750905">)</span>&nbsp;<span class="op" id="3750907">(</span><span class="builtintype" id="3750908">int</span><span class="op" id="3750911">,</span>&nbsp;<span class="builtintype" id="3750913">error</span><span class="op" id="3750918">)</span>&nbsp;<span class="op" id="3750920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750923">if</span>&nbsp;<span class="op" id="3750926">!</span><span class="ident" id="3750927">c</span><span class="op" id="3750928">.</span><span class="ident" id="3750929">ok</span><span class="op" id="3750931">(</span><span class="op" id="3750932">)</span>&nbsp;<span class="op" id="3750934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750938">return</span>&nbsp;<span class="num" id="3750945">0</span><span class="op" id="3750946">,</span>&nbsp;<span class="ident" id="3750948">syscall</span><span class="op" id="3750955">.</span><span class="ident" id="3750956">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3750964">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3750967">a</span><span class="op" id="3750968">,</span>&nbsp;<span class="ident" id="3750970">ok</span>&nbsp;<span class="op" id="3750973">:=</span>&nbsp;<span class="ident" id="3750976">addr</span><span class="op" id="3750980">.</span><span class="op" id="3750981">(</span><span class="op" id="3750982">*</span><span class="ident" id="3750983">UDPAddr</span><span class="op" id="3750990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3750993">if</span>&nbsp;<span class="op" id="3750996">!</span><span class="ident" id="3750997">ok</span>&nbsp;<span class="op" id="3751000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751004">return</span>&nbsp;<span class="num" id="3751011">0</span><span class="op" id="3751012">,</span>&nbsp;<span class="op" id="3751014">&amp;</span><span class="ident" id="3751015">OpError</span><span class="op" id="3751022">{</span><span class="string" id="3751023">&#34;write&#34;</span><span class="op" id="3751030">,</span>&nbsp;<span class="ident" id="3751032">c</span><span class="op" id="3751033">.</span><span class="ident" id="3751034">fd</span><span class="op" id="3751036">.</span><span class="ident" id="3751037">net</span><span class="op" id="3751040">,</span>&nbsp;<span class="ident" id="3751042">addr</span><span class="op" id="3751046">,</span>&nbsp;<span class="ident" id="3751048">syscall</span><span class="op" id="3751055">.</span><span class="ident" id="3751056">EINVAL</span><span class="op" id="3751062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3751065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751068">return</span>&nbsp;<span class="ident" id="3751075">c</span><span class="op" id="3751076">.</span><span class="ident" id="3751077">WriteToUDP</span><span class="op" id="3751087">(</span><span class="ident" id="3751088">b</span><span class="op" id="3751089">,</span>&nbsp;<span class="ident" id="3751091">a</span><span class="op" id="3751092">)</span><br>
<span class="lineno">140</span><span class="op" id="3751094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3751097">//&nbsp;WriteMsgUDP&nbsp;writes&nbsp;a&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3751168">//&nbsp;b&nbsp;and&nbsp;the&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;from&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3751235">//&nbsp;number&nbsp;of&nbsp;payload&nbsp;and&nbsp;out-of-band&nbsp;bytes&nbsp;written.</span><br>
<span class="lineno">145</span><span class="keyword" id="3751287">func</span>&nbsp;<span class="op" id="3751292">(</span><span class="ident" id="3751293">c</span>&nbsp;<span class="op" id="3751295">*</span><span class="ident" id="3751296">UDPConn</span><span class="op" id="3751303">)</span>&nbsp;<span class="ident" id="3751305">WriteMsgUDP</span><span class="op" id="3751316">(</span><span class="ident" id="3751317">b</span><span class="op" id="3751318">,</span>&nbsp;<span class="ident" id="3751320">oob</span>&nbsp;<span class="op" id="3751324">[</span><span class="op" id="3751325">]</span><span class="builtintype" id="3751326">byte</span><span class="op" id="3751330">,</span>&nbsp;<span class="ident" id="3751332">addr</span>&nbsp;<span class="op" id="3751337">*</span><span class="ident" id="3751338">UDPAddr</span><span class="op" id="3751345">)</span>&nbsp;<span class="op" id="3751347">(</span><span class="ident" id="3751348">n</span><span class="op" id="3751349">,</span>&nbsp;<span class="ident" id="3751351">oobn</span>&nbsp;<span class="builtintype" id="3751356">int</span><span class="op" id="3751359">,</span>&nbsp;<span class="ident" id="3751361">err</span>&nbsp;<span class="builtintype" id="3751365">error</span><span class="op" id="3751370">)</span>&nbsp;<span class="op" id="3751372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751375">if</span>&nbsp;<span class="op" id="3751378">!</span><span class="ident" id="3751379">c</span><span class="op" id="3751380">.</span><span class="ident" id="3751381">ok</span><span class="op" id="3751383">(</span><span class="op" id="3751384">)</span>&nbsp;<span class="op" id="3751386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751390">return</span>&nbsp;<span class="num" id="3751397">0</span><span class="op" id="3751398">,</span>&nbsp;<span class="num" id="3751400">0</span><span class="op" id="3751401">,</span>&nbsp;<span class="ident" id="3751403">syscall</span><span class="op" id="3751410">.</span><span class="ident" id="3751411">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3751419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751422">if</span>&nbsp;<span class="ident" id="3751425">c</span><span class="op" id="3751426">.</span><span class="ident" id="3751427">fd</span><span class="op" id="3751429">.</span><span class="ident" id="3751430">isConnected</span>&nbsp;<span class="op" id="3751442">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751446">return</span>&nbsp;<span class="num" id="3751453">0</span><span class="op" id="3751454">,</span>&nbsp;<span class="num" id="3751456">0</span><span class="op" id="3751457">,</span>&nbsp;<span class="op" id="3751459">&amp;</span><span class="ident" id="3751460">OpError</span><span class="op" id="3751467">{</span><span class="string" id="3751468">&#34;write&#34;</span><span class="op" id="3751475">,</span>&nbsp;<span class="ident" id="3751477">c</span><span class="op" id="3751478">.</span><span class="ident" id="3751479">fd</span><span class="op" id="3751481">.</span><span class="ident" id="3751482">net</span><span class="op" id="3751485">,</span>&nbsp;<span class="ident" id="3751487">addr</span><span class="op" id="3751491">,</span>&nbsp;<span class="ident" id="3751493">ErrWriteToConnected</span><span class="op" id="3751512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3751515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751518">if</span>&nbsp;<span class="ident" id="3751521">addr</span>&nbsp;<span class="op" id="3751526">==</span>&nbsp;<span class="ident" id="3751529">nil</span>&nbsp;<span class="op" id="3751533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751537">return</span>&nbsp;<span class="num" id="3751544">0</span><span class="op" id="3751545">,</span>&nbsp;<span class="num" id="3751547">0</span><span class="op" id="3751548">,</span>&nbsp;<span class="op" id="3751550">&amp;</span><span class="ident" id="3751551">OpError</span><span class="op" id="3751558">{</span><span class="ident" id="3751559">Op</span><span class="op" id="3751561">:</span>&nbsp;<span class="string" id="3751563">&#34;write&#34;</span><span class="op" id="3751570">,</span>&nbsp;<span class="ident" id="3751572">Net</span><span class="op" id="3751575">:</span>&nbsp;<span class="ident" id="3751577">c</span><span class="op" id="3751578">.</span><span class="ident" id="3751579">fd</span><span class="op" id="3751581">.</span><span class="ident" id="3751582">net</span><span class="op" id="3751585">,</span>&nbsp;<span class="ident" id="3751587">Addr</span><span class="op" id="3751591">:</span>&nbsp;<span class="ident" id="3751593">nil</span><span class="op" id="3751596">,</span>&nbsp;<span class="ident" id="3751598">Err</span><span class="op" id="3751601">:</span>&nbsp;<span class="ident" id="3751603">errMissingAddress</span><span class="op" id="3751620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3751623">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3751626">sa</span><span class="op" id="3751628">,</span>&nbsp;<span class="ident" id="3751630">err</span>&nbsp;<span class="op" id="3751634">:=</span>&nbsp;<span class="ident" id="3751637">addr</span><span class="op" id="3751641">.</span><span class="ident" id="3751642">sockaddr</span><span class="op" id="3751650">(</span><span class="ident" id="3751651">c</span><span class="op" id="3751652">.</span><span class="ident" id="3751653">fd</span><span class="op" id="3751655">.</span><span class="ident" id="3751656">family</span><span class="op" id="3751662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751665">if</span>&nbsp;<span class="ident" id="3751668">err</span>&nbsp;<span class="op" id="3751672">!=</span>&nbsp;<span class="ident" id="3751675">nil</span>&nbsp;<span class="op" id="3751679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751683">return</span>&nbsp;<span class="num" id="3751690">0</span><span class="op" id="3751691">,</span>&nbsp;<span class="num" id="3751693">0</span><span class="op" id="3751694">,</span>&nbsp;<span class="op" id="3751696">&amp;</span><span class="ident" id="3751697">OpError</span><span class="op" id="3751704">{</span><span class="string" id="3751705">&#34;write&#34;</span><span class="op" id="3751712">,</span>&nbsp;<span class="ident" id="3751714">c</span><span class="op" id="3751715">.</span><span class="ident" id="3751716">fd</span><span class="op" id="3751718">.</span><span class="ident" id="3751719">net</span><span class="op" id="3751722">,</span>&nbsp;<span class="ident" id="3751724">addr</span><span class="op" id="3751728">,</span>&nbsp;<span class="ident" id="3751730">err</span><span class="op" id="3751733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3751736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3751739">return</span>&nbsp;<span class="ident" id="3751746">c</span><span class="op" id="3751747">.</span><span class="ident" id="3751748">fd</span><span class="op" id="3751750">.</span><span class="ident" id="3751751">writeMsg</span><span class="op" id="3751759">(</span><span class="ident" id="3751760">b</span><span class="op" id="3751761">,</span>&nbsp;<span class="ident" id="3751763">oob</span><span class="op" id="3751766">,</span>&nbsp;<span class="ident" id="3751768">sa</span><span class="op" id="3751770">)</span><br>
<span class="lineno">160</span><span class="op" id="3751772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3751775">//&nbsp;DialUDP&nbsp;connects&nbsp;to&nbsp;the&nbsp;remote&nbsp;address&nbsp;raddr&nbsp;on&nbsp;the&nbsp;network&nbsp;net,</span><br>
<span class="lineno"></span><span class="comment" id="3751843">//&nbsp;which&nbsp;must&nbsp;be&nbsp;&#34;udp&#34;,&nbsp;&#34;udp4&#34;,&nbsp;or&nbsp;&#34;udp6&#34;.&nbsp;&nbsp;If&nbsp;laddr&nbsp;is&nbsp;not&nbsp;nil,&nbsp;it&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3751914">//&nbsp;used&nbsp;as&nbsp;the&nbsp;local&nbsp;address&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">165</span><span class="keyword" id="3751963">func</span>&nbsp;<span class="ident" id="3751968">DialUDP</span><span class="op" id="3751975">(</span><span class="ident" id="3751976">net</span>&nbsp;<span class="builtintype" id="3751980">string</span><span class="op" id="3751986">,</span>&nbsp;<span class="ident" id="3751988">laddr</span><span class="op" id="3751993">,</span>&nbsp;<span class="ident" id="3751995">raddr</span>&nbsp;<span class="op" id="3752001">*</span><span class="ident" id="3752002">UDPAddr</span><span class="op" id="3752009">)</span>&nbsp;<span class="op" id="3752011">(</span><span class="op" id="3752012">*</span><span class="ident" id="3752013">UDPConn</span><span class="op" id="3752020">,</span>&nbsp;<span class="builtintype" id="3752022">error</span><span class="op" id="3752027">)</span>&nbsp;<span class="op" id="3752029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752032">switch</span>&nbsp;<span class="ident" id="3752039">net</span>&nbsp;<span class="op" id="3752043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752046">case</span>&nbsp;<span class="string" id="3752051">&#34;udp&#34;</span><span class="op" id="3752056">,</span>&nbsp;<span class="string" id="3752058">&#34;udp4&#34;</span><span class="op" id="3752064">,</span>&nbsp;<span class="string" id="3752066">&#34;udp6&#34;</span><span class="op" id="3752072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752075">default</span><span class="op" id="3752082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752086">return</span>&nbsp;<span class="ident" id="3752093">nil</span><span class="op" id="3752096">,</span>&nbsp;<span class="op" id="3752098">&amp;</span><span class="ident" id="3752099">OpError</span><span class="op" id="3752106">{</span><span class="ident" id="3752107">Op</span><span class="op" id="3752109">:</span>&nbsp;<span class="string" id="3752111">&#34;dial&#34;</span><span class="op" id="3752117">,</span>&nbsp;<span class="ident" id="3752119">Net</span><span class="op" id="3752122">:</span>&nbsp;<span class="ident" id="3752124">net</span><span class="op" id="3752127">,</span>&nbsp;<span class="ident" id="3752129">Addr</span><span class="op" id="3752133">:</span>&nbsp;<span class="ident" id="3752135">raddr</span><span class="op" id="3752140">,</span>&nbsp;<span class="ident" id="3752142">Err</span><span class="op" id="3752145">:</span>&nbsp;<span class="ident" id="3752147">UnknownNetworkError</span><span class="op" id="3752166">(</span><span class="ident" id="3752167">net</span><span class="op" id="3752170">)</span><span class="op" id="3752171">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752177">if</span>&nbsp;<span class="ident" id="3752180">raddr</span>&nbsp;<span class="op" id="3752186">==</span>&nbsp;<span class="ident" id="3752189">nil</span>&nbsp;<span class="op" id="3752193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752197">return</span>&nbsp;<span class="ident" id="3752204">nil</span><span class="op" id="3752207">,</span>&nbsp;<span class="op" id="3752209">&amp;</span><span class="ident" id="3752210">OpError</span><span class="op" id="3752217">{</span><span class="ident" id="3752218">Op</span><span class="op" id="3752220">:</span>&nbsp;<span class="string" id="3752222">&#34;dial&#34;</span><span class="op" id="3752228">,</span>&nbsp;<span class="ident" id="3752230">Net</span><span class="op" id="3752233">:</span>&nbsp;<span class="ident" id="3752235">net</span><span class="op" id="3752238">,</span>&nbsp;<span class="ident" id="3752240">Addr</span><span class="op" id="3752244">:</span>&nbsp;<span class="ident" id="3752246">nil</span><span class="op" id="3752249">,</span>&nbsp;<span class="ident" id="3752251">Err</span><span class="op" id="3752254">:</span>&nbsp;<span class="ident" id="3752256">errMissingAddress</span><span class="op" id="3752273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752279">return</span>&nbsp;<span class="ident" id="3752286">dialUDP</span><span class="op" id="3752293">(</span><span class="ident" id="3752294">net</span><span class="op" id="3752297">,</span>&nbsp;<span class="ident" id="3752299">laddr</span><span class="op" id="3752304">,</span>&nbsp;<span class="ident" id="3752306">raddr</span><span class="op" id="3752311">,</span>&nbsp;<span class="ident" id="3752313">noDeadline</span><span class="op" id="3752323">)</span><br>
<span class="lineno">175</span><span class="op" id="3752325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3752328">func</span>&nbsp;<span class="ident" id="3752333">dialUDP</span><span class="op" id="3752340">(</span><span class="ident" id="3752341">net</span>&nbsp;<span class="builtintype" id="3752345">string</span><span class="op" id="3752351">,</span>&nbsp;<span class="ident" id="3752353">laddr</span><span class="op" id="3752358">,</span>&nbsp;<span class="ident" id="3752360">raddr</span>&nbsp;<span class="op" id="3752366">*</span><span class="ident" id="3752367">UDPAddr</span><span class="op" id="3752374">,</span>&nbsp;<span class="ident" id="3752376">deadline</span>&nbsp;<span class="ident" id="3752385">time</span><span class="op" id="3752389">.</span><span class="ident" id="3752390">Time</span><span class="op" id="3752394">)</span>&nbsp;<span class="op" id="3752396">(</span><span class="op" id="3752397">*</span><span class="ident" id="3752398">UDPConn</span><span class="op" id="3752405">,</span>&nbsp;<span class="builtintype" id="3752407">error</span><span class="op" id="3752412">)</span>&nbsp;<span class="op" id="3752414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3752417">fd</span><span class="op" id="3752419">,</span>&nbsp;<span class="ident" id="3752421">err</span>&nbsp;<span class="op" id="3752425">:=</span>&nbsp;<span class="ident" id="3752428">internetSocket</span><span class="op" id="3752442">(</span><span class="ident" id="3752443">net</span><span class="op" id="3752446">,</span>&nbsp;<span class="ident" id="3752448">laddr</span><span class="op" id="3752453">,</span>&nbsp;<span class="ident" id="3752455">raddr</span><span class="op" id="3752460">,</span>&nbsp;<span class="ident" id="3752462">deadline</span><span class="op" id="3752470">,</span>&nbsp;<span class="ident" id="3752472">syscall</span><span class="op" id="3752479">.</span><span class="ident" id="3752480">SOCK_DGRAM</span><span class="op" id="3752490">,</span>&nbsp;<span class="num" id="3752492">0</span><span class="op" id="3752493">,</span>&nbsp;<span class="string" id="3752495">&#34;dial&#34;</span><span class="op" id="3752501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752504">if</span>&nbsp;<span class="ident" id="3752507">err</span>&nbsp;<span class="op" id="3752511">!=</span>&nbsp;<span class="ident" id="3752514">nil</span>&nbsp;<span class="op" id="3752518">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752522">return</span>&nbsp;<span class="ident" id="3752529">nil</span><span class="op" id="3752532">,</span>&nbsp;<span class="op" id="3752534">&amp;</span><span class="ident" id="3752535">OpError</span><span class="op" id="3752542">{</span><span class="ident" id="3752543">Op</span><span class="op" id="3752545">:</span>&nbsp;<span class="string" id="3752547">&#34;dial&#34;</span><span class="op" id="3752553">,</span>&nbsp;<span class="ident" id="3752555">Net</span><span class="op" id="3752558">:</span>&nbsp;<span class="ident" id="3752560">net</span><span class="op" id="3752563">,</span>&nbsp;<span class="ident" id="3752565">Addr</span><span class="op" id="3752569">:</span>&nbsp;<span class="ident" id="3752571">raddr</span><span class="op" id="3752576">,</span>&nbsp;<span class="ident" id="3752578">Err</span><span class="op" id="3752581">:</span>&nbsp;<span class="ident" id="3752583">err</span><span class="op" id="3752586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3752589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3752592">return</span>&nbsp;<span class="ident" id="3752599">newUDPConn</span><span class="op" id="3752609">(</span><span class="ident" id="3752610">fd</span><span class="op" id="3752612">)</span><span class="op" id="3752613">,</span>&nbsp;<span class="ident" id="3752615">nil</span><br>
<span class="lineno"></span><span class="op" id="3752619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="comment" id="3752622">//&nbsp;ListenUDP&nbsp;listens&nbsp;for&nbsp;incoming&nbsp;UDP&nbsp;packets&nbsp;addressed&nbsp;to&nbsp;the&nbsp;local</span><br>
<span class="lineno"></span><span class="comment" id="3752691">//&nbsp;address&nbsp;laddr.&nbsp;&nbsp;Net&nbsp;must&nbsp;be&nbsp;&#34;udp&#34;,&nbsp;&#34;udp4&#34;,&nbsp;or&nbsp;&#34;udp6&#34;.&nbsp;&nbsp;If&nbsp;laddr&nbsp;has</span><br>
<span class="lineno"></span><span class="comment" id="3752762">//&nbsp;a&nbsp;port&nbsp;of&nbsp;0,&nbsp;ListenUDP&nbsp;will&nbsp;choose&nbsp;an&nbsp;available&nbsp;port.</span><br>
<span class="lineno"></span><span class="comment" id="3752819">//&nbsp;The&nbsp;LocalAddr&nbsp;method&nbsp;of&nbsp;the&nbsp;returned&nbsp;UDPConn&nbsp;can&nbsp;be&nbsp;used&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3752882">//&nbsp;discover&nbsp;the&nbsp;port.&nbsp;&nbsp;The&nbsp;returned&nbsp;connection&#39;s&nbsp;ReadFrom&nbsp;and&nbsp;WriteTo</span><br>
<span class="lineno">190</span><span class="comment" id="3752952">//&nbsp;methods&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;receive&nbsp;and&nbsp;send&nbsp;UDP&nbsp;packets&nbsp;with&nbsp;per-packet</span><br>
<span class="lineno"></span><span class="comment" id="3753023">//&nbsp;addressing.</span><br>
<span class="lineno"></span><span class="keyword" id="3753038">func</span>&nbsp;<span class="ident" id="3753043">ListenUDP</span><span class="op" id="3753052">(</span><span class="ident" id="3753053">net</span>&nbsp;<span class="builtintype" id="3753057">string</span><span class="op" id="3753063">,</span>&nbsp;<span class="ident" id="3753065">laddr</span>&nbsp;<span class="op" id="3753071">*</span><span class="ident" id="3753072">UDPAddr</span><span class="op" id="3753079">)</span>&nbsp;<span class="op" id="3753081">(</span><span class="op" id="3753082">*</span><span class="ident" id="3753083">UDPConn</span><span class="op" id="3753090">,</span>&nbsp;<span class="builtintype" id="3753092">error</span><span class="op" id="3753097">)</span>&nbsp;<span class="op" id="3753099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753102">switch</span>&nbsp;<span class="ident" id="3753109">net</span>&nbsp;<span class="op" id="3753113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753116">case</span>&nbsp;<span class="string" id="3753121">&#34;udp&#34;</span><span class="op" id="3753126">,</span>&nbsp;<span class="string" id="3753128">&#34;udp4&#34;</span><span class="op" id="3753134">,</span>&nbsp;<span class="string" id="3753136">&#34;udp6&#34;</span><span class="op" id="3753142">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753145">default</span><span class="op" id="3753152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753156">return</span>&nbsp;<span class="ident" id="3753163">nil</span><span class="op" id="3753166">,</span>&nbsp;<span class="op" id="3753168">&amp;</span><span class="ident" id="3753169">OpError</span><span class="op" id="3753176">{</span><span class="ident" id="3753177">Op</span><span class="op" id="3753179">:</span>&nbsp;<span class="string" id="3753181">&#34;listen&#34;</span><span class="op" id="3753189">,</span>&nbsp;<span class="ident" id="3753191">Net</span><span class="op" id="3753194">:</span>&nbsp;<span class="ident" id="3753196">net</span><span class="op" id="3753199">,</span>&nbsp;<span class="ident" id="3753201">Addr</span><span class="op" id="3753205">:</span>&nbsp;<span class="ident" id="3753207">laddr</span><span class="op" id="3753212">,</span>&nbsp;<span class="ident" id="3753214">Err</span><span class="op" id="3753217">:</span>&nbsp;<span class="ident" id="3753219">UnknownNetworkError</span><span class="op" id="3753238">(</span><span class="ident" id="3753239">net</span><span class="op" id="3753242">)</span><span class="op" id="3753243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753249">if</span>&nbsp;<span class="ident" id="3753252">laddr</span>&nbsp;<span class="op" id="3753258">==</span>&nbsp;<span class="ident" id="3753261">nil</span>&nbsp;<span class="op" id="3753265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753269">laddr</span>&nbsp;<span class="op" id="3753275">=</span>&nbsp;<span class="op" id="3753277">&amp;</span><span class="ident" id="3753278">UDPAddr</span><span class="op" id="3753285">{</span><span class="op" id="3753286">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3753292">fd</span><span class="op" id="3753294">,</span>&nbsp;<span class="ident" id="3753296">err</span>&nbsp;<span class="op" id="3753300">:=</span>&nbsp;<span class="ident" id="3753303">internetSocket</span><span class="op" id="3753317">(</span><span class="ident" id="3753318">net</span><span class="op" id="3753321">,</span>&nbsp;<span class="ident" id="3753323">laddr</span><span class="op" id="3753328">,</span>&nbsp;<span class="ident" id="3753330">nil</span><span class="op" id="3753333">,</span>&nbsp;<span class="ident" id="3753335">noDeadline</span><span class="op" id="3753345">,</span>&nbsp;<span class="ident" id="3753347">syscall</span><span class="op" id="3753354">.</span><span class="ident" id="3753355">SOCK_DGRAM</span><span class="op" id="3753365">,</span>&nbsp;<span class="num" id="3753367">0</span><span class="op" id="3753368">,</span>&nbsp;<span class="string" id="3753370">&#34;listen&#34;</span><span class="op" id="3753378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753381">if</span>&nbsp;<span class="ident" id="3753384">err</span>&nbsp;<span class="op" id="3753388">!=</span>&nbsp;<span class="ident" id="3753391">nil</span>&nbsp;<span class="op" id="3753395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753399">return</span>&nbsp;<span class="ident" id="3753406">nil</span><span class="op" id="3753409">,</span>&nbsp;<span class="op" id="3753411">&amp;</span><span class="ident" id="3753412">OpError</span><span class="op" id="3753419">{</span><span class="ident" id="3753420">Op</span><span class="op" id="3753422">:</span>&nbsp;<span class="string" id="3753424">&#34;listen&#34;</span><span class="op" id="3753432">,</span>&nbsp;<span class="ident" id="3753434">Net</span><span class="op" id="3753437">:</span>&nbsp;<span class="ident" id="3753439">net</span><span class="op" id="3753442">,</span>&nbsp;<span class="ident" id="3753444">Addr</span><span class="op" id="3753448">:</span>&nbsp;<span class="ident" id="3753450">laddr</span><span class="op" id="3753455">,</span>&nbsp;<span class="ident" id="3753457">Err</span><span class="op" id="3753460">:</span>&nbsp;<span class="ident" id="3753462">err</span><span class="op" id="3753465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753468">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753471">return</span>&nbsp;<span class="ident" id="3753478">newUDPConn</span><span class="op" id="3753488">(</span><span class="ident" id="3753489">fd</span><span class="op" id="3753491">)</span><span class="op" id="3753492">,</span>&nbsp;<span class="ident" id="3753494">nil</span><br>
<span class="lineno"></span><span class="op" id="3753498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3753501">//&nbsp;ListenMulticastUDP&nbsp;listens&nbsp;for&nbsp;incoming&nbsp;multicast&nbsp;UDP&nbsp;packets</span><br>
<span class="lineno"></span><span class="comment" id="3753566">//&nbsp;addressed&nbsp;to&nbsp;the&nbsp;group&nbsp;address&nbsp;gaddr&nbsp;on&nbsp;ifi,&nbsp;which&nbsp;specifies&nbsp;the</span><br>
<span class="lineno">210</span><span class="comment" id="3753634">//&nbsp;interface&nbsp;to&nbsp;join.&nbsp;&nbsp;ListenMulticastUDP&nbsp;uses&nbsp;default&nbsp;multicast</span><br>
<span class="lineno"></span><span class="comment" id="3753699">//&nbsp;interface&nbsp;if&nbsp;ifi&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3753727">func</span>&nbsp;<span class="ident" id="3753732">ListenMulticastUDP</span><span class="op" id="3753750">(</span><span class="ident" id="3753751">net</span>&nbsp;<span class="builtintype" id="3753755">string</span><span class="op" id="3753761">,</span>&nbsp;<span class="ident" id="3753763">ifi</span>&nbsp;<span class="op" id="3753767">*</span><span class="ident" id="3753768">Interface</span><span class="op" id="3753777">,</span>&nbsp;<span class="ident" id="3753779">gaddr</span>&nbsp;<span class="op" id="3753785">*</span><span class="ident" id="3753786">UDPAddr</span><span class="op" id="3753793">)</span>&nbsp;<span class="op" id="3753795">(</span><span class="op" id="3753796">*</span><span class="ident" id="3753797">UDPConn</span><span class="op" id="3753804">,</span>&nbsp;<span class="builtintype" id="3753806">error</span><span class="op" id="3753811">)</span>&nbsp;<span class="op" id="3753813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753816">switch</span>&nbsp;<span class="ident" id="3753823">net</span>&nbsp;<span class="op" id="3753827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753830">case</span>&nbsp;<span class="string" id="3753835">&#34;udp&#34;</span><span class="op" id="3753840">,</span>&nbsp;<span class="string" id="3753842">&#34;udp4&#34;</span><span class="op" id="3753848">,</span>&nbsp;<span class="string" id="3753850">&#34;udp6&#34;</span><span class="op" id="3753856">:</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753859">default</span><span class="op" id="3753866">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753870">return</span>&nbsp;<span class="ident" id="3753877">nil</span><span class="op" id="3753880">,</span>&nbsp;<span class="op" id="3753882">&amp;</span><span class="ident" id="3753883">OpError</span><span class="op" id="3753890">{</span><span class="ident" id="3753891">Op</span><span class="op" id="3753893">:</span>&nbsp;<span class="string" id="3753895">&#34;listen&#34;</span><span class="op" id="3753903">,</span>&nbsp;<span class="ident" id="3753905">Net</span><span class="op" id="3753908">:</span>&nbsp;<span class="ident" id="3753910">net</span><span class="op" id="3753913">,</span>&nbsp;<span class="ident" id="3753915">Addr</span><span class="op" id="3753919">:</span>&nbsp;<span class="ident" id="3753921">gaddr</span><span class="op" id="3753926">,</span>&nbsp;<span class="ident" id="3753928">Err</span><span class="op" id="3753931">:</span>&nbsp;<span class="ident" id="3753933">UnknownNetworkError</span><span class="op" id="3753952">(</span><span class="ident" id="3753953">net</span><span class="op" id="3753956">)</span><span class="op" id="3753957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3753960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3753963">if</span>&nbsp;<span class="ident" id="3753966">gaddr</span>&nbsp;<span class="op" id="3753972">==</span>&nbsp;<span class="ident" id="3753975">nil</span>&nbsp;<span class="op" id="3753979">||</span>&nbsp;<span class="ident" id="3753982">gaddr</span><span class="op" id="3753987">.</span><span class="ident" id="3753988">IP</span>&nbsp;<span class="op" id="3753991">==</span>&nbsp;<span class="ident" id="3753994">nil</span>&nbsp;<span class="op" id="3753998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754002">return</span>&nbsp;<span class="ident" id="3754009">nil</span><span class="op" id="3754012">,</span>&nbsp;<span class="op" id="3754014">&amp;</span><span class="ident" id="3754015">OpError</span><span class="op" id="3754022">{</span><span class="ident" id="3754023">Op</span><span class="op" id="3754025">:</span>&nbsp;<span class="string" id="3754027">&#34;listen&#34;</span><span class="op" id="3754035">,</span>&nbsp;<span class="ident" id="3754037">Net</span><span class="op" id="3754040">:</span>&nbsp;<span class="ident" id="3754042">net</span><span class="op" id="3754045">,</span>&nbsp;<span class="ident" id="3754047">Addr</span><span class="op" id="3754051">:</span>&nbsp;<span class="ident" id="3754053">nil</span><span class="op" id="3754056">,</span>&nbsp;<span class="ident" id="3754058">Err</span><span class="op" id="3754061">:</span>&nbsp;<span class="ident" id="3754063">errMissingAddress</span><span class="op" id="3754080">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754086">fd</span><span class="op" id="3754088">,</span>&nbsp;<span class="ident" id="3754090">err</span>&nbsp;<span class="op" id="3754094">:=</span>&nbsp;<span class="ident" id="3754097">internetSocket</span><span class="op" id="3754111">(</span><span class="ident" id="3754112">net</span><span class="op" id="3754115">,</span>&nbsp;<span class="ident" id="3754117">gaddr</span><span class="op" id="3754122">,</span>&nbsp;<span class="ident" id="3754124">nil</span><span class="op" id="3754127">,</span>&nbsp;<span class="ident" id="3754129">noDeadline</span><span class="op" id="3754139">,</span>&nbsp;<span class="ident" id="3754141">syscall</span><span class="op" id="3754148">.</span><span class="ident" id="3754149">SOCK_DGRAM</span><span class="op" id="3754159">,</span>&nbsp;<span class="num" id="3754161">0</span><span class="op" id="3754162">,</span>&nbsp;<span class="string" id="3754164">&#34;listen&#34;</span><span class="op" id="3754172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754175">if</span>&nbsp;<span class="ident" id="3754178">err</span>&nbsp;<span class="op" id="3754182">!=</span>&nbsp;<span class="ident" id="3754185">nil</span>&nbsp;<span class="op" id="3754189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754193">return</span>&nbsp;<span class="ident" id="3754200">nil</span><span class="op" id="3754203">,</span>&nbsp;<span class="op" id="3754205">&amp;</span><span class="ident" id="3754206">OpError</span><span class="op" id="3754213">{</span><span class="ident" id="3754214">Op</span><span class="op" id="3754216">:</span>&nbsp;<span class="string" id="3754218">&#34;listen&#34;</span><span class="op" id="3754226">,</span>&nbsp;<span class="ident" id="3754228">Net</span><span class="op" id="3754231">:</span>&nbsp;<span class="ident" id="3754233">net</span><span class="op" id="3754236">,</span>&nbsp;<span class="ident" id="3754238">Addr</span><span class="op" id="3754242">:</span>&nbsp;<span class="ident" id="3754244">gaddr</span><span class="op" id="3754249">,</span>&nbsp;<span class="ident" id="3754251">Err</span><span class="op" id="3754254">:</span>&nbsp;<span class="ident" id="3754256">err</span><span class="op" id="3754259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754262">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754265">c</span>&nbsp;<span class="op" id="3754267">:=</span>&nbsp;<span class="ident" id="3754270">newUDPConn</span><span class="op" id="3754280">(</span><span class="ident" id="3754281">fd</span><span class="op" id="3754283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754286">if</span>&nbsp;<span class="ident" id="3754289">ip4</span>&nbsp;<span class="op" id="3754293">:=</span>&nbsp;<span class="ident" id="3754296">gaddr</span><span class="op" id="3754301">.</span><span class="ident" id="3754302">IP</span><span class="op" id="3754304">.</span><span class="ident" id="3754305">To4</span><span class="op" id="3754308">(</span><span class="op" id="3754309">)</span><span class="op" id="3754310">;</span>&nbsp;<span class="ident" id="3754312">ip4</span>&nbsp;<span class="op" id="3754316">!=</span>&nbsp;<span class="ident" id="3754319">nil</span>&nbsp;<span class="op" id="3754323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754327">if</span>&nbsp;<span class="ident" id="3754330">err</span>&nbsp;<span class="op" id="3754334">:=</span>&nbsp;<span class="ident" id="3754337">listenIPv4MulticastUDP</span><span class="op" id="3754359">(</span><span class="ident" id="3754360">c</span><span class="op" id="3754361">,</span>&nbsp;<span class="ident" id="3754363">ifi</span><span class="op" id="3754366">,</span>&nbsp;<span class="ident" id="3754368">ip4</span><span class="op" id="3754371">)</span><span class="op" id="3754372">;</span>&nbsp;<span class="ident" id="3754374">err</span>&nbsp;<span class="op" id="3754378">!=</span>&nbsp;<span class="ident" id="3754381">nil</span>&nbsp;<span class="op" id="3754385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754390">c</span><span class="op" id="3754391">.</span><span class="ident" id="3754392">Close</span><span class="op" id="3754397">(</span><span class="op" id="3754398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754403">return</span>&nbsp;<span class="ident" id="3754410">nil</span><span class="op" id="3754413">,</span>&nbsp;<span class="op" id="3754415">&amp;</span><span class="ident" id="3754416">OpError</span><span class="op" id="3754423">{</span><span class="ident" id="3754424">Op</span><span class="op" id="3754426">:</span>&nbsp;<span class="string" id="3754428">&#34;listen&#34;</span><span class="op" id="3754436">,</span>&nbsp;<span class="ident" id="3754438">Net</span><span class="op" id="3754441">:</span>&nbsp;<span class="ident" id="3754443">net</span><span class="op" id="3754446">,</span>&nbsp;<span class="ident" id="3754448">Addr</span><span class="op" id="3754452">:</span>&nbsp;<span class="op" id="3754454">&amp;</span><span class="ident" id="3754455">IPAddr</span><span class="op" id="3754461">{</span><span class="ident" id="3754462">IP</span><span class="op" id="3754464">:</span>&nbsp;<span class="ident" id="3754466">ip4</span><span class="op" id="3754469">}</span><span class="op" id="3754470">,</span>&nbsp;<span class="ident" id="3754472">Err</span><span class="op" id="3754475">:</span>&nbsp;<span class="ident" id="3754477">err</span><span class="op" id="3754480">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754487">}</span>&nbsp;<span class="keyword" id="3754489">else</span>&nbsp;<span class="op" id="3754494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754498">if</span>&nbsp;<span class="ident" id="3754501">err</span>&nbsp;<span class="op" id="3754505">:=</span>&nbsp;<span class="ident" id="3754508">listenIPv6MulticastUDP</span><span class="op" id="3754530">(</span><span class="ident" id="3754531">c</span><span class="op" id="3754532">,</span>&nbsp;<span class="ident" id="3754534">ifi</span><span class="op" id="3754537">,</span>&nbsp;<span class="ident" id="3754539">gaddr</span><span class="op" id="3754544">.</span><span class="ident" id="3754545">IP</span><span class="op" id="3754547">)</span><span class="op" id="3754548">;</span>&nbsp;<span class="ident" id="3754550">err</span>&nbsp;<span class="op" id="3754554">!=</span>&nbsp;<span class="ident" id="3754557">nil</span>&nbsp;<span class="op" id="3754561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754566">c</span><span class="op" id="3754567">.</span><span class="ident" id="3754568">Close</span><span class="op" id="3754573">(</span><span class="op" id="3754574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754579">return</span>&nbsp;<span class="ident" id="3754586">nil</span><span class="op" id="3754589">,</span>&nbsp;<span class="op" id="3754591">&amp;</span><span class="ident" id="3754592">OpError</span><span class="op" id="3754599">{</span><span class="ident" id="3754600">Op</span><span class="op" id="3754602">:</span>&nbsp;<span class="string" id="3754604">&#34;listen&#34;</span><span class="op" id="3754612">,</span>&nbsp;<span class="ident" id="3754614">Net</span><span class="op" id="3754617">:</span>&nbsp;<span class="ident" id="3754619">net</span><span class="op" id="3754622">,</span>&nbsp;<span class="ident" id="3754624">Addr</span><span class="op" id="3754628">:</span>&nbsp;<span class="op" id="3754630">&amp;</span><span class="ident" id="3754631">IPAddr</span><span class="op" id="3754637">{</span><span class="ident" id="3754638">IP</span><span class="op" id="3754640">:</span>&nbsp;<span class="ident" id="3754642">gaddr</span><span class="op" id="3754647">.</span><span class="ident" id="3754648">IP</span><span class="op" id="3754650">}</span><span class="op" id="3754651">,</span>&nbsp;<span class="ident" id="3754653">Err</span><span class="op" id="3754656">:</span>&nbsp;<span class="ident" id="3754658">err</span><span class="op" id="3754661">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754671">return</span>&nbsp;<span class="ident" id="3754678">c</span><span class="op" id="3754679">,</span>&nbsp;<span class="ident" id="3754681">nil</span><br>
<span class="lineno"></span><span class="op" id="3754685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="3754688">func</span>&nbsp;<span class="ident" id="3754693">listenIPv4MulticastUDP</span><span class="op" id="3754715">(</span><span class="ident" id="3754716">c</span>&nbsp;<span class="op" id="3754718">*</span><span class="ident" id="3754719">UDPConn</span><span class="op" id="3754726">,</span>&nbsp;<span class="ident" id="3754728">ifi</span>&nbsp;<span class="op" id="3754732">*</span><span class="ident" id="3754733">Interface</span><span class="op" id="3754742">,</span>&nbsp;<span class="ident" id="3754744">ip</span>&nbsp;<span class="ident" id="3754747">IP</span><span class="op" id="3754749">)</span>&nbsp;<span class="builtintype" id="3754751">error</span>&nbsp;<span class="op" id="3754757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754760">if</span>&nbsp;<span class="ident" id="3754763">ifi</span>&nbsp;<span class="op" id="3754767">!=</span>&nbsp;<span class="ident" id="3754770">nil</span>&nbsp;<span class="op" id="3754774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754778">if</span>&nbsp;<span class="ident" id="3754781">err</span>&nbsp;<span class="op" id="3754785">:=</span>&nbsp;<span class="ident" id="3754788">setIPv4MulticastInterface</span><span class="op" id="3754813">(</span><span class="ident" id="3754814">c</span><span class="op" id="3754815">.</span><span class="ident" id="3754816">fd</span><span class="op" id="3754818">,</span>&nbsp;<span class="ident" id="3754820">ifi</span><span class="op" id="3754823">)</span><span class="op" id="3754824">;</span>&nbsp;<span class="ident" id="3754826">err</span>&nbsp;<span class="op" id="3754830">!=</span>&nbsp;<span class="ident" id="3754833">nil</span>&nbsp;<span class="op" id="3754837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754842">return</span>&nbsp;<span class="ident" id="3754849">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754855">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754861">if</span>&nbsp;<span class="ident" id="3754864">err</span>&nbsp;<span class="op" id="3754868">:=</span>&nbsp;<span class="ident" id="3754871">setIPv4MulticastLoopback</span><span class="op" id="3754895">(</span><span class="ident" id="3754896">c</span><span class="op" id="3754897">.</span><span class="ident" id="3754898">fd</span><span class="op" id="3754900">,</span>&nbsp;<span class="builtintype" id="3754902">false</span><span class="op" id="3754907">)</span><span class="op" id="3754908">;</span>&nbsp;<span class="ident" id="3754910">err</span>&nbsp;<span class="op" id="3754914">!=</span>&nbsp;<span class="ident" id="3754917">nil</span>&nbsp;<span class="op" id="3754921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754925">return</span>&nbsp;<span class="ident" id="3754932">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3754937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754940">if</span>&nbsp;<span class="ident" id="3754943">err</span>&nbsp;<span class="op" id="3754947">:=</span>&nbsp;<span class="ident" id="3754950">joinIPv4Group</span><span class="op" id="3754963">(</span><span class="ident" id="3754964">c</span><span class="op" id="3754965">.</span><span class="ident" id="3754966">fd</span><span class="op" id="3754968">,</span>&nbsp;<span class="ident" id="3754970">ifi</span><span class="op" id="3754973">,</span>&nbsp;<span class="ident" id="3754975">ip</span><span class="op" id="3754977">)</span><span class="op" id="3754978">;</span>&nbsp;<span class="ident" id="3754980">err</span>&nbsp;<span class="op" id="3754984">!=</span>&nbsp;<span class="ident" id="3754987">nil</span>&nbsp;<span class="op" id="3754991">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3754995">return</span>&nbsp;<span class="ident" id="3755002">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755010">return</span>&nbsp;<span class="ident" id="3755017">nil</span><br>
<span class="lineno"></span><span class="op" id="3755021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="keyword" id="3755024">func</span>&nbsp;<span class="ident" id="3755029">listenIPv6MulticastUDP</span><span class="op" id="3755051">(</span><span class="ident" id="3755052">c</span>&nbsp;<span class="op" id="3755054">*</span><span class="ident" id="3755055">UDPConn</span><span class="op" id="3755062">,</span>&nbsp;<span class="ident" id="3755064">ifi</span>&nbsp;<span class="op" id="3755068">*</span><span class="ident" id="3755069">Interface</span><span class="op" id="3755078">,</span>&nbsp;<span class="ident" id="3755080">ip</span>&nbsp;<span class="ident" id="3755083">IP</span><span class="op" id="3755085">)</span>&nbsp;<span class="builtintype" id="3755087">error</span>&nbsp;<span class="op" id="3755093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755096">if</span>&nbsp;<span class="ident" id="3755099">ifi</span>&nbsp;<span class="op" id="3755103">!=</span>&nbsp;<span class="ident" id="3755106">nil</span>&nbsp;<span class="op" id="3755110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755114">if</span>&nbsp;<span class="ident" id="3755117">err</span>&nbsp;<span class="op" id="3755121">:=</span>&nbsp;<span class="ident" id="3755124">setIPv6MulticastInterface</span><span class="op" id="3755149">(</span><span class="ident" id="3755150">c</span><span class="op" id="3755151">.</span><span class="ident" id="3755152">fd</span><span class="op" id="3755154">,</span>&nbsp;<span class="ident" id="3755156">ifi</span><span class="op" id="3755159">)</span><span class="op" id="3755160">;</span>&nbsp;<span class="ident" id="3755162">err</span>&nbsp;<span class="op" id="3755166">!=</span>&nbsp;<span class="ident" id="3755169">nil</span>&nbsp;<span class="op" id="3755173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755178">return</span>&nbsp;<span class="ident" id="3755185">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755191">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755197">if</span>&nbsp;<span class="ident" id="3755200">err</span>&nbsp;<span class="op" id="3755204">:=</span>&nbsp;<span class="ident" id="3755207">setIPv6MulticastLoopback</span><span class="op" id="3755231">(</span><span class="ident" id="3755232">c</span><span class="op" id="3755233">.</span><span class="ident" id="3755234">fd</span><span class="op" id="3755236">,</span>&nbsp;<span class="builtintype" id="3755238">false</span><span class="op" id="3755243">)</span><span class="op" id="3755244">;</span>&nbsp;<span class="ident" id="3755246">err</span>&nbsp;<span class="op" id="3755250">!=</span>&nbsp;<span class="ident" id="3755253">nil</span>&nbsp;<span class="op" id="3755257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755261">return</span>&nbsp;<span class="ident" id="3755268">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755276">if</span>&nbsp;<span class="ident" id="3755279">err</span>&nbsp;<span class="op" id="3755283">:=</span>&nbsp;<span class="ident" id="3755286">joinIPv6Group</span><span class="op" id="3755299">(</span><span class="ident" id="3755300">c</span><span class="op" id="3755301">.</span><span class="ident" id="3755302">fd</span><span class="op" id="3755304">,</span>&nbsp;<span class="ident" id="3755306">ifi</span><span class="op" id="3755309">,</span>&nbsp;<span class="ident" id="3755311">ip</span><span class="op" id="3755313">)</span><span class="op" id="3755314">;</span>&nbsp;<span class="ident" id="3755316">err</span>&nbsp;<span class="op" id="3755320">!=</span>&nbsp;<span class="ident" id="3755323">nil</span>&nbsp;<span class="op" id="3755327">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755331">return</span>&nbsp;<span class="ident" id="3755338">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3755346">return</span>&nbsp;<span class="ident" id="3755353">nil</span><br>
<span class="lineno"></span><span class="op" id="3755357">}</span>
</div>
</body>
</html>
