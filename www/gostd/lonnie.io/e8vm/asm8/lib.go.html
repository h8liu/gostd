<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/asm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/asm8/bare_func.go.html">bare_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_file.go.html">build_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_func.go.html">build_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_lib.go.html">build_lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_var.go.html">build_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/builder.go.html">builder.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/check_type.go.html">check_type.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_hex.go.html">data_hex.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_nums.go.html">data_nums.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_str.go.html">data_str.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/file.go.html">file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_decl.go.html">func_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_stmt.go.html">func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst.go.html">inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all.go.html">lex_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all_test.go.html">lex_all_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_comment.go.html">lex_comment.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_operand.go.html">lex_operand.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_string.go.html">lex_string.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lib.go.html">lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/package.go.html">package.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_arg.go.html">parse_arg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_file.go.html">parse_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func.go.html">parse_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_stmt.go.html">parse_func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_test.go.html">parse_func_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_inst.go.html">parse_inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_label.go.html">parse_label.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_reg.go.html">parse_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_sym.go.html">parse_sym.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var.go.html">parse_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var_stmt.go.html">parse_var_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parser.go.html">parser.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/single_file.go.html">single_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/stmt_lexer.go.html">stmt_lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_scope.go.html">sym_scope.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_table.go.html">sym_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/symbol.go.html">symbol.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/token.go.html">token.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_decl.go.html">var_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_stmt.go.html">var_stmt.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="4877428">package</span>&nbsp;<span class="ident" id="4877436">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4877442">import</span>&nbsp;<span class="op" id="4877449">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4877452">&#34;lonnie.io/e8vm/link8&#34;</span><br>
<span class="lineno">5</span><span class="op" id="4877475">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4877478">//&nbsp;PkgObj&nbsp;is&nbsp;a&nbsp;package&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4877509">type</span>&nbsp;<span class="ident" id="4877514">lib</span>&nbsp;<span class="keyword" id="4877518">struct</span>&nbsp;<span class="op" id="4877525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877528">*</span><span class="ident" id="4877529">link8</span><span class="op" id="4877534">.</span><span class="ident" id="4877535">Package</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877545">requires</span>&nbsp;<span class="keyword" id="4877554">map</span><span class="op" id="4877557">[</span><span class="builtintype" id="4877558">uint32</span><span class="op" id="4877564">]</span><span class="op" id="4877565">*</span><span class="ident" id="4877566">lib</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877571">symbols</span>&nbsp;&nbsp;<span class="keyword" id="4877580">map</span><span class="op" id="4877583">[</span><span class="builtintype" id="4877584">string</span><span class="op" id="4877590">]</span><span class="op" id="4877591">*</span><span class="ident" id="4877592">symbol</span><br>
<span class="lineno"></span><span class="op" id="4877599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4877602">//&nbsp;NewPkgObj&nbsp;creates&nbsp;a&nbsp;new&nbsp;package&nbsp;compile&nbsp;object</span><br>
<span class="lineno"></span><span class="keyword" id="4877652">func</span>&nbsp;<span class="ident" id="4877657">newLib</span><span class="op" id="4877663">(</span><span class="ident" id="4877664">p</span>&nbsp;<span class="builtintype" id="4877666">string</span><span class="op" id="4877672">)</span>&nbsp;<span class="op" id="4877674">*</span><span class="ident" id="4877675">lib</span>&nbsp;<span class="op" id="4877679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877682">ret</span>&nbsp;<span class="op" id="4877686">:=</span>&nbsp;<span class="builtinfunc" id="4877689">new</span><span class="op" id="4877692">(</span><span class="ident" id="4877693">lib</span><span class="op" id="4877696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877699">ret</span><span class="op" id="4877702">.</span><span class="ident" id="4877703">Package</span>&nbsp;<span class="op" id="4877711">=</span>&nbsp;<span class="ident" id="4877713">link8</span><span class="op" id="4877718">.</span><span class="ident" id="4877719">NewPackage</span><span class="op" id="4877729">(</span><span class="ident" id="4877730">p</span><span class="op" id="4877731">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877735">ret</span><span class="op" id="4877738">.</span><span class="ident" id="4877739">requires</span>&nbsp;<span class="op" id="4877748">=</span>&nbsp;<span class="builtinfunc" id="4877750">make</span><span class="op" id="4877754">(</span><span class="keyword" id="4877755">map</span><span class="op" id="4877758">[</span><span class="builtintype" id="4877759">uint32</span><span class="op" id="4877765">]</span><span class="op" id="4877766">*</span><span class="ident" id="4877767">lib</span><span class="op" id="4877770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877773">ret</span><span class="op" id="4877776">.</span><span class="ident" id="4877777">symbols</span>&nbsp;<span class="op" id="4877785">=</span>&nbsp;<span class="builtinfunc" id="4877787">make</span><span class="op" id="4877791">(</span><span class="keyword" id="4877792">map</span><span class="op" id="4877795">[</span><span class="builtintype" id="4877796">string</span><span class="op" id="4877802">]</span><span class="op" id="4877803">*</span><span class="ident" id="4877804">symbol</span><span class="op" id="4877810">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877814">id</span>&nbsp;<span class="op" id="4877817">:=</span>&nbsp;<span class="ident" id="4877820">ret</span><span class="op" id="4877823">.</span><span class="ident" id="4877824">Require</span><span class="op" id="4877831">(</span><span class="ident" id="4877832">ret</span><span class="op" id="4877835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877838">if</span>&nbsp;<span class="ident" id="4877841">id</span>&nbsp;<span class="op" id="4877844">!=</span>&nbsp;<span class="num" id="4877847">0</span>&nbsp;<span class="op" id="4877849">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4877853">panic</span><span class="op" id="4877858">(</span><span class="string" id="4877859">&#34;bug&#34;</span><span class="op" id="4877864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877871">return</span>&nbsp;<span class="ident" id="4877878">ret</span><br>
<span class="lineno"></span><span class="op" id="4877882">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4877885">//&nbsp;Require&nbsp;imports&nbsp;a&nbsp;package&nbsp;in&nbsp;and&nbsp;grants&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="4877940">//&nbsp;a&nbsp;import&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="4877959">func</span>&nbsp;<span class="op" id="4877964">(</span><span class="ident" id="4877965">p</span>&nbsp;<span class="op" id="4877967">*</span><span class="ident" id="4877968">lib</span><span class="op" id="4877971">)</span>&nbsp;<span class="ident" id="4877973">Require</span><span class="op" id="4877980">(</span><span class="ident" id="4877981">req</span>&nbsp;<span class="op" id="4877985">*</span><span class="ident" id="4877986">lib</span><span class="op" id="4877989">)</span>&nbsp;<span class="builtintype" id="4877991">uint32</span>&nbsp;<span class="op" id="4877998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878001">ret</span>&nbsp;<span class="op" id="4878005">:=</span>&nbsp;<span class="ident" id="4878008">p</span><span class="op" id="4878009">.</span><span class="ident" id="4878010">Package</span><span class="op" id="4878017">.</span><span class="ident" id="4878018">Require</span><span class="op" id="4878025">(</span><span class="ident" id="4878026">req</span><span class="op" id="4878029">.</span><span class="ident" id="4878030">Package</span><span class="op" id="4878037">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878040">_</span><span class="op" id="4878041">,</span>&nbsp;<span class="ident" id="4878043">found</span>&nbsp;<span class="op" id="4878049">:=</span>&nbsp;<span class="ident" id="4878052">p</span><span class="op" id="4878053">.</span><span class="ident" id="4878054">requires</span><span class="op" id="4878062">[</span><span class="ident" id="4878063">ret</span><span class="op" id="4878066">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878069">if</span>&nbsp;<span class="op" id="4878072">!</span><span class="ident" id="4878073">found</span>&nbsp;<span class="op" id="4878079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878083">p</span><span class="op" id="4878084">.</span><span class="ident" id="4878085">requires</span><span class="op" id="4878093">[</span><span class="ident" id="4878094">ret</span><span class="op" id="4878097">]</span>&nbsp;<span class="op" id="4878099">=</span>&nbsp;<span class="ident" id="4878101">req</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878110">return</span>&nbsp;<span class="ident" id="4878117">ret</span><br>
<span class="lineno"></span><span class="op" id="4878121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4878124">//&nbsp;PkgIndex&nbsp;returns&nbsp;the&nbsp;package&nbsp;import&nbsp;index,&nbsp;consistent&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4878186">//&nbsp;the&nbsp;underlying&nbsp;link8.Package.</span><br>
<span class="lineno">45</span><span class="keyword" id="4878219">func</span>&nbsp;<span class="op" id="4878224">(</span><span class="ident" id="4878225">p</span>&nbsp;<span class="op" id="4878227">*</span><span class="ident" id="4878228">lib</span><span class="op" id="4878231">)</span>&nbsp;<span class="ident" id="4878233">LibIndex</span><span class="op" id="4878241">(</span><span class="ident" id="4878242">path</span>&nbsp;<span class="builtintype" id="4878247">string</span><span class="op" id="4878253">)</span>&nbsp;<span class="op" id="4878255">(</span><span class="op" id="4878256">*</span><span class="ident" id="4878257">lib</span><span class="op" id="4878260">,</span>&nbsp;<span class="builtintype" id="4878262">uint32</span><span class="op" id="4878268">)</span>&nbsp;<span class="op" id="4878270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878273">pkg</span><span class="op" id="4878276">,</span>&nbsp;<span class="ident" id="4878278">index</span>&nbsp;<span class="op" id="4878284">:=</span>&nbsp;<span class="ident" id="4878287">p</span><span class="op" id="4878288">.</span><span class="ident" id="4878289">Package</span><span class="op" id="4878296">.</span><span class="ident" id="4878297">PkgIndex</span><span class="op" id="4878305">(</span><span class="ident" id="4878306">path</span><span class="op" id="4878310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878313">if</span>&nbsp;<span class="ident" id="4878316">pkg</span>&nbsp;<span class="op" id="4878320">==</span>&nbsp;<span class="ident" id="4878323">nil</span>&nbsp;<span class="op" id="4878327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878331">return</span>&nbsp;<span class="ident" id="4878338">nil</span><span class="op" id="4878341">,</span>&nbsp;<span class="num" id="4878343">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878346">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878350">ret</span><span class="op" id="4878353">,</span>&nbsp;<span class="ident" id="4878355">found</span>&nbsp;<span class="op" id="4878361">:=</span>&nbsp;<span class="ident" id="4878364">p</span><span class="op" id="4878365">.</span><span class="ident" id="4878366">requires</span><span class="op" id="4878374">[</span><span class="ident" id="4878375">index</span><span class="op" id="4878380">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878383">if</span>&nbsp;<span class="op" id="4878386">!</span><span class="ident" id="4878387">found</span>&nbsp;<span class="op" id="4878393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4878397">panic</span><span class="op" id="4878402">(</span><span class="string" id="4878403">&#34;bug&#34;</span><span class="op" id="4878408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878411">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878415">return</span>&nbsp;<span class="ident" id="4878422">ret</span><span class="op" id="4878425">,</span>&nbsp;<span class="ident" id="4878427">index</span><br>
<span class="lineno"></span><span class="op" id="4878433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4878436">//&nbsp;Declare&nbsp;declares&nbsp;a&nbsp;symbol&nbsp;inside&nbsp;the&nbsp;package.&nbsp;&nbsp;If&nbsp;the&nbsp;symbol&nbsp;is&nbsp;a&nbsp;function</span><br>
<span class="lineno">60</span><span class="comment" id="4878514">//&nbsp;or&nbsp;variable,&nbsp;it&nbsp;is&nbsp;also&nbsp;declared&nbsp;as&nbsp;an&nbsp;object&nbsp;file&nbsp;symbol&nbsp;in&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="4878593">//&nbsp;link8.Package,&nbsp;and&nbsp;it&nbsp;returns&nbsp;the&nbsp;index.&nbsp;&nbsp;If&nbsp;the&nbsp;symbol&nbsp;is&nbsp;a&nbsp;constant,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4878670">//&nbsp;returns&nbsp;0&nbsp;after&nbsp;the&nbsp;declaration.&nbsp;Other&nbsp;types&nbsp;will&nbsp;panic.&nbsp;Redeclaration&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="4878749">//&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="4878759">func</span>&nbsp;<span class="op" id="4878764">(</span><span class="ident" id="4878765">p</span>&nbsp;<span class="op" id="4878767">*</span><span class="ident" id="4878768">lib</span><span class="op" id="4878771">)</span>&nbsp;<span class="ident" id="4878773">Declare</span><span class="op" id="4878780">(</span><span class="ident" id="4878781">s</span>&nbsp;<span class="op" id="4878783">*</span><span class="ident" id="4878784">symbol</span><span class="op" id="4878790">)</span>&nbsp;<span class="builtintype" id="4878792">uint32</span>&nbsp;<span class="op" id="4878799">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878802">_</span><span class="op" id="4878803">,</span>&nbsp;<span class="ident" id="4878805">found</span>&nbsp;<span class="op" id="4878811">:=</span>&nbsp;<span class="ident" id="4878814">p</span><span class="op" id="4878815">.</span><span class="ident" id="4878816">symbols</span><span class="op" id="4878823">[</span><span class="ident" id="4878824">s</span><span class="op" id="4878825">.</span><span class="ident" id="4878826">Name</span><span class="op" id="4878830">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878833">if</span>&nbsp;<span class="ident" id="4878836">found</span>&nbsp;<span class="op" id="4878842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4878846">panic</span><span class="op" id="4878851">(</span><span class="string" id="4878852">&#34;redeclare&#34;</span><span class="op" id="4878863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878869">p</span><span class="op" id="4878870">.</span><span class="ident" id="4878871">symbols</span><span class="op" id="4878878">[</span><span class="ident" id="4878879">s</span><span class="op" id="4878880">.</span><span class="ident" id="4878881">Name</span><span class="op" id="4878885">]</span>&nbsp;<span class="op" id="4878887">=</span>&nbsp;<span class="ident" id="4878889">s</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878893">switch</span>&nbsp;<span class="ident" id="4878900">s</span><span class="op" id="4878901">.</span><span class="ident" id="4878902">Type</span>&nbsp;<span class="op" id="4878907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878910">case</span>&nbsp;<span class="ident" id="4878915">SymConst</span><span class="op" id="4878923">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878927">return</span>&nbsp;<span class="num" id="4878934">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878937">case</span>&nbsp;<span class="ident" id="4878942">SymFunc</span><span class="op" id="4878949">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878953">return</span>&nbsp;<span class="ident" id="4878960">p</span><span class="op" id="4878961">.</span><span class="ident" id="4878962">Package</span><span class="op" id="4878969">.</span><span class="ident" id="4878970">Declare</span><span class="op" id="4878977">(</span><span class="op" id="4878978">&amp;</span><span class="ident" id="4878979">link8</span><span class="op" id="4878984">.</span><span class="ident" id="4878985">Symbol</span><span class="op" id="4878991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878996">Name</span><span class="op" id="4879000">:</span>&nbsp;<span class="ident" id="4879002">s</span><span class="op" id="4879003">.</span><span class="ident" id="4879004">Name</span><span class="op" id="4879008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879013">Type</span><span class="op" id="4879017">:</span>&nbsp;<span class="ident" id="4879019">link8</span><span class="op" id="4879024">.</span><span class="ident" id="4879025">SymFunc</span><span class="op" id="4879032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879036">}</span><span class="op" id="4879037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879040">case</span>&nbsp;<span class="ident" id="4879045">SymVar</span><span class="op" id="4879051">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879055">return</span>&nbsp;<span class="ident" id="4879062">p</span><span class="op" id="4879063">.</span><span class="ident" id="4879064">Package</span><span class="op" id="4879071">.</span><span class="ident" id="4879072">Declare</span><span class="op" id="4879079">(</span><span class="op" id="4879080">&amp;</span><span class="ident" id="4879081">link8</span><span class="op" id="4879086">.</span><span class="ident" id="4879087">Symbol</span><span class="op" id="4879093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879098">Name</span><span class="op" id="4879102">:</span>&nbsp;<span class="ident" id="4879104">s</span><span class="op" id="4879105">.</span><span class="ident" id="4879106">Name</span><span class="op" id="4879110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879115">Type</span><span class="op" id="4879119">:</span>&nbsp;<span class="ident" id="4879121">link8</span><span class="op" id="4879126">.</span><span class="ident" id="4879127">SymVar</span><span class="op" id="4879133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879137">}</span><span class="op" id="4879138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879141">default</span><span class="op" id="4879148">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4879152">panic</span><span class="op" id="4879157">(</span><span class="string" id="4879158">&#34;declare&nbsp;with&nbsp;invalid&nbsp;sym&nbsp;type&#34;</span><span class="op" id="4879189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879192">}</span><br>
<span class="lineno"></span><span class="op" id="4879194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4879197">//&nbsp;Query&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;declared&nbsp;by&nbsp;name&nbsp;and&nbsp;its&nbsp;symbol&nbsp;index</span><br>
<span class="lineno">90</span><span class="comment" id="4879263">//&nbsp;if&nbsp;the&nbsp;symbol&nbsp;is&nbsp;a&nbsp;function&nbsp;or&nbsp;variable.&nbsp;It&nbsp;returns&nbsp;nil,&nbsp;0&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="4879330">//&nbsp;the&nbsp;symbol&nbsp;of&nbsp;name&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="4879366">func</span>&nbsp;<span class="op" id="4879371">(</span><span class="ident" id="4879372">p</span>&nbsp;<span class="op" id="4879374">*</span><span class="ident" id="4879375">lib</span><span class="op" id="4879378">)</span>&nbsp;<span class="ident" id="4879380">Query</span><span class="op" id="4879385">(</span><span class="ident" id="4879386">name</span>&nbsp;<span class="builtintype" id="4879391">string</span><span class="op" id="4879397">)</span>&nbsp;<span class="op" id="4879399">(</span><span class="op" id="4879400">*</span><span class="ident" id="4879401">symbol</span><span class="op" id="4879407">,</span>&nbsp;<span class="builtintype" id="4879409">uint32</span><span class="op" id="4879415">)</span>&nbsp;<span class="op" id="4879417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879420">ret</span><span class="op" id="4879423">,</span>&nbsp;<span class="ident" id="4879425">found</span>&nbsp;<span class="op" id="4879431">:=</span>&nbsp;<span class="ident" id="4879434">p</span><span class="op" id="4879435">.</span><span class="ident" id="4879436">symbols</span><span class="op" id="4879443">[</span><span class="ident" id="4879444">name</span><span class="op" id="4879448">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879451">if</span>&nbsp;<span class="op" id="4879454">!</span><span class="ident" id="4879455">found</span>&nbsp;<span class="op" id="4879461">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879465">return</span>&nbsp;<span class="ident" id="4879472">nil</span><span class="op" id="4879475">,</span>&nbsp;<span class="num" id="4879477">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879484">switch</span>&nbsp;<span class="ident" id="4879491">ret</span><span class="op" id="4879494">.</span><span class="ident" id="4879495">Type</span>&nbsp;<span class="op" id="4879500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879503">case</span>&nbsp;<span class="ident" id="4879508">SymConst</span><span class="op" id="4879516">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879520">return</span>&nbsp;<span class="ident" id="4879527">ret</span><span class="op" id="4879530">,</span>&nbsp;<span class="num" id="4879532">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879535">case</span>&nbsp;<span class="ident" id="4879540">SymFunc</span><span class="op" id="4879547">,</span>&nbsp;<span class="ident" id="4879549">SymVar</span><span class="op" id="4879555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879559">s</span><span class="op" id="4879560">,</span>&nbsp;<span class="ident" id="4879562">index</span>&nbsp;<span class="op" id="4879568">:=</span>&nbsp;<span class="ident" id="4879571">p</span><span class="op" id="4879572">.</span><span class="ident" id="4879573">Package</span><span class="op" id="4879580">.</span><span class="ident" id="4879581">Query</span><span class="op" id="4879586">(</span><span class="ident" id="4879587">name</span><span class="op" id="4879591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879595">if</span>&nbsp;<span class="ident" id="4879598">s</span>&nbsp;<span class="op" id="4879600">==</span>&nbsp;<span class="ident" id="4879603">nil</span>&nbsp;<span class="op" id="4879607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4879612">panic</span><span class="op" id="4879617">(</span><span class="string" id="4879618">&#34;symbol&nbsp;missing&#34;</span><span class="op" id="4879634">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879642">return</span>&nbsp;<span class="ident" id="4879649">ret</span><span class="op" id="4879652">,</span>&nbsp;<span class="ident" id="4879654">index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879661">default</span><span class="op" id="4879668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4879672">panic</span><span class="op" id="4879677">(</span><span class="string" id="4879678">&#34;bug&#34;</span><span class="op" id="4879683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879686">}</span><br>
<span class="lineno">110</span><span class="op" id="4879688">}</span>
</div>
</body>
</html>
