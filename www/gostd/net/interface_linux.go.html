<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html" class="current">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3265461">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3265517">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3265571">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3265622">package</span>&nbsp;<span class="ident" id="3265630">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3265635">import</span>&nbsp;<span class="op" id="3265642">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3265645">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3265651">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3265662">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3265671">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3265674">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3265740">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="3265809">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3265823">func</span>&nbsp;<span class="ident" id="3265828">interfaceTable</span><span class="op" id="3265842">(</span><span class="ident" id="3265843">ifindex</span>&nbsp;<span class="builtintype" id="3265851">int</span><span class="op" id="3265854">)</span>&nbsp;<span class="op" id="3265856">(</span><span class="op" id="3265857">[</span><span class="op" id="3265858">]</span><span class="ident" id="3265859">Interface</span><span class="op" id="3265868">,</span>&nbsp;<span class="builtintype" id="3265870">error</span><span class="op" id="3265875">)</span>&nbsp;<span class="op" id="3265877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3265880">tab</span><span class="op" id="3265883">,</span>&nbsp;<span class="ident" id="3265885">err</span>&nbsp;<span class="op" id="3265889">:=</span>&nbsp;<span class="ident" id="3265892">syscall</span><span class="op" id="3265899">.</span><span class="ident" id="3265900">NetlinkRIB</span><span class="op" id="3265910">(</span><span class="ident" id="3265911">syscall</span><span class="op" id="3265918">.</span><span class="ident" id="3265919">RTM_GETLINK</span><span class="op" id="3265930">,</span>&nbsp;<span class="ident" id="3265932">syscall</span><span class="op" id="3265939">.</span><span class="ident" id="3265940">AF_UNSPEC</span><span class="op" id="3265949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3265952">if</span>&nbsp;<span class="ident" id="3265955">err</span>&nbsp;<span class="op" id="3265959">!=</span>&nbsp;<span class="builtintype" id="3265962">nil</span>&nbsp;<span class="op" id="3265966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3265970">return</span>&nbsp;<span class="builtintype" id="3265977">nil</span><span class="op" id="3265980">,</span>&nbsp;<span class="ident" id="3265982">os</span><span class="op" id="3265984">.</span><span class="ident" id="3265985">NewSyscallError</span><span class="op" id="3266000">(</span><span class="string" id="3266001">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3266014">,</span>&nbsp;<span class="ident" id="3266016">err</span><span class="op" id="3266019">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3266022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3266025">msgs</span><span class="op" id="3266029">,</span>&nbsp;<span class="ident" id="3266031">err</span>&nbsp;<span class="op" id="3266035">:=</span>&nbsp;<span class="ident" id="3266038">syscall</span><span class="op" id="3266045">.</span><span class="ident" id="3266046">ParseNetlinkMessage</span><span class="op" id="3266065">(</span><span class="ident" id="3266066">tab</span><span class="op" id="3266069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266072">if</span>&nbsp;<span class="ident" id="3266075">err</span>&nbsp;<span class="op" id="3266079">!=</span>&nbsp;<span class="builtintype" id="3266082">nil</span>&nbsp;<span class="op" id="3266086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266090">return</span>&nbsp;<span class="builtintype" id="3266097">nil</span><span class="op" id="3266100">,</span>&nbsp;<span class="ident" id="3266102">os</span><span class="op" id="3266104">.</span><span class="ident" id="3266105">NewSyscallError</span><span class="op" id="3266120">(</span><span class="string" id="3266121">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3266138">,</span>&nbsp;<span class="ident" id="3266140">err</span><span class="op" id="3266143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3266146">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266149">var</span>&nbsp;<span class="ident" id="3266153">ift</span>&nbsp;<span class="op" id="3266157">[</span><span class="op" id="3266158">]</span><span class="ident" id="3266159">Interface</span><br>
<span class="lineno"></span><span class="ident" id="3266169">loop</span><span class="op" id="3266173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266176">for</span>&nbsp;<span class="ident" id="3266180">_</span><span class="op" id="3266181">,</span>&nbsp;<span class="ident" id="3266183">m</span>&nbsp;<span class="op" id="3266185">:=</span>&nbsp;<span class="keyword" id="3266188">range</span>&nbsp;<span class="ident" id="3266194">msgs</span>&nbsp;<span class="op" id="3266199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266203">switch</span>&nbsp;<span class="ident" id="3266210">m</span><span class="op" id="3266211">.</span><span class="ident" id="3266212">Header</span><span class="op" id="3266218">.</span><span class="ident" id="3266219">Type</span>&nbsp;<span class="op" id="3266224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266228">case</span>&nbsp;<span class="ident" id="3266233">syscall</span><span class="op" id="3266240">.</span><span class="ident" id="3266241">NLMSG_DONE</span><span class="op" id="3266251">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266256">break</span>&nbsp;<span class="ident" id="3266262">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266269">case</span>&nbsp;<span class="ident" id="3266274">syscall</span><span class="op" id="3266281">.</span><span class="ident" id="3266282">RTM_NEWLINK</span><span class="op" id="3266293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3266298">ifim</span>&nbsp;<span class="op" id="3266303">:=</span>&nbsp;<span class="op" id="3266306">(</span><span class="op" id="3266307">*</span><span class="ident" id="3266308">syscall</span><span class="op" id="3266315">.</span><span class="ident" id="3266316">IfInfomsg</span><span class="op" id="3266325">)</span><span class="op" id="3266326">(</span><span class="ident" id="3266327">unsafe</span><span class="op" id="3266333">.</span><span class="ident" id="3266334">Pointer</span><span class="op" id="3266341">(</span><span class="op" id="3266342">&amp;</span><span class="ident" id="3266343">m</span><span class="op" id="3266344">.</span><span class="ident" id="3266345">Data</span><span class="op" id="3266349">[</span><span class="num" id="3266350">0</span><span class="op" id="3266351">]</span><span class="op" id="3266352">)</span><span class="op" id="3266353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266358">if</span>&nbsp;<span class="ident" id="3266361">ifindex</span>&nbsp;<span class="op" id="3266369">==</span>&nbsp;<span class="num" id="3266372">0</span>&nbsp;<span class="op" id="3266374">||</span>&nbsp;<span class="ident" id="3266377">ifindex</span>&nbsp;<span class="op" id="3266385">==</span>&nbsp;<span class="builtintype" id="3266388">int</span><span class="op" id="3266391">(</span><span class="ident" id="3266392">ifim</span><span class="op" id="3266396">.</span><span class="ident" id="3266397">Index</span><span class="op" id="3266402">)</span>&nbsp;<span class="op" id="3266404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3266410">attrs</span><span class="op" id="3266415">,</span>&nbsp;<span class="ident" id="3266417">err</span>&nbsp;<span class="op" id="3266421">:=</span>&nbsp;<span class="ident" id="3266424">syscall</span><span class="op" id="3266431">.</span><span class="ident" id="3266432">ParseNetlinkRouteAttr</span><span class="op" id="3266453">(</span><span class="op" id="3266454">&amp;</span><span class="ident" id="3266455">m</span><span class="op" id="3266456">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266462">if</span>&nbsp;<span class="ident" id="3266465">err</span>&nbsp;<span class="op" id="3266469">!=</span>&nbsp;<span class="builtintype" id="3266472">nil</span>&nbsp;<span class="op" id="3266476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266483">return</span>&nbsp;<span class="builtintype" id="3266490">nil</span><span class="op" id="3266493">,</span>&nbsp;<span class="ident" id="3266495">os</span><span class="op" id="3266497">.</span><span class="ident" id="3266498">NewSyscallError</span><span class="op" id="3266513">(</span><span class="string" id="3266514">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3266533">,</span>&nbsp;<span class="ident" id="3266535">err</span><span class="op" id="3266538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3266544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3266550">ift</span>&nbsp;<span class="op" id="3266554">=</span>&nbsp;<span class="builtinfunc" id="3266556">append</span><span class="op" id="3266562">(</span><span class="ident" id="3266563">ift</span><span class="op" id="3266566">,</span>&nbsp;<span class="op" id="3266568">*</span><span class="ident" id="3266569">newLink</span><span class="op" id="3266576">(</span><span class="ident" id="3266577">ifim</span><span class="op" id="3266581">,</span>&nbsp;<span class="ident" id="3266583">attrs</span><span class="op" id="3266588">)</span><span class="op" id="3266589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266595">if</span>&nbsp;<span class="ident" id="3266598">ifindex</span>&nbsp;<span class="op" id="3266606">==</span>&nbsp;<span class="builtintype" id="3266609">int</span><span class="op" id="3266612">(</span><span class="ident" id="3266613">ifim</span><span class="op" id="3266617">.</span><span class="ident" id="3266618">Index</span><span class="op" id="3266623">)</span>&nbsp;<span class="op" id="3266625">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266632">break</span>&nbsp;<span class="ident" id="3266638">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3266647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3266652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3266656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3266659">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3266662">return</span>&nbsp;<span class="ident" id="3266669">ift</span><span class="op" id="3266672">,</span>&nbsp;<span class="builtintype" id="3266674">nil</span><br>
<span class="lineno"></span><span class="op" id="3266678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3266681">const</span>&nbsp;<span class="op" id="3266687">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266690">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3266714">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3266776">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="3266799">=</span>&nbsp;<span class="num" id="3266801">768</span>&nbsp;<span class="comment" id="3266805">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3266834">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="3266857">=</span>&nbsp;<span class="num" id="3266859">769</span>&nbsp;<span class="comment" id="3266863">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3266892">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="3266915">=</span>&nbsp;<span class="num" id="3266917">776</span>&nbsp;<span class="comment" id="3266921">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3266950">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="3266973">=</span>&nbsp;<span class="num" id="3266975">778</span>&nbsp;<span class="comment" id="3266979">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3267016">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="3267039">=</span>&nbsp;<span class="num" id="3267041">823</span>&nbsp;<span class="comment" id="3267045">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="3267081">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3267084">func</span>&nbsp;<span class="ident" id="3267089">newLink</span><span class="op" id="3267096">(</span><span class="ident" id="3267097">ifim</span>&nbsp;<span class="op" id="3267102">*</span><span class="ident" id="3267103">syscall</span><span class="op" id="3267110">.</span><span class="ident" id="3267111">IfInfomsg</span><span class="op" id="3267120">,</span>&nbsp;<span class="ident" id="3267122">attrs</span>&nbsp;<span class="op" id="3267128">[</span><span class="op" id="3267129">]</span><span class="ident" id="3267130">syscall</span><span class="op" id="3267137">.</span><span class="ident" id="3267138">NetlinkRouteAttr</span><span class="op" id="3267154">)</span>&nbsp;<span class="op" id="3267156">*</span><span class="ident" id="3267157">Interface</span>&nbsp;<span class="op" id="3267167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3267170">ifi</span>&nbsp;<span class="op" id="3267174">:=</span>&nbsp;<span class="op" id="3267177">&amp;</span><span class="ident" id="3267178">Interface</span><span class="op" id="3267187">{</span><span class="ident" id="3267188">Index</span><span class="op" id="3267193">:</span>&nbsp;<span class="builtintype" id="3267195">int</span><span class="op" id="3267198">(</span><span class="ident" id="3267199">ifim</span><span class="op" id="3267203">.</span><span class="ident" id="3267204">Index</span><span class="op" id="3267209">)</span><span class="op" id="3267210">,</span>&nbsp;<span class="ident" id="3267212">Flags</span><span class="op" id="3267217">:</span>&nbsp;<span class="ident" id="3267219">linkFlags</span><span class="op" id="3267228">(</span><span class="ident" id="3267229">ifim</span><span class="op" id="3267233">.</span><span class="ident" id="3267234">Flags</span><span class="op" id="3267239">)</span><span class="op" id="3267240">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267243">for</span>&nbsp;<span class="ident" id="3267247">_</span><span class="op" id="3267248">,</span>&nbsp;<span class="ident" id="3267250">a</span>&nbsp;<span class="op" id="3267252">:=</span>&nbsp;<span class="keyword" id="3267255">range</span>&nbsp;<span class="ident" id="3267261">attrs</span>&nbsp;<span class="op" id="3267267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267271">switch</span>&nbsp;<span class="ident" id="3267278">a</span><span class="op" id="3267279">.</span><span class="ident" id="3267280">Attr</span><span class="op" id="3267284">.</span><span class="ident" id="3267285">Type</span>&nbsp;<span class="op" id="3267290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267294">case</span>&nbsp;<span class="ident" id="3267299">syscall</span><span class="op" id="3267306">.</span><span class="ident" id="3267307">IFLA_ADDRESS</span><span class="op" id="3267319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3267324">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3267373">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3267420">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267444">switch</span>&nbsp;<span class="builtinfunc" id="3267451">len</span><span class="op" id="3267454">(</span><span class="ident" id="3267455">a</span><span class="op" id="3267456">.</span><span class="ident" id="3267457">Value</span><span class="op" id="3267462">)</span>&nbsp;<span class="op" id="3267464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267469">case</span>&nbsp;<span class="ident" id="3267474">IPv4len</span><span class="op" id="3267481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267487">switch</span>&nbsp;<span class="ident" id="3267494">ifim</span><span class="op" id="3267498">.</span><span class="ident" id="3267499">Type</span>&nbsp;<span class="op" id="3267504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267510">case</span>&nbsp;<span class="ident" id="3267515">sysARPHardwareIPv4IPv4</span><span class="op" id="3267537">,</span>&nbsp;<span class="ident" id="3267539">sysARPHardwareGREIPv4</span><span class="op" id="3267560">,</span>&nbsp;<span class="ident" id="3267562">sysARPHardwareIPv6IPv4</span><span class="op" id="3267584">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267591">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3267604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267609">case</span>&nbsp;<span class="ident" id="3267614">IPv6len</span><span class="op" id="3267621">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267627">switch</span>&nbsp;<span class="ident" id="3267634">ifim</span><span class="op" id="3267638">.</span><span class="ident" id="3267639">Type</span>&nbsp;<span class="op" id="3267644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267650">case</span>&nbsp;<span class="ident" id="3267655">sysARPHardwareIPv6IPv6</span><span class="op" id="3267677">,</span>&nbsp;<span class="ident" id="3267679">sysARPHardwareGREIPv6</span><span class="op" id="3267700">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267707">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3267720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3267725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267730">var</span>&nbsp;<span class="ident" id="3267734">nonzero</span>&nbsp;<span class="builtintype" id="3267742">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267750">for</span>&nbsp;<span class="ident" id="3267754">_</span><span class="op" id="3267755">,</span>&nbsp;<span class="ident" id="3267757">b</span>&nbsp;<span class="op" id="3267759">:=</span>&nbsp;<span class="keyword" id="3267762">range</span>&nbsp;<span class="ident" id="3267768">a</span><span class="op" id="3267769">.</span><span class="ident" id="3267770">Value</span>&nbsp;<span class="op" id="3267776">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267782">if</span>&nbsp;<span class="ident" id="3267785">b</span>&nbsp;<span class="op" id="3267787">!=</span>&nbsp;<span class="num" id="3267790">0</span>&nbsp;<span class="op" id="3267792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3267799">nonzero</span>&nbsp;<span class="op" id="3267807">=</span>&nbsp;<span class="builtintype" id="3267809">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267819">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3267829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3267834">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267839">if</span>&nbsp;<span class="ident" id="3267842">nonzero</span>&nbsp;<span class="op" id="3267850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3267856">ifi</span><span class="op" id="3267859">.</span><span class="ident" id="3267860">HardwareAddr</span>&nbsp;<span class="op" id="3267873">=</span>&nbsp;<span class="ident" id="3267875">a</span><span class="op" id="3267876">.</span><span class="ident" id="3267877">Value</span><span class="op" id="3267882">[</span><span class="op" id="3267883">:</span><span class="op" id="3267884">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3267889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267893">case</span>&nbsp;<span class="ident" id="3267898">syscall</span><span class="op" id="3267905">.</span><span class="ident" id="3267906">IFLA_IFNAME</span><span class="op" id="3267917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3267922">ifi</span><span class="op" id="3267925">.</span><span class="ident" id="3267926">Name</span>&nbsp;<span class="op" id="3267931">=</span>&nbsp;<span class="builtintype" id="3267933">string</span><span class="op" id="3267939">(</span><span class="ident" id="3267940">a</span><span class="op" id="3267941">.</span><span class="ident" id="3267942">Value</span><span class="op" id="3267947">[</span><span class="op" id="3267948">:</span><span class="builtinfunc" id="3267949">len</span><span class="op" id="3267952">(</span><span class="ident" id="3267953">a</span><span class="op" id="3267954">.</span><span class="ident" id="3267955">Value</span><span class="op" id="3267960">)</span><span class="op" id="3267961">-</span><span class="num" id="3267962">1</span><span class="op" id="3267963">]</span><span class="op" id="3267964">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3267968">case</span>&nbsp;<span class="ident" id="3267973">syscall</span><span class="op" id="3267980">.</span><span class="ident" id="3267981">IFLA_MTU</span><span class="op" id="3267989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3267994">ifi</span><span class="op" id="3267997">.</span><span class="ident" id="3267998">MTU</span>&nbsp;<span class="op" id="3268002">=</span>&nbsp;<span class="builtintype" id="3268004">int</span><span class="op" id="3268007">(</span><span class="op" id="3268008">*</span><span class="op" id="3268009">(</span><span class="op" id="3268010">*</span><span class="builtintype" id="3268011">uint32</span><span class="op" id="3268017">)</span><span class="op" id="3268018">(</span><span class="ident" id="3268019">unsafe</span><span class="op" id="3268025">.</span><span class="ident" id="3268026">Pointer</span><span class="op" id="3268033">(</span><span class="op" id="3268034">&amp;</span><span class="ident" id="3268035">a</span><span class="op" id="3268036">.</span><span class="ident" id="3268037">Value</span><span class="op" id="3268042">[</span><span class="op" id="3268043">:</span><span class="num" id="3268044">4</span><span class="op" id="3268045">]</span><span class="op" id="3268046">[</span><span class="num" id="3268047">0</span><span class="op" id="3268048">]</span><span class="op" id="3268049">)</span><span class="op" id="3268050">)</span><span class="op" id="3268051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3268055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3268058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268061">return</span>&nbsp;<span class="ident" id="3268068">ifi</span><br>
<span class="lineno">95</span><span class="op" id="3268072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3268075">func</span>&nbsp;<span class="ident" id="3268080">linkFlags</span><span class="op" id="3268089">(</span><span class="ident" id="3268090">rawFlags</span>&nbsp;<span class="builtintype" id="3268099">uint32</span><span class="op" id="3268105">)</span>&nbsp;<span class="ident" id="3268107">Flags</span>&nbsp;<span class="op" id="3268113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268116">var</span>&nbsp;<span class="ident" id="3268120">f</span>&nbsp;<span class="ident" id="3268122">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268129">if</span>&nbsp;<span class="ident" id="3268132">rawFlags</span><span class="op" id="3268140">&amp;</span><span class="ident" id="3268141">syscall</span><span class="op" id="3268148">.</span><span class="ident" id="3268149">IFF_UP</span>&nbsp;<span class="op" id="3268156">!=</span>&nbsp;<span class="num" id="3268159">0</span>&nbsp;<span class="op" id="3268161">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3268165">f</span>&nbsp;<span class="op" id="3268167">|=</span>&nbsp;<span class="ident" id="3268170">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3268178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268181">if</span>&nbsp;<span class="ident" id="3268184">rawFlags</span><span class="op" id="3268192">&amp;</span><span class="ident" id="3268193">syscall</span><span class="op" id="3268200">.</span><span class="ident" id="3268201">IFF_BROADCAST</span>&nbsp;<span class="op" id="3268215">!=</span>&nbsp;<span class="num" id="3268218">0</span>&nbsp;<span class="op" id="3268220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3268224">f</span>&nbsp;<span class="op" id="3268226">|=</span>&nbsp;<span class="ident" id="3268229">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3268244">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268247">if</span>&nbsp;<span class="ident" id="3268250">rawFlags</span><span class="op" id="3268258">&amp;</span><span class="ident" id="3268259">syscall</span><span class="op" id="3268266">.</span><span class="ident" id="3268267">IFF_LOOPBACK</span>&nbsp;<span class="op" id="3268280">!=</span>&nbsp;<span class="num" id="3268283">0</span>&nbsp;<span class="op" id="3268285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3268289">f</span>&nbsp;<span class="op" id="3268291">|=</span>&nbsp;<span class="ident" id="3268294">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3268308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268311">if</span>&nbsp;<span class="ident" id="3268314">rawFlags</span><span class="op" id="3268322">&amp;</span><span class="ident" id="3268323">syscall</span><span class="op" id="3268330">.</span><span class="ident" id="3268331">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="3268347">!=</span>&nbsp;<span class="num" id="3268350">0</span>&nbsp;<span class="op" id="3268352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3268356">f</span>&nbsp;<span class="op" id="3268358">|=</span>&nbsp;<span class="ident" id="3268361">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3268379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268382">if</span>&nbsp;<span class="ident" id="3268385">rawFlags</span><span class="op" id="3268393">&amp;</span><span class="ident" id="3268394">syscall</span><span class="op" id="3268401">.</span><span class="ident" id="3268402">IFF_MULTICAST</span>&nbsp;<span class="op" id="3268416">!=</span>&nbsp;<span class="num" id="3268419">0</span>&nbsp;<span class="op" id="3268421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3268425">f</span>&nbsp;<span class="op" id="3268427">|=</span>&nbsp;<span class="ident" id="3268430">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3268445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268448">return</span>&nbsp;<span class="ident" id="3268455">f</span><br>
<span class="lineno">115</span><span class="op" id="3268457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3268460">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3268527">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="3268597">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="3268611">func</span>&nbsp;<span class="ident" id="3268616">interfaceAddrTable</span><span class="op" id="3268634">(</span><span class="ident" id="3268635">ifi</span>&nbsp;<span class="op" id="3268639">*</span><span class="ident" id="3268640">Interface</span><span class="op" id="3268649">)</span>&nbsp;<span class="op" id="3268651">(</span><span class="op" id="3268652">[</span><span class="op" id="3268653">]</span><span class="ident" id="3268654">Addr</span><span class="op" id="3268658">,</span>&nbsp;<span class="builtintype" id="3268660">error</span><span class="op" id="3268665">)</span>&nbsp;<span class="op" id="3268667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3268670">tab</span><span class="op" id="3268673">,</span>&nbsp;<span class="ident" id="3268675">err</span>&nbsp;<span class="op" id="3268679">:=</span>&nbsp;<span class="ident" id="3268682">syscall</span><span class="op" id="3268689">.</span><span class="ident" id="3268690">NetlinkRIB</span><span class="op" id="3268700">(</span><span class="ident" id="3268701">syscall</span><span class="op" id="3268708">.</span><span class="ident" id="3268709">RTM_GETADDR</span><span class="op" id="3268720">,</span>&nbsp;<span class="ident" id="3268722">syscall</span><span class="op" id="3268729">.</span><span class="ident" id="3268730">AF_UNSPEC</span><span class="op" id="3268739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268742">if</span>&nbsp;<span class="ident" id="3268745">err</span>&nbsp;<span class="op" id="3268749">!=</span>&nbsp;<span class="builtintype" id="3268752">nil</span>&nbsp;<span class="op" id="3268756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268760">return</span>&nbsp;<span class="builtintype" id="3268767">nil</span><span class="op" id="3268770">,</span>&nbsp;<span class="ident" id="3268772">os</span><span class="op" id="3268774">.</span><span class="ident" id="3268775">NewSyscallError</span><span class="op" id="3268790">(</span><span class="string" id="3268791">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3268804">,</span>&nbsp;<span class="ident" id="3268806">err</span><span class="op" id="3268809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3268812">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3268815">msgs</span><span class="op" id="3268819">,</span>&nbsp;<span class="ident" id="3268821">err</span>&nbsp;<span class="op" id="3268825">:=</span>&nbsp;<span class="ident" id="3268828">syscall</span><span class="op" id="3268835">.</span><span class="ident" id="3268836">ParseNetlinkMessage</span><span class="op" id="3268855">(</span><span class="ident" id="3268856">tab</span><span class="op" id="3268859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268862">if</span>&nbsp;<span class="ident" id="3268865">err</span>&nbsp;<span class="op" id="3268869">!=</span>&nbsp;<span class="builtintype" id="3268872">nil</span>&nbsp;<span class="op" id="3268876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268880">return</span>&nbsp;<span class="builtintype" id="3268887">nil</span><span class="op" id="3268890">,</span>&nbsp;<span class="ident" id="3268892">os</span><span class="op" id="3268894">.</span><span class="ident" id="3268895">NewSyscallError</span><span class="op" id="3268910">(</span><span class="string" id="3268911">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3268928">,</span>&nbsp;<span class="ident" id="3268930">err</span><span class="op" id="3268933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3268936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268939">var</span>&nbsp;<span class="ident" id="3268943">ift</span>&nbsp;<span class="op" id="3268947">[</span><span class="op" id="3268948">]</span><span class="ident" id="3268949">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268960">if</span>&nbsp;<span class="ident" id="3268963">ifi</span>&nbsp;<span class="op" id="3268967">==</span>&nbsp;<span class="builtintype" id="3268970">nil</span>&nbsp;<span class="op" id="3268974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3268978">var</span>&nbsp;<span class="ident" id="3268982">err</span>&nbsp;<span class="builtintype" id="3268986">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3268994">ift</span><span class="op" id="3268997">,</span>&nbsp;<span class="ident" id="3268999">err</span>&nbsp;<span class="op" id="3269003">=</span>&nbsp;<span class="ident" id="3269005">interfaceTable</span><span class="op" id="3269019">(</span><span class="num" id="3269020">0</span><span class="op" id="3269021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269025">if</span>&nbsp;<span class="ident" id="3269028">err</span>&nbsp;<span class="op" id="3269032">!=</span>&nbsp;<span class="builtintype" id="3269035">nil</span>&nbsp;<span class="op" id="3269039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269044">return</span>&nbsp;<span class="builtintype" id="3269051">nil</span><span class="op" id="3269054">,</span>&nbsp;<span class="ident" id="3269056">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3269062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3269065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3269068">ifat</span><span class="op" id="3269072">,</span>&nbsp;<span class="ident" id="3269074">err</span>&nbsp;<span class="op" id="3269078">:=</span>&nbsp;<span class="ident" id="3269081">addrTable</span><span class="op" id="3269090">(</span><span class="ident" id="3269091">ift</span><span class="op" id="3269094">,</span>&nbsp;<span class="ident" id="3269096">ifi</span><span class="op" id="3269099">,</span>&nbsp;<span class="ident" id="3269101">msgs</span><span class="op" id="3269105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269108">if</span>&nbsp;<span class="ident" id="3269111">err</span>&nbsp;<span class="op" id="3269115">!=</span>&nbsp;<span class="builtintype" id="3269118">nil</span>&nbsp;<span class="op" id="3269122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269126">return</span>&nbsp;<span class="builtintype" id="3269133">nil</span><span class="op" id="3269136">,</span>&nbsp;<span class="ident" id="3269138">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3269143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269146">return</span>&nbsp;<span class="ident" id="3269153">ifat</span><span class="op" id="3269157">,</span>&nbsp;<span class="builtintype" id="3269159">nil</span><br>
<span class="lineno"></span><span class="op" id="3269163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3269166">func</span>&nbsp;<span class="ident" id="3269171">addrTable</span><span class="op" id="3269180">(</span><span class="ident" id="3269181">ift</span>&nbsp;<span class="op" id="3269185">[</span><span class="op" id="3269186">]</span><span class="ident" id="3269187">Interface</span><span class="op" id="3269196">,</span>&nbsp;<span class="ident" id="3269198">ifi</span>&nbsp;<span class="op" id="3269202">*</span><span class="ident" id="3269203">Interface</span><span class="op" id="3269212">,</span>&nbsp;<span class="ident" id="3269214">msgs</span>&nbsp;<span class="op" id="3269219">[</span><span class="op" id="3269220">]</span><span class="ident" id="3269221">syscall</span><span class="op" id="3269228">.</span><span class="ident" id="3269229">NetlinkMessage</span><span class="op" id="3269243">)</span>&nbsp;<span class="op" id="3269245">(</span><span class="op" id="3269246">[</span><span class="op" id="3269247">]</span><span class="ident" id="3269248">Addr</span><span class="op" id="3269252">,</span>&nbsp;<span class="builtintype" id="3269254">error</span><span class="op" id="3269259">)</span>&nbsp;<span class="op" id="3269261">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269264">var</span>&nbsp;<span class="ident" id="3269268">ifat</span>&nbsp;<span class="op" id="3269273">[</span><span class="op" id="3269274">]</span><span class="ident" id="3269275">Addr</span><br>
<span class="lineno"></span><span class="ident" id="3269280">loop</span><span class="op" id="3269284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269287">for</span>&nbsp;<span class="ident" id="3269291">_</span><span class="op" id="3269292">,</span>&nbsp;<span class="ident" id="3269294">m</span>&nbsp;<span class="op" id="3269296">:=</span>&nbsp;<span class="keyword" id="3269299">range</span>&nbsp;<span class="ident" id="3269305">msgs</span>&nbsp;<span class="op" id="3269310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269314">switch</span>&nbsp;<span class="ident" id="3269321">m</span><span class="op" id="3269322">.</span><span class="ident" id="3269323">Header</span><span class="op" id="3269329">.</span><span class="ident" id="3269330">Type</span>&nbsp;<span class="op" id="3269335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269339">case</span>&nbsp;<span class="ident" id="3269344">syscall</span><span class="op" id="3269351">.</span><span class="ident" id="3269352">NLMSG_DONE</span><span class="op" id="3269362">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269367">break</span>&nbsp;<span class="ident" id="3269373">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269380">case</span>&nbsp;<span class="ident" id="3269385">syscall</span><span class="op" id="3269392">.</span><span class="ident" id="3269393">RTM_NEWADDR</span><span class="op" id="3269404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3269409">ifam</span>&nbsp;<span class="op" id="3269414">:=</span>&nbsp;<span class="op" id="3269417">(</span><span class="op" id="3269418">*</span><span class="ident" id="3269419">syscall</span><span class="op" id="3269426">.</span><span class="ident" id="3269427">IfAddrmsg</span><span class="op" id="3269436">)</span><span class="op" id="3269437">(</span><span class="ident" id="3269438">unsafe</span><span class="op" id="3269444">.</span><span class="ident" id="3269445">Pointer</span><span class="op" id="3269452">(</span><span class="op" id="3269453">&amp;</span><span class="ident" id="3269454">m</span><span class="op" id="3269455">.</span><span class="ident" id="3269456">Data</span><span class="op" id="3269460">[</span><span class="num" id="3269461">0</span><span class="op" id="3269462">]</span><span class="op" id="3269463">)</span><span class="op" id="3269464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269469">if</span>&nbsp;<span class="builtinfunc" id="3269472">len</span><span class="op" id="3269475">(</span><span class="ident" id="3269476">ift</span><span class="op" id="3269479">)</span>&nbsp;<span class="op" id="3269481">!=</span>&nbsp;<span class="num" id="3269484">0</span>&nbsp;<span class="op" id="3269486">||</span>&nbsp;<span class="ident" id="3269489">ifi</span><span class="op" id="3269492">.</span><span class="ident" id="3269493">Index</span>&nbsp;<span class="op" id="3269499">==</span>&nbsp;<span class="builtintype" id="3269502">int</span><span class="op" id="3269505">(</span><span class="ident" id="3269506">ifam</span><span class="op" id="3269510">.</span><span class="ident" id="3269511">Index</span><span class="op" id="3269516">)</span>&nbsp;<span class="op" id="3269518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269524">if</span>&nbsp;<span class="builtinfunc" id="3269527">len</span><span class="op" id="3269530">(</span><span class="ident" id="3269531">ift</span><span class="op" id="3269534">)</span>&nbsp;<span class="op" id="3269536">!=</span>&nbsp;<span class="num" id="3269539">0</span>&nbsp;<span class="op" id="3269541">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269548">var</span>&nbsp;<span class="ident" id="3269552">err</span>&nbsp;<span class="builtintype" id="3269556">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3269567">ifi</span><span class="op" id="3269570">,</span>&nbsp;<span class="ident" id="3269572">err</span>&nbsp;<span class="op" id="3269576">=</span>&nbsp;<span class="ident" id="3269578">interfaceByIndex</span><span class="op" id="3269594">(</span><span class="ident" id="3269595">ift</span><span class="op" id="3269598">,</span>&nbsp;<span class="builtintype" id="3269600">int</span><span class="op" id="3269603">(</span><span class="ident" id="3269604">ifam</span><span class="op" id="3269608">.</span><span class="ident" id="3269609">Index</span><span class="op" id="3269614">)</span><span class="op" id="3269615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269622">if</span>&nbsp;<span class="ident" id="3269625">err</span>&nbsp;<span class="op" id="3269629">!=</span>&nbsp;<span class="builtintype" id="3269632">nil</span>&nbsp;<span class="op" id="3269636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269644">return</span>&nbsp;<span class="builtintype" id="3269651">nil</span><span class="op" id="3269654">,</span>&nbsp;<span class="ident" id="3269656">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3269665">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3269671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3269677">attrs</span><span class="op" id="3269682">,</span>&nbsp;<span class="ident" id="3269684">err</span>&nbsp;<span class="op" id="3269688">:=</span>&nbsp;<span class="ident" id="3269691">syscall</span><span class="op" id="3269698">.</span><span class="ident" id="3269699">ParseNetlinkRouteAttr</span><span class="op" id="3269720">(</span><span class="op" id="3269721">&amp;</span><span class="ident" id="3269722">m</span><span class="op" id="3269723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269729">if</span>&nbsp;<span class="ident" id="3269732">err</span>&nbsp;<span class="op" id="3269736">!=</span>&nbsp;<span class="builtintype" id="3269739">nil</span>&nbsp;<span class="op" id="3269743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269750">return</span>&nbsp;<span class="builtintype" id="3269757">nil</span><span class="op" id="3269760">,</span>&nbsp;<span class="ident" id="3269762">os</span><span class="op" id="3269764">.</span><span class="ident" id="3269765">NewSyscallError</span><span class="op" id="3269780">(</span><span class="string" id="3269781">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3269800">,</span>&nbsp;<span class="ident" id="3269802">err</span><span class="op" id="3269805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3269811">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3269817">ifa</span>&nbsp;<span class="op" id="3269821">:=</span>&nbsp;<span class="ident" id="3269824">newAddr</span><span class="op" id="3269831">(</span><span class="ident" id="3269832">ifi</span><span class="op" id="3269835">,</span>&nbsp;<span class="ident" id="3269837">ifam</span><span class="op" id="3269841">,</span>&nbsp;<span class="ident" id="3269843">attrs</span><span class="op" id="3269848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269854">if</span>&nbsp;<span class="ident" id="3269857">ifa</span>&nbsp;<span class="op" id="3269861">!=</span>&nbsp;<span class="builtintype" id="3269864">nil</span>&nbsp;<span class="op" id="3269868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3269875">ifat</span>&nbsp;<span class="op" id="3269880">=</span>&nbsp;<span class="builtinfunc" id="3269882">append</span><span class="op" id="3269888">(</span><span class="ident" id="3269889">ifat</span><span class="op" id="3269893">,</span>&nbsp;<span class="ident" id="3269895">ifa</span><span class="op" id="3269898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3269904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3269909">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3269913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3269916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3269919">return</span>&nbsp;<span class="ident" id="3269926">ifat</span><span class="op" id="3269930">,</span>&nbsp;<span class="builtintype" id="3269932">nil</span><br>
<span class="lineno"></span><span class="op" id="3269936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="3269939">func</span>&nbsp;<span class="ident" id="3269944">newAddr</span><span class="op" id="3269951">(</span><span class="ident" id="3269952">ifi</span>&nbsp;<span class="op" id="3269956">*</span><span class="ident" id="3269957">Interface</span><span class="op" id="3269966">,</span>&nbsp;<span class="ident" id="3269968">ifam</span>&nbsp;<span class="op" id="3269973">*</span><span class="ident" id="3269974">syscall</span><span class="op" id="3269981">.</span><span class="ident" id="3269982">IfAddrmsg</span><span class="op" id="3269991">,</span>&nbsp;<span class="ident" id="3269993">attrs</span>&nbsp;<span class="op" id="3269999">[</span><span class="op" id="3270000">]</span><span class="ident" id="3270001">syscall</span><span class="op" id="3270008">.</span><span class="ident" id="3270009">NetlinkRouteAttr</span><span class="op" id="3270025">)</span>&nbsp;<span class="ident" id="3270027">Addr</span>&nbsp;<span class="op" id="3270032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270035">var</span>&nbsp;<span class="ident" id="3270039">ipPointToPoint</span>&nbsp;<span class="builtintype" id="3270054">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3270060">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3270121">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3270184">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270239">if</span>&nbsp;<span class="ident" id="3270242">ifi</span><span class="op" id="3270245">.</span><span class="ident" id="3270246">Flags</span><span class="op" id="3270251">&amp;</span><span class="ident" id="3270252">FlagPointToPoint</span>&nbsp;<span class="op" id="3270269">!=</span>&nbsp;<span class="num" id="3270272">0</span>&nbsp;<span class="op" id="3270274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270278">for</span>&nbsp;<span class="ident" id="3270282">_</span><span class="op" id="3270283">,</span>&nbsp;<span class="ident" id="3270285">a</span>&nbsp;<span class="op" id="3270287">:=</span>&nbsp;<span class="keyword" id="3270290">range</span>&nbsp;<span class="ident" id="3270296">attrs</span>&nbsp;<span class="op" id="3270302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270307">if</span>&nbsp;<span class="ident" id="3270310">a</span><span class="op" id="3270311">.</span><span class="ident" id="3270312">Attr</span><span class="op" id="3270316">.</span><span class="ident" id="3270317">Type</span>&nbsp;<span class="op" id="3270322">==</span>&nbsp;<span class="ident" id="3270325">syscall</span><span class="op" id="3270332">.</span><span class="ident" id="3270333">IFA_LOCAL</span>&nbsp;<span class="op" id="3270343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3270349">ipPointToPoint</span>&nbsp;<span class="op" id="3270364">=</span>&nbsp;<span class="builtintype" id="3270366">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270375">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3270384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3270388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3270391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270394">for</span>&nbsp;<span class="ident" id="3270398">_</span><span class="op" id="3270399">,</span>&nbsp;<span class="ident" id="3270401">a</span>&nbsp;<span class="op" id="3270403">:=</span>&nbsp;<span class="keyword" id="3270406">range</span>&nbsp;<span class="ident" id="3270412">attrs</span>&nbsp;<span class="op" id="3270418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270422">if</span>&nbsp;<span class="ident" id="3270425">ipPointToPoint</span>&nbsp;<span class="op" id="3270440">&amp;&amp;</span>&nbsp;<span class="ident" id="3270443">a</span><span class="op" id="3270444">.</span><span class="ident" id="3270445">Attr</span><span class="op" id="3270449">.</span><span class="ident" id="3270450">Type</span>&nbsp;<span class="op" id="3270455">==</span>&nbsp;<span class="ident" id="3270458">syscall</span><span class="op" id="3270465">.</span><span class="ident" id="3270466">IFA_ADDRESS</span>&nbsp;<span class="op" id="3270478">||</span>&nbsp;<span class="op" id="3270481">!</span><span class="ident" id="3270482">ipPointToPoint</span>&nbsp;<span class="op" id="3270497">&amp;&amp;</span>&nbsp;<span class="ident" id="3270500">a</span><span class="op" id="3270501">.</span><span class="ident" id="3270502">Attr</span><span class="op" id="3270506">.</span><span class="ident" id="3270507">Type</span>&nbsp;<span class="op" id="3270512">==</span>&nbsp;<span class="ident" id="3270515">syscall</span><span class="op" id="3270522">.</span><span class="ident" id="3270523">IFA_LOCAL</span>&nbsp;<span class="op" id="3270533">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270538">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3270549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270553">switch</span>&nbsp;<span class="ident" id="3270560">ifam</span><span class="op" id="3270564">.</span><span class="ident" id="3270565">Family</span>&nbsp;<span class="op" id="3270572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270576">case</span>&nbsp;<span class="ident" id="3270581">syscall</span><span class="op" id="3270588">.</span><span class="ident" id="3270589">AF_INET</span><span class="op" id="3270596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270601">return</span>&nbsp;<span class="op" id="3270608">&amp;</span><span class="ident" id="3270609">IPNet</span><span class="op" id="3270614">{</span><span class="ident" id="3270615">IP</span><span class="op" id="3270617">:</span>&nbsp;<span class="ident" id="3270619">IPv4</span><span class="op" id="3270623">(</span><span class="ident" id="3270624">a</span><span class="op" id="3270625">.</span><span class="ident" id="3270626">Value</span><span class="op" id="3270631">[</span><span class="num" id="3270632">0</span><span class="op" id="3270633">]</span><span class="op" id="3270634">,</span>&nbsp;<span class="ident" id="3270636">a</span><span class="op" id="3270637">.</span><span class="ident" id="3270638">Value</span><span class="op" id="3270643">[</span><span class="num" id="3270644">1</span><span class="op" id="3270645">]</span><span class="op" id="3270646">,</span>&nbsp;<span class="ident" id="3270648">a</span><span class="op" id="3270649">.</span><span class="ident" id="3270650">Value</span><span class="op" id="3270655">[</span><span class="num" id="3270656">2</span><span class="op" id="3270657">]</span><span class="op" id="3270658">,</span>&nbsp;<span class="ident" id="3270660">a</span><span class="op" id="3270661">.</span><span class="ident" id="3270662">Value</span><span class="op" id="3270667">[</span><span class="num" id="3270668">3</span><span class="op" id="3270669">]</span><span class="op" id="3270670">)</span><span class="op" id="3270671">,</span>&nbsp;<span class="ident" id="3270673">Mask</span><span class="op" id="3270677">:</span>&nbsp;<span class="ident" id="3270679">CIDRMask</span><span class="op" id="3270687">(</span><span class="builtintype" id="3270688">int</span><span class="op" id="3270691">(</span><span class="ident" id="3270692">ifam</span><span class="op" id="3270696">.</span><span class="ident" id="3270697">Prefixlen</span><span class="op" id="3270706">)</span><span class="op" id="3270707">,</span>&nbsp;<span class="num" id="3270709">8</span><span class="op" id="3270710">*</span><span class="ident" id="3270711">IPv4len</span><span class="op" id="3270718">)</span><span class="op" id="3270719">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270723">case</span>&nbsp;<span class="ident" id="3270728">syscall</span><span class="op" id="3270735">.</span><span class="ident" id="3270736">AF_INET6</span><span class="op" id="3270744">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3270749">ifa</span>&nbsp;<span class="op" id="3270753">:=</span>&nbsp;<span class="op" id="3270756">&amp;</span><span class="ident" id="3270757">IPNet</span><span class="op" id="3270762">{</span><span class="ident" id="3270763">IP</span><span class="op" id="3270765">:</span>&nbsp;<span class="builtinfunc" id="3270767">make</span><span class="op" id="3270771">(</span><span class="ident" id="3270772">IP</span><span class="op" id="3270774">,</span>&nbsp;<span class="ident" id="3270776">IPv6len</span><span class="op" id="3270783">)</span><span class="op" id="3270784">,</span>&nbsp;<span class="ident" id="3270786">Mask</span><span class="op" id="3270790">:</span>&nbsp;<span class="ident" id="3270792">CIDRMask</span><span class="op" id="3270800">(</span><span class="builtintype" id="3270801">int</span><span class="op" id="3270804">(</span><span class="ident" id="3270805">ifam</span><span class="op" id="3270809">.</span><span class="ident" id="3270810">Prefixlen</span><span class="op" id="3270819">)</span><span class="op" id="3270820">,</span>&nbsp;<span class="num" id="3270822">8</span><span class="op" id="3270823">*</span><span class="ident" id="3270824">IPv6len</span><span class="op" id="3270831">)</span><span class="op" id="3270832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3270837">copy</span><span class="op" id="3270841">(</span><span class="ident" id="3270842">ifa</span><span class="op" id="3270845">.</span><span class="ident" id="3270846">IP</span><span class="op" id="3270848">,</span>&nbsp;<span class="ident" id="3270850">a</span><span class="op" id="3270851">.</span><span class="ident" id="3270852">Value</span><span class="op" id="3270857">[</span><span class="op" id="3270858">:</span><span class="op" id="3270859">]</span><span class="op" id="3270860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270865">return</span>&nbsp;<span class="ident" id="3270872">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3270878">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3270881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3270884">return</span>&nbsp;<span class="builtintype" id="3270891">nil</span><br>
<span class="lineno"></span><span class="op" id="3270895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3270898">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="3270962">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3270976">func</span>&nbsp;<span class="ident" id="3270981">interfaceMulticastAddrTable</span><span class="op" id="3271008">(</span><span class="ident" id="3271009">ifi</span>&nbsp;<span class="op" id="3271013">*</span><span class="ident" id="3271014">Interface</span><span class="op" id="3271023">)</span>&nbsp;<span class="op" id="3271025">(</span><span class="op" id="3271026">[</span><span class="op" id="3271027">]</span><span class="ident" id="3271028">Addr</span><span class="op" id="3271032">,</span>&nbsp;<span class="builtintype" id="3271034">error</span><span class="op" id="3271039">)</span>&nbsp;<span class="op" id="3271041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271044">ifmat4</span>&nbsp;<span class="op" id="3271051">:=</span>&nbsp;<span class="ident" id="3271054">parseProcNetIGMP</span><span class="op" id="3271070">(</span><span class="string" id="3271071">&#34;/proc/net/igmp&#34;</span><span class="op" id="3271087">,</span>&nbsp;<span class="ident" id="3271089">ifi</span><span class="op" id="3271092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271095">ifmat6</span>&nbsp;<span class="op" id="3271102">:=</span>&nbsp;<span class="ident" id="3271105">parseProcNetIGMP6</span><span class="op" id="3271122">(</span><span class="string" id="3271123">&#34;/proc/net/igmp6&#34;</span><span class="op" id="3271140">,</span>&nbsp;<span class="ident" id="3271142">ifi</span><span class="op" id="3271145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271148">return</span>&nbsp;<span class="builtinfunc" id="3271155">append</span><span class="op" id="3271161">(</span><span class="ident" id="3271162">ifmat4</span><span class="op" id="3271168">,</span>&nbsp;<span class="ident" id="3271170">ifmat6</span><span class="op" id="3271176">...</span><span class="op" id="3271179">)</span><span class="op" id="3271180">,</span>&nbsp;<span class="builtintype" id="3271182">nil</span><br>
<span class="lineno">210</span><span class="op" id="3271186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3271189">func</span>&nbsp;<span class="ident" id="3271194">parseProcNetIGMP</span><span class="op" id="3271210">(</span><span class="ident" id="3271211">path</span>&nbsp;<span class="builtintype" id="3271216">string</span><span class="op" id="3271222">,</span>&nbsp;<span class="ident" id="3271224">ifi</span>&nbsp;<span class="op" id="3271228">*</span><span class="ident" id="3271229">Interface</span><span class="op" id="3271238">)</span>&nbsp;<span class="op" id="3271240">[</span><span class="op" id="3271241">]</span><span class="ident" id="3271242">Addr</span>&nbsp;<span class="op" id="3271247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271250">fd</span><span class="op" id="3271252">,</span>&nbsp;<span class="ident" id="3271254">err</span>&nbsp;<span class="op" id="3271258">:=</span>&nbsp;<span class="ident" id="3271261">open</span><span class="op" id="3271265">(</span><span class="ident" id="3271266">path</span><span class="op" id="3271270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271273">if</span>&nbsp;<span class="ident" id="3271276">err</span>&nbsp;<span class="op" id="3271280">!=</span>&nbsp;<span class="builtintype" id="3271283">nil</span>&nbsp;<span class="op" id="3271287">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271291">return</span>&nbsp;<span class="builtintype" id="3271298">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3271303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271306">defer</span>&nbsp;<span class="ident" id="3271312">fd</span><span class="op" id="3271314">.</span><span class="builtinfunc" id="3271315">close</span><span class="op" id="3271320">(</span><span class="op" id="3271321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271324">var</span>&nbsp;<span class="op" id="3271328">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271332">ifmat</span>&nbsp;<span class="op" id="3271338">[</span><span class="op" id="3271339">]</span><span class="ident" id="3271340">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271347">name</span>&nbsp;&nbsp;<span class="builtintype" id="3271353">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3271361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271364">fd</span><span class="op" id="3271366">.</span><span class="ident" id="3271367">readLine</span><span class="op" id="3271375">(</span><span class="op" id="3271376">)</span>&nbsp;<span class="comment" id="3271378">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271398">b</span>&nbsp;<span class="op" id="3271400">:=</span>&nbsp;<span class="builtinfunc" id="3271403">make</span><span class="op" id="3271407">(</span><span class="op" id="3271408">[</span><span class="op" id="3271409">]</span><span class="builtintype" id="3271410">byte</span><span class="op" id="3271414">,</span>&nbsp;<span class="ident" id="3271416">IPv4len</span><span class="op" id="3271423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271426">for</span>&nbsp;<span class="ident" id="3271430">l</span><span class="op" id="3271431">,</span>&nbsp;<span class="ident" id="3271433">ok</span>&nbsp;<span class="op" id="3271436">:=</span>&nbsp;<span class="ident" id="3271439">fd</span><span class="op" id="3271441">.</span><span class="ident" id="3271442">readLine</span><span class="op" id="3271450">(</span><span class="op" id="3271451">)</span><span class="op" id="3271452">;</span>&nbsp;<span class="ident" id="3271454">ok</span><span class="op" id="3271456">;</span>&nbsp;<span class="ident" id="3271458">l</span><span class="op" id="3271459">,</span>&nbsp;<span class="ident" id="3271461">ok</span>&nbsp;<span class="op" id="3271464">=</span>&nbsp;<span class="ident" id="3271466">fd</span><span class="op" id="3271468">.</span><span class="ident" id="3271469">readLine</span><span class="op" id="3271477">(</span><span class="op" id="3271478">)</span>&nbsp;<span class="op" id="3271480">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271484">f</span>&nbsp;<span class="op" id="3271486">:=</span>&nbsp;<span class="ident" id="3271489">splitAtBytes</span><span class="op" id="3271501">(</span><span class="ident" id="3271502">l</span><span class="op" id="3271503">,</span>&nbsp;<span class="string" id="3271505">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="3271515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271519">if</span>&nbsp;<span class="builtinfunc" id="3271522">len</span><span class="op" id="3271525">(</span><span class="ident" id="3271526">f</span><span class="op" id="3271527">)</span>&nbsp;<span class="op" id="3271529">&lt;</span>&nbsp;<span class="num" id="3271531">4</span>&nbsp;<span class="op" id="3271533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271538">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3271549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271553">switch</span>&nbsp;<span class="op" id="3271560">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271564">case</span>&nbsp;<span class="ident" id="3271569">l</span><span class="op" id="3271570">[</span><span class="num" id="3271571">0</span><span class="op" id="3271572">]</span>&nbsp;<span class="op" id="3271574">!=</span>&nbsp;<span class="string" id="3271577">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3271581">&amp;&amp;</span>&nbsp;<span class="ident" id="3271584">l</span><span class="op" id="3271585">[</span><span class="num" id="3271586">0</span><span class="op" id="3271587">]</span>&nbsp;<span class="op" id="3271589">!=</span>&nbsp;<span class="string" id="3271592">&#39;\t&#39;</span><span class="op" id="3271596">:</span>&nbsp;<span class="comment" id="3271598">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271623">name</span>&nbsp;<span class="op" id="3271628">=</span>&nbsp;<span class="ident" id="3271630">f</span><span class="op" id="3271631">[</span><span class="num" id="3271632">1</span><span class="op" id="3271633">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271637">case</span>&nbsp;<span class="builtinfunc" id="3271642">len</span><span class="op" id="3271645">(</span><span class="ident" id="3271646">f</span><span class="op" id="3271647">[</span><span class="num" id="3271648">0</span><span class="op" id="3271649">]</span><span class="op" id="3271650">)</span>&nbsp;<span class="op" id="3271652">==</span>&nbsp;<span class="num" id="3271655">8</span><span class="op" id="3271656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271661">if</span>&nbsp;<span class="ident" id="3271664">ifi</span>&nbsp;<span class="op" id="3271668">==</span>&nbsp;<span class="builtintype" id="3271671">nil</span>&nbsp;<span class="op" id="3271675">||</span>&nbsp;<span class="ident" id="3271678">name</span>&nbsp;<span class="op" id="3271683">==</span>&nbsp;<span class="ident" id="3271686">ifi</span><span class="op" id="3271689">.</span><span class="ident" id="3271690">Name</span>&nbsp;<span class="op" id="3271695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3271701">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3271737">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3271780">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3271799">for</span>&nbsp;<span class="ident" id="3271803">i</span>&nbsp;<span class="op" id="3271805">:=</span>&nbsp;<span class="num" id="3271808">0</span><span class="op" id="3271809">;</span>&nbsp;<span class="ident" id="3271811">i</span><span class="op" id="3271812">+</span><span class="num" id="3271813">1</span>&nbsp;<span class="op" id="3271815">&lt;</span>&nbsp;<span class="builtinfunc" id="3271817">len</span><span class="op" id="3271820">(</span><span class="ident" id="3271821">f</span><span class="op" id="3271822">[</span><span class="num" id="3271823">0</span><span class="op" id="3271824">]</span><span class="op" id="3271825">)</span><span class="op" id="3271826">;</span>&nbsp;<span class="ident" id="3271828">i</span>&nbsp;<span class="op" id="3271830">+=</span>&nbsp;<span class="num" id="3271833">2</span>&nbsp;<span class="op" id="3271835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271842">b</span><span class="op" id="3271843">[</span><span class="ident" id="3271844">i</span><span class="op" id="3271845">/</span><span class="num" id="3271846">2</span><span class="op" id="3271847">]</span><span class="op" id="3271848">,</span>&nbsp;<span class="ident" id="3271850">_</span>&nbsp;<span class="op" id="3271852">=</span>&nbsp;<span class="ident" id="3271854">xtoi2</span><span class="op" id="3271859">(</span><span class="ident" id="3271860">f</span><span class="op" id="3271861">[</span><span class="num" id="3271862">0</span><span class="op" id="3271863">]</span><span class="op" id="3271864">[</span><span class="ident" id="3271865">i</span><span class="op" id="3271866">:</span><span class="ident" id="3271867">i</span><span class="op" id="3271868">+</span><span class="num" id="3271869">2</span><span class="op" id="3271870">]</span><span class="op" id="3271871">,</span>&nbsp;<span class="num" id="3271873">0</span><span class="op" id="3271874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3271880">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271886">i</span>&nbsp;<span class="op" id="3271888">:=</span>&nbsp;<span class="op" id="3271891">*</span><span class="op" id="3271892">(</span><span class="op" id="3271893">*</span><span class="builtintype" id="3271894">uint32</span><span class="op" id="3271900">)</span><span class="op" id="3271901">(</span><span class="ident" id="3271902">unsafe</span><span class="op" id="3271908">.</span><span class="ident" id="3271909">Pointer</span><span class="op" id="3271916">(</span><span class="op" id="3271917">&amp;</span><span class="ident" id="3271918">b</span><span class="op" id="3271919">[</span><span class="op" id="3271920">:</span><span class="num" id="3271921">4</span><span class="op" id="3271922">]</span><span class="op" id="3271923">[</span><span class="num" id="3271924">0</span><span class="op" id="3271925">]</span><span class="op" id="3271926">)</span><span class="op" id="3271927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3271933">ifma</span>&nbsp;<span class="op" id="3271938">:=</span>&nbsp;<span class="ident" id="3271941">IPAddr</span><span class="op" id="3271947">{</span><span class="ident" id="3271948">IP</span><span class="op" id="3271950">:</span>&nbsp;<span class="ident" id="3271952">IPv4</span><span class="op" id="3271956">(</span><span class="builtintype" id="3271957">byte</span><span class="op" id="3271961">(</span><span class="ident" id="3271962">i</span><span class="op" id="3271963">&gt;&gt;</span><span class="num" id="3271965">24</span><span class="op" id="3271967">)</span><span class="op" id="3271968">,</span>&nbsp;<span class="builtintype" id="3271970">byte</span><span class="op" id="3271974">(</span><span class="ident" id="3271975">i</span><span class="op" id="3271976">&gt;&gt;</span><span class="num" id="3271978">16</span><span class="op" id="3271980">)</span><span class="op" id="3271981">,</span>&nbsp;<span class="builtintype" id="3271983">byte</span><span class="op" id="3271987">(</span><span class="ident" id="3271988">i</span><span class="op" id="3271989">&gt;&gt;</span><span class="num" id="3271991">8</span><span class="op" id="3271992">)</span><span class="op" id="3271993">,</span>&nbsp;<span class="builtintype" id="3271995">byte</span><span class="op" id="3271999">(</span><span class="ident" id="3272000">i</span><span class="op" id="3272001">)</span><span class="op" id="3272002">)</span><span class="op" id="3272003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3272009">ifmat</span>&nbsp;<span class="op" id="3272015">=</span>&nbsp;<span class="builtinfunc" id="3272017">append</span><span class="op" id="3272023">(</span><span class="ident" id="3272024">ifmat</span><span class="op" id="3272029">,</span>&nbsp;<span class="ident" id="3272031">ifma</span><span class="op" id="3272035">.</span><span class="ident" id="3272036">toAddr</span><span class="op" id="3272042">(</span><span class="op" id="3272043">)</span><span class="op" id="3272044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3272049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3272053">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3272056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272059">return</span>&nbsp;<span class="ident" id="3272066">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3272072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3272075">func</span>&nbsp;<span class="ident" id="3272080">parseProcNetIGMP6</span><span class="op" id="3272097">(</span><span class="ident" id="3272098">path</span>&nbsp;<span class="builtintype" id="3272103">string</span><span class="op" id="3272109">,</span>&nbsp;<span class="ident" id="3272111">ifi</span>&nbsp;<span class="op" id="3272115">*</span><span class="ident" id="3272116">Interface</span><span class="op" id="3272125">)</span>&nbsp;<span class="op" id="3272127">[</span><span class="op" id="3272128">]</span><span class="ident" id="3272129">Addr</span>&nbsp;<span class="op" id="3272134">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3272137">fd</span><span class="op" id="3272139">,</span>&nbsp;<span class="ident" id="3272141">err</span>&nbsp;<span class="op" id="3272145">:=</span>&nbsp;<span class="ident" id="3272148">open</span><span class="op" id="3272152">(</span><span class="ident" id="3272153">path</span><span class="op" id="3272157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272160">if</span>&nbsp;<span class="ident" id="3272163">err</span>&nbsp;<span class="op" id="3272167">!=</span>&nbsp;<span class="builtintype" id="3272170">nil</span>&nbsp;<span class="op" id="3272174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272178">return</span>&nbsp;<span class="builtintype" id="3272185">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3272190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272193">defer</span>&nbsp;<span class="ident" id="3272199">fd</span><span class="op" id="3272201">.</span><span class="builtinfunc" id="3272202">close</span><span class="op" id="3272207">(</span><span class="op" id="3272208">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272211">var</span>&nbsp;<span class="ident" id="3272215">ifmat</span>&nbsp;<span class="op" id="3272221">[</span><span class="op" id="3272222">]</span><span class="ident" id="3272223">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3272229">b</span>&nbsp;<span class="op" id="3272231">:=</span>&nbsp;<span class="builtinfunc" id="3272234">make</span><span class="op" id="3272238">(</span><span class="op" id="3272239">[</span><span class="op" id="3272240">]</span><span class="builtintype" id="3272241">byte</span><span class="op" id="3272245">,</span>&nbsp;<span class="ident" id="3272247">IPv6len</span><span class="op" id="3272254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272257">for</span>&nbsp;<span class="ident" id="3272261">l</span><span class="op" id="3272262">,</span>&nbsp;<span class="ident" id="3272264">ok</span>&nbsp;<span class="op" id="3272267">:=</span>&nbsp;<span class="ident" id="3272270">fd</span><span class="op" id="3272272">.</span><span class="ident" id="3272273">readLine</span><span class="op" id="3272281">(</span><span class="op" id="3272282">)</span><span class="op" id="3272283">;</span>&nbsp;<span class="ident" id="3272285">ok</span><span class="op" id="3272287">;</span>&nbsp;<span class="ident" id="3272289">l</span><span class="op" id="3272290">,</span>&nbsp;<span class="ident" id="3272292">ok</span>&nbsp;<span class="op" id="3272295">=</span>&nbsp;<span class="ident" id="3272297">fd</span><span class="op" id="3272299">.</span><span class="ident" id="3272300">readLine</span><span class="op" id="3272308">(</span><span class="op" id="3272309">)</span>&nbsp;<span class="op" id="3272311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3272315">f</span>&nbsp;<span class="op" id="3272317">:=</span>&nbsp;<span class="ident" id="3272320">splitAtBytes</span><span class="op" id="3272332">(</span><span class="ident" id="3272333">l</span><span class="op" id="3272334">,</span>&nbsp;<span class="string" id="3272336">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="3272345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272349">if</span>&nbsp;<span class="builtinfunc" id="3272352">len</span><span class="op" id="3272355">(</span><span class="ident" id="3272356">f</span><span class="op" id="3272357">)</span>&nbsp;<span class="op" id="3272359">&lt;</span>&nbsp;<span class="num" id="3272361">6</span>&nbsp;<span class="op" id="3272363">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272368">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3272379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272383">if</span>&nbsp;<span class="ident" id="3272386">ifi</span>&nbsp;<span class="op" id="3272390">==</span>&nbsp;<span class="builtintype" id="3272393">nil</span>&nbsp;<span class="op" id="3272397">||</span>&nbsp;<span class="ident" id="3272400">f</span><span class="op" id="3272401">[</span><span class="num" id="3272402">1</span><span class="op" id="3272403">]</span>&nbsp;<span class="op" id="3272405">==</span>&nbsp;<span class="ident" id="3272408">ifi</span><span class="op" id="3272411">.</span><span class="ident" id="3272412">Name</span>&nbsp;<span class="op" id="3272417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272422">for</span>&nbsp;<span class="ident" id="3272426">i</span>&nbsp;<span class="op" id="3272428">:=</span>&nbsp;<span class="num" id="3272431">0</span><span class="op" id="3272432">;</span>&nbsp;<span class="ident" id="3272434">i</span><span class="op" id="3272435">+</span><span class="num" id="3272436">1</span>&nbsp;<span class="op" id="3272438">&lt;</span>&nbsp;<span class="builtinfunc" id="3272440">len</span><span class="op" id="3272443">(</span><span class="ident" id="3272444">f</span><span class="op" id="3272445">[</span><span class="num" id="3272446">2</span><span class="op" id="3272447">]</span><span class="op" id="3272448">)</span><span class="op" id="3272449">;</span>&nbsp;<span class="ident" id="3272451">i</span>&nbsp;<span class="op" id="3272453">+=</span>&nbsp;<span class="num" id="3272456">2</span>&nbsp;<span class="op" id="3272458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3272464">b</span><span class="op" id="3272465">[</span><span class="ident" id="3272466">i</span><span class="op" id="3272467">/</span><span class="num" id="3272468">2</span><span class="op" id="3272469">]</span><span class="op" id="3272470">,</span>&nbsp;<span class="ident" id="3272472">_</span>&nbsp;<span class="op" id="3272474">=</span>&nbsp;<span class="ident" id="3272476">xtoi2</span><span class="op" id="3272481">(</span><span class="ident" id="3272482">f</span><span class="op" id="3272483">[</span><span class="num" id="3272484">2</span><span class="op" id="3272485">]</span><span class="op" id="3272486">[</span><span class="ident" id="3272487">i</span><span class="op" id="3272488">:</span><span class="ident" id="3272489">i</span><span class="op" id="3272490">+</span><span class="num" id="3272491">2</span><span class="op" id="3272492">]</span><span class="op" id="3272493">,</span>&nbsp;<span class="num" id="3272495">0</span><span class="op" id="3272496">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3272501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3272506">ifma</span>&nbsp;<span class="op" id="3272511">:=</span>&nbsp;<span class="ident" id="3272514">IPAddr</span><span class="op" id="3272520">{</span><span class="ident" id="3272521">IP</span><span class="op" id="3272523">:</span>&nbsp;<span class="ident" id="3272525">IP</span><span class="op" id="3272527">{</span><span class="ident" id="3272528">b</span><span class="op" id="3272529">[</span><span class="num" id="3272530">0</span><span class="op" id="3272531">]</span><span class="op" id="3272532">,</span>&nbsp;<span class="ident" id="3272534">b</span><span class="op" id="3272535">[</span><span class="num" id="3272536">1</span><span class="op" id="3272537">]</span><span class="op" id="3272538">,</span>&nbsp;<span class="ident" id="3272540">b</span><span class="op" id="3272541">[</span><span class="num" id="3272542">2</span><span class="op" id="3272543">]</span><span class="op" id="3272544">,</span>&nbsp;<span class="ident" id="3272546">b</span><span class="op" id="3272547">[</span><span class="num" id="3272548">3</span><span class="op" id="3272549">]</span><span class="op" id="3272550">,</span>&nbsp;<span class="ident" id="3272552">b</span><span class="op" id="3272553">[</span><span class="num" id="3272554">4</span><span class="op" id="3272555">]</span><span class="op" id="3272556">,</span>&nbsp;<span class="ident" id="3272558">b</span><span class="op" id="3272559">[</span><span class="num" id="3272560">5</span><span class="op" id="3272561">]</span><span class="op" id="3272562">,</span>&nbsp;<span class="ident" id="3272564">b</span><span class="op" id="3272565">[</span><span class="num" id="3272566">6</span><span class="op" id="3272567">]</span><span class="op" id="3272568">,</span>&nbsp;<span class="ident" id="3272570">b</span><span class="op" id="3272571">[</span><span class="num" id="3272572">7</span><span class="op" id="3272573">]</span><span class="op" id="3272574">,</span>&nbsp;<span class="ident" id="3272576">b</span><span class="op" id="3272577">[</span><span class="num" id="3272578">8</span><span class="op" id="3272579">]</span><span class="op" id="3272580">,</span>&nbsp;<span class="ident" id="3272582">b</span><span class="op" id="3272583">[</span><span class="num" id="3272584">9</span><span class="op" id="3272585">]</span><span class="op" id="3272586">,</span>&nbsp;<span class="ident" id="3272588">b</span><span class="op" id="3272589">[</span><span class="num" id="3272590">10</span><span class="op" id="3272592">]</span><span class="op" id="3272593">,</span>&nbsp;<span class="ident" id="3272595">b</span><span class="op" id="3272596">[</span><span class="num" id="3272597">11</span><span class="op" id="3272599">]</span><span class="op" id="3272600">,</span>&nbsp;<span class="ident" id="3272602">b</span><span class="op" id="3272603">[</span><span class="num" id="3272604">12</span><span class="op" id="3272606">]</span><span class="op" id="3272607">,</span>&nbsp;<span class="ident" id="3272609">b</span><span class="op" id="3272610">[</span><span class="num" id="3272611">13</span><span class="op" id="3272613">]</span><span class="op" id="3272614">,</span>&nbsp;<span class="ident" id="3272616">b</span><span class="op" id="3272617">[</span><span class="num" id="3272618">14</span><span class="op" id="3272620">]</span><span class="op" id="3272621">,</span>&nbsp;<span class="ident" id="3272623">b</span><span class="op" id="3272624">[</span><span class="num" id="3272625">15</span><span class="op" id="3272627">]</span><span class="op" id="3272628">}</span><span class="op" id="3272629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3272634">ifmat</span>&nbsp;<span class="op" id="3272640">=</span>&nbsp;<span class="builtinfunc" id="3272642">append</span><span class="op" id="3272648">(</span><span class="ident" id="3272649">ifmat</span><span class="op" id="3272654">,</span>&nbsp;<span class="ident" id="3272656">ifma</span><span class="op" id="3272660">.</span><span class="ident" id="3272661">toAddr</span><span class="op" id="3272667">(</span><span class="op" id="3272668">)</span><span class="op" id="3272669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3272673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3272676">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3272679">return</span>&nbsp;<span class="ident" id="3272686">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3272692">}</span>
</div>
</body>
</html>
