<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/elf</h2>
<ul>
<li><a href="/gostd/debug/elf/elf.go.html">elf.go</a></li>
<li><a href="/gostd/debug/elf/elf_test.go.html">elf_test.go</a></li>
<li><a href="/gostd/debug/elf/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/elf/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/elf/symbols_test.go.html">symbols_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5350315">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5350371">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5350425">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5350476">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5350530">package</span>&nbsp;<span class="ident" id="5350538">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5350543">import</span>&nbsp;<span class="op" id="5350550">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5350553">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5350562">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5350577">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5350596">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5350606">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5350613">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5350619">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="5350624">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5350627">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5350660">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5350699">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="5350746">type</span>&nbsp;<span class="ident" id="5350751">FileHeader</span>&nbsp;<span class="keyword" id="5350762">struct</span>&nbsp;<span class="op" id="5350769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350772">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350783">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350790">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350801">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350807">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350818">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350827">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350838">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350845">ABIVersion</span>&nbsp;<span class="builtintype" id="5350856">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350863">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="5350874">binary</span><span class="op" id="5350880">.</span><span class="ident" id="5350881">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350892">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350903">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350909">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350920">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5350929">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5350940">uint64</span><br>
<span class="lineno">35</span><span class="op" id="5350947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5350950">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5350989">type</span>&nbsp;<span class="ident" id="5350994">File</span>&nbsp;<span class="keyword" id="5350999">struct</span>&nbsp;<span class="op" id="5351006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351009">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351021">Sections</span>&nbsp;&nbsp;<span class="op" id="5351031">[</span><span class="op" id="5351032">]</span><span class="op" id="5351033">*</span><span class="ident" id="5351034">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351043">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5351053">[</span><span class="op" id="5351054">]</span><span class="op" id="5351055">*</span><span class="ident" id="5351056">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351062">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351072">io</span><span class="op" id="5351074">.</span><span class="ident" id="5351075">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351083">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5351093">[</span><span class="op" id="5351094">]</span><span class="ident" id="5351095">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351104">gnuVersym</span>&nbsp;<span class="op" id="5351114">[</span><span class="op" id="5351115">]</span><span class="builtintype" id="5351116">byte</span><br>
<span class="lineno">45</span><span class="op" id="5351121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5351124">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5351183">type</span>&nbsp;<span class="ident" id="5351188">SectionHeader</span>&nbsp;<span class="keyword" id="5351202">struct</span>&nbsp;<span class="op" id="5351209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351212">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5351222">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351230">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351240">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351253">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351263">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351276">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351286">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351294">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351304">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351312">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5351322">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351330">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5351340">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351348">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5351358">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351366">Addralign</span>&nbsp;<span class="ident" id="5351376">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351384">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5351394">uint64</span><br>
<span class="lineno"></span><span class="op" id="5351401">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5351404">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5351461">type</span>&nbsp;<span class="ident" id="5351466">Section</span>&nbsp;<span class="keyword" id="5351474">struct</span>&nbsp;<span class="op" id="5351481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351484">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5351500">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5351538">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5351578">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5351613">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5351661">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5351711">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351735">io</span><span class="op" id="5351737">.</span><span class="ident" id="5351738">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351748">sr</span>&nbsp;<span class="op" id="5351751">*</span><span class="ident" id="5351752">io</span><span class="op" id="5351754">.</span><span class="ident" id="5351755">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5351769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5351772">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5351831">func</span>&nbsp;<span class="op" id="5351836">(</span><span class="ident" id="5351837">s</span>&nbsp;<span class="op" id="5351839">*</span><span class="ident" id="5351840">Section</span><span class="op" id="5351847">)</span>&nbsp;<span class="ident" id="5351849">Data</span><span class="op" id="5351853">(</span><span class="op" id="5351854">)</span>&nbsp;<span class="op" id="5351856">(</span><span class="op" id="5351857">[</span><span class="op" id="5351858">]</span><span class="builtintype" id="5351859">byte</span><span class="op" id="5351863">,</span>&nbsp;<span class="builtintype" id="5351865">error</span><span class="op" id="5351870">)</span>&nbsp;<span class="op" id="5351872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351875">dat</span>&nbsp;<span class="op" id="5351879">:=</span>&nbsp;<span class="builtinfunc" id="5351882">make</span><span class="op" id="5351886">(</span><span class="op" id="5351887">[</span><span class="op" id="5351888">]</span><span class="builtintype" id="5351889">byte</span><span class="op" id="5351893">,</span>&nbsp;<span class="ident" id="5351895">s</span><span class="op" id="5351896">.</span><span class="ident" id="5351897">sr</span><span class="op" id="5351899">.</span><span class="ident" id="5351900">Size</span><span class="op" id="5351904">(</span><span class="op" id="5351905">)</span><span class="op" id="5351906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351909">n</span><span class="op" id="5351910">,</span>&nbsp;<span class="ident" id="5351912">err</span>&nbsp;<span class="op" id="5351916">:=</span>&nbsp;<span class="ident" id="5351919">s</span><span class="op" id="5351920">.</span><span class="ident" id="5351921">sr</span><span class="op" id="5351923">.</span><span class="ident" id="5351924">ReadAt</span><span class="op" id="5351930">(</span><span class="ident" id="5351931">dat</span><span class="op" id="5351934">,</span>&nbsp;<span class="num" id="5351936">0</span><span class="op" id="5351937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351940">if</span>&nbsp;<span class="ident" id="5351943">n</span>&nbsp;<span class="op" id="5351945">==</span>&nbsp;<span class="builtinfunc" id="5351948">len</span><span class="op" id="5351951">(</span><span class="ident" id="5351952">dat</span><span class="op" id="5351955">)</span>&nbsp;<span class="op" id="5351957">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5351961">err</span>&nbsp;<span class="op" id="5351965">=</span>&nbsp;<span class="ident" id="5351967">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5351972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5351975">return</span>&nbsp;<span class="ident" id="5351982">dat</span><span class="op" id="5351985">[</span><span class="num" id="5351986">0</span><span class="op" id="5351987">:</span><span class="ident" id="5351988">n</span><span class="op" id="5351989">]</span><span class="op" id="5351990">,</span>&nbsp;<span class="ident" id="5351992">err</span><br>
<span class="lineno"></span><span class="op" id="5351996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="5351999">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5352062">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5352087">func</span>&nbsp;<span class="op" id="5352092">(</span><span class="ident" id="5352093">f</span>&nbsp;<span class="op" id="5352095">*</span><span class="ident" id="5352096">File</span><span class="op" id="5352100">)</span>&nbsp;<span class="ident" id="5352102">stringTable</span><span class="op" id="5352113">(</span><span class="ident" id="5352114">link</span>&nbsp;<span class="builtintype" id="5352119">uint32</span><span class="op" id="5352125">)</span>&nbsp;<span class="op" id="5352127">(</span><span class="op" id="5352128">[</span><span class="op" id="5352129">]</span><span class="builtintype" id="5352130">byte</span><span class="op" id="5352134">,</span>&nbsp;<span class="builtintype" id="5352136">error</span><span class="op" id="5352141">)</span>&nbsp;<span class="op" id="5352143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352146">if</span>&nbsp;<span class="ident" id="5352149">link</span>&nbsp;<span class="op" id="5352154">&lt;=</span>&nbsp;<span class="num" id="5352157">0</span>&nbsp;<span class="op" id="5352159">||</span>&nbsp;<span class="ident" id="5352162">link</span>&nbsp;<span class="op" id="5352167">&gt;=</span>&nbsp;<span class="builtintype" id="5352170">uint32</span><span class="op" id="5352176">(</span><span class="builtinfunc" id="5352177">len</span><span class="op" id="5352180">(</span><span class="ident" id="5352181">f</span><span class="op" id="5352182">.</span><span class="ident" id="5352183">Sections</span><span class="op" id="5352191">)</span><span class="op" id="5352192">)</span>&nbsp;<span class="op" id="5352194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352198">return</span>&nbsp;<span class="ident" id="5352205">nil</span><span class="op" id="5352208">,</span>&nbsp;<span class="ident" id="5352210">errors</span><span class="op" id="5352216">.</span><span class="ident" id="5352217">New</span><span class="op" id="5352220">(</span><span class="string" id="5352221">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="5352260">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5352263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5352266">return</span>&nbsp;<span class="ident" id="5352273">f</span><span class="op" id="5352274">.</span><span class="ident" id="5352275">Sections</span><span class="op" id="5352283">[</span><span class="ident" id="5352284">link</span><span class="op" id="5352288">]</span><span class="op" id="5352289">.</span><span class="ident" id="5352290">Data</span><span class="op" id="5352294">(</span><span class="op" id="5352295">)</span><br>
<span class="lineno"></span><span class="op" id="5352297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5352300">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="5352358">func</span>&nbsp;<span class="op" id="5352363">(</span><span class="ident" id="5352364">s</span>&nbsp;<span class="op" id="5352366">*</span><span class="ident" id="5352367">Section</span><span class="op" id="5352374">)</span>&nbsp;<span class="ident" id="5352376">Open</span><span class="op" id="5352380">(</span><span class="op" id="5352381">)</span>&nbsp;<span class="ident" id="5352383">io</span><span class="op" id="5352385">.</span><span class="ident" id="5352386">ReadSeeker</span>&nbsp;<span class="op" id="5352397">{</span>&nbsp;<span class="keyword" id="5352399">return</span>&nbsp;<span class="ident" id="5352406">io</span><span class="op" id="5352408">.</span><span class="ident" id="5352409">NewSectionReader</span><span class="op" id="5352425">(</span><span class="ident" id="5352426">s</span><span class="op" id="5352427">.</span><span class="ident" id="5352428">sr</span><span class="op" id="5352430">,</span>&nbsp;<span class="num" id="5352432">0</span><span class="op" id="5352433">,</span>&nbsp;<span class="num" id="5352435">1</span><span class="op" id="5352436">&lt;&lt;</span><span class="num" id="5352438">63</span><span class="op" id="5352440">-</span><span class="num" id="5352441">1</span><span class="op" id="5352442">)</span>&nbsp;<span class="op" id="5352444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5352447">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5352503">type</span>&nbsp;<span class="ident" id="5352508">ProgHeader</span>&nbsp;<span class="keyword" id="5352519">struct</span>&nbsp;<span class="op" id="5352526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352529">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5352536">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352546">Flags</span>&nbsp;&nbsp;<span class="ident" id="5352553">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352563">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5352570">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352578">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="5352585">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352593">Paddr</span>&nbsp;&nbsp;<span class="ident" id="5352600">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352608">Filesz</span>&nbsp;<span class="ident" id="5352615">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352623">Memsz</span>&nbsp;&nbsp;<span class="ident" id="5352630">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352638">Align</span>&nbsp;&nbsp;<span class="ident" id="5352645">uint64</span><br>
<span class="lineno"></span><span class="op" id="5352652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5352655">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="5352722">type</span>&nbsp;<span class="ident" id="5352727">Prog</span>&nbsp;<span class="keyword" id="5352732">struct</span>&nbsp;<span class="op" id="5352739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352742">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5352755">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5352793">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5352833">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5352868">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5352916">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5352966">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5352990">io</span><span class="op" id="5352992">.</span><span class="ident" id="5352993">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353003">sr</span>&nbsp;<span class="op" id="5353006">*</span><span class="ident" id="5353007">io</span><span class="op" id="5353009">.</span><span class="ident" id="5353010">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5353024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5353027">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5353090">func</span>&nbsp;<span class="op" id="5353095">(</span><span class="ident" id="5353096">p</span>&nbsp;<span class="op" id="5353098">*</span><span class="ident" id="5353099">Prog</span><span class="op" id="5353103">)</span>&nbsp;<span class="ident" id="5353105">Open</span><span class="op" id="5353109">(</span><span class="op" id="5353110">)</span>&nbsp;<span class="ident" id="5353112">io</span><span class="op" id="5353114">.</span><span class="ident" id="5353115">ReadSeeker</span>&nbsp;<span class="op" id="5353126">{</span>&nbsp;<span class="keyword" id="5353128">return</span>&nbsp;<span class="ident" id="5353135">io</span><span class="op" id="5353137">.</span><span class="ident" id="5353138">NewSectionReader</span><span class="op" id="5353154">(</span><span class="ident" id="5353155">p</span><span class="op" id="5353156">.</span><span class="ident" id="5353157">sr</span><span class="op" id="5353159">,</span>&nbsp;<span class="num" id="5353161">0</span><span class="op" id="5353162">,</span>&nbsp;<span class="num" id="5353164">1</span><span class="op" id="5353165">&lt;&lt;</span><span class="num" id="5353167">63</span><span class="op" id="5353169">-</span><span class="num" id="5353170">1</span><span class="op" id="5353171">)</span>&nbsp;<span class="op" id="5353173">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5353176">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5353240">type</span>&nbsp;<span class="ident" id="5353245">Symbol</span>&nbsp;<span class="keyword" id="5353252">struct</span>&nbsp;<span class="op" id="5353259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353262">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5353274">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353282">Info</span><span class="op" id="5353286">,</span>&nbsp;<span class="ident" id="5353288">Other</span>&nbsp;<span class="builtintype" id="5353294">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353300">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5353312">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353326">Value</span><span class="op" id="5353331">,</span>&nbsp;<span class="ident" id="5353333">Size</span>&nbsp;<span class="ident" id="5353338">uint64</span><br>
<span class="lineno"></span><span class="op" id="5353345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5353348">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5353370">type</span>&nbsp;<span class="ident" id="5353375">FormatError</span>&nbsp;<span class="keyword" id="5353387">struct</span>&nbsp;<span class="op" id="5353394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353397">off</span>&nbsp;<span class="ident" id="5353401">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353408">msg</span>&nbsp;<span class="builtintype" id="5353412">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353420">val</span>&nbsp;<span class="keyword" id="5353424">interface</span><span class="op" id="5353433">{</span><span class="op" id="5353434">}</span><br>
<span class="lineno"></span><span class="op" id="5353436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5353439">func</span>&nbsp;<span class="op" id="5353444">(</span><span class="ident" id="5353445">e</span>&nbsp;<span class="op" id="5353447">*</span><span class="ident" id="5353448">FormatError</span><span class="op" id="5353459">)</span>&nbsp;<span class="ident" id="5353461">Error</span><span class="op" id="5353466">(</span><span class="op" id="5353467">)</span>&nbsp;<span class="builtintype" id="5353469">string</span>&nbsp;<span class="op" id="5353476">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353479">msg</span>&nbsp;<span class="op" id="5353483">:=</span>&nbsp;<span class="ident" id="5353486">e</span><span class="op" id="5353487">.</span><span class="ident" id="5353488">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353493">if</span>&nbsp;<span class="ident" id="5353496">e</span><span class="op" id="5353497">.</span><span class="ident" id="5353498">val</span>&nbsp;<span class="op" id="5353502">!=</span>&nbsp;<span class="ident" id="5353505">nil</span>&nbsp;<span class="op" id="5353509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353513">msg</span>&nbsp;<span class="op" id="5353517">+=</span>&nbsp;<span class="ident" id="5353520">fmt</span><span class="op" id="5353523">.</span><span class="ident" id="5353524">Sprintf</span><span class="op" id="5353531">(</span><span class="string" id="5353532">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="5353540">,</span>&nbsp;<span class="ident" id="5353542">e</span><span class="op" id="5353543">.</span><span class="ident" id="5353544">val</span><span class="op" id="5353547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5353550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353553">msg</span>&nbsp;<span class="op" id="5353557">+=</span>&nbsp;<span class="ident" id="5353560">fmt</span><span class="op" id="5353563">.</span><span class="ident" id="5353564">Sprintf</span><span class="op" id="5353571">(</span><span class="string" id="5353572">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5353595">,</span>&nbsp;<span class="ident" id="5353597">e</span><span class="op" id="5353598">.</span><span class="ident" id="5353599">off</span><span class="op" id="5353602">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353605">return</span>&nbsp;<span class="ident" id="5353612">msg</span><br>
<span class="lineno"></span><span class="op" id="5353616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5353619">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5353704">func</span>&nbsp;<span class="ident" id="5353709">Open</span><span class="op" id="5353713">(</span><span class="ident" id="5353714">name</span>&nbsp;<span class="builtintype" id="5353719">string</span><span class="op" id="5353725">)</span>&nbsp;<span class="op" id="5353727">(</span><span class="op" id="5353728">*</span><span class="ident" id="5353729">File</span><span class="op" id="5353733">,</span>&nbsp;<span class="builtintype" id="5353735">error</span><span class="op" id="5353740">)</span>&nbsp;<span class="op" id="5353742">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353745">f</span><span class="op" id="5353746">,</span>&nbsp;<span class="ident" id="5353748">err</span>&nbsp;<span class="op" id="5353752">:=</span>&nbsp;<span class="ident" id="5353755">os</span><span class="op" id="5353757">.</span><span class="ident" id="5353758">Open</span><span class="op" id="5353762">(</span><span class="ident" id="5353763">name</span><span class="op" id="5353767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353770">if</span>&nbsp;<span class="ident" id="5353773">err</span>&nbsp;<span class="op" id="5353777">!=</span>&nbsp;<span class="ident" id="5353780">nil</span>&nbsp;<span class="op" id="5353784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353788">return</span>&nbsp;<span class="ident" id="5353795">nil</span><span class="op" id="5353798">,</span>&nbsp;<span class="ident" id="5353800">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5353805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353808">ff</span><span class="op" id="5353810">,</span>&nbsp;<span class="ident" id="5353812">err</span>&nbsp;<span class="op" id="5353816">:=</span>&nbsp;<span class="ident" id="5353819">NewFile</span><span class="op" id="5353826">(</span><span class="ident" id="5353827">f</span><span class="op" id="5353828">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353831">if</span>&nbsp;<span class="ident" id="5353834">err</span>&nbsp;<span class="op" id="5353838">!=</span>&nbsp;<span class="ident" id="5353841">nil</span>&nbsp;<span class="op" id="5353845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353849">f</span><span class="op" id="5353850">.</span><span class="ident" id="5353851">Close</span><span class="op" id="5353856">(</span><span class="op" id="5353857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353861">return</span>&nbsp;<span class="ident" id="5353868">nil</span><span class="op" id="5353871">,</span>&nbsp;<span class="ident" id="5353873">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5353878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5353881">ff</span><span class="op" id="5353883">.</span><span class="ident" id="5353884">closer</span>&nbsp;<span class="op" id="5353891">=</span>&nbsp;<span class="ident" id="5353893">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5353896">return</span>&nbsp;<span class="ident" id="5353903">ff</span><span class="op" id="5353905">,</span>&nbsp;<span class="ident" id="5353907">nil</span><br>
<span class="lineno"></span><span class="op" id="5353911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5353914">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5353940">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="5354007">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5354031">func</span>&nbsp;<span class="op" id="5354036">(</span><span class="ident" id="5354037">f</span>&nbsp;<span class="op" id="5354039">*</span><span class="ident" id="5354040">File</span><span class="op" id="5354044">)</span>&nbsp;<span class="ident" id="5354046">Close</span><span class="op" id="5354051">(</span><span class="op" id="5354052">)</span>&nbsp;<span class="builtintype" id="5354054">error</span>&nbsp;<span class="op" id="5354060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354063">var</span>&nbsp;<span class="ident" id="5354067">err</span>&nbsp;<span class="builtintype" id="5354071">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354078">if</span>&nbsp;<span class="ident" id="5354081">f</span><span class="op" id="5354082">.</span><span class="ident" id="5354083">closer</span>&nbsp;<span class="op" id="5354090">!=</span>&nbsp;<span class="ident" id="5354093">nil</span>&nbsp;<span class="op" id="5354097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5354101">err</span>&nbsp;<span class="op" id="5354105">=</span>&nbsp;<span class="ident" id="5354107">f</span><span class="op" id="5354108">.</span><span class="ident" id="5354109">closer</span><span class="op" id="5354115">.</span><span class="ident" id="5354116">Close</span><span class="op" id="5354121">(</span><span class="op" id="5354122">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5354126">f</span><span class="op" id="5354127">.</span><span class="ident" id="5354128">closer</span>&nbsp;<span class="op" id="5354135">=</span>&nbsp;<span class="ident" id="5354137">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5354142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354145">return</span>&nbsp;<span class="ident" id="5354152">err</span><br>
<span class="lineno"></span><span class="op" id="5354156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="5354159">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5354216">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5354267">func</span>&nbsp;<span class="op" id="5354272">(</span><span class="ident" id="5354273">f</span>&nbsp;<span class="op" id="5354275">*</span><span class="ident" id="5354276">File</span><span class="op" id="5354280">)</span>&nbsp;<span class="ident" id="5354282">SectionByType</span><span class="op" id="5354295">(</span><span class="ident" id="5354296">typ</span>&nbsp;<span class="ident" id="5354300">SectionType</span><span class="op" id="5354311">)</span>&nbsp;<span class="op" id="5354313">*</span><span class="ident" id="5354314">Section</span>&nbsp;<span class="op" id="5354322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354325">for</span>&nbsp;<span class="ident" id="5354329">_</span><span class="op" id="5354330">,</span>&nbsp;<span class="ident" id="5354332">s</span>&nbsp;<span class="op" id="5354334">:=</span>&nbsp;<span class="keyword" id="5354337">range</span>&nbsp;<span class="ident" id="5354343">f</span><span class="op" id="5354344">.</span><span class="ident" id="5354345">Sections</span>&nbsp;<span class="op" id="5354354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354358">if</span>&nbsp;<span class="ident" id="5354361">s</span><span class="op" id="5354362">.</span><span class="ident" id="5354363">Type</span>&nbsp;<span class="op" id="5354368">==</span>&nbsp;<span class="ident" id="5354371">typ</span>&nbsp;<span class="op" id="5354375">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354380">return</span>&nbsp;<span class="ident" id="5354387">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5354391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5354394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354397">return</span>&nbsp;<span class="ident" id="5354404">nil</span><br>
<span class="lineno"></span><span class="op" id="5354408">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5354411">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="5354494">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="5354564">func</span>&nbsp;<span class="ident" id="5354569">NewFile</span><span class="op" id="5354576">(</span><span class="ident" id="5354577">r</span>&nbsp;<span class="ident" id="5354579">io</span><span class="op" id="5354581">.</span><span class="ident" id="5354582">ReaderAt</span><span class="op" id="5354590">)</span>&nbsp;<span class="op" id="5354592">(</span><span class="op" id="5354593">*</span><span class="ident" id="5354594">File</span><span class="op" id="5354598">,</span>&nbsp;<span class="builtintype" id="5354600">error</span><span class="op" id="5354605">)</span>&nbsp;<span class="op" id="5354607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5354610">sr</span>&nbsp;<span class="op" id="5354613">:=</span>&nbsp;<span class="ident" id="5354616">io</span><span class="op" id="5354618">.</span><span class="ident" id="5354619">NewSectionReader</span><span class="op" id="5354635">(</span><span class="ident" id="5354636">r</span><span class="op" id="5354637">,</span>&nbsp;<span class="num" id="5354639">0</span><span class="op" id="5354640">,</span>&nbsp;<span class="num" id="5354642">1</span><span class="op" id="5354643">&lt;&lt;</span><span class="num" id="5354645">63</span><span class="op" id="5354647">-</span><span class="num" id="5354648">1</span><span class="op" id="5354649">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5354652">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354687">var</span>&nbsp;<span class="ident" id="5354691">ident</span>&nbsp;<span class="op" id="5354697">[</span><span class="num" id="5354698">16</span><span class="op" id="5354700">]</span><span class="builtintype" id="5354701">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354708">if</span>&nbsp;<span class="ident" id="5354711">_</span><span class="op" id="5354712">,</span>&nbsp;<span class="ident" id="5354714">err</span>&nbsp;<span class="op" id="5354718">:=</span>&nbsp;<span class="ident" id="5354721">r</span><span class="op" id="5354722">.</span><span class="ident" id="5354723">ReadAt</span><span class="op" id="5354729">(</span><span class="ident" id="5354730">ident</span><span class="op" id="5354735">[</span><span class="num" id="5354736">0</span><span class="op" id="5354737">:</span><span class="op" id="5354738">]</span><span class="op" id="5354739">,</span>&nbsp;<span class="num" id="5354741">0</span><span class="op" id="5354742">)</span><span class="op" id="5354743">;</span>&nbsp;<span class="ident" id="5354745">err</span>&nbsp;<span class="op" id="5354749">!=</span>&nbsp;<span class="ident" id="5354752">nil</span>&nbsp;<span class="op" id="5354756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354760">return</span>&nbsp;<span class="ident" id="5354767">nil</span><span class="op" id="5354770">,</span>&nbsp;<span class="ident" id="5354772">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5354777">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354780">if</span>&nbsp;<span class="ident" id="5354783">ident</span><span class="op" id="5354788">[</span><span class="num" id="5354789">0</span><span class="op" id="5354790">]</span>&nbsp;<span class="op" id="5354792">!=</span>&nbsp;<span class="string" id="5354795">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="5354802">||</span>&nbsp;<span class="ident" id="5354805">ident</span><span class="op" id="5354810">[</span><span class="num" id="5354811">1</span><span class="op" id="5354812">]</span>&nbsp;<span class="op" id="5354814">!=</span>&nbsp;<span class="string" id="5354817">&#39;E&#39;</span>&nbsp;<span class="op" id="5354821">||</span>&nbsp;<span class="ident" id="5354824">ident</span><span class="op" id="5354829">[</span><span class="num" id="5354830">2</span><span class="op" id="5354831">]</span>&nbsp;<span class="op" id="5354833">!=</span>&nbsp;<span class="string" id="5354836">&#39;L&#39;</span>&nbsp;<span class="op" id="5354840">||</span>&nbsp;<span class="ident" id="5354843">ident</span><span class="op" id="5354848">[</span><span class="num" id="5354849">3</span><span class="op" id="5354850">]</span>&nbsp;<span class="op" id="5354852">!=</span>&nbsp;<span class="string" id="5354855">&#39;F&#39;</span>&nbsp;<span class="op" id="5354859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354863">return</span>&nbsp;<span class="ident" id="5354870">nil</span><span class="op" id="5354873">,</span>&nbsp;<span class="op" id="5354875">&amp;</span><span class="ident" id="5354876">FormatError</span><span class="op" id="5354887">{</span><span class="num" id="5354888">0</span><span class="op" id="5354889">,</span>&nbsp;<span class="string" id="5354891">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="5354909">,</span>&nbsp;<span class="ident" id="5354911">ident</span><span class="op" id="5354916">[</span><span class="num" id="5354917">0</span><span class="op" id="5354918">:</span><span class="num" id="5354919">4</span><span class="op" id="5354920">]</span><span class="op" id="5354921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5354924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5354928">f</span>&nbsp;<span class="op" id="5354930">:=</span>&nbsp;<span class="builtinfunc" id="5354933">new</span><span class="op" id="5354936">(</span><span class="ident" id="5354937">File</span><span class="op" id="5354941">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5354944">f</span><span class="op" id="5354945">.</span><span class="ident" id="5354946">Class</span>&nbsp;<span class="op" id="5354952">=</span>&nbsp;<span class="ident" id="5354954">Class</span><span class="op" id="5354959">(</span><span class="ident" id="5354960">ident</span><span class="op" id="5354965">[</span><span class="ident" id="5354966">EI_CLASS</span><span class="op" id="5354974">]</span><span class="op" id="5354975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354978">switch</span>&nbsp;<span class="ident" id="5354985">f</span><span class="op" id="5354986">.</span><span class="ident" id="5354987">Class</span>&nbsp;<span class="op" id="5354993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5354996">case</span>&nbsp;<span class="ident" id="5355001">ELFCLASS32</span><span class="op" id="5355011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355014">case</span>&nbsp;<span class="ident" id="5355019">ELFCLASS64</span><span class="op" id="5355029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5355033">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355040">default</span><span class="op" id="5355047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355051">return</span>&nbsp;<span class="ident" id="5355058">nil</span><span class="op" id="5355061">,</span>&nbsp;<span class="op" id="5355063">&amp;</span><span class="ident" id="5355064">FormatError</span><span class="op" id="5355075">{</span><span class="num" id="5355076">0</span><span class="op" id="5355077">,</span>&nbsp;<span class="string" id="5355079">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="5355098">,</span>&nbsp;<span class="ident" id="5355100">f</span><span class="op" id="5355101">.</span><span class="ident" id="5355102">Class</span><span class="op" id="5355107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5355110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355114">f</span><span class="op" id="5355115">.</span><span class="ident" id="5355116">Data</span>&nbsp;<span class="op" id="5355121">=</span>&nbsp;<span class="ident" id="5355123">Data</span><span class="op" id="5355127">(</span><span class="ident" id="5355128">ident</span><span class="op" id="5355133">[</span><span class="ident" id="5355134">EI_DATA</span><span class="op" id="5355141">]</span><span class="op" id="5355142">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355145">switch</span>&nbsp;<span class="ident" id="5355152">f</span><span class="op" id="5355153">.</span><span class="ident" id="5355154">Data</span>&nbsp;<span class="op" id="5355159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355162">case</span>&nbsp;<span class="ident" id="5355167">ELFDATA2LSB</span><span class="op" id="5355178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355182">f</span><span class="op" id="5355183">.</span><span class="ident" id="5355184">ByteOrder</span>&nbsp;<span class="op" id="5355194">=</span>&nbsp;<span class="ident" id="5355196">binary</span><span class="op" id="5355202">.</span><span class="ident" id="5355203">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355217">case</span>&nbsp;<span class="ident" id="5355222">ELFDATA2MSB</span><span class="op" id="5355233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355237">f</span><span class="op" id="5355238">.</span><span class="ident" id="5355239">ByteOrder</span>&nbsp;<span class="op" id="5355249">=</span>&nbsp;<span class="ident" id="5355251">binary</span><span class="op" id="5355257">.</span><span class="ident" id="5355258">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355269">default</span><span class="op" id="5355276">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355280">return</span>&nbsp;<span class="ident" id="5355287">nil</span><span class="op" id="5355290">,</span>&nbsp;<span class="op" id="5355292">&amp;</span><span class="ident" id="5355293">FormatError</span><span class="op" id="5355304">{</span><span class="num" id="5355305">0</span><span class="op" id="5355306">,</span>&nbsp;<span class="string" id="5355308">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="5355335">,</span>&nbsp;<span class="ident" id="5355337">f</span><span class="op" id="5355338">.</span><span class="ident" id="5355339">Data</span><span class="op" id="5355343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5355346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355350">f</span><span class="op" id="5355351">.</span><span class="ident" id="5355352">Version</span>&nbsp;<span class="op" id="5355360">=</span>&nbsp;<span class="ident" id="5355362">Version</span><span class="op" id="5355369">(</span><span class="ident" id="5355370">ident</span><span class="op" id="5355375">[</span><span class="ident" id="5355376">EI_VERSION</span><span class="op" id="5355386">]</span><span class="op" id="5355387">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355390">if</span>&nbsp;<span class="ident" id="5355393">f</span><span class="op" id="5355394">.</span><span class="ident" id="5355395">Version</span>&nbsp;<span class="op" id="5355403">!=</span>&nbsp;<span class="ident" id="5355406">EV_CURRENT</span>&nbsp;<span class="op" id="5355417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355421">return</span>&nbsp;<span class="ident" id="5355428">nil</span><span class="op" id="5355431">,</span>&nbsp;<span class="op" id="5355433">&amp;</span><span class="ident" id="5355434">FormatError</span><span class="op" id="5355445">{</span><span class="num" id="5355446">0</span><span class="op" id="5355447">,</span>&nbsp;<span class="string" id="5355449">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5355470">,</span>&nbsp;<span class="ident" id="5355472">f</span><span class="op" id="5355473">.</span><span class="ident" id="5355474">Version</span><span class="op" id="5355481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5355484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355488">f</span><span class="op" id="5355489">.</span><span class="ident" id="5355490">OSABI</span>&nbsp;<span class="op" id="5355496">=</span>&nbsp;<span class="ident" id="5355498">OSABI</span><span class="op" id="5355503">(</span><span class="ident" id="5355504">ident</span><span class="op" id="5355509">[</span><span class="ident" id="5355510">EI_OSABI</span><span class="op" id="5355518">]</span><span class="op" id="5355519">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355522">f</span><span class="op" id="5355523">.</span><span class="ident" id="5355524">ABIVersion</span>&nbsp;<span class="op" id="5355535">=</span>&nbsp;<span class="ident" id="5355537">ident</span><span class="op" id="5355542">[</span><span class="ident" id="5355543">EI_ABIVERSION</span><span class="op" id="5355556">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5355560">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355585">var</span>&nbsp;<span class="ident" id="5355589">phoff</span>&nbsp;<span class="ident" id="5355595">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355602">var</span>&nbsp;<span class="ident" id="5355606">phentsize</span><span class="op" id="5355615">,</span>&nbsp;<span class="ident" id="5355617">phnum</span>&nbsp;<span class="builtintype" id="5355623">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355628">var</span>&nbsp;<span class="ident" id="5355632">shoff</span>&nbsp;<span class="ident" id="5355638">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355645">var</span>&nbsp;<span class="ident" id="5355649">shentsize</span><span class="op" id="5355658">,</span>&nbsp;<span class="ident" id="5355660">shnum</span><span class="op" id="5355665">,</span>&nbsp;<span class="ident" id="5355667">shstrndx</span>&nbsp;<span class="builtintype" id="5355676">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355681">shstrndx</span>&nbsp;<span class="op" id="5355690">=</span>&nbsp;<span class="op" id="5355692">-</span><span class="num" id="5355693">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355696">switch</span>&nbsp;<span class="ident" id="5355703">f</span><span class="op" id="5355704">.</span><span class="ident" id="5355705">Class</span>&nbsp;<span class="op" id="5355711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355714">case</span>&nbsp;<span class="ident" id="5355719">ELFCLASS32</span><span class="op" id="5355729">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355733">hdr</span>&nbsp;<span class="op" id="5355737">:=</span>&nbsp;<span class="builtinfunc" id="5355740">new</span><span class="op" id="5355743">(</span><span class="ident" id="5355744">Header32</span><span class="op" id="5355752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355756">sr</span><span class="op" id="5355758">.</span><span class="ident" id="5355759">Seek</span><span class="op" id="5355763">(</span><span class="num" id="5355764">0</span><span class="op" id="5355765">,</span>&nbsp;<span class="ident" id="5355767">os</span><span class="op" id="5355769">.</span><span class="ident" id="5355770">SEEK_SET</span><span class="op" id="5355778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355782">if</span>&nbsp;<span class="ident" id="5355785">err</span>&nbsp;<span class="op" id="5355789">:=</span>&nbsp;<span class="ident" id="5355792">binary</span><span class="op" id="5355798">.</span><span class="ident" id="5355799">Read</span><span class="op" id="5355803">(</span><span class="ident" id="5355804">sr</span><span class="op" id="5355806">,</span>&nbsp;<span class="ident" id="5355808">f</span><span class="op" id="5355809">.</span><span class="ident" id="5355810">ByteOrder</span><span class="op" id="5355819">,</span>&nbsp;<span class="ident" id="5355821">hdr</span><span class="op" id="5355824">)</span><span class="op" id="5355825">;</span>&nbsp;<span class="ident" id="5355827">err</span>&nbsp;<span class="op" id="5355831">!=</span>&nbsp;<span class="ident" id="5355834">nil</span>&nbsp;<span class="op" id="5355838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355843">return</span>&nbsp;<span class="ident" id="5355850">nil</span><span class="op" id="5355853">,</span>&nbsp;<span class="ident" id="5355855">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5355861">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355865">f</span><span class="op" id="5355866">.</span><span class="ident" id="5355867">Type</span>&nbsp;<span class="op" id="5355872">=</span>&nbsp;<span class="ident" id="5355874">Type</span><span class="op" id="5355878">(</span><span class="ident" id="5355879">hdr</span><span class="op" id="5355882">.</span><span class="ident" id="5355883">Type</span><span class="op" id="5355887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355891">f</span><span class="op" id="5355892">.</span><span class="ident" id="5355893">Machine</span>&nbsp;<span class="op" id="5355901">=</span>&nbsp;<span class="ident" id="5355903">Machine</span><span class="op" id="5355910">(</span><span class="ident" id="5355911">hdr</span><span class="op" id="5355914">.</span><span class="ident" id="5355915">Machine</span><span class="op" id="5355922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5355926">f</span><span class="op" id="5355927">.</span><span class="ident" id="5355928">Entry</span>&nbsp;<span class="op" id="5355934">=</span>&nbsp;<span class="ident" id="5355936">uint64</span><span class="op" id="5355942">(</span><span class="ident" id="5355943">hdr</span><span class="op" id="5355946">.</span><span class="ident" id="5355947">Entry</span><span class="op" id="5355952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5355956">if</span>&nbsp;<span class="ident" id="5355959">v</span>&nbsp;<span class="op" id="5355961">:=</span>&nbsp;<span class="ident" id="5355964">Version</span><span class="op" id="5355971">(</span><span class="ident" id="5355972">hdr</span><span class="op" id="5355975">.</span><span class="ident" id="5355976">Version</span><span class="op" id="5355983">)</span><span class="op" id="5355984">;</span>&nbsp;<span class="ident" id="5355986">v</span>&nbsp;<span class="op" id="5355988">!=</span>&nbsp;<span class="ident" id="5355991">f</span><span class="op" id="5355992">.</span><span class="ident" id="5355993">Version</span>&nbsp;<span class="op" id="5356001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356006">return</span>&nbsp;<span class="ident" id="5356013">nil</span><span class="op" id="5356016">,</span>&nbsp;<span class="op" id="5356018">&amp;</span><span class="ident" id="5356019">FormatError</span><span class="op" id="5356030">{</span><span class="num" id="5356031">0</span><span class="op" id="5356032">,</span>&nbsp;<span class="string" id="5356034">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5356058">,</span>&nbsp;<span class="ident" id="5356060">v</span><span class="op" id="5356061">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5356065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356069">phoff</span>&nbsp;<span class="op" id="5356075">=</span>&nbsp;<span class="ident" id="5356077">int64</span><span class="op" id="5356082">(</span><span class="ident" id="5356083">hdr</span><span class="op" id="5356086">.</span><span class="ident" id="5356087">Phoff</span><span class="op" id="5356092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356096">phentsize</span>&nbsp;<span class="op" id="5356106">=</span>&nbsp;<span class="builtintype" id="5356108">int</span><span class="op" id="5356111">(</span><span class="ident" id="5356112">hdr</span><span class="op" id="5356115">.</span><span class="ident" id="5356116">Phentsize</span><span class="op" id="5356125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356129">phnum</span>&nbsp;<span class="op" id="5356135">=</span>&nbsp;<span class="builtintype" id="5356137">int</span><span class="op" id="5356140">(</span><span class="ident" id="5356141">hdr</span><span class="op" id="5356144">.</span><span class="ident" id="5356145">Phnum</span><span class="op" id="5356150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356154">shoff</span>&nbsp;<span class="op" id="5356160">=</span>&nbsp;<span class="ident" id="5356162">int64</span><span class="op" id="5356167">(</span><span class="ident" id="5356168">hdr</span><span class="op" id="5356171">.</span><span class="ident" id="5356172">Shoff</span><span class="op" id="5356177">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356181">shentsize</span>&nbsp;<span class="op" id="5356191">=</span>&nbsp;<span class="builtintype" id="5356193">int</span><span class="op" id="5356196">(</span><span class="ident" id="5356197">hdr</span><span class="op" id="5356200">.</span><span class="ident" id="5356201">Shentsize</span><span class="op" id="5356210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356214">shnum</span>&nbsp;<span class="op" id="5356220">=</span>&nbsp;<span class="builtintype" id="5356222">int</span><span class="op" id="5356225">(</span><span class="ident" id="5356226">hdr</span><span class="op" id="5356229">.</span><span class="ident" id="5356230">Shnum</span><span class="op" id="5356235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356239">shstrndx</span>&nbsp;<span class="op" id="5356248">=</span>&nbsp;<span class="builtintype" id="5356250">int</span><span class="op" id="5356253">(</span><span class="ident" id="5356254">hdr</span><span class="op" id="5356257">.</span><span class="ident" id="5356258">Shstrndx</span><span class="op" id="5356266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356269">case</span>&nbsp;<span class="ident" id="5356274">ELFCLASS64</span><span class="op" id="5356284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356288">hdr</span>&nbsp;<span class="op" id="5356292">:=</span>&nbsp;<span class="builtinfunc" id="5356295">new</span><span class="op" id="5356298">(</span><span class="ident" id="5356299">Header64</span><span class="op" id="5356307">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356311">sr</span><span class="op" id="5356313">.</span><span class="ident" id="5356314">Seek</span><span class="op" id="5356318">(</span><span class="num" id="5356319">0</span><span class="op" id="5356320">,</span>&nbsp;<span class="ident" id="5356322">os</span><span class="op" id="5356324">.</span><span class="ident" id="5356325">SEEK_SET</span><span class="op" id="5356333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356337">if</span>&nbsp;<span class="ident" id="5356340">err</span>&nbsp;<span class="op" id="5356344">:=</span>&nbsp;<span class="ident" id="5356347">binary</span><span class="op" id="5356353">.</span><span class="ident" id="5356354">Read</span><span class="op" id="5356358">(</span><span class="ident" id="5356359">sr</span><span class="op" id="5356361">,</span>&nbsp;<span class="ident" id="5356363">f</span><span class="op" id="5356364">.</span><span class="ident" id="5356365">ByteOrder</span><span class="op" id="5356374">,</span>&nbsp;<span class="ident" id="5356376">hdr</span><span class="op" id="5356379">)</span><span class="op" id="5356380">;</span>&nbsp;<span class="ident" id="5356382">err</span>&nbsp;<span class="op" id="5356386">!=</span>&nbsp;<span class="ident" id="5356389">nil</span>&nbsp;<span class="op" id="5356393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356398">return</span>&nbsp;<span class="ident" id="5356405">nil</span><span class="op" id="5356408">,</span>&nbsp;<span class="ident" id="5356410">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5356416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356420">f</span><span class="op" id="5356421">.</span><span class="ident" id="5356422">Type</span>&nbsp;<span class="op" id="5356427">=</span>&nbsp;<span class="ident" id="5356429">Type</span><span class="op" id="5356433">(</span><span class="ident" id="5356434">hdr</span><span class="op" id="5356437">.</span><span class="ident" id="5356438">Type</span><span class="op" id="5356442">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356446">f</span><span class="op" id="5356447">.</span><span class="ident" id="5356448">Machine</span>&nbsp;<span class="op" id="5356456">=</span>&nbsp;<span class="ident" id="5356458">Machine</span><span class="op" id="5356465">(</span><span class="ident" id="5356466">hdr</span><span class="op" id="5356469">.</span><span class="ident" id="5356470">Machine</span><span class="op" id="5356477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356481">f</span><span class="op" id="5356482">.</span><span class="ident" id="5356483">Entry</span>&nbsp;<span class="op" id="5356489">=</span>&nbsp;<span class="ident" id="5356491">uint64</span><span class="op" id="5356497">(</span><span class="ident" id="5356498">hdr</span><span class="op" id="5356501">.</span><span class="ident" id="5356502">Entry</span><span class="op" id="5356507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356511">if</span>&nbsp;<span class="ident" id="5356514">v</span>&nbsp;<span class="op" id="5356516">:=</span>&nbsp;<span class="ident" id="5356519">Version</span><span class="op" id="5356526">(</span><span class="ident" id="5356527">hdr</span><span class="op" id="5356530">.</span><span class="ident" id="5356531">Version</span><span class="op" id="5356538">)</span><span class="op" id="5356539">;</span>&nbsp;<span class="ident" id="5356541">v</span>&nbsp;<span class="op" id="5356543">!=</span>&nbsp;<span class="ident" id="5356546">f</span><span class="op" id="5356547">.</span><span class="ident" id="5356548">Version</span>&nbsp;<span class="op" id="5356556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356561">return</span>&nbsp;<span class="ident" id="5356568">nil</span><span class="op" id="5356571">,</span>&nbsp;<span class="op" id="5356573">&amp;</span><span class="ident" id="5356574">FormatError</span><span class="op" id="5356585">{</span><span class="num" id="5356586">0</span><span class="op" id="5356587">,</span>&nbsp;<span class="string" id="5356589">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5356613">,</span>&nbsp;<span class="ident" id="5356615">v</span><span class="op" id="5356616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5356620">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356624">phoff</span>&nbsp;<span class="op" id="5356630">=</span>&nbsp;<span class="ident" id="5356632">int64</span><span class="op" id="5356637">(</span><span class="ident" id="5356638">hdr</span><span class="op" id="5356641">.</span><span class="ident" id="5356642">Phoff</span><span class="op" id="5356647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356651">phentsize</span>&nbsp;<span class="op" id="5356661">=</span>&nbsp;<span class="builtintype" id="5356663">int</span><span class="op" id="5356666">(</span><span class="ident" id="5356667">hdr</span><span class="op" id="5356670">.</span><span class="ident" id="5356671">Phentsize</span><span class="op" id="5356680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356684">phnum</span>&nbsp;<span class="op" id="5356690">=</span>&nbsp;<span class="builtintype" id="5356692">int</span><span class="op" id="5356695">(</span><span class="ident" id="5356696">hdr</span><span class="op" id="5356699">.</span><span class="ident" id="5356700">Phnum</span><span class="op" id="5356705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356709">shoff</span>&nbsp;<span class="op" id="5356715">=</span>&nbsp;<span class="ident" id="5356717">int64</span><span class="op" id="5356722">(</span><span class="ident" id="5356723">hdr</span><span class="op" id="5356726">.</span><span class="ident" id="5356727">Shoff</span><span class="op" id="5356732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356736">shentsize</span>&nbsp;<span class="op" id="5356746">=</span>&nbsp;<span class="builtintype" id="5356748">int</span><span class="op" id="5356751">(</span><span class="ident" id="5356752">hdr</span><span class="op" id="5356755">.</span><span class="ident" id="5356756">Shentsize</span><span class="op" id="5356765">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356769">shnum</span>&nbsp;<span class="op" id="5356775">=</span>&nbsp;<span class="builtintype" id="5356777">int</span><span class="op" id="5356780">(</span><span class="ident" id="5356781">hdr</span><span class="op" id="5356784">.</span><span class="ident" id="5356785">Shnum</span><span class="op" id="5356790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356794">shstrndx</span>&nbsp;<span class="op" id="5356803">=</span>&nbsp;<span class="builtintype" id="5356805">int</span><span class="op" id="5356808">(</span><span class="ident" id="5356809">hdr</span><span class="op" id="5356812">.</span><span class="ident" id="5356813">Shstrndx</span><span class="op" id="5356821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5356824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356828">if</span>&nbsp;<span class="ident" id="5356831">shnum</span>&nbsp;<span class="op" id="5356837">&gt;</span>&nbsp;<span class="num" id="5356839">0</span>&nbsp;<span class="op" id="5356841">&amp;&amp;</span>&nbsp;<span class="ident" id="5356844">shoff</span>&nbsp;<span class="op" id="5356850">&gt;</span>&nbsp;<span class="num" id="5356852">0</span>&nbsp;<span class="op" id="5356854">&amp;&amp;</span>&nbsp;<span class="op" id="5356857">(</span><span class="ident" id="5356858">shstrndx</span>&nbsp;<span class="op" id="5356867">&lt;</span>&nbsp;<span class="num" id="5356869">0</span>&nbsp;<span class="op" id="5356871">||</span>&nbsp;<span class="ident" id="5356874">shstrndx</span>&nbsp;<span class="op" id="5356883">&gt;=</span>&nbsp;<span class="ident" id="5356886">shnum</span><span class="op" id="5356891">)</span>&nbsp;<span class="op" id="5356893">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5356897">return</span>&nbsp;<span class="ident" id="5356904">nil</span><span class="op" id="5356907">,</span>&nbsp;<span class="op" id="5356909">&amp;</span><span class="ident" id="5356910">FormatError</span><span class="op" id="5356921">{</span><span class="num" id="5356922">0</span><span class="op" id="5356923">,</span>&nbsp;<span class="string" id="5356925">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="5356947">,</span>&nbsp;<span class="ident" id="5356949">shstrndx</span><span class="op" id="5356957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5356960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5356964">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5356989">f</span><span class="op" id="5356990">.</span><span class="ident" id="5356991">Progs</span>&nbsp;<span class="op" id="5356997">=</span>&nbsp;<span class="builtinfunc" id="5356999">make</span><span class="op" id="5357003">(</span><span class="op" id="5357004">[</span><span class="op" id="5357005">]</span><span class="op" id="5357006">*</span><span class="ident" id="5357007">Prog</span><span class="op" id="5357011">,</span>&nbsp;<span class="ident" id="5357013">phnum</span><span class="op" id="5357018">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357021">for</span>&nbsp;<span class="ident" id="5357025">i</span>&nbsp;<span class="op" id="5357027">:=</span>&nbsp;<span class="num" id="5357030">0</span><span class="op" id="5357031">;</span>&nbsp;<span class="ident" id="5357033">i</span>&nbsp;<span class="op" id="5357035">&lt;</span>&nbsp;<span class="ident" id="5357037">phnum</span><span class="op" id="5357042">;</span>&nbsp;<span class="ident" id="5357044">i</span><span class="op" id="5357045">++</span>&nbsp;<span class="op" id="5357048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357052">off</span>&nbsp;<span class="op" id="5357056">:=</span>&nbsp;<span class="ident" id="5357059">phoff</span>&nbsp;<span class="op" id="5357065">+</span>&nbsp;<span class="ident" id="5357067">int64</span><span class="op" id="5357072">(</span><span class="ident" id="5357073">i</span><span class="op" id="5357074">)</span><span class="op" id="5357075">*</span><span class="ident" id="5357076">int64</span><span class="op" id="5357081">(</span><span class="ident" id="5357082">phentsize</span><span class="op" id="5357091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357095">sr</span><span class="op" id="5357097">.</span><span class="ident" id="5357098">Seek</span><span class="op" id="5357102">(</span><span class="ident" id="5357103">off</span><span class="op" id="5357106">,</span>&nbsp;<span class="ident" id="5357108">os</span><span class="op" id="5357110">.</span><span class="ident" id="5357111">SEEK_SET</span><span class="op" id="5357119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357123">p</span>&nbsp;<span class="op" id="5357125">:=</span>&nbsp;<span class="builtinfunc" id="5357128">new</span><span class="op" id="5357131">(</span><span class="ident" id="5357132">Prog</span><span class="op" id="5357136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357140">switch</span>&nbsp;<span class="ident" id="5357147">f</span><span class="op" id="5357148">.</span><span class="ident" id="5357149">Class</span>&nbsp;<span class="op" id="5357155">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357159">case</span>&nbsp;<span class="ident" id="5357164">ELFCLASS32</span><span class="op" id="5357174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357179">ph</span>&nbsp;<span class="op" id="5357182">:=</span>&nbsp;<span class="builtinfunc" id="5357185">new</span><span class="op" id="5357188">(</span><span class="ident" id="5357189">Prog32</span><span class="op" id="5357195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357200">if</span>&nbsp;<span class="ident" id="5357203">err</span>&nbsp;<span class="op" id="5357207">:=</span>&nbsp;<span class="ident" id="5357210">binary</span><span class="op" id="5357216">.</span><span class="ident" id="5357217">Read</span><span class="op" id="5357221">(</span><span class="ident" id="5357222">sr</span><span class="op" id="5357224">,</span>&nbsp;<span class="ident" id="5357226">f</span><span class="op" id="5357227">.</span><span class="ident" id="5357228">ByteOrder</span><span class="op" id="5357237">,</span>&nbsp;<span class="ident" id="5357239">ph</span><span class="op" id="5357241">)</span><span class="op" id="5357242">;</span>&nbsp;<span class="ident" id="5357244">err</span>&nbsp;<span class="op" id="5357248">!=</span>&nbsp;<span class="ident" id="5357251">nil</span>&nbsp;<span class="op" id="5357255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357261">return</span>&nbsp;<span class="ident" id="5357268">nil</span><span class="op" id="5357271">,</span>&nbsp;<span class="ident" id="5357273">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5357280">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357285">p</span><span class="op" id="5357286">.</span><span class="ident" id="5357287">ProgHeader</span>&nbsp;<span class="op" id="5357298">=</span>&nbsp;<span class="ident" id="5357300">ProgHeader</span><span class="op" id="5357310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357316">Type</span><span class="op" id="5357320">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5357324">ProgType</span><span class="op" id="5357332">(</span><span class="ident" id="5357333">ph</span><span class="op" id="5357335">.</span><span class="ident" id="5357336">Type</span><span class="op" id="5357340">)</span><span class="op" id="5357341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357347">Flags</span><span class="op" id="5357352">:</span>&nbsp;&nbsp;<span class="ident" id="5357355">ProgFlag</span><span class="op" id="5357363">(</span><span class="ident" id="5357364">ph</span><span class="op" id="5357366">.</span><span class="ident" id="5357367">Flags</span><span class="op" id="5357372">)</span><span class="op" id="5357373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357379">Off</span><span class="op" id="5357382">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5357387">uint64</span><span class="op" id="5357393">(</span><span class="ident" id="5357394">ph</span><span class="op" id="5357396">.</span><span class="ident" id="5357397">Off</span><span class="op" id="5357400">)</span><span class="op" id="5357401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357407">Vaddr</span><span class="op" id="5357412">:</span>&nbsp;&nbsp;<span class="ident" id="5357415">uint64</span><span class="op" id="5357421">(</span><span class="ident" id="5357422">ph</span><span class="op" id="5357424">.</span><span class="ident" id="5357425">Vaddr</span><span class="op" id="5357430">)</span><span class="op" id="5357431">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357437">Paddr</span><span class="op" id="5357442">:</span>&nbsp;&nbsp;<span class="ident" id="5357445">uint64</span><span class="op" id="5357451">(</span><span class="ident" id="5357452">ph</span><span class="op" id="5357454">.</span><span class="ident" id="5357455">Paddr</span><span class="op" id="5357460">)</span><span class="op" id="5357461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357467">Filesz</span><span class="op" id="5357473">:</span>&nbsp;<span class="ident" id="5357475">uint64</span><span class="op" id="5357481">(</span><span class="ident" id="5357482">ph</span><span class="op" id="5357484">.</span><span class="ident" id="5357485">Filesz</span><span class="op" id="5357491">)</span><span class="op" id="5357492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357498">Memsz</span><span class="op" id="5357503">:</span>&nbsp;&nbsp;<span class="ident" id="5357506">uint64</span><span class="op" id="5357512">(</span><span class="ident" id="5357513">ph</span><span class="op" id="5357515">.</span><span class="ident" id="5357516">Memsz</span><span class="op" id="5357521">)</span><span class="op" id="5357522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357528">Align</span><span class="op" id="5357533">:</span>&nbsp;&nbsp;<span class="ident" id="5357536">uint64</span><span class="op" id="5357542">(</span><span class="ident" id="5357543">ph</span><span class="op" id="5357545">.</span><span class="ident" id="5357546">Align</span><span class="op" id="5357551">)</span><span class="op" id="5357552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5357557">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357561">case</span>&nbsp;<span class="ident" id="5357566">ELFCLASS64</span><span class="op" id="5357576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357581">ph</span>&nbsp;<span class="op" id="5357584">:=</span>&nbsp;<span class="builtinfunc" id="5357587">new</span><span class="op" id="5357590">(</span><span class="ident" id="5357591">Prog64</span><span class="op" id="5357597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357602">if</span>&nbsp;<span class="ident" id="5357605">err</span>&nbsp;<span class="op" id="5357609">:=</span>&nbsp;<span class="ident" id="5357612">binary</span><span class="op" id="5357618">.</span><span class="ident" id="5357619">Read</span><span class="op" id="5357623">(</span><span class="ident" id="5357624">sr</span><span class="op" id="5357626">,</span>&nbsp;<span class="ident" id="5357628">f</span><span class="op" id="5357629">.</span><span class="ident" id="5357630">ByteOrder</span><span class="op" id="5357639">,</span>&nbsp;<span class="ident" id="5357641">ph</span><span class="op" id="5357643">)</span><span class="op" id="5357644">;</span>&nbsp;<span class="ident" id="5357646">err</span>&nbsp;<span class="op" id="5357650">!=</span>&nbsp;<span class="ident" id="5357653">nil</span>&nbsp;<span class="op" id="5357657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5357663">return</span>&nbsp;<span class="ident" id="5357670">nil</span><span class="op" id="5357673">,</span>&nbsp;<span class="ident" id="5357675">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5357682">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357687">p</span><span class="op" id="5357688">.</span><span class="ident" id="5357689">ProgHeader</span>&nbsp;<span class="op" id="5357700">=</span>&nbsp;<span class="ident" id="5357702">ProgHeader</span><span class="op" id="5357712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357718">Type</span><span class="op" id="5357722">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5357726">ProgType</span><span class="op" id="5357734">(</span><span class="ident" id="5357735">ph</span><span class="op" id="5357737">.</span><span class="ident" id="5357738">Type</span><span class="op" id="5357742">)</span><span class="op" id="5357743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357749">Flags</span><span class="op" id="5357754">:</span>&nbsp;&nbsp;<span class="ident" id="5357757">ProgFlag</span><span class="op" id="5357765">(</span><span class="ident" id="5357766">ph</span><span class="op" id="5357768">.</span><span class="ident" id="5357769">Flags</span><span class="op" id="5357774">)</span><span class="op" id="5357775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357781">Off</span><span class="op" id="5357784">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5357789">uint64</span><span class="op" id="5357795">(</span><span class="ident" id="5357796">ph</span><span class="op" id="5357798">.</span><span class="ident" id="5357799">Off</span><span class="op" id="5357802">)</span><span class="op" id="5357803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357809">Vaddr</span><span class="op" id="5357814">:</span>&nbsp;&nbsp;<span class="ident" id="5357817">uint64</span><span class="op" id="5357823">(</span><span class="ident" id="5357824">ph</span><span class="op" id="5357826">.</span><span class="ident" id="5357827">Vaddr</span><span class="op" id="5357832">)</span><span class="op" id="5357833">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357839">Paddr</span><span class="op" id="5357844">:</span>&nbsp;&nbsp;<span class="ident" id="5357847">uint64</span><span class="op" id="5357853">(</span><span class="ident" id="5357854">ph</span><span class="op" id="5357856">.</span><span class="ident" id="5357857">Paddr</span><span class="op" id="5357862">)</span><span class="op" id="5357863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357869">Filesz</span><span class="op" id="5357875">:</span>&nbsp;<span class="ident" id="5357877">uint64</span><span class="op" id="5357883">(</span><span class="ident" id="5357884">ph</span><span class="op" id="5357886">.</span><span class="ident" id="5357887">Filesz</span><span class="op" id="5357893">)</span><span class="op" id="5357894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357900">Memsz</span><span class="op" id="5357905">:</span>&nbsp;&nbsp;<span class="ident" id="5357908">uint64</span><span class="op" id="5357914">(</span><span class="ident" id="5357915">ph</span><span class="op" id="5357917">.</span><span class="ident" id="5357918">Memsz</span><span class="op" id="5357923">)</span><span class="op" id="5357924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357930">Align</span><span class="op" id="5357935">:</span>&nbsp;&nbsp;<span class="ident" id="5357938">uint64</span><span class="op" id="5357944">(</span><span class="ident" id="5357945">ph</span><span class="op" id="5357947">.</span><span class="ident" id="5357948">Align</span><span class="op" id="5357953">)</span><span class="op" id="5357954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5357959">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5357963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5357967">p</span><span class="op" id="5357968">.</span><span class="ident" id="5357969">sr</span>&nbsp;<span class="op" id="5357972">=</span>&nbsp;<span class="ident" id="5357974">io</span><span class="op" id="5357976">.</span><span class="ident" id="5357977">NewSectionReader</span><span class="op" id="5357993">(</span><span class="ident" id="5357994">r</span><span class="op" id="5357995">,</span>&nbsp;<span class="ident" id="5357997">int64</span><span class="op" id="5358002">(</span><span class="ident" id="5358003">p</span><span class="op" id="5358004">.</span><span class="ident" id="5358005">Off</span><span class="op" id="5358008">)</span><span class="op" id="5358009">,</span>&nbsp;<span class="ident" id="5358011">int64</span><span class="op" id="5358016">(</span><span class="ident" id="5358017">p</span><span class="op" id="5358018">.</span><span class="ident" id="5358019">Filesz</span><span class="op" id="5358025">)</span><span class="op" id="5358026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358030">p</span><span class="op" id="5358031">.</span><span class="ident" id="5358032">ReaderAt</span>&nbsp;<span class="op" id="5358041">=</span>&nbsp;<span class="ident" id="5358043">p</span><span class="op" id="5358044">.</span><span class="ident" id="5358045">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358050">f</span><span class="op" id="5358051">.</span><span class="ident" id="5358052">Progs</span><span class="op" id="5358057">[</span><span class="ident" id="5358058">i</span><span class="op" id="5358059">]</span>&nbsp;<span class="op" id="5358061">=</span>&nbsp;<span class="ident" id="5358063">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5358066">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5358070">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358095">f</span><span class="op" id="5358096">.</span><span class="ident" id="5358097">Sections</span>&nbsp;<span class="op" id="5358106">=</span>&nbsp;<span class="builtinfunc" id="5358108">make</span><span class="op" id="5358112">(</span><span class="op" id="5358113">[</span><span class="op" id="5358114">]</span><span class="op" id="5358115">*</span><span class="ident" id="5358116">Section</span><span class="op" id="5358123">,</span>&nbsp;<span class="ident" id="5358125">shnum</span><span class="op" id="5358130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358133">names</span>&nbsp;<span class="op" id="5358139">:=</span>&nbsp;<span class="builtinfunc" id="5358142">make</span><span class="op" id="5358146">(</span><span class="op" id="5358147">[</span><span class="op" id="5358148">]</span><span class="builtintype" id="5358149">uint32</span><span class="op" id="5358155">,</span>&nbsp;<span class="ident" id="5358157">shnum</span><span class="op" id="5358162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358165">for</span>&nbsp;<span class="ident" id="5358169">i</span>&nbsp;<span class="op" id="5358171">:=</span>&nbsp;<span class="num" id="5358174">0</span><span class="op" id="5358175">;</span>&nbsp;<span class="ident" id="5358177">i</span>&nbsp;<span class="op" id="5358179">&lt;</span>&nbsp;<span class="ident" id="5358181">shnum</span><span class="op" id="5358186">;</span>&nbsp;<span class="ident" id="5358188">i</span><span class="op" id="5358189">++</span>&nbsp;<span class="op" id="5358192">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358196">off</span>&nbsp;<span class="op" id="5358200">:=</span>&nbsp;<span class="ident" id="5358203">shoff</span>&nbsp;<span class="op" id="5358209">+</span>&nbsp;<span class="ident" id="5358211">int64</span><span class="op" id="5358216">(</span><span class="ident" id="5358217">i</span><span class="op" id="5358218">)</span><span class="op" id="5358219">*</span><span class="ident" id="5358220">int64</span><span class="op" id="5358225">(</span><span class="ident" id="5358226">shentsize</span><span class="op" id="5358235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358239">sr</span><span class="op" id="5358241">.</span><span class="ident" id="5358242">Seek</span><span class="op" id="5358246">(</span><span class="ident" id="5358247">off</span><span class="op" id="5358250">,</span>&nbsp;<span class="ident" id="5358252">os</span><span class="op" id="5358254">.</span><span class="ident" id="5358255">SEEK_SET</span><span class="op" id="5358263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358267">s</span>&nbsp;<span class="op" id="5358269">:=</span>&nbsp;<span class="builtinfunc" id="5358272">new</span><span class="op" id="5358275">(</span><span class="ident" id="5358276">Section</span><span class="op" id="5358283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358287">switch</span>&nbsp;<span class="ident" id="5358294">f</span><span class="op" id="5358295">.</span><span class="ident" id="5358296">Class</span>&nbsp;<span class="op" id="5358302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358306">case</span>&nbsp;<span class="ident" id="5358311">ELFCLASS32</span><span class="op" id="5358321">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358326">sh</span>&nbsp;<span class="op" id="5358329">:=</span>&nbsp;<span class="builtinfunc" id="5358332">new</span><span class="op" id="5358335">(</span><span class="ident" id="5358336">Section32</span><span class="op" id="5358345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358350">if</span>&nbsp;<span class="ident" id="5358353">err</span>&nbsp;<span class="op" id="5358357">:=</span>&nbsp;<span class="ident" id="5358360">binary</span><span class="op" id="5358366">.</span><span class="ident" id="5358367">Read</span><span class="op" id="5358371">(</span><span class="ident" id="5358372">sr</span><span class="op" id="5358374">,</span>&nbsp;<span class="ident" id="5358376">f</span><span class="op" id="5358377">.</span><span class="ident" id="5358378">ByteOrder</span><span class="op" id="5358387">,</span>&nbsp;<span class="ident" id="5358389">sh</span><span class="op" id="5358391">)</span><span class="op" id="5358392">;</span>&nbsp;<span class="ident" id="5358394">err</span>&nbsp;<span class="op" id="5358398">!=</span>&nbsp;<span class="ident" id="5358401">nil</span>&nbsp;<span class="op" id="5358405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358411">return</span>&nbsp;<span class="ident" id="5358418">nil</span><span class="op" id="5358421">,</span>&nbsp;<span class="ident" id="5358423">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5358430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358435">names</span><span class="op" id="5358440">[</span><span class="ident" id="5358441">i</span><span class="op" id="5358442">]</span>&nbsp;<span class="op" id="5358444">=</span>&nbsp;<span class="ident" id="5358446">sh</span><span class="op" id="5358448">.</span><span class="ident" id="5358449">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358457">s</span><span class="op" id="5358458">.</span><span class="ident" id="5358459">SectionHeader</span>&nbsp;<span class="op" id="5358473">=</span>&nbsp;<span class="ident" id="5358475">SectionHeader</span><span class="op" id="5358488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358494">Type</span><span class="op" id="5358498">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5358505">SectionType</span><span class="op" id="5358516">(</span><span class="ident" id="5358517">sh</span><span class="op" id="5358519">.</span><span class="ident" id="5358520">Type</span><span class="op" id="5358524">)</span><span class="op" id="5358525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358531">Flags</span><span class="op" id="5358536">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5358542">SectionFlag</span><span class="op" id="5358553">(</span><span class="ident" id="5358554">sh</span><span class="op" id="5358556">.</span><span class="ident" id="5358557">Flags</span><span class="op" id="5358562">)</span><span class="op" id="5358563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358569">Addr</span><span class="op" id="5358573">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5358580">uint64</span><span class="op" id="5358586">(</span><span class="ident" id="5358587">sh</span><span class="op" id="5358589">.</span><span class="ident" id="5358590">Addr</span><span class="op" id="5358594">)</span><span class="op" id="5358595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358601">Offset</span><span class="op" id="5358607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5358612">uint64</span><span class="op" id="5358618">(</span><span class="ident" id="5358619">sh</span><span class="op" id="5358621">.</span><span class="ident" id="5358622">Off</span><span class="op" id="5358625">)</span><span class="op" id="5358626">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358632">Size</span><span class="op" id="5358636">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5358643">uint64</span><span class="op" id="5358649">(</span><span class="ident" id="5358650">sh</span><span class="op" id="5358652">.</span><span class="ident" id="5358653">Size</span><span class="op" id="5358657">)</span><span class="op" id="5358658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358664">Link</span><span class="op" id="5358668">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5358675">uint32</span><span class="op" id="5358681">(</span><span class="ident" id="5358682">sh</span><span class="op" id="5358684">.</span><span class="ident" id="5358685">Link</span><span class="op" id="5358689">)</span><span class="op" id="5358690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358696">Info</span><span class="op" id="5358700">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5358707">uint32</span><span class="op" id="5358713">(</span><span class="ident" id="5358714">sh</span><span class="op" id="5358716">.</span><span class="ident" id="5358717">Info</span><span class="op" id="5358721">)</span><span class="op" id="5358722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358728">Addralign</span><span class="op" id="5358737">:</span>&nbsp;<span class="ident" id="5358739">uint64</span><span class="op" id="5358745">(</span><span class="ident" id="5358746">sh</span><span class="op" id="5358748">.</span><span class="ident" id="5358749">Addralign</span><span class="op" id="5358758">)</span><span class="op" id="5358759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358765">Entsize</span><span class="op" id="5358772">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5358776">uint64</span><span class="op" id="5358782">(</span><span class="ident" id="5358783">sh</span><span class="op" id="5358785">.</span><span class="ident" id="5358786">Entsize</span><span class="op" id="5358793">)</span><span class="op" id="5358794">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5358799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358803">case</span>&nbsp;<span class="ident" id="5358808">ELFCLASS64</span><span class="op" id="5358818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358823">sh</span>&nbsp;<span class="op" id="5358826">:=</span>&nbsp;<span class="builtinfunc" id="5358829">new</span><span class="op" id="5358832">(</span><span class="ident" id="5358833">Section64</span><span class="op" id="5358842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358847">if</span>&nbsp;<span class="ident" id="5358850">err</span>&nbsp;<span class="op" id="5358854">:=</span>&nbsp;<span class="ident" id="5358857">binary</span><span class="op" id="5358863">.</span><span class="ident" id="5358864">Read</span><span class="op" id="5358868">(</span><span class="ident" id="5358869">sr</span><span class="op" id="5358871">,</span>&nbsp;<span class="ident" id="5358873">f</span><span class="op" id="5358874">.</span><span class="ident" id="5358875">ByteOrder</span><span class="op" id="5358884">,</span>&nbsp;<span class="ident" id="5358886">sh</span><span class="op" id="5358888">)</span><span class="op" id="5358889">;</span>&nbsp;<span class="ident" id="5358891">err</span>&nbsp;<span class="op" id="5358895">!=</span>&nbsp;<span class="ident" id="5358898">nil</span>&nbsp;<span class="op" id="5358902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5358908">return</span>&nbsp;<span class="ident" id="5358915">nil</span><span class="op" id="5358918">,</span>&nbsp;<span class="ident" id="5358920">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5358927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358932">names</span><span class="op" id="5358937">[</span><span class="ident" id="5358938">i</span><span class="op" id="5358939">]</span>&nbsp;<span class="op" id="5358941">=</span>&nbsp;<span class="ident" id="5358943">sh</span><span class="op" id="5358945">.</span><span class="ident" id="5358946">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358954">s</span><span class="op" id="5358955">.</span><span class="ident" id="5358956">SectionHeader</span>&nbsp;<span class="op" id="5358970">=</span>&nbsp;<span class="ident" id="5358972">SectionHeader</span><span class="op" id="5358985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5358991">Type</span><span class="op" id="5358995">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5359002">SectionType</span><span class="op" id="5359013">(</span><span class="ident" id="5359014">sh</span><span class="op" id="5359016">.</span><span class="ident" id="5359017">Type</span><span class="op" id="5359021">)</span><span class="op" id="5359022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359028">Flags</span><span class="op" id="5359033">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5359039">SectionFlag</span><span class="op" id="5359050">(</span><span class="ident" id="5359051">sh</span><span class="op" id="5359053">.</span><span class="ident" id="5359054">Flags</span><span class="op" id="5359059">)</span><span class="op" id="5359060">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359066">Offset</span><span class="op" id="5359072">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5359077">uint64</span><span class="op" id="5359083">(</span><span class="ident" id="5359084">sh</span><span class="op" id="5359086">.</span><span class="ident" id="5359087">Off</span><span class="op" id="5359090">)</span><span class="op" id="5359091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359097">Size</span><span class="op" id="5359101">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5359108">uint64</span><span class="op" id="5359114">(</span><span class="ident" id="5359115">sh</span><span class="op" id="5359117">.</span><span class="ident" id="5359118">Size</span><span class="op" id="5359122">)</span><span class="op" id="5359123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359129">Addr</span><span class="op" id="5359133">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5359140">uint64</span><span class="op" id="5359146">(</span><span class="ident" id="5359147">sh</span><span class="op" id="5359149">.</span><span class="ident" id="5359150">Addr</span><span class="op" id="5359154">)</span><span class="op" id="5359155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359161">Link</span><span class="op" id="5359165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5359172">uint32</span><span class="op" id="5359178">(</span><span class="ident" id="5359179">sh</span><span class="op" id="5359181">.</span><span class="ident" id="5359182">Link</span><span class="op" id="5359186">)</span><span class="op" id="5359187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359193">Info</span><span class="op" id="5359197">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5359204">uint32</span><span class="op" id="5359210">(</span><span class="ident" id="5359211">sh</span><span class="op" id="5359213">.</span><span class="ident" id="5359214">Info</span><span class="op" id="5359218">)</span><span class="op" id="5359219">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359225">Addralign</span><span class="op" id="5359234">:</span>&nbsp;<span class="ident" id="5359236">uint64</span><span class="op" id="5359242">(</span><span class="ident" id="5359243">sh</span><span class="op" id="5359245">.</span><span class="ident" id="5359246">Addralign</span><span class="op" id="5359255">)</span><span class="op" id="5359256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359262">Entsize</span><span class="op" id="5359269">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5359273">uint64</span><span class="op" id="5359279">(</span><span class="ident" id="5359280">sh</span><span class="op" id="5359282">.</span><span class="ident" id="5359283">Entsize</span><span class="op" id="5359290">)</span><span class="op" id="5359291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5359296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5359300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359304">s</span><span class="op" id="5359305">.</span><span class="ident" id="5359306">sr</span>&nbsp;<span class="op" id="5359309">=</span>&nbsp;<span class="ident" id="5359311">io</span><span class="op" id="5359313">.</span><span class="ident" id="5359314">NewSectionReader</span><span class="op" id="5359330">(</span><span class="ident" id="5359331">r</span><span class="op" id="5359332">,</span>&nbsp;<span class="ident" id="5359334">int64</span><span class="op" id="5359339">(</span><span class="ident" id="5359340">s</span><span class="op" id="5359341">.</span><span class="ident" id="5359342">Offset</span><span class="op" id="5359348">)</span><span class="op" id="5359349">,</span>&nbsp;<span class="ident" id="5359351">int64</span><span class="op" id="5359356">(</span><span class="ident" id="5359357">s</span><span class="op" id="5359358">.</span><span class="ident" id="5359359">Size</span><span class="op" id="5359363">)</span><span class="op" id="5359364">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359368">s</span><span class="op" id="5359369">.</span><span class="ident" id="5359370">ReaderAt</span>&nbsp;<span class="op" id="5359379">=</span>&nbsp;<span class="ident" id="5359381">s</span><span class="op" id="5359382">.</span><span class="ident" id="5359383">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359388">f</span><span class="op" id="5359389">.</span><span class="ident" id="5359390">Sections</span><span class="op" id="5359398">[</span><span class="ident" id="5359399">i</span><span class="op" id="5359400">]</span>&nbsp;<span class="op" id="5359402">=</span>&nbsp;<span class="ident" id="5359404">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5359407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359411">if</span>&nbsp;<span class="builtinfunc" id="5359414">len</span><span class="op" id="5359417">(</span><span class="ident" id="5359418">f</span><span class="op" id="5359419">.</span><span class="ident" id="5359420">Sections</span><span class="op" id="5359428">)</span>&nbsp;<span class="op" id="5359430">==</span>&nbsp;<span class="num" id="5359433">0</span>&nbsp;<span class="op" id="5359435">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359439">return</span>&nbsp;<span class="ident" id="5359446">f</span><span class="op" id="5359447">,</span>&nbsp;<span class="ident" id="5359449">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5359454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5359458">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359496">shstrtab</span><span class="op" id="5359504">,</span>&nbsp;<span class="ident" id="5359506">err</span>&nbsp;<span class="op" id="5359510">:=</span>&nbsp;<span class="ident" id="5359513">f</span><span class="op" id="5359514">.</span><span class="ident" id="5359515">Sections</span><span class="op" id="5359523">[</span><span class="ident" id="5359524">shstrndx</span><span class="op" id="5359532">]</span><span class="op" id="5359533">.</span><span class="ident" id="5359534">Data</span><span class="op" id="5359538">(</span><span class="op" id="5359539">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359542">if</span>&nbsp;<span class="ident" id="5359545">err</span>&nbsp;<span class="op" id="5359549">!=</span>&nbsp;<span class="ident" id="5359552">nil</span>&nbsp;<span class="op" id="5359556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359560">return</span>&nbsp;<span class="ident" id="5359567">nil</span><span class="op" id="5359570">,</span>&nbsp;<span class="ident" id="5359572">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5359577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359580">for</span>&nbsp;<span class="ident" id="5359584">i</span><span class="op" id="5359585">,</span>&nbsp;<span class="ident" id="5359587">s</span>&nbsp;<span class="op" id="5359589">:=</span>&nbsp;<span class="keyword" id="5359592">range</span>&nbsp;<span class="ident" id="5359598">f</span><span class="op" id="5359599">.</span><span class="ident" id="5359600">Sections</span>&nbsp;<span class="op" id="5359609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359613">var</span>&nbsp;<span class="ident" id="5359617">ok</span>&nbsp;<span class="builtintype" id="5359620">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5359627">s</span><span class="op" id="5359628">.</span><span class="ident" id="5359629">Name</span><span class="op" id="5359633">,</span>&nbsp;<span class="ident" id="5359635">ok</span>&nbsp;<span class="op" id="5359638">=</span>&nbsp;<span class="ident" id="5359640">getString</span><span class="op" id="5359649">(</span><span class="ident" id="5359650">shstrtab</span><span class="op" id="5359658">,</span>&nbsp;<span class="builtintype" id="5359660">int</span><span class="op" id="5359663">(</span><span class="ident" id="5359664">names</span><span class="op" id="5359669">[</span><span class="ident" id="5359670">i</span><span class="op" id="5359671">]</span><span class="op" id="5359672">)</span><span class="op" id="5359673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359677">if</span>&nbsp;<span class="op" id="5359680">!</span><span class="ident" id="5359681">ok</span>&nbsp;<span class="op" id="5359684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359689">return</span>&nbsp;<span class="ident" id="5359696">nil</span><span class="op" id="5359699">,</span>&nbsp;<span class="op" id="5359701">&amp;</span><span class="ident" id="5359702">FormatError</span><span class="op" id="5359713">{</span><span class="ident" id="5359714">shoff</span>&nbsp;<span class="op" id="5359720">+</span>&nbsp;<span class="ident" id="5359722">int64</span><span class="op" id="5359727">(</span><span class="ident" id="5359728">i</span><span class="op" id="5359729">*</span><span class="ident" id="5359730">shentsize</span><span class="op" id="5359739">)</span><span class="op" id="5359740">,</span>&nbsp;<span class="string" id="5359742">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="5359766">,</span>&nbsp;<span class="ident" id="5359768">names</span><span class="op" id="5359773">[</span><span class="ident" id="5359774">i</span><span class="op" id="5359775">]</span><span class="op" id="5359776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5359780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5359783">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5359787">return</span>&nbsp;<span class="ident" id="5359794">f</span><span class="op" id="5359795">,</span>&nbsp;<span class="ident" id="5359797">nil</span><br>
<span class="lineno"></span><span class="op" id="5359801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5359804">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="5359875">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5359939">func</span>&nbsp;<span class="op" id="5359944">(</span><span class="ident" id="5359945">f</span>&nbsp;<span class="op" id="5359947">*</span><span class="ident" id="5359948">File</span><span class="op" id="5359952">)</span>&nbsp;<span class="ident" id="5359954">getSymbols</span><span class="op" id="5359964">(</span><span class="ident" id="5359965">typ</span>&nbsp;<span class="ident" id="5359969">SectionType</span><span class="op" id="5359980">)</span>&nbsp;<span class="op" id="5359982">(</span><span class="op" id="5359983">[</span><span class="op" id="5359984">]</span><span class="ident" id="5359985">Symbol</span><span class="op" id="5359991">,</span>&nbsp;<span class="op" id="5359993">[</span><span class="op" id="5359994">]</span><span class="builtintype" id="5359995">byte</span><span class="op" id="5359999">,</span>&nbsp;<span class="builtintype" id="5360001">error</span><span class="op" id="5360006">)</span>&nbsp;<span class="op" id="5360008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360011">switch</span>&nbsp;<span class="ident" id="5360018">f</span><span class="op" id="5360019">.</span><span class="ident" id="5360020">Class</span>&nbsp;<span class="op" id="5360026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360029">case</span>&nbsp;<span class="ident" id="5360034">ELFCLASS64</span><span class="op" id="5360044">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360048">return</span>&nbsp;<span class="ident" id="5360055">f</span><span class="op" id="5360056">.</span><span class="ident" id="5360057">getSymbols64</span><span class="op" id="5360069">(</span><span class="ident" id="5360070">typ</span><span class="op" id="5360073">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360077">case</span>&nbsp;<span class="ident" id="5360082">ELFCLASS32</span><span class="op" id="5360092">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360096">return</span>&nbsp;<span class="ident" id="5360103">f</span><span class="op" id="5360104">.</span><span class="ident" id="5360105">getSymbols32</span><span class="op" id="5360117">(</span><span class="ident" id="5360118">typ</span><span class="op" id="5360121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5360124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360128">return</span>&nbsp;<span class="ident" id="5360135">nil</span><span class="op" id="5360138">,</span>&nbsp;<span class="ident" id="5360140">nil</span><span class="op" id="5360143">,</span>&nbsp;<span class="ident" id="5360145">errors</span><span class="op" id="5360151">.</span><span class="ident" id="5360152">New</span><span class="op" id="5360155">(</span><span class="string" id="5360156">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5360173">)</span><br>
<span class="lineno"></span><span class="op" id="5360175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5360178">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="5360246">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="5360290">var</span>&nbsp;<span class="ident" id="5360294">ErrNoSymbols</span>&nbsp;<span class="op" id="5360307">=</span>&nbsp;<span class="ident" id="5360309">errors</span><span class="op" id="5360315">.</span><span class="ident" id="5360316">New</span><span class="op" id="5360319">(</span><span class="string" id="5360320">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5360339">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5360342">func</span>&nbsp;<span class="op" id="5360347">(</span><span class="ident" id="5360348">f</span>&nbsp;<span class="op" id="5360350">*</span><span class="ident" id="5360351">File</span><span class="op" id="5360355">)</span>&nbsp;<span class="ident" id="5360357">getSymbols32</span><span class="op" id="5360369">(</span><span class="ident" id="5360370">typ</span>&nbsp;<span class="ident" id="5360374">SectionType</span><span class="op" id="5360385">)</span>&nbsp;<span class="op" id="5360387">(</span><span class="op" id="5360388">[</span><span class="op" id="5360389">]</span><span class="ident" id="5360390">Symbol</span><span class="op" id="5360396">,</span>&nbsp;<span class="op" id="5360398">[</span><span class="op" id="5360399">]</span><span class="builtintype" id="5360400">byte</span><span class="op" id="5360404">,</span>&nbsp;<span class="builtintype" id="5360406">error</span><span class="op" id="5360411">)</span>&nbsp;<span class="op" id="5360413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5360416">symtabSection</span>&nbsp;<span class="op" id="5360430">:=</span>&nbsp;<span class="ident" id="5360433">f</span><span class="op" id="5360434">.</span><span class="ident" id="5360435">SectionByType</span><span class="op" id="5360448">(</span><span class="ident" id="5360449">typ</span><span class="op" id="5360452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360455">if</span>&nbsp;<span class="ident" id="5360458">symtabSection</span>&nbsp;<span class="op" id="5360472">==</span>&nbsp;<span class="ident" id="5360475">nil</span>&nbsp;<span class="op" id="5360479">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360483">return</span>&nbsp;<span class="ident" id="5360490">nil</span><span class="op" id="5360493">,</span>&nbsp;<span class="ident" id="5360495">nil</span><span class="op" id="5360498">,</span>&nbsp;<span class="ident" id="5360500">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5360514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5360518">data</span><span class="op" id="5360522">,</span>&nbsp;<span class="ident" id="5360524">err</span>&nbsp;<span class="op" id="5360528">:=</span>&nbsp;<span class="ident" id="5360531">symtabSection</span><span class="op" id="5360544">.</span><span class="ident" id="5360545">Data</span><span class="op" id="5360549">(</span><span class="op" id="5360550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360553">if</span>&nbsp;<span class="ident" id="5360556">err</span>&nbsp;<span class="op" id="5360560">!=</span>&nbsp;<span class="ident" id="5360563">nil</span>&nbsp;<span class="op" id="5360567">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360571">return</span>&nbsp;<span class="ident" id="5360578">nil</span><span class="op" id="5360581">,</span>&nbsp;<span class="ident" id="5360583">nil</span><span class="op" id="5360586">,</span>&nbsp;<span class="ident" id="5360588">errors</span><span class="op" id="5360594">.</span><span class="ident" id="5360595">New</span><span class="op" id="5360598">(</span><span class="string" id="5360599">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5360627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5360630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5360633">symtab</span>&nbsp;<span class="op" id="5360640">:=</span>&nbsp;<span class="ident" id="5360643">bytes</span><span class="op" id="5360648">.</span><span class="ident" id="5360649">NewReader</span><span class="op" id="5360658">(</span><span class="ident" id="5360659">data</span><span class="op" id="5360663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360666">if</span>&nbsp;<span class="ident" id="5360669">symtab</span><span class="op" id="5360675">.</span><span class="ident" id="5360676">Len</span><span class="op" id="5360679">(</span><span class="op" id="5360680">)</span><span class="op" id="5360681">%</span><span class="ident" id="5360682">Sym32Size</span>&nbsp;<span class="op" id="5360692">!=</span>&nbsp;<span class="num" id="5360695">0</span>&nbsp;<span class="op" id="5360697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360701">return</span>&nbsp;<span class="ident" id="5360708">nil</span><span class="op" id="5360711">,</span>&nbsp;<span class="ident" id="5360713">nil</span><span class="op" id="5360716">,</span>&nbsp;<span class="ident" id="5360718">errors</span><span class="op" id="5360724">.</span><span class="ident" id="5360725">New</span><span class="op" id="5360728">(</span><span class="string" id="5360729">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="5360784">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5360787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5360791">strdata</span><span class="op" id="5360798">,</span>&nbsp;<span class="ident" id="5360800">err</span>&nbsp;<span class="op" id="5360804">:=</span>&nbsp;<span class="ident" id="5360807">f</span><span class="op" id="5360808">.</span><span class="ident" id="5360809">stringTable</span><span class="op" id="5360820">(</span><span class="ident" id="5360821">symtabSection</span><span class="op" id="5360834">.</span><span class="ident" id="5360835">Link</span><span class="op" id="5360839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360842">if</span>&nbsp;<span class="ident" id="5360845">err</span>&nbsp;<span class="op" id="5360849">!=</span>&nbsp;<span class="ident" id="5360852">nil</span>&nbsp;<span class="op" id="5360856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360860">return</span>&nbsp;<span class="ident" id="5360867">nil</span><span class="op" id="5360870">,</span>&nbsp;<span class="ident" id="5360872">nil</span><span class="op" id="5360875">,</span>&nbsp;<span class="ident" id="5360877">errors</span><span class="op" id="5360883">.</span><span class="ident" id="5360884">New</span><span class="op" id="5360887">(</span><span class="string" id="5360888">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5360922">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5360925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5360929">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5360963">var</span>&nbsp;<span class="ident" id="5360967">skip</span>&nbsp;<span class="op" id="5360972">[</span><span class="ident" id="5360973">Sym32Size</span><span class="op" id="5360982">]</span><span class="builtintype" id="5360983">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5360989">symtab</span><span class="op" id="5360995">.</span><span class="ident" id="5360996">Read</span><span class="op" id="5361000">(</span><span class="ident" id="5361001">skip</span><span class="op" id="5361005">[</span><span class="op" id="5361006">:</span><span class="op" id="5361007">]</span><span class="op" id="5361008">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361012">symbols</span>&nbsp;<span class="op" id="5361020">:=</span>&nbsp;<span class="builtinfunc" id="5361023">make</span><span class="op" id="5361027">(</span><span class="op" id="5361028">[</span><span class="op" id="5361029">]</span><span class="ident" id="5361030">Symbol</span><span class="op" id="5361036">,</span>&nbsp;<span class="ident" id="5361038">symtab</span><span class="op" id="5361044">.</span><span class="ident" id="5361045">Len</span><span class="op" id="5361048">(</span><span class="op" id="5361049">)</span><span class="op" id="5361050">/</span><span class="ident" id="5361051">Sym32Size</span><span class="op" id="5361060">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361064">i</span>&nbsp;<span class="op" id="5361066">:=</span>&nbsp;<span class="num" id="5361069">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361072">var</span>&nbsp;<span class="ident" id="5361076">sym</span>&nbsp;<span class="ident" id="5361080">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361087">for</span>&nbsp;<span class="ident" id="5361091">symtab</span><span class="op" id="5361097">.</span><span class="ident" id="5361098">Len</span><span class="op" id="5361101">(</span><span class="op" id="5361102">)</span>&nbsp;<span class="op" id="5361104">&gt;</span>&nbsp;<span class="num" id="5361106">0</span>&nbsp;<span class="op" id="5361108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361112">binary</span><span class="op" id="5361118">.</span><span class="ident" id="5361119">Read</span><span class="op" id="5361123">(</span><span class="ident" id="5361124">symtab</span><span class="op" id="5361130">,</span>&nbsp;<span class="ident" id="5361132">f</span><span class="op" id="5361133">.</span><span class="ident" id="5361134">ByteOrder</span><span class="op" id="5361143">,</span>&nbsp;<span class="op" id="5361145">&amp;</span><span class="ident" id="5361146">sym</span><span class="op" id="5361149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361153">str</span><span class="op" id="5361156">,</span>&nbsp;<span class="ident" id="5361158">_</span>&nbsp;<span class="op" id="5361160">:=</span>&nbsp;<span class="ident" id="5361163">getString</span><span class="op" id="5361172">(</span><span class="ident" id="5361173">strdata</span><span class="op" id="5361180">,</span>&nbsp;<span class="builtintype" id="5361182">int</span><span class="op" id="5361185">(</span><span class="ident" id="5361186">sym</span><span class="op" id="5361189">.</span><span class="ident" id="5361190">Name</span><span class="op" id="5361194">)</span><span class="op" id="5361195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361199">symbols</span><span class="op" id="5361206">[</span><span class="ident" id="5361207">i</span><span class="op" id="5361208">]</span><span class="op" id="5361209">.</span><span class="ident" id="5361210">Name</span>&nbsp;<span class="op" id="5361215">=</span>&nbsp;<span class="ident" id="5361217">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361223">symbols</span><span class="op" id="5361230">[</span><span class="ident" id="5361231">i</span><span class="op" id="5361232">]</span><span class="op" id="5361233">.</span><span class="ident" id="5361234">Info</span>&nbsp;<span class="op" id="5361239">=</span>&nbsp;<span class="ident" id="5361241">sym</span><span class="op" id="5361244">.</span><span class="ident" id="5361245">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361252">symbols</span><span class="op" id="5361259">[</span><span class="ident" id="5361260">i</span><span class="op" id="5361261">]</span><span class="op" id="5361262">.</span><span class="ident" id="5361263">Other</span>&nbsp;<span class="op" id="5361269">=</span>&nbsp;<span class="ident" id="5361271">sym</span><span class="op" id="5361274">.</span><span class="ident" id="5361275">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361283">symbols</span><span class="op" id="5361290">[</span><span class="ident" id="5361291">i</span><span class="op" id="5361292">]</span><span class="op" id="5361293">.</span><span class="ident" id="5361294">Section</span>&nbsp;<span class="op" id="5361302">=</span>&nbsp;<span class="ident" id="5361304">SectionIndex</span><span class="op" id="5361316">(</span><span class="ident" id="5361317">sym</span><span class="op" id="5361320">.</span><span class="ident" id="5361321">Shndx</span><span class="op" id="5361326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361330">symbols</span><span class="op" id="5361337">[</span><span class="ident" id="5361338">i</span><span class="op" id="5361339">]</span><span class="op" id="5361340">.</span><span class="ident" id="5361341">Value</span>&nbsp;<span class="op" id="5361347">=</span>&nbsp;<span class="ident" id="5361349">uint64</span><span class="op" id="5361355">(</span><span class="ident" id="5361356">sym</span><span class="op" id="5361359">.</span><span class="ident" id="5361360">Value</span><span class="op" id="5361365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361369">symbols</span><span class="op" id="5361376">[</span><span class="ident" id="5361377">i</span><span class="op" id="5361378">]</span><span class="op" id="5361379">.</span><span class="ident" id="5361380">Size</span>&nbsp;<span class="op" id="5361385">=</span>&nbsp;<span class="ident" id="5361387">uint64</span><span class="op" id="5361393">(</span><span class="ident" id="5361394">sym</span><span class="op" id="5361397">.</span><span class="ident" id="5361398">Size</span><span class="op" id="5361402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361406">i</span><span class="op" id="5361407">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5361411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361415">return</span>&nbsp;<span class="ident" id="5361422">symbols</span><span class="op" id="5361429">,</span>&nbsp;<span class="ident" id="5361431">strdata</span><span class="op" id="5361438">,</span>&nbsp;<span class="ident" id="5361440">nil</span><br>
<span class="lineno"></span><span class="op" id="5361444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="5361447">func</span>&nbsp;<span class="op" id="5361452">(</span><span class="ident" id="5361453">f</span>&nbsp;<span class="op" id="5361455">*</span><span class="ident" id="5361456">File</span><span class="op" id="5361460">)</span>&nbsp;<span class="ident" id="5361462">getSymbols64</span><span class="op" id="5361474">(</span><span class="ident" id="5361475">typ</span>&nbsp;<span class="ident" id="5361479">SectionType</span><span class="op" id="5361490">)</span>&nbsp;<span class="op" id="5361492">(</span><span class="op" id="5361493">[</span><span class="op" id="5361494">]</span><span class="ident" id="5361495">Symbol</span><span class="op" id="5361501">,</span>&nbsp;<span class="op" id="5361503">[</span><span class="op" id="5361504">]</span><span class="builtintype" id="5361505">byte</span><span class="op" id="5361509">,</span>&nbsp;<span class="builtintype" id="5361511">error</span><span class="op" id="5361516">)</span>&nbsp;<span class="op" id="5361518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361521">symtabSection</span>&nbsp;<span class="op" id="5361535">:=</span>&nbsp;<span class="ident" id="5361538">f</span><span class="op" id="5361539">.</span><span class="ident" id="5361540">SectionByType</span><span class="op" id="5361553">(</span><span class="ident" id="5361554">typ</span><span class="op" id="5361557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361560">if</span>&nbsp;<span class="ident" id="5361563">symtabSection</span>&nbsp;<span class="op" id="5361577">==</span>&nbsp;<span class="ident" id="5361580">nil</span>&nbsp;<span class="op" id="5361584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361588">return</span>&nbsp;<span class="ident" id="5361595">nil</span><span class="op" id="5361598">,</span>&nbsp;<span class="ident" id="5361600">nil</span><span class="op" id="5361603">,</span>&nbsp;<span class="ident" id="5361605">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5361619">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361623">data</span><span class="op" id="5361627">,</span>&nbsp;<span class="ident" id="5361629">err</span>&nbsp;<span class="op" id="5361633">:=</span>&nbsp;<span class="ident" id="5361636">symtabSection</span><span class="op" id="5361649">.</span><span class="ident" id="5361650">Data</span><span class="op" id="5361654">(</span><span class="op" id="5361655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361658">if</span>&nbsp;<span class="ident" id="5361661">err</span>&nbsp;<span class="op" id="5361665">!=</span>&nbsp;<span class="ident" id="5361668">nil</span>&nbsp;<span class="op" id="5361672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361676">return</span>&nbsp;<span class="ident" id="5361683">nil</span><span class="op" id="5361686">,</span>&nbsp;<span class="ident" id="5361688">nil</span><span class="op" id="5361691">,</span>&nbsp;<span class="ident" id="5361693">errors</span><span class="op" id="5361699">.</span><span class="ident" id="5361700">New</span><span class="op" id="5361703">(</span><span class="string" id="5361704">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5361732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5361735">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361738">symtab</span>&nbsp;<span class="op" id="5361745">:=</span>&nbsp;<span class="ident" id="5361748">bytes</span><span class="op" id="5361753">.</span><span class="ident" id="5361754">NewReader</span><span class="op" id="5361763">(</span><span class="ident" id="5361764">data</span><span class="op" id="5361768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361771">if</span>&nbsp;<span class="ident" id="5361774">symtab</span><span class="op" id="5361780">.</span><span class="ident" id="5361781">Len</span><span class="op" id="5361784">(</span><span class="op" id="5361785">)</span><span class="op" id="5361786">%</span><span class="ident" id="5361787">Sym64Size</span>&nbsp;<span class="op" id="5361797">!=</span>&nbsp;<span class="num" id="5361800">0</span>&nbsp;<span class="op" id="5361802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361806">return</span>&nbsp;<span class="ident" id="5361813">nil</span><span class="op" id="5361816">,</span>&nbsp;<span class="ident" id="5361818">nil</span><span class="op" id="5361821">,</span>&nbsp;<span class="ident" id="5361823">errors</span><span class="op" id="5361829">.</span><span class="ident" id="5361830">New</span><span class="op" id="5361833">(</span><span class="string" id="5361834">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="5361891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5361894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5361898">strdata</span><span class="op" id="5361905">,</span>&nbsp;<span class="ident" id="5361907">err</span>&nbsp;<span class="op" id="5361911">:=</span>&nbsp;<span class="ident" id="5361914">f</span><span class="op" id="5361915">.</span><span class="ident" id="5361916">stringTable</span><span class="op" id="5361927">(</span><span class="ident" id="5361928">symtabSection</span><span class="op" id="5361941">.</span><span class="ident" id="5361942">Link</span><span class="op" id="5361946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361949">if</span>&nbsp;<span class="ident" id="5361952">err</span>&nbsp;<span class="op" id="5361956">!=</span>&nbsp;<span class="ident" id="5361959">nil</span>&nbsp;<span class="op" id="5361963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5361967">return</span>&nbsp;<span class="ident" id="5361974">nil</span><span class="op" id="5361977">,</span>&nbsp;<span class="ident" id="5361979">nil</span><span class="op" id="5361982">,</span>&nbsp;<span class="ident" id="5361984">errors</span><span class="op" id="5361990">.</span><span class="ident" id="5361991">New</span><span class="op" id="5361994">(</span><span class="string" id="5361995">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5362029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5362032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5362036">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362070">var</span>&nbsp;<span class="ident" id="5362074">skip</span>&nbsp;<span class="op" id="5362079">[</span><span class="ident" id="5362080">Sym64Size</span><span class="op" id="5362089">]</span><span class="builtintype" id="5362090">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362096">symtab</span><span class="op" id="5362102">.</span><span class="ident" id="5362103">Read</span><span class="op" id="5362107">(</span><span class="ident" id="5362108">skip</span><span class="op" id="5362112">[</span><span class="op" id="5362113">:</span><span class="op" id="5362114">]</span><span class="op" id="5362115">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362119">symbols</span>&nbsp;<span class="op" id="5362127">:=</span>&nbsp;<span class="builtinfunc" id="5362130">make</span><span class="op" id="5362134">(</span><span class="op" id="5362135">[</span><span class="op" id="5362136">]</span><span class="ident" id="5362137">Symbol</span><span class="op" id="5362143">,</span>&nbsp;<span class="ident" id="5362145">symtab</span><span class="op" id="5362151">.</span><span class="ident" id="5362152">Len</span><span class="op" id="5362155">(</span><span class="op" id="5362156">)</span><span class="op" id="5362157">/</span><span class="ident" id="5362158">Sym64Size</span><span class="op" id="5362167">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362171">i</span>&nbsp;<span class="op" id="5362173">:=</span>&nbsp;<span class="num" id="5362176">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362179">var</span>&nbsp;<span class="ident" id="5362183">sym</span>&nbsp;<span class="ident" id="5362187">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362194">for</span>&nbsp;<span class="ident" id="5362198">symtab</span><span class="op" id="5362204">.</span><span class="ident" id="5362205">Len</span><span class="op" id="5362208">(</span><span class="op" id="5362209">)</span>&nbsp;<span class="op" id="5362211">&gt;</span>&nbsp;<span class="num" id="5362213">0</span>&nbsp;<span class="op" id="5362215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362219">binary</span><span class="op" id="5362225">.</span><span class="ident" id="5362226">Read</span><span class="op" id="5362230">(</span><span class="ident" id="5362231">symtab</span><span class="op" id="5362237">,</span>&nbsp;<span class="ident" id="5362239">f</span><span class="op" id="5362240">.</span><span class="ident" id="5362241">ByteOrder</span><span class="op" id="5362250">,</span>&nbsp;<span class="op" id="5362252">&amp;</span><span class="ident" id="5362253">sym</span><span class="op" id="5362256">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362260">str</span><span class="op" id="5362263">,</span>&nbsp;<span class="ident" id="5362265">_</span>&nbsp;<span class="op" id="5362267">:=</span>&nbsp;<span class="ident" id="5362270">getString</span><span class="op" id="5362279">(</span><span class="ident" id="5362280">strdata</span><span class="op" id="5362287">,</span>&nbsp;<span class="builtintype" id="5362289">int</span><span class="op" id="5362292">(</span><span class="ident" id="5362293">sym</span><span class="op" id="5362296">.</span><span class="ident" id="5362297">Name</span><span class="op" id="5362301">)</span><span class="op" id="5362302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362306">symbols</span><span class="op" id="5362313">[</span><span class="ident" id="5362314">i</span><span class="op" id="5362315">]</span><span class="op" id="5362316">.</span><span class="ident" id="5362317">Name</span>&nbsp;<span class="op" id="5362322">=</span>&nbsp;<span class="ident" id="5362324">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362330">symbols</span><span class="op" id="5362337">[</span><span class="ident" id="5362338">i</span><span class="op" id="5362339">]</span><span class="op" id="5362340">.</span><span class="ident" id="5362341">Info</span>&nbsp;<span class="op" id="5362346">=</span>&nbsp;<span class="ident" id="5362348">sym</span><span class="op" id="5362351">.</span><span class="ident" id="5362352">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362359">symbols</span><span class="op" id="5362366">[</span><span class="ident" id="5362367">i</span><span class="op" id="5362368">]</span><span class="op" id="5362369">.</span><span class="ident" id="5362370">Other</span>&nbsp;<span class="op" id="5362376">=</span>&nbsp;<span class="ident" id="5362378">sym</span><span class="op" id="5362381">.</span><span class="ident" id="5362382">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362390">symbols</span><span class="op" id="5362397">[</span><span class="ident" id="5362398">i</span><span class="op" id="5362399">]</span><span class="op" id="5362400">.</span><span class="ident" id="5362401">Section</span>&nbsp;<span class="op" id="5362409">=</span>&nbsp;<span class="ident" id="5362411">SectionIndex</span><span class="op" id="5362423">(</span><span class="ident" id="5362424">sym</span><span class="op" id="5362427">.</span><span class="ident" id="5362428">Shndx</span><span class="op" id="5362433">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362437">symbols</span><span class="op" id="5362444">[</span><span class="ident" id="5362445">i</span><span class="op" id="5362446">]</span><span class="op" id="5362447">.</span><span class="ident" id="5362448">Value</span>&nbsp;<span class="op" id="5362454">=</span>&nbsp;<span class="ident" id="5362456">sym</span><span class="op" id="5362459">.</span><span class="ident" id="5362460">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362468">symbols</span><span class="op" id="5362475">[</span><span class="ident" id="5362476">i</span><span class="op" id="5362477">]</span><span class="op" id="5362478">.</span><span class="ident" id="5362479">Size</span>&nbsp;<span class="op" id="5362484">=</span>&nbsp;<span class="ident" id="5362486">sym</span><span class="op" id="5362489">.</span><span class="ident" id="5362490">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5362497">i</span><span class="op" id="5362498">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5362502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362506">return</span>&nbsp;<span class="ident" id="5362513">symbols</span><span class="op" id="5362520">,</span>&nbsp;<span class="ident" id="5362522">strdata</span><span class="op" id="5362529">,</span>&nbsp;<span class="ident" id="5362531">nil</span><br>
<span class="lineno"></span><span class="op" id="5362535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5362538">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5362595">func</span>&nbsp;<span class="ident" id="5362600">getString</span><span class="op" id="5362609">(</span><span class="ident" id="5362610">section</span>&nbsp;<span class="op" id="5362618">[</span><span class="op" id="5362619">]</span><span class="builtintype" id="5362620">byte</span><span class="op" id="5362624">,</span>&nbsp;<span class="ident" id="5362626">start</span>&nbsp;<span class="builtintype" id="5362632">int</span><span class="op" id="5362635">)</span>&nbsp;<span class="op" id="5362637">(</span><span class="builtintype" id="5362638">string</span><span class="op" id="5362644">,</span>&nbsp;<span class="builtintype" id="5362646">bool</span><span class="op" id="5362650">)</span>&nbsp;<span class="op" id="5362652">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362655">if</span>&nbsp;<span class="ident" id="5362658">start</span>&nbsp;<span class="op" id="5362664">&lt;</span>&nbsp;<span class="num" id="5362666">0</span>&nbsp;<span class="op" id="5362668">||</span>&nbsp;<span class="ident" id="5362671">start</span>&nbsp;<span class="op" id="5362677">&gt;=</span>&nbsp;<span class="builtinfunc" id="5362680">len</span><span class="op" id="5362683">(</span><span class="ident" id="5362684">section</span><span class="op" id="5362691">)</span>&nbsp;<span class="op" id="5362693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362697">return</span>&nbsp;<span class="string" id="5362704">&#34;&#34;</span><span class="op" id="5362706">,</span>&nbsp;<span class="builtintype" id="5362708">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5362715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362719">for</span>&nbsp;<span class="ident" id="5362723">end</span>&nbsp;<span class="op" id="5362727">:=</span>&nbsp;<span class="ident" id="5362730">start</span><span class="op" id="5362735">;</span>&nbsp;<span class="ident" id="5362737">end</span>&nbsp;<span class="op" id="5362741">&lt;</span>&nbsp;<span class="builtinfunc" id="5362743">len</span><span class="op" id="5362746">(</span><span class="ident" id="5362747">section</span><span class="op" id="5362754">)</span><span class="op" id="5362755">;</span>&nbsp;<span class="ident" id="5362757">end</span><span class="op" id="5362760">++</span>&nbsp;<span class="op" id="5362763">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362767">if</span>&nbsp;<span class="ident" id="5362770">section</span><span class="op" id="5362777">[</span><span class="ident" id="5362778">end</span><span class="op" id="5362781">]</span>&nbsp;<span class="op" id="5362783">==</span>&nbsp;<span class="num" id="5362786">0</span>&nbsp;<span class="op" id="5362788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362793">return</span>&nbsp;<span class="builtintype" id="5362800">string</span><span class="op" id="5362806">(</span><span class="ident" id="5362807">section</span><span class="op" id="5362814">[</span><span class="ident" id="5362815">start</span><span class="op" id="5362820">:</span><span class="ident" id="5362821">end</span><span class="op" id="5362824">]</span><span class="op" id="5362825">)</span><span class="op" id="5362826">,</span>&nbsp;<span class="builtintype" id="5362828">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5362835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5362838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362841">return</span>&nbsp;<span class="string" id="5362848">&#34;&#34;</span><span class="op" id="5362850">,</span>&nbsp;<span class="builtintype" id="5362852">false</span><br>
<span class="lineno">510</span><span class="op" id="5362858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5362861">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5362929">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5362948">func</span>&nbsp;<span class="op" id="5362953">(</span><span class="ident" id="5362954">f</span>&nbsp;<span class="op" id="5362956">*</span><span class="ident" id="5362957">File</span><span class="op" id="5362961">)</span>&nbsp;<span class="ident" id="5362963">Section</span><span class="op" id="5362970">(</span><span class="ident" id="5362971">name</span>&nbsp;<span class="builtintype" id="5362976">string</span><span class="op" id="5362982">)</span>&nbsp;<span class="op" id="5362984">*</span><span class="ident" id="5362985">Section</span>&nbsp;<span class="op" id="5362993">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5362996">for</span>&nbsp;<span class="ident" id="5363000">_</span><span class="op" id="5363001">,</span>&nbsp;<span class="ident" id="5363003">s</span>&nbsp;<span class="op" id="5363005">:=</span>&nbsp;<span class="keyword" id="5363008">range</span>&nbsp;<span class="ident" id="5363014">f</span><span class="op" id="5363015">.</span><span class="ident" id="5363016">Sections</span>&nbsp;<span class="op" id="5363025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363029">if</span>&nbsp;<span class="ident" id="5363032">s</span><span class="op" id="5363033">.</span><span class="ident" id="5363034">Name</span>&nbsp;<span class="op" id="5363039">==</span>&nbsp;<span class="ident" id="5363042">name</span>&nbsp;<span class="op" id="5363047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363052">return</span>&nbsp;<span class="ident" id="5363059">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5363063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5363066">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363069">return</span>&nbsp;<span class="ident" id="5363076">nil</span><br>
<span class="lineno"></span><span class="op" id="5363080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5363083">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="5363161">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="5363180">func</span>&nbsp;<span class="op" id="5363185">(</span><span class="ident" id="5363186">f</span>&nbsp;<span class="op" id="5363188">*</span><span class="ident" id="5363189">File</span><span class="op" id="5363193">)</span>&nbsp;<span class="ident" id="5363195">applyRelocations</span><span class="op" id="5363211">(</span><span class="ident" id="5363212">dst</span>&nbsp;<span class="op" id="5363216">[</span><span class="op" id="5363217">]</span><span class="builtintype" id="5363218">byte</span><span class="op" id="5363222">,</span>&nbsp;<span class="ident" id="5363224">rels</span>&nbsp;<span class="op" id="5363229">[</span><span class="op" id="5363230">]</span><span class="builtintype" id="5363231">byte</span><span class="op" id="5363235">)</span>&nbsp;<span class="builtintype" id="5363237">error</span>&nbsp;<span class="op" id="5363243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363246">if</span>&nbsp;<span class="ident" id="5363249">f</span><span class="op" id="5363250">.</span><span class="ident" id="5363251">Class</span>&nbsp;<span class="op" id="5363257">==</span>&nbsp;<span class="ident" id="5363260">ELFCLASS64</span>&nbsp;<span class="op" id="5363271">&amp;&amp;</span>&nbsp;<span class="ident" id="5363274">f</span><span class="op" id="5363275">.</span><span class="ident" id="5363276">Machine</span>&nbsp;<span class="op" id="5363284">==</span>&nbsp;<span class="ident" id="5363287">EM_X86_64</span>&nbsp;<span class="op" id="5363297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363301">return</span>&nbsp;<span class="ident" id="5363308">f</span><span class="op" id="5363309">.</span><span class="ident" id="5363310">applyRelocationsAMD64</span><span class="op" id="5363331">(</span><span class="ident" id="5363332">dst</span><span class="op" id="5363335">,</span>&nbsp;<span class="ident" id="5363337">rels</span><span class="op" id="5363341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5363344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363347">if</span>&nbsp;<span class="ident" id="5363350">f</span><span class="op" id="5363351">.</span><span class="ident" id="5363352">Class</span>&nbsp;<span class="op" id="5363358">==</span>&nbsp;<span class="ident" id="5363361">ELFCLASS32</span>&nbsp;<span class="op" id="5363372">&amp;&amp;</span>&nbsp;<span class="ident" id="5363375">f</span><span class="op" id="5363376">.</span><span class="ident" id="5363377">Machine</span>&nbsp;<span class="op" id="5363385">==</span>&nbsp;<span class="ident" id="5363388">EM_386</span>&nbsp;<span class="op" id="5363395">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363399">return</span>&nbsp;<span class="ident" id="5363406">f</span><span class="op" id="5363407">.</span><span class="ident" id="5363408">applyRelocations386</span><span class="op" id="5363427">(</span><span class="ident" id="5363428">dst</span><span class="op" id="5363431">,</span>&nbsp;<span class="ident" id="5363433">rels</span><span class="op" id="5363437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5363440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363443">if</span>&nbsp;<span class="ident" id="5363446">f</span><span class="op" id="5363447">.</span><span class="ident" id="5363448">Class</span>&nbsp;<span class="op" id="5363454">==</span>&nbsp;<span class="ident" id="5363457">ELFCLASS64</span>&nbsp;<span class="op" id="5363468">&amp;&amp;</span>&nbsp;<span class="ident" id="5363471">f</span><span class="op" id="5363472">.</span><span class="ident" id="5363473">Machine</span>&nbsp;<span class="op" id="5363481">==</span>&nbsp;<span class="ident" id="5363484">EM_AARCH64</span>&nbsp;<span class="op" id="5363495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363499">return</span>&nbsp;<span class="ident" id="5363506">f</span><span class="op" id="5363507">.</span><span class="ident" id="5363508">applyRelocationsARM64</span><span class="op" id="5363529">(</span><span class="ident" id="5363530">dst</span><span class="op" id="5363533">,</span>&nbsp;<span class="ident" id="5363535">rels</span><span class="op" id="5363539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5363542">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363546">return</span>&nbsp;<span class="ident" id="5363553">errors</span><span class="op" id="5363559">.</span><span class="ident" id="5363560">New</span><span class="op" id="5363563">(</span><span class="string" id="5363564">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5363581">)</span><br>
<span class="lineno"></span><span class="op" id="5363583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5363586">func</span>&nbsp;<span class="op" id="5363591">(</span><span class="ident" id="5363592">f</span>&nbsp;<span class="op" id="5363594">*</span><span class="ident" id="5363595">File</span><span class="op" id="5363599">)</span>&nbsp;<span class="ident" id="5363601">applyRelocationsAMD64</span><span class="op" id="5363622">(</span><span class="ident" id="5363623">dst</span>&nbsp;<span class="op" id="5363627">[</span><span class="op" id="5363628">]</span><span class="builtintype" id="5363629">byte</span><span class="op" id="5363633">,</span>&nbsp;<span class="ident" id="5363635">rels</span>&nbsp;<span class="op" id="5363640">[</span><span class="op" id="5363641">]</span><span class="builtintype" id="5363642">byte</span><span class="op" id="5363646">)</span>&nbsp;<span class="builtintype" id="5363648">error</span>&nbsp;<span class="op" id="5363654">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5363657">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363687">if</span>&nbsp;<span class="builtinfunc" id="5363690">len</span><span class="op" id="5363693">(</span><span class="ident" id="5363694">rels</span><span class="op" id="5363698">)</span><span class="op" id="5363699">%</span><span class="num" id="5363700">24</span>&nbsp;<span class="op" id="5363703">!=</span>&nbsp;<span class="num" id="5363706">0</span>&nbsp;<span class="op" id="5363708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363712">return</span>&nbsp;<span class="ident" id="5363719">errors</span><span class="op" id="5363725">.</span><span class="ident" id="5363726">New</span><span class="op" id="5363729">(</span><span class="string" id="5363730">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5363784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5363787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5363791">symbols</span><span class="op" id="5363798">,</span>&nbsp;<span class="ident" id="5363800">_</span><span class="op" id="5363801">,</span>&nbsp;<span class="ident" id="5363803">err</span>&nbsp;<span class="op" id="5363807">:=</span>&nbsp;<span class="ident" id="5363810">f</span><span class="op" id="5363811">.</span><span class="ident" id="5363812">getSymbols</span><span class="op" id="5363822">(</span><span class="ident" id="5363823">SHT_SYMTAB</span><span class="op" id="5363833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363836">if</span>&nbsp;<span class="ident" id="5363839">err</span>&nbsp;<span class="op" id="5363843">!=</span>&nbsp;<span class="ident" id="5363846">nil</span>&nbsp;<span class="op" id="5363850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363854">return</span>&nbsp;<span class="ident" id="5363861">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5363866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5363870">b</span>&nbsp;<span class="op" id="5363872">:=</span>&nbsp;<span class="ident" id="5363875">bytes</span><span class="op" id="5363880">.</span><span class="ident" id="5363881">NewReader</span><span class="op" id="5363890">(</span><span class="ident" id="5363891">rels</span><span class="op" id="5363895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363898">var</span>&nbsp;<span class="ident" id="5363902">rela</span>&nbsp;<span class="ident" id="5363907">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5363916">for</span>&nbsp;<span class="ident" id="5363920">b</span><span class="op" id="5363921">.</span><span class="ident" id="5363922">Len</span><span class="op" id="5363925">(</span><span class="op" id="5363926">)</span>&nbsp;<span class="op" id="5363928">&gt;</span>&nbsp;<span class="num" id="5363930">0</span>&nbsp;<span class="op" id="5363932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5363936">binary</span><span class="op" id="5363942">.</span><span class="ident" id="5363943">Read</span><span class="op" id="5363947">(</span><span class="ident" id="5363948">b</span><span class="op" id="5363949">,</span>&nbsp;<span class="ident" id="5363951">f</span><span class="op" id="5363952">.</span><span class="ident" id="5363953">ByteOrder</span><span class="op" id="5363962">,</span>&nbsp;<span class="op" id="5363964">&amp;</span><span class="ident" id="5363965">rela</span><span class="op" id="5363969">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5363973">symNo</span>&nbsp;<span class="op" id="5363979">:=</span>&nbsp;<span class="ident" id="5363982">rela</span><span class="op" id="5363986">.</span><span class="ident" id="5363987">Info</span>&nbsp;<span class="op" id="5363992">&gt;&gt;</span>&nbsp;<span class="num" id="5363995">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364000">t</span>&nbsp;<span class="op" id="5364002">:=</span>&nbsp;<span class="ident" id="5364005">R_X86_64</span><span class="op" id="5364013">(</span><span class="ident" id="5364014">rela</span><span class="op" id="5364018">.</span><span class="ident" id="5364019">Info</span>&nbsp;<span class="op" id="5364024">&amp;</span>&nbsp;<span class="num" id="5364026">0xffff</span><span class="op" id="5364032">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364037">if</span>&nbsp;<span class="ident" id="5364040">symNo</span>&nbsp;<span class="op" id="5364046">==</span>&nbsp;<span class="num" id="5364049">0</span>&nbsp;<span class="op" id="5364051">||</span>&nbsp;<span class="ident" id="5364054">symNo</span>&nbsp;<span class="op" id="5364060">&gt;</span>&nbsp;<span class="ident" id="5364062">uint64</span><span class="op" id="5364068">(</span><span class="builtinfunc" id="5364069">len</span><span class="op" id="5364072">(</span><span class="ident" id="5364073">symbols</span><span class="op" id="5364080">)</span><span class="op" id="5364081">)</span>&nbsp;<span class="op" id="5364083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364088">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364103">sym</span>&nbsp;<span class="op" id="5364107">:=</span>&nbsp;<span class="op" id="5364110">&amp;</span><span class="ident" id="5364111">symbols</span><span class="op" id="5364118">[</span><span class="ident" id="5364119">symNo</span><span class="op" id="5364124">-</span><span class="num" id="5364125">1</span><span class="op" id="5364126">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364130">if</span>&nbsp;<span class="ident" id="5364133">SymType</span><span class="op" id="5364140">(</span><span class="ident" id="5364141">sym</span><span class="op" id="5364144">.</span><span class="ident" id="5364145">Info</span><span class="op" id="5364149">&amp;</span><span class="num" id="5364150">0xf</span><span class="op" id="5364153">)</span>&nbsp;<span class="op" id="5364155">!=</span>&nbsp;<span class="ident" id="5364158">STT_SECTION</span>&nbsp;<span class="op" id="5364170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5364175">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364230">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5364246">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5364299">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5364354">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364401">switch</span>&nbsp;<span class="ident" id="5364408">t</span>&nbsp;<span class="op" id="5364410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364414">case</span>&nbsp;<span class="ident" id="5364419">R_X86_64_64</span><span class="op" id="5364430">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364435">if</span>&nbsp;<span class="ident" id="5364438">rela</span><span class="op" id="5364442">.</span><span class="ident" id="5364443">Off</span><span class="op" id="5364446">+</span><span class="num" id="5364447">8</span>&nbsp;<span class="op" id="5364449">&gt;=</span>&nbsp;<span class="ident" id="5364452">uint64</span><span class="op" id="5364458">(</span><span class="builtinfunc" id="5364459">len</span><span class="op" id="5364462">(</span><span class="ident" id="5364463">dst</span><span class="op" id="5364466">)</span><span class="op" id="5364467">)</span>&nbsp;<span class="op" id="5364469">||</span>&nbsp;<span class="ident" id="5364472">rela</span><span class="op" id="5364476">.</span><span class="ident" id="5364477">Addend</span>&nbsp;<span class="op" id="5364484">&lt;</span>&nbsp;<span class="num" id="5364486">0</span>&nbsp;<span class="op" id="5364488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364494">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364511">f</span><span class="op" id="5364512">.</span><span class="ident" id="5364513">ByteOrder</span><span class="op" id="5364522">.</span><span class="ident" id="5364523">PutUint64</span><span class="op" id="5364532">(</span><span class="ident" id="5364533">dst</span><span class="op" id="5364536">[</span><span class="ident" id="5364537">rela</span><span class="op" id="5364541">.</span><span class="ident" id="5364542">Off</span><span class="op" id="5364545">:</span><span class="ident" id="5364546">rela</span><span class="op" id="5364550">.</span><span class="ident" id="5364551">Off</span><span class="op" id="5364554">+</span><span class="num" id="5364555">8</span><span class="op" id="5364556">]</span><span class="op" id="5364557">,</span>&nbsp;<span class="ident" id="5364559">uint64</span><span class="op" id="5364565">(</span><span class="ident" id="5364566">rela</span><span class="op" id="5364570">.</span><span class="ident" id="5364571">Addend</span><span class="op" id="5364577">)</span><span class="op" id="5364578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364582">case</span>&nbsp;<span class="ident" id="5364587">R_X86_64_32</span><span class="op" id="5364598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364603">if</span>&nbsp;<span class="ident" id="5364606">rela</span><span class="op" id="5364610">.</span><span class="ident" id="5364611">Off</span><span class="op" id="5364614">+</span><span class="num" id="5364615">4</span>&nbsp;<span class="op" id="5364617">&gt;=</span>&nbsp;<span class="ident" id="5364620">uint64</span><span class="op" id="5364626">(</span><span class="builtinfunc" id="5364627">len</span><span class="op" id="5364630">(</span><span class="ident" id="5364631">dst</span><span class="op" id="5364634">)</span><span class="op" id="5364635">)</span>&nbsp;<span class="op" id="5364637">||</span>&nbsp;<span class="ident" id="5364640">rela</span><span class="op" id="5364644">.</span><span class="ident" id="5364645">Addend</span>&nbsp;<span class="op" id="5364652">&lt;</span>&nbsp;<span class="num" id="5364654">0</span>&nbsp;<span class="op" id="5364656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364662">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364679">f</span><span class="op" id="5364680">.</span><span class="ident" id="5364681">ByteOrder</span><span class="op" id="5364690">.</span><span class="ident" id="5364691">PutUint32</span><span class="op" id="5364700">(</span><span class="ident" id="5364701">dst</span><span class="op" id="5364704">[</span><span class="ident" id="5364705">rela</span><span class="op" id="5364709">.</span><span class="ident" id="5364710">Off</span><span class="op" id="5364713">:</span><span class="ident" id="5364714">rela</span><span class="op" id="5364718">.</span><span class="ident" id="5364719">Off</span><span class="op" id="5364722">+</span><span class="num" id="5364723">4</span><span class="op" id="5364724">]</span><span class="op" id="5364725">,</span>&nbsp;<span class="builtintype" id="5364727">uint32</span><span class="op" id="5364733">(</span><span class="ident" id="5364734">rela</span><span class="op" id="5364738">.</span><span class="ident" id="5364739">Addend</span><span class="op" id="5364745">)</span><span class="op" id="5364746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364757">return</span>&nbsp;<span class="ident" id="5364764">nil</span><br>
<span class="lineno"></span><span class="op" id="5364768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5364771">func</span>&nbsp;<span class="op" id="5364776">(</span><span class="ident" id="5364777">f</span>&nbsp;<span class="op" id="5364779">*</span><span class="ident" id="5364780">File</span><span class="op" id="5364784">)</span>&nbsp;<span class="ident" id="5364786">applyRelocations386</span><span class="op" id="5364805">(</span><span class="ident" id="5364806">dst</span>&nbsp;<span class="op" id="5364810">[</span><span class="op" id="5364811">]</span><span class="builtintype" id="5364812">byte</span><span class="op" id="5364816">,</span>&nbsp;<span class="ident" id="5364818">rels</span>&nbsp;<span class="op" id="5364823">[</span><span class="op" id="5364824">]</span><span class="builtintype" id="5364825">byte</span><span class="op" id="5364829">)</span>&nbsp;<span class="builtintype" id="5364831">error</span>&nbsp;<span class="op" id="5364837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5364840">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364868">if</span>&nbsp;<span class="builtinfunc" id="5364871">len</span><span class="op" id="5364874">(</span><span class="ident" id="5364875">rels</span><span class="op" id="5364879">)</span><span class="op" id="5364880">%</span><span class="num" id="5364881">8</span>&nbsp;<span class="op" id="5364883">!=</span>&nbsp;<span class="num" id="5364886">0</span>&nbsp;<span class="op" id="5364888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5364892">return</span>&nbsp;<span class="ident" id="5364899">errors</span><span class="op" id="5364905">.</span><span class="ident" id="5364906">New</span><span class="op" id="5364909">(</span><span class="string" id="5364910">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="5364963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5364966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5364970">symbols</span><span class="op" id="5364977">,</span>&nbsp;<span class="ident" id="5364979">_</span><span class="op" id="5364980">,</span>&nbsp;<span class="ident" id="5364982">err</span>&nbsp;<span class="op" id="5364986">:=</span>&nbsp;<span class="ident" id="5364989">f</span><span class="op" id="5364990">.</span><span class="ident" id="5364991">getSymbols</span><span class="op" id="5365001">(</span><span class="ident" id="5365002">SHT_SYMTAB</span><span class="op" id="5365012">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365015">if</span>&nbsp;<span class="ident" id="5365018">err</span>&nbsp;<span class="op" id="5365022">!=</span>&nbsp;<span class="ident" id="5365025">nil</span>&nbsp;<span class="op" id="5365029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365033">return</span>&nbsp;<span class="ident" id="5365040">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365049">b</span>&nbsp;<span class="op" id="5365051">:=</span>&nbsp;<span class="ident" id="5365054">bytes</span><span class="op" id="5365059">.</span><span class="ident" id="5365060">NewReader</span><span class="op" id="5365069">(</span><span class="ident" id="5365070">rels</span><span class="op" id="5365074">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365077">var</span>&nbsp;<span class="ident" id="5365081">rel</span>&nbsp;<span class="ident" id="5365085">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365093">for</span>&nbsp;<span class="ident" id="5365097">b</span><span class="op" id="5365098">.</span><span class="ident" id="5365099">Len</span><span class="op" id="5365102">(</span><span class="op" id="5365103">)</span>&nbsp;<span class="op" id="5365105">&gt;</span>&nbsp;<span class="num" id="5365107">0</span>&nbsp;<span class="op" id="5365109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365113">binary</span><span class="op" id="5365119">.</span><span class="ident" id="5365120">Read</span><span class="op" id="5365124">(</span><span class="ident" id="5365125">b</span><span class="op" id="5365126">,</span>&nbsp;<span class="ident" id="5365128">f</span><span class="op" id="5365129">.</span><span class="ident" id="5365130">ByteOrder</span><span class="op" id="5365139">,</span>&nbsp;<span class="op" id="5365141">&amp;</span><span class="ident" id="5365142">rel</span><span class="op" id="5365145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365149">symNo</span>&nbsp;<span class="op" id="5365155">:=</span>&nbsp;<span class="ident" id="5365158">rel</span><span class="op" id="5365161">.</span><span class="ident" id="5365162">Info</span>&nbsp;<span class="op" id="5365167">&gt;&gt;</span>&nbsp;<span class="num" id="5365170">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365174">t</span>&nbsp;<span class="op" id="5365176">:=</span>&nbsp;<span class="ident" id="5365179">R_386</span><span class="op" id="5365184">(</span><span class="ident" id="5365185">rel</span><span class="op" id="5365188">.</span><span class="ident" id="5365189">Info</span>&nbsp;<span class="op" id="5365194">&amp;</span>&nbsp;<span class="num" id="5365196">0xff</span><span class="op" id="5365200">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365205">if</span>&nbsp;<span class="ident" id="5365208">symNo</span>&nbsp;<span class="op" id="5365214">==</span>&nbsp;<span class="num" id="5365217">0</span>&nbsp;<span class="op" id="5365219">||</span>&nbsp;<span class="ident" id="5365222">symNo</span>&nbsp;<span class="op" id="5365228">&gt;</span>&nbsp;<span class="builtintype" id="5365230">uint32</span><span class="op" id="5365236">(</span><span class="builtinfunc" id="5365237">len</span><span class="op" id="5365240">(</span><span class="ident" id="5365241">symbols</span><span class="op" id="5365248">)</span><span class="op" id="5365249">)</span>&nbsp;<span class="op" id="5365251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365256">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365267">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365271">sym</span>&nbsp;<span class="op" id="5365275">:=</span>&nbsp;<span class="op" id="5365278">&amp;</span><span class="ident" id="5365279">symbols</span><span class="op" id="5365286">[</span><span class="ident" id="5365287">symNo</span><span class="op" id="5365292">-</span><span class="num" id="5365293">1</span><span class="op" id="5365294">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365299">if</span>&nbsp;<span class="ident" id="5365302">t</span>&nbsp;<span class="op" id="5365304">==</span>&nbsp;<span class="ident" id="5365307">R_386_32</span>&nbsp;<span class="op" id="5365316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365321">if</span>&nbsp;<span class="ident" id="5365324">rel</span><span class="op" id="5365327">.</span><span class="ident" id="5365328">Off</span><span class="op" id="5365331">+</span><span class="num" id="5365332">4</span>&nbsp;<span class="op" id="5365334">&gt;=</span>&nbsp;<span class="builtintype" id="5365337">uint32</span><span class="op" id="5365343">(</span><span class="builtinfunc" id="5365344">len</span><span class="op" id="5365347">(</span><span class="ident" id="5365348">dst</span><span class="op" id="5365351">)</span><span class="op" id="5365352">)</span>&nbsp;<span class="op" id="5365354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365360">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365377">val</span>&nbsp;<span class="op" id="5365381">:=</span>&nbsp;<span class="ident" id="5365384">f</span><span class="op" id="5365385">.</span><span class="ident" id="5365386">ByteOrder</span><span class="op" id="5365395">.</span><span class="ident" id="5365396">Uint32</span><span class="op" id="5365402">(</span><span class="ident" id="5365403">dst</span><span class="op" id="5365406">[</span><span class="ident" id="5365407">rel</span><span class="op" id="5365410">.</span><span class="ident" id="5365411">Off</span>&nbsp;<span class="op" id="5365415">:</span>&nbsp;<span class="ident" id="5365417">rel</span><span class="op" id="5365420">.</span><span class="ident" id="5365421">Off</span><span class="op" id="5365424">+</span><span class="num" id="5365425">4</span><span class="op" id="5365426">]</span><span class="op" id="5365427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365432">val</span>&nbsp;<span class="op" id="5365436">+=</span>&nbsp;<span class="builtintype" id="5365439">uint32</span><span class="op" id="5365445">(</span><span class="ident" id="5365446">sym</span><span class="op" id="5365449">.</span><span class="ident" id="5365450">Value</span><span class="op" id="5365455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365460">f</span><span class="op" id="5365461">.</span><span class="ident" id="5365462">ByteOrder</span><span class="op" id="5365471">.</span><span class="ident" id="5365472">PutUint32</span><span class="op" id="5365481">(</span><span class="ident" id="5365482">dst</span><span class="op" id="5365485">[</span><span class="ident" id="5365486">rel</span><span class="op" id="5365489">.</span><span class="ident" id="5365490">Off</span><span class="op" id="5365493">:</span><span class="ident" id="5365494">rel</span><span class="op" id="5365497">.</span><span class="ident" id="5365498">Off</span><span class="op" id="5365501">+</span><span class="num" id="5365502">4</span><span class="op" id="5365503">]</span><span class="op" id="5365504">,</span>&nbsp;<span class="ident" id="5365506">val</span><span class="op" id="5365509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365513">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365520">return</span>&nbsp;<span class="ident" id="5365527">nil</span><br>
<span class="lineno"></span><span class="op" id="5365531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="5365534">func</span>&nbsp;<span class="op" id="5365539">(</span><span class="ident" id="5365540">f</span>&nbsp;<span class="op" id="5365542">*</span><span class="ident" id="5365543">File</span><span class="op" id="5365547">)</span>&nbsp;<span class="ident" id="5365549">applyRelocationsARM64</span><span class="op" id="5365570">(</span><span class="ident" id="5365571">dst</span>&nbsp;<span class="op" id="5365575">[</span><span class="op" id="5365576">]</span><span class="builtintype" id="5365577">byte</span><span class="op" id="5365581">,</span>&nbsp;<span class="ident" id="5365583">rels</span>&nbsp;<span class="op" id="5365588">[</span><span class="op" id="5365589">]</span><span class="builtintype" id="5365590">byte</span><span class="op" id="5365594">)</span>&nbsp;<span class="builtintype" id="5365596">error</span>&nbsp;<span class="op" id="5365602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5365605">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365635">if</span>&nbsp;<span class="builtinfunc" id="5365638">len</span><span class="op" id="5365641">(</span><span class="ident" id="5365642">rels</span><span class="op" id="5365646">)</span><span class="op" id="5365647">%</span><span class="num" id="5365648">24</span>&nbsp;<span class="op" id="5365651">!=</span>&nbsp;<span class="num" id="5365654">0</span>&nbsp;<span class="op" id="5365656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365660">return</span>&nbsp;<span class="ident" id="5365667">errors</span><span class="op" id="5365673">.</span><span class="ident" id="5365674">New</span><span class="op" id="5365677">(</span><span class="string" id="5365678">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5365732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365735">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365739">symbols</span><span class="op" id="5365746">,</span>&nbsp;<span class="ident" id="5365748">_</span><span class="op" id="5365749">,</span>&nbsp;<span class="ident" id="5365751">err</span>&nbsp;<span class="op" id="5365755">:=</span>&nbsp;<span class="ident" id="5365758">f</span><span class="op" id="5365759">.</span><span class="ident" id="5365760">getSymbols</span><span class="op" id="5365770">(</span><span class="ident" id="5365771">SHT_SYMTAB</span><span class="op" id="5365781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365784">if</span>&nbsp;<span class="ident" id="5365787">err</span>&nbsp;<span class="op" id="5365791">!=</span>&nbsp;<span class="ident" id="5365794">nil</span>&nbsp;<span class="op" id="5365798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365802">return</span>&nbsp;<span class="ident" id="5365809">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5365814">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365818">b</span>&nbsp;<span class="op" id="5365820">:=</span>&nbsp;<span class="ident" id="5365823">bytes</span><span class="op" id="5365828">.</span><span class="ident" id="5365829">NewReader</span><span class="op" id="5365838">(</span><span class="ident" id="5365839">rels</span><span class="op" id="5365843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365846">var</span>&nbsp;<span class="ident" id="5365850">rela</span>&nbsp;<span class="ident" id="5365855">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365864">for</span>&nbsp;<span class="ident" id="5365868">b</span><span class="op" id="5365869">.</span><span class="ident" id="5365870">Len</span><span class="op" id="5365873">(</span><span class="op" id="5365874">)</span>&nbsp;<span class="op" id="5365876">&gt;</span>&nbsp;<span class="num" id="5365878">0</span>&nbsp;<span class="op" id="5365880">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365884">binary</span><span class="op" id="5365890">.</span><span class="ident" id="5365891">Read</span><span class="op" id="5365895">(</span><span class="ident" id="5365896">b</span><span class="op" id="5365897">,</span>&nbsp;<span class="ident" id="5365899">f</span><span class="op" id="5365900">.</span><span class="ident" id="5365901">ByteOrder</span><span class="op" id="5365910">,</span>&nbsp;<span class="op" id="5365912">&amp;</span><span class="ident" id="5365913">rela</span><span class="op" id="5365917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365921">symNo</span>&nbsp;<span class="op" id="5365927">:=</span>&nbsp;<span class="ident" id="5365930">rela</span><span class="op" id="5365934">.</span><span class="ident" id="5365935">Info</span>&nbsp;<span class="op" id="5365940">&gt;&gt;</span>&nbsp;<span class="num" id="5365943">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5365948">t</span>&nbsp;<span class="op" id="5365950">:=</span>&nbsp;<span class="ident" id="5365953">R_AARCH64</span><span class="op" id="5365962">(</span><span class="ident" id="5365963">rela</span><span class="op" id="5365967">.</span><span class="ident" id="5365968">Info</span>&nbsp;<span class="op" id="5365973">&amp;</span>&nbsp;<span class="num" id="5365975">0xffff</span><span class="op" id="5365981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5365986">if</span>&nbsp;<span class="ident" id="5365989">symNo</span>&nbsp;<span class="op" id="5365995">==</span>&nbsp;<span class="num" id="5365998">0</span>&nbsp;<span class="op" id="5366000">||</span>&nbsp;<span class="ident" id="5366003">symNo</span>&nbsp;<span class="op" id="5366009">&gt;</span>&nbsp;<span class="ident" id="5366011">uint64</span><span class="op" id="5366017">(</span><span class="builtinfunc" id="5366018">len</span><span class="op" id="5366021">(</span><span class="ident" id="5366022">symbols</span><span class="op" id="5366029">)</span><span class="op" id="5366030">)</span>&nbsp;<span class="op" id="5366032">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366037">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366052">sym</span>&nbsp;<span class="op" id="5366056">:=</span>&nbsp;<span class="op" id="5366059">&amp;</span><span class="ident" id="5366060">symbols</span><span class="op" id="5366067">[</span><span class="ident" id="5366068">symNo</span><span class="op" id="5366073">-</span><span class="num" id="5366074">1</span><span class="op" id="5366075">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366079">if</span>&nbsp;<span class="ident" id="5366082">SymType</span><span class="op" id="5366089">(</span><span class="ident" id="5366090">sym</span><span class="op" id="5366093">.</span><span class="ident" id="5366094">Info</span><span class="op" id="5366098">&amp;</span><span class="num" id="5366099">0xf</span><span class="op" id="5366102">)</span>&nbsp;<span class="op" id="5366104">!=</span>&nbsp;<span class="ident" id="5366107">STT_SECTION</span>&nbsp;<span class="op" id="5366119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5366124">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366179">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5366195">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5366248">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5366303">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366350">switch</span>&nbsp;<span class="ident" id="5366357">t</span>&nbsp;<span class="op" id="5366359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366363">case</span>&nbsp;<span class="ident" id="5366368">R_AARCH64_ABS64</span><span class="op" id="5366383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366388">if</span>&nbsp;<span class="ident" id="5366391">rela</span><span class="op" id="5366395">.</span><span class="ident" id="5366396">Off</span><span class="op" id="5366399">+</span><span class="num" id="5366400">8</span>&nbsp;<span class="op" id="5366402">&gt;=</span>&nbsp;<span class="ident" id="5366405">uint64</span><span class="op" id="5366411">(</span><span class="builtinfunc" id="5366412">len</span><span class="op" id="5366415">(</span><span class="ident" id="5366416">dst</span><span class="op" id="5366419">)</span><span class="op" id="5366420">)</span>&nbsp;<span class="op" id="5366422">||</span>&nbsp;<span class="ident" id="5366425">rela</span><span class="op" id="5366429">.</span><span class="ident" id="5366430">Addend</span>&nbsp;<span class="op" id="5366437">&lt;</span>&nbsp;<span class="num" id="5366439">0</span>&nbsp;<span class="op" id="5366441">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366447">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366464">f</span><span class="op" id="5366465">.</span><span class="ident" id="5366466">ByteOrder</span><span class="op" id="5366475">.</span><span class="ident" id="5366476">PutUint64</span><span class="op" id="5366485">(</span><span class="ident" id="5366486">dst</span><span class="op" id="5366489">[</span><span class="ident" id="5366490">rela</span><span class="op" id="5366494">.</span><span class="ident" id="5366495">Off</span><span class="op" id="5366498">:</span><span class="ident" id="5366499">rela</span><span class="op" id="5366503">.</span><span class="ident" id="5366504">Off</span><span class="op" id="5366507">+</span><span class="num" id="5366508">8</span><span class="op" id="5366509">]</span><span class="op" id="5366510">,</span>&nbsp;<span class="ident" id="5366512">uint64</span><span class="op" id="5366518">(</span><span class="ident" id="5366519">rela</span><span class="op" id="5366523">.</span><span class="ident" id="5366524">Addend</span><span class="op" id="5366530">)</span><span class="op" id="5366531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366535">case</span>&nbsp;<span class="ident" id="5366540">R_AARCH64_ABS32</span><span class="op" id="5366555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366560">if</span>&nbsp;<span class="ident" id="5366563">rela</span><span class="op" id="5366567">.</span><span class="ident" id="5366568">Off</span><span class="op" id="5366571">+</span><span class="num" id="5366572">4</span>&nbsp;<span class="op" id="5366574">&gt;=</span>&nbsp;<span class="ident" id="5366577">uint64</span><span class="op" id="5366583">(</span><span class="builtinfunc" id="5366584">len</span><span class="op" id="5366587">(</span><span class="ident" id="5366588">dst</span><span class="op" id="5366591">)</span><span class="op" id="5366592">)</span>&nbsp;<span class="op" id="5366594">||</span>&nbsp;<span class="ident" id="5366597">rela</span><span class="op" id="5366601">.</span><span class="ident" id="5366602">Addend</span>&nbsp;<span class="op" id="5366609">&lt;</span>&nbsp;<span class="num" id="5366611">0</span>&nbsp;<span class="op" id="5366613">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366619">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366636">f</span><span class="op" id="5366637">.</span><span class="ident" id="5366638">ByteOrder</span><span class="op" id="5366647">.</span><span class="ident" id="5366648">PutUint32</span><span class="op" id="5366657">(</span><span class="ident" id="5366658">dst</span><span class="op" id="5366661">[</span><span class="ident" id="5366662">rela</span><span class="op" id="5366666">.</span><span class="ident" id="5366667">Off</span><span class="op" id="5366670">:</span><span class="ident" id="5366671">rela</span><span class="op" id="5366675">.</span><span class="ident" id="5366676">Off</span><span class="op" id="5366679">+</span><span class="num" id="5366680">4</span><span class="op" id="5366681">]</span><span class="op" id="5366682">,</span>&nbsp;<span class="builtintype" id="5366684">uint32</span><span class="op" id="5366690">(</span><span class="ident" id="5366691">rela</span><span class="op" id="5366695">.</span><span class="ident" id="5366696">Addend</span><span class="op" id="5366702">)</span><span class="op" id="5366703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5366710">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366714">return</span>&nbsp;<span class="ident" id="5366721">nil</span><br>
<span class="lineno"></span><span class="op" id="5366725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5366728">func</span>&nbsp;<span class="op" id="5366733">(</span><span class="ident" id="5366734">f</span>&nbsp;<span class="op" id="5366736">*</span><span class="ident" id="5366737">File</span><span class="op" id="5366741">)</span>&nbsp;<span class="ident" id="5366743">DWARF</span><span class="op" id="5366748">(</span><span class="op" id="5366749">)</span>&nbsp;<span class="op" id="5366751">(</span><span class="op" id="5366752">*</span><span class="ident" id="5366753">dwarf</span><span class="op" id="5366758">.</span><span class="ident" id="5366759">Data</span><span class="op" id="5366763">,</span>&nbsp;<span class="builtintype" id="5366765">error</span><span class="op" id="5366770">)</span>&nbsp;<span class="op" id="5366772">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5366775">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5366826">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5366881">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366940">var</span>&nbsp;<span class="ident" id="5366944">names</span>&nbsp;<span class="op" id="5366950">=</span>&nbsp;<span class="op" id="5366952">[</span><span class="op" id="5366953">...</span><span class="op" id="5366956">]</span><span class="builtintype" id="5366957">string</span><span class="op" id="5366963">{</span><span class="string" id="5366964">&#34;abbrev&#34;</span><span class="op" id="5366972">,</span>&nbsp;<span class="string" id="5366974">&#34;info&#34;</span><span class="op" id="5366980">,</span>&nbsp;<span class="string" id="5366982">&#34;str&#34;</span><span class="op" id="5366987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5366990">var</span>&nbsp;<span class="ident" id="5366994">dat</span>&nbsp;<span class="op" id="5366998">[</span><span class="builtinfunc" id="5366999">len</span><span class="op" id="5367002">(</span><span class="ident" id="5367003">names</span><span class="op" id="5367008">)</span><span class="op" id="5367009">]</span><span class="op" id="5367010">[</span><span class="op" id="5367011">]</span><span class="builtintype" id="5367012">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367018">for</span>&nbsp;<span class="ident" id="5367022">i</span><span class="op" id="5367023">,</span>&nbsp;<span class="ident" id="5367025">name</span>&nbsp;<span class="op" id="5367030">:=</span>&nbsp;<span class="keyword" id="5367033">range</span>&nbsp;<span class="ident" id="5367039">names</span>&nbsp;<span class="op" id="5367045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367049">name</span>&nbsp;<span class="op" id="5367054">=</span>&nbsp;<span class="string" id="5367056">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5367066">+</span>&nbsp;<span class="ident" id="5367068">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367075">s</span>&nbsp;<span class="op" id="5367077">:=</span>&nbsp;<span class="ident" id="5367080">f</span><span class="op" id="5367081">.</span><span class="ident" id="5367082">Section</span><span class="op" id="5367089">(</span><span class="ident" id="5367090">name</span><span class="op" id="5367094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367098">if</span>&nbsp;<span class="ident" id="5367101">s</span>&nbsp;<span class="op" id="5367103">==</span>&nbsp;<span class="ident" id="5367106">nil</span>&nbsp;<span class="op" id="5367110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367115">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5367126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367130">b</span><span class="op" id="5367131">,</span>&nbsp;<span class="ident" id="5367133">err</span>&nbsp;<span class="op" id="5367137">:=</span>&nbsp;<span class="ident" id="5367140">s</span><span class="op" id="5367141">.</span><span class="ident" id="5367142">Data</span><span class="op" id="5367146">(</span><span class="op" id="5367147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367151">if</span>&nbsp;<span class="ident" id="5367154">err</span>&nbsp;<span class="op" id="5367158">!=</span>&nbsp;<span class="ident" id="5367161">nil</span>&nbsp;<span class="op" id="5367165">&amp;&amp;</span>&nbsp;<span class="ident" id="5367168">uint64</span><span class="op" id="5367174">(</span><span class="builtinfunc" id="5367175">len</span><span class="op" id="5367178">(</span><span class="ident" id="5367179">b</span><span class="op" id="5367180">)</span><span class="op" id="5367181">)</span>&nbsp;<span class="op" id="5367183">&lt;</span>&nbsp;<span class="ident" id="5367185">s</span><span class="op" id="5367186">.</span><span class="ident" id="5367187">Size</span>&nbsp;<span class="op" id="5367192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367197">return</span>&nbsp;<span class="ident" id="5367204">nil</span><span class="op" id="5367207">,</span>&nbsp;<span class="ident" id="5367209">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5367215">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367219">dat</span><span class="op" id="5367222">[</span><span class="ident" id="5367223">i</span><span class="op" id="5367224">]</span>&nbsp;<span class="op" id="5367226">=</span>&nbsp;<span class="ident" id="5367228">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5367231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5367235">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5367308">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367381">rela</span>&nbsp;<span class="op" id="5367386">:=</span>&nbsp;<span class="ident" id="5367389">f</span><span class="op" id="5367390">.</span><span class="ident" id="5367391">Section</span><span class="op" id="5367398">(</span><span class="string" id="5367399">&#34;.rela.debug_info&#34;</span><span class="op" id="5367417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367420">if</span>&nbsp;<span class="ident" id="5367423">rela</span>&nbsp;<span class="op" id="5367428">!=</span>&nbsp;<span class="ident" id="5367431">nil</span>&nbsp;<span class="op" id="5367435">&amp;&amp;</span>&nbsp;<span class="ident" id="5367438">rela</span><span class="op" id="5367442">.</span><span class="ident" id="5367443">Type</span>&nbsp;<span class="op" id="5367448">==</span>&nbsp;<span class="ident" id="5367451">SHT_RELA</span>&nbsp;<span class="op" id="5367460">&amp;&amp;</span>&nbsp;<span class="op" id="5367463">(</span><span class="ident" id="5367464">f</span><span class="op" id="5367465">.</span><span class="ident" id="5367466">Machine</span>&nbsp;<span class="op" id="5367474">==</span>&nbsp;<span class="ident" id="5367477">EM_X86_64</span>&nbsp;<span class="op" id="5367487">||</span>&nbsp;<span class="ident" id="5367490">f</span><span class="op" id="5367491">.</span><span class="ident" id="5367492">Machine</span>&nbsp;<span class="op" id="5367500">==</span>&nbsp;<span class="ident" id="5367503">EM_AARCH64</span><span class="op" id="5367513">)</span>&nbsp;<span class="op" id="5367515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367519">data</span><span class="op" id="5367523">,</span>&nbsp;<span class="ident" id="5367525">err</span>&nbsp;<span class="op" id="5367529">:=</span>&nbsp;<span class="ident" id="5367532">rela</span><span class="op" id="5367536">.</span><span class="ident" id="5367537">Data</span><span class="op" id="5367541">(</span><span class="op" id="5367542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367546">if</span>&nbsp;<span class="ident" id="5367549">err</span>&nbsp;<span class="op" id="5367553">!=</span>&nbsp;<span class="ident" id="5367556">nil</span>&nbsp;<span class="op" id="5367560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367565">return</span>&nbsp;<span class="ident" id="5367572">nil</span><span class="op" id="5367575">,</span>&nbsp;<span class="ident" id="5367577">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5367583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367587">err</span>&nbsp;<span class="op" id="5367591">=</span>&nbsp;<span class="ident" id="5367593">f</span><span class="op" id="5367594">.</span><span class="ident" id="5367595">applyRelocations</span><span class="op" id="5367611">(</span><span class="ident" id="5367612">dat</span><span class="op" id="5367615">[</span><span class="num" id="5367616">1</span><span class="op" id="5367617">]</span><span class="op" id="5367618">,</span>&nbsp;<span class="ident" id="5367620">data</span><span class="op" id="5367624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367628">if</span>&nbsp;<span class="ident" id="5367631">err</span>&nbsp;<span class="op" id="5367635">!=</span>&nbsp;<span class="ident" id="5367638">nil</span>&nbsp;<span class="op" id="5367642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367647">return</span>&nbsp;<span class="ident" id="5367654">nil</span><span class="op" id="5367657">,</span>&nbsp;<span class="ident" id="5367659">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5367665">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5367668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5367672">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367738">rel</span>&nbsp;<span class="op" id="5367742">:=</span>&nbsp;<span class="ident" id="5367745">f</span><span class="op" id="5367746">.</span><span class="ident" id="5367747">Section</span><span class="op" id="5367754">(</span><span class="string" id="5367755">&#34;.rel.debug_info&#34;</span><span class="op" id="5367772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367775">if</span>&nbsp;<span class="ident" id="5367778">rel</span>&nbsp;<span class="op" id="5367782">!=</span>&nbsp;<span class="ident" id="5367785">nil</span>&nbsp;<span class="op" id="5367789">&amp;&amp;</span>&nbsp;<span class="ident" id="5367792">rel</span><span class="op" id="5367795">.</span><span class="ident" id="5367796">Type</span>&nbsp;<span class="op" id="5367801">==</span>&nbsp;<span class="ident" id="5367804">SHT_REL</span>&nbsp;<span class="op" id="5367812">&amp;&amp;</span>&nbsp;<span class="ident" id="5367815">f</span><span class="op" id="5367816">.</span><span class="ident" id="5367817">Machine</span>&nbsp;<span class="op" id="5367825">==</span>&nbsp;<span class="ident" id="5367828">EM_386</span>&nbsp;<span class="op" id="5367835">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367839">data</span><span class="op" id="5367843">,</span>&nbsp;<span class="ident" id="5367845">err</span>&nbsp;<span class="op" id="5367849">:=</span>&nbsp;<span class="ident" id="5367852">rel</span><span class="op" id="5367855">.</span><span class="ident" id="5367856">Data</span><span class="op" id="5367860">(</span><span class="op" id="5367861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367865">if</span>&nbsp;<span class="ident" id="5367868">err</span>&nbsp;<span class="op" id="5367872">!=</span>&nbsp;<span class="ident" id="5367875">nil</span>&nbsp;<span class="op" id="5367879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367884">return</span>&nbsp;<span class="ident" id="5367891">nil</span><span class="op" id="5367894">,</span>&nbsp;<span class="ident" id="5367896">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5367902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367906">err</span>&nbsp;<span class="op" id="5367910">=</span>&nbsp;<span class="ident" id="5367912">f</span><span class="op" id="5367913">.</span><span class="ident" id="5367914">applyRelocations</span><span class="op" id="5367930">(</span><span class="ident" id="5367931">dat</span><span class="op" id="5367934">[</span><span class="num" id="5367935">1</span><span class="op" id="5367936">]</span><span class="op" id="5367937">,</span>&nbsp;<span class="ident" id="5367939">data</span><span class="op" id="5367943">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367947">if</span>&nbsp;<span class="ident" id="5367950">err</span>&nbsp;<span class="op" id="5367954">!=</span>&nbsp;<span class="ident" id="5367957">nil</span>&nbsp;<span class="op" id="5367961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5367966">return</span>&nbsp;<span class="ident" id="5367973">nil</span><span class="op" id="5367976">,</span>&nbsp;<span class="ident" id="5367978">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5367984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5367987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367991">abbrev</span><span class="op" id="5367997">,</span>&nbsp;<span class="ident" id="5367999">info</span><span class="op" id="5368003">,</span>&nbsp;<span class="ident" id="5368005">str</span>&nbsp;<span class="op" id="5368009">:=</span>&nbsp;<span class="ident" id="5368012">dat</span><span class="op" id="5368015">[</span><span class="num" id="5368016">0</span><span class="op" id="5368017">]</span><span class="op" id="5368018">,</span>&nbsp;<span class="ident" id="5368020">dat</span><span class="op" id="5368023">[</span><span class="num" id="5368024">1</span><span class="op" id="5368025">]</span><span class="op" id="5368026">,</span>&nbsp;<span class="ident" id="5368028">dat</span><span class="op" id="5368031">[</span><span class="num" id="5368032">2</span><span class="op" id="5368033">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368036">d</span><span class="op" id="5368037">,</span>&nbsp;<span class="ident" id="5368039">err</span>&nbsp;<span class="op" id="5368043">:=</span>&nbsp;<span class="ident" id="5368046">dwarf</span><span class="op" id="5368051">.</span><span class="ident" id="5368052">New</span><span class="op" id="5368055">(</span><span class="ident" id="5368056">abbrev</span><span class="op" id="5368062">,</span>&nbsp;<span class="ident" id="5368064">nil</span><span class="op" id="5368067">,</span>&nbsp;<span class="ident" id="5368069">nil</span><span class="op" id="5368072">,</span>&nbsp;<span class="ident" id="5368074">info</span><span class="op" id="5368078">,</span>&nbsp;<span class="ident" id="5368080">nil</span><span class="op" id="5368083">,</span>&nbsp;<span class="ident" id="5368085">nil</span><span class="op" id="5368088">,</span>&nbsp;<span class="ident" id="5368090">nil</span><span class="op" id="5368093">,</span>&nbsp;<span class="ident" id="5368095">str</span><span class="op" id="5368098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368101">if</span>&nbsp;<span class="ident" id="5368104">err</span>&nbsp;<span class="op" id="5368108">!=</span>&nbsp;<span class="ident" id="5368111">nil</span>&nbsp;<span class="op" id="5368115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368119">return</span>&nbsp;<span class="ident" id="5368126">nil</span><span class="op" id="5368129">,</span>&nbsp;<span class="ident" id="5368131">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368136">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5368140">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368183">for</span>&nbsp;<span class="ident" id="5368187">i</span><span class="op" id="5368188">,</span>&nbsp;<span class="ident" id="5368190">s</span>&nbsp;<span class="op" id="5368192">:=</span>&nbsp;<span class="keyword" id="5368195">range</span>&nbsp;<span class="ident" id="5368201">f</span><span class="op" id="5368202">.</span><span class="ident" id="5368203">Sections</span>&nbsp;<span class="op" id="5368212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368216">if</span>&nbsp;<span class="ident" id="5368219">s</span><span class="op" id="5368220">.</span><span class="ident" id="5368221">Name</span>&nbsp;<span class="op" id="5368226">==</span>&nbsp;<span class="string" id="5368229">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="5368244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368249">b</span><span class="op" id="5368250">,</span>&nbsp;<span class="ident" id="5368252">err</span>&nbsp;<span class="op" id="5368256">:=</span>&nbsp;<span class="ident" id="5368259">s</span><span class="op" id="5368260">.</span><span class="ident" id="5368261">Data</span><span class="op" id="5368265">(</span><span class="op" id="5368266">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368271">if</span>&nbsp;<span class="ident" id="5368274">err</span>&nbsp;<span class="op" id="5368278">!=</span>&nbsp;<span class="ident" id="5368281">nil</span>&nbsp;<span class="op" id="5368285">&amp;&amp;</span>&nbsp;<span class="ident" id="5368288">uint64</span><span class="op" id="5368294">(</span><span class="builtinfunc" id="5368295">len</span><span class="op" id="5368298">(</span><span class="ident" id="5368299">b</span><span class="op" id="5368300">)</span><span class="op" id="5368301">)</span>&nbsp;<span class="op" id="5368303">&lt;</span>&nbsp;<span class="ident" id="5368305">s</span><span class="op" id="5368306">.</span><span class="ident" id="5368307">Size</span>&nbsp;<span class="op" id="5368312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368318">return</span>&nbsp;<span class="ident" id="5368325">nil</span><span class="op" id="5368328">,</span>&nbsp;<span class="ident" id="5368330">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368343">for</span>&nbsp;<span class="ident" id="5368347">_</span><span class="op" id="5368348">,</span>&nbsp;<span class="ident" id="5368350">r</span>&nbsp;<span class="op" id="5368352">:=</span>&nbsp;<span class="keyword" id="5368355">range</span>&nbsp;<span class="ident" id="5368361">f</span><span class="op" id="5368362">.</span><span class="ident" id="5368363">Sections</span>&nbsp;<span class="op" id="5368372">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368378">if</span>&nbsp;<span class="ident" id="5368381">r</span><span class="op" id="5368382">.</span><span class="ident" id="5368383">Type</span>&nbsp;<span class="op" id="5368388">!=</span>&nbsp;<span class="ident" id="5368391">SHT_RELA</span>&nbsp;<span class="op" id="5368400">&amp;&amp;</span>&nbsp;<span class="ident" id="5368403">r</span><span class="op" id="5368404">.</span><span class="ident" id="5368405">Type</span>&nbsp;<span class="op" id="5368410">!=</span>&nbsp;<span class="ident" id="5368413">SHT_REL</span>&nbsp;<span class="op" id="5368421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368428">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368447">if</span>&nbsp;<span class="builtintype" id="5368450">int</span><span class="op" id="5368453">(</span><span class="ident" id="5368454">r</span><span class="op" id="5368455">.</span><span class="ident" id="5368456">Info</span><span class="op" id="5368460">)</span>&nbsp;<span class="op" id="5368462">!=</span>&nbsp;<span class="ident" id="5368465">i</span>&nbsp;<span class="op" id="5368467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368474">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368493">rd</span><span class="op" id="5368495">,</span>&nbsp;<span class="ident" id="5368497">err</span>&nbsp;<span class="op" id="5368501">:=</span>&nbsp;<span class="ident" id="5368504">r</span><span class="op" id="5368505">.</span><span class="ident" id="5368506">Data</span><span class="op" id="5368510">(</span><span class="op" id="5368511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368517">if</span>&nbsp;<span class="ident" id="5368520">err</span>&nbsp;<span class="op" id="5368524">!=</span>&nbsp;<span class="ident" id="5368527">nil</span>&nbsp;<span class="op" id="5368531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368538">return</span>&nbsp;<span class="ident" id="5368545">nil</span><span class="op" id="5368548">,</span>&nbsp;<span class="ident" id="5368550">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368558">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368564">err</span>&nbsp;<span class="op" id="5368568">=</span>&nbsp;<span class="ident" id="5368570">f</span><span class="op" id="5368571">.</span><span class="ident" id="5368572">applyRelocations</span><span class="op" id="5368588">(</span><span class="ident" id="5368589">b</span><span class="op" id="5368590">,</span>&nbsp;<span class="ident" id="5368592">rd</span><span class="op" id="5368594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368600">if</span>&nbsp;<span class="ident" id="5368603">err</span>&nbsp;<span class="op" id="5368607">!=</span>&nbsp;<span class="ident" id="5368610">nil</span>&nbsp;<span class="op" id="5368614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368621">return</span>&nbsp;<span class="ident" id="5368628">nil</span><span class="op" id="5368631">,</span>&nbsp;<span class="ident" id="5368633">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368646">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368652">err</span>&nbsp;<span class="op" id="5368656">=</span>&nbsp;<span class="ident" id="5368658">d</span><span class="op" id="5368659">.</span><span class="ident" id="5368660">AddTypes</span><span class="op" id="5368668">(</span><span class="ident" id="5368669">fmt</span><span class="op" id="5368672">.</span><span class="ident" id="5368673">Sprintf</span><span class="op" id="5368680">(</span><span class="string" id="5368681">&#34;types-%d&#34;</span><span class="op" id="5368691">,</span>&nbsp;<span class="ident" id="5368693">i</span><span class="op" id="5368694">)</span><span class="op" id="5368695">,</span>&nbsp;<span class="ident" id="5368697">b</span><span class="op" id="5368698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368703">if</span>&nbsp;<span class="ident" id="5368706">err</span>&nbsp;<span class="op" id="5368710">!=</span>&nbsp;<span class="ident" id="5368713">nil</span>&nbsp;<span class="op" id="5368717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368723">return</span>&nbsp;<span class="ident" id="5368730">nil</span><span class="op" id="5368733">,</span>&nbsp;<span class="ident" id="5368735">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368742">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368753">return</span>&nbsp;<span class="ident" id="5368760">d</span><span class="op" id="5368761">,</span>&nbsp;<span class="ident" id="5368763">nil</span><br>
<span class="lineno"></span><span class="op" id="5368767">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="5368770">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5368853">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5368874">//</span><br>
<span class="lineno"></span><span class="comment" id="5368877">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="5368953">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5369027">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5369073">func</span>&nbsp;<span class="op" id="5369078">(</span><span class="ident" id="5369079">f</span>&nbsp;<span class="op" id="5369081">*</span><span class="ident" id="5369082">File</span><span class="op" id="5369086">)</span>&nbsp;<span class="ident" id="5369088">Symbols</span><span class="op" id="5369095">(</span><span class="op" id="5369096">)</span>&nbsp;<span class="op" id="5369098">(</span><span class="op" id="5369099">[</span><span class="op" id="5369100">]</span><span class="ident" id="5369101">Symbol</span><span class="op" id="5369107">,</span>&nbsp;<span class="builtintype" id="5369109">error</span><span class="op" id="5369114">)</span>&nbsp;<span class="op" id="5369116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369119">sym</span><span class="op" id="5369122">,</span>&nbsp;<span class="ident" id="5369124">_</span><span class="op" id="5369125">,</span>&nbsp;<span class="ident" id="5369127">err</span>&nbsp;<span class="op" id="5369131">:=</span>&nbsp;<span class="ident" id="5369134">f</span><span class="op" id="5369135">.</span><span class="ident" id="5369136">getSymbols</span><span class="op" id="5369146">(</span><span class="ident" id="5369147">SHT_SYMTAB</span><span class="op" id="5369157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5369160">return</span>&nbsp;<span class="ident" id="5369167">sym</span><span class="op" id="5369170">,</span>&nbsp;<span class="ident" id="5369172">err</span><br>
<span class="lineno">770</span><span class="op" id="5369176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5369179">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5369249">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5369298">//</span><br>
<span class="lineno">775</span><span class="comment" id="5369301">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="5369385">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5369459">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5369505">func</span>&nbsp;<span class="op" id="5369510">(</span><span class="ident" id="5369511">f</span>&nbsp;<span class="op" id="5369513">*</span><span class="ident" id="5369514">File</span><span class="op" id="5369518">)</span>&nbsp;<span class="ident" id="5369520">DynamicSymbols</span><span class="op" id="5369534">(</span><span class="op" id="5369535">)</span>&nbsp;<span class="op" id="5369537">(</span><span class="op" id="5369538">[</span><span class="op" id="5369539">]</span><span class="ident" id="5369540">Symbol</span><span class="op" id="5369546">,</span>&nbsp;<span class="builtintype" id="5369548">error</span><span class="op" id="5369553">)</span>&nbsp;<span class="op" id="5369555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369558">sym</span><span class="op" id="5369561">,</span>&nbsp;<span class="ident" id="5369563">_</span><span class="op" id="5369564">,</span>&nbsp;<span class="ident" id="5369566">err</span>&nbsp;<span class="op" id="5369570">:=</span>&nbsp;<span class="ident" id="5369573">f</span><span class="op" id="5369574">.</span><span class="ident" id="5369575">getSymbols</span><span class="op" id="5369585">(</span><span class="ident" id="5369586">SHT_DYNSYM</span><span class="op" id="5369596">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5369599">return</span>&nbsp;<span class="ident" id="5369606">sym</span><span class="op" id="5369609">,</span>&nbsp;<span class="ident" id="5369611">err</span><br>
<span class="lineno"></span><span class="op" id="5369615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5369618">type</span>&nbsp;<span class="ident" id="5369623">ImportedSymbol</span>&nbsp;<span class="keyword" id="5369638">struct</span>&nbsp;<span class="op" id="5369645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369648">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5369656">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369664">Version</span>&nbsp;<span class="builtintype" id="5369672">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369680">Library</span>&nbsp;<span class="builtintype" id="5369688">string</span><br>
<span class="lineno"></span><span class="op" id="5369695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5369698">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="5369750">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5369805">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5369859">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5369895">func</span>&nbsp;<span class="op" id="5369900">(</span><span class="ident" id="5369901">f</span>&nbsp;<span class="op" id="5369903">*</span><span class="ident" id="5369904">File</span><span class="op" id="5369908">)</span>&nbsp;<span class="ident" id="5369910">ImportedSymbols</span><span class="op" id="5369925">(</span><span class="op" id="5369926">)</span>&nbsp;<span class="op" id="5369928">(</span><span class="op" id="5369929">[</span><span class="op" id="5369930">]</span><span class="ident" id="5369931">ImportedSymbol</span><span class="op" id="5369945">,</span>&nbsp;<span class="builtintype" id="5369947">error</span><span class="op" id="5369952">)</span>&nbsp;<span class="op" id="5369954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369957">sym</span><span class="op" id="5369960">,</span>&nbsp;<span class="ident" id="5369962">str</span><span class="op" id="5369965">,</span>&nbsp;<span class="ident" id="5369967">err</span>&nbsp;<span class="op" id="5369971">:=</span>&nbsp;<span class="ident" id="5369974">f</span><span class="op" id="5369975">.</span><span class="ident" id="5369976">getSymbols</span><span class="op" id="5369986">(</span><span class="ident" id="5369987">SHT_DYNSYM</span><span class="op" id="5369997">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370000">if</span>&nbsp;<span class="ident" id="5370003">err</span>&nbsp;<span class="op" id="5370007">!=</span>&nbsp;<span class="ident" id="5370010">nil</span>&nbsp;<span class="op" id="5370014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370018">return</span>&nbsp;<span class="ident" id="5370025">nil</span><span class="op" id="5370028">,</span>&nbsp;<span class="ident" id="5370030">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370038">f</span><span class="op" id="5370039">.</span><span class="ident" id="5370040">gnuVersionInit</span><span class="op" id="5370054">(</span><span class="ident" id="5370055">str</span><span class="op" id="5370058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370061">var</span>&nbsp;<span class="ident" id="5370065">all</span>&nbsp;<span class="op" id="5370069">[</span><span class="op" id="5370070">]</span><span class="ident" id="5370071">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370087">for</span>&nbsp;<span class="ident" id="5370091">i</span><span class="op" id="5370092">,</span>&nbsp;<span class="ident" id="5370094">s</span>&nbsp;<span class="op" id="5370096">:=</span>&nbsp;<span class="keyword" id="5370099">range</span>&nbsp;<span class="ident" id="5370105">sym</span>&nbsp;<span class="op" id="5370109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370113">if</span>&nbsp;<span class="ident" id="5370116">ST_BIND</span><span class="op" id="5370123">(</span><span class="ident" id="5370124">s</span><span class="op" id="5370125">.</span><span class="ident" id="5370126">Info</span><span class="op" id="5370130">)</span>&nbsp;<span class="op" id="5370132">==</span>&nbsp;<span class="ident" id="5370135">STB_GLOBAL</span>&nbsp;<span class="op" id="5370146">&amp;&amp;</span>&nbsp;<span class="ident" id="5370149">s</span><span class="op" id="5370150">.</span><span class="ident" id="5370151">Section</span>&nbsp;<span class="op" id="5370159">==</span>&nbsp;<span class="ident" id="5370162">SHN_UNDEF</span>&nbsp;<span class="op" id="5370172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370177">all</span>&nbsp;<span class="op" id="5370181">=</span>&nbsp;<span class="builtinfunc" id="5370183">append</span><span class="op" id="5370189">(</span><span class="ident" id="5370190">all</span><span class="op" id="5370193">,</span>&nbsp;<span class="ident" id="5370195">ImportedSymbol</span><span class="op" id="5370209">{</span><span class="ident" id="5370210">Name</span><span class="op" id="5370214">:</span>&nbsp;<span class="ident" id="5370216">s</span><span class="op" id="5370217">.</span><span class="ident" id="5370218">Name</span><span class="op" id="5370222">}</span><span class="op" id="5370223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370228">f</span><span class="op" id="5370229">.</span><span class="ident" id="5370230">gnuVersion</span><span class="op" id="5370240">(</span><span class="ident" id="5370241">i</span><span class="op" id="5370242">,</span>&nbsp;<span class="op" id="5370244">&amp;</span><span class="ident" id="5370245">all</span><span class="op" id="5370248">[</span><span class="builtinfunc" id="5370249">len</span><span class="op" id="5370252">(</span><span class="ident" id="5370253">all</span><span class="op" id="5370256">)</span><span class="op" id="5370257">-</span><span class="num" id="5370258">1</span><span class="op" id="5370259">]</span><span class="op" id="5370260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370264">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370270">return</span>&nbsp;<span class="ident" id="5370277">all</span><span class="op" id="5370280">,</span>&nbsp;<span class="ident" id="5370282">nil</span><br>
<span class="lineno"></span><span class="op" id="5370286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5370289">type</span>&nbsp;<span class="ident" id="5370294">verneed</span>&nbsp;<span class="keyword" id="5370302">struct</span>&nbsp;<span class="op" id="5370309">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370312">File</span>&nbsp;<span class="builtintype" id="5370317">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370325">Name</span>&nbsp;<span class="builtintype" id="5370330">string</span><br>
<span class="lineno"></span><span class="op" id="5370337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5370340">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="5370388">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="5370423">func</span>&nbsp;<span class="op" id="5370428">(</span><span class="ident" id="5370429">f</span>&nbsp;<span class="op" id="5370431">*</span><span class="ident" id="5370432">File</span><span class="op" id="5370436">)</span>&nbsp;<span class="ident" id="5370438">gnuVersionInit</span><span class="op" id="5370452">(</span><span class="ident" id="5370453">str</span>&nbsp;<span class="op" id="5370457">[</span><span class="op" id="5370458">]</span><span class="builtintype" id="5370459">byte</span><span class="op" id="5370463">)</span>&nbsp;<span class="op" id="5370465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5370468">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370504">vn</span>&nbsp;<span class="op" id="5370507">:=</span>&nbsp;<span class="ident" id="5370510">f</span><span class="op" id="5370511">.</span><span class="ident" id="5370512">SectionByType</span><span class="op" id="5370525">(</span><span class="ident" id="5370526">SHT_GNU_VERNEED</span><span class="op" id="5370541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370544">if</span>&nbsp;<span class="ident" id="5370547">vn</span>&nbsp;<span class="op" id="5370550">==</span>&nbsp;<span class="ident" id="5370553">nil</span>&nbsp;<span class="op" id="5370557">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370561">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370572">d</span><span class="op" id="5370573">,</span>&nbsp;<span class="ident" id="5370575">_</span>&nbsp;<span class="op" id="5370577">:=</span>&nbsp;<span class="ident" id="5370580">vn</span><span class="op" id="5370582">.</span><span class="ident" id="5370583">Data</span><span class="op" id="5370587">(</span><span class="op" id="5370588">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370592">var</span>&nbsp;<span class="ident" id="5370596">need</span>&nbsp;<span class="op" id="5370601">[</span><span class="op" id="5370602">]</span><span class="ident" id="5370603">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370612">i</span>&nbsp;<span class="op" id="5370614">:=</span>&nbsp;<span class="num" id="5370617">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370620">for</span>&nbsp;<span class="op" id="5370624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370628">if</span>&nbsp;<span class="ident" id="5370631">i</span><span class="op" id="5370632">+</span><span class="num" id="5370633">16</span>&nbsp;<span class="op" id="5370636">&gt;</span>&nbsp;<span class="builtinfunc" id="5370638">len</span><span class="op" id="5370641">(</span><span class="ident" id="5370642">d</span><span class="op" id="5370643">)</span>&nbsp;<span class="op" id="5370645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370650">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370658">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370662">vers</span>&nbsp;<span class="op" id="5370667">:=</span>&nbsp;<span class="ident" id="5370670">f</span><span class="op" id="5370671">.</span><span class="ident" id="5370672">ByteOrder</span><span class="op" id="5370681">.</span><span class="ident" id="5370682">Uint16</span><span class="op" id="5370688">(</span><span class="ident" id="5370689">d</span><span class="op" id="5370690">[</span><span class="ident" id="5370691">i</span>&nbsp;<span class="op" id="5370693">:</span>&nbsp;<span class="ident" id="5370695">i</span><span class="op" id="5370696">+</span><span class="num" id="5370697">2</span><span class="op" id="5370698">]</span><span class="op" id="5370699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370703">if</span>&nbsp;<span class="ident" id="5370706">vers</span>&nbsp;<span class="op" id="5370711">!=</span>&nbsp;<span class="num" id="5370714">1</span>&nbsp;<span class="op" id="5370716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370721">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370733">cnt</span>&nbsp;<span class="op" id="5370737">:=</span>&nbsp;<span class="ident" id="5370740">f</span><span class="op" id="5370741">.</span><span class="ident" id="5370742">ByteOrder</span><span class="op" id="5370751">.</span><span class="ident" id="5370752">Uint16</span><span class="op" id="5370758">(</span><span class="ident" id="5370759">d</span><span class="op" id="5370760">[</span><span class="ident" id="5370761">i</span><span class="op" id="5370762">+</span><span class="num" id="5370763">2</span>&nbsp;<span class="op" id="5370765">:</span>&nbsp;<span class="ident" id="5370767">i</span><span class="op" id="5370768">+</span><span class="num" id="5370769">4</span><span class="op" id="5370770">]</span><span class="op" id="5370771">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370775">fileoff</span>&nbsp;<span class="op" id="5370783">:=</span>&nbsp;<span class="ident" id="5370786">f</span><span class="op" id="5370787">.</span><span class="ident" id="5370788">ByteOrder</span><span class="op" id="5370797">.</span><span class="ident" id="5370798">Uint32</span><span class="op" id="5370804">(</span><span class="ident" id="5370805">d</span><span class="op" id="5370806">[</span><span class="ident" id="5370807">i</span><span class="op" id="5370808">+</span><span class="num" id="5370809">4</span>&nbsp;<span class="op" id="5370811">:</span>&nbsp;<span class="ident" id="5370813">i</span><span class="op" id="5370814">+</span><span class="num" id="5370815">8</span><span class="op" id="5370816">]</span><span class="op" id="5370817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370821">aux</span>&nbsp;<span class="op" id="5370825">:=</span>&nbsp;<span class="ident" id="5370828">f</span><span class="op" id="5370829">.</span><span class="ident" id="5370830">ByteOrder</span><span class="op" id="5370839">.</span><span class="ident" id="5370840">Uint32</span><span class="op" id="5370846">(</span><span class="ident" id="5370847">d</span><span class="op" id="5370848">[</span><span class="ident" id="5370849">i</span><span class="op" id="5370850">+</span><span class="num" id="5370851">8</span>&nbsp;<span class="op" id="5370853">:</span>&nbsp;<span class="ident" id="5370855">i</span><span class="op" id="5370856">+</span><span class="num" id="5370857">12</span><span class="op" id="5370859">]</span><span class="op" id="5370860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370864">next</span>&nbsp;<span class="op" id="5370869">:=</span>&nbsp;<span class="ident" id="5370872">f</span><span class="op" id="5370873">.</span><span class="ident" id="5370874">ByteOrder</span><span class="op" id="5370883">.</span><span class="ident" id="5370884">Uint32</span><span class="op" id="5370890">(</span><span class="ident" id="5370891">d</span><span class="op" id="5370892">[</span><span class="ident" id="5370893">i</span><span class="op" id="5370894">+</span><span class="num" id="5370895">12</span>&nbsp;<span class="op" id="5370898">:</span>&nbsp;<span class="ident" id="5370900">i</span><span class="op" id="5370901">+</span><span class="num" id="5370902">16</span><span class="op" id="5370904">]</span><span class="op" id="5370905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370909">file</span><span class="op" id="5370913">,</span>&nbsp;<span class="ident" id="5370915">_</span>&nbsp;<span class="op" id="5370917">:=</span>&nbsp;<span class="ident" id="5370920">getString</span><span class="op" id="5370929">(</span><span class="ident" id="5370930">str</span><span class="op" id="5370933">,</span>&nbsp;<span class="builtintype" id="5370935">int</span><span class="op" id="5370938">(</span><span class="ident" id="5370939">fileoff</span><span class="op" id="5370946">)</span><span class="op" id="5370947">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370952">var</span>&nbsp;<span class="ident" id="5370956">name</span>&nbsp;<span class="builtintype" id="5370961">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370970">j</span>&nbsp;<span class="op" id="5370972">:=</span>&nbsp;<span class="ident" id="5370975">i</span>&nbsp;<span class="op" id="5370977">+</span>&nbsp;<span class="builtintype" id="5370979">int</span><span class="op" id="5370982">(</span><span class="ident" id="5370983">aux</span><span class="op" id="5370986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370990">for</span>&nbsp;<span class="ident" id="5370994">c</span>&nbsp;<span class="op" id="5370996">:=</span>&nbsp;<span class="num" id="5370999">0</span><span class="op" id="5371000">;</span>&nbsp;<span class="ident" id="5371002">c</span>&nbsp;<span class="op" id="5371004">&lt;</span>&nbsp;<span class="builtintype" id="5371006">int</span><span class="op" id="5371009">(</span><span class="ident" id="5371010">cnt</span><span class="op" id="5371013">)</span><span class="op" id="5371014">;</span>&nbsp;<span class="ident" id="5371016">c</span><span class="op" id="5371017">++</span>&nbsp;<span class="op" id="5371020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371025">if</span>&nbsp;<span class="ident" id="5371028">j</span><span class="op" id="5371029">+</span><span class="num" id="5371030">16</span>&nbsp;<span class="op" id="5371033">&gt;</span>&nbsp;<span class="builtinfunc" id="5371035">len</span><span class="op" id="5371038">(</span><span class="ident" id="5371039">d</span><span class="op" id="5371040">)</span>&nbsp;<span class="op" id="5371042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371048">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5371062">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5371105">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371151">other</span>&nbsp;<span class="op" id="5371157">:=</span>&nbsp;<span class="ident" id="5371160">f</span><span class="op" id="5371161">.</span><span class="ident" id="5371162">ByteOrder</span><span class="op" id="5371171">.</span><span class="ident" id="5371172">Uint16</span><span class="op" id="5371178">(</span><span class="ident" id="5371179">d</span><span class="op" id="5371180">[</span><span class="ident" id="5371181">j</span><span class="op" id="5371182">+</span><span class="num" id="5371183">6</span>&nbsp;<span class="op" id="5371185">:</span>&nbsp;<span class="ident" id="5371187">j</span><span class="op" id="5371188">+</span><span class="num" id="5371189">8</span><span class="op" id="5371190">]</span><span class="op" id="5371191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371196">nameoff</span>&nbsp;<span class="op" id="5371204">:=</span>&nbsp;<span class="ident" id="5371207">f</span><span class="op" id="5371208">.</span><span class="ident" id="5371209">ByteOrder</span><span class="op" id="5371218">.</span><span class="ident" id="5371219">Uint32</span><span class="op" id="5371225">(</span><span class="ident" id="5371226">d</span><span class="op" id="5371227">[</span><span class="ident" id="5371228">j</span><span class="op" id="5371229">+</span><span class="num" id="5371230">8</span>&nbsp;<span class="op" id="5371232">:</span>&nbsp;<span class="ident" id="5371234">j</span><span class="op" id="5371235">+</span><span class="num" id="5371236">12</span><span class="op" id="5371238">]</span><span class="op" id="5371239">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371244">next</span>&nbsp;<span class="op" id="5371249">:=</span>&nbsp;<span class="ident" id="5371252">f</span><span class="op" id="5371253">.</span><span class="ident" id="5371254">ByteOrder</span><span class="op" id="5371263">.</span><span class="ident" id="5371264">Uint32</span><span class="op" id="5371270">(</span><span class="ident" id="5371271">d</span><span class="op" id="5371272">[</span><span class="ident" id="5371273">j</span><span class="op" id="5371274">+</span><span class="num" id="5371275">12</span>&nbsp;<span class="op" id="5371278">:</span>&nbsp;<span class="ident" id="5371280">j</span><span class="op" id="5371281">+</span><span class="num" id="5371282">16</span><span class="op" id="5371284">]</span><span class="op" id="5371285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371290">name</span><span class="op" id="5371294">,</span>&nbsp;<span class="ident" id="5371296">_</span>&nbsp;<span class="op" id="5371298">=</span>&nbsp;<span class="ident" id="5371300">getString</span><span class="op" id="5371309">(</span><span class="ident" id="5371310">str</span><span class="op" id="5371313">,</span>&nbsp;<span class="builtintype" id="5371315">int</span><span class="op" id="5371318">(</span><span class="ident" id="5371319">nameoff</span><span class="op" id="5371326">)</span><span class="op" id="5371327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371332">ndx</span>&nbsp;<span class="op" id="5371336">:=</span>&nbsp;<span class="builtintype" id="5371339">int</span><span class="op" id="5371342">(</span><span class="ident" id="5371343">other</span><span class="op" id="5371348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371353">if</span>&nbsp;<span class="ident" id="5371356">ndx</span>&nbsp;<span class="op" id="5371360">&gt;=</span>&nbsp;<span class="builtinfunc" id="5371363">len</span><span class="op" id="5371366">(</span><span class="ident" id="5371367">need</span><span class="op" id="5371371">)</span>&nbsp;<span class="op" id="5371373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371379">a</span>&nbsp;<span class="op" id="5371381">:=</span>&nbsp;<span class="builtinfunc" id="5371384">make</span><span class="op" id="5371388">(</span><span class="op" id="5371389">[</span><span class="op" id="5371390">]</span><span class="ident" id="5371391">verneed</span><span class="op" id="5371398">,</span>&nbsp;<span class="num" id="5371400">2</span><span class="op" id="5371401">*</span><span class="op" id="5371402">(</span><span class="ident" id="5371403">ndx</span><span class="op" id="5371406">+</span><span class="num" id="5371407">1</span><span class="op" id="5371408">)</span><span class="op" id="5371409">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5371415">copy</span><span class="op" id="5371419">(</span><span class="ident" id="5371420">a</span><span class="op" id="5371421">,</span>&nbsp;<span class="ident" id="5371423">need</span><span class="op" id="5371427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371433">need</span>&nbsp;<span class="op" id="5371438">=</span>&nbsp;<span class="ident" id="5371440">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371451">need</span><span class="op" id="5371455">[</span><span class="ident" id="5371456">ndx</span><span class="op" id="5371459">]</span>&nbsp;<span class="op" id="5371461">=</span>&nbsp;<span class="ident" id="5371463">verneed</span><span class="op" id="5371470">{</span><span class="ident" id="5371471">file</span><span class="op" id="5371475">,</span>&nbsp;<span class="ident" id="5371477">name</span><span class="op" id="5371481">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371486">if</span>&nbsp;<span class="ident" id="5371489">next</span>&nbsp;<span class="op" id="5371494">==</span>&nbsp;<span class="num" id="5371497">0</span>&nbsp;<span class="op" id="5371499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371505">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371519">j</span>&nbsp;<span class="op" id="5371521">+=</span>&nbsp;<span class="builtintype" id="5371524">int</span><span class="op" id="5371527">(</span><span class="ident" id="5371528">next</span><span class="op" id="5371532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371536">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371541">if</span>&nbsp;<span class="ident" id="5371544">next</span>&nbsp;<span class="op" id="5371549">==</span>&nbsp;<span class="num" id="5371552">0</span>&nbsp;<span class="op" id="5371554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371559">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371571">i</span>&nbsp;<span class="op" id="5371573">+=</span>&nbsp;<span class="builtintype" id="5371576">int</span><span class="op" id="5371579">(</span><span class="ident" id="5371580">next</span><span class="op" id="5371584">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5371591">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371649">vs</span>&nbsp;<span class="op" id="5371652">:=</span>&nbsp;<span class="ident" id="5371655">f</span><span class="op" id="5371656">.</span><span class="ident" id="5371657">SectionByType</span><span class="op" id="5371670">(</span><span class="ident" id="5371671">SHT_GNU_VERSYM</span><span class="op" id="5371685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371688">if</span>&nbsp;<span class="ident" id="5371691">vs</span>&nbsp;<span class="op" id="5371694">==</span>&nbsp;<span class="ident" id="5371697">nil</span>&nbsp;<span class="op" id="5371701">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371705">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371716">d</span><span class="op" id="5371717">,</span>&nbsp;<span class="ident" id="5371719">_</span>&nbsp;<span class="op" id="5371721">=</span>&nbsp;<span class="ident" id="5371723">vs</span><span class="op" id="5371725">.</span><span class="ident" id="5371726">Data</span><span class="op" id="5371730">(</span><span class="op" id="5371731">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371735">f</span><span class="op" id="5371736">.</span><span class="ident" id="5371737">gnuNeed</span>&nbsp;<span class="op" id="5371745">=</span>&nbsp;<span class="ident" id="5371747">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371753">f</span><span class="op" id="5371754">.</span><span class="ident" id="5371755">gnuVersym</span>&nbsp;<span class="op" id="5371765">=</span>&nbsp;<span class="ident" id="5371767">d</span><br>
<span class="lineno"></span><span class="op" id="5371769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5371772">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="5371831">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="5371880">func</span>&nbsp;<span class="op" id="5371885">(</span><span class="ident" id="5371886">f</span>&nbsp;<span class="op" id="5371888">*</span><span class="ident" id="5371889">File</span><span class="op" id="5371893">)</span>&nbsp;<span class="ident" id="5371895">gnuVersion</span><span class="op" id="5371905">(</span><span class="ident" id="5371906">i</span>&nbsp;<span class="builtintype" id="5371908">int</span><span class="op" id="5371911">,</span>&nbsp;<span class="ident" id="5371913">sym</span>&nbsp;<span class="op" id="5371917">*</span><span class="ident" id="5371918">ImportedSymbol</span><span class="op" id="5371932">)</span>&nbsp;<span class="op" id="5371934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5371937">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371966">i</span>&nbsp;<span class="op" id="5371968">=</span>&nbsp;<span class="op" id="5371970">(</span><span class="ident" id="5371971">i</span>&nbsp;<span class="op" id="5371973">+</span>&nbsp;<span class="num" id="5371975">1</span><span class="op" id="5371976">)</span>&nbsp;<span class="op" id="5371978">*</span>&nbsp;<span class="num" id="5371980">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371983">if</span>&nbsp;<span class="ident" id="5371986">i</span>&nbsp;<span class="op" id="5371988">&gt;=</span>&nbsp;<span class="builtinfunc" id="5371991">len</span><span class="op" id="5371994">(</span><span class="ident" id="5371995">f</span><span class="op" id="5371996">.</span><span class="ident" id="5371997">gnuVersym</span><span class="op" id="5372006">)</span>&nbsp;<span class="op" id="5372008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372012">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5372020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372023">j</span>&nbsp;<span class="op" id="5372025">:=</span>&nbsp;<span class="builtintype" id="5372028">int</span><span class="op" id="5372031">(</span><span class="ident" id="5372032">f</span><span class="op" id="5372033">.</span><span class="ident" id="5372034">ByteOrder</span><span class="op" id="5372043">.</span><span class="ident" id="5372044">Uint16</span><span class="op" id="5372050">(</span><span class="ident" id="5372051">f</span><span class="op" id="5372052">.</span><span class="ident" id="5372053">gnuVersym</span><span class="op" id="5372062">[</span><span class="ident" id="5372063">i</span><span class="op" id="5372064">:</span><span class="op" id="5372065">]</span><span class="op" id="5372066">)</span><span class="op" id="5372067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372070">if</span>&nbsp;<span class="ident" id="5372073">j</span>&nbsp;<span class="op" id="5372075">&lt;</span>&nbsp;<span class="num" id="5372077">2</span>&nbsp;<span class="op" id="5372079">||</span>&nbsp;<span class="ident" id="5372082">j</span>&nbsp;<span class="op" id="5372084">&gt;=</span>&nbsp;<span class="builtinfunc" id="5372087">len</span><span class="op" id="5372090">(</span><span class="ident" id="5372091">f</span><span class="op" id="5372092">.</span><span class="ident" id="5372093">gnuNeed</span><span class="op" id="5372100">)</span>&nbsp;<span class="op" id="5372102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372106">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5372114">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372117">n</span>&nbsp;<span class="op" id="5372119">:=</span>&nbsp;<span class="op" id="5372122">&amp;</span><span class="ident" id="5372123">f</span><span class="op" id="5372124">.</span><span class="ident" id="5372125">gnuNeed</span><span class="op" id="5372132">[</span><span class="ident" id="5372133">j</span><span class="op" id="5372134">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372137">sym</span><span class="op" id="5372140">.</span><span class="ident" id="5372141">Library</span>&nbsp;<span class="op" id="5372149">=</span>&nbsp;<span class="ident" id="5372151">n</span><span class="op" id="5372152">.</span><span class="ident" id="5372153">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372159">sym</span><span class="op" id="5372162">.</span><span class="ident" id="5372163">Version</span>&nbsp;<span class="op" id="5372171">=</span>&nbsp;<span class="ident" id="5372173">n</span><span class="op" id="5372174">.</span><span class="ident" id="5372175">Name</span><br>
<span class="lineno"></span><span class="op" id="5372180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5372183">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5372239">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5372294">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="5372342">func</span>&nbsp;<span class="op" id="5372347">(</span><span class="ident" id="5372348">f</span>&nbsp;<span class="op" id="5372350">*</span><span class="ident" id="5372351">File</span><span class="op" id="5372355">)</span>&nbsp;<span class="ident" id="5372357">ImportedLibraries</span><span class="op" id="5372374">(</span><span class="op" id="5372375">)</span>&nbsp;<span class="op" id="5372377">(</span><span class="op" id="5372378">[</span><span class="op" id="5372379">]</span><span class="builtintype" id="5372380">string</span><span class="op" id="5372386">,</span>&nbsp;<span class="builtintype" id="5372388">error</span><span class="op" id="5372393">)</span>&nbsp;<span class="op" id="5372395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372398">return</span>&nbsp;<span class="ident" id="5372405">f</span><span class="op" id="5372406">.</span><span class="ident" id="5372407">DynString</span><span class="op" id="5372416">(</span><span class="ident" id="5372417">DT_NEEDED</span><span class="op" id="5372426">)</span><br>
<span class="lineno">905</span><span class="op" id="5372428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5372431">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="5372511">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="5372523">//</span><br>
<span class="lineno">910</span><span class="comment" id="5372526">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5372610">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="5372625">func</span>&nbsp;<span class="op" id="5372630">(</span><span class="ident" id="5372631">f</span>&nbsp;<span class="op" id="5372633">*</span><span class="ident" id="5372634">File</span><span class="op" id="5372638">)</span>&nbsp;<span class="ident" id="5372640">DynString</span><span class="op" id="5372649">(</span><span class="ident" id="5372650">tag</span>&nbsp;<span class="ident" id="5372654">DynTag</span><span class="op" id="5372660">)</span>&nbsp;<span class="op" id="5372662">(</span><span class="op" id="5372663">[</span><span class="op" id="5372664">]</span><span class="builtintype" id="5372665">string</span><span class="op" id="5372671">,</span>&nbsp;<span class="builtintype" id="5372673">error</span><span class="op" id="5372678">)</span>&nbsp;<span class="op" id="5372680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372683">switch</span>&nbsp;<span class="ident" id="5372690">tag</span>&nbsp;<span class="op" id="5372694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372697">case</span>&nbsp;<span class="ident" id="5372702">DT_NEEDED</span><span class="op" id="5372711">,</span>&nbsp;<span class="ident" id="5372713">DT_SONAME</span><span class="op" id="5372722">,</span>&nbsp;<span class="ident" id="5372724">DT_RPATH</span><span class="op" id="5372732">,</span>&nbsp;<span class="ident" id="5372734">DT_RUNPATH</span><span class="op" id="5372744">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372747">default</span><span class="op" id="5372754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372758">return</span>&nbsp;<span class="ident" id="5372765">nil</span><span class="op" id="5372768">,</span>&nbsp;<span class="ident" id="5372770">fmt</span><span class="op" id="5372773">.</span><span class="ident" id="5372774">Errorf</span><span class="op" id="5372780">(</span><span class="string" id="5372781">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="5372807">,</span>&nbsp;<span class="ident" id="5372809">tag</span><span class="op" id="5372812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5372815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372818">ds</span>&nbsp;<span class="op" id="5372821">:=</span>&nbsp;<span class="ident" id="5372824">f</span><span class="op" id="5372825">.</span><span class="ident" id="5372826">SectionByType</span><span class="op" id="5372839">(</span><span class="ident" id="5372840">SHT_DYNAMIC</span><span class="op" id="5372851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372854">if</span>&nbsp;<span class="ident" id="5372857">ds</span>&nbsp;<span class="op" id="5372860">==</span>&nbsp;<span class="ident" id="5372863">nil</span>&nbsp;<span class="op" id="5372867">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5372871">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372905">return</span>&nbsp;<span class="ident" id="5372912">nil</span><span class="op" id="5372915">,</span>&nbsp;<span class="ident" id="5372917">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5372922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372925">d</span><span class="op" id="5372926">,</span>&nbsp;<span class="ident" id="5372928">err</span>&nbsp;<span class="op" id="5372932">:=</span>&nbsp;<span class="ident" id="5372935">ds</span><span class="op" id="5372937">.</span><span class="ident" id="5372938">Data</span><span class="op" id="5372942">(</span><span class="op" id="5372943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372946">if</span>&nbsp;<span class="ident" id="5372949">err</span>&nbsp;<span class="op" id="5372953">!=</span>&nbsp;<span class="ident" id="5372956">nil</span>&nbsp;<span class="op" id="5372960">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372964">return</span>&nbsp;<span class="ident" id="5372971">nil</span><span class="op" id="5372974">,</span>&nbsp;<span class="ident" id="5372976">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5372981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372984">str</span><span class="op" id="5372987">,</span>&nbsp;<span class="ident" id="5372989">err</span>&nbsp;<span class="op" id="5372993">:=</span>&nbsp;<span class="ident" id="5372996">f</span><span class="op" id="5372997">.</span><span class="ident" id="5372998">stringTable</span><span class="op" id="5373009">(</span><span class="ident" id="5373010">ds</span><span class="op" id="5373012">.</span><span class="ident" id="5373013">Link</span><span class="op" id="5373017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373020">if</span>&nbsp;<span class="ident" id="5373023">err</span>&nbsp;<span class="op" id="5373027">!=</span>&nbsp;<span class="ident" id="5373030">nil</span>&nbsp;<span class="op" id="5373034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373038">return</span>&nbsp;<span class="ident" id="5373045">nil</span><span class="op" id="5373048">,</span>&nbsp;<span class="ident" id="5373050">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5373055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373058">var</span>&nbsp;<span class="ident" id="5373062">all</span>&nbsp;<span class="op" id="5373066">[</span><span class="op" id="5373067">]</span><span class="builtintype" id="5373068">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373076">for</span>&nbsp;<span class="builtinfunc" id="5373080">len</span><span class="op" id="5373083">(</span><span class="ident" id="5373084">d</span><span class="op" id="5373085">)</span>&nbsp;<span class="op" id="5373087">&gt;</span>&nbsp;<span class="num" id="5373089">0</span>&nbsp;<span class="op" id="5373091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373095">var</span>&nbsp;<span class="ident" id="5373099">t</span>&nbsp;<span class="ident" id="5373101">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373110">var</span>&nbsp;<span class="ident" id="5373114">v</span>&nbsp;<span class="ident" id="5373116">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373125">switch</span>&nbsp;<span class="ident" id="5373132">f</span><span class="op" id="5373133">.</span><span class="ident" id="5373134">Class</span>&nbsp;<span class="op" id="5373140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373144">case</span>&nbsp;<span class="ident" id="5373149">ELFCLASS32</span><span class="op" id="5373159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373164">t</span>&nbsp;<span class="op" id="5373166">=</span>&nbsp;<span class="ident" id="5373168">DynTag</span><span class="op" id="5373174">(</span><span class="ident" id="5373175">f</span><span class="op" id="5373176">.</span><span class="ident" id="5373177">ByteOrder</span><span class="op" id="5373186">.</span><span class="ident" id="5373187">Uint32</span><span class="op" id="5373193">(</span><span class="ident" id="5373194">d</span><span class="op" id="5373195">[</span><span class="num" id="5373196">0</span><span class="op" id="5373197">:</span><span class="num" id="5373198">4</span><span class="op" id="5373199">]</span><span class="op" id="5373200">)</span><span class="op" id="5373201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373206">v</span>&nbsp;<span class="op" id="5373208">=</span>&nbsp;<span class="ident" id="5373210">uint64</span><span class="op" id="5373216">(</span><span class="ident" id="5373217">f</span><span class="op" id="5373218">.</span><span class="ident" id="5373219">ByteOrder</span><span class="op" id="5373228">.</span><span class="ident" id="5373229">Uint32</span><span class="op" id="5373235">(</span><span class="ident" id="5373236">d</span><span class="op" id="5373237">[</span><span class="num" id="5373238">4</span><span class="op" id="5373239">:</span><span class="num" id="5373240">8</span><span class="op" id="5373241">]</span><span class="op" id="5373242">)</span><span class="op" id="5373243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373248">d</span>&nbsp;<span class="op" id="5373250">=</span>&nbsp;<span class="ident" id="5373252">d</span><span class="op" id="5373253">[</span><span class="num" id="5373254">8</span><span class="op" id="5373255">:</span><span class="op" id="5373256">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373260">case</span>&nbsp;<span class="ident" id="5373265">ELFCLASS64</span><span class="op" id="5373275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373280">t</span>&nbsp;<span class="op" id="5373282">=</span>&nbsp;<span class="ident" id="5373284">DynTag</span><span class="op" id="5373290">(</span><span class="ident" id="5373291">f</span><span class="op" id="5373292">.</span><span class="ident" id="5373293">ByteOrder</span><span class="op" id="5373302">.</span><span class="ident" id="5373303">Uint64</span><span class="op" id="5373309">(</span><span class="ident" id="5373310">d</span><span class="op" id="5373311">[</span><span class="num" id="5373312">0</span><span class="op" id="5373313">:</span><span class="num" id="5373314">8</span><span class="op" id="5373315">]</span><span class="op" id="5373316">)</span><span class="op" id="5373317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373322">v</span>&nbsp;<span class="op" id="5373324">=</span>&nbsp;<span class="ident" id="5373326">f</span><span class="op" id="5373327">.</span><span class="ident" id="5373328">ByteOrder</span><span class="op" id="5373337">.</span><span class="ident" id="5373338">Uint64</span><span class="op" id="5373344">(</span><span class="ident" id="5373345">d</span><span class="op" id="5373346">[</span><span class="num" id="5373347">8</span><span class="op" id="5373348">:</span><span class="num" id="5373349">16</span><span class="op" id="5373351">]</span><span class="op" id="5373352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373357">d</span>&nbsp;<span class="op" id="5373359">=</span>&nbsp;<span class="ident" id="5373361">d</span><span class="op" id="5373362">[</span><span class="num" id="5373363">16</span><span class="op" id="5373365">:</span><span class="op" id="5373366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5373370">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373374">if</span>&nbsp;<span class="ident" id="5373377">t</span>&nbsp;<span class="op" id="5373379">==</span>&nbsp;<span class="ident" id="5373382">tag</span>&nbsp;<span class="op" id="5373386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373391">s</span><span class="op" id="5373392">,</span>&nbsp;<span class="ident" id="5373394">ok</span>&nbsp;<span class="op" id="5373397">:=</span>&nbsp;<span class="ident" id="5373400">getString</span><span class="op" id="5373409">(</span><span class="ident" id="5373410">str</span><span class="op" id="5373413">,</span>&nbsp;<span class="builtintype" id="5373415">int</span><span class="op" id="5373418">(</span><span class="ident" id="5373419">v</span><span class="op" id="5373420">)</span><span class="op" id="5373421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373426">if</span>&nbsp;<span class="ident" id="5373429">ok</span>&nbsp;<span class="op" id="5373432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373438">all</span>&nbsp;<span class="op" id="5373442">=</span>&nbsp;<span class="builtinfunc" id="5373444">append</span><span class="op" id="5373450">(</span><span class="ident" id="5373451">all</span><span class="op" id="5373454">,</span>&nbsp;<span class="ident" id="5373456">s</span><span class="op" id="5373457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5373462">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5373466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5373469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373472">return</span>&nbsp;<span class="ident" id="5373479">all</span><span class="op" id="5373482">,</span>&nbsp;<span class="ident" id="5373484">nil</span><br>
<span class="lineno"></span><span class="op" id="5373488">}</span>
</div>
</body>
</html>
