<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html" class="current">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1753473">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1753528">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1753582">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1753633">//&nbsp;Time-related&nbsp;runtime&nbsp;and&nbsp;pieces&nbsp;of&nbsp;package&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1753686">package</span>&nbsp;<span class="ident" id="1753694">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1753703">import</span>&nbsp;<span class="string" id="1753710">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1753720">//&nbsp;Package&nbsp;time&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1753772">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../time/sleep.go:/runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="1753838">//&nbsp;For&nbsp;GOOS=nacl,&nbsp;package&nbsp;syscall&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1753908">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../syscall/net_nacl.go:/runtimeTimer.</span><br>
<span class="lineno">15</span><span class="keyword" id="1753980">type</span>&nbsp;<span class="ident" id="1753985">timer</span>&nbsp;<span class="keyword" id="1753991">struct</span>&nbsp;<span class="op" id="1753998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754001">i</span>&nbsp;<span class="builtintype" id="1754003">int</span>&nbsp;<span class="comment" id="1754007">//&nbsp;heap&nbsp;index</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1754023">//&nbsp;Timer&nbsp;wakes&nbsp;up&nbsp;at&nbsp;when,&nbsp;and&nbsp;then&nbsp;at&nbsp;when+period,&nbsp;...&nbsp;(period&nbsp;&gt;&nbsp;0&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1754098">//&nbsp;each&nbsp;time&nbsp;calling&nbsp;f(now,&nbsp;arg)&nbsp;in&nbsp;the&nbsp;timer&nbsp;goroutine,&nbsp;so&nbsp;f&nbsp;must&nbsp;be</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1754169">//&nbsp;a&nbsp;well-behaved&nbsp;function&nbsp;and&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754212">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1754219">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754226">period</span>&nbsp;<span class="ident" id="1754233">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754240">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1754247">func</span><span class="op" id="1754251">(</span><span class="keyword" id="1754252">interface</span><span class="op" id="1754261">{</span><span class="op" id="1754262">}</span><span class="op" id="1754263">,</span>&nbsp;<span class="builtintype" id="1754265">uintptr</span><span class="op" id="1754272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754275">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1754282">interface</span><span class="op" id="1754291">{</span><span class="op" id="1754292">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754295">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1754302">uintptr</span><br>
<span class="lineno"></span><span class="op" id="1754310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1754313">var</span>&nbsp;<span class="ident" id="1754317">timers</span>&nbsp;<span class="keyword" id="1754324">struct</span>&nbsp;<span class="op" id="1754331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754334">lock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1754347">mutex</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754354">gp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1754367">*</span><span class="ident" id="1754368">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754371">created</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1754384">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754390">sleeping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1754403">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754409">rescheduling</span>&nbsp;<span class="builtintype" id="1754422">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754428">waitnote</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1754441">note</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754447">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1754460">[</span><span class="op" id="1754461">]</span><span class="op" id="1754462">*</span><span class="ident" id="1754463">timer</span><br>
<span class="lineno"></span><span class="op" id="1754469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1754472">//&nbsp;nacl&nbsp;fake&nbsp;time&nbsp;support&nbsp;-&nbsp;time&nbsp;in&nbsp;nanoseconds&nbsp;since&nbsp;1970</span><br>
<span class="lineno"></span><span class="keyword" id="1754531">var</span>&nbsp;<span class="ident" id="1754535">faketime</span>&nbsp;<span class="ident" id="1754544">int64</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1754551">//&nbsp;Package&nbsp;time&nbsp;APIs.</span><br>
<span class="lineno"></span><span class="comment" id="1754573">//&nbsp;Godoc&nbsp;uses&nbsp;the&nbsp;comments&nbsp;in&nbsp;package&nbsp;time,&nbsp;not&nbsp;these.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1754629">//&nbsp;time.now&nbsp;is&nbsp;implemented&nbsp;in&nbsp;assembly.</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="1754670">//&nbsp;Sleep&nbsp;puts&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;sleep&nbsp;for&nbsp;at&nbsp;least&nbsp;ns&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="1754744">func</span>&nbsp;<span class="ident" id="1754749">timeSleep</span><span class="op" id="1754758">(</span><span class="ident" id="1754759">ns</span>&nbsp;<span class="ident" id="1754762">int64</span><span class="op" id="1754767">)</span>&nbsp;<span class="op" id="1754769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1754772">if</span>&nbsp;<span class="ident" id="1754775">ns</span>&nbsp;<span class="op" id="1754778">&lt;=</span>&nbsp;<span class="num" id="1754781">0</span>&nbsp;<span class="op" id="1754783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1754787">return</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754799">t</span>&nbsp;<span class="op" id="1754801">:=</span>&nbsp;<span class="builtinfunc" id="1754804">new</span><span class="op" id="1754807">(</span><span class="ident" id="1754808">timer</span><span class="op" id="1754813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754816">t</span><span class="op" id="1754817">.</span><span class="ident" id="1754818">when</span>&nbsp;<span class="op" id="1754823">=</span>&nbsp;<span class="ident" id="1754825">nanotime</span><span class="op" id="1754833">(</span><span class="op" id="1754834">)</span>&nbsp;<span class="op" id="1754836">+</span>&nbsp;<span class="ident" id="1754838">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754842">t</span><span class="op" id="1754843">.</span><span class="ident" id="1754844">f</span>&nbsp;<span class="op" id="1754846">=</span>&nbsp;<span class="ident" id="1754848">goroutineReady</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754864">t</span><span class="op" id="1754865">.</span><span class="ident" id="1754866">arg</span>&nbsp;<span class="op" id="1754870">=</span>&nbsp;<span class="ident" id="1754872">getg</span><span class="op" id="1754876">(</span><span class="op" id="1754877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754880">lock</span><span class="op" id="1754884">(</span><span class="op" id="1754885">&amp;</span><span class="ident" id="1754886">timers</span><span class="op" id="1754892">.</span><span class="ident" id="1754893">lock</span><span class="op" id="1754897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754900">addtimerLocked</span><span class="op" id="1754914">(</span><span class="ident" id="1754915">t</span><span class="op" id="1754916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1754919">goparkunlock</span><span class="op" id="1754931">(</span><span class="op" id="1754932">&amp;</span><span class="ident" id="1754933">timers</span><span class="op" id="1754939">.</span><span class="ident" id="1754940">lock</span><span class="op" id="1754944">,</span>&nbsp;<span class="string" id="1754946">&#34;sleep&#34;</span><span class="op" id="1754953">)</span><br>
<span class="lineno"></span><span class="op" id="1754955">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1754958">//&nbsp;startTimer&nbsp;adds&nbsp;t&nbsp;to&nbsp;the&nbsp;timer&nbsp;heap.</span><br>
<span class="lineno"></span><span class="keyword" id="1754998">func</span>&nbsp;<span class="ident" id="1755003">startTimer</span><span class="op" id="1755013">(</span><span class="ident" id="1755014">t</span>&nbsp;<span class="op" id="1755016">*</span><span class="ident" id="1755017">timer</span><span class="op" id="1755022">)</span>&nbsp;<span class="op" id="1755024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1755027">if</span>&nbsp;<span class="ident" id="1755030">raceenabled</span>&nbsp;<span class="op" id="1755042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755046">racerelease</span><span class="op" id="1755057">(</span><span class="ident" id="1755058">unsafe</span><span class="op" id="1755064">.</span><span class="ident" id="1755065">Pointer</span><span class="op" id="1755072">(</span><span class="ident" id="1755073">t</span><span class="op" id="1755074">)</span><span class="op" id="1755075">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755081">addtimer</span><span class="op" id="1755089">(</span><span class="ident" id="1755090">t</span><span class="op" id="1755091">)</span><br>
<span class="lineno"></span><span class="op" id="1755093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1755096">//&nbsp;stopTimer&nbsp;removes&nbsp;t&nbsp;from&nbsp;the&nbsp;timer&nbsp;heap&nbsp;if&nbsp;it&nbsp;is&nbsp;there.</span><br>
<span class="lineno">70</span><span class="comment" id="1755155">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;t&nbsp;was&nbsp;removed,&nbsp;false&nbsp;if&nbsp;t&nbsp;wasn&#39;t&nbsp;even&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="1755222">func</span>&nbsp;<span class="ident" id="1755227">stopTimer</span><span class="op" id="1755236">(</span><span class="ident" id="1755237">t</span>&nbsp;<span class="op" id="1755239">*</span><span class="ident" id="1755240">timer</span><span class="op" id="1755245">)</span>&nbsp;<span class="builtintype" id="1755247">bool</span>&nbsp;<span class="op" id="1755252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1755255">return</span>&nbsp;<span class="ident" id="1755262">deltimer</span><span class="op" id="1755270">(</span><span class="ident" id="1755271">t</span><span class="op" id="1755272">)</span><br>
<span class="lineno"></span><span class="op" id="1755274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1755277">//&nbsp;Go&nbsp;runtime.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1755293">//&nbsp;Ready&nbsp;the&nbsp;goroutine&nbsp;arg.</span><br>
<span class="lineno"></span><span class="keyword" id="1755321">func</span>&nbsp;<span class="ident" id="1755326">goroutineReady</span><span class="op" id="1755340">(</span><span class="ident" id="1755341">arg</span>&nbsp;<span class="keyword" id="1755345">interface</span><span class="op" id="1755354">{</span><span class="op" id="1755355">}</span><span class="op" id="1755356">,</span>&nbsp;<span class="ident" id="1755358">seq</span>&nbsp;<span class="builtintype" id="1755362">uintptr</span><span class="op" id="1755369">)</span>&nbsp;<span class="op" id="1755371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755374">goready</span><span class="op" id="1755381">(</span><span class="ident" id="1755382">arg</span><span class="op" id="1755385">.</span><span class="op" id="1755386">(</span><span class="op" id="1755387">*</span><span class="ident" id="1755388">g</span><span class="op" id="1755389">)</span><span class="op" id="1755390">)</span><br>
<span class="lineno">80</span><span class="op" id="1755392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1755395">func</span>&nbsp;<span class="ident" id="1755400">addtimer</span><span class="op" id="1755408">(</span><span class="ident" id="1755409">t</span>&nbsp;<span class="op" id="1755411">*</span><span class="ident" id="1755412">timer</span><span class="op" id="1755417">)</span>&nbsp;<span class="op" id="1755419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755422">lock</span><span class="op" id="1755426">(</span><span class="op" id="1755427">&amp;</span><span class="ident" id="1755428">timers</span><span class="op" id="1755434">.</span><span class="ident" id="1755435">lock</span><span class="op" id="1755439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755442">addtimerLocked</span><span class="op" id="1755456">(</span><span class="ident" id="1755457">t</span><span class="op" id="1755458">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755461">unlock</span><span class="op" id="1755467">(</span><span class="op" id="1755468">&amp;</span><span class="ident" id="1755469">timers</span><span class="op" id="1755475">.</span><span class="ident" id="1755476">lock</span><span class="op" id="1755480">)</span><br>
<span class="lineno"></span><span class="op" id="1755482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1755485">//&nbsp;Add&nbsp;a&nbsp;timer&nbsp;to&nbsp;the&nbsp;heap&nbsp;and&nbsp;start&nbsp;or&nbsp;kick&nbsp;the&nbsp;timer&nbsp;proc.</span><br>
<span class="lineno"></span><span class="comment" id="1755546">//&nbsp;If&nbsp;the&nbsp;new&nbsp;timer&nbsp;is&nbsp;earlier&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;others.</span><br>
<span class="lineno">90</span><span class="comment" id="1755601">//&nbsp;Timers&nbsp;are&nbsp;locked.</span><br>
<span class="lineno"></span><span class="keyword" id="1755623">func</span>&nbsp;<span class="ident" id="1755628">addtimerLocked</span><span class="op" id="1755642">(</span><span class="ident" id="1755643">t</span>&nbsp;<span class="op" id="1755645">*</span><span class="ident" id="1755646">timer</span><span class="op" id="1755651">)</span>&nbsp;<span class="op" id="1755653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1755656">//&nbsp;when&nbsp;must&nbsp;never&nbsp;be&nbsp;negative;&nbsp;otherwise&nbsp;timerproc&nbsp;will&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1755723">//&nbsp;during&nbsp;its&nbsp;delta&nbsp;calculation&nbsp;and&nbsp;never&nbsp;expire&nbsp;other&nbsp;runtime·timers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1755796">if</span>&nbsp;<span class="ident" id="1755799">t</span><span class="op" id="1755800">.</span><span class="ident" id="1755801">when</span>&nbsp;<span class="op" id="1755806">&lt;</span>&nbsp;<span class="num" id="1755808">0</span>&nbsp;<span class="op" id="1755810">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755814">t</span><span class="op" id="1755815">.</span><span class="ident" id="1755816">when</span>&nbsp;<span class="op" id="1755821">=</span>&nbsp;<span class="num" id="1755823">1</span><span class="op" id="1755824">&lt;&lt;</span><span class="num" id="1755826">63</span>&nbsp;<span class="op" id="1755829">-</span>&nbsp;<span class="num" id="1755831">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755837">t</span><span class="op" id="1755838">.</span><span class="ident" id="1755839">i</span>&nbsp;<span class="op" id="1755841">=</span>&nbsp;<span class="builtinfunc" id="1755843">len</span><span class="op" id="1755846">(</span><span class="ident" id="1755847">timers</span><span class="op" id="1755853">.</span><span class="ident" id="1755854">t</span><span class="op" id="1755855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755858">timers</span><span class="op" id="1755864">.</span><span class="ident" id="1755865">t</span>&nbsp;<span class="op" id="1755867">=</span>&nbsp;<span class="builtinfunc" id="1755869">append</span><span class="op" id="1755875">(</span><span class="ident" id="1755876">timers</span><span class="op" id="1755882">.</span><span class="ident" id="1755883">t</span><span class="op" id="1755884">,</span>&nbsp;<span class="ident" id="1755886">t</span><span class="op" id="1755887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755890">siftupTimer</span><span class="op" id="1755901">(</span><span class="ident" id="1755902">t</span><span class="op" id="1755903">.</span><span class="ident" id="1755904">i</span><span class="op" id="1755905">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1755908">if</span>&nbsp;<span class="ident" id="1755911">t</span><span class="op" id="1755912">.</span><span class="ident" id="1755913">i</span>&nbsp;<span class="op" id="1755915">==</span>&nbsp;<span class="num" id="1755918">0</span>&nbsp;<span class="op" id="1755920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1755924">//&nbsp;siftup&nbsp;moved&nbsp;to&nbsp;top:&nbsp;new&nbsp;earliest&nbsp;deadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1755973">if</span>&nbsp;<span class="ident" id="1755976">timers</span><span class="op" id="1755982">.</span><span class="ident" id="1755983">sleeping</span>&nbsp;<span class="op" id="1755992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1755997">timers</span><span class="op" id="1756003">.</span><span class="ident" id="1756004">sleeping</span>&nbsp;<span class="op" id="1756013">=</span>&nbsp;<span class="builtintype" id="1756015">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756024">notewakeup</span><span class="op" id="1756034">(</span><span class="op" id="1756035">&amp;</span><span class="ident" id="1756036">timers</span><span class="op" id="1756042">.</span><span class="ident" id="1756043">waitnote</span><span class="op" id="1756051">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756059">if</span>&nbsp;<span class="ident" id="1756062">timers</span><span class="op" id="1756068">.</span><span class="ident" id="1756069">rescheduling</span>&nbsp;<span class="op" id="1756082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756087">timers</span><span class="op" id="1756093">.</span><span class="ident" id="1756094">rescheduling</span>&nbsp;<span class="op" id="1756107">=</span>&nbsp;<span class="builtintype" id="1756109">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756118">goready</span><span class="op" id="1756125">(</span><span class="ident" id="1756126">timers</span><span class="op" id="1756132">.</span><span class="ident" id="1756133">gp</span><span class="op" id="1756135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756139">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756145">if</span>&nbsp;<span class="op" id="1756148">!</span><span class="ident" id="1756149">timers</span><span class="op" id="1756155">.</span><span class="ident" id="1756156">created</span>&nbsp;<span class="op" id="1756164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756168">timers</span><span class="op" id="1756174">.</span><span class="ident" id="1756175">created</span>&nbsp;<span class="op" id="1756183">=</span>&nbsp;<span class="builtintype" id="1756185">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756192">go</span>&nbsp;<span class="ident" id="1756195">timerproc</span><span class="op" id="1756204">(</span><span class="op" id="1756205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756208">}</span><br>
<span class="lineno">115</span><span class="op" id="1756210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1756213">//&nbsp;Delete&nbsp;timer&nbsp;t&nbsp;from&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span><span class="comment" id="1756246">//&nbsp;Do&nbsp;not&nbsp;need&nbsp;to&nbsp;update&nbsp;the&nbsp;timerproc:&nbsp;if&nbsp;it&nbsp;wakes&nbsp;up&nbsp;early,&nbsp;no&nbsp;big&nbsp;deal.</span><br>
<span class="lineno"></span><span class="keyword" id="1756321">func</span>&nbsp;<span class="ident" id="1756326">deltimer</span><span class="op" id="1756334">(</span><span class="ident" id="1756335">t</span>&nbsp;<span class="op" id="1756337">*</span><span class="ident" id="1756338">timer</span><span class="op" id="1756343">)</span>&nbsp;<span class="builtintype" id="1756345">bool</span>&nbsp;<span class="op" id="1756350">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1756353">//&nbsp;Dereference&nbsp;t&nbsp;so&nbsp;that&nbsp;any&nbsp;panic&nbsp;happens&nbsp;before&nbsp;the&nbsp;lock&nbsp;is&nbsp;held.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1756422">//&nbsp;Discard&nbsp;result,&nbsp;because&nbsp;t&nbsp;might&nbsp;be&nbsp;moving&nbsp;in&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756481">_</span>&nbsp;<span class="op" id="1756483">=</span>&nbsp;<span class="ident" id="1756485">t</span><span class="op" id="1756486">.</span><span class="ident" id="1756487">i</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756491">lock</span><span class="op" id="1756495">(</span><span class="op" id="1756496">&amp;</span><span class="ident" id="1756497">timers</span><span class="op" id="1756503">.</span><span class="ident" id="1756504">lock</span><span class="op" id="1756508">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1756511">//&nbsp;t&nbsp;may&nbsp;not&nbsp;be&nbsp;registered&nbsp;anymore&nbsp;and&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1756560">//&nbsp;a&nbsp;bogus&nbsp;i&nbsp;(typically&nbsp;0,&nbsp;if&nbsp;generated&nbsp;by&nbsp;Go).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1756609">//&nbsp;Verify&nbsp;it&nbsp;before&nbsp;proceeding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756642">i</span>&nbsp;<span class="op" id="1756644">:=</span>&nbsp;<span class="ident" id="1756647">t</span><span class="op" id="1756648">.</span><span class="ident" id="1756649">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756652">last</span>&nbsp;<span class="op" id="1756657">:=</span>&nbsp;<span class="builtinfunc" id="1756660">len</span><span class="op" id="1756663">(</span><span class="ident" id="1756664">timers</span><span class="op" id="1756670">.</span><span class="ident" id="1756671">t</span><span class="op" id="1756672">)</span>&nbsp;<span class="op" id="1756674">-</span>&nbsp;<span class="num" id="1756676">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756679">if</span>&nbsp;<span class="ident" id="1756682">i</span>&nbsp;<span class="op" id="1756684">&lt;</span>&nbsp;<span class="num" id="1756686">0</span>&nbsp;<span class="op" id="1756688">||</span>&nbsp;<span class="ident" id="1756691">i</span>&nbsp;<span class="op" id="1756693">&gt;</span>&nbsp;<span class="ident" id="1756695">last</span>&nbsp;<span class="op" id="1756700">||</span>&nbsp;<span class="ident" id="1756703">timers</span><span class="op" id="1756709">.</span><span class="ident" id="1756710">t</span><span class="op" id="1756711">[</span><span class="ident" id="1756712">i</span><span class="op" id="1756713">]</span>&nbsp;<span class="op" id="1756715">!=</span>&nbsp;<span class="ident" id="1756718">t</span>&nbsp;<span class="op" id="1756720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756724">unlock</span><span class="op" id="1756730">(</span><span class="op" id="1756731">&amp;</span><span class="ident" id="1756732">timers</span><span class="op" id="1756738">.</span><span class="ident" id="1756739">lock</span><span class="op" id="1756743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756747">return</span>&nbsp;<span class="builtintype" id="1756754">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756764">if</span>&nbsp;<span class="ident" id="1756767">i</span>&nbsp;<span class="op" id="1756769">!=</span>&nbsp;<span class="ident" id="1756772">last</span>&nbsp;<span class="op" id="1756777">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756781">timers</span><span class="op" id="1756787">.</span><span class="ident" id="1756788">t</span><span class="op" id="1756789">[</span><span class="ident" id="1756790">i</span><span class="op" id="1756791">]</span>&nbsp;<span class="op" id="1756793">=</span>&nbsp;<span class="ident" id="1756795">timers</span><span class="op" id="1756801">.</span><span class="ident" id="1756802">t</span><span class="op" id="1756803">[</span><span class="ident" id="1756804">last</span><span class="op" id="1756808">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756812">timers</span><span class="op" id="1756818">.</span><span class="ident" id="1756819">t</span><span class="op" id="1756820">[</span><span class="ident" id="1756821">i</span><span class="op" id="1756822">]</span><span class="op" id="1756823">.</span><span class="ident" id="1756824">i</span>&nbsp;<span class="op" id="1756826">=</span>&nbsp;<span class="ident" id="1756828">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756834">timers</span><span class="op" id="1756840">.</span><span class="ident" id="1756841">t</span><span class="op" id="1756842">[</span><span class="ident" id="1756843">last</span><span class="op" id="1756847">]</span>&nbsp;<span class="op" id="1756849">=</span>&nbsp;<span class="ident" id="1756851">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756856">timers</span><span class="op" id="1756862">.</span><span class="ident" id="1756863">t</span>&nbsp;<span class="op" id="1756865">=</span>&nbsp;<span class="ident" id="1756867">timers</span><span class="op" id="1756873">.</span><span class="ident" id="1756874">t</span><span class="op" id="1756875">[</span><span class="op" id="1756876">:</span><span class="ident" id="1756877">last</span><span class="op" id="1756881">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756884">if</span>&nbsp;<span class="ident" id="1756887">i</span>&nbsp;<span class="op" id="1756889">!=</span>&nbsp;<span class="ident" id="1756892">last</span>&nbsp;<span class="op" id="1756897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756901">siftupTimer</span><span class="op" id="1756912">(</span><span class="ident" id="1756913">i</span><span class="op" id="1756914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756918">siftdownTimer</span><span class="op" id="1756931">(</span><span class="ident" id="1756932">i</span><span class="op" id="1756933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756939">unlock</span><span class="op" id="1756945">(</span><span class="op" id="1756946">&amp;</span><span class="ident" id="1756947">timers</span><span class="op" id="1756953">.</span><span class="ident" id="1756954">lock</span><span class="op" id="1756958">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756961">return</span>&nbsp;<span class="builtintype" id="1756968">true</span><br>
<span class="lineno"></span><span class="op" id="1756973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1756976">//&nbsp;Timerproc&nbsp;runs&nbsp;the&nbsp;time-driven&nbsp;events.</span><br>
<span class="lineno"></span><span class="comment" id="1757018">//&nbsp;It&nbsp;sleeps&nbsp;until&nbsp;the&nbsp;next&nbsp;event&nbsp;in&nbsp;the&nbsp;timers&nbsp;heap.</span><br>
<span class="lineno">150</span><span class="comment" id="1757072">//&nbsp;If&nbsp;addtimer&nbsp;inserts&nbsp;a&nbsp;new&nbsp;earlier&nbsp;event,&nbsp;addtimer1&nbsp;wakes&nbsp;timerproc&nbsp;early.</span><br>
<span class="lineno"></span><span class="keyword" id="1757149">func</span>&nbsp;<span class="ident" id="1757154">timerproc</span><span class="op" id="1757163">(</span><span class="op" id="1757164">)</span>&nbsp;<span class="op" id="1757166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757169">timers</span><span class="op" id="1757175">.</span><span class="ident" id="1757176">gp</span>&nbsp;<span class="op" id="1757179">=</span>&nbsp;<span class="ident" id="1757181">getg</span><span class="op" id="1757185">(</span><span class="op" id="1757186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757189">timers</span><span class="op" id="1757195">.</span><span class="ident" id="1757196">gp</span><span class="op" id="1757198">.</span><span class="ident" id="1757199">issystem</span>&nbsp;<span class="op" id="1757208">=</span>&nbsp;<span class="builtintype" id="1757210">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757216">for</span>&nbsp;<span class="op" id="1757220">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757224">lock</span><span class="op" id="1757228">(</span><span class="op" id="1757229">&amp;</span><span class="ident" id="1757230">timers</span><span class="op" id="1757236">.</span><span class="ident" id="1757237">lock</span><span class="op" id="1757241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757245">timers</span><span class="op" id="1757251">.</span><span class="ident" id="1757252">sleeping</span>&nbsp;<span class="op" id="1757261">=</span>&nbsp;<span class="builtintype" id="1757263">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757271">now</span>&nbsp;<span class="op" id="1757275">:=</span>&nbsp;<span class="ident" id="1757278">nanotime</span><span class="op" id="1757286">(</span><span class="op" id="1757287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757291">delta</span>&nbsp;<span class="op" id="1757297">:=</span>&nbsp;<span class="ident" id="1757300">int64</span><span class="op" id="1757305">(</span><span class="op" id="1757306">-</span><span class="num" id="1757307">1</span><span class="op" id="1757308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757312">for</span>&nbsp;<span class="op" id="1757316">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757321">if</span>&nbsp;<span class="builtinfunc" id="1757324">len</span><span class="op" id="1757327">(</span><span class="ident" id="1757328">timers</span><span class="op" id="1757334">.</span><span class="ident" id="1757335">t</span><span class="op" id="1757336">)</span>&nbsp;<span class="op" id="1757338">==</span>&nbsp;<span class="num" id="1757341">0</span>&nbsp;<span class="op" id="1757343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757349">delta</span>&nbsp;<span class="op" id="1757355">=</span>&nbsp;<span class="op" id="1757357">-</span><span class="num" id="1757358">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757364">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1757373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757378">t</span>&nbsp;<span class="op" id="1757380">:=</span>&nbsp;<span class="ident" id="1757383">timers</span><span class="op" id="1757389">.</span><span class="ident" id="1757390">t</span><span class="op" id="1757391">[</span><span class="num" id="1757392">0</span><span class="op" id="1757393">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757398">delta</span>&nbsp;<span class="op" id="1757404">=</span>&nbsp;<span class="ident" id="1757406">t</span><span class="op" id="1757407">.</span><span class="ident" id="1757408">when</span>&nbsp;<span class="op" id="1757413">-</span>&nbsp;<span class="ident" id="1757415">now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757422">if</span>&nbsp;<span class="ident" id="1757425">delta</span>&nbsp;<span class="op" id="1757431">&gt;</span>&nbsp;<span class="num" id="1757433">0</span>&nbsp;<span class="op" id="1757435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757441">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1757450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757455">if</span>&nbsp;<span class="ident" id="1757458">t</span><span class="op" id="1757459">.</span><span class="ident" id="1757460">period</span>&nbsp;<span class="op" id="1757467">&gt;</span>&nbsp;<span class="num" id="1757469">0</span>&nbsp;<span class="op" id="1757471">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1757477">//&nbsp;leave&nbsp;in&nbsp;heap&nbsp;but&nbsp;adjust&nbsp;next&nbsp;time&nbsp;to&nbsp;fire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757527">t</span><span class="op" id="1757528">.</span><span class="ident" id="1757529">when</span>&nbsp;<span class="op" id="1757534">+=</span>&nbsp;<span class="ident" id="1757537">t</span><span class="op" id="1757538">.</span><span class="ident" id="1757539">period</span>&nbsp;<span class="op" id="1757546">*</span>&nbsp;<span class="op" id="1757548">(</span><span class="num" id="1757549">1</span>&nbsp;<span class="op" id="1757551">+</span>&nbsp;<span class="op" id="1757553">-</span><span class="ident" id="1757554">delta</span><span class="op" id="1757559">/</span><span class="ident" id="1757560">t</span><span class="op" id="1757561">.</span><span class="ident" id="1757562">period</span><span class="op" id="1757568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757574">siftdownTimer</span><span class="op" id="1757587">(</span><span class="num" id="1757588">0</span><span class="op" id="1757589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1757594">}</span>&nbsp;<span class="keyword" id="1757596">else</span>&nbsp;<span class="op" id="1757601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1757607">//&nbsp;remove&nbsp;from&nbsp;heap</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757631">last</span>&nbsp;<span class="op" id="1757636">:=</span>&nbsp;<span class="builtinfunc" id="1757639">len</span><span class="op" id="1757642">(</span><span class="ident" id="1757643">timers</span><span class="op" id="1757649">.</span><span class="ident" id="1757650">t</span><span class="op" id="1757651">)</span>&nbsp;<span class="op" id="1757653">-</span>&nbsp;<span class="num" id="1757655">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757661">if</span>&nbsp;<span class="ident" id="1757664">last</span>&nbsp;<span class="op" id="1757669">&gt;</span>&nbsp;<span class="num" id="1757671">0</span>&nbsp;<span class="op" id="1757673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757680">timers</span><span class="op" id="1757686">.</span><span class="ident" id="1757687">t</span><span class="op" id="1757688">[</span><span class="num" id="1757689">0</span><span class="op" id="1757690">]</span>&nbsp;<span class="op" id="1757692">=</span>&nbsp;<span class="ident" id="1757694">timers</span><span class="op" id="1757700">.</span><span class="ident" id="1757701">t</span><span class="op" id="1757702">[</span><span class="ident" id="1757703">last</span><span class="op" id="1757707">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757714">timers</span><span class="op" id="1757720">.</span><span class="ident" id="1757721">t</span><span class="op" id="1757722">[</span><span class="num" id="1757723">0</span><span class="op" id="1757724">]</span><span class="op" id="1757725">.</span><span class="ident" id="1757726">i</span>&nbsp;<span class="op" id="1757728">=</span>&nbsp;<span class="num" id="1757730">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1757736">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757742">timers</span><span class="op" id="1757748">.</span><span class="ident" id="1757749">t</span><span class="op" id="1757750">[</span><span class="ident" id="1757751">last</span><span class="op" id="1757755">]</span>&nbsp;<span class="op" id="1757757">=</span>&nbsp;<span class="ident" id="1757759">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757767">timers</span><span class="op" id="1757773">.</span><span class="ident" id="1757774">t</span>&nbsp;<span class="op" id="1757776">=</span>&nbsp;<span class="ident" id="1757778">timers</span><span class="op" id="1757784">.</span><span class="ident" id="1757785">t</span><span class="op" id="1757786">[</span><span class="op" id="1757787">:</span><span class="ident" id="1757788">last</span><span class="op" id="1757792">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757798">if</span>&nbsp;<span class="ident" id="1757801">last</span>&nbsp;<span class="op" id="1757806">&gt;</span>&nbsp;<span class="num" id="1757808">0</span>&nbsp;<span class="op" id="1757810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757817">siftdownTimer</span><span class="op" id="1757830">(</span><span class="num" id="1757831">0</span><span class="op" id="1757832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1757838">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757844">t</span><span class="op" id="1757845">.</span><span class="ident" id="1757846">i</span>&nbsp;<span class="op" id="1757848">=</span>&nbsp;<span class="op" id="1757850">-</span><span class="num" id="1757851">1</span>&nbsp;<span class="comment" id="1757853">//&nbsp;mark&nbsp;as&nbsp;removed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1757875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757880">f</span>&nbsp;<span class="op" id="1757882">:=</span>&nbsp;<span class="ident" id="1757885">t</span><span class="op" id="1757886">.</span><span class="ident" id="1757887">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757892">arg</span>&nbsp;<span class="op" id="1757896">:=</span>&nbsp;<span class="ident" id="1757899">t</span><span class="op" id="1757900">.</span><span class="ident" id="1757901">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757908">seq</span>&nbsp;<span class="op" id="1757912">:=</span>&nbsp;<span class="ident" id="1757915">t</span><span class="op" id="1757916">.</span><span class="ident" id="1757917">seq</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757924">unlock</span><span class="op" id="1757930">(</span><span class="op" id="1757931">&amp;</span><span class="ident" id="1757932">timers</span><span class="op" id="1757938">.</span><span class="ident" id="1757939">lock</span><span class="op" id="1757943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757948">if</span>&nbsp;<span class="ident" id="1757951">raceenabled</span>&nbsp;<span class="op" id="1757963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757969">raceacquire</span><span class="op" id="1757980">(</span><span class="ident" id="1757981">unsafe</span><span class="op" id="1757987">.</span><span class="ident" id="1757988">Pointer</span><span class="op" id="1757995">(</span><span class="ident" id="1757996">t</span><span class="op" id="1757997">)</span><span class="op" id="1757998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758008">f</span><span class="op" id="1758009">(</span><span class="ident" id="1758010">arg</span><span class="op" id="1758013">,</span>&nbsp;<span class="ident" id="1758015">seq</span><span class="op" id="1758018">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758023">lock</span><span class="op" id="1758027">(</span><span class="op" id="1758028">&amp;</span><span class="ident" id="1758029">timers</span><span class="op" id="1758035">.</span><span class="ident" id="1758036">lock</span><span class="op" id="1758040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758048">if</span>&nbsp;<span class="ident" id="1758051">delta</span>&nbsp;<span class="op" id="1758057">&lt;</span>&nbsp;<span class="num" id="1758059">0</span>&nbsp;<span class="op" id="1758061">||</span>&nbsp;<span class="ident" id="1758064">faketime</span>&nbsp;<span class="op" id="1758073">&gt;</span>&nbsp;<span class="num" id="1758075">0</span>&nbsp;<span class="op" id="1758077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1758082">//&nbsp;No&nbsp;timers&nbsp;left&nbsp;-&nbsp;put&nbsp;goroutine&nbsp;to&nbsp;sleep.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758129">timers</span><span class="op" id="1758135">.</span><span class="ident" id="1758136">rescheduling</span>&nbsp;<span class="op" id="1758149">=</span>&nbsp;<span class="builtintype" id="1758151">true</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758159">goparkunlock</span><span class="op" id="1758171">(</span><span class="op" id="1758172">&amp;</span><span class="ident" id="1758173">timers</span><span class="op" id="1758179">.</span><span class="ident" id="1758180">lock</span><span class="op" id="1758184">,</span>&nbsp;<span class="string" id="1758186">&#34;timer&nbsp;goroutine&nbsp;(idle)&#34;</span><span class="op" id="1758210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758215">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1758230">//&nbsp;At&nbsp;least&nbsp;one&nbsp;timer&nbsp;pending.&nbsp;&nbsp;Sleep&nbsp;until&nbsp;then.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758282">timers</span><span class="op" id="1758288">.</span><span class="ident" id="1758289">sleeping</span>&nbsp;<span class="op" id="1758298">=</span>&nbsp;<span class="builtintype" id="1758300">true</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758307">noteclear</span><span class="op" id="1758316">(</span><span class="op" id="1758317">&amp;</span><span class="ident" id="1758318">timers</span><span class="op" id="1758324">.</span><span class="ident" id="1758325">waitnote</span><span class="op" id="1758333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758337">unlock</span><span class="op" id="1758343">(</span><span class="op" id="1758344">&amp;</span><span class="ident" id="1758345">timers</span><span class="op" id="1758351">.</span><span class="ident" id="1758352">lock</span><span class="op" id="1758356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758360">notetsleepg</span><span class="op" id="1758371">(</span><span class="op" id="1758372">&amp;</span><span class="ident" id="1758373">timers</span><span class="op" id="1758379">.</span><span class="ident" id="1758380">waitnote</span><span class="op" id="1758388">,</span>&nbsp;<span class="ident" id="1758390">delta</span><span class="op" id="1758395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758398">}</span><br>
<span class="lineno"></span><span class="op" id="1758400">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1758403">func</span>&nbsp;<span class="ident" id="1758408">timejump</span><span class="op" id="1758416">(</span><span class="op" id="1758417">)</span>&nbsp;<span class="op" id="1758419">*</span><span class="ident" id="1758420">g</span>&nbsp;<span class="op" id="1758422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758425">if</span>&nbsp;<span class="ident" id="1758428">faketime</span>&nbsp;<span class="op" id="1758437">==</span>&nbsp;<span class="num" id="1758440">0</span>&nbsp;<span class="op" id="1758442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758446">return</span>&nbsp;<span class="ident" id="1758453">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758458">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758462">lock</span><span class="op" id="1758466">(</span><span class="op" id="1758467">&amp;</span><span class="ident" id="1758468">timers</span><span class="op" id="1758474">.</span><span class="ident" id="1758475">lock</span><span class="op" id="1758479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758482">if</span>&nbsp;<span class="op" id="1758485">!</span><span class="ident" id="1758486">timers</span><span class="op" id="1758492">.</span><span class="ident" id="1758493">created</span>&nbsp;<span class="op" id="1758501">||</span>&nbsp;<span class="builtinfunc" id="1758504">len</span><span class="op" id="1758507">(</span><span class="ident" id="1758508">timers</span><span class="op" id="1758514">.</span><span class="ident" id="1758515">t</span><span class="op" id="1758516">)</span>&nbsp;<span class="op" id="1758518">==</span>&nbsp;<span class="num" id="1758521">0</span>&nbsp;<span class="op" id="1758523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758527">unlock</span><span class="op" id="1758533">(</span><span class="op" id="1758534">&amp;</span><span class="ident" id="1758535">timers</span><span class="op" id="1758541">.</span><span class="ident" id="1758542">lock</span><span class="op" id="1758546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758550">return</span>&nbsp;<span class="ident" id="1758557">nil</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758566">var</span>&nbsp;<span class="ident" id="1758570">gp</span>&nbsp;<span class="op" id="1758573">*</span><span class="ident" id="1758574">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758577">if</span>&nbsp;<span class="ident" id="1758580">faketime</span>&nbsp;<span class="op" id="1758589">&lt;</span>&nbsp;<span class="ident" id="1758591">timers</span><span class="op" id="1758597">.</span><span class="ident" id="1758598">t</span><span class="op" id="1758599">[</span><span class="num" id="1758600">0</span><span class="op" id="1758601">]</span><span class="op" id="1758602">.</span><span class="ident" id="1758603">when</span>&nbsp;<span class="op" id="1758608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758612">faketime</span>&nbsp;<span class="op" id="1758621">=</span>&nbsp;<span class="ident" id="1758623">timers</span><span class="op" id="1758629">.</span><span class="ident" id="1758630">t</span><span class="op" id="1758631">[</span><span class="num" id="1758632">0</span><span class="op" id="1758633">]</span><span class="op" id="1758634">.</span><span class="ident" id="1758635">when</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758642">if</span>&nbsp;<span class="ident" id="1758645">timers</span><span class="op" id="1758651">.</span><span class="ident" id="1758652">rescheduling</span>&nbsp;<span class="op" id="1758665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758670">timers</span><span class="op" id="1758676">.</span><span class="ident" id="1758677">rescheduling</span>&nbsp;<span class="op" id="1758690">=</span>&nbsp;<span class="builtintype" id="1758692">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758701">gp</span>&nbsp;<span class="op" id="1758704">=</span>&nbsp;<span class="ident" id="1758706">timers</span><span class="op" id="1758712">.</span><span class="ident" id="1758713">gp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758721">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758724">unlock</span><span class="op" id="1758730">(</span><span class="op" id="1758731">&amp;</span><span class="ident" id="1758732">timers</span><span class="op" id="1758738">.</span><span class="ident" id="1758739">lock</span><span class="op" id="1758743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758746">return</span>&nbsp;<span class="ident" id="1758753">gp</span><br>
<span class="lineno"></span><span class="op" id="1758756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1758759">//&nbsp;Heap&nbsp;maintenance&nbsp;algorithms.</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="1758792">func</span>&nbsp;<span class="ident" id="1758797">siftupTimer</span><span class="op" id="1758808">(</span><span class="ident" id="1758809">i</span>&nbsp;<span class="builtintype" id="1758811">int</span><span class="op" id="1758814">)</span>&nbsp;<span class="op" id="1758816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758819">t</span>&nbsp;<span class="op" id="1758821">:=</span>&nbsp;<span class="ident" id="1758824">timers</span><span class="op" id="1758830">.</span><span class="ident" id="1758831">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758834">when</span>&nbsp;<span class="op" id="1758839">:=</span>&nbsp;<span class="ident" id="1758842">t</span><span class="op" id="1758843">[</span><span class="ident" id="1758844">i</span><span class="op" id="1758845">]</span><span class="op" id="1758846">.</span><span class="ident" id="1758847">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758853">tmp</span>&nbsp;<span class="op" id="1758857">:=</span>&nbsp;<span class="ident" id="1758860">t</span><span class="op" id="1758861">[</span><span class="ident" id="1758862">i</span><span class="op" id="1758863">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758866">for</span>&nbsp;<span class="ident" id="1758870">i</span>&nbsp;<span class="op" id="1758872">&gt;</span>&nbsp;<span class="num" id="1758874">0</span>&nbsp;<span class="op" id="1758876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758880">p</span>&nbsp;<span class="op" id="1758882">:=</span>&nbsp;<span class="op" id="1758885">(</span><span class="ident" id="1758886">i</span>&nbsp;<span class="op" id="1758888">-</span>&nbsp;<span class="num" id="1758890">1</span><span class="op" id="1758891">)</span>&nbsp;<span class="op" id="1758893">/</span>&nbsp;<span class="num" id="1758895">4</span>&nbsp;<span class="comment" id="1758897">//&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758909">if</span>&nbsp;<span class="ident" id="1758912">when</span>&nbsp;<span class="op" id="1758917">&gt;=</span>&nbsp;<span class="ident" id="1758920">t</span><span class="op" id="1758921">[</span><span class="ident" id="1758922">p</span><span class="op" id="1758923">]</span><span class="op" id="1758924">.</span><span class="ident" id="1758925">when</span>&nbsp;<span class="op" id="1758930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758935">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758943">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758947">t</span><span class="op" id="1758948">[</span><span class="ident" id="1758949">i</span><span class="op" id="1758950">]</span>&nbsp;<span class="op" id="1758952">=</span>&nbsp;<span class="ident" id="1758954">t</span><span class="op" id="1758955">[</span><span class="ident" id="1758956">p</span><span class="op" id="1758957">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758961">t</span><span class="op" id="1758962">[</span><span class="ident" id="1758963">i</span><span class="op" id="1758964">]</span><span class="op" id="1758965">.</span><span class="ident" id="1758966">i</span>&nbsp;<span class="op" id="1758968">=</span>&nbsp;<span class="ident" id="1758970">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758974">t</span><span class="op" id="1758975">[</span><span class="ident" id="1758976">p</span><span class="op" id="1758977">]</span>&nbsp;<span class="op" id="1758979">=</span>&nbsp;<span class="ident" id="1758981">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758987">t</span><span class="op" id="1758988">[</span><span class="ident" id="1758989">p</span><span class="op" id="1758990">]</span><span class="op" id="1758991">.</span><span class="ident" id="1758992">i</span>&nbsp;<span class="op" id="1758994">=</span>&nbsp;<span class="ident" id="1758996">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759000">i</span>&nbsp;<span class="op" id="1759002">=</span>&nbsp;<span class="ident" id="1759004">p</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1759007">}</span><br>
<span class="lineno"></span><span class="op" id="1759009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1759012">func</span>&nbsp;<span class="ident" id="1759017">siftdownTimer</span><span class="op" id="1759030">(</span><span class="ident" id="1759031">i</span>&nbsp;<span class="builtintype" id="1759033">int</span><span class="op" id="1759036">)</span>&nbsp;<span class="op" id="1759038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759041">t</span>&nbsp;<span class="op" id="1759043">:=</span>&nbsp;<span class="ident" id="1759046">timers</span><span class="op" id="1759052">.</span><span class="ident" id="1759053">t</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759056">n</span>&nbsp;<span class="op" id="1759058">:=</span>&nbsp;<span class="builtinfunc" id="1759061">len</span><span class="op" id="1759064">(</span><span class="ident" id="1759065">t</span><span class="op" id="1759066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759069">when</span>&nbsp;<span class="op" id="1759074">:=</span>&nbsp;<span class="ident" id="1759077">t</span><span class="op" id="1759078">[</span><span class="ident" id="1759079">i</span><span class="op" id="1759080">]</span><span class="op" id="1759081">.</span><span class="ident" id="1759082">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759088">tmp</span>&nbsp;<span class="op" id="1759092">:=</span>&nbsp;<span class="ident" id="1759095">t</span><span class="op" id="1759096">[</span><span class="ident" id="1759097">i</span><span class="op" id="1759098">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1759101">for</span>&nbsp;<span class="op" id="1759105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759109">c</span>&nbsp;<span class="op" id="1759111">:=</span>&nbsp;<span class="ident" id="1759114">i</span><span class="op" id="1759115">*</span><span class="num" id="1759116">4</span>&nbsp;<span class="op" id="1759118">+</span>&nbsp;<span class="num" id="1759120">1</span>&nbsp;<span class="comment" id="1759122">//&nbsp;left&nbsp;child</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759138">c3</span>&nbsp;<span class="op" id="1759141">:=</span>&nbsp;<span class="ident" id="1759144">c</span>&nbsp;<span class="op" id="1759146">+</span>&nbsp;<span class="num" id="1759148">2</span>&nbsp;&nbsp;<span class="comment" id="1759151">//&nbsp;mid&nbsp;child</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1759166">if</span>&nbsp;<span class="ident" id="1759169">c</span>&nbsp;<span class="op" id="1759171">&gt;=</span>&nbsp;<span class="ident" id="1759174">n</span>&nbsp;<span class="op" id="1759176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1759181">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1759189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759193">w</span>&nbsp;<span class="op" id="1759195">:=</span>&nbsp;<span class="ident" id="1759198">t</span><span class="op" id="1759199">[</span><span class="ident" id="1759200">c</span><span class="op" id="1759201">]</span><span class="op" id="1759202">.</span><span class="ident" id="1759203">when</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1759210">if</span>&nbsp;<span class="ident" id="1759213">c</span><span class="op" id="1759214">+</span><span class="num" id="1759215">1</span>&nbsp;<span class="op" id="1759217">&lt;</span>&nbsp;<span class="ident" id="1759219">n</span>&nbsp;<span class="op" id="1759221">&amp;&amp;</span>&nbsp;<span class="ident" id="1759224">t</span><span class="op" id="1759225">[</span><span class="ident" id="1759226">c</span><span class="op" id="1759227">+</span><span class="num" id="1759228">1</span><span class="op" id="1759229">]</span><span class="op" id="1759230">.</span><span class="ident" id="1759231">when</span>&nbsp;<span class="op" id="1759236">&lt;</span>&nbsp;<span class="ident" id="1759238">w</span>&nbsp;<span class="op" id="1759240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759245">w</span>&nbsp;<span class="op" id="1759247">=</span>&nbsp;<span class="ident" id="1759249">t</span><span class="op" id="1759250">[</span><span class="ident" id="1759251">c</span><span class="op" id="1759252">+</span><span class="num" id="1759253">1</span><span class="op" id="1759254">]</span><span class="op" id="1759255">.</span><span class="ident" id="1759256">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759264">c</span><span class="op" id="1759265">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1759270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1759274">if</span>&nbsp;<span class="ident" id="1759277">c3</span>&nbsp;<span class="op" id="1759280">&lt;</span>&nbsp;<span class="ident" id="1759282">n</span>&nbsp;<span class="op" id="1759284">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759289">w3</span>&nbsp;<span class="op" id="1759292">:=</span>&nbsp;<span class="ident" id="1759295">t</span><span class="op" id="1759296">[</span><span class="ident" id="1759297">c3</span><span class="op" id="1759299">]</span><span class="op" id="1759300">.</span><span class="ident" id="1759301">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1759309">if</span>&nbsp;<span class="ident" id="1759312">c3</span><span class="op" id="1759314">+</span><span class="num" id="1759315">1</span>&nbsp;<span class="op" id="1759317">&lt;</span>&nbsp;<span class="ident" id="1759319">n</span>&nbsp;<span class="op" id="1759321">&amp;&amp;</span>&nbsp;<span class="ident" id="1759324">t</span><span class="op" id="1759325">[</span><span class="ident" id="1759326">c3</span><span class="op" id="1759328">+</span><span class="num" id="1759329">1</span><span class="op" id="1759330">]</span><span class="op" id="1759331">.</span><span class="ident" id="1759332">when</span>&nbsp;<span class="op" id="1759337">&lt;</span>&nbsp;<span class="ident" id="1759339">w3</span>&nbsp;<span class="op" id="1759342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759348">w3</span>&nbsp;<span class="op" id="1759351">=</span>&nbsp;<span class="ident" id="1759353">t</span><span class="op" id="1759354">[</span><span class="ident" id="1759355">c3</span><span class="op" id="1759357">+</span><span class="num" id="1759358">1</span><span class="op" id="1759359">]</span><span class="op" id="1759360">.</span><span class="ident" id="1759361">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759370">c3</span><span class="op" id="1759372">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1759378">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1759383">if</span>&nbsp;<span class="ident" id="1759386">w3</span>&nbsp;<span class="op" id="1759389">&lt;</span>&nbsp;<span class="ident" id="1759391">w</span>&nbsp;<span class="op" id="1759393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759399">w</span>&nbsp;<span class="op" id="1759401">=</span>&nbsp;<span class="ident" id="1759403">w3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759410">c</span>&nbsp;<span class="op" id="1759412">=</span>&nbsp;<span class="ident" id="1759414">c3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1759420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1759424">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1759428">if</span>&nbsp;<span class="ident" id="1759431">w</span>&nbsp;<span class="op" id="1759433">&gt;=</span>&nbsp;<span class="ident" id="1759436">when</span>&nbsp;<span class="op" id="1759441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1759446">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1759454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759458">t</span><span class="op" id="1759459">[</span><span class="ident" id="1759460">i</span><span class="op" id="1759461">]</span>&nbsp;<span class="op" id="1759463">=</span>&nbsp;<span class="ident" id="1759465">t</span><span class="op" id="1759466">[</span><span class="ident" id="1759467">c</span><span class="op" id="1759468">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759472">t</span><span class="op" id="1759473">[</span><span class="ident" id="1759474">i</span><span class="op" id="1759475">]</span><span class="op" id="1759476">.</span><span class="ident" id="1759477">i</span>&nbsp;<span class="op" id="1759479">=</span>&nbsp;<span class="ident" id="1759481">i</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759485">t</span><span class="op" id="1759486">[</span><span class="ident" id="1759487">c</span><span class="op" id="1759488">]</span>&nbsp;<span class="op" id="1759490">=</span>&nbsp;<span class="ident" id="1759492">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759498">t</span><span class="op" id="1759499">[</span><span class="ident" id="1759500">c</span><span class="op" id="1759501">]</span><span class="op" id="1759502">.</span><span class="ident" id="1759503">i</span>&nbsp;<span class="op" id="1759505">=</span>&nbsp;<span class="ident" id="1759507">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759511">i</span>&nbsp;<span class="op" id="1759513">=</span>&nbsp;<span class="ident" id="1759515">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1759518">}</span><br>
<span class="lineno"></span><span class="op" id="1759520">}</span>
</div>
</body>
</html>
