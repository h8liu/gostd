<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html" class="current">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2278236">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2278291">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2278345">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2278396">package</span>&nbsp;<span class="ident" id="2278404">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2278410">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2278476">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2278530">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2278581">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2278636">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2278666">//</span><br>
<span class="lineno"></span><span class="comment" id="2278669">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2278725">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2278794">//</span><br>
<span class="lineno"></span><span class="comment" id="2278797">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2278856">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2278912">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2278969">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2278986">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2279042">//</span><br>
<span class="lineno">25</span><span class="comment" id="2279045">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2279087">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="2279147">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2279161">//</span><br>
<span class="lineno"></span><span class="comment" id="2279164">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="2279182">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2279247">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2279310">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="2279344">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="2279378">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="2279412">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="2279464">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="2279504">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2279559">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="2279614">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="2279671">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2279724">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2279778">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="2279812">//</span><br>
<span class="lineno"></span><span class="comment" id="2279815">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="2279866">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2279913">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2279937">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2279998">//</span><br>
<span class="lineno">50</span><span class="comment" id="2280001">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2280023">//&nbsp;&nbsp;&nbsp;&nbsp;Jn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2280043">//&nbsp;&nbsp;&nbsp;&nbsp;Jn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2280063">func</span>&nbsp;<span class="ident" id="2280068">Jn</span><span class="op" id="2280070">(</span><span class="ident" id="2280071">n</span>&nbsp;<span class="builtintype" id="2280073">int</span><span class="op" id="2280076">,</span>&nbsp;<span class="ident" id="2280078">x</span>&nbsp;<span class="builtintype" id="2280080">float64</span><span class="op" id="2280087">)</span>&nbsp;<span class="builtintype" id="2280089">float64</span>&nbsp;<span class="op" id="2280097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280100">const</span>&nbsp;<span class="op" id="2280106">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2280110">TwoM29</span>&nbsp;<span class="op" id="2280117">=</span>&nbsp;<span class="num" id="2280119">1.0</span>&nbsp;<span class="op" id="2280123">/</span>&nbsp;<span class="op" id="2280125">(</span><span class="num" id="2280126">1</span>&nbsp;<span class="op" id="2280128">&lt;&lt;</span>&nbsp;<span class="num" id="2280131">29</span><span class="op" id="2280133">)</span>&nbsp;<span class="comment" id="2280135">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2280166">Two302</span>&nbsp;<span class="op" id="2280173">=</span>&nbsp;<span class="num" id="2280175">1</span>&nbsp;<span class="op" id="2280177">&lt;&lt;</span>&nbsp;<span class="num" id="2280180">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280191">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2280221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280224">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280242">switch</span>&nbsp;<span class="op" id="2280249">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280252">case</span>&nbsp;<span class="ident" id="2280257"><a href="/gostd/math/bits.go.html#2211423">IsNaN</a></span><span class="op" id="2280262">(</span><span class="ident" id="2280263"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2280264">)</span><span class="op" id="2280265">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280269">return</span>&nbsp;<span class="ident" id="2280276"><a href="/gostd/math/jn.go.html#2280078">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280279">case</span>&nbsp;<span class="ident" id="2280284"><a href="/gostd/math/bits.go.html#2211921">IsInf</a></span><span class="op" id="2280289">(</span><span class="ident" id="2280290"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2280291">,</span>&nbsp;<span class="num" id="2280293">0</span><span class="op" id="2280294">)</span><span class="op" id="2280295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280299">return</span>&nbsp;<span class="num" id="2280306">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2280309">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280312">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280375">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280406">if</span>&nbsp;<span class="ident" id="2280409"><a href="/gostd/math/jn.go.html#2280071">n</a></span>&nbsp;<span class="op" id="2280411">==</span>&nbsp;<span class="num" id="2280414">0</span>&nbsp;<span class="op" id="2280416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280420">return</span>&nbsp;<span class="ident" id="2280427"><a href="/gostd/math/j0.go.html#2253614">J0</a></span><span class="op" id="2280429">(</span><span class="ident" id="2280430"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2280431">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2280434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280437">if</span>&nbsp;<span class="ident" id="2280440"><a href="/gostd/math/jn.go.html#2280078">x</a></span>&nbsp;<span class="op" id="2280442">==</span>&nbsp;<span class="num" id="2280445">0</span>&nbsp;<span class="op" id="2280447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280451">return</span>&nbsp;<span class="num" id="2280458">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2280461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280464">if</span>&nbsp;<span class="ident" id="2280467"><a href="/gostd/math/jn.go.html#2280071">n</a></span>&nbsp;<span class="op" id="2280469">&lt;</span>&nbsp;<span class="num" id="2280471">0</span>&nbsp;<span class="op" id="2280473">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2280477"><a href="/gostd/math/jn.go.html#2280071">n</a></span><span class="op" id="2280478">,</span>&nbsp;<span class="ident" id="2280480"><a href="/gostd/math/jn.go.html#2280078">x</a></span>&nbsp;<span class="op" id="2280482">=</span>&nbsp;<span class="op" id="2280484">-</span><span class="ident" id="2280485"><a href="/gostd/math/jn.go.html#2280071">n</a></span><span class="op" id="2280486">,</span>&nbsp;<span class="op" id="2280488">-</span><span class="ident" id="2280489"><a href="/gostd/math/jn.go.html#2280078">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2280492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280495">if</span>&nbsp;<span class="ident" id="2280498"><a href="/gostd/math/jn.go.html#2280071">n</a></span>&nbsp;<span class="op" id="2280500">==</span>&nbsp;<span class="num" id="2280503">1</span>&nbsp;<span class="op" id="2280505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280509">return</span>&nbsp;<span class="ident" id="2280516"><a href="/gostd/math/j1.go.html#2267587">J1</a></span><span class="op" id="2280518">(</span><span class="ident" id="2280519"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2280520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2280523">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2280526">sign</span>&nbsp;<span class="op" id="2280531">:=</span>&nbsp;<span class="builtintype" id="2280534">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280541">if</span>&nbsp;<span class="ident" id="2280544"><a href="/gostd/math/jn.go.html#2280078">x</a></span>&nbsp;<span class="op" id="2280546">&lt;</span>&nbsp;<span class="num" id="2280548">0</span>&nbsp;<span class="op" id="2280550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2280554"><a href="/gostd/math/jn.go.html#2280078">x</a></span>&nbsp;<span class="op" id="2280556">=</span>&nbsp;<span class="op" id="2280558">-</span><span class="ident" id="2280559"><a href="/gostd/math/jn.go.html#2280078">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280563">if</span>&nbsp;<span class="ident" id="2280566"><a href="/gostd/math/jn.go.html#2280071">n</a></span><span class="op" id="2280567">&amp;</span><span class="num" id="2280568">1</span>&nbsp;<span class="op" id="2280570">==</span>&nbsp;<span class="num" id="2280573">1</span>&nbsp;<span class="op" id="2280575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2280580"><a href="/gostd/math/jn.go.html#2280526">sign</a></span>&nbsp;<span class="op" id="2280585">=</span>&nbsp;<span class="builtintype" id="2280587">true</span>&nbsp;<span class="comment" id="2280592">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2280618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2280621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280624">var</span>&nbsp;<span class="ident" id="2280628">b</span>&nbsp;<span class="builtintype" id="2280630">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280639">if</span>&nbsp;<span class="builtintype" id="2280642">float64</span><span class="op" id="2280649">(</span><span class="ident" id="2280650"><a href="/gostd/math/jn.go.html#2280071">n</a></span><span class="op" id="2280651">)</span>&nbsp;<span class="op" id="2280653">&lt;=</span>&nbsp;<span class="ident" id="2280656"><a href="/gostd/math/jn.go.html#2280078">x</a></span>&nbsp;<span class="op" id="2280658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280662">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2280710">if</span>&nbsp;<span class="ident" id="2280713"><a href="/gostd/math/jn.go.html#2280078">x</a></span>&nbsp;<span class="op" id="2280715">&gt;=</span>&nbsp;<span class="ident" id="2280718"><a href="/gostd/math/jn.go.html#2280166">Two302</a></span>&nbsp;<span class="op" id="2280725">{</span>&nbsp;<span class="comment" id="2280727">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280745">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280763">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280818">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280873">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280912">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280969">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2280975">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281031">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281085">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281133">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281181">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281229">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2281278">var</span>&nbsp;<span class="ident" id="2281282">temp</span>&nbsp;<span class="builtintype" id="2281287">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2281298">switch</span>&nbsp;<span class="ident" id="2281305"><a href="/gostd/math/jn.go.html#2280071">n</a></span>&nbsp;<span class="op" id="2281307">&amp;</span>&nbsp;<span class="num" id="2281309">3</span>&nbsp;<span class="op" id="2281311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2281316">case</span>&nbsp;<span class="num" id="2281321">0</span><span class="op" id="2281322">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281328"><a href="/gostd/math/jn.go.html#2281282">temp</a></span>&nbsp;<span class="op" id="2281333">=</span>&nbsp;<span class="ident" id="2281335"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="2281338">(</span><span class="ident" id="2281339"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281340">)</span>&nbsp;<span class="op" id="2281342">+</span>&nbsp;<span class="ident" id="2281344"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2281347">(</span><span class="ident" id="2281348"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2281354">case</span>&nbsp;<span class="num" id="2281359">1</span><span class="op" id="2281360">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281366"><a href="/gostd/math/jn.go.html#2281282">temp</a></span>&nbsp;<span class="op" id="2281371">=</span>&nbsp;<span class="op" id="2281373">-</span><span class="ident" id="2281374"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="2281377">(</span><span class="ident" id="2281378"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281379">)</span>&nbsp;<span class="op" id="2281381">+</span>&nbsp;<span class="ident" id="2281383"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2281386">(</span><span class="ident" id="2281387"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2281393">case</span>&nbsp;<span class="num" id="2281398">2</span><span class="op" id="2281399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281405"><a href="/gostd/math/jn.go.html#2281282">temp</a></span>&nbsp;<span class="op" id="2281410">=</span>&nbsp;<span class="op" id="2281412">-</span><span class="ident" id="2281413"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="2281416">(</span><span class="ident" id="2281417"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281418">)</span>&nbsp;<span class="op" id="2281420">-</span>&nbsp;<span class="ident" id="2281422"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2281425">(</span><span class="ident" id="2281426"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2281432">case</span>&nbsp;<span class="num" id="2281437">3</span><span class="op" id="2281438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281444"><a href="/gostd/math/jn.go.html#2281282">temp</a></span>&nbsp;<span class="op" id="2281449">=</span>&nbsp;<span class="ident" id="2281451"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="2281454">(</span><span class="ident" id="2281455"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281456">)</span>&nbsp;<span class="op" id="2281458">-</span>&nbsp;<span class="ident" id="2281460"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2281463">(</span><span class="ident" id="2281464"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281465">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2281470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281475"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2281477">=</span>&nbsp;<span class="op" id="2281479">(</span><span class="num" id="2281480">1</span>&nbsp;<span class="op" id="2281482">/</span>&nbsp;<span class="ident" id="2281484"><a href="/gostd/math/const.go.html#2214922">SqrtPi</a></span><span class="op" id="2281490">)</span>&nbsp;<span class="op" id="2281492">*</span>&nbsp;<span class="ident" id="2281494"><a href="/gostd/math/jn.go.html#2281282">temp</a></span>&nbsp;<span class="op" id="2281499">/</span>&nbsp;<span class="ident" id="2281501"><a href="/gostd/math/sqrt.go.html#2332042">Sqrt</a></span><span class="op" id="2281505">(</span><span class="ident" id="2281506"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2281511">}</span>&nbsp;<span class="keyword" id="2281513">else</span>&nbsp;<span class="op" id="2281518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281523"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2281525">=</span>&nbsp;<span class="ident" id="2281527"><a href="/gostd/math/j1.go.html#2267587">J1</a></span><span class="op" id="2281529">(</span><span class="ident" id="2281530"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2281536">for</span>&nbsp;<span class="ident" id="2281540">i</span><span class="op" id="2281541">,</span>&nbsp;<span class="ident" id="2281543">a</span>&nbsp;<span class="op" id="2281545">:=</span>&nbsp;<span class="num" id="2281548">1</span><span class="op" id="2281549">,</span>&nbsp;<span class="ident" id="2281551"><a href="/gostd/math/j0.go.html#2253614">J0</a></span><span class="op" id="2281553">(</span><span class="ident" id="2281554"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281555">)</span><span class="op" id="2281556">;</span>&nbsp;<span class="ident" id="2281558"><a href="/gostd/math/jn.go.html#2281540">i</a></span>&nbsp;<span class="op" id="2281560">&lt;</span>&nbsp;<span class="ident" id="2281562"><a href="/gostd/math/jn.go.html#2280071">n</a></span><span class="op" id="2281563">;</span>&nbsp;<span class="ident" id="2281565"><a href="/gostd/math/jn.go.html#2281540">i</a></span><span class="op" id="2281566">++</span>&nbsp;<span class="op" id="2281569">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281575"><a href="/gostd/math/jn.go.html#2281543">a</a></span><span class="op" id="2281576">,</span>&nbsp;<span class="ident" id="2281578"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2281580">=</span>&nbsp;<span class="ident" id="2281582"><a href="/gostd/math/jn.go.html#2280628">b</a></span><span class="op" id="2281583">,</span>&nbsp;<span class="ident" id="2281585"><a href="/gostd/math/jn.go.html#2280628">b</a></span><span class="op" id="2281586">*</span><span class="op" id="2281587">(</span><span class="builtintype" id="2281588">float64</span><span class="op" id="2281595">(</span><span class="ident" id="2281596"><a href="/gostd/math/jn.go.html#2281540">i</a></span><span class="op" id="2281597">+</span><span class="ident" id="2281598"><a href="/gostd/math/jn.go.html#2281540">i</a></span><span class="op" id="2281599">)</span><span class="op" id="2281600">/</span><span class="ident" id="2281601"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2281602">)</span><span class="op" id="2281603">-</span><span class="ident" id="2281604"><a href="/gostd/math/jn.go.html#2281543">a</a></span>&nbsp;<span class="comment" id="2281606">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2281628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2281632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2281635">}</span>&nbsp;<span class="keyword" id="2281637">else</span>&nbsp;<span class="op" id="2281642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2281646">if</span>&nbsp;<span class="ident" id="2281649"><a href="/gostd/math/jn.go.html#2280078">x</a></span>&nbsp;<span class="op" id="2281651">&lt;</span>&nbsp;<span class="ident" id="2281653"><a href="/gostd/math/jn.go.html#2280110">TwoM29</a></span>&nbsp;<span class="op" id="2281660">{</span>&nbsp;<span class="comment" id="2281662">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281679">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281740">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2281777">if</span>&nbsp;<span class="ident" id="2281780"><a href="/gostd/math/jn.go.html#2280071">n</a></span>&nbsp;<span class="op" id="2281782">&gt;</span>&nbsp;<span class="num" id="2281784">33</span>&nbsp;<span class="op" id="2281787">{</span>&nbsp;<span class="comment" id="2281789">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281806"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2281808">=</span>&nbsp;<span class="num" id="2281810">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2281815">}</span>&nbsp;<span class="keyword" id="2281817">else</span>&nbsp;<span class="op" id="2281822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281828">temp</span>&nbsp;<span class="op" id="2281833">:=</span>&nbsp;<span class="ident" id="2281836"><a href="/gostd/math/jn.go.html#2280078">x</a></span>&nbsp;<span class="op" id="2281838">*</span>&nbsp;<span class="num" id="2281840">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281848"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2281850">=</span>&nbsp;<span class="ident" id="2281852"><a href="/gostd/math/jn.go.html#2281828">temp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281861">a</span>&nbsp;<span class="op" id="2281863">:=</span>&nbsp;<span class="num" id="2281866">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2281874">for</span>&nbsp;<span class="ident" id="2281878">i</span>&nbsp;<span class="op" id="2281880">:=</span>&nbsp;<span class="num" id="2281883">2</span><span class="op" id="2281884">;</span>&nbsp;<span class="ident" id="2281886"><a href="/gostd/math/jn.go.html#2281878">i</a></span>&nbsp;<span class="op" id="2281888">&lt;=</span>&nbsp;<span class="ident" id="2281891"><a href="/gostd/math/jn.go.html#2280071">n</a></span><span class="op" id="2281892">;</span>&nbsp;<span class="ident" id="2281894"><a href="/gostd/math/jn.go.html#2281878">i</a></span><span class="op" id="2281895">++</span>&nbsp;<span class="op" id="2281898">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281905"><a href="/gostd/math/jn.go.html#2281861">a</a></span>&nbsp;<span class="op" id="2281907">*=</span>&nbsp;<span class="builtintype" id="2281910">float64</span><span class="op" id="2281917">(</span><span class="ident" id="2281918"><a href="/gostd/math/jn.go.html#2281878">i</a></span><span class="op" id="2281919">)</span>&nbsp;<span class="comment" id="2281921">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281936"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2281938">*=</span>&nbsp;<span class="ident" id="2281941"><a href="/gostd/math/jn.go.html#2281828">temp</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281952">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2281972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281978"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2281980">/=</span>&nbsp;<span class="ident" id="2281983"><a href="/gostd/math/jn.go.html#2281861">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2281988">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2281992">}</span>&nbsp;<span class="keyword" id="2281994">else</span>&nbsp;<span class="op" id="2281999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282004">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282034">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282083">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282140">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282189">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282195">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282240">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282296">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282344">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282394">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282440">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282446">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282500">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282542">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282567">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282604">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282632">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282668">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282699">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282734">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282771">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282777">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282823">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282858">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282896">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282934">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2282972">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2283015">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283033">w</span>&nbsp;<span class="op" id="2283035">:=</span>&nbsp;<span class="builtintype" id="2283038">float64</span><span class="op" id="2283045">(</span><span class="ident" id="2283046"><a href="/gostd/math/jn.go.html#2280071">n</a></span><span class="op" id="2283047">+</span><span class="ident" id="2283048"><a href="/gostd/math/jn.go.html#2280071">n</a></span><span class="op" id="2283049">)</span>&nbsp;<span class="op" id="2283051">/</span>&nbsp;<span class="ident" id="2283053"><a href="/gostd/math/jn.go.html#2280078">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283058">h</span>&nbsp;<span class="op" id="2283060">:=</span>&nbsp;<span class="num" id="2283063">2</span>&nbsp;<span class="op" id="2283065">/</span>&nbsp;<span class="ident" id="2283067"><a href="/gostd/math/jn.go.html#2280078">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283072">q0</span>&nbsp;<span class="op" id="2283075">:=</span>&nbsp;<span class="ident" id="2283078"><a href="/gostd/math/jn.go.html#2283033">w</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283083">z</span>&nbsp;<span class="op" id="2283085">:=</span>&nbsp;<span class="ident" id="2283088"><a href="/gostd/math/jn.go.html#2283033">w</a></span>&nbsp;<span class="op" id="2283090">+</span>&nbsp;<span class="ident" id="2283092"><a href="/gostd/math/jn.go.html#2283058">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283097">q1</span>&nbsp;<span class="op" id="2283100">:=</span>&nbsp;<span class="ident" id="2283103"><a href="/gostd/math/jn.go.html#2283033">w</a></span><span class="op" id="2283104">*</span><span class="ident" id="2283105"><a href="/gostd/math/jn.go.html#2283083">z</a></span>&nbsp;<span class="op" id="2283107">-</span>&nbsp;<span class="num" id="2283109">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283114">k</span>&nbsp;<span class="op" id="2283116">:=</span>&nbsp;<span class="num" id="2283119">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2283124">for</span>&nbsp;<span class="ident" id="2283128"><a href="/gostd/math/jn.go.html#2283097">q1</a></span>&nbsp;<span class="op" id="2283131">&lt;</span>&nbsp;<span class="num" id="2283133">1e9</span>&nbsp;<span class="op" id="2283137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283143"><a href="/gostd/math/jn.go.html#2283114">k</a></span>&nbsp;<span class="op" id="2283145">+=</span>&nbsp;<span class="num" id="2283148">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283154"><a href="/gostd/math/jn.go.html#2283083">z</a></span>&nbsp;<span class="op" id="2283156">+=</span>&nbsp;<span class="ident" id="2283159"><a href="/gostd/math/jn.go.html#2283058">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283165"><a href="/gostd/math/jn.go.html#2283072">q0</a></span><span class="op" id="2283167">,</span>&nbsp;<span class="ident" id="2283169"><a href="/gostd/math/jn.go.html#2283097">q1</a></span>&nbsp;<span class="op" id="2283172">=</span>&nbsp;<span class="ident" id="2283174"><a href="/gostd/math/jn.go.html#2283097">q1</a></span><span class="op" id="2283176">,</span>&nbsp;<span class="ident" id="2283178"><a href="/gostd/math/jn.go.html#2283083">z</a></span><span class="op" id="2283179">*</span><span class="ident" id="2283180"><a href="/gostd/math/jn.go.html#2283097">q1</a></span><span class="op" id="2283182">-</span><span class="ident" id="2283183"><a href="/gostd/math/jn.go.html#2283072">q0</a></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2283189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283194">m</span>&nbsp;<span class="op" id="2283196">:=</span>&nbsp;<span class="ident" id="2283199"><a href="/gostd/math/jn.go.html#2280071">n</a></span>&nbsp;<span class="op" id="2283201">+</span>&nbsp;<span class="ident" id="2283203"><a href="/gostd/math/jn.go.html#2280071">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283208">t</span>&nbsp;<span class="op" id="2283210">:=</span>&nbsp;<span class="num" id="2283213">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2283220">for</span>&nbsp;<span class="ident" id="2283224">i</span>&nbsp;<span class="op" id="2283226">:=</span>&nbsp;<span class="num" id="2283229">2</span>&nbsp;<span class="op" id="2283231">*</span>&nbsp;<span class="op" id="2283233">(</span><span class="ident" id="2283234"><a href="/gostd/math/jn.go.html#2280071">n</a></span>&nbsp;<span class="op" id="2283236">+</span>&nbsp;<span class="ident" id="2283238"><a href="/gostd/math/jn.go.html#2283114">k</a></span><span class="op" id="2283239">)</span><span class="op" id="2283240">;</span>&nbsp;<span class="ident" id="2283242"><a href="/gostd/math/jn.go.html#2283224">i</a></span>&nbsp;<span class="op" id="2283244">&gt;=</span>&nbsp;<span class="ident" id="2283247"><a href="/gostd/math/jn.go.html#2283194">m</a></span><span class="op" id="2283248">;</span>&nbsp;<span class="ident" id="2283250"><a href="/gostd/math/jn.go.html#2283224">i</a></span>&nbsp;<span class="op" id="2283252">-=</span>&nbsp;<span class="num" id="2283255">2</span>&nbsp;<span class="op" id="2283257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283263"><a href="/gostd/math/jn.go.html#2283208">t</a></span>&nbsp;<span class="op" id="2283265">=</span>&nbsp;<span class="num" id="2283267">1</span>&nbsp;<span class="op" id="2283269">/</span>&nbsp;<span class="op" id="2283271">(</span><span class="builtintype" id="2283272">float64</span><span class="op" id="2283279">(</span><span class="ident" id="2283280"><a href="/gostd/math/jn.go.html#2283224">i</a></span><span class="op" id="2283281">)</span><span class="op" id="2283282">/</span><span class="ident" id="2283283"><a href="/gostd/math/jn.go.html#2280078">x</a></span>&nbsp;<span class="op" id="2283285">-</span>&nbsp;<span class="ident" id="2283287"><a href="/gostd/math/jn.go.html#2283208">t</a></span><span class="op" id="2283288">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2283293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283298">a</span>&nbsp;<span class="op" id="2283300">:=</span>&nbsp;<span class="ident" id="2283303"><a href="/gostd/math/jn.go.html#2283208">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283308"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2283310">=</span>&nbsp;<span class="num" id="2283312">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2283317">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2283371">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2283408">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2283439">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2283480">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2283546">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2283605">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283638">tmp</span>&nbsp;<span class="op" id="2283642">:=</span>&nbsp;<span class="builtintype" id="2283645">float64</span><span class="op" id="2283652">(</span><span class="ident" id="2283653"><a href="/gostd/math/jn.go.html#2280071">n</a></span><span class="op" id="2283654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283659">v</span>&nbsp;<span class="op" id="2283661">:=</span>&nbsp;<span class="num" id="2283664">2</span>&nbsp;<span class="op" id="2283666">/</span>&nbsp;<span class="ident" id="2283668"><a href="/gostd/math/jn.go.html#2280078">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283673"><a href="/gostd/math/jn.go.html#2283638">tmp</a></span>&nbsp;<span class="op" id="2283677">=</span>&nbsp;<span class="ident" id="2283679"><a href="/gostd/math/jn.go.html#2283638">tmp</a></span>&nbsp;<span class="op" id="2283683">*</span>&nbsp;<span class="ident" id="2283685"><a href="/gostd/math/log.go.html#2300722">Log</a></span><span class="op" id="2283688">(</span><span class="ident" id="2283689"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="2283692">(</span><span class="ident" id="2283693"><a href="/gostd/math/jn.go.html#2283659">v</a></span><span class="op" id="2283694">*</span><span class="ident" id="2283695"><a href="/gostd/math/jn.go.html#2283638">tmp</a></span><span class="op" id="2283698">)</span><span class="op" id="2283699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2283704">if</span>&nbsp;<span class="ident" id="2283707"><a href="/gostd/math/jn.go.html#2283638">tmp</a></span>&nbsp;<span class="op" id="2283711">&lt;</span>&nbsp;<span class="num" id="2283713">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="2283740">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2283746">for</span>&nbsp;<span class="ident" id="2283750">i</span>&nbsp;<span class="op" id="2283752">:=</span>&nbsp;<span class="ident" id="2283755"><a href="/gostd/math/jn.go.html#2280071">n</a></span>&nbsp;<span class="op" id="2283757">-</span>&nbsp;<span class="num" id="2283759">1</span><span class="op" id="2283760">;</span>&nbsp;<span class="ident" id="2283762"><a href="/gostd/math/jn.go.html#2283750">i</a></span>&nbsp;<span class="op" id="2283764">&gt;</span>&nbsp;<span class="num" id="2283766">0</span><span class="op" id="2283767">;</span>&nbsp;<span class="ident" id="2283769"><a href="/gostd/math/jn.go.html#2283750">i</a></span><span class="op" id="2283770">--</span>&nbsp;<span class="op" id="2283773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283780">di</span>&nbsp;<span class="op" id="2283783">:=</span>&nbsp;<span class="builtintype" id="2283786">float64</span><span class="op" id="2283793">(</span><span class="ident" id="2283794"><a href="/gostd/math/jn.go.html#2283750">i</a></span>&nbsp;<span class="op" id="2283796">+</span>&nbsp;<span class="ident" id="2283798"><a href="/gostd/math/jn.go.html#2283750">i</a></span><span class="op" id="2283799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283806"><a href="/gostd/math/jn.go.html#2283298">a</a></span><span class="op" id="2283807">,</span>&nbsp;<span class="ident" id="2283809"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2283811">=</span>&nbsp;<span class="ident" id="2283813"><a href="/gostd/math/jn.go.html#2280628">b</a></span><span class="op" id="2283814">,</span>&nbsp;<span class="ident" id="2283816"><a href="/gostd/math/jn.go.html#2280628">b</a></span><span class="op" id="2283817">*</span><span class="ident" id="2283818"><a href="/gostd/math/jn.go.html#2283780">di</a></span><span class="op" id="2283820">/</span><span class="ident" id="2283821"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2283822">-</span><span class="ident" id="2283823"><a href="/gostd/math/jn.go.html#2283298">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283830"><a href="/gostd/math/jn.go.html#2283780">di</a></span>&nbsp;<span class="op" id="2283833">-=</span>&nbsp;<span class="num" id="2283836">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2283842">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2283847">}</span>&nbsp;<span class="keyword" id="2283849">else</span>&nbsp;<span class="op" id="2283854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2283860">for</span>&nbsp;<span class="ident" id="2283864">i</span>&nbsp;<span class="op" id="2283866">:=</span>&nbsp;<span class="ident" id="2283869"><a href="/gostd/math/jn.go.html#2280071">n</a></span>&nbsp;<span class="op" id="2283871">-</span>&nbsp;<span class="num" id="2283873">1</span><span class="op" id="2283874">;</span>&nbsp;<span class="ident" id="2283876"><a href="/gostd/math/jn.go.html#2283864">i</a></span>&nbsp;<span class="op" id="2283878">&gt;</span>&nbsp;<span class="num" id="2283880">0</span><span class="op" id="2283881">;</span>&nbsp;<span class="ident" id="2283883"><a href="/gostd/math/jn.go.html#2283864">i</a></span><span class="op" id="2283884">--</span>&nbsp;<span class="op" id="2283887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283894">di</span>&nbsp;<span class="op" id="2283897">:=</span>&nbsp;<span class="builtintype" id="2283900">float64</span><span class="op" id="2283907">(</span><span class="ident" id="2283908"><a href="/gostd/math/jn.go.html#2283864">i</a></span>&nbsp;<span class="op" id="2283910">+</span>&nbsp;<span class="ident" id="2283912"><a href="/gostd/math/jn.go.html#2283864">i</a></span><span class="op" id="2283913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283920"><a href="/gostd/math/jn.go.html#2283298">a</a></span><span class="op" id="2283921">,</span>&nbsp;<span class="ident" id="2283923"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2283925">=</span>&nbsp;<span class="ident" id="2283927"><a href="/gostd/math/jn.go.html#2280628">b</a></span><span class="op" id="2283928">,</span>&nbsp;<span class="ident" id="2283930"><a href="/gostd/math/jn.go.html#2280628">b</a></span><span class="op" id="2283931">*</span><span class="ident" id="2283932"><a href="/gostd/math/jn.go.html#2283894">di</a></span><span class="op" id="2283934">/</span><span class="ident" id="2283935"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2283936">-</span><span class="ident" id="2283937"><a href="/gostd/math/jn.go.html#2283298">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2283944"><a href="/gostd/math/jn.go.html#2283894">di</a></span>&nbsp;<span class="op" id="2283947">-=</span>&nbsp;<span class="num" id="2283950">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2283957">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284000">if</span>&nbsp;<span class="ident" id="2284003"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2284005">&gt;</span>&nbsp;<span class="num" id="2284007">1e100</span>&nbsp;<span class="op" id="2284013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2284021"><a href="/gostd/math/jn.go.html#2283298">a</a></span>&nbsp;<span class="op" id="2284023">/=</span>&nbsp;<span class="ident" id="2284026"><a href="/gostd/math/jn.go.html#2280628">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2284034"><a href="/gostd/math/jn.go.html#2283208">t</a></span>&nbsp;<span class="op" id="2284036">/=</span>&nbsp;<span class="ident" id="2284039"><a href="/gostd/math/jn.go.html#2280628">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2284047"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2284049">=</span>&nbsp;<span class="num" id="2284051">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2284074"><a href="/gostd/math/jn.go.html#2280628">b</a></span>&nbsp;<span class="op" id="2284076">=</span>&nbsp;<span class="ident" id="2284078"><a href="/gostd/math/jn.go.html#2283208">t</a></span>&nbsp;<span class="op" id="2284080">*</span>&nbsp;<span class="ident" id="2284082"><a href="/gostd/math/j0.go.html#2253614">J0</a></span><span class="op" id="2284084">(</span><span class="ident" id="2284085"><a href="/gostd/math/jn.go.html#2280078">x</a></span><span class="op" id="2284086">)</span>&nbsp;<span class="op" id="2284088">/</span>&nbsp;<span class="ident" id="2284090"><a href="/gostd/math/jn.go.html#2280628">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284094">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284100">if</span>&nbsp;<span class="ident" id="2284103"><a href="/gostd/math/jn.go.html#2280526">sign</a></span>&nbsp;<span class="op" id="2284108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284112">return</span>&nbsp;<span class="op" id="2284119">-</span><span class="ident" id="2284120"><a href="/gostd/math/jn.go.html#2280628">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284126">return</span>&nbsp;<span class="ident" id="2284133"><a href="/gostd/math/jn.go.html#2280628">b</a></span><br>
<span class="lineno">225</span><span class="op" id="2284135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2284138">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2284200">//</span><br>
<span class="lineno"></span><span class="comment" id="2284203">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="2284225">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2284244">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2284267">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="2284321">//&nbsp;&nbsp;&nbsp;&nbsp;Y1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2284343">//&nbsp;&nbsp;&nbsp;&nbsp;Y1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="2284363">func</span>&nbsp;<span class="ident" id="2284368">Yn</span><span class="op" id="2284370">(</span><span class="ident" id="2284371">n</span>&nbsp;<span class="builtintype" id="2284373">int</span><span class="op" id="2284376">,</span>&nbsp;<span class="ident" id="2284378">x</span>&nbsp;<span class="builtintype" id="2284380">float64</span><span class="op" id="2284387">)</span>&nbsp;<span class="builtintype" id="2284389">float64</span>&nbsp;<span class="op" id="2284397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284400">const</span>&nbsp;<span class="ident" id="2284406">Two302</span>&nbsp;<span class="op" id="2284413">=</span>&nbsp;<span class="num" id="2284415">1</span>&nbsp;<span class="op" id="2284417">&lt;&lt;</span>&nbsp;<span class="num" id="2284420">302</span>&nbsp;<span class="comment" id="2284424">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2284454">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284472">switch</span>&nbsp;<span class="op" id="2284479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284482">case</span>&nbsp;<span class="ident" id="2284487"><a href="/gostd/math/jn.go.html#2284378">x</a></span>&nbsp;<span class="op" id="2284489">&lt;</span>&nbsp;<span class="num" id="2284491">0</span>&nbsp;<span class="op" id="2284493">||</span>&nbsp;<span class="ident" id="2284496"><a href="/gostd/math/bits.go.html#2211423">IsNaN</a></span><span class="op" id="2284501">(</span><span class="ident" id="2284502"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2284503">)</span><span class="op" id="2284504">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284508">return</span>&nbsp;<span class="ident" id="2284515"><a href="/gostd/math/bits.go.html#2211303">NaN</a></span><span class="op" id="2284518">(</span><span class="op" id="2284519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284522">case</span>&nbsp;<span class="ident" id="2284527"><a href="/gostd/math/bits.go.html#2211921">IsInf</a></span><span class="op" id="2284532">(</span><span class="ident" id="2284533"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2284534">,</span>&nbsp;<span class="num" id="2284536">1</span><span class="op" id="2284537">)</span><span class="op" id="2284538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284542">return</span>&nbsp;<span class="num" id="2284549">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284556">if</span>&nbsp;<span class="ident" id="2284559"><a href="/gostd/math/jn.go.html#2284371">n</a></span>&nbsp;<span class="op" id="2284561">==</span>&nbsp;<span class="num" id="2284564">0</span>&nbsp;<span class="op" id="2284566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284570">return</span>&nbsp;<span class="ident" id="2284577"><a href="/gostd/math/j0.go.html#2255533">Y0</a></span><span class="op" id="2284579">(</span><span class="ident" id="2284580"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2284581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284587">if</span>&nbsp;<span class="ident" id="2284590"><a href="/gostd/math/jn.go.html#2284378">x</a></span>&nbsp;<span class="op" id="2284592">==</span>&nbsp;<span class="num" id="2284595">0</span>&nbsp;<span class="op" id="2284597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284601">if</span>&nbsp;<span class="ident" id="2284604"><a href="/gostd/math/jn.go.html#2284371">n</a></span>&nbsp;<span class="op" id="2284606">&lt;</span>&nbsp;<span class="num" id="2284608">0</span>&nbsp;<span class="op" id="2284610">&amp;&amp;</span>&nbsp;<span class="ident" id="2284613"><a href="/gostd/math/jn.go.html#2284371">n</a></span><span class="op" id="2284614">&amp;</span><span class="num" id="2284615">1</span>&nbsp;<span class="op" id="2284617">==</span>&nbsp;<span class="num" id="2284620">1</span>&nbsp;<span class="op" id="2284622">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284627">return</span>&nbsp;<span class="ident" id="2284634"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2284637">(</span><span class="num" id="2284638">1</span><span class="op" id="2284639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284647">return</span>&nbsp;<span class="ident" id="2284654"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2284657">(</span><span class="op" id="2284658">-</span><span class="num" id="2284659">1</span><span class="op" id="2284660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2284666">sign</span>&nbsp;<span class="op" id="2284671">:=</span>&nbsp;<span class="builtintype" id="2284674">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284681">if</span>&nbsp;<span class="ident" id="2284684"><a href="/gostd/math/jn.go.html#2284371">n</a></span>&nbsp;<span class="op" id="2284686">&lt;</span>&nbsp;<span class="num" id="2284688">0</span>&nbsp;<span class="op" id="2284690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2284694"><a href="/gostd/math/jn.go.html#2284371">n</a></span>&nbsp;<span class="op" id="2284696">=</span>&nbsp;<span class="op" id="2284698">-</span><span class="ident" id="2284699"><a href="/gostd/math/jn.go.html#2284371">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284703">if</span>&nbsp;<span class="ident" id="2284706"><a href="/gostd/math/jn.go.html#2284371">n</a></span><span class="op" id="2284707">&amp;</span><span class="num" id="2284708">1</span>&nbsp;<span class="op" id="2284710">==</span>&nbsp;<span class="num" id="2284713">1</span>&nbsp;<span class="op" id="2284715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2284720"><a href="/gostd/math/jn.go.html#2284666">sign</a></span>&nbsp;<span class="op" id="2284725">=</span>&nbsp;<span class="builtintype" id="2284727">true</span>&nbsp;<span class="comment" id="2284732">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284767">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284773">if</span>&nbsp;<span class="ident" id="2284776"><a href="/gostd/math/jn.go.html#2284371">n</a></span>&nbsp;<span class="op" id="2284778">==</span>&nbsp;<span class="num" id="2284781">1</span>&nbsp;<span class="op" id="2284783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284787">if</span>&nbsp;<span class="ident" id="2284790"><a href="/gostd/math/jn.go.html#2284666">sign</a></span>&nbsp;<span class="op" id="2284795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284800">return</span>&nbsp;<span class="op" id="2284807">-</span><span class="ident" id="2284808"><a href="/gostd/math/j1.go.html#2269377">Y1</a></span><span class="op" id="2284810">(</span><span class="ident" id="2284811"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2284812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284816">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284820">return</span>&nbsp;<span class="ident" id="2284827"><a href="/gostd/math/j1.go.html#2269377">Y1</a></span><span class="op" id="2284829">(</span><span class="ident" id="2284830"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2284831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284837">var</span>&nbsp;<span class="ident" id="2284841">b</span>&nbsp;<span class="builtintype" id="2284843">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2284852">if</span>&nbsp;<span class="ident" id="2284855"><a href="/gostd/math/jn.go.html#2284378">x</a></span>&nbsp;<span class="op" id="2284857">&gt;=</span>&nbsp;<span class="ident" id="2284860"><a href="/gostd/math/jn.go.html#2284406">Two302</a></span>&nbsp;<span class="op" id="2284867">{</span>&nbsp;<span class="comment" id="2284869">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2284885">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2284902">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2284951">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285000">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285033">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285077">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285082">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285119">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285160">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285182">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285205">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285227">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2285250">var</span>&nbsp;<span class="ident" id="2285254">temp</span>&nbsp;<span class="builtintype" id="2285259">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2285269">switch</span>&nbsp;<span class="ident" id="2285276"><a href="/gostd/math/jn.go.html#2284371">n</a></span>&nbsp;<span class="op" id="2285278">&amp;</span>&nbsp;<span class="num" id="2285280">3</span>&nbsp;<span class="op" id="2285282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2285286">case</span>&nbsp;<span class="num" id="2285291">0</span><span class="op" id="2285292">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2285297"><a href="/gostd/math/jn.go.html#2285254">temp</a></span>&nbsp;<span class="op" id="2285302">=</span>&nbsp;<span class="ident" id="2285304"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2285307">(</span><span class="ident" id="2285308"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285309">)</span>&nbsp;<span class="op" id="2285311">-</span>&nbsp;<span class="ident" id="2285313"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="2285316">(</span><span class="ident" id="2285317"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2285322">case</span>&nbsp;<span class="num" id="2285327">1</span><span class="op" id="2285328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2285333"><a href="/gostd/math/jn.go.html#2285254">temp</a></span>&nbsp;<span class="op" id="2285338">=</span>&nbsp;<span class="op" id="2285340">-</span><span class="ident" id="2285341"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2285344">(</span><span class="ident" id="2285345"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285346">)</span>&nbsp;<span class="op" id="2285348">-</span>&nbsp;<span class="ident" id="2285350"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="2285353">(</span><span class="ident" id="2285354"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2285359">case</span>&nbsp;<span class="num" id="2285364">2</span><span class="op" id="2285365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2285370"><a href="/gostd/math/jn.go.html#2285254">temp</a></span>&nbsp;<span class="op" id="2285375">=</span>&nbsp;<span class="op" id="2285377">-</span><span class="ident" id="2285378"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2285381">(</span><span class="ident" id="2285382"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285383">)</span>&nbsp;<span class="op" id="2285385">+</span>&nbsp;<span class="ident" id="2285387"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="2285390">(</span><span class="ident" id="2285391"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285392">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2285396">case</span>&nbsp;<span class="num" id="2285401">3</span><span class="op" id="2285402">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2285407"><a href="/gostd/math/jn.go.html#2285254">temp</a></span>&nbsp;<span class="op" id="2285412">=</span>&nbsp;<span class="ident" id="2285414"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2285417">(</span><span class="ident" id="2285418"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285419">)</span>&nbsp;<span class="op" id="2285421">+</span>&nbsp;<span class="ident" id="2285423"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="2285426">(</span><span class="ident" id="2285427"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2285432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2285436"><a href="/gostd/math/jn.go.html#2284841">b</a></span>&nbsp;<span class="op" id="2285438">=</span>&nbsp;<span class="op" id="2285440">(</span><span class="num" id="2285441">1</span>&nbsp;<span class="op" id="2285443">/</span>&nbsp;<span class="ident" id="2285445"><a href="/gostd/math/const.go.html#2214922">SqrtPi</a></span><span class="op" id="2285451">)</span>&nbsp;<span class="op" id="2285453">*</span>&nbsp;<span class="ident" id="2285455"><a href="/gostd/math/jn.go.html#2285254">temp</a></span>&nbsp;<span class="op" id="2285460">/</span>&nbsp;<span class="ident" id="2285462"><a href="/gostd/math/sqrt.go.html#2332042">Sqrt</a></span><span class="op" id="2285466">(</span><span class="ident" id="2285467"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2285471">}</span>&nbsp;<span class="keyword" id="2285473">else</span>&nbsp;<span class="op" id="2285478">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2285482">a</span>&nbsp;<span class="op" id="2285484">:=</span>&nbsp;<span class="ident" id="2285487"><a href="/gostd/math/j0.go.html#2255533">Y0</a></span><span class="op" id="2285489">(</span><span class="ident" id="2285490"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2285495"><a href="/gostd/math/jn.go.html#2284841">b</a></span>&nbsp;<span class="op" id="2285497">=</span>&nbsp;<span class="ident" id="2285499"><a href="/gostd/math/j1.go.html#2269377">Y1</a></span><span class="op" id="2285501">(</span><span class="ident" id="2285502"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285507">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2285530">for</span>&nbsp;<span class="ident" id="2285534">i</span>&nbsp;<span class="op" id="2285536">:=</span>&nbsp;<span class="num" id="2285539">1</span><span class="op" id="2285540">;</span>&nbsp;<span class="ident" id="2285542"><a href="/gostd/math/jn.go.html#2285534">i</a></span>&nbsp;<span class="op" id="2285544">&lt;</span>&nbsp;<span class="ident" id="2285546"><a href="/gostd/math/jn.go.html#2284371">n</a></span>&nbsp;<span class="op" id="2285548">&amp;&amp;</span>&nbsp;<span class="op" id="2285551">!</span><span class="ident" id="2285552"><a href="/gostd/math/bits.go.html#2211921">IsInf</a></span><span class="op" id="2285557">(</span><span class="ident" id="2285558"><a href="/gostd/math/jn.go.html#2284841">b</a></span><span class="op" id="2285559">,</span>&nbsp;<span class="op" id="2285561">-</span><span class="num" id="2285562">1</span><span class="op" id="2285563">)</span><span class="op" id="2285564">;</span>&nbsp;<span class="ident" id="2285566"><a href="/gostd/math/jn.go.html#2285534">i</a></span><span class="op" id="2285567">++</span>&nbsp;<span class="op" id="2285570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2285575"><a href="/gostd/math/jn.go.html#2285482">a</a></span><span class="op" id="2285576">,</span>&nbsp;<span class="ident" id="2285578"><a href="/gostd/math/jn.go.html#2284841">b</a></span>&nbsp;<span class="op" id="2285580">=</span>&nbsp;<span class="ident" id="2285582"><a href="/gostd/math/jn.go.html#2284841">b</a></span><span class="op" id="2285583">,</span>&nbsp;<span class="op" id="2285585">(</span><span class="builtintype" id="2285586">float64</span><span class="op" id="2285593">(</span><span class="ident" id="2285594"><a href="/gostd/math/jn.go.html#2285534">i</a></span><span class="op" id="2285595">+</span><span class="ident" id="2285596"><a href="/gostd/math/jn.go.html#2285534">i</a></span><span class="op" id="2285597">)</span><span class="op" id="2285598">/</span><span class="ident" id="2285599"><a href="/gostd/math/jn.go.html#2284378">x</a></span><span class="op" id="2285600">)</span><span class="op" id="2285601">*</span><span class="ident" id="2285602"><a href="/gostd/math/jn.go.html#2284841">b</a></span><span class="op" id="2285603">-</span><span class="ident" id="2285604"><a href="/gostd/math/jn.go.html#2285482">a</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2285608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2285611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2285614">if</span>&nbsp;<span class="ident" id="2285617"><a href="/gostd/math/jn.go.html#2284666">sign</a></span>&nbsp;<span class="op" id="2285622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2285626">return</span>&nbsp;<span class="op" id="2285633">-</span><span class="ident" id="2285634"><a href="/gostd/math/jn.go.html#2284841">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2285637">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2285640">return</span>&nbsp;<span class="ident" id="2285647"><a href="/gostd/math/jn.go.html#2284841">b</a></span><br>
<span class="lineno"></span><span class="op" id="2285649">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
