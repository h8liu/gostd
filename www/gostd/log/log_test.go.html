<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>log</h2>
<ul>
<li><a href="/gostd/log/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/log/log.go.html">log.go</a></li>
<li><a href="/gostd/log/log_test.go.html" class="current">log_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7182834">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7182889">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7182943">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7182994">package</span>&nbsp;<span class="ident" id="7183002">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7183007">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7183039">import</span>&nbsp;<span class="op" id="7183046">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7183049">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7183058">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7183064">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7183074">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7183084">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7183087">const</span>&nbsp;<span class="op" id="7183093">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7183096">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183110">=</span>&nbsp;<span class="string" id="7183112">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7183158">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183172">=</span>&nbsp;<span class="string" id="7183174">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7183210">Rmicroseconds</span>&nbsp;<span class="op" id="7183224">=</span>&nbsp;<span class="string" id="7183226">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7183262">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183276">=</span>&nbsp;<span class="string" id="7183278">`(54|56):`</span>&nbsp;<span class="comment" id="7183289">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7183351">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183365">=</span>&nbsp;<span class="string" id="7183367">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7183393">+</span>&nbsp;<span class="ident" id="7183395">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7183402">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183416">=</span>&nbsp;<span class="string" id="7183418">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7183441">+</span>&nbsp;<span class="ident" id="7183443">Rline</span><br>
<span class="lineno"></span><span class="op" id="7183449">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7183452">type</span>&nbsp;<span class="ident" id="7183457">tester</span>&nbsp;<span class="keyword" id="7183464">struct</span>&nbsp;<span class="op" id="7183471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7183474">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7183482">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7183487">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="7183495">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7183503">pattern</span>&nbsp;<span class="builtintype" id="7183511">string</span>&nbsp;<span class="comment" id="7183518">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="7183591">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="7183594">var</span>&nbsp;<span class="ident" id="7183598">tests</span>&nbsp;<span class="op" id="7183604">=</span>&nbsp;<span class="op" id="7183606">[</span><span class="op" id="7183607">]</span><span class="ident" id="7183608">tester</span><span class="op" id="7183614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7183617">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183640">{</span><span class="num" id="7183641">0</span><span class="op" id="7183642">,</span>&nbsp;<span class="string" id="7183644">&#34;&#34;</span><span class="op" id="7183646">,</span>&nbsp;<span class="string" id="7183648">&#34;&#34;</span><span class="op" id="7183650">}</span><span class="op" id="7183651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183654">{</span><span class="num" id="7183655">0</span><span class="op" id="7183656">,</span>&nbsp;<span class="string" id="7183658">&#34;XXX&#34;</span><span class="op" id="7183663">,</span>&nbsp;<span class="string" id="7183665">&#34;XXX&#34;</span><span class="op" id="7183670">}</span><span class="op" id="7183671">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183674">{</span><span class="ident" id="7183675">Ldate</span><span class="op" id="7183680">,</span>&nbsp;<span class="string" id="7183682">&#34;&#34;</span><span class="op" id="7183684">,</span>&nbsp;<span class="ident" id="7183686">Rdate</span>&nbsp;<span class="op" id="7183692">+</span>&nbsp;<span class="string" id="7183694">&#34;&nbsp;&#34;</span><span class="op" id="7183697">}</span><span class="op" id="7183698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183701">{</span><span class="ident" id="7183702">Ltime</span><span class="op" id="7183707">,</span>&nbsp;<span class="string" id="7183709">&#34;&#34;</span><span class="op" id="7183711">,</span>&nbsp;<span class="ident" id="7183713">Rtime</span>&nbsp;<span class="op" id="7183719">+</span>&nbsp;<span class="string" id="7183721">&#34;&nbsp;&#34;</span><span class="op" id="7183724">}</span><span class="op" id="7183725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183728">{</span><span class="ident" id="7183729">Ltime</span>&nbsp;<span class="op" id="7183735">|</span>&nbsp;<span class="ident" id="7183737">Lmicroseconds</span><span class="op" id="7183750">,</span>&nbsp;<span class="string" id="7183752">&#34;&#34;</span><span class="op" id="7183754">,</span>&nbsp;<span class="ident" id="7183756">Rtime</span>&nbsp;<span class="op" id="7183762">+</span>&nbsp;<span class="ident" id="7183764">Rmicroseconds</span>&nbsp;<span class="op" id="7183778">+</span>&nbsp;<span class="string" id="7183780">&#34;&nbsp;&#34;</span><span class="op" id="7183783">}</span><span class="op" id="7183784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183787">{</span><span class="ident" id="7183788">Lmicroseconds</span><span class="op" id="7183801">,</span>&nbsp;<span class="string" id="7183803">&#34;&#34;</span><span class="op" id="7183805">,</span>&nbsp;<span class="ident" id="7183807">Rtime</span>&nbsp;<span class="op" id="7183813">+</span>&nbsp;<span class="ident" id="7183815">Rmicroseconds</span>&nbsp;<span class="op" id="7183829">+</span>&nbsp;<span class="string" id="7183831">&#34;&nbsp;&#34;</span><span class="op" id="7183834">}</span><span class="op" id="7183835">,</span>&nbsp;<span class="comment" id="7183837">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183863">{</span><span class="ident" id="7183864">Llongfile</span><span class="op" id="7183873">,</span>&nbsp;<span class="string" id="7183875">&#34;&#34;</span><span class="op" id="7183877">,</span>&nbsp;<span class="ident" id="7183879">Rlongfile</span>&nbsp;<span class="op" id="7183889">+</span>&nbsp;<span class="string" id="7183891">&#34;&nbsp;&#34;</span><span class="op" id="7183894">}</span><span class="op" id="7183895">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183898">{</span><span class="ident" id="7183899">Lshortfile</span><span class="op" id="7183909">,</span>&nbsp;<span class="string" id="7183911">&#34;&#34;</span><span class="op" id="7183913">,</span>&nbsp;<span class="ident" id="7183915">Rshortfile</span>&nbsp;<span class="op" id="7183926">+</span>&nbsp;<span class="string" id="7183928">&#34;&nbsp;&#34;</span><span class="op" id="7183931">}</span><span class="op" id="7183932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7183935">{</span><span class="ident" id="7183936">Llongfile</span>&nbsp;<span class="op" id="7183946">|</span>&nbsp;<span class="ident" id="7183948">Lshortfile</span><span class="op" id="7183958">,</span>&nbsp;<span class="string" id="7183960">&#34;&#34;</span><span class="op" id="7183962">,</span>&nbsp;<span class="ident" id="7183964">Rshortfile</span>&nbsp;<span class="op" id="7183975">+</span>&nbsp;<span class="string" id="7183977">&#34;&nbsp;&#34;</span><span class="op" id="7183980">}</span><span class="op" id="7183981">,</span>&nbsp;<span class="comment" id="7183983">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7184016">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184040">{</span><span class="ident" id="7184041">Ldate</span>&nbsp;<span class="op" id="7184047">|</span>&nbsp;<span class="ident" id="7184049">Ltime</span>&nbsp;<span class="op" id="7184055">|</span>&nbsp;<span class="ident" id="7184057">Lmicroseconds</span>&nbsp;<span class="op" id="7184071">|</span>&nbsp;<span class="ident" id="7184073">Llongfile</span><span class="op" id="7184082">,</span>&nbsp;<span class="string" id="7184084">&#34;XXX&#34;</span><span class="op" id="7184089">,</span>&nbsp;<span class="string" id="7184091">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7184097">+</span>&nbsp;<span class="ident" id="7184099">Rdate</span>&nbsp;<span class="op" id="7184105">+</span>&nbsp;<span class="string" id="7184107">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7184111">+</span>&nbsp;<span class="ident" id="7184113">Rtime</span>&nbsp;<span class="op" id="7184119">+</span>&nbsp;<span class="ident" id="7184121">Rmicroseconds</span>&nbsp;<span class="op" id="7184135">+</span>&nbsp;<span class="string" id="7184137">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7184141">+</span>&nbsp;<span class="ident" id="7184143">Rlongfile</span>&nbsp;<span class="op" id="7184153">+</span>&nbsp;<span class="string" id="7184155">&#34;&nbsp;&#34;</span><span class="op" id="7184158">}</span><span class="op" id="7184159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184162">{</span><span class="ident" id="7184163">Ldate</span>&nbsp;<span class="op" id="7184169">|</span>&nbsp;<span class="ident" id="7184171">Ltime</span>&nbsp;<span class="op" id="7184177">|</span>&nbsp;<span class="ident" id="7184179">Lmicroseconds</span>&nbsp;<span class="op" id="7184193">|</span>&nbsp;<span class="ident" id="7184195">Lshortfile</span><span class="op" id="7184205">,</span>&nbsp;<span class="string" id="7184207">&#34;XXX&#34;</span><span class="op" id="7184212">,</span>&nbsp;<span class="string" id="7184214">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7184220">+</span>&nbsp;<span class="ident" id="7184222">Rdate</span>&nbsp;<span class="op" id="7184228">+</span>&nbsp;<span class="string" id="7184230">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7184234">+</span>&nbsp;<span class="ident" id="7184236">Rtime</span>&nbsp;<span class="op" id="7184242">+</span>&nbsp;<span class="ident" id="7184244">Rmicroseconds</span>&nbsp;<span class="op" id="7184258">+</span>&nbsp;<span class="string" id="7184260">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7184264">+</span>&nbsp;<span class="ident" id="7184266">Rshortfile</span>&nbsp;<span class="op" id="7184277">+</span>&nbsp;<span class="string" id="7184279">&#34;&nbsp;&#34;</span><span class="op" id="7184282">}</span><span class="op" id="7184283">,</span><br>
<span class="lineno">45</span><span class="op" id="7184285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7184288">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="7184370">func</span>&nbsp;<span class="ident" id="7184375">testPrint</span><span class="op" id="7184384">(</span><span class="ident" id="7184385">t</span>&nbsp;<span class="op" id="7184387">*</span><span class="ident" id="7184388">testing</span><span class="op" id="7184395">.</span><span class="ident" id="7184396">T</span><span class="op" id="7184397">,</span>&nbsp;<span class="ident" id="7184399">flag</span>&nbsp;<span class="builtintype" id="7184404">int</span><span class="op" id="7184407">,</span>&nbsp;<span class="ident" id="7184409">prefix</span>&nbsp;<span class="builtintype" id="7184416">string</span><span class="op" id="7184422">,</span>&nbsp;<span class="ident" id="7184424">pattern</span>&nbsp;<span class="builtintype" id="7184432">string</span><span class="op" id="7184438">,</span>&nbsp;<span class="ident" id="7184440">useFormat</span>&nbsp;<span class="builtintype" id="7184450">bool</span><span class="op" id="7184454">)</span>&nbsp;<span class="op" id="7184456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184459">buf</span>&nbsp;<span class="op" id="7184463">:=</span>&nbsp;<span class="builtinfunc" id="7184466">new</span><span class="op" id="7184469">(</span><span class="ident" id="7184470">bytes</span><span class="op" id="7184475">.</span><span class="ident" id="7184476">Buffer</span><span class="op" id="7184482">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184485">SetOutput</span><span class="op" id="7184494">(</span><span class="ident" id="7184495">buf</span><span class="op" id="7184498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184501">SetFlags</span><span class="op" id="7184509">(</span><span class="ident" id="7184510">flag</span><span class="op" id="7184514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184517">SetPrefix</span><span class="op" id="7184526">(</span><span class="ident" id="7184527">prefix</span><span class="op" id="7184533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7184536">if</span>&nbsp;<span class="ident" id="7184539">useFormat</span>&nbsp;<span class="op" id="7184549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184553">Printf</span><span class="op" id="7184559">(</span><span class="string" id="7184560">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="7184576">,</span>&nbsp;<span class="num" id="7184578">23</span><span class="op" id="7184580">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184583">}</span>&nbsp;<span class="keyword" id="7184585">else</span>&nbsp;<span class="op" id="7184590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184594">Println</span><span class="op" id="7184601">(</span><span class="string" id="7184602">&#34;hello&#34;</span><span class="op" id="7184609">,</span>&nbsp;<span class="num" id="7184611">23</span><span class="op" id="7184613">,</span>&nbsp;<span class="string" id="7184615">&#34;world&#34;</span><span class="op" id="7184622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184628">line</span>&nbsp;<span class="op" id="7184633">:=</span>&nbsp;<span class="ident" id="7184636">buf</span><span class="op" id="7184639">.</span><span class="ident" id="7184640">String</span><span class="op" id="7184646">(</span><span class="op" id="7184647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184650">line</span>&nbsp;<span class="op" id="7184655">=</span>&nbsp;<span class="ident" id="7184657">line</span><span class="op" id="7184661">[</span><span class="num" id="7184662">0</span>&nbsp;<span class="op" id="7184664">:</span>&nbsp;<span class="builtinfunc" id="7184666">len</span><span class="op" id="7184669">(</span><span class="ident" id="7184670">line</span><span class="op" id="7184674">)</span><span class="op" id="7184675">-</span><span class="num" id="7184676">1</span><span class="op" id="7184677">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184680">pattern</span>&nbsp;<span class="op" id="7184688">=</span>&nbsp;<span class="string" id="7184690">&#34;^&#34;</span>&nbsp;<span class="op" id="7184694">+</span>&nbsp;<span class="ident" id="7184696">pattern</span>&nbsp;<span class="op" id="7184704">+</span>&nbsp;<span class="string" id="7184706">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184725">matched</span><span class="op" id="7184732">,</span>&nbsp;<span class="ident" id="7184734">err4</span>&nbsp;<span class="op" id="7184739">:=</span>&nbsp;<span class="ident" id="7184742">regexp</span><span class="op" id="7184748">.</span><span class="ident" id="7184749">MatchString</span><span class="op" id="7184760">(</span><span class="ident" id="7184761">pattern</span><span class="op" id="7184768">,</span>&nbsp;<span class="ident" id="7184770">line</span><span class="op" id="7184774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7184777">if</span>&nbsp;<span class="ident" id="7184780">err4</span>&nbsp;<span class="op" id="7184785">!=</span>&nbsp;<span class="builtintype" id="7184788">nil</span>&nbsp;<span class="op" id="7184792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184796">t</span><span class="op" id="7184797">.</span><span class="ident" id="7184798">Fatal</span><span class="op" id="7184803">(</span><span class="string" id="7184804">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="7184830">,</span>&nbsp;<span class="ident" id="7184832">err4</span><span class="op" id="7184836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184839">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7184842">if</span>&nbsp;<span class="op" id="7184845">!</span><span class="ident" id="7184846">matched</span>&nbsp;<span class="op" id="7184854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184858">t</span><span class="op" id="7184859">.</span><span class="ident" id="7184860">Errorf</span><span class="op" id="7184866">(</span><span class="string" id="7184867">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7184901">,</span>&nbsp;<span class="ident" id="7184903">pattern</span><span class="op" id="7184910">,</span>&nbsp;<span class="ident" id="7184912">line</span><span class="op" id="7184916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7184919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7184922">SetOutput</span><span class="op" id="7184931">(</span><span class="ident" id="7184932">os</span><span class="op" id="7184934">.</span><span class="ident" id="7184935">Stderr</span><span class="op" id="7184941">)</span><br>
<span class="lineno"></span><span class="op" id="7184943">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7184946">func</span>&nbsp;<span class="ident" id="7184951">TestAll</span><span class="op" id="7184958">(</span><span class="ident" id="7184959">t</span>&nbsp;<span class="op" id="7184961">*</span><span class="ident" id="7184962">testing</span><span class="op" id="7184969">.</span><span class="ident" id="7184970">T</span><span class="op" id="7184971">)</span>&nbsp;<span class="op" id="7184973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7184976">for</span>&nbsp;<span class="ident" id="7184980">_</span><span class="op" id="7184981">,</span>&nbsp;<span class="ident" id="7184983">testcase</span>&nbsp;<span class="op" id="7184992">:=</span>&nbsp;<span class="keyword" id="7184995">range</span>&nbsp;<span class="ident" id="7185001">tests</span>&nbsp;<span class="op" id="7185007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185011">testPrint</span><span class="op" id="7185020">(</span><span class="ident" id="7185021">t</span><span class="op" id="7185022">,</span>&nbsp;<span class="ident" id="7185024">testcase</span><span class="op" id="7185032">.</span><span class="ident" id="7185033">flag</span><span class="op" id="7185037">,</span>&nbsp;<span class="ident" id="7185039">testcase</span><span class="op" id="7185047">.</span><span class="ident" id="7185048">prefix</span><span class="op" id="7185054">,</span>&nbsp;<span class="ident" id="7185056">testcase</span><span class="op" id="7185064">.</span><span class="ident" id="7185065">pattern</span><span class="op" id="7185072">,</span>&nbsp;<span class="builtintype" id="7185074">false</span><span class="op" id="7185079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185083">testPrint</span><span class="op" id="7185092">(</span><span class="ident" id="7185093">t</span><span class="op" id="7185094">,</span>&nbsp;<span class="ident" id="7185096">testcase</span><span class="op" id="7185104">.</span><span class="ident" id="7185105">flag</span><span class="op" id="7185109">,</span>&nbsp;<span class="ident" id="7185111">testcase</span><span class="op" id="7185119">.</span><span class="ident" id="7185120">prefix</span><span class="op" id="7185126">,</span>&nbsp;<span class="ident" id="7185128">testcase</span><span class="op" id="7185136">.</span><span class="ident" id="7185137">pattern</span><span class="op" id="7185144">,</span>&nbsp;<span class="builtintype" id="7185146">true</span><span class="op" id="7185150">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185153">}</span><br>
<span class="lineno"></span><span class="op" id="7185155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7185158">func</span>&nbsp;<span class="ident" id="7185163">TestOutput</span><span class="op" id="7185173">(</span><span class="ident" id="7185174">t</span>&nbsp;<span class="op" id="7185176">*</span><span class="ident" id="7185177">testing</span><span class="op" id="7185184">.</span><span class="ident" id="7185185">T</span><span class="op" id="7185186">)</span>&nbsp;<span class="op" id="7185188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7185191">const</span>&nbsp;<span class="ident" id="7185197">testString</span>&nbsp;<span class="op" id="7185208">=</span>&nbsp;<span class="string" id="7185210">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7185218">var</span>&nbsp;<span class="ident" id="7185222">b</span>&nbsp;<span class="ident" id="7185224">bytes</span><span class="op" id="7185229">.</span><span class="ident" id="7185230">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185238">l</span>&nbsp;<span class="op" id="7185240">:=</span>&nbsp;<span class="ident" id="7185243">New</span><span class="op" id="7185246">(</span><span class="op" id="7185247">&amp;</span><span class="ident" id="7185248">b</span><span class="op" id="7185249">,</span>&nbsp;<span class="string" id="7185251">&#34;&#34;</span><span class="op" id="7185253">,</span>&nbsp;<span class="num" id="7185255">0</span><span class="op" id="7185256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185259">l</span><span class="op" id="7185260">.</span><span class="ident" id="7185261">Println</span><span class="op" id="7185268">(</span><span class="ident" id="7185269">testString</span><span class="op" id="7185279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7185282">if</span>&nbsp;<span class="ident" id="7185285">expect</span>&nbsp;<span class="op" id="7185292">:=</span>&nbsp;<span class="ident" id="7185295">testString</span>&nbsp;<span class="op" id="7185306">+</span>&nbsp;<span class="string" id="7185308">&#34;\n&#34;</span><span class="op" id="7185312">;</span>&nbsp;<span class="ident" id="7185314">b</span><span class="op" id="7185315">.</span><span class="ident" id="7185316">String</span><span class="op" id="7185322">(</span><span class="op" id="7185323">)</span>&nbsp;<span class="op" id="7185325">!=</span>&nbsp;<span class="ident" id="7185328">expect</span>&nbsp;<span class="op" id="7185335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185339">t</span><span class="op" id="7185340">.</span><span class="ident" id="7185341">Errorf</span><span class="op" id="7185347">(</span><span class="string" id="7185348">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7185382">,</span>&nbsp;<span class="ident" id="7185384">expect</span><span class="op" id="7185390">,</span>&nbsp;<span class="ident" id="7185392">b</span><span class="op" id="7185393">.</span><span class="ident" id="7185394">String</span><span class="op" id="7185400">(</span><span class="op" id="7185401">)</span><span class="op" id="7185402">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185405">}</span><br>
<span class="lineno"></span><span class="op" id="7185407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7185410">func</span>&nbsp;<span class="ident" id="7185415">TestFlagAndPrefixSetting</span><span class="op" id="7185439">(</span><span class="ident" id="7185440">t</span>&nbsp;<span class="op" id="7185442">*</span><span class="ident" id="7185443">testing</span><span class="op" id="7185450">.</span><span class="ident" id="7185451">T</span><span class="op" id="7185452">)</span>&nbsp;<span class="op" id="7185454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7185457">var</span>&nbsp;<span class="ident" id="7185461">b</span>&nbsp;<span class="ident" id="7185463">bytes</span><span class="op" id="7185468">.</span><span class="ident" id="7185469">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185477">l</span>&nbsp;<span class="op" id="7185479">:=</span>&nbsp;<span class="ident" id="7185482">New</span><span class="op" id="7185485">(</span><span class="op" id="7185486">&amp;</span><span class="ident" id="7185487">b</span><span class="op" id="7185488">,</span>&nbsp;<span class="string" id="7185490">&#34;Test:&#34;</span><span class="op" id="7185497">,</span>&nbsp;<span class="ident" id="7185499">LstdFlags</span><span class="op" id="7185508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185511">f</span>&nbsp;<span class="op" id="7185513">:=</span>&nbsp;<span class="ident" id="7185516">l</span><span class="op" id="7185517">.</span><span class="ident" id="7185518">Flags</span><span class="op" id="7185523">(</span><span class="op" id="7185524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7185527">if</span>&nbsp;<span class="ident" id="7185530">f</span>&nbsp;<span class="op" id="7185532">!=</span>&nbsp;<span class="ident" id="7185535">LstdFlags</span>&nbsp;<span class="op" id="7185545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185549">t</span><span class="op" id="7185550">.</span><span class="ident" id="7185551">Errorf</span><span class="op" id="7185557">(</span><span class="string" id="7185558">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7185587">,</span>&nbsp;<span class="ident" id="7185589">LstdFlags</span><span class="op" id="7185598">,</span>&nbsp;<span class="ident" id="7185600">f</span><span class="op" id="7185601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185604">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185607">l</span><span class="op" id="7185608">.</span><span class="ident" id="7185609">SetFlags</span><span class="op" id="7185617">(</span><span class="ident" id="7185618">f</span>&nbsp;<span class="op" id="7185620">|</span>&nbsp;<span class="ident" id="7185622">Lmicroseconds</span><span class="op" id="7185635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185638">f</span>&nbsp;<span class="op" id="7185640">=</span>&nbsp;<span class="ident" id="7185642">l</span><span class="op" id="7185643">.</span><span class="ident" id="7185644">Flags</span><span class="op" id="7185649">(</span><span class="op" id="7185650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7185653">if</span>&nbsp;<span class="ident" id="7185656">f</span>&nbsp;<span class="op" id="7185658">!=</span>&nbsp;<span class="ident" id="7185661">LstdFlags</span><span class="op" id="7185670">|</span><span class="ident" id="7185671">Lmicroseconds</span>&nbsp;<span class="op" id="7185685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185689">t</span><span class="op" id="7185690">.</span><span class="ident" id="7185691">Errorf</span><span class="op" id="7185697">(</span><span class="string" id="7185698">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7185727">,</span>&nbsp;<span class="ident" id="7185729">LstdFlags</span><span class="op" id="7185738">|</span><span class="ident" id="7185739">Lmicroseconds</span><span class="op" id="7185752">,</span>&nbsp;<span class="ident" id="7185754">f</span><span class="op" id="7185755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185758">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185761">p</span>&nbsp;<span class="op" id="7185763">:=</span>&nbsp;<span class="ident" id="7185766">l</span><span class="op" id="7185767">.</span><span class="ident" id="7185768">Prefix</span><span class="op" id="7185774">(</span><span class="op" id="7185775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7185778">if</span>&nbsp;<span class="ident" id="7185781">p</span>&nbsp;<span class="op" id="7185783">!=</span>&nbsp;<span class="string" id="7185786">&#34;Test:&#34;</span>&nbsp;<span class="op" id="7185794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185798">t</span><span class="op" id="7185799">.</span><span class="ident" id="7185800">Errorf</span><span class="op" id="7185806">(</span><span class="string" id="7185807">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7185840">,</span>&nbsp;<span class="ident" id="7185842">p</span><span class="op" id="7185843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185849">l</span><span class="op" id="7185850">.</span><span class="ident" id="7185851">SetPrefix</span><span class="op" id="7185860">(</span><span class="string" id="7185861">&#34;Reality:&#34;</span><span class="op" id="7185871">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185874">p</span>&nbsp;<span class="op" id="7185876">=</span>&nbsp;<span class="ident" id="7185878">l</span><span class="op" id="7185879">.</span><span class="ident" id="7185880">Prefix</span><span class="op" id="7185886">(</span><span class="op" id="7185887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7185890">if</span>&nbsp;<span class="ident" id="7185893">p</span>&nbsp;<span class="op" id="7185895">!=</span>&nbsp;<span class="string" id="7185898">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="7185909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185913">t</span><span class="op" id="7185914">.</span><span class="ident" id="7185915">Errorf</span><span class="op" id="7185921">(</span><span class="string" id="7185922">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7185958">,</span>&nbsp;<span class="ident" id="7185960">p</span><span class="op" id="7185961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7185964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7185967">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186047">l</span><span class="op" id="7186048">.</span><span class="ident" id="7186049">Print</span><span class="op" id="7186054">(</span><span class="string" id="7186055">&#34;hello&#34;</span><span class="op" id="7186062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186065">pattern</span>&nbsp;<span class="op" id="7186073">:=</span>&nbsp;<span class="string" id="7186076">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="7186088">+</span>&nbsp;<span class="ident" id="7186090">Rdate</span>&nbsp;<span class="op" id="7186096">+</span>&nbsp;<span class="string" id="7186098">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7186102">+</span>&nbsp;<span class="ident" id="7186104">Rtime</span>&nbsp;<span class="op" id="7186110">+</span>&nbsp;<span class="ident" id="7186112">Rmicroseconds</span>&nbsp;<span class="op" id="7186126">+</span>&nbsp;<span class="string" id="7186128">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186140">matched</span><span class="op" id="7186147">,</span>&nbsp;<span class="ident" id="7186149">err</span>&nbsp;<span class="op" id="7186153">:=</span>&nbsp;<span class="ident" id="7186156">regexp</span><span class="op" id="7186162">.</span><span class="ident" id="7186163">Match</span><span class="op" id="7186168">(</span><span class="ident" id="7186169">pattern</span><span class="op" id="7186176">,</span>&nbsp;<span class="ident" id="7186178">b</span><span class="op" id="7186179">.</span><span class="ident" id="7186180">Bytes</span><span class="op" id="7186185">(</span><span class="op" id="7186186">)</span><span class="op" id="7186187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7186190">if</span>&nbsp;<span class="ident" id="7186193">err</span>&nbsp;<span class="op" id="7186197">!=</span>&nbsp;<span class="builtintype" id="7186200">nil</span>&nbsp;<span class="op" id="7186204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186208">t</span><span class="op" id="7186209">.</span><span class="ident" id="7186210">Fatalf</span><span class="op" id="7186216">(</span><span class="string" id="7186217">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="7186249">,</span>&nbsp;<span class="ident" id="7186251">pattern</span><span class="op" id="7186258">,</span>&nbsp;<span class="ident" id="7186260">err</span><span class="op" id="7186263">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7186266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7186269">if</span>&nbsp;<span class="op" id="7186272">!</span><span class="ident" id="7186273">matched</span>&nbsp;<span class="op" id="7186281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7186285">t</span><span class="op" id="7186286">.</span><span class="ident" id="7186287">Error</span><span class="op" id="7186292">(</span><span class="string" id="7186293">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="7186324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7186327">}</span><br>
<span class="lineno"></span><span class="op" id="7186329">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
