<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html" class="current">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4028254">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4028309">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4028363">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4028414">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4028479">//&nbsp;Read&nbsp;system&nbsp;DNS&nbsp;config&nbsp;from&nbsp;/etc/resolv.conf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4028528">package</span>&nbsp;<span class="ident" id="4028536">net</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4028541">type</span>&nbsp;<span class="ident" id="4028546">dnsConfig</span>&nbsp;<span class="keyword" id="4028556">struct</span>&nbsp;<span class="op" id="4028563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028566">servers</span>&nbsp;&nbsp;<span class="op" id="4028575">[</span><span class="op" id="4028576">]</span><span class="builtintype" id="4028577">string</span>&nbsp;<span class="comment" id="4028584">//&nbsp;servers&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028603">search</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4028612">[</span><span class="op" id="4028613">]</span><span class="builtintype" id="4028614">string</span>&nbsp;<span class="comment" id="4028621">//&nbsp;suffixes&nbsp;to&nbsp;append&nbsp;to&nbsp;local&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028658">ndots</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4028667">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4028676">//&nbsp;number&nbsp;of&nbsp;dots&nbsp;in&nbsp;name&nbsp;to&nbsp;trigger&nbsp;absolute&nbsp;lookup</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028730">timeout</span>&nbsp;&nbsp;<span class="builtintype" id="4028739">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4028748">//&nbsp;seconds&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;packet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028787">attempts</span>&nbsp;<span class="builtintype" id="4028796">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4028805">//&nbsp;lost&nbsp;packets&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028849">rotate</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4028858">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4028867">//&nbsp;round&nbsp;robin&nbsp;among&nbsp;servers</span><br>
<span class="lineno"></span><span class="op" id="4028896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4028899">//&nbsp;See&nbsp;resolv.conf(5)&nbsp;on&nbsp;a&nbsp;Linux&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="4028941">//&nbsp;TODO(rsc):&nbsp;Supposed&nbsp;to&nbsp;call&nbsp;uname()&nbsp;and&nbsp;chop&nbsp;the&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="4029003">//&nbsp;of&nbsp;the&nbsp;host&nbsp;name&nbsp;to&nbsp;get&nbsp;the&nbsp;default&nbsp;search&nbsp;domain.</span><br>
<span class="lineno"></span><span class="keyword" id="4029057">func</span>&nbsp;<span class="ident" id="4029062">dnsReadConfig</span><span class="op" id="4029075">(</span><span class="ident" id="4029076">filename</span>&nbsp;<span class="builtintype" id="4029085">string</span><span class="op" id="4029091">)</span>&nbsp;<span class="op" id="4029093">(</span><span class="op" id="4029094">*</span><span class="ident" id="4029095">dnsConfig</span><span class="op" id="4029104">,</span>&nbsp;<span class="builtintype" id="4029106">error</span><span class="op" id="4029111">)</span>&nbsp;<span class="op" id="4029113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029116">file</span><span class="op" id="4029120">,</span>&nbsp;<span class="ident" id="4029122">err</span>&nbsp;<span class="op" id="4029126">:=</span>&nbsp;<span class="ident" id="4029129">open</span><span class="op" id="4029133">(</span><span class="ident" id="4029134">filename</span><span class="op" id="4029142">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029145">if</span>&nbsp;<span class="ident" id="4029148">err</span>&nbsp;<span class="op" id="4029152">!=</span>&nbsp;<span class="ident" id="4029155">nil</span>&nbsp;<span class="op" id="4029159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029163">return</span>&nbsp;<span class="ident" id="4029170">nil</span><span class="op" id="4029173">,</span>&nbsp;<span class="op" id="4029175">&amp;</span><span class="ident" id="4029176">DNSConfigError</span><span class="op" id="4029190">{</span><span class="ident" id="4029191">err</span><span class="op" id="4029194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029200">defer</span>&nbsp;<span class="ident" id="4029206">file</span><span class="op" id="4029210">.</span><span class="builtinfunc" id="4029211">close</span><span class="op" id="4029216">(</span><span class="op" id="4029217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029220">conf</span>&nbsp;<span class="op" id="4029225">:=</span>&nbsp;<span class="op" id="4029228">&amp;</span><span class="ident" id="4029229">dnsConfig</span><span class="op" id="4029238">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029242">ndots</span><span class="op" id="4029247">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4029252">1</span><span class="op" id="4029253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029257">timeout</span><span class="op" id="4029264">:</span>&nbsp;&nbsp;<span class="num" id="4029267">5</span><span class="op" id="4029268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029272">attempts</span><span class="op" id="4029280">:</span>&nbsp;<span class="num" id="4029282">2</span><span class="op" id="4029283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029289">for</span>&nbsp;<span class="ident" id="4029293">line</span><span class="op" id="4029297">,</span>&nbsp;<span class="ident" id="4029299">ok</span>&nbsp;<span class="op" id="4029302">:=</span>&nbsp;<span class="ident" id="4029305">file</span><span class="op" id="4029309">.</span><span class="ident" id="4029310">readLine</span><span class="op" id="4029318">(</span><span class="op" id="4029319">)</span><span class="op" id="4029320">;</span>&nbsp;<span class="ident" id="4029322">ok</span><span class="op" id="4029324">;</span>&nbsp;<span class="ident" id="4029326">line</span><span class="op" id="4029330">,</span>&nbsp;<span class="ident" id="4029332">ok</span>&nbsp;<span class="op" id="4029335">=</span>&nbsp;<span class="ident" id="4029337">file</span><span class="op" id="4029341">.</span><span class="ident" id="4029342">readLine</span><span class="op" id="4029350">(</span><span class="op" id="4029351">)</span>&nbsp;<span class="op" id="4029353">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029357">f</span>&nbsp;<span class="op" id="4029359">:=</span>&nbsp;<span class="ident" id="4029362">getFields</span><span class="op" id="4029371">(</span><span class="ident" id="4029372">line</span><span class="op" id="4029376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029380">if</span>&nbsp;<span class="builtinfunc" id="4029383">len</span><span class="op" id="4029386">(</span><span class="ident" id="4029387">f</span><span class="op" id="4029388">)</span>&nbsp;<span class="op" id="4029390">&lt;</span>&nbsp;<span class="num" id="4029392">1</span>&nbsp;<span class="op" id="4029394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029399">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029414">switch</span>&nbsp;<span class="ident" id="4029421">f</span><span class="op" id="4029422">[</span><span class="num" id="4029423">0</span><span class="op" id="4029424">]</span>&nbsp;<span class="op" id="4029426">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029430">case</span>&nbsp;<span class="string" id="4029435">&#34;nameserver&#34;</span><span class="op" id="4029447">:</span>&nbsp;<span class="comment" id="4029449">//&nbsp;add&nbsp;one&nbsp;name&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029475">if</span>&nbsp;<span class="builtinfunc" id="4029478">len</span><span class="op" id="4029481">(</span><span class="ident" id="4029482">f</span><span class="op" id="4029483">)</span>&nbsp;<span class="op" id="4029485">&gt;</span>&nbsp;<span class="num" id="4029487">1</span>&nbsp;<span class="op" id="4029489">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4029492">len</span><span class="op" id="4029495">(</span><span class="ident" id="4029496">conf</span><span class="op" id="4029500">.</span><span class="ident" id="4029501">servers</span><span class="op" id="4029508">)</span>&nbsp;<span class="op" id="4029510">&lt;</span>&nbsp;<span class="num" id="4029512">3</span>&nbsp;<span class="op" id="4029514">{</span>&nbsp;<span class="comment" id="4029516">//&nbsp;small,&nbsp;but&nbsp;the&nbsp;standard&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029553">//&nbsp;One&nbsp;more&nbsp;check:&nbsp;make&nbsp;sure&nbsp;server&nbsp;name&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029601">//&nbsp;just&nbsp;an&nbsp;IP&nbsp;address.&nbsp;&nbsp;Otherwise&nbsp;we&nbsp;need&nbsp;DNS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029651">//&nbsp;to&nbsp;look&nbsp;it&nbsp;up.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029673">if</span>&nbsp;<span class="ident" id="4029676">parseIPv4</span><span class="op" id="4029685">(</span><span class="ident" id="4029686">f</span><span class="op" id="4029687">[</span><span class="num" id="4029688">1</span><span class="op" id="4029689">]</span><span class="op" id="4029690">)</span>&nbsp;<span class="op" id="4029692">!=</span>&nbsp;<span class="ident" id="4029695">nil</span>&nbsp;<span class="op" id="4029699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029706">conf</span><span class="op" id="4029710">.</span><span class="ident" id="4029711">servers</span>&nbsp;<span class="op" id="4029719">=</span>&nbsp;<span class="builtinfunc" id="4029721">append</span><span class="op" id="4029727">(</span><span class="ident" id="4029728">conf</span><span class="op" id="4029732">.</span><span class="ident" id="4029733">servers</span><span class="op" id="4029740">,</span>&nbsp;<span class="ident" id="4029742">f</span><span class="op" id="4029743">[</span><span class="num" id="4029744">1</span><span class="op" id="4029745">]</span><span class="op" id="4029746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029752">}</span>&nbsp;<span class="keyword" id="4029754">else</span>&nbsp;<span class="keyword" id="4029759">if</span>&nbsp;<span class="ident" id="4029762">ip</span><span class="op" id="4029764">,</span>&nbsp;<span class="ident" id="4029766">_</span>&nbsp;<span class="op" id="4029768">:=</span>&nbsp;<span class="ident" id="4029771">parseIPv6</span><span class="op" id="4029780">(</span><span class="ident" id="4029781">f</span><span class="op" id="4029782">[</span><span class="num" id="4029783">1</span><span class="op" id="4029784">]</span><span class="op" id="4029785">,</span>&nbsp;<span class="builtintype" id="4029787">true</span><span class="op" id="4029791">)</span><span class="op" id="4029792">;</span>&nbsp;<span class="ident" id="4029794">ip</span>&nbsp;<span class="op" id="4029797">!=</span>&nbsp;<span class="ident" id="4029800">nil</span>&nbsp;<span class="op" id="4029804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029811">conf</span><span class="op" id="4029815">.</span><span class="ident" id="4029816">servers</span>&nbsp;<span class="op" id="4029824">=</span>&nbsp;<span class="builtinfunc" id="4029826">append</span><span class="op" id="4029832">(</span><span class="ident" id="4029833">conf</span><span class="op" id="4029837">.</span><span class="ident" id="4029838">servers</span><span class="op" id="4029845">,</span>&nbsp;<span class="ident" id="4029847">f</span><span class="op" id="4029848">[</span><span class="num" id="4029849">1</span><span class="op" id="4029850">]</span><span class="op" id="4029851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029857">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029867">case</span>&nbsp;<span class="string" id="4029872">&#34;domain&#34;</span><span class="op" id="4029880">:</span>&nbsp;<span class="comment" id="4029882">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;just&nbsp;this&nbsp;domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029924">if</span>&nbsp;<span class="builtinfunc" id="4029927">len</span><span class="op" id="4029930">(</span><span class="ident" id="4029931">f</span><span class="op" id="4029932">)</span>&nbsp;<span class="op" id="4029934">&gt;</span>&nbsp;<span class="num" id="4029936">1</span>&nbsp;<span class="op" id="4029938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029944">conf</span><span class="op" id="4029948">.</span><span class="ident" id="4029949">search</span>&nbsp;<span class="op" id="4029956">=</span>&nbsp;<span class="op" id="4029958">[</span><span class="op" id="4029959">]</span><span class="builtintype" id="4029960">string</span><span class="op" id="4029966">{</span><span class="ident" id="4029967">f</span><span class="op" id="4029968">[</span><span class="num" id="4029969">1</span><span class="op" id="4029970">]</span><span class="op" id="4029971">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029981">case</span>&nbsp;<span class="string" id="4029986">&#34;search&#34;</span><span class="op" id="4029994">:</span>&nbsp;<span class="comment" id="4029996">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;given&nbsp;servers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030035">conf</span><span class="op" id="4030039">.</span><span class="ident" id="4030040">search</span>&nbsp;<span class="op" id="4030047">=</span>&nbsp;<span class="builtinfunc" id="4030049">make</span><span class="op" id="4030053">(</span><span class="op" id="4030054">[</span><span class="op" id="4030055">]</span><span class="builtintype" id="4030056">string</span><span class="op" id="4030062">,</span>&nbsp;<span class="builtinfunc" id="4030064">len</span><span class="op" id="4030067">(</span><span class="ident" id="4030068">f</span><span class="op" id="4030069">)</span><span class="op" id="4030070">-</span><span class="num" id="4030071">1</span><span class="op" id="4030072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030077">for</span>&nbsp;<span class="ident" id="4030081">i</span>&nbsp;<span class="op" id="4030083">:=</span>&nbsp;<span class="num" id="4030086">0</span><span class="op" id="4030087">;</span>&nbsp;<span class="ident" id="4030089">i</span>&nbsp;<span class="op" id="4030091">&lt;</span>&nbsp;<span class="builtinfunc" id="4030093">len</span><span class="op" id="4030096">(</span><span class="ident" id="4030097">conf</span><span class="op" id="4030101">.</span><span class="ident" id="4030102">search</span><span class="op" id="4030108">)</span><span class="op" id="4030109">;</span>&nbsp;<span class="ident" id="4030111">i</span><span class="op" id="4030112">++</span>&nbsp;<span class="op" id="4030115">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030121">conf</span><span class="op" id="4030125">.</span><span class="ident" id="4030126">search</span><span class="op" id="4030132">[</span><span class="ident" id="4030133">i</span><span class="op" id="4030134">]</span>&nbsp;<span class="op" id="4030136">=</span>&nbsp;<span class="ident" id="4030138">f</span><span class="op" id="4030139">[</span><span class="ident" id="4030140">i</span><span class="op" id="4030141">+</span><span class="num" id="4030142">1</span><span class="op" id="4030143">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030153">case</span>&nbsp;<span class="string" id="4030158">&#34;options&#34;</span><span class="op" id="4030167">:</span>&nbsp;<span class="comment" id="4030169">//&nbsp;magic&nbsp;options</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030189">for</span>&nbsp;<span class="ident" id="4030193">i</span>&nbsp;<span class="op" id="4030195">:=</span>&nbsp;<span class="num" id="4030198">1</span><span class="op" id="4030199">;</span>&nbsp;<span class="ident" id="4030201">i</span>&nbsp;<span class="op" id="4030203">&lt;</span>&nbsp;<span class="builtinfunc" id="4030205">len</span><span class="op" id="4030208">(</span><span class="ident" id="4030209">f</span><span class="op" id="4030210">)</span><span class="op" id="4030211">;</span>&nbsp;<span class="ident" id="4030213">i</span><span class="op" id="4030214">++</span>&nbsp;<span class="op" id="4030217">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030223">s</span>&nbsp;<span class="op" id="4030225">:=</span>&nbsp;<span class="ident" id="4030228">f</span><span class="op" id="4030229">[</span><span class="ident" id="4030230">i</span><span class="op" id="4030231">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030237">switch</span>&nbsp;<span class="op" id="4030244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030250">case</span>&nbsp;<span class="ident" id="4030255">hasPrefix</span><span class="op" id="4030264">(</span><span class="ident" id="4030265">s</span><span class="op" id="4030266">,</span>&nbsp;<span class="string" id="4030268">&#34;ndots:&#34;</span><span class="op" id="4030276">)</span><span class="op" id="4030277">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030284">n</span><span class="op" id="4030285">,</span>&nbsp;<span class="ident" id="4030287">_</span><span class="op" id="4030288">,</span>&nbsp;<span class="ident" id="4030290">_</span>&nbsp;<span class="op" id="4030292">:=</span>&nbsp;<span class="ident" id="4030295">dtoi</span><span class="op" id="4030299">(</span><span class="ident" id="4030300">s</span><span class="op" id="4030301">,</span>&nbsp;<span class="num" id="4030303">6</span><span class="op" id="4030304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030311">if</span>&nbsp;<span class="ident" id="4030314">n</span>&nbsp;<span class="op" id="4030316">&lt;</span>&nbsp;<span class="num" id="4030318">1</span>&nbsp;<span class="op" id="4030320">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030328">n</span>&nbsp;<span class="op" id="4030330">=</span>&nbsp;<span class="num" id="4030332">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030346">conf</span><span class="op" id="4030350">.</span><span class="ident" id="4030351">ndots</span>&nbsp;<span class="op" id="4030357">=</span>&nbsp;<span class="ident" id="4030359">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030365">case</span>&nbsp;<span class="ident" id="4030370">hasPrefix</span><span class="op" id="4030379">(</span><span class="ident" id="4030380">s</span><span class="op" id="4030381">,</span>&nbsp;<span class="string" id="4030383">&#34;timeout:&#34;</span><span class="op" id="4030393">)</span><span class="op" id="4030394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030401">n</span><span class="op" id="4030402">,</span>&nbsp;<span class="ident" id="4030404">_</span><span class="op" id="4030405">,</span>&nbsp;<span class="ident" id="4030407">_</span>&nbsp;<span class="op" id="4030409">:=</span>&nbsp;<span class="ident" id="4030412">dtoi</span><span class="op" id="4030416">(</span><span class="ident" id="4030417">s</span><span class="op" id="4030418">,</span>&nbsp;<span class="num" id="4030420">8</span><span class="op" id="4030421">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030428">if</span>&nbsp;<span class="ident" id="4030431">n</span>&nbsp;<span class="op" id="4030433">&lt;</span>&nbsp;<span class="num" id="4030435">1</span>&nbsp;<span class="op" id="4030437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030445">n</span>&nbsp;<span class="op" id="4030447">=</span>&nbsp;<span class="num" id="4030449">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030463">conf</span><span class="op" id="4030467">.</span><span class="ident" id="4030468">timeout</span>&nbsp;<span class="op" id="4030476">=</span>&nbsp;<span class="ident" id="4030478">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030484">case</span>&nbsp;<span class="ident" id="4030489">hasPrefix</span><span class="op" id="4030498">(</span><span class="ident" id="4030499">s</span><span class="op" id="4030500">,</span>&nbsp;<span class="string" id="4030502">&#34;attempts:&#34;</span><span class="op" id="4030513">)</span><span class="op" id="4030514">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030521">n</span><span class="op" id="4030522">,</span>&nbsp;<span class="ident" id="4030524">_</span><span class="op" id="4030525">,</span>&nbsp;<span class="ident" id="4030527">_</span>&nbsp;<span class="op" id="4030529">:=</span>&nbsp;<span class="ident" id="4030532">dtoi</span><span class="op" id="4030536">(</span><span class="ident" id="4030537">s</span><span class="op" id="4030538">,</span>&nbsp;<span class="num" id="4030540">9</span><span class="op" id="4030541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030548">if</span>&nbsp;<span class="ident" id="4030551">n</span>&nbsp;<span class="op" id="4030553">&lt;</span>&nbsp;<span class="num" id="4030555">1</span>&nbsp;<span class="op" id="4030557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030565">n</span>&nbsp;<span class="op" id="4030567">=</span>&nbsp;<span class="num" id="4030569">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030583">conf</span><span class="op" id="4030587">.</span><span class="ident" id="4030588">attempts</span>&nbsp;<span class="op" id="4030597">=</span>&nbsp;<span class="ident" id="4030599">n</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030605">case</span>&nbsp;<span class="ident" id="4030610">s</span>&nbsp;<span class="op" id="4030612">==</span>&nbsp;<span class="string" id="4030615">&#34;rotate&#34;</span><span class="op" id="4030623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030630">conf</span><span class="op" id="4030634">.</span><span class="ident" id="4030635">rotate</span>&nbsp;<span class="op" id="4030642">=</span>&nbsp;<span class="builtintype" id="4030644">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030662">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030668">return</span>&nbsp;<span class="ident" id="4030675">conf</span><span class="op" id="4030679">,</span>&nbsp;<span class="ident" id="4030681">nil</span><br>
<span class="lineno"></span><span class="op" id="4030685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4030688">func</span>&nbsp;<span class="ident" id="4030693">hasPrefix</span><span class="op" id="4030702">(</span><span class="ident" id="4030703">s</span><span class="op" id="4030704">,</span>&nbsp;<span class="ident" id="4030706">prefix</span>&nbsp;<span class="builtintype" id="4030713">string</span><span class="op" id="4030719">)</span>&nbsp;<span class="builtintype" id="4030721">bool</span>&nbsp;<span class="op" id="4030726">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030729">return</span>&nbsp;<span class="builtinfunc" id="4030736">len</span><span class="op" id="4030739">(</span><span class="ident" id="4030740">s</span><span class="op" id="4030741">)</span>&nbsp;<span class="op" id="4030743">&gt;=</span>&nbsp;<span class="builtinfunc" id="4030746">len</span><span class="op" id="4030749">(</span><span class="ident" id="4030750">prefix</span><span class="op" id="4030756">)</span>&nbsp;<span class="op" id="4030758">&amp;&amp;</span>&nbsp;<span class="ident" id="4030761">s</span><span class="op" id="4030762">[</span><span class="op" id="4030763">:</span><span class="builtinfunc" id="4030764">len</span><span class="op" id="4030767">(</span><span class="ident" id="4030768">prefix</span><span class="op" id="4030774">)</span><span class="op" id="4030775">]</span>&nbsp;<span class="op" id="4030777">==</span>&nbsp;<span class="ident" id="4030780">prefix</span><br>
<span class="lineno"></span><span class="op" id="4030787">}</span>
</div>
</body>
</html>
