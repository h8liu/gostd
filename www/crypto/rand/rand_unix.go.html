<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4012258">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4012314">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4012368">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4012419">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4012495">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="4012548">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4012563">package</span>&nbsp;<span class="ident" id="4012571">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4012577">import</span>&nbsp;<span class="op" id="4012584">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4012587">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4012596">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4012610">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4012627">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4012633">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4012639">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4012650">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4012658">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4012665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4012668">const</span>&nbsp;<span class="ident" id="4012674">urandomDevice</span>&nbsp;<span class="op" id="4012688">=</span>&nbsp;<span class="string" id="4012690">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4012706">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="4012754">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4012806">func</span>&nbsp;<span class="ident" id="4012811">init</span><span class="op" id="4012815">(</span><span class="op" id="4012816">)</span>&nbsp;<span class="op" id="4012818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012821">if</span>&nbsp;<span class="ident" id="4012824"><a href="/crypto/rand/rand_unix.go.html#4012639">runtime</a></span><span class="op" id="4012831">.</span><span class="ident" id="4012832">GOOS</span>&nbsp;<span class="op" id="4012837">==</span>&nbsp;<span class="string" id="4012840">&#34;plan9&#34;</span>&nbsp;<span class="op" id="4012848">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012852"><a href="/crypto/rand/rand.go.html#4011150">Reader</a></span>&nbsp;<span class="op" id="4012859">=</span>&nbsp;<span class="ident" id="4012861"><a href="/crypto/rand/rand_unix.go.html#4014141">newReader</a></span><span class="op" id="4012870">(</span><span class="ident" id="4012871">nil</span><span class="op" id="4012874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012877">}</span>&nbsp;<span class="keyword" id="4012879">else</span>&nbsp;<span class="op" id="4012884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012888"><a href="/crypto/rand/rand.go.html#4011150">Reader</a></span>&nbsp;<span class="op" id="4012895">=</span>&nbsp;<span class="op" id="4012897">&amp;</span><span class="ident" id="4012898"><a href="/crypto/rand/rand_unix.go.html#4013003">devReader</a></span><span class="op" id="4012907">{</span><span class="ident" id="4012908">name</span><span class="op" id="4012912">:</span>&nbsp;<span class="ident" id="4012914"><a href="/crypto/rand/rand_unix.go.html#4012674">urandomDevice</a></span><span class="op" id="4012927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012930">}</span><br>
<span class="lineno"></span><span class="op" id="4012932">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4012935">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4012998">type</span>&nbsp;<span class="ident" id="4013003">devReader</span>&nbsp;<span class="keyword" id="4013013">struct</span>&nbsp;<span class="op" id="4013020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013023">name</span>&nbsp;<span class="builtintype" id="4013028">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013036">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013041"><a href="/crypto/rand/rand_unix.go.html#4012627">io</a></span><span class="op" id="4013043">.</span><span class="ident" id="4013044">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013052">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4013057"><a href="/crypto/rand/rand_unix.go.html#4012650">sync</a></span><span class="op" id="4013061">.</span><span class="ident" id="4013062">Mutex</span><br>
<span class="lineno"></span><span class="op" id="4013068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4013071">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="4013139">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="4013168">var</span>&nbsp;<span class="ident" id="4013172">altGetRandom</span>&nbsp;<span class="keyword" id="4013185">func</span><span class="op" id="4013189">(</span><span class="op" id="4013190">[</span><span class="op" id="4013191">]</span><span class="builtintype" id="4013192">byte</span><span class="op" id="4013196">)</span>&nbsp;<span class="op" id="4013198">(</span><span class="ident" id="4013199">ok</span>&nbsp;<span class="builtintype" id="4013202">bool</span><span class="op" id="4013206">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4013209">func</span>&nbsp;<span class="op" id="4013214">(</span><span class="ident" id="4013215">r</span>&nbsp;<span class="op" id="4013217">*</span><span class="ident" id="4013218"><a href="/crypto/rand/rand_unix.go.html#4013003">devReader</a></span><span class="op" id="4013227">)</span>&nbsp;<span class="ident" id="4013229">Read</span><span class="op" id="4013233">(</span><span class="ident" id="4013234">b</span>&nbsp;<span class="op" id="4013236">[</span><span class="op" id="4013237">]</span><span class="builtintype" id="4013238">byte</span><span class="op" id="4013242">)</span>&nbsp;<span class="op" id="4013244">(</span><span class="ident" id="4013245">n</span>&nbsp;<span class="builtintype" id="4013247">int</span><span class="op" id="4013250">,</span>&nbsp;<span class="ident" id="4013252">err</span>&nbsp;<span class="builtintype" id="4013256">error</span><span class="op" id="4013261">)</span>&nbsp;<span class="op" id="4013263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013266">if</span>&nbsp;<span class="ident" id="4013269"><a href="/crypto/rand/rand_unix.go.html#4013172">altGetRandom</a></span>&nbsp;<span class="op" id="4013282">!=</span>&nbsp;<span class="ident" id="4013285">nil</span>&nbsp;<span class="op" id="4013289">&amp;&amp;</span>&nbsp;<span class="ident" id="4013292"><a href="/crypto/rand/rand_unix.go.html#4013215">r</a></span><span class="op" id="4013293">.</span><span class="ident" id="4013294">name</span>&nbsp;<span class="op" id="4013299">==</span>&nbsp;<span class="ident" id="4013302"><a href="/crypto/rand/rand_unix.go.html#4012674">urandomDevice</a></span>&nbsp;<span class="op" id="4013316">&amp;&amp;</span>&nbsp;<span class="ident" id="4013319"><a href="/crypto/rand/rand_unix.go.html#4013172">altGetRandom</a></span><span class="op" id="4013331">(</span><span class="ident" id="4013332"><a href="/crypto/rand/rand_unix.go.html#4013234">b</a></span><span class="op" id="4013333">)</span>&nbsp;<span class="op" id="4013335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013339">return</span>&nbsp;<span class="builtinfunc" id="4013346">len</span><span class="op" id="4013349">(</span><span class="ident" id="4013350"><a href="/crypto/rand/rand_unix.go.html#4013234">b</a></span><span class="op" id="4013351">)</span><span class="op" id="4013352">,</span>&nbsp;<span class="ident" id="4013354">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013362"><a href="/crypto/rand/rand_unix.go.html#4013215">r</a></span><span class="op" id="4013363">.</span><span class="ident" id="4013364">mu</span><span class="op" id="4013366">.</span><span class="ident" id="4013367">Lock</span><span class="op" id="4013371">(</span><span class="op" id="4013372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013375">defer</span>&nbsp;<span class="ident" id="4013381"><a href="/crypto/rand/rand_unix.go.html#4013215">r</a></span><span class="op" id="4013382">.</span><span class="ident" id="4013383">mu</span><span class="op" id="4013385">.</span><span class="ident" id="4013386">Unlock</span><span class="op" id="4013392">(</span><span class="op" id="4013393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013396">if</span>&nbsp;<span class="ident" id="4013399"><a href="/crypto/rand/rand_unix.go.html#4013215">r</a></span><span class="op" id="4013400">.</span><span class="ident" id="4013401">f</span>&nbsp;<span class="op" id="4013403">==</span>&nbsp;<span class="ident" id="4013406">nil</span>&nbsp;<span class="op" id="4013410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013414">f</span><span class="op" id="4013415">,</span>&nbsp;<span class="ident" id="4013417">err</span>&nbsp;<span class="op" id="4013421">:=</span>&nbsp;<span class="ident" id="4013424"><a href="/crypto/rand/rand_unix.go.html#4012633">os</a></span><span class="op" id="4013426">.</span><span class="ident" id="4013427">Open</span><span class="op" id="4013431">(</span><span class="ident" id="4013432"><a href="/crypto/rand/rand_unix.go.html#4013215">r</a></span><span class="op" id="4013433">.</span><span class="ident" id="4013434">name</span><span class="op" id="4013438">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013442">if</span>&nbsp;<span class="ident" id="4013445"><a href="/crypto/rand/rand_unix.go.html#4013414">f</a></span>&nbsp;<span class="op" id="4013447">==</span>&nbsp;<span class="ident" id="4013450">nil</span>&nbsp;<span class="op" id="4013454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013459">return</span>&nbsp;<span class="num" id="4013466">0</span><span class="op" id="4013467">,</span>&nbsp;<span class="ident" id="4013469"><a href="/crypto/rand/rand_unix.go.html#4013417">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013479">if</span>&nbsp;<span class="ident" id="4013482"><a href="/crypto/rand/rand_unix.go.html#4012639">runtime</a></span><span class="op" id="4013489">.</span><span class="ident" id="4013490">GOOS</span>&nbsp;<span class="op" id="4013495">==</span>&nbsp;<span class="string" id="4013498">&#34;plan9&#34;</span>&nbsp;<span class="op" id="4013506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013511"><a href="/crypto/rand/rand_unix.go.html#4013215">r</a></span><span class="op" id="4013512">.</span><span class="ident" id="4013513">f</span>&nbsp;<span class="op" id="4013515">=</span>&nbsp;<span class="ident" id="4013517"><a href="/crypto/rand/rand_unix.go.html#4013414">f</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013521">}</span>&nbsp;<span class="keyword" id="4013523">else</span>&nbsp;<span class="op" id="4013528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013533"><a href="/crypto/rand/rand_unix.go.html#4013215">r</a></span><span class="op" id="4013534">.</span><span class="ident" id="4013535">f</span>&nbsp;<span class="op" id="4013537">=</span>&nbsp;<span class="ident" id="4013539"><a href="/crypto/rand/rand_unix.go.html#4012587">bufio</a></span><span class="op" id="4013544">.</span><span class="ident" id="4013545">NewReader</span><span class="op" id="4013554">(</span><span class="ident" id="4013555"><a href="/crypto/rand/rand_unix.go.html#4013414">f</a></span><span class="op" id="4013556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013566">return</span>&nbsp;<span class="ident" id="4013573"><a href="/crypto/rand/rand_unix.go.html#4013215">r</a></span><span class="op" id="4013574">.</span><span class="ident" id="4013575">f</span><span class="op" id="4013576">.</span><span class="ident" id="4013577">Read</span><span class="op" id="4013581">(</span><span class="ident" id="4013582"><a href="/crypto/rand/rand_unix.go.html#4013234">b</a></span><span class="op" id="4013583">)</span><br>
<span class="lineno">65</span><span class="op" id="4013585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4013588">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="4013641">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4013686">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4013741">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="4013802">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4013861">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="4013912">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="4013969">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4014028">//</span><br>
<span class="lineno"></span><span class="comment" id="4014031">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="4014087">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4014136">func</span>&nbsp;<span class="ident" id="4014141">newReader</span><span class="op" id="4014150">(</span><span class="ident" id="4014151">entropy</span>&nbsp;<span class="ident" id="4014159"><a href="/crypto/rand/rand_unix.go.html#4012627">io</a></span><span class="op" id="4014161">.</span><span class="ident" id="4014162">Reader</span><span class="op" id="4014168">)</span>&nbsp;<span class="ident" id="4014170"><a href="/crypto/rand/rand_unix.go.html#4012627">io</a></span><span class="op" id="4014172">.</span><span class="ident" id="4014173">Reader</span>&nbsp;<span class="op" id="4014180">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014183">if</span>&nbsp;<span class="ident" id="4014186"><a href="/crypto/rand/rand_unix.go.html#4014151">entropy</a></span>&nbsp;<span class="op" id="4014194">==</span>&nbsp;<span class="ident" id="4014197">nil</span>&nbsp;<span class="op" id="4014201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014205"><a href="/crypto/rand/rand_unix.go.html#4014151">entropy</a></span>&nbsp;<span class="op" id="4014213">=</span>&nbsp;<span class="op" id="4014215">&amp;</span><span class="ident" id="4014216"><a href="/crypto/rand/rand_unix.go.html#4013003">devReader</a></span><span class="op" id="4014225">{</span><span class="ident" id="4014226">name</span><span class="op" id="4014230">:</span>&nbsp;<span class="string" id="4014232">&#34;/dev/random&#34;</span><span class="op" id="4014245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014251">return</span>&nbsp;<span class="op" id="4014258">&amp;</span><span class="ident" id="4014259"><a href="/crypto/rand/rand_unix.go.html#4014292">reader</a></span><span class="op" id="4014265">{</span><span class="ident" id="4014266">entropy</span><span class="op" id="4014273">:</span>&nbsp;<span class="ident" id="4014275"><a href="/crypto/rand/rand_unix.go.html#4014151">entropy</a></span><span class="op" id="4014282">}</span><br>
<span class="lineno"></span><span class="op" id="4014284">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="4014287">type</span>&nbsp;<span class="ident" id="4014292">reader</span>&nbsp;<span class="keyword" id="4014299">struct</span>&nbsp;<span class="op" id="4014306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014309">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014330"><a href="/crypto/rand/rand_unix.go.html#4012650">sync</a></span><span class="op" id="4014334">.</span><span class="ident" id="4014335">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014342">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4014363">int</span>&nbsp;<span class="comment" id="4014367">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014409">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014430"><a href="/crypto/rand/rand_unix.go.html#4012610">cipher</a></span><span class="op" id="4014436">.</span><span class="ident" id="4014437">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014444">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014465"><a href="/crypto/rand/rand_unix.go.html#4012627">io</a></span><span class="op" id="4014467">.</span><span class="ident" id="4014468">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014476">time</span><span class="op" id="4014480">,</span>&nbsp;<span class="ident" id="4014482">seed</span><span class="op" id="4014486">,</span>&nbsp;<span class="ident" id="4014488">dst</span><span class="op" id="4014491">,</span>&nbsp;<span class="ident" id="4014493">key</span>&nbsp;<span class="op" id="4014497">[</span><span class="ident" id="4014498"><a href="/crypto/rand/rand_unix.go.html#4012596">aes</a></span><span class="op" id="4014501">.</span><span class="ident" id="4014502">BlockSize</span><span class="op" id="4014511">]</span><span class="builtintype" id="4014512">byte</span><br>
<span class="lineno"></span><span class="op" id="4014517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4014520">func</span>&nbsp;<span class="op" id="4014525">(</span><span class="ident" id="4014526">r</span>&nbsp;<span class="op" id="4014528">*</span><span class="ident" id="4014529"><a href="/crypto/rand/rand_unix.go.html#4014292">reader</a></span><span class="op" id="4014535">)</span>&nbsp;<span class="ident" id="4014537">Read</span><span class="op" id="4014541">(</span><span class="ident" id="4014542">b</span>&nbsp;<span class="op" id="4014544">[</span><span class="op" id="4014545">]</span><span class="builtintype" id="4014546">byte</span><span class="op" id="4014550">)</span>&nbsp;<span class="op" id="4014552">(</span><span class="ident" id="4014553">n</span>&nbsp;<span class="builtintype" id="4014555">int</span><span class="op" id="4014558">,</span>&nbsp;<span class="ident" id="4014560">err</span>&nbsp;<span class="builtintype" id="4014564">error</span><span class="op" id="4014569">)</span>&nbsp;<span class="op" id="4014571">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014574"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4014575">.</span><span class="ident" id="4014576">mu</span><span class="op" id="4014578">.</span><span class="ident" id="4014579">Lock</span><span class="op" id="4014583">(</span><span class="op" id="4014584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014587">defer</span>&nbsp;<span class="ident" id="4014593"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4014594">.</span><span class="ident" id="4014595">mu</span><span class="op" id="4014597">.</span><span class="ident" id="4014598">Unlock</span><span class="op" id="4014604">(</span><span class="op" id="4014605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014608"><a href="/crypto/rand/rand_unix.go.html#4014553">n</a></span>&nbsp;<span class="op" id="4014610">=</span>&nbsp;<span class="builtinfunc" id="4014612">len</span><span class="op" id="4014615">(</span><span class="ident" id="4014616"><a href="/crypto/rand/rand_unix.go.html#4014542">b</a></span><span class="op" id="4014617">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014621">for</span>&nbsp;<span class="builtinfunc" id="4014625">len</span><span class="op" id="4014628">(</span><span class="ident" id="4014629"><a href="/crypto/rand/rand_unix.go.html#4014542">b</a></span><span class="op" id="4014630">)</span>&nbsp;<span class="op" id="4014632">&gt;</span>&nbsp;<span class="num" id="4014634">0</span>&nbsp;<span class="op" id="4014636">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014640">if</span>&nbsp;<span class="ident" id="4014643"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4014644">.</span><span class="ident" id="4014645">budget</span>&nbsp;<span class="op" id="4014652">==</span>&nbsp;<span class="num" id="4014655">0</span>&nbsp;<span class="op" id="4014657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014662">_</span><span class="op" id="4014663">,</span>&nbsp;<span class="ident" id="4014665">err</span>&nbsp;<span class="op" id="4014669">:=</span>&nbsp;<span class="ident" id="4014672"><a href="/crypto/rand/rand_unix.go.html#4012627">io</a></span><span class="op" id="4014674">.</span><span class="ident" id="4014675">ReadFull</span><span class="op" id="4014683">(</span><span class="ident" id="4014684"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4014685">.</span><span class="ident" id="4014686">entropy</span><span class="op" id="4014693">,</span>&nbsp;<span class="ident" id="4014695"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4014696">.</span><span class="ident" id="4014697">seed</span><span class="op" id="4014701">[</span><span class="num" id="4014702">0</span><span class="op" id="4014703">:</span><span class="op" id="4014704">]</span><span class="op" id="4014705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014710">if</span>&nbsp;<span class="ident" id="4014713"><a href="/crypto/rand/rand_unix.go.html#4014665">err</a></span>&nbsp;<span class="op" id="4014717">!=</span>&nbsp;<span class="ident" id="4014720">nil</span>&nbsp;<span class="op" id="4014724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014730">return</span>&nbsp;<span class="ident" id="4014737"><a href="/crypto/rand/rand_unix.go.html#4014553">n</a></span>&nbsp;<span class="op" id="4014739">-</span>&nbsp;<span class="builtinfunc" id="4014741">len</span><span class="op" id="4014744">(</span><span class="ident" id="4014745"><a href="/crypto/rand/rand_unix.go.html#4014542">b</a></span><span class="op" id="4014746">)</span><span class="op" id="4014747">,</span>&nbsp;<span class="ident" id="4014749"><a href="/crypto/rand/rand_unix.go.html#4014665">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014756">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014761">_</span><span class="op" id="4014762">,</span>&nbsp;<span class="ident" id="4014764"><a href="/crypto/rand/rand_unix.go.html#4014665">err</a></span>&nbsp;<span class="op" id="4014768">=</span>&nbsp;<span class="ident" id="4014770"><a href="/crypto/rand/rand_unix.go.html#4012627">io</a></span><span class="op" id="4014772">.</span><span class="ident" id="4014773">ReadFull</span><span class="op" id="4014781">(</span><span class="ident" id="4014782"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4014783">.</span><span class="ident" id="4014784">entropy</span><span class="op" id="4014791">,</span>&nbsp;<span class="ident" id="4014793"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4014794">.</span><span class="ident" id="4014795">key</span><span class="op" id="4014798">[</span><span class="num" id="4014799">0</span><span class="op" id="4014800">:</span><span class="op" id="4014801">]</span><span class="op" id="4014802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014807">if</span>&nbsp;<span class="ident" id="4014810"><a href="/crypto/rand/rand_unix.go.html#4014665">err</a></span>&nbsp;<span class="op" id="4014814">!=</span>&nbsp;<span class="ident" id="4014817">nil</span>&nbsp;<span class="op" id="4014821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014827">return</span>&nbsp;<span class="ident" id="4014834"><a href="/crypto/rand/rand_unix.go.html#4014553">n</a></span>&nbsp;<span class="op" id="4014836">-</span>&nbsp;<span class="builtinfunc" id="4014838">len</span><span class="op" id="4014841">(</span><span class="ident" id="4014842"><a href="/crypto/rand/rand_unix.go.html#4014542">b</a></span><span class="op" id="4014843">)</span><span class="op" id="4014844">,</span>&nbsp;<span class="ident" id="4014846"><a href="/crypto/rand/rand_unix.go.html#4014665">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014858"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4014859">.</span><span class="ident" id="4014860">cipher</span><span class="op" id="4014866">,</span>&nbsp;<span class="ident" id="4014868"><a href="/crypto/rand/rand_unix.go.html#4014665">err</a></span>&nbsp;<span class="op" id="4014872">=</span>&nbsp;<span class="ident" id="4014874"><a href="/crypto/rand/rand_unix.go.html#4012596">aes</a></span><span class="op" id="4014877">.</span><span class="ident" id="4014878">NewCipher</span><span class="op" id="4014887">(</span><span class="ident" id="4014888"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4014889">.</span><span class="ident" id="4014890">key</span><span class="op" id="4014893">[</span><span class="num" id="4014894">0</span><span class="op" id="4014895">:</span><span class="op" id="4014896">]</span><span class="op" id="4014897">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014902">if</span>&nbsp;<span class="ident" id="4014905"><a href="/crypto/rand/rand_unix.go.html#4014665">err</a></span>&nbsp;<span class="op" id="4014909">!=</span>&nbsp;<span class="ident" id="4014912">nil</span>&nbsp;<span class="op" id="4014916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014922">return</span>&nbsp;<span class="ident" id="4014929"><a href="/crypto/rand/rand_unix.go.html#4014553">n</a></span>&nbsp;<span class="op" id="4014931">-</span>&nbsp;<span class="builtinfunc" id="4014933">len</span><span class="op" id="4014936">(</span><span class="ident" id="4014937"><a href="/crypto/rand/rand_unix.go.html#4014542">b</a></span><span class="op" id="4014938">)</span><span class="op" id="4014939">,</span>&nbsp;<span class="ident" id="4014941"><a href="/crypto/rand/rand_unix.go.html#4014665">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014953"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4014954">.</span><span class="ident" id="4014955">budget</span>&nbsp;<span class="op" id="4014962">=</span>&nbsp;<span class="num" id="4014964">1</span>&nbsp;<span class="op" id="4014966">&lt;&lt;</span>&nbsp;<span class="num" id="4014969">20</span>&nbsp;<span class="comment" id="4014972">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015005">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015009"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015010">.</span><span class="ident" id="4015011">budget</span>&nbsp;<span class="op" id="4015018">-=</span>&nbsp;<span class="ident" id="4015021"><a href="/crypto/rand/rand_unix.go.html#4012596">aes</a></span><span class="op" id="4015024">.</span><span class="ident" id="4015025">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4015038">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4015108">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4015113">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4015132">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4015155">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4015182">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015209">ns</span>&nbsp;<span class="op" id="4015212">:=</span>&nbsp;<span class="ident" id="4015215"><a href="/crypto/rand/rand_unix.go.html#4012658">time</a></span><span class="op" id="4015219">.</span><span class="ident" id="4015220">Now</span><span class="op" id="4015223">(</span><span class="op" id="4015224">)</span><span class="op" id="4015225">.</span><span class="ident" id="4015226">UnixNano</span><span class="op" id="4015234">(</span><span class="op" id="4015235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015239"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015240">.</span><span class="ident" id="4015241">time</span><span class="op" id="4015245">[</span><span class="num" id="4015246">0</span><span class="op" id="4015247">]</span>&nbsp;<span class="op" id="4015249">=</span>&nbsp;<span class="builtintype" id="4015251">byte</span><span class="op" id="4015255">(</span><span class="ident" id="4015256"><a href="/crypto/rand/rand_unix.go.html#4015209">ns</a></span>&nbsp;<span class="op" id="4015259">&gt;&gt;</span>&nbsp;<span class="num" id="4015262">56</span><span class="op" id="4015264">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015268"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015269">.</span><span class="ident" id="4015270">time</span><span class="op" id="4015274">[</span><span class="num" id="4015275">1</span><span class="op" id="4015276">]</span>&nbsp;<span class="op" id="4015278">=</span>&nbsp;<span class="builtintype" id="4015280">byte</span><span class="op" id="4015284">(</span><span class="ident" id="4015285"><a href="/crypto/rand/rand_unix.go.html#4015209">ns</a></span>&nbsp;<span class="op" id="4015288">&gt;&gt;</span>&nbsp;<span class="num" id="4015291">48</span><span class="op" id="4015293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015297"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015298">.</span><span class="ident" id="4015299">time</span><span class="op" id="4015303">[</span><span class="num" id="4015304">2</span><span class="op" id="4015305">]</span>&nbsp;<span class="op" id="4015307">=</span>&nbsp;<span class="builtintype" id="4015309">byte</span><span class="op" id="4015313">(</span><span class="ident" id="4015314"><a href="/crypto/rand/rand_unix.go.html#4015209">ns</a></span>&nbsp;<span class="op" id="4015317">&gt;&gt;</span>&nbsp;<span class="num" id="4015320">40</span><span class="op" id="4015322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015326"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015327">.</span><span class="ident" id="4015328">time</span><span class="op" id="4015332">[</span><span class="num" id="4015333">3</span><span class="op" id="4015334">]</span>&nbsp;<span class="op" id="4015336">=</span>&nbsp;<span class="builtintype" id="4015338">byte</span><span class="op" id="4015342">(</span><span class="ident" id="4015343"><a href="/crypto/rand/rand_unix.go.html#4015209">ns</a></span>&nbsp;<span class="op" id="4015346">&gt;&gt;</span>&nbsp;<span class="num" id="4015349">32</span><span class="op" id="4015351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015355"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015356">.</span><span class="ident" id="4015357">time</span><span class="op" id="4015361">[</span><span class="num" id="4015362">4</span><span class="op" id="4015363">]</span>&nbsp;<span class="op" id="4015365">=</span>&nbsp;<span class="builtintype" id="4015367">byte</span><span class="op" id="4015371">(</span><span class="ident" id="4015372"><a href="/crypto/rand/rand_unix.go.html#4015209">ns</a></span>&nbsp;<span class="op" id="4015375">&gt;&gt;</span>&nbsp;<span class="num" id="4015378">24</span><span class="op" id="4015380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015384"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015385">.</span><span class="ident" id="4015386">time</span><span class="op" id="4015390">[</span><span class="num" id="4015391">5</span><span class="op" id="4015392">]</span>&nbsp;<span class="op" id="4015394">=</span>&nbsp;<span class="builtintype" id="4015396">byte</span><span class="op" id="4015400">(</span><span class="ident" id="4015401"><a href="/crypto/rand/rand_unix.go.html#4015209">ns</a></span>&nbsp;<span class="op" id="4015404">&gt;&gt;</span>&nbsp;<span class="num" id="4015407">16</span><span class="op" id="4015409">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015413"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015414">.</span><span class="ident" id="4015415">time</span><span class="op" id="4015419">[</span><span class="num" id="4015420">6</span><span class="op" id="4015421">]</span>&nbsp;<span class="op" id="4015423">=</span>&nbsp;<span class="builtintype" id="4015425">byte</span><span class="op" id="4015429">(</span><span class="ident" id="4015430"><a href="/crypto/rand/rand_unix.go.html#4015209">ns</a></span>&nbsp;<span class="op" id="4015433">&gt;&gt;</span>&nbsp;<span class="num" id="4015436">8</span><span class="op" id="4015437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015441"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015442">.</span><span class="ident" id="4015443">time</span><span class="op" id="4015447">[</span><span class="num" id="4015448">7</span><span class="op" id="4015449">]</span>&nbsp;<span class="op" id="4015451">=</span>&nbsp;<span class="builtintype" id="4015453">byte</span><span class="op" id="4015457">(</span><span class="ident" id="4015458"><a href="/crypto/rand/rand_unix.go.html#4015209">ns</a></span><span class="op" id="4015460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015464"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015465">.</span><span class="ident" id="4015466">cipher</span><span class="op" id="4015472">.</span><span class="ident" id="4015473">Encrypt</span><span class="op" id="4015480">(</span><span class="ident" id="4015481"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015482">.</span><span class="ident" id="4015483">time</span><span class="op" id="4015487">[</span><span class="num" id="4015488">0</span><span class="op" id="4015489">:</span><span class="op" id="4015490">]</span><span class="op" id="4015491">,</span>&nbsp;<span class="ident" id="4015493"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015494">.</span><span class="ident" id="4015495">time</span><span class="op" id="4015499">[</span><span class="num" id="4015500">0</span><span class="op" id="4015501">:</span><span class="op" id="4015502">]</span><span class="op" id="4015503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015507">for</span>&nbsp;<span class="ident" id="4015511">i</span>&nbsp;<span class="op" id="4015513">:=</span>&nbsp;<span class="num" id="4015516">0</span><span class="op" id="4015517">;</span>&nbsp;<span class="ident" id="4015519"><a href="/crypto/rand/rand_unix.go.html#4015511">i</a></span>&nbsp;<span class="op" id="4015521">&lt;</span>&nbsp;<span class="ident" id="4015523"><a href="/crypto/rand/rand_unix.go.html#4012596">aes</a></span><span class="op" id="4015526">.</span><span class="ident" id="4015527">BlockSize</span><span class="op" id="4015536">;</span>&nbsp;<span class="ident" id="4015538"><a href="/crypto/rand/rand_unix.go.html#4015511">i</a></span><span class="op" id="4015539">++</span>&nbsp;<span class="op" id="4015542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015547"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015548">.</span><span class="ident" id="4015549">dst</span><span class="op" id="4015552">[</span><span class="ident" id="4015553"><a href="/crypto/rand/rand_unix.go.html#4015511">i</a></span><span class="op" id="4015554">]</span>&nbsp;<span class="op" id="4015556">=</span>&nbsp;<span class="ident" id="4015558"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015559">.</span><span class="ident" id="4015560">time</span><span class="op" id="4015564">[</span><span class="ident" id="4015565"><a href="/crypto/rand/rand_unix.go.html#4015511">i</a></span><span class="op" id="4015566">]</span>&nbsp;<span class="op" id="4015568">^</span>&nbsp;<span class="ident" id="4015570"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015571">.</span><span class="ident" id="4015572">seed</span><span class="op" id="4015576">[</span><span class="ident" id="4015577"><a href="/crypto/rand/rand_unix.go.html#4015511">i</a></span><span class="op" id="4015578">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015586"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015587">.</span><span class="ident" id="4015588">cipher</span><span class="op" id="4015594">.</span><span class="ident" id="4015595">Encrypt</span><span class="op" id="4015602">(</span><span class="ident" id="4015603"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015604">.</span><span class="ident" id="4015605">dst</span><span class="op" id="4015608">[</span><span class="num" id="4015609">0</span><span class="op" id="4015610">:</span><span class="op" id="4015611">]</span><span class="op" id="4015612">,</span>&nbsp;<span class="ident" id="4015614"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015615">.</span><span class="ident" id="4015616">dst</span><span class="op" id="4015619">[</span><span class="num" id="4015620">0</span><span class="op" id="4015621">:</span><span class="op" id="4015622">]</span><span class="op" id="4015623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015627">for</span>&nbsp;<span class="ident" id="4015631">i</span>&nbsp;<span class="op" id="4015633">:=</span>&nbsp;<span class="num" id="4015636">0</span><span class="op" id="4015637">;</span>&nbsp;<span class="ident" id="4015639"><a href="/crypto/rand/rand_unix.go.html#4015631">i</a></span>&nbsp;<span class="op" id="4015641">&lt;</span>&nbsp;<span class="ident" id="4015643"><a href="/crypto/rand/rand_unix.go.html#4012596">aes</a></span><span class="op" id="4015646">.</span><span class="ident" id="4015647">BlockSize</span><span class="op" id="4015656">;</span>&nbsp;<span class="ident" id="4015658"><a href="/crypto/rand/rand_unix.go.html#4015631">i</a></span><span class="op" id="4015659">++</span>&nbsp;<span class="op" id="4015662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015667"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015668">.</span><span class="ident" id="4015669">seed</span><span class="op" id="4015673">[</span><span class="ident" id="4015674"><a href="/crypto/rand/rand_unix.go.html#4015631">i</a></span><span class="op" id="4015675">]</span>&nbsp;<span class="op" id="4015677">=</span>&nbsp;<span class="ident" id="4015679"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015680">.</span><span class="ident" id="4015681">time</span><span class="op" id="4015685">[</span><span class="ident" id="4015686"><a href="/crypto/rand/rand_unix.go.html#4015631">i</a></span><span class="op" id="4015687">]</span>&nbsp;<span class="op" id="4015689">^</span>&nbsp;<span class="ident" id="4015691"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015692">.</span><span class="ident" id="4015693">dst</span><span class="op" id="4015696">[</span><span class="ident" id="4015697"><a href="/crypto/rand/rand_unix.go.html#4015631">i</a></span><span class="op" id="4015698">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015702">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015706"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015707">.</span><span class="ident" id="4015708">cipher</span><span class="op" id="4015714">.</span><span class="ident" id="4015715">Encrypt</span><span class="op" id="4015722">(</span><span class="ident" id="4015723"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015724">.</span><span class="ident" id="4015725">seed</span><span class="op" id="4015729">[</span><span class="num" id="4015730">0</span><span class="op" id="4015731">:</span><span class="op" id="4015732">]</span><span class="op" id="4015733">,</span>&nbsp;<span class="ident" id="4015735"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015736">.</span><span class="ident" id="4015737">seed</span><span class="op" id="4015741">[</span><span class="num" id="4015742">0</span><span class="op" id="4015743">:</span><span class="op" id="4015744">]</span><span class="op" id="4015745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015750">m</span>&nbsp;<span class="op" id="4015752">:=</span>&nbsp;<span class="builtinfunc" id="4015755">copy</span><span class="op" id="4015759">(</span><span class="ident" id="4015760"><a href="/crypto/rand/rand_unix.go.html#4014542">b</a></span><span class="op" id="4015761">,</span>&nbsp;<span class="ident" id="4015763"><a href="/crypto/rand/rand_unix.go.html#4014526">r</a></span><span class="op" id="4015764">.</span><span class="ident" id="4015765">dst</span><span class="op" id="4015768">[</span><span class="num" id="4015769">0</span><span class="op" id="4015770">:</span><span class="op" id="4015771">]</span><span class="op" id="4015772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015776"><a href="/crypto/rand/rand_unix.go.html#4014542">b</a></span>&nbsp;<span class="op" id="4015778">=</span>&nbsp;<span class="ident" id="4015780"><a href="/crypto/rand/rand_unix.go.html#4014542">b</a></span><span class="op" id="4015781">[</span><span class="ident" id="4015782"><a href="/crypto/rand/rand_unix.go.html#4015750">m</a></span><span class="op" id="4015783">:</span><span class="op" id="4015784">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015787">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015791">return</span>&nbsp;<span class="ident" id="4015798"><a href="/crypto/rand/rand_unix.go.html#4014553">n</a></span><span class="op" id="4015799">,</span>&nbsp;<span class="ident" id="4015801">nil</span><br>
<span class="lineno"></span><span class="op" id="4015805">}</span>
</div>
</body>
</html>
