<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5112009">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5112064">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5112118">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5112169">package</span>&nbsp;<span class="ident" id="5112177">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5112187">import</span>&nbsp;<span class="op" id="5112194">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5112197">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="5112203">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="5112206">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5112283">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="5112353">//</span><br>
<span class="lineno"></span><span class="comment" id="5112356">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5112431">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5112474">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="5112524">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="5112562">type</span>&nbsp;<span class="ident" id="5112567">context</span>&nbsp;<span class="keyword" id="5112575">struct</span>&nbsp;<span class="op" id="5112582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112585">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5112593">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112600">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5112608">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112615">urlPart</span>&nbsp;<span class="ident" id="5112623">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112632">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5112640">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112647">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5112655">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112661">element</span>&nbsp;<span class="ident" id="5112669">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112678">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5112686">*</span><span class="ident" id="5112687">Error</span><br>
<span class="lineno"></span><span class="op" id="5112693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5112696">func</span>&nbsp;<span class="op" id="5112701">(</span><span class="ident" id="5112702">c</span>&nbsp;<span class="ident" id="5112704">context</span><span class="op" id="5112711">)</span>&nbsp;<span class="ident" id="5112713">String</span><span class="op" id="5112719">(</span><span class="op" id="5112720">)</span>&nbsp;<span class="builtintype" id="5112722">string</span>&nbsp;<span class="op" id="5112729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112732">return</span>&nbsp;<span class="ident" id="5112739">fmt</span><span class="op" id="5112742">.</span><span class="ident" id="5112743">Sprintf</span><span class="op" id="5112750">(</span><span class="string" id="5112751">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="5112775">,</span>&nbsp;<span class="ident" id="5112777">c</span><span class="op" id="5112778">.</span><span class="ident" id="5112779">state</span><span class="op" id="5112784">,</span>&nbsp;<span class="ident" id="5112786">c</span><span class="op" id="5112787">.</span><span class="ident" id="5112788">delim</span><span class="op" id="5112793">,</span>&nbsp;<span class="ident" id="5112795">c</span><span class="op" id="5112796">.</span><span class="ident" id="5112797">urlPart</span><span class="op" id="5112804">,</span>&nbsp;<span class="ident" id="5112806">c</span><span class="op" id="5112807">.</span><span class="ident" id="5112808">jsCtx</span><span class="op" id="5112813">,</span>&nbsp;<span class="ident" id="5112815">c</span><span class="op" id="5112816">.</span><span class="ident" id="5112817">attr</span><span class="op" id="5112821">,</span>&nbsp;<span class="ident" id="5112823">c</span><span class="op" id="5112824">.</span><span class="ident" id="5112825">element</span><span class="op" id="5112832">,</span>&nbsp;<span class="ident" id="5112834">c</span><span class="op" id="5112835">.</span><span class="ident" id="5112836">err</span><span class="op" id="5112839">)</span><br>
<span class="lineno">30</span><span class="op" id="5112841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5112844">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="5112890">func</span>&nbsp;<span class="op" id="5112895">(</span><span class="ident" id="5112896">c</span>&nbsp;<span class="ident" id="5112898">context</span><span class="op" id="5112905">)</span>&nbsp;<span class="ident" id="5112907">eq</span><span class="op" id="5112909">(</span><span class="ident" id="5112910">d</span>&nbsp;<span class="ident" id="5112912">context</span><span class="op" id="5112919">)</span>&nbsp;<span class="builtintype" id="5112921">bool</span>&nbsp;<span class="op" id="5112926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5112929">return</span>&nbsp;<span class="ident" id="5112936">c</span><span class="op" id="5112937">.</span><span class="ident" id="5112938">state</span>&nbsp;<span class="op" id="5112944">==</span>&nbsp;<span class="ident" id="5112947">d</span><span class="op" id="5112948">.</span><span class="ident" id="5112949">state</span>&nbsp;<span class="op" id="5112955">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112960">c</span><span class="op" id="5112961">.</span><span class="ident" id="5112962">delim</span>&nbsp;<span class="op" id="5112968">==</span>&nbsp;<span class="ident" id="5112971">d</span><span class="op" id="5112972">.</span><span class="ident" id="5112973">delim</span>&nbsp;<span class="op" id="5112979">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5112984">c</span><span class="op" id="5112985">.</span><span class="ident" id="5112986">urlPart</span>&nbsp;<span class="op" id="5112994">==</span>&nbsp;<span class="ident" id="5112997">d</span><span class="op" id="5112998">.</span><span class="ident" id="5112999">urlPart</span>&nbsp;<span class="op" id="5113007">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113012">c</span><span class="op" id="5113013">.</span><span class="ident" id="5113014">jsCtx</span>&nbsp;<span class="op" id="5113020">==</span>&nbsp;<span class="ident" id="5113023">d</span><span class="op" id="5113024">.</span><span class="ident" id="5113025">jsCtx</span>&nbsp;<span class="op" id="5113031">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113036">c</span><span class="op" id="5113037">.</span><span class="ident" id="5113038">attr</span>&nbsp;<span class="op" id="5113043">==</span>&nbsp;<span class="ident" id="5113046">d</span><span class="op" id="5113047">.</span><span class="ident" id="5113048">attr</span>&nbsp;<span class="op" id="5113053">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113058">c</span><span class="op" id="5113059">.</span><span class="ident" id="5113060">element</span>&nbsp;<span class="op" id="5113068">==</span>&nbsp;<span class="ident" id="5113071">d</span><span class="op" id="5113072">.</span><span class="ident" id="5113073">element</span>&nbsp;<span class="op" id="5113081">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113086">c</span><span class="op" id="5113087">.</span><span class="ident" id="5113088">err</span>&nbsp;<span class="op" id="5113092">==</span>&nbsp;<span class="ident" id="5113095">d</span><span class="op" id="5113096">.</span><span class="ident" id="5113097">err</span><br>
<span class="lineno"></span><span class="op" id="5113101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5113104">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5113182">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="5113238">func</span>&nbsp;<span class="op" id="5113243">(</span><span class="ident" id="5113244">c</span>&nbsp;<span class="ident" id="5113246">context</span><span class="op" id="5113253">)</span>&nbsp;<span class="ident" id="5113255">mangle</span><span class="op" id="5113261">(</span><span class="ident" id="5113262">templateName</span>&nbsp;<span class="builtintype" id="5113275">string</span><span class="op" id="5113281">)</span>&nbsp;<span class="builtintype" id="5113283">string</span>&nbsp;<span class="op" id="5113290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5113293">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113365">if</span>&nbsp;<span class="ident" id="5113368">c</span><span class="op" id="5113369">.</span><span class="ident" id="5113370">state</span>&nbsp;<span class="op" id="5113376">==</span>&nbsp;<span class="ident" id="5113379">stateText</span>&nbsp;<span class="op" id="5113389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113393">return</span>&nbsp;<span class="ident" id="5113400">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5113414">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113417">s</span>&nbsp;<span class="op" id="5113419">:=</span>&nbsp;<span class="ident" id="5113422">templateName</span>&nbsp;<span class="op" id="5113435">+</span>&nbsp;<span class="string" id="5113437">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="5113454">+</span>&nbsp;<span class="ident" id="5113456">c</span><span class="op" id="5113457">.</span><span class="ident" id="5113458">state</span><span class="op" id="5113463">.</span><span class="ident" id="5113464">String</span><span class="op" id="5113470">(</span><span class="op" id="5113471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113474">if</span>&nbsp;<span class="ident" id="5113477">c</span><span class="op" id="5113478">.</span><span class="ident" id="5113479">delim</span>&nbsp;<span class="op" id="5113485">!=</span>&nbsp;<span class="num" id="5113488">0</span>&nbsp;<span class="op" id="5113490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113494">s</span>&nbsp;<span class="op" id="5113496">+=</span>&nbsp;<span class="string" id="5113499">&#34;_&#34;</span>&nbsp;<span class="op" id="5113503">+</span>&nbsp;<span class="ident" id="5113505">c</span><span class="op" id="5113506">.</span><span class="ident" id="5113507">delim</span><span class="op" id="5113512">.</span><span class="ident" id="5113513">String</span><span class="op" id="5113519">(</span><span class="op" id="5113520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5113523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113526">if</span>&nbsp;<span class="ident" id="5113529">c</span><span class="op" id="5113530">.</span><span class="ident" id="5113531">urlPart</span>&nbsp;<span class="op" id="5113539">!=</span>&nbsp;<span class="num" id="5113542">0</span>&nbsp;<span class="op" id="5113544">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113548">s</span>&nbsp;<span class="op" id="5113550">+=</span>&nbsp;<span class="string" id="5113553">&#34;_&#34;</span>&nbsp;<span class="op" id="5113557">+</span>&nbsp;<span class="ident" id="5113559">c</span><span class="op" id="5113560">.</span><span class="ident" id="5113561">urlPart</span><span class="op" id="5113568">.</span><span class="ident" id="5113569">String</span><span class="op" id="5113575">(</span><span class="op" id="5113576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5113579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113582">if</span>&nbsp;<span class="ident" id="5113585">c</span><span class="op" id="5113586">.</span><span class="ident" id="5113587">jsCtx</span>&nbsp;<span class="op" id="5113593">!=</span>&nbsp;<span class="num" id="5113596">0</span>&nbsp;<span class="op" id="5113598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113602">s</span>&nbsp;<span class="op" id="5113604">+=</span>&nbsp;<span class="string" id="5113607">&#34;_&#34;</span>&nbsp;<span class="op" id="5113611">+</span>&nbsp;<span class="ident" id="5113613">c</span><span class="op" id="5113614">.</span><span class="ident" id="5113615">jsCtx</span><span class="op" id="5113620">.</span><span class="ident" id="5113621">String</span><span class="op" id="5113627">(</span><span class="op" id="5113628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5113631">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113634">if</span>&nbsp;<span class="ident" id="5113637">c</span><span class="op" id="5113638">.</span><span class="ident" id="5113639">attr</span>&nbsp;<span class="op" id="5113644">!=</span>&nbsp;<span class="num" id="5113647">0</span>&nbsp;<span class="op" id="5113649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113653">s</span>&nbsp;<span class="op" id="5113655">+=</span>&nbsp;<span class="string" id="5113658">&#34;_&#34;</span>&nbsp;<span class="op" id="5113662">+</span>&nbsp;<span class="ident" id="5113664">c</span><span class="op" id="5113665">.</span><span class="ident" id="5113666">attr</span><span class="op" id="5113670">.</span><span class="ident" id="5113671">String</span><span class="op" id="5113677">(</span><span class="op" id="5113678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5113681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113684">if</span>&nbsp;<span class="ident" id="5113687">c</span><span class="op" id="5113688">.</span><span class="ident" id="5113689">element</span>&nbsp;<span class="op" id="5113697">!=</span>&nbsp;<span class="num" id="5113700">0</span>&nbsp;<span class="op" id="5113702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5113706">s</span>&nbsp;<span class="op" id="5113708">+=</span>&nbsp;<span class="string" id="5113711">&#34;_&#34;</span>&nbsp;<span class="op" id="5113715">+</span>&nbsp;<span class="ident" id="5113717">c</span><span class="op" id="5113718">.</span><span class="ident" id="5113719">element</span><span class="op" id="5113726">.</span><span class="ident" id="5113727">String</span><span class="op" id="5113733">(</span><span class="op" id="5113734">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5113737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5113740">return</span>&nbsp;<span class="ident" id="5113747">s</span><br>
<span class="lineno"></span><span class="op" id="5113749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5113752">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="5113803">//</span><br>
<span class="lineno"></span><span class="comment" id="5113806">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="5113885">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5113962">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="5114035">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="5114115">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5114145">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="5114183">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="5114261">type</span>&nbsp;<span class="ident" id="5114266">state</span>&nbsp;<span class="builtintype" id="5114272">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="5114279">const</span>&nbsp;<span class="op" id="5114285">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114288">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114349">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114412">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5114462">stateText</span>&nbsp;<span class="ident" id="5114472">state</span>&nbsp;<span class="op" id="5114478">=</span>&nbsp;<span class="ident" id="5114480">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114486">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5114552">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114562">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114613">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5114665">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114680">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114750">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5114815">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114831">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114903">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5114955">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5114973">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115030">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115044">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115116">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115186">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115199">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115268">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115279">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115348">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115358">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115420">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115429">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115495">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115509">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115575">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115589">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115650">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115665">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115733">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115750">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115813">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115829">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115894">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115904">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5115964">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5115979">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116039">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5116054">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116118">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5116133">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116197">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5116212">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116267">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5116280">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116342">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5116360">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116417">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5116434">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5116496">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116523">stateError</span><br>
<span class="lineno"></span><span class="op" id="5116534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5116537">var</span>&nbsp;<span class="ident" id="5116541">stateNames</span>&nbsp;<span class="op" id="5116552">=</span>&nbsp;<span class="op" id="5116554">[</span><span class="op" id="5116555">...</span><span class="op" id="5116558">]</span><span class="builtintype" id="5116559">string</span><span class="op" id="5116565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116568">stateText</span><span class="op" id="5116577">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116586">&#34;stateText&#34;</span><span class="op" id="5116597">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116600">stateTag</span><span class="op" id="5116608">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116618">&#34;stateTag&#34;</span><span class="op" id="5116628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116631">stateAttrName</span><span class="op" id="5116644">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116649">&#34;stateAttrName&#34;</span><span class="op" id="5116664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116667">stateAfterName</span><span class="op" id="5116681">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5116685">&#34;stateAfterName&#34;</span><span class="op" id="5116701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116704">stateBeforeValue</span><span class="op" id="5116720">:</span>&nbsp;<span class="string" id="5116722">&#34;stateBeforeValue&#34;</span><span class="op" id="5116740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116743">stateHTMLCmt</span><span class="op" id="5116755">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116761">&#34;stateHTMLCmt&#34;</span><span class="op" id="5116775">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116778">stateRCDATA</span><span class="op" id="5116789">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116796">&#34;stateRCDATA&#34;</span><span class="op" id="5116809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116812">stateAttr</span><span class="op" id="5116821">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116830">&#34;stateAttr&#34;</span><span class="op" id="5116841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116844">stateURL</span><span class="op" id="5116852">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116862">&#34;stateURL&#34;</span><span class="op" id="5116872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116875">stateJS</span><span class="op" id="5116882">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116893">&#34;stateJS&#34;</span><span class="op" id="5116902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116905">stateJSDqStr</span><span class="op" id="5116917">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116923">&#34;stateJSDqStr&#34;</span><span class="op" id="5116937">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116940">stateJSSqStr</span><span class="op" id="5116952">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116958">&#34;stateJSSqStr&#34;</span><span class="op" id="5116972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5116975">stateJSRegexp</span><span class="op" id="5116988">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5116993">&#34;stateJSRegexp&#34;</span><span class="op" id="5117008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117011">stateJSBlockCmt</span><span class="op" id="5117026">:</span>&nbsp;&nbsp;<span class="string" id="5117029">&#34;stateJSBlockCmt&#34;</span><span class="op" id="5117046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117049">stateJSLineCmt</span><span class="op" id="5117063">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5117067">&#34;stateJSLineCmt&#34;</span><span class="op" id="5117083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117086">stateCSS</span><span class="op" id="5117094">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5117104">&#34;stateCSS&#34;</span><span class="op" id="5117114">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117117">stateCSSDqStr</span><span class="op" id="5117130">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5117135">&#34;stateCSSDqStr&#34;</span><span class="op" id="5117150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117153">stateCSSSqStr</span><span class="op" id="5117166">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5117171">&#34;stateCSSSqStr&#34;</span><span class="op" id="5117186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117189">stateCSSDqURL</span><span class="op" id="5117202">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5117207">&#34;stateCSSDqURL&#34;</span><span class="op" id="5117222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117225">stateCSSSqURL</span><span class="op" id="5117238">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5117243">&#34;stateCSSSqURL&#34;</span><span class="op" id="5117258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117261">stateCSSURL</span><span class="op" id="5117272">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5117279">&#34;stateCSSURL&#34;</span><span class="op" id="5117292">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117295">stateCSSBlockCmt</span><span class="op" id="5117311">:</span>&nbsp;<span class="string" id="5117313">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="5117331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117334">stateCSSLineCmt</span><span class="op" id="5117349">:</span>&nbsp;&nbsp;<span class="string" id="5117352">&#34;stateCSSLineCmt&#34;</span><span class="op" id="5117369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117372">stateError</span><span class="op" id="5117382">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5117390">&#34;stateError&#34;</span><span class="op" id="5117402">,</span><br>
<span class="lineno"></span><span class="op" id="5117404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="5117407">func</span>&nbsp;<span class="op" id="5117412">(</span><span class="ident" id="5117413">s</span>&nbsp;<span class="ident" id="5117415">state</span><span class="op" id="5117420">)</span>&nbsp;<span class="ident" id="5117422">String</span><span class="op" id="5117428">(</span><span class="op" id="5117429">)</span>&nbsp;<span class="builtintype" id="5117431">string</span>&nbsp;<span class="op" id="5117438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5117441">if</span>&nbsp;<span class="builtintype" id="5117444">int</span><span class="op" id="5117447">(</span><span class="ident" id="5117448">s</span><span class="op" id="5117449">)</span>&nbsp;<span class="op" id="5117451">&lt;</span>&nbsp;<span class="builtinfunc" id="5117453">len</span><span class="op" id="5117456">(</span><span class="ident" id="5117457">stateNames</span><span class="op" id="5117467">)</span>&nbsp;<span class="op" id="5117469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5117473">return</span>&nbsp;<span class="ident" id="5117480">stateNames</span><span class="op" id="5117490">[</span><span class="ident" id="5117491">s</span><span class="op" id="5117492">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5117495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5117498">return</span>&nbsp;<span class="ident" id="5117505">fmt</span><span class="op" id="5117508">.</span><span class="ident" id="5117509">Sprintf</span><span class="op" id="5117516">(</span><span class="string" id="5117517">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="5117535">,</span>&nbsp;<span class="builtintype" id="5117537">int</span><span class="op" id="5117540">(</span><span class="ident" id="5117541">s</span><span class="op" id="5117542">)</span><span class="op" id="5117543">)</span><br>
<span class="lineno">170</span><span class="op" id="5117545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5117548">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5117624">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="5117681">func</span>&nbsp;<span class="ident" id="5117686">isComment</span><span class="op" id="5117695">(</span><span class="ident" id="5117696">s</span>&nbsp;<span class="ident" id="5117698">state</span><span class="op" id="5117703">)</span>&nbsp;<span class="builtintype" id="5117705">bool</span>&nbsp;<span class="op" id="5117710">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5117713">switch</span>&nbsp;<span class="ident" id="5117720">s</span>&nbsp;<span class="op" id="5117722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5117725">case</span>&nbsp;<span class="ident" id="5117730">stateHTMLCmt</span><span class="op" id="5117742">,</span>&nbsp;<span class="ident" id="5117744">stateJSBlockCmt</span><span class="op" id="5117759">,</span>&nbsp;<span class="ident" id="5117761">stateJSLineCmt</span><span class="op" id="5117775">,</span>&nbsp;<span class="ident" id="5117777">stateCSSBlockCmt</span><span class="op" id="5117793">,</span>&nbsp;<span class="ident" id="5117795">stateCSSLineCmt</span><span class="op" id="5117810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5117814">return</span>&nbsp;<span class="builtintype" id="5117821">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5117827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5117830">return</span>&nbsp;<span class="builtintype" id="5117837">false</span><br>
<span class="lineno">180</span><span class="op" id="5117843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5117846">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5117908">func</span>&nbsp;<span class="ident" id="5117913">isInTag</span><span class="op" id="5117920">(</span><span class="ident" id="5117921">s</span>&nbsp;<span class="ident" id="5117923">state</span><span class="op" id="5117928">)</span>&nbsp;<span class="builtintype" id="5117930">bool</span>&nbsp;<span class="op" id="5117935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5117938">switch</span>&nbsp;<span class="ident" id="5117945">s</span>&nbsp;<span class="op" id="5117947">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5117950">case</span>&nbsp;<span class="ident" id="5117955">stateTag</span><span class="op" id="5117963">,</span>&nbsp;<span class="ident" id="5117965">stateAttrName</span><span class="op" id="5117978">,</span>&nbsp;<span class="ident" id="5117980">stateAfterName</span><span class="op" id="5117994">,</span>&nbsp;<span class="ident" id="5117996">stateBeforeValue</span><span class="op" id="5118012">,</span>&nbsp;<span class="ident" id="5118014">stateAttr</span><span class="op" id="5118023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118027">return</span>&nbsp;<span class="builtintype" id="5118034">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5118040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118043">return</span>&nbsp;<span class="builtintype" id="5118050">false</span><br>
<span class="lineno"></span><span class="op" id="5118056">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5118059">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="5118127">type</span>&nbsp;<span class="ident" id="5118132">delim</span>&nbsp;<span class="builtintype" id="5118138">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5118145">const</span>&nbsp;<span class="op" id="5118151">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5118154">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118198">delimNone</span>&nbsp;<span class="ident" id="5118208">delim</span>&nbsp;<span class="op" id="5118214">=</span>&nbsp;<span class="ident" id="5118216">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5118222">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118296">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5118314">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118388">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5118406">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5118476">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118502">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="5118521">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="5118524">var</span>&nbsp;<span class="ident" id="5118528">delimNames</span>&nbsp;<span class="op" id="5118539">=</span>&nbsp;<span class="op" id="5118541">[</span><span class="op" id="5118542">...</span><span class="op" id="5118545">]</span><span class="builtintype" id="5118546">string</span><span class="op" id="5118552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118555">delimNone</span><span class="op" id="5118564">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5118575">&#34;delimNone&#34;</span><span class="op" id="5118586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118589">delimDoubleQuote</span><span class="op" id="5118605">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5118609">&#34;delimDoubleQuote&#34;</span><span class="op" id="5118627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118630">delimSingleQuote</span><span class="op" id="5118646">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5118650">&#34;delimSingleQuote&#34;</span><span class="op" id="5118668">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118671">delimSpaceOrTagEnd</span><span class="op" id="5118689">:</span>&nbsp;<span class="string" id="5118691">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="5118711">,</span><br>
<span class="lineno"></span><span class="op" id="5118713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5118716">func</span>&nbsp;<span class="op" id="5118721">(</span><span class="ident" id="5118722">d</span>&nbsp;<span class="ident" id="5118724">delim</span><span class="op" id="5118729">)</span>&nbsp;<span class="ident" id="5118731">String</span><span class="op" id="5118737">(</span><span class="op" id="5118738">)</span>&nbsp;<span class="builtintype" id="5118740">string</span>&nbsp;<span class="op" id="5118747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118750">if</span>&nbsp;<span class="builtintype" id="5118753">int</span><span class="op" id="5118756">(</span><span class="ident" id="5118757">d</span><span class="op" id="5118758">)</span>&nbsp;<span class="op" id="5118760">&lt;</span>&nbsp;<span class="builtinfunc" id="5118762">len</span><span class="op" id="5118765">(</span><span class="ident" id="5118766">delimNames</span><span class="op" id="5118776">)</span>&nbsp;<span class="op" id="5118778">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118782">return</span>&nbsp;<span class="ident" id="5118789">delimNames</span><span class="op" id="5118799">[</span><span class="ident" id="5118800">d</span><span class="op" id="5118801">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5118804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118807">return</span>&nbsp;<span class="ident" id="5118814">fmt</span><span class="op" id="5118817">.</span><span class="ident" id="5118818">Sprintf</span><span class="op" id="5118825">(</span><span class="string" id="5118826">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="5118844">,</span>&nbsp;<span class="builtintype" id="5118846">int</span><span class="op" id="5118849">(</span><span class="ident" id="5118850">d</span><span class="op" id="5118851">)</span><span class="op" id="5118852">)</span><br>
<span class="lineno"></span><span class="op" id="5118854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5118857">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="5118937">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="5118961">type</span>&nbsp;<span class="ident" id="5118966">urlPart</span>&nbsp;<span class="builtintype" id="5118974">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5118981">const</span>&nbsp;<span class="op" id="5118987">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5118990">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119058">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119097">urlPartNone</span>&nbsp;<span class="ident" id="5119109">urlPart</span>&nbsp;<span class="op" id="5119117">=</span>&nbsp;<span class="ident" id="5119119">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119125">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119199">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119240">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119257">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119326">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119361">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119381">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119450">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119481">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="5119496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5119499">var</span>&nbsp;<span class="ident" id="5119503">urlPartNames</span>&nbsp;<span class="op" id="5119516">=</span>&nbsp;<span class="op" id="5119518">[</span><span class="op" id="5119519">...</span><span class="op" id="5119522">]</span><span class="builtintype" id="5119523">string</span><span class="op" id="5119529">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119532">urlPartNone</span><span class="op" id="5119543">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5119552">&#34;urlPartNone&#34;</span><span class="op" id="5119565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119568">urlPartPreQuery</span><span class="op" id="5119583">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5119588">&#34;urlPartPreQuery&#34;</span><span class="op" id="5119605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119608">urlPartQueryOrFrag</span><span class="op" id="5119626">:</span>&nbsp;<span class="string" id="5119628">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="5119648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5119651">urlPartUnknown</span><span class="op" id="5119665">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5119671">&#34;urlPartUnknown&#34;</span><span class="op" id="5119687">,</span><br>
<span class="lineno"></span><span class="op" id="5119689">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="5119692">func</span>&nbsp;<span class="op" id="5119697">(</span><span class="ident" id="5119698">u</span>&nbsp;<span class="ident" id="5119700">urlPart</span><span class="op" id="5119707">)</span>&nbsp;<span class="ident" id="5119709">String</span><span class="op" id="5119715">(</span><span class="op" id="5119716">)</span>&nbsp;<span class="builtintype" id="5119718">string</span>&nbsp;<span class="op" id="5119725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5119728">if</span>&nbsp;<span class="builtintype" id="5119731">int</span><span class="op" id="5119734">(</span><span class="ident" id="5119735">u</span><span class="op" id="5119736">)</span>&nbsp;<span class="op" id="5119738">&lt;</span>&nbsp;<span class="builtinfunc" id="5119740">len</span><span class="op" id="5119743">(</span><span class="ident" id="5119744">urlPartNames</span><span class="op" id="5119756">)</span>&nbsp;<span class="op" id="5119758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5119762">return</span>&nbsp;<span class="ident" id="5119769">urlPartNames</span><span class="op" id="5119781">[</span><span class="ident" id="5119782">u</span><span class="op" id="5119783">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5119786">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5119789">return</span>&nbsp;<span class="ident" id="5119796">fmt</span><span class="op" id="5119799">.</span><span class="ident" id="5119800">Sprintf</span><span class="op" id="5119807">(</span><span class="string" id="5119808">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="5119828">,</span>&nbsp;<span class="builtintype" id="5119830">int</span><span class="op" id="5119833">(</span><span class="ident" id="5119834">u</span><span class="op" id="5119835">)</span><span class="op" id="5119836">)</span><br>
<span class="lineno"></span><span class="op" id="5119838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5119841">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5119916">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="5119938">type</span>&nbsp;<span class="ident" id="5119943">jsCtx</span>&nbsp;<span class="builtintype" id="5119949">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5119956">const</span>&nbsp;<span class="op" id="5119962">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5119965">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5120030">jsCtxRegexp</span>&nbsp;<span class="ident" id="5120042">jsCtx</span>&nbsp;<span class="op" id="5120048">=</span>&nbsp;<span class="ident" id="5120050">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120056">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5120123">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120135">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5120208">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="5120221">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="5120224">func</span>&nbsp;<span class="op" id="5120229">(</span><span class="ident" id="5120230">c</span>&nbsp;<span class="ident" id="5120232">jsCtx</span><span class="op" id="5120237">)</span>&nbsp;<span class="ident" id="5120239">String</span><span class="op" id="5120245">(</span><span class="op" id="5120246">)</span>&nbsp;<span class="builtintype" id="5120248">string</span>&nbsp;<span class="op" id="5120255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5120258">switch</span>&nbsp;<span class="ident" id="5120265">c</span>&nbsp;<span class="op" id="5120267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5120270">case</span>&nbsp;<span class="ident" id="5120275">jsCtxRegexp</span><span class="op" id="5120286">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5120290">return</span>&nbsp;<span class="string" id="5120297">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5120312">case</span>&nbsp;<span class="ident" id="5120317">jsCtxDivOp</span><span class="op" id="5120327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5120331">return</span>&nbsp;<span class="string" id="5120338">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5120352">case</span>&nbsp;<span class="ident" id="5120357">jsCtxUnknown</span><span class="op" id="5120369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5120373">return</span>&nbsp;<span class="string" id="5120380">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5120396">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5120399">return</span>&nbsp;<span class="ident" id="5120406">fmt</span><span class="op" id="5120409">.</span><span class="ident" id="5120410">Sprintf</span><span class="op" id="5120417">(</span><span class="string" id="5120418">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="5120436">,</span>&nbsp;<span class="builtintype" id="5120438">int</span><span class="op" id="5120441">(</span><span class="ident" id="5120442">c</span><span class="op" id="5120443">)</span><span class="op" id="5120444">)</span><br>
<span class="lineno"></span><span class="op" id="5120446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5120449">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="5120529">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="5120609">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5120683">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5120762">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5120793">type</span>&nbsp;<span class="ident" id="5120798">element</span>&nbsp;<span class="builtintype" id="5120806">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="5120813">const</span>&nbsp;<span class="op" id="5120819">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120822">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5120892">elementNone</span>&nbsp;<span class="ident" id="5120904">element</span>&nbsp;<span class="op" id="5120912">=</span>&nbsp;<span class="ident" id="5120914">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120920">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5120984">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5120999">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121061">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121075">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121141">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121158">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121218">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="5121231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5121234">var</span>&nbsp;<span class="ident" id="5121238">elementNames</span>&nbsp;<span class="op" id="5121251">=</span>&nbsp;<span class="op" id="5121253">[</span><span class="op" id="5121254">...</span><span class="op" id="5121257">]</span><span class="builtintype" id="5121258">string</span><span class="op" id="5121264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121267">elementNone</span><span class="op" id="5121278">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5121284">&#34;elementNone&#34;</span><span class="op" id="5121297">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121300">elementScript</span><span class="op" id="5121313">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5121317">&#34;elementScript&#34;</span><span class="op" id="5121332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121335">elementStyle</span><span class="op" id="5121347">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5121352">&#34;elementStyle&#34;</span><span class="op" id="5121366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121369">elementTextarea</span><span class="op" id="5121384">:</span>&nbsp;<span class="string" id="5121386">&#34;elementTextarea&#34;</span><span class="op" id="5121403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121406">elementTitle</span><span class="op" id="5121418">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5121423">&#34;elementTitle&#34;</span><span class="op" id="5121437">,</span><br>
<span class="lineno"></span><span class="op" id="5121439">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="5121442">func</span>&nbsp;<span class="op" id="5121447">(</span><span class="ident" id="5121448">e</span>&nbsp;<span class="ident" id="5121450">element</span><span class="op" id="5121457">)</span>&nbsp;<span class="ident" id="5121459">String</span><span class="op" id="5121465">(</span><span class="op" id="5121466">)</span>&nbsp;<span class="builtintype" id="5121468">string</span>&nbsp;<span class="op" id="5121475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5121478">if</span>&nbsp;<span class="builtintype" id="5121481">int</span><span class="op" id="5121484">(</span><span class="ident" id="5121485">e</span><span class="op" id="5121486">)</span>&nbsp;<span class="op" id="5121488">&lt;</span>&nbsp;<span class="builtinfunc" id="5121490">len</span><span class="op" id="5121493">(</span><span class="ident" id="5121494">elementNames</span><span class="op" id="5121506">)</span>&nbsp;<span class="op" id="5121508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5121512">return</span>&nbsp;<span class="ident" id="5121519">elementNames</span><span class="op" id="5121531">[</span><span class="ident" id="5121532">e</span><span class="op" id="5121533">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5121536">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5121539">return</span>&nbsp;<span class="ident" id="5121546">fmt</span><span class="op" id="5121549">.</span><span class="ident" id="5121550">Sprintf</span><span class="op" id="5121557">(</span><span class="string" id="5121558">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="5121578">,</span>&nbsp;<span class="builtintype" id="5121580">int</span><span class="op" id="5121583">(</span><span class="ident" id="5121584">e</span><span class="op" id="5121585">)</span><span class="op" id="5121586">)</span><br>
<span class="lineno"></span><span class="op" id="5121588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5121591">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5121666">type</span>&nbsp;<span class="ident" id="5121671">attr</span>&nbsp;<span class="builtintype" id="5121676">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="5121683">const</span>&nbsp;<span class="op" id="5121689">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121692">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121756">attrNone</span>&nbsp;<span class="ident" id="5121765">attr</span>&nbsp;<span class="op" id="5121770">=</span>&nbsp;<span class="ident" id="5121772">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121778">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121836">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121848">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121917">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5121928">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5121990">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="5121998">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5122001">var</span>&nbsp;<span class="ident" id="5122005">attrNames</span>&nbsp;<span class="op" id="5122015">=</span>&nbsp;<span class="op" id="5122017">[</span><span class="op" id="5122018">...</span><span class="op" id="5122021">]</span><span class="builtintype" id="5122022">string</span><span class="op" id="5122028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5122031">attrNone</span><span class="op" id="5122039">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5122043">&#34;attrNone&#34;</span><span class="op" id="5122053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5122056">attrScript</span><span class="op" id="5122066">:</span>&nbsp;<span class="string" id="5122068">&#34;attrScript&#34;</span><span class="op" id="5122080">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5122083">attrStyle</span><span class="op" id="5122092">:</span>&nbsp;&nbsp;<span class="string" id="5122095">&#34;attrStyle&#34;</span><span class="op" id="5122106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5122109">attrURL</span><span class="op" id="5122116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5122121">&#34;attrURL&#34;</span><span class="op" id="5122130">,</span><br>
<span class="lineno"></span><span class="op" id="5122132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5122135">func</span>&nbsp;<span class="op" id="5122140">(</span><span class="ident" id="5122141">a</span>&nbsp;<span class="ident" id="5122143">attr</span><span class="op" id="5122147">)</span>&nbsp;<span class="ident" id="5122149">String</span><span class="op" id="5122155">(</span><span class="op" id="5122156">)</span>&nbsp;<span class="builtintype" id="5122158">string</span>&nbsp;<span class="op" id="5122165">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5122168">if</span>&nbsp;<span class="builtintype" id="5122171">int</span><span class="op" id="5122174">(</span><span class="ident" id="5122175">a</span><span class="op" id="5122176">)</span>&nbsp;<span class="op" id="5122178">&lt;</span>&nbsp;<span class="builtinfunc" id="5122180">len</span><span class="op" id="5122183">(</span><span class="ident" id="5122184">attrNames</span><span class="op" id="5122193">)</span>&nbsp;<span class="op" id="5122195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5122199">return</span>&nbsp;<span class="ident" id="5122206">attrNames</span><span class="op" id="5122215">[</span><span class="ident" id="5122216">a</span><span class="op" id="5122217">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5122220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5122223">return</span>&nbsp;<span class="ident" id="5122230">fmt</span><span class="op" id="5122233">.</span><span class="ident" id="5122234">Sprintf</span><span class="op" id="5122241">(</span><span class="string" id="5122242">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="5122259">,</span>&nbsp;<span class="builtintype" id="5122261">int</span><span class="op" id="5122264">(</span><span class="ident" id="5122265">a</span><span class="op" id="5122266">)</span><span class="op" id="5122267">)</span><br>
<span class="lineno"></span><span class="op" id="5122269">}</span>
</div>
</body>
</html>
