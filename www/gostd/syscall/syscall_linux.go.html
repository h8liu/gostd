<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html" class="current">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2401936">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2401991">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2402045">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2402096">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2402119">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2402165">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2402203">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2402268">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2402325">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2402370">package</span>&nbsp;<span class="ident" id="2402378">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2402387">import</span>&nbsp;<span class="string" id="2402394">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2402404">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2402423">//sys&nbsp;&nbsp;&nbsp;&nbspopen(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2402491">func</span>&nbsp;<span class="ident" id="2402496">Open</span><span class="op" id="2402500">(</span><span class="ident" id="2402501">path</span>&nbsp;<span class="builtintype" id="2402506">string</span><span class="op" id="2402512">,</span>&nbsp;<span class="ident" id="2402514">mode</span>&nbsp;<span class="builtintype" id="2402519">int</span><span class="op" id="2402522">,</span>&nbsp;<span class="ident" id="2402524">perm</span>&nbsp;<span class="builtintype" id="2402529">uint32</span><span class="op" id="2402535">)</span>&nbsp;<span class="op" id="2402537">(</span><span class="ident" id="2402538">fd</span>&nbsp;<span class="builtintype" id="2402541">int</span><span class="op" id="2402544">,</span>&nbsp;<span class="ident" id="2402546">err</span>&nbsp;<span class="builtintype" id="2402550">error</span><span class="op" id="2402555">)</span>&nbsp;<span class="op" id="2402557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402560">return</span>&nbsp;<span class="ident" id="2402567">open</span><span class="op" id="2402571">(</span><span class="ident" id="2402572">path</span><span class="op" id="2402576">,</span>&nbsp;<span class="ident" id="2402578">mode</span><span class="op" id="2402582">|</span><span class="ident" id="2402583">O_LARGEFILE</span><span class="op" id="2402594">,</span>&nbsp;<span class="ident" id="2402596">perm</span><span class="op" id="2402600">)</span><br>
<span class="lineno"></span><span class="op" id="2402602">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2402605">//sys&nbsp;&nbsp;&nbsp;&nbspopenat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2402687">func</span>&nbsp;<span class="ident" id="2402692">Openat</span><span class="op" id="2402698">(</span><span class="ident" id="2402699">dirfd</span>&nbsp;<span class="builtintype" id="2402705">int</span><span class="op" id="2402708">,</span>&nbsp;<span class="ident" id="2402710">path</span>&nbsp;<span class="builtintype" id="2402715">string</span><span class="op" id="2402721">,</span>&nbsp;<span class="ident" id="2402723">flags</span>&nbsp;<span class="builtintype" id="2402729">int</span><span class="op" id="2402732">,</span>&nbsp;<span class="ident" id="2402734">mode</span>&nbsp;<span class="builtintype" id="2402739">uint32</span><span class="op" id="2402745">)</span>&nbsp;<span class="op" id="2402747">(</span><span class="ident" id="2402748">fd</span>&nbsp;<span class="builtintype" id="2402751">int</span><span class="op" id="2402754">,</span>&nbsp;<span class="ident" id="2402756">err</span>&nbsp;<span class="builtintype" id="2402760">error</span><span class="op" id="2402765">)</span>&nbsp;<span class="op" id="2402767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402770">return</span>&nbsp;<span class="ident" id="2402777">openat</span><span class="op" id="2402783">(</span><span class="ident" id="2402784">dirfd</span><span class="op" id="2402789">,</span>&nbsp;<span class="ident" id="2402791">path</span><span class="op" id="2402795">,</span>&nbsp;<span class="ident" id="2402797">flags</span><span class="op" id="2402802">|</span><span class="ident" id="2402803">O_LARGEFILE</span><span class="op" id="2402814">,</span>&nbsp;<span class="ident" id="2402816">mode</span><span class="op" id="2402820">)</span><br>
<span class="lineno">30</span><span class="op" id="2402822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2402825">//sysnb&nbsp;&nbsp;&nbsp;&nbsppipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2402865">func</span>&nbsp;<span class="ident" id="2402870">Pipe</span><span class="op" id="2402874">(</span><span class="ident" id="2402875">p</span>&nbsp;<span class="op" id="2402877">[</span><span class="op" id="2402878">]</span><span class="builtintype" id="2402879">int</span><span class="op" id="2402882">)</span>&nbsp;<span class="op" id="2402884">(</span><span class="ident" id="2402885">err</span>&nbsp;<span class="builtintype" id="2402889">error</span><span class="op" id="2402894">)</span>&nbsp;<span class="op" id="2402896">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402899">if</span>&nbsp;<span class="builtinfunc" id="2402902">len</span><span class="op" id="2402905">(</span><span class="ident" id="2402906">p</span><span class="op" id="2402907">)</span>&nbsp;<span class="op" id="2402909">!=</span>&nbsp;<span class="num" id="2402912">2</span>&nbsp;<span class="op" id="2402914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402918">return</span>&nbsp;<span class="ident" id="2402925">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2402933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2402936">var</span>&nbsp;<span class="ident" id="2402940">pp</span>&nbsp;<span class="op" id="2402943">[</span><span class="num" id="2402944">2</span><span class="op" id="2402945">]</span><span class="ident" id="2402946">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402954">err</span>&nbsp;<span class="op" id="2402958">=</span>&nbsp;<span class="ident" id="2402960">pipe</span><span class="op" id="2402964">(</span><span class="op" id="2402965">&amp;</span><span class="ident" id="2402966">pp</span><span class="op" id="2402968">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402971">p</span><span class="op" id="2402972">[</span><span class="num" id="2402973">0</span><span class="op" id="2402974">]</span>&nbsp;<span class="op" id="2402976">=</span>&nbsp;<span class="builtintype" id="2402978">int</span><span class="op" id="2402981">(</span><span class="ident" id="2402982">pp</span><span class="op" id="2402984">[</span><span class="num" id="2402985">0</span><span class="op" id="2402986">]</span><span class="op" id="2402987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2402990">p</span><span class="op" id="2402991">[</span><span class="num" id="2402992">1</span><span class="op" id="2402993">]</span>&nbsp;<span class="op" id="2402995">=</span>&nbsp;<span class="builtintype" id="2402997">int</span><span class="op" id="2403000">(</span><span class="ident" id="2403001">pp</span><span class="op" id="2403003">[</span><span class="num" id="2403004">1</span><span class="op" id="2403005">]</span><span class="op" id="2403006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403009">return</span><br>
<span class="lineno"></span><span class="op" id="2403016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2403019">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2403071">func</span>&nbsp;<span class="ident" id="2403076">Pipe2</span><span class="op" id="2403081">(</span><span class="ident" id="2403082">p</span>&nbsp;<span class="op" id="2403084">[</span><span class="op" id="2403085">]</span><span class="builtintype" id="2403086">int</span><span class="op" id="2403089">,</span>&nbsp;<span class="ident" id="2403091">flags</span>&nbsp;<span class="builtintype" id="2403097">int</span><span class="op" id="2403100">)</span>&nbsp;<span class="op" id="2403102">(</span><span class="ident" id="2403103">err</span>&nbsp;<span class="builtintype" id="2403107">error</span><span class="op" id="2403112">)</span>&nbsp;<span class="op" id="2403114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403117">if</span>&nbsp;<span class="builtinfunc" id="2403120">len</span><span class="op" id="2403123">(</span><span class="ident" id="2403124">p</span><span class="op" id="2403125">)</span>&nbsp;<span class="op" id="2403127">!=</span>&nbsp;<span class="num" id="2403130">2</span>&nbsp;<span class="op" id="2403132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403136">return</span>&nbsp;<span class="ident" id="2403143">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403154">var</span>&nbsp;<span class="ident" id="2403158">pp</span>&nbsp;<span class="op" id="2403161">[</span><span class="num" id="2403162">2</span><span class="op" id="2403163">]</span><span class="ident" id="2403164">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403172">err</span>&nbsp;<span class="op" id="2403176">=</span>&nbsp;<span class="ident" id="2403178">pipe2</span><span class="op" id="2403183">(</span><span class="op" id="2403184">&amp;</span><span class="ident" id="2403185">pp</span><span class="op" id="2403187">,</span>&nbsp;<span class="ident" id="2403189">flags</span><span class="op" id="2403194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403197">p</span><span class="op" id="2403198">[</span><span class="num" id="2403199">0</span><span class="op" id="2403200">]</span>&nbsp;<span class="op" id="2403202">=</span>&nbsp;<span class="builtintype" id="2403204">int</span><span class="op" id="2403207">(</span><span class="ident" id="2403208">pp</span><span class="op" id="2403210">[</span><span class="num" id="2403211">0</span><span class="op" id="2403212">]</span><span class="op" id="2403213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403216">p</span><span class="op" id="2403217">[</span><span class="num" id="2403218">1</span><span class="op" id="2403219">]</span>&nbsp;<span class="op" id="2403221">=</span>&nbsp;<span class="builtintype" id="2403223">int</span><span class="op" id="2403226">(</span><span class="ident" id="2403227">pp</span><span class="op" id="2403229">[</span><span class="num" id="2403230">1</span><span class="op" id="2403231">]</span><span class="op" id="2403232">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403235">return</span><br>
<span class="lineno"></span><span class="op" id="2403242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2403245">//sys&nbsp;&nbsp;&nbsp;&nbsputimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2403303">func</span>&nbsp;<span class="ident" id="2403308">Utimes</span><span class="op" id="2403314">(</span><span class="ident" id="2403315">path</span>&nbsp;<span class="builtintype" id="2403320">string</span><span class="op" id="2403326">,</span>&nbsp;<span class="ident" id="2403328">tv</span>&nbsp;<span class="op" id="2403331">[</span><span class="op" id="2403332">]</span><span class="ident" id="2403333">Timeval</span><span class="op" id="2403340">)</span>&nbsp;<span class="op" id="2403342">(</span><span class="ident" id="2403343">err</span>&nbsp;<span class="builtintype" id="2403347">error</span><span class="op" id="2403352">)</span>&nbsp;<span class="op" id="2403354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403357">if</span>&nbsp;<span class="builtinfunc" id="2403360">len</span><span class="op" id="2403363">(</span><span class="ident" id="2403364">tv</span><span class="op" id="2403366">)</span>&nbsp;<span class="op" id="2403368">!=</span>&nbsp;<span class="num" id="2403371">2</span>&nbsp;<span class="op" id="2403373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403377">return</span>&nbsp;<span class="ident" id="2403384">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403395">return</span>&nbsp;<span class="ident" id="2403402">utimes</span><span class="op" id="2403408">(</span><span class="ident" id="2403409">path</span><span class="op" id="2403413">,</span>&nbsp;<span class="op" id="2403415">(</span><span class="op" id="2403416">*</span><span class="op" id="2403417">[</span><span class="num" id="2403418">2</span><span class="op" id="2403419">]</span><span class="ident" id="2403420">Timeval</span><span class="op" id="2403427">)</span><span class="op" id="2403428">(</span><span class="ident" id="2403429">unsafe</span><span class="op" id="2403435">.</span><span class="ident" id="2403436">Pointer</span><span class="op" id="2403443">(</span><span class="op" id="2403444">&amp;</span><span class="ident" id="2403445">tv</span><span class="op" id="2403447">[</span><span class="num" id="2403448">0</span><span class="op" id="2403449">]</span><span class="op" id="2403450">)</span><span class="op" id="2403451">)</span><span class="op" id="2403452">)</span><br>
<span class="lineno">65</span><span class="op" id="2403454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2403457">//sys&nbsp;&nbsp;&nbsp;&nbsputimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2403530">func</span>&nbsp;<span class="ident" id="2403535">UtimesNano</span><span class="op" id="2403545">(</span><span class="ident" id="2403546">path</span>&nbsp;<span class="builtintype" id="2403551">string</span><span class="op" id="2403557">,</span>&nbsp;<span class="ident" id="2403559">ts</span>&nbsp;<span class="op" id="2403562">[</span><span class="op" id="2403563">]</span><span class="ident" id="2403564">Timespec</span><span class="op" id="2403572">)</span>&nbsp;<span class="op" id="2403574">(</span><span class="ident" id="2403575">err</span>&nbsp;<span class="builtintype" id="2403579">error</span><span class="op" id="2403584">)</span>&nbsp;<span class="op" id="2403586">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403589">if</span>&nbsp;<span class="builtinfunc" id="2403592">len</span><span class="op" id="2403595">(</span><span class="ident" id="2403596">ts</span><span class="op" id="2403598">)</span>&nbsp;<span class="op" id="2403600">!=</span>&nbsp;<span class="num" id="2403603">2</span>&nbsp;<span class="op" id="2403605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403609">return</span>&nbsp;<span class="ident" id="2403616">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403627">err</span>&nbsp;<span class="op" id="2403631">=</span>&nbsp;<span class="ident" id="2403633">utimensat</span><span class="op" id="2403642">(</span><span class="ident" id="2403643">_AT_FDCWD</span><span class="op" id="2403652">,</span>&nbsp;<span class="ident" id="2403654">path</span><span class="op" id="2403658">,</span>&nbsp;<span class="op" id="2403660">(</span><span class="op" id="2403661">*</span><span class="op" id="2403662">[</span><span class="num" id="2403663">2</span><span class="op" id="2403664">]</span><span class="ident" id="2403665">Timespec</span><span class="op" id="2403673">)</span><span class="op" id="2403674">(</span><span class="ident" id="2403675">unsafe</span><span class="op" id="2403681">.</span><span class="ident" id="2403682">Pointer</span><span class="op" id="2403689">(</span><span class="op" id="2403690">&amp;</span><span class="ident" id="2403691">ts</span><span class="op" id="2403693">[</span><span class="num" id="2403694">0</span><span class="op" id="2403695">]</span><span class="op" id="2403696">)</span><span class="op" id="2403697">)</span><span class="op" id="2403698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403701">if</span>&nbsp;<span class="ident" id="2403704">err</span>&nbsp;<span class="op" id="2403708">!=</span>&nbsp;<span class="ident" id="2403711">ENOSYS</span>&nbsp;<span class="op" id="2403718">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403722">return</span>&nbsp;<span class="ident" id="2403729">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403737">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2403812">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403875">var</span>&nbsp;<span class="ident" id="2403879">tv</span>&nbsp;<span class="op" id="2403882">[</span><span class="num" id="2403883">2</span><span class="op" id="2403884">]</span><span class="ident" id="2403885">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403894">for</span>&nbsp;<span class="ident" id="2403898">i</span>&nbsp;<span class="op" id="2403900">:=</span>&nbsp;<span class="num" id="2403903">0</span><span class="op" id="2403904">;</span>&nbsp;<span class="ident" id="2403906">i</span>&nbsp;<span class="op" id="2403908">&lt;</span>&nbsp;<span class="num" id="2403910">2</span><span class="op" id="2403911">;</span>&nbsp;<span class="ident" id="2403913">i</span><span class="op" id="2403914">++</span>&nbsp;<span class="op" id="2403917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403921">tv</span><span class="op" id="2403923">[</span><span class="ident" id="2403924">i</span><span class="op" id="2403925">]</span><span class="op" id="2403926">.</span><span class="ident" id="2403927">Sec</span>&nbsp;<span class="op" id="2403931">=</span>&nbsp;<span class="ident" id="2403933">ts</span><span class="op" id="2403935">[</span><span class="ident" id="2403936">i</span><span class="op" id="2403937">]</span><span class="op" id="2403938">.</span><span class="ident" id="2403939">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2403945">tv</span><span class="op" id="2403947">[</span><span class="ident" id="2403948">i</span><span class="op" id="2403949">]</span><span class="op" id="2403950">.</span><span class="ident" id="2403951">Usec</span>&nbsp;<span class="op" id="2403956">=</span>&nbsp;<span class="ident" id="2403958">ts</span><span class="op" id="2403960">[</span><span class="ident" id="2403961">i</span><span class="op" id="2403962">]</span><span class="op" id="2403963">.</span><span class="ident" id="2403964">Nsec</span>&nbsp;<span class="op" id="2403969">/</span>&nbsp;<span class="num" id="2403971">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2403977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2403980">return</span>&nbsp;<span class="ident" id="2403987">utimes</span><span class="op" id="2403993">(</span><span class="ident" id="2403994">path</span><span class="op" id="2403998">,</span>&nbsp;<span class="op" id="2404000">(</span><span class="op" id="2404001">*</span><span class="op" id="2404002">[</span><span class="num" id="2404003">2</span><span class="op" id="2404004">]</span><span class="ident" id="2404005">Timeval</span><span class="op" id="2404012">)</span><span class="op" id="2404013">(</span><span class="ident" id="2404014">unsafe</span><span class="op" id="2404020">.</span><span class="ident" id="2404021">Pointer</span><span class="op" id="2404028">(</span><span class="op" id="2404029">&amp;</span><span class="ident" id="2404030">tv</span><span class="op" id="2404032">[</span><span class="num" id="2404033">0</span><span class="op" id="2404034">]</span><span class="op" id="2404035">)</span><span class="op" id="2404036">)</span><span class="op" id="2404037">)</span><br>
<span class="lineno">85</span><span class="op" id="2404039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2404042">//sys&nbsp;&nbsp;&nbsp;&nbspfutimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2404113">func</span>&nbsp;<span class="ident" id="2404118">Futimesat</span><span class="op" id="2404127">(</span><span class="ident" id="2404128">dirfd</span>&nbsp;<span class="builtintype" id="2404134">int</span><span class="op" id="2404137">,</span>&nbsp;<span class="ident" id="2404139">path</span>&nbsp;<span class="builtintype" id="2404144">string</span><span class="op" id="2404150">,</span>&nbsp;<span class="ident" id="2404152">tv</span>&nbsp;<span class="op" id="2404155">[</span><span class="op" id="2404156">]</span><span class="ident" id="2404157">Timeval</span><span class="op" id="2404164">)</span>&nbsp;<span class="op" id="2404166">(</span><span class="ident" id="2404167">err</span>&nbsp;<span class="builtintype" id="2404171">error</span><span class="op" id="2404176">)</span>&nbsp;<span class="op" id="2404178">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404181">if</span>&nbsp;<span class="builtinfunc" id="2404184">len</span><span class="op" id="2404187">(</span><span class="ident" id="2404188">tv</span><span class="op" id="2404190">)</span>&nbsp;<span class="op" id="2404192">!=</span>&nbsp;<span class="num" id="2404195">2</span>&nbsp;<span class="op" id="2404197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404201">return</span>&nbsp;<span class="ident" id="2404208">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2404216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404219">pathp</span><span class="op" id="2404224">,</span>&nbsp;<span class="ident" id="2404226">err</span>&nbsp;<span class="op" id="2404230">:=</span>&nbsp;<span class="ident" id="2404233">BytePtrFromString</span><span class="op" id="2404250">(</span><span class="ident" id="2404251">path</span><span class="op" id="2404255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404258">if</span>&nbsp;<span class="ident" id="2404261">err</span>&nbsp;<span class="op" id="2404265">!=</span>&nbsp;<span class="ident" id="2404268">nil</span>&nbsp;<span class="op" id="2404272">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404276">return</span>&nbsp;<span class="ident" id="2404283">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2404288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404291">err</span>&nbsp;<span class="op" id="2404295">=</span>&nbsp;<span class="ident" id="2404297">futimesat</span><span class="op" id="2404306">(</span><span class="ident" id="2404307">dirfd</span><span class="op" id="2404312">,</span>&nbsp;<span class="ident" id="2404314">pathp</span><span class="op" id="2404319">,</span>&nbsp;<span class="op" id="2404321">(</span><span class="op" id="2404322">*</span><span class="op" id="2404323">[</span><span class="num" id="2404324">2</span><span class="op" id="2404325">]</span><span class="ident" id="2404326">Timeval</span><span class="op" id="2404333">)</span><span class="op" id="2404334">(</span><span class="ident" id="2404335">unsafe</span><span class="op" id="2404341">.</span><span class="ident" id="2404342">Pointer</span><span class="op" id="2404349">(</span><span class="op" id="2404350">&amp;</span><span class="ident" id="2404351">tv</span><span class="op" id="2404353">[</span><span class="num" id="2404354">0</span><span class="op" id="2404355">]</span><span class="op" id="2404356">)</span><span class="op" id="2404357">)</span><span class="op" id="2404358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404361">use</span><span class="op" id="2404364">(</span><span class="ident" id="2404365">unsafe</span><span class="op" id="2404371">.</span><span class="ident" id="2404372">Pointer</span><span class="op" id="2404379">(</span><span class="ident" id="2404380">pathp</span><span class="op" id="2404385">)</span><span class="op" id="2404386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404389">return</span>&nbsp;<span class="ident" id="2404396">err</span><br>
<span class="lineno">100</span><span class="op" id="2404400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2404403">func</span>&nbsp;<span class="ident" id="2404408">Futimes</span><span class="op" id="2404415">(</span><span class="ident" id="2404416">fd</span>&nbsp;<span class="builtintype" id="2404419">int</span><span class="op" id="2404422">,</span>&nbsp;<span class="ident" id="2404424">tv</span>&nbsp;<span class="op" id="2404427">[</span><span class="op" id="2404428">]</span><span class="ident" id="2404429">Timeval</span><span class="op" id="2404436">)</span>&nbsp;<span class="op" id="2404438">(</span><span class="ident" id="2404439">err</span>&nbsp;<span class="builtintype" id="2404443">error</span><span class="op" id="2404448">)</span>&nbsp;<span class="op" id="2404450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2404453">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2404512">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404542">return</span>&nbsp;<span class="ident" id="2404549">Utimes</span><span class="op" id="2404555">(</span><span class="string" id="2404556">&#34;/proc/self/fd/&#34;</span><span class="op" id="2404572">+</span><span class="ident" id="2404573">itoa</span><span class="op" id="2404577">(</span><span class="ident" id="2404578">fd</span><span class="op" id="2404580">)</span><span class="op" id="2404581">,</span>&nbsp;<span class="ident" id="2404583">tv</span><span class="op" id="2404585">)</span><br>
<span class="lineno"></span><span class="op" id="2404587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2404590">const</span>&nbsp;<span class="ident" id="2404596">ImplementsGetwd</span>&nbsp;<span class="op" id="2404612">=</span>&nbsp;<span class="builtintype" id="2404614">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2404620">//sys&nbsp;&nbsp;&nbsp;&nbspGetcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2404665">func</span>&nbsp;<span class="ident" id="2404670">Getwd</span><span class="op" id="2404675">(</span><span class="op" id="2404676">)</span>&nbsp;<span class="op" id="2404678">(</span><span class="ident" id="2404679">wd</span>&nbsp;<span class="builtintype" id="2404682">string</span><span class="op" id="2404688">,</span>&nbsp;<span class="ident" id="2404690">err</span>&nbsp;<span class="builtintype" id="2404694">error</span><span class="op" id="2404699">)</span>&nbsp;<span class="op" id="2404701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404704">var</span>&nbsp;<span class="ident" id="2404708">buf</span>&nbsp;<span class="op" id="2404712">[</span><span class="ident" id="2404713">PathMax</span><span class="op" id="2404720">]</span><span class="builtintype" id="2404721">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2404727">n</span><span class="op" id="2404728">,</span>&nbsp;<span class="ident" id="2404730">err</span>&nbsp;<span class="op" id="2404734">:=</span>&nbsp;<span class="ident" id="2404737">Getcwd</span><span class="op" id="2404743">(</span><span class="ident" id="2404744">buf</span><span class="op" id="2404747">[</span><span class="num" id="2404748">0</span><span class="op" id="2404749">:</span><span class="op" id="2404750">]</span><span class="op" id="2404751">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404754">if</span>&nbsp;<span class="ident" id="2404757">err</span>&nbsp;<span class="op" id="2404761">!=</span>&nbsp;<span class="ident" id="2404764">nil</span>&nbsp;<span class="op" id="2404768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404772">return</span>&nbsp;<span class="string" id="2404779">&#34;&#34;</span><span class="op" id="2404781">,</span>&nbsp;<span class="ident" id="2404783">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2404788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2404791">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404865">if</span>&nbsp;<span class="ident" id="2404868">n</span>&nbsp;<span class="op" id="2404870">&lt;</span>&nbsp;<span class="num" id="2404872">1</span>&nbsp;<span class="op" id="2404874">||</span>&nbsp;<span class="ident" id="2404877">n</span>&nbsp;<span class="op" id="2404879">&gt;</span>&nbsp;<span class="builtinfunc" id="2404881">len</span><span class="op" id="2404884">(</span><span class="ident" id="2404885">buf</span><span class="op" id="2404888">)</span>&nbsp;<span class="op" id="2404890">||</span>&nbsp;<span class="ident" id="2404893">buf</span><span class="op" id="2404896">[</span><span class="ident" id="2404897">n</span><span class="op" id="2404898">-</span><span class="num" id="2404899">1</span><span class="op" id="2404900">]</span>&nbsp;<span class="op" id="2404902">!=</span>&nbsp;<span class="num" id="2404905">0</span>&nbsp;<span class="op" id="2404907">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404911">return</span>&nbsp;<span class="string" id="2404918">&#34;&#34;</span><span class="op" id="2404920">,</span>&nbsp;<span class="ident" id="2404922">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2404930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2404933">return</span>&nbsp;<span class="builtintype" id="2404940">string</span><span class="op" id="2404946">(</span><span class="ident" id="2404947">buf</span><span class="op" id="2404950">[</span><span class="num" id="2404951">0</span>&nbsp;<span class="op" id="2404953">:</span>&nbsp;<span class="ident" id="2404955">n</span><span class="op" id="2404956">-</span><span class="num" id="2404957">1</span><span class="op" id="2404958">]</span><span class="op" id="2404959">)</span><span class="op" id="2404960">,</span>&nbsp;<span class="ident" id="2404962">nil</span><br>
<span class="lineno"></span><span class="op" id="2404966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2404969">func</span>&nbsp;<span class="ident" id="2404974">Getgroups</span><span class="op" id="2404983">(</span><span class="op" id="2404984">)</span>&nbsp;<span class="op" id="2404986">(</span><span class="ident" id="2404987">gids</span>&nbsp;<span class="op" id="2404992">[</span><span class="op" id="2404993">]</span><span class="builtintype" id="2404994">int</span><span class="op" id="2404997">,</span>&nbsp;<span class="ident" id="2404999">err</span>&nbsp;<span class="builtintype" id="2405003">error</span><span class="op" id="2405008">)</span>&nbsp;<span class="op" id="2405010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405013">n</span><span class="op" id="2405014">,</span>&nbsp;<span class="ident" id="2405016">err</span>&nbsp;<span class="op" id="2405020">:=</span>&nbsp;<span class="ident" id="2405023">getgroups</span><span class="op" id="2405032">(</span><span class="num" id="2405033">0</span><span class="op" id="2405034">,</span>&nbsp;<span class="ident" id="2405036">nil</span><span class="op" id="2405039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405042">if</span>&nbsp;<span class="ident" id="2405045">err</span>&nbsp;<span class="op" id="2405049">!=</span>&nbsp;<span class="ident" id="2405052">nil</span>&nbsp;<span class="op" id="2405056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405060">return</span>&nbsp;<span class="ident" id="2405067">nil</span><span class="op" id="2405070">,</span>&nbsp;<span class="ident" id="2405072">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405077">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405080">if</span>&nbsp;<span class="ident" id="2405083">n</span>&nbsp;<span class="op" id="2405085">==</span>&nbsp;<span class="num" id="2405088">0</span>&nbsp;<span class="op" id="2405090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405094">return</span>&nbsp;<span class="ident" id="2405101">nil</span><span class="op" id="2405104">,</span>&nbsp;<span class="ident" id="2405106">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2405115">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405169">if</span>&nbsp;<span class="ident" id="2405172">n</span>&nbsp;<span class="op" id="2405174">&lt;</span>&nbsp;<span class="num" id="2405176">0</span>&nbsp;<span class="op" id="2405178">||</span>&nbsp;<span class="ident" id="2405181">n</span>&nbsp;<span class="op" id="2405183">&gt;</span>&nbsp;<span class="num" id="2405185">1</span><span class="op" id="2405186">&lt;&lt;</span><span class="num" id="2405188">20</span>&nbsp;<span class="op" id="2405191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405195">return</span>&nbsp;<span class="ident" id="2405202">nil</span><span class="op" id="2405205">,</span>&nbsp;<span class="ident" id="2405207">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405219">a</span>&nbsp;<span class="op" id="2405221">:=</span>&nbsp;<span class="builtinfunc" id="2405224">make</span><span class="op" id="2405228">(</span><span class="op" id="2405229">[</span><span class="op" id="2405230">]</span><span class="ident" id="2405231">_Gid_t</span><span class="op" id="2405237">,</span>&nbsp;<span class="ident" id="2405239">n</span><span class="op" id="2405240">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405243">n</span><span class="op" id="2405244">,</span>&nbsp;<span class="ident" id="2405246">err</span>&nbsp;<span class="op" id="2405250">=</span>&nbsp;<span class="ident" id="2405252">getgroups</span><span class="op" id="2405261">(</span><span class="ident" id="2405262">n</span><span class="op" id="2405263">,</span>&nbsp;<span class="op" id="2405265">&amp;</span><span class="ident" id="2405266">a</span><span class="op" id="2405267">[</span><span class="num" id="2405268">0</span><span class="op" id="2405269">]</span><span class="op" id="2405270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405273">if</span>&nbsp;<span class="ident" id="2405276">err</span>&nbsp;<span class="op" id="2405280">!=</span>&nbsp;<span class="ident" id="2405283">nil</span>&nbsp;<span class="op" id="2405287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405291">return</span>&nbsp;<span class="ident" id="2405298">nil</span><span class="op" id="2405301">,</span>&nbsp;<span class="ident" id="2405303">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405311">gids</span>&nbsp;<span class="op" id="2405316">=</span>&nbsp;<span class="builtinfunc" id="2405318">make</span><span class="op" id="2405322">(</span><span class="op" id="2405323">[</span><span class="op" id="2405324">]</span><span class="builtintype" id="2405325">int</span><span class="op" id="2405328">,</span>&nbsp;<span class="ident" id="2405330">n</span><span class="op" id="2405331">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405334">for</span>&nbsp;<span class="ident" id="2405338">i</span><span class="op" id="2405339">,</span>&nbsp;<span class="ident" id="2405341">v</span>&nbsp;<span class="op" id="2405343">:=</span>&nbsp;<span class="keyword" id="2405346">range</span>&nbsp;<span class="ident" id="2405352">a</span><span class="op" id="2405353">[</span><span class="num" id="2405354">0</span><span class="op" id="2405355">:</span><span class="ident" id="2405356">n</span><span class="op" id="2405357">]</span>&nbsp;<span class="op" id="2405359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405363">gids</span><span class="op" id="2405367">[</span><span class="ident" id="2405368">i</span><span class="op" id="2405369">]</span>&nbsp;<span class="op" id="2405371">=</span>&nbsp;<span class="builtintype" id="2405373">int</span><span class="op" id="2405376">(</span><span class="ident" id="2405377">v</span><span class="op" id="2405378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405384">return</span><br>
<span class="lineno"></span><span class="op" id="2405391">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2405394">func</span>&nbsp;<span class="ident" id="2405399">Setgroups</span><span class="op" id="2405408">(</span><span class="ident" id="2405409">gids</span>&nbsp;<span class="op" id="2405414">[</span><span class="op" id="2405415">]</span><span class="builtintype" id="2405416">int</span><span class="op" id="2405419">)</span>&nbsp;<span class="op" id="2405421">(</span><span class="ident" id="2405422">err</span>&nbsp;<span class="builtintype" id="2405426">error</span><span class="op" id="2405431">)</span>&nbsp;<span class="op" id="2405433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405436">if</span>&nbsp;<span class="builtinfunc" id="2405439">len</span><span class="op" id="2405442">(</span><span class="ident" id="2405443">gids</span><span class="op" id="2405447">)</span>&nbsp;<span class="op" id="2405449">==</span>&nbsp;<span class="num" id="2405452">0</span>&nbsp;<span class="op" id="2405454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405458">return</span>&nbsp;<span class="ident" id="2405465">setgroups</span><span class="op" id="2405474">(</span><span class="num" id="2405475">0</span><span class="op" id="2405476">,</span>&nbsp;<span class="ident" id="2405478">nil</span><span class="op" id="2405481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405484">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405488">a</span>&nbsp;<span class="op" id="2405490">:=</span>&nbsp;<span class="builtinfunc" id="2405493">make</span><span class="op" id="2405497">(</span><span class="op" id="2405498">[</span><span class="op" id="2405499">]</span><span class="ident" id="2405500">_Gid_t</span><span class="op" id="2405506">,</span>&nbsp;<span class="builtinfunc" id="2405508">len</span><span class="op" id="2405511">(</span><span class="ident" id="2405512">gids</span><span class="op" id="2405516">)</span><span class="op" id="2405517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405520">for</span>&nbsp;<span class="ident" id="2405524">i</span><span class="op" id="2405525">,</span>&nbsp;<span class="ident" id="2405527">v</span>&nbsp;<span class="op" id="2405529">:=</span>&nbsp;<span class="keyword" id="2405532">range</span>&nbsp;<span class="ident" id="2405538">gids</span>&nbsp;<span class="op" id="2405543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2405547">a</span><span class="op" id="2405548">[</span><span class="ident" id="2405549">i</span><span class="op" id="2405550">]</span>&nbsp;<span class="op" id="2405552">=</span>&nbsp;<span class="ident" id="2405554">_Gid_t</span><span class="op" id="2405560">(</span><span class="ident" id="2405561">v</span><span class="op" id="2405562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2405565">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2405568">return</span>&nbsp;<span class="ident" id="2405575">setgroups</span><span class="op" id="2405584">(</span><span class="builtinfunc" id="2405585">len</span><span class="op" id="2405588">(</span><span class="ident" id="2405589">a</span><span class="op" id="2405590">)</span><span class="op" id="2405591">,</span>&nbsp;<span class="op" id="2405593">&amp;</span><span class="ident" id="2405594">a</span><span class="op" id="2405595">[</span><span class="num" id="2405596">0</span><span class="op" id="2405597">]</span><span class="op" id="2405598">)</span><br>
<span class="lineno"></span><span class="op" id="2405600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2405603">type</span>&nbsp;<span class="ident" id="2405608">WaitStatus</span>&nbsp;<span class="builtintype" id="2405619">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2405627">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2405682">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2405741">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2405791">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2405845">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2405896">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2405951">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2406006">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406046">const</span>&nbsp;<span class="op" id="2406052">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406055">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406063">=</span>&nbsp;<span class="num" id="2406065">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406071">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406079">=</span>&nbsp;<span class="num" id="2406081">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406087">exited</span>&nbsp;&nbsp;<span class="op" id="2406095">=</span>&nbsp;<span class="num" id="2406097">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406103">stopped</span>&nbsp;<span class="op" id="2406111">=</span>&nbsp;<span class="num" id="2406113">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2406119">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2406127">=</span>&nbsp;<span class="num" id="2406129">8</span><br>
<span class="lineno">180</span><span class="op" id="2406131">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406134">func</span>&nbsp;<span class="op" id="2406139">(</span><span class="ident" id="2406140">w</span>&nbsp;<span class="ident" id="2406142">WaitStatus</span><span class="op" id="2406152">)</span>&nbsp;<span class="ident" id="2406154">Exited</span><span class="op" id="2406160">(</span><span class="op" id="2406161">)</span>&nbsp;<span class="builtintype" id="2406163">bool</span>&nbsp;<span class="op" id="2406168">{</span>&nbsp;<span class="keyword" id="2406170">return</span>&nbsp;<span class="ident" id="2406177">w</span><span class="op" id="2406178">&amp;</span><span class="ident" id="2406179">mask</span>&nbsp;<span class="op" id="2406184">==</span>&nbsp;<span class="ident" id="2406187">exited</span>&nbsp;<span class="op" id="2406194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406197">func</span>&nbsp;<span class="op" id="2406202">(</span><span class="ident" id="2406203">w</span>&nbsp;<span class="ident" id="2406205">WaitStatus</span><span class="op" id="2406215">)</span>&nbsp;<span class="ident" id="2406217">Signaled</span><span class="op" id="2406225">(</span><span class="op" id="2406226">)</span>&nbsp;<span class="builtintype" id="2406228">bool</span>&nbsp;<span class="op" id="2406233">{</span>&nbsp;<span class="keyword" id="2406235">return</span>&nbsp;<span class="ident" id="2406242">w</span><span class="op" id="2406243">&amp;</span><span class="ident" id="2406244">mask</span>&nbsp;<span class="op" id="2406249">!=</span>&nbsp;<span class="ident" id="2406252">stopped</span>&nbsp;<span class="op" id="2406260">&amp;&amp;</span>&nbsp;<span class="ident" id="2406263">w</span><span class="op" id="2406264">&amp;</span><span class="ident" id="2406265">mask</span>&nbsp;<span class="op" id="2406270">!=</span>&nbsp;<span class="ident" id="2406273">exited</span>&nbsp;<span class="op" id="2406280">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2406283">func</span>&nbsp;<span class="op" id="2406288">(</span><span class="ident" id="2406289">w</span>&nbsp;<span class="ident" id="2406291">WaitStatus</span><span class="op" id="2406301">)</span>&nbsp;<span class="ident" id="2406303">Stopped</span><span class="op" id="2406310">(</span><span class="op" id="2406311">)</span>&nbsp;<span class="builtintype" id="2406313">bool</span>&nbsp;<span class="op" id="2406318">{</span>&nbsp;<span class="keyword" id="2406320">return</span>&nbsp;<span class="ident" id="2406327">w</span><span class="op" id="2406328">&amp;</span><span class="num" id="2406329">0xFF</span>&nbsp;<span class="op" id="2406334">==</span>&nbsp;<span class="ident" id="2406337">stopped</span>&nbsp;<span class="op" id="2406345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406348">func</span>&nbsp;<span class="op" id="2406353">(</span><span class="ident" id="2406354">w</span>&nbsp;<span class="ident" id="2406356">WaitStatus</span><span class="op" id="2406366">)</span>&nbsp;<span class="ident" id="2406368">Continued</span><span class="op" id="2406377">(</span><span class="op" id="2406378">)</span>&nbsp;<span class="builtintype" id="2406380">bool</span>&nbsp;<span class="op" id="2406385">{</span>&nbsp;<span class="keyword" id="2406387">return</span>&nbsp;<span class="ident" id="2406394">w</span>&nbsp;<span class="op" id="2406396">==</span>&nbsp;<span class="num" id="2406399">0xFFFF</span>&nbsp;<span class="op" id="2406406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2406409">func</span>&nbsp;<span class="op" id="2406414">(</span><span class="ident" id="2406415">w</span>&nbsp;<span class="ident" id="2406417">WaitStatus</span><span class="op" id="2406427">)</span>&nbsp;<span class="ident" id="2406429">CoreDump</span><span class="op" id="2406437">(</span><span class="op" id="2406438">)</span>&nbsp;<span class="builtintype" id="2406440">bool</span>&nbsp;<span class="op" id="2406445">{</span>&nbsp;<span class="keyword" id="2406447">return</span>&nbsp;<span class="ident" id="2406454">w</span><span class="op" id="2406455">.</span><span class="ident" id="2406456">Signaled</span><span class="op" id="2406464">(</span><span class="op" id="2406465">)</span>&nbsp;<span class="op" id="2406467">&amp;&amp;</span>&nbsp;<span class="ident" id="2406470">w</span><span class="op" id="2406471">&amp;</span><span class="ident" id="2406472">core</span>&nbsp;<span class="op" id="2406477">!=</span>&nbsp;<span class="num" id="2406480">0</span>&nbsp;<span class="op" id="2406482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406485">func</span>&nbsp;<span class="op" id="2406490">(</span><span class="ident" id="2406491">w</span>&nbsp;<span class="ident" id="2406493">WaitStatus</span><span class="op" id="2406503">)</span>&nbsp;<span class="ident" id="2406505">ExitStatus</span><span class="op" id="2406515">(</span><span class="op" id="2406516">)</span>&nbsp;<span class="builtintype" id="2406518">int</span>&nbsp;<span class="op" id="2406522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406525">if</span>&nbsp;<span class="op" id="2406528">!</span><span class="ident" id="2406529">w</span><span class="op" id="2406530">.</span><span class="ident" id="2406531">Exited</span><span class="op" id="2406537">(</span><span class="op" id="2406538">)</span>&nbsp;<span class="op" id="2406540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406544">return</span>&nbsp;<span class="op" id="2406551">-</span><span class="num" id="2406552">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406558">return</span>&nbsp;<span class="builtintype" id="2406565">int</span><span class="op" id="2406568">(</span><span class="ident" id="2406569">w</span><span class="op" id="2406570">&gt;&gt;</span><span class="ident" id="2406572">shift</span><span class="op" id="2406577">)</span>&nbsp;<span class="op" id="2406579">&amp;</span>&nbsp;<span class="num" id="2406581">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2406586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406589">func</span>&nbsp;<span class="op" id="2406594">(</span><span class="ident" id="2406595">w</span>&nbsp;<span class="ident" id="2406597">WaitStatus</span><span class="op" id="2406607">)</span>&nbsp;<span class="ident" id="2406609">Signal</span><span class="op" id="2406615">(</span><span class="op" id="2406616">)</span>&nbsp;<span class="ident" id="2406618">Signal</span>&nbsp;<span class="op" id="2406625">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406628">if</span>&nbsp;<span class="op" id="2406631">!</span><span class="ident" id="2406632">w</span><span class="op" id="2406633">.</span><span class="ident" id="2406634">Signaled</span><span class="op" id="2406642">(</span><span class="op" id="2406643">)</span>&nbsp;<span class="op" id="2406645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406649">return</span>&nbsp;<span class="op" id="2406656">-</span><span class="num" id="2406657">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406663">return</span>&nbsp;<span class="ident" id="2406670">Signal</span><span class="op" id="2406676">(</span><span class="ident" id="2406677">w</span>&nbsp;<span class="op" id="2406679">&amp;</span>&nbsp;<span class="ident" id="2406681">mask</span><span class="op" id="2406685">)</span><br>
<span class="lineno"></span><span class="op" id="2406687">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2406690">func</span>&nbsp;<span class="op" id="2406695">(</span><span class="ident" id="2406696">w</span>&nbsp;<span class="ident" id="2406698">WaitStatus</span><span class="op" id="2406708">)</span>&nbsp;<span class="ident" id="2406710">StopSignal</span><span class="op" id="2406720">(</span><span class="op" id="2406721">)</span>&nbsp;<span class="ident" id="2406723">Signal</span>&nbsp;<span class="op" id="2406730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406733">if</span>&nbsp;<span class="op" id="2406736">!</span><span class="ident" id="2406737">w</span><span class="op" id="2406738">.</span><span class="ident" id="2406739">Stopped</span><span class="op" id="2406746">(</span><span class="op" id="2406747">)</span>&nbsp;<span class="op" id="2406749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406753">return</span>&nbsp;<span class="op" id="2406760">-</span><span class="num" id="2406761">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406764">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406767">return</span>&nbsp;<span class="ident" id="2406774">Signal</span><span class="op" id="2406780">(</span><span class="ident" id="2406781">w</span><span class="op" id="2406782">&gt;&gt;</span><span class="ident" id="2406784">shift</span><span class="op" id="2406789">)</span>&nbsp;<span class="op" id="2406791">&amp;</span>&nbsp;<span class="num" id="2406793">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2406798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406801">func</span>&nbsp;<span class="op" id="2406806">(</span><span class="ident" id="2406807">w</span>&nbsp;<span class="ident" id="2406809">WaitStatus</span><span class="op" id="2406819">)</span>&nbsp;<span class="ident" id="2406821">TrapCause</span><span class="op" id="2406830">(</span><span class="op" id="2406831">)</span>&nbsp;<span class="builtintype" id="2406833">int</span>&nbsp;<span class="op" id="2406837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406840">if</span>&nbsp;<span class="ident" id="2406843">w</span><span class="op" id="2406844">.</span><span class="ident" id="2406845">StopSignal</span><span class="op" id="2406855">(</span><span class="op" id="2406856">)</span>&nbsp;<span class="op" id="2406858">!=</span>&nbsp;<span class="ident" id="2406861">SIGTRAP</span>&nbsp;<span class="op" id="2406869">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406873">return</span>&nbsp;<span class="op" id="2406880">-</span><span class="num" id="2406881">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2406884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2406887">return</span>&nbsp;<span class="builtintype" id="2406894">int</span><span class="op" id="2406897">(</span><span class="ident" id="2406898">w</span><span class="op" id="2406899">&gt;&gt;</span><span class="ident" id="2406901">shift</span><span class="op" id="2406906">)</span>&nbsp;<span class="op" id="2406908">&gt;&gt;</span>&nbsp;<span class="num" id="2406911">8</span><br>
<span class="lineno"></span><span class="op" id="2406913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2406916">//sys&nbsp;&nbsp;&nbsp;&nbspwait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2407006">func</span>&nbsp;<span class="ident" id="2407011">Wait4</span><span class="op" id="2407016">(</span><span class="ident" id="2407017">pid</span>&nbsp;<span class="builtintype" id="2407021">int</span><span class="op" id="2407024">,</span>&nbsp;<span class="ident" id="2407026">wstatus</span>&nbsp;<span class="op" id="2407034">*</span><span class="ident" id="2407035">WaitStatus</span><span class="op" id="2407045">,</span>&nbsp;<span class="ident" id="2407047">options</span>&nbsp;<span class="builtintype" id="2407055">int</span><span class="op" id="2407058">,</span>&nbsp;<span class="ident" id="2407060">rusage</span>&nbsp;<span class="op" id="2407067">*</span><span class="ident" id="2407068">Rusage</span><span class="op" id="2407074">)</span>&nbsp;<span class="op" id="2407076">(</span><span class="ident" id="2407077">wpid</span>&nbsp;<span class="builtintype" id="2407082">int</span><span class="op" id="2407085">,</span>&nbsp;<span class="ident" id="2407087">err</span>&nbsp;<span class="builtintype" id="2407091">error</span><span class="op" id="2407096">)</span>&nbsp;<span class="op" id="2407098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407101">var</span>&nbsp;<span class="ident" id="2407105">status</span>&nbsp;<span class="ident" id="2407112">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407120">wpid</span><span class="op" id="2407124">,</span>&nbsp;<span class="ident" id="2407126">err</span>&nbsp;<span class="op" id="2407130">=</span>&nbsp;<span class="ident" id="2407132">wait4</span><span class="op" id="2407137">(</span><span class="ident" id="2407138">pid</span><span class="op" id="2407141">,</span>&nbsp;<span class="op" id="2407143">&amp;</span><span class="ident" id="2407144">status</span><span class="op" id="2407150">,</span>&nbsp;<span class="ident" id="2407152">options</span><span class="op" id="2407159">,</span>&nbsp;<span class="ident" id="2407161">rusage</span><span class="op" id="2407167">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407170">if</span>&nbsp;<span class="ident" id="2407173">wstatus</span>&nbsp;<span class="op" id="2407181">!=</span>&nbsp;<span class="ident" id="2407184">nil</span>&nbsp;<span class="op" id="2407188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407192">*</span><span class="ident" id="2407193">wstatus</span>&nbsp;<span class="op" id="2407201">=</span>&nbsp;<span class="ident" id="2407203">WaitStatus</span><span class="op" id="2407213">(</span><span class="ident" id="2407214">status</span><span class="op" id="2407220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407226">return</span><br>
<span class="lineno"></span><span class="op" id="2407233">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2407236">func</span>&nbsp;<span class="ident" id="2407241">Mkfifo</span><span class="op" id="2407247">(</span><span class="ident" id="2407248">path</span>&nbsp;<span class="builtintype" id="2407253">string</span><span class="op" id="2407259">,</span>&nbsp;<span class="ident" id="2407261">mode</span>&nbsp;<span class="builtintype" id="2407266">uint32</span><span class="op" id="2407272">)</span>&nbsp;<span class="op" id="2407274">(</span><span class="ident" id="2407275">err</span>&nbsp;<span class="builtintype" id="2407279">error</span><span class="op" id="2407284">)</span>&nbsp;<span class="op" id="2407286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407289">return</span>&nbsp;<span class="ident" id="2407296">Mknod</span><span class="op" id="2407301">(</span><span class="ident" id="2407302">path</span><span class="op" id="2407306">,</span>&nbsp;<span class="ident" id="2407308">mode</span><span class="op" id="2407312">|</span><span class="ident" id="2407313">S_IFIFO</span><span class="op" id="2407320">,</span>&nbsp;<span class="num" id="2407322">0</span><span class="op" id="2407323">)</span><br>
<span class="lineno"></span><span class="op" id="2407325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2407328">func</span>&nbsp;<span class="op" id="2407333">(</span><span class="ident" id="2407334">sa</span>&nbsp;<span class="op" id="2407337">*</span><span class="ident" id="2407338">SockaddrInet4</span><span class="op" id="2407351">)</span>&nbsp;<span class="ident" id="2407353">sockaddr</span><span class="op" id="2407361">(</span><span class="op" id="2407362">)</span>&nbsp;<span class="op" id="2407364">(</span><span class="ident" id="2407365">unsafe</span><span class="op" id="2407371">.</span><span class="ident" id="2407372">Pointer</span><span class="op" id="2407379">,</span>&nbsp;<span class="ident" id="2407381">_Socklen</span><span class="op" id="2407389">,</span>&nbsp;<span class="builtintype" id="2407391">error</span><span class="op" id="2407396">)</span>&nbsp;<span class="op" id="2407398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407401">if</span>&nbsp;<span class="ident" id="2407404">sa</span><span class="op" id="2407406">.</span><span class="ident" id="2407407">Port</span>&nbsp;<span class="op" id="2407412">&lt;</span>&nbsp;<span class="num" id="2407414">0</span>&nbsp;<span class="op" id="2407416">||</span>&nbsp;<span class="ident" id="2407419">sa</span><span class="op" id="2407421">.</span><span class="ident" id="2407422">Port</span>&nbsp;<span class="op" id="2407427">&gt;</span>&nbsp;<span class="num" id="2407429">0xFFFF</span>&nbsp;<span class="op" id="2407436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407440">return</span>&nbsp;<span class="ident" id="2407447">nil</span><span class="op" id="2407450">,</span>&nbsp;<span class="num" id="2407452">0</span><span class="op" id="2407453">,</span>&nbsp;<span class="ident" id="2407455">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407466">sa</span><span class="op" id="2407468">.</span><span class="ident" id="2407469">raw</span><span class="op" id="2407472">.</span><span class="ident" id="2407473">Family</span>&nbsp;<span class="op" id="2407480">=</span>&nbsp;<span class="ident" id="2407482">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407491">p</span>&nbsp;<span class="op" id="2407493">:=</span>&nbsp;<span class="op" id="2407496">(</span><span class="op" id="2407497">*</span><span class="op" id="2407498">[</span><span class="num" id="2407499">2</span><span class="op" id="2407500">]</span><span class="builtintype" id="2407501">byte</span><span class="op" id="2407505">)</span><span class="op" id="2407506">(</span><span class="ident" id="2407507">unsafe</span><span class="op" id="2407513">.</span><span class="ident" id="2407514">Pointer</span><span class="op" id="2407521">(</span><span class="op" id="2407522">&amp;</span><span class="ident" id="2407523">sa</span><span class="op" id="2407525">.</span><span class="ident" id="2407526">raw</span><span class="op" id="2407529">.</span><span class="ident" id="2407530">Port</span><span class="op" id="2407534">)</span><span class="op" id="2407535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407538">p</span><span class="op" id="2407539">[</span><span class="num" id="2407540">0</span><span class="op" id="2407541">]</span>&nbsp;<span class="op" id="2407543">=</span>&nbsp;<span class="builtintype" id="2407545">byte</span><span class="op" id="2407549">(</span><span class="ident" id="2407550">sa</span><span class="op" id="2407552">.</span><span class="ident" id="2407553">Port</span>&nbsp;<span class="op" id="2407558">&gt;&gt;</span>&nbsp;<span class="num" id="2407561">8</span><span class="op" id="2407562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407565">p</span><span class="op" id="2407566">[</span><span class="num" id="2407567">1</span><span class="op" id="2407568">]</span>&nbsp;<span class="op" id="2407570">=</span>&nbsp;<span class="builtintype" id="2407572">byte</span><span class="op" id="2407576">(</span><span class="ident" id="2407577">sa</span><span class="op" id="2407579">.</span><span class="ident" id="2407580">Port</span><span class="op" id="2407584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407587">for</span>&nbsp;<span class="ident" id="2407591">i</span>&nbsp;<span class="op" id="2407593">:=</span>&nbsp;<span class="num" id="2407596">0</span><span class="op" id="2407597">;</span>&nbsp;<span class="ident" id="2407599">i</span>&nbsp;<span class="op" id="2407601">&lt;</span>&nbsp;<span class="builtinfunc" id="2407603">len</span><span class="op" id="2407606">(</span><span class="ident" id="2407607">sa</span><span class="op" id="2407609">.</span><span class="ident" id="2407610">Addr</span><span class="op" id="2407614">)</span><span class="op" id="2407615">;</span>&nbsp;<span class="ident" id="2407617">i</span><span class="op" id="2407618">++</span>&nbsp;<span class="op" id="2407621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407625">sa</span><span class="op" id="2407627">.</span><span class="ident" id="2407628">raw</span><span class="op" id="2407631">.</span><span class="ident" id="2407632">Addr</span><span class="op" id="2407636">[</span><span class="ident" id="2407637">i</span><span class="op" id="2407638">]</span>&nbsp;<span class="op" id="2407640">=</span>&nbsp;<span class="ident" id="2407642">sa</span><span class="op" id="2407644">.</span><span class="ident" id="2407645">Addr</span><span class="op" id="2407649">[</span><span class="ident" id="2407650">i</span><span class="op" id="2407651">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407657">return</span>&nbsp;<span class="ident" id="2407664">unsafe</span><span class="op" id="2407670">.</span><span class="ident" id="2407671">Pointer</span><span class="op" id="2407678">(</span><span class="op" id="2407679">&amp;</span><span class="ident" id="2407680">sa</span><span class="op" id="2407682">.</span><span class="ident" id="2407683">raw</span><span class="op" id="2407686">)</span><span class="op" id="2407687">,</span>&nbsp;<span class="ident" id="2407689">SizeofSockaddrInet4</span><span class="op" id="2407708">,</span>&nbsp;<span class="ident" id="2407710">nil</span><br>
<span class="lineno"></span><span class="op" id="2407714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2407717">func</span>&nbsp;<span class="op" id="2407722">(</span><span class="ident" id="2407723">sa</span>&nbsp;<span class="op" id="2407726">*</span><span class="ident" id="2407727">SockaddrInet6</span><span class="op" id="2407740">)</span>&nbsp;<span class="ident" id="2407742">sockaddr</span><span class="op" id="2407750">(</span><span class="op" id="2407751">)</span>&nbsp;<span class="op" id="2407753">(</span><span class="ident" id="2407754">unsafe</span><span class="op" id="2407760">.</span><span class="ident" id="2407761">Pointer</span><span class="op" id="2407768">,</span>&nbsp;<span class="ident" id="2407770">_Socklen</span><span class="op" id="2407778">,</span>&nbsp;<span class="builtintype" id="2407780">error</span><span class="op" id="2407785">)</span>&nbsp;<span class="op" id="2407787">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407790">if</span>&nbsp;<span class="ident" id="2407793">sa</span><span class="op" id="2407795">.</span><span class="ident" id="2407796">Port</span>&nbsp;<span class="op" id="2407801">&lt;</span>&nbsp;<span class="num" id="2407803">0</span>&nbsp;<span class="op" id="2407805">||</span>&nbsp;<span class="ident" id="2407808">sa</span><span class="op" id="2407810">.</span><span class="ident" id="2407811">Port</span>&nbsp;<span class="op" id="2407816">&gt;</span>&nbsp;<span class="num" id="2407818">0xFFFF</span>&nbsp;<span class="op" id="2407825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2407829">return</span>&nbsp;<span class="ident" id="2407836">nil</span><span class="op" id="2407839">,</span>&nbsp;<span class="num" id="2407841">0</span><span class="op" id="2407842">,</span>&nbsp;<span class="ident" id="2407844">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2407852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407855">sa</span><span class="op" id="2407857">.</span><span class="ident" id="2407858">raw</span><span class="op" id="2407861">.</span><span class="ident" id="2407862">Family</span>&nbsp;<span class="op" id="2407869">=</span>&nbsp;<span class="ident" id="2407871">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407881">p</span>&nbsp;<span class="op" id="2407883">:=</span>&nbsp;<span class="op" id="2407886">(</span><span class="op" id="2407887">*</span><span class="op" id="2407888">[</span><span class="num" id="2407889">2</span><span class="op" id="2407890">]</span><span class="builtintype" id="2407891">byte</span><span class="op" id="2407895">)</span><span class="op" id="2407896">(</span><span class="ident" id="2407897">unsafe</span><span class="op" id="2407903">.</span><span class="ident" id="2407904">Pointer</span><span class="op" id="2407911">(</span><span class="op" id="2407912">&amp;</span><span class="ident" id="2407913">sa</span><span class="op" id="2407915">.</span><span class="ident" id="2407916">raw</span><span class="op" id="2407919">.</span><span class="ident" id="2407920">Port</span><span class="op" id="2407924">)</span><span class="op" id="2407925">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407928">p</span><span class="op" id="2407929">[</span><span class="num" id="2407930">0</span><span class="op" id="2407931">]</span>&nbsp;<span class="op" id="2407933">=</span>&nbsp;<span class="builtintype" id="2407935">byte</span><span class="op" id="2407939">(</span><span class="ident" id="2407940">sa</span><span class="op" id="2407942">.</span><span class="ident" id="2407943">Port</span>&nbsp;<span class="op" id="2407948">&gt;&gt;</span>&nbsp;<span class="num" id="2407951">8</span><span class="op" id="2407952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407955">p</span><span class="op" id="2407956">[</span><span class="num" id="2407957">1</span><span class="op" id="2407958">]</span>&nbsp;<span class="op" id="2407960">=</span>&nbsp;<span class="builtintype" id="2407962">byte</span><span class="op" id="2407966">(</span><span class="ident" id="2407967">sa</span><span class="op" id="2407969">.</span><span class="ident" id="2407970">Port</span><span class="op" id="2407974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2407977">sa</span><span class="op" id="2407979">.</span><span class="ident" id="2407980">raw</span><span class="op" id="2407983">.</span><span class="ident" id="2407984">Scope_id</span>&nbsp;<span class="op" id="2407993">=</span>&nbsp;<span class="ident" id="2407995">sa</span><span class="op" id="2407997">.</span><span class="ident" id="2407998">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408006">for</span>&nbsp;<span class="ident" id="2408010">i</span>&nbsp;<span class="op" id="2408012">:=</span>&nbsp;<span class="num" id="2408015">0</span><span class="op" id="2408016">;</span>&nbsp;<span class="ident" id="2408018">i</span>&nbsp;<span class="op" id="2408020">&lt;</span>&nbsp;<span class="builtinfunc" id="2408022">len</span><span class="op" id="2408025">(</span><span class="ident" id="2408026">sa</span><span class="op" id="2408028">.</span><span class="ident" id="2408029">Addr</span><span class="op" id="2408033">)</span><span class="op" id="2408034">;</span>&nbsp;<span class="ident" id="2408036">i</span><span class="op" id="2408037">++</span>&nbsp;<span class="op" id="2408040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408044">sa</span><span class="op" id="2408046">.</span><span class="ident" id="2408047">raw</span><span class="op" id="2408050">.</span><span class="ident" id="2408051">Addr</span><span class="op" id="2408055">[</span><span class="ident" id="2408056">i</span><span class="op" id="2408057">]</span>&nbsp;<span class="op" id="2408059">=</span>&nbsp;<span class="ident" id="2408061">sa</span><span class="op" id="2408063">.</span><span class="ident" id="2408064">Addr</span><span class="op" id="2408068">[</span><span class="ident" id="2408069">i</span><span class="op" id="2408070">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408076">return</span>&nbsp;<span class="ident" id="2408083">unsafe</span><span class="op" id="2408089">.</span><span class="ident" id="2408090">Pointer</span><span class="op" id="2408097">(</span><span class="op" id="2408098">&amp;</span><span class="ident" id="2408099">sa</span><span class="op" id="2408101">.</span><span class="ident" id="2408102">raw</span><span class="op" id="2408105">)</span><span class="op" id="2408106">,</span>&nbsp;<span class="ident" id="2408108">SizeofSockaddrInet6</span><span class="op" id="2408127">,</span>&nbsp;<span class="ident" id="2408129">nil</span><br>
<span class="lineno"></span><span class="op" id="2408133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2408136">func</span>&nbsp;<span class="op" id="2408141">(</span><span class="ident" id="2408142">sa</span>&nbsp;<span class="op" id="2408145">*</span><span class="ident" id="2408146">SockaddrUnix</span><span class="op" id="2408158">)</span>&nbsp;<span class="ident" id="2408160">sockaddr</span><span class="op" id="2408168">(</span><span class="op" id="2408169">)</span>&nbsp;<span class="op" id="2408171">(</span><span class="ident" id="2408172">unsafe</span><span class="op" id="2408178">.</span><span class="ident" id="2408179">Pointer</span><span class="op" id="2408186">,</span>&nbsp;<span class="ident" id="2408188">_Socklen</span><span class="op" id="2408196">,</span>&nbsp;<span class="builtintype" id="2408198">error</span><span class="op" id="2408203">)</span>&nbsp;<span class="op" id="2408205">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408208">name</span>&nbsp;<span class="op" id="2408213">:=</span>&nbsp;<span class="ident" id="2408216">sa</span><span class="op" id="2408218">.</span><span class="ident" id="2408219">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408225">n</span>&nbsp;<span class="op" id="2408227">:=</span>&nbsp;<span class="builtinfunc" id="2408230">len</span><span class="op" id="2408233">(</span><span class="ident" id="2408234">name</span><span class="op" id="2408238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408241">if</span>&nbsp;<span class="ident" id="2408244">n</span>&nbsp;<span class="op" id="2408246">&gt;=</span>&nbsp;<span class="builtinfunc" id="2408249">len</span><span class="op" id="2408252">(</span><span class="ident" id="2408253">sa</span><span class="op" id="2408255">.</span><span class="ident" id="2408256">raw</span><span class="op" id="2408259">.</span><span class="ident" id="2408260">Path</span><span class="op" id="2408264">)</span>&nbsp;<span class="op" id="2408266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408270">return</span>&nbsp;<span class="ident" id="2408277">nil</span><span class="op" id="2408280">,</span>&nbsp;<span class="num" id="2408282">0</span><span class="op" id="2408283">,</span>&nbsp;<span class="ident" id="2408285">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408293">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408296">sa</span><span class="op" id="2408298">.</span><span class="ident" id="2408299">raw</span><span class="op" id="2408302">.</span><span class="ident" id="2408303">Family</span>&nbsp;<span class="op" id="2408310">=</span>&nbsp;<span class="ident" id="2408312">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408321">for</span>&nbsp;<span class="ident" id="2408325">i</span>&nbsp;<span class="op" id="2408327">:=</span>&nbsp;<span class="num" id="2408330">0</span><span class="op" id="2408331">;</span>&nbsp;<span class="ident" id="2408333">i</span>&nbsp;<span class="op" id="2408335">&lt;</span>&nbsp;<span class="ident" id="2408337">n</span><span class="op" id="2408338">;</span>&nbsp;<span class="ident" id="2408340">i</span><span class="op" id="2408341">++</span>&nbsp;<span class="op" id="2408344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408348">sa</span><span class="op" id="2408350">.</span><span class="ident" id="2408351">raw</span><span class="op" id="2408354">.</span><span class="ident" id="2408355">Path</span><span class="op" id="2408359">[</span><span class="ident" id="2408360">i</span><span class="op" id="2408361">]</span>&nbsp;<span class="op" id="2408363">=</span>&nbsp;<span class="builtintype" id="2408365">int8</span><span class="op" id="2408369">(</span><span class="ident" id="2408370">name</span><span class="op" id="2408374">[</span><span class="ident" id="2408375">i</span><span class="op" id="2408376">]</span><span class="op" id="2408377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2408383">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408425">sl</span>&nbsp;<span class="op" id="2408428">:=</span>&nbsp;<span class="ident" id="2408431">_Socklen</span><span class="op" id="2408439">(</span><span class="num" id="2408440">2</span><span class="op" id="2408441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408444">if</span>&nbsp;<span class="ident" id="2408447">n</span>&nbsp;<span class="op" id="2408449">&gt;</span>&nbsp;<span class="num" id="2408451">0</span>&nbsp;<span class="op" id="2408453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408457">sl</span>&nbsp;<span class="op" id="2408460">+=</span>&nbsp;<span class="ident" id="2408463">_Socklen</span><span class="op" id="2408471">(</span><span class="ident" id="2408472">n</span><span class="op" id="2408473">)</span>&nbsp;<span class="op" id="2408475">+</span>&nbsp;<span class="num" id="2408477">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408483">if</span>&nbsp;<span class="ident" id="2408486">sa</span><span class="op" id="2408488">.</span><span class="ident" id="2408489">raw</span><span class="op" id="2408492">.</span><span class="ident" id="2408493">Path</span><span class="op" id="2408497">[</span><span class="num" id="2408498">0</span><span class="op" id="2408499">]</span>&nbsp;<span class="op" id="2408501">==</span>&nbsp;<span class="string" id="2408504">&#39;@&#39;</span>&nbsp;<span class="op" id="2408508">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408512">sa</span><span class="op" id="2408514">.</span><span class="ident" id="2408515">raw</span><span class="op" id="2408518">.</span><span class="ident" id="2408519">Path</span><span class="op" id="2408523">[</span><span class="num" id="2408524">0</span><span class="op" id="2408525">]</span>&nbsp;<span class="op" id="2408527">=</span>&nbsp;<span class="num" id="2408529">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2408533">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408585">sl</span><span class="op" id="2408587">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408595">return</span>&nbsp;<span class="ident" id="2408602">unsafe</span><span class="op" id="2408608">.</span><span class="ident" id="2408609">Pointer</span><span class="op" id="2408616">(</span><span class="op" id="2408617">&amp;</span><span class="ident" id="2408618">sa</span><span class="op" id="2408620">.</span><span class="ident" id="2408621">raw</span><span class="op" id="2408624">)</span><span class="op" id="2408625">,</span>&nbsp;<span class="ident" id="2408627">sl</span><span class="op" id="2408629">,</span>&nbsp;<span class="ident" id="2408631">nil</span><br>
<span class="lineno"></span><span class="op" id="2408635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2408638">type</span>&nbsp;<span class="ident" id="2408643">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2408661">struct</span>&nbsp;<span class="op" id="2408668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408671">Protocol</span>&nbsp;<span class="builtintype" id="2408680">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408688">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2408697">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408702">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2408711">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408719">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2408728">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408735">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2408744">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408751">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408760">[</span><span class="num" id="2408761">8</span><span class="op" id="2408762">]</span><span class="builtintype" id="2408763">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408769">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408778">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2408799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2408802">func</span>&nbsp;<span class="op" id="2408807">(</span><span class="ident" id="2408808">sa</span>&nbsp;<span class="op" id="2408811">*</span><span class="ident" id="2408812">SockaddrLinklayer</span><span class="op" id="2408829">)</span>&nbsp;<span class="ident" id="2408831">sockaddr</span><span class="op" id="2408839">(</span><span class="op" id="2408840">)</span>&nbsp;<span class="op" id="2408842">(</span><span class="ident" id="2408843">unsafe</span><span class="op" id="2408849">.</span><span class="ident" id="2408850">Pointer</span><span class="op" id="2408857">,</span>&nbsp;<span class="ident" id="2408859">_Socklen</span><span class="op" id="2408867">,</span>&nbsp;<span class="builtintype" id="2408869">error</span><span class="op" id="2408874">)</span>&nbsp;<span class="op" id="2408876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408879">if</span>&nbsp;<span class="ident" id="2408882">sa</span><span class="op" id="2408884">.</span><span class="ident" id="2408885">Ifindex</span>&nbsp;<span class="op" id="2408893">&lt;</span>&nbsp;<span class="num" id="2408895">0</span>&nbsp;<span class="op" id="2408897">||</span>&nbsp;<span class="ident" id="2408900">sa</span><span class="op" id="2408902">.</span><span class="ident" id="2408903">Ifindex</span>&nbsp;<span class="op" id="2408911">&gt;</span>&nbsp;<span class="num" id="2408913">0x7fffffff</span>&nbsp;<span class="op" id="2408924">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2408928">return</span>&nbsp;<span class="ident" id="2408935">nil</span><span class="op" id="2408938">,</span>&nbsp;<span class="num" id="2408940">0</span><span class="op" id="2408941">,</span>&nbsp;<span class="ident" id="2408943">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2408951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408954">sa</span><span class="op" id="2408956">.</span><span class="ident" id="2408957">raw</span><span class="op" id="2408960">.</span><span class="ident" id="2408961">Family</span>&nbsp;<span class="op" id="2408968">=</span>&nbsp;<span class="ident" id="2408970">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2408981">sa</span><span class="op" id="2408983">.</span><span class="ident" id="2408984">raw</span><span class="op" id="2408987">.</span><span class="ident" id="2408988">Protocol</span>&nbsp;<span class="op" id="2408997">=</span>&nbsp;<span class="ident" id="2408999">sa</span><span class="op" id="2409001">.</span><span class="ident" id="2409002">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409012">sa</span><span class="op" id="2409014">.</span><span class="ident" id="2409015">raw</span><span class="op" id="2409018">.</span><span class="ident" id="2409019">Ifindex</span>&nbsp;<span class="op" id="2409027">=</span>&nbsp;<span class="builtintype" id="2409029">int32</span><span class="op" id="2409034">(</span><span class="ident" id="2409035">sa</span><span class="op" id="2409037">.</span><span class="ident" id="2409038">Ifindex</span><span class="op" id="2409045">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409048">sa</span><span class="op" id="2409050">.</span><span class="ident" id="2409051">raw</span><span class="op" id="2409054">.</span><span class="ident" id="2409055">Hatype</span>&nbsp;<span class="op" id="2409062">=</span>&nbsp;<span class="ident" id="2409064">sa</span><span class="op" id="2409066">.</span><span class="ident" id="2409067">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409075">sa</span><span class="op" id="2409077">.</span><span class="ident" id="2409078">raw</span><span class="op" id="2409081">.</span><span class="ident" id="2409082">Pkttype</span>&nbsp;<span class="op" id="2409090">=</span>&nbsp;<span class="ident" id="2409092">sa</span><span class="op" id="2409094">.</span><span class="ident" id="2409095">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409104">sa</span><span class="op" id="2409106">.</span><span class="ident" id="2409107">raw</span><span class="op" id="2409110">.</span><span class="ident" id="2409111">Halen</span>&nbsp;<span class="op" id="2409117">=</span>&nbsp;<span class="ident" id="2409119">sa</span><span class="op" id="2409121">.</span><span class="ident" id="2409122">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409129">for</span>&nbsp;<span class="ident" id="2409133">i</span>&nbsp;<span class="op" id="2409135">:=</span>&nbsp;<span class="num" id="2409138">0</span><span class="op" id="2409139">;</span>&nbsp;<span class="ident" id="2409141">i</span>&nbsp;<span class="op" id="2409143">&lt;</span>&nbsp;<span class="builtinfunc" id="2409145">len</span><span class="op" id="2409148">(</span><span class="ident" id="2409149">sa</span><span class="op" id="2409151">.</span><span class="ident" id="2409152">Addr</span><span class="op" id="2409156">)</span><span class="op" id="2409157">;</span>&nbsp;<span class="ident" id="2409159">i</span><span class="op" id="2409160">++</span>&nbsp;<span class="op" id="2409163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409167">sa</span><span class="op" id="2409169">.</span><span class="ident" id="2409170">raw</span><span class="op" id="2409173">.</span><span class="ident" id="2409174">Addr</span><span class="op" id="2409178">[</span><span class="ident" id="2409179">i</span><span class="op" id="2409180">]</span>&nbsp;<span class="op" id="2409182">=</span>&nbsp;<span class="ident" id="2409184">sa</span><span class="op" id="2409186">.</span><span class="ident" id="2409187">Addr</span><span class="op" id="2409191">[</span><span class="ident" id="2409192">i</span><span class="op" id="2409193">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2409196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409199">return</span>&nbsp;<span class="ident" id="2409206">unsafe</span><span class="op" id="2409212">.</span><span class="ident" id="2409213">Pointer</span><span class="op" id="2409220">(</span><span class="op" id="2409221">&amp;</span><span class="ident" id="2409222">sa</span><span class="op" id="2409224">.</span><span class="ident" id="2409225">raw</span><span class="op" id="2409228">)</span><span class="op" id="2409229">,</span>&nbsp;<span class="ident" id="2409231">SizeofSockaddrLinklayer</span><span class="op" id="2409254">,</span>&nbsp;<span class="ident" id="2409256">nil</span><br>
<span class="lineno"></span><span class="op" id="2409260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2409263">type</span>&nbsp;<span class="ident" id="2409268">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2409284">struct</span>&nbsp;<span class="op" id="2409291">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409294">Family</span>&nbsp;<span class="builtintype" id="2409301">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409309">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2409316">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409324">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2409331">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409339">Groups</span>&nbsp;<span class="builtintype" id="2409346">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409354">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409361">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2409380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2409383">func</span>&nbsp;<span class="op" id="2409388">(</span><span class="ident" id="2409389">sa</span>&nbsp;<span class="op" id="2409392">*</span><span class="ident" id="2409393">SockaddrNetlink</span><span class="op" id="2409408">)</span>&nbsp;<span class="ident" id="2409410">sockaddr</span><span class="op" id="2409418">(</span><span class="op" id="2409419">)</span>&nbsp;<span class="op" id="2409421">(</span><span class="ident" id="2409422">unsafe</span><span class="op" id="2409428">.</span><span class="ident" id="2409429">Pointer</span><span class="op" id="2409436">,</span>&nbsp;<span class="ident" id="2409438">_Socklen</span><span class="op" id="2409446">,</span>&nbsp;<span class="builtintype" id="2409448">error</span><span class="op" id="2409453">)</span>&nbsp;<span class="op" id="2409455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409458">sa</span><span class="op" id="2409460">.</span><span class="ident" id="2409461">raw</span><span class="op" id="2409464">.</span><span class="ident" id="2409465">Family</span>&nbsp;<span class="op" id="2409472">=</span>&nbsp;<span class="ident" id="2409474">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409486">sa</span><span class="op" id="2409488">.</span><span class="ident" id="2409489">raw</span><span class="op" id="2409492">.</span><span class="ident" id="2409493">Pad</span>&nbsp;<span class="op" id="2409497">=</span>&nbsp;<span class="ident" id="2409499">sa</span><span class="op" id="2409501">.</span><span class="ident" id="2409502">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409507">sa</span><span class="op" id="2409509">.</span><span class="ident" id="2409510">raw</span><span class="op" id="2409513">.</span><span class="ident" id="2409514">Pid</span>&nbsp;<span class="op" id="2409518">=</span>&nbsp;<span class="ident" id="2409520">sa</span><span class="op" id="2409522">.</span><span class="ident" id="2409523">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409528">sa</span><span class="op" id="2409530">.</span><span class="ident" id="2409531">raw</span><span class="op" id="2409534">.</span><span class="ident" id="2409535">Groups</span>&nbsp;<span class="op" id="2409542">=</span>&nbsp;<span class="ident" id="2409544">sa</span><span class="op" id="2409546">.</span><span class="ident" id="2409547">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409555">return</span>&nbsp;<span class="ident" id="2409562">unsafe</span><span class="op" id="2409568">.</span><span class="ident" id="2409569">Pointer</span><span class="op" id="2409576">(</span><span class="op" id="2409577">&amp;</span><span class="ident" id="2409578">sa</span><span class="op" id="2409580">.</span><span class="ident" id="2409581">raw</span><span class="op" id="2409584">)</span><span class="op" id="2409585">,</span>&nbsp;<span class="ident" id="2409587">SizeofSockaddrNetlink</span><span class="op" id="2409608">,</span>&nbsp;<span class="ident" id="2409610">nil</span><br>
<span class="lineno"></span><span class="op" id="2409614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2409617">func</span>&nbsp;<span class="ident" id="2409622">anyToSockaddr</span><span class="op" id="2409635">(</span><span class="ident" id="2409636">rsa</span>&nbsp;<span class="op" id="2409640">*</span><span class="ident" id="2409641">RawSockaddrAny</span><span class="op" id="2409655">)</span>&nbsp;<span class="op" id="2409657">(</span><span class="ident" id="2409658">Sockaddr</span><span class="op" id="2409666">,</span>&nbsp;<span class="builtintype" id="2409668">error</span><span class="op" id="2409673">)</span>&nbsp;<span class="op" id="2409675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409678">switch</span>&nbsp;<span class="ident" id="2409685">rsa</span><span class="op" id="2409688">.</span><span class="ident" id="2409689">Addr</span><span class="op" id="2409693">.</span><span class="ident" id="2409694">Family</span>&nbsp;<span class="op" id="2409701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409704">case</span>&nbsp;<span class="ident" id="2409709">AF_NETLINK</span><span class="op" id="2409719">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409723">pp</span>&nbsp;<span class="op" id="2409726">:=</span>&nbsp;<span class="op" id="2409729">(</span><span class="op" id="2409730">*</span><span class="ident" id="2409731">RawSockaddrNetlink</span><span class="op" id="2409749">)</span><span class="op" id="2409750">(</span><span class="ident" id="2409751">unsafe</span><span class="op" id="2409757">.</span><span class="ident" id="2409758">Pointer</span><span class="op" id="2409765">(</span><span class="ident" id="2409766">rsa</span><span class="op" id="2409769">)</span><span class="op" id="2409770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409774">sa</span>&nbsp;<span class="op" id="2409777">:=</span>&nbsp;<span class="builtinfunc" id="2409780">new</span><span class="op" id="2409783">(</span><span class="ident" id="2409784">SockaddrNetlink</span><span class="op" id="2409799">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409803">sa</span><span class="op" id="2409805">.</span><span class="ident" id="2409806">Family</span>&nbsp;<span class="op" id="2409813">=</span>&nbsp;<span class="ident" id="2409815">pp</span><span class="op" id="2409817">.</span><span class="ident" id="2409818">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409827">sa</span><span class="op" id="2409829">.</span><span class="ident" id="2409830">Pad</span>&nbsp;<span class="op" id="2409834">=</span>&nbsp;<span class="ident" id="2409836">pp</span><span class="op" id="2409838">.</span><span class="ident" id="2409839">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409845">sa</span><span class="op" id="2409847">.</span><span class="ident" id="2409848">Pid</span>&nbsp;<span class="op" id="2409852">=</span>&nbsp;<span class="ident" id="2409854">pp</span><span class="op" id="2409856">.</span><span class="ident" id="2409857">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409863">sa</span><span class="op" id="2409865">.</span><span class="ident" id="2409866">Groups</span>&nbsp;<span class="op" id="2409873">=</span>&nbsp;<span class="ident" id="2409875">pp</span><span class="op" id="2409877">.</span><span class="ident" id="2409878">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409887">return</span>&nbsp;<span class="ident" id="2409894">sa</span><span class="op" id="2409896">,</span>&nbsp;<span class="ident" id="2409898">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2409904">case</span>&nbsp;<span class="ident" id="2409909">AF_PACKET</span><span class="op" id="2409918">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409922">pp</span>&nbsp;<span class="op" id="2409925">:=</span>&nbsp;<span class="op" id="2409928">(</span><span class="op" id="2409929">*</span><span class="ident" id="2409930">RawSockaddrLinklayer</span><span class="op" id="2409950">)</span><span class="op" id="2409951">(</span><span class="ident" id="2409952">unsafe</span><span class="op" id="2409958">.</span><span class="ident" id="2409959">Pointer</span><span class="op" id="2409966">(</span><span class="ident" id="2409967">rsa</span><span class="op" id="2409970">)</span><span class="op" id="2409971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2409975">sa</span>&nbsp;<span class="op" id="2409978">:=</span>&nbsp;<span class="builtinfunc" id="2409981">new</span><span class="op" id="2409984">(</span><span class="ident" id="2409985">SockaddrLinklayer</span><span class="op" id="2410002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410006">sa</span><span class="op" id="2410008">.</span><span class="ident" id="2410009">Protocol</span>&nbsp;<span class="op" id="2410018">=</span>&nbsp;<span class="ident" id="2410020">pp</span><span class="op" id="2410022">.</span><span class="ident" id="2410023">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410034">sa</span><span class="op" id="2410036">.</span><span class="ident" id="2410037">Ifindex</span>&nbsp;<span class="op" id="2410045">=</span>&nbsp;<span class="builtintype" id="2410047">int</span><span class="op" id="2410050">(</span><span class="ident" id="2410051">pp</span><span class="op" id="2410053">.</span><span class="ident" id="2410054">Ifindex</span><span class="op" id="2410061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410065">sa</span><span class="op" id="2410067">.</span><span class="ident" id="2410068">Hatype</span>&nbsp;<span class="op" id="2410075">=</span>&nbsp;<span class="ident" id="2410077">pp</span><span class="op" id="2410079">.</span><span class="ident" id="2410080">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410089">sa</span><span class="op" id="2410091">.</span><span class="ident" id="2410092">Pkttype</span>&nbsp;<span class="op" id="2410100">=</span>&nbsp;<span class="ident" id="2410102">pp</span><span class="op" id="2410104">.</span><span class="ident" id="2410105">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410115">sa</span><span class="op" id="2410117">.</span><span class="ident" id="2410118">Halen</span>&nbsp;<span class="op" id="2410124">=</span>&nbsp;<span class="ident" id="2410126">pp</span><span class="op" id="2410128">.</span><span class="ident" id="2410129">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410137">for</span>&nbsp;<span class="ident" id="2410141">i</span>&nbsp;<span class="op" id="2410143">:=</span>&nbsp;<span class="num" id="2410146">0</span><span class="op" id="2410147">;</span>&nbsp;<span class="ident" id="2410149">i</span>&nbsp;<span class="op" id="2410151">&lt;</span>&nbsp;<span class="builtinfunc" id="2410153">len</span><span class="op" id="2410156">(</span><span class="ident" id="2410157">sa</span><span class="op" id="2410159">.</span><span class="ident" id="2410160">Addr</span><span class="op" id="2410164">)</span><span class="op" id="2410165">;</span>&nbsp;<span class="ident" id="2410167">i</span><span class="op" id="2410168">++</span>&nbsp;<span class="op" id="2410171">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410176">sa</span><span class="op" id="2410178">.</span><span class="ident" id="2410179">Addr</span><span class="op" id="2410183">[</span><span class="ident" id="2410184">i</span><span class="op" id="2410185">]</span>&nbsp;<span class="op" id="2410187">=</span>&nbsp;<span class="ident" id="2410189">pp</span><span class="op" id="2410191">.</span><span class="ident" id="2410192">Addr</span><span class="op" id="2410196">[</span><span class="ident" id="2410197">i</span><span class="op" id="2410198">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410206">return</span>&nbsp;<span class="ident" id="2410213">sa</span><span class="op" id="2410215">,</span>&nbsp;<span class="ident" id="2410217">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410223">case</span>&nbsp;<span class="ident" id="2410228">AF_UNIX</span><span class="op" id="2410235">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410239">pp</span>&nbsp;<span class="op" id="2410242">:=</span>&nbsp;<span class="op" id="2410245">(</span><span class="op" id="2410246">*</span><span class="ident" id="2410247">RawSockaddrUnix</span><span class="op" id="2410262">)</span><span class="op" id="2410263">(</span><span class="ident" id="2410264">unsafe</span><span class="op" id="2410270">.</span><span class="ident" id="2410271">Pointer</span><span class="op" id="2410278">(</span><span class="ident" id="2410279">rsa</span><span class="op" id="2410282">)</span><span class="op" id="2410283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410287">sa</span>&nbsp;<span class="op" id="2410290">:=</span>&nbsp;<span class="builtinfunc" id="2410293">new</span><span class="op" id="2410296">(</span><span class="ident" id="2410297">SockaddrUnix</span><span class="op" id="2410309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410313">if</span>&nbsp;<span class="ident" id="2410316">pp</span><span class="op" id="2410318">.</span><span class="ident" id="2410319">Path</span><span class="op" id="2410323">[</span><span class="num" id="2410324">0</span><span class="op" id="2410325">]</span>&nbsp;<span class="op" id="2410327">==</span>&nbsp;<span class="num" id="2410330">0</span>&nbsp;<span class="op" id="2410332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410337">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410374">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410426">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410467">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410509">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410549">pp</span><span class="op" id="2410551">.</span><span class="ident" id="2410552">Path</span><span class="op" id="2410556">[</span><span class="num" id="2410557">0</span><span class="op" id="2410558">]</span>&nbsp;<span class="op" id="2410560">=</span>&nbsp;<span class="string" id="2410562">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410568">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410573">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410603">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410656">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410709">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2410763">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410799">n</span>&nbsp;<span class="op" id="2410801">:=</span>&nbsp;<span class="num" id="2410804">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410808">for</span>&nbsp;<span class="ident" id="2410812">n</span>&nbsp;<span class="op" id="2410814">&lt;</span>&nbsp;<span class="builtinfunc" id="2410816">len</span><span class="op" id="2410819">(</span><span class="ident" id="2410820">pp</span><span class="op" id="2410822">.</span><span class="ident" id="2410823">Path</span><span class="op" id="2410827">)</span>&nbsp;<span class="op" id="2410829">&amp;&amp;</span>&nbsp;<span class="ident" id="2410832">pp</span><span class="op" id="2410834">.</span><span class="ident" id="2410835">Path</span><span class="op" id="2410839">[</span><span class="ident" id="2410840">n</span><span class="op" id="2410841">]</span>&nbsp;<span class="op" id="2410843">!=</span>&nbsp;<span class="num" id="2410846">0</span>&nbsp;<span class="op" id="2410848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410853">n</span><span class="op" id="2410854">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2410859">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410863">bytes</span>&nbsp;<span class="op" id="2410869">:=</span>&nbsp;<span class="op" id="2410872">(</span><span class="op" id="2410873">*</span><span class="op" id="2410874">[</span><span class="num" id="2410875">10000</span><span class="op" id="2410880">]</span><span class="builtintype" id="2410881">byte</span><span class="op" id="2410885">)</span><span class="op" id="2410886">(</span><span class="ident" id="2410887">unsafe</span><span class="op" id="2410893">.</span><span class="ident" id="2410894">Pointer</span><span class="op" id="2410901">(</span><span class="op" id="2410902">&amp;</span><span class="ident" id="2410903">pp</span><span class="op" id="2410905">.</span><span class="ident" id="2410906">Path</span><span class="op" id="2410910">[</span><span class="num" id="2410911">0</span><span class="op" id="2410912">]</span><span class="op" id="2410913">)</span><span class="op" id="2410914">)</span><span class="op" id="2410915">[</span><span class="num" id="2410916">0</span><span class="op" id="2410917">:</span><span class="ident" id="2410918">n</span><span class="op" id="2410919">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410923">sa</span><span class="op" id="2410925">.</span><span class="ident" id="2410926">Name</span>&nbsp;<span class="op" id="2410931">=</span>&nbsp;<span class="builtintype" id="2410933">string</span><span class="op" id="2410939">(</span><span class="ident" id="2410940">bytes</span><span class="op" id="2410945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410949">return</span>&nbsp;<span class="ident" id="2410956">sa</span><span class="op" id="2410958">,</span>&nbsp;<span class="ident" id="2410960">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2410966">case</span>&nbsp;<span class="ident" id="2410971">AF_INET</span><span class="op" id="2410978">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2410982">pp</span>&nbsp;<span class="op" id="2410985">:=</span>&nbsp;<span class="op" id="2410988">(</span><span class="op" id="2410989">*</span><span class="ident" id="2410990">RawSockaddrInet4</span><span class="op" id="2411006">)</span><span class="op" id="2411007">(</span><span class="ident" id="2411008">unsafe</span><span class="op" id="2411014">.</span><span class="ident" id="2411015">Pointer</span><span class="op" id="2411022">(</span><span class="ident" id="2411023">rsa</span><span class="op" id="2411026">)</span><span class="op" id="2411027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411031">sa</span>&nbsp;<span class="op" id="2411034">:=</span>&nbsp;<span class="builtinfunc" id="2411037">new</span><span class="op" id="2411040">(</span><span class="ident" id="2411041">SockaddrInet4</span><span class="op" id="2411054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411058">p</span>&nbsp;<span class="op" id="2411060">:=</span>&nbsp;<span class="op" id="2411063">(</span><span class="op" id="2411064">*</span><span class="op" id="2411065">[</span><span class="num" id="2411066">2</span><span class="op" id="2411067">]</span><span class="builtintype" id="2411068">byte</span><span class="op" id="2411072">)</span><span class="op" id="2411073">(</span><span class="ident" id="2411074">unsafe</span><span class="op" id="2411080">.</span><span class="ident" id="2411081">Pointer</span><span class="op" id="2411088">(</span><span class="op" id="2411089">&amp;</span><span class="ident" id="2411090">pp</span><span class="op" id="2411092">.</span><span class="ident" id="2411093">Port</span><span class="op" id="2411097">)</span><span class="op" id="2411098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411102">sa</span><span class="op" id="2411104">.</span><span class="ident" id="2411105">Port</span>&nbsp;<span class="op" id="2411110">=</span>&nbsp;<span class="builtintype" id="2411112">int</span><span class="op" id="2411115">(</span><span class="ident" id="2411116">p</span><span class="op" id="2411117">[</span><span class="num" id="2411118">0</span><span class="op" id="2411119">]</span><span class="op" id="2411120">)</span><span class="op" id="2411121">&lt;&lt;</span><span class="num" id="2411123">8</span>&nbsp;<span class="op" id="2411125">+</span>&nbsp;<span class="builtintype" id="2411127">int</span><span class="op" id="2411130">(</span><span class="ident" id="2411131">p</span><span class="op" id="2411132">[</span><span class="num" id="2411133">1</span><span class="op" id="2411134">]</span><span class="op" id="2411135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411139">for</span>&nbsp;<span class="ident" id="2411143">i</span>&nbsp;<span class="op" id="2411145">:=</span>&nbsp;<span class="num" id="2411148">0</span><span class="op" id="2411149">;</span>&nbsp;<span class="ident" id="2411151">i</span>&nbsp;<span class="op" id="2411153">&lt;</span>&nbsp;<span class="builtinfunc" id="2411155">len</span><span class="op" id="2411158">(</span><span class="ident" id="2411159">sa</span><span class="op" id="2411161">.</span><span class="ident" id="2411162">Addr</span><span class="op" id="2411166">)</span><span class="op" id="2411167">;</span>&nbsp;<span class="ident" id="2411169">i</span><span class="op" id="2411170">++</span>&nbsp;<span class="op" id="2411173">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411178">sa</span><span class="op" id="2411180">.</span><span class="ident" id="2411181">Addr</span><span class="op" id="2411185">[</span><span class="ident" id="2411186">i</span><span class="op" id="2411187">]</span>&nbsp;<span class="op" id="2411189">=</span>&nbsp;<span class="ident" id="2411191">pp</span><span class="op" id="2411193">.</span><span class="ident" id="2411194">Addr</span><span class="op" id="2411198">[</span><span class="ident" id="2411199">i</span><span class="op" id="2411200">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411208">return</span>&nbsp;<span class="ident" id="2411215">sa</span><span class="op" id="2411217">,</span>&nbsp;<span class="ident" id="2411219">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411225">case</span>&nbsp;<span class="ident" id="2411230">AF_INET6</span><span class="op" id="2411238">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411242">pp</span>&nbsp;<span class="op" id="2411245">:=</span>&nbsp;<span class="op" id="2411248">(</span><span class="op" id="2411249">*</span><span class="ident" id="2411250">RawSockaddrInet6</span><span class="op" id="2411266">)</span><span class="op" id="2411267">(</span><span class="ident" id="2411268">unsafe</span><span class="op" id="2411274">.</span><span class="ident" id="2411275">Pointer</span><span class="op" id="2411282">(</span><span class="ident" id="2411283">rsa</span><span class="op" id="2411286">)</span><span class="op" id="2411287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411291">sa</span>&nbsp;<span class="op" id="2411294">:=</span>&nbsp;<span class="builtinfunc" id="2411297">new</span><span class="op" id="2411300">(</span><span class="ident" id="2411301">SockaddrInet6</span><span class="op" id="2411314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411318">p</span>&nbsp;<span class="op" id="2411320">:=</span>&nbsp;<span class="op" id="2411323">(</span><span class="op" id="2411324">*</span><span class="op" id="2411325">[</span><span class="num" id="2411326">2</span><span class="op" id="2411327">]</span><span class="builtintype" id="2411328">byte</span><span class="op" id="2411332">)</span><span class="op" id="2411333">(</span><span class="ident" id="2411334">unsafe</span><span class="op" id="2411340">.</span><span class="ident" id="2411341">Pointer</span><span class="op" id="2411348">(</span><span class="op" id="2411349">&amp;</span><span class="ident" id="2411350">pp</span><span class="op" id="2411352">.</span><span class="ident" id="2411353">Port</span><span class="op" id="2411357">)</span><span class="op" id="2411358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411362">sa</span><span class="op" id="2411364">.</span><span class="ident" id="2411365">Port</span>&nbsp;<span class="op" id="2411370">=</span>&nbsp;<span class="builtintype" id="2411372">int</span><span class="op" id="2411375">(</span><span class="ident" id="2411376">p</span><span class="op" id="2411377">[</span><span class="num" id="2411378">0</span><span class="op" id="2411379">]</span><span class="op" id="2411380">)</span><span class="op" id="2411381">&lt;&lt;</span><span class="num" id="2411383">8</span>&nbsp;<span class="op" id="2411385">+</span>&nbsp;<span class="builtintype" id="2411387">int</span><span class="op" id="2411390">(</span><span class="ident" id="2411391">p</span><span class="op" id="2411392">[</span><span class="num" id="2411393">1</span><span class="op" id="2411394">]</span><span class="op" id="2411395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411399">sa</span><span class="op" id="2411401">.</span><span class="ident" id="2411402">ZoneId</span>&nbsp;<span class="op" id="2411409">=</span>&nbsp;<span class="ident" id="2411411">pp</span><span class="op" id="2411413">.</span><span class="ident" id="2411414">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411425">for</span>&nbsp;<span class="ident" id="2411429">i</span>&nbsp;<span class="op" id="2411431">:=</span>&nbsp;<span class="num" id="2411434">0</span><span class="op" id="2411435">;</span>&nbsp;<span class="ident" id="2411437">i</span>&nbsp;<span class="op" id="2411439">&lt;</span>&nbsp;<span class="builtinfunc" id="2411441">len</span><span class="op" id="2411444">(</span><span class="ident" id="2411445">sa</span><span class="op" id="2411447">.</span><span class="ident" id="2411448">Addr</span><span class="op" id="2411452">)</span><span class="op" id="2411453">;</span>&nbsp;<span class="ident" id="2411455">i</span><span class="op" id="2411456">++</span>&nbsp;<span class="op" id="2411459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411464">sa</span><span class="op" id="2411466">.</span><span class="ident" id="2411467">Addr</span><span class="op" id="2411471">[</span><span class="ident" id="2411472">i</span><span class="op" id="2411473">]</span>&nbsp;<span class="op" id="2411475">=</span>&nbsp;<span class="ident" id="2411477">pp</span><span class="op" id="2411479">.</span><span class="ident" id="2411480">Addr</span><span class="op" id="2411484">[</span><span class="ident" id="2411485">i</span><span class="op" id="2411486">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411494">return</span>&nbsp;<span class="ident" id="2411501">sa</span><span class="op" id="2411503">,</span>&nbsp;<span class="ident" id="2411505">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411510">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411513">return</span>&nbsp;<span class="ident" id="2411520">nil</span><span class="op" id="2411523">,</span>&nbsp;<span class="ident" id="2411525">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2411538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2411541">func</span>&nbsp;<span class="ident" id="2411546">Accept</span><span class="op" id="2411552">(</span><span class="ident" id="2411553">fd</span>&nbsp;<span class="builtintype" id="2411556">int</span><span class="op" id="2411559">)</span>&nbsp;<span class="op" id="2411561">(</span><span class="ident" id="2411562">nfd</span>&nbsp;<span class="builtintype" id="2411566">int</span><span class="op" id="2411569">,</span>&nbsp;<span class="ident" id="2411571">sa</span>&nbsp;<span class="ident" id="2411574">Sockaddr</span><span class="op" id="2411582">,</span>&nbsp;<span class="ident" id="2411584">err</span>&nbsp;<span class="builtintype" id="2411588">error</span><span class="op" id="2411593">)</span>&nbsp;<span class="op" id="2411595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411598">var</span>&nbsp;<span class="ident" id="2411602">rsa</span>&nbsp;<span class="ident" id="2411606">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411622">var</span>&nbsp;<span class="builtinfunc" id="2411626">len</span>&nbsp;<span class="ident" id="2411630">_Socklen</span>&nbsp;<span class="op" id="2411639">=</span>&nbsp;<span class="ident" id="2411641">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411660">nfd</span><span class="op" id="2411663">,</span>&nbsp;<span class="ident" id="2411665">err</span>&nbsp;<span class="op" id="2411669">=</span>&nbsp;<span class="ident" id="2411671">accept</span><span class="op" id="2411677">(</span><span class="ident" id="2411678">fd</span><span class="op" id="2411680">,</span>&nbsp;<span class="op" id="2411682">&amp;</span><span class="ident" id="2411683">rsa</span><span class="op" id="2411686">,</span>&nbsp;<span class="op" id="2411688">&amp;</span><span class="builtinfunc" id="2411689">len</span><span class="op" id="2411692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411695">if</span>&nbsp;<span class="ident" id="2411698">err</span>&nbsp;<span class="op" id="2411702">!=</span>&nbsp;<span class="ident" id="2411705">nil</span>&nbsp;<span class="op" id="2411709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411713">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411721">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411724">sa</span><span class="op" id="2411726">,</span>&nbsp;<span class="ident" id="2411728">err</span>&nbsp;<span class="op" id="2411732">=</span>&nbsp;<span class="ident" id="2411734">anyToSockaddr</span><span class="op" id="2411747">(</span><span class="op" id="2411748">&amp;</span><span class="ident" id="2411749">rsa</span><span class="op" id="2411752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411755">if</span>&nbsp;<span class="ident" id="2411758">err</span>&nbsp;<span class="op" id="2411762">!=</span>&nbsp;<span class="ident" id="2411765">nil</span>&nbsp;<span class="op" id="2411769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411773">Close</span><span class="op" id="2411778">(</span><span class="ident" id="2411779">nfd</span><span class="op" id="2411782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411786">nfd</span>&nbsp;<span class="op" id="2411790">=</span>&nbsp;<span class="num" id="2411792">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2411795">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411798">return</span><br>
<span class="lineno"></span><span class="op" id="2411805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2411808">func</span>&nbsp;<span class="ident" id="2411813">Accept4</span><span class="op" id="2411820">(</span><span class="ident" id="2411821">fd</span>&nbsp;<span class="builtintype" id="2411824">int</span><span class="op" id="2411827">,</span>&nbsp;<span class="ident" id="2411829">flags</span>&nbsp;<span class="builtintype" id="2411835">int</span><span class="op" id="2411838">)</span>&nbsp;<span class="op" id="2411840">(</span><span class="ident" id="2411841">nfd</span>&nbsp;<span class="builtintype" id="2411845">int</span><span class="op" id="2411848">,</span>&nbsp;<span class="ident" id="2411850">sa</span>&nbsp;<span class="ident" id="2411853">Sockaddr</span><span class="op" id="2411861">,</span>&nbsp;<span class="ident" id="2411863">err</span>&nbsp;<span class="builtintype" id="2411867">error</span><span class="op" id="2411872">)</span>&nbsp;<span class="op" id="2411874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411877">var</span>&nbsp;<span class="ident" id="2411881">rsa</span>&nbsp;<span class="ident" id="2411885">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411901">var</span>&nbsp;<span class="builtinfunc" id="2411905">len</span>&nbsp;<span class="ident" id="2411909">_Socklen</span>&nbsp;<span class="op" id="2411918">=</span>&nbsp;<span class="ident" id="2411920">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2411939">nfd</span><span class="op" id="2411942">,</span>&nbsp;<span class="ident" id="2411944">err</span>&nbsp;<span class="op" id="2411948">=</span>&nbsp;<span class="ident" id="2411950">accept4</span><span class="op" id="2411957">(</span><span class="ident" id="2411958">fd</span><span class="op" id="2411960">,</span>&nbsp;<span class="op" id="2411962">&amp;</span><span class="ident" id="2411963">rsa</span><span class="op" id="2411966">,</span>&nbsp;<span class="op" id="2411968">&amp;</span><span class="builtinfunc" id="2411969">len</span><span class="op" id="2411972">,</span>&nbsp;<span class="ident" id="2411974">flags</span><span class="op" id="2411979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2411982">if</span>&nbsp;<span class="ident" id="2411985">err</span>&nbsp;<span class="op" id="2411989">!=</span>&nbsp;<span class="ident" id="2411992">nil</span>&nbsp;<span class="op" id="2411996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412000">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2412008">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412011">if</span>&nbsp;<span class="builtinfunc" id="2412014">len</span>&nbsp;<span class="op" id="2412018">&gt;</span>&nbsp;<span class="ident" id="2412020">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2412038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2412042">panic</span><span class="op" id="2412047">(</span><span class="string" id="2412048">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2412074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2412077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412080">sa</span><span class="op" id="2412082">,</span>&nbsp;<span class="ident" id="2412084">err</span>&nbsp;<span class="op" id="2412088">=</span>&nbsp;<span class="ident" id="2412090">anyToSockaddr</span><span class="op" id="2412103">(</span><span class="op" id="2412104">&amp;</span><span class="ident" id="2412105">rsa</span><span class="op" id="2412108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412111">if</span>&nbsp;<span class="ident" id="2412114">err</span>&nbsp;<span class="op" id="2412118">!=</span>&nbsp;<span class="ident" id="2412121">nil</span>&nbsp;<span class="op" id="2412125">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412129">Close</span><span class="op" id="2412134">(</span><span class="ident" id="2412135">nfd</span><span class="op" id="2412138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412142">nfd</span>&nbsp;<span class="op" id="2412146">=</span>&nbsp;<span class="num" id="2412148">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2412151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412154">return</span><br>
<span class="lineno"></span><span class="op" id="2412161">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2412164">func</span>&nbsp;<span class="ident" id="2412169">Getsockname</span><span class="op" id="2412180">(</span><span class="ident" id="2412181">fd</span>&nbsp;<span class="builtintype" id="2412184">int</span><span class="op" id="2412187">)</span>&nbsp;<span class="op" id="2412189">(</span><span class="ident" id="2412190">sa</span>&nbsp;<span class="ident" id="2412193">Sockaddr</span><span class="op" id="2412201">,</span>&nbsp;<span class="ident" id="2412203">err</span>&nbsp;<span class="builtintype" id="2412207">error</span><span class="op" id="2412212">)</span>&nbsp;<span class="op" id="2412214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412217">var</span>&nbsp;<span class="ident" id="2412221">rsa</span>&nbsp;<span class="ident" id="2412225">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412241">var</span>&nbsp;<span class="builtinfunc" id="2412245">len</span>&nbsp;<span class="ident" id="2412249">_Socklen</span>&nbsp;<span class="op" id="2412258">=</span>&nbsp;<span class="ident" id="2412260">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412279">if</span>&nbsp;<span class="ident" id="2412282">err</span>&nbsp;<span class="op" id="2412286">=</span>&nbsp;<span class="ident" id="2412288">getsockname</span><span class="op" id="2412299">(</span><span class="ident" id="2412300">fd</span><span class="op" id="2412302">,</span>&nbsp;<span class="op" id="2412304">&amp;</span><span class="ident" id="2412305">rsa</span><span class="op" id="2412308">,</span>&nbsp;<span class="op" id="2412310">&amp;</span><span class="builtinfunc" id="2412311">len</span><span class="op" id="2412314">)</span><span class="op" id="2412315">;</span>&nbsp;<span class="ident" id="2412317">err</span>&nbsp;<span class="op" id="2412321">!=</span>&nbsp;<span class="ident" id="2412324">nil</span>&nbsp;<span class="op" id="2412328">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412332">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2412340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412343">return</span>&nbsp;<span class="ident" id="2412350">anyToSockaddr</span><span class="op" id="2412363">(</span><span class="op" id="2412364">&amp;</span><span class="ident" id="2412365">rsa</span><span class="op" id="2412368">)</span><br>
<span class="lineno"></span><span class="op" id="2412370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2412373">func</span>&nbsp;<span class="ident" id="2412378">GetsockoptInet4Addr</span><span class="op" id="2412397">(</span><span class="ident" id="2412398">fd</span><span class="op" id="2412400">,</span>&nbsp;<span class="ident" id="2412402">level</span><span class="op" id="2412407">,</span>&nbsp;<span class="ident" id="2412409">opt</span>&nbsp;<span class="builtintype" id="2412413">int</span><span class="op" id="2412416">)</span>&nbsp;<span class="op" id="2412418">(</span><span class="ident" id="2412419">value</span>&nbsp;<span class="op" id="2412425">[</span><span class="num" id="2412426">4</span><span class="op" id="2412427">]</span><span class="builtintype" id="2412428">byte</span><span class="op" id="2412432">,</span>&nbsp;<span class="ident" id="2412434">err</span>&nbsp;<span class="builtintype" id="2412438">error</span><span class="op" id="2412443">)</span>&nbsp;<span class="op" id="2412445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412448">vallen</span>&nbsp;<span class="op" id="2412455">:=</span>&nbsp;<span class="ident" id="2412458">_Socklen</span><span class="op" id="2412466">(</span><span class="num" id="2412467">4</span><span class="op" id="2412468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412471">err</span>&nbsp;<span class="op" id="2412475">=</span>&nbsp;<span class="ident" id="2412477">getsockopt</span><span class="op" id="2412487">(</span><span class="ident" id="2412488">fd</span><span class="op" id="2412490">,</span>&nbsp;<span class="ident" id="2412492">level</span><span class="op" id="2412497">,</span>&nbsp;<span class="ident" id="2412499">opt</span><span class="op" id="2412502">,</span>&nbsp;<span class="ident" id="2412504">unsafe</span><span class="op" id="2412510">.</span><span class="ident" id="2412511">Pointer</span><span class="op" id="2412518">(</span><span class="op" id="2412519">&amp;</span><span class="ident" id="2412520">value</span><span class="op" id="2412525">[</span><span class="num" id="2412526">0</span><span class="op" id="2412527">]</span><span class="op" id="2412528">)</span><span class="op" id="2412529">,</span>&nbsp;<span class="op" id="2412531">&amp;</span><span class="ident" id="2412532">vallen</span><span class="op" id="2412538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412541">return</span>&nbsp;<span class="ident" id="2412548">value</span><span class="op" id="2412553">,</span>&nbsp;<span class="ident" id="2412555">err</span><br>
<span class="lineno"></span><span class="op" id="2412559">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2412562">func</span>&nbsp;<span class="ident" id="2412567">GetsockoptIPMreq</span><span class="op" id="2412583">(</span><span class="ident" id="2412584">fd</span><span class="op" id="2412586">,</span>&nbsp;<span class="ident" id="2412588">level</span><span class="op" id="2412593">,</span>&nbsp;<span class="ident" id="2412595">opt</span>&nbsp;<span class="builtintype" id="2412599">int</span><span class="op" id="2412602">)</span>&nbsp;<span class="op" id="2412604">(</span><span class="op" id="2412605">*</span><span class="ident" id="2412606">IPMreq</span><span class="op" id="2412612">,</span>&nbsp;<span class="builtintype" id="2412614">error</span><span class="op" id="2412619">)</span>&nbsp;<span class="op" id="2412621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412624">var</span>&nbsp;<span class="ident" id="2412628">value</span>&nbsp;<span class="ident" id="2412634">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412642">vallen</span>&nbsp;<span class="op" id="2412649">:=</span>&nbsp;<span class="ident" id="2412652">_Socklen</span><span class="op" id="2412660">(</span><span class="ident" id="2412661">SizeofIPMreq</span><span class="op" id="2412673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412676">err</span>&nbsp;<span class="op" id="2412680">:=</span>&nbsp;<span class="ident" id="2412683">getsockopt</span><span class="op" id="2412693">(</span><span class="ident" id="2412694">fd</span><span class="op" id="2412696">,</span>&nbsp;<span class="ident" id="2412698">level</span><span class="op" id="2412703">,</span>&nbsp;<span class="ident" id="2412705">opt</span><span class="op" id="2412708">,</span>&nbsp;<span class="ident" id="2412710">unsafe</span><span class="op" id="2412716">.</span><span class="ident" id="2412717">Pointer</span><span class="op" id="2412724">(</span><span class="op" id="2412725">&amp;</span><span class="ident" id="2412726">value</span><span class="op" id="2412731">)</span><span class="op" id="2412732">,</span>&nbsp;<span class="op" id="2412734">&amp;</span><span class="ident" id="2412735">vallen</span><span class="op" id="2412741">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412744">return</span>&nbsp;<span class="op" id="2412751">&amp;</span><span class="ident" id="2412752">value</span><span class="op" id="2412757">,</span>&nbsp;<span class="ident" id="2412759">err</span><br>
<span class="lineno"></span><span class="op" id="2412763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2412766">func</span>&nbsp;<span class="ident" id="2412771">GetsockoptIPMreqn</span><span class="op" id="2412788">(</span><span class="ident" id="2412789">fd</span><span class="op" id="2412791">,</span>&nbsp;<span class="ident" id="2412793">level</span><span class="op" id="2412798">,</span>&nbsp;<span class="ident" id="2412800">opt</span>&nbsp;<span class="builtintype" id="2412804">int</span><span class="op" id="2412807">)</span>&nbsp;<span class="op" id="2412809">(</span><span class="op" id="2412810">*</span><span class="ident" id="2412811">IPMreqn</span><span class="op" id="2412818">,</span>&nbsp;<span class="builtintype" id="2412820">error</span><span class="op" id="2412825">)</span>&nbsp;<span class="op" id="2412827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412830">var</span>&nbsp;<span class="ident" id="2412834">value</span>&nbsp;<span class="ident" id="2412840">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412849">vallen</span>&nbsp;<span class="op" id="2412856">:=</span>&nbsp;<span class="ident" id="2412859">_Socklen</span><span class="op" id="2412867">(</span><span class="ident" id="2412868">SizeofIPMreqn</span><span class="op" id="2412881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2412884">err</span>&nbsp;<span class="op" id="2412888">:=</span>&nbsp;<span class="ident" id="2412891">getsockopt</span><span class="op" id="2412901">(</span><span class="ident" id="2412902">fd</span><span class="op" id="2412904">,</span>&nbsp;<span class="ident" id="2412906">level</span><span class="op" id="2412911">,</span>&nbsp;<span class="ident" id="2412913">opt</span><span class="op" id="2412916">,</span>&nbsp;<span class="ident" id="2412918">unsafe</span><span class="op" id="2412924">.</span><span class="ident" id="2412925">Pointer</span><span class="op" id="2412932">(</span><span class="op" id="2412933">&amp;</span><span class="ident" id="2412934">value</span><span class="op" id="2412939">)</span><span class="op" id="2412940">,</span>&nbsp;<span class="op" id="2412942">&amp;</span><span class="ident" id="2412943">vallen</span><span class="op" id="2412949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2412952">return</span>&nbsp;<span class="op" id="2412959">&amp;</span><span class="ident" id="2412960">value</span><span class="op" id="2412965">,</span>&nbsp;<span class="ident" id="2412967">err</span><br>
<span class="lineno"></span><span class="op" id="2412971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2412974">func</span>&nbsp;<span class="ident" id="2412979">GetsockoptIPv6Mreq</span><span class="op" id="2412997">(</span><span class="ident" id="2412998">fd</span><span class="op" id="2413000">,</span>&nbsp;<span class="ident" id="2413002">level</span><span class="op" id="2413007">,</span>&nbsp;<span class="ident" id="2413009">opt</span>&nbsp;<span class="builtintype" id="2413013">int</span><span class="op" id="2413016">)</span>&nbsp;<span class="op" id="2413018">(</span><span class="op" id="2413019">*</span><span class="ident" id="2413020">IPv6Mreq</span><span class="op" id="2413028">,</span>&nbsp;<span class="builtintype" id="2413030">error</span><span class="op" id="2413035">)</span>&nbsp;<span class="op" id="2413037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413040">var</span>&nbsp;<span class="ident" id="2413044">value</span>&nbsp;<span class="ident" id="2413050">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413060">vallen</span>&nbsp;<span class="op" id="2413067">:=</span>&nbsp;<span class="ident" id="2413070">_Socklen</span><span class="op" id="2413078">(</span><span class="ident" id="2413079">SizeofIPv6Mreq</span><span class="op" id="2413093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413096">err</span>&nbsp;<span class="op" id="2413100">:=</span>&nbsp;<span class="ident" id="2413103">getsockopt</span><span class="op" id="2413113">(</span><span class="ident" id="2413114">fd</span><span class="op" id="2413116">,</span>&nbsp;<span class="ident" id="2413118">level</span><span class="op" id="2413123">,</span>&nbsp;<span class="ident" id="2413125">opt</span><span class="op" id="2413128">,</span>&nbsp;<span class="ident" id="2413130">unsafe</span><span class="op" id="2413136">.</span><span class="ident" id="2413137">Pointer</span><span class="op" id="2413144">(</span><span class="op" id="2413145">&amp;</span><span class="ident" id="2413146">value</span><span class="op" id="2413151">)</span><span class="op" id="2413152">,</span>&nbsp;<span class="op" id="2413154">&amp;</span><span class="ident" id="2413155">vallen</span><span class="op" id="2413161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413164">return</span>&nbsp;<span class="op" id="2413171">&amp;</span><span class="ident" id="2413172">value</span><span class="op" id="2413177">,</span>&nbsp;<span class="ident" id="2413179">err</span><br>
<span class="lineno">470</span><span class="op" id="2413183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413186">func</span>&nbsp;<span class="ident" id="2413191">GetsockoptIPv6MTUInfo</span><span class="op" id="2413212">(</span><span class="ident" id="2413213">fd</span><span class="op" id="2413215">,</span>&nbsp;<span class="ident" id="2413217">level</span><span class="op" id="2413222">,</span>&nbsp;<span class="ident" id="2413224">opt</span>&nbsp;<span class="builtintype" id="2413228">int</span><span class="op" id="2413231">)</span>&nbsp;<span class="op" id="2413233">(</span><span class="op" id="2413234">*</span><span class="ident" id="2413235">IPv6MTUInfo</span><span class="op" id="2413246">,</span>&nbsp;<span class="builtintype" id="2413248">error</span><span class="op" id="2413253">)</span>&nbsp;<span class="op" id="2413255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413258">var</span>&nbsp;<span class="ident" id="2413262">value</span>&nbsp;<span class="ident" id="2413268">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413281">vallen</span>&nbsp;<span class="op" id="2413288">:=</span>&nbsp;<span class="ident" id="2413291">_Socklen</span><span class="op" id="2413299">(</span><span class="ident" id="2413300">SizeofIPv6MTUInfo</span><span class="op" id="2413317">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413320">err</span>&nbsp;<span class="op" id="2413324">:=</span>&nbsp;<span class="ident" id="2413327">getsockopt</span><span class="op" id="2413337">(</span><span class="ident" id="2413338">fd</span><span class="op" id="2413340">,</span>&nbsp;<span class="ident" id="2413342">level</span><span class="op" id="2413347">,</span>&nbsp;<span class="ident" id="2413349">opt</span><span class="op" id="2413352">,</span>&nbsp;<span class="ident" id="2413354">unsafe</span><span class="op" id="2413360">.</span><span class="ident" id="2413361">Pointer</span><span class="op" id="2413368">(</span><span class="op" id="2413369">&amp;</span><span class="ident" id="2413370">value</span><span class="op" id="2413375">)</span><span class="op" id="2413376">,</span>&nbsp;<span class="op" id="2413378">&amp;</span><span class="ident" id="2413379">vallen</span><span class="op" id="2413385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413388">return</span>&nbsp;<span class="op" id="2413395">&amp;</span><span class="ident" id="2413396">value</span><span class="op" id="2413401">,</span>&nbsp;<span class="ident" id="2413403">err</span><br>
<span class="lineno"></span><span class="op" id="2413407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413410">func</span>&nbsp;<span class="ident" id="2413415">GetsockoptICMPv6Filter</span><span class="op" id="2413437">(</span><span class="ident" id="2413438">fd</span><span class="op" id="2413440">,</span>&nbsp;<span class="ident" id="2413442">level</span><span class="op" id="2413447">,</span>&nbsp;<span class="ident" id="2413449">opt</span>&nbsp;<span class="builtintype" id="2413453">int</span><span class="op" id="2413456">)</span>&nbsp;<span class="op" id="2413458">(</span><span class="op" id="2413459">*</span><span class="ident" id="2413460">ICMPv6Filter</span><span class="op" id="2413472">,</span>&nbsp;<span class="builtintype" id="2413474">error</span><span class="op" id="2413479">)</span>&nbsp;<span class="op" id="2413481">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413484">var</span>&nbsp;<span class="ident" id="2413488">value</span>&nbsp;<span class="ident" id="2413494">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413508">vallen</span>&nbsp;<span class="op" id="2413515">:=</span>&nbsp;<span class="ident" id="2413518">_Socklen</span><span class="op" id="2413526">(</span><span class="ident" id="2413527">SizeofICMPv6Filter</span><span class="op" id="2413545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413548">err</span>&nbsp;<span class="op" id="2413552">:=</span>&nbsp;<span class="ident" id="2413555">getsockopt</span><span class="op" id="2413565">(</span><span class="ident" id="2413566">fd</span><span class="op" id="2413568">,</span>&nbsp;<span class="ident" id="2413570">level</span><span class="op" id="2413575">,</span>&nbsp;<span class="ident" id="2413577">opt</span><span class="op" id="2413580">,</span>&nbsp;<span class="ident" id="2413582">unsafe</span><span class="op" id="2413588">.</span><span class="ident" id="2413589">Pointer</span><span class="op" id="2413596">(</span><span class="op" id="2413597">&amp;</span><span class="ident" id="2413598">value</span><span class="op" id="2413603">)</span><span class="op" id="2413604">,</span>&nbsp;<span class="op" id="2413606">&amp;</span><span class="ident" id="2413607">vallen</span><span class="op" id="2413613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413616">return</span>&nbsp;<span class="op" id="2413623">&amp;</span><span class="ident" id="2413624">value</span><span class="op" id="2413629">,</span>&nbsp;<span class="ident" id="2413631">err</span><br>
<span class="lineno"></span><span class="op" id="2413635">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2413638">func</span>&nbsp;<span class="ident" id="2413643">GetsockoptUcred</span><span class="op" id="2413658">(</span><span class="ident" id="2413659">fd</span><span class="op" id="2413661">,</span>&nbsp;<span class="ident" id="2413663">level</span><span class="op" id="2413668">,</span>&nbsp;<span class="ident" id="2413670">opt</span>&nbsp;<span class="builtintype" id="2413674">int</span><span class="op" id="2413677">)</span>&nbsp;<span class="op" id="2413679">(</span><span class="op" id="2413680">*</span><span class="ident" id="2413681">Ucred</span><span class="op" id="2413686">,</span>&nbsp;<span class="builtintype" id="2413688">error</span><span class="op" id="2413693">)</span>&nbsp;<span class="op" id="2413695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413698">var</span>&nbsp;<span class="ident" id="2413702">value</span>&nbsp;<span class="ident" id="2413708">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413715">vallen</span>&nbsp;<span class="op" id="2413722">:=</span>&nbsp;<span class="ident" id="2413725">_Socklen</span><span class="op" id="2413733">(</span><span class="ident" id="2413734">SizeofUcred</span><span class="op" id="2413745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413748">err</span>&nbsp;<span class="op" id="2413752">:=</span>&nbsp;<span class="ident" id="2413755">getsockopt</span><span class="op" id="2413765">(</span><span class="ident" id="2413766">fd</span><span class="op" id="2413768">,</span>&nbsp;<span class="ident" id="2413770">level</span><span class="op" id="2413775">,</span>&nbsp;<span class="ident" id="2413777">opt</span><span class="op" id="2413780">,</span>&nbsp;<span class="ident" id="2413782">unsafe</span><span class="op" id="2413788">.</span><span class="ident" id="2413789">Pointer</span><span class="op" id="2413796">(</span><span class="op" id="2413797">&amp;</span><span class="ident" id="2413798">value</span><span class="op" id="2413803">)</span><span class="op" id="2413804">,</span>&nbsp;<span class="op" id="2413806">&amp;</span><span class="ident" id="2413807">vallen</span><span class="op" id="2413813">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413816">return</span>&nbsp;<span class="op" id="2413823">&amp;</span><span class="ident" id="2413824">value</span><span class="op" id="2413829">,</span>&nbsp;<span class="ident" id="2413831">err</span><br>
<span class="lineno"></span><span class="op" id="2413835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413838">func</span>&nbsp;<span class="ident" id="2413843">SetsockoptIPMreqn</span><span class="op" id="2413860">(</span><span class="ident" id="2413861">fd</span><span class="op" id="2413863">,</span>&nbsp;<span class="ident" id="2413865">level</span><span class="op" id="2413870">,</span>&nbsp;<span class="ident" id="2413872">opt</span>&nbsp;<span class="builtintype" id="2413876">int</span><span class="op" id="2413879">,</span>&nbsp;<span class="ident" id="2413881">mreq</span>&nbsp;<span class="op" id="2413886">*</span><span class="ident" id="2413887">IPMreqn</span><span class="op" id="2413894">)</span>&nbsp;<span class="op" id="2413896">(</span><span class="ident" id="2413897">err</span>&nbsp;<span class="builtintype" id="2413901">error</span><span class="op" id="2413906">)</span>&nbsp;<span class="op" id="2413908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2413911">return</span>&nbsp;<span class="ident" id="2413918">setsockopt</span><span class="op" id="2413928">(</span><span class="ident" id="2413929">fd</span><span class="op" id="2413931">,</span>&nbsp;<span class="ident" id="2413933">level</span><span class="op" id="2413938">,</span>&nbsp;<span class="ident" id="2413940">opt</span><span class="op" id="2413943">,</span>&nbsp;<span class="ident" id="2413945">unsafe</span><span class="op" id="2413951">.</span><span class="ident" id="2413952">Pointer</span><span class="op" id="2413959">(</span><span class="ident" id="2413960">mreq</span><span class="op" id="2413964">)</span><span class="op" id="2413965">,</span>&nbsp;<span class="ident" id="2413967">unsafe</span><span class="op" id="2413973">.</span><span class="ident" id="2413974">Sizeof</span><span class="op" id="2413980">(</span><span class="op" id="2413981">*</span><span class="ident" id="2413982">mreq</span><span class="op" id="2413986">)</span><span class="op" id="2413987">)</span><br>
<span class="lineno">495</span><span class="op" id="2413989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413992">func</span>&nbsp;<span class="ident" id="2413997">Recvmsg</span><span class="op" id="2414004">(</span><span class="ident" id="2414005">fd</span>&nbsp;<span class="builtintype" id="2414008">int</span><span class="op" id="2414011">,</span>&nbsp;<span class="ident" id="2414013">p</span><span class="op" id="2414014">,</span>&nbsp;<span class="ident" id="2414016">oob</span>&nbsp;<span class="op" id="2414020">[</span><span class="op" id="2414021">]</span><span class="builtintype" id="2414022">byte</span><span class="op" id="2414026">,</span>&nbsp;<span class="ident" id="2414028">flags</span>&nbsp;<span class="builtintype" id="2414034">int</span><span class="op" id="2414037">)</span>&nbsp;<span class="op" id="2414039">(</span><span class="ident" id="2414040">n</span><span class="op" id="2414041">,</span>&nbsp;<span class="ident" id="2414043">oobn</span>&nbsp;<span class="builtintype" id="2414048">int</span><span class="op" id="2414051">,</span>&nbsp;<span class="ident" id="2414053">recvflags</span>&nbsp;<span class="builtintype" id="2414063">int</span><span class="op" id="2414066">,</span>&nbsp;<span class="ident" id="2414068">from</span>&nbsp;<span class="ident" id="2414073">Sockaddr</span><span class="op" id="2414081">,</span>&nbsp;<span class="ident" id="2414083">err</span>&nbsp;<span class="builtintype" id="2414087">error</span><span class="op" id="2414092">)</span>&nbsp;<span class="op" id="2414094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414097">var</span>&nbsp;<span class="ident" id="2414101">msg</span>&nbsp;<span class="ident" id="2414105">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414113">var</span>&nbsp;<span class="ident" id="2414117">rsa</span>&nbsp;<span class="ident" id="2414121">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414137">msg</span><span class="op" id="2414140">.</span><span class="ident" id="2414141">Name</span>&nbsp;<span class="op" id="2414146">=</span>&nbsp;<span class="op" id="2414148">(</span><span class="op" id="2414149">*</span><span class="builtintype" id="2414150">byte</span><span class="op" id="2414154">)</span><span class="op" id="2414155">(</span><span class="ident" id="2414156">unsafe</span><span class="op" id="2414162">.</span><span class="ident" id="2414163">Pointer</span><span class="op" id="2414170">(</span><span class="op" id="2414171">&amp;</span><span class="ident" id="2414172">rsa</span><span class="op" id="2414175">)</span><span class="op" id="2414176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414179">msg</span><span class="op" id="2414182">.</span><span class="ident" id="2414183">Namelen</span>&nbsp;<span class="op" id="2414191">=</span>&nbsp;<span class="builtintype" id="2414193">uint32</span><span class="op" id="2414199">(</span><span class="ident" id="2414200">SizeofSockaddrAny</span><span class="op" id="2414217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414220">var</span>&nbsp;<span class="ident" id="2414224">iov</span>&nbsp;<span class="ident" id="2414228">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414235">if</span>&nbsp;<span class="builtinfunc" id="2414238">len</span><span class="op" id="2414241">(</span><span class="ident" id="2414242">p</span><span class="op" id="2414243">)</span>&nbsp;<span class="op" id="2414245">&gt;</span>&nbsp;<span class="num" id="2414247">0</span>&nbsp;<span class="op" id="2414249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414253">iov</span><span class="op" id="2414256">.</span><span class="ident" id="2414257">Base</span>&nbsp;<span class="op" id="2414262">=</span>&nbsp;<span class="op" id="2414264">(</span><span class="op" id="2414265">*</span><span class="builtintype" id="2414266">byte</span><span class="op" id="2414270">)</span><span class="op" id="2414271">(</span><span class="ident" id="2414272">unsafe</span><span class="op" id="2414278">.</span><span class="ident" id="2414279">Pointer</span><span class="op" id="2414286">(</span><span class="op" id="2414287">&amp;</span><span class="ident" id="2414288">p</span><span class="op" id="2414289">[</span><span class="num" id="2414290">0</span><span class="op" id="2414291">]</span><span class="op" id="2414292">)</span><span class="op" id="2414293">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414297">iov</span><span class="op" id="2414300">.</span><span class="ident" id="2414301">SetLen</span><span class="op" id="2414307">(</span><span class="builtinfunc" id="2414308">len</span><span class="op" id="2414311">(</span><span class="ident" id="2414312">p</span><span class="op" id="2414313">)</span><span class="op" id="2414314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2414317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414320">var</span>&nbsp;<span class="ident" id="2414324">dummy</span>&nbsp;<span class="builtintype" id="2414330">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414336">if</span>&nbsp;<span class="builtinfunc" id="2414339">len</span><span class="op" id="2414342">(</span><span class="ident" id="2414343">oob</span><span class="op" id="2414346">)</span>&nbsp;<span class="op" id="2414348">&gt;</span>&nbsp;<span class="num" id="2414350">0</span>&nbsp;<span class="op" id="2414352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414356">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414394">if</span>&nbsp;<span class="builtinfunc" id="2414397">len</span><span class="op" id="2414400">(</span><span class="ident" id="2414401">p</span><span class="op" id="2414402">)</span>&nbsp;<span class="op" id="2414404">==</span>&nbsp;<span class="num" id="2414407">0</span>&nbsp;<span class="op" id="2414409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414414">iov</span><span class="op" id="2414417">.</span><span class="ident" id="2414418">Base</span>&nbsp;<span class="op" id="2414423">=</span>&nbsp;<span class="op" id="2414425">&amp;</span><span class="ident" id="2414426">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414435">iov</span><span class="op" id="2414438">.</span><span class="ident" id="2414439">SetLen</span><span class="op" id="2414445">(</span><span class="num" id="2414446">1</span><span class="op" id="2414447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2414451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414455">msg</span><span class="op" id="2414458">.</span><span class="ident" id="2414459">Control</span>&nbsp;<span class="op" id="2414467">=</span>&nbsp;<span class="op" id="2414469">(</span><span class="op" id="2414470">*</span><span class="builtintype" id="2414471">byte</span><span class="op" id="2414475">)</span><span class="op" id="2414476">(</span><span class="ident" id="2414477">unsafe</span><span class="op" id="2414483">.</span><span class="ident" id="2414484">Pointer</span><span class="op" id="2414491">(</span><span class="op" id="2414492">&amp;</span><span class="ident" id="2414493">oob</span><span class="op" id="2414496">[</span><span class="num" id="2414497">0</span><span class="op" id="2414498">]</span><span class="op" id="2414499">)</span><span class="op" id="2414500">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414504">msg</span><span class="op" id="2414507">.</span><span class="ident" id="2414508">SetControllen</span><span class="op" id="2414521">(</span><span class="builtinfunc" id="2414522">len</span><span class="op" id="2414525">(</span><span class="ident" id="2414526">oob</span><span class="op" id="2414529">)</span><span class="op" id="2414530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2414533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414536">msg</span><span class="op" id="2414539">.</span><span class="ident" id="2414540">Iov</span>&nbsp;<span class="op" id="2414544">=</span>&nbsp;<span class="op" id="2414546">&amp;</span><span class="ident" id="2414547">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414552">msg</span><span class="op" id="2414555">.</span><span class="ident" id="2414556">Iovlen</span>&nbsp;<span class="op" id="2414563">=</span>&nbsp;<span class="num" id="2414565">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414568">if</span>&nbsp;<span class="ident" id="2414571">n</span><span class="op" id="2414572">,</span>&nbsp;<span class="ident" id="2414574">err</span>&nbsp;<span class="op" id="2414578">=</span>&nbsp;<span class="ident" id="2414580">recvmsg</span><span class="op" id="2414587">(</span><span class="ident" id="2414588">fd</span><span class="op" id="2414590">,</span>&nbsp;<span class="op" id="2414592">&amp;</span><span class="ident" id="2414593">msg</span><span class="op" id="2414596">,</span>&nbsp;<span class="ident" id="2414598">flags</span><span class="op" id="2414603">)</span><span class="op" id="2414604">;</span>&nbsp;<span class="ident" id="2414606">err</span>&nbsp;<span class="op" id="2414610">!=</span>&nbsp;<span class="ident" id="2414613">nil</span>&nbsp;<span class="op" id="2414617">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414621">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2414629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414632">oobn</span>&nbsp;<span class="op" id="2414637">=</span>&nbsp;<span class="builtintype" id="2414639">int</span><span class="op" id="2414642">(</span><span class="ident" id="2414643">msg</span><span class="op" id="2414646">.</span><span class="ident" id="2414647">Controllen</span><span class="op" id="2414657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414660">recvflags</span>&nbsp;<span class="op" id="2414670">=</span>&nbsp;<span class="builtintype" id="2414672">int</span><span class="op" id="2414675">(</span><span class="ident" id="2414676">msg</span><span class="op" id="2414679">.</span><span class="ident" id="2414680">Flags</span><span class="op" id="2414685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414688">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414754">if</span>&nbsp;<span class="ident" id="2414757">rsa</span><span class="op" id="2414760">.</span><span class="ident" id="2414761">Addr</span><span class="op" id="2414765">.</span><span class="ident" id="2414766">Family</span>&nbsp;<span class="op" id="2414773">!=</span>&nbsp;<span class="ident" id="2414776">AF_UNSPEC</span>&nbsp;<span class="op" id="2414786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414790">from</span><span class="op" id="2414794">,</span>&nbsp;<span class="ident" id="2414796">err</span>&nbsp;<span class="op" id="2414800">=</span>&nbsp;<span class="ident" id="2414802">anyToSockaddr</span><span class="op" id="2414815">(</span><span class="op" id="2414816">&amp;</span><span class="ident" id="2414817">rsa</span><span class="op" id="2414820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2414823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414826">return</span><br>
<span class="lineno"></span><span class="op" id="2414833">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2414836">func</span>&nbsp;<span class="ident" id="2414841">Sendmsg</span><span class="op" id="2414848">(</span><span class="ident" id="2414849">fd</span>&nbsp;<span class="builtintype" id="2414852">int</span><span class="op" id="2414855">,</span>&nbsp;<span class="ident" id="2414857">p</span><span class="op" id="2414858">,</span>&nbsp;<span class="ident" id="2414860">oob</span>&nbsp;<span class="op" id="2414864">[</span><span class="op" id="2414865">]</span><span class="builtintype" id="2414866">byte</span><span class="op" id="2414870">,</span>&nbsp;<span class="ident" id="2414872">to</span>&nbsp;<span class="ident" id="2414875">Sockaddr</span><span class="op" id="2414883">,</span>&nbsp;<span class="ident" id="2414885">flags</span>&nbsp;<span class="builtintype" id="2414891">int</span><span class="op" id="2414894">)</span>&nbsp;<span class="op" id="2414896">(</span><span class="ident" id="2414897">err</span>&nbsp;<span class="builtintype" id="2414901">error</span><span class="op" id="2414906">)</span>&nbsp;<span class="op" id="2414908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414911">_</span><span class="op" id="2414912">,</span>&nbsp;<span class="ident" id="2414914">err</span>&nbsp;<span class="op" id="2414918">=</span>&nbsp;<span class="ident" id="2414920">SendmsgN</span><span class="op" id="2414928">(</span><span class="ident" id="2414929">fd</span><span class="op" id="2414931">,</span>&nbsp;<span class="ident" id="2414933">p</span><span class="op" id="2414934">,</span>&nbsp;<span class="ident" id="2414936">oob</span><span class="op" id="2414939">,</span>&nbsp;<span class="ident" id="2414941">to</span><span class="op" id="2414943">,</span>&nbsp;<span class="ident" id="2414945">flags</span><span class="op" id="2414950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2414953">return</span><br>
<span class="lineno"></span><span class="op" id="2414960">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2414963">func</span>&nbsp;<span class="ident" id="2414968">SendmsgN</span><span class="op" id="2414976">(</span><span class="ident" id="2414977">fd</span>&nbsp;<span class="builtintype" id="2414980">int</span><span class="op" id="2414983">,</span>&nbsp;<span class="ident" id="2414985">p</span><span class="op" id="2414986">,</span>&nbsp;<span class="ident" id="2414988">oob</span>&nbsp;<span class="op" id="2414992">[</span><span class="op" id="2414993">]</span><span class="builtintype" id="2414994">byte</span><span class="op" id="2414998">,</span>&nbsp;<span class="ident" id="2415000">to</span>&nbsp;<span class="ident" id="2415003">Sockaddr</span><span class="op" id="2415011">,</span>&nbsp;<span class="ident" id="2415013">flags</span>&nbsp;<span class="builtintype" id="2415019">int</span><span class="op" id="2415022">)</span>&nbsp;<span class="op" id="2415024">(</span><span class="ident" id="2415025">n</span>&nbsp;<span class="builtintype" id="2415027">int</span><span class="op" id="2415030">,</span>&nbsp;<span class="ident" id="2415032">err</span>&nbsp;<span class="builtintype" id="2415036">error</span><span class="op" id="2415041">)</span>&nbsp;<span class="op" id="2415043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415046">var</span>&nbsp;<span class="ident" id="2415050">ptr</span>&nbsp;<span class="ident" id="2415054">unsafe</span><span class="op" id="2415060">.</span><span class="ident" id="2415061">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415070">var</span>&nbsp;<span class="ident" id="2415074">salen</span>&nbsp;<span class="ident" id="2415080">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415090">if</span>&nbsp;<span class="ident" id="2415093">to</span>&nbsp;<span class="op" id="2415096">!=</span>&nbsp;<span class="ident" id="2415099">nil</span>&nbsp;<span class="op" id="2415103">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415107">var</span>&nbsp;<span class="ident" id="2415111">err</span>&nbsp;<span class="builtintype" id="2415115">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415123">ptr</span><span class="op" id="2415126">,</span>&nbsp;<span class="ident" id="2415128">salen</span><span class="op" id="2415133">,</span>&nbsp;<span class="ident" id="2415135">err</span>&nbsp;<span class="op" id="2415139">=</span>&nbsp;<span class="ident" id="2415141">to</span><span class="op" id="2415143">.</span><span class="ident" id="2415144">sockaddr</span><span class="op" id="2415152">(</span><span class="op" id="2415153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415157">if</span>&nbsp;<span class="ident" id="2415160">err</span>&nbsp;<span class="op" id="2415164">!=</span>&nbsp;<span class="ident" id="2415167">nil</span>&nbsp;<span class="op" id="2415171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415176">return</span>&nbsp;<span class="num" id="2415183">0</span><span class="op" id="2415184">,</span>&nbsp;<span class="ident" id="2415186">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415192">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415198">var</span>&nbsp;<span class="ident" id="2415202">msg</span>&nbsp;<span class="ident" id="2415206">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415214">msg</span><span class="op" id="2415217">.</span><span class="ident" id="2415218">Name</span>&nbsp;<span class="op" id="2415223">=</span>&nbsp;<span class="op" id="2415225">(</span><span class="op" id="2415226">*</span><span class="builtintype" id="2415227">byte</span><span class="op" id="2415231">)</span><span class="op" id="2415232">(</span><span class="ident" id="2415233">unsafe</span><span class="op" id="2415239">.</span><span class="ident" id="2415240">Pointer</span><span class="op" id="2415247">(</span><span class="ident" id="2415248">ptr</span><span class="op" id="2415251">)</span><span class="op" id="2415252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415255">msg</span><span class="op" id="2415258">.</span><span class="ident" id="2415259">Namelen</span>&nbsp;<span class="op" id="2415267">=</span>&nbsp;<span class="builtintype" id="2415269">uint32</span><span class="op" id="2415275">(</span><span class="ident" id="2415276">salen</span><span class="op" id="2415281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415284">var</span>&nbsp;<span class="ident" id="2415288">iov</span>&nbsp;<span class="ident" id="2415292">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415299">if</span>&nbsp;<span class="builtinfunc" id="2415302">len</span><span class="op" id="2415305">(</span><span class="ident" id="2415306">p</span><span class="op" id="2415307">)</span>&nbsp;<span class="op" id="2415309">&gt;</span>&nbsp;<span class="num" id="2415311">0</span>&nbsp;<span class="op" id="2415313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415317">iov</span><span class="op" id="2415320">.</span><span class="ident" id="2415321">Base</span>&nbsp;<span class="op" id="2415326">=</span>&nbsp;<span class="op" id="2415328">(</span><span class="op" id="2415329">*</span><span class="builtintype" id="2415330">byte</span><span class="op" id="2415334">)</span><span class="op" id="2415335">(</span><span class="ident" id="2415336">unsafe</span><span class="op" id="2415342">.</span><span class="ident" id="2415343">Pointer</span><span class="op" id="2415350">(</span><span class="op" id="2415351">&amp;</span><span class="ident" id="2415352">p</span><span class="op" id="2415353">[</span><span class="num" id="2415354">0</span><span class="op" id="2415355">]</span><span class="op" id="2415356">)</span><span class="op" id="2415357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415361">iov</span><span class="op" id="2415364">.</span><span class="ident" id="2415365">SetLen</span><span class="op" id="2415371">(</span><span class="builtinfunc" id="2415372">len</span><span class="op" id="2415375">(</span><span class="ident" id="2415376">p</span><span class="op" id="2415377">)</span><span class="op" id="2415378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415384">var</span>&nbsp;<span class="ident" id="2415388">dummy</span>&nbsp;<span class="builtintype" id="2415394">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415400">if</span>&nbsp;<span class="builtinfunc" id="2415403">len</span><span class="op" id="2415406">(</span><span class="ident" id="2415407">oob</span><span class="op" id="2415410">)</span>&nbsp;<span class="op" id="2415412">&gt;</span>&nbsp;<span class="num" id="2415414">0</span>&nbsp;<span class="op" id="2415416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2415420">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415455">if</span>&nbsp;<span class="builtinfunc" id="2415458">len</span><span class="op" id="2415461">(</span><span class="ident" id="2415462">p</span><span class="op" id="2415463">)</span>&nbsp;<span class="op" id="2415465">==</span>&nbsp;<span class="num" id="2415468">0</span>&nbsp;<span class="op" id="2415470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415475">iov</span><span class="op" id="2415478">.</span><span class="ident" id="2415479">Base</span>&nbsp;<span class="op" id="2415484">=</span>&nbsp;<span class="op" id="2415486">&amp;</span><span class="ident" id="2415487">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415496">iov</span><span class="op" id="2415499">.</span><span class="ident" id="2415500">SetLen</span><span class="op" id="2415506">(</span><span class="num" id="2415507">1</span><span class="op" id="2415508">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415516">msg</span><span class="op" id="2415519">.</span><span class="ident" id="2415520">Control</span>&nbsp;<span class="op" id="2415528">=</span>&nbsp;<span class="op" id="2415530">(</span><span class="op" id="2415531">*</span><span class="builtintype" id="2415532">byte</span><span class="op" id="2415536">)</span><span class="op" id="2415537">(</span><span class="ident" id="2415538">unsafe</span><span class="op" id="2415544">.</span><span class="ident" id="2415545">Pointer</span><span class="op" id="2415552">(</span><span class="op" id="2415553">&amp;</span><span class="ident" id="2415554">oob</span><span class="op" id="2415557">[</span><span class="num" id="2415558">0</span><span class="op" id="2415559">]</span><span class="op" id="2415560">)</span><span class="op" id="2415561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415565">msg</span><span class="op" id="2415568">.</span><span class="ident" id="2415569">SetControllen</span><span class="op" id="2415582">(</span><span class="builtinfunc" id="2415583">len</span><span class="op" id="2415586">(</span><span class="ident" id="2415587">oob</span><span class="op" id="2415590">)</span><span class="op" id="2415591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415597">msg</span><span class="op" id="2415600">.</span><span class="ident" id="2415601">Iov</span>&nbsp;<span class="op" id="2415605">=</span>&nbsp;<span class="op" id="2415607">&amp;</span><span class="ident" id="2415608">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415613">msg</span><span class="op" id="2415616">.</span><span class="ident" id="2415617">Iovlen</span>&nbsp;<span class="op" id="2415624">=</span>&nbsp;<span class="num" id="2415626">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415629">if</span>&nbsp;<span class="ident" id="2415632">n</span><span class="op" id="2415633">,</span>&nbsp;<span class="ident" id="2415635">err</span>&nbsp;<span class="op" id="2415639">=</span>&nbsp;<span class="ident" id="2415641">sendmsg</span><span class="op" id="2415648">(</span><span class="ident" id="2415649">fd</span><span class="op" id="2415651">,</span>&nbsp;<span class="op" id="2415653">&amp;</span><span class="ident" id="2415654">msg</span><span class="op" id="2415657">,</span>&nbsp;<span class="ident" id="2415659">flags</span><span class="op" id="2415664">)</span><span class="op" id="2415665">;</span>&nbsp;<span class="ident" id="2415667">err</span>&nbsp;<span class="op" id="2415671">!=</span>&nbsp;<span class="ident" id="2415674">nil</span>&nbsp;<span class="op" id="2415678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415682">return</span>&nbsp;<span class="num" id="2415689">0</span><span class="op" id="2415690">,</span>&nbsp;<span class="ident" id="2415692">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415700">if</span>&nbsp;<span class="builtinfunc" id="2415703">len</span><span class="op" id="2415706">(</span><span class="ident" id="2415707">oob</span><span class="op" id="2415710">)</span>&nbsp;<span class="op" id="2415712">&gt;</span>&nbsp;<span class="num" id="2415714">0</span>&nbsp;<span class="op" id="2415716">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2415719">len</span><span class="op" id="2415722">(</span><span class="ident" id="2415723">p</span><span class="op" id="2415724">)</span>&nbsp;<span class="op" id="2415726">==</span>&nbsp;<span class="num" id="2415729">0</span>&nbsp;<span class="op" id="2415731">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415735">n</span>&nbsp;<span class="op" id="2415737">=</span>&nbsp;<span class="num" id="2415739">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2415742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415745">return</span>&nbsp;<span class="ident" id="2415752">n</span><span class="op" id="2415753">,</span>&nbsp;<span class="ident" id="2415755">nil</span><br>
<span class="lineno"></span><span class="op" id="2415759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2415762">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2415825">func</span>&nbsp;<span class="ident" id="2415830">BindToDevice</span><span class="op" id="2415842">(</span><span class="ident" id="2415843">fd</span>&nbsp;<span class="builtintype" id="2415846">int</span><span class="op" id="2415849">,</span>&nbsp;<span class="ident" id="2415851">device</span>&nbsp;<span class="builtintype" id="2415858">string</span><span class="op" id="2415864">)</span>&nbsp;<span class="op" id="2415866">(</span><span class="ident" id="2415867">err</span>&nbsp;<span class="builtintype" id="2415871">error</span><span class="op" id="2415876">)</span>&nbsp;<span class="op" id="2415878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415881">return</span>&nbsp;<span class="ident" id="2415888">SetsockoptString</span><span class="op" id="2415904">(</span><span class="ident" id="2415905">fd</span><span class="op" id="2415907">,</span>&nbsp;<span class="ident" id="2415909">SOL_SOCKET</span><span class="op" id="2415919">,</span>&nbsp;<span class="ident" id="2415921">SO_BINDTODEVICE</span><span class="op" id="2415936">,</span>&nbsp;<span class="ident" id="2415938">device</span><span class="op" id="2415944">)</span><br>
<span class="lineno"></span><span class="op" id="2415946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2415949">//sys&nbsp;&nbsp;&nbsp;&nbspptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2416025">func</span>&nbsp;<span class="ident" id="2416030">ptracePeek</span><span class="op" id="2416040">(</span><span class="ident" id="2416041">req</span>&nbsp;<span class="builtintype" id="2416045">int</span><span class="op" id="2416048">,</span>&nbsp;<span class="ident" id="2416050">pid</span>&nbsp;<span class="builtintype" id="2416054">int</span><span class="op" id="2416057">,</span>&nbsp;<span class="ident" id="2416059">addr</span>&nbsp;<span class="builtintype" id="2416064">uintptr</span><span class="op" id="2416071">,</span>&nbsp;<span class="ident" id="2416073">out</span>&nbsp;<span class="op" id="2416077">[</span><span class="op" id="2416078">]</span><span class="builtintype" id="2416079">byte</span><span class="op" id="2416083">)</span>&nbsp;<span class="op" id="2416085">(</span><span class="ident" id="2416086">count</span>&nbsp;<span class="builtintype" id="2416092">int</span><span class="op" id="2416095">,</span>&nbsp;<span class="ident" id="2416097">err</span>&nbsp;<span class="builtintype" id="2416101">error</span><span class="op" id="2416106">)</span>&nbsp;<span class="op" id="2416108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416111">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416174">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416214">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416266">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416329">var</span>&nbsp;<span class="ident" id="2416333">buf</span>&nbsp;<span class="op" id="2416337">[</span><span class="ident" id="2416338">sizeofPtr</span><span class="op" id="2416347">]</span><span class="builtintype" id="2416348">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416355">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416414">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416473">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416529">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416587">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2416601">n</span>&nbsp;<span class="op" id="2416603">:=</span>&nbsp;<span class="num" id="2416606">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416609">if</span>&nbsp;<span class="ident" id="2416612">addr</span><span class="op" id="2416616">%</span><span class="ident" id="2416617">sizeofPtr</span>&nbsp;<span class="op" id="2416627">!=</span>&nbsp;<span class="num" id="2416630">0</span>&nbsp;<span class="op" id="2416632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2416636">err</span>&nbsp;<span class="op" id="2416640">=</span>&nbsp;<span class="ident" id="2416642">ptrace</span><span class="op" id="2416648">(</span><span class="ident" id="2416649">req</span><span class="op" id="2416652">,</span>&nbsp;<span class="ident" id="2416654">pid</span><span class="op" id="2416657">,</span>&nbsp;<span class="ident" id="2416659">addr</span><span class="op" id="2416663">-</span><span class="ident" id="2416664">addr</span><span class="op" id="2416668">%</span><span class="ident" id="2416669">sizeofPtr</span><span class="op" id="2416678">,</span>&nbsp;<span class="builtintype" id="2416680">uintptr</span><span class="op" id="2416687">(</span><span class="ident" id="2416688">unsafe</span><span class="op" id="2416694">.</span><span class="ident" id="2416695">Pointer</span><span class="op" id="2416702">(</span><span class="op" id="2416703">&amp;</span><span class="ident" id="2416704">buf</span><span class="op" id="2416707">[</span><span class="num" id="2416708">0</span><span class="op" id="2416709">]</span><span class="op" id="2416710">)</span><span class="op" id="2416711">)</span><span class="op" id="2416712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416716">if</span>&nbsp;<span class="ident" id="2416719">err</span>&nbsp;<span class="op" id="2416723">!=</span>&nbsp;<span class="ident" id="2416726">nil</span>&nbsp;<span class="op" id="2416730">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416735">return</span>&nbsp;<span class="num" id="2416742">0</span><span class="op" id="2416743">,</span>&nbsp;<span class="ident" id="2416745">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2416751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2416755">n</span>&nbsp;<span class="op" id="2416757">+=</span>&nbsp;<span class="builtinfunc" id="2416760">copy</span><span class="op" id="2416764">(</span><span class="ident" id="2416765">out</span><span class="op" id="2416768">,</span>&nbsp;<span class="ident" id="2416770">buf</span><span class="op" id="2416773">[</span><span class="ident" id="2416774">addr</span><span class="op" id="2416778">%</span><span class="ident" id="2416779">sizeofPtr</span><span class="op" id="2416788">:</span><span class="op" id="2416789">]</span><span class="op" id="2416790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2416794">out</span>&nbsp;<span class="op" id="2416798">=</span>&nbsp;<span class="ident" id="2416800">out</span><span class="op" id="2416803">[</span><span class="ident" id="2416804">n</span><span class="op" id="2416805">:</span><span class="op" id="2416806">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2416809">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416813">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416828">for</span>&nbsp;<span class="builtinfunc" id="2416832">len</span><span class="op" id="2416835">(</span><span class="ident" id="2416836">out</span><span class="op" id="2416839">)</span>&nbsp;<span class="op" id="2416841">&gt;</span>&nbsp;<span class="num" id="2416843">0</span>&nbsp;<span class="op" id="2416845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416849">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2416904">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2416971">err</span>&nbsp;<span class="op" id="2416975">=</span>&nbsp;<span class="ident" id="2416977">ptrace</span><span class="op" id="2416983">(</span><span class="ident" id="2416984">req</span><span class="op" id="2416987">,</span>&nbsp;<span class="ident" id="2416989">pid</span><span class="op" id="2416992">,</span>&nbsp;<span class="ident" id="2416994">addr</span><span class="op" id="2416998">+</span><span class="builtintype" id="2416999">uintptr</span><span class="op" id="2417006">(</span><span class="ident" id="2417007">n</span><span class="op" id="2417008">)</span><span class="op" id="2417009">,</span>&nbsp;<span class="builtintype" id="2417011">uintptr</span><span class="op" id="2417018">(</span><span class="ident" id="2417019">unsafe</span><span class="op" id="2417025">.</span><span class="ident" id="2417026">Pointer</span><span class="op" id="2417033">(</span><span class="op" id="2417034">&amp;</span><span class="ident" id="2417035">buf</span><span class="op" id="2417038">[</span><span class="num" id="2417039">0</span><span class="op" id="2417040">]</span><span class="op" id="2417041">)</span><span class="op" id="2417042">)</span><span class="op" id="2417043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417047">if</span>&nbsp;<span class="ident" id="2417050">err</span>&nbsp;<span class="op" id="2417054">!=</span>&nbsp;<span class="ident" id="2417057">nil</span>&nbsp;<span class="op" id="2417061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417066">return</span>&nbsp;<span class="ident" id="2417073">n</span><span class="op" id="2417074">,</span>&nbsp;<span class="ident" id="2417076">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2417082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417086">copied</span>&nbsp;<span class="op" id="2417093">:=</span>&nbsp;<span class="builtinfunc" id="2417096">copy</span><span class="op" id="2417100">(</span><span class="ident" id="2417101">out</span><span class="op" id="2417104">,</span>&nbsp;<span class="ident" id="2417106">buf</span><span class="op" id="2417109">[</span><span class="num" id="2417110">0</span><span class="op" id="2417111">:</span><span class="op" id="2417112">]</span><span class="op" id="2417113">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417117">n</span>&nbsp;<span class="op" id="2417119">+=</span>&nbsp;<span class="ident" id="2417122">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417131">out</span>&nbsp;<span class="op" id="2417135">=</span>&nbsp;<span class="ident" id="2417137">out</span><span class="op" id="2417140">[</span><span class="ident" id="2417141">copied</span><span class="op" id="2417147">:</span><span class="op" id="2417148">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2417151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417155">return</span>&nbsp;<span class="ident" id="2417162">n</span><span class="op" id="2417163">,</span>&nbsp;<span class="ident" id="2417165">nil</span><br>
<span class="lineno">620</span><span class="op" id="2417169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2417172">func</span>&nbsp;<span class="ident" id="2417177">PtracePeekText</span><span class="op" id="2417191">(</span><span class="ident" id="2417192">pid</span>&nbsp;<span class="builtintype" id="2417196">int</span><span class="op" id="2417199">,</span>&nbsp;<span class="ident" id="2417201">addr</span>&nbsp;<span class="builtintype" id="2417206">uintptr</span><span class="op" id="2417213">,</span>&nbsp;<span class="ident" id="2417215">out</span>&nbsp;<span class="op" id="2417219">[</span><span class="op" id="2417220">]</span><span class="builtintype" id="2417221">byte</span><span class="op" id="2417225">)</span>&nbsp;<span class="op" id="2417227">(</span><span class="ident" id="2417228">count</span>&nbsp;<span class="builtintype" id="2417234">int</span><span class="op" id="2417237">,</span>&nbsp;<span class="ident" id="2417239">err</span>&nbsp;<span class="builtintype" id="2417243">error</span><span class="op" id="2417248">)</span>&nbsp;<span class="op" id="2417250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417253">return</span>&nbsp;<span class="ident" id="2417260">ptracePeek</span><span class="op" id="2417270">(</span><span class="ident" id="2417271">PTRACE_PEEKTEXT</span><span class="op" id="2417286">,</span>&nbsp;<span class="ident" id="2417288">pid</span><span class="op" id="2417291">,</span>&nbsp;<span class="ident" id="2417293">addr</span><span class="op" id="2417297">,</span>&nbsp;<span class="ident" id="2417299">out</span><span class="op" id="2417302">)</span><br>
<span class="lineno"></span><span class="op" id="2417304">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2417307">func</span>&nbsp;<span class="ident" id="2417312">PtracePeekData</span><span class="op" id="2417326">(</span><span class="ident" id="2417327">pid</span>&nbsp;<span class="builtintype" id="2417331">int</span><span class="op" id="2417334">,</span>&nbsp;<span class="ident" id="2417336">addr</span>&nbsp;<span class="builtintype" id="2417341">uintptr</span><span class="op" id="2417348">,</span>&nbsp;<span class="ident" id="2417350">out</span>&nbsp;<span class="op" id="2417354">[</span><span class="op" id="2417355">]</span><span class="builtintype" id="2417356">byte</span><span class="op" id="2417360">)</span>&nbsp;<span class="op" id="2417362">(</span><span class="ident" id="2417363">count</span>&nbsp;<span class="builtintype" id="2417369">int</span><span class="op" id="2417372">,</span>&nbsp;<span class="ident" id="2417374">err</span>&nbsp;<span class="builtintype" id="2417378">error</span><span class="op" id="2417383">)</span>&nbsp;<span class="op" id="2417385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417388">return</span>&nbsp;<span class="ident" id="2417395">ptracePeek</span><span class="op" id="2417405">(</span><span class="ident" id="2417406">PTRACE_PEEKDATA</span><span class="op" id="2417421">,</span>&nbsp;<span class="ident" id="2417423">pid</span><span class="op" id="2417426">,</span>&nbsp;<span class="ident" id="2417428">addr</span><span class="op" id="2417432">,</span>&nbsp;<span class="ident" id="2417434">out</span><span class="op" id="2417437">)</span><br>
<span class="lineno"></span><span class="op" id="2417439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2417442">func</span>&nbsp;<span class="ident" id="2417447">ptracePoke</span><span class="op" id="2417457">(</span><span class="ident" id="2417458">pokeReq</span>&nbsp;<span class="builtintype" id="2417466">int</span><span class="op" id="2417469">,</span>&nbsp;<span class="ident" id="2417471">peekReq</span>&nbsp;<span class="builtintype" id="2417479">int</span><span class="op" id="2417482">,</span>&nbsp;<span class="ident" id="2417484">pid</span>&nbsp;<span class="builtintype" id="2417488">int</span><span class="op" id="2417491">,</span>&nbsp;<span class="ident" id="2417493">addr</span>&nbsp;<span class="builtintype" id="2417498">uintptr</span><span class="op" id="2417505">,</span>&nbsp;<span class="ident" id="2417507">data</span>&nbsp;<span class="op" id="2417512">[</span><span class="op" id="2417513">]</span><span class="builtintype" id="2417514">byte</span><span class="op" id="2417518">)</span>&nbsp;<span class="op" id="2417520">(</span><span class="ident" id="2417521">count</span>&nbsp;<span class="builtintype" id="2417527">int</span><span class="op" id="2417530">,</span>&nbsp;<span class="ident" id="2417532">err</span>&nbsp;<span class="builtintype" id="2417536">error</span><span class="op" id="2417541">)</span>&nbsp;<span class="op" id="2417543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2417546">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2417607">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2417664">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417682">n</span>&nbsp;<span class="op" id="2417684">:=</span>&nbsp;<span class="num" id="2417687">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417690">if</span>&nbsp;<span class="ident" id="2417693">addr</span><span class="op" id="2417697">%</span><span class="ident" id="2417698">sizeofPtr</span>&nbsp;<span class="op" id="2417708">!=</span>&nbsp;<span class="num" id="2417711">0</span>&nbsp;<span class="op" id="2417713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417717">var</span>&nbsp;<span class="ident" id="2417721">buf</span>&nbsp;<span class="op" id="2417725">[</span><span class="ident" id="2417726">sizeofPtr</span><span class="op" id="2417735">]</span><span class="builtintype" id="2417736">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417743">err</span>&nbsp;<span class="op" id="2417747">=</span>&nbsp;<span class="ident" id="2417749">ptrace</span><span class="op" id="2417755">(</span><span class="ident" id="2417756">peekReq</span><span class="op" id="2417763">,</span>&nbsp;<span class="ident" id="2417765">pid</span><span class="op" id="2417768">,</span>&nbsp;<span class="ident" id="2417770">addr</span><span class="op" id="2417774">-</span><span class="ident" id="2417775">addr</span><span class="op" id="2417779">%</span><span class="ident" id="2417780">sizeofPtr</span><span class="op" id="2417789">,</span>&nbsp;<span class="builtintype" id="2417791">uintptr</span><span class="op" id="2417798">(</span><span class="ident" id="2417799">unsafe</span><span class="op" id="2417805">.</span><span class="ident" id="2417806">Pointer</span><span class="op" id="2417813">(</span><span class="op" id="2417814">&amp;</span><span class="ident" id="2417815">buf</span><span class="op" id="2417818">[</span><span class="num" id="2417819">0</span><span class="op" id="2417820">]</span><span class="op" id="2417821">)</span><span class="op" id="2417822">)</span><span class="op" id="2417823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417827">if</span>&nbsp;<span class="ident" id="2417830">err</span>&nbsp;<span class="op" id="2417834">!=</span>&nbsp;<span class="ident" id="2417837">nil</span>&nbsp;<span class="op" id="2417841">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417846">return</span>&nbsp;<span class="num" id="2417853">0</span><span class="op" id="2417854">,</span>&nbsp;<span class="ident" id="2417856">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2417862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417866">n</span>&nbsp;<span class="op" id="2417868">+=</span>&nbsp;<span class="builtinfunc" id="2417871">copy</span><span class="op" id="2417875">(</span><span class="ident" id="2417876">buf</span><span class="op" id="2417879">[</span><span class="ident" id="2417880">addr</span><span class="op" id="2417884">%</span><span class="ident" id="2417885">sizeofPtr</span><span class="op" id="2417894">:</span><span class="op" id="2417895">]</span><span class="op" id="2417896">,</span>&nbsp;<span class="ident" id="2417898">data</span><span class="op" id="2417902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417906">word</span>&nbsp;<span class="op" id="2417911">:=</span>&nbsp;<span class="op" id="2417914">*</span><span class="op" id="2417915">(</span><span class="op" id="2417916">(</span><span class="op" id="2417917">*</span><span class="builtintype" id="2417918">uintptr</span><span class="op" id="2417925">)</span><span class="op" id="2417926">(</span><span class="ident" id="2417927">unsafe</span><span class="op" id="2417933">.</span><span class="ident" id="2417934">Pointer</span><span class="op" id="2417941">(</span><span class="op" id="2417942">&amp;</span><span class="ident" id="2417943">buf</span><span class="op" id="2417946">[</span><span class="num" id="2417947">0</span><span class="op" id="2417948">]</span><span class="op" id="2417949">)</span><span class="op" id="2417950">)</span><span class="op" id="2417951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417955">err</span>&nbsp;<span class="op" id="2417959">=</span>&nbsp;<span class="ident" id="2417961">ptrace</span><span class="op" id="2417967">(</span><span class="ident" id="2417968">pokeReq</span><span class="op" id="2417975">,</span>&nbsp;<span class="ident" id="2417977">pid</span><span class="op" id="2417980">,</span>&nbsp;<span class="ident" id="2417982">addr</span><span class="op" id="2417986">-</span><span class="ident" id="2417987">addr</span><span class="op" id="2417991">%</span><span class="ident" id="2417992">sizeofPtr</span><span class="op" id="2418001">,</span>&nbsp;<span class="ident" id="2418003">word</span><span class="op" id="2418007">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418011">if</span>&nbsp;<span class="ident" id="2418014">err</span>&nbsp;<span class="op" id="2418018">!=</span>&nbsp;<span class="ident" id="2418021">nil</span>&nbsp;<span class="op" id="2418025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418030">return</span>&nbsp;<span class="num" id="2418037">0</span><span class="op" id="2418038">,</span>&nbsp;<span class="ident" id="2418040">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2418046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418050">data</span>&nbsp;<span class="op" id="2418055">=</span>&nbsp;<span class="ident" id="2418057">data</span><span class="op" id="2418061">[</span><span class="ident" id="2418062">n</span><span class="op" id="2418063">:</span><span class="op" id="2418064">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2418067">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2418071">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418085">for</span>&nbsp;<span class="builtinfunc" id="2418089">len</span><span class="op" id="2418092">(</span><span class="ident" id="2418093">data</span><span class="op" id="2418097">)</span>&nbsp;<span class="op" id="2418099">&gt;</span>&nbsp;<span class="ident" id="2418101">sizeofPtr</span>&nbsp;<span class="op" id="2418111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418115">word</span>&nbsp;<span class="op" id="2418120">:=</span>&nbsp;<span class="op" id="2418123">*</span><span class="op" id="2418124">(</span><span class="op" id="2418125">(</span><span class="op" id="2418126">*</span><span class="builtintype" id="2418127">uintptr</span><span class="op" id="2418134">)</span><span class="op" id="2418135">(</span><span class="ident" id="2418136">unsafe</span><span class="op" id="2418142">.</span><span class="ident" id="2418143">Pointer</span><span class="op" id="2418150">(</span><span class="op" id="2418151">&amp;</span><span class="ident" id="2418152">data</span><span class="op" id="2418156">[</span><span class="num" id="2418157">0</span><span class="op" id="2418158">]</span><span class="op" id="2418159">)</span><span class="op" id="2418160">)</span><span class="op" id="2418161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418165">err</span>&nbsp;<span class="op" id="2418169">=</span>&nbsp;<span class="ident" id="2418171">ptrace</span><span class="op" id="2418177">(</span><span class="ident" id="2418178">pokeReq</span><span class="op" id="2418185">,</span>&nbsp;<span class="ident" id="2418187">pid</span><span class="op" id="2418190">,</span>&nbsp;<span class="ident" id="2418192">addr</span><span class="op" id="2418196">+</span><span class="builtintype" id="2418197">uintptr</span><span class="op" id="2418204">(</span><span class="ident" id="2418205">n</span><span class="op" id="2418206">)</span><span class="op" id="2418207">,</span>&nbsp;<span class="ident" id="2418209">word</span><span class="op" id="2418213">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418217">if</span>&nbsp;<span class="ident" id="2418220">err</span>&nbsp;<span class="op" id="2418224">!=</span>&nbsp;<span class="ident" id="2418227">nil</span>&nbsp;<span class="op" id="2418231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418236">return</span>&nbsp;<span class="ident" id="2418243">n</span><span class="op" id="2418244">,</span>&nbsp;<span class="ident" id="2418246">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2418252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418256">n</span>&nbsp;<span class="op" id="2418258">+=</span>&nbsp;<span class="ident" id="2418261">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418273">data</span>&nbsp;<span class="op" id="2418278">=</span>&nbsp;<span class="ident" id="2418280">data</span><span class="op" id="2418284">[</span><span class="ident" id="2418285">sizeofPtr</span><span class="op" id="2418294">:</span><span class="op" id="2418295">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2418298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2418302">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418321">if</span>&nbsp;<span class="builtinfunc" id="2418324">len</span><span class="op" id="2418327">(</span><span class="ident" id="2418328">data</span><span class="op" id="2418332">)</span>&nbsp;<span class="op" id="2418334">&gt;</span>&nbsp;<span class="num" id="2418336">0</span>&nbsp;<span class="op" id="2418338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418342">var</span>&nbsp;<span class="ident" id="2418346">buf</span>&nbsp;<span class="op" id="2418350">[</span><span class="ident" id="2418351">sizeofPtr</span><span class="op" id="2418360">]</span><span class="builtintype" id="2418361">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418368">err</span>&nbsp;<span class="op" id="2418372">=</span>&nbsp;<span class="ident" id="2418374">ptrace</span><span class="op" id="2418380">(</span><span class="ident" id="2418381">peekReq</span><span class="op" id="2418388">,</span>&nbsp;<span class="ident" id="2418390">pid</span><span class="op" id="2418393">,</span>&nbsp;<span class="ident" id="2418395">addr</span><span class="op" id="2418399">+</span><span class="builtintype" id="2418400">uintptr</span><span class="op" id="2418407">(</span><span class="ident" id="2418408">n</span><span class="op" id="2418409">)</span><span class="op" id="2418410">,</span>&nbsp;<span class="builtintype" id="2418412">uintptr</span><span class="op" id="2418419">(</span><span class="ident" id="2418420">unsafe</span><span class="op" id="2418426">.</span><span class="ident" id="2418427">Pointer</span><span class="op" id="2418434">(</span><span class="op" id="2418435">&amp;</span><span class="ident" id="2418436">buf</span><span class="op" id="2418439">[</span><span class="num" id="2418440">0</span><span class="op" id="2418441">]</span><span class="op" id="2418442">)</span><span class="op" id="2418443">)</span><span class="op" id="2418444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418448">if</span>&nbsp;<span class="ident" id="2418451">err</span>&nbsp;<span class="op" id="2418455">!=</span>&nbsp;<span class="ident" id="2418458">nil</span>&nbsp;<span class="op" id="2418462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418467">return</span>&nbsp;<span class="ident" id="2418474">n</span><span class="op" id="2418475">,</span>&nbsp;<span class="ident" id="2418477">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2418483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2418487">copy</span><span class="op" id="2418491">(</span><span class="ident" id="2418492">buf</span><span class="op" id="2418495">[</span><span class="num" id="2418496">0</span><span class="op" id="2418497">:</span><span class="op" id="2418498">]</span><span class="op" id="2418499">,</span>&nbsp;<span class="ident" id="2418501">data</span><span class="op" id="2418505">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418509">word</span>&nbsp;<span class="op" id="2418514">:=</span>&nbsp;<span class="op" id="2418517">*</span><span class="op" id="2418518">(</span><span class="op" id="2418519">(</span><span class="op" id="2418520">*</span><span class="builtintype" id="2418521">uintptr</span><span class="op" id="2418528">)</span><span class="op" id="2418529">(</span><span class="ident" id="2418530">unsafe</span><span class="op" id="2418536">.</span><span class="ident" id="2418537">Pointer</span><span class="op" id="2418544">(</span><span class="op" id="2418545">&amp;</span><span class="ident" id="2418546">buf</span><span class="op" id="2418549">[</span><span class="num" id="2418550">0</span><span class="op" id="2418551">]</span><span class="op" id="2418552">)</span><span class="op" id="2418553">)</span><span class="op" id="2418554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418558">err</span>&nbsp;<span class="op" id="2418562">=</span>&nbsp;<span class="ident" id="2418564">ptrace</span><span class="op" id="2418570">(</span><span class="ident" id="2418571">pokeReq</span><span class="op" id="2418578">,</span>&nbsp;<span class="ident" id="2418580">pid</span><span class="op" id="2418583">,</span>&nbsp;<span class="ident" id="2418585">addr</span><span class="op" id="2418589">+</span><span class="builtintype" id="2418590">uintptr</span><span class="op" id="2418597">(</span><span class="ident" id="2418598">n</span><span class="op" id="2418599">)</span><span class="op" id="2418600">,</span>&nbsp;<span class="ident" id="2418602">word</span><span class="op" id="2418606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418610">if</span>&nbsp;<span class="ident" id="2418613">err</span>&nbsp;<span class="op" id="2418617">!=</span>&nbsp;<span class="ident" id="2418620">nil</span>&nbsp;<span class="op" id="2418624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418629">return</span>&nbsp;<span class="ident" id="2418636">n</span><span class="op" id="2418637">,</span>&nbsp;<span class="ident" id="2418639">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2418645">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418649">n</span>&nbsp;<span class="op" id="2418651">+=</span>&nbsp;<span class="builtinfunc" id="2418654">len</span><span class="op" id="2418657">(</span><span class="ident" id="2418658">data</span><span class="op" id="2418662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2418665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418669">return</span>&nbsp;<span class="ident" id="2418676">n</span><span class="op" id="2418677">,</span>&nbsp;<span class="ident" id="2418679">nil</span><br>
<span class="lineno"></span><span class="op" id="2418683">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2418686">func</span>&nbsp;<span class="ident" id="2418691">PtracePokeText</span><span class="op" id="2418705">(</span><span class="ident" id="2418706">pid</span>&nbsp;<span class="builtintype" id="2418710">int</span><span class="op" id="2418713">,</span>&nbsp;<span class="ident" id="2418715">addr</span>&nbsp;<span class="builtintype" id="2418720">uintptr</span><span class="op" id="2418727">,</span>&nbsp;<span class="ident" id="2418729">data</span>&nbsp;<span class="op" id="2418734">[</span><span class="op" id="2418735">]</span><span class="builtintype" id="2418736">byte</span><span class="op" id="2418740">)</span>&nbsp;<span class="op" id="2418742">(</span><span class="ident" id="2418743">count</span>&nbsp;<span class="builtintype" id="2418749">int</span><span class="op" id="2418752">,</span>&nbsp;<span class="ident" id="2418754">err</span>&nbsp;<span class="builtintype" id="2418758">error</span><span class="op" id="2418763">)</span>&nbsp;<span class="op" id="2418765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418768">return</span>&nbsp;<span class="ident" id="2418775">ptracePoke</span><span class="op" id="2418785">(</span><span class="ident" id="2418786">PTRACE_POKETEXT</span><span class="op" id="2418801">,</span>&nbsp;<span class="ident" id="2418803">PTRACE_PEEKTEXT</span><span class="op" id="2418818">,</span>&nbsp;<span class="ident" id="2418820">pid</span><span class="op" id="2418823">,</span>&nbsp;<span class="ident" id="2418825">addr</span><span class="op" id="2418829">,</span>&nbsp;<span class="ident" id="2418831">data</span><span class="op" id="2418835">)</span><br>
<span class="lineno"></span><span class="op" id="2418837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2418840">func</span>&nbsp;<span class="ident" id="2418845">PtracePokeData</span><span class="op" id="2418859">(</span><span class="ident" id="2418860">pid</span>&nbsp;<span class="builtintype" id="2418864">int</span><span class="op" id="2418867">,</span>&nbsp;<span class="ident" id="2418869">addr</span>&nbsp;<span class="builtintype" id="2418874">uintptr</span><span class="op" id="2418881">,</span>&nbsp;<span class="ident" id="2418883">data</span>&nbsp;<span class="op" id="2418888">[</span><span class="op" id="2418889">]</span><span class="builtintype" id="2418890">byte</span><span class="op" id="2418894">)</span>&nbsp;<span class="op" id="2418896">(</span><span class="ident" id="2418897">count</span>&nbsp;<span class="builtintype" id="2418903">int</span><span class="op" id="2418906">,</span>&nbsp;<span class="ident" id="2418908">err</span>&nbsp;<span class="builtintype" id="2418912">error</span><span class="op" id="2418917">)</span>&nbsp;<span class="op" id="2418919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418922">return</span>&nbsp;<span class="ident" id="2418929">ptracePoke</span><span class="op" id="2418939">(</span><span class="ident" id="2418940">PTRACE_POKEDATA</span><span class="op" id="2418955">,</span>&nbsp;<span class="ident" id="2418957">PTRACE_PEEKDATA</span><span class="op" id="2418972">,</span>&nbsp;<span class="ident" id="2418974">pid</span><span class="op" id="2418977">,</span>&nbsp;<span class="ident" id="2418979">addr</span><span class="op" id="2418983">,</span>&nbsp;<span class="ident" id="2418985">data</span><span class="op" id="2418989">)</span><br>
<span class="lineno"></span><span class="op" id="2418991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2418994">func</span>&nbsp;<span class="ident" id="2418999">PtraceGetRegs</span><span class="op" id="2419012">(</span><span class="ident" id="2419013">pid</span>&nbsp;<span class="builtintype" id="2419017">int</span><span class="op" id="2419020">,</span>&nbsp;<span class="ident" id="2419022">regsout</span>&nbsp;<span class="op" id="2419030">*</span><span class="ident" id="2419031">PtraceRegs</span><span class="op" id="2419041">)</span>&nbsp;<span class="op" id="2419043">(</span><span class="ident" id="2419044">err</span>&nbsp;<span class="builtintype" id="2419048">error</span><span class="op" id="2419053">)</span>&nbsp;<span class="op" id="2419055">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419058">return</span>&nbsp;<span class="ident" id="2419065">ptrace</span><span class="op" id="2419071">(</span><span class="ident" id="2419072">PTRACE_GETREGS</span><span class="op" id="2419086">,</span>&nbsp;<span class="ident" id="2419088">pid</span><span class="op" id="2419091">,</span>&nbsp;<span class="num" id="2419093">0</span><span class="op" id="2419094">,</span>&nbsp;<span class="builtintype" id="2419096">uintptr</span><span class="op" id="2419103">(</span><span class="ident" id="2419104">unsafe</span><span class="op" id="2419110">.</span><span class="ident" id="2419111">Pointer</span><span class="op" id="2419118">(</span><span class="ident" id="2419119">regsout</span><span class="op" id="2419126">)</span><span class="op" id="2419127">)</span><span class="op" id="2419128">)</span><br>
<span class="lineno"></span><span class="op" id="2419130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2419133">func</span>&nbsp;<span class="ident" id="2419138">PtraceSetRegs</span><span class="op" id="2419151">(</span><span class="ident" id="2419152">pid</span>&nbsp;<span class="builtintype" id="2419156">int</span><span class="op" id="2419159">,</span>&nbsp;<span class="ident" id="2419161">regs</span>&nbsp;<span class="op" id="2419166">*</span><span class="ident" id="2419167">PtraceRegs</span><span class="op" id="2419177">)</span>&nbsp;<span class="op" id="2419179">(</span><span class="ident" id="2419180">err</span>&nbsp;<span class="builtintype" id="2419184">error</span><span class="op" id="2419189">)</span>&nbsp;<span class="op" id="2419191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419194">return</span>&nbsp;<span class="ident" id="2419201">ptrace</span><span class="op" id="2419207">(</span><span class="ident" id="2419208">PTRACE_SETREGS</span><span class="op" id="2419222">,</span>&nbsp;<span class="ident" id="2419224">pid</span><span class="op" id="2419227">,</span>&nbsp;<span class="num" id="2419229">0</span><span class="op" id="2419230">,</span>&nbsp;<span class="builtintype" id="2419232">uintptr</span><span class="op" id="2419239">(</span><span class="ident" id="2419240">unsafe</span><span class="op" id="2419246">.</span><span class="ident" id="2419247">Pointer</span><span class="op" id="2419254">(</span><span class="ident" id="2419255">regs</span><span class="op" id="2419259">)</span><span class="op" id="2419260">)</span><span class="op" id="2419261">)</span><br>
<span class="lineno">695</span><span class="op" id="2419263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2419266">func</span>&nbsp;<span class="ident" id="2419271">PtraceSetOptions</span><span class="op" id="2419287">(</span><span class="ident" id="2419288">pid</span>&nbsp;<span class="builtintype" id="2419292">int</span><span class="op" id="2419295">,</span>&nbsp;<span class="ident" id="2419297">options</span>&nbsp;<span class="builtintype" id="2419305">int</span><span class="op" id="2419308">)</span>&nbsp;<span class="op" id="2419310">(</span><span class="ident" id="2419311">err</span>&nbsp;<span class="builtintype" id="2419315">error</span><span class="op" id="2419320">)</span>&nbsp;<span class="op" id="2419322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419325">return</span>&nbsp;<span class="ident" id="2419332">ptrace</span><span class="op" id="2419338">(</span><span class="ident" id="2419339">PTRACE_SETOPTIONS</span><span class="op" id="2419356">,</span>&nbsp;<span class="ident" id="2419358">pid</span><span class="op" id="2419361">,</span>&nbsp;<span class="num" id="2419363">0</span><span class="op" id="2419364">,</span>&nbsp;<span class="builtintype" id="2419366">uintptr</span><span class="op" id="2419373">(</span><span class="ident" id="2419374">options</span><span class="op" id="2419381">)</span><span class="op" id="2419382">)</span><br>
<span class="lineno"></span><span class="op" id="2419384">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2419387">func</span>&nbsp;<span class="ident" id="2419392">PtraceGetEventMsg</span><span class="op" id="2419409">(</span><span class="ident" id="2419410">pid</span>&nbsp;<span class="builtintype" id="2419414">int</span><span class="op" id="2419417">)</span>&nbsp;<span class="op" id="2419419">(</span><span class="ident" id="2419420">msg</span>&nbsp;<span class="builtintype" id="2419424">uint</span><span class="op" id="2419428">,</span>&nbsp;<span class="ident" id="2419430">err</span>&nbsp;<span class="builtintype" id="2419434">error</span><span class="op" id="2419439">)</span>&nbsp;<span class="op" id="2419441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419444">var</span>&nbsp;<span class="ident" id="2419448">data</span>&nbsp;<span class="ident" id="2419453">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419462">err</span>&nbsp;<span class="op" id="2419466">=</span>&nbsp;<span class="ident" id="2419468">ptrace</span><span class="op" id="2419474">(</span><span class="ident" id="2419475">PTRACE_GETEVENTMSG</span><span class="op" id="2419493">,</span>&nbsp;<span class="ident" id="2419495">pid</span><span class="op" id="2419498">,</span>&nbsp;<span class="num" id="2419500">0</span><span class="op" id="2419501">,</span>&nbsp;<span class="builtintype" id="2419503">uintptr</span><span class="op" id="2419510">(</span><span class="ident" id="2419511">unsafe</span><span class="op" id="2419517">.</span><span class="ident" id="2419518">Pointer</span><span class="op" id="2419525">(</span><span class="op" id="2419526">&amp;</span><span class="ident" id="2419527">data</span><span class="op" id="2419531">)</span><span class="op" id="2419532">)</span><span class="op" id="2419533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419536">msg</span>&nbsp;<span class="op" id="2419540">=</span>&nbsp;<span class="builtintype" id="2419542">uint</span><span class="op" id="2419546">(</span><span class="ident" id="2419547">data</span><span class="op" id="2419551">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419554">return</span><br>
<span class="lineno"></span><span class="op" id="2419561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2419564">func</span>&nbsp;<span class="ident" id="2419569">PtraceCont</span><span class="op" id="2419579">(</span><span class="ident" id="2419580">pid</span>&nbsp;<span class="builtintype" id="2419584">int</span><span class="op" id="2419587">,</span>&nbsp;<span class="ident" id="2419589">signal</span>&nbsp;<span class="builtintype" id="2419596">int</span><span class="op" id="2419599">)</span>&nbsp;<span class="op" id="2419601">(</span><span class="ident" id="2419602">err</span>&nbsp;<span class="builtintype" id="2419606">error</span><span class="op" id="2419611">)</span>&nbsp;<span class="op" id="2419613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419616">return</span>&nbsp;<span class="ident" id="2419623">ptrace</span><span class="op" id="2419629">(</span><span class="ident" id="2419630">PTRACE_CONT</span><span class="op" id="2419641">,</span>&nbsp;<span class="ident" id="2419643">pid</span><span class="op" id="2419646">,</span>&nbsp;<span class="num" id="2419648">0</span><span class="op" id="2419649">,</span>&nbsp;<span class="builtintype" id="2419651">uintptr</span><span class="op" id="2419658">(</span><span class="ident" id="2419659">signal</span><span class="op" id="2419665">)</span><span class="op" id="2419666">)</span><br>
<span class="lineno">710</span><span class="op" id="2419668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2419671">func</span>&nbsp;<span class="ident" id="2419676">PtraceSyscall</span><span class="op" id="2419689">(</span><span class="ident" id="2419690">pid</span>&nbsp;<span class="builtintype" id="2419694">int</span><span class="op" id="2419697">,</span>&nbsp;<span class="ident" id="2419699">signal</span>&nbsp;<span class="builtintype" id="2419706">int</span><span class="op" id="2419709">)</span>&nbsp;<span class="op" id="2419711">(</span><span class="ident" id="2419712">err</span>&nbsp;<span class="builtintype" id="2419716">error</span><span class="op" id="2419721">)</span>&nbsp;<span class="op" id="2419723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419726">return</span>&nbsp;<span class="ident" id="2419733">ptrace</span><span class="op" id="2419739">(</span><span class="ident" id="2419740">PTRACE_SYSCALL</span><span class="op" id="2419754">,</span>&nbsp;<span class="ident" id="2419756">pid</span><span class="op" id="2419759">,</span>&nbsp;<span class="num" id="2419761">0</span><span class="op" id="2419762">,</span>&nbsp;<span class="builtintype" id="2419764">uintptr</span><span class="op" id="2419771">(</span><span class="ident" id="2419772">signal</span><span class="op" id="2419778">)</span><span class="op" id="2419779">)</span><br>
<span class="lineno"></span><span class="op" id="2419781">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2419784">func</span>&nbsp;<span class="ident" id="2419789">PtraceSingleStep</span><span class="op" id="2419805">(</span><span class="ident" id="2419806">pid</span>&nbsp;<span class="builtintype" id="2419810">int</span><span class="op" id="2419813">)</span>&nbsp;<span class="op" id="2419815">(</span><span class="ident" id="2419816">err</span>&nbsp;<span class="builtintype" id="2419820">error</span><span class="op" id="2419825">)</span>&nbsp;<span class="op" id="2419827">{</span>&nbsp;<span class="keyword" id="2419829">return</span>&nbsp;<span class="ident" id="2419836">ptrace</span><span class="op" id="2419842">(</span><span class="ident" id="2419843">PTRACE_SINGLESTEP</span><span class="op" id="2419860">,</span>&nbsp;<span class="ident" id="2419862">pid</span><span class="op" id="2419865">,</span>&nbsp;<span class="num" id="2419867">0</span><span class="op" id="2419868">,</span>&nbsp;<span class="num" id="2419870">0</span><span class="op" id="2419871">)</span>&nbsp;<span class="op" id="2419873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2419876">func</span>&nbsp;<span class="ident" id="2419881">PtraceAttach</span><span class="op" id="2419893">(</span><span class="ident" id="2419894">pid</span>&nbsp;<span class="builtintype" id="2419898">int</span><span class="op" id="2419901">)</span>&nbsp;<span class="op" id="2419903">(</span><span class="ident" id="2419904">err</span>&nbsp;<span class="builtintype" id="2419908">error</span><span class="op" id="2419913">)</span>&nbsp;<span class="op" id="2419915">{</span>&nbsp;<span class="keyword" id="2419917">return</span>&nbsp;<span class="ident" id="2419924">ptrace</span><span class="op" id="2419930">(</span><span class="ident" id="2419931">PTRACE_ATTACH</span><span class="op" id="2419944">,</span>&nbsp;<span class="ident" id="2419946">pid</span><span class="op" id="2419949">,</span>&nbsp;<span class="num" id="2419951">0</span><span class="op" id="2419952">,</span>&nbsp;<span class="num" id="2419954">0</span><span class="op" id="2419955">)</span>&nbsp;<span class="op" id="2419957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2419960">func</span>&nbsp;<span class="ident" id="2419965">PtraceDetach</span><span class="op" id="2419977">(</span><span class="ident" id="2419978">pid</span>&nbsp;<span class="builtintype" id="2419982">int</span><span class="op" id="2419985">)</span>&nbsp;<span class="op" id="2419987">(</span><span class="ident" id="2419988">err</span>&nbsp;<span class="builtintype" id="2419992">error</span><span class="op" id="2419997">)</span>&nbsp;<span class="op" id="2419999">{</span>&nbsp;<span class="keyword" id="2420001">return</span>&nbsp;<span class="ident" id="2420008">ptrace</span><span class="op" id="2420014">(</span><span class="ident" id="2420015">PTRACE_DETACH</span><span class="op" id="2420028">,</span>&nbsp;<span class="ident" id="2420030">pid</span><span class="op" id="2420033">,</span>&nbsp;<span class="num" id="2420035">0</span><span class="op" id="2420036">,</span>&nbsp;<span class="num" id="2420038">0</span><span class="op" id="2420039">)</span>&nbsp;<span class="op" id="2420041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2420044">//sys&nbsp;&nbsp;&nbsp;&nbspreboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2420117">func</span>&nbsp;<span class="ident" id="2420122">Reboot</span><span class="op" id="2420128">(</span><span class="ident" id="2420129">cmd</span>&nbsp;<span class="builtintype" id="2420133">int</span><span class="op" id="2420136">)</span>&nbsp;<span class="op" id="2420138">(</span><span class="ident" id="2420139">err</span>&nbsp;<span class="builtintype" id="2420143">error</span><span class="op" id="2420148">)</span>&nbsp;<span class="op" id="2420150">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420153">return</span>&nbsp;<span class="ident" id="2420160">reboot</span><span class="op" id="2420166">(</span><span class="ident" id="2420167">LINUX_REBOOT_MAGIC1</span><span class="op" id="2420186">,</span>&nbsp;<span class="ident" id="2420188">LINUX_REBOOT_MAGIC2</span><span class="op" id="2420207">,</span>&nbsp;<span class="ident" id="2420209">cmd</span><span class="op" id="2420212">,</span>&nbsp;<span class="string" id="2420214">&#34;&#34;</span><span class="op" id="2420216">)</span><br>
<span class="lineno"></span><span class="op" id="2420218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2420221">func</span>&nbsp;<span class="ident" id="2420226">clen</span><span class="op" id="2420230">(</span><span class="ident" id="2420231">n</span>&nbsp;<span class="op" id="2420233">[</span><span class="op" id="2420234">]</span><span class="builtintype" id="2420235">byte</span><span class="op" id="2420239">)</span>&nbsp;<span class="builtintype" id="2420241">int</span>&nbsp;<span class="op" id="2420245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420248">for</span>&nbsp;<span class="ident" id="2420252">i</span>&nbsp;<span class="op" id="2420254">:=</span>&nbsp;<span class="num" id="2420257">0</span><span class="op" id="2420258">;</span>&nbsp;<span class="ident" id="2420260">i</span>&nbsp;<span class="op" id="2420262">&lt;</span>&nbsp;<span class="builtinfunc" id="2420264">len</span><span class="op" id="2420267">(</span><span class="ident" id="2420268">n</span><span class="op" id="2420269">)</span><span class="op" id="2420270">;</span>&nbsp;<span class="ident" id="2420272">i</span><span class="op" id="2420273">++</span>&nbsp;<span class="op" id="2420276">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420280">if</span>&nbsp;<span class="ident" id="2420283">n</span><span class="op" id="2420284">[</span><span class="ident" id="2420285">i</span><span class="op" id="2420286">]</span>&nbsp;<span class="op" id="2420288">==</span>&nbsp;<span class="num" id="2420291">0</span>&nbsp;<span class="op" id="2420293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420298">return</span>&nbsp;<span class="ident" id="2420305">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420315">return</span>&nbsp;<span class="builtinfunc" id="2420322">len</span><span class="op" id="2420325">(</span><span class="ident" id="2420326">n</span><span class="op" id="2420327">)</span><br>
<span class="lineno">735</span><span class="op" id="2420329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2420332">func</span>&nbsp;<span class="ident" id="2420337">ReadDirent</span><span class="op" id="2420347">(</span><span class="ident" id="2420348">fd</span>&nbsp;<span class="builtintype" id="2420351">int</span><span class="op" id="2420354">,</span>&nbsp;<span class="ident" id="2420356">buf</span>&nbsp;<span class="op" id="2420360">[</span><span class="op" id="2420361">]</span><span class="builtintype" id="2420362">byte</span><span class="op" id="2420366">)</span>&nbsp;<span class="op" id="2420368">(</span><span class="ident" id="2420369">n</span>&nbsp;<span class="builtintype" id="2420371">int</span><span class="op" id="2420374">,</span>&nbsp;<span class="ident" id="2420376">err</span>&nbsp;<span class="builtintype" id="2420380">error</span><span class="op" id="2420385">)</span>&nbsp;<span class="op" id="2420387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420390">return</span>&nbsp;<span class="ident" id="2420397">Getdents</span><span class="op" id="2420405">(</span><span class="ident" id="2420406">fd</span><span class="op" id="2420408">,</span>&nbsp;<span class="ident" id="2420410">buf</span><span class="op" id="2420413">)</span><br>
<span class="lineno"></span><span class="op" id="2420415">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2420418">func</span>&nbsp;<span class="ident" id="2420423">ParseDirent</span><span class="op" id="2420434">(</span><span class="ident" id="2420435">buf</span>&nbsp;<span class="op" id="2420439">[</span><span class="op" id="2420440">]</span><span class="builtintype" id="2420441">byte</span><span class="op" id="2420445">,</span>&nbsp;<span class="ident" id="2420447">max</span>&nbsp;<span class="builtintype" id="2420451">int</span><span class="op" id="2420454">,</span>&nbsp;<span class="ident" id="2420456">names</span>&nbsp;<span class="op" id="2420462">[</span><span class="op" id="2420463">]</span><span class="builtintype" id="2420464">string</span><span class="op" id="2420470">)</span>&nbsp;<span class="op" id="2420472">(</span><span class="ident" id="2420473">consumed</span>&nbsp;<span class="builtintype" id="2420482">int</span><span class="op" id="2420485">,</span>&nbsp;<span class="ident" id="2420487">count</span>&nbsp;<span class="builtintype" id="2420493">int</span><span class="op" id="2420496">,</span>&nbsp;<span class="ident" id="2420498">newnames</span>&nbsp;<span class="op" id="2420507">[</span><span class="op" id="2420508">]</span><span class="builtintype" id="2420509">string</span><span class="op" id="2420515">)</span>&nbsp;<span class="op" id="2420517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420520">origlen</span>&nbsp;<span class="op" id="2420528">:=</span>&nbsp;<span class="builtinfunc" id="2420531">len</span><span class="op" id="2420534">(</span><span class="ident" id="2420535">buf</span><span class="op" id="2420538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420541">count</span>&nbsp;<span class="op" id="2420547">=</span>&nbsp;<span class="num" id="2420549">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420552">for</span>&nbsp;<span class="ident" id="2420556">max</span>&nbsp;<span class="op" id="2420560">!=</span>&nbsp;<span class="num" id="2420563">0</span>&nbsp;<span class="op" id="2420565">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2420568">len</span><span class="op" id="2420571">(</span><span class="ident" id="2420572">buf</span><span class="op" id="2420575">)</span>&nbsp;<span class="op" id="2420577">&gt;</span>&nbsp;<span class="num" id="2420579">0</span>&nbsp;<span class="op" id="2420581">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420585">dirent</span>&nbsp;<span class="op" id="2420592">:=</span>&nbsp;<span class="op" id="2420595">(</span><span class="op" id="2420596">*</span><span class="ident" id="2420597">Dirent</span><span class="op" id="2420603">)</span><span class="op" id="2420604">(</span><span class="ident" id="2420605">unsafe</span><span class="op" id="2420611">.</span><span class="ident" id="2420612">Pointer</span><span class="op" id="2420619">(</span><span class="op" id="2420620">&amp;</span><span class="ident" id="2420621">buf</span><span class="op" id="2420624">[</span><span class="num" id="2420625">0</span><span class="op" id="2420626">]</span><span class="op" id="2420627">)</span><span class="op" id="2420628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420632">buf</span>&nbsp;<span class="op" id="2420636">=</span>&nbsp;<span class="ident" id="2420638">buf</span><span class="op" id="2420641">[</span><span class="ident" id="2420642">dirent</span><span class="op" id="2420648">.</span><span class="ident" id="2420649">Reclen</span><span class="op" id="2420655">:</span><span class="op" id="2420656">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420660">if</span>&nbsp;<span class="ident" id="2420663">dirent</span><span class="op" id="2420669">.</span><span class="ident" id="2420670">Ino</span>&nbsp;<span class="op" id="2420674">==</span>&nbsp;<span class="num" id="2420677">0</span>&nbsp;<span class="op" id="2420679">{</span>&nbsp;<span class="comment" id="2420681">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420713">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420724">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420728">bytes</span>&nbsp;<span class="op" id="2420734">:=</span>&nbsp;<span class="op" id="2420737">(</span><span class="op" id="2420738">*</span><span class="op" id="2420739">[</span><span class="num" id="2420740">10000</span><span class="op" id="2420745">]</span><span class="builtintype" id="2420746">byte</span><span class="op" id="2420750">)</span><span class="op" id="2420751">(</span><span class="ident" id="2420752">unsafe</span><span class="op" id="2420758">.</span><span class="ident" id="2420759">Pointer</span><span class="op" id="2420766">(</span><span class="op" id="2420767">&amp;</span><span class="ident" id="2420768">dirent</span><span class="op" id="2420774">.</span><span class="ident" id="2420775">Name</span><span class="op" id="2420779">[</span><span class="num" id="2420780">0</span><span class="op" id="2420781">]</span><span class="op" id="2420782">)</span><span class="op" id="2420783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420787">var</span>&nbsp;<span class="ident" id="2420791">name</span>&nbsp;<span class="op" id="2420796">=</span>&nbsp;<span class="builtintype" id="2420798">string</span><span class="op" id="2420804">(</span><span class="ident" id="2420805">bytes</span><span class="op" id="2420810">[</span><span class="num" id="2420811">0</span><span class="op" id="2420812">:</span><span class="ident" id="2420813">clen</span><span class="op" id="2420817">(</span><span class="ident" id="2420818">bytes</span><span class="op" id="2420823">[</span><span class="op" id="2420824">:</span><span class="op" id="2420825">]</span><span class="op" id="2420826">)</span><span class="op" id="2420827">]</span><span class="op" id="2420828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420832">if</span>&nbsp;<span class="ident" id="2420835">name</span>&nbsp;<span class="op" id="2420840">==</span>&nbsp;<span class="string" id="2420843">&#34;.&#34;</span>&nbsp;<span class="op" id="2420847">||</span>&nbsp;<span class="ident" id="2420850">name</span>&nbsp;<span class="op" id="2420855">==</span>&nbsp;<span class="string" id="2420858">&#34;..&#34;</span>&nbsp;<span class="op" id="2420863">{</span>&nbsp;<span class="comment" id="2420865">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420885">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420896">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420900">max</span><span class="op" id="2420903">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420908">count</span><span class="op" id="2420913">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420918">names</span>&nbsp;<span class="op" id="2420924">=</span>&nbsp;<span class="builtinfunc" id="2420926">append</span><span class="op" id="2420932">(</span><span class="ident" id="2420933">names</span><span class="op" id="2420938">,</span>&nbsp;<span class="ident" id="2420940">name</span><span class="op" id="2420944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420950">return</span>&nbsp;<span class="ident" id="2420957">origlen</span>&nbsp;<span class="op" id="2420965">-</span>&nbsp;<span class="builtinfunc" id="2420967">len</span><span class="op" id="2420970">(</span><span class="ident" id="2420971">buf</span><span class="op" id="2420974">)</span><span class="op" id="2420975">,</span>&nbsp;<span class="ident" id="2420977">count</span><span class="op" id="2420982">,</span>&nbsp;<span class="ident" id="2420984">names</span><br>
<span class="lineno">760</span><span class="op" id="2420990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2420993">//sys&nbsp;&nbsp;&nbsp;&nbspmount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2421090">func</span>&nbsp;<span class="ident" id="2421095">Mount</span><span class="op" id="2421100">(</span><span class="ident" id="2421101">source</span>&nbsp;<span class="builtintype" id="2421108">string</span><span class="op" id="2421114">,</span>&nbsp;<span class="ident" id="2421116">target</span>&nbsp;<span class="builtintype" id="2421123">string</span><span class="op" id="2421129">,</span>&nbsp;<span class="ident" id="2421131">fstype</span>&nbsp;<span class="builtintype" id="2421138">string</span><span class="op" id="2421144">,</span>&nbsp;<span class="ident" id="2421146">flags</span>&nbsp;<span class="builtintype" id="2421152">uintptr</span><span class="op" id="2421159">,</span>&nbsp;<span class="ident" id="2421161">data</span>&nbsp;<span class="builtintype" id="2421166">string</span><span class="op" id="2421172">)</span>&nbsp;<span class="op" id="2421174">(</span><span class="ident" id="2421175">err</span>&nbsp;<span class="builtintype" id="2421179">error</span><span class="op" id="2421184">)</span>&nbsp;<span class="op" id="2421186">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2421189">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2421254">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421306">if</span>&nbsp;<span class="ident" id="2421309">data</span>&nbsp;<span class="op" id="2421314">==</span>&nbsp;<span class="string" id="2421317">&#34;&#34;</span>&nbsp;<span class="op" id="2421320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421324">return</span>&nbsp;<span class="ident" id="2421331">mount</span><span class="op" id="2421336">(</span><span class="ident" id="2421337">source</span><span class="op" id="2421343">,</span>&nbsp;<span class="ident" id="2421345">target</span><span class="op" id="2421351">,</span>&nbsp;<span class="ident" id="2421353">fstype</span><span class="op" id="2421359">,</span>&nbsp;<span class="ident" id="2421361">flags</span><span class="op" id="2421366">,</span>&nbsp;<span class="ident" id="2421368">nil</span><span class="op" id="2421371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421374">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421377">datap</span><span class="op" id="2421382">,</span>&nbsp;<span class="ident" id="2421384">err</span>&nbsp;<span class="op" id="2421388">:=</span>&nbsp;<span class="ident" id="2421391">BytePtrFromString</span><span class="op" id="2421408">(</span><span class="ident" id="2421409">data</span><span class="op" id="2421413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421416">if</span>&nbsp;<span class="ident" id="2421419">err</span>&nbsp;<span class="op" id="2421423">!=</span>&nbsp;<span class="ident" id="2421426">nil</span>&nbsp;<span class="op" id="2421430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421434">return</span>&nbsp;<span class="ident" id="2421441">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421449">err</span>&nbsp;<span class="op" id="2421453">=</span>&nbsp;<span class="ident" id="2421455">mount</span><span class="op" id="2421460">(</span><span class="ident" id="2421461">source</span><span class="op" id="2421467">,</span>&nbsp;<span class="ident" id="2421469">target</span><span class="op" id="2421475">,</span>&nbsp;<span class="ident" id="2421477">fstype</span><span class="op" id="2421483">,</span>&nbsp;<span class="ident" id="2421485">flags</span><span class="op" id="2421490">,</span>&nbsp;<span class="ident" id="2421492">datap</span><span class="op" id="2421497">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421500">use</span><span class="op" id="2421503">(</span><span class="ident" id="2421504">unsafe</span><span class="op" id="2421510">.</span><span class="ident" id="2421511">Pointer</span><span class="op" id="2421518">(</span><span class="ident" id="2421519">datap</span><span class="op" id="2421524">)</span><span class="op" id="2421525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421528">return</span>&nbsp;<span class="ident" id="2421535">err</span><br>
<span class="lineno"></span><span class="op" id="2421539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2421542">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2421552">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2421564">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2421579">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2421603">//sys&nbsp;&nbsp;&nbsp;&nbspAccess(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421654">//sys&nbsp;&nbsp;&nbsp;&nbspAcct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421690">//sys&nbsp;&nbsp;&nbsp;&nbspAdjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421740">//sys&nbsp;&nbsp;&nbsp;&nbspChdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2421777">//sys&nbsp;&nbsp;&nbsp;&nbspChmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421827">//sys&nbsp;&nbsp;&nbsp;&nbspChroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421865">//sys&nbsp;&nbsp;&nbsp;&nbspClose(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421897">//sys&nbsp;&nbsp;&nbsp;&nbspCreat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2421955">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2421998">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422045">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422103">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422153">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422204">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2422278">//sys&nbsp;&nbsp;&nbsp;&nbspEpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422354">//sys&nbsp;&nbsp;&nbsp;&nbspExit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2422392">//sys&nbsp;&nbsp;&nbsp;&nbspFaccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422468">//sys&nbsp;&nbsp;&nbsp;&nbspFallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422539">//sys&nbsp;&nbsp;&nbsp;&nbspFchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2422572">//sys&nbsp;&nbsp;&nbsp;&nbspFchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422618">//sys&nbsp;&nbsp;&nbsp;&nbspFchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422693">//sys&nbsp;&nbsp;&nbsp;&nbspFchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422773">//sys&nbsp;&nbsp;&nbsp;&nbspfcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422832">//sys&nbsp;&nbsp;&nbsp;&nbspFdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2422868">//sys&nbsp;&nbsp;&nbsp;&nbspFlock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422909">//sys&nbsp;&nbsp;&nbsp;&nbspFsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2422941">//sys&nbsp;&nbsp;&nbsp;&nbspGetdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2423012">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423059">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2423087">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2423114">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2423143">//sys&nbsp;&nbsp;&nbsp;&nbspGetpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423203">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423258">//sysnb&nbsp;&nbsp;&nbsp;&nbspGettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2423285">//sys&nbsp;&nbsp;&nbsp;&nbspGetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423359">//sys&nbsp;&nbsp;&nbsp;&nbspInotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423446">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423488">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423540">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2423614">//sysnb&nbsp;&nbsp;&nbsp;&nbspKill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423660">//sys&nbsp;&nbsp;&nbsp;&nbspKlogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2423727">//sys&nbsp;&nbsp;&nbsp;&nbspLink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423782">//sys&nbsp;&nbsp;&nbsp;&nbspListxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423844">//sys&nbsp;&nbsp;&nbsp;&nbspMkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2423894">//sys&nbsp;&nbsp;&nbsp;&nbspMkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2423957">//sys&nbsp;&nbsp;&nbsp;&nbspMknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424016">//sys&nbsp;&nbsp;&nbsp;&nbspMknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424088">//sys&nbsp;&nbsp;&nbsp;&nbspNanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424152">//sys&nbsp;&nbsp;&nbsp;&nbspPause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2424178">//sys&nbsp;&nbsp;&nbsp;&nbspPivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2424254">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2424352">//sys&nbsp;&nbsp;&nbsp;&nbspread(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424400">//sys&nbsp;&nbsp;&nbsp;&nbspReadlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424459">//sys&nbsp;&nbsp;&nbsp;&nbspRemovexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2424515">//sys&nbsp;&nbsp;&nbsp;&nbspRename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424572">//sys&nbsp;&nbsp;&nbsp;&nbspRenameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424659">//sys&nbsp;&nbsp;&nbsp;&nbspRmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424696">//sys&nbsp;&nbsp;&nbsp;&nbspSetdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424738">//sys&nbsp;&nbsp;&nbsp;&nbspSethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2424778">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424825">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2424863">//sysnb&nbsp;&nbsp;&nbsp;&nbspSettimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2424910">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2424925">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2425005">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2425080">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2425151">func</span>&nbsp;<span class="ident" id="2425156">Setuid</span><span class="op" id="2425162">(</span><span class="ident" id="2425163">uid</span>&nbsp;<span class="builtintype" id="2425167">int</span><span class="op" id="2425170">)</span>&nbsp;<span class="op" id="2425172">(</span><span class="ident" id="2425173">err</span>&nbsp;<span class="builtintype" id="2425177">error</span><span class="op" id="2425182">)</span>&nbsp;<span class="op" id="2425184">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425187">return</span>&nbsp;<span class="ident" id="2425194">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2425205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2425208">func</span>&nbsp;<span class="ident" id="2425213">Setgid</span><span class="op" id="2425219">(</span><span class="ident" id="2425220">uid</span>&nbsp;<span class="builtintype" id="2425224">int</span><span class="op" id="2425227">)</span>&nbsp;<span class="op" id="2425229">(</span><span class="ident" id="2425230">err</span>&nbsp;<span class="builtintype" id="2425234">error</span><span class="op" id="2425239">)</span>&nbsp;<span class="op" id="2425241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425244">return</span>&nbsp;<span class="ident" id="2425251">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2425262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2425265">//sys&nbsp;&nbsp;&nbsp;&nbspSetpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425325">//sys&nbsp;&nbsp;&nbsp;&nbspSetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425402">//sys&nbsp;&nbsp;&nbsp;&nbspSymlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2425460">//sys&nbsp;&nbsp;&nbsp;&nbspSync()</span><br>
<span class="lineno"></span><span class="comment" id="2425473">//sysnb&nbsp;&nbsp;&nbsp;&nbspSysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425518">//sys&nbsp;&nbsp;&nbsp;&nbspTee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425587">//sysnb&nbsp;&nbsp;&nbsp;&nbspTgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425645">//sysnb&nbsp;&nbsp;&nbsp;&nbspTimes(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2425696">//sysnb&nbsp;&nbsp;&nbsp;&nbspUmask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2425734">//sysnb&nbsp;&nbsp;&nbsp;&nbspUname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425774">//sys&nbsp;&nbsp;&nbsp;&nbspUnlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425812">//sys&nbsp;&nbsp;&nbsp;&nbspUnlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425863">//sys&nbsp;&nbsp;&nbsp;&nbspUnmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2425929">//sys&nbsp;&nbsp;&nbsp;&nbspUnshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425966">//sys&nbsp;&nbsp;&nbsp;&nbspUstat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426014">//sys&nbsp;&nbsp;&nbsp;&nbspUtime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426065">//sys&nbsp;&nbsp;&nbsp;&nbspwrite(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426114">//sys&nbsp;&nbsp;&nbsp;&nbspexitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2426164">//sys&nbsp;&nbsp;&nbsp;&nbspreadlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2426233">//sys&nbsp;&nbsp;&nbsp;&nbspwritelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2426305">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2426361">//sys&nbsp;&nbsp;&nbsp;&nbspmunmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2426417">var</span>&nbsp;<span class="ident" id="2426421">mapper</span>&nbsp;<span class="op" id="2426428">=</span>&nbsp;<span class="op" id="2426430">&amp;</span><span class="ident" id="2426431">mmapper</span><span class="op" id="2426438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2426441">active</span><span class="op" id="2426447">:</span>&nbsp;<span class="builtinfunc" id="2426449">make</span><span class="op" id="2426453">(</span><span class="keyword" id="2426454">map</span><span class="op" id="2426457">[</span><span class="op" id="2426458">*</span><span class="builtintype" id="2426459">byte</span><span class="op" id="2426463">]</span><span class="op" id="2426464">[</span><span class="op" id="2426465">]</span><span class="builtintype" id="2426466">byte</span><span class="op" id="2426470">)</span><span class="op" id="2426471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2426474">mmap</span><span class="op" id="2426478">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2426482">mmap</span><span class="op" id="2426486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2426489">munmap</span><span class="op" id="2426495">:</span>&nbsp;<span class="ident" id="2426497">munmap</span><span class="op" id="2426503">,</span><br>
<span class="lineno">890</span><span class="op" id="2426505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2426508">func</span>&nbsp;<span class="ident" id="2426513">Mmap</span><span class="op" id="2426517">(</span><span class="ident" id="2426518">fd</span>&nbsp;<span class="builtintype" id="2426521">int</span><span class="op" id="2426524">,</span>&nbsp;<span class="ident" id="2426526">offset</span>&nbsp;<span class="ident" id="2426533">int64</span><span class="op" id="2426538">,</span>&nbsp;<span class="ident" id="2426540">length</span>&nbsp;<span class="builtintype" id="2426547">int</span><span class="op" id="2426550">,</span>&nbsp;<span class="ident" id="2426552">prot</span>&nbsp;<span class="builtintype" id="2426557">int</span><span class="op" id="2426560">,</span>&nbsp;<span class="ident" id="2426562">flags</span>&nbsp;<span class="builtintype" id="2426568">int</span><span class="op" id="2426571">)</span>&nbsp;<span class="op" id="2426573">(</span><span class="ident" id="2426574">data</span>&nbsp;<span class="op" id="2426579">[</span><span class="op" id="2426580">]</span><span class="builtintype" id="2426581">byte</span><span class="op" id="2426585">,</span>&nbsp;<span class="ident" id="2426587">err</span>&nbsp;<span class="builtintype" id="2426591">error</span><span class="op" id="2426596">)</span>&nbsp;<span class="op" id="2426598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426601">return</span>&nbsp;<span class="ident" id="2426608">mapper</span><span class="op" id="2426614">.</span><span class="ident" id="2426615">Mmap</span><span class="op" id="2426619">(</span><span class="ident" id="2426620">fd</span><span class="op" id="2426622">,</span>&nbsp;<span class="ident" id="2426624">offset</span><span class="op" id="2426630">,</span>&nbsp;<span class="ident" id="2426632">length</span><span class="op" id="2426638">,</span>&nbsp;<span class="ident" id="2426640">prot</span><span class="op" id="2426644">,</span>&nbsp;<span class="ident" id="2426646">flags</span><span class="op" id="2426651">)</span><br>
<span class="lineno"></span><span class="op" id="2426653">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2426656">func</span>&nbsp;<span class="ident" id="2426661">Munmap</span><span class="op" id="2426667">(</span><span class="ident" id="2426668">b</span>&nbsp;<span class="op" id="2426670">[</span><span class="op" id="2426671">]</span><span class="builtintype" id="2426672">byte</span><span class="op" id="2426676">)</span>&nbsp;<span class="op" id="2426678">(</span><span class="ident" id="2426679">err</span>&nbsp;<span class="builtintype" id="2426683">error</span><span class="op" id="2426688">)</span>&nbsp;<span class="op" id="2426690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426693">return</span>&nbsp;<span class="ident" id="2426700">mapper</span><span class="op" id="2426706">.</span><span class="ident" id="2426707">Munmap</span><span class="op" id="2426713">(</span><span class="ident" id="2426714">b</span><span class="op" id="2426715">)</span><br>
<span class="lineno"></span><span class="op" id="2426717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2426720">//sys&nbsp;&nbsp;&nbsp;&nbspMadvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426768">//sys&nbsp;&nbsp;&nbsp;&nbspMprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426815">//sys&nbsp;&nbsp;&nbsp;&nbspMlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426849">//sys&nbsp;&nbsp;&nbsp;&nbspMunlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426885">//sys&nbsp;&nbsp;&nbsp;&nbspMlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2426923">//sys&nbsp;&nbsp;&nbsp;&nbspMunlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2426955">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2426979">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2426989">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2427003">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2427012">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2427025">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2427032">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2427042">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2427052">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2427067">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2427083">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2427101">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2427117">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2427126">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2427142">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2427158">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2427173">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2427187">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2427203">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2427214">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2427224">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2427237">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2427250">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2427264">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2427272">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2427288">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2427301">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2427310">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2427327">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2427343">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2427360">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2427377">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2427390">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2427401">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2427413">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2427426">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2427441">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2427452">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2427464">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2427473">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2427486">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2427499">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2427512">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2427522">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2427535">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2427549">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2427566">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2427582">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2427595">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2427604">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2427620">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2427631">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2427644">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2427653">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2427666">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2427678">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2427694">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2427706">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2427716">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2427734">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2427749">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2427761">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2427771">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2427781">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2427791">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2427801">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2427811">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2427820">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2427834">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2427848">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2427863">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2427871">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2427880">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2427889">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2427901">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2427911">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2427922">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2427937">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2427949">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2427962">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2427971">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2427989">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2428003">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2428021">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2428036">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2428052">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2428069">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2428087">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2428102">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2428118">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2428136">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2428159">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2428182">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2428202">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2428219">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2428240">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2428262">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2428282">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2428299">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2428313">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2428325">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2428335">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2428345">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2428354">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2428368">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2428384">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2428401">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2428418">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2428435">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2428444">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2428454">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2428463">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2428473">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2428488">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2428500">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2428511">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2428521">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2428530">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2428545">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2428560">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2428579">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2428595">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2428611">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2428622">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2428642">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2428653">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2428664">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2428674">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2428687">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2428696">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2428707">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2428719">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2428730">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2428740">//&nbsp;_Sysctl</span>
</div>
</body>
</html>
