<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3661130">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3661186">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3661240">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3661291">//&nbsp;Package&nbsp;json&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;JSON&nbsp;objects&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3661370">//&nbsp;RFC&nbsp;4627.&nbsp;The&nbsp;mapping&nbsp;between&nbsp;JSON&nbsp;objects&nbsp;and&nbsp;Go&nbsp;values&nbsp;is&nbsp;described</span><br>
<span class="lineno"></span><span class="comment" id="3661443">//&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;the&nbsp;Marshal&nbsp;and&nbsp;Unmarshal&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="3661508">//</span><br>
<span class="lineno"></span><span class="comment" id="3661511">//&nbsp;See&nbsp;&#34;JSON&nbsp;and&nbsp;Go&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;this&nbsp;package:</span><br>
<span class="lineno">10</span><span class="comment" id="3661569">//&nbsp;http://golang.org/doc/articles/json_and_go.html</span><br>
<span class="lineno"></span><span class="keyword" id="3661620">package</span>&nbsp;<span class="ident" id="3661628">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3661634">import</span>&nbsp;<span class="op" id="3661641">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661644">&#34;bytes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661653">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661665">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661684">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661692">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661703">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661714">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661722">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661733">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661744">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661752">&#34;unicode&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3661763">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3661778">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3661781">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;JSON&nbsp;encoding&nbsp;of&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="3661824">//</span><br>
<span class="lineno">30</span><span class="comment" id="3661827">//&nbsp;Marshal&nbsp;traverses&nbsp;the&nbsp;value&nbsp;v&nbsp;recursively.</span><br>
<span class="lineno"></span><span class="comment" id="3661873">//&nbsp;If&nbsp;an&nbsp;encountered&nbsp;value&nbsp;implements&nbsp;the&nbsp;Marshaler&nbsp;interface</span><br>
<span class="lineno"></span><span class="comment" id="3661935">//&nbsp;and&nbsp;is&nbsp;not&nbsp;a&nbsp;nil&nbsp;pointer,&nbsp;Marshal&nbsp;calls&nbsp;its&nbsp;MarshalJSON&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="3662001">//&nbsp;to&nbsp;produce&nbsp;JSON.&nbsp;&nbsp;The&nbsp;nil&nbsp;pointer&nbsp;exception&nbsp;is&nbsp;not&nbsp;strictly&nbsp;necessary</span><br>
<span class="lineno"></span><span class="comment" id="3662074">//&nbsp;but&nbsp;mimics&nbsp;a&nbsp;similar,&nbsp;necessary&nbsp;exception&nbsp;in&nbsp;the&nbsp;behavior&nbsp;of</span><br>
<span class="lineno">35</span><span class="comment" id="3662138">//&nbsp;UnmarshalJSON.</span><br>
<span class="lineno"></span><span class="comment" id="3662156">//</span><br>
<span class="lineno"></span><span class="comment" id="3662159">//&nbsp;Otherwise,&nbsp;Marshal&nbsp;uses&nbsp;the&nbsp;following&nbsp;type-dependent&nbsp;default&nbsp;encodings:</span><br>
<span class="lineno"></span><span class="comment" id="3662234">//</span><br>
<span class="lineno"></span><span class="comment" id="3662237">//&nbsp;Boolean&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;booleans.</span><br>
<span class="lineno">40</span><span class="comment" id="3662280">//</span><br>
<span class="lineno"></span><span class="comment" id="3662283">//&nbsp;Floating&nbsp;point,&nbsp;integer,&nbsp;and&nbsp;Number&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;numbers.</span><br>
<span class="lineno"></span><span class="comment" id="3662353">//</span><br>
<span class="lineno"></span><span class="comment" id="3662356">//&nbsp;String&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;strings&nbsp;coerced&nbsp;to&nbsp;valid&nbsp;UTF-8,</span><br>
<span class="lineno"></span><span class="comment" id="3662420">//&nbsp;replacing&nbsp;invalid&nbsp;bytes&nbsp;with&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="3662482">//&nbsp;The&nbsp;angle&nbsp;brackets&nbsp;&#34;&lt;&#34;&nbsp;and&nbsp;&#34;&gt;&#34;&nbsp;are&nbsp;escaped&nbsp;to&nbsp;&#34;\u003c&#34;&nbsp;and&nbsp;&#34;\u003e&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3662553">//&nbsp;to&nbsp;keep&nbsp;some&nbsp;browsers&nbsp;from&nbsp;misinterpreting&nbsp;JSON&nbsp;output&nbsp;as&nbsp;HTML.</span><br>
<span class="lineno"></span><span class="comment" id="3662620">//&nbsp;Ampersand&nbsp;&#34;&amp;&#34;&nbsp;is&nbsp;also&nbsp;escaped&nbsp;to&nbsp;&#34;\u0026&#34;&nbsp;for&nbsp;the&nbsp;same&nbsp;reason.</span><br>
<span class="lineno"></span><span class="comment" id="3662686">//</span><br>
<span class="lineno"></span><span class="comment" id="3662689">//&nbsp;Array&nbsp;and&nbsp;slice&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;arrays,&nbsp;except&nbsp;that</span><br>
<span class="lineno">50</span><span class="comment" id="3662750">//&nbsp;[]byte&nbsp;encodes&nbsp;as&nbsp;a&nbsp;base64-encoded&nbsp;string,&nbsp;and&nbsp;a&nbsp;nil&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="3662812">//&nbsp;encodes&nbsp;as&nbsp;the&nbsp;null&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="3662848">//</span><br>
<span class="lineno"></span><span class="comment" id="3662851">//&nbsp;Struct&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;objects.&nbsp;Each&nbsp;exported&nbsp;struct&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="3662919">//&nbsp;becomes&nbsp;a&nbsp;member&nbsp;of&nbsp;the&nbsp;object&nbsp;unless</span><br>
<span class="lineno">55</span><span class="comment" id="3662960">//&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;field&#39;s&nbsp;tag&nbsp;is&nbsp;&#34;-&#34;,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3662994">//&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;field&nbsp;is&nbsp;empty&nbsp;and&nbsp;its&nbsp;tag&nbsp;specifies&nbsp;the&nbsp;&#34;omitempty&#34;&nbsp;option.</span><br>
<span class="lineno"></span><span class="comment" id="3663066">//&nbsp;The&nbsp;empty&nbsp;values&nbsp;are&nbsp;false,&nbsp;0,&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="3663104">//&nbsp;nil&nbsp;pointer&nbsp;or&nbsp;interface&nbsp;value,&nbsp;and&nbsp;any&nbsp;array,&nbsp;slice,&nbsp;map,&nbsp;or&nbsp;string&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3663179">//&nbsp;length&nbsp;zero.&nbsp;The&nbsp;object&#39;s&nbsp;default&nbsp;key&nbsp;string&nbsp;is&nbsp;the&nbsp;struct&nbsp;field&nbsp;name</span><br>
<span class="lineno">60</span><span class="comment" id="3663252">//&nbsp;but&nbsp;can&nbsp;be&nbsp;specified&nbsp;in&nbsp;the&nbsp;struct&nbsp;field&#39;s&nbsp;tag&nbsp;value.&nbsp;The&nbsp;&#34;json&#34;&nbsp;key&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3663327">//&nbsp;the&nbsp;struct&nbsp;field&#39;s&nbsp;tag&nbsp;value&nbsp;is&nbsp;the&nbsp;key&nbsp;name,&nbsp;followed&nbsp;by&nbsp;an&nbsp;optional&nbsp;comma</span><br>
<span class="lineno"></span><span class="comment" id="3663406">//&nbsp;and&nbsp;options.&nbsp;Examples:</span><br>
<span class="lineno"></span><span class="comment" id="3663432">//</span><br>
<span class="lineno"></span><span class="comment" id="3663435">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;is&nbsp;ignored&nbsp;by&nbsp;this&nbsp;package.</span><br>
<span class="lineno">65</span><span class="comment" id="3663477">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;-&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="3663503">//</span><br>
<span class="lineno"></span><span class="comment" id="3663506">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;appears&nbsp;in&nbsp;JSON&nbsp;as&nbsp;key&nbsp;&#34;myName&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3663553">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;myName&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="3663584">//</span><br>
<span class="lineno">70</span><span class="comment" id="3663587">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;appears&nbsp;in&nbsp;JSON&nbsp;as&nbsp;key&nbsp;&#34;myName&#34;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3663637">//&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;field&nbsp;is&nbsp;omitted&nbsp;from&nbsp;the&nbsp;object&nbsp;if&nbsp;its&nbsp;value&nbsp;is&nbsp;empty,</span><br>
<span class="lineno"></span><span class="comment" id="3663705">//&nbsp;&nbsp;&nbsp;//&nbsp;as&nbsp;defined&nbsp;above.</span><br>
<span class="lineno"></span><span class="comment" id="3663731">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;myName,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="3663772">//</span><br>
<span class="lineno">75</span><span class="comment" id="3663775">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;appears&nbsp;in&nbsp;JSON&nbsp;as&nbsp;key&nbsp;&#34;Field&#34;&nbsp;(the&nbsp;default),&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="3663839">//&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;field&nbsp;is&nbsp;skipped&nbsp;if&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="3663878">//&nbsp;&nbsp;&nbsp;//&nbsp;Note&nbsp;the&nbsp;leading&nbsp;comma.</span><br>
<span class="lineno"></span><span class="comment" id="3663910">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="3663945">//</span><br>
<span class="lineno">80</span><span class="comment" id="3663948">//&nbsp;The&nbsp;&#34;string&#34;&nbsp;option&nbsp;signals&nbsp;that&nbsp;a&nbsp;field&nbsp;is&nbsp;stored&nbsp;as&nbsp;JSON&nbsp;inside&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3664019">//&nbsp;JSON-encoded&nbsp;string.&nbsp;It&nbsp;applies&nbsp;only&nbsp;to&nbsp;fields&nbsp;of&nbsp;string,&nbsp;floating&nbsp;point,</span><br>
<span class="lineno"></span><span class="comment" id="3664096">//&nbsp;or&nbsp;integer&nbsp;types.&nbsp;This&nbsp;extra&nbsp;level&nbsp;of&nbsp;encoding&nbsp;is&nbsp;sometimes&nbsp;used&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="3664169">//&nbsp;communicating&nbsp;with&nbsp;JavaScript&nbsp;programs:</span><br>
<span class="lineno"></span><span class="comment" id="3664212">//</span><br>
<span class="lineno">85</span><span class="comment" id="3664215">//&nbsp;&nbsp;&nbsp;&nbsp;Int64String&nbsp;int64&nbsp;`json:&#34;,string&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="3664256">//</span><br>
<span class="lineno"></span><span class="comment" id="3664259">//&nbsp;The&nbsp;key&nbsp;name&nbsp;will&nbsp;be&nbsp;used&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3664329">//&nbsp;only&nbsp;Unicode&nbsp;letters,&nbsp;digits,&nbsp;dollar&nbsp;signs,&nbsp;percent&nbsp;signs,&nbsp;hyphens,</span><br>
<span class="lineno"></span><span class="comment" id="3664400">//&nbsp;underscores&nbsp;and&nbsp;slashes.</span><br>
<span class="lineno">90</span><span class="comment" id="3664428">//</span><br>
<span class="lineno"></span><span class="comment" id="3664431">//&nbsp;Anonymous&nbsp;struct&nbsp;fields&nbsp;are&nbsp;usually&nbsp;marshaled&nbsp;as&nbsp;if&nbsp;their&nbsp;inner&nbsp;exported&nbsp;fields</span><br>
<span class="lineno"></span><span class="comment" id="3664514">//&nbsp;were&nbsp;fields&nbsp;in&nbsp;the&nbsp;outer&nbsp;struct,&nbsp;subject&nbsp;to&nbsp;the&nbsp;usual&nbsp;Go&nbsp;visibility&nbsp;rules&nbsp;amended</span><br>
<span class="lineno"></span><span class="comment" id="3664599">//&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;next&nbsp;paragraph.</span><br>
<span class="lineno"></span><span class="comment" id="3664638">//&nbsp;An&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;given&nbsp;in&nbsp;its&nbsp;JSON&nbsp;tag&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno">95</span><span class="comment" id="3664715">//&nbsp;having&nbsp;that&nbsp;name,&nbsp;rather&nbsp;than&nbsp;being&nbsp;anonymous.</span><br>
<span class="lineno"></span><span class="comment" id="3664765">//&nbsp;An&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;of&nbsp;interface&nbsp;type&nbsp;is&nbsp;treated&nbsp;the&nbsp;same&nbsp;as&nbsp;having</span><br>
<span class="lineno"></span><span class="comment" id="3664842">//&nbsp;that&nbsp;type&nbsp;as&nbsp;its&nbsp;name,&nbsp;rather&nbsp;than&nbsp;being&nbsp;anonymous.</span><br>
<span class="lineno"></span><span class="comment" id="3664897">//</span><br>
<span class="lineno"></span><span class="comment" id="3664900">//&nbsp;The&nbsp;Go&nbsp;visibility&nbsp;rules&nbsp;for&nbsp;struct&nbsp;fields&nbsp;are&nbsp;amended&nbsp;for&nbsp;JSON&nbsp;when</span><br>
<span class="lineno">100</span><span class="comment" id="3664971">//&nbsp;deciding&nbsp;which&nbsp;field&nbsp;to&nbsp;marshal&nbsp;or&nbsp;unmarshal.&nbsp;If&nbsp;there&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3665033">//&nbsp;multiple&nbsp;fields&nbsp;at&nbsp;the&nbsp;same&nbsp;level,&nbsp;and&nbsp;that&nbsp;level&nbsp;is&nbsp;the&nbsp;least</span><br>
<span class="lineno"></span><span class="comment" id="3665099">//&nbsp;nested&nbsp;(and&nbsp;would&nbsp;therefore&nbsp;be&nbsp;the&nbsp;nesting&nbsp;level&nbsp;selected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3665167">//&nbsp;usual&nbsp;Go&nbsp;rules),&nbsp;the&nbsp;following&nbsp;extra&nbsp;rules&nbsp;apply:</span><br>
<span class="lineno"></span><span class="comment" id="3665220">//</span><br>
<span class="lineno">105</span><span class="comment" id="3665223">//&nbsp;1)&nbsp;Of&nbsp;those&nbsp;fields,&nbsp;if&nbsp;any&nbsp;are&nbsp;JSON-tagged,&nbsp;only&nbsp;tagged&nbsp;fields&nbsp;are&nbsp;considered,</span><br>
<span class="lineno"></span><span class="comment" id="3665305">//&nbsp;even&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;untagged&nbsp;fields&nbsp;that&nbsp;would&nbsp;otherwise&nbsp;conflict.</span><br>
<span class="lineno"></span><span class="comment" id="3665382">//&nbsp;2)&nbsp;If&nbsp;there&nbsp;is&nbsp;exactly&nbsp;one&nbsp;field&nbsp;(tagged&nbsp;or&nbsp;not&nbsp;according&nbsp;to&nbsp;the&nbsp;first&nbsp;rule),&nbsp;that&nbsp;is&nbsp;selected.</span><br>
<span class="lineno"></span><span class="comment" id="3665481">//&nbsp;3)&nbsp;Otherwise&nbsp;there&nbsp;are&nbsp;multiple&nbsp;fields,&nbsp;and&nbsp;all&nbsp;are&nbsp;ignored;&nbsp;no&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="3665562">//</span><br>
<span class="lineno">110</span><span class="comment" id="3665565">//&nbsp;Handling&nbsp;of&nbsp;anonymous&nbsp;struct&nbsp;fields&nbsp;is&nbsp;new&nbsp;in&nbsp;Go&nbsp;1.1.</span><br>
<span class="lineno"></span><span class="comment" id="3665622">//&nbsp;Prior&nbsp;to&nbsp;Go&nbsp;1.1,&nbsp;anonymous&nbsp;struct&nbsp;fields&nbsp;were&nbsp;ignored.&nbsp;To&nbsp;force&nbsp;ignoring&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3665701">//&nbsp;an&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;in&nbsp;both&nbsp;current&nbsp;and&nbsp;earlier&nbsp;versions,&nbsp;give&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="3665783">//&nbsp;a&nbsp;JSON&nbsp;tag&nbsp;of&nbsp;&#34;-&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3665805">//</span><br>
<span class="lineno">115</span><span class="comment" id="3665808">//&nbsp;Map&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;objects.</span><br>
<span class="lineno"></span><span class="comment" id="3665846">//&nbsp;The&nbsp;map&#39;s&nbsp;key&nbsp;type&nbsp;must&nbsp;be&nbsp;string;&nbsp;the&nbsp;object&nbsp;keys&nbsp;are&nbsp;used&nbsp;directly</span><br>
<span class="lineno"></span><span class="comment" id="3665918">//&nbsp;as&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="comment" id="3665934">//</span><br>
<span class="lineno"></span><span class="comment" id="3665937">//&nbsp;Pointer&nbsp;values&nbsp;encode&nbsp;as&nbsp;the&nbsp;value&nbsp;pointed&nbsp;to.</span><br>
<span class="lineno">120</span><span class="comment" id="3665987">//&nbsp;A&nbsp;nil&nbsp;pointer&nbsp;encodes&nbsp;as&nbsp;the&nbsp;null&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="3666037">//</span><br>
<span class="lineno"></span><span class="comment" id="3666040">//&nbsp;Interface&nbsp;values&nbsp;encode&nbsp;as&nbsp;the&nbsp;value&nbsp;contained&nbsp;in&nbsp;the&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3666108">//&nbsp;A&nbsp;nil&nbsp;interface&nbsp;value&nbsp;encodes&nbsp;as&nbsp;the&nbsp;null&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="3666166">//</span><br>
<span class="lineno">125</span><span class="comment" id="3666169">//&nbsp;Channel,&nbsp;complex,&nbsp;and&nbsp;function&nbsp;values&nbsp;cannot&nbsp;be&nbsp;encoded&nbsp;in&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="comment" id="3666237">//&nbsp;Attempting&nbsp;to&nbsp;encode&nbsp;such&nbsp;a&nbsp;value&nbsp;causes&nbsp;Marshal&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3666299">//&nbsp;an&nbsp;UnsupportedTypeError.</span><br>
<span class="lineno"></span><span class="comment" id="3666327">//</span><br>
<span class="lineno"></span><span class="comment" id="3666330">//&nbsp;JSON&nbsp;cannot&nbsp;represent&nbsp;cyclic&nbsp;data&nbsp;structures&nbsp;and&nbsp;Marshal&nbsp;does&nbsp;not</span><br>
<span class="lineno">130</span><span class="comment" id="3666399">//&nbsp;handle&nbsp;them.&nbsp;&nbsp;Passing&nbsp;cyclic&nbsp;structures&nbsp;to&nbsp;Marshal&nbsp;will&nbsp;result&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3666468">//&nbsp;an&nbsp;infinite&nbsp;recursion.</span><br>
<span class="lineno"></span><span class="comment" id="3666494">//</span><br>
<span class="lineno"></span><span class="keyword" id="3666497">func</span>&nbsp;<span class="ident" id="3666502">Marshal</span><span class="op" id="3666509">(</span><span class="ident" id="3666510">v</span>&nbsp;<span class="keyword" id="3666512">interface</span><span class="op" id="3666521">{</span><span class="op" id="3666522">}</span><span class="op" id="3666523">)</span>&nbsp;<span class="op" id="3666525">(</span><span class="op" id="3666526">[</span><span class="op" id="3666527">]</span><span class="builtintype" id="3666528">byte</span><span class="op" id="3666532">,</span>&nbsp;<span class="builtintype" id="3666534">error</span><span class="op" id="3666539">)</span>&nbsp;<span class="op" id="3666541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666544">e</span>&nbsp;<span class="op" id="3666546">:=</span>&nbsp;<span class="op" id="3666549">&amp;</span><span class="ident" id="3666550"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3666561">{</span><span class="op" id="3666562">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666565">err</span>&nbsp;<span class="op" id="3666569">:=</span>&nbsp;<span class="ident" id="3666572"><a href="/encoding/json/encode.go.html#3666544">e</a></span><span class="op" id="3666573">.</span><span class="ident" id="3666574">marshal</span><span class="op" id="3666581">(</span><span class="ident" id="3666582"><a href="/encoding/json/encode.go.html#3666510">v</a></span><span class="op" id="3666583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3666586">if</span>&nbsp;<span class="ident" id="3666589"><a href="/encoding/json/encode.go.html#3666565">err</a></span>&nbsp;<span class="op" id="3666593">!=</span>&nbsp;<span class="ident" id="3666596">nil</span>&nbsp;<span class="op" id="3666600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3666604">return</span>&nbsp;<span class="ident" id="3666611">nil</span><span class="op" id="3666614">,</span>&nbsp;<span class="ident" id="3666616"><a href="/encoding/json/encode.go.html#3666565">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3666621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3666624">return</span>&nbsp;<span class="ident" id="3666631"><a href="/encoding/json/encode.go.html#3666544">e</a></span><span class="op" id="3666632">.</span><span class="ident" id="3666633">Bytes</span><span class="op" id="3666638">(</span><span class="op" id="3666639">)</span><span class="op" id="3666640">,</span>&nbsp;<span class="ident" id="3666642">nil</span><br>
<span class="lineno">140</span><span class="op" id="3666646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3666649">//&nbsp;MarshalIndent&nbsp;is&nbsp;like&nbsp;Marshal&nbsp;but&nbsp;applies&nbsp;Indent&nbsp;to&nbsp;format&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="3666723">func</span>&nbsp;<span class="ident" id="3666728">MarshalIndent</span><span class="op" id="3666741">(</span><span class="ident" id="3666742">v</span>&nbsp;<span class="keyword" id="3666744">interface</span><span class="op" id="3666753">{</span><span class="op" id="3666754">}</span><span class="op" id="3666755">,</span>&nbsp;<span class="ident" id="3666757">prefix</span><span class="op" id="3666763">,</span>&nbsp;<span class="ident" id="3666765">indent</span>&nbsp;<span class="builtintype" id="3666772">string</span><span class="op" id="3666778">)</span>&nbsp;<span class="op" id="3666780">(</span><span class="op" id="3666781">[</span><span class="op" id="3666782">]</span><span class="builtintype" id="3666783">byte</span><span class="op" id="3666787">,</span>&nbsp;<span class="builtintype" id="3666789">error</span><span class="op" id="3666794">)</span>&nbsp;<span class="op" id="3666796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666799">b</span><span class="op" id="3666800">,</span>&nbsp;<span class="ident" id="3666802">err</span>&nbsp;<span class="op" id="3666806">:=</span>&nbsp;<span class="ident" id="3666809"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="3666816">(</span><span class="ident" id="3666817"><a href="/encoding/json/encode.go.html#3666742">v</a></span><span class="op" id="3666818">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3666821">if</span>&nbsp;<span class="ident" id="3666824"><a href="/encoding/json/encode.go.html#3666802">err</a></span>&nbsp;<span class="op" id="3666828">!=</span>&nbsp;<span class="ident" id="3666831">nil</span>&nbsp;<span class="op" id="3666835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3666839">return</span>&nbsp;<span class="ident" id="3666846">nil</span><span class="op" id="3666849">,</span>&nbsp;<span class="ident" id="3666851"><a href="/encoding/json/encode.go.html#3666802">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3666856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3666859">var</span>&nbsp;<span class="ident" id="3666863">buf</span>&nbsp;<span class="ident" id="3666867"><a href="/encoding/json/encode.go.html#3661644">bytes</a></span><span class="op" id="3666872">.</span><span class="ident" id="3666873">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666881"><a href="/encoding/json/encode.go.html#3666802">err</a></span>&nbsp;<span class="op" id="3666885">=</span>&nbsp;<span class="ident" id="3666887"><a href="/encoding/json/indent.go.html#3697432">Indent</a></span><span class="op" id="3666893">(</span><span class="op" id="3666894">&amp;</span><span class="ident" id="3666895"><a href="/encoding/json/encode.go.html#3666863">buf</a></span><span class="op" id="3666898">,</span>&nbsp;<span class="ident" id="3666900"><a href="/encoding/json/encode.go.html#3666799">b</a></span><span class="op" id="3666901">,</span>&nbsp;<span class="ident" id="3666903"><a href="/encoding/json/encode.go.html#3666757">prefix</a></span><span class="op" id="3666909">,</span>&nbsp;<span class="ident" id="3666911"><a href="/encoding/json/encode.go.html#3666765">indent</a></span><span class="op" id="3666917">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3666920">if</span>&nbsp;<span class="ident" id="3666923"><a href="/encoding/json/encode.go.html#3666802">err</a></span>&nbsp;<span class="op" id="3666927">!=</span>&nbsp;<span class="ident" id="3666930">nil</span>&nbsp;<span class="op" id="3666934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3666938">return</span>&nbsp;<span class="ident" id="3666945">nil</span><span class="op" id="3666948">,</span>&nbsp;<span class="ident" id="3666950"><a href="/encoding/json/encode.go.html#3666802">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3666955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3666958">return</span>&nbsp;<span class="ident" id="3666965"><a href="/encoding/json/encode.go.html#3666863">buf</a></span><span class="op" id="3666968">.</span><span class="ident" id="3666969">Bytes</span><span class="op" id="3666974">(</span><span class="op" id="3666975">)</span><span class="op" id="3666976">,</span>&nbsp;<span class="ident" id="3666978">nil</span><br>
<span class="lineno"></span><span class="op" id="3666982">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="3666985">//&nbsp;HTMLEscape&nbsp;appends&nbsp;to&nbsp;dst&nbsp;the&nbsp;JSON-encoded&nbsp;src&nbsp;with&nbsp;&lt;,&nbsp;&gt;,&nbsp;&amp;,&nbsp;U+2028&nbsp;and&nbsp;U+2029</span><br>
<span class="lineno"></span><span class="comment" id="3667067">//&nbsp;characters&nbsp;inside&nbsp;string&nbsp;literals&nbsp;changed&nbsp;to&nbsp;\u003c,&nbsp;\u003e,&nbsp;\u0026,&nbsp;\u2028,&nbsp;\u2029</span><br>
<span class="lineno"></span><span class="comment" id="3667154">//&nbsp;so&nbsp;that&nbsp;the&nbsp;JSON&nbsp;will&nbsp;be&nbsp;safe&nbsp;to&nbsp;embed&nbsp;inside&nbsp;HTML&nbsp;&lt;script&gt;&nbsp;tags.</span><br>
<span class="lineno"></span><span class="comment" id="3667223">//&nbsp;For&nbsp;historical&nbsp;reasons,&nbsp;web&nbsp;browsers&nbsp;don&#39;t&nbsp;honor&nbsp;standard&nbsp;HTML</span><br>
<span class="lineno">160</span><span class="comment" id="3667289">//&nbsp;escaping&nbsp;within&nbsp;&lt;script&gt;&nbsp;tags,&nbsp;so&nbsp;an&nbsp;alternative&nbsp;JSON&nbsp;encoding&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="3667360">//&nbsp;be&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="3667372">func</span>&nbsp;<span class="ident" id="3667377">HTMLEscape</span><span class="op" id="3667387">(</span><span class="ident" id="3667388">dst</span>&nbsp;<span class="op" id="3667392">*</span><span class="ident" id="3667393"><a href="/encoding/json/encode.go.html#3661644">bytes</a></span><span class="op" id="3667398">.</span><span class="ident" id="3667399">Buffer</span><span class="op" id="3667405">,</span>&nbsp;<span class="ident" id="3667407">src</span>&nbsp;<span class="op" id="3667411">[</span><span class="op" id="3667412">]</span><span class="builtintype" id="3667413">byte</span><span class="op" id="3667417">)</span>&nbsp;<span class="op" id="3667419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3667422">//&nbsp;The&nbsp;characters&nbsp;can&nbsp;only&nbsp;appear&nbsp;in&nbsp;string&nbsp;literals,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3667477">//&nbsp;so&nbsp;just&nbsp;scan&nbsp;the&nbsp;string&nbsp;one&nbsp;byte&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667525">start</span>&nbsp;<span class="op" id="3667531">:=</span>&nbsp;<span class="num" id="3667534">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3667537">for</span>&nbsp;<span class="ident" id="3667541">i</span><span class="op" id="3667542">,</span>&nbsp;<span class="ident" id="3667544">c</span>&nbsp;<span class="op" id="3667546">:=</span>&nbsp;<span class="keyword" id="3667549">range</span>&nbsp;<span class="ident" id="3667555"><a href="/encoding/json/encode.go.html#3667407">src</a></span>&nbsp;<span class="op" id="3667559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3667563">if</span>&nbsp;<span class="ident" id="3667566"><a href="/encoding/json/encode.go.html#3667544">c</a></span>&nbsp;<span class="op" id="3667568">==</span>&nbsp;<span class="string" id="3667571">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="3667575">||</span>&nbsp;<span class="ident" id="3667578"><a href="/encoding/json/encode.go.html#3667544">c</a></span>&nbsp;<span class="op" id="3667580">==</span>&nbsp;<span class="string" id="3667583">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="3667587">||</span>&nbsp;<span class="ident" id="3667590"><a href="/encoding/json/encode.go.html#3667544">c</a></span>&nbsp;<span class="op" id="3667592">==</span>&nbsp;<span class="string" id="3667595">&#39;&amp;&#39;</span>&nbsp;<span class="op" id="3667599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3667604">if</span>&nbsp;<span class="ident" id="3667607"><a href="/encoding/json/encode.go.html#3667525">start</a></span>&nbsp;<span class="op" id="3667613">&lt;</span>&nbsp;<span class="ident" id="3667615"><a href="/encoding/json/encode.go.html#3667541">i</a></span>&nbsp;<span class="op" id="3667617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667623"><a href="/encoding/json/encode.go.html#3667388">dst</a></span><span class="op" id="3667626">.</span><span class="ident" id="3667627">Write</span><span class="op" id="3667632">(</span><span class="ident" id="3667633"><a href="/encoding/json/encode.go.html#3667407">src</a></span><span class="op" id="3667636">[</span><span class="ident" id="3667637"><a href="/encoding/json/encode.go.html#3667525">start</a></span><span class="op" id="3667642">:</span><span class="ident" id="3667643"><a href="/encoding/json/encode.go.html#3667541">i</a></span><span class="op" id="3667644">]</span><span class="op" id="3667645">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3667650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667655"><a href="/encoding/json/encode.go.html#3667388">dst</a></span><span class="op" id="3667658">.</span><span class="ident" id="3667659">WriteString</span><span class="op" id="3667670">(</span><span class="string" id="3667671">`\u00`</span><span class="op" id="3667677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667682"><a href="/encoding/json/encode.go.html#3667388">dst</a></span><span class="op" id="3667685">.</span><span class="ident" id="3667686">WriteByte</span><span class="op" id="3667695">(</span><span class="ident" id="3667696"><a href="/encoding/json/encode.go.html#3669482">hex</a></span><span class="op" id="3667699">[</span><span class="ident" id="3667700"><a href="/encoding/json/encode.go.html#3667544">c</a></span><span class="op" id="3667701">&gt;&gt;</span><span class="num" id="3667703">4</span><span class="op" id="3667704">]</span><span class="op" id="3667705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667710"><a href="/encoding/json/encode.go.html#3667388">dst</a></span><span class="op" id="3667713">.</span><span class="ident" id="3667714">WriteByte</span><span class="op" id="3667723">(</span><span class="ident" id="3667724"><a href="/encoding/json/encode.go.html#3669482">hex</a></span><span class="op" id="3667727">[</span><span class="ident" id="3667728"><a href="/encoding/json/encode.go.html#3667544">c</a></span><span class="op" id="3667729">&amp;</span><span class="num" id="3667730">0xF</span><span class="op" id="3667733">]</span><span class="op" id="3667734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667739"><a href="/encoding/json/encode.go.html#3667525">start</a></span>&nbsp;<span class="op" id="3667745">=</span>&nbsp;<span class="ident" id="3667747"><a href="/encoding/json/encode.go.html#3667541">i</a></span>&nbsp;<span class="op" id="3667749">+</span>&nbsp;<span class="num" id="3667751">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3667755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3667759">//&nbsp;Convert&nbsp;U+2028&nbsp;and&nbsp;U+2029&nbsp;(E2&nbsp;80&nbsp;A8&nbsp;and&nbsp;E2&nbsp;80&nbsp;A9).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3667815">if</span>&nbsp;<span class="ident" id="3667818"><a href="/encoding/json/encode.go.html#3667544">c</a></span>&nbsp;<span class="op" id="3667820">==</span>&nbsp;<span class="num" id="3667823">0xE2</span>&nbsp;<span class="op" id="3667828">&amp;&amp;</span>&nbsp;<span class="ident" id="3667831"><a href="/encoding/json/encode.go.html#3667541">i</a></span><span class="op" id="3667832">+</span><span class="num" id="3667833">2</span>&nbsp;<span class="op" id="3667835">&lt;</span>&nbsp;<span class="builtinfunc" id="3667837">len</span><span class="op" id="3667840">(</span><span class="ident" id="3667841"><a href="/encoding/json/encode.go.html#3667407">src</a></span><span class="op" id="3667844">)</span>&nbsp;<span class="op" id="3667846">&amp;&amp;</span>&nbsp;<span class="ident" id="3667849"><a href="/encoding/json/encode.go.html#3667407">src</a></span><span class="op" id="3667852">[</span><span class="ident" id="3667853"><a href="/encoding/json/encode.go.html#3667541">i</a></span><span class="op" id="3667854">+</span><span class="num" id="3667855">1</span><span class="op" id="3667856">]</span>&nbsp;<span class="op" id="3667858">==</span>&nbsp;<span class="num" id="3667861">0x80</span>&nbsp;<span class="op" id="3667866">&amp;&amp;</span>&nbsp;<span class="ident" id="3667869"><a href="/encoding/json/encode.go.html#3667407">src</a></span><span class="op" id="3667872">[</span><span class="ident" id="3667873"><a href="/encoding/json/encode.go.html#3667541">i</a></span><span class="op" id="3667874">+</span><span class="num" id="3667875">2</span><span class="op" id="3667876">]</span><span class="op" id="3667877">&amp;^</span><span class="num" id="3667879">1</span>&nbsp;<span class="op" id="3667881">==</span>&nbsp;<span class="num" id="3667884">0xA8</span>&nbsp;<span class="op" id="3667889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3667894">if</span>&nbsp;<span class="ident" id="3667897"><a href="/encoding/json/encode.go.html#3667525">start</a></span>&nbsp;<span class="op" id="3667903">&lt;</span>&nbsp;<span class="ident" id="3667905"><a href="/encoding/json/encode.go.html#3667541">i</a></span>&nbsp;<span class="op" id="3667907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667913"><a href="/encoding/json/encode.go.html#3667388">dst</a></span><span class="op" id="3667916">.</span><span class="ident" id="3667917">Write</span><span class="op" id="3667922">(</span><span class="ident" id="3667923"><a href="/encoding/json/encode.go.html#3667407">src</a></span><span class="op" id="3667926">[</span><span class="ident" id="3667927"><a href="/encoding/json/encode.go.html#3667525">start</a></span><span class="op" id="3667932">:</span><span class="ident" id="3667933"><a href="/encoding/json/encode.go.html#3667541">i</a></span><span class="op" id="3667934">]</span><span class="op" id="3667935">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3667940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667945"><a href="/encoding/json/encode.go.html#3667388">dst</a></span><span class="op" id="3667948">.</span><span class="ident" id="3667949">WriteString</span><span class="op" id="3667960">(</span><span class="string" id="3667961">`\u202`</span><span class="op" id="3667968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667973"><a href="/encoding/json/encode.go.html#3667388">dst</a></span><span class="op" id="3667976">.</span><span class="ident" id="3667977">WriteByte</span><span class="op" id="3667986">(</span><span class="ident" id="3667987"><a href="/encoding/json/encode.go.html#3669482">hex</a></span><span class="op" id="3667990">[</span><span class="ident" id="3667991"><a href="/encoding/json/encode.go.html#3667407">src</a></span><span class="op" id="3667994">[</span><span class="ident" id="3667995"><a href="/encoding/json/encode.go.html#3667541">i</a></span><span class="op" id="3667996">+</span><span class="num" id="3667997">2</span><span class="op" id="3667998">]</span><span class="op" id="3667999">&amp;</span><span class="num" id="3668000">0xF</span><span class="op" id="3668003">]</span><span class="op" id="3668004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668009"><a href="/encoding/json/encode.go.html#3667525">start</a></span>&nbsp;<span class="op" id="3668015">=</span>&nbsp;<span class="ident" id="3668017"><a href="/encoding/json/encode.go.html#3667541">i</a></span>&nbsp;<span class="op" id="3668019">+</span>&nbsp;<span class="num" id="3668021">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3668025">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3668028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668031">if</span>&nbsp;<span class="ident" id="3668034"><a href="/encoding/json/encode.go.html#3667525">start</a></span>&nbsp;<span class="op" id="3668040">&lt;</span>&nbsp;<span class="builtinfunc" id="3668042">len</span><span class="op" id="3668045">(</span><span class="ident" id="3668046"><a href="/encoding/json/encode.go.html#3667407">src</a></span><span class="op" id="3668049">)</span>&nbsp;<span class="op" id="3668051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668055"><a href="/encoding/json/encode.go.html#3667388">dst</a></span><span class="op" id="3668058">.</span><span class="ident" id="3668059">Write</span><span class="op" id="3668064">(</span><span class="ident" id="3668065"><a href="/encoding/json/encode.go.html#3667407">src</a></span><span class="op" id="3668068">[</span><span class="ident" id="3668069"><a href="/encoding/json/encode.go.html#3667525">start</a></span><span class="op" id="3668074">:</span><span class="op" id="3668075">]</span><span class="op" id="3668076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3668079">}</span><br>
<span class="lineno"></span><span class="op" id="3668081">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3668084">//&nbsp;Marshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3668142">//&nbsp;can&nbsp;marshal&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="keyword" id="3668185">type</span>&nbsp;<span class="ident" id="3668190">Marshaler</span>&nbsp;<span class="keyword" id="3668200">interface</span>&nbsp;<span class="op" id="3668210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668213">MarshalJSON</span><span class="op" id="3668224">(</span><span class="op" id="3668225">)</span>&nbsp;<span class="op" id="3668227">(</span><span class="op" id="3668228">[</span><span class="op" id="3668229">]</span><span class="builtintype" id="3668230">byte</span><span class="op" id="3668234">,</span>&nbsp;<span class="builtintype" id="3668236">error</span><span class="op" id="3668241">)</span><br>
<span class="lineno">195</span><span class="op" id="3668243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3668246">//&nbsp;An&nbsp;UnsupportedTypeError&nbsp;is&nbsp;returned&nbsp;by&nbsp;Marshal&nbsp;when&nbsp;attempting</span><br>
<span class="lineno"></span><span class="comment" id="3668312">//&nbsp;to&nbsp;encode&nbsp;an&nbsp;unsupported&nbsp;value&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3668352">type</span>&nbsp;<span class="ident" id="3668357">UnsupportedTypeError</span>&nbsp;<span class="keyword" id="3668378">struct</span>&nbsp;<span class="op" id="3668385">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668388">Type</span>&nbsp;<span class="ident" id="3668393"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3668400">.</span><span class="ident" id="3668401">Type</span><br>
<span class="lineno"></span><span class="op" id="3668406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3668409">func</span>&nbsp;<span class="op" id="3668414">(</span><span class="ident" id="3668415">e</span>&nbsp;<span class="op" id="3668417">*</span><span class="ident" id="3668418"><a href="/encoding/json/encode.go.html#3668357">UnsupportedTypeError</a></span><span class="op" id="3668438">)</span>&nbsp;<span class="ident" id="3668440">Error</span><span class="op" id="3668445">(</span><span class="op" id="3668446">)</span>&nbsp;<span class="builtintype" id="3668448">string</span>&nbsp;<span class="op" id="3668455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668458">return</span>&nbsp;<span class="string" id="3668465">&#34;json:&nbsp;unsupported&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="3668492">+</span>&nbsp;<span class="ident" id="3668494"><a href="/encoding/json/encode.go.html#3668415">e</a></span><span class="op" id="3668495">.</span><span class="ident" id="3668496">Type</span><span class="op" id="3668500">.</span><span class="ident" id="3668501">String</span><span class="op" id="3668507">(</span><span class="op" id="3668508">)</span><br>
<span class="lineno">205</span><span class="op" id="3668510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3668513">type</span>&nbsp;<span class="ident" id="3668518">UnsupportedValueError</span>&nbsp;<span class="keyword" id="3668540">struct</span>&nbsp;<span class="op" id="3668547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668550">Value</span>&nbsp;<span class="ident" id="3668556"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3668563">.</span><span class="ident" id="3668564">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668571">Str</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3668577">string</span><br>
<span class="lineno">210</span><span class="op" id="3668584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3668587">func</span>&nbsp;<span class="op" id="3668592">(</span><span class="ident" id="3668593">e</span>&nbsp;<span class="op" id="3668595">*</span><span class="ident" id="3668596"><a href="/encoding/json/encode.go.html#3668518">UnsupportedValueError</a></span><span class="op" id="3668617">)</span>&nbsp;<span class="ident" id="3668619">Error</span><span class="op" id="3668624">(</span><span class="op" id="3668625">)</span>&nbsp;<span class="builtintype" id="3668627">string</span>&nbsp;<span class="op" id="3668634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668637">return</span>&nbsp;<span class="string" id="3668644">&#34;json:&nbsp;unsupported&nbsp;value:&nbsp;&#34;</span>&nbsp;<span class="op" id="3668672">+</span>&nbsp;<span class="ident" id="3668674"><a href="/encoding/json/encode.go.html#3668593">e</a></span><span class="op" id="3668675">.</span><span class="ident" id="3668676">Str</span><br>
<span class="lineno"></span><span class="op" id="3668680">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="comment" id="3668683">//&nbsp;Before&nbsp;Go&nbsp;1.2,&nbsp;an&nbsp;InvalidUTF8Error&nbsp;was&nbsp;returned&nbsp;by&nbsp;Marshal&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="3668750">//&nbsp;attempting&nbsp;to&nbsp;encode&nbsp;a&nbsp;string&nbsp;value&nbsp;with&nbsp;invalid&nbsp;UTF-8&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="comment" id="3668819">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.2,&nbsp;Marshal&nbsp;instead&nbsp;coerces&nbsp;the&nbsp;string&nbsp;to&nbsp;valid&nbsp;UTF-8&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3668889">//&nbsp;replacing&nbsp;invalid&nbsp;bytes&nbsp;with&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;rune&nbsp;U+FFFD.</span><br>
<span class="lineno">220</span><span class="comment" id="3668958">//&nbsp;This&nbsp;error&nbsp;is&nbsp;no&nbsp;longer&nbsp;generated&nbsp;but&nbsp;is&nbsp;kept&nbsp;for&nbsp;backwards&nbsp;compatibility</span><br>
<span class="lineno"></span><span class="comment" id="3669035">//&nbsp;with&nbsp;programs&nbsp;that&nbsp;might&nbsp;mention&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3669075">type</span>&nbsp;<span class="ident" id="3669080">InvalidUTF8Error</span>&nbsp;<span class="keyword" id="3669097">struct</span>&nbsp;<span class="op" id="3669104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669107">S</span>&nbsp;<span class="builtintype" id="3669109">string</span>&nbsp;<span class="comment" id="3669116">//&nbsp;the&nbsp;whole&nbsp;string&nbsp;value&nbsp;that&nbsp;caused&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="op" id="3669164">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="keyword" id="3669167">func</span>&nbsp;<span class="op" id="3669172">(</span><span class="ident" id="3669173">e</span>&nbsp;<span class="op" id="3669175">*</span><span class="ident" id="3669176"><a href="/encoding/json/encode.go.html#3669080">InvalidUTF8Error</a></span><span class="op" id="3669192">)</span>&nbsp;<span class="ident" id="3669194">Error</span><span class="op" id="3669199">(</span><span class="op" id="3669200">)</span>&nbsp;<span class="builtintype" id="3669202">string</span>&nbsp;<span class="op" id="3669209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669212">return</span>&nbsp;<span class="string" id="3669219">&#34;json:&nbsp;invalid&nbsp;UTF-8&nbsp;in&nbsp;string:&nbsp;&#34;</span>&nbsp;<span class="op" id="3669253">+</span>&nbsp;<span class="ident" id="3669255"><a href="/encoding/json/encode.go.html#3661722">strconv</a></span><span class="op" id="3669262">.</span><span class="ident" id="3669263">Quote</span><span class="op" id="3669268">(</span><span class="ident" id="3669269"><a href="/encoding/json/encode.go.html#3669173">e</a></span><span class="op" id="3669270">.</span><span class="ident" id="3669271">S</span><span class="op" id="3669272">)</span><br>
<span class="lineno"></span><span class="op" id="3669274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="3669277">type</span>&nbsp;<span class="ident" id="3669282">MarshalerError</span>&nbsp;<span class="keyword" id="3669297">struct</span>&nbsp;<span class="op" id="3669304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669307">Type</span>&nbsp;<span class="ident" id="3669312"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3669319">.</span><span class="ident" id="3669320">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669326">Err</span>&nbsp;&nbsp;<span class="builtintype" id="3669331">error</span><br>
<span class="lineno"></span><span class="op" id="3669337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="3669340">func</span>&nbsp;<span class="op" id="3669345">(</span><span class="ident" id="3669346">e</span>&nbsp;<span class="op" id="3669348">*</span><span class="ident" id="3669349"><a href="/encoding/json/encode.go.html#3669282">MarshalerError</a></span><span class="op" id="3669363">)</span>&nbsp;<span class="ident" id="3669365">Error</span><span class="op" id="3669370">(</span><span class="op" id="3669371">)</span>&nbsp;<span class="builtintype" id="3669373">string</span>&nbsp;<span class="op" id="3669380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669383">return</span>&nbsp;<span class="string" id="3669390">&#34;json:&nbsp;error&nbsp;calling&nbsp;MarshalJSON&nbsp;for&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="3669434">+</span>&nbsp;<span class="ident" id="3669436"><a href="/encoding/json/encode.go.html#3669346">e</a></span><span class="op" id="3669437">.</span><span class="ident" id="3669438">Type</span><span class="op" id="3669442">.</span><span class="ident" id="3669443">String</span><span class="op" id="3669449">(</span><span class="op" id="3669450">)</span>&nbsp;<span class="op" id="3669452">+</span>&nbsp;<span class="string" id="3669454">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3669459">+</span>&nbsp;<span class="ident" id="3669461"><a href="/encoding/json/encode.go.html#3669346">e</a></span><span class="op" id="3669462">.</span><span class="ident" id="3669463">Err</span><span class="op" id="3669466">.</span><span class="ident" id="3669467">Error</span><span class="op" id="3669472">(</span><span class="op" id="3669473">)</span><br>
<span class="lineno"></span><span class="op" id="3669475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3669478">var</span>&nbsp;<span class="ident" id="3669482">hex</span>&nbsp;<span class="op" id="3669486">=</span>&nbsp;<span class="string" id="3669488">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="comment" id="3669508">//&nbsp;An&nbsp;encodeState&nbsp;encodes&nbsp;JSON&nbsp;into&nbsp;a&nbsp;bytes.Buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="3669560">type</span>&nbsp;<span class="ident" id="3669565">encodeState</span>&nbsp;<span class="keyword" id="3669577">struct</span>&nbsp;<span class="op" id="3669584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669587"><a href="/encoding/json/encode.go.html#3661644">bytes</a></span><span class="op" id="3669592">.</span><span class="ident" id="3669593">Buffer</span>&nbsp;<span class="comment" id="3669600">//&nbsp;accumulated&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669623">scratch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3669636">[</span><span class="num" id="3669637">64</span><span class="op" id="3669639">]</span><span class="builtintype" id="3669640">byte</span><br>
<span class="lineno">245</span><span class="op" id="3669645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3669648">var</span>&nbsp;<span class="ident" id="3669652">encodeStatePool</span>&nbsp;<span class="ident" id="3669668"><a href="/encoding/json/encode.go.html#3661744">sync</a></span><span class="op" id="3669672">.</span><span class="ident" id="3669673">Pool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3669679">func</span>&nbsp;<span class="ident" id="3669684">newEncodeState</span><span class="op" id="3669698">(</span><span class="op" id="3669699">)</span>&nbsp;<span class="op" id="3669701">*</span><span class="ident" id="3669702"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span>&nbsp;<span class="op" id="3669714">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669717">if</span>&nbsp;<span class="ident" id="3669720">v</span>&nbsp;<span class="op" id="3669722">:=</span>&nbsp;<span class="ident" id="3669725"><a href="/encoding/json/encode.go.html#3669652">encodeStatePool</a></span><span class="op" id="3669740">.</span><span class="ident" id="3669741">Get</span><span class="op" id="3669744">(</span><span class="op" id="3669745">)</span><span class="op" id="3669746">;</span>&nbsp;<span class="ident" id="3669748"><a href="/encoding/json/encode.go.html#3669720">v</a></span>&nbsp;<span class="op" id="3669750">!=</span>&nbsp;<span class="ident" id="3669753">nil</span>&nbsp;<span class="op" id="3669757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669761">e</span>&nbsp;<span class="op" id="3669763">:=</span>&nbsp;<span class="ident" id="3669766"><a href="/encoding/json/encode.go.html#3669720">v</a></span><span class="op" id="3669767">.</span><span class="op" id="3669768">(</span><span class="op" id="3669769">*</span><span class="ident" id="3669770"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3669781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669785"><a href="/encoding/json/encode.go.html#3669761">e</a></span><span class="op" id="3669786">.</span><span class="ident" id="3669787">Reset</span><span class="op" id="3669792">(</span><span class="op" id="3669793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669797">return</span>&nbsp;<span class="ident" id="3669804"><a href="/encoding/json/encode.go.html#3669761">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3669807">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669810">return</span>&nbsp;<span class="builtinfunc" id="3669817">new</span><span class="op" id="3669820">(</span><span class="ident" id="3669821"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3669832">)</span><br>
<span class="lineno"></span><span class="op" id="3669834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3669837">func</span>&nbsp;<span class="op" id="3669842">(</span><span class="ident" id="3669843">e</span>&nbsp;<span class="op" id="3669845">*</span><span class="ident" id="3669846"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3669857">)</span>&nbsp;<span class="ident" id="3669859">marshal</span><span class="op" id="3669866">(</span><span class="ident" id="3669867">v</span>&nbsp;<span class="keyword" id="3669869">interface</span><span class="op" id="3669878">{</span><span class="op" id="3669879">}</span><span class="op" id="3669880">)</span>&nbsp;<span class="op" id="3669882">(</span><span class="ident" id="3669883">err</span>&nbsp;<span class="builtintype" id="3669887">error</span><span class="op" id="3669892">)</span>&nbsp;<span class="op" id="3669894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669897">defer</span>&nbsp;<span class="keyword" id="3669903">func</span><span class="op" id="3669907">(</span><span class="op" id="3669908">)</span>&nbsp;<span class="op" id="3669910">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669914">if</span>&nbsp;<span class="ident" id="3669917">r</span>&nbsp;<span class="op" id="3669919">:=</span>&nbsp;<span class="builtinfunc" id="3669922">recover</span><span class="op" id="3669929">(</span><span class="op" id="3669930">)</span><span class="op" id="3669931">;</span>&nbsp;<span class="ident" id="3669933"><a href="/encoding/json/encode.go.html#3669917">r</a></span>&nbsp;<span class="op" id="3669935">!=</span>&nbsp;<span class="ident" id="3669938">nil</span>&nbsp;<span class="op" id="3669942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669947">if</span>&nbsp;<span class="ident" id="3669950">_</span><span class="op" id="3669951">,</span>&nbsp;<span class="ident" id="3669953">ok</span>&nbsp;<span class="op" id="3669956">:=</span>&nbsp;<span class="ident" id="3669959"><a href="/encoding/json/encode.go.html#3669917">r</a></span><span class="op" id="3669960">.</span><span class="op" id="3669961">(</span><span class="ident" id="3669962"><a href="/encoding/json/encode.go.html#3661703">runtime</a></span><span class="op" id="3669969">.</span><span class="ident" id="3669970">Error</span><span class="op" id="3669975">)</span><span class="op" id="3669976">;</span>&nbsp;<span class="ident" id="3669978"><a href="/encoding/json/encode.go.html#3669953">ok</a></span>&nbsp;<span class="op" id="3669981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3669987">panic</span><span class="op" id="3669992">(</span><span class="ident" id="3669993"><a href="/encoding/json/encode.go.html#3669917">r</a></span><span class="op" id="3669994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3669999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670004">if</span>&nbsp;<span class="ident" id="3670007">s</span><span class="op" id="3670008">,</span>&nbsp;<span class="ident" id="3670010">ok</span>&nbsp;<span class="op" id="3670013">:=</span>&nbsp;<span class="ident" id="3670016"><a href="/encoding/json/encode.go.html#3669917">r</a></span><span class="op" id="3670017">.</span><span class="op" id="3670018">(</span><span class="builtintype" id="3670019">string</span><span class="op" id="3670025">)</span><span class="op" id="3670026">;</span>&nbsp;<span class="ident" id="3670028"><a href="/encoding/json/encode.go.html#3670010">ok</a></span>&nbsp;<span class="op" id="3670031">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3670037">panic</span><span class="op" id="3670042">(</span><span class="ident" id="3670043"><a href="/encoding/json/encode.go.html#3670007">s</a></span><span class="op" id="3670044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3670049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670054"><a href="/encoding/json/encode.go.html#3669883">err</a></span>&nbsp;<span class="op" id="3670058">=</span>&nbsp;<span class="ident" id="3670060"><a href="/encoding/json/encode.go.html#3669917">r</a></span><span class="op" id="3670061">.</span><span class="op" id="3670062">(</span><span class="builtintype" id="3670063">error</span><span class="op" id="3670068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3670072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3670075">}</span><span class="op" id="3670076">(</span><span class="op" id="3670077">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670080"><a href="/encoding/json/encode.go.html#3669843">e</a></span><span class="op" id="3670081">.</span><span class="ident" id="3670082">reflectValue</span><span class="op" id="3670094">(</span><span class="ident" id="3670095"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670102">.</span><span class="ident" id="3670103">ValueOf</span><span class="op" id="3670110">(</span><span class="ident" id="3670111"><a href="/encoding/json/encode.go.html#3669867">v</a></span><span class="op" id="3670112">)</span><span class="op" id="3670113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670116">return</span>&nbsp;<span class="ident" id="3670123">nil</span><br>
<span class="lineno"></span><span class="op" id="3670127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3670130">func</span>&nbsp;<span class="op" id="3670135">(</span><span class="ident" id="3670136">e</span>&nbsp;<span class="op" id="3670138">*</span><span class="ident" id="3670139"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3670150">)</span>&nbsp;<span class="builtintype" id="3670152">error</span><span class="op" id="3670157">(</span><span class="ident" id="3670158">err</span>&nbsp;<span class="builtintype" id="3670162">error</span><span class="op" id="3670167">)</span>&nbsp;<span class="op" id="3670169">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3670172">panic</span><span class="op" id="3670177">(</span><span class="ident" id="3670178"><a href="/encoding/json/encode.go.html#3670158">err</a></span><span class="op" id="3670181">)</span><br>
<span class="lineno"></span><span class="op" id="3670183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3670186">var</span>&nbsp;<span class="ident" id="3670190">byteSliceType</span>&nbsp;<span class="op" id="3670204">=</span>&nbsp;<span class="ident" id="3670206"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670213">.</span><span class="ident" id="3670214">TypeOf</span><span class="op" id="3670220">(</span><span class="op" id="3670221">[</span><span class="op" id="3670222">]</span><span class="builtintype" id="3670223">byte</span><span class="op" id="3670227">(</span><span class="ident" id="3670228">nil</span><span class="op" id="3670231">)</span><span class="op" id="3670232">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3670235">func</span>&nbsp;<span class="ident" id="3670240">isEmptyValue</span><span class="op" id="3670252">(</span><span class="ident" id="3670253">v</span>&nbsp;<span class="ident" id="3670255"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670262">.</span><span class="ident" id="3670263">Value</span><span class="op" id="3670268">)</span>&nbsp;<span class="builtintype" id="3670270">bool</span>&nbsp;<span class="op" id="3670275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670278">switch</span>&nbsp;<span class="ident" id="3670285"><a href="/encoding/json/encode.go.html#3670253">v</a></span><span class="op" id="3670286">.</span><span class="ident" id="3670287">Kind</span><span class="op" id="3670291">(</span><span class="op" id="3670292">)</span>&nbsp;<span class="op" id="3670294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670297">case</span>&nbsp;<span class="ident" id="3670302"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670309">.</span><span class="ident" id="3670310">Array</span><span class="op" id="3670315">,</span>&nbsp;<span class="ident" id="3670317"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670324">.</span><span class="ident" id="3670325">Map</span><span class="op" id="3670328">,</span>&nbsp;<span class="ident" id="3670330"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670337">.</span><span class="ident" id="3670338">Slice</span><span class="op" id="3670343">,</span>&nbsp;<span class="ident" id="3670345"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670352">.</span><span class="ident" id="3670353">String</span><span class="op" id="3670359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670363">return</span>&nbsp;<span class="ident" id="3670370"><a href="/encoding/json/encode.go.html#3670253">v</a></span><span class="op" id="3670371">.</span><span class="ident" id="3670372">Len</span><span class="op" id="3670375">(</span><span class="op" id="3670376">)</span>&nbsp;<span class="op" id="3670378">==</span>&nbsp;<span class="num" id="3670381">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670384">case</span>&nbsp;<span class="ident" id="3670389"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670396">.</span><span class="ident" id="3670397">Bool</span><span class="op" id="3670401">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670405">return</span>&nbsp;<span class="op" id="3670412">!</span><span class="ident" id="3670413"><a href="/encoding/json/encode.go.html#3670253">v</a></span><span class="op" id="3670414">.</span><span class="ident" id="3670415">Bool</span><span class="op" id="3670419">(</span><span class="op" id="3670420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670423">case</span>&nbsp;<span class="ident" id="3670428"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670435">.</span><span class="ident" id="3670436">Int</span><span class="op" id="3670439">,</span>&nbsp;<span class="ident" id="3670441"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670448">.</span><span class="ident" id="3670449">Int8</span><span class="op" id="3670453">,</span>&nbsp;<span class="ident" id="3670455"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670462">.</span><span class="ident" id="3670463">Int16</span><span class="op" id="3670468">,</span>&nbsp;<span class="ident" id="3670470"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670477">.</span><span class="ident" id="3670478">Int32</span><span class="op" id="3670483">,</span>&nbsp;<span class="ident" id="3670485"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670492">.</span><span class="ident" id="3670493">Int64</span><span class="op" id="3670498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670502">return</span>&nbsp;<span class="ident" id="3670509"><a href="/encoding/json/encode.go.html#3670253">v</a></span><span class="op" id="3670510">.</span><span class="ident" id="3670511">Int</span><span class="op" id="3670514">(</span><span class="op" id="3670515">)</span>&nbsp;<span class="op" id="3670517">==</span>&nbsp;<span class="num" id="3670520">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670523">case</span>&nbsp;<span class="ident" id="3670528"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670535">.</span><span class="ident" id="3670536">Uint</span><span class="op" id="3670540">,</span>&nbsp;<span class="ident" id="3670542"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670549">.</span><span class="ident" id="3670550">Uint8</span><span class="op" id="3670555">,</span>&nbsp;<span class="ident" id="3670557"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670564">.</span><span class="ident" id="3670565">Uint16</span><span class="op" id="3670571">,</span>&nbsp;<span class="ident" id="3670573"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670580">.</span><span class="ident" id="3670581">Uint32</span><span class="op" id="3670587">,</span>&nbsp;<span class="ident" id="3670589"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670596">.</span><span class="ident" id="3670597">Uint64</span><span class="op" id="3670603">,</span>&nbsp;<span class="ident" id="3670605"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670612">.</span><span class="ident" id="3670613">Uintptr</span><span class="op" id="3670620">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670624">return</span>&nbsp;<span class="ident" id="3670631"><a href="/encoding/json/encode.go.html#3670253">v</a></span><span class="op" id="3670632">.</span><span class="ident" id="3670633">Uint</span><span class="op" id="3670637">(</span><span class="op" id="3670638">)</span>&nbsp;<span class="op" id="3670640">==</span>&nbsp;<span class="num" id="3670643">0</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670646">case</span>&nbsp;<span class="ident" id="3670651"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670658">.</span><span class="ident" id="3670659">Float32</span><span class="op" id="3670666">,</span>&nbsp;<span class="ident" id="3670668"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670675">.</span><span class="ident" id="3670676">Float64</span><span class="op" id="3670683">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670687">return</span>&nbsp;<span class="ident" id="3670694"><a href="/encoding/json/encode.go.html#3670253">v</a></span><span class="op" id="3670695">.</span><span class="ident" id="3670696">Float</span><span class="op" id="3670701">(</span><span class="op" id="3670702">)</span>&nbsp;<span class="op" id="3670704">==</span>&nbsp;<span class="num" id="3670707">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670710">case</span>&nbsp;<span class="ident" id="3670715"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670722">.</span><span class="ident" id="3670723">Interface</span><span class="op" id="3670732">,</span>&nbsp;<span class="ident" id="3670734"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670741">.</span><span class="ident" id="3670742">Ptr</span><span class="op" id="3670745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670749">return</span>&nbsp;<span class="ident" id="3670756"><a href="/encoding/json/encode.go.html#3670253">v</a></span><span class="op" id="3670757">.</span><span class="ident" id="3670758">IsNil</span><span class="op" id="3670763">(</span><span class="op" id="3670764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3670767">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3670770">return</span>&nbsp;<span class="ident" id="3670777">false</span><br>
<span class="lineno"></span><span class="op" id="3670783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3670786">func</span>&nbsp;<span class="op" id="3670791">(</span><span class="ident" id="3670792">e</span>&nbsp;<span class="op" id="3670794">*</span><span class="ident" id="3670795"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3670806">)</span>&nbsp;<span class="ident" id="3670808">reflectValue</span><span class="op" id="3670820">(</span><span class="ident" id="3670821">v</span>&nbsp;<span class="ident" id="3670823"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670830">.</span><span class="ident" id="3670831">Value</span><span class="op" id="3670836">)</span>&nbsp;<span class="op" id="3670838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670841"><a href="/encoding/json/encode.go.html#3671022">valueEncoder</a></span><span class="op" id="3670853">(</span><span class="ident" id="3670854"><a href="/encoding/json/encode.go.html#3670821">v</a></span><span class="op" id="3670855">)</span><span class="op" id="3670856">(</span><span class="ident" id="3670857"><a href="/encoding/json/encode.go.html#3670792">e</a></span><span class="op" id="3670858">,</span>&nbsp;<span class="ident" id="3670860"><a href="/encoding/json/encode.go.html#3670821">v</a></span><span class="op" id="3670861">,</span>&nbsp;<span class="ident" id="3670863">false</span><span class="op" id="3670868">)</span><br>
<span class="lineno">300</span><span class="op" id="3670870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3670873">type</span>&nbsp;<span class="ident" id="3670878">encoderFunc</span>&nbsp;<span class="keyword" id="3670890">func</span><span class="op" id="3670894">(</span><span class="ident" id="3670895">e</span>&nbsp;<span class="op" id="3670897">*</span><span class="ident" id="3670898"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3670909">,</span>&nbsp;<span class="ident" id="3670911">v</span>&nbsp;<span class="ident" id="3670913"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670920">.</span><span class="ident" id="3670921">Value</span><span class="op" id="3670926">,</span>&nbsp;<span class="ident" id="3670928">quoted</span>&nbsp;<span class="builtintype" id="3670935">bool</span><span class="op" id="3670939">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3670942">var</span>&nbsp;<span class="ident" id="3670946">encoderCache</span>&nbsp;<span class="keyword" id="3670959">struct</span>&nbsp;<span class="op" id="3670966">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670969"><a href="/encoding/json/encode.go.html#3661744">sync</a></span><span class="op" id="3670973">.</span><span class="ident" id="3670974">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3670983">m</span>&nbsp;<span class="keyword" id="3670985">map</span><span class="op" id="3670988">[</span><span class="ident" id="3670989"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3670996">.</span><span class="ident" id="3670997">Type</span><span class="op" id="3671001">]</span><span class="ident" id="3671002"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="3671014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3671017">func</span>&nbsp;<span class="ident" id="3671022">valueEncoder</span><span class="op" id="3671034">(</span><span class="ident" id="3671035">v</span>&nbsp;<span class="ident" id="3671037"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3671044">.</span><span class="ident" id="3671045">Value</span><span class="op" id="3671050">)</span>&nbsp;<span class="ident" id="3671052"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span>&nbsp;<span class="op" id="3671064">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671067">if</span>&nbsp;<span class="op" id="3671070">!</span><span class="ident" id="3671071"><a href="/encoding/json/encode.go.html#3671035">v</a></span><span class="op" id="3671072">.</span><span class="ident" id="3671073">IsValid</span><span class="op" id="3671080">(</span><span class="op" id="3671081">)</span>&nbsp;<span class="op" id="3671083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671087">return</span>&nbsp;<span class="ident" id="3671094"><a href="/encoding/json/encode.go.html#3673604">invalidValueEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671118">return</span>&nbsp;<span class="ident" id="3671125"><a href="/encoding/json/encode.go.html#3671155">typeEncoder</a></span><span class="op" id="3671136">(</span><span class="ident" id="3671137"><a href="/encoding/json/encode.go.html#3671035">v</a></span><span class="op" id="3671138">.</span><span class="ident" id="3671139">Type</span><span class="op" id="3671143">(</span><span class="op" id="3671144">)</span><span class="op" id="3671145">)</span><br>
<span class="lineno"></span><span class="op" id="3671147">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="3671150">func</span>&nbsp;<span class="ident" id="3671155">typeEncoder</span><span class="op" id="3671166">(</span><span class="ident" id="3671167">t</span>&nbsp;<span class="ident" id="3671169"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3671176">.</span><span class="ident" id="3671177">Type</span><span class="op" id="3671181">)</span>&nbsp;<span class="ident" id="3671183"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span>&nbsp;<span class="op" id="3671195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671198"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671210">.</span><span class="ident" id="3671211">RLock</span><span class="op" id="3671216">(</span><span class="op" id="3671217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671220">f</span>&nbsp;<span class="op" id="3671222">:=</span>&nbsp;<span class="ident" id="3671225"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671237">.</span><span class="ident" id="3671238">m</span><span class="op" id="3671239">[</span><span class="ident" id="3671240"><a href="/encoding/json/encode.go.html#3671167">t</a></span><span class="op" id="3671241">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671244"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671256">.</span><span class="ident" id="3671257">RUnlock</span><span class="op" id="3671264">(</span><span class="op" id="3671265">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671268">if</span>&nbsp;<span class="ident" id="3671271"><a href="/encoding/json/encode.go.html#3671220">f</a></span>&nbsp;<span class="op" id="3671273">!=</span>&nbsp;<span class="ident" id="3671276">nil</span>&nbsp;<span class="op" id="3671280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671284">return</span>&nbsp;<span class="ident" id="3671291"><a href="/encoding/json/encode.go.html#3671220">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3671298">//&nbsp;To&nbsp;deal&nbsp;with&nbsp;recursive&nbsp;types,&nbsp;populate&nbsp;the&nbsp;map&nbsp;with&nbsp;an</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3671357">//&nbsp;indirect&nbsp;func&nbsp;before&nbsp;we&nbsp;build&nbsp;it.&nbsp;This&nbsp;type&nbsp;waits&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3671418">//&nbsp;real&nbsp;func&nbsp;(f)&nbsp;to&nbsp;be&nbsp;ready&nbsp;and&nbsp;then&nbsp;calls&nbsp;it.&nbsp;&nbsp;This&nbsp;indirect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3671482">//&nbsp;func&nbsp;is&nbsp;only&nbsp;used&nbsp;for&nbsp;recursive&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671525"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671537">.</span><span class="ident" id="3671538">Lock</span><span class="op" id="3671542">(</span><span class="op" id="3671543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671546">if</span>&nbsp;<span class="ident" id="3671549"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671561">.</span><span class="ident" id="3671562">m</span>&nbsp;<span class="op" id="3671564">==</span>&nbsp;<span class="ident" id="3671567">nil</span>&nbsp;<span class="op" id="3671571">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671575"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671587">.</span><span class="ident" id="3671588">m</span>&nbsp;<span class="op" id="3671590">=</span>&nbsp;<span class="builtinfunc" id="3671592">make</span><span class="op" id="3671596">(</span><span class="keyword" id="3671597">map</span><span class="op" id="3671600">[</span><span class="ident" id="3671601"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3671608">.</span><span class="ident" id="3671609">Type</span><span class="op" id="3671613">]</span><span class="ident" id="3671614"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span><span class="op" id="3671625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671631">var</span>&nbsp;<span class="ident" id="3671635">wg</span>&nbsp;<span class="ident" id="3671638"><a href="/encoding/json/encode.go.html#3661744">sync</a></span><span class="op" id="3671642">.</span><span class="ident" id="3671643">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671654"><a href="/encoding/json/encode.go.html#3671635">wg</a></span><span class="op" id="3671656">.</span><span class="ident" id="3671657">Add</span><span class="op" id="3671660">(</span><span class="num" id="3671661">1</span><span class="op" id="3671662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671665"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671677">.</span><span class="ident" id="3671678">m</span><span class="op" id="3671679">[</span><span class="ident" id="3671680"><a href="/encoding/json/encode.go.html#3671167">t</a></span><span class="op" id="3671681">]</span>&nbsp;<span class="op" id="3671683">=</span>&nbsp;<span class="keyword" id="3671685">func</span><span class="op" id="3671689">(</span><span class="ident" id="3671690">e</span>&nbsp;<span class="op" id="3671692">*</span><span class="ident" id="3671693"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3671704">,</span>&nbsp;<span class="ident" id="3671706">v</span>&nbsp;<span class="ident" id="3671708"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3671715">.</span><span class="ident" id="3671716">Value</span><span class="op" id="3671721">,</span>&nbsp;<span class="ident" id="3671723">quoted</span>&nbsp;<span class="builtintype" id="3671730">bool</span><span class="op" id="3671734">)</span>&nbsp;<span class="op" id="3671736">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671740"><a href="/encoding/json/encode.go.html#3671635">wg</a></span><span class="op" id="3671742">.</span><span class="ident" id="3671743">Wait</span><span class="op" id="3671747">(</span><span class="op" id="3671748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671752"><a href="/encoding/json/encode.go.html#3671220">f</a></span><span class="op" id="3671753">(</span><span class="ident" id="3671754"><a href="/encoding/json/encode.go.html#3671690">e</a></span><span class="op" id="3671755">,</span>&nbsp;<span class="ident" id="3671757"><a href="/encoding/json/encode.go.html#3671706">v</a></span><span class="op" id="3671758">,</span>&nbsp;<span class="ident" id="3671760"><a href="/encoding/json/encode.go.html#3671723">quoted</a></span><span class="op" id="3671766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3671769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671772"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671784">.</span><span class="ident" id="3671785">Unlock</span><span class="op" id="3671791">(</span><span class="op" id="3671792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3671796">//&nbsp;Compute&nbsp;fields&nbsp;without&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3671829">//&nbsp;Might&nbsp;duplicate&nbsp;effort&nbsp;but&nbsp;won&#39;t&nbsp;hold&nbsp;other&nbsp;computations&nbsp;back.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671896"><a href="/encoding/json/encode.go.html#3671220">f</a></span>&nbsp;<span class="op" id="3671898">=</span>&nbsp;<span class="ident" id="3671900"><a href="/encoding/json/encode.go.html#3672284">newTypeEncoder</a></span><span class="op" id="3671914">(</span><span class="ident" id="3671915"><a href="/encoding/json/encode.go.html#3671167">t</a></span><span class="op" id="3671916">,</span>&nbsp;<span class="ident" id="3671918">true</span><span class="op" id="3671922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671925"><a href="/encoding/json/encode.go.html#3671635">wg</a></span><span class="op" id="3671927">.</span><span class="ident" id="3671928">Done</span><span class="op" id="3671932">(</span><span class="op" id="3671933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671936"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671948">.</span><span class="ident" id="3671949">Lock</span><span class="op" id="3671953">(</span><span class="op" id="3671954">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671957"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671969">.</span><span class="ident" id="3671970">m</span><span class="op" id="3671971">[</span><span class="ident" id="3671972"><a href="/encoding/json/encode.go.html#3671167">t</a></span><span class="op" id="3671973">]</span>&nbsp;<span class="op" id="3671975">=</span>&nbsp;<span class="ident" id="3671977"><a href="/encoding/json/encode.go.html#3671220">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671980"><a href="/encoding/json/encode.go.html#3670946">encoderCache</a></span><span class="op" id="3671992">.</span><span class="ident" id="3671993">Unlock</span><span class="op" id="3671999">(</span><span class="op" id="3672000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672003">return</span>&nbsp;<span class="ident" id="3672010"><a href="/encoding/json/encode.go.html#3671220">f</a></span><br>
<span class="lineno"></span><span class="op" id="3672012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3672015">var</span>&nbsp;<span class="op" id="3672019">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672022">marshalerType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3672040">=</span>&nbsp;<span class="ident" id="3672042"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672049">.</span><span class="ident" id="3672050">TypeOf</span><span class="op" id="3672056">(</span><span class="builtinfunc" id="3672057">new</span><span class="op" id="3672060">(</span><span class="ident" id="3672061"><a href="/encoding/json/encode.go.html#3668190">Marshaler</a></span><span class="op" id="3672070">)</span><span class="op" id="3672071">)</span><span class="op" id="3672072">.</span><span class="ident" id="3672073">Elem</span><span class="op" id="3672077">(</span><span class="op" id="3672078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672081">textMarshalerType</span>&nbsp;<span class="op" id="3672099">=</span>&nbsp;<span class="ident" id="3672101"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672108">.</span><span class="ident" id="3672109">TypeOf</span><span class="op" id="3672115">(</span><span class="builtinfunc" id="3672116">new</span><span class="op" id="3672119">(</span><span class="ident" id="3672120"><a href="/encoding/json/encode.go.html#3661653">encoding</a></span><span class="op" id="3672128">.</span><span class="ident" id="3672129">TextMarshaler</span><span class="op" id="3672142">)</span><span class="op" id="3672143">)</span><span class="op" id="3672144">.</span><span class="ident" id="3672145">Elem</span><span class="op" id="3672149">(</span><span class="op" id="3672150">)</span><br>
<span class="lineno"></span><span class="op" id="3672152">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3672155">//&nbsp;newTypeEncoder&nbsp;constructs&nbsp;an&nbsp;encoderFunc&nbsp;for&nbsp;a&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="3672211">//&nbsp;The&nbsp;returned&nbsp;encoder&nbsp;only&nbsp;checks&nbsp;CanAddr&nbsp;when&nbsp;allowAddr&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3672279">func</span>&nbsp;<span class="ident" id="3672284">newTypeEncoder</span><span class="op" id="3672298">(</span><span class="ident" id="3672299">t</span>&nbsp;<span class="ident" id="3672301"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672308">.</span><span class="ident" id="3672309">Type</span><span class="op" id="3672313">,</span>&nbsp;<span class="ident" id="3672315">allowAddr</span>&nbsp;<span class="builtintype" id="3672325">bool</span><span class="op" id="3672329">)</span>&nbsp;<span class="ident" id="3672331"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span>&nbsp;<span class="op" id="3672343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672346">if</span>&nbsp;<span class="ident" id="3672349"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3672350">.</span><span class="ident" id="3672351">Implements</span><span class="op" id="3672361">(</span><span class="ident" id="3672362"><a href="/encoding/json/encode.go.html#3672022">marshalerType</a></span><span class="op" id="3672375">)</span>&nbsp;<span class="op" id="3672377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672381">return</span>&nbsp;<span class="ident" id="3672388"><a href="/encoding/json/encode.go.html#3673703">marshalerEncoder</a></span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672409">if</span>&nbsp;<span class="ident" id="3672412"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3672413">.</span><span class="ident" id="3672414">Kind</span><span class="op" id="3672418">(</span><span class="op" id="3672419">)</span>&nbsp;<span class="op" id="3672421">!=</span>&nbsp;<span class="ident" id="3672424"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672431">.</span><span class="ident" id="3672432">Ptr</span>&nbsp;<span class="op" id="3672436">&amp;&amp;</span>&nbsp;<span class="ident" id="3672439"><a href="/encoding/json/encode.go.html#3672315">allowAddr</a></span>&nbsp;<span class="op" id="3672449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672453">if</span>&nbsp;<span class="ident" id="3672456"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672463">.</span><span class="ident" id="3672464">PtrTo</span><span class="op" id="3672469">(</span><span class="ident" id="3672470"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3672471">)</span><span class="op" id="3672472">.</span><span class="ident" id="3672473">Implements</span><span class="op" id="3672483">(</span><span class="ident" id="3672484"><a href="/encoding/json/encode.go.html#3672022">marshalerType</a></span><span class="op" id="3672497">)</span>&nbsp;<span class="op" id="3672499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672504">return</span>&nbsp;<span class="ident" id="3672511"><a href="/encoding/json/encode.go.html#3680407">newCondAddrEncoder</a></span><span class="op" id="3672529">(</span><span class="ident" id="3672530"><a href="/encoding/json/encode.go.html#3674079">addrMarshalerEncoder</a></span><span class="op" id="3672550">,</span>&nbsp;<span class="ident" id="3672552"><a href="/encoding/json/encode.go.html#3672284">newTypeEncoder</a></span><span class="op" id="3672566">(</span><span class="ident" id="3672567"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3672568">,</span>&nbsp;<span class="ident" id="3672570">false</span><span class="op" id="3672575">)</span><span class="op" id="3672576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672580">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672587">if</span>&nbsp;<span class="ident" id="3672590"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3672591">.</span><span class="ident" id="3672592">Implements</span><span class="op" id="3672602">(</span><span class="ident" id="3672603"><a href="/encoding/json/encode.go.html#3672081">textMarshalerType</a></span><span class="op" id="3672620">)</span>&nbsp;<span class="op" id="3672622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672626">return</span>&nbsp;<span class="ident" id="3672633"><a href="/encoding/json/encode.go.html#3674450">textMarshalerEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672655">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672658">if</span>&nbsp;<span class="ident" id="3672661"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3672662">.</span><span class="ident" id="3672663">Kind</span><span class="op" id="3672667">(</span><span class="op" id="3672668">)</span>&nbsp;<span class="op" id="3672670">!=</span>&nbsp;<span class="ident" id="3672673"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672680">.</span><span class="ident" id="3672681">Ptr</span>&nbsp;<span class="op" id="3672685">&amp;&amp;</span>&nbsp;<span class="ident" id="3672688"><a href="/encoding/json/encode.go.html#3672315">allowAddr</a></span>&nbsp;<span class="op" id="3672698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672702">if</span>&nbsp;<span class="ident" id="3672705"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672712">.</span><span class="ident" id="3672713">PtrTo</span><span class="op" id="3672718">(</span><span class="ident" id="3672719"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3672720">)</span><span class="op" id="3672721">.</span><span class="ident" id="3672722">Implements</span><span class="op" id="3672732">(</span><span class="ident" id="3672733"><a href="/encoding/json/encode.go.html#3672081">textMarshalerType</a></span><span class="op" id="3672750">)</span>&nbsp;<span class="op" id="3672752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672757">return</span>&nbsp;<span class="ident" id="3672764"><a href="/encoding/json/encode.go.html#3680407">newCondAddrEncoder</a></span><span class="op" id="3672782">(</span><span class="ident" id="3672783"><a href="/encoding/json/encode.go.html#3674788">addrTextMarshalerEncoder</a></span><span class="op" id="3672807">,</span>&nbsp;<span class="ident" id="3672809"><a href="/encoding/json/encode.go.html#3672284">newTypeEncoder</a></span><span class="op" id="3672823">(</span><span class="ident" id="3672824"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3672825">,</span>&nbsp;<span class="ident" id="3672827">false</span><span class="op" id="3672832">)</span><span class="op" id="3672833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672840">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672844">switch</span>&nbsp;<span class="ident" id="3672851"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3672852">.</span><span class="ident" id="3672853">Kind</span><span class="op" id="3672857">(</span><span class="op" id="3672858">)</span>&nbsp;<span class="op" id="3672860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672863">case</span>&nbsp;<span class="ident" id="3672868"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672875">.</span><span class="ident" id="3672876">Bool</span><span class="op" id="3672880">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672884">return</span>&nbsp;<span class="ident" id="3672891"><a href="/encoding/json/encode.go.html#3675121">boolEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672904">case</span>&nbsp;<span class="ident" id="3672909"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672916">.</span><span class="ident" id="3672917">Int</span><span class="op" id="3672920">,</span>&nbsp;<span class="ident" id="3672922"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672929">.</span><span class="ident" id="3672930">Int8</span><span class="op" id="3672934">,</span>&nbsp;<span class="ident" id="3672936"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672943">.</span><span class="ident" id="3672944">Int16</span><span class="op" id="3672949">,</span>&nbsp;<span class="ident" id="3672951"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672958">.</span><span class="ident" id="3672959">Int32</span><span class="op" id="3672964">,</span>&nbsp;<span class="ident" id="3672966"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3672973">.</span><span class="ident" id="3672974">Int64</span><span class="op" id="3672979">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672983">return</span>&nbsp;<span class="ident" id="3672990"><a href="/encoding/json/encode.go.html#3675336">intEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673002">case</span>&nbsp;<span class="ident" id="3673007"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673014">.</span><span class="ident" id="3673015">Uint</span><span class="op" id="3673019">,</span>&nbsp;<span class="ident" id="3673021"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673028">.</span><span class="ident" id="3673029">Uint8</span><span class="op" id="3673034">,</span>&nbsp;<span class="ident" id="3673036"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673043">.</span><span class="ident" id="3673044">Uint16</span><span class="op" id="3673050">,</span>&nbsp;<span class="ident" id="3673052"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673059">.</span><span class="ident" id="3673060">Uint32</span><span class="op" id="3673066">,</span>&nbsp;<span class="ident" id="3673068"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673075">.</span><span class="ident" id="3673076">Uint64</span><span class="op" id="3673082">,</span>&nbsp;<span class="ident" id="3673084"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673091">.</span><span class="ident" id="3673092">Uintptr</span><span class="op" id="3673099">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673103">return</span>&nbsp;<span class="ident" id="3673110"><a href="/encoding/json/encode.go.html#3675537">uintEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673123">case</span>&nbsp;<span class="ident" id="3673128"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673135">.</span><span class="ident" id="3673136">Float32</span><span class="op" id="3673143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673147">return</span>&nbsp;<span class="ident" id="3673154"><a href="/encoding/json/encode.go.html#3676153">float32Encoder</a></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673170">case</span>&nbsp;<span class="ident" id="3673175"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673182">.</span><span class="ident" id="3673183">Float64</span><span class="op" id="3673190">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673194">return</span>&nbsp;<span class="ident" id="3673201"><a href="/encoding/json/encode.go.html#3676197">float64Encoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673217">case</span>&nbsp;<span class="ident" id="3673222"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673229">.</span><span class="ident" id="3673230">String</span><span class="op" id="3673236">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673240">return</span>&nbsp;<span class="ident" id="3673247"><a href="/encoding/json/encode.go.html#3676248">stringEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673262">case</span>&nbsp;<span class="ident" id="3673267"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673274">.</span><span class="ident" id="3673275">Interface</span><span class="op" id="3673284">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673288">return</span>&nbsp;<span class="ident" id="3673295"><a href="/encoding/json/encode.go.html#3676610">interfaceEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673313">case</span>&nbsp;<span class="ident" id="3673318"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673325">.</span><span class="ident" id="3673326">Struct</span><span class="op" id="3673332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673336">return</span>&nbsp;<span class="ident" id="3673343"><a href="/encoding/json/encode.go.html#3677368">newStructEncoder</a></span><span class="op" id="3673359">(</span><span class="ident" id="3673360"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3673361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673364">case</span>&nbsp;<span class="ident" id="3673369"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673376">.</span><span class="ident" id="3673377">Map</span><span class="op" id="3673380">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673384">return</span>&nbsp;<span class="ident" id="3673391"><a href="/encoding/json/encode.go.html#3678060">newMapEncoder</a></span><span class="op" id="3673404">(</span><span class="ident" id="3673405"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3673406">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673409">case</span>&nbsp;<span class="ident" id="3673414"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673421">.</span><span class="ident" id="3673422">Slice</span><span class="op" id="3673427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673431">return</span>&nbsp;<span class="ident" id="3673438"><a href="/encoding/json/encode.go.html#3679074">newSliceEncoder</a></span><span class="op" id="3673453">(</span><span class="ident" id="3673454"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3673455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673458">case</span>&nbsp;<span class="ident" id="3673463"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673470">.</span><span class="ident" id="3673471">Array</span><span class="op" id="3673476">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673480">return</span>&nbsp;<span class="ident" id="3673487"><a href="/encoding/json/encode.go.html#3679588">newArrayEncoder</a></span><span class="op" id="3673502">(</span><span class="ident" id="3673503"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3673504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673507">case</span>&nbsp;<span class="ident" id="3673512"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673519">.</span><span class="ident" id="3673520">Ptr</span><span class="op" id="3673523">:</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673527">return</span>&nbsp;<span class="ident" id="3673534"><a href="/encoding/json/encode.go.html#3679920">newPtrEncoder</a></span><span class="op" id="3673547">(</span><span class="ident" id="3673548"><a href="/encoding/json/encode.go.html#3672299">t</a></span><span class="op" id="3673549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673552">default</span><span class="op" id="3673559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673563">return</span>&nbsp;<span class="ident" id="3673570"><a href="/encoding/json/encode.go.html#3676761">unsupportedTypeEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3673594">}</span><br>
<span class="lineno"></span><span class="op" id="3673596">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="3673599">func</span>&nbsp;<span class="ident" id="3673604">invalidValueEncoder</span><span class="op" id="3673623">(</span><span class="ident" id="3673624">e</span>&nbsp;<span class="op" id="3673626">*</span><span class="ident" id="3673627"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3673638">,</span>&nbsp;<span class="ident" id="3673640">v</span>&nbsp;<span class="ident" id="3673642"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673649">.</span><span class="ident" id="3673650">Value</span><span class="op" id="3673655">,</span>&nbsp;<span class="ident" id="3673657">quoted</span>&nbsp;<span class="builtintype" id="3673664">bool</span><span class="op" id="3673668">)</span>&nbsp;<span class="op" id="3673670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3673673"><a href="/encoding/json/encode.go.html#3673624">e</a></span><span class="op" id="3673674">.</span><span class="ident" id="3673675">WriteString</span><span class="op" id="3673686">(</span><span class="string" id="3673687">&#34;null&#34;</span><span class="op" id="3673693">)</span><br>
<span class="lineno"></span><span class="op" id="3673695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="3673698">func</span>&nbsp;<span class="ident" id="3673703">marshalerEncoder</span><span class="op" id="3673719">(</span><span class="ident" id="3673720">e</span>&nbsp;<span class="op" id="3673722">*</span><span class="ident" id="3673723"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3673734">,</span>&nbsp;<span class="ident" id="3673736">v</span>&nbsp;<span class="ident" id="3673738"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673745">.</span><span class="ident" id="3673746">Value</span><span class="op" id="3673751">,</span>&nbsp;<span class="ident" id="3673753">quoted</span>&nbsp;<span class="builtintype" id="3673760">bool</span><span class="op" id="3673764">)</span>&nbsp;<span class="op" id="3673766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673769">if</span>&nbsp;<span class="ident" id="3673772"><a href="/encoding/json/encode.go.html#3673736">v</a></span><span class="op" id="3673773">.</span><span class="ident" id="3673774">Kind</span><span class="op" id="3673778">(</span><span class="op" id="3673779">)</span>&nbsp;<span class="op" id="3673781">==</span>&nbsp;<span class="ident" id="3673784"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3673791">.</span><span class="ident" id="3673792">Ptr</span>&nbsp;<span class="op" id="3673796">&amp;&amp;</span>&nbsp;<span class="ident" id="3673799"><a href="/encoding/json/encode.go.html#3673736">v</a></span><span class="op" id="3673800">.</span><span class="ident" id="3673801">IsNil</span><span class="op" id="3673806">(</span><span class="op" id="3673807">)</span>&nbsp;<span class="op" id="3673809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3673813"><a href="/encoding/json/encode.go.html#3673720">e</a></span><span class="op" id="3673814">.</span><span class="ident" id="3673815">WriteString</span><span class="op" id="3673826">(</span><span class="string" id="3673827">&#34;null&#34;</span><span class="op" id="3673833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673837">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3673845">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3673848">m</span>&nbsp;<span class="op" id="3673850">:=</span>&nbsp;<span class="ident" id="3673853"><a href="/encoding/json/encode.go.html#3673736">v</a></span><span class="op" id="3673854">.</span><span class="ident" id="3673855">Interface</span><span class="op" id="3673864">(</span><span class="op" id="3673865">)</span><span class="op" id="3673866">.</span><span class="op" id="3673867">(</span><span class="ident" id="3673868"><a href="/encoding/json/encode.go.html#3668190">Marshaler</a></span><span class="op" id="3673877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3673880">b</span><span class="op" id="3673881">,</span>&nbsp;<span class="ident" id="3673883">err</span>&nbsp;<span class="op" id="3673887">:=</span>&nbsp;<span class="ident" id="3673890"><a href="/encoding/json/encode.go.html#3673848">m</a></span><span class="op" id="3673891">.</span><span class="ident" id="3673892">MarshalJSON</span><span class="op" id="3673903">(</span><span class="op" id="3673904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3673907">if</span>&nbsp;<span class="ident" id="3673910"><a href="/encoding/json/encode.go.html#3673883">err</a></span>&nbsp;<span class="op" id="3673914">==</span>&nbsp;<span class="ident" id="3673917">nil</span>&nbsp;<span class="op" id="3673921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3673925">//&nbsp;copy&nbsp;JSON&nbsp;into&nbsp;buffer,&nbsp;checking&nbsp;validity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3673972"><a href="/encoding/json/encode.go.html#3673883">err</a></span>&nbsp;<span class="op" id="3673976">=</span>&nbsp;<span class="ident" id="3673978"><a href="/encoding/json/indent.go.html#3695887">compact</a></span><span class="op" id="3673985">(</span><span class="op" id="3673986">&amp;</span><span class="ident" id="3673987"><a href="/encoding/json/encode.go.html#3673720">e</a></span><span class="op" id="3673988">.</span><span class="ident" id="3673989">Buffer</span><span class="op" id="3673995">,</span>&nbsp;<span class="ident" id="3673997"><a href="/encoding/json/encode.go.html#3673880">b</a></span><span class="op" id="3673998">,</span>&nbsp;<span class="ident" id="3674000">true</span><span class="op" id="3674004">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3674007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674010">if</span>&nbsp;<span class="ident" id="3674013"><a href="/encoding/json/encode.go.html#3673883">err</a></span>&nbsp;<span class="op" id="3674017">!=</span>&nbsp;<span class="ident" id="3674020">nil</span>&nbsp;<span class="op" id="3674024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674028"><a href="/encoding/json/encode.go.html#3673720">e</a></span><span class="op" id="3674029">.</span><span class="builtintype" id="3674030">error</span><span class="op" id="3674035">(</span><span class="op" id="3674036">&amp;</span><span class="ident" id="3674037"><a href="/encoding/json/encode.go.html#3669282">MarshalerError</a></span><span class="op" id="3674051">{</span><span class="ident" id="3674052"><a href="/encoding/json/encode.go.html#3673736">v</a></span><span class="op" id="3674053">.</span><span class="ident" id="3674054">Type</span><span class="op" id="3674058">(</span><span class="op" id="3674059">)</span><span class="op" id="3674060">,</span>&nbsp;<span class="ident" id="3674062"><a href="/encoding/json/encode.go.html#3673883">err</a></span><span class="op" id="3674065">}</span><span class="op" id="3674066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3674069">}</span><br>
<span class="lineno"></span><span class="op" id="3674071">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="3674074">func</span>&nbsp;<span class="ident" id="3674079">addrMarshalerEncoder</span><span class="op" id="3674099">(</span><span class="ident" id="3674100">e</span>&nbsp;<span class="op" id="3674102">*</span><span class="ident" id="3674103"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3674114">,</span>&nbsp;<span class="ident" id="3674116">v</span>&nbsp;<span class="ident" id="3674118"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3674125">.</span><span class="ident" id="3674126">Value</span><span class="op" id="3674131">,</span>&nbsp;<span class="ident" id="3674133">quoted</span>&nbsp;<span class="builtintype" id="3674140">bool</span><span class="op" id="3674144">)</span>&nbsp;<span class="op" id="3674146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674149">va</span>&nbsp;<span class="op" id="3674152">:=</span>&nbsp;<span class="ident" id="3674155"><a href="/encoding/json/encode.go.html#3674116">v</a></span><span class="op" id="3674156">.</span><span class="ident" id="3674157">Addr</span><span class="op" id="3674161">(</span><span class="op" id="3674162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674165">if</span>&nbsp;<span class="ident" id="3674168"><a href="/encoding/json/encode.go.html#3674149">va</a></span><span class="op" id="3674170">.</span><span class="ident" id="3674171">IsNil</span><span class="op" id="3674176">(</span><span class="op" id="3674177">)</span>&nbsp;<span class="op" id="3674179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674183"><a href="/encoding/json/encode.go.html#3674100">e</a></span><span class="op" id="3674184">.</span><span class="ident" id="3674185">WriteString</span><span class="op" id="3674196">(</span><span class="string" id="3674197">&#34;null&#34;</span><span class="op" id="3674203">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674207">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3674215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674218">m</span>&nbsp;<span class="op" id="3674220">:=</span>&nbsp;<span class="ident" id="3674223"><a href="/encoding/json/encode.go.html#3674149">va</a></span><span class="op" id="3674225">.</span><span class="ident" id="3674226">Interface</span><span class="op" id="3674235">(</span><span class="op" id="3674236">)</span><span class="op" id="3674237">.</span><span class="op" id="3674238">(</span><span class="ident" id="3674239"><a href="/encoding/json/encode.go.html#3668190">Marshaler</a></span><span class="op" id="3674248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674251">b</span><span class="op" id="3674252">,</span>&nbsp;<span class="ident" id="3674254">err</span>&nbsp;<span class="op" id="3674258">:=</span>&nbsp;<span class="ident" id="3674261"><a href="/encoding/json/encode.go.html#3674218">m</a></span><span class="op" id="3674262">.</span><span class="ident" id="3674263">MarshalJSON</span><span class="op" id="3674274">(</span><span class="op" id="3674275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674278">if</span>&nbsp;<span class="ident" id="3674281"><a href="/encoding/json/encode.go.html#3674254">err</a></span>&nbsp;<span class="op" id="3674285">==</span>&nbsp;<span class="ident" id="3674288">nil</span>&nbsp;<span class="op" id="3674292">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3674296">//&nbsp;copy&nbsp;JSON&nbsp;into&nbsp;buffer,&nbsp;checking&nbsp;validity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674343"><a href="/encoding/json/encode.go.html#3674254">err</a></span>&nbsp;<span class="op" id="3674347">=</span>&nbsp;<span class="ident" id="3674349"><a href="/encoding/json/indent.go.html#3695887">compact</a></span><span class="op" id="3674356">(</span><span class="op" id="3674357">&amp;</span><span class="ident" id="3674358"><a href="/encoding/json/encode.go.html#3674100">e</a></span><span class="op" id="3674359">.</span><span class="ident" id="3674360">Buffer</span><span class="op" id="3674366">,</span>&nbsp;<span class="ident" id="3674368"><a href="/encoding/json/encode.go.html#3674251">b</a></span><span class="op" id="3674369">,</span>&nbsp;<span class="ident" id="3674371">true</span><span class="op" id="3674375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3674378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674381">if</span>&nbsp;<span class="ident" id="3674384"><a href="/encoding/json/encode.go.html#3674254">err</a></span>&nbsp;<span class="op" id="3674388">!=</span>&nbsp;<span class="ident" id="3674391">nil</span>&nbsp;<span class="op" id="3674395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674399"><a href="/encoding/json/encode.go.html#3674100">e</a></span><span class="op" id="3674400">.</span><span class="builtintype" id="3674401">error</span><span class="op" id="3674406">(</span><span class="op" id="3674407">&amp;</span><span class="ident" id="3674408"><a href="/encoding/json/encode.go.html#3669282">MarshalerError</a></span><span class="op" id="3674422">{</span><span class="ident" id="3674423"><a href="/encoding/json/encode.go.html#3674116">v</a></span><span class="op" id="3674424">.</span><span class="ident" id="3674425">Type</span><span class="op" id="3674429">(</span><span class="op" id="3674430">)</span><span class="op" id="3674431">,</span>&nbsp;<span class="ident" id="3674433"><a href="/encoding/json/encode.go.html#3674254">err</a></span><span class="op" id="3674436">}</span><span class="op" id="3674437">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3674440">}</span><br>
<span class="lineno"></span><span class="op" id="3674442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3674445">func</span>&nbsp;<span class="ident" id="3674450">textMarshalerEncoder</span><span class="op" id="3674470">(</span><span class="ident" id="3674471">e</span>&nbsp;<span class="op" id="3674473">*</span><span class="ident" id="3674474"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3674485">,</span>&nbsp;<span class="ident" id="3674487">v</span>&nbsp;<span class="ident" id="3674489"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3674496">.</span><span class="ident" id="3674497">Value</span><span class="op" id="3674502">,</span>&nbsp;<span class="ident" id="3674504">quoted</span>&nbsp;<span class="builtintype" id="3674511">bool</span><span class="op" id="3674515">)</span>&nbsp;<span class="op" id="3674517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674520">if</span>&nbsp;<span class="ident" id="3674523"><a href="/encoding/json/encode.go.html#3674487">v</a></span><span class="op" id="3674524">.</span><span class="ident" id="3674525">Kind</span><span class="op" id="3674529">(</span><span class="op" id="3674530">)</span>&nbsp;<span class="op" id="3674532">==</span>&nbsp;<span class="ident" id="3674535"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3674542">.</span><span class="ident" id="3674543">Ptr</span>&nbsp;<span class="op" id="3674547">&amp;&amp;</span>&nbsp;<span class="ident" id="3674550"><a href="/encoding/json/encode.go.html#3674487">v</a></span><span class="op" id="3674551">.</span><span class="ident" id="3674552">IsNil</span><span class="op" id="3674557">(</span><span class="op" id="3674558">)</span>&nbsp;<span class="op" id="3674560">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674564"><a href="/encoding/json/encode.go.html#3674471">e</a></span><span class="op" id="3674565">.</span><span class="ident" id="3674566">WriteString</span><span class="op" id="3674577">(</span><span class="string" id="3674578">&#34;null&#34;</span><span class="op" id="3674584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674588">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3674596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674599">m</span>&nbsp;<span class="op" id="3674601">:=</span>&nbsp;<span class="ident" id="3674604"><a href="/encoding/json/encode.go.html#3674487">v</a></span><span class="op" id="3674605">.</span><span class="ident" id="3674606">Interface</span><span class="op" id="3674615">(</span><span class="op" id="3674616">)</span><span class="op" id="3674617">.</span><span class="op" id="3674618">(</span><span class="ident" id="3674619"><a href="/encoding/json/encode.go.html#3661653">encoding</a></span><span class="op" id="3674627">.</span><span class="ident" id="3674628">TextMarshaler</span><span class="op" id="3674641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674644">b</span><span class="op" id="3674645">,</span>&nbsp;<span class="ident" id="3674647">err</span>&nbsp;<span class="op" id="3674651">:=</span>&nbsp;<span class="ident" id="3674654"><a href="/encoding/json/encode.go.html#3674599">m</a></span><span class="op" id="3674655">.</span><span class="ident" id="3674656">MarshalText</span><span class="op" id="3674667">(</span><span class="op" id="3674668">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674671">if</span>&nbsp;<span class="ident" id="3674674"><a href="/encoding/json/encode.go.html#3674647">err</a></span>&nbsp;<span class="op" id="3674678">==</span>&nbsp;<span class="ident" id="3674681">nil</span>&nbsp;<span class="op" id="3674685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674689">_</span><span class="op" id="3674690">,</span>&nbsp;<span class="ident" id="3674692"><a href="/encoding/json/encode.go.html#3674647">err</a></span>&nbsp;<span class="op" id="3674696">=</span>&nbsp;<span class="ident" id="3674698"><a href="/encoding/json/encode.go.html#3674471">e</a></span><span class="op" id="3674699">.</span><span class="ident" id="3674700">stringBytes</span><span class="op" id="3674711">(</span><span class="ident" id="3674712"><a href="/encoding/json/encode.go.html#3674644">b</a></span><span class="op" id="3674713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3674716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674719">if</span>&nbsp;<span class="ident" id="3674722"><a href="/encoding/json/encode.go.html#3674647">err</a></span>&nbsp;<span class="op" id="3674726">!=</span>&nbsp;<span class="ident" id="3674729">nil</span>&nbsp;<span class="op" id="3674733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674737"><a href="/encoding/json/encode.go.html#3674471">e</a></span><span class="op" id="3674738">.</span><span class="builtintype" id="3674739">error</span><span class="op" id="3674744">(</span><span class="op" id="3674745">&amp;</span><span class="ident" id="3674746"><a href="/encoding/json/encode.go.html#3669282">MarshalerError</a></span><span class="op" id="3674760">{</span><span class="ident" id="3674761"><a href="/encoding/json/encode.go.html#3674487">v</a></span><span class="op" id="3674762">.</span><span class="ident" id="3674763">Type</span><span class="op" id="3674767">(</span><span class="op" id="3674768">)</span><span class="op" id="3674769">,</span>&nbsp;<span class="ident" id="3674771"><a href="/encoding/json/encode.go.html#3674647">err</a></span><span class="op" id="3674774">}</span><span class="op" id="3674775">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3674778">}</span><br>
<span class="lineno"></span><span class="op" id="3674780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3674783">func</span>&nbsp;<span class="ident" id="3674788">addrTextMarshalerEncoder</span><span class="op" id="3674812">(</span><span class="ident" id="3674813">e</span>&nbsp;<span class="op" id="3674815">*</span><span class="ident" id="3674816"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3674827">,</span>&nbsp;<span class="ident" id="3674829">v</span>&nbsp;<span class="ident" id="3674831"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3674838">.</span><span class="ident" id="3674839">Value</span><span class="op" id="3674844">,</span>&nbsp;<span class="ident" id="3674846">quoted</span>&nbsp;<span class="builtintype" id="3674853">bool</span><span class="op" id="3674857">)</span>&nbsp;<span class="op" id="3674859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674862">va</span>&nbsp;<span class="op" id="3674865">:=</span>&nbsp;<span class="ident" id="3674868"><a href="/encoding/json/encode.go.html#3674829">v</a></span><span class="op" id="3674869">.</span><span class="ident" id="3674870">Addr</span><span class="op" id="3674874">(</span><span class="op" id="3674875">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674878">if</span>&nbsp;<span class="ident" id="3674881"><a href="/encoding/json/encode.go.html#3674862">va</a></span><span class="op" id="3674883">.</span><span class="ident" id="3674884">IsNil</span><span class="op" id="3674889">(</span><span class="op" id="3674890">)</span>&nbsp;<span class="op" id="3674892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674896"><a href="/encoding/json/encode.go.html#3674813">e</a></span><span class="op" id="3674897">.</span><span class="ident" id="3674898">WriteString</span><span class="op" id="3674909">(</span><span class="string" id="3674910">&#34;null&#34;</span><span class="op" id="3674916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3674920">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3674928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674931">m</span>&nbsp;<span class="op" id="3674933">:=</span>&nbsp;<span class="ident" id="3674936"><a href="/encoding/json/encode.go.html#3674862">va</a></span><span class="op" id="3674938">.</span><span class="ident" id="3674939">Interface</span><span class="op" id="3674948">(</span><span class="op" id="3674949">)</span><span class="op" id="3674950">.</span><span class="op" id="3674951">(</span><span class="ident" id="3674952"><a href="/encoding/json/encode.go.html#3661653">encoding</a></span><span class="op" id="3674960">.</span><span class="ident" id="3674961">TextMarshaler</span><span class="op" id="3674974">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3674977">b</span><span class="op" id="3674978">,</span>&nbsp;<span class="ident" id="3674980">err</span>&nbsp;<span class="op" id="3674984">:=</span>&nbsp;<span class="ident" id="3674987"><a href="/encoding/json/encode.go.html#3674931">m</a></span><span class="op" id="3674988">.</span><span class="ident" id="3674989">MarshalText</span><span class="op" id="3675000">(</span><span class="op" id="3675001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3675004">if</span>&nbsp;<span class="ident" id="3675007"><a href="/encoding/json/encode.go.html#3674980">err</a></span>&nbsp;<span class="op" id="3675011">==</span>&nbsp;<span class="ident" id="3675014">nil</span>&nbsp;<span class="op" id="3675018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675022">_</span><span class="op" id="3675023">,</span>&nbsp;<span class="ident" id="3675025"><a href="/encoding/json/encode.go.html#3674980">err</a></span>&nbsp;<span class="op" id="3675029">=</span>&nbsp;<span class="ident" id="3675031"><a href="/encoding/json/encode.go.html#3674813">e</a></span><span class="op" id="3675032">.</span><span class="ident" id="3675033">stringBytes</span><span class="op" id="3675044">(</span><span class="ident" id="3675045"><a href="/encoding/json/encode.go.html#3674977">b</a></span><span class="op" id="3675046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3675052">if</span>&nbsp;<span class="ident" id="3675055"><a href="/encoding/json/encode.go.html#3674980">err</a></span>&nbsp;<span class="op" id="3675059">!=</span>&nbsp;<span class="ident" id="3675062">nil</span>&nbsp;<span class="op" id="3675066">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675070"><a href="/encoding/json/encode.go.html#3674813">e</a></span><span class="op" id="3675071">.</span><span class="builtintype" id="3675072">error</span><span class="op" id="3675077">(</span><span class="op" id="3675078">&amp;</span><span class="ident" id="3675079"><a href="/encoding/json/encode.go.html#3669282">MarshalerError</a></span><span class="op" id="3675093">{</span><span class="ident" id="3675094"><a href="/encoding/json/encode.go.html#3674829">v</a></span><span class="op" id="3675095">.</span><span class="ident" id="3675096">Type</span><span class="op" id="3675100">(</span><span class="op" id="3675101">)</span><span class="op" id="3675102">,</span>&nbsp;<span class="ident" id="3675104"><a href="/encoding/json/encode.go.html#3674980">err</a></span><span class="op" id="3675107">}</span><span class="op" id="3675108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675111">}</span><br>
<span class="lineno"></span><span class="op" id="3675113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3675116">func</span>&nbsp;<span class="ident" id="3675121">boolEncoder</span><span class="op" id="3675132">(</span><span class="ident" id="3675133">e</span>&nbsp;<span class="op" id="3675135">*</span><span class="ident" id="3675136"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3675147">,</span>&nbsp;<span class="ident" id="3675149">v</span>&nbsp;<span class="ident" id="3675151"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3675158">.</span><span class="ident" id="3675159">Value</span><span class="op" id="3675164">,</span>&nbsp;<span class="ident" id="3675166">quoted</span>&nbsp;<span class="builtintype" id="3675173">bool</span><span class="op" id="3675177">)</span>&nbsp;<span class="op" id="3675179">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3675182">if</span>&nbsp;<span class="ident" id="3675185"><a href="/encoding/json/encode.go.html#3675166">quoted</a></span>&nbsp;<span class="op" id="3675192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675196"><a href="/encoding/json/encode.go.html#3675133">e</a></span><span class="op" id="3675197">.</span><span class="ident" id="3675198">WriteByte</span><span class="op" id="3675207">(</span><span class="string" id="3675208">&#39;&#34;&#39;</span><span class="op" id="3675211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3675217">if</span>&nbsp;<span class="ident" id="3675220"><a href="/encoding/json/encode.go.html#3675149">v</a></span><span class="op" id="3675221">.</span><span class="ident" id="3675222">Bool</span><span class="op" id="3675226">(</span><span class="op" id="3675227">)</span>&nbsp;<span class="op" id="3675229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675233"><a href="/encoding/json/encode.go.html#3675133">e</a></span><span class="op" id="3675234">.</span><span class="ident" id="3675235">WriteString</span><span class="op" id="3675246">(</span><span class="string" id="3675247">&#34;true&#34;</span><span class="op" id="3675253">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675256">}</span>&nbsp;<span class="keyword" id="3675258">else</span>&nbsp;<span class="op" id="3675263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675267"><a href="/encoding/json/encode.go.html#3675133">e</a></span><span class="op" id="3675268">.</span><span class="ident" id="3675269">WriteString</span><span class="op" id="3675280">(</span><span class="string" id="3675281">&#34;false&#34;</span><span class="op" id="3675288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3675294">if</span>&nbsp;<span class="ident" id="3675297"><a href="/encoding/json/encode.go.html#3675166">quoted</a></span>&nbsp;<span class="op" id="3675304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675308"><a href="/encoding/json/encode.go.html#3675133">e</a></span><span class="op" id="3675309">.</span><span class="ident" id="3675310">WriteByte</span><span class="op" id="3675319">(</span><span class="string" id="3675320">&#39;&#34;&#39;</span><span class="op" id="3675323">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675326">}</span><br>
<span class="lineno"></span><span class="op" id="3675328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3675331">func</span>&nbsp;<span class="ident" id="3675336">intEncoder</span><span class="op" id="3675346">(</span><span class="ident" id="3675347">e</span>&nbsp;<span class="op" id="3675349">*</span><span class="ident" id="3675350"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3675361">,</span>&nbsp;<span class="ident" id="3675363">v</span>&nbsp;<span class="ident" id="3675365"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3675372">.</span><span class="ident" id="3675373">Value</span><span class="op" id="3675378">,</span>&nbsp;<span class="ident" id="3675380">quoted</span>&nbsp;<span class="builtintype" id="3675387">bool</span><span class="op" id="3675391">)</span>&nbsp;<span class="op" id="3675393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675396">b</span>&nbsp;<span class="op" id="3675398">:=</span>&nbsp;<span class="ident" id="3675401"><a href="/encoding/json/encode.go.html#3661722">strconv</a></span><span class="op" id="3675408">.</span><span class="ident" id="3675409">AppendInt</span><span class="op" id="3675418">(</span><span class="ident" id="3675419"><a href="/encoding/json/encode.go.html#3675347">e</a></span><span class="op" id="3675420">.</span><span class="ident" id="3675421">scratch</span><span class="op" id="3675428">[</span><span class="op" id="3675429">:</span><span class="num" id="3675430">0</span><span class="op" id="3675431">]</span><span class="op" id="3675432">,</span>&nbsp;<span class="ident" id="3675434"><a href="/encoding/json/encode.go.html#3675363">v</a></span><span class="op" id="3675435">.</span><span class="ident" id="3675436">Int</span><span class="op" id="3675439">(</span><span class="op" id="3675440">)</span><span class="op" id="3675441">,</span>&nbsp;<span class="num" id="3675443">10</span><span class="op" id="3675445">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3675448">if</span>&nbsp;<span class="ident" id="3675451"><a href="/encoding/json/encode.go.html#3675380">quoted</a></span>&nbsp;<span class="op" id="3675458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675462"><a href="/encoding/json/encode.go.html#3675347">e</a></span><span class="op" id="3675463">.</span><span class="ident" id="3675464">WriteByte</span><span class="op" id="3675473">(</span><span class="string" id="3675474">&#39;&#34;&#39;</span><span class="op" id="3675477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675483"><a href="/encoding/json/encode.go.html#3675347">e</a></span><span class="op" id="3675484">.</span><span class="ident" id="3675485">Write</span><span class="op" id="3675490">(</span><span class="ident" id="3675491"><a href="/encoding/json/encode.go.html#3675396">b</a></span><span class="op" id="3675492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3675495">if</span>&nbsp;<span class="ident" id="3675498"><a href="/encoding/json/encode.go.html#3675380">quoted</a></span>&nbsp;<span class="op" id="3675505">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675509"><a href="/encoding/json/encode.go.html#3675347">e</a></span><span class="op" id="3675510">.</span><span class="ident" id="3675511">WriteByte</span><span class="op" id="3675520">(</span><span class="string" id="3675521">&#39;&#34;&#39;</span><span class="op" id="3675524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675527">}</span><br>
<span class="lineno"></span><span class="op" id="3675529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3675532">func</span>&nbsp;<span class="ident" id="3675537">uintEncoder</span><span class="op" id="3675548">(</span><span class="ident" id="3675549">e</span>&nbsp;<span class="op" id="3675551">*</span><span class="ident" id="3675552"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3675563">,</span>&nbsp;<span class="ident" id="3675565">v</span>&nbsp;<span class="ident" id="3675567"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3675574">.</span><span class="ident" id="3675575">Value</span><span class="op" id="3675580">,</span>&nbsp;<span class="ident" id="3675582">quoted</span>&nbsp;<span class="builtintype" id="3675589">bool</span><span class="op" id="3675593">)</span>&nbsp;<span class="op" id="3675595">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675598">b</span>&nbsp;<span class="op" id="3675600">:=</span>&nbsp;<span class="ident" id="3675603"><a href="/encoding/json/encode.go.html#3661722">strconv</a></span><span class="op" id="3675610">.</span><span class="ident" id="3675611">AppendUint</span><span class="op" id="3675621">(</span><span class="ident" id="3675622"><a href="/encoding/json/encode.go.html#3675549">e</a></span><span class="op" id="3675623">.</span><span class="ident" id="3675624">scratch</span><span class="op" id="3675631">[</span><span class="op" id="3675632">:</span><span class="num" id="3675633">0</span><span class="op" id="3675634">]</span><span class="op" id="3675635">,</span>&nbsp;<span class="ident" id="3675637"><a href="/encoding/json/encode.go.html#3675565">v</a></span><span class="op" id="3675638">.</span><span class="ident" id="3675639">Uint</span><span class="op" id="3675643">(</span><span class="op" id="3675644">)</span><span class="op" id="3675645">,</span>&nbsp;<span class="num" id="3675647">10</span><span class="op" id="3675649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3675652">if</span>&nbsp;<span class="ident" id="3675655"><a href="/encoding/json/encode.go.html#3675582">quoted</a></span>&nbsp;<span class="op" id="3675662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675666"><a href="/encoding/json/encode.go.html#3675549">e</a></span><span class="op" id="3675667">.</span><span class="ident" id="3675668">WriteByte</span><span class="op" id="3675677">(</span><span class="string" id="3675678">&#39;&#34;&#39;</span><span class="op" id="3675681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675687"><a href="/encoding/json/encode.go.html#3675549">e</a></span><span class="op" id="3675688">.</span><span class="ident" id="3675689">Write</span><span class="op" id="3675694">(</span><span class="ident" id="3675695"><a href="/encoding/json/encode.go.html#3675598">b</a></span><span class="op" id="3675696">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3675699">if</span>&nbsp;<span class="ident" id="3675702"><a href="/encoding/json/encode.go.html#3675582">quoted</a></span>&nbsp;<span class="op" id="3675709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675713"><a href="/encoding/json/encode.go.html#3675549">e</a></span><span class="op" id="3675714">.</span><span class="ident" id="3675715">WriteByte</span><span class="op" id="3675724">(</span><span class="string" id="3675725">&#39;&#34;&#39;</span><span class="op" id="3675728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675731">}</span><br>
<span class="lineno"></span><span class="op" id="3675733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="keyword" id="3675736">type</span>&nbsp;<span class="ident" id="3675741">floatEncoder</span>&nbsp;<span class="builtintype" id="3675754">int</span>&nbsp;<span class="comment" id="3675758">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3675777">func</span>&nbsp;<span class="op" id="3675782">(</span><span class="ident" id="3675783">bits</span>&nbsp;<span class="ident" id="3675788"><a href="/encoding/json/encode.go.html#3675741">floatEncoder</a></span><span class="op" id="3675800">)</span>&nbsp;<span class="ident" id="3675802">encode</span><span class="op" id="3675808">(</span><span class="ident" id="3675809">e</span>&nbsp;<span class="op" id="3675811">*</span><span class="ident" id="3675812"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3675823">,</span>&nbsp;<span class="ident" id="3675825">v</span>&nbsp;<span class="ident" id="3675827"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3675834">.</span><span class="ident" id="3675835">Value</span><span class="op" id="3675840">,</span>&nbsp;<span class="ident" id="3675842">quoted</span>&nbsp;<span class="builtintype" id="3675849">bool</span><span class="op" id="3675853">)</span>&nbsp;<span class="op" id="3675855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675858">f</span>&nbsp;<span class="op" id="3675860">:=</span>&nbsp;<span class="ident" id="3675863"><a href="/encoding/json/encode.go.html#3675825">v</a></span><span class="op" id="3675864">.</span><span class="ident" id="3675865">Float</span><span class="op" id="3675870">(</span><span class="op" id="3675871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3675874">if</span>&nbsp;<span class="ident" id="3675877"><a href="/encoding/json/encode.go.html#3661684">math</a></span><span class="op" id="3675881">.</span><span class="ident" id="3675882">IsInf</span><span class="op" id="3675887">(</span><span class="ident" id="3675888"><a href="/encoding/json/encode.go.html#3675858">f</a></span><span class="op" id="3675889">,</span>&nbsp;<span class="num" id="3675891">0</span><span class="op" id="3675892">)</span>&nbsp;<span class="op" id="3675894">||</span>&nbsp;<span class="ident" id="3675897"><a href="/encoding/json/encode.go.html#3661684">math</a></span><span class="op" id="3675901">.</span><span class="ident" id="3675902">IsNaN</span><span class="op" id="3675907">(</span><span class="ident" id="3675908"><a href="/encoding/json/encode.go.html#3675858">f</a></span><span class="op" id="3675909">)</span>&nbsp;<span class="op" id="3675911">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675915"><a href="/encoding/json/encode.go.html#3675809">e</a></span><span class="op" id="3675916">.</span><span class="builtintype" id="3675917">error</span><span class="op" id="3675922">(</span><span class="op" id="3675923">&amp;</span><span class="ident" id="3675924"><a href="/encoding/json/encode.go.html#3668518">UnsupportedValueError</a></span><span class="op" id="3675945">{</span><span class="ident" id="3675946"><a href="/encoding/json/encode.go.html#3675825">v</a></span><span class="op" id="3675947">,</span>&nbsp;<span class="ident" id="3675949"><a href="/encoding/json/encode.go.html#3661722">strconv</a></span><span class="op" id="3675956">.</span><span class="ident" id="3675957">FormatFloat</span><span class="op" id="3675968">(</span><span class="ident" id="3675969"><a href="/encoding/json/encode.go.html#3675858">f</a></span><span class="op" id="3675970">,</span>&nbsp;<span class="string" id="3675972">&#39;g&#39;</span><span class="op" id="3675975">,</span>&nbsp;<span class="op" id="3675977">-</span><span class="num" id="3675978">1</span><span class="op" id="3675979">,</span>&nbsp;<span class="builtintype" id="3675981">int</span><span class="op" id="3675984">(</span><span class="ident" id="3675985"><a href="/encoding/json/encode.go.html#3675783">bits</a></span><span class="op" id="3675989">)</span><span class="op" id="3675990">)</span><span class="op" id="3675991">}</span><span class="op" id="3675992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3675995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3675998">b</span>&nbsp;<span class="op" id="3676000">:=</span>&nbsp;<span class="ident" id="3676003"><a href="/encoding/json/encode.go.html#3661722">strconv</a></span><span class="op" id="3676010">.</span><span class="ident" id="3676011">AppendFloat</span><span class="op" id="3676022">(</span><span class="ident" id="3676023"><a href="/encoding/json/encode.go.html#3675809">e</a></span><span class="op" id="3676024">.</span><span class="ident" id="3676025">scratch</span><span class="op" id="3676032">[</span><span class="op" id="3676033">:</span><span class="num" id="3676034">0</span><span class="op" id="3676035">]</span><span class="op" id="3676036">,</span>&nbsp;<span class="ident" id="3676038"><a href="/encoding/json/encode.go.html#3675858">f</a></span><span class="op" id="3676039">,</span>&nbsp;<span class="string" id="3676041">&#39;g&#39;</span><span class="op" id="3676044">,</span>&nbsp;<span class="op" id="3676046">-</span><span class="num" id="3676047">1</span><span class="op" id="3676048">,</span>&nbsp;<span class="builtintype" id="3676050">int</span><span class="op" id="3676053">(</span><span class="ident" id="3676054"><a href="/encoding/json/encode.go.html#3675783">bits</a></span><span class="op" id="3676058">)</span><span class="op" id="3676059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3676062">if</span>&nbsp;<span class="ident" id="3676065"><a href="/encoding/json/encode.go.html#3675842">quoted</a></span>&nbsp;<span class="op" id="3676072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676076"><a href="/encoding/json/encode.go.html#3675809">e</a></span><span class="op" id="3676077">.</span><span class="ident" id="3676078">WriteByte</span><span class="op" id="3676087">(</span><span class="string" id="3676088">&#39;&#34;&#39;</span><span class="op" id="3676091">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3676094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676097"><a href="/encoding/json/encode.go.html#3675809">e</a></span><span class="op" id="3676098">.</span><span class="ident" id="3676099">Write</span><span class="op" id="3676104">(</span><span class="ident" id="3676105"><a href="/encoding/json/encode.go.html#3675998">b</a></span><span class="op" id="3676106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3676109">if</span>&nbsp;<span class="ident" id="3676112"><a href="/encoding/json/encode.go.html#3675842">quoted</a></span>&nbsp;<span class="op" id="3676119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676123"><a href="/encoding/json/encode.go.html#3675809">e</a></span><span class="op" id="3676124">.</span><span class="ident" id="3676125">WriteByte</span><span class="op" id="3676134">(</span><span class="string" id="3676135">&#39;&#34;&#39;</span><span class="op" id="3676138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3676141">}</span><br>
<span class="lineno">525</span><span class="op" id="3676143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3676146">var</span>&nbsp;<span class="op" id="3676150">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676153">float32Encoder</span>&nbsp;<span class="op" id="3676168">=</span>&nbsp;<span class="op" id="3676170">(</span><span class="ident" id="3676171"><a href="/encoding/json/encode.go.html#3675741">floatEncoder</a></span><span class="op" id="3676183">(</span><span class="num" id="3676184">32</span><span class="op" id="3676186">)</span><span class="op" id="3676187">)</span><span class="op" id="3676188">.</span><span class="ident" id="3676189">encode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676197">float64Encoder</span>&nbsp;<span class="op" id="3676212">=</span>&nbsp;<span class="op" id="3676214">(</span><span class="ident" id="3676215"><a href="/encoding/json/encode.go.html#3675741">floatEncoder</a></span><span class="op" id="3676227">(</span><span class="num" id="3676228">64</span><span class="op" id="3676230">)</span><span class="op" id="3676231">)</span><span class="op" id="3676232">.</span><span class="ident" id="3676233">encode</span><br>
<span class="lineno">530</span><span class="op" id="3676240">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3676243">func</span>&nbsp;<span class="ident" id="3676248">stringEncoder</span><span class="op" id="3676261">(</span><span class="ident" id="3676262">e</span>&nbsp;<span class="op" id="3676264">*</span><span class="ident" id="3676265"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3676276">,</span>&nbsp;<span class="ident" id="3676278">v</span>&nbsp;<span class="ident" id="3676280"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3676287">.</span><span class="ident" id="3676288">Value</span><span class="op" id="3676293">,</span>&nbsp;<span class="ident" id="3676295">quoted</span>&nbsp;<span class="builtintype" id="3676302">bool</span><span class="op" id="3676306">)</span>&nbsp;<span class="op" id="3676308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3676311">if</span>&nbsp;<span class="ident" id="3676314"><a href="/encoding/json/encode.go.html#3676278">v</a></span><span class="op" id="3676315">.</span><span class="ident" id="3676316">Type</span><span class="op" id="3676320">(</span><span class="op" id="3676321">)</span>&nbsp;<span class="op" id="3676323">==</span>&nbsp;<span class="ident" id="3676326"><a href="/encoding/json/decode.go.html#3651273">numberType</a></span>&nbsp;<span class="op" id="3676337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676341">numStr</span>&nbsp;<span class="op" id="3676348">:=</span>&nbsp;<span class="ident" id="3676351"><a href="/encoding/json/encode.go.html#3676278">v</a></span><span class="op" id="3676352">.</span><span class="ident" id="3676353">String</span><span class="op" id="3676359">(</span><span class="op" id="3676360">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3676364">if</span>&nbsp;<span class="ident" id="3676367"><a href="/encoding/json/encode.go.html#3676341">numStr</a></span>&nbsp;<span class="op" id="3676374">==</span>&nbsp;<span class="string" id="3676377">&#34;&#34;</span>&nbsp;<span class="op" id="3676380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676385"><a href="/encoding/json/encode.go.html#3676341">numStr</a></span>&nbsp;<span class="op" id="3676392">=</span>&nbsp;<span class="string" id="3676394">&#34;0&#34;</span>&nbsp;<span class="comment" id="3676398">//&nbsp;Number&#39;s&nbsp;zero-val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3676421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676425"><a href="/encoding/json/encode.go.html#3676262">e</a></span><span class="op" id="3676426">.</span><span class="ident" id="3676427">WriteString</span><span class="op" id="3676438">(</span><span class="ident" id="3676439"><a href="/encoding/json/encode.go.html#3676341">numStr</a></span><span class="op" id="3676445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3676449">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3676457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3676460">if</span>&nbsp;<span class="ident" id="3676463"><a href="/encoding/json/encode.go.html#3676295">quoted</a></span>&nbsp;<span class="op" id="3676470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676474">sb</span><span class="op" id="3676476">,</span>&nbsp;<span class="ident" id="3676478">err</span>&nbsp;<span class="op" id="3676482">:=</span>&nbsp;<span class="ident" id="3676485"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="3676492">(</span><span class="ident" id="3676493"><a href="/encoding/json/encode.go.html#3676278">v</a></span><span class="op" id="3676494">.</span><span class="ident" id="3676495">String</span><span class="op" id="3676501">(</span><span class="op" id="3676502">)</span><span class="op" id="3676503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3676507">if</span>&nbsp;<span class="ident" id="3676510"><a href="/encoding/json/encode.go.html#3676478">err</a></span>&nbsp;<span class="op" id="3676514">!=</span>&nbsp;<span class="ident" id="3676517">nil</span>&nbsp;<span class="op" id="3676521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676526"><a href="/encoding/json/encode.go.html#3676262">e</a></span><span class="op" id="3676527">.</span><span class="builtintype" id="3676528">error</span><span class="op" id="3676533">(</span><span class="ident" id="3676534"><a href="/encoding/json/encode.go.html#3676478">err</a></span><span class="op" id="3676537">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3676541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676545"><a href="/encoding/json/encode.go.html#3676262">e</a></span><span class="op" id="3676546">.</span><span class="builtintype" id="3676547">string</span><span class="op" id="3676553">(</span><span class="builtintype" id="3676554">string</span><span class="op" id="3676560">(</span><span class="ident" id="3676561"><a href="/encoding/json/encode.go.html#3676474">sb</a></span><span class="op" id="3676563">)</span><span class="op" id="3676564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3676567">}</span>&nbsp;<span class="keyword" id="3676569">else</span>&nbsp;<span class="op" id="3676574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676578"><a href="/encoding/json/encode.go.html#3676262">e</a></span><span class="op" id="3676579">.</span><span class="builtintype" id="3676580">string</span><span class="op" id="3676586">(</span><span class="ident" id="3676587"><a href="/encoding/json/encode.go.html#3676278">v</a></span><span class="op" id="3676588">.</span><span class="ident" id="3676589">String</span><span class="op" id="3676595">(</span><span class="op" id="3676596">)</span><span class="op" id="3676597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3676600">}</span><br>
<span class="lineno">550</span><span class="op" id="3676602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3676605">func</span>&nbsp;<span class="ident" id="3676610">interfaceEncoder</span><span class="op" id="3676626">(</span><span class="ident" id="3676627">e</span>&nbsp;<span class="op" id="3676629">*</span><span class="ident" id="3676630"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3676641">,</span>&nbsp;<span class="ident" id="3676643">v</span>&nbsp;<span class="ident" id="3676645"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3676652">.</span><span class="ident" id="3676653">Value</span><span class="op" id="3676658">,</span>&nbsp;<span class="ident" id="3676660">quoted</span>&nbsp;<span class="builtintype" id="3676667">bool</span><span class="op" id="3676671">)</span>&nbsp;<span class="op" id="3676673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3676676">if</span>&nbsp;<span class="ident" id="3676679"><a href="/encoding/json/encode.go.html#3676643">v</a></span><span class="op" id="3676680">.</span><span class="ident" id="3676681">IsNil</span><span class="op" id="3676686">(</span><span class="op" id="3676687">)</span>&nbsp;<span class="op" id="3676689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676693"><a href="/encoding/json/encode.go.html#3676627">e</a></span><span class="op" id="3676694">.</span><span class="ident" id="3676695">WriteString</span><span class="op" id="3676706">(</span><span class="string" id="3676707">&#34;null&#34;</span><span class="op" id="3676713">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3676717">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3676725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676728"><a href="/encoding/json/encode.go.html#3676627">e</a></span><span class="op" id="3676729">.</span><span class="ident" id="3676730">reflectValue</span><span class="op" id="3676742">(</span><span class="ident" id="3676743"><a href="/encoding/json/encode.go.html#3676643">v</a></span><span class="op" id="3676744">.</span><span class="ident" id="3676745">Elem</span><span class="op" id="3676749">(</span><span class="op" id="3676750">)</span><span class="op" id="3676751">)</span><br>
<span class="lineno"></span><span class="op" id="3676753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="3676756">func</span>&nbsp;<span class="ident" id="3676761">unsupportedTypeEncoder</span><span class="op" id="3676783">(</span><span class="ident" id="3676784">e</span>&nbsp;<span class="op" id="3676786">*</span><span class="ident" id="3676787"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3676798">,</span>&nbsp;<span class="ident" id="3676800">v</span>&nbsp;<span class="ident" id="3676802"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3676809">.</span><span class="ident" id="3676810">Value</span><span class="op" id="3676815">,</span>&nbsp;<span class="ident" id="3676817">quoted</span>&nbsp;<span class="builtintype" id="3676824">bool</span><span class="op" id="3676828">)</span>&nbsp;<span class="op" id="3676830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676833"><a href="/encoding/json/encode.go.html#3676784">e</a></span><span class="op" id="3676834">.</span><span class="builtintype" id="3676835">error</span><span class="op" id="3676840">(</span><span class="op" id="3676841">&amp;</span><span class="ident" id="3676842"><a href="/encoding/json/encode.go.html#3668357">UnsupportedTypeError</a></span><span class="op" id="3676862">{</span><span class="ident" id="3676863"><a href="/encoding/json/encode.go.html#3676800">v</a></span><span class="op" id="3676864">.</span><span class="ident" id="3676865">Type</span><span class="op" id="3676869">(</span><span class="op" id="3676870">)</span><span class="op" id="3676871">}</span><span class="op" id="3676872">)</span><br>
<span class="lineno"></span><span class="op" id="3676874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3676877">type</span>&nbsp;<span class="ident" id="3676882">structEncoder</span>&nbsp;<span class="keyword" id="3676896">struct</span>&nbsp;<span class="op" id="3676903">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676906">fields</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3676916">[</span><span class="op" id="3676917">]</span><span class="ident" id="3676918"><a href="/encoding/json/encode.go.html#3685603">field</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3676925">fieldEncs</span>&nbsp;<span class="op" id="3676935">[</span><span class="op" id="3676936">]</span><span class="ident" id="3676937"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="3676949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3676952">func</span>&nbsp;<span class="op" id="3676957">(</span><span class="ident" id="3676958">se</span>&nbsp;<span class="op" id="3676961">*</span><span class="ident" id="3676962"><a href="/encoding/json/encode.go.html#3676882">structEncoder</a></span><span class="op" id="3676975">)</span>&nbsp;<span class="ident" id="3676977">encode</span><span class="op" id="3676983">(</span><span class="ident" id="3676984">e</span>&nbsp;<span class="op" id="3676986">*</span><span class="ident" id="3676987"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3676998">,</span>&nbsp;<span class="ident" id="3677000">v</span>&nbsp;<span class="ident" id="3677002"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3677009">.</span><span class="ident" id="3677010">Value</span><span class="op" id="3677015">,</span>&nbsp;<span class="ident" id="3677017">quoted</span>&nbsp;<span class="builtintype" id="3677024">bool</span><span class="op" id="3677028">)</span>&nbsp;<span class="op" id="3677030">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677033"><a href="/encoding/json/encode.go.html#3676984">e</a></span><span class="op" id="3677034">.</span><span class="ident" id="3677035">WriteByte</span><span class="op" id="3677044">(</span><span class="string" id="3677045">&#39;{&#39;</span><span class="op" id="3677048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677051">first</span>&nbsp;<span class="op" id="3677057">:=</span>&nbsp;<span class="ident" id="3677060">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677066">for</span>&nbsp;<span class="ident" id="3677070">i</span><span class="op" id="3677071">,</span>&nbsp;<span class="ident" id="3677073">f</span>&nbsp;<span class="op" id="3677075">:=</span>&nbsp;<span class="keyword" id="3677078">range</span>&nbsp;<span class="ident" id="3677084"><a href="/encoding/json/encode.go.html#3676958">se</a></span><span class="op" id="3677086">.</span><span class="ident" id="3677087">fields</span>&nbsp;<span class="op" id="3677094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677098">fv</span>&nbsp;<span class="op" id="3677101">:=</span>&nbsp;<span class="ident" id="3677104"><a href="/encoding/json/encode.go.html#3680958">fieldByIndex</a></span><span class="op" id="3677116">(</span><span class="ident" id="3677117"><a href="/encoding/json/encode.go.html#3677000">v</a></span><span class="op" id="3677118">,</span>&nbsp;<span class="ident" id="3677120"><a href="/encoding/json/encode.go.html#3677073">f</a></span><span class="op" id="3677121">.</span><span class="ident" id="3677122">index</span><span class="op" id="3677127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677131">if</span>&nbsp;<span class="op" id="3677134">!</span><span class="ident" id="3677135"><a href="/encoding/json/encode.go.html#3677098">fv</a></span><span class="op" id="3677137">.</span><span class="ident" id="3677138">IsValid</span><span class="op" id="3677145">(</span><span class="op" id="3677146">)</span>&nbsp;<span class="op" id="3677148">||</span>&nbsp;<span class="ident" id="3677151"><a href="/encoding/json/encode.go.html#3677073">f</a></span><span class="op" id="3677152">.</span><span class="ident" id="3677153">omitEmpty</span>&nbsp;<span class="op" id="3677163">&amp;&amp;</span>&nbsp;<span class="ident" id="3677166"><a href="/encoding/json/encode.go.html#3670240">isEmptyValue</a></span><span class="op" id="3677178">(</span><span class="ident" id="3677179"><a href="/encoding/json/encode.go.html#3677098">fv</a></span><span class="op" id="3677181">)</span>&nbsp;<span class="op" id="3677183">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677188">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3677199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677203">if</span>&nbsp;<span class="ident" id="3677206"><a href="/encoding/json/encode.go.html#3677051">first</a></span>&nbsp;<span class="op" id="3677212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677217"><a href="/encoding/json/encode.go.html#3677051">first</a></span>&nbsp;<span class="op" id="3677223">=</span>&nbsp;<span class="ident" id="3677225">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3677233">}</span>&nbsp;<span class="keyword" id="3677235">else</span>&nbsp;<span class="op" id="3677240">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677245"><a href="/encoding/json/encode.go.html#3676984">e</a></span><span class="op" id="3677246">.</span><span class="ident" id="3677247">WriteByte</span><span class="op" id="3677256">(</span><span class="string" id="3677257">&#39;,&#39;</span><span class="op" id="3677260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3677264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677268"><a href="/encoding/json/encode.go.html#3676984">e</a></span><span class="op" id="3677269">.</span><span class="builtintype" id="3677270">string</span><span class="op" id="3677276">(</span><span class="ident" id="3677277"><a href="/encoding/json/encode.go.html#3677073">f</a></span><span class="op" id="3677278">.</span><span class="ident" id="3677279">name</span><span class="op" id="3677283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677287"><a href="/encoding/json/encode.go.html#3676984">e</a></span><span class="op" id="3677288">.</span><span class="ident" id="3677289">WriteByte</span><span class="op" id="3677298">(</span><span class="string" id="3677299">&#39;:&#39;</span><span class="op" id="3677302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677306"><a href="/encoding/json/encode.go.html#3676958">se</a></span><span class="op" id="3677308">.</span><span class="ident" id="3677309">fieldEncs</span><span class="op" id="3677318">[</span><span class="ident" id="3677319"><a href="/encoding/json/encode.go.html#3677070">i</a></span><span class="op" id="3677320">]</span><span class="op" id="3677321">(</span><span class="ident" id="3677322"><a href="/encoding/json/encode.go.html#3676984">e</a></span><span class="op" id="3677323">,</span>&nbsp;<span class="ident" id="3677325"><a href="/encoding/json/encode.go.html#3677098">fv</a></span><span class="op" id="3677327">,</span>&nbsp;<span class="ident" id="3677329"><a href="/encoding/json/encode.go.html#3677073">f</a></span><span class="op" id="3677330">.</span><span class="ident" id="3677331">quoted</span><span class="op" id="3677337">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3677340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677343"><a href="/encoding/json/encode.go.html#3676984">e</a></span><span class="op" id="3677344">.</span><span class="ident" id="3677345">WriteByte</span><span class="op" id="3677354">(</span><span class="string" id="3677355">&#39;}&#39;</span><span class="op" id="3677358">)</span><br>
<span class="lineno"></span><span class="op" id="3677360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3677363">func</span>&nbsp;<span class="ident" id="3677368">newStructEncoder</span><span class="op" id="3677384">(</span><span class="ident" id="3677385">t</span>&nbsp;<span class="ident" id="3677387"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3677394">.</span><span class="ident" id="3677395">Type</span><span class="op" id="3677399">)</span>&nbsp;<span class="ident" id="3677401"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span>&nbsp;<span class="op" id="3677413">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677416">fields</span>&nbsp;<span class="op" id="3677423">:=</span>&nbsp;<span class="ident" id="3677426"><a href="/encoding/json/encode.go.html#3691600">cachedTypeFields</a></span><span class="op" id="3677442">(</span><span class="ident" id="3677443"><a href="/encoding/json/encode.go.html#3677385">t</a></span><span class="op" id="3677444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677447">se</span>&nbsp;<span class="op" id="3677450">:=</span>&nbsp;<span class="op" id="3677453">&amp;</span><span class="ident" id="3677454"><a href="/encoding/json/encode.go.html#3676882">structEncoder</a></span><span class="op" id="3677467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677471">fields</span><span class="op" id="3677477">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3677482"><a href="/encoding/json/encode.go.html#3677416">fields</a></span><span class="op" id="3677488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677492">fieldEncs</span><span class="op" id="3677501">:</span>&nbsp;<span class="builtinfunc" id="3677503">make</span><span class="op" id="3677507">(</span><span class="op" id="3677508">[</span><span class="op" id="3677509">]</span><span class="ident" id="3677510"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span><span class="op" id="3677521">,</span>&nbsp;<span class="builtinfunc" id="3677523">len</span><span class="op" id="3677526">(</span><span class="ident" id="3677527"><a href="/encoding/json/encode.go.html#3677416">fields</a></span><span class="op" id="3677533">)</span><span class="op" id="3677534">)</span><span class="op" id="3677535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3677538">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677541">for</span>&nbsp;<span class="ident" id="3677545">i</span><span class="op" id="3677546">,</span>&nbsp;<span class="ident" id="3677548">f</span>&nbsp;<span class="op" id="3677550">:=</span>&nbsp;<span class="keyword" id="3677553">range</span>&nbsp;<span class="ident" id="3677559"><a href="/encoding/json/encode.go.html#3677416">fields</a></span>&nbsp;<span class="op" id="3677566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677570"><a href="/encoding/json/encode.go.html#3677447">se</a></span><span class="op" id="3677572">.</span><span class="ident" id="3677573">fieldEncs</span><span class="op" id="3677582">[</span><span class="ident" id="3677583"><a href="/encoding/json/encode.go.html#3677545">i</a></span><span class="op" id="3677584">]</span>&nbsp;<span class="op" id="3677586">=</span>&nbsp;<span class="ident" id="3677588"><a href="/encoding/json/encode.go.html#3671155">typeEncoder</a></span><span class="op" id="3677599">(</span><span class="ident" id="3677600"><a href="/encoding/json/encode.go.html#3681183">typeByIndex</a></span><span class="op" id="3677611">(</span><span class="ident" id="3677612"><a href="/encoding/json/encode.go.html#3677385">t</a></span><span class="op" id="3677613">,</span>&nbsp;<span class="ident" id="3677615"><a href="/encoding/json/encode.go.html#3677548">f</a></span><span class="op" id="3677616">.</span><span class="ident" id="3677617">index</span><span class="op" id="3677622">)</span><span class="op" id="3677623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3677626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677629">return</span>&nbsp;<span class="ident" id="3677636"><a href="/encoding/json/encode.go.html#3677447">se</a></span><span class="op" id="3677638">.</span><span class="ident" id="3677639">encode</span><br>
<span class="lineno"></span><span class="op" id="3677646">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span><span class="keyword" id="3677649">type</span>&nbsp;<span class="ident" id="3677654">mapEncoder</span>&nbsp;<span class="keyword" id="3677665">struct</span>&nbsp;<span class="op" id="3677672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677675">elemEnc</span>&nbsp;<span class="ident" id="3677683"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="3677695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">605</span><span class="keyword" id="3677698">func</span>&nbsp;<span class="op" id="3677703">(</span><span class="ident" id="3677704">me</span>&nbsp;<span class="op" id="3677707">*</span><span class="ident" id="3677708"><a href="/encoding/json/encode.go.html#3677654">mapEncoder</a></span><span class="op" id="3677718">)</span>&nbsp;<span class="ident" id="3677720">encode</span><span class="op" id="3677726">(</span><span class="ident" id="3677727">e</span>&nbsp;<span class="op" id="3677729">*</span><span class="ident" id="3677730"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3677741">,</span>&nbsp;<span class="ident" id="3677743">v</span>&nbsp;<span class="ident" id="3677745"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3677752">.</span><span class="ident" id="3677753">Value</span><span class="op" id="3677758">,</span>&nbsp;<span class="ident" id="3677760">_</span>&nbsp;<span class="builtintype" id="3677762">bool</span><span class="op" id="3677766">)</span>&nbsp;<span class="op" id="3677768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677771">if</span>&nbsp;<span class="ident" id="3677774"><a href="/encoding/json/encode.go.html#3677743">v</a></span><span class="op" id="3677775">.</span><span class="ident" id="3677776">IsNil</span><span class="op" id="3677781">(</span><span class="op" id="3677782">)</span>&nbsp;<span class="op" id="3677784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677788"><a href="/encoding/json/encode.go.html#3677727">e</a></span><span class="op" id="3677789">.</span><span class="ident" id="3677790">WriteString</span><span class="op" id="3677801">(</span><span class="string" id="3677802">&#34;null&#34;</span><span class="op" id="3677808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677812">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3677820">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677823"><a href="/encoding/json/encode.go.html#3677727">e</a></span><span class="op" id="3677824">.</span><span class="ident" id="3677825">WriteByte</span><span class="op" id="3677834">(</span><span class="string" id="3677835">&#39;{&#39;</span><span class="op" id="3677838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677841">var</span>&nbsp;<span class="ident" id="3677845">sv</span>&nbsp;<span class="ident" id="3677848"><a href="/encoding/json/encode.go.html#3681482">stringValues</a></span>&nbsp;<span class="op" id="3677861">=</span>&nbsp;<span class="ident" id="3677863"><a href="/encoding/json/encode.go.html#3677743">v</a></span><span class="op" id="3677864">.</span><span class="ident" id="3677865">MapKeys</span><span class="op" id="3677872">(</span><span class="op" id="3677873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677876"><a href="/encoding/json/encode.go.html#3661714">sort</a></span><span class="op" id="3677880">.</span><span class="ident" id="3677881">Sort</span><span class="op" id="3677885">(</span><span class="ident" id="3677886"><a href="/encoding/json/encode.go.html#3677845">sv</a></span><span class="op" id="3677888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677891">for</span>&nbsp;<span class="ident" id="3677895">i</span><span class="op" id="3677896">,</span>&nbsp;<span class="ident" id="3677898">k</span>&nbsp;<span class="op" id="3677900">:=</span>&nbsp;<span class="keyword" id="3677903">range</span>&nbsp;<span class="ident" id="3677909"><a href="/encoding/json/encode.go.html#3677845">sv</a></span>&nbsp;<span class="op" id="3677912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3677916">if</span>&nbsp;<span class="ident" id="3677919"><a href="/encoding/json/encode.go.html#3677895">i</a></span>&nbsp;<span class="op" id="3677921">&gt;</span>&nbsp;<span class="num" id="3677923">0</span>&nbsp;<span class="op" id="3677925">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677930"><a href="/encoding/json/encode.go.html#3677727">e</a></span><span class="op" id="3677931">.</span><span class="ident" id="3677932">WriteByte</span><span class="op" id="3677941">(</span><span class="string" id="3677942">&#39;,&#39;</span><span class="op" id="3677945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3677949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677953"><a href="/encoding/json/encode.go.html#3677727">e</a></span><span class="op" id="3677954">.</span><span class="builtintype" id="3677955">string</span><span class="op" id="3677961">(</span><span class="ident" id="3677962"><a href="/encoding/json/encode.go.html#3677898">k</a></span><span class="op" id="3677963">.</span><span class="ident" id="3677964">String</span><span class="op" id="3677970">(</span><span class="op" id="3677971">)</span><span class="op" id="3677972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677976"><a href="/encoding/json/encode.go.html#3677727">e</a></span><span class="op" id="3677977">.</span><span class="ident" id="3677978">WriteByte</span><span class="op" id="3677987">(</span><span class="string" id="3677988">&#39;:&#39;</span><span class="op" id="3677991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3677995"><a href="/encoding/json/encode.go.html#3677704">me</a></span><span class="op" id="3677997">.</span><span class="ident" id="3677998">elemEnc</span><span class="op" id="3678005">(</span><span class="ident" id="3678006"><a href="/encoding/json/encode.go.html#3677727">e</a></span><span class="op" id="3678007">,</span>&nbsp;<span class="ident" id="3678009"><a href="/encoding/json/encode.go.html#3677743">v</a></span><span class="op" id="3678010">.</span><span class="ident" id="3678011">MapIndex</span><span class="op" id="3678019">(</span><span class="ident" id="3678020"><a href="/encoding/json/encode.go.html#3677898">k</a></span><span class="op" id="3678021">)</span><span class="op" id="3678022">,</span>&nbsp;<span class="ident" id="3678024">false</span><span class="op" id="3678029">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3678032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678035"><a href="/encoding/json/encode.go.html#3677727">e</a></span><span class="op" id="3678036">.</span><span class="ident" id="3678037">WriteByte</span><span class="op" id="3678046">(</span><span class="string" id="3678047">&#39;}&#39;</span><span class="op" id="3678050">)</span><br>
<span class="lineno"></span><span class="op" id="3678052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3678055">func</span>&nbsp;<span class="ident" id="3678060">newMapEncoder</span><span class="op" id="3678073">(</span><span class="ident" id="3678074">t</span>&nbsp;<span class="ident" id="3678076"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3678083">.</span><span class="ident" id="3678084">Type</span><span class="op" id="3678088">)</span>&nbsp;<span class="ident" id="3678090"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span>&nbsp;<span class="op" id="3678102">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3678105">if</span>&nbsp;<span class="ident" id="3678108"><a href="/encoding/json/encode.go.html#3678074">t</a></span><span class="op" id="3678109">.</span><span class="ident" id="3678110">Key</span><span class="op" id="3678113">(</span><span class="op" id="3678114">)</span><span class="op" id="3678115">.</span><span class="ident" id="3678116">Kind</span><span class="op" id="3678120">(</span><span class="op" id="3678121">)</span>&nbsp;<span class="op" id="3678123">!=</span>&nbsp;<span class="ident" id="3678126"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3678133">.</span><span class="ident" id="3678134">String</span>&nbsp;<span class="op" id="3678141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3678145">return</span>&nbsp;<span class="ident" id="3678152"><a href="/encoding/json/encode.go.html#3676761">unsupportedTypeEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3678176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678179">me</span>&nbsp;<span class="op" id="3678182">:=</span>&nbsp;<span class="op" id="3678185">&amp;</span><span class="ident" id="3678186"><a href="/encoding/json/encode.go.html#3677654">mapEncoder</a></span><span class="op" id="3678196">{</span><span class="ident" id="3678197"><a href="/encoding/json/encode.go.html#3671155">typeEncoder</a></span><span class="op" id="3678208">(</span><span class="ident" id="3678209"><a href="/encoding/json/encode.go.html#3678074">t</a></span><span class="op" id="3678210">.</span><span class="ident" id="3678211">Elem</span><span class="op" id="3678215">(</span><span class="op" id="3678216">)</span><span class="op" id="3678217">)</span><span class="op" id="3678218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3678221">return</span>&nbsp;<span class="ident" id="3678228"><a href="/encoding/json/encode.go.html#3678179">me</a></span><span class="op" id="3678230">.</span><span class="ident" id="3678231">encode</span><br>
<span class="lineno">630</span><span class="op" id="3678238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3678241">func</span>&nbsp;<span class="ident" id="3678246">encodeByteSlice</span><span class="op" id="3678261">(</span><span class="ident" id="3678262">e</span>&nbsp;<span class="op" id="3678264">*</span><span class="ident" id="3678265"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3678276">,</span>&nbsp;<span class="ident" id="3678278">v</span>&nbsp;<span class="ident" id="3678280"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3678287">.</span><span class="ident" id="3678288">Value</span><span class="op" id="3678293">,</span>&nbsp;<span class="ident" id="3678295">_</span>&nbsp;<span class="builtintype" id="3678297">bool</span><span class="op" id="3678301">)</span>&nbsp;<span class="op" id="3678303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3678306">if</span>&nbsp;<span class="ident" id="3678309"><a href="/encoding/json/encode.go.html#3678278">v</a></span><span class="op" id="3678310">.</span><span class="ident" id="3678311">IsNil</span><span class="op" id="3678316">(</span><span class="op" id="3678317">)</span>&nbsp;<span class="op" id="3678319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678323"><a href="/encoding/json/encode.go.html#3678262">e</a></span><span class="op" id="3678324">.</span><span class="ident" id="3678325">WriteString</span><span class="op" id="3678336">(</span><span class="string" id="3678337">&#34;null&#34;</span><span class="op" id="3678343">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3678347">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3678355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678358">s</span>&nbsp;<span class="op" id="3678360">:=</span>&nbsp;<span class="ident" id="3678363"><a href="/encoding/json/encode.go.html#3678278">v</a></span><span class="op" id="3678364">.</span><span class="ident" id="3678365">Bytes</span><span class="op" id="3678370">(</span><span class="op" id="3678371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678374"><a href="/encoding/json/encode.go.html#3678262">e</a></span><span class="op" id="3678375">.</span><span class="ident" id="3678376">WriteByte</span><span class="op" id="3678385">(</span><span class="string" id="3678386">&#39;&#34;&#39;</span><span class="op" id="3678389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3678392">if</span>&nbsp;<span class="builtinfunc" id="3678395">len</span><span class="op" id="3678398">(</span><span class="ident" id="3678399"><a href="/encoding/json/encode.go.html#3678358">s</a></span><span class="op" id="3678400">)</span>&nbsp;<span class="op" id="3678402">&lt;</span>&nbsp;<span class="num" id="3678404">1024</span>&nbsp;<span class="op" id="3678409">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3678413">//&nbsp;for&nbsp;small&nbsp;buffers,&nbsp;using&nbsp;Encode&nbsp;directly&nbsp;is&nbsp;much&nbsp;faster.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678475">dst</span>&nbsp;<span class="op" id="3678479">:=</span>&nbsp;<span class="builtinfunc" id="3678482">make</span><span class="op" id="3678486">(</span><span class="op" id="3678487">[</span><span class="op" id="3678488">]</span><span class="builtintype" id="3678489">byte</span><span class="op" id="3678493">,</span>&nbsp;<span class="ident" id="3678495"><a href="/encoding/json/encode.go.html#3661665">base64</a></span><span class="op" id="3678501">.</span><span class="ident" id="3678502">StdEncoding</span><span class="op" id="3678513">.</span><span class="ident" id="3678514">EncodedLen</span><span class="op" id="3678524">(</span><span class="builtinfunc" id="3678525">len</span><span class="op" id="3678528">(</span><span class="ident" id="3678529"><a href="/encoding/json/encode.go.html#3678358">s</a></span><span class="op" id="3678530">)</span><span class="op" id="3678531">)</span><span class="op" id="3678532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678536"><a href="/encoding/json/encode.go.html#3661665">base64</a></span><span class="op" id="3678542">.</span><span class="ident" id="3678543">StdEncoding</span><span class="op" id="3678554">.</span><span class="ident" id="3678555">Encode</span><span class="op" id="3678561">(</span><span class="ident" id="3678562"><a href="/encoding/json/encode.go.html#3678475">dst</a></span><span class="op" id="3678565">,</span>&nbsp;<span class="ident" id="3678567"><a href="/encoding/json/encode.go.html#3678358">s</a></span><span class="op" id="3678568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678572"><a href="/encoding/json/encode.go.html#3678262">e</a></span><span class="op" id="3678573">.</span><span class="ident" id="3678574">Write</span><span class="op" id="3678579">(</span><span class="ident" id="3678580"><a href="/encoding/json/encode.go.html#3678475">dst</a></span><span class="op" id="3678583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3678586">}</span>&nbsp;<span class="keyword" id="3678588">else</span>&nbsp;<span class="op" id="3678593">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3678597">//&nbsp;for&nbsp;large&nbsp;buffers,&nbsp;avoid&nbsp;unnecessary&nbsp;extra&nbsp;temporary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3678655">//&nbsp;buffer&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678674">enc</span>&nbsp;<span class="op" id="3678678">:=</span>&nbsp;<span class="ident" id="3678681"><a href="/encoding/json/encode.go.html#3661665">base64</a></span><span class="op" id="3678687">.</span><span class="ident" id="3678688">NewEncoder</span><span class="op" id="3678698">(</span><span class="ident" id="3678699"><a href="/encoding/json/encode.go.html#3661665">base64</a></span><span class="op" id="3678705">.</span><span class="ident" id="3678706">StdEncoding</span><span class="op" id="3678717">,</span>&nbsp;<span class="ident" id="3678719"><a href="/encoding/json/encode.go.html#3678262">e</a></span><span class="op" id="3678720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678724"><a href="/encoding/json/encode.go.html#3678674">enc</a></span><span class="op" id="3678727">.</span><span class="ident" id="3678728">Write</span><span class="op" id="3678733">(</span><span class="ident" id="3678734"><a href="/encoding/json/encode.go.html#3678358">s</a></span><span class="op" id="3678735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678739"><a href="/encoding/json/encode.go.html#3678674">enc</a></span><span class="op" id="3678742">.</span><span class="ident" id="3678743">Close</span><span class="op" id="3678748">(</span><span class="op" id="3678749">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3678752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678755"><a href="/encoding/json/encode.go.html#3678262">e</a></span><span class="op" id="3678756">.</span><span class="ident" id="3678757">WriteByte</span><span class="op" id="3678766">(</span><span class="string" id="3678767">&#39;&#34;&#39;</span><span class="op" id="3678770">)</span><br>
<span class="lineno"></span><span class="op" id="3678772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3678775">//&nbsp;sliceEncoder&nbsp;just&nbsp;wraps&nbsp;an&nbsp;arrayEncoder,&nbsp;checking&nbsp;to&nbsp;make&nbsp;sure&nbsp;the&nbsp;value&nbsp;isn&#39;t&nbsp;nil.</span><br>
<span class="lineno">655</span><span class="keyword" id="3678862">type</span>&nbsp;<span class="ident" id="3678867">sliceEncoder</span>&nbsp;<span class="keyword" id="3678880">struct</span>&nbsp;<span class="op" id="3678887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3678890">arrayEnc</span>&nbsp;<span class="ident" id="3678899"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="3678911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3678914">func</span>&nbsp;<span class="op" id="3678919">(</span><span class="ident" id="3678920">se</span>&nbsp;<span class="op" id="3678923">*</span><span class="ident" id="3678924"><a href="/encoding/json/encode.go.html#3678867">sliceEncoder</a></span><span class="op" id="3678936">)</span>&nbsp;<span class="ident" id="3678938">encode</span><span class="op" id="3678944">(</span><span class="ident" id="3678945">e</span>&nbsp;<span class="op" id="3678947">*</span><span class="ident" id="3678948"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3678959">,</span>&nbsp;<span class="ident" id="3678961">v</span>&nbsp;<span class="ident" id="3678963"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3678970">.</span><span class="ident" id="3678971">Value</span><span class="op" id="3678976">,</span>&nbsp;<span class="ident" id="3678978">_</span>&nbsp;<span class="builtintype" id="3678980">bool</span><span class="op" id="3678984">)</span>&nbsp;<span class="op" id="3678986">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3678989">if</span>&nbsp;<span class="ident" id="3678992"><a href="/encoding/json/encode.go.html#3678961">v</a></span><span class="op" id="3678993">.</span><span class="ident" id="3678994">IsNil</span><span class="op" id="3678999">(</span><span class="op" id="3679000">)</span>&nbsp;<span class="op" id="3679002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679006"><a href="/encoding/json/encode.go.html#3678945">e</a></span><span class="op" id="3679007">.</span><span class="ident" id="3679008">WriteString</span><span class="op" id="3679019">(</span><span class="string" id="3679020">&#34;null&#34;</span><span class="op" id="3679026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3679030">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3679038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679041"><a href="/encoding/json/encode.go.html#3678920">se</a></span><span class="op" id="3679043">.</span><span class="ident" id="3679044">arrayEnc</span><span class="op" id="3679052">(</span><span class="ident" id="3679053"><a href="/encoding/json/encode.go.html#3678945">e</a></span><span class="op" id="3679054">,</span>&nbsp;<span class="ident" id="3679056"><a href="/encoding/json/encode.go.html#3678961">v</a></span><span class="op" id="3679057">,</span>&nbsp;<span class="ident" id="3679059">false</span><span class="op" id="3679064">)</span><br>
<span class="lineno">665</span><span class="op" id="3679066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3679069">func</span>&nbsp;<span class="ident" id="3679074">newSliceEncoder</span><span class="op" id="3679089">(</span><span class="ident" id="3679090">t</span>&nbsp;<span class="ident" id="3679092"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3679099">.</span><span class="ident" id="3679100">Type</span><span class="op" id="3679104">)</span>&nbsp;<span class="ident" id="3679106"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span>&nbsp;<span class="op" id="3679118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3679121">//&nbsp;Byte&nbsp;slices&nbsp;get&nbsp;special&nbsp;treatment;&nbsp;arrays&nbsp;don&#39;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3679174">if</span>&nbsp;<span class="ident" id="3679177"><a href="/encoding/json/encode.go.html#3679090">t</a></span><span class="op" id="3679178">.</span><span class="ident" id="3679179">Elem</span><span class="op" id="3679183">(</span><span class="op" id="3679184">)</span><span class="op" id="3679185">.</span><span class="ident" id="3679186">Kind</span><span class="op" id="3679190">(</span><span class="op" id="3679191">)</span>&nbsp;<span class="op" id="3679193">==</span>&nbsp;<span class="ident" id="3679196"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3679203">.</span><span class="ident" id="3679204">Uint8</span>&nbsp;<span class="op" id="3679210">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3679214">return</span>&nbsp;<span class="ident" id="3679221"><a href="/encoding/json/encode.go.html#3678246">encodeByteSlice</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3679238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679241">enc</span>&nbsp;<span class="op" id="3679245">:=</span>&nbsp;<span class="op" id="3679248">&amp;</span><span class="ident" id="3679249"><a href="/encoding/json/encode.go.html#3678867">sliceEncoder</a></span><span class="op" id="3679261">{</span><span class="ident" id="3679262"><a href="/encoding/json/encode.go.html#3679588">newArrayEncoder</a></span><span class="op" id="3679277">(</span><span class="ident" id="3679278"><a href="/encoding/json/encode.go.html#3679090">t</a></span><span class="op" id="3679279">)</span><span class="op" id="3679280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3679283">return</span>&nbsp;<span class="ident" id="3679290"><a href="/encoding/json/encode.go.html#3679241">enc</a></span><span class="op" id="3679293">.</span><span class="ident" id="3679294">encode</span><br>
<span class="lineno"></span><span class="op" id="3679301">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="keyword" id="3679304">type</span>&nbsp;<span class="ident" id="3679309">arrayEncoder</span>&nbsp;<span class="keyword" id="3679322">struct</span>&nbsp;<span class="op" id="3679329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679332">elemEnc</span>&nbsp;<span class="ident" id="3679340"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="3679352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span><span class="keyword" id="3679355">func</span>&nbsp;<span class="op" id="3679360">(</span><span class="ident" id="3679361">ae</span>&nbsp;<span class="op" id="3679364">*</span><span class="ident" id="3679365"><a href="/encoding/json/encode.go.html#3679309">arrayEncoder</a></span><span class="op" id="3679377">)</span>&nbsp;<span class="ident" id="3679379">encode</span><span class="op" id="3679385">(</span><span class="ident" id="3679386">e</span>&nbsp;<span class="op" id="3679388">*</span><span class="ident" id="3679389"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3679400">,</span>&nbsp;<span class="ident" id="3679402">v</span>&nbsp;<span class="ident" id="3679404"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3679411">.</span><span class="ident" id="3679412">Value</span><span class="op" id="3679417">,</span>&nbsp;<span class="ident" id="3679419">_</span>&nbsp;<span class="builtintype" id="3679421">bool</span><span class="op" id="3679425">)</span>&nbsp;<span class="op" id="3679427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679430"><a href="/encoding/json/encode.go.html#3679386">e</a></span><span class="op" id="3679431">.</span><span class="ident" id="3679432">WriteByte</span><span class="op" id="3679441">(</span><span class="string" id="3679442">&#39;[&#39;</span><span class="op" id="3679445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679448">n</span>&nbsp;<span class="op" id="3679450">:=</span>&nbsp;<span class="ident" id="3679453"><a href="/encoding/json/encode.go.html#3679402">v</a></span><span class="op" id="3679454">.</span><span class="ident" id="3679455">Len</span><span class="op" id="3679458">(</span><span class="op" id="3679459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3679462">for</span>&nbsp;<span class="ident" id="3679466">i</span>&nbsp;<span class="op" id="3679468">:=</span>&nbsp;<span class="num" id="3679471">0</span><span class="op" id="3679472">;</span>&nbsp;<span class="ident" id="3679474"><a href="/encoding/json/encode.go.html#3679466">i</a></span>&nbsp;<span class="op" id="3679476">&lt;</span>&nbsp;<span class="ident" id="3679478"><a href="/encoding/json/encode.go.html#3679448">n</a></span><span class="op" id="3679479">;</span>&nbsp;<span class="ident" id="3679481"><a href="/encoding/json/encode.go.html#3679466">i</a></span><span class="op" id="3679482">++</span>&nbsp;<span class="op" id="3679485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3679489">if</span>&nbsp;<span class="ident" id="3679492"><a href="/encoding/json/encode.go.html#3679466">i</a></span>&nbsp;<span class="op" id="3679494">&gt;</span>&nbsp;<span class="num" id="3679496">0</span>&nbsp;<span class="op" id="3679498">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679503"><a href="/encoding/json/encode.go.html#3679386">e</a></span><span class="op" id="3679504">.</span><span class="ident" id="3679505">WriteByte</span><span class="op" id="3679514">(</span><span class="string" id="3679515">&#39;,&#39;</span><span class="op" id="3679518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3679522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679526"><a href="/encoding/json/encode.go.html#3679361">ae</a></span><span class="op" id="3679528">.</span><span class="ident" id="3679529">elemEnc</span><span class="op" id="3679536">(</span><span class="ident" id="3679537"><a href="/encoding/json/encode.go.html#3679386">e</a></span><span class="op" id="3679538">,</span>&nbsp;<span class="ident" id="3679540"><a href="/encoding/json/encode.go.html#3679402">v</a></span><span class="op" id="3679541">.</span><span class="ident" id="3679542">Index</span><span class="op" id="3679547">(</span><span class="ident" id="3679548"><a href="/encoding/json/encode.go.html#3679466">i</a></span><span class="op" id="3679549">)</span><span class="op" id="3679550">,</span>&nbsp;<span class="ident" id="3679552">false</span><span class="op" id="3679557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3679560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679563"><a href="/encoding/json/encode.go.html#3679386">e</a></span><span class="op" id="3679564">.</span><span class="ident" id="3679565">WriteByte</span><span class="op" id="3679574">(</span><span class="string" id="3679575">&#39;]&#39;</span><span class="op" id="3679578">)</span><br>
<span class="lineno">690</span><span class="op" id="3679580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3679583">func</span>&nbsp;<span class="ident" id="3679588">newArrayEncoder</span><span class="op" id="3679603">(</span><span class="ident" id="3679604">t</span>&nbsp;<span class="ident" id="3679606"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3679613">.</span><span class="ident" id="3679614">Type</span><span class="op" id="3679618">)</span>&nbsp;<span class="ident" id="3679620"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span>&nbsp;<span class="op" id="3679632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679635">enc</span>&nbsp;<span class="op" id="3679639">:=</span>&nbsp;<span class="op" id="3679642">&amp;</span><span class="ident" id="3679643"><a href="/encoding/json/encode.go.html#3679309">arrayEncoder</a></span><span class="op" id="3679655">{</span><span class="ident" id="3679656"><a href="/encoding/json/encode.go.html#3671155">typeEncoder</a></span><span class="op" id="3679667">(</span><span class="ident" id="3679668"><a href="/encoding/json/encode.go.html#3679604">t</a></span><span class="op" id="3679669">.</span><span class="ident" id="3679670">Elem</span><span class="op" id="3679674">(</span><span class="op" id="3679675">)</span><span class="op" id="3679676">)</span><span class="op" id="3679677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3679680">return</span>&nbsp;<span class="ident" id="3679687"><a href="/encoding/json/encode.go.html#3679635">enc</a></span><span class="op" id="3679690">.</span><span class="ident" id="3679691">encode</span><br>
<span class="lineno">695</span><span class="op" id="3679698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3679701">type</span>&nbsp;<span class="ident" id="3679706">ptrEncoder</span>&nbsp;<span class="keyword" id="3679717">struct</span>&nbsp;<span class="op" id="3679724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679727">elemEnc</span>&nbsp;<span class="ident" id="3679735"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="3679747">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="3679750">func</span>&nbsp;<span class="op" id="3679755">(</span><span class="ident" id="3679756">pe</span>&nbsp;<span class="op" id="3679759">*</span><span class="ident" id="3679760"><a href="/encoding/json/encode.go.html#3679706">ptrEncoder</a></span><span class="op" id="3679770">)</span>&nbsp;<span class="ident" id="3679772">encode</span><span class="op" id="3679778">(</span><span class="ident" id="3679779">e</span>&nbsp;<span class="op" id="3679781">*</span><span class="ident" id="3679782"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3679793">,</span>&nbsp;<span class="ident" id="3679795">v</span>&nbsp;<span class="ident" id="3679797"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3679804">.</span><span class="ident" id="3679805">Value</span><span class="op" id="3679810">,</span>&nbsp;<span class="ident" id="3679812">quoted</span>&nbsp;<span class="builtintype" id="3679819">bool</span><span class="op" id="3679823">)</span>&nbsp;<span class="op" id="3679825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3679828">if</span>&nbsp;<span class="ident" id="3679831"><a href="/encoding/json/encode.go.html#3679795">v</a></span><span class="op" id="3679832">.</span><span class="ident" id="3679833">IsNil</span><span class="op" id="3679838">(</span><span class="op" id="3679839">)</span>&nbsp;<span class="op" id="3679841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679845"><a href="/encoding/json/encode.go.html#3679779">e</a></span><span class="op" id="3679846">.</span><span class="ident" id="3679847">WriteString</span><span class="op" id="3679858">(</span><span class="string" id="3679859">&#34;null&#34;</span><span class="op" id="3679865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3679869">return</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3679877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679880"><a href="/encoding/json/encode.go.html#3679756">pe</a></span><span class="op" id="3679882">.</span><span class="ident" id="3679883">elemEnc</span><span class="op" id="3679890">(</span><span class="ident" id="3679891"><a href="/encoding/json/encode.go.html#3679779">e</a></span><span class="op" id="3679892">,</span>&nbsp;<span class="ident" id="3679894"><a href="/encoding/json/encode.go.html#3679795">v</a></span><span class="op" id="3679895">.</span><span class="ident" id="3679896">Elem</span><span class="op" id="3679900">(</span><span class="op" id="3679901">)</span><span class="op" id="3679902">,</span>&nbsp;<span class="ident" id="3679904"><a href="/encoding/json/encode.go.html#3679812">quoted</a></span><span class="op" id="3679910">)</span><br>
<span class="lineno"></span><span class="op" id="3679912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3679915">func</span>&nbsp;<span class="ident" id="3679920">newPtrEncoder</span><span class="op" id="3679933">(</span><span class="ident" id="3679934">t</span>&nbsp;<span class="ident" id="3679936"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3679943">.</span><span class="ident" id="3679944">Type</span><span class="op" id="3679948">)</span>&nbsp;<span class="ident" id="3679950"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span>&nbsp;<span class="op" id="3679962">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3679965">enc</span>&nbsp;<span class="op" id="3679969">:=</span>&nbsp;<span class="op" id="3679972">&amp;</span><span class="ident" id="3679973"><a href="/encoding/json/encode.go.html#3679706">ptrEncoder</a></span><span class="op" id="3679983">{</span><span class="ident" id="3679984"><a href="/encoding/json/encode.go.html#3671155">typeEncoder</a></span><span class="op" id="3679995">(</span><span class="ident" id="3679996"><a href="/encoding/json/encode.go.html#3679934">t</a></span><span class="op" id="3679997">.</span><span class="ident" id="3679998">Elem</span><span class="op" id="3680002">(</span><span class="op" id="3680003">)</span><span class="op" id="3680004">)</span><span class="op" id="3680005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680008">return</span>&nbsp;<span class="ident" id="3680015"><a href="/encoding/json/encode.go.html#3679965">enc</a></span><span class="op" id="3680018">.</span><span class="ident" id="3680019">encode</span><br>
<span class="lineno"></span><span class="op" id="3680026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3680029">type</span>&nbsp;<span class="ident" id="3680034">condAddrEncoder</span>&nbsp;<span class="keyword" id="3680050">struct</span>&nbsp;<span class="op" id="3680057">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3680060">canAddrEnc</span><span class="op" id="3680070">,</span>&nbsp;<span class="ident" id="3680072">elseEnc</span>&nbsp;<span class="ident" id="3680080"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="3680092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3680095">func</span>&nbsp;<span class="op" id="3680100">(</span><span class="ident" id="3680101">ce</span>&nbsp;<span class="op" id="3680104">*</span><span class="ident" id="3680105"><a href="/encoding/json/encode.go.html#3680034">condAddrEncoder</a></span><span class="op" id="3680120">)</span>&nbsp;<span class="ident" id="3680122">encode</span><span class="op" id="3680128">(</span><span class="ident" id="3680129">e</span>&nbsp;<span class="op" id="3680131">*</span><span class="ident" id="3680132"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3680143">,</span>&nbsp;<span class="ident" id="3680145">v</span>&nbsp;<span class="ident" id="3680147"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3680154">.</span><span class="ident" id="3680155">Value</span><span class="op" id="3680160">,</span>&nbsp;<span class="ident" id="3680162">quoted</span>&nbsp;<span class="builtintype" id="3680169">bool</span><span class="op" id="3680173">)</span>&nbsp;<span class="op" id="3680175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680178">if</span>&nbsp;<span class="ident" id="3680181"><a href="/encoding/json/encode.go.html#3680145">v</a></span><span class="op" id="3680182">.</span><span class="ident" id="3680183">CanAddr</span><span class="op" id="3680190">(</span><span class="op" id="3680191">)</span>&nbsp;<span class="op" id="3680193">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3680197"><a href="/encoding/json/encode.go.html#3680101">ce</a></span><span class="op" id="3680199">.</span><span class="ident" id="3680200">canAddrEnc</span><span class="op" id="3680210">(</span><span class="ident" id="3680211"><a href="/encoding/json/encode.go.html#3680129">e</a></span><span class="op" id="3680212">,</span>&nbsp;<span class="ident" id="3680214"><a href="/encoding/json/encode.go.html#3680145">v</a></span><span class="op" id="3680215">,</span>&nbsp;<span class="ident" id="3680217"><a href="/encoding/json/encode.go.html#3680162">quoted</a></span><span class="op" id="3680223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3680226">}</span>&nbsp;<span class="keyword" id="3680228">else</span>&nbsp;<span class="op" id="3680233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3680237"><a href="/encoding/json/encode.go.html#3680101">ce</a></span><span class="op" id="3680239">.</span><span class="ident" id="3680240">elseEnc</span><span class="op" id="3680247">(</span><span class="ident" id="3680248"><a href="/encoding/json/encode.go.html#3680129">e</a></span><span class="op" id="3680249">,</span>&nbsp;<span class="ident" id="3680251"><a href="/encoding/json/encode.go.html#3680145">v</a></span><span class="op" id="3680252">,</span>&nbsp;<span class="ident" id="3680254"><a href="/encoding/json/encode.go.html#3680162">quoted</a></span><span class="op" id="3680260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3680263">}</span><br>
<span class="lineno"></span><span class="op" id="3680265">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span><span class="comment" id="3680268">//&nbsp;newCondAddrEncoder&nbsp;returns&nbsp;an&nbsp;encoder&nbsp;that&nbsp;checks&nbsp;whether&nbsp;its&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3680339">//&nbsp;CanAddr&nbsp;and&nbsp;delegates&nbsp;to&nbsp;canAddrEnc&nbsp;if&nbsp;so,&nbsp;else&nbsp;to&nbsp;elseEnc.</span><br>
<span class="lineno"></span><span class="keyword" id="3680402">func</span>&nbsp;<span class="ident" id="3680407">newCondAddrEncoder</span><span class="op" id="3680425">(</span><span class="ident" id="3680426">canAddrEnc</span><span class="op" id="3680436">,</span>&nbsp;<span class="ident" id="3680438">elseEnc</span>&nbsp;<span class="ident" id="3680446"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span><span class="op" id="3680457">)</span>&nbsp;<span class="ident" id="3680459"><a href="/encoding/json/encode.go.html#3670878">encoderFunc</a></span>&nbsp;<span class="op" id="3680471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3680474">enc</span>&nbsp;<span class="op" id="3680478">:=</span>&nbsp;<span class="op" id="3680481">&amp;</span><span class="ident" id="3680482"><a href="/encoding/json/encode.go.html#3680034">condAddrEncoder</a></span><span class="op" id="3680497">{</span><span class="ident" id="3680498">canAddrEnc</span><span class="op" id="3680508">:</span>&nbsp;<span class="ident" id="3680510"><a href="/encoding/json/encode.go.html#3680426">canAddrEnc</a></span><span class="op" id="3680520">,</span>&nbsp;<span class="ident" id="3680522">elseEnc</span><span class="op" id="3680529">:</span>&nbsp;<span class="ident" id="3680531"><a href="/encoding/json/encode.go.html#3680438">elseEnc</a></span><span class="op" id="3680538">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680541">return</span>&nbsp;<span class="ident" id="3680548"><a href="/encoding/json/encode.go.html#3680474">enc</a></span><span class="op" id="3680551">.</span><span class="ident" id="3680552">encode</span><br>
<span class="lineno"></span><span class="op" id="3680559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3680562">func</span>&nbsp;<span class="ident" id="3680567">isValidTag</span><span class="op" id="3680577">(</span><span class="ident" id="3680578">s</span>&nbsp;<span class="builtintype" id="3680580">string</span><span class="op" id="3680586">)</span>&nbsp;<span class="builtintype" id="3680588">bool</span>&nbsp;<span class="op" id="3680593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680596">if</span>&nbsp;<span class="ident" id="3680599"><a href="/encoding/json/encode.go.html#3680578">s</a></span>&nbsp;<span class="op" id="3680601">==</span>&nbsp;<span class="string" id="3680604">&#34;&#34;</span>&nbsp;<span class="op" id="3680607">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680611">return</span>&nbsp;<span class="ident" id="3680618">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3680625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680628">for</span>&nbsp;<span class="ident" id="3680632">_</span><span class="op" id="3680633">,</span>&nbsp;<span class="ident" id="3680635">c</span>&nbsp;<span class="op" id="3680637">:=</span>&nbsp;<span class="keyword" id="3680640">range</span>&nbsp;<span class="ident" id="3680646"><a href="/encoding/json/encode.go.html#3680578">s</a></span>&nbsp;<span class="op" id="3680648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680652">switch</span>&nbsp;<span class="op" id="3680659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680663">case</span>&nbsp;<span class="ident" id="3680668"><a href="/encoding/json/encode.go.html#3661733">strings</a></span><span class="op" id="3680675">.</span><span class="ident" id="3680676">ContainsRune</span><span class="op" id="3680688">(</span><span class="string" id="3680689">&#34;!#$%&amp;()*+-./:&lt;=&gt;?@[]^_{|}~&nbsp;&#34;</span><span class="op" id="3680718">,</span>&nbsp;<span class="ident" id="3680720"><a href="/encoding/json/encode.go.html#3680635">c</a></span><span class="op" id="3680721">)</span><span class="op" id="3680722">:</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3680727">//&nbsp;Backslash&nbsp;and&nbsp;quote&nbsp;chars&nbsp;are&nbsp;reserved,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3680777">//&nbsp;otherwise&nbsp;any&nbsp;punctuation&nbsp;chars&nbsp;are&nbsp;allowed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3680827">//&nbsp;in&nbsp;a&nbsp;tag&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680847">default</span><span class="op" id="3680854">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680859">if</span>&nbsp;<span class="op" id="3680862">!</span><span class="ident" id="3680863"><a href="/encoding/json/encode.go.html#3661752">unicode</a></span><span class="op" id="3680870">.</span><span class="ident" id="3680871">IsLetter</span><span class="op" id="3680879">(</span><span class="ident" id="3680880"><a href="/encoding/json/encode.go.html#3680635">c</a></span><span class="op" id="3680881">)</span>&nbsp;<span class="op" id="3680883">&amp;&amp;</span>&nbsp;<span class="op" id="3680886">!</span><span class="ident" id="3680887"><a href="/encoding/json/encode.go.html#3661752">unicode</a></span><span class="op" id="3680894">.</span><span class="ident" id="3680895">IsDigit</span><span class="op" id="3680902">(</span><span class="ident" id="3680903"><a href="/encoding/json/encode.go.html#3680635">c</a></span><span class="op" id="3680904">)</span>&nbsp;<span class="op" id="3680906">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680912">return</span>&nbsp;<span class="ident" id="3680919">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3680928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3680932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3680935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3680938">return</span>&nbsp;<span class="ident" id="3680945">true</span><br>
<span class="lineno">750</span><span class="op" id="3680950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3680953">func</span>&nbsp;<span class="ident" id="3680958">fieldByIndex</span><span class="op" id="3680970">(</span><span class="ident" id="3680971">v</span>&nbsp;<span class="ident" id="3680973"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3680980">.</span><span class="ident" id="3680981">Value</span><span class="op" id="3680986">,</span>&nbsp;<span class="ident" id="3680988">index</span>&nbsp;<span class="op" id="3680994">[</span><span class="op" id="3680995">]</span><span class="builtintype" id="3680996">int</span><span class="op" id="3680999">)</span>&nbsp;<span class="ident" id="3681001"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3681008">.</span><span class="ident" id="3681009">Value</span>&nbsp;<span class="op" id="3681015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3681018">for</span>&nbsp;<span class="ident" id="3681022">_</span><span class="op" id="3681023">,</span>&nbsp;<span class="ident" id="3681025">i</span>&nbsp;<span class="op" id="3681027">:=</span>&nbsp;<span class="keyword" id="3681030">range</span>&nbsp;<span class="ident" id="3681036"><a href="/encoding/json/encode.go.html#3680988">index</a></span>&nbsp;<span class="op" id="3681042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3681046">if</span>&nbsp;<span class="ident" id="3681049"><a href="/encoding/json/encode.go.html#3680971">v</a></span><span class="op" id="3681050">.</span><span class="ident" id="3681051">Kind</span><span class="op" id="3681055">(</span><span class="op" id="3681056">)</span>&nbsp;<span class="op" id="3681058">==</span>&nbsp;<span class="ident" id="3681061"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3681068">.</span><span class="ident" id="3681069">Ptr</span>&nbsp;<span class="op" id="3681073">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3681078">if</span>&nbsp;<span class="ident" id="3681081"><a href="/encoding/json/encode.go.html#3680971">v</a></span><span class="op" id="3681082">.</span><span class="ident" id="3681083">IsNil</span><span class="op" id="3681088">(</span><span class="op" id="3681089">)</span>&nbsp;<span class="op" id="3681091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3681097">return</span>&nbsp;<span class="ident" id="3681104"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3681111">.</span><span class="ident" id="3681112">Value</span><span class="op" id="3681117">{</span><span class="op" id="3681118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3681123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3681128"><a href="/encoding/json/encode.go.html#3680971">v</a></span>&nbsp;<span class="op" id="3681130">=</span>&nbsp;<span class="ident" id="3681132"><a href="/encoding/json/encode.go.html#3680971">v</a></span><span class="op" id="3681133">.</span><span class="ident" id="3681134">Elem</span><span class="op" id="3681138">(</span><span class="op" id="3681139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3681143">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3681147"><a href="/encoding/json/encode.go.html#3680971">v</a></span>&nbsp;<span class="op" id="3681149">=</span>&nbsp;<span class="ident" id="3681151"><a href="/encoding/json/encode.go.html#3680971">v</a></span><span class="op" id="3681152">.</span><span class="ident" id="3681153">Field</span><span class="op" id="3681158">(</span><span class="ident" id="3681159"><a href="/encoding/json/encode.go.html#3681025">i</a></span><span class="op" id="3681160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3681163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3681166">return</span>&nbsp;<span class="ident" id="3681173"><a href="/encoding/json/encode.go.html#3680971">v</a></span><br>
<span class="lineno"></span><span class="op" id="3681175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span><span class="keyword" id="3681178">func</span>&nbsp;<span class="ident" id="3681183">typeByIndex</span><span class="op" id="3681194">(</span><span class="ident" id="3681195">t</span>&nbsp;<span class="ident" id="3681197"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3681204">.</span><span class="ident" id="3681205">Type</span><span class="op" id="3681209">,</span>&nbsp;<span class="ident" id="3681211">index</span>&nbsp;<span class="op" id="3681217">[</span><span class="op" id="3681218">]</span><span class="builtintype" id="3681219">int</span><span class="op" id="3681222">)</span>&nbsp;<span class="ident" id="3681224"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3681231">.</span><span class="ident" id="3681232">Type</span>&nbsp;<span class="op" id="3681237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3681240">for</span>&nbsp;<span class="ident" id="3681244">_</span><span class="op" id="3681245">,</span>&nbsp;<span class="ident" id="3681247">i</span>&nbsp;<span class="op" id="3681249">:=</span>&nbsp;<span class="keyword" id="3681252">range</span>&nbsp;<span class="ident" id="3681258"><a href="/encoding/json/encode.go.html#3681211">index</a></span>&nbsp;<span class="op" id="3681264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3681268">if</span>&nbsp;<span class="ident" id="3681271"><a href="/encoding/json/encode.go.html#3681195">t</a></span><span class="op" id="3681272">.</span><span class="ident" id="3681273">Kind</span><span class="op" id="3681277">(</span><span class="op" id="3681278">)</span>&nbsp;<span class="op" id="3681280">==</span>&nbsp;<span class="ident" id="3681283"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3681290">.</span><span class="ident" id="3681291">Ptr</span>&nbsp;<span class="op" id="3681295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3681300"><a href="/encoding/json/encode.go.html#3681195">t</a></span>&nbsp;<span class="op" id="3681302">=</span>&nbsp;<span class="ident" id="3681304"><a href="/encoding/json/encode.go.html#3681195">t</a></span><span class="op" id="3681305">.</span><span class="ident" id="3681306">Elem</span><span class="op" id="3681310">(</span><span class="op" id="3681311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3681315">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3681319"><a href="/encoding/json/encode.go.html#3681195">t</a></span>&nbsp;<span class="op" id="3681321">=</span>&nbsp;<span class="ident" id="3681323"><a href="/encoding/json/encode.go.html#3681195">t</a></span><span class="op" id="3681324">.</span><span class="ident" id="3681325">Field</span><span class="op" id="3681330">(</span><span class="ident" id="3681331"><a href="/encoding/json/encode.go.html#3681247">i</a></span><span class="op" id="3681332">)</span><span class="op" id="3681333">.</span><span class="ident" id="3681334">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3681340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3681343">return</span>&nbsp;<span class="ident" id="3681350"><a href="/encoding/json/encode.go.html#3681195">t</a></span><br>
<span class="lineno"></span><span class="op" id="3681352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span><span class="comment" id="3681355">//&nbsp;stringValues&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;reflect.Value&nbsp;holding&nbsp;*reflect.StringValue.</span><br>
<span class="lineno"></span><span class="comment" id="3681429">//&nbsp;It&nbsp;implements&nbsp;the&nbsp;methods&nbsp;to&nbsp;sort&nbsp;by&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3681477">type</span>&nbsp;<span class="ident" id="3681482">stringValues</span>&nbsp;<span class="op" id="3681495">[</span><span class="op" id="3681496">]</span><span class="ident" id="3681497"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3681504">.</span><span class="ident" id="3681505">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3681512">func</span>&nbsp;<span class="op" id="3681517">(</span><span class="ident" id="3681518">sv</span>&nbsp;<span class="ident" id="3681521"><a href="/encoding/json/encode.go.html#3681482">stringValues</a></span><span class="op" id="3681533">)</span>&nbsp;<span class="ident" id="3681535">Len</span><span class="op" id="3681538">(</span><span class="op" id="3681539">)</span>&nbsp;<span class="builtintype" id="3681541">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3681555">{</span>&nbsp;<span class="keyword" id="3681557">return</span>&nbsp;<span class="builtinfunc" id="3681564">len</span><span class="op" id="3681567">(</span><span class="ident" id="3681568"><a href="/encoding/json/encode.go.html#3681518">sv</a></span><span class="op" id="3681570">)</span>&nbsp;<span class="op" id="3681572">}</span><br>
<span class="lineno">780</span><span class="keyword" id="3681574">func</span>&nbsp;<span class="op" id="3681579">(</span><span class="ident" id="3681580">sv</span>&nbsp;<span class="ident" id="3681583"><a href="/encoding/json/encode.go.html#3681482">stringValues</a></span><span class="op" id="3681595">)</span>&nbsp;<span class="ident" id="3681597">Swap</span><span class="op" id="3681601">(</span><span class="ident" id="3681602">i</span><span class="op" id="3681603">,</span>&nbsp;<span class="ident" id="3681605">j</span>&nbsp;<span class="builtintype" id="3681607">int</span><span class="op" id="3681610">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3681617">{</span>&nbsp;<span class="ident" id="3681619"><a href="/encoding/json/encode.go.html#3681580">sv</a></span><span class="op" id="3681621">[</span><span class="ident" id="3681622"><a href="/encoding/json/encode.go.html#3681602">i</a></span><span class="op" id="3681623">]</span><span class="op" id="3681624">,</span>&nbsp;<span class="ident" id="3681626"><a href="/encoding/json/encode.go.html#3681580">sv</a></span><span class="op" id="3681628">[</span><span class="ident" id="3681629"><a href="/encoding/json/encode.go.html#3681605">j</a></span><span class="op" id="3681630">]</span>&nbsp;<span class="op" id="3681632">=</span>&nbsp;<span class="ident" id="3681634"><a href="/encoding/json/encode.go.html#3681580">sv</a></span><span class="op" id="3681636">[</span><span class="ident" id="3681637"><a href="/encoding/json/encode.go.html#3681605">j</a></span><span class="op" id="3681638">]</span><span class="op" id="3681639">,</span>&nbsp;<span class="ident" id="3681641"><a href="/encoding/json/encode.go.html#3681580">sv</a></span><span class="op" id="3681643">[</span><span class="ident" id="3681644"><a href="/encoding/json/encode.go.html#3681602">i</a></span><span class="op" id="3681645">]</span>&nbsp;<span class="op" id="3681647">}</span><br>
<span class="lineno"></span><span class="keyword" id="3681649">func</span>&nbsp;<span class="op" id="3681654">(</span><span class="ident" id="3681655">sv</span>&nbsp;<span class="ident" id="3681658"><a href="/encoding/json/encode.go.html#3681482">stringValues</a></span><span class="op" id="3681670">)</span>&nbsp;<span class="ident" id="3681672">Less</span><span class="op" id="3681676">(</span><span class="ident" id="3681677">i</span><span class="op" id="3681678">,</span>&nbsp;<span class="ident" id="3681680">j</span>&nbsp;<span class="builtintype" id="3681682">int</span><span class="op" id="3681685">)</span>&nbsp;<span class="builtintype" id="3681687">bool</span>&nbsp;<span class="op" id="3681692">{</span>&nbsp;<span class="keyword" id="3681694">return</span>&nbsp;<span class="ident" id="3681701"><a href="/encoding/json/encode.go.html#3681655">sv</a></span><span class="op" id="3681703">.</span><span class="ident" id="3681704">get</span><span class="op" id="3681707">(</span><span class="ident" id="3681708"><a href="/encoding/json/encode.go.html#3681677">i</a></span><span class="op" id="3681709">)</span>&nbsp;<span class="op" id="3681711">&lt;</span>&nbsp;<span class="ident" id="3681713"><a href="/encoding/json/encode.go.html#3681655">sv</a></span><span class="op" id="3681715">.</span><span class="ident" id="3681716">get</span><span class="op" id="3681719">(</span><span class="ident" id="3681720"><a href="/encoding/json/encode.go.html#3681680">j</a></span><span class="op" id="3681721">)</span>&nbsp;<span class="op" id="3681723">}</span><br>
<span class="lineno"></span><span class="keyword" id="3681725">func</span>&nbsp;<span class="op" id="3681730">(</span><span class="ident" id="3681731">sv</span>&nbsp;<span class="ident" id="3681734"><a href="/encoding/json/encode.go.html#3681482">stringValues</a></span><span class="op" id="3681746">)</span>&nbsp;<span class="ident" id="3681748">get</span><span class="op" id="3681751">(</span><span class="ident" id="3681752">i</span>&nbsp;<span class="builtintype" id="3681754">int</span><span class="op" id="3681757">)</span>&nbsp;<span class="builtintype" id="3681759">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3681768">{</span>&nbsp;<span class="keyword" id="3681770">return</span>&nbsp;<span class="ident" id="3681777"><a href="/encoding/json/encode.go.html#3681731">sv</a></span><span class="op" id="3681779">[</span><span class="ident" id="3681780"><a href="/encoding/json/encode.go.html#3681752">i</a></span><span class="op" id="3681781">]</span><span class="op" id="3681782">.</span><span class="ident" id="3681783">String</span><span class="op" id="3681789">(</span><span class="op" id="3681790">)</span>&nbsp;<span class="op" id="3681792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3681795">//&nbsp;NOTE:&nbsp;keep&nbsp;in&nbsp;sync&nbsp;with&nbsp;stringBytes&nbsp;below.</span><br>
<span class="lineno">785</span><span class="keyword" id="3681841">func</span>&nbsp;<span class="op" id="3681846">(</span><span class="ident" id="3681847">e</span>&nbsp;<span class="op" id="3681849">*</span><span class="ident" id="3681850"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3681861">)</span>&nbsp;<span class="builtintype" id="3681863">string</span><span class="op" id="3681869">(</span><span class="ident" id="3681870">s</span>&nbsp;<span class="builtintype" id="3681872">string</span><span class="op" id="3681878">)</span>&nbsp;<span class="op" id="3681880">(</span><span class="builtintype" id="3681881">int</span><span class="op" id="3681884">,</span>&nbsp;<span class="builtintype" id="3681886">error</span><span class="op" id="3681891">)</span>&nbsp;<span class="op" id="3681893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3681896">len0</span>&nbsp;<span class="op" id="3681901">:=</span>&nbsp;<span class="ident" id="3681904"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3681905">.</span><span class="ident" id="3681906">Len</span><span class="op" id="3681909">(</span><span class="op" id="3681910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3681913"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3681914">.</span><span class="ident" id="3681915">WriteByte</span><span class="op" id="3681924">(</span><span class="string" id="3681925">&#39;&#34;&#39;</span><span class="op" id="3681928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3681931">start</span>&nbsp;<span class="op" id="3681937">:=</span>&nbsp;<span class="num" id="3681940">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3681943">for</span>&nbsp;<span class="ident" id="3681947">i</span>&nbsp;<span class="op" id="3681949">:=</span>&nbsp;<span class="num" id="3681952">0</span><span class="op" id="3681953">;</span>&nbsp;<span class="ident" id="3681955"><a href="/encoding/json/encode.go.html#3681947">i</a></span>&nbsp;<span class="op" id="3681957">&lt;</span>&nbsp;<span class="builtinfunc" id="3681959">len</span><span class="op" id="3681962">(</span><span class="ident" id="3681963"><a href="/encoding/json/encode.go.html#3681870">s</a></span><span class="op" id="3681964">)</span><span class="op" id="3681965">;</span>&nbsp;<span class="op" id="3681967">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3681971">if</span>&nbsp;<span class="ident" id="3681974">b</span>&nbsp;<span class="op" id="3681976">:=</span>&nbsp;<span class="ident" id="3681979"><a href="/encoding/json/encode.go.html#3681870">s</a></span><span class="op" id="3681980">[</span><span class="ident" id="3681981"><a href="/encoding/json/encode.go.html#3681947">i</a></span><span class="op" id="3681982">]</span><span class="op" id="3681983">;</span>&nbsp;<span class="ident" id="3681985"><a href="/encoding/json/encode.go.html#3681974">b</a></span>&nbsp;<span class="op" id="3681987">&lt;</span>&nbsp;<span class="ident" id="3681989"><a href="/encoding/json/encode.go.html#3661763">utf8</a></span><span class="op" id="3681993">.</span><span class="ident" id="3681994">RuneSelf</span>&nbsp;<span class="op" id="3682003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682008">if</span>&nbsp;<span class="num" id="3682011">0x20</span>&nbsp;<span class="op" id="3682016">&lt;=</span>&nbsp;<span class="ident" id="3682019"><a href="/encoding/json/encode.go.html#3681974">b</a></span>&nbsp;<span class="op" id="3682021">&amp;&amp;</span>&nbsp;<span class="ident" id="3682024"><a href="/encoding/json/encode.go.html#3681974">b</a></span>&nbsp;<span class="op" id="3682026">!=</span>&nbsp;<span class="string" id="3682029">&#39;\\&#39;</span>&nbsp;<span class="op" id="3682034">&amp;&amp;</span>&nbsp;<span class="ident" id="3682037"><a href="/encoding/json/encode.go.html#3681974">b</a></span>&nbsp;<span class="op" id="3682039">!=</span>&nbsp;<span class="string" id="3682042">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3682046">&amp;&amp;</span>&nbsp;<span class="ident" id="3682049"><a href="/encoding/json/encode.go.html#3681974">b</a></span>&nbsp;<span class="op" id="3682051">!=</span>&nbsp;<span class="string" id="3682054">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="3682058">&amp;&amp;</span>&nbsp;<span class="ident" id="3682061"><a href="/encoding/json/encode.go.html#3681974">b</a></span>&nbsp;<span class="op" id="3682063">!=</span>&nbsp;<span class="string" id="3682066">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="3682070">&amp;&amp;</span>&nbsp;<span class="ident" id="3682073"><a href="/encoding/json/encode.go.html#3681974">b</a></span>&nbsp;<span class="op" id="3682075">!=</span>&nbsp;<span class="string" id="3682078">&#39;&amp;&#39;</span>&nbsp;<span class="op" id="3682082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682088"><a href="/encoding/json/encode.go.html#3681947">i</a></span><span class="op" id="3682089">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682096">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3682108">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682113">if</span>&nbsp;<span class="ident" id="3682116"><a href="/encoding/json/encode.go.html#3681931">start</a></span>&nbsp;<span class="op" id="3682122">&lt;</span>&nbsp;<span class="ident" id="3682124"><a href="/encoding/json/encode.go.html#3681947">i</a></span>&nbsp;<span class="op" id="3682126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682132"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682133">.</span><span class="ident" id="3682134">WriteString</span><span class="op" id="3682145">(</span><span class="ident" id="3682146"><a href="/encoding/json/encode.go.html#3681870">s</a></span><span class="op" id="3682147">[</span><span class="ident" id="3682148"><a href="/encoding/json/encode.go.html#3681931">start</a></span><span class="op" id="3682153">:</span><span class="ident" id="3682154"><a href="/encoding/json/encode.go.html#3681947">i</a></span><span class="op" id="3682155">]</span><span class="op" id="3682156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3682161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682166">switch</span>&nbsp;<span class="ident" id="3682173"><a href="/encoding/json/encode.go.html#3681974">b</a></span>&nbsp;<span class="op" id="3682175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682180">case</span>&nbsp;<span class="string" id="3682185">&#39;\\&#39;</span><span class="op" id="3682189">,</span>&nbsp;<span class="string" id="3682191">&#39;&#34;&#39;</span><span class="op" id="3682194">:</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682200"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682201">.</span><span class="ident" id="3682202">WriteByte</span><span class="op" id="3682211">(</span><span class="string" id="3682212">&#39;\\&#39;</span><span class="op" id="3682216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682222"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682223">.</span><span class="ident" id="3682224">WriteByte</span><span class="op" id="3682233">(</span><span class="ident" id="3682234"><a href="/encoding/json/encode.go.html#3681974">b</a></span><span class="op" id="3682235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682240">case</span>&nbsp;<span class="string" id="3682245">&#39;\n&#39;</span><span class="op" id="3682249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682255"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682256">.</span><span class="ident" id="3682257">WriteByte</span><span class="op" id="3682266">(</span><span class="string" id="3682267">&#39;\\&#39;</span><span class="op" id="3682271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682277"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682278">.</span><span class="ident" id="3682279">WriteByte</span><span class="op" id="3682288">(</span><span class="string" id="3682289">&#39;n&#39;</span><span class="op" id="3682292">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682297">case</span>&nbsp;<span class="string" id="3682302">&#39;\r&#39;</span><span class="op" id="3682306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682312"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682313">.</span><span class="ident" id="3682314">WriteByte</span><span class="op" id="3682323">(</span><span class="string" id="3682324">&#39;\\&#39;</span><span class="op" id="3682328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682334"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682335">.</span><span class="ident" id="3682336">WriteByte</span><span class="op" id="3682345">(</span><span class="string" id="3682346">&#39;r&#39;</span><span class="op" id="3682349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682354">case</span>&nbsp;<span class="string" id="3682359">&#39;\t&#39;</span><span class="op" id="3682363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682369"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682370">.</span><span class="ident" id="3682371">WriteByte</span><span class="op" id="3682380">(</span><span class="string" id="3682381">&#39;\\&#39;</span><span class="op" id="3682385">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682391"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682392">.</span><span class="ident" id="3682393">WriteByte</span><span class="op" id="3682402">(</span><span class="string" id="3682403">&#39;t&#39;</span><span class="op" id="3682406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682411">default</span><span class="op" id="3682418">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3682424">//&nbsp;This&nbsp;encodes&nbsp;bytes&nbsp;&lt;&nbsp;0x20&nbsp;except&nbsp;for&nbsp;\n&nbsp;and&nbsp;\r,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3682479">//&nbsp;as&nbsp;well&nbsp;as&nbsp;&lt;,&nbsp;&gt;&nbsp;and&nbsp;&amp;.&nbsp;The&nbsp;latter&nbsp;are&nbsp;escaped&nbsp;because&nbsp;they</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3682545">//&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;when&nbsp;user-controlled&nbsp;strings</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3682608">//&nbsp;are&nbsp;rendered&nbsp;into&nbsp;JSON&nbsp;and&nbsp;served&nbsp;to&nbsp;some&nbsp;browsers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682667"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682668">.</span><span class="ident" id="3682669">WriteString</span><span class="op" id="3682680">(</span><span class="string" id="3682681">`\u00`</span><span class="op" id="3682687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682693"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682694">.</span><span class="ident" id="3682695">WriteByte</span><span class="op" id="3682704">(</span><span class="ident" id="3682705"><a href="/encoding/json/encode.go.html#3669482">hex</a></span><span class="op" id="3682708">[</span><span class="ident" id="3682709"><a href="/encoding/json/encode.go.html#3681974">b</a></span><span class="op" id="3682710">&gt;&gt;</span><span class="num" id="3682712">4</span><span class="op" id="3682713">]</span><span class="op" id="3682714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682720"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682721">.</span><span class="ident" id="3682722">WriteByte</span><span class="op" id="3682731">(</span><span class="ident" id="3682732"><a href="/encoding/json/encode.go.html#3669482">hex</a></span><span class="op" id="3682735">[</span><span class="ident" id="3682736"><a href="/encoding/json/encode.go.html#3681974">b</a></span><span class="op" id="3682737">&amp;</span><span class="num" id="3682738">0xF</span><span class="op" id="3682741">]</span><span class="op" id="3682742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3682747">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682752"><a href="/encoding/json/encode.go.html#3681947">i</a></span><span class="op" id="3682753">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682759"><a href="/encoding/json/encode.go.html#3681931">start</a></span>&nbsp;<span class="op" id="3682765">=</span>&nbsp;<span class="ident" id="3682767"><a href="/encoding/json/encode.go.html#3681947">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682772">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3682783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682787">c</span><span class="op" id="3682788">,</span>&nbsp;<span class="ident" id="3682790">size</span>&nbsp;<span class="op" id="3682795">:=</span>&nbsp;<span class="ident" id="3682798"><a href="/encoding/json/encode.go.html#3661763">utf8</a></span><span class="op" id="3682802">.</span><span class="ident" id="3682803">DecodeRuneInString</span><span class="op" id="3682821">(</span><span class="ident" id="3682822"><a href="/encoding/json/encode.go.html#3681870">s</a></span><span class="op" id="3682823">[</span><span class="ident" id="3682824"><a href="/encoding/json/encode.go.html#3681947">i</a></span><span class="op" id="3682825">:</span><span class="op" id="3682826">]</span><span class="op" id="3682827">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682831">if</span>&nbsp;<span class="ident" id="3682834"><a href="/encoding/json/encode.go.html#3682787">c</a></span>&nbsp;<span class="op" id="3682836">==</span>&nbsp;<span class="ident" id="3682839"><a href="/encoding/json/encode.go.html#3661763">utf8</a></span><span class="op" id="3682843">.</span><span class="ident" id="3682844">RuneError</span>&nbsp;<span class="op" id="3682854">&amp;&amp;</span>&nbsp;<span class="ident" id="3682857"><a href="/encoding/json/encode.go.html#3682790">size</a></span>&nbsp;<span class="op" id="3682862">==</span>&nbsp;<span class="num" id="3682865">1</span>&nbsp;<span class="op" id="3682867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682872">if</span>&nbsp;<span class="ident" id="3682875"><a href="/encoding/json/encode.go.html#3681931">start</a></span>&nbsp;<span class="op" id="3682881">&lt;</span>&nbsp;<span class="ident" id="3682883"><a href="/encoding/json/encode.go.html#3681947">i</a></span>&nbsp;<span class="op" id="3682885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682891"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682892">.</span><span class="ident" id="3682893">WriteString</span><span class="op" id="3682904">(</span><span class="ident" id="3682905"><a href="/encoding/json/encode.go.html#3681870">s</a></span><span class="op" id="3682906">[</span><span class="ident" id="3682907"><a href="/encoding/json/encode.go.html#3681931">start</a></span><span class="op" id="3682912">:</span><span class="ident" id="3682913"><a href="/encoding/json/encode.go.html#3681947">i</a></span><span class="op" id="3682914">]</span><span class="op" id="3682915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3682920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682925"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3682926">.</span><span class="ident" id="3682927">WriteString</span><span class="op" id="3682938">(</span><span class="string" id="3682939">`\ufffd`</span><span class="op" id="3682947">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682952"><a href="/encoding/json/encode.go.html#3681947">i</a></span>&nbsp;<span class="op" id="3682954">+=</span>&nbsp;<span class="ident" id="3682957"><a href="/encoding/json/encode.go.html#3682790">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3682965"><a href="/encoding/json/encode.go.html#3681931">start</a></span>&nbsp;<span class="op" id="3682971">=</span>&nbsp;<span class="ident" id="3682973"><a href="/encoding/json/encode.go.html#3681947">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3682978">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3682989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3682993">//&nbsp;U+2028&nbsp;is&nbsp;LINE&nbsp;SEPARATOR.</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3683024">//&nbsp;U+2029&nbsp;is&nbsp;PARAGRAPH&nbsp;SEPARATOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3683060">//&nbsp;They&nbsp;are&nbsp;both&nbsp;technically&nbsp;valid&nbsp;characters&nbsp;in&nbsp;JSON&nbsp;strings,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3683125">//&nbsp;but&nbsp;don&#39;t&nbsp;work&nbsp;in&nbsp;JSONP,&nbsp;which&nbsp;has&nbsp;to&nbsp;be&nbsp;evaluated&nbsp;as&nbsp;JavaScript,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3683196">//&nbsp;and&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;there.&nbsp;It&nbsp;is&nbsp;valid&nbsp;JSON&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3683259">//&nbsp;escape&nbsp;them,&nbsp;so&nbsp;we&nbsp;do&nbsp;so&nbsp;unconditionally.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3683306">//&nbsp;See&nbsp;http://timelessrepo.com/json-isnt-a-javascript-subset&nbsp;for&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3683385">if</span>&nbsp;<span class="ident" id="3683388"><a href="/encoding/json/encode.go.html#3682787">c</a></span>&nbsp;<span class="op" id="3683390">==</span>&nbsp;<span class="string" id="3683393">&#39;\u2028&#39;</span>&nbsp;<span class="op" id="3683402">||</span>&nbsp;<span class="ident" id="3683405"><a href="/encoding/json/encode.go.html#3682787">c</a></span>&nbsp;<span class="op" id="3683407">==</span>&nbsp;<span class="string" id="3683410">&#39;\u2029&#39;</span>&nbsp;<span class="op" id="3683419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3683424">if</span>&nbsp;<span class="ident" id="3683427"><a href="/encoding/json/encode.go.html#3681931">start</a></span>&nbsp;<span class="op" id="3683433">&lt;</span>&nbsp;<span class="ident" id="3683435"><a href="/encoding/json/encode.go.html#3681947">i</a></span>&nbsp;<span class="op" id="3683437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683443"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3683444">.</span><span class="ident" id="3683445">WriteString</span><span class="op" id="3683456">(</span><span class="ident" id="3683457"><a href="/encoding/json/encode.go.html#3681870">s</a></span><span class="op" id="3683458">[</span><span class="ident" id="3683459"><a href="/encoding/json/encode.go.html#3681931">start</a></span><span class="op" id="3683464">:</span><span class="ident" id="3683465"><a href="/encoding/json/encode.go.html#3681947">i</a></span><span class="op" id="3683466">]</span><span class="op" id="3683467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3683472">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683477"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3683478">.</span><span class="ident" id="3683479">WriteString</span><span class="op" id="3683490">(</span><span class="string" id="3683491">`\u202`</span><span class="op" id="3683498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683503"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3683504">.</span><span class="ident" id="3683505">WriteByte</span><span class="op" id="3683514">(</span><span class="ident" id="3683515"><a href="/encoding/json/encode.go.html#3669482">hex</a></span><span class="op" id="3683518">[</span><span class="ident" id="3683519"><a href="/encoding/json/encode.go.html#3682787">c</a></span><span class="op" id="3683520">&amp;</span><span class="num" id="3683521">0xF</span><span class="op" id="3683524">]</span><span class="op" id="3683525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683530"><a href="/encoding/json/encode.go.html#3681947">i</a></span>&nbsp;<span class="op" id="3683532">+=</span>&nbsp;<span class="ident" id="3683535"><a href="/encoding/json/encode.go.html#3682790">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683543"><a href="/encoding/json/encode.go.html#3681931">start</a></span>&nbsp;<span class="op" id="3683549">=</span>&nbsp;<span class="ident" id="3683551"><a href="/encoding/json/encode.go.html#3681947">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3683556">continue</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3683567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683571"><a href="/encoding/json/encode.go.html#3681947">i</a></span>&nbsp;<span class="op" id="3683573">+=</span>&nbsp;<span class="ident" id="3683576"><a href="/encoding/json/encode.go.html#3682790">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3683582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3683585">if</span>&nbsp;<span class="ident" id="3683588"><a href="/encoding/json/encode.go.html#3681931">start</a></span>&nbsp;<span class="op" id="3683594">&lt;</span>&nbsp;<span class="builtinfunc" id="3683596">len</span><span class="op" id="3683599">(</span><span class="ident" id="3683600"><a href="/encoding/json/encode.go.html#3681870">s</a></span><span class="op" id="3683601">)</span>&nbsp;<span class="op" id="3683603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683607"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3683608">.</span><span class="ident" id="3683609">WriteString</span><span class="op" id="3683620">(</span><span class="ident" id="3683621"><a href="/encoding/json/encode.go.html#3681870">s</a></span><span class="op" id="3683622">[</span><span class="ident" id="3683623"><a href="/encoding/json/encode.go.html#3681931">start</a></span><span class="op" id="3683628">:</span><span class="op" id="3683629">]</span><span class="op" id="3683630">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3683633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683636"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3683637">.</span><span class="ident" id="3683638">WriteByte</span><span class="op" id="3683647">(</span><span class="string" id="3683648">&#39;&#34;&#39;</span><span class="op" id="3683651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3683654">return</span>&nbsp;<span class="ident" id="3683661"><a href="/encoding/json/encode.go.html#3681847">e</a></span><span class="op" id="3683662">.</span><span class="ident" id="3683663">Len</span><span class="op" id="3683666">(</span><span class="op" id="3683667">)</span>&nbsp;<span class="op" id="3683669">-</span>&nbsp;<span class="ident" id="3683671"><a href="/encoding/json/encode.go.html#3681896">len0</a></span><span class="op" id="3683675">,</span>&nbsp;<span class="ident" id="3683677">nil</span><br>
<span class="lineno"></span><span class="op" id="3683681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="comment" id="3683684">//&nbsp;NOTE:&nbsp;keep&nbsp;in&nbsp;sync&nbsp;with&nbsp;string&nbsp;above.</span><br>
<span class="lineno"></span><span class="keyword" id="3683725">func</span>&nbsp;<span class="op" id="3683730">(</span><span class="ident" id="3683731">e</span>&nbsp;<span class="op" id="3683733">*</span><span class="ident" id="3683734"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="3683745">)</span>&nbsp;<span class="ident" id="3683747">stringBytes</span><span class="op" id="3683758">(</span><span class="ident" id="3683759">s</span>&nbsp;<span class="op" id="3683761">[</span><span class="op" id="3683762">]</span><span class="builtintype" id="3683763">byte</span><span class="op" id="3683767">)</span>&nbsp;<span class="op" id="3683769">(</span><span class="builtintype" id="3683770">int</span><span class="op" id="3683773">,</span>&nbsp;<span class="builtintype" id="3683775">error</span><span class="op" id="3683780">)</span>&nbsp;<span class="op" id="3683782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683785">len0</span>&nbsp;<span class="op" id="3683790">:=</span>&nbsp;<span class="ident" id="3683793"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3683794">.</span><span class="ident" id="3683795">Len</span><span class="op" id="3683798">(</span><span class="op" id="3683799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683802"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3683803">.</span><span class="ident" id="3683804">WriteByte</span><span class="op" id="3683813">(</span><span class="string" id="3683814">&#39;&#34;&#39;</span><span class="op" id="3683817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683820">start</span>&nbsp;<span class="op" id="3683826">:=</span>&nbsp;<span class="num" id="3683829">0</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3683832">for</span>&nbsp;<span class="ident" id="3683836">i</span>&nbsp;<span class="op" id="3683838">:=</span>&nbsp;<span class="num" id="3683841">0</span><span class="op" id="3683842">;</span>&nbsp;<span class="ident" id="3683844"><a href="/encoding/json/encode.go.html#3683836">i</a></span>&nbsp;<span class="op" id="3683846">&lt;</span>&nbsp;<span class="builtinfunc" id="3683848">len</span><span class="op" id="3683851">(</span><span class="ident" id="3683852"><a href="/encoding/json/encode.go.html#3683759">s</a></span><span class="op" id="3683853">)</span><span class="op" id="3683854">;</span>&nbsp;<span class="op" id="3683856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3683860">if</span>&nbsp;<span class="ident" id="3683863">b</span>&nbsp;<span class="op" id="3683865">:=</span>&nbsp;<span class="ident" id="3683868"><a href="/encoding/json/encode.go.html#3683759">s</a></span><span class="op" id="3683869">[</span><span class="ident" id="3683870"><a href="/encoding/json/encode.go.html#3683836">i</a></span><span class="op" id="3683871">]</span><span class="op" id="3683872">;</span>&nbsp;<span class="ident" id="3683874"><a href="/encoding/json/encode.go.html#3683863">b</a></span>&nbsp;<span class="op" id="3683876">&lt;</span>&nbsp;<span class="ident" id="3683878"><a href="/encoding/json/encode.go.html#3661763">utf8</a></span><span class="op" id="3683882">.</span><span class="ident" id="3683883">RuneSelf</span>&nbsp;<span class="op" id="3683892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3683897">if</span>&nbsp;<span class="num" id="3683900">0x20</span>&nbsp;<span class="op" id="3683905">&lt;=</span>&nbsp;<span class="ident" id="3683908"><a href="/encoding/json/encode.go.html#3683863">b</a></span>&nbsp;<span class="op" id="3683910">&amp;&amp;</span>&nbsp;<span class="ident" id="3683913"><a href="/encoding/json/encode.go.html#3683863">b</a></span>&nbsp;<span class="op" id="3683915">!=</span>&nbsp;<span class="string" id="3683918">&#39;\\&#39;</span>&nbsp;<span class="op" id="3683923">&amp;&amp;</span>&nbsp;<span class="ident" id="3683926"><a href="/encoding/json/encode.go.html#3683863">b</a></span>&nbsp;<span class="op" id="3683928">!=</span>&nbsp;<span class="string" id="3683931">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3683935">&amp;&amp;</span>&nbsp;<span class="ident" id="3683938"><a href="/encoding/json/encode.go.html#3683863">b</a></span>&nbsp;<span class="op" id="3683940">!=</span>&nbsp;<span class="string" id="3683943">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="3683947">&amp;&amp;</span>&nbsp;<span class="ident" id="3683950"><a href="/encoding/json/encode.go.html#3683863">b</a></span>&nbsp;<span class="op" id="3683952">!=</span>&nbsp;<span class="string" id="3683955">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="3683959">&amp;&amp;</span>&nbsp;<span class="ident" id="3683962"><a href="/encoding/json/encode.go.html#3683863">b</a></span>&nbsp;<span class="op" id="3683964">!=</span>&nbsp;<span class="string" id="3683967">&#39;&amp;&#39;</span>&nbsp;<span class="op" id="3683971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3683977"><a href="/encoding/json/encode.go.html#3683836">i</a></span><span class="op" id="3683978">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3683985">continue</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3683997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684002">if</span>&nbsp;<span class="ident" id="3684005"><a href="/encoding/json/encode.go.html#3683820">start</a></span>&nbsp;<span class="op" id="3684011">&lt;</span>&nbsp;<span class="ident" id="3684013"><a href="/encoding/json/encode.go.html#3683836">i</a></span>&nbsp;<span class="op" id="3684015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684021"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684022">.</span><span class="ident" id="3684023">Write</span><span class="op" id="3684028">(</span><span class="ident" id="3684029"><a href="/encoding/json/encode.go.html#3683759">s</a></span><span class="op" id="3684030">[</span><span class="ident" id="3684031"><a href="/encoding/json/encode.go.html#3683820">start</a></span><span class="op" id="3684036">:</span><span class="ident" id="3684037"><a href="/encoding/json/encode.go.html#3683836">i</a></span><span class="op" id="3684038">]</span><span class="op" id="3684039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3684044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684049">switch</span>&nbsp;<span class="ident" id="3684056"><a href="/encoding/json/encode.go.html#3683863">b</a></span>&nbsp;<span class="op" id="3684058">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684063">case</span>&nbsp;<span class="string" id="3684068">&#39;\\&#39;</span><span class="op" id="3684072">,</span>&nbsp;<span class="string" id="3684074">&#39;&#34;&#39;</span><span class="op" id="3684077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684083"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684084">.</span><span class="ident" id="3684085">WriteByte</span><span class="op" id="3684094">(</span><span class="string" id="3684095">&#39;\\&#39;</span><span class="op" id="3684099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684105"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684106">.</span><span class="ident" id="3684107">WriteByte</span><span class="op" id="3684116">(</span><span class="ident" id="3684117"><a href="/encoding/json/encode.go.html#3683863">b</a></span><span class="op" id="3684118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684123">case</span>&nbsp;<span class="string" id="3684128">&#39;\n&#39;</span><span class="op" id="3684132">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684138"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684139">.</span><span class="ident" id="3684140">WriteByte</span><span class="op" id="3684149">(</span><span class="string" id="3684150">&#39;\\&#39;</span><span class="op" id="3684154">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684160"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684161">.</span><span class="ident" id="3684162">WriteByte</span><span class="op" id="3684171">(</span><span class="string" id="3684172">&#39;n&#39;</span><span class="op" id="3684175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684180">case</span>&nbsp;<span class="string" id="3684185">&#39;\r&#39;</span><span class="op" id="3684189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684195"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684196">.</span><span class="ident" id="3684197">WriteByte</span><span class="op" id="3684206">(</span><span class="string" id="3684207">&#39;\\&#39;</span><span class="op" id="3684211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684217"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684218">.</span><span class="ident" id="3684219">WriteByte</span><span class="op" id="3684228">(</span><span class="string" id="3684229">&#39;r&#39;</span><span class="op" id="3684232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684237">case</span>&nbsp;<span class="string" id="3684242">&#39;\t&#39;</span><span class="op" id="3684246">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684252"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684253">.</span><span class="ident" id="3684254">WriteByte</span><span class="op" id="3684263">(</span><span class="string" id="3684264">&#39;\\&#39;</span><span class="op" id="3684268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684274"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684275">.</span><span class="ident" id="3684276">WriteByte</span><span class="op" id="3684285">(</span><span class="string" id="3684286">&#39;t&#39;</span><span class="op" id="3684289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684294">default</span><span class="op" id="3684301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3684307">//&nbsp;This&nbsp;encodes&nbsp;bytes&nbsp;&lt;&nbsp;0x20&nbsp;except&nbsp;for&nbsp;\n&nbsp;and&nbsp;\r,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3684362">//&nbsp;as&nbsp;well&nbsp;as&nbsp;&lt;,&nbsp;&gt;,&nbsp;and&nbsp;&amp;.&nbsp;The&nbsp;latter&nbsp;are&nbsp;escaped&nbsp;because&nbsp;they</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3684429">//&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;when&nbsp;user-controlled&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3684492">//&nbsp;are&nbsp;rendered&nbsp;into&nbsp;JSON&nbsp;and&nbsp;served&nbsp;to&nbsp;some&nbsp;browsers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684551"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684552">.</span><span class="ident" id="3684553">WriteString</span><span class="op" id="3684564">(</span><span class="string" id="3684565">`\u00`</span><span class="op" id="3684571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684577"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684578">.</span><span class="ident" id="3684579">WriteByte</span><span class="op" id="3684588">(</span><span class="ident" id="3684589"><a href="/encoding/json/encode.go.html#3669482">hex</a></span><span class="op" id="3684592">[</span><span class="ident" id="3684593"><a href="/encoding/json/encode.go.html#3683863">b</a></span><span class="op" id="3684594">&gt;&gt;</span><span class="num" id="3684596">4</span><span class="op" id="3684597">]</span><span class="op" id="3684598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684604"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684605">.</span><span class="ident" id="3684606">WriteByte</span><span class="op" id="3684615">(</span><span class="ident" id="3684616"><a href="/encoding/json/encode.go.html#3669482">hex</a></span><span class="op" id="3684619">[</span><span class="ident" id="3684620"><a href="/encoding/json/encode.go.html#3683863">b</a></span><span class="op" id="3684621">&amp;</span><span class="num" id="3684622">0xF</span><span class="op" id="3684625">]</span><span class="op" id="3684626">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3684631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684636"><a href="/encoding/json/encode.go.html#3683836">i</a></span><span class="op" id="3684637">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684643"><a href="/encoding/json/encode.go.html#3683820">start</a></span>&nbsp;<span class="op" id="3684649">=</span>&nbsp;<span class="ident" id="3684651"><a href="/encoding/json/encode.go.html#3683836">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684656">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3684667">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684671">c</span><span class="op" id="3684672">,</span>&nbsp;<span class="ident" id="3684674">size</span>&nbsp;<span class="op" id="3684679">:=</span>&nbsp;<span class="ident" id="3684682"><a href="/encoding/json/encode.go.html#3661763">utf8</a></span><span class="op" id="3684686">.</span><span class="ident" id="3684687">DecodeRune</span><span class="op" id="3684697">(</span><span class="ident" id="3684698"><a href="/encoding/json/encode.go.html#3683759">s</a></span><span class="op" id="3684699">[</span><span class="ident" id="3684700"><a href="/encoding/json/encode.go.html#3683836">i</a></span><span class="op" id="3684701">:</span><span class="op" id="3684702">]</span><span class="op" id="3684703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684707">if</span>&nbsp;<span class="ident" id="3684710"><a href="/encoding/json/encode.go.html#3684671">c</a></span>&nbsp;<span class="op" id="3684712">==</span>&nbsp;<span class="ident" id="3684715"><a href="/encoding/json/encode.go.html#3661763">utf8</a></span><span class="op" id="3684719">.</span><span class="ident" id="3684720">RuneError</span>&nbsp;<span class="op" id="3684730">&amp;&amp;</span>&nbsp;<span class="ident" id="3684733"><a href="/encoding/json/encode.go.html#3684674">size</a></span>&nbsp;<span class="op" id="3684738">==</span>&nbsp;<span class="num" id="3684741">1</span>&nbsp;<span class="op" id="3684743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684748">if</span>&nbsp;<span class="ident" id="3684751"><a href="/encoding/json/encode.go.html#3683820">start</a></span>&nbsp;<span class="op" id="3684757">&lt;</span>&nbsp;<span class="ident" id="3684759"><a href="/encoding/json/encode.go.html#3683836">i</a></span>&nbsp;<span class="op" id="3684761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684767"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684768">.</span><span class="ident" id="3684769">Write</span><span class="op" id="3684774">(</span><span class="ident" id="3684775"><a href="/encoding/json/encode.go.html#3683759">s</a></span><span class="op" id="3684776">[</span><span class="ident" id="3684777"><a href="/encoding/json/encode.go.html#3683820">start</a></span><span class="op" id="3684782">:</span><span class="ident" id="3684783"><a href="/encoding/json/encode.go.html#3683836">i</a></span><span class="op" id="3684784">]</span><span class="op" id="3684785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3684790">}</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684795"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3684796">.</span><span class="ident" id="3684797">WriteString</span><span class="op" id="3684808">(</span><span class="string" id="3684809">`\ufffd`</span><span class="op" id="3684817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684822"><a href="/encoding/json/encode.go.html#3683836">i</a></span>&nbsp;<span class="op" id="3684824">+=</span>&nbsp;<span class="ident" id="3684827"><a href="/encoding/json/encode.go.html#3684674">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3684835"><a href="/encoding/json/encode.go.html#3683820">start</a></span>&nbsp;<span class="op" id="3684841">=</span>&nbsp;<span class="ident" id="3684843"><a href="/encoding/json/encode.go.html#3683836">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3684848">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3684859">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3684863">//&nbsp;U+2028&nbsp;is&nbsp;LINE&nbsp;SEPARATOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3684894">//&nbsp;U+2029&nbsp;is&nbsp;PARAGRAPH&nbsp;SEPARATOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3684930">//&nbsp;They&nbsp;are&nbsp;both&nbsp;technically&nbsp;valid&nbsp;characters&nbsp;in&nbsp;JSON&nbsp;strings,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3684995">//&nbsp;but&nbsp;don&#39;t&nbsp;work&nbsp;in&nbsp;JSONP,&nbsp;which&nbsp;has&nbsp;to&nbsp;be&nbsp;evaluated&nbsp;as&nbsp;JavaScript,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3685066">//&nbsp;and&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;there.&nbsp;It&nbsp;is&nbsp;valid&nbsp;JSON&nbsp;to</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3685129">//&nbsp;escape&nbsp;them,&nbsp;so&nbsp;we&nbsp;do&nbsp;so&nbsp;unconditionally.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3685176">//&nbsp;See&nbsp;http://timelessrepo.com/json-isnt-a-javascript-subset&nbsp;for&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3685255">if</span>&nbsp;<span class="ident" id="3685258"><a href="/encoding/json/encode.go.html#3684671">c</a></span>&nbsp;<span class="op" id="3685260">==</span>&nbsp;<span class="string" id="3685263">&#39;\u2028&#39;</span>&nbsp;<span class="op" id="3685272">||</span>&nbsp;<span class="ident" id="3685275"><a href="/encoding/json/encode.go.html#3684671">c</a></span>&nbsp;<span class="op" id="3685277">==</span>&nbsp;<span class="string" id="3685280">&#39;\u2029&#39;</span>&nbsp;<span class="op" id="3685289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3685294">if</span>&nbsp;<span class="ident" id="3685297"><a href="/encoding/json/encode.go.html#3683820">start</a></span>&nbsp;<span class="op" id="3685303">&lt;</span>&nbsp;<span class="ident" id="3685305"><a href="/encoding/json/encode.go.html#3683836">i</a></span>&nbsp;<span class="op" id="3685307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685313"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3685314">.</span><span class="ident" id="3685315">Write</span><span class="op" id="3685320">(</span><span class="ident" id="3685321"><a href="/encoding/json/encode.go.html#3683759">s</a></span><span class="op" id="3685322">[</span><span class="ident" id="3685323"><a href="/encoding/json/encode.go.html#3683820">start</a></span><span class="op" id="3685328">:</span><span class="ident" id="3685329"><a href="/encoding/json/encode.go.html#3683836">i</a></span><span class="op" id="3685330">]</span><span class="op" id="3685331">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3685336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685341"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3685342">.</span><span class="ident" id="3685343">WriteString</span><span class="op" id="3685354">(</span><span class="string" id="3685355">`\u202`</span><span class="op" id="3685362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685367"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3685368">.</span><span class="ident" id="3685369">WriteByte</span><span class="op" id="3685378">(</span><span class="ident" id="3685379"><a href="/encoding/json/encode.go.html#3669482">hex</a></span><span class="op" id="3685382">[</span><span class="ident" id="3685383"><a href="/encoding/json/encode.go.html#3684671">c</a></span><span class="op" id="3685384">&amp;</span><span class="num" id="3685385">0xF</span><span class="op" id="3685388">]</span><span class="op" id="3685389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685394"><a href="/encoding/json/encode.go.html#3683836">i</a></span>&nbsp;<span class="op" id="3685396">+=</span>&nbsp;<span class="ident" id="3685399"><a href="/encoding/json/encode.go.html#3684674">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685407"><a href="/encoding/json/encode.go.html#3683820">start</a></span>&nbsp;<span class="op" id="3685413">=</span>&nbsp;<span class="ident" id="3685415"><a href="/encoding/json/encode.go.html#3683836">i</a></span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3685420">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3685431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685435"><a href="/encoding/json/encode.go.html#3683836">i</a></span>&nbsp;<span class="op" id="3685437">+=</span>&nbsp;<span class="ident" id="3685440"><a href="/encoding/json/encode.go.html#3684674">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3685446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3685449">if</span>&nbsp;<span class="ident" id="3685452"><a href="/encoding/json/encode.go.html#3683820">start</a></span>&nbsp;<span class="op" id="3685458">&lt;</span>&nbsp;<span class="builtinfunc" id="3685460">len</span><span class="op" id="3685463">(</span><span class="ident" id="3685464"><a href="/encoding/json/encode.go.html#3683759">s</a></span><span class="op" id="3685465">)</span>&nbsp;<span class="op" id="3685467">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685471"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3685472">.</span><span class="ident" id="3685473">Write</span><span class="op" id="3685478">(</span><span class="ident" id="3685479"><a href="/encoding/json/encode.go.html#3683759">s</a></span><span class="op" id="3685480">[</span><span class="ident" id="3685481"><a href="/encoding/json/encode.go.html#3683820">start</a></span><span class="op" id="3685486">:</span><span class="op" id="3685487">]</span><span class="op" id="3685488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3685491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685494"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3685495">.</span><span class="ident" id="3685496">WriteByte</span><span class="op" id="3685505">(</span><span class="string" id="3685506">&#39;&#34;&#39;</span><span class="op" id="3685509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3685512">return</span>&nbsp;<span class="ident" id="3685519"><a href="/encoding/json/encode.go.html#3683731">e</a></span><span class="op" id="3685520">.</span><span class="ident" id="3685521">Len</span><span class="op" id="3685524">(</span><span class="op" id="3685525">)</span>&nbsp;<span class="op" id="3685527">-</span>&nbsp;<span class="ident" id="3685529"><a href="/encoding/json/encode.go.html#3683785">len0</a></span><span class="op" id="3685533">,</span>&nbsp;<span class="ident" id="3685535">nil</span><br>
<span class="lineno"></span><span class="op" id="3685539">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="comment" id="3685542">//&nbsp;A&nbsp;field&nbsp;represents&nbsp;a&nbsp;single&nbsp;field&nbsp;found&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="3685598">type</span>&nbsp;<span class="ident" id="3685603">field</span>&nbsp;<span class="keyword" id="3685609">struct</span>&nbsp;<span class="op" id="3685616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685619">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3685629">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685637">nameBytes</span>&nbsp;<span class="op" id="3685647">[</span><span class="op" id="3685648">]</span><span class="builtintype" id="3685649">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3685670">//&nbsp;[]byte(name)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685687">equalFold</span>&nbsp;<span class="keyword" id="3685697">func</span><span class="op" id="3685701">(</span><span class="ident" id="3685702">s</span><span class="op" id="3685703">,</span>&nbsp;<span class="ident" id="3685705">t</span>&nbsp;<span class="op" id="3685707">[</span><span class="op" id="3685708">]</span><span class="builtintype" id="3685709">byte</span><span class="op" id="3685713">)</span>&nbsp;<span class="builtintype" id="3685715">bool</span>&nbsp;<span class="comment" id="3685720">//&nbsp;bytes.EqualFold&nbsp;or&nbsp;equivalent</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685755">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3685765">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685771">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3685781">[</span><span class="op" id="3685782">]</span><span class="builtintype" id="3685783">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685788">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3685798"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3685805">.</span><span class="ident" id="3685806">Type</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685812">omitEmpty</span>&nbsp;<span class="builtintype" id="3685822">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685828">quoted</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3685838">bool</span><br>
<span class="lineno"></span><span class="op" id="3685843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3685846">func</span>&nbsp;<span class="ident" id="3685851">fillField</span><span class="op" id="3685860">(</span><span class="ident" id="3685861">f</span>&nbsp;<span class="ident" id="3685863"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3685868">)</span>&nbsp;<span class="ident" id="3685870"><a href="/encoding/json/encode.go.html#3685603">field</a></span>&nbsp;<span class="op" id="3685876">{</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685879"><a href="/encoding/json/encode.go.html#3685861">f</a></span><span class="op" id="3685880">.</span><span class="ident" id="3685881">nameBytes</span>&nbsp;<span class="op" id="3685891">=</span>&nbsp;<span class="op" id="3685893">[</span><span class="op" id="3685894">]</span><span class="builtintype" id="3685895">byte</span><span class="op" id="3685899">(</span><span class="ident" id="3685900"><a href="/encoding/json/encode.go.html#3685861">f</a></span><span class="op" id="3685901">.</span><span class="ident" id="3685902">name</span><span class="op" id="3685906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3685909"><a href="/encoding/json/encode.go.html#3685861">f</a></span><span class="op" id="3685910">.</span><span class="ident" id="3685911">equalFold</span>&nbsp;<span class="op" id="3685921">=</span>&nbsp;<span class="ident" id="3685923"><a href="/encoding/json/fold.go.html#3693150">foldFunc</a></span><span class="op" id="3685931">(</span><span class="ident" id="3685932"><a href="/encoding/json/encode.go.html#3685861">f</a></span><span class="op" id="3685933">.</span><span class="ident" id="3685934">nameBytes</span><span class="op" id="3685943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3685946">return</span>&nbsp;<span class="ident" id="3685953"><a href="/encoding/json/encode.go.html#3685861">f</a></span><br>
<span class="lineno"></span><span class="op" id="3685955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span><span class="comment" id="3685958">//&nbsp;byName&nbsp;sorts&nbsp;field&nbsp;by&nbsp;name,&nbsp;breaking&nbsp;ties&nbsp;with&nbsp;depth,</span><br>
<span class="lineno"></span><span class="comment" id="3686015">//&nbsp;then&nbsp;breaking&nbsp;ties&nbsp;with&nbsp;&#34;name&nbsp;came&nbsp;from&nbsp;json&nbsp;tag&#34;,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="3686074">//&nbsp;breaking&nbsp;ties&nbsp;with&nbsp;index&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="keyword" id="3686112">type</span>&nbsp;<span class="ident" id="3686117">byName</span>&nbsp;<span class="op" id="3686124">[</span><span class="op" id="3686125">]</span><span class="ident" id="3686126"><a href="/encoding/json/encode.go.html#3685603">field</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">960</span><span class="keyword" id="3686133">func</span>&nbsp;<span class="op" id="3686138">(</span><span class="ident" id="3686139">x</span>&nbsp;<span class="ident" id="3686141"><a href="/encoding/json/encode.go.html#3686117">byName</a></span><span class="op" id="3686147">)</span>&nbsp;<span class="ident" id="3686149">Len</span><span class="op" id="3686152">(</span><span class="op" id="3686153">)</span>&nbsp;<span class="builtintype" id="3686155">int</span>&nbsp;<span class="op" id="3686159">{</span>&nbsp;<span class="keyword" id="3686161">return</span>&nbsp;<span class="builtinfunc" id="3686168">len</span><span class="op" id="3686171">(</span><span class="ident" id="3686172"><a href="/encoding/json/encode.go.html#3686139">x</a></span><span class="op" id="3686173">)</span>&nbsp;<span class="op" id="3686175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3686178">func</span>&nbsp;<span class="op" id="3686183">(</span><span class="ident" id="3686184">x</span>&nbsp;<span class="ident" id="3686186"><a href="/encoding/json/encode.go.html#3686117">byName</a></span><span class="op" id="3686192">)</span>&nbsp;<span class="ident" id="3686194">Swap</span><span class="op" id="3686198">(</span><span class="ident" id="3686199">i</span><span class="op" id="3686200">,</span>&nbsp;<span class="ident" id="3686202">j</span>&nbsp;<span class="builtintype" id="3686204">int</span><span class="op" id="3686207">)</span>&nbsp;<span class="op" id="3686209">{</span>&nbsp;<span class="ident" id="3686211"><a href="/encoding/json/encode.go.html#3686184">x</a></span><span class="op" id="3686212">[</span><span class="ident" id="3686213"><a href="/encoding/json/encode.go.html#3686199">i</a></span><span class="op" id="3686214">]</span><span class="op" id="3686215">,</span>&nbsp;<span class="ident" id="3686217"><a href="/encoding/json/encode.go.html#3686184">x</a></span><span class="op" id="3686218">[</span><span class="ident" id="3686219"><a href="/encoding/json/encode.go.html#3686202">j</a></span><span class="op" id="3686220">]</span>&nbsp;<span class="op" id="3686222">=</span>&nbsp;<span class="ident" id="3686224"><a href="/encoding/json/encode.go.html#3686184">x</a></span><span class="op" id="3686225">[</span><span class="ident" id="3686226"><a href="/encoding/json/encode.go.html#3686202">j</a></span><span class="op" id="3686227">]</span><span class="op" id="3686228">,</span>&nbsp;<span class="ident" id="3686230"><a href="/encoding/json/encode.go.html#3686184">x</a></span><span class="op" id="3686231">[</span><span class="ident" id="3686232"><a href="/encoding/json/encode.go.html#3686199">i</a></span><span class="op" id="3686233">]</span>&nbsp;<span class="op" id="3686235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3686238">func</span>&nbsp;<span class="op" id="3686243">(</span><span class="ident" id="3686244">x</span>&nbsp;<span class="ident" id="3686246"><a href="/encoding/json/encode.go.html#3686117">byName</a></span><span class="op" id="3686252">)</span>&nbsp;<span class="ident" id="3686254">Less</span><span class="op" id="3686258">(</span><span class="ident" id="3686259">i</span><span class="op" id="3686260">,</span>&nbsp;<span class="ident" id="3686262">j</span>&nbsp;<span class="builtintype" id="3686264">int</span><span class="op" id="3686267">)</span>&nbsp;<span class="builtintype" id="3686269">bool</span>&nbsp;<span class="op" id="3686274">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686277">if</span>&nbsp;<span class="ident" id="3686280"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686281">[</span><span class="ident" id="3686282"><a href="/encoding/json/encode.go.html#3686259">i</a></span><span class="op" id="3686283">]</span><span class="op" id="3686284">.</span><span class="ident" id="3686285">name</span>&nbsp;<span class="op" id="3686290">!=</span>&nbsp;<span class="ident" id="3686293"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686294">[</span><span class="ident" id="3686295"><a href="/encoding/json/encode.go.html#3686262">j</a></span><span class="op" id="3686296">]</span><span class="op" id="3686297">.</span><span class="ident" id="3686298">name</span>&nbsp;<span class="op" id="3686303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686307">return</span>&nbsp;<span class="ident" id="3686314"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686315">[</span><span class="ident" id="3686316"><a href="/encoding/json/encode.go.html#3686259">i</a></span><span class="op" id="3686317">]</span><span class="op" id="3686318">.</span><span class="ident" id="3686319">name</span>&nbsp;<span class="op" id="3686324">&lt;</span>&nbsp;<span class="ident" id="3686326"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686327">[</span><span class="ident" id="3686328"><a href="/encoding/json/encode.go.html#3686262">j</a></span><span class="op" id="3686329">]</span><span class="op" id="3686330">.</span><span class="ident" id="3686331">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3686337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686340">if</span>&nbsp;<span class="builtinfunc" id="3686343">len</span><span class="op" id="3686346">(</span><span class="ident" id="3686347"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686348">[</span><span class="ident" id="3686349"><a href="/encoding/json/encode.go.html#3686259">i</a></span><span class="op" id="3686350">]</span><span class="op" id="3686351">.</span><span class="ident" id="3686352">index</span><span class="op" id="3686357">)</span>&nbsp;<span class="op" id="3686359">!=</span>&nbsp;<span class="builtinfunc" id="3686362">len</span><span class="op" id="3686365">(</span><span class="ident" id="3686366"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686367">[</span><span class="ident" id="3686368"><a href="/encoding/json/encode.go.html#3686262">j</a></span><span class="op" id="3686369">]</span><span class="op" id="3686370">.</span><span class="ident" id="3686371">index</span><span class="op" id="3686376">)</span>&nbsp;<span class="op" id="3686378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686382">return</span>&nbsp;<span class="builtinfunc" id="3686389">len</span><span class="op" id="3686392">(</span><span class="ident" id="3686393"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686394">[</span><span class="ident" id="3686395"><a href="/encoding/json/encode.go.html#3686259">i</a></span><span class="op" id="3686396">]</span><span class="op" id="3686397">.</span><span class="ident" id="3686398">index</span><span class="op" id="3686403">)</span>&nbsp;<span class="op" id="3686405">&lt;</span>&nbsp;<span class="builtinfunc" id="3686407">len</span><span class="op" id="3686410">(</span><span class="ident" id="3686411"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686412">[</span><span class="ident" id="3686413"><a href="/encoding/json/encode.go.html#3686262">j</a></span><span class="op" id="3686414">]</span><span class="op" id="3686415">.</span><span class="ident" id="3686416">index</span><span class="op" id="3686421">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3686424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686427">if</span>&nbsp;<span class="ident" id="3686430"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686431">[</span><span class="ident" id="3686432"><a href="/encoding/json/encode.go.html#3686259">i</a></span><span class="op" id="3686433">]</span><span class="op" id="3686434">.</span><span class="ident" id="3686435">tag</span>&nbsp;<span class="op" id="3686439">!=</span>&nbsp;<span class="ident" id="3686442"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686443">[</span><span class="ident" id="3686444"><a href="/encoding/json/encode.go.html#3686262">j</a></span><span class="op" id="3686445">]</span><span class="op" id="3686446">.</span><span class="ident" id="3686447">tag</span>&nbsp;<span class="op" id="3686451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686455">return</span>&nbsp;<span class="ident" id="3686462"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686463">[</span><span class="ident" id="3686464"><a href="/encoding/json/encode.go.html#3686259">i</a></span><span class="op" id="3686465">]</span><span class="op" id="3686466">.</span><span class="ident" id="3686467">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3686472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686475">return</span>&nbsp;<span class="ident" id="3686482"><a href="/encoding/json/encode.go.html#3686554">byIndex</a></span><span class="op" id="3686489">(</span><span class="ident" id="3686490"><a href="/encoding/json/encode.go.html#3686244">x</a></span><span class="op" id="3686491">)</span><span class="op" id="3686492">.</span><span class="ident" id="3686493">Less</span><span class="op" id="3686497">(</span><span class="ident" id="3686498"><a href="/encoding/json/encode.go.html#3686259">i</a></span><span class="op" id="3686499">,</span>&nbsp;<span class="ident" id="3686501"><a href="/encoding/json/encode.go.html#3686262">j</a></span><span class="op" id="3686502">)</span><br>
<span class="lineno">975</span><span class="op" id="3686504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3686507">//&nbsp;byIndex&nbsp;sorts&nbsp;field&nbsp;by&nbsp;index&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="keyword" id="3686549">type</span>&nbsp;<span class="ident" id="3686554">byIndex</span>&nbsp;<span class="op" id="3686562">[</span><span class="op" id="3686563">]</span><span class="ident" id="3686564"><a href="/encoding/json/encode.go.html#3685603">field</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">980</span><span class="keyword" id="3686571">func</span>&nbsp;<span class="op" id="3686576">(</span><span class="ident" id="3686577">x</span>&nbsp;<span class="ident" id="3686579"><a href="/encoding/json/encode.go.html#3686554">byIndex</a></span><span class="op" id="3686586">)</span>&nbsp;<span class="ident" id="3686588">Len</span><span class="op" id="3686591">(</span><span class="op" id="3686592">)</span>&nbsp;<span class="builtintype" id="3686594">int</span>&nbsp;<span class="op" id="3686598">{</span>&nbsp;<span class="keyword" id="3686600">return</span>&nbsp;<span class="builtinfunc" id="3686607">len</span><span class="op" id="3686610">(</span><span class="ident" id="3686611"><a href="/encoding/json/encode.go.html#3686577">x</a></span><span class="op" id="3686612">)</span>&nbsp;<span class="op" id="3686614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3686617">func</span>&nbsp;<span class="op" id="3686622">(</span><span class="ident" id="3686623">x</span>&nbsp;<span class="ident" id="3686625"><a href="/encoding/json/encode.go.html#3686554">byIndex</a></span><span class="op" id="3686632">)</span>&nbsp;<span class="ident" id="3686634">Swap</span><span class="op" id="3686638">(</span><span class="ident" id="3686639">i</span><span class="op" id="3686640">,</span>&nbsp;<span class="ident" id="3686642">j</span>&nbsp;<span class="builtintype" id="3686644">int</span><span class="op" id="3686647">)</span>&nbsp;<span class="op" id="3686649">{</span>&nbsp;<span class="ident" id="3686651"><a href="/encoding/json/encode.go.html#3686623">x</a></span><span class="op" id="3686652">[</span><span class="ident" id="3686653"><a href="/encoding/json/encode.go.html#3686639">i</a></span><span class="op" id="3686654">]</span><span class="op" id="3686655">,</span>&nbsp;<span class="ident" id="3686657"><a href="/encoding/json/encode.go.html#3686623">x</a></span><span class="op" id="3686658">[</span><span class="ident" id="3686659"><a href="/encoding/json/encode.go.html#3686642">j</a></span><span class="op" id="3686660">]</span>&nbsp;<span class="op" id="3686662">=</span>&nbsp;<span class="ident" id="3686664"><a href="/encoding/json/encode.go.html#3686623">x</a></span><span class="op" id="3686665">[</span><span class="ident" id="3686666"><a href="/encoding/json/encode.go.html#3686642">j</a></span><span class="op" id="3686667">]</span><span class="op" id="3686668">,</span>&nbsp;<span class="ident" id="3686670"><a href="/encoding/json/encode.go.html#3686623">x</a></span><span class="op" id="3686671">[</span><span class="ident" id="3686672"><a href="/encoding/json/encode.go.html#3686639">i</a></span><span class="op" id="3686673">]</span>&nbsp;<span class="op" id="3686675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3686678">func</span>&nbsp;<span class="op" id="3686683">(</span><span class="ident" id="3686684">x</span>&nbsp;<span class="ident" id="3686686"><a href="/encoding/json/encode.go.html#3686554">byIndex</a></span><span class="op" id="3686693">)</span>&nbsp;<span class="ident" id="3686695">Less</span><span class="op" id="3686699">(</span><span class="ident" id="3686700">i</span><span class="op" id="3686701">,</span>&nbsp;<span class="ident" id="3686703">j</span>&nbsp;<span class="builtintype" id="3686705">int</span><span class="op" id="3686708">)</span>&nbsp;<span class="builtintype" id="3686710">bool</span>&nbsp;<span class="op" id="3686715">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686718">for</span>&nbsp;<span class="ident" id="3686722">k</span><span class="op" id="3686723">,</span>&nbsp;<span class="ident" id="3686725">xik</span>&nbsp;<span class="op" id="3686729">:=</span>&nbsp;<span class="keyword" id="3686732">range</span>&nbsp;<span class="ident" id="3686738"><a href="/encoding/json/encode.go.html#3686684">x</a></span><span class="op" id="3686739">[</span><span class="ident" id="3686740"><a href="/encoding/json/encode.go.html#3686700">i</a></span><span class="op" id="3686741">]</span><span class="op" id="3686742">.</span><span class="ident" id="3686743">index</span>&nbsp;<span class="op" id="3686749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686753">if</span>&nbsp;<span class="ident" id="3686756"><a href="/encoding/json/encode.go.html#3686722">k</a></span>&nbsp;<span class="op" id="3686758">&gt;=</span>&nbsp;<span class="builtinfunc" id="3686761">len</span><span class="op" id="3686764">(</span><span class="ident" id="3686765"><a href="/encoding/json/encode.go.html#3686684">x</a></span><span class="op" id="3686766">[</span><span class="ident" id="3686767"><a href="/encoding/json/encode.go.html#3686703">j</a></span><span class="op" id="3686768">]</span><span class="op" id="3686769">.</span><span class="ident" id="3686770">index</span><span class="op" id="3686775">)</span>&nbsp;<span class="op" id="3686777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686782">return</span>&nbsp;<span class="ident" id="3686789">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3686797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686801">if</span>&nbsp;<span class="ident" id="3686804"><a href="/encoding/json/encode.go.html#3686725">xik</a></span>&nbsp;<span class="op" id="3686808">!=</span>&nbsp;<span class="ident" id="3686811"><a href="/encoding/json/encode.go.html#3686684">x</a></span><span class="op" id="3686812">[</span><span class="ident" id="3686813"><a href="/encoding/json/encode.go.html#3686703">j</a></span><span class="op" id="3686814">]</span><span class="op" id="3686815">.</span><span class="ident" id="3686816">index</span><span class="op" id="3686821">[</span><span class="ident" id="3686822"><a href="/encoding/json/encode.go.html#3686722">k</a></span><span class="op" id="3686823">]</span>&nbsp;<span class="op" id="3686825">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686830">return</span>&nbsp;<span class="ident" id="3686837"><a href="/encoding/json/encode.go.html#3686725">xik</a></span>&nbsp;<span class="op" id="3686841">&lt;</span>&nbsp;<span class="ident" id="3686843"><a href="/encoding/json/encode.go.html#3686684">x</a></span><span class="op" id="3686844">[</span><span class="ident" id="3686845"><a href="/encoding/json/encode.go.html#3686703">j</a></span><span class="op" id="3686846">]</span><span class="op" id="3686847">.</span><span class="ident" id="3686848">index</span><span class="op" id="3686853">[</span><span class="ident" id="3686854"><a href="/encoding/json/encode.go.html#3686722">k</a></span><span class="op" id="3686855">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3686859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3686862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3686865">return</span>&nbsp;<span class="builtinfunc" id="3686872">len</span><span class="op" id="3686875">(</span><span class="ident" id="3686876"><a href="/encoding/json/encode.go.html#3686684">x</a></span><span class="op" id="3686877">[</span><span class="ident" id="3686878"><a href="/encoding/json/encode.go.html#3686700">i</a></span><span class="op" id="3686879">]</span><span class="op" id="3686880">.</span><span class="ident" id="3686881">index</span><span class="op" id="3686886">)</span>&nbsp;<span class="op" id="3686888">&lt;</span>&nbsp;<span class="builtinfunc" id="3686890">len</span><span class="op" id="3686893">(</span><span class="ident" id="3686894"><a href="/encoding/json/encode.go.html#3686684">x</a></span><span class="op" id="3686895">[</span><span class="ident" id="3686896"><a href="/encoding/json/encode.go.html#3686703">j</a></span><span class="op" id="3686897">]</span><span class="op" id="3686898">.</span><span class="ident" id="3686899">index</span><span class="op" id="3686904">)</span><br>
<span class="lineno"></span><span class="op" id="3686906">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="comment" id="3686909">//&nbsp;typeFields&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;fields&nbsp;that&nbsp;JSON&nbsp;should&nbsp;recognize&nbsp;for&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="3686995">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth-first&nbsp;search&nbsp;over&nbsp;the&nbsp;set&nbsp;of&nbsp;structs&nbsp;to&nbsp;include&nbsp;-&nbsp;the&nbsp;top&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="3687088">//&nbsp;and&nbsp;then&nbsp;any&nbsp;reachable&nbsp;anonymous&nbsp;structs.</span><br>
<span class="lineno"></span><span class="keyword" id="3687133">func</span>&nbsp;<span class="ident" id="3687138">typeFields</span><span class="op" id="3687148">(</span><span class="ident" id="3687149">t</span>&nbsp;<span class="ident" id="3687151"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3687158">.</span><span class="ident" id="3687159">Type</span><span class="op" id="3687163">)</span>&nbsp;<span class="op" id="3687165">[</span><span class="op" id="3687166">]</span><span class="ident" id="3687167"><a href="/encoding/json/encode.go.html#3685603">field</a></span>&nbsp;<span class="op" id="3687173">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3687176">//&nbsp;Anonymous&nbsp;fields&nbsp;to&nbsp;explore&nbsp;at&nbsp;the&nbsp;current&nbsp;level&nbsp;and&nbsp;the&nbsp;next.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687243">current</span>&nbsp;<span class="op" id="3687251">:=</span>&nbsp;<span class="op" id="3687254">[</span><span class="op" id="3687255">]</span><span class="ident" id="3687256"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3687261">{</span><span class="op" id="3687262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687265">next</span>&nbsp;<span class="op" id="3687270">:=</span>&nbsp;<span class="op" id="3687273">[</span><span class="op" id="3687274">]</span><span class="ident" id="3687275"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3687280">{</span><span class="op" id="3687281">{</span><span class="ident" id="3687282">typ</span><span class="op" id="3687285">:</span>&nbsp;<span class="ident" id="3687287"><a href="/encoding/json/encode.go.html#3687149">t</a></span><span class="op" id="3687288">}</span><span class="op" id="3687289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3687293">//&nbsp;Count&nbsp;of&nbsp;queued&nbsp;names&nbsp;for&nbsp;current&nbsp;level&nbsp;and&nbsp;the&nbsp;next.</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687351">count</span>&nbsp;<span class="op" id="3687357">:=</span>&nbsp;<span class="keyword" id="3687360">map</span><span class="op" id="3687363">[</span><span class="ident" id="3687364"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3687371">.</span><span class="ident" id="3687372">Type</span><span class="op" id="3687376">]</span><span class="builtintype" id="3687377">int</span><span class="op" id="3687380">{</span><span class="op" id="3687381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687384">nextCount</span>&nbsp;<span class="op" id="3687394">:=</span>&nbsp;<span class="keyword" id="3687397">map</span><span class="op" id="3687400">[</span><span class="ident" id="3687401"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3687408">.</span><span class="ident" id="3687409">Type</span><span class="op" id="3687413">]</span><span class="builtintype" id="3687414">int</span><span class="op" id="3687417">{</span><span class="op" id="3687418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3687422">//&nbsp;Types&nbsp;already&nbsp;visited&nbsp;at&nbsp;an&nbsp;earlier&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687469">visited</span>&nbsp;<span class="op" id="3687477">:=</span>&nbsp;<span class="keyword" id="3687480">map</span><span class="op" id="3687483">[</span><span class="ident" id="3687484"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3687491">.</span><span class="ident" id="3687492">Type</span><span class="op" id="3687496">]</span><span class="builtintype" id="3687497">bool</span><span class="op" id="3687501">{</span><span class="op" id="3687502">}</span><br>
<span class="lineno">1010</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3687506">//&nbsp;Fields&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3687524">var</span>&nbsp;<span class="ident" id="3687528">fields</span>&nbsp;<span class="op" id="3687535">[</span><span class="op" id="3687536">]</span><span class="ident" id="3687537"><a href="/encoding/json/encode.go.html#3685603">field</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3687545">for</span>&nbsp;<span class="builtinfunc" id="3687549">len</span><span class="op" id="3687552">(</span><span class="ident" id="3687553"><a href="/encoding/json/encode.go.html#3687265">next</a></span><span class="op" id="3687557">)</span>&nbsp;<span class="op" id="3687559">&gt;</span>&nbsp;<span class="num" id="3687561">0</span>&nbsp;<span class="op" id="3687563">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687567"><a href="/encoding/json/encode.go.html#3687243">current</a></span><span class="op" id="3687574">,</span>&nbsp;<span class="ident" id="3687576"><a href="/encoding/json/encode.go.html#3687265">next</a></span>&nbsp;<span class="op" id="3687581">=</span>&nbsp;<span class="ident" id="3687583"><a href="/encoding/json/encode.go.html#3687265">next</a></span><span class="op" id="3687587">,</span>&nbsp;<span class="ident" id="3687589"><a href="/encoding/json/encode.go.html#3687243">current</a></span><span class="op" id="3687596">[</span><span class="op" id="3687597">:</span><span class="num" id="3687598">0</span><span class="op" id="3687599">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687603"><a href="/encoding/json/encode.go.html#3687351">count</a></span><span class="op" id="3687608">,</span>&nbsp;<span class="ident" id="3687610"><a href="/encoding/json/encode.go.html#3687384">nextCount</a></span>&nbsp;<span class="op" id="3687620">=</span>&nbsp;<span class="ident" id="3687622"><a href="/encoding/json/encode.go.html#3687384">nextCount</a></span><span class="op" id="3687631">,</span>&nbsp;<span class="keyword" id="3687633">map</span><span class="op" id="3687636">[</span><span class="ident" id="3687637"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3687644">.</span><span class="ident" id="3687645">Type</span><span class="op" id="3687649">]</span><span class="builtintype" id="3687650">int</span><span class="op" id="3687653">{</span><span class="op" id="3687654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3687659">for</span>&nbsp;<span class="ident" id="3687663">_</span><span class="op" id="3687664">,</span>&nbsp;<span class="ident" id="3687666">f</span>&nbsp;<span class="op" id="3687668">:=</span>&nbsp;<span class="keyword" id="3687671">range</span>&nbsp;<span class="ident" id="3687677"><a href="/encoding/json/encode.go.html#3687243">current</a></span>&nbsp;<span class="op" id="3687685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3687690">if</span>&nbsp;<span class="ident" id="3687693"><a href="/encoding/json/encode.go.html#3687469">visited</a></span><span class="op" id="3687700">[</span><span class="ident" id="3687701"><a href="/encoding/json/encode.go.html#3687666">f</a></span><span class="op" id="3687702">.</span><span class="ident" id="3687703">typ</span><span class="op" id="3687706">]</span>&nbsp;<span class="op" id="3687708">{</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3687714">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3687726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687731"><a href="/encoding/json/encode.go.html#3687469">visited</a></span><span class="op" id="3687738">[</span><span class="ident" id="3687739"><a href="/encoding/json/encode.go.html#3687666">f</a></span><span class="op" id="3687740">.</span><span class="ident" id="3687741">typ</span><span class="op" id="3687744">]</span>&nbsp;<span class="op" id="3687746">=</span>&nbsp;<span class="ident" id="3687748">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3687757">//&nbsp;Scan&nbsp;f.typ&nbsp;for&nbsp;fields&nbsp;to&nbsp;include.</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3687797">for</span>&nbsp;<span class="ident" id="3687801">i</span>&nbsp;<span class="op" id="3687803">:=</span>&nbsp;<span class="num" id="3687806">0</span><span class="op" id="3687807">;</span>&nbsp;<span class="ident" id="3687809"><a href="/encoding/json/encode.go.html#3687801">i</a></span>&nbsp;<span class="op" id="3687811">&lt;</span>&nbsp;<span class="ident" id="3687813"><a href="/encoding/json/encode.go.html#3687666">f</a></span><span class="op" id="3687814">.</span><span class="ident" id="3687815">typ</span><span class="op" id="3687818">.</span><span class="ident" id="3687819">NumField</span><span class="op" id="3687827">(</span><span class="op" id="3687828">)</span><span class="op" id="3687829">;</span>&nbsp;<span class="ident" id="3687831"><a href="/encoding/json/encode.go.html#3687801">i</a></span><span class="op" id="3687832">++</span>&nbsp;<span class="op" id="3687835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687841">sf</span>&nbsp;<span class="op" id="3687844">:=</span>&nbsp;<span class="ident" id="3687847"><a href="/encoding/json/encode.go.html#3687666">f</a></span><span class="op" id="3687848">.</span><span class="ident" id="3687849">typ</span><span class="op" id="3687852">.</span><span class="ident" id="3687853">Field</span><span class="op" id="3687858">(</span><span class="ident" id="3687859"><a href="/encoding/json/encode.go.html#3687801">i</a></span><span class="op" id="3687860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3687866">if</span>&nbsp;<span class="ident" id="3687869"><a href="/encoding/json/encode.go.html#3687841">sf</a></span><span class="op" id="3687871">.</span><span class="ident" id="3687872">PkgPath</span>&nbsp;<span class="op" id="3687880">!=</span>&nbsp;<span class="string" id="3687883">&#34;&#34;</span>&nbsp;<span class="op" id="3687886">{</span>&nbsp;<span class="comment" id="3687888">//&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3687907">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3687920">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687926">tag</span>&nbsp;<span class="op" id="3687930">:=</span>&nbsp;<span class="ident" id="3687933"><a href="/encoding/json/encode.go.html#3687841">sf</a></span><span class="op" id="3687935">.</span><span class="ident" id="3687936">Tag</span><span class="op" id="3687939">.</span><span class="ident" id="3687940">Get</span><span class="op" id="3687943">(</span><span class="string" id="3687944">&#34;json&#34;</span><span class="op" id="3687950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3687956">if</span>&nbsp;<span class="ident" id="3687959"><a href="/encoding/json/encode.go.html#3687926">tag</a></span>&nbsp;<span class="op" id="3687963">==</span>&nbsp;<span class="string" id="3687966">&#34;-&#34;</span>&nbsp;<span class="op" id="3687970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3687977">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3687990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687996">name</span><span class="op" id="3688000">,</span>&nbsp;<span class="ident" id="3688002">opts</span>&nbsp;<span class="op" id="3688007">:=</span>&nbsp;<span class="ident" id="3688010"><a href="/encoding/json/tags.go.html#3720683">parseTag</a></span><span class="op" id="3688018">(</span><span class="ident" id="3688019"><a href="/encoding/json/encode.go.html#3687926">tag</a></span><span class="op" id="3688022">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688028">if</span>&nbsp;<span class="op" id="3688031">!</span><span class="ident" id="3688032"><a href="/encoding/json/encode.go.html#3680567">isValidTag</a></span><span class="op" id="3688042">(</span><span class="ident" id="3688043"><a href="/encoding/json/encode.go.html#3687996">name</a></span><span class="op" id="3688047">)</span>&nbsp;<span class="op" id="3688049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688056"><a href="/encoding/json/encode.go.html#3687996">name</a></span>&nbsp;<span class="op" id="3688061">=</span>&nbsp;<span class="string" id="3688063">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688076">index</span>&nbsp;<span class="op" id="3688082">:=</span>&nbsp;<span class="builtinfunc" id="3688085">make</span><span class="op" id="3688089">(</span><span class="op" id="3688090">[</span><span class="op" id="3688091">]</span><span class="builtintype" id="3688092">int</span><span class="op" id="3688095">,</span>&nbsp;<span class="builtinfunc" id="3688097">len</span><span class="op" id="3688100">(</span><span class="ident" id="3688101"><a href="/encoding/json/encode.go.html#3687666">f</a></span><span class="op" id="3688102">.</span><span class="ident" id="3688103">index</span><span class="op" id="3688108">)</span><span class="op" id="3688109">+</span><span class="num" id="3688110">1</span><span class="op" id="3688111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3688117">copy</span><span class="op" id="3688121">(</span><span class="ident" id="3688122"><a href="/encoding/json/encode.go.html#3688076">index</a></span><span class="op" id="3688127">,</span>&nbsp;<span class="ident" id="3688129"><a href="/encoding/json/encode.go.html#3687666">f</a></span><span class="op" id="3688130">.</span><span class="ident" id="3688131">index</span><span class="op" id="3688136">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688142"><a href="/encoding/json/encode.go.html#3688076">index</a></span><span class="op" id="3688147">[</span><span class="builtinfunc" id="3688148">len</span><span class="op" id="3688151">(</span><span class="ident" id="3688152"><a href="/encoding/json/encode.go.html#3687666">f</a></span><span class="op" id="3688153">.</span><span class="ident" id="3688154">index</span><span class="op" id="3688159">)</span><span class="op" id="3688160">]</span>&nbsp;<span class="op" id="3688162">=</span>&nbsp;<span class="ident" id="3688164"><a href="/encoding/json/encode.go.html#3687801">i</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688171">ft</span>&nbsp;<span class="op" id="3688174">:=</span>&nbsp;<span class="ident" id="3688177"><a href="/encoding/json/encode.go.html#3687841">sf</a></span><span class="op" id="3688179">.</span><span class="ident" id="3688180">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688189">if</span>&nbsp;<span class="ident" id="3688192"><a href="/encoding/json/encode.go.html#3688171">ft</a></span><span class="op" id="3688194">.</span><span class="ident" id="3688195">Name</span><span class="op" id="3688199">(</span><span class="op" id="3688200">)</span>&nbsp;<span class="op" id="3688202">==</span>&nbsp;<span class="string" id="3688205">&#34;&#34;</span>&nbsp;<span class="op" id="3688208">&amp;&amp;</span>&nbsp;<span class="ident" id="3688211"><a href="/encoding/json/encode.go.html#3688171">ft</a></span><span class="op" id="3688213">.</span><span class="ident" id="3688214">Kind</span><span class="op" id="3688218">(</span><span class="op" id="3688219">)</span>&nbsp;<span class="op" id="3688221">==</span>&nbsp;<span class="ident" id="3688224"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3688231">.</span><span class="ident" id="3688232">Ptr</span>&nbsp;<span class="op" id="3688236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3688243">//&nbsp;Follow&nbsp;pointer.</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688267"><a href="/encoding/json/encode.go.html#3688171">ft</a></span>&nbsp;<span class="op" id="3688270">=</span>&nbsp;<span class="ident" id="3688272"><a href="/encoding/json/encode.go.html#3688171">ft</a></span><span class="op" id="3688274">.</span><span class="ident" id="3688275">Elem</span><span class="op" id="3688279">(</span><span class="op" id="3688280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3688293">//&nbsp;Record&nbsp;found&nbsp;field&nbsp;and&nbsp;index&nbsp;sequence.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688339">if</span>&nbsp;<span class="ident" id="3688342"><a href="/encoding/json/encode.go.html#3687996">name</a></span>&nbsp;<span class="op" id="3688347">!=</span>&nbsp;<span class="string" id="3688350">&#34;&#34;</span>&nbsp;<span class="op" id="3688353">||</span>&nbsp;<span class="op" id="3688356">!</span><span class="ident" id="3688357"><a href="/encoding/json/encode.go.html#3687841">sf</a></span><span class="op" id="3688359">.</span><span class="ident" id="3688360">Anonymous</span>&nbsp;<span class="op" id="3688370">||</span>&nbsp;<span class="ident" id="3688373"><a href="/encoding/json/encode.go.html#3688171">ft</a></span><span class="op" id="3688375">.</span><span class="ident" id="3688376">Kind</span><span class="op" id="3688380">(</span><span class="op" id="3688381">)</span>&nbsp;<span class="op" id="3688383">!=</span>&nbsp;<span class="ident" id="3688386"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3688393">.</span><span class="ident" id="3688394">Struct</span>&nbsp;<span class="op" id="3688401">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688408">tagged</span>&nbsp;<span class="op" id="3688415">:=</span>&nbsp;<span class="ident" id="3688418"><a href="/encoding/json/encode.go.html#3687996">name</a></span>&nbsp;<span class="op" id="3688423">!=</span>&nbsp;<span class="string" id="3688426">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688434">if</span>&nbsp;<span class="ident" id="3688437"><a href="/encoding/json/encode.go.html#3687996">name</a></span>&nbsp;<span class="op" id="3688442">==</span>&nbsp;<span class="string" id="3688445">&#34;&#34;</span>&nbsp;<span class="op" id="3688448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688456"><a href="/encoding/json/encode.go.html#3687996">name</a></span>&nbsp;<span class="op" id="3688461">=</span>&nbsp;<span class="ident" id="3688463"><a href="/encoding/json/encode.go.html#3687841">sf</a></span><span class="op" id="3688465">.</span><span class="ident" id="3688466">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688483"><a href="/encoding/json/encode.go.html#3687528">fields</a></span>&nbsp;<span class="op" id="3688490">=</span>&nbsp;<span class="builtinfunc" id="3688492">append</span><span class="op" id="3688498">(</span><span class="ident" id="3688499"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3688505">,</span>&nbsp;<span class="ident" id="3688507"><a href="/encoding/json/encode.go.html#3685851">fillField</a></span><span class="op" id="3688516">(</span><span class="ident" id="3688517"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3688522">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688530">name</span><span class="op" id="3688534">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3688541"><a href="/encoding/json/encode.go.html#3687996">name</a></span><span class="op" id="3688545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688553">tag</span><span class="op" id="3688556">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3688564"><a href="/encoding/json/encode.go.html#3688408">tagged</a></span><span class="op" id="3688570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688578">index</span><span class="op" id="3688583">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3688589"><a href="/encoding/json/encode.go.html#3688076">index</a></span><span class="op" id="3688594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688602">typ</span><span class="op" id="3688605">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3688613"><a href="/encoding/json/encode.go.html#3688171">ft</a></span><span class="op" id="3688615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688623">omitEmpty</span><span class="op" id="3688632">:</span>&nbsp;<span class="ident" id="3688634"><a href="/encoding/json/encode.go.html#3688002">opts</a></span><span class="op" id="3688638">.</span><span class="ident" id="3688639">Contains</span><span class="op" id="3688647">(</span><span class="string" id="3688648">&#34;omitempty&#34;</span><span class="op" id="3688659">)</span><span class="op" id="3688660">,</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688668">quoted</span><span class="op" id="3688674">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3688679"><a href="/encoding/json/encode.go.html#3688002">opts</a></span><span class="op" id="3688683">.</span><span class="ident" id="3688684">Contains</span><span class="op" id="3688692">(</span><span class="string" id="3688693">&#34;string&#34;</span><span class="op" id="3688701">)</span><span class="op" id="3688702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688709">}</span><span class="op" id="3688710">)</span><span class="op" id="3688711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688718">if</span>&nbsp;<span class="ident" id="3688721"><a href="/encoding/json/encode.go.html#3687351">count</a></span><span class="op" id="3688726">[</span><span class="ident" id="3688727"><a href="/encoding/json/encode.go.html#3687666">f</a></span><span class="op" id="3688728">.</span><span class="ident" id="3688729">typ</span><span class="op" id="3688732">]</span>&nbsp;<span class="op" id="3688734">&gt;</span>&nbsp;<span class="num" id="3688736">1</span>&nbsp;<span class="op" id="3688738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3688746">//&nbsp;If&nbsp;there&nbsp;were&nbsp;multiple&nbsp;instances,&nbsp;add&nbsp;a&nbsp;second,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3688803">//&nbsp;so&nbsp;that&nbsp;the&nbsp;annihilation&nbsp;code&nbsp;will&nbsp;see&nbsp;a&nbsp;duplicate.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3688864">//&nbsp;It&nbsp;only&nbsp;cares&nbsp;about&nbsp;the&nbsp;distinction&nbsp;between&nbsp;1&nbsp;or&nbsp;2,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3688925">//&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;generating&nbsp;any&nbsp;more&nbsp;copies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688978"><a href="/encoding/json/encode.go.html#3687528">fields</a></span>&nbsp;<span class="op" id="3688985">=</span>&nbsp;<span class="builtinfunc" id="3688987">append</span><span class="op" id="3688993">(</span><span class="ident" id="3688994"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3689000">,</span>&nbsp;<span class="ident" id="3689002"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3689008">[</span><span class="builtinfunc" id="3689009">len</span><span class="op" id="3689012">(</span><span class="ident" id="3689013"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3689019">)</span><span class="op" id="3689020">-</span><span class="num" id="3689021">1</span><span class="op" id="3689022">]</span><span class="op" id="3689023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689037">continue</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3689057">//&nbsp;Record&nbsp;new&nbsp;anonymous&nbsp;struct&nbsp;to&nbsp;explore&nbsp;in&nbsp;next&nbsp;round.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689118"><a href="/encoding/json/encode.go.html#3687384">nextCount</a></span><span class="op" id="3689127">[</span><span class="ident" id="3689128"><a href="/encoding/json/encode.go.html#3688171">ft</a></span><span class="op" id="3689130">]</span><span class="op" id="3689131">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689138">if</span>&nbsp;<span class="ident" id="3689141"><a href="/encoding/json/encode.go.html#3687384">nextCount</a></span><span class="op" id="3689150">[</span><span class="ident" id="3689151"><a href="/encoding/json/encode.go.html#3688171">ft</a></span><span class="op" id="3689153">]</span>&nbsp;<span class="op" id="3689155">==</span>&nbsp;<span class="num" id="3689158">1</span>&nbsp;<span class="op" id="3689160">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689167"><a href="/encoding/json/encode.go.html#3687265">next</a></span>&nbsp;<span class="op" id="3689172">=</span>&nbsp;<span class="builtinfunc" id="3689174">append</span><span class="op" id="3689180">(</span><span class="ident" id="3689181"><a href="/encoding/json/encode.go.html#3687265">next</a></span><span class="op" id="3689185">,</span>&nbsp;<span class="ident" id="3689187"><a href="/encoding/json/encode.go.html#3685851">fillField</a></span><span class="op" id="3689196">(</span><span class="ident" id="3689197"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3689202">{</span><span class="ident" id="3689203">name</span><span class="op" id="3689207">:</span>&nbsp;<span class="ident" id="3689209"><a href="/encoding/json/encode.go.html#3688171">ft</a></span><span class="op" id="3689211">.</span><span class="ident" id="3689212">Name</span><span class="op" id="3689216">(</span><span class="op" id="3689217">)</span><span class="op" id="3689218">,</span>&nbsp;<span class="ident" id="3689220">index</span><span class="op" id="3689225">:</span>&nbsp;<span class="ident" id="3689227"><a href="/encoding/json/encode.go.html#3688076">index</a></span><span class="op" id="3689232">,</span>&nbsp;<span class="ident" id="3689234">typ</span><span class="op" id="3689237">:</span>&nbsp;<span class="ident" id="3689239"><a href="/encoding/json/encode.go.html#3688171">ft</a></span><span class="op" id="3689241">}</span><span class="op" id="3689242">)</span><span class="op" id="3689243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689261">}</span><br>
<span class="lineno">1080</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689265"><a href="/encoding/json/encode.go.html#3661714">sort</a></span><span class="op" id="3689269">.</span><span class="ident" id="3689270">Sort</span><span class="op" id="3689274">(</span><span class="ident" id="3689275"><a href="/encoding/json/encode.go.html#3686117">byName</a></span><span class="op" id="3689281">(</span><span class="ident" id="3689282"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3689288">)</span><span class="op" id="3689289">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3689293">//&nbsp;Delete&nbsp;all&nbsp;fields&nbsp;that&nbsp;are&nbsp;hidden&nbsp;by&nbsp;the&nbsp;Go&nbsp;rules&nbsp;for&nbsp;embedded&nbsp;fields,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3689368">//&nbsp;except&nbsp;that&nbsp;fields&nbsp;with&nbsp;JSON&nbsp;tags&nbsp;are&nbsp;promoted.</span><br>
<span class="lineno">1085</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3689421">//&nbsp;The&nbsp;fields&nbsp;are&nbsp;sorted&nbsp;in&nbsp;primary&nbsp;order&nbsp;of&nbsp;name,&nbsp;secondary&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3689489">//&nbsp;of&nbsp;field&nbsp;index&nbsp;length.&nbsp;Loop&nbsp;over&nbsp;names;&nbsp;for&nbsp;each&nbsp;name,&nbsp;delete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3689555">//&nbsp;hidden&nbsp;fields&nbsp;by&nbsp;choosing&nbsp;the&nbsp;one&nbsp;dominant&nbsp;field&nbsp;that&nbsp;survives.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689623">out</span>&nbsp;<span class="op" id="3689627">:=</span>&nbsp;<span class="ident" id="3689630"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3689636">[</span><span class="op" id="3689637">:</span><span class="num" id="3689638">0</span><span class="op" id="3689639">]</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689642">for</span>&nbsp;<span class="ident" id="3689646">advance</span><span class="op" id="3689653">,</span>&nbsp;<span class="ident" id="3689655">i</span>&nbsp;<span class="op" id="3689657">:=</span>&nbsp;<span class="num" id="3689660">0</span><span class="op" id="3689661">,</span>&nbsp;<span class="num" id="3689663">0</span><span class="op" id="3689664">;</span>&nbsp;<span class="ident" id="3689666"><a href="/encoding/json/encode.go.html#3689655">i</a></span>&nbsp;<span class="op" id="3689668">&lt;</span>&nbsp;<span class="builtinfunc" id="3689670">len</span><span class="op" id="3689673">(</span><span class="ident" id="3689674"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3689680">)</span><span class="op" id="3689681">;</span>&nbsp;<span class="ident" id="3689683"><a href="/encoding/json/encode.go.html#3689655">i</a></span>&nbsp;<span class="op" id="3689685">+=</span>&nbsp;<span class="ident" id="3689688"><a href="/encoding/json/encode.go.html#3689646">advance</a></span>&nbsp;<span class="op" id="3689696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3689700">//&nbsp;One&nbsp;iteration&nbsp;per&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3689729">//&nbsp;Find&nbsp;the&nbsp;sequence&nbsp;of&nbsp;fields&nbsp;with&nbsp;the&nbsp;name&nbsp;of&nbsp;this&nbsp;first&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689797">fi</span>&nbsp;<span class="op" id="3689800">:=</span>&nbsp;<span class="ident" id="3689803"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3689809">[</span><span class="ident" id="3689810"><a href="/encoding/json/encode.go.html#3689655">i</a></span><span class="op" id="3689811">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689815">name</span>&nbsp;<span class="op" id="3689820">:=</span>&nbsp;<span class="ident" id="3689823"><a href="/encoding/json/encode.go.html#3689797">fi</a></span><span class="op" id="3689825">.</span><span class="ident" id="3689826">name</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689833">for</span>&nbsp;<span class="ident" id="3689837"><a href="/encoding/json/encode.go.html#3689646">advance</a></span>&nbsp;<span class="op" id="3689845">=</span>&nbsp;<span class="num" id="3689847">1</span><span class="op" id="3689848">;</span>&nbsp;<span class="ident" id="3689850"><a href="/encoding/json/encode.go.html#3689655">i</a></span><span class="op" id="3689851">+</span><span class="ident" id="3689852"><a href="/encoding/json/encode.go.html#3689646">advance</a></span>&nbsp;<span class="op" id="3689860">&lt;</span>&nbsp;<span class="builtinfunc" id="3689862">len</span><span class="op" id="3689865">(</span><span class="ident" id="3689866"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3689872">)</span><span class="op" id="3689873">;</span>&nbsp;<span class="ident" id="3689875"><a href="/encoding/json/encode.go.html#3689646">advance</a></span><span class="op" id="3689882">++</span>&nbsp;<span class="op" id="3689885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689890">fj</span>&nbsp;<span class="op" id="3689893">:=</span>&nbsp;<span class="ident" id="3689896"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3689902">[</span><span class="ident" id="3689903"><a href="/encoding/json/encode.go.html#3689655">i</a></span><span class="op" id="3689904">+</span><span class="ident" id="3689905"><a href="/encoding/json/encode.go.html#3689646">advance</a></span><span class="op" id="3689912">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689917">if</span>&nbsp;<span class="ident" id="3689920"><a href="/encoding/json/encode.go.html#3689890">fj</a></span><span class="op" id="3689922">.</span><span class="ident" id="3689923">name</span>&nbsp;<span class="op" id="3689928">!=</span>&nbsp;<span class="ident" id="3689931"><a href="/encoding/json/encode.go.html#3689815">name</a></span>&nbsp;<span class="op" id="3689936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689942">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689951">}</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689959">if</span>&nbsp;<span class="ident" id="3689962"><a href="/encoding/json/encode.go.html#3689646">advance</a></span>&nbsp;<span class="op" id="3689970">==</span>&nbsp;<span class="num" id="3689973">1</span>&nbsp;<span class="op" id="3689975">{</span>&nbsp;<span class="comment" id="3689977">//&nbsp;Only&nbsp;one&nbsp;field&nbsp;with&nbsp;this&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690013"><a href="/encoding/json/encode.go.html#3689623">out</a></span>&nbsp;<span class="op" id="3690017">=</span>&nbsp;<span class="builtinfunc" id="3690019">append</span><span class="op" id="3690025">(</span><span class="ident" id="3690026"><a href="/encoding/json/encode.go.html#3689623">out</a></span><span class="op" id="3690029">,</span>&nbsp;<span class="ident" id="3690031"><a href="/encoding/json/encode.go.html#3689797">fi</a></span><span class="op" id="3690033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690038">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690049">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690053">dominant</span><span class="op" id="3690061">,</span>&nbsp;<span class="ident" id="3690063">ok</span>&nbsp;<span class="op" id="3690066">:=</span>&nbsp;<span class="ident" id="3690069"><a href="/encoding/json/encode.go.html#3690571">dominantField</a></span><span class="op" id="3690082">(</span><span class="ident" id="3690083"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3690089">[</span><span class="ident" id="3690090"><a href="/encoding/json/encode.go.html#3689655">i</a></span>&nbsp;<span class="op" id="3690092">:</span>&nbsp;<span class="ident" id="3690094"><a href="/encoding/json/encode.go.html#3689655">i</a></span><span class="op" id="3690095">+</span><span class="ident" id="3690096"><a href="/encoding/json/encode.go.html#3689646">advance</a></span><span class="op" id="3690103">]</span><span class="op" id="3690104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690108">if</span>&nbsp;<span class="ident" id="3690111"><a href="/encoding/json/encode.go.html#3690063">ok</a></span>&nbsp;<span class="op" id="3690114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690119"><a href="/encoding/json/encode.go.html#3689623">out</a></span>&nbsp;<span class="op" id="3690123">=</span>&nbsp;<span class="builtinfunc" id="3690125">append</span><span class="op" id="3690131">(</span><span class="ident" id="3690132"><a href="/encoding/json/encode.go.html#3689623">out</a></span><span class="op" id="3690135">,</span>&nbsp;<span class="ident" id="3690137"><a href="/encoding/json/encode.go.html#3690053">dominant</a></span><span class="op" id="3690145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690152">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690156"><a href="/encoding/json/encode.go.html#3687528">fields</a></span>&nbsp;<span class="op" id="3690163">=</span>&nbsp;<span class="ident" id="3690165"><a href="/encoding/json/encode.go.html#3689623">out</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690170"><a href="/encoding/json/encode.go.html#3661714">sort</a></span><span class="op" id="3690174">.</span><span class="ident" id="3690175">Sort</span><span class="op" id="3690179">(</span><span class="ident" id="3690180"><a href="/encoding/json/encode.go.html#3686554">byIndex</a></span><span class="op" id="3690187">(</span><span class="ident" id="3690188"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><span class="op" id="3690194">)</span><span class="op" id="3690195">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690199">return</span>&nbsp;<span class="ident" id="3690206"><a href="/encoding/json/encode.go.html#3687528">fields</a></span><br>
<span class="lineno">1115</span><span class="op" id="3690213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3690216">//&nbsp;dominantField&nbsp;looks&nbsp;through&nbsp;the&nbsp;fields,&nbsp;all&nbsp;of&nbsp;which&nbsp;are&nbsp;known&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3690285">//&nbsp;have&nbsp;the&nbsp;same&nbsp;name,&nbsp;to&nbsp;find&nbsp;the&nbsp;single&nbsp;field&nbsp;that&nbsp;dominates&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3690352">//&nbsp;others&nbsp;using&nbsp;Go&#39;s&nbsp;embedding&nbsp;rules,&nbsp;modified&nbsp;by&nbsp;the&nbsp;presence&nbsp;of</span><br>
<span class="lineno">1120</span><span class="comment" id="3690418">//&nbsp;JSON&nbsp;tags.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;top-level&nbsp;fields,&nbsp;the&nbsp;boolean</span><br>
<span class="lineno"></span><span class="comment" id="3690484">//&nbsp;will&nbsp;be&nbsp;false:&nbsp;This&nbsp;condition&nbsp;is&nbsp;an&nbsp;error&nbsp;in&nbsp;Go&nbsp;and&nbsp;we&nbsp;skip&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3690551">//&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="3690566">func</span>&nbsp;<span class="ident" id="3690571">dominantField</span><span class="op" id="3690584">(</span><span class="ident" id="3690585">fields</span>&nbsp;<span class="op" id="3690592">[</span><span class="op" id="3690593">]</span><span class="ident" id="3690594"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3690599">)</span>&nbsp;<span class="op" id="3690601">(</span><span class="ident" id="3690602"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3690607">,</span>&nbsp;<span class="builtintype" id="3690609">bool</span><span class="op" id="3690613">)</span>&nbsp;<span class="op" id="3690615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3690618">//&nbsp;The&nbsp;fields&nbsp;are&nbsp;sorted&nbsp;in&nbsp;increasing&nbsp;index-length&nbsp;order.&nbsp;The&nbsp;winner</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3690689">//&nbsp;must&nbsp;therefore&nbsp;be&nbsp;one&nbsp;with&nbsp;the&nbsp;shortest&nbsp;index&nbsp;length.&nbsp;Drop&nbsp;all</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3690756">//&nbsp;longer&nbsp;entries,&nbsp;which&nbsp;is&nbsp;easy:&nbsp;just&nbsp;truncate&nbsp;the&nbsp;slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690816">length</span>&nbsp;<span class="op" id="3690823">:=</span>&nbsp;<span class="builtinfunc" id="3690826">len</span><span class="op" id="3690829">(</span><span class="ident" id="3690830"><a href="/encoding/json/encode.go.html#3690585">fields</a></span><span class="op" id="3690836">[</span><span class="num" id="3690837">0</span><span class="op" id="3690838">]</span><span class="op" id="3690839">.</span><span class="ident" id="3690840">index</span><span class="op" id="3690845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690848">tagged</span>&nbsp;<span class="op" id="3690855">:=</span>&nbsp;<span class="op" id="3690858">-</span><span class="num" id="3690859">1</span>&nbsp;<span class="comment" id="3690861">//&nbsp;Index&nbsp;of&nbsp;first&nbsp;tagged&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690894">for</span>&nbsp;<span class="ident" id="3690898">i</span><span class="op" id="3690899">,</span>&nbsp;<span class="ident" id="3690901">f</span>&nbsp;<span class="op" id="3690903">:=</span>&nbsp;<span class="keyword" id="3690906">range</span>&nbsp;<span class="ident" id="3690912"><a href="/encoding/json/encode.go.html#3690585">fields</a></span>&nbsp;<span class="op" id="3690919">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690923">if</span>&nbsp;<span class="builtinfunc" id="3690926">len</span><span class="op" id="3690929">(</span><span class="ident" id="3690930"><a href="/encoding/json/encode.go.html#3690901">f</a></span><span class="op" id="3690931">.</span><span class="ident" id="3690932">index</span><span class="op" id="3690937">)</span>&nbsp;<span class="op" id="3690939">&gt;</span>&nbsp;<span class="ident" id="3690941"><a href="/encoding/json/encode.go.html#3690816">length</a></span>&nbsp;<span class="op" id="3690948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690953"><a href="/encoding/json/encode.go.html#3690585">fields</a></span>&nbsp;<span class="op" id="3690960">=</span>&nbsp;<span class="ident" id="3690962"><a href="/encoding/json/encode.go.html#3690585">fields</a></span><span class="op" id="3690968">[</span><span class="op" id="3690969">:</span><span class="ident" id="3690970"><a href="/encoding/json/encode.go.html#3690898">i</a></span><span class="op" id="3690971">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690976">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690988">if</span>&nbsp;<span class="ident" id="3690991"><a href="/encoding/json/encode.go.html#3690901">f</a></span><span class="op" id="3690992">.</span><span class="ident" id="3690993">tag</span>&nbsp;<span class="op" id="3690997">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691002">if</span>&nbsp;<span class="ident" id="3691005"><a href="/encoding/json/encode.go.html#3690848">tagged</a></span>&nbsp;<span class="op" id="3691012">&gt;=</span>&nbsp;<span class="num" id="3691015">0</span>&nbsp;<span class="op" id="3691017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691023">//&nbsp;Multiple&nbsp;tagged&nbsp;fields&nbsp;at&nbsp;the&nbsp;same&nbsp;level:&nbsp;conflict.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691082">//&nbsp;Return&nbsp;no&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691106">return</span>&nbsp;<span class="ident" id="3691113"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3691118">{</span><span class="op" id="3691119">}</span><span class="op" id="3691120">,</span>&nbsp;<span class="ident" id="3691122">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691131">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691136"><a href="/encoding/json/encode.go.html#3690848">tagged</a></span>&nbsp;<span class="op" id="3691143">=</span>&nbsp;<span class="ident" id="3691145"><a href="/encoding/json/encode.go.html#3690898">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691155">if</span>&nbsp;<span class="ident" id="3691158"><a href="/encoding/json/encode.go.html#3690848">tagged</a></span>&nbsp;<span class="op" id="3691165">&gt;=</span>&nbsp;<span class="num" id="3691168">0</span>&nbsp;<span class="op" id="3691170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691174">return</span>&nbsp;<span class="ident" id="3691181"><a href="/encoding/json/encode.go.html#3690585">fields</a></span><span class="op" id="3691187">[</span><span class="ident" id="3691188"><a href="/encoding/json/encode.go.html#3690848">tagged</a></span><span class="op" id="3691194">]</span><span class="op" id="3691195">,</span>&nbsp;<span class="ident" id="3691197">true</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691206">//&nbsp;All&nbsp;remaining&nbsp;fields&nbsp;have&nbsp;the&nbsp;same&nbsp;length.&nbsp;If&nbsp;there&#39;s&nbsp;more&nbsp;than&nbsp;one,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691279">//&nbsp;we&nbsp;have&nbsp;a&nbsp;conflict&nbsp;(two&nbsp;fields&nbsp;named&nbsp;&#34;X&#34;&nbsp;at&nbsp;the&nbsp;same&nbsp;level)&nbsp;and&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691350">//&nbsp;return&nbsp;no&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691371">if</span>&nbsp;<span class="builtinfunc" id="3691374">len</span><span class="op" id="3691377">(</span><span class="ident" id="3691378"><a href="/encoding/json/encode.go.html#3690585">fields</a></span><span class="op" id="3691384">)</span>&nbsp;<span class="op" id="3691386">&gt;</span>&nbsp;<span class="num" id="3691388">1</span>&nbsp;<span class="op" id="3691390">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691394">return</span>&nbsp;<span class="ident" id="3691401"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3691406">{</span><span class="op" id="3691407">}</span><span class="op" id="3691408">,</span>&nbsp;<span class="ident" id="3691410">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691420">return</span>&nbsp;<span class="ident" id="3691427"><a href="/encoding/json/encode.go.html#3690585">fields</a></span><span class="op" id="3691433">[</span><span class="num" id="3691434">0</span><span class="op" id="3691435">]</span><span class="op" id="3691436">,</span>&nbsp;<span class="ident" id="3691438">true</span><br>
<span class="lineno"></span><span class="op" id="3691443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span><span class="keyword" id="3691446">var</span>&nbsp;<span class="ident" id="3691450">fieldCache</span>&nbsp;<span class="keyword" id="3691461">struct</span>&nbsp;<span class="op" id="3691468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691471"><a href="/encoding/json/encode.go.html#3661744">sync</a></span><span class="op" id="3691475">.</span><span class="ident" id="3691476">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691485">m</span>&nbsp;<span class="keyword" id="3691487">map</span><span class="op" id="3691490">[</span><span class="ident" id="3691491"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3691498">.</span><span class="ident" id="3691499">Type</span><span class="op" id="3691503">]</span><span class="op" id="3691504">[</span><span class="op" id="3691505">]</span><span class="ident" id="3691506"><a href="/encoding/json/encode.go.html#3685603">field</a></span><br>
<span class="lineno"></span><span class="op" id="3691512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="3691515">//&nbsp;cachedTypeFields&nbsp;is&nbsp;like&nbsp;typeFields&nbsp;but&nbsp;uses&nbsp;a&nbsp;cache&nbsp;to&nbsp;avoid&nbsp;repeated&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="3691595">func</span>&nbsp;<span class="ident" id="3691600">cachedTypeFields</span><span class="op" id="3691616">(</span><span class="ident" id="3691617">t</span>&nbsp;<span class="ident" id="3691619"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3691626">.</span><span class="ident" id="3691627">Type</span><span class="op" id="3691631">)</span>&nbsp;<span class="op" id="3691633">[</span><span class="op" id="3691634">]</span><span class="ident" id="3691635"><a href="/encoding/json/encode.go.html#3685603">field</a></span>&nbsp;<span class="op" id="3691641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691644"><a href="/encoding/json/encode.go.html#3691450">fieldCache</a></span><span class="op" id="3691654">.</span><span class="ident" id="3691655">RLock</span><span class="op" id="3691660">(</span><span class="op" id="3691661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691664">f</span>&nbsp;<span class="op" id="3691666">:=</span>&nbsp;<span class="ident" id="3691669"><a href="/encoding/json/encode.go.html#3691450">fieldCache</a></span><span class="op" id="3691679">.</span><span class="ident" id="3691680">m</span><span class="op" id="3691681">[</span><span class="ident" id="3691682"><a href="/encoding/json/encode.go.html#3691617">t</a></span><span class="op" id="3691683">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691686"><a href="/encoding/json/encode.go.html#3691450">fieldCache</a></span><span class="op" id="3691696">.</span><span class="ident" id="3691697">RUnlock</span><span class="op" id="3691704">(</span><span class="op" id="3691705">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691708">if</span>&nbsp;<span class="ident" id="3691711"><a href="/encoding/json/encode.go.html#3691664">f</a></span>&nbsp;<span class="op" id="3691713">!=</span>&nbsp;<span class="ident" id="3691716">nil</span>&nbsp;<span class="op" id="3691720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691724">return</span>&nbsp;<span class="ident" id="3691731"><a href="/encoding/json/encode.go.html#3691664">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691738">//&nbsp;Compute&nbsp;fields&nbsp;without&nbsp;lock.</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691771">//&nbsp;Might&nbsp;duplicate&nbsp;effort&nbsp;but&nbsp;won&#39;t&nbsp;hold&nbsp;other&nbsp;computations&nbsp;back.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691838"><a href="/encoding/json/encode.go.html#3691664">f</a></span>&nbsp;<span class="op" id="3691840">=</span>&nbsp;<span class="ident" id="3691842"><a href="/encoding/json/encode.go.html#3687138">typeFields</a></span><span class="op" id="3691852">(</span><span class="ident" id="3691853"><a href="/encoding/json/encode.go.html#3691617">t</a></span><span class="op" id="3691854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691857">if</span>&nbsp;<span class="ident" id="3691860"><a href="/encoding/json/encode.go.html#3691664">f</a></span>&nbsp;<span class="op" id="3691862">==</span>&nbsp;<span class="ident" id="3691865">nil</span>&nbsp;<span class="op" id="3691869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691873"><a href="/encoding/json/encode.go.html#3691664">f</a></span>&nbsp;<span class="op" id="3691875">=</span>&nbsp;<span class="op" id="3691877">[</span><span class="op" id="3691878">]</span><span class="ident" id="3691879"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3691884">{</span><span class="op" id="3691885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691888">}</span><br>
<span class="lineno">1175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691892"><a href="/encoding/json/encode.go.html#3691450">fieldCache</a></span><span class="op" id="3691902">.</span><span class="ident" id="3691903">Lock</span><span class="op" id="3691907">(</span><span class="op" id="3691908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691911">if</span>&nbsp;<span class="ident" id="3691914"><a href="/encoding/json/encode.go.html#3691450">fieldCache</a></span><span class="op" id="3691924">.</span><span class="ident" id="3691925">m</span>&nbsp;<span class="op" id="3691927">==</span>&nbsp;<span class="ident" id="3691930">nil</span>&nbsp;<span class="op" id="3691934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691938"><a href="/encoding/json/encode.go.html#3691450">fieldCache</a></span><span class="op" id="3691948">.</span><span class="ident" id="3691949">m</span>&nbsp;<span class="op" id="3691951">=</span>&nbsp;<span class="keyword" id="3691953">map</span><span class="op" id="3691956">[</span><span class="ident" id="3691957"><a href="/encoding/json/encode.go.html#3661692">reflect</a></span><span class="op" id="3691964">.</span><span class="ident" id="3691965">Type</span><span class="op" id="3691969">]</span><span class="op" id="3691970">[</span><span class="op" id="3691971">]</span><span class="ident" id="3691972"><a href="/encoding/json/encode.go.html#3685603">field</a></span><span class="op" id="3691977">{</span><span class="op" id="3691978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691981">}</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691984"><a href="/encoding/json/encode.go.html#3691450">fieldCache</a></span><span class="op" id="3691994">.</span><span class="ident" id="3691995">m</span><span class="op" id="3691996">[</span><span class="ident" id="3691997"><a href="/encoding/json/encode.go.html#3691617">t</a></span><span class="op" id="3691998">]</span>&nbsp;<span class="op" id="3692000">=</span>&nbsp;<span class="ident" id="3692002"><a href="/encoding/json/encode.go.html#3691664">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692005"><a href="/encoding/json/encode.go.html#3691450">fieldCache</a></span><span class="op" id="3692015">.</span><span class="ident" id="3692016">Unlock</span><span class="op" id="3692022">(</span><span class="op" id="3692023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692026">return</span>&nbsp;<span class="ident" id="3692033"><a href="/encoding/json/encode.go.html#3691664">f</a></span><br>
<span class="lineno"></span><span class="op" id="3692035">}</span>
</div>
</body>
</html>
