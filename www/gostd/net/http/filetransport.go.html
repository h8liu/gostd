<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4850060">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4850115">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4850169">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4850220">package</span>&nbsp;<span class="ident" id="4850228">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4850234">import</span>&nbsp;<span class="op" id="4850241">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4850244">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4850251">&#34;io&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4850256">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4850259">//&nbsp;fileTransport&nbsp;implements&nbsp;RoundTripper&nbsp;for&nbsp;the&nbsp;&#39;file&#39;&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="keyword" id="4850325">type</span>&nbsp;<span class="ident" id="4850330">fileTransport</span>&nbsp;<span class="keyword" id="4850344">struct</span>&nbsp;<span class="op" id="4850351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850354">fh</span>&nbsp;<span class="ident" id="4850357">fileHandler</span><br>
<span class="lineno">15</span><span class="op" id="4850369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4850372">//&nbsp;NewFileTransport&nbsp;returns&nbsp;a&nbsp;new&nbsp;RoundTripper,&nbsp;serving&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="4850441">//&nbsp;FileSystem.&nbsp;The&nbsp;returned&nbsp;RoundTripper&nbsp;ignores&nbsp;the&nbsp;URL&nbsp;host&nbsp;in&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="4850510">//&nbsp;incoming&nbsp;requests,&nbsp;as&nbsp;well&nbsp;as&nbsp;most&nbsp;other&nbsp;properties&nbsp;of&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="4850572">//&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="4850584">//</span><br>
<span class="lineno"></span><span class="comment" id="4850587">//&nbsp;The&nbsp;typical&nbsp;use&nbsp;case&nbsp;for&nbsp;NewFileTransport&nbsp;is&nbsp;to&nbsp;register&nbsp;the&nbsp;&#34;file&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4850658">//&nbsp;protocol&nbsp;with&nbsp;a&nbsp;Transport,&nbsp;as&nbsp;in:</span><br>
<span class="lineno"></span><span class="comment" id="4850695">//</span><br>
<span class="lineno">25</span><span class="comment" id="4850698">//&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;&amp;http.Transport{}</span><br>
<span class="lineno"></span><span class="comment" id="4850726">//&nbsp;&nbsp;&nbsp;t.RegisterProtocol(&#34;file&#34;,&nbsp;http.NewFileTransport(http.Dir(&#34;/&#34;)))</span><br>
<span class="lineno"></span><span class="comment" id="4850796">//&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;&amp;http.Client{Transport:&nbsp;t}</span><br>
<span class="lineno"></span><span class="comment" id="4850833">//&nbsp;&nbsp;&nbsp;res,&nbsp;err&nbsp;:=&nbsp;c.Get(&#34;file:///etc/passwd&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="4850878">//&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno">30</span><span class="keyword" id="4850887">func</span>&nbsp;<span class="ident" id="4850892">NewFileTransport</span><span class="op" id="4850908">(</span><span class="ident" id="4850909">fs</span>&nbsp;<span class="ident" id="4850912">FileSystem</span><span class="op" id="4850922">)</span>&nbsp;<span class="ident" id="4850924">RoundTripper</span>&nbsp;<span class="op" id="4850937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850940">return</span>&nbsp;<span class="ident" id="4850947">fileTransport</span><span class="op" id="4850960">{</span><span class="ident" id="4850961">fileHandler</span><span class="op" id="4850972">{</span><span class="ident" id="4850973">fs</span><span class="op" id="4850975">}</span><span class="op" id="4850976">}</span><br>
<span class="lineno"></span><span class="op" id="4850978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4850981">func</span>&nbsp;<span class="op" id="4850986">(</span><span class="ident" id="4850987">t</span>&nbsp;<span class="ident" id="4850989">fileTransport</span><span class="op" id="4851002">)</span>&nbsp;<span class="ident" id="4851004">RoundTrip</span><span class="op" id="4851013">(</span><span class="ident" id="4851014">req</span>&nbsp;<span class="op" id="4851018">*</span><span class="ident" id="4851019">Request</span><span class="op" id="4851026">)</span>&nbsp;<span class="op" id="4851028">(</span><span class="ident" id="4851029">resp</span>&nbsp;<span class="op" id="4851034">*</span><span class="ident" id="4851035">Response</span><span class="op" id="4851043">,</span>&nbsp;<span class="ident" id="4851045">err</span>&nbsp;<span class="builtintype" id="4851049">error</span><span class="op" id="4851054">)</span>&nbsp;<span class="op" id="4851056">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851059">//&nbsp;We&nbsp;start&nbsp;ServeHTTP&nbsp;in&nbsp;a&nbsp;goroutine,&nbsp;which&nbsp;may&nbsp;take&nbsp;a&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851120">//&nbsp;time&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;large.&nbsp;&nbsp;The&nbsp;newPopulateResponseWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851182">//&nbsp;call&nbsp;returns&nbsp;a&nbsp;channel&nbsp;which&nbsp;either&nbsp;ServeHTTP&nbsp;or&nbsp;finish()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851244">//&nbsp;sends&nbsp;our&nbsp;*Response&nbsp;on,&nbsp;once&nbsp;the&nbsp;*Response&nbsp;itself&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851307">//&nbsp;populated&nbsp;(even&nbsp;if&nbsp;the&nbsp;body&nbsp;itself&nbsp;is&nbsp;still&nbsp;being</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851361">//&nbsp;written&nbsp;to&nbsp;the&nbsp;res.Body,&nbsp;a&nbsp;pipe)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851398">rw</span><span class="op" id="4851400">,</span>&nbsp;<span class="ident" id="4851402">resc</span>&nbsp;<span class="op" id="4851407">:=</span>&nbsp;<span class="ident" id="4851410">newPopulateResponseWriter</span><span class="op" id="4851435">(</span><span class="op" id="4851436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851439">go</span>&nbsp;<span class="keyword" id="4851442">func</span><span class="op" id="4851446">(</span><span class="op" id="4851447">)</span>&nbsp;<span class="op" id="4851449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851453">t</span><span class="op" id="4851454">.</span><span class="ident" id="4851455">fh</span><span class="op" id="4851457">.</span><span class="ident" id="4851458">ServeHTTP</span><span class="op" id="4851467">(</span><span class="ident" id="4851468">rw</span><span class="op" id="4851470">,</span>&nbsp;<span class="ident" id="4851472">req</span><span class="op" id="4851475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851479">rw</span><span class="op" id="4851481">.</span><span class="ident" id="4851482">finish</span><span class="op" id="4851488">(</span><span class="op" id="4851489">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851492">}</span><span class="op" id="4851493">(</span><span class="op" id="4851494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851497">return</span>&nbsp;<span class="op" id="4851504">&lt;-</span><span class="ident" id="4851506">resc</span><span class="op" id="4851510">,</span>&nbsp;<span class="ident" id="4851512">nil</span><br>
<span class="lineno"></span><span class="op" id="4851516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4851519">func</span>&nbsp;<span class="ident" id="4851524">newPopulateResponseWriter</span><span class="op" id="4851549">(</span><span class="op" id="4851550">)</span>&nbsp;<span class="op" id="4851552">(</span><span class="op" id="4851553">*</span><span class="ident" id="4851554">populateResponse</span><span class="op" id="4851570">,</span>&nbsp;<span class="op" id="4851572">&lt;-</span><span class="keyword" id="4851574">chan</span>&nbsp;<span class="op" id="4851579">*</span><span class="ident" id="4851580">Response</span><span class="op" id="4851588">)</span>&nbsp;<span class="op" id="4851590">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851593">pr</span><span class="op" id="4851595">,</span>&nbsp;<span class="ident" id="4851597">pw</span>&nbsp;<span class="op" id="4851600">:=</span>&nbsp;<span class="ident" id="4851603">io</span><span class="op" id="4851605">.</span><span class="ident" id="4851606">Pipe</span><span class="op" id="4851610">(</span><span class="op" id="4851611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851614">rw</span>&nbsp;<span class="op" id="4851617">:=</span>&nbsp;<span class="op" id="4851620">&amp;</span><span class="ident" id="4851621">populateResponse</span><span class="op" id="4851637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851641">ch</span><span class="op" id="4851643">:</span>&nbsp;<span class="builtinfunc" id="4851645">make</span><span class="op" id="4851649">(</span><span class="keyword" id="4851650">chan</span>&nbsp;<span class="op" id="4851655">*</span><span class="ident" id="4851656">Response</span><span class="op" id="4851664">)</span><span class="op" id="4851665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851669">pw</span><span class="op" id="4851671">:</span>&nbsp;<span class="ident" id="4851673">pw</span><span class="op" id="4851675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851679">res</span><span class="op" id="4851682">:</span>&nbsp;<span class="op" id="4851684">&amp;</span><span class="ident" id="4851685">Response</span><span class="op" id="4851693">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851698">Proto</span><span class="op" id="4851703">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4851710">&#34;HTTP/1.0&#34;</span><span class="op" id="4851720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851725">ProtoMajor</span><span class="op" id="4851735">:</span>&nbsp;<span class="num" id="4851737">1</span><span class="op" id="4851738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851743">Header</span><span class="op" id="4851749">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4851755">make</span><span class="op" id="4851759">(</span><span class="ident" id="4851760">Header</span><span class="op" id="4851766">)</span><span class="op" id="4851767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851772">Close</span><span class="op" id="4851777">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4851784">true</span><span class="op" id="4851788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851793">Body</span><span class="op" id="4851797">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851805">pr</span><span class="op" id="4851807">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851811">}</span><span class="op" id="4851812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851818">return</span>&nbsp;<span class="ident" id="4851825">rw</span><span class="op" id="4851827">,</span>&nbsp;<span class="ident" id="4851829">rw</span><span class="op" id="4851831">.</span><span class="ident" id="4851832">ch</span><br>
<span class="lineno"></span><span class="op" id="4851835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="4851838">//&nbsp;populateResponse&nbsp;is&nbsp;a&nbsp;ResponseWriter&nbsp;that&nbsp;populates&nbsp;the&nbsp;*Response</span><br>
<span class="lineno"></span><span class="comment" id="4851907">//&nbsp;in&nbsp;res,&nbsp;and&nbsp;writes&nbsp;its&nbsp;body&nbsp;to&nbsp;a&nbsp;pipe&nbsp;connected&nbsp;to&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="comment" id="4851974">//&nbsp;body.&nbsp;Once&nbsp;writes&nbsp;begin&nbsp;or&nbsp;finish()&nbsp;is&nbsp;called,&nbsp;the&nbsp;response&nbsp;is&nbsp;sent</span><br>
<span class="lineno"></span><span class="comment" id="4852045">//&nbsp;on&nbsp;ch.</span><br>
<span class="lineno"></span><span class="keyword" id="4852055">type</span>&nbsp;<span class="ident" id="4852060">populateResponse</span>&nbsp;<span class="keyword" id="4852077">struct</span>&nbsp;<span class="op" id="4852084">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852087">res</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852100">*</span><span class="ident" id="4852101">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852111">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852124">chan</span>&nbsp;<span class="op" id="4852129">*</span><span class="ident" id="4852130">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852140">wroteHeader</span>&nbsp;&nbsp;<span class="builtintype" id="4852153">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852159">hasContent</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4852172">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852178">sentResponse</span>&nbsp;<span class="builtintype" id="4852191">bool</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852197">pw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852210">*</span><span class="ident" id="4852211">io</span><span class="op" id="4852213">.</span><span class="ident" id="4852214">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="4852225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4852228">func</span>&nbsp;<span class="op" id="4852233">(</span><span class="ident" id="4852234">pr</span>&nbsp;<span class="op" id="4852237">*</span><span class="ident" id="4852238">populateResponse</span><span class="op" id="4852254">)</span>&nbsp;<span class="ident" id="4852256">finish</span><span class="op" id="4852262">(</span><span class="op" id="4852263">)</span>&nbsp;<span class="op" id="4852265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852268">if</span>&nbsp;<span class="op" id="4852271">!</span><span class="ident" id="4852272">pr</span><span class="op" id="4852274">.</span><span class="ident" id="4852275">wroteHeader</span>&nbsp;<span class="op" id="4852287">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852291">pr</span><span class="op" id="4852293">.</span><span class="ident" id="4852294">WriteHeader</span><span class="op" id="4852305">(</span><span class="num" id="4852306">500</span><span class="op" id="4852309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852315">if</span>&nbsp;<span class="op" id="4852318">!</span><span class="ident" id="4852319">pr</span><span class="op" id="4852321">.</span><span class="ident" id="4852322">sentResponse</span>&nbsp;<span class="op" id="4852335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852339">pr</span><span class="op" id="4852341">.</span><span class="ident" id="4852342">sendResponse</span><span class="op" id="4852354">(</span><span class="op" id="4852355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852358">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852361">pr</span><span class="op" id="4852363">.</span><span class="ident" id="4852364">pw</span><span class="op" id="4852366">.</span><span class="ident" id="4852367">Close</span><span class="op" id="4852372">(</span><span class="op" id="4852373">)</span><br>
<span class="lineno"></span><span class="op" id="4852375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4852378">func</span>&nbsp;<span class="op" id="4852383">(</span><span class="ident" id="4852384">pr</span>&nbsp;<span class="op" id="4852387">*</span><span class="ident" id="4852388">populateResponse</span><span class="op" id="4852404">)</span>&nbsp;<span class="ident" id="4852406">sendResponse</span><span class="op" id="4852418">(</span><span class="op" id="4852419">)</span>&nbsp;<span class="op" id="4852421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852424">if</span>&nbsp;<span class="ident" id="4852427">pr</span><span class="op" id="4852429">.</span><span class="ident" id="4852430">sentResponse</span>&nbsp;<span class="op" id="4852443">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852447">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852458">pr</span><span class="op" id="4852460">.</span><span class="ident" id="4852461">sentResponse</span>&nbsp;<span class="op" id="4852474">=</span>&nbsp;<span class="builtintype" id="4852476">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852483">if</span>&nbsp;<span class="ident" id="4852486">pr</span><span class="op" id="4852488">.</span><span class="ident" id="4852489">hasContent</span>&nbsp;<span class="op" id="4852500">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852504">pr</span><span class="op" id="4852506">.</span><span class="ident" id="4852507">res</span><span class="op" id="4852510">.</span><span class="ident" id="4852511">ContentLength</span>&nbsp;<span class="op" id="4852525">=</span>&nbsp;<span class="op" id="4852527">-</span><span class="num" id="4852528">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852534">pr</span><span class="op" id="4852536">.</span><span class="ident" id="4852537">ch</span>&nbsp;<span class="op" id="4852540">&lt;-</span>&nbsp;<span class="ident" id="4852543">pr</span><span class="op" id="4852545">.</span><span class="ident" id="4852546">res</span><br>
<span class="lineno"></span><span class="op" id="4852550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4852553">func</span>&nbsp;<span class="op" id="4852558">(</span><span class="ident" id="4852559">pr</span>&nbsp;<span class="op" id="4852562">*</span><span class="ident" id="4852563">populateResponse</span><span class="op" id="4852579">)</span>&nbsp;<span class="ident" id="4852581">Header</span><span class="op" id="4852587">(</span><span class="op" id="4852588">)</span>&nbsp;<span class="ident" id="4852590">Header</span>&nbsp;<span class="op" id="4852597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852600">return</span>&nbsp;<span class="ident" id="4852607">pr</span><span class="op" id="4852609">.</span><span class="ident" id="4852610">res</span><span class="op" id="4852613">.</span><span class="ident" id="4852614">Header</span><br>
<span class="lineno"></span><span class="op" id="4852621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4852624">func</span>&nbsp;<span class="op" id="4852629">(</span><span class="ident" id="4852630">pr</span>&nbsp;<span class="op" id="4852633">*</span><span class="ident" id="4852634">populateResponse</span><span class="op" id="4852650">)</span>&nbsp;<span class="ident" id="4852652">WriteHeader</span><span class="op" id="4852663">(</span><span class="ident" id="4852664">code</span>&nbsp;<span class="builtintype" id="4852669">int</span><span class="op" id="4852672">)</span>&nbsp;<span class="op" id="4852674">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852677">if</span>&nbsp;<span class="ident" id="4852680">pr</span><span class="op" id="4852682">.</span><span class="ident" id="4852683">wroteHeader</span>&nbsp;<span class="op" id="4852695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852699">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852710">pr</span><span class="op" id="4852712">.</span><span class="ident" id="4852713">wroteHeader</span>&nbsp;<span class="op" id="4852725">=</span>&nbsp;<span class="builtintype" id="4852727">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852734">pr</span><span class="op" id="4852736">.</span><span class="ident" id="4852737">res</span><span class="op" id="4852740">.</span><span class="ident" id="4852741">StatusCode</span>&nbsp;<span class="op" id="4852752">=</span>&nbsp;<span class="ident" id="4852754">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852760">pr</span><span class="op" id="4852762">.</span><span class="ident" id="4852763">res</span><span class="op" id="4852766">.</span><span class="ident" id="4852767">Status</span>&nbsp;<span class="op" id="4852774">=</span>&nbsp;<span class="ident" id="4852776">fmt</span><span class="op" id="4852779">.</span><span class="ident" id="4852780">Sprintf</span><span class="op" id="4852787">(</span><span class="string" id="4852788">&#34;%d&nbsp;%s&#34;</span><span class="op" id="4852795">,</span>&nbsp;<span class="ident" id="4852797">code</span><span class="op" id="4852801">,</span>&nbsp;<span class="ident" id="4852803">StatusText</span><span class="op" id="4852813">(</span><span class="ident" id="4852814">code</span><span class="op" id="4852818">)</span><span class="op" id="4852819">)</span><br>
<span class="lineno"></span><span class="op" id="4852821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4852824">func</span>&nbsp;<span class="op" id="4852829">(</span><span class="ident" id="4852830">pr</span>&nbsp;<span class="op" id="4852833">*</span><span class="ident" id="4852834">populateResponse</span><span class="op" id="4852850">)</span>&nbsp;<span class="ident" id="4852852">Write</span><span class="op" id="4852857">(</span><span class="ident" id="4852858">p</span>&nbsp;<span class="op" id="4852860">[</span><span class="op" id="4852861">]</span><span class="builtintype" id="4852862">byte</span><span class="op" id="4852866">)</span>&nbsp;<span class="op" id="4852868">(</span><span class="ident" id="4852869">n</span>&nbsp;<span class="builtintype" id="4852871">int</span><span class="op" id="4852874">,</span>&nbsp;<span class="ident" id="4852876">err</span>&nbsp;<span class="builtintype" id="4852880">error</span><span class="op" id="4852885">)</span>&nbsp;<span class="op" id="4852887">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852890">if</span>&nbsp;<span class="op" id="4852893">!</span><span class="ident" id="4852894">pr</span><span class="op" id="4852896">.</span><span class="ident" id="4852897">wroteHeader</span>&nbsp;<span class="op" id="4852909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852913">pr</span><span class="op" id="4852915">.</span><span class="ident" id="4852916">WriteHeader</span><span class="op" id="4852927">(</span><span class="ident" id="4852928">StatusOK</span><span class="op" id="4852936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852942">pr</span><span class="op" id="4852944">.</span><span class="ident" id="4852945">hasContent</span>&nbsp;<span class="op" id="4852956">=</span>&nbsp;<span class="builtintype" id="4852958">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852964">if</span>&nbsp;<span class="op" id="4852967">!</span><span class="ident" id="4852968">pr</span><span class="op" id="4852970">.</span><span class="ident" id="4852971">sentResponse</span>&nbsp;<span class="op" id="4852984">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852988">pr</span><span class="op" id="4852990">.</span><span class="ident" id="4852991">sendResponse</span><span class="op" id="4853003">(</span><span class="op" id="4853004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4853007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853010">return</span>&nbsp;<span class="ident" id="4853017">pr</span><span class="op" id="4853019">.</span><span class="ident" id="4853020">pw</span><span class="op" id="4853022">.</span><span class="ident" id="4853023">Write</span><span class="op" id="4853028">(</span><span class="ident" id="4853029">p</span><span class="op" id="4853030">)</span><br>
<span class="lineno"></span><span class="op" id="4853032">}</span>
</div>
</body>
</html>
