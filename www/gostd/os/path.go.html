<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html" class="current">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2521139">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2521194">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2521248">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2521299">package</span>&nbsp;<span class="ident" id="2521307">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2521311">import</span>&nbsp;<span class="op" id="2521318">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2521321">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2521327">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2521337">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2521340">//&nbsp;MkdirAll&nbsp;creates&nbsp;a&nbsp;directory&nbsp;named&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="2521384">//&nbsp;along&nbsp;with&nbsp;any&nbsp;necessary&nbsp;parents,&nbsp;and&nbsp;returns&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="2521438">//&nbsp;or&nbsp;else&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">15</span><span class="comment" id="2521467">//&nbsp;The&nbsp;permission&nbsp;bits&nbsp;perm&nbsp;are&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2521512">//&nbsp;directories&nbsp;that&nbsp;MkdirAll&nbsp;creates.</span><br>
<span class="lineno"></span><span class="comment" id="2521550">//&nbsp;If&nbsp;path&nbsp;is&nbsp;already&nbsp;a&nbsp;directory,&nbsp;MkdirAll&nbsp;does&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="2521607">//&nbsp;and&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2521627">func</span>&nbsp;<span class="ident" id="2521632">MkdirAll</span><span class="op" id="2521640">(</span><span class="ident" id="2521641">path</span>&nbsp;<span class="builtintype" id="2521646">string</span><span class="op" id="2521652">,</span>&nbsp;<span class="ident" id="2521654">perm</span>&nbsp;<span class="ident" id="2521659">FileMode</span><span class="op" id="2521667">)</span>&nbsp;<span class="builtintype" id="2521669">error</span>&nbsp;<span class="op" id="2521675">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2521678">//&nbsp;Fast&nbsp;path:&nbsp;if&nbsp;we&nbsp;can&nbsp;tell&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;directory&nbsp;or&nbsp;file,&nbsp;stop&nbsp;with&nbsp;success&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2521773">dir</span><span class="op" id="2521776">,</span>&nbsp;<span class="ident" id="2521778">err</span>&nbsp;<span class="op" id="2521782">:=</span>&nbsp;<span class="ident" id="2521785">Stat</span><span class="op" id="2521789">(</span><span class="ident" id="2521790">path</span><span class="op" id="2521794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521797">if</span>&nbsp;<span class="ident" id="2521800">err</span>&nbsp;<span class="op" id="2521804">==</span>&nbsp;<span class="ident" id="2521807">nil</span>&nbsp;<span class="op" id="2521811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521815">if</span>&nbsp;<span class="ident" id="2521818">dir</span><span class="op" id="2521821">.</span><span class="ident" id="2521822">IsDir</span><span class="op" id="2521827">(</span><span class="op" id="2521828">)</span>&nbsp;<span class="op" id="2521830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521835">return</span>&nbsp;<span class="ident" id="2521842">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2521848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521852">return</span>&nbsp;<span class="op" id="2521859">&amp;</span><span class="ident" id="2521860">PathError</span><span class="op" id="2521869">{</span><span class="string" id="2521870">&#34;mkdir&#34;</span><span class="op" id="2521877">,</span>&nbsp;<span class="ident" id="2521879">path</span><span class="op" id="2521883">,</span>&nbsp;<span class="ident" id="2521885">syscall</span><span class="op" id="2521892">.</span><span class="ident" id="2521893">ENOTDIR</span><span class="op" id="2521900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2521903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2521907">//&nbsp;Slow&nbsp;path:&nbsp;make&nbsp;sure&nbsp;parent&nbsp;exists&nbsp;and&nbsp;then&nbsp;call&nbsp;Mkdir&nbsp;for&nbsp;path.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2521976">i</span>&nbsp;<span class="op" id="2521978">:=</span>&nbsp;<span class="builtinfunc" id="2521981">len</span><span class="op" id="2521984">(</span><span class="ident" id="2521985">path</span><span class="op" id="2521989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2521992">for</span>&nbsp;<span class="ident" id="2521996">i</span>&nbsp;<span class="op" id="2521998">&gt;</span>&nbsp;<span class="num" id="2522000">0</span>&nbsp;<span class="op" id="2522002">&amp;&amp;</span>&nbsp;<span class="ident" id="2522005">IsPathSeparator</span><span class="op" id="2522020">(</span><span class="ident" id="2522021">path</span><span class="op" id="2522025">[</span><span class="ident" id="2522026">i</span><span class="op" id="2522027">-</span><span class="num" id="2522028">1</span><span class="op" id="2522029">]</span><span class="op" id="2522030">)</span>&nbsp;<span class="op" id="2522032">{</span>&nbsp;<span class="comment" id="2522034">//&nbsp;Skip&nbsp;trailing&nbsp;path&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522069">i</span><span class="op" id="2522070">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2522074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522078">j</span>&nbsp;<span class="op" id="2522080">:=</span>&nbsp;<span class="ident" id="2522083">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522086">for</span>&nbsp;<span class="ident" id="2522090">j</span>&nbsp;<span class="op" id="2522092">&gt;</span>&nbsp;<span class="num" id="2522094">0</span>&nbsp;<span class="op" id="2522096">&amp;&amp;</span>&nbsp;<span class="op" id="2522099">!</span><span class="ident" id="2522100">IsPathSeparator</span><span class="op" id="2522115">(</span><span class="ident" id="2522116">path</span><span class="op" id="2522120">[</span><span class="ident" id="2522121">j</span><span class="op" id="2522122">-</span><span class="num" id="2522123">1</span><span class="op" id="2522124">]</span><span class="op" id="2522125">)</span>&nbsp;<span class="op" id="2522127">{</span>&nbsp;<span class="comment" id="2522129">//&nbsp;Scan&nbsp;backward&nbsp;over&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522162">j</span><span class="op" id="2522163">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2522167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522171">if</span>&nbsp;<span class="ident" id="2522174">j</span>&nbsp;<span class="op" id="2522176">&gt;</span>&nbsp;<span class="num" id="2522178">1</span>&nbsp;<span class="op" id="2522180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2522184">//&nbsp;Create&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522203">err</span>&nbsp;<span class="op" id="2522207">=</span>&nbsp;<span class="ident" id="2522209">MkdirAll</span><span class="op" id="2522217">(</span><span class="ident" id="2522218">path</span><span class="op" id="2522222">[</span><span class="num" id="2522223">0</span><span class="op" id="2522224">:</span><span class="ident" id="2522225">j</span><span class="op" id="2522226">-</span><span class="num" id="2522227">1</span><span class="op" id="2522228">]</span><span class="op" id="2522229">,</span>&nbsp;<span class="ident" id="2522231">perm</span><span class="op" id="2522235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522239">if</span>&nbsp;<span class="ident" id="2522242">err</span>&nbsp;<span class="op" id="2522246">!=</span>&nbsp;<span class="ident" id="2522249">nil</span>&nbsp;<span class="op" id="2522253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522258">return</span>&nbsp;<span class="ident" id="2522265">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2522271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2522274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2522278">//&nbsp;Parent&nbsp;now&nbsp;exists;&nbsp;invoke&nbsp;Mkdir&nbsp;and&nbsp;use&nbsp;its&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522334">err</span>&nbsp;<span class="op" id="2522338">=</span>&nbsp;<span class="ident" id="2522340">Mkdir</span><span class="op" id="2522345">(</span><span class="ident" id="2522346">path</span><span class="op" id="2522350">,</span>&nbsp;<span class="ident" id="2522352">perm</span><span class="op" id="2522356">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522359">if</span>&nbsp;<span class="ident" id="2522362">err</span>&nbsp;<span class="op" id="2522366">!=</span>&nbsp;<span class="ident" id="2522369">nil</span>&nbsp;<span class="op" id="2522373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2522377">//&nbsp;Handle&nbsp;arguments&nbsp;like&nbsp;&#34;foo/.&#34;&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2522415">//&nbsp;double-checking&nbsp;that&nbsp;directory&nbsp;doesn&#39;t&nbsp;exist.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522466">dir</span><span class="op" id="2522469">,</span>&nbsp;<span class="ident" id="2522471">err1</span>&nbsp;<span class="op" id="2522476">:=</span>&nbsp;<span class="ident" id="2522479">Lstat</span><span class="op" id="2522484">(</span><span class="ident" id="2522485">path</span><span class="op" id="2522489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522493">if</span>&nbsp;<span class="ident" id="2522496">err1</span>&nbsp;<span class="op" id="2522501">==</span>&nbsp;<span class="ident" id="2522504">nil</span>&nbsp;<span class="op" id="2522508">&amp;&amp;</span>&nbsp;<span class="ident" id="2522511">dir</span><span class="op" id="2522514">.</span><span class="ident" id="2522515">IsDir</span><span class="op" id="2522520">(</span><span class="op" id="2522521">)</span>&nbsp;<span class="op" id="2522523">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522528">return</span>&nbsp;<span class="ident" id="2522535">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2522541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522545">return</span>&nbsp;<span class="ident" id="2522552">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2522557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522560">return</span>&nbsp;<span class="ident" id="2522567">nil</span><br>
<span class="lineno">60</span><span class="op" id="2522571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2522574">//&nbsp;RemoveAll&nbsp;removes&nbsp;path&nbsp;and&nbsp;any&nbsp;children&nbsp;it&nbsp;contains.</span><br>
<span class="lineno"></span><span class="comment" id="2522630">//&nbsp;It&nbsp;removes&nbsp;everything&nbsp;it&nbsp;can&nbsp;but&nbsp;returns&nbsp;the&nbsp;first&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2522690">//&nbsp;it&nbsp;encounters.&nbsp;&nbsp;If&nbsp;the&nbsp;path&nbsp;does&nbsp;not&nbsp;exist,&nbsp;RemoveAll</span><br>
<span class="lineno">65</span><span class="comment" id="2522747">//&nbsp;returns&nbsp;nil&nbsp;(no&nbsp;error).</span><br>
<span class="lineno"></span><span class="keyword" id="2522774">func</span>&nbsp;<span class="ident" id="2522779">RemoveAll</span><span class="op" id="2522788">(</span><span class="ident" id="2522789">path</span>&nbsp;<span class="builtintype" id="2522794">string</span><span class="op" id="2522800">)</span>&nbsp;<span class="builtintype" id="2522802">error</span>&nbsp;<span class="op" id="2522808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2522811">//&nbsp;Simple&nbsp;case:&nbsp;if&nbsp;Remove&nbsp;works,&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522857">err</span>&nbsp;<span class="op" id="2522861">:=</span>&nbsp;<span class="ident" id="2522864">Remove</span><span class="op" id="2522870">(</span><span class="ident" id="2522871">path</span><span class="op" id="2522875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522878">if</span>&nbsp;<span class="ident" id="2522881">err</span>&nbsp;<span class="op" id="2522885">==</span>&nbsp;<span class="ident" id="2522888">nil</span>&nbsp;<span class="op" id="2522892">||</span>&nbsp;<span class="ident" id="2522895">IsNotExist</span><span class="op" id="2522905">(</span><span class="ident" id="2522906">err</span><span class="op" id="2522909">)</span>&nbsp;<span class="op" id="2522911">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2522915">return</span>&nbsp;<span class="ident" id="2522922">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2522927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2522931">//&nbsp;Otherwise,&nbsp;is&nbsp;this&nbsp;a&nbsp;directory&nbsp;we&nbsp;need&nbsp;to&nbsp;recurse&nbsp;into?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2522991">dir</span><span class="op" id="2522994">,</span>&nbsp;<span class="ident" id="2522996">serr</span>&nbsp;<span class="op" id="2523001">:=</span>&nbsp;<span class="ident" id="2523004">Lstat</span><span class="op" id="2523009">(</span><span class="ident" id="2523010">path</span><span class="op" id="2523014">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523017">if</span>&nbsp;<span class="ident" id="2523020">serr</span>&nbsp;<span class="op" id="2523025">!=</span>&nbsp;<span class="ident" id="2523028">nil</span>&nbsp;<span class="op" id="2523032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523036">if</span>&nbsp;<span class="ident" id="2523039">serr</span><span class="op" id="2523043">,</span>&nbsp;<span class="ident" id="2523045">ok</span>&nbsp;<span class="op" id="2523048">:=</span>&nbsp;<span class="ident" id="2523051">serr</span><span class="op" id="2523055">.</span><span class="op" id="2523056">(</span><span class="op" id="2523057">*</span><span class="ident" id="2523058">PathError</span><span class="op" id="2523067">)</span><span class="op" id="2523068">;</span>&nbsp;<span class="ident" id="2523070">ok</span>&nbsp;<span class="op" id="2523073">&amp;&amp;</span>&nbsp;<span class="op" id="2523076">(</span><span class="ident" id="2523077">IsNotExist</span><span class="op" id="2523087">(</span><span class="ident" id="2523088">serr</span><span class="op" id="2523092">.</span><span class="ident" id="2523093">Err</span><span class="op" id="2523096">)</span>&nbsp;<span class="op" id="2523098">||</span>&nbsp;<span class="ident" id="2523101">serr</span><span class="op" id="2523105">.</span><span class="ident" id="2523106">Err</span>&nbsp;<span class="op" id="2523110">==</span>&nbsp;<span class="ident" id="2523113">syscall</span><span class="op" id="2523120">.</span><span class="ident" id="2523121">ENOTDIR</span><span class="op" id="2523128">)</span>&nbsp;<span class="op" id="2523130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523135">return</span>&nbsp;<span class="ident" id="2523142">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523152">return</span>&nbsp;<span class="ident" id="2523159">serr</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523168">if</span>&nbsp;<span class="op" id="2523171">!</span><span class="ident" id="2523172">dir</span><span class="op" id="2523175">.</span><span class="ident" id="2523176">IsDir</span><span class="op" id="2523181">(</span><span class="op" id="2523182">)</span>&nbsp;<span class="op" id="2523184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2523188">//&nbsp;Not&nbsp;a&nbsp;directory;&nbsp;return&nbsp;the&nbsp;error&nbsp;from&nbsp;Remove.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523240">return</span>&nbsp;<span class="ident" id="2523247">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523252">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2523256">//&nbsp;Directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2523271">fd</span><span class="op" id="2523273">,</span>&nbsp;<span class="ident" id="2523275">err</span>&nbsp;<span class="op" id="2523279">:=</span>&nbsp;<span class="ident" id="2523282">Open</span><span class="op" id="2523286">(</span><span class="ident" id="2523287">path</span><span class="op" id="2523291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523294">if</span>&nbsp;<span class="ident" id="2523297">err</span>&nbsp;<span class="op" id="2523301">!=</span>&nbsp;<span class="ident" id="2523304">nil</span>&nbsp;<span class="op" id="2523308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523312">if</span>&nbsp;<span class="ident" id="2523315">IsNotExist</span><span class="op" id="2523325">(</span><span class="ident" id="2523326">err</span><span class="op" id="2523329">)</span>&nbsp;<span class="op" id="2523331">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2523336">//&nbsp;Race.&nbsp;It&nbsp;was&nbsp;deleted&nbsp;between&nbsp;the&nbsp;Lstat&nbsp;and&nbsp;Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2523391">//&nbsp;Return&nbsp;nil&nbsp;per&nbsp;RemoveAll&#39;s&nbsp;docs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523430">return</span>&nbsp;<span class="ident" id="2523437">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523447">return</span>&nbsp;<span class="ident" id="2523454">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2523463">//&nbsp;Remove&nbsp;contents&nbsp;&amp;&nbsp;return&nbsp;first&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2523505">err</span>&nbsp;<span class="op" id="2523509">=</span>&nbsp;<span class="ident" id="2523511">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523516">for</span>&nbsp;<span class="op" id="2523520">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2523524">names</span><span class="op" id="2523529">,</span>&nbsp;<span class="ident" id="2523531">err1</span>&nbsp;<span class="op" id="2523536">:=</span>&nbsp;<span class="ident" id="2523539">fd</span><span class="op" id="2523541">.</span><span class="ident" id="2523542">Readdirnames</span><span class="op" id="2523554">(</span><span class="num" id="2523555">100</span><span class="op" id="2523558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523562">for</span>&nbsp;<span class="ident" id="2523566">_</span><span class="op" id="2523567">,</span>&nbsp;<span class="ident" id="2523569">name</span>&nbsp;<span class="op" id="2523574">:=</span>&nbsp;<span class="keyword" id="2523577">range</span>&nbsp;<span class="ident" id="2523583">names</span>&nbsp;<span class="op" id="2523589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2523594">err1</span>&nbsp;<span class="op" id="2523599">:=</span>&nbsp;<span class="ident" id="2523602">RemoveAll</span><span class="op" id="2523611">(</span><span class="ident" id="2523612">path</span>&nbsp;<span class="op" id="2523617">+</span>&nbsp;<span class="builtintype" id="2523619">string</span><span class="op" id="2523625">(</span><span class="ident" id="2523626">PathSeparator</span><span class="op" id="2523639">)</span>&nbsp;<span class="op" id="2523641">+</span>&nbsp;<span class="ident" id="2523643">name</span><span class="op" id="2523647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523652">if</span>&nbsp;<span class="ident" id="2523655">err</span>&nbsp;<span class="op" id="2523659">==</span>&nbsp;<span class="ident" id="2523662">nil</span>&nbsp;<span class="op" id="2523666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2523672">err</span>&nbsp;<span class="op" id="2523676">=</span>&nbsp;<span class="ident" id="2523678">err1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523694">if</span>&nbsp;<span class="ident" id="2523697">err1</span>&nbsp;<span class="op" id="2523702">==</span>&nbsp;<span class="ident" id="2523705">io</span><span class="op" id="2523707">.</span><span class="ident" id="2523708">EOF</span>&nbsp;<span class="op" id="2523712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523717">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523725">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2523729">//&nbsp;If&nbsp;Readdirnames&nbsp;returned&nbsp;an&nbsp;error,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523777">if</span>&nbsp;<span class="ident" id="2523780">err</span>&nbsp;<span class="op" id="2523784">==</span>&nbsp;<span class="ident" id="2523787">nil</span>&nbsp;<span class="op" id="2523791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2523796">err</span>&nbsp;<span class="op" id="2523800">=</span>&nbsp;<span class="ident" id="2523802">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523813">if</span>&nbsp;<span class="builtinfunc" id="2523816">len</span><span class="op" id="2523819">(</span><span class="ident" id="2523820">names</span><span class="op" id="2523825">)</span>&nbsp;<span class="op" id="2523827">==</span>&nbsp;<span class="num" id="2523830">0</span>&nbsp;<span class="op" id="2523832">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523837">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2523848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2523852">//&nbsp;Close&nbsp;directory,&nbsp;because&nbsp;windows&nbsp;won&#39;t&nbsp;remove&nbsp;opened&nbsp;directory.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2523920">fd</span><span class="op" id="2523922">.</span><span class="ident" id="2523923">Close</span><span class="op" id="2523928">(</span><span class="op" id="2523929">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2523933">//&nbsp;Remove&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2523955">err1</span>&nbsp;<span class="op" id="2523960">:=</span>&nbsp;<span class="ident" id="2523963">Remove</span><span class="op" id="2523969">(</span><span class="ident" id="2523970">path</span><span class="op" id="2523974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2523977">if</span>&nbsp;<span class="ident" id="2523980">err1</span>&nbsp;<span class="op" id="2523985">==</span>&nbsp;<span class="ident" id="2523988">nil</span>&nbsp;<span class="op" id="2523992">||</span>&nbsp;<span class="ident" id="2523995">IsNotExist</span><span class="op" id="2524005">(</span><span class="ident" id="2524006">err1</span><span class="op" id="2524010">)</span>&nbsp;<span class="op" id="2524012">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2524016">return</span>&nbsp;<span class="ident" id="2524023">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2524028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2524031">if</span>&nbsp;<span class="ident" id="2524034">err</span>&nbsp;<span class="op" id="2524038">==</span>&nbsp;<span class="ident" id="2524041">nil</span>&nbsp;<span class="op" id="2524045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2524049">err</span>&nbsp;<span class="op" id="2524053">=</span>&nbsp;<span class="ident" id="2524055">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2524061">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2524064">return</span>&nbsp;<span class="ident" id="2524071">err</span><br>
<span class="lineno"></span><span class="op" id="2524075">}</span>
</div>
</body>
</html>
