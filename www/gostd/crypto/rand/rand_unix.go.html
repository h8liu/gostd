<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html" class="current">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3527770">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3527826">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3527880">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3527931">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3528007">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3528060">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3528075">package</span>&nbsp;<span class="ident" id="3528083">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3528089">import</span>&nbsp;<span class="op" id="3528096">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3528099">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3528108">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3528122">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3528139">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3528145">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3528151">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3528162">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3528170">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3528177">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3528180">const</span>&nbsp;<span class="ident" id="3528186">urandomDevice</span>&nbsp;<span class="op" id="3528200">=</span>&nbsp;<span class="string" id="3528202">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3528218">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="3528266">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3528318">func</span>&nbsp;<span class="ident" id="3528323">init</span><span class="op" id="3528327">(</span><span class="op" id="3528328">)</span>&nbsp;<span class="op" id="3528330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3528333">if</span>&nbsp;<span class="ident" id="3528336">runtime</span><span class="op" id="3528343">.</span><span class="ident" id="3528344">GOOS</span>&nbsp;<span class="op" id="3528349">==</span>&nbsp;<span class="string" id="3528352">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3528360">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3528364">Reader</span>&nbsp;<span class="op" id="3528371">=</span>&nbsp;<span class="ident" id="3528373">newReader</span><span class="op" id="3528382">(</span><span class="builtintype" id="3528383">nil</span><span class="op" id="3528386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3528389">}</span>&nbsp;<span class="keyword" id="3528391">else</span>&nbsp;<span class="op" id="3528396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3528400">Reader</span>&nbsp;<span class="op" id="3528407">=</span>&nbsp;<span class="op" id="3528409">&amp;</span><span class="ident" id="3528410">devReader</span><span class="op" id="3528419">{</span><span class="ident" id="3528420">name</span><span class="op" id="3528424">:</span>&nbsp;<span class="ident" id="3528426">urandomDevice</span><span class="op" id="3528439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3528442">}</span><br>
<span class="lineno"></span><span class="op" id="3528444">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3528447">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3528510">type</span>&nbsp;<span class="ident" id="3528515">devReader</span>&nbsp;<span class="keyword" id="3528525">struct</span>&nbsp;<span class="op" id="3528532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3528535">name</span>&nbsp;<span class="builtintype" id="3528540">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3528548">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3528553">io</span><span class="op" id="3528555">.</span><span class="ident" id="3528556">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3528564">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3528569">sync</span><span class="op" id="3528573">.</span><span class="ident" id="3528574">Mutex</span><br>
<span class="lineno"></span><span class="op" id="3528580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3528583">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="3528651">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="3528680">var</span>&nbsp;<span class="ident" id="3528684">altGetRandom</span>&nbsp;<span class="keyword" id="3528697">func</span><span class="op" id="3528701">(</span><span class="op" id="3528702">[</span><span class="op" id="3528703">]</span><span class="builtintype" id="3528704">byte</span><span class="op" id="3528708">)</span>&nbsp;<span class="op" id="3528710">(</span><span class="ident" id="3528711">ok</span>&nbsp;<span class="builtintype" id="3528714">bool</span><span class="op" id="3528718">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3528721">func</span>&nbsp;<span class="op" id="3528726">(</span><span class="ident" id="3528727">r</span>&nbsp;<span class="op" id="3528729">*</span><span class="ident" id="3528730">devReader</span><span class="op" id="3528739">)</span>&nbsp;<span class="ident" id="3528741">Read</span><span class="op" id="3528745">(</span><span class="ident" id="3528746">b</span>&nbsp;<span class="op" id="3528748">[</span><span class="op" id="3528749">]</span><span class="builtintype" id="3528750">byte</span><span class="op" id="3528754">)</span>&nbsp;<span class="op" id="3528756">(</span><span class="ident" id="3528757">n</span>&nbsp;<span class="builtintype" id="3528759">int</span><span class="op" id="3528762">,</span>&nbsp;<span class="ident" id="3528764">err</span>&nbsp;<span class="builtintype" id="3528768">error</span><span class="op" id="3528773">)</span>&nbsp;<span class="op" id="3528775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3528778">if</span>&nbsp;<span class="ident" id="3528781">altGetRandom</span>&nbsp;<span class="op" id="3528794">!=</span>&nbsp;<span class="builtintype" id="3528797">nil</span>&nbsp;<span class="op" id="3528801">&amp;&amp;</span>&nbsp;<span class="ident" id="3528804">r</span><span class="op" id="3528805">.</span><span class="ident" id="3528806">name</span>&nbsp;<span class="op" id="3528811">==</span>&nbsp;<span class="ident" id="3528814">urandomDevice</span>&nbsp;<span class="op" id="3528828">&amp;&amp;</span>&nbsp;<span class="ident" id="3528831">altGetRandom</span><span class="op" id="3528843">(</span><span class="ident" id="3528844">b</span><span class="op" id="3528845">)</span>&nbsp;<span class="op" id="3528847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3528851">return</span>&nbsp;<span class="builtinfunc" id="3528858">len</span><span class="op" id="3528861">(</span><span class="ident" id="3528862">b</span><span class="op" id="3528863">)</span><span class="op" id="3528864">,</span>&nbsp;<span class="builtintype" id="3528866">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3528871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3528874">r</span><span class="op" id="3528875">.</span><span class="ident" id="3528876">mu</span><span class="op" id="3528878">.</span><span class="ident" id="3528879">Lock</span><span class="op" id="3528883">(</span><span class="op" id="3528884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3528887">defer</span>&nbsp;<span class="ident" id="3528893">r</span><span class="op" id="3528894">.</span><span class="ident" id="3528895">mu</span><span class="op" id="3528897">.</span><span class="ident" id="3528898">Unlock</span><span class="op" id="3528904">(</span><span class="op" id="3528905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3528908">if</span>&nbsp;<span class="ident" id="3528911">r</span><span class="op" id="3528912">.</span><span class="ident" id="3528913">f</span>&nbsp;<span class="op" id="3528915">==</span>&nbsp;<span class="builtintype" id="3528918">nil</span>&nbsp;<span class="op" id="3528922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3528926">f</span><span class="op" id="3528927">,</span>&nbsp;<span class="ident" id="3528929">err</span>&nbsp;<span class="op" id="3528933">:=</span>&nbsp;<span class="ident" id="3528936">os</span><span class="op" id="3528938">.</span><span class="ident" id="3528939">Open</span><span class="op" id="3528943">(</span><span class="ident" id="3528944">r</span><span class="op" id="3528945">.</span><span class="ident" id="3528946">name</span><span class="op" id="3528950">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3528954">if</span>&nbsp;<span class="ident" id="3528957">f</span>&nbsp;<span class="op" id="3528959">==</span>&nbsp;<span class="builtintype" id="3528962">nil</span>&nbsp;<span class="op" id="3528966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3528971">return</span>&nbsp;<span class="num" id="3528978">0</span><span class="op" id="3528979">,</span>&nbsp;<span class="ident" id="3528981">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3528987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3528991">if</span>&nbsp;<span class="ident" id="3528994">runtime</span><span class="op" id="3529001">.</span><span class="ident" id="3529002">GOOS</span>&nbsp;<span class="op" id="3529007">==</span>&nbsp;<span class="string" id="3529010">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3529018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529023">r</span><span class="op" id="3529024">.</span><span class="ident" id="3529025">f</span>&nbsp;<span class="op" id="3529027">=</span>&nbsp;<span class="ident" id="3529029">f</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3529033">}</span>&nbsp;<span class="keyword" id="3529035">else</span>&nbsp;<span class="op" id="3529040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529045">r</span><span class="op" id="3529046">.</span><span class="ident" id="3529047">f</span>&nbsp;<span class="op" id="3529049">=</span>&nbsp;<span class="ident" id="3529051">bufio</span><span class="op" id="3529056">.</span><span class="ident" id="3529057">NewReader</span><span class="op" id="3529066">(</span><span class="ident" id="3529067">f</span><span class="op" id="3529068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3529072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3529075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3529078">return</span>&nbsp;<span class="ident" id="3529085">r</span><span class="op" id="3529086">.</span><span class="ident" id="3529087">f</span><span class="op" id="3529088">.</span><span class="ident" id="3529089">Read</span><span class="op" id="3529093">(</span><span class="ident" id="3529094">b</span><span class="op" id="3529095">)</span><br>
<span class="lineno">65</span><span class="op" id="3529097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3529100">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3529153">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3529198">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3529253">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="3529314">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3529373">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="3529424">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="3529481">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3529540">//</span><br>
<span class="lineno"></span><span class="comment" id="3529543">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="3529599">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3529648">func</span>&nbsp;<span class="ident" id="3529653">newReader</span><span class="op" id="3529662">(</span><span class="ident" id="3529663">entropy</span>&nbsp;<span class="ident" id="3529671">io</span><span class="op" id="3529673">.</span><span class="ident" id="3529674">Reader</span><span class="op" id="3529680">)</span>&nbsp;<span class="ident" id="3529682">io</span><span class="op" id="3529684">.</span><span class="ident" id="3529685">Reader</span>&nbsp;<span class="op" id="3529692">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3529695">if</span>&nbsp;<span class="ident" id="3529698">entropy</span>&nbsp;<span class="op" id="3529706">==</span>&nbsp;<span class="builtintype" id="3529709">nil</span>&nbsp;<span class="op" id="3529713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529717">entropy</span>&nbsp;<span class="op" id="3529725">=</span>&nbsp;<span class="op" id="3529727">&amp;</span><span class="ident" id="3529728">devReader</span><span class="op" id="3529737">{</span><span class="ident" id="3529738">name</span><span class="op" id="3529742">:</span>&nbsp;<span class="string" id="3529744">&#34;/dev/random&#34;</span><span class="op" id="3529757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3529760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3529763">return</span>&nbsp;<span class="op" id="3529770">&amp;</span><span class="ident" id="3529771">reader</span><span class="op" id="3529777">{</span><span class="ident" id="3529778">entropy</span><span class="op" id="3529785">:</span>&nbsp;<span class="ident" id="3529787">entropy</span><span class="op" id="3529794">}</span><br>
<span class="lineno"></span><span class="op" id="3529796">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3529799">type</span>&nbsp;<span class="ident" id="3529804">reader</span>&nbsp;<span class="keyword" id="3529811">struct</span>&nbsp;<span class="op" id="3529818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529821">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529842">sync</span><span class="op" id="3529846">.</span><span class="ident" id="3529847">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529854">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3529875">int</span>&nbsp;<span class="comment" id="3529879">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529921">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529942">cipher</span><span class="op" id="3529948">.</span><span class="ident" id="3529949">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529956">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529977">io</span><span class="op" id="3529979">.</span><span class="ident" id="3529980">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529988">time</span><span class="op" id="3529992">,</span>&nbsp;<span class="ident" id="3529994">seed</span><span class="op" id="3529998">,</span>&nbsp;<span class="ident" id="3530000">dst</span><span class="op" id="3530003">,</span>&nbsp;<span class="ident" id="3530005">key</span>&nbsp;<span class="op" id="3530009">[</span><span class="ident" id="3530010">aes</span><span class="op" id="3530013">.</span><span class="ident" id="3530014">BlockSize</span><span class="op" id="3530023">]</span><span class="builtintype" id="3530024">byte</span><br>
<span class="lineno"></span><span class="op" id="3530029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3530032">func</span>&nbsp;<span class="op" id="3530037">(</span><span class="ident" id="3530038">r</span>&nbsp;<span class="op" id="3530040">*</span><span class="ident" id="3530041">reader</span><span class="op" id="3530047">)</span>&nbsp;<span class="ident" id="3530049">Read</span><span class="op" id="3530053">(</span><span class="ident" id="3530054">b</span>&nbsp;<span class="op" id="3530056">[</span><span class="op" id="3530057">]</span><span class="builtintype" id="3530058">byte</span><span class="op" id="3530062">)</span>&nbsp;<span class="op" id="3530064">(</span><span class="ident" id="3530065">n</span>&nbsp;<span class="builtintype" id="3530067">int</span><span class="op" id="3530070">,</span>&nbsp;<span class="ident" id="3530072">err</span>&nbsp;<span class="builtintype" id="3530076">error</span><span class="op" id="3530081">)</span>&nbsp;<span class="op" id="3530083">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530086">r</span><span class="op" id="3530087">.</span><span class="ident" id="3530088">mu</span><span class="op" id="3530090">.</span><span class="ident" id="3530091">Lock</span><span class="op" id="3530095">(</span><span class="op" id="3530096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3530099">defer</span>&nbsp;<span class="ident" id="3530105">r</span><span class="op" id="3530106">.</span><span class="ident" id="3530107">mu</span><span class="op" id="3530109">.</span><span class="ident" id="3530110">Unlock</span><span class="op" id="3530116">(</span><span class="op" id="3530117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530120">n</span>&nbsp;<span class="op" id="3530122">=</span>&nbsp;<span class="builtinfunc" id="3530124">len</span><span class="op" id="3530127">(</span><span class="ident" id="3530128">b</span><span class="op" id="3530129">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3530133">for</span>&nbsp;<span class="builtinfunc" id="3530137">len</span><span class="op" id="3530140">(</span><span class="ident" id="3530141">b</span><span class="op" id="3530142">)</span>&nbsp;<span class="op" id="3530144">&gt;</span>&nbsp;<span class="num" id="3530146">0</span>&nbsp;<span class="op" id="3530148">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3530152">if</span>&nbsp;<span class="ident" id="3530155">r</span><span class="op" id="3530156">.</span><span class="ident" id="3530157">budget</span>&nbsp;<span class="op" id="3530164">==</span>&nbsp;<span class="num" id="3530167">0</span>&nbsp;<span class="op" id="3530169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530174">_</span><span class="op" id="3530175">,</span>&nbsp;<span class="ident" id="3530177">err</span>&nbsp;<span class="op" id="3530181">:=</span>&nbsp;<span class="ident" id="3530184">io</span><span class="op" id="3530186">.</span><span class="ident" id="3530187">ReadFull</span><span class="op" id="3530195">(</span><span class="ident" id="3530196">r</span><span class="op" id="3530197">.</span><span class="ident" id="3530198">entropy</span><span class="op" id="3530205">,</span>&nbsp;<span class="ident" id="3530207">r</span><span class="op" id="3530208">.</span><span class="ident" id="3530209">seed</span><span class="op" id="3530213">[</span><span class="num" id="3530214">0</span><span class="op" id="3530215">:</span><span class="op" id="3530216">]</span><span class="op" id="3530217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3530222">if</span>&nbsp;<span class="ident" id="3530225">err</span>&nbsp;<span class="op" id="3530229">!=</span>&nbsp;<span class="builtintype" id="3530232">nil</span>&nbsp;<span class="op" id="3530236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3530242">return</span>&nbsp;<span class="ident" id="3530249">n</span>&nbsp;<span class="op" id="3530251">-</span>&nbsp;<span class="builtinfunc" id="3530253">len</span><span class="op" id="3530256">(</span><span class="ident" id="3530257">b</span><span class="op" id="3530258">)</span><span class="op" id="3530259">,</span>&nbsp;<span class="ident" id="3530261">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3530268">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530273">_</span><span class="op" id="3530274">,</span>&nbsp;<span class="ident" id="3530276">err</span>&nbsp;<span class="op" id="3530280">=</span>&nbsp;<span class="ident" id="3530282">io</span><span class="op" id="3530284">.</span><span class="ident" id="3530285">ReadFull</span><span class="op" id="3530293">(</span><span class="ident" id="3530294">r</span><span class="op" id="3530295">.</span><span class="ident" id="3530296">entropy</span><span class="op" id="3530303">,</span>&nbsp;<span class="ident" id="3530305">r</span><span class="op" id="3530306">.</span><span class="ident" id="3530307">key</span><span class="op" id="3530310">[</span><span class="num" id="3530311">0</span><span class="op" id="3530312">:</span><span class="op" id="3530313">]</span><span class="op" id="3530314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3530319">if</span>&nbsp;<span class="ident" id="3530322">err</span>&nbsp;<span class="op" id="3530326">!=</span>&nbsp;<span class="builtintype" id="3530329">nil</span>&nbsp;<span class="op" id="3530333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3530339">return</span>&nbsp;<span class="ident" id="3530346">n</span>&nbsp;<span class="op" id="3530348">-</span>&nbsp;<span class="builtinfunc" id="3530350">len</span><span class="op" id="3530353">(</span><span class="ident" id="3530354">b</span><span class="op" id="3530355">)</span><span class="op" id="3530356">,</span>&nbsp;<span class="ident" id="3530358">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3530365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530370">r</span><span class="op" id="3530371">.</span><span class="ident" id="3530372">cipher</span><span class="op" id="3530378">,</span>&nbsp;<span class="ident" id="3530380">err</span>&nbsp;<span class="op" id="3530384">=</span>&nbsp;<span class="ident" id="3530386">aes</span><span class="op" id="3530389">.</span><span class="ident" id="3530390">NewCipher</span><span class="op" id="3530399">(</span><span class="ident" id="3530400">r</span><span class="op" id="3530401">.</span><span class="ident" id="3530402">key</span><span class="op" id="3530405">[</span><span class="num" id="3530406">0</span><span class="op" id="3530407">:</span><span class="op" id="3530408">]</span><span class="op" id="3530409">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3530414">if</span>&nbsp;<span class="ident" id="3530417">err</span>&nbsp;<span class="op" id="3530421">!=</span>&nbsp;<span class="builtintype" id="3530424">nil</span>&nbsp;<span class="op" id="3530428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3530434">return</span>&nbsp;<span class="ident" id="3530441">n</span>&nbsp;<span class="op" id="3530443">-</span>&nbsp;<span class="builtinfunc" id="3530445">len</span><span class="op" id="3530448">(</span><span class="ident" id="3530449">b</span><span class="op" id="3530450">)</span><span class="op" id="3530451">,</span>&nbsp;<span class="ident" id="3530453">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3530460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530465">r</span><span class="op" id="3530466">.</span><span class="ident" id="3530467">budget</span>&nbsp;<span class="op" id="3530474">=</span>&nbsp;<span class="num" id="3530476">1</span>&nbsp;<span class="op" id="3530478">&lt;&lt;</span>&nbsp;<span class="num" id="3530481">20</span>&nbsp;<span class="comment" id="3530484">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3530517">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530521">r</span><span class="op" id="3530522">.</span><span class="ident" id="3530523">budget</span>&nbsp;<span class="op" id="3530530">-=</span>&nbsp;<span class="ident" id="3530533">aes</span><span class="op" id="3530536">.</span><span class="ident" id="3530537">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3530550">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3530620">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3530625">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3530644">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3530667">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3530694">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530721">ns</span>&nbsp;<span class="op" id="3530724">:=</span>&nbsp;<span class="ident" id="3530727">time</span><span class="op" id="3530731">.</span><span class="ident" id="3530732">Now</span><span class="op" id="3530735">(</span><span class="op" id="3530736">)</span><span class="op" id="3530737">.</span><span class="ident" id="3530738">UnixNano</span><span class="op" id="3530746">(</span><span class="op" id="3530747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530751">r</span><span class="op" id="3530752">.</span><span class="ident" id="3530753">time</span><span class="op" id="3530757">[</span><span class="num" id="3530758">0</span><span class="op" id="3530759">]</span>&nbsp;<span class="op" id="3530761">=</span>&nbsp;<span class="builtintype" id="3530763">byte</span><span class="op" id="3530767">(</span><span class="ident" id="3530768">ns</span>&nbsp;<span class="op" id="3530771">&gt;&gt;</span>&nbsp;<span class="num" id="3530774">56</span><span class="op" id="3530776">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530780">r</span><span class="op" id="3530781">.</span><span class="ident" id="3530782">time</span><span class="op" id="3530786">[</span><span class="num" id="3530787">1</span><span class="op" id="3530788">]</span>&nbsp;<span class="op" id="3530790">=</span>&nbsp;<span class="builtintype" id="3530792">byte</span><span class="op" id="3530796">(</span><span class="ident" id="3530797">ns</span>&nbsp;<span class="op" id="3530800">&gt;&gt;</span>&nbsp;<span class="num" id="3530803">48</span><span class="op" id="3530805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530809">r</span><span class="op" id="3530810">.</span><span class="ident" id="3530811">time</span><span class="op" id="3530815">[</span><span class="num" id="3530816">2</span><span class="op" id="3530817">]</span>&nbsp;<span class="op" id="3530819">=</span>&nbsp;<span class="builtintype" id="3530821">byte</span><span class="op" id="3530825">(</span><span class="ident" id="3530826">ns</span>&nbsp;<span class="op" id="3530829">&gt;&gt;</span>&nbsp;<span class="num" id="3530832">40</span><span class="op" id="3530834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530838">r</span><span class="op" id="3530839">.</span><span class="ident" id="3530840">time</span><span class="op" id="3530844">[</span><span class="num" id="3530845">3</span><span class="op" id="3530846">]</span>&nbsp;<span class="op" id="3530848">=</span>&nbsp;<span class="builtintype" id="3530850">byte</span><span class="op" id="3530854">(</span><span class="ident" id="3530855">ns</span>&nbsp;<span class="op" id="3530858">&gt;&gt;</span>&nbsp;<span class="num" id="3530861">32</span><span class="op" id="3530863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530867">r</span><span class="op" id="3530868">.</span><span class="ident" id="3530869">time</span><span class="op" id="3530873">[</span><span class="num" id="3530874">4</span><span class="op" id="3530875">]</span>&nbsp;<span class="op" id="3530877">=</span>&nbsp;<span class="builtintype" id="3530879">byte</span><span class="op" id="3530883">(</span><span class="ident" id="3530884">ns</span>&nbsp;<span class="op" id="3530887">&gt;&gt;</span>&nbsp;<span class="num" id="3530890">24</span><span class="op" id="3530892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530896">r</span><span class="op" id="3530897">.</span><span class="ident" id="3530898">time</span><span class="op" id="3530902">[</span><span class="num" id="3530903">5</span><span class="op" id="3530904">]</span>&nbsp;<span class="op" id="3530906">=</span>&nbsp;<span class="builtintype" id="3530908">byte</span><span class="op" id="3530912">(</span><span class="ident" id="3530913">ns</span>&nbsp;<span class="op" id="3530916">&gt;&gt;</span>&nbsp;<span class="num" id="3530919">16</span><span class="op" id="3530921">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530925">r</span><span class="op" id="3530926">.</span><span class="ident" id="3530927">time</span><span class="op" id="3530931">[</span><span class="num" id="3530932">6</span><span class="op" id="3530933">]</span>&nbsp;<span class="op" id="3530935">=</span>&nbsp;<span class="builtintype" id="3530937">byte</span><span class="op" id="3530941">(</span><span class="ident" id="3530942">ns</span>&nbsp;<span class="op" id="3530945">&gt;&gt;</span>&nbsp;<span class="num" id="3530948">8</span><span class="op" id="3530949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530953">r</span><span class="op" id="3530954">.</span><span class="ident" id="3530955">time</span><span class="op" id="3530959">[</span><span class="num" id="3530960">7</span><span class="op" id="3530961">]</span>&nbsp;<span class="op" id="3530963">=</span>&nbsp;<span class="builtintype" id="3530965">byte</span><span class="op" id="3530969">(</span><span class="ident" id="3530970">ns</span><span class="op" id="3530972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3530976">r</span><span class="op" id="3530977">.</span><span class="ident" id="3530978">cipher</span><span class="op" id="3530984">.</span><span class="ident" id="3530985">Encrypt</span><span class="op" id="3530992">(</span><span class="ident" id="3530993">r</span><span class="op" id="3530994">.</span><span class="ident" id="3530995">time</span><span class="op" id="3530999">[</span><span class="num" id="3531000">0</span><span class="op" id="3531001">:</span><span class="op" id="3531002">]</span><span class="op" id="3531003">,</span>&nbsp;<span class="ident" id="3531005">r</span><span class="op" id="3531006">.</span><span class="ident" id="3531007">time</span><span class="op" id="3531011">[</span><span class="num" id="3531012">0</span><span class="op" id="3531013">:</span><span class="op" id="3531014">]</span><span class="op" id="3531015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3531019">for</span>&nbsp;<span class="ident" id="3531023">i</span>&nbsp;<span class="op" id="3531025">:=</span>&nbsp;<span class="num" id="3531028">0</span><span class="op" id="3531029">;</span>&nbsp;<span class="ident" id="3531031">i</span>&nbsp;<span class="op" id="3531033">&lt;</span>&nbsp;<span class="ident" id="3531035">aes</span><span class="op" id="3531038">.</span><span class="ident" id="3531039">BlockSize</span><span class="op" id="3531048">;</span>&nbsp;<span class="ident" id="3531050">i</span><span class="op" id="3531051">++</span>&nbsp;<span class="op" id="3531054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3531059">r</span><span class="op" id="3531060">.</span><span class="ident" id="3531061">dst</span><span class="op" id="3531064">[</span><span class="ident" id="3531065">i</span><span class="op" id="3531066">]</span>&nbsp;<span class="op" id="3531068">=</span>&nbsp;<span class="ident" id="3531070">r</span><span class="op" id="3531071">.</span><span class="ident" id="3531072">time</span><span class="op" id="3531076">[</span><span class="ident" id="3531077">i</span><span class="op" id="3531078">]</span>&nbsp;<span class="op" id="3531080">^</span>&nbsp;<span class="ident" id="3531082">r</span><span class="op" id="3531083">.</span><span class="ident" id="3531084">seed</span><span class="op" id="3531088">[</span><span class="ident" id="3531089">i</span><span class="op" id="3531090">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3531094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3531098">r</span><span class="op" id="3531099">.</span><span class="ident" id="3531100">cipher</span><span class="op" id="3531106">.</span><span class="ident" id="3531107">Encrypt</span><span class="op" id="3531114">(</span><span class="ident" id="3531115">r</span><span class="op" id="3531116">.</span><span class="ident" id="3531117">dst</span><span class="op" id="3531120">[</span><span class="num" id="3531121">0</span><span class="op" id="3531122">:</span><span class="op" id="3531123">]</span><span class="op" id="3531124">,</span>&nbsp;<span class="ident" id="3531126">r</span><span class="op" id="3531127">.</span><span class="ident" id="3531128">dst</span><span class="op" id="3531131">[</span><span class="num" id="3531132">0</span><span class="op" id="3531133">:</span><span class="op" id="3531134">]</span><span class="op" id="3531135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3531139">for</span>&nbsp;<span class="ident" id="3531143">i</span>&nbsp;<span class="op" id="3531145">:=</span>&nbsp;<span class="num" id="3531148">0</span><span class="op" id="3531149">;</span>&nbsp;<span class="ident" id="3531151">i</span>&nbsp;<span class="op" id="3531153">&lt;</span>&nbsp;<span class="ident" id="3531155">aes</span><span class="op" id="3531158">.</span><span class="ident" id="3531159">BlockSize</span><span class="op" id="3531168">;</span>&nbsp;<span class="ident" id="3531170">i</span><span class="op" id="3531171">++</span>&nbsp;<span class="op" id="3531174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3531179">r</span><span class="op" id="3531180">.</span><span class="ident" id="3531181">seed</span><span class="op" id="3531185">[</span><span class="ident" id="3531186">i</span><span class="op" id="3531187">]</span>&nbsp;<span class="op" id="3531189">=</span>&nbsp;<span class="ident" id="3531191">r</span><span class="op" id="3531192">.</span><span class="ident" id="3531193">time</span><span class="op" id="3531197">[</span><span class="ident" id="3531198">i</span><span class="op" id="3531199">]</span>&nbsp;<span class="op" id="3531201">^</span>&nbsp;<span class="ident" id="3531203">r</span><span class="op" id="3531204">.</span><span class="ident" id="3531205">dst</span><span class="op" id="3531208">[</span><span class="ident" id="3531209">i</span><span class="op" id="3531210">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3531214">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3531218">r</span><span class="op" id="3531219">.</span><span class="ident" id="3531220">cipher</span><span class="op" id="3531226">.</span><span class="ident" id="3531227">Encrypt</span><span class="op" id="3531234">(</span><span class="ident" id="3531235">r</span><span class="op" id="3531236">.</span><span class="ident" id="3531237">seed</span><span class="op" id="3531241">[</span><span class="num" id="3531242">0</span><span class="op" id="3531243">:</span><span class="op" id="3531244">]</span><span class="op" id="3531245">,</span>&nbsp;<span class="ident" id="3531247">r</span><span class="op" id="3531248">.</span><span class="ident" id="3531249">seed</span><span class="op" id="3531253">[</span><span class="num" id="3531254">0</span><span class="op" id="3531255">:</span><span class="op" id="3531256">]</span><span class="op" id="3531257">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3531262">m</span>&nbsp;<span class="op" id="3531264">:=</span>&nbsp;<span class="builtinfunc" id="3531267">copy</span><span class="op" id="3531271">(</span><span class="ident" id="3531272">b</span><span class="op" id="3531273">,</span>&nbsp;<span class="ident" id="3531275">r</span><span class="op" id="3531276">.</span><span class="ident" id="3531277">dst</span><span class="op" id="3531280">[</span><span class="num" id="3531281">0</span><span class="op" id="3531282">:</span><span class="op" id="3531283">]</span><span class="op" id="3531284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3531288">b</span>&nbsp;<span class="op" id="3531290">=</span>&nbsp;<span class="ident" id="3531292">b</span><span class="op" id="3531293">[</span><span class="ident" id="3531294">m</span><span class="op" id="3531295">:</span><span class="op" id="3531296">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3531299">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3531303">return</span>&nbsp;<span class="ident" id="3531310">n</span><span class="op" id="3531311">,</span>&nbsp;<span class="builtintype" id="3531313">nil</span><br>
<span class="lineno"></span><span class="op" id="3531317">}</span>
</div>
</body>
</html>
