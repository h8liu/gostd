<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4913452">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4913507">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4913561">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4913612">/*<br>
<span class="lineno"></span>Package&nbsp;zlib&nbsp;implements&nbsp;reading&nbsp;and&nbsp;writing&nbsp;of&nbsp;zlib&nbsp;format&nbsp;compressed&nbsp;data,<br>
<span class="lineno"></span>as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;1950.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>The&nbsp;implementation&nbsp;provides&nbsp;filters&nbsp;that&nbsp;uncompress&nbsp;during&nbsp;reading<br>
<span class="lineno">10</span>and&nbsp;compress&nbsp;during&nbsp;writing.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;write&nbsp;compressed&nbsp;data<br>
<span class="lineno"></span>to&nbsp;a&nbsp;buffer:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;b&nbsp;bytes.Buffer<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspw&nbsp;:=&nbsp;zlib.NewWriter(&amp;b)<br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbspw.Write([]byte(&#34;hello,&nbsp;world\n&#34;))<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspw.Close()<br>
<span class="lineno"></span><br>
<span class="lineno"></span>and&nbsp;to&nbsp;read&nbsp;that&nbsp;data&nbsp;back:<br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbspr,&nbsp;err&nbsp;:=&nbsp;zlib.NewReader(&amp;b)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspio.Copy(os.Stdout,&nbsp;r)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspr.Close()<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="4914055">package</span>&nbsp;<span class="ident" id="4914063">zlib</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="4914069">import</span>&nbsp;<span class="op" id="4914076">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4914079">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4914088">&#34;compress/flate&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4914106">&#34;errors&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4914116">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4914124">&#34;hash/adler32&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4914140">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="4914145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="4914148">const</span>&nbsp;<span class="ident" id="4914154">zlibDeflate</span>&nbsp;<span class="op" id="4914166">=</span>&nbsp;<span class="num" id="4914168">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4914171">var</span>&nbsp;<span class="op" id="4914175">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914178">//&nbsp;ErrChecksum&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914259">ErrChecksum</span>&nbsp;<span class="op" id="4914271">=</span>&nbsp;<span class="ident" id="4914273">errors</span><span class="op" id="4914279">.</span><span class="ident" id="4914280">New</span><span class="op" id="4914283">(</span><span class="string" id="4914284">&#34;zlib:&nbsp;invalid&nbsp;checksum&#34;</span><span class="op" id="4914308">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914311">//&nbsp;ErrDictionary&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;dictionary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914396">ErrDictionary</span>&nbsp;<span class="op" id="4914410">=</span>&nbsp;<span class="ident" id="4914412">errors</span><span class="op" id="4914418">.</span><span class="ident" id="4914419">New</span><span class="op" id="4914422">(</span><span class="string" id="4914423">&#34;zlib:&nbsp;invalid&nbsp;dictionary&#34;</span><span class="op" id="4914449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914452">//&nbsp;ErrHeader&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914529">ErrHeader</span>&nbsp;<span class="op" id="4914539">=</span>&nbsp;<span class="ident" id="4914541">errors</span><span class="op" id="4914547">.</span><span class="ident" id="4914548">New</span><span class="op" id="4914551">(</span><span class="string" id="4914552">&#34;zlib:&nbsp;invalid&nbsp;header&#34;</span><span class="op" id="4914574">)</span><br>
<span class="lineno"></span><span class="op" id="4914576">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="4914579">type</span>&nbsp;<span class="ident" id="4914584">reader</span>&nbsp;<span class="keyword" id="4914591">struct</span>&nbsp;<span class="op" id="4914598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914601">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4914614">flate</span><span class="op" id="4914619">.</span><span class="ident" id="4914620">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914628">decompressor</span>&nbsp;<span class="ident" id="4914641">io</span><span class="op" id="4914643">.</span><span class="ident" id="4914644">ReadCloser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914656">digest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4914669">hash</span><span class="op" id="4914673">.</span><span class="ident" id="4914674">Hash32</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914682">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4914695">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914702">scratch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4914715">[</span><span class="num" id="4914716">4</span><span class="op" id="4914717">]</span><span class="builtintype" id="4914718">byte</span><br>
<span class="lineno"></span><span class="op" id="4914723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4914726">//&nbsp;Resetter&nbsp;resets&nbsp;a&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;or&nbsp;NewReaderDict&nbsp;to</span><br>
<span class="lineno">55</span><span class="comment" id="4914800">//&nbsp;to&nbsp;switch&nbsp;to&nbsp;a&nbsp;new&nbsp;underlying&nbsp;Reader.&nbsp;This&nbsp;permits&nbsp;reusing&nbsp;a&nbsp;ReadCloser</span><br>
<span class="lineno"></span><span class="comment" id="4914875">//&nbsp;instead&nbsp;of&nbsp;allocating&nbsp;a&nbsp;new&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="4914911">type</span>&nbsp;<span class="ident" id="4914916">Resetter</span>&nbsp;<span class="keyword" id="4914925">interface</span>&nbsp;<span class="op" id="4914935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914938">//&nbsp;Reset&nbsp;discards&nbsp;any&nbsp;buffered&nbsp;data&nbsp;and&nbsp;resets&nbsp;the&nbsp;Resetter&nbsp;as&nbsp;if&nbsp;it&nbsp;was</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4915012">//&nbsp;newly&nbsp;initialized&nbsp;with&nbsp;the&nbsp;given&nbsp;reader.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915057">Reset</span><span class="op" id="4915062">(</span><span class="ident" id="4915063">r</span>&nbsp;<span class="ident" id="4915065">io</span><span class="op" id="4915067">.</span><span class="ident" id="4915068">Reader</span><span class="op" id="4915074">,</span>&nbsp;<span class="ident" id="4915076">dict</span>&nbsp;<span class="op" id="4915081">[</span><span class="op" id="4915082">]</span><span class="builtintype" id="4915083">byte</span><span class="op" id="4915087">)</span>&nbsp;<span class="builtintype" id="4915089">error</span><br>
<span class="lineno"></span><span class="op" id="4915095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4915098">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;ReadCloser.</span><br>
<span class="lineno"></span><span class="comment" id="4915137">//&nbsp;Reads&nbsp;from&nbsp;the&nbsp;returned&nbsp;ReadCloser&nbsp;read&nbsp;and&nbsp;decompress&nbsp;data&nbsp;from&nbsp;r.</span><br>
<span class="lineno">65</span><span class="comment" id="4915208">//&nbsp;The&nbsp;implementation&nbsp;buffers&nbsp;input&nbsp;and&nbsp;may&nbsp;read&nbsp;more&nbsp;data&nbsp;than&nbsp;necessary&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4915290">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;call&nbsp;Close&nbsp;on&nbsp;the&nbsp;ReadCloser&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span><span class="comment" id="4915370">//</span><br>
<span class="lineno"></span><span class="comment" id="4915373">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="4915439">func</span>&nbsp;<span class="ident" id="4915444">NewReader</span><span class="op" id="4915453">(</span><span class="ident" id="4915454">r</span>&nbsp;<span class="ident" id="4915456">io</span><span class="op" id="4915458">.</span><span class="ident" id="4915459">Reader</span><span class="op" id="4915465">)</span>&nbsp;<span class="op" id="4915467">(</span><span class="ident" id="4915468">io</span><span class="op" id="4915470">.</span><span class="ident" id="4915471">ReadCloser</span><span class="op" id="4915481">,</span>&nbsp;<span class="builtintype" id="4915483">error</span><span class="op" id="4915488">)</span>&nbsp;<span class="op" id="4915490">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4915493">return</span>&nbsp;<span class="ident" id="4915500">NewReaderDict</span><span class="op" id="4915513">(</span><span class="ident" id="4915514">r</span><span class="op" id="4915515">,</span>&nbsp;<span class="ident" id="4915517">nil</span><span class="op" id="4915520">)</span><br>
<span class="lineno"></span><span class="op" id="4915522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4915525">//&nbsp;NewReaderDict&nbsp;is&nbsp;like&nbsp;NewReader&nbsp;but&nbsp;uses&nbsp;a&nbsp;preset&nbsp;dictionary.</span><br>
<span class="lineno"></span><span class="comment" id="4915590">//&nbsp;NewReaderDict&nbsp;ignores&nbsp;the&nbsp;dictionary&nbsp;if&nbsp;the&nbsp;compressed&nbsp;data&nbsp;does&nbsp;not&nbsp;refer&nbsp;to&nbsp;it.</span><br>
<span class="lineno">75</span><span class="comment" id="4915675">//&nbsp;If&nbsp;the&nbsp;compressed&nbsp;data&nbsp;refers&nbsp;to&nbsp;a&nbsp;different&nbsp;dictionary,&nbsp;NewReaderDict&nbsp;returns&nbsp;ErrDictionary.</span><br>
<span class="lineno"></span><span class="comment" id="4915772">//</span><br>
<span class="lineno"></span><span class="comment" id="4915775">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReaderDict&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="4915845">func</span>&nbsp;<span class="ident" id="4915850">NewReaderDict</span><span class="op" id="4915863">(</span><span class="ident" id="4915864">r</span>&nbsp;<span class="ident" id="4915866">io</span><span class="op" id="4915868">.</span><span class="ident" id="4915869">Reader</span><span class="op" id="4915875">,</span>&nbsp;<span class="ident" id="4915877">dict</span>&nbsp;<span class="op" id="4915882">[</span><span class="op" id="4915883">]</span><span class="builtintype" id="4915884">byte</span><span class="op" id="4915888">)</span>&nbsp;<span class="op" id="4915890">(</span><span class="ident" id="4915891">io</span><span class="op" id="4915893">.</span><span class="ident" id="4915894">ReadCloser</span><span class="op" id="4915904">,</span>&nbsp;<span class="builtintype" id="4915906">error</span><span class="op" id="4915911">)</span>&nbsp;<span class="op" id="4915913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915916">z</span>&nbsp;<span class="op" id="4915918">:=</span>&nbsp;<span class="builtinfunc" id="4915921">new</span><span class="op" id="4915924">(</span><span class="ident" id="4915925">reader</span><span class="op" id="4915931">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915934">err</span>&nbsp;<span class="op" id="4915938">:=</span>&nbsp;<span class="ident" id="4915941">z</span><span class="op" id="4915942">.</span><span class="ident" id="4915943">Reset</span><span class="op" id="4915948">(</span><span class="ident" id="4915949">r</span><span class="op" id="4915950">,</span>&nbsp;<span class="ident" id="4915952">dict</span><span class="op" id="4915956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4915959">if</span>&nbsp;<span class="ident" id="4915962">err</span>&nbsp;<span class="op" id="4915966">!=</span>&nbsp;<span class="ident" id="4915969">nil</span>&nbsp;<span class="op" id="4915973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4915977">return</span>&nbsp;<span class="ident" id="4915984">nil</span><span class="op" id="4915987">,</span>&nbsp;<span class="ident" id="4915989">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4915994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4915997">return</span>&nbsp;<span class="ident" id="4916004">z</span><span class="op" id="4916005">,</span>&nbsp;<span class="ident" id="4916007">nil</span><br>
<span class="lineno">85</span><span class="op" id="4916011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4916014">func</span>&nbsp;<span class="op" id="4916019">(</span><span class="ident" id="4916020">z</span>&nbsp;<span class="op" id="4916022">*</span><span class="ident" id="4916023">reader</span><span class="op" id="4916029">)</span>&nbsp;<span class="ident" id="4916031">Read</span><span class="op" id="4916035">(</span><span class="ident" id="4916036">p</span>&nbsp;<span class="op" id="4916038">[</span><span class="op" id="4916039">]</span><span class="builtintype" id="4916040">byte</span><span class="op" id="4916044">)</span>&nbsp;<span class="op" id="4916046">(</span><span class="ident" id="4916047">n</span>&nbsp;<span class="builtintype" id="4916049">int</span><span class="op" id="4916052">,</span>&nbsp;<span class="ident" id="4916054">err</span>&nbsp;<span class="builtintype" id="4916058">error</span><span class="op" id="4916063">)</span>&nbsp;<span class="op" id="4916065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916068">if</span>&nbsp;<span class="ident" id="4916071">z</span><span class="op" id="4916072">.</span><span class="ident" id="4916073">err</span>&nbsp;<span class="op" id="4916077">!=</span>&nbsp;<span class="ident" id="4916080">nil</span>&nbsp;<span class="op" id="4916084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916088">return</span>&nbsp;<span class="num" id="4916095">0</span><span class="op" id="4916096">,</span>&nbsp;<span class="ident" id="4916098">z</span><span class="op" id="4916099">.</span><span class="ident" id="4916100">err</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916108">if</span>&nbsp;<span class="builtinfunc" id="4916111">len</span><span class="op" id="4916114">(</span><span class="ident" id="4916115">p</span><span class="op" id="4916116">)</span>&nbsp;<span class="op" id="4916118">==</span>&nbsp;<span class="num" id="4916121">0</span>&nbsp;<span class="op" id="4916123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916127">return</span>&nbsp;<span class="num" id="4916134">0</span><span class="op" id="4916135">,</span>&nbsp;<span class="ident" id="4916137">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916146">n</span><span class="op" id="4916147">,</span>&nbsp;<span class="ident" id="4916149">err</span>&nbsp;<span class="op" id="4916153">=</span>&nbsp;<span class="ident" id="4916155">z</span><span class="op" id="4916156">.</span><span class="ident" id="4916157">decompressor</span><span class="op" id="4916169">.</span><span class="ident" id="4916170">Read</span><span class="op" id="4916174">(</span><span class="ident" id="4916175">p</span><span class="op" id="4916176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916179">z</span><span class="op" id="4916180">.</span><span class="ident" id="4916181">digest</span><span class="op" id="4916187">.</span><span class="ident" id="4916188">Write</span><span class="op" id="4916193">(</span><span class="ident" id="4916194">p</span><span class="op" id="4916195">[</span><span class="num" id="4916196">0</span><span class="op" id="4916197">:</span><span class="ident" id="4916198">n</span><span class="op" id="4916199">]</span><span class="op" id="4916200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916203">if</span>&nbsp;<span class="ident" id="4916206">n</span>&nbsp;<span class="op" id="4916208">!=</span>&nbsp;<span class="num" id="4916211">0</span>&nbsp;<span class="op" id="4916213">||</span>&nbsp;<span class="ident" id="4916216">err</span>&nbsp;<span class="op" id="4916220">!=</span>&nbsp;<span class="ident" id="4916223">io</span><span class="op" id="4916225">.</span><span class="ident" id="4916226">EOF</span>&nbsp;<span class="op" id="4916230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916234">z</span><span class="op" id="4916235">.</span><span class="ident" id="4916236">err</span>&nbsp;<span class="op" id="4916240">=</span>&nbsp;<span class="ident" id="4916242">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916248">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4916260">//&nbsp;Finished&nbsp;file;&nbsp;check&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916295">if</span>&nbsp;<span class="ident" id="4916298">_</span><span class="op" id="4916299">,</span>&nbsp;<span class="ident" id="4916301">err</span>&nbsp;<span class="op" id="4916305">:=</span>&nbsp;<span class="ident" id="4916308">io</span><span class="op" id="4916310">.</span><span class="ident" id="4916311">ReadFull</span><span class="op" id="4916319">(</span><span class="ident" id="4916320">z</span><span class="op" id="4916321">.</span><span class="ident" id="4916322">r</span><span class="op" id="4916323">,</span>&nbsp;<span class="ident" id="4916325">z</span><span class="op" id="4916326">.</span><span class="ident" id="4916327">scratch</span><span class="op" id="4916334">[</span><span class="num" id="4916335">0</span><span class="op" id="4916336">:</span><span class="num" id="4916337">4</span><span class="op" id="4916338">]</span><span class="op" id="4916339">)</span><span class="op" id="4916340">;</span>&nbsp;<span class="ident" id="4916342">err</span>&nbsp;<span class="op" id="4916346">!=</span>&nbsp;<span class="ident" id="4916349">nil</span>&nbsp;<span class="op" id="4916353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916357">z</span><span class="op" id="4916358">.</span><span class="ident" id="4916359">err</span>&nbsp;<span class="op" id="4916363">=</span>&nbsp;<span class="ident" id="4916365">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916371">return</span>&nbsp;<span class="num" id="4916378">0</span><span class="op" id="4916379">,</span>&nbsp;<span class="ident" id="4916381">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4916389">//&nbsp;ZLIB&nbsp;(RFC&nbsp;1950)&nbsp;is&nbsp;big-endian,&nbsp;unlike&nbsp;GZIP&nbsp;(RFC&nbsp;1952).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916448">checksum</span>&nbsp;<span class="op" id="4916457">:=</span>&nbsp;<span class="builtintype" id="4916460">uint32</span><span class="op" id="4916466">(</span><span class="ident" id="4916467">z</span><span class="op" id="4916468">.</span><span class="ident" id="4916469">scratch</span><span class="op" id="4916476">[</span><span class="num" id="4916477">0</span><span class="op" id="4916478">]</span><span class="op" id="4916479">)</span><span class="op" id="4916480">&lt;&lt;</span><span class="num" id="4916482">24</span>&nbsp;<span class="op" id="4916485">|</span>&nbsp;<span class="builtintype" id="4916487">uint32</span><span class="op" id="4916493">(</span><span class="ident" id="4916494">z</span><span class="op" id="4916495">.</span><span class="ident" id="4916496">scratch</span><span class="op" id="4916503">[</span><span class="num" id="4916504">1</span><span class="op" id="4916505">]</span><span class="op" id="4916506">)</span><span class="op" id="4916507">&lt;&lt;</span><span class="num" id="4916509">16</span>&nbsp;<span class="op" id="4916512">|</span>&nbsp;<span class="builtintype" id="4916514">uint32</span><span class="op" id="4916520">(</span><span class="ident" id="4916521">z</span><span class="op" id="4916522">.</span><span class="ident" id="4916523">scratch</span><span class="op" id="4916530">[</span><span class="num" id="4916531">2</span><span class="op" id="4916532">]</span><span class="op" id="4916533">)</span><span class="op" id="4916534">&lt;&lt;</span><span class="num" id="4916536">8</span>&nbsp;<span class="op" id="4916538">|</span>&nbsp;<span class="builtintype" id="4916540">uint32</span><span class="op" id="4916546">(</span><span class="ident" id="4916547">z</span><span class="op" id="4916548">.</span><span class="ident" id="4916549">scratch</span><span class="op" id="4916556">[</span><span class="num" id="4916557">3</span><span class="op" id="4916558">]</span><span class="op" id="4916559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916562">if</span>&nbsp;<span class="ident" id="4916565">checksum</span>&nbsp;<span class="op" id="4916574">!=</span>&nbsp;<span class="ident" id="4916577">z</span><span class="op" id="4916578">.</span><span class="ident" id="4916579">digest</span><span class="op" id="4916585">.</span><span class="ident" id="4916586">Sum32</span><span class="op" id="4916591">(</span><span class="op" id="4916592">)</span>&nbsp;<span class="op" id="4916594">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916598">z</span><span class="op" id="4916599">.</span><span class="ident" id="4916600">err</span>&nbsp;<span class="op" id="4916604">=</span>&nbsp;<span class="ident" id="4916606">ErrChecksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916620">return</span>&nbsp;<span class="num" id="4916627">0</span><span class="op" id="4916628">,</span>&nbsp;<span class="ident" id="4916630">z</span><span class="op" id="4916631">.</span><span class="ident" id="4916632">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916640">return</span><br>
<span class="lineno"></span><span class="op" id="4916647">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="4916650">//&nbsp;Calling&nbsp;Close&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;wrapped&nbsp;io.Reader&nbsp;originally&nbsp;passed&nbsp;to&nbsp;NewReader.</span><br>
<span class="lineno"></span><span class="keyword" id="4916736">func</span>&nbsp;<span class="op" id="4916741">(</span><span class="ident" id="4916742">z</span>&nbsp;<span class="op" id="4916744">*</span><span class="ident" id="4916745">reader</span><span class="op" id="4916751">)</span>&nbsp;<span class="ident" id="4916753">Close</span><span class="op" id="4916758">(</span><span class="op" id="4916759">)</span>&nbsp;<span class="builtintype" id="4916761">error</span>&nbsp;<span class="op" id="4916767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916770">if</span>&nbsp;<span class="ident" id="4916773">z</span><span class="op" id="4916774">.</span><span class="ident" id="4916775">err</span>&nbsp;<span class="op" id="4916779">!=</span>&nbsp;<span class="ident" id="4916782">nil</span>&nbsp;<span class="op" id="4916786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916790">return</span>&nbsp;<span class="ident" id="4916797">z</span><span class="op" id="4916798">.</span><span class="ident" id="4916799">err</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916807">z</span><span class="op" id="4916808">.</span><span class="ident" id="4916809">err</span>&nbsp;<span class="op" id="4916813">=</span>&nbsp;<span class="ident" id="4916815">z</span><span class="op" id="4916816">.</span><span class="ident" id="4916817">decompressor</span><span class="op" id="4916829">.</span><span class="ident" id="4916830">Close</span><span class="op" id="4916835">(</span><span class="op" id="4916836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916839">return</span>&nbsp;<span class="ident" id="4916846">z</span><span class="op" id="4916847">.</span><span class="ident" id="4916848">err</span><br>
<span class="lineno"></span><span class="op" id="4916852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="4916855">func</span>&nbsp;<span class="op" id="4916860">(</span><span class="ident" id="4916861">z</span>&nbsp;<span class="op" id="4916863">*</span><span class="ident" id="4916864">reader</span><span class="op" id="4916870">)</span>&nbsp;<span class="ident" id="4916872">Reset</span><span class="op" id="4916877">(</span><span class="ident" id="4916878">r</span>&nbsp;<span class="ident" id="4916880">io</span><span class="op" id="4916882">.</span><span class="ident" id="4916883">Reader</span><span class="op" id="4916889">,</span>&nbsp;<span class="ident" id="4916891">dict</span>&nbsp;<span class="op" id="4916896">[</span><span class="op" id="4916897">]</span><span class="builtintype" id="4916898">byte</span><span class="op" id="4916902">)</span>&nbsp;<span class="builtintype" id="4916904">error</span>&nbsp;<span class="op" id="4916910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916913">if</span>&nbsp;<span class="ident" id="4916916">fr</span><span class="op" id="4916918">,</span>&nbsp;<span class="ident" id="4916920">ok</span>&nbsp;<span class="op" id="4916923">:=</span>&nbsp;<span class="ident" id="4916926">r</span><span class="op" id="4916927">.</span><span class="op" id="4916928">(</span><span class="ident" id="4916929">flate</span><span class="op" id="4916934">.</span><span class="ident" id="4916935">Reader</span><span class="op" id="4916941">)</span><span class="op" id="4916942">;</span>&nbsp;<span class="ident" id="4916944">ok</span>&nbsp;<span class="op" id="4916947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916951">z</span><span class="op" id="4916952">.</span><span class="ident" id="4916953">r</span>&nbsp;<span class="op" id="4916955">=</span>&nbsp;<span class="ident" id="4916957">fr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916961">}</span>&nbsp;<span class="keyword" id="4916963">else</span>&nbsp;<span class="op" id="4916968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916972">z</span><span class="op" id="4916973">.</span><span class="ident" id="4916974">r</span>&nbsp;<span class="op" id="4916976">=</span>&nbsp;<span class="ident" id="4916978">bufio</span><span class="op" id="4916983">.</span><span class="ident" id="4916984">NewReader</span><span class="op" id="4916993">(</span><span class="ident" id="4916994">r</span><span class="op" id="4916995">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917001">_</span><span class="op" id="4917002">,</span>&nbsp;<span class="ident" id="4917004">err</span>&nbsp;<span class="op" id="4917008">:=</span>&nbsp;<span class="ident" id="4917011">io</span><span class="op" id="4917013">.</span><span class="ident" id="4917014">ReadFull</span><span class="op" id="4917022">(</span><span class="ident" id="4917023">z</span><span class="op" id="4917024">.</span><span class="ident" id="4917025">r</span><span class="op" id="4917026">,</span>&nbsp;<span class="ident" id="4917028">z</span><span class="op" id="4917029">.</span><span class="ident" id="4917030">scratch</span><span class="op" id="4917037">[</span><span class="num" id="4917038">0</span><span class="op" id="4917039">:</span><span class="num" id="4917040">2</span><span class="op" id="4917041">]</span><span class="op" id="4917042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917045">if</span>&nbsp;<span class="ident" id="4917048">err</span>&nbsp;<span class="op" id="4917052">!=</span>&nbsp;<span class="ident" id="4917055">nil</span>&nbsp;<span class="op" id="4917059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917063">return</span>&nbsp;<span class="ident" id="4917070">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917075">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917078">h</span>&nbsp;<span class="op" id="4917080">:=</span>&nbsp;<span class="builtintype" id="4917083">uint</span><span class="op" id="4917087">(</span><span class="ident" id="4917088">z</span><span class="op" id="4917089">.</span><span class="ident" id="4917090">scratch</span><span class="op" id="4917097">[</span><span class="num" id="4917098">0</span><span class="op" id="4917099">]</span><span class="op" id="4917100">)</span><span class="op" id="4917101">&lt;&lt;</span><span class="num" id="4917103">8</span>&nbsp;<span class="op" id="4917105">|</span>&nbsp;<span class="builtintype" id="4917107">uint</span><span class="op" id="4917111">(</span><span class="ident" id="4917112">z</span><span class="op" id="4917113">.</span><span class="ident" id="4917114">scratch</span><span class="op" id="4917121">[</span><span class="num" id="4917122">1</span><span class="op" id="4917123">]</span><span class="op" id="4917124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917127">if</span>&nbsp;<span class="op" id="4917130">(</span><span class="ident" id="4917131">z</span><span class="op" id="4917132">.</span><span class="ident" id="4917133">scratch</span><span class="op" id="4917140">[</span><span class="num" id="4917141">0</span><span class="op" id="4917142">]</span><span class="op" id="4917143">&amp;</span><span class="num" id="4917144">0x0f</span>&nbsp;<span class="op" id="4917149">!=</span>&nbsp;<span class="ident" id="4917152">zlibDeflate</span><span class="op" id="4917163">)</span>&nbsp;<span class="op" id="4917165">||</span>&nbsp;<span class="op" id="4917168">(</span><span class="ident" id="4917169">h</span><span class="op" id="4917170">%</span><span class="num" id="4917171">31</span>&nbsp;<span class="op" id="4917174">!=</span>&nbsp;<span class="num" id="4917177">0</span><span class="op" id="4917178">)</span>&nbsp;<span class="op" id="4917180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917184">return</span>&nbsp;<span class="ident" id="4917191">ErrHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917205">haveDict</span>&nbsp;<span class="op" id="4917214">:=</span>&nbsp;<span class="ident" id="4917217">z</span><span class="op" id="4917218">.</span><span class="ident" id="4917219">scratch</span><span class="op" id="4917226">[</span><span class="num" id="4917227">1</span><span class="op" id="4917228">]</span><span class="op" id="4917229">&amp;</span><span class="num" id="4917230">0x20</span>&nbsp;<span class="op" id="4917235">!=</span>&nbsp;<span class="num" id="4917238">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917241">if</span>&nbsp;<span class="ident" id="4917244">haveDict</span>&nbsp;<span class="op" id="4917253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917257">_</span><span class="op" id="4917258">,</span>&nbsp;<span class="ident" id="4917260">err</span>&nbsp;<span class="op" id="4917264">=</span>&nbsp;<span class="ident" id="4917266">io</span><span class="op" id="4917268">.</span><span class="ident" id="4917269">ReadFull</span><span class="op" id="4917277">(</span><span class="ident" id="4917278">z</span><span class="op" id="4917279">.</span><span class="ident" id="4917280">r</span><span class="op" id="4917281">,</span>&nbsp;<span class="ident" id="4917283">z</span><span class="op" id="4917284">.</span><span class="ident" id="4917285">scratch</span><span class="op" id="4917292">[</span><span class="num" id="4917293">0</span><span class="op" id="4917294">:</span><span class="num" id="4917295">4</span><span class="op" id="4917296">]</span><span class="op" id="4917297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917301">if</span>&nbsp;<span class="ident" id="4917304">err</span>&nbsp;<span class="op" id="4917308">!=</span>&nbsp;<span class="ident" id="4917311">nil</span>&nbsp;<span class="op" id="4917315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917320">return</span>&nbsp;<span class="ident" id="4917327">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917333">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917337">checksum</span>&nbsp;<span class="op" id="4917346">:=</span>&nbsp;<span class="builtintype" id="4917349">uint32</span><span class="op" id="4917355">(</span><span class="ident" id="4917356">z</span><span class="op" id="4917357">.</span><span class="ident" id="4917358">scratch</span><span class="op" id="4917365">[</span><span class="num" id="4917366">0</span><span class="op" id="4917367">]</span><span class="op" id="4917368">)</span><span class="op" id="4917369">&lt;&lt;</span><span class="num" id="4917371">24</span>&nbsp;<span class="op" id="4917374">|</span>&nbsp;<span class="builtintype" id="4917376">uint32</span><span class="op" id="4917382">(</span><span class="ident" id="4917383">z</span><span class="op" id="4917384">.</span><span class="ident" id="4917385">scratch</span><span class="op" id="4917392">[</span><span class="num" id="4917393">1</span><span class="op" id="4917394">]</span><span class="op" id="4917395">)</span><span class="op" id="4917396">&lt;&lt;</span><span class="num" id="4917398">16</span>&nbsp;<span class="op" id="4917401">|</span>&nbsp;<span class="builtintype" id="4917403">uint32</span><span class="op" id="4917409">(</span><span class="ident" id="4917410">z</span><span class="op" id="4917411">.</span><span class="ident" id="4917412">scratch</span><span class="op" id="4917419">[</span><span class="num" id="4917420">2</span><span class="op" id="4917421">]</span><span class="op" id="4917422">)</span><span class="op" id="4917423">&lt;&lt;</span><span class="num" id="4917425">8</span>&nbsp;<span class="op" id="4917427">|</span>&nbsp;<span class="builtintype" id="4917429">uint32</span><span class="op" id="4917435">(</span><span class="ident" id="4917436">z</span><span class="op" id="4917437">.</span><span class="ident" id="4917438">scratch</span><span class="op" id="4917445">[</span><span class="num" id="4917446">3</span><span class="op" id="4917447">]</span><span class="op" id="4917448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917452">if</span>&nbsp;<span class="ident" id="4917455">checksum</span>&nbsp;<span class="op" id="4917464">!=</span>&nbsp;<span class="ident" id="4917467">adler32</span><span class="op" id="4917474">.</span><span class="ident" id="4917475">Checksum</span><span class="op" id="4917483">(</span><span class="ident" id="4917484">dict</span><span class="op" id="4917488">)</span>&nbsp;<span class="op" id="4917490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917495">return</span>&nbsp;<span class="ident" id="4917502">ErrDictionary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917521">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917524">if</span>&nbsp;<span class="ident" id="4917527">z</span><span class="op" id="4917528">.</span><span class="ident" id="4917529">decompressor</span>&nbsp;<span class="op" id="4917542">==</span>&nbsp;<span class="ident" id="4917545">nil</span>&nbsp;<span class="op" id="4917549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917553">if</span>&nbsp;<span class="ident" id="4917556">haveDict</span>&nbsp;<span class="op" id="4917565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917570">z</span><span class="op" id="4917571">.</span><span class="ident" id="4917572">decompressor</span>&nbsp;<span class="op" id="4917585">=</span>&nbsp;<span class="ident" id="4917587">flate</span><span class="op" id="4917592">.</span><span class="ident" id="4917593">NewReaderDict</span><span class="op" id="4917606">(</span><span class="ident" id="4917607">z</span><span class="op" id="4917608">.</span><span class="ident" id="4917609">r</span><span class="op" id="4917610">,</span>&nbsp;<span class="ident" id="4917612">dict</span><span class="op" id="4917616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917620">}</span>&nbsp;<span class="keyword" id="4917622">else</span>&nbsp;<span class="op" id="4917627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917632">z</span><span class="op" id="4917633">.</span><span class="ident" id="4917634">decompressor</span>&nbsp;<span class="op" id="4917647">=</span>&nbsp;<span class="ident" id="4917649">flate</span><span class="op" id="4917654">.</span><span class="ident" id="4917655">NewReader</span><span class="op" id="4917664">(</span><span class="ident" id="4917665">z</span><span class="op" id="4917666">.</span><span class="ident" id="4917667">r</span><span class="op" id="4917668">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917675">}</span>&nbsp;<span class="keyword" id="4917677">else</span>&nbsp;<span class="op" id="4917682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917686">z</span><span class="op" id="4917687">.</span><span class="ident" id="4917688">decompressor</span><span class="op" id="4917700">.</span><span class="op" id="4917701">(</span><span class="ident" id="4917702">flate</span><span class="op" id="4917707">.</span><span class="ident" id="4917708">Resetter</span><span class="op" id="4917716">)</span><span class="op" id="4917717">.</span><span class="ident" id="4917718">Reset</span><span class="op" id="4917723">(</span><span class="ident" id="4917724">z</span><span class="op" id="4917725">.</span><span class="ident" id="4917726">r</span><span class="op" id="4917727">,</span>&nbsp;<span class="ident" id="4917729">dict</span><span class="op" id="4917733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917739">z</span><span class="op" id="4917740">.</span><span class="ident" id="4917741">digest</span>&nbsp;<span class="op" id="4917748">=</span>&nbsp;<span class="ident" id="4917750">adler32</span><span class="op" id="4917757">.</span><span class="ident" id="4917758">New</span><span class="op" id="4917761">(</span><span class="op" id="4917762">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917765">return</span>&nbsp;<span class="ident" id="4917772">nil</span><br>
<span class="lineno"></span><span class="op" id="4917776">}</span>
</div>
</body>
</html>
