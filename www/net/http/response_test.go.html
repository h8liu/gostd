<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8021580">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8021636">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8021690">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8021741">package</span>&nbsp;<span class="ident" id="8021749">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8021755">import</span>&nbsp;<span class="op" id="8021762">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021765">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021774">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021783">&#34;compress/gzip&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021800">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021815">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021822">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021828">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021841">&#34;net/http/internal&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021862">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021873">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021884">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021894">&#34;strings&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021905">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8021915">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8021918">type</span>&nbsp;<span class="ident" id="8021923">respTest</span>&nbsp;<span class="keyword" id="8021932">struct</span>&nbsp;<span class="op" id="8021939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021942">Raw</span>&nbsp;&nbsp;<span class="builtintype" id="8021947">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021955">Resp</span>&nbsp;<span class="ident" id="8021960">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021970">Body</span>&nbsp;<span class="builtintype" id="8021975">string</span><br>
<span class="lineno"></span><span class="op" id="8021982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8021985">func</span>&nbsp;<span class="ident" id="8021990">dummyReq</span><span class="op" id="8021998">(</span><span class="ident" id="8021999">method</span>&nbsp;<span class="builtintype" id="8022006">string</span><span class="op" id="8022012">)</span>&nbsp;<span class="op" id="8022014">*</span><span class="ident" id="8022015">Request</span>&nbsp;<span class="op" id="8022023">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022026">return</span>&nbsp;<span class="op" id="8022033">&amp;</span><span class="ident" id="8022034">Request</span><span class="op" id="8022041">{</span><span class="ident" id="8022042">Method</span><span class="op" id="8022048">:</span>&nbsp;<span class="ident" id="8022050">method</span><span class="op" id="8022056">}</span><br>
<span class="lineno"></span><span class="op" id="8022058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8022061">func</span>&nbsp;<span class="ident" id="8022066">dummyReq11</span><span class="op" id="8022076">(</span><span class="ident" id="8022077">method</span>&nbsp;<span class="builtintype" id="8022084">string</span><span class="op" id="8022090">)</span>&nbsp;<span class="op" id="8022092">*</span><span class="ident" id="8022093">Request</span>&nbsp;<span class="op" id="8022101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022104">return</span>&nbsp;<span class="op" id="8022111">&amp;</span><span class="ident" id="8022112">Request</span><span class="op" id="8022119">{</span><span class="ident" id="8022120">Method</span><span class="op" id="8022126">:</span>&nbsp;<span class="ident" id="8022128">method</span><span class="op" id="8022134">,</span>&nbsp;<span class="ident" id="8022136">Proto</span><span class="op" id="8022141">:</span>&nbsp;<span class="string" id="8022143">&#34;HTTP/1.1&#34;</span><span class="op" id="8022153">,</span>&nbsp;<span class="ident" id="8022155">ProtoMajor</span><span class="op" id="8022165">:</span>&nbsp;<span class="num" id="8022167">1</span><span class="op" id="8022168">,</span>&nbsp;<span class="ident" id="8022170">ProtoMinor</span><span class="op" id="8022180">:</span>&nbsp;<span class="num" id="8022182">1</span><span class="op" id="8022183">}</span><br>
<span class="lineno">35</span><span class="op" id="8022185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8022188">var</span>&nbsp;<span class="ident" id="8022192">respTests</span>&nbsp;<span class="op" id="8022202">=</span>&nbsp;<span class="op" id="8022204">[</span><span class="op" id="8022205">]</span><span class="ident" id="8022206">respTest</span><span class="op" id="8022214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8022217">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022264">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8022268">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8022290">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8022295">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8022319">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8022324">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8022331">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8022336">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8022349">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022354">Response</span><span class="op" id="8022362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022367">Status</span><span class="op" id="8022373">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8022379">&#34;200&nbsp;OK&#34;</span><span class="op" id="8022387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022392">StatusCode</span><span class="op" id="8022402">:</span>&nbsp;<span class="num" id="8022404">200</span><span class="op" id="8022407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022412">Proto</span><span class="op" id="8022417">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8022424">&#34;HTTP/1.0&#34;</span><span class="op" id="8022434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022439">ProtoMajor</span><span class="op" id="8022449">:</span>&nbsp;<span class="num" id="8022451">1</span><span class="op" id="8022452">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022457">ProtoMinor</span><span class="op" id="8022467">:</span>&nbsp;<span class="num" id="8022469">0</span><span class="op" id="8022470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022475">Request</span><span class="op" id="8022482">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8022487">dummyReq</span><span class="op" id="8022495">(</span><span class="string" id="8022496">&#34;GET&#34;</span><span class="op" id="8022501">)</span><span class="op" id="8022502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022507">Header</span><span class="op" id="8022513">:</span>&nbsp;<span class="ident" id="8022515">Header</span><span class="op" id="8022521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8022527">&#34;Connection&#34;</span><span class="op" id="8022539">:</span>&nbsp;<span class="op" id="8022541">{</span><span class="string" id="8022542">&#34;close&#34;</span><span class="op" id="8022549">}</span><span class="op" id="8022550">,</span>&nbsp;<span class="comment" id="8022552">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022577">}</span><span class="op" id="8022578">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022583">Close</span><span class="op" id="8022588">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8022598">true</span><span class="op" id="8022602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022607">ContentLength</span><span class="op" id="8022620">:</span>&nbsp;<span class="op" id="8022622">-</span><span class="num" id="8022623">1</span><span class="op" id="8022624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022628">}</span><span class="op" id="8022629">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8022634">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8022647">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022650">}</span><span class="op" id="8022651">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8022655">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;response&nbsp;without&nbsp;Content-Length&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8022713">//&nbsp;Connection&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022737">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8022741">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8022763">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8022768">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8022775">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8022780">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8022793">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022798">Response</span><span class="op" id="8022806">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022811">Status</span><span class="op" id="8022817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8022826">&#34;200&nbsp;OK&#34;</span><span class="op" id="8022834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022839">StatusCode</span><span class="op" id="8022849">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8022854">200</span><span class="op" id="8022857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022862">Proto</span><span class="op" id="8022867">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8022877">&#34;HTTP/1.1&#34;</span><span class="op" id="8022887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022892">ProtoMajor</span><span class="op" id="8022902">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8022907">1</span><span class="op" id="8022908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022913">ProtoMinor</span><span class="op" id="8022923">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8022928">1</span><span class="op" id="8022929">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022934">Header</span><span class="op" id="8022940">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8022949">Header</span><span class="op" id="8022955">{</span><span class="op" id="8022956">}</span><span class="op" id="8022957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022962">Request</span><span class="op" id="8022969">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8022977">dummyReq</span><span class="op" id="8022985">(</span><span class="string" id="8022986">&#34;GET&#34;</span><span class="op" id="8022991">)</span><span class="op" id="8022992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022997">Close</span><span class="op" id="8023002">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8023012">true</span><span class="op" id="8023016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023021">ContentLength</span><span class="op" id="8023034">:</span>&nbsp;<span class="op" id="8023036">-</span><span class="num" id="8023037">1</span><span class="op" id="8023038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023042">}</span><span class="op" id="8023043">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023048">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8023061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023064">}</span><span class="op" id="8023065">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8023069">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;204&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023133">&#34;HTTP/1.1&nbsp;204&nbsp;No&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="8023163">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023168">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8023175">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023180">&#34;Body&nbsp;should&nbsp;not&nbsp;be&nbsp;read!\n&#34;</span><span class="op" id="8023208">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023213">Response</span><span class="op" id="8023221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023226">Status</span><span class="op" id="8023232">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8023241">&#34;204&nbsp;No&nbsp;Content&#34;</span><span class="op" id="8023257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023262">StatusCode</span><span class="op" id="8023272">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8023277">204</span><span class="op" id="8023280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023285">Proto</span><span class="op" id="8023290">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8023300">&#34;HTTP/1.1&#34;</span><span class="op" id="8023310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023315">ProtoMajor</span><span class="op" id="8023325">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8023330">1</span><span class="op" id="8023331">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023336">ProtoMinor</span><span class="op" id="8023346">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8023351">1</span><span class="op" id="8023352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023357">Header</span><span class="op" id="8023363">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8023372">Header</span><span class="op" id="8023378">{</span><span class="op" id="8023379">}</span><span class="op" id="8023380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023385">Request</span><span class="op" id="8023392">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8023400">dummyReq</span><span class="op" id="8023408">(</span><span class="string" id="8023409">&#34;GET&#34;</span><span class="op" id="8023414">)</span><span class="op" id="8023415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023420">Close</span><span class="op" id="8023425">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8023435">false</span><span class="op" id="8023440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023445">ContentLength</span><span class="op" id="8023458">:</span>&nbsp;<span class="num" id="8023460">0</span><span class="op" id="8023461">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023465">}</span><span class="op" id="8023466">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023471">&#34;&#34;</span><span class="op" id="8023473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023476">}</span><span class="op" id="8023477">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8023481">//&nbsp;Unchunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023529">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8023551">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023556">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="8023581">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023586">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8023610">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023615">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8023622">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023627">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8023640">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023645">Response</span><span class="op" id="8023653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023658">Status</span><span class="op" id="8023664">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8023670">&#34;200&nbsp;OK&#34;</span><span class="op" id="8023678">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023683">StatusCode</span><span class="op" id="8023693">:</span>&nbsp;<span class="num" id="8023695">200</span><span class="op" id="8023698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023703">Proto</span><span class="op" id="8023708">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8023715">&#34;HTTP/1.0&#34;</span><span class="op" id="8023725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023730">ProtoMajor</span><span class="op" id="8023740">:</span>&nbsp;<span class="num" id="8023742">1</span><span class="op" id="8023743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023748">ProtoMinor</span><span class="op" id="8023758">:</span>&nbsp;<span class="num" id="8023760">0</span><span class="op" id="8023761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023766">Request</span><span class="op" id="8023773">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8023778">dummyReq</span><span class="op" id="8023786">(</span><span class="string" id="8023787">&#34;GET&#34;</span><span class="op" id="8023792">)</span><span class="op" id="8023793">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023798">Header</span><span class="op" id="8023804">:</span>&nbsp;<span class="ident" id="8023806">Header</span><span class="op" id="8023812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023818">&#34;Connection&#34;</span><span class="op" id="8023830">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8023836">{</span><span class="string" id="8023837">&#34;close&#34;</span><span class="op" id="8023844">}</span><span class="op" id="8023845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023851">&#34;Content-Length&#34;</span><span class="op" id="8023867">:</span>&nbsp;<span class="op" id="8023869">{</span><span class="string" id="8023870">&#34;10&#34;</span><span class="op" id="8023874">}</span><span class="op" id="8023875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023880">}</span><span class="op" id="8023881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023886">Close</span><span class="op" id="8023891">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8023901">true</span><span class="op" id="8023905">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023910">ContentLength</span><span class="op" id="8023923">:</span>&nbsp;<span class="num" id="8023925">10</span><span class="op" id="8023927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023931">}</span><span class="op" id="8023932">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8023937">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8023950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023953">}</span><span class="op" id="8023954">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8023958">//&nbsp;Chunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024007">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8024029">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024034">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8024067">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024072">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8024079">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024084">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="8024093">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024098">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="8024116">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024121">&#34;09\r\n&#34;</span>&nbsp;<span class="op" id="8024130">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024135">&#34;continued\r\n&#34;</span>&nbsp;<span class="op" id="8024151">+</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024156">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="8024164">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024169">&#34;\r\n&#34;</span><span class="op" id="8024175">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024180">Response</span><span class="op" id="8024188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024193">Status</span><span class="op" id="8024199">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8024211">&#34;200&nbsp;OK&#34;</span><span class="op" id="8024219">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024224">StatusCode</span><span class="op" id="8024234">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8024242">200</span><span class="op" id="8024245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024250">Proto</span><span class="op" id="8024255">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8024268">&#34;HTTP/1.1&#34;</span><span class="op" id="8024278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024283">ProtoMajor</span><span class="op" id="8024293">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8024301">1</span><span class="op" id="8024302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024307">ProtoMinor</span><span class="op" id="8024317">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8024325">1</span><span class="op" id="8024326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024331">Request</span><span class="op" id="8024338">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8024349">dummyReq</span><span class="op" id="8024357">(</span><span class="string" id="8024358">&#34;GET&#34;</span><span class="op" id="8024363">)</span><span class="op" id="8024364">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024369">Header</span><span class="op" id="8024375">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8024387">Header</span><span class="op" id="8024393">{</span><span class="op" id="8024394">}</span><span class="op" id="8024395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024400">Close</span><span class="op" id="8024405">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8024418">false</span><span class="op" id="8024423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024428">ContentLength</span><span class="op" id="8024441">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8024446">-</span><span class="num" id="8024447">1</span><span class="op" id="8024448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024453">TransferEncoding</span><span class="op" id="8024469">:</span>&nbsp;<span class="op" id="8024471">[</span><span class="op" id="8024472">]</span><span class="builtintype" id="8024473">string</span><span class="op" id="8024479">{</span><span class="string" id="8024480">&#34;chunked&#34;</span><span class="op" id="8024489">}</span><span class="op" id="8024490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024494">}</span><span class="op" id="8024495">,</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024500">&#34;Body&nbsp;here\ncontinued&#34;</span><span class="op" id="8024522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024525">}</span><span class="op" id="8024526">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8024530">//&nbsp;Chunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8024572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024576">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8024598">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024603">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8024636">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024641">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="8024666">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024671">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8024678">+</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024683">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="8024692">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024697">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="8024715">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024720">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="8024728">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8024733">&#34;\r\n&#34;</span><span class="op" id="8024739">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024744">Response</span><span class="op" id="8024752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024757">Status</span><span class="op" id="8024763">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8024775">&#34;200&nbsp;OK&#34;</span><span class="op" id="8024783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024788">StatusCode</span><span class="op" id="8024798">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8024806">200</span><span class="op" id="8024809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024814">Proto</span><span class="op" id="8024819">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8024832">&#34;HTTP/1.1&#34;</span><span class="op" id="8024842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024847">ProtoMajor</span><span class="op" id="8024857">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8024865">1</span><span class="op" id="8024866">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024871">ProtoMinor</span><span class="op" id="8024881">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8024889">1</span><span class="op" id="8024890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024895">Request</span><span class="op" id="8024902">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8024913">dummyReq</span><span class="op" id="8024921">(</span><span class="string" id="8024922">&#34;GET&#34;</span><span class="op" id="8024927">)</span><span class="op" id="8024928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024933">Header</span><span class="op" id="8024939">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8024951">Header</span><span class="op" id="8024957">{</span><span class="op" id="8024958">}</span><span class="op" id="8024959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024964">Close</span><span class="op" id="8024969">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8024982">false</span><span class="op" id="8024987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8024992">ContentLength</span><span class="op" id="8025005">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8025010">-</span><span class="num" id="8025011">1</span><span class="op" id="8025012">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025017">TransferEncoding</span><span class="op" id="8025033">:</span>&nbsp;<span class="op" id="8025035">[</span><span class="op" id="8025036">]</span><span class="builtintype" id="8025037">string</span><span class="op" id="8025043">{</span><span class="string" id="8025044">&#34;chunked&#34;</span><span class="op" id="8025053">}</span><span class="op" id="8025054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025058">}</span><span class="op" id="8025059">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8025064">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8025077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025080">}</span><span class="op" id="8025081">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8025085">//&nbsp;Chunked&nbsp;response&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8025140">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8025162">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8025167">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8025200">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8025205">&#34;\r\n&#34;</span><span class="op" id="8025211">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025216">Response</span><span class="op" id="8025224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025229">Status</span><span class="op" id="8025235">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8025247">&#34;200&nbsp;OK&#34;</span><span class="op" id="8025255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025260">StatusCode</span><span class="op" id="8025270">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8025278">200</span><span class="op" id="8025281">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025286">Proto</span><span class="op" id="8025291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8025304">&#34;HTTP/1.1&#34;</span><span class="op" id="8025314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025319">ProtoMajor</span><span class="op" id="8025329">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8025337">1</span><span class="op" id="8025338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025343">ProtoMinor</span><span class="op" id="8025353">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8025361">1</span><span class="op" id="8025362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025367">Request</span><span class="op" id="8025374">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8025385">dummyReq</span><span class="op" id="8025393">(</span><span class="string" id="8025394">&#34;HEAD&#34;</span><span class="op" id="8025400">)</span><span class="op" id="8025401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025406">Header</span><span class="op" id="8025412">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8025424">Header</span><span class="op" id="8025430">{</span><span class="op" id="8025431">}</span><span class="op" id="8025432">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025437">TransferEncoding</span><span class="op" id="8025453">:</span>&nbsp;<span class="op" id="8025455">[</span><span class="op" id="8025456">]</span><span class="builtintype" id="8025457">string</span><span class="op" id="8025463">{</span><span class="string" id="8025464">&#34;chunked&#34;</span><span class="op" id="8025473">}</span><span class="op" id="8025474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025479">Close</span><span class="op" id="8025484">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8025497">false</span><span class="op" id="8025502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025507">ContentLength</span><span class="op" id="8025520">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8025525">-</span><span class="num" id="8025526">1</span><span class="op" id="8025527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025531">}</span><span class="op" id="8025532">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8025537">&#34;&#34;</span><span class="op" id="8025539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025542">}</span><span class="op" id="8025543">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8025547">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025596">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8025600">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8025622">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8025627">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="8025653">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8025658">&#34;\r\n&#34;</span><span class="op" id="8025664">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025669">Response</span><span class="op" id="8025677">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025682">Status</span><span class="op" id="8025688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8025700">&#34;200&nbsp;OK&#34;</span><span class="op" id="8025708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025713">StatusCode</span><span class="op" id="8025723">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8025731">200</span><span class="op" id="8025734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025739">Proto</span><span class="op" id="8025744">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8025757">&#34;HTTP/1.0&#34;</span><span class="op" id="8025767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025772">ProtoMajor</span><span class="op" id="8025782">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8025790">1</span><span class="op" id="8025791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025796">ProtoMinor</span><span class="op" id="8025806">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8025814">0</span><span class="op" id="8025815">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025820">Request</span><span class="op" id="8025827">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8025838">dummyReq</span><span class="op" id="8025846">(</span><span class="string" id="8025847">&#34;HEAD&#34;</span><span class="op" id="8025853">)</span><span class="op" id="8025854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025859">Header</span><span class="op" id="8025865">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8025877">Header</span><span class="op" id="8025883">{</span><span class="string" id="8025884">&#34;Content-Length&#34;</span><span class="op" id="8025900">:</span>&nbsp;<span class="op" id="8025902">{</span><span class="string" id="8025903">&#34;256&#34;</span><span class="op" id="8025908">}</span><span class="op" id="8025909">}</span><span class="op" id="8025910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025915">TransferEncoding</span><span class="op" id="8025931">:</span>&nbsp;<span class="ident" id="8025933">nil</span><span class="op" id="8025936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025941">Close</span><span class="op" id="8025946">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8025959">true</span><span class="op" id="8025963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8025968">ContentLength</span><span class="op" id="8025981">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8025986">256</span><span class="op" id="8025989">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8025993">}</span><span class="op" id="8025994">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8025999">&#34;&#34;</span><span class="op" id="8026001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8026004">}</span><span class="op" id="8026005">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8026009">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request&nbsp;with&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8026072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8026076">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8026098">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8026103">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="8026129">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8026134">&#34;\r\n&#34;</span><span class="op" id="8026140">,</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026145">Response</span><span class="op" id="8026153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026158">Status</span><span class="op" id="8026164">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8026176">&#34;200&nbsp;OK&#34;</span><span class="op" id="8026184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026189">StatusCode</span><span class="op" id="8026199">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8026207">200</span><span class="op" id="8026210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026215">Proto</span><span class="op" id="8026220">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8026233">&#34;HTTP/1.1&#34;</span><span class="op" id="8026243">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026248">ProtoMajor</span><span class="op" id="8026258">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8026266">1</span><span class="op" id="8026267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026272">ProtoMinor</span><span class="op" id="8026282">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8026290">1</span><span class="op" id="8026291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026296">Request</span><span class="op" id="8026303">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8026314">dummyReq</span><span class="op" id="8026322">(</span><span class="string" id="8026323">&#34;HEAD&#34;</span><span class="op" id="8026329">)</span><span class="op" id="8026330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026335">Header</span><span class="op" id="8026341">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8026353">Header</span><span class="op" id="8026359">{</span><span class="string" id="8026360">&#34;Content-Length&#34;</span><span class="op" id="8026376">:</span>&nbsp;<span class="op" id="8026378">{</span><span class="string" id="8026379">&#34;256&#34;</span><span class="op" id="8026384">}</span><span class="op" id="8026385">}</span><span class="op" id="8026386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026391">TransferEncoding</span><span class="op" id="8026407">:</span>&nbsp;<span class="ident" id="8026409">nil</span><span class="op" id="8026412">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026417">Close</span><span class="op" id="8026422">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8026435">false</span><span class="op" id="8026440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026445">ContentLength</span><span class="op" id="8026458">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8026463">256</span><span class="op" id="8026466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8026470">}</span><span class="op" id="8026471">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8026476">&#34;&#34;</span><span class="op" id="8026478">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8026481">}</span><span class="op" id="8026482">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8026486">//&nbsp;No&nbsp;Content-Length&nbsp;or&nbsp;Chunked&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8026549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8026553">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8026575">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8026580">&#34;\r\n&#34;</span><span class="op" id="8026586">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026591">Response</span><span class="op" id="8026599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026604">Status</span><span class="op" id="8026610">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8026622">&#34;200&nbsp;OK&#34;</span><span class="op" id="8026630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026635">StatusCode</span><span class="op" id="8026645">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8026653">200</span><span class="op" id="8026656">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026661">Proto</span><span class="op" id="8026666">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8026679">&#34;HTTP/1.0&#34;</span><span class="op" id="8026689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026694">ProtoMajor</span><span class="op" id="8026704">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8026712">1</span><span class="op" id="8026713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026718">ProtoMinor</span><span class="op" id="8026728">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8026736">0</span><span class="op" id="8026737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026742">Request</span><span class="op" id="8026749">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8026760">dummyReq</span><span class="op" id="8026768">(</span><span class="string" id="8026769">&#34;HEAD&#34;</span><span class="op" id="8026775">)</span><span class="op" id="8026776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026781">Header</span><span class="op" id="8026787">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8026799">Header</span><span class="op" id="8026805">{</span><span class="op" id="8026806">}</span><span class="op" id="8026807">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026812">TransferEncoding</span><span class="op" id="8026828">:</span>&nbsp;<span class="ident" id="8026830">nil</span><span class="op" id="8026833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026838">Close</span><span class="op" id="8026843">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8026856">true</span><span class="op" id="8026860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8026865">ContentLength</span><span class="op" id="8026878">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8026883">-</span><span class="num" id="8026884">1</span><span class="op" id="8026885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8026889">}</span><span class="op" id="8026890">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8026895">&#34;&#34;</span><span class="op" id="8026897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8026900">}</span><span class="op" id="8026901">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8026905">//&nbsp;explicit&nbsp;Content-Length&nbsp;of&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8026939">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8026943">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8026965">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8026970">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8026994">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8026999">&#34;\r\n&#34;</span><span class="op" id="8027005">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027010">Response</span><span class="op" id="8027018">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027023">Status</span><span class="op" id="8027029">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8027035">&#34;200&nbsp;OK&#34;</span><span class="op" id="8027043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027048">StatusCode</span><span class="op" id="8027058">:</span>&nbsp;<span class="num" id="8027060">200</span><span class="op" id="8027063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027068">Proto</span><span class="op" id="8027073">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8027080">&#34;HTTP/1.1&#34;</span><span class="op" id="8027090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027095">ProtoMajor</span><span class="op" id="8027105">:</span>&nbsp;<span class="num" id="8027107">1</span><span class="op" id="8027108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027113">ProtoMinor</span><span class="op" id="8027123">:</span>&nbsp;<span class="num" id="8027125">1</span><span class="op" id="8027126">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027131">Request</span><span class="op" id="8027138">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8027143">dummyReq</span><span class="op" id="8027151">(</span><span class="string" id="8027152">&#34;GET&#34;</span><span class="op" id="8027157">)</span><span class="op" id="8027158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027163">Header</span><span class="op" id="8027169">:</span>&nbsp;<span class="ident" id="8027171">Header</span><span class="op" id="8027177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8027183">&#34;Content-Length&#34;</span><span class="op" id="8027199">:</span>&nbsp;<span class="op" id="8027201">{</span><span class="string" id="8027202">&#34;0&#34;</span><span class="op" id="8027205">}</span><span class="op" id="8027206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8027211">}</span><span class="op" id="8027212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027217">Close</span><span class="op" id="8027222">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8027232">false</span><span class="op" id="8027237">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027242">ContentLength</span><span class="op" id="8027255">:</span>&nbsp;<span class="num" id="8027257">0</span><span class="op" id="8027258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8027262">}</span><span class="op" id="8027263">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8027268">&#34;&#34;</span><span class="op" id="8027270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8027273">}</span><span class="op" id="8027274">,</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8027278">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;but&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8027339">//&nbsp;(permitted&nbsp;by&nbsp;RFC&nbsp;2616)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8027367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8027371">&#34;HTTP/1.0&nbsp;303&nbsp;\r\n\r\n&#34;</span><span class="op" id="8027394">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027398">Response</span><span class="op" id="8027406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027411">Status</span><span class="op" id="8027417">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8027426">&#34;303&nbsp;&#34;</span><span class="op" id="8027432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027437">StatusCode</span><span class="op" id="8027447">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8027452">303</span><span class="op" id="8027455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027460">Proto</span><span class="op" id="8027465">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8027475">&#34;HTTP/1.0&#34;</span><span class="op" id="8027485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027490">ProtoMajor</span><span class="op" id="8027500">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8027505">1</span><span class="op" id="8027506">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027511">ProtoMinor</span><span class="op" id="8027521">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8027526">0</span><span class="op" id="8027527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027532">Request</span><span class="op" id="8027539">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8027547">dummyReq</span><span class="op" id="8027555">(</span><span class="string" id="8027556">&#34;GET&#34;</span><span class="op" id="8027561">)</span><span class="op" id="8027562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027567">Header</span><span class="op" id="8027573">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8027582">Header</span><span class="op" id="8027588">{</span><span class="op" id="8027589">}</span><span class="op" id="8027590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027595">Close</span><span class="op" id="8027600">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8027610">true</span><span class="op" id="8027614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027619">ContentLength</span><span class="op" id="8027632">:</span>&nbsp;<span class="op" id="8027634">-</span><span class="num" id="8027635">1</span><span class="op" id="8027636">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8027640">}</span><span class="op" id="8027641">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8027646">&#34;&#34;</span><span class="op" id="8027648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8027651">}</span><span class="op" id="8027652">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8027656">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;and&nbsp;no&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8027720">//&nbsp;(not&nbsp;permitted&nbsp;by&nbsp;RFC&nbsp;2616,&nbsp;but&nbsp;we&#39;ll&nbsp;accept&nbsp;it&nbsp;anyway)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8027780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8027784">&#34;HTTP/1.0&nbsp;303\r\n\r\n&#34;</span><span class="op" id="8027806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027810">Response</span><span class="op" id="8027818">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027823">Status</span><span class="op" id="8027829">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8027838">&#34;303&nbsp;&#34;</span><span class="op" id="8027844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027849">StatusCode</span><span class="op" id="8027859">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8027864">303</span><span class="op" id="8027867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027872">Proto</span><span class="op" id="8027877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8027887">&#34;HTTP/1.0&#34;</span><span class="op" id="8027897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027902">ProtoMajor</span><span class="op" id="8027912">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8027917">1</span><span class="op" id="8027918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027923">ProtoMinor</span><span class="op" id="8027933">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8027938">0</span><span class="op" id="8027939">,</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027944">Request</span><span class="op" id="8027951">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8027959">dummyReq</span><span class="op" id="8027967">(</span><span class="string" id="8027968">&#34;GET&#34;</span><span class="op" id="8027973">)</span><span class="op" id="8027974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8027979">Header</span><span class="op" id="8027985">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8027994">Header</span><span class="op" id="8028000">{</span><span class="op" id="8028001">}</span><span class="op" id="8028002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028007">Close</span><span class="op" id="8028012">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8028022">true</span><span class="op" id="8028026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028031">ContentLength</span><span class="op" id="8028044">:</span>&nbsp;<span class="op" id="8028046">-</span><span class="num" id="8028047">1</span><span class="op" id="8028048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8028052">}</span><span class="op" id="8028053">,</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8028058">&#34;&#34;</span><span class="op" id="8028060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8028063">}</span><span class="op" id="8028064">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8028068">//&nbsp;golang.org/issue/4767:&nbsp;don&#39;t&nbsp;special-case&nbsp;multipart/byteranges&nbsp;responses</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8028145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8028149">`HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content<br>
<span class="lineno"></span>Connection:&nbsp;close<br>
<span class="lineno"></span>Content-Type:&nbsp;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef<br>
<span class="lineno"></span><br>
<span class="lineno">340</span>some&nbsp;body`</span><span class="op" id="8028270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028274">Response</span><span class="op" id="8028282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028287">Status</span><span class="op" id="8028293">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8028299">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="8028320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028325">StatusCode</span><span class="op" id="8028335">:</span>&nbsp;<span class="num" id="8028337">206</span><span class="op" id="8028340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028345">Proto</span><span class="op" id="8028350">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8028357">&#34;HTTP/1.1&#34;</span><span class="op" id="8028367">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028372">ProtoMajor</span><span class="op" id="8028382">:</span>&nbsp;<span class="num" id="8028384">1</span><span class="op" id="8028385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028390">ProtoMinor</span><span class="op" id="8028400">:</span>&nbsp;<span class="num" id="8028402">1</span><span class="op" id="8028403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028408">Request</span><span class="op" id="8028415">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8028420">dummyReq</span><span class="op" id="8028428">(</span><span class="string" id="8028429">&#34;GET&#34;</span><span class="op" id="8028434">)</span><span class="op" id="8028435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028440">Header</span><span class="op" id="8028446">:</span>&nbsp;<span class="ident" id="8028448">Header</span><span class="op" id="8028454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8028460">&#34;Content-Type&#34;</span><span class="op" id="8028474">:</span>&nbsp;<span class="op" id="8028476">[</span><span class="op" id="8028477">]</span><span class="builtintype" id="8028478">string</span><span class="op" id="8028484">{</span><span class="string" id="8028485">&#34;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef&#34;</span><span class="op" id="8028534">}</span><span class="op" id="8028535">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8028540">}</span><span class="op" id="8028541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028546">Close</span><span class="op" id="8028551">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8028561">true</span><span class="op" id="8028565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028570">ContentLength</span><span class="op" id="8028583">:</span>&nbsp;<span class="op" id="8028585">-</span><span class="num" id="8028586">1</span><span class="op" id="8028587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8028591">}</span><span class="op" id="8028592">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8028597">&#34;some&nbsp;body&#34;</span><span class="op" id="8028608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8028611">}</span><span class="op" id="8028612">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8028616">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length,&nbsp;Request&nbsp;is&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8028678">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8028682">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8028704">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8028709">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8028733">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8028738">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8028745">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8028750">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8028763">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028768">Response</span><span class="op" id="8028776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028781">Status</span><span class="op" id="8028787">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8028793">&#34;200&nbsp;OK&#34;</span><span class="op" id="8028801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028806">StatusCode</span><span class="op" id="8028816">:</span>&nbsp;<span class="num" id="8028818">200</span><span class="op" id="8028821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028826">Proto</span><span class="op" id="8028831">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8028838">&#34;HTTP/1.0&#34;</span><span class="op" id="8028848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028853">ProtoMajor</span><span class="op" id="8028863">:</span>&nbsp;<span class="num" id="8028865">1</span><span class="op" id="8028866">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028871">ProtoMinor</span><span class="op" id="8028881">:</span>&nbsp;<span class="num" id="8028883">0</span><span class="op" id="8028884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028889">Header</span><span class="op" id="8028895">:</span>&nbsp;<span class="ident" id="8028897">Header</span><span class="op" id="8028903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8028909">&#34;Connection&#34;</span><span class="op" id="8028921">:</span>&nbsp;<span class="op" id="8028923">{</span><span class="string" id="8028924">&#34;close&#34;</span><span class="op" id="8028931">}</span><span class="op" id="8028932">,</span>&nbsp;<span class="comment" id="8028934">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8028959">}</span><span class="op" id="8028960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028965">Close</span><span class="op" id="8028970">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8028980">true</span><span class="op" id="8028984">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8028989">ContentLength</span><span class="op" id="8029002">:</span>&nbsp;<span class="op" id="8029004">-</span><span class="num" id="8029005">1</span><span class="op" id="8029006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8029010">}</span><span class="op" id="8029011">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029016">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8029029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8029032">}</span><span class="op" id="8029033">,</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8029037">//&nbsp;206&nbsp;Partial&nbsp;Content.&nbsp;golang.org/issue/8923</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8029084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029088">&#34;HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="8029123">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029128">&#34;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8\r\n&#34;</span>&nbsp;<span class="op" id="8029174">+</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029179">&#34;Accept-Ranges:&nbsp;bytes\r\n&#34;</span>&nbsp;<span class="op" id="8029206">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029211">&#34;Content-Range:&nbsp;bytes&nbsp;0-5/1862\r\n&#34;</span>&nbsp;<span class="op" id="8029247">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029252">&#34;Content-Length:&nbsp;6\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8029280">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029285">&#34;foobar&#34;</span><span class="op" id="8029293">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029298">Response</span><span class="op" id="8029306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029311">Status</span><span class="op" id="8029317">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8029323">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="8029344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029349">StatusCode</span><span class="op" id="8029359">:</span>&nbsp;<span class="num" id="8029361">206</span><span class="op" id="8029364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029369">Proto</span><span class="op" id="8029374">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8029381">&#34;HTTP/1.1&#34;</span><span class="op" id="8029391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029396">ProtoMajor</span><span class="op" id="8029406">:</span>&nbsp;<span class="num" id="8029408">1</span><span class="op" id="8029409">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029414">ProtoMinor</span><span class="op" id="8029424">:</span>&nbsp;<span class="num" id="8029426">1</span><span class="op" id="8029427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029432">Request</span><span class="op" id="8029439">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8029444">dummyReq</span><span class="op" id="8029452">(</span><span class="string" id="8029453">&#34;GET&#34;</span><span class="op" id="8029458">)</span><span class="op" id="8029459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029464">Header</span><span class="op" id="8029470">:</span>&nbsp;<span class="ident" id="8029472">Header</span><span class="op" id="8029478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029484">&#34;Accept-Ranges&#34;</span><span class="op" id="8029499">:</span>&nbsp;&nbsp;<span class="op" id="8029502">[</span><span class="op" id="8029503">]</span><span class="builtintype" id="8029504">string</span><span class="op" id="8029510">{</span><span class="string" id="8029511">&#34;bytes&#34;</span><span class="op" id="8029518">}</span><span class="op" id="8029519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029525">&#34;Content-Length&#34;</span><span class="op" id="8029541">:</span>&nbsp;<span class="op" id="8029543">[</span><span class="op" id="8029544">]</span><span class="builtintype" id="8029545">string</span><span class="op" id="8029551">{</span><span class="string" id="8029552">&#34;6&#34;</span><span class="op" id="8029555">}</span><span class="op" id="8029556">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029562">&#34;Content-Type&#34;</span><span class="op" id="8029576">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8029580">[</span><span class="op" id="8029581">]</span><span class="builtintype" id="8029582">string</span><span class="op" id="8029588">{</span><span class="string" id="8029589">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="8029616">}</span><span class="op" id="8029617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029623">&#34;Content-Range&#34;</span><span class="op" id="8029638">:</span>&nbsp;&nbsp;<span class="op" id="8029641">[</span><span class="op" id="8029642">]</span><span class="builtintype" id="8029643">string</span><span class="op" id="8029649">{</span><span class="string" id="8029650">&#34;bytes&nbsp;0-5/1862&#34;</span><span class="op" id="8029666">}</span><span class="op" id="8029667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8029672">}</span><span class="op" id="8029673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029678">ContentLength</span><span class="op" id="8029691">:</span>&nbsp;<span class="num" id="8029693">6</span><span class="op" id="8029694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8029698">}</span><span class="op" id="8029699">,</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8029704">&#34;foobar&#34;</span><span class="op" id="8029712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8029715">}</span><span class="op" id="8029716">,</span><br>
<span class="lineno"></span><span class="op" id="8029718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="8029721">func</span>&nbsp;<span class="ident" id="8029726">TestReadResponse</span><span class="op" id="8029742">(</span><span class="ident" id="8029743">t</span>&nbsp;<span class="op" id="8029745">*</span><span class="ident" id="8029746">testing</span><span class="op" id="8029753">.</span><span class="ident" id="8029754">T</span><span class="op" id="8029755">)</span>&nbsp;<span class="op" id="8029757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8029760">for</span>&nbsp;<span class="ident" id="8029764">i</span><span class="op" id="8029765">,</span>&nbsp;<span class="ident" id="8029767">tt</span>&nbsp;<span class="op" id="8029770">:=</span>&nbsp;<span class="keyword" id="8029773">range</span>&nbsp;<span class="ident" id="8029779">respTests</span>&nbsp;<span class="op" id="8029789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029793">resp</span><span class="op" id="8029797">,</span>&nbsp;<span class="ident" id="8029799">err</span>&nbsp;<span class="op" id="8029803">:=</span>&nbsp;<span class="ident" id="8029806">ReadResponse</span><span class="op" id="8029818">(</span><span class="ident" id="8029819">bufio</span><span class="op" id="8029824">.</span><span class="ident" id="8029825">NewReader</span><span class="op" id="8029834">(</span><span class="ident" id="8029835">strings</span><span class="op" id="8029842">.</span><span class="ident" id="8029843">NewReader</span><span class="op" id="8029852">(</span><span class="ident" id="8029853">tt</span><span class="op" id="8029855">.</span><span class="ident" id="8029856">Raw</span><span class="op" id="8029859">)</span><span class="op" id="8029860">)</span><span class="op" id="8029861">,</span>&nbsp;<span class="ident" id="8029863">tt</span><span class="op" id="8029865">.</span><span class="ident" id="8029866">Resp</span><span class="op" id="8029870">.</span><span class="ident" id="8029871">Request</span><span class="op" id="8029878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8029882">if</span>&nbsp;<span class="ident" id="8029885">err</span>&nbsp;<span class="op" id="8029889">!=</span>&nbsp;<span class="ident" id="8029892">nil</span>&nbsp;<span class="op" id="8029896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029901">t</span><span class="op" id="8029902">.</span><span class="ident" id="8029903">Errorf</span><span class="op" id="8029909">(</span><span class="string" id="8029910">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8029919">,</span>&nbsp;<span class="ident" id="8029921">i</span><span class="op" id="8029922">,</span>&nbsp;<span class="ident" id="8029924">err</span><span class="op" id="8029927">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8029932">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8029943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029947">rbody</span>&nbsp;<span class="op" id="8029953">:=</span>&nbsp;<span class="ident" id="8029956">resp</span><span class="op" id="8029960">.</span><span class="ident" id="8029961">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029968">resp</span><span class="op" id="8029972">.</span><span class="ident" id="8029973">Body</span>&nbsp;<span class="op" id="8029978">=</span>&nbsp;<span class="ident" id="8029980">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8029986">diff</span><span class="op" id="8029990">(</span><span class="ident" id="8029991">t</span><span class="op" id="8029992">,</span>&nbsp;<span class="ident" id="8029994">fmt</span><span class="op" id="8029997">.</span><span class="ident" id="8029998">Sprintf</span><span class="op" id="8030005">(</span><span class="string" id="8030006">&#34;#%d&nbsp;Response&#34;</span><span class="op" id="8030020">,</span>&nbsp;<span class="ident" id="8030022">i</span><span class="op" id="8030023">)</span><span class="op" id="8030024">,</span>&nbsp;<span class="ident" id="8030026">resp</span><span class="op" id="8030030">,</span>&nbsp;<span class="op" id="8030032">&amp;</span><span class="ident" id="8030033">tt</span><span class="op" id="8030035">.</span><span class="ident" id="8030036">Resp</span><span class="op" id="8030040">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8030044">var</span>&nbsp;<span class="ident" id="8030048">bout</span>&nbsp;<span class="ident" id="8030053">bytes</span><span class="op" id="8030058">.</span><span class="ident" id="8030059">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8030068">if</span>&nbsp;<span class="ident" id="8030071">rbody</span>&nbsp;<span class="op" id="8030077">!=</span>&nbsp;<span class="ident" id="8030080">nil</span>&nbsp;<span class="op" id="8030084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8030089">_</span><span class="op" id="8030090">,</span>&nbsp;<span class="ident" id="8030092">err</span>&nbsp;<span class="op" id="8030096">=</span>&nbsp;<span class="ident" id="8030098">io</span><span class="op" id="8030100">.</span><span class="ident" id="8030101">Copy</span><span class="op" id="8030105">(</span><span class="op" id="8030106">&amp;</span><span class="ident" id="8030107">bout</span><span class="op" id="8030111">,</span>&nbsp;<span class="ident" id="8030113">rbody</span><span class="op" id="8030118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8030123">if</span>&nbsp;<span class="ident" id="8030126">err</span>&nbsp;<span class="op" id="8030130">!=</span>&nbsp;<span class="ident" id="8030133">nil</span>&nbsp;<span class="op" id="8030137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8030143">t</span><span class="op" id="8030144">.</span><span class="ident" id="8030145">Errorf</span><span class="op" id="8030151">(</span><span class="string" id="8030152">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8030161">,</span>&nbsp;<span class="ident" id="8030163">i</span><span class="op" id="8030164">,</span>&nbsp;<span class="ident" id="8030166">err</span><span class="op" id="8030169">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8030175">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8030187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8030192">rbody</span><span class="op" id="8030197">.</span><span class="ident" id="8030198">Close</span><span class="op" id="8030203">(</span><span class="op" id="8030204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8030208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8030212">body</span>&nbsp;<span class="op" id="8030217">:=</span>&nbsp;<span class="ident" id="8030220">bout</span><span class="op" id="8030224">.</span><span class="ident" id="8030225">String</span><span class="op" id="8030231">(</span><span class="op" id="8030232">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8030236">if</span>&nbsp;<span class="ident" id="8030239">body</span>&nbsp;<span class="op" id="8030244">!=</span>&nbsp;<span class="ident" id="8030247">tt</span><span class="op" id="8030249">.</span><span class="ident" id="8030250">Body</span>&nbsp;<span class="op" id="8030255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8030260">t</span><span class="op" id="8030261">.</span><span class="ident" id="8030262">Errorf</span><span class="op" id="8030268">(</span><span class="string" id="8030269">&#34;#%d:&nbsp;Body&nbsp;=&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8030293">,</span>&nbsp;<span class="ident" id="8030295">i</span><span class="op" id="8030296">,</span>&nbsp;<span class="ident" id="8030298">body</span><span class="op" id="8030302">,</span>&nbsp;<span class="ident" id="8030304">tt</span><span class="op" id="8030306">.</span><span class="ident" id="8030307">Body</span><span class="op" id="8030311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8030315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8030318">}</span><br>
<span class="lineno"></span><span class="op" id="8030320">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="8030323">func</span>&nbsp;<span class="ident" id="8030328">TestWriteResponse</span><span class="op" id="8030345">(</span><span class="ident" id="8030346">t</span>&nbsp;<span class="op" id="8030348">*</span><span class="ident" id="8030349">testing</span><span class="op" id="8030356">.</span><span class="ident" id="8030357">T</span><span class="op" id="8030358">)</span>&nbsp;<span class="op" id="8030360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8030363">for</span>&nbsp;<span class="ident" id="8030367">i</span><span class="op" id="8030368">,</span>&nbsp;<span class="ident" id="8030370">tt</span>&nbsp;<span class="op" id="8030373">:=</span>&nbsp;<span class="keyword" id="8030376">range</span>&nbsp;<span class="ident" id="8030382">respTests</span>&nbsp;<span class="op" id="8030392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8030396">resp</span><span class="op" id="8030400">,</span>&nbsp;<span class="ident" id="8030402">err</span>&nbsp;<span class="op" id="8030406">:=</span>&nbsp;<span class="ident" id="8030409">ReadResponse</span><span class="op" id="8030421">(</span><span class="ident" id="8030422">bufio</span><span class="op" id="8030427">.</span><span class="ident" id="8030428">NewReader</span><span class="op" id="8030437">(</span><span class="ident" id="8030438">strings</span><span class="op" id="8030445">.</span><span class="ident" id="8030446">NewReader</span><span class="op" id="8030455">(</span><span class="ident" id="8030456">tt</span><span class="op" id="8030458">.</span><span class="ident" id="8030459">Raw</span><span class="op" id="8030462">)</span><span class="op" id="8030463">)</span><span class="op" id="8030464">,</span>&nbsp;<span class="ident" id="8030466">tt</span><span class="op" id="8030468">.</span><span class="ident" id="8030469">Resp</span><span class="op" id="8030473">.</span><span class="ident" id="8030474">Request</span><span class="op" id="8030481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8030485">if</span>&nbsp;<span class="ident" id="8030488">err</span>&nbsp;<span class="op" id="8030492">!=</span>&nbsp;<span class="ident" id="8030495">nil</span>&nbsp;<span class="op" id="8030499">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8030504">t</span><span class="op" id="8030505">.</span><span class="ident" id="8030506">Errorf</span><span class="op" id="8030512">(</span><span class="string" id="8030513">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8030522">,</span>&nbsp;<span class="ident" id="8030524">i</span><span class="op" id="8030525">,</span>&nbsp;<span class="ident" id="8030527">err</span><span class="op" id="8030530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8030535">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8030546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8030550">err</span>&nbsp;<span class="op" id="8030554">=</span>&nbsp;<span class="ident" id="8030556">resp</span><span class="op" id="8030560">.</span><span class="ident" id="8030561">Write</span><span class="op" id="8030566">(</span><span class="ident" id="8030567">ioutil</span><span class="op" id="8030573">.</span><span class="ident" id="8030574">Discard</span><span class="op" id="8030581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8030585">if</span>&nbsp;<span class="ident" id="8030588">err</span>&nbsp;<span class="op" id="8030592">!=</span>&nbsp;<span class="ident" id="8030595">nil</span>&nbsp;<span class="op" id="8030599">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8030604">t</span><span class="op" id="8030605">.</span><span class="ident" id="8030606">Errorf</span><span class="op" id="8030612">(</span><span class="string" id="8030613">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8030622">,</span>&nbsp;<span class="ident" id="8030624">i</span><span class="op" id="8030625">,</span>&nbsp;<span class="ident" id="8030627">err</span><span class="op" id="8030630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8030635">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8030646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8030649">}</span><br>
<span class="lineno"></span><span class="op" id="8030651">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="8030654">var</span>&nbsp;<span class="ident" id="8030658">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="8030689">=</span>&nbsp;<span class="op" id="8030691">[</span><span class="op" id="8030692">]</span><span class="keyword" id="8030693">struct</span>&nbsp;<span class="op" id="8030700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8030703">chunked</span><span class="op" id="8030710">,</span>&nbsp;<span class="ident" id="8030712">compressed</span>&nbsp;<span class="builtintype" id="8030723">bool</span><br>
<span class="lineno"></span><span class="op" id="8030728">}</span><span class="op" id="8030729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8030732">{</span><span class="ident" id="8030733">false</span><span class="op" id="8030738">,</span>&nbsp;<span class="ident" id="8030740">false</span><span class="op" id="8030745">}</span><span class="op" id="8030746">,</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8030749">{</span><span class="ident" id="8030750">true</span><span class="op" id="8030754">,</span>&nbsp;<span class="ident" id="8030756">false</span><span class="op" id="8030761">}</span><span class="op" id="8030762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8030765">{</span><span class="ident" id="8030766">true</span><span class="op" id="8030770">,</span>&nbsp;<span class="ident" id="8030772">true</span><span class="op" id="8030776">}</span><span class="op" id="8030777">,</span><br>
<span class="lineno"></span><span class="op" id="8030779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8030782">//&nbsp;TestReadResponseCloseInMiddle&nbsp;tests&nbsp;that&nbsp;closing&nbsp;a&nbsp;body&nbsp;after</span><br>
<span class="lineno">460</span><span class="comment" id="8030847">//&nbsp;reading&nbsp;only&nbsp;part&nbsp;of&nbsp;its&nbsp;contents&nbsp;advances&nbsp;the&nbsp;read&nbsp;to&nbsp;the&nbsp;end&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="8030916">//&nbsp;the&nbsp;request,&nbsp;right&nbsp;up&nbsp;until&nbsp;the&nbsp;next&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="8030965">func</span>&nbsp;<span class="ident" id="8030970">TestReadResponseCloseInMiddle</span><span class="op" id="8030999">(</span><span class="ident" id="8031000">t</span>&nbsp;<span class="op" id="8031002">*</span><span class="ident" id="8031003">testing</span><span class="op" id="8031010">.</span><span class="ident" id="8031011">T</span><span class="op" id="8031012">)</span>&nbsp;<span class="op" id="8031014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8031017">for</span>&nbsp;<span class="ident" id="8031021">_</span><span class="op" id="8031022">,</span>&nbsp;<span class="ident" id="8031024">test</span>&nbsp;<span class="op" id="8031029">:=</span>&nbsp;<span class="keyword" id="8031032">range</span>&nbsp;<span class="ident" id="8031038">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="8031069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031073">fatalf</span>&nbsp;<span class="op" id="8031080">:=</span>&nbsp;<span class="keyword" id="8031083">func</span><span class="op" id="8031087">(</span><span class="ident" id="8031088">format</span>&nbsp;<span class="builtintype" id="8031095">string</span><span class="op" id="8031101">,</span>&nbsp;<span class="ident" id="8031103">args</span>&nbsp;<span class="op" id="8031108">...</span><span class="keyword" id="8031111">interface</span><span class="op" id="8031120">{</span><span class="op" id="8031121">}</span><span class="op" id="8031122">)</span>&nbsp;<span class="op" id="8031124">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031129">args</span>&nbsp;<span class="op" id="8031134">=</span>&nbsp;<span class="builtinfunc" id="8031136">append</span><span class="op" id="8031142">(</span><span class="op" id="8031143">[</span><span class="op" id="8031144">]</span><span class="keyword" id="8031145">interface</span><span class="op" id="8031154">{</span><span class="op" id="8031155">}</span><span class="op" id="8031156">{</span><span class="ident" id="8031157">test</span><span class="op" id="8031161">.</span><span class="ident" id="8031162">chunked</span><span class="op" id="8031169">,</span>&nbsp;<span class="ident" id="8031171">test</span><span class="op" id="8031175">.</span><span class="ident" id="8031176">compressed</span><span class="op" id="8031186">}</span><span class="op" id="8031187">,</span>&nbsp;<span class="ident" id="8031189">args</span><span class="op" id="8031193">...</span><span class="op" id="8031196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031201">t</span><span class="op" id="8031202">.</span><span class="ident" id="8031203">Fatalf</span><span class="op" id="8031209">(</span><span class="string" id="8031210">&#34;on&nbsp;test&nbsp;chunked=%v,&nbsp;compressed=%v:&nbsp;&#34;</span><span class="op" id="8031247">+</span><span class="ident" id="8031248">format</span><span class="op" id="8031254">,</span>&nbsp;<span class="ident" id="8031256">args</span><span class="op" id="8031260">...</span><span class="op" id="8031263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8031267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031271">checkErr</span>&nbsp;<span class="op" id="8031280">:=</span>&nbsp;<span class="keyword" id="8031283">func</span><span class="op" id="8031287">(</span><span class="ident" id="8031288">err</span>&nbsp;<span class="builtintype" id="8031292">error</span><span class="op" id="8031297">,</span>&nbsp;<span class="ident" id="8031299">msg</span>&nbsp;<span class="builtintype" id="8031303">string</span><span class="op" id="8031309">)</span>&nbsp;<span class="op" id="8031311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8031316">if</span>&nbsp;<span class="ident" id="8031319">err</span>&nbsp;<span class="op" id="8031323">==</span>&nbsp;<span class="ident" id="8031326">nil</span>&nbsp;<span class="op" id="8031330">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8031336">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8031346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031351">fatalf</span><span class="op" id="8031357">(</span><span class="ident" id="8031358">msg</span><span class="op" id="8031361">+</span><span class="string" id="8031362">&#34;:&nbsp;%v&#34;</span><span class="op" id="8031368">,</span>&nbsp;<span class="ident" id="8031370">err</span><span class="op" id="8031373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8031377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8031381">var</span>&nbsp;<span class="ident" id="8031385">buf</span>&nbsp;<span class="ident" id="8031389">bytes</span><span class="op" id="8031394">.</span><span class="ident" id="8031395">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031404">buf</span><span class="op" id="8031407">.</span><span class="ident" id="8031408">WriteString</span><span class="op" id="8031419">(</span><span class="string" id="8031420">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span><span class="op" id="8031441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8031445">if</span>&nbsp;<span class="ident" id="8031448">test</span><span class="op" id="8031452">.</span><span class="ident" id="8031453">chunked</span>&nbsp;<span class="op" id="8031461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031466">buf</span><span class="op" id="8031469">.</span><span class="ident" id="8031470">WriteString</span><span class="op" id="8031481">(</span><span class="string" id="8031482">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span><span class="op" id="8031514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8031518">}</span>&nbsp;<span class="keyword" id="8031520">else</span>&nbsp;<span class="op" id="8031525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031530">buf</span><span class="op" id="8031533">.</span><span class="ident" id="8031534">WriteString</span><span class="op" id="8031545">(</span><span class="string" id="8031546">&#34;Content-Length:&nbsp;1000000\r\n&#34;</span><span class="op" id="8031575">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8031579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8031583">var</span>&nbsp;<span class="ident" id="8031587">wr</span>&nbsp;<span class="ident" id="8031590">io</span><span class="op" id="8031592">.</span><span class="ident" id="8031593">Writer</span>&nbsp;<span class="op" id="8031600">=</span>&nbsp;<span class="op" id="8031602">&amp;</span><span class="ident" id="8031603">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8031609">if</span>&nbsp;<span class="ident" id="8031612">test</span><span class="op" id="8031616">.</span><span class="ident" id="8031617">chunked</span>&nbsp;<span class="op" id="8031625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031630">wr</span>&nbsp;<span class="op" id="8031633">=</span>&nbsp;<span class="ident" id="8031635">internal</span><span class="op" id="8031643">.</span><span class="ident" id="8031644">NewChunkedWriter</span><span class="op" id="8031660">(</span><span class="ident" id="8031661">wr</span><span class="op" id="8031663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8031667">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8031671">if</span>&nbsp;<span class="ident" id="8031674">test</span><span class="op" id="8031678">.</span><span class="ident" id="8031679">compressed</span>&nbsp;<span class="op" id="8031690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031695">buf</span><span class="op" id="8031698">.</span><span class="ident" id="8031699">WriteString</span><span class="op" id="8031710">(</span><span class="string" id="8031711">&#34;Content-Encoding:&nbsp;gzip\r\n&#34;</span><span class="op" id="8031739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031744">wr</span>&nbsp;<span class="op" id="8031747">=</span>&nbsp;<span class="ident" id="8031749">gzip</span><span class="op" id="8031753">.</span><span class="ident" id="8031754">NewWriter</span><span class="op" id="8031763">(</span><span class="ident" id="8031764">wr</span><span class="op" id="8031766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8031770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031774">buf</span><span class="op" id="8031777">.</span><span class="ident" id="8031778">WriteString</span><span class="op" id="8031789">(</span><span class="string" id="8031790">&#34;\r\n&#34;</span><span class="op" id="8031796">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031801">chunk</span>&nbsp;<span class="op" id="8031807">:=</span>&nbsp;<span class="ident" id="8031810">bytes</span><span class="op" id="8031815">.</span><span class="ident" id="8031816">Repeat</span><span class="op" id="8031822">(</span><span class="op" id="8031823">[</span><span class="op" id="8031824">]</span><span class="builtintype" id="8031825">byte</span><span class="op" id="8031829">{</span><span class="string" id="8031830">&#39;x&#39;</span><span class="op" id="8031833">}</span><span class="op" id="8031834">,</span>&nbsp;<span class="num" id="8031836">1000</span><span class="op" id="8031840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8031844">for</span>&nbsp;<span class="ident" id="8031848">i</span>&nbsp;<span class="op" id="8031850">:=</span>&nbsp;<span class="num" id="8031853">0</span><span class="op" id="8031854">;</span>&nbsp;<span class="ident" id="8031856">i</span>&nbsp;<span class="op" id="8031858">&lt;</span>&nbsp;<span class="num" id="8031860">1000</span><span class="op" id="8031864">;</span>&nbsp;<span class="ident" id="8031866">i</span><span class="op" id="8031867">++</span>&nbsp;<span class="op" id="8031870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8031875">if</span>&nbsp;<span class="ident" id="8031878">test</span><span class="op" id="8031882">.</span><span class="ident" id="8031883">compressed</span>&nbsp;<span class="op" id="8031894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8031900">//&nbsp;Otherwise&nbsp;this&nbsp;compresses&nbsp;too&nbsp;well.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031943">_</span><span class="op" id="8031944">,</span>&nbsp;<span class="ident" id="8031946">err</span>&nbsp;<span class="op" id="8031950">:=</span>&nbsp;<span class="ident" id="8031953">io</span><span class="op" id="8031955">.</span><span class="ident" id="8031956">ReadFull</span><span class="op" id="8031964">(</span><span class="ident" id="8031965">rand</span><span class="op" id="8031969">.</span><span class="ident" id="8031970">Reader</span><span class="op" id="8031976">,</span>&nbsp;<span class="ident" id="8031978">chunk</span><span class="op" id="8031983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8031989">checkErr</span><span class="op" id="8031997">(</span><span class="ident" id="8031998">err</span><span class="op" id="8032001">,</span>&nbsp;<span class="string" id="8032003">&#34;rand.Reader&nbsp;ReadFull&#34;</span><span class="op" id="8032025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032035">wr</span><span class="op" id="8032037">.</span><span class="ident" id="8032038">Write</span><span class="op" id="8032043">(</span><span class="ident" id="8032044">chunk</span><span class="op" id="8032049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032053">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032057">if</span>&nbsp;<span class="ident" id="8032060">test</span><span class="op" id="8032064">.</span><span class="ident" id="8032065">compressed</span>&nbsp;<span class="op" id="8032076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032081">err</span>&nbsp;<span class="op" id="8032085">:=</span>&nbsp;<span class="ident" id="8032088">wr</span><span class="op" id="8032090">.</span><span class="op" id="8032091">(</span><span class="op" id="8032092">*</span><span class="ident" id="8032093">gzip</span><span class="op" id="8032097">.</span><span class="ident" id="8032098">Writer</span><span class="op" id="8032104">)</span><span class="op" id="8032105">.</span><span class="ident" id="8032106">Close</span><span class="op" id="8032111">(</span><span class="op" id="8032112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032117">checkErr</span><span class="op" id="8032125">(</span><span class="ident" id="8032126">err</span><span class="op" id="8032129">,</span>&nbsp;<span class="string" id="8032131">&#34;compressor&nbsp;close&#34;</span><span class="op" id="8032149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032157">if</span>&nbsp;<span class="ident" id="8032160">test</span><span class="op" id="8032164">.</span><span class="ident" id="8032165">chunked</span>&nbsp;<span class="op" id="8032173">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032178">buf</span><span class="op" id="8032181">.</span><span class="ident" id="8032182">WriteString</span><span class="op" id="8032193">(</span><span class="string" id="8032194">&#34;0\r\n\r\n&#34;</span><span class="op" id="8032205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032213">buf</span><span class="op" id="8032216">.</span><span class="ident" id="8032217">WriteString</span><span class="op" id="8032228">(</span><span class="string" id="8032229">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="8032248">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032253">bufr</span>&nbsp;<span class="op" id="8032258">:=</span>&nbsp;<span class="ident" id="8032261">bufio</span><span class="op" id="8032266">.</span><span class="ident" id="8032267">NewReader</span><span class="op" id="8032276">(</span><span class="op" id="8032277">&amp;</span><span class="ident" id="8032278">buf</span><span class="op" id="8032281">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032285">resp</span><span class="op" id="8032289">,</span>&nbsp;<span class="ident" id="8032291">err</span>&nbsp;<span class="op" id="8032295">:=</span>&nbsp;<span class="ident" id="8032298">ReadResponse</span><span class="op" id="8032310">(</span><span class="ident" id="8032311">bufr</span><span class="op" id="8032315">,</span>&nbsp;<span class="ident" id="8032317">dummyReq</span><span class="op" id="8032325">(</span><span class="string" id="8032326">&#34;GET&#34;</span><span class="op" id="8032331">)</span><span class="op" id="8032332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032336">checkErr</span><span class="op" id="8032344">(</span><span class="ident" id="8032345">err</span><span class="op" id="8032348">,</span>&nbsp;<span class="string" id="8032350">&#34;ReadResponse&#34;</span><span class="op" id="8032364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032368">expectedLength</span>&nbsp;<span class="op" id="8032383">:=</span>&nbsp;<span class="ident" id="8032386">int64</span><span class="op" id="8032391">(</span><span class="op" id="8032392">-</span><span class="num" id="8032393">1</span><span class="op" id="8032394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032398">if</span>&nbsp;<span class="op" id="8032401">!</span><span class="ident" id="8032402">test</span><span class="op" id="8032406">.</span><span class="ident" id="8032407">chunked</span>&nbsp;<span class="op" id="8032415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032420">expectedLength</span>&nbsp;<span class="op" id="8032435">=</span>&nbsp;<span class="num" id="8032437">1000000</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032451">if</span>&nbsp;<span class="ident" id="8032454">resp</span><span class="op" id="8032458">.</span><span class="ident" id="8032459">ContentLength</span>&nbsp;<span class="op" id="8032473">!=</span>&nbsp;<span class="ident" id="8032476">expectedLength</span>&nbsp;<span class="op" id="8032491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032496">fatalf</span><span class="op" id="8032502">(</span><span class="string" id="8032503">&#34;expected&nbsp;response&nbsp;length&nbsp;%d,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8032540">,</span>&nbsp;<span class="ident" id="8032542">expectedLength</span><span class="op" id="8032556">,</span>&nbsp;<span class="ident" id="8032558">resp</span><span class="op" id="8032562">.</span><span class="ident" id="8032563">ContentLength</span><span class="op" id="8032576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032584">if</span>&nbsp;<span class="ident" id="8032587">resp</span><span class="op" id="8032591">.</span><span class="ident" id="8032592">Body</span>&nbsp;<span class="op" id="8032597">==</span>&nbsp;<span class="ident" id="8032600">nil</span>&nbsp;<span class="op" id="8032604">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032609">fatalf</span><span class="op" id="8032615">(</span><span class="string" id="8032616">&#34;nil&nbsp;body&#34;</span><span class="op" id="8032626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032634">if</span>&nbsp;<span class="ident" id="8032637">test</span><span class="op" id="8032641">.</span><span class="ident" id="8032642">compressed</span>&nbsp;<span class="op" id="8032653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032658">gzReader</span><span class="op" id="8032666">,</span>&nbsp;<span class="ident" id="8032668">err</span>&nbsp;<span class="op" id="8032672">:=</span>&nbsp;<span class="ident" id="8032675">gzip</span><span class="op" id="8032679">.</span><span class="ident" id="8032680">NewReader</span><span class="op" id="8032689">(</span><span class="ident" id="8032690">resp</span><span class="op" id="8032694">.</span><span class="ident" id="8032695">Body</span><span class="op" id="8032699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032704">checkErr</span><span class="op" id="8032712">(</span><span class="ident" id="8032713">err</span><span class="op" id="8032716">,</span>&nbsp;<span class="string" id="8032718">&#34;gzip.NewReader&#34;</span><span class="op" id="8032734">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032739">resp</span><span class="op" id="8032743">.</span><span class="ident" id="8032744">Body</span>&nbsp;<span class="op" id="8032749">=</span>&nbsp;<span class="op" id="8032751">&amp;</span><span class="ident" id="8032752">readerAndCloser</span><span class="op" id="8032767">{</span><span class="ident" id="8032768">gzReader</span><span class="op" id="8032776">,</span>&nbsp;<span class="ident" id="8032778">resp</span><span class="op" id="8032782">.</span><span class="ident" id="8032783">Body</span><span class="op" id="8032787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032796">rbuf</span>&nbsp;<span class="op" id="8032801">:=</span>&nbsp;<span class="builtinfunc" id="8032804">make</span><span class="op" id="8032808">(</span><span class="op" id="8032809">[</span><span class="op" id="8032810">]</span><span class="builtintype" id="8032811">byte</span><span class="op" id="8032815">,</span>&nbsp;<span class="num" id="8032817">2500</span><span class="op" id="8032821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032825">n</span><span class="op" id="8032826">,</span>&nbsp;<span class="ident" id="8032828">err</span>&nbsp;<span class="op" id="8032832">:=</span>&nbsp;<span class="ident" id="8032835">io</span><span class="op" id="8032837">.</span><span class="ident" id="8032838">ReadFull</span><span class="op" id="8032846">(</span><span class="ident" id="8032847">resp</span><span class="op" id="8032851">.</span><span class="ident" id="8032852">Body</span><span class="op" id="8032856">,</span>&nbsp;<span class="ident" id="8032858">rbuf</span><span class="op" id="8032862">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032866">checkErr</span><span class="op" id="8032874">(</span><span class="ident" id="8032875">err</span><span class="op" id="8032878">,</span>&nbsp;<span class="string" id="8032880">&#34;2500&nbsp;byte&nbsp;ReadFull&#34;</span><span class="op" id="8032900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032904">if</span>&nbsp;<span class="ident" id="8032907">n</span>&nbsp;<span class="op" id="8032909">!=</span>&nbsp;<span class="num" id="8032912">2500</span>&nbsp;<span class="op" id="8032917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032922">fatalf</span><span class="op" id="8032928">(</span><span class="string" id="8032929">&#34;ReadFull&nbsp;only&nbsp;read&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="8032958">,</span>&nbsp;<span class="ident" id="8032960">n</span><span class="op" id="8032961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032969">if</span>&nbsp;<span class="ident" id="8032972">test</span><span class="op" id="8032976">.</span><span class="ident" id="8032977">compressed</span>&nbsp;<span class="op" id="8032988">==</span>&nbsp;<span class="ident" id="8032991">false</span>&nbsp;<span class="op" id="8032997">&amp;&amp;</span>&nbsp;<span class="op" id="8033000">!</span><span class="ident" id="8033001">bytes</span><span class="op" id="8033006">.</span><span class="ident" id="8033007">Equal</span><span class="op" id="8033012">(</span><span class="ident" id="8033013">bytes</span><span class="op" id="8033018">.</span><span class="ident" id="8033019">Repeat</span><span class="op" id="8033025">(</span><span class="op" id="8033026">[</span><span class="op" id="8033027">]</span><span class="builtintype" id="8033028">byte</span><span class="op" id="8033032">{</span><span class="string" id="8033033">&#39;x&#39;</span><span class="op" id="8033036">}</span><span class="op" id="8033037">,</span>&nbsp;<span class="num" id="8033039">2500</span><span class="op" id="8033043">)</span><span class="op" id="8033044">,</span>&nbsp;<span class="ident" id="8033046">rbuf</span><span class="op" id="8033050">)</span>&nbsp;<span class="op" id="8033052">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033057">fatalf</span><span class="op" id="8033063">(</span><span class="string" id="8033064">&#34;ReadFull&nbsp;didn&#39;t&nbsp;read&nbsp;2500&nbsp;&#39;x&#39;;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8033103">,</span>&nbsp;<span class="builtintype" id="8033105">string</span><span class="op" id="8033111">(</span><span class="ident" id="8033112">rbuf</span><span class="op" id="8033116">)</span><span class="op" id="8033117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033125">resp</span><span class="op" id="8033129">.</span><span class="ident" id="8033130">Body</span><span class="op" id="8033134">.</span><span class="ident" id="8033135">Close</span><span class="op" id="8033140">(</span><span class="op" id="8033141">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033146">rest</span><span class="op" id="8033150">,</span>&nbsp;<span class="ident" id="8033152">err</span>&nbsp;<span class="op" id="8033156">:=</span>&nbsp;<span class="ident" id="8033159">ioutil</span><span class="op" id="8033165">.</span><span class="ident" id="8033166">ReadAll</span><span class="op" id="8033173">(</span><span class="ident" id="8033174">bufr</span><span class="op" id="8033178">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033182">checkErr</span><span class="op" id="8033190">(</span><span class="ident" id="8033191">err</span><span class="op" id="8033194">,</span>&nbsp;<span class="string" id="8033196">&#34;ReadAll&nbsp;on&nbsp;remainder&#34;</span><span class="op" id="8033218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033222">if</span>&nbsp;<span class="ident" id="8033225">e</span><span class="op" id="8033226">,</span>&nbsp;<span class="ident" id="8033228">g</span>&nbsp;<span class="op" id="8033230">:=</span>&nbsp;<span class="string" id="8033233">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="8033252">,</span>&nbsp;<span class="builtintype" id="8033254">string</span><span class="op" id="8033260">(</span><span class="ident" id="8033261">rest</span><span class="op" id="8033265">)</span><span class="op" id="8033266">;</span>&nbsp;<span class="ident" id="8033268">e</span>&nbsp;<span class="op" id="8033270">!=</span>&nbsp;<span class="ident" id="8033273">g</span>&nbsp;<span class="op" id="8033275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033280">g</span>&nbsp;<span class="op" id="8033282">=</span>&nbsp;<span class="ident" id="8033284">regexp</span><span class="op" id="8033290">.</span><span class="ident" id="8033291">MustCompile</span><span class="op" id="8033302">(</span><span class="string" id="8033303">`(xx+)`</span><span class="op" id="8033310">)</span><span class="op" id="8033311">.</span><span class="ident" id="8033312">ReplaceAllStringFunc</span><span class="op" id="8033332">(</span><span class="ident" id="8033333">g</span><span class="op" id="8033334">,</span>&nbsp;<span class="keyword" id="8033336">func</span><span class="op" id="8033340">(</span><span class="ident" id="8033341">match</span>&nbsp;<span class="builtintype" id="8033347">string</span><span class="op" id="8033353">)</span>&nbsp;<span class="builtintype" id="8033355">string</span>&nbsp;<span class="op" id="8033362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033368">return</span>&nbsp;<span class="ident" id="8033375">fmt</span><span class="op" id="8033378">.</span><span class="ident" id="8033379">Sprintf</span><span class="op" id="8033386">(</span><span class="string" id="8033387">&#34;x(repeated&nbsp;x%d)&#34;</span><span class="op" id="8033404">,</span>&nbsp;<span class="builtinfunc" id="8033406">len</span><span class="op" id="8033409">(</span><span class="ident" id="8033410">match</span><span class="op" id="8033415">)</span><span class="op" id="8033416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033421">}</span><span class="op" id="8033422">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033427">fatalf</span><span class="op" id="8033433">(</span><span class="string" id="8033434">&#34;remainder&nbsp;=&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="8033463">,</span>&nbsp;<span class="ident" id="8033465">g</span><span class="op" id="8033466">,</span>&nbsp;<span class="ident" id="8033468">e</span><span class="op" id="8033469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033476">}</span><br>
<span class="lineno"></span><span class="op" id="8033478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="keyword" id="8033481">func</span>&nbsp;<span class="ident" id="8033486">diff</span><span class="op" id="8033490">(</span><span class="ident" id="8033491">t</span>&nbsp;<span class="op" id="8033493">*</span><span class="ident" id="8033494">testing</span><span class="op" id="8033501">.</span><span class="ident" id="8033502">T</span><span class="op" id="8033503">,</span>&nbsp;<span class="ident" id="8033505">prefix</span>&nbsp;<span class="builtintype" id="8033512">string</span><span class="op" id="8033518">,</span>&nbsp;<span class="ident" id="8033520">have</span><span class="op" id="8033524">,</span>&nbsp;<span class="ident" id="8033526">want</span>&nbsp;<span class="keyword" id="8033531">interface</span><span class="op" id="8033540">{</span><span class="op" id="8033541">}</span><span class="op" id="8033542">)</span>&nbsp;<span class="op" id="8033544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033547">hv</span>&nbsp;<span class="op" id="8033550">:=</span>&nbsp;<span class="ident" id="8033553">reflect</span><span class="op" id="8033560">.</span><span class="ident" id="8033561">ValueOf</span><span class="op" id="8033568">(</span><span class="ident" id="8033569">have</span><span class="op" id="8033573">)</span><span class="op" id="8033574">.</span><span class="ident" id="8033575">Elem</span><span class="op" id="8033579">(</span><span class="op" id="8033580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033583">wv</span>&nbsp;<span class="op" id="8033586">:=</span>&nbsp;<span class="ident" id="8033589">reflect</span><span class="op" id="8033596">.</span><span class="ident" id="8033597">ValueOf</span><span class="op" id="8033604">(</span><span class="ident" id="8033605">want</span><span class="op" id="8033609">)</span><span class="op" id="8033610">.</span><span class="ident" id="8033611">Elem</span><span class="op" id="8033615">(</span><span class="op" id="8033616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033619">if</span>&nbsp;<span class="ident" id="8033622">hv</span><span class="op" id="8033624">.</span><span class="ident" id="8033625">Type</span><span class="op" id="8033629">(</span><span class="op" id="8033630">)</span>&nbsp;<span class="op" id="8033632">!=</span>&nbsp;<span class="ident" id="8033635">wv</span><span class="op" id="8033637">.</span><span class="ident" id="8033638">Type</span><span class="op" id="8033642">(</span><span class="op" id="8033643">)</span>&nbsp;<span class="op" id="8033645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033649">t</span><span class="op" id="8033650">.</span><span class="ident" id="8033651">Errorf</span><span class="op" id="8033657">(</span><span class="string" id="8033658">&#34;%s:&nbsp;type&nbsp;mismatch&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8033688">,</span>&nbsp;<span class="ident" id="8033690">prefix</span><span class="op" id="8033696">,</span>&nbsp;<span class="ident" id="8033698">hv</span><span class="op" id="8033700">.</span><span class="ident" id="8033701">Type</span><span class="op" id="8033705">(</span><span class="op" id="8033706">)</span><span class="op" id="8033707">,</span>&nbsp;<span class="ident" id="8033709">wv</span><span class="op" id="8033711">.</span><span class="ident" id="8033712">Type</span><span class="op" id="8033716">(</span><span class="op" id="8033717">)</span><span class="op" id="8033718">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033724">for</span>&nbsp;<span class="ident" id="8033728">i</span>&nbsp;<span class="op" id="8033730">:=</span>&nbsp;<span class="num" id="8033733">0</span><span class="op" id="8033734">;</span>&nbsp;<span class="ident" id="8033736">i</span>&nbsp;<span class="op" id="8033738">&lt;</span>&nbsp;<span class="ident" id="8033740">hv</span><span class="op" id="8033742">.</span><span class="ident" id="8033743">NumField</span><span class="op" id="8033751">(</span><span class="op" id="8033752">)</span><span class="op" id="8033753">;</span>&nbsp;<span class="ident" id="8033755">i</span><span class="op" id="8033756">++</span>&nbsp;<span class="op" id="8033759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033763">hf</span>&nbsp;<span class="op" id="8033766">:=</span>&nbsp;<span class="ident" id="8033769">hv</span><span class="op" id="8033771">.</span><span class="ident" id="8033772">Field</span><span class="op" id="8033777">(</span><span class="ident" id="8033778">i</span><span class="op" id="8033779">)</span><span class="op" id="8033780">.</span><span class="ident" id="8033781">Interface</span><span class="op" id="8033790">(</span><span class="op" id="8033791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033795">wf</span>&nbsp;<span class="op" id="8033798">:=</span>&nbsp;<span class="ident" id="8033801">wv</span><span class="op" id="8033803">.</span><span class="ident" id="8033804">Field</span><span class="op" id="8033809">(</span><span class="ident" id="8033810">i</span><span class="op" id="8033811">)</span><span class="op" id="8033812">.</span><span class="ident" id="8033813">Interface</span><span class="op" id="8033822">(</span><span class="op" id="8033823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033827">if</span>&nbsp;<span class="op" id="8033830">!</span><span class="ident" id="8033831">reflect</span><span class="op" id="8033838">.</span><span class="ident" id="8033839">DeepEqual</span><span class="op" id="8033848">(</span><span class="ident" id="8033849">hf</span><span class="op" id="8033851">,</span>&nbsp;<span class="ident" id="8033853">wf</span><span class="op" id="8033855">)</span>&nbsp;<span class="op" id="8033857">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033862">t</span><span class="op" id="8033863">.</span><span class="ident" id="8033864">Errorf</span><span class="op" id="8033870">(</span><span class="string" id="8033871">&#34;%s:&nbsp;%s&nbsp;=&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8033892">,</span>&nbsp;<span class="ident" id="8033894">prefix</span><span class="op" id="8033900">,</span>&nbsp;<span class="ident" id="8033902">hv</span><span class="op" id="8033904">.</span><span class="ident" id="8033905">Type</span><span class="op" id="8033909">(</span><span class="op" id="8033910">)</span><span class="op" id="8033911">.</span><span class="ident" id="8033912">Field</span><span class="op" id="8033917">(</span><span class="ident" id="8033918">i</span><span class="op" id="8033919">)</span><span class="op" id="8033920">.</span><span class="ident" id="8033921">Name</span><span class="op" id="8033925">,</span>&nbsp;<span class="ident" id="8033927">hf</span><span class="op" id="8033929">,</span>&nbsp;<span class="ident" id="8033931">wf</span><span class="op" id="8033933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033940">}</span><br>
<span class="lineno"></span><span class="op" id="8033942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span><span class="keyword" id="8033945">type</span>&nbsp;<span class="ident" id="8033950">responseLocationTest</span>&nbsp;<span class="keyword" id="8033971">struct</span>&nbsp;<span class="op" id="8033978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033981">location</span>&nbsp;<span class="builtintype" id="8033990">string</span>&nbsp;<span class="comment" id="8033997">//&nbsp;Response&#39;s&nbsp;Location&nbsp;header&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034034">requrl</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8034043">string</span>&nbsp;<span class="comment" id="8034050">//&nbsp;Response.Request.URL&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034081">want</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8034090">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034098">wantErr</span>&nbsp;&nbsp;<span class="builtintype" id="8034107">error</span><br>
<span class="lineno">570</span><span class="op" id="8034113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8034116">var</span>&nbsp;<span class="ident" id="8034120">responseLocationTests</span>&nbsp;<span class="op" id="8034142">=</span>&nbsp;<span class="op" id="8034144">[</span><span class="op" id="8034145">]</span><span class="ident" id="8034146">responseLocationTest</span><span class="op" id="8034166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8034169">{</span><span class="string" id="8034170">&#34;/foo&#34;</span><span class="op" id="8034176">,</span>&nbsp;<span class="string" id="8034178">&#34;http://bar.com/baz&#34;</span><span class="op" id="8034198">,</span>&nbsp;<span class="string" id="8034200">&#34;http://bar.com/foo&#34;</span><span class="op" id="8034220">,</span>&nbsp;<span class="ident" id="8034222">nil</span><span class="op" id="8034225">}</span><span class="op" id="8034226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8034229">{</span><span class="string" id="8034230">&#34;http://foo.com/&#34;</span><span class="op" id="8034247">,</span>&nbsp;<span class="string" id="8034249">&#34;http://bar.com/baz&#34;</span><span class="op" id="8034269">,</span>&nbsp;<span class="string" id="8034271">&#34;http://foo.com/&#34;</span><span class="op" id="8034288">,</span>&nbsp;<span class="ident" id="8034290">nil</span><span class="op" id="8034293">}</span><span class="op" id="8034294">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8034297">{</span><span class="string" id="8034298">&#34;&#34;</span><span class="op" id="8034300">,</span>&nbsp;<span class="string" id="8034302">&#34;http://bar.com/baz&#34;</span><span class="op" id="8034322">,</span>&nbsp;<span class="string" id="8034324">&#34;&#34;</span><span class="op" id="8034326">,</span>&nbsp;<span class="ident" id="8034328">ErrNoLocation</span><span class="op" id="8034341">}</span><span class="op" id="8034342">,</span><br>
<span class="lineno"></span><span class="op" id="8034344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8034347">func</span>&nbsp;<span class="ident" id="8034352">TestLocationResponse</span><span class="op" id="8034372">(</span><span class="ident" id="8034373">t</span>&nbsp;<span class="op" id="8034375">*</span><span class="ident" id="8034376">testing</span><span class="op" id="8034383">.</span><span class="ident" id="8034384">T</span><span class="op" id="8034385">)</span>&nbsp;<span class="op" id="8034387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8034390">for</span>&nbsp;<span class="ident" id="8034394">i</span><span class="op" id="8034395">,</span>&nbsp;<span class="ident" id="8034397">tt</span>&nbsp;<span class="op" id="8034400">:=</span>&nbsp;<span class="keyword" id="8034403">range</span>&nbsp;<span class="ident" id="8034409">responseLocationTests</span>&nbsp;<span class="op" id="8034431">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034435">res</span>&nbsp;<span class="op" id="8034439">:=</span>&nbsp;<span class="builtinfunc" id="8034442">new</span><span class="op" id="8034445">(</span><span class="ident" id="8034446">Response</span><span class="op" id="8034454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034458">res</span><span class="op" id="8034461">.</span><span class="ident" id="8034462">Header</span>&nbsp;<span class="op" id="8034469">=</span>&nbsp;<span class="builtinfunc" id="8034471">make</span><span class="op" id="8034475">(</span><span class="ident" id="8034476">Header</span><span class="op" id="8034482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034486">res</span><span class="op" id="8034489">.</span><span class="ident" id="8034490">Header</span><span class="op" id="8034496">.</span><span class="ident" id="8034497">Set</span><span class="op" id="8034500">(</span><span class="string" id="8034501">&#34;Location&#34;</span><span class="op" id="8034511">,</span>&nbsp;<span class="ident" id="8034513">tt</span><span class="op" id="8034515">.</span><span class="ident" id="8034516">location</span><span class="op" id="8034524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8034528">if</span>&nbsp;<span class="ident" id="8034531">tt</span><span class="op" id="8034533">.</span><span class="ident" id="8034534">requrl</span>&nbsp;<span class="op" id="8034541">!=</span>&nbsp;<span class="string" id="8034544">&#34;&#34;</span>&nbsp;<span class="op" id="8034547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034552">res</span><span class="op" id="8034555">.</span><span class="ident" id="8034556">Request</span>&nbsp;<span class="op" id="8034564">=</span>&nbsp;<span class="op" id="8034566">&amp;</span><span class="ident" id="8034567">Request</span><span class="op" id="8034574">{</span><span class="op" id="8034575">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8034580">var</span>&nbsp;<span class="ident" id="8034584">err</span>&nbsp;<span class="builtintype" id="8034588">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034597">res</span><span class="op" id="8034600">.</span><span class="ident" id="8034601">Request</span><span class="op" id="8034608">.</span><span class="ident" id="8034609">URL</span><span class="op" id="8034612">,</span>&nbsp;<span class="ident" id="8034614">err</span>&nbsp;<span class="op" id="8034618">=</span>&nbsp;<span class="ident" id="8034620">url</span><span class="op" id="8034623">.</span><span class="ident" id="8034624">Parse</span><span class="op" id="8034629">(</span><span class="ident" id="8034630">tt</span><span class="op" id="8034632">.</span><span class="ident" id="8034633">requrl</span><span class="op" id="8034639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8034644">if</span>&nbsp;<span class="ident" id="8034647">err</span>&nbsp;<span class="op" id="8034651">!=</span>&nbsp;<span class="ident" id="8034654">nil</span>&nbsp;<span class="op" id="8034658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034664">t</span><span class="op" id="8034665">.</span><span class="ident" id="8034666">Fatalf</span><span class="op" id="8034672">(</span><span class="string" id="8034673">&#34;bad&nbsp;test&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8034694">,</span>&nbsp;<span class="ident" id="8034696">tt</span><span class="op" id="8034698">.</span><span class="ident" id="8034699">requrl</span><span class="op" id="8034705">,</span>&nbsp;<span class="ident" id="8034707">err</span><span class="op" id="8034710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8034715">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8034719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034724">got</span><span class="op" id="8034727">,</span>&nbsp;<span class="ident" id="8034729">err</span>&nbsp;<span class="op" id="8034733">:=</span>&nbsp;<span class="ident" id="8034736">res</span><span class="op" id="8034739">.</span><span class="ident" id="8034740">Location</span><span class="op" id="8034748">(</span><span class="op" id="8034749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8034753">if</span>&nbsp;<span class="ident" id="8034756">tt</span><span class="op" id="8034758">.</span><span class="ident" id="8034759">wantErr</span>&nbsp;<span class="op" id="8034767">!=</span>&nbsp;<span class="ident" id="8034770">nil</span>&nbsp;<span class="op" id="8034774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8034779">if</span>&nbsp;<span class="ident" id="8034782">err</span>&nbsp;<span class="op" id="8034786">==</span>&nbsp;<span class="ident" id="8034789">nil</span>&nbsp;<span class="op" id="8034793">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034799">t</span><span class="op" id="8034800">.</span><span class="ident" id="8034801">Errorf</span><span class="op" id="8034807">(</span><span class="string" id="8034808">&#34;%d.&nbsp;err=nil;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8034830">,</span>&nbsp;<span class="ident" id="8034832">i</span><span class="op" id="8034833">,</span>&nbsp;<span class="ident" id="8034835">tt</span><span class="op" id="8034837">.</span><span class="ident" id="8034838">wantErr</span><span class="op" id="8034845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8034851">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8034863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8034868">if</span>&nbsp;<span class="ident" id="8034871">g</span><span class="op" id="8034872">,</span>&nbsp;<span class="ident" id="8034874">e</span>&nbsp;<span class="op" id="8034876">:=</span>&nbsp;<span class="ident" id="8034879">err</span><span class="op" id="8034882">.</span><span class="ident" id="8034883">Error</span><span class="op" id="8034888">(</span><span class="op" id="8034889">)</span><span class="op" id="8034890">,</span>&nbsp;<span class="ident" id="8034892">tt</span><span class="op" id="8034894">.</span><span class="ident" id="8034895">wantErr</span><span class="op" id="8034902">.</span><span class="ident" id="8034903">Error</span><span class="op" id="8034908">(</span><span class="op" id="8034909">)</span><span class="op" id="8034910">;</span>&nbsp;<span class="ident" id="8034912">g</span>&nbsp;<span class="op" id="8034914">!=</span>&nbsp;<span class="ident" id="8034917">e</span>&nbsp;<span class="op" id="8034919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034925">t</span><span class="op" id="8034926">.</span><span class="ident" id="8034927">Errorf</span><span class="op" id="8034933">(</span><span class="string" id="8034934">&#34;%d.&nbsp;err=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8034955">,</span>&nbsp;<span class="ident" id="8034957">i</span><span class="op" id="8034958">,</span>&nbsp;<span class="ident" id="8034960">g</span><span class="op" id="8034961">,</span>&nbsp;<span class="ident" id="8034963">e</span><span class="op" id="8034964">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8034970">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8034982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8034987">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8034998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8035002">if</span>&nbsp;<span class="ident" id="8035005">err</span>&nbsp;<span class="op" id="8035009">!=</span>&nbsp;<span class="ident" id="8035012">nil</span>&nbsp;<span class="op" id="8035016">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035021">t</span><span class="op" id="8035022">.</span><span class="ident" id="8035023">Errorf</span><span class="op" id="8035029">(</span><span class="string" id="8035030">&#34;%d.&nbsp;err=%q&#34;</span><span class="op" id="8035042">,</span>&nbsp;<span class="ident" id="8035044">i</span><span class="op" id="8035045">,</span>&nbsp;<span class="ident" id="8035047">err</span><span class="op" id="8035050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8035055">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8035066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8035070">if</span>&nbsp;<span class="ident" id="8035073">g</span><span class="op" id="8035074">,</span>&nbsp;<span class="ident" id="8035076">e</span>&nbsp;<span class="op" id="8035078">:=</span>&nbsp;<span class="ident" id="8035081">got</span><span class="op" id="8035084">.</span><span class="ident" id="8035085">String</span><span class="op" id="8035091">(</span><span class="op" id="8035092">)</span><span class="op" id="8035093">,</span>&nbsp;<span class="ident" id="8035095">tt</span><span class="op" id="8035097">.</span><span class="ident" id="8035098">want</span><span class="op" id="8035102">;</span>&nbsp;<span class="ident" id="8035104">g</span>&nbsp;<span class="op" id="8035106">!=</span>&nbsp;<span class="ident" id="8035109">e</span>&nbsp;<span class="op" id="8035111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035116">t</span><span class="op" id="8035117">.</span><span class="ident" id="8035118">Errorf</span><span class="op" id="8035124">(</span><span class="string" id="8035125">&#34;%d.&nbsp;Location=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8035151">,</span>&nbsp;<span class="ident" id="8035153">i</span><span class="op" id="8035154">,</span>&nbsp;<span class="ident" id="8035156">g</span><span class="op" id="8035157">,</span>&nbsp;<span class="ident" id="8035159">e</span><span class="op" id="8035160">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8035164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8035167">}</span><br>
<span class="lineno"></span><span class="op" id="8035169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8035172">func</span>&nbsp;<span class="ident" id="8035177">TestResponseStatusStutter</span><span class="op" id="8035202">(</span><span class="ident" id="8035203">t</span>&nbsp;<span class="op" id="8035205">*</span><span class="ident" id="8035206">testing</span><span class="op" id="8035213">.</span><span class="ident" id="8035214">T</span><span class="op" id="8035215">)</span>&nbsp;<span class="op" id="8035217">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035220">r</span>&nbsp;<span class="op" id="8035222">:=</span>&nbsp;<span class="op" id="8035225">&amp;</span><span class="ident" id="8035226">Response</span><span class="op" id="8035234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035238">Status</span><span class="op" id="8035244">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8035250">&#34;123&nbsp;some&nbsp;status&#34;</span><span class="op" id="8035267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035271">StatusCode</span><span class="op" id="8035281">:</span>&nbsp;<span class="num" id="8035283">123</span><span class="op" id="8035286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035290">ProtoMajor</span><span class="op" id="8035300">:</span>&nbsp;<span class="num" id="8035302">1</span><span class="op" id="8035303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035307">ProtoMinor</span><span class="op" id="8035317">:</span>&nbsp;<span class="num" id="8035319">3</span><span class="op" id="8035320">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8035323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8035326">var</span>&nbsp;<span class="ident" id="8035330">buf</span>&nbsp;<span class="ident" id="8035334">bytes</span><span class="op" id="8035339">.</span><span class="ident" id="8035340">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035348">r</span><span class="op" id="8035349">.</span><span class="ident" id="8035350">Write</span><span class="op" id="8035355">(</span><span class="op" id="8035356">&amp;</span><span class="ident" id="8035357">buf</span><span class="op" id="8035360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8035363">if</span>&nbsp;<span class="ident" id="8035366">strings</span><span class="op" id="8035373">.</span><span class="ident" id="8035374">Contains</span><span class="op" id="8035382">(</span><span class="ident" id="8035383">buf</span><span class="op" id="8035386">.</span><span class="ident" id="8035387">String</span><span class="op" id="8035393">(</span><span class="op" id="8035394">)</span><span class="op" id="8035395">,</span>&nbsp;<span class="string" id="8035397">&#34;123&nbsp;123&#34;</span><span class="op" id="8035406">)</span>&nbsp;<span class="op" id="8035408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035412">t</span><span class="op" id="8035413">.</span><span class="ident" id="8035414">Errorf</span><span class="op" id="8035420">(</span><span class="string" id="8035421">&#34;stutter&nbsp;in&nbsp;status:&nbsp;%s&#34;</span><span class="op" id="8035444">,</span>&nbsp;<span class="ident" id="8035446">buf</span><span class="op" id="8035449">.</span><span class="ident" id="8035450">String</span><span class="op" id="8035456">(</span><span class="op" id="8035457">)</span><span class="op" id="8035458">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8035461">}</span><br>
<span class="lineno"></span><span class="op" id="8035463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8035466">func</span>&nbsp;<span class="ident" id="8035471">TestResponseContentLengthShortBody</span><span class="op" id="8035505">(</span><span class="ident" id="8035506">t</span>&nbsp;<span class="op" id="8035508">*</span><span class="ident" id="8035509">testing</span><span class="op" id="8035516">.</span><span class="ident" id="8035517">T</span><span class="op" id="8035518">)</span>&nbsp;<span class="op" id="8035520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8035523">const</span>&nbsp;<span class="ident" id="8035529">shortBody</span>&nbsp;<span class="op" id="8035539">=</span>&nbsp;<span class="string" id="8035541">&#34;Short&nbsp;body,&nbsp;not&nbsp;123&nbsp;bytes.&#34;</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035571">br</span>&nbsp;<span class="op" id="8035574">:=</span>&nbsp;<span class="ident" id="8035577">bufio</span><span class="op" id="8035582">.</span><span class="ident" id="8035583">NewReader</span><span class="op" id="8035592">(</span><span class="ident" id="8035593">strings</span><span class="op" id="8035600">.</span><span class="ident" id="8035601">NewReader</span><span class="op" id="8035610">(</span><span class="string" id="8035611">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8035633">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8035637">&#34;Content-Length:&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="8035663">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8035667">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8035674">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035678">shortBody</span><span class="op" id="8035687">)</span><span class="op" id="8035688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035691">res</span><span class="op" id="8035694">,</span>&nbsp;<span class="ident" id="8035696">err</span>&nbsp;<span class="op" id="8035700">:=</span>&nbsp;<span class="ident" id="8035703">ReadResponse</span><span class="op" id="8035715">(</span><span class="ident" id="8035716">br</span><span class="op" id="8035718">,</span>&nbsp;<span class="op" id="8035720">&amp;</span><span class="ident" id="8035721">Request</span><span class="op" id="8035728">{</span><span class="ident" id="8035729">Method</span><span class="op" id="8035735">:</span>&nbsp;<span class="string" id="8035737">&#34;GET&#34;</span><span class="op" id="8035742">}</span><span class="op" id="8035743">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8035746">if</span>&nbsp;<span class="ident" id="8035749">err</span>&nbsp;<span class="op" id="8035753">!=</span>&nbsp;<span class="ident" id="8035756">nil</span>&nbsp;<span class="op" id="8035760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035764">t</span><span class="op" id="8035765">.</span><span class="ident" id="8035766">Fatal</span><span class="op" id="8035771">(</span><span class="ident" id="8035772">err</span><span class="op" id="8035775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8035778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8035781">if</span>&nbsp;<span class="ident" id="8035784">res</span><span class="op" id="8035787">.</span><span class="ident" id="8035788">ContentLength</span>&nbsp;<span class="op" id="8035802">!=</span>&nbsp;<span class="num" id="8035805">123</span>&nbsp;<span class="op" id="8035809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035813">t</span><span class="op" id="8035814">.</span><span class="ident" id="8035815">Fatalf</span><span class="op" id="8035821">(</span><span class="string" id="8035822">&#34;Content-Length&nbsp;=&nbsp;%d;&nbsp;want&nbsp;123&#34;</span><span class="op" id="8035853">,</span>&nbsp;<span class="ident" id="8035855">res</span><span class="op" id="8035858">.</span><span class="ident" id="8035859">ContentLength</span><span class="op" id="8035872">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8035875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8035878">var</span>&nbsp;<span class="ident" id="8035882">buf</span>&nbsp;<span class="ident" id="8035886">bytes</span><span class="op" id="8035891">.</span><span class="ident" id="8035892">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035900">n</span><span class="op" id="8035901">,</span>&nbsp;<span class="ident" id="8035903">err</span>&nbsp;<span class="op" id="8035907">:=</span>&nbsp;<span class="ident" id="8035910">io</span><span class="op" id="8035912">.</span><span class="ident" id="8035913">Copy</span><span class="op" id="8035917">(</span><span class="op" id="8035918">&amp;</span><span class="ident" id="8035919">buf</span><span class="op" id="8035922">,</span>&nbsp;<span class="ident" id="8035924">res</span><span class="op" id="8035927">.</span><span class="ident" id="8035928">Body</span><span class="op" id="8035932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8035935">if</span>&nbsp;<span class="ident" id="8035938">n</span>&nbsp;<span class="op" id="8035940">!=</span>&nbsp;<span class="ident" id="8035943">int64</span><span class="op" id="8035948">(</span><span class="builtinfunc" id="8035949">len</span><span class="op" id="8035952">(</span><span class="ident" id="8035953">shortBody</span><span class="op" id="8035962">)</span><span class="op" id="8035963">)</span>&nbsp;<span class="op" id="8035965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8035969">t</span><span class="op" id="8035970">.</span><span class="ident" id="8035971">Errorf</span><span class="op" id="8035977">(</span><span class="string" id="8035978">&#34;Copied&nbsp;%d&nbsp;bytes;&nbsp;want&nbsp;%d,&nbsp;len(%q)&#34;</span><span class="op" id="8036013">,</span>&nbsp;<span class="ident" id="8036015">n</span><span class="op" id="8036016">,</span>&nbsp;<span class="builtinfunc" id="8036018">len</span><span class="op" id="8036021">(</span><span class="ident" id="8036022">shortBody</span><span class="op" id="8036031">)</span><span class="op" id="8036032">,</span>&nbsp;<span class="ident" id="8036034">shortBody</span><span class="op" id="8036043">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8036046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8036049">if</span>&nbsp;<span class="ident" id="8036052">buf</span><span class="op" id="8036055">.</span><span class="ident" id="8036056">String</span><span class="op" id="8036062">(</span><span class="op" id="8036063">)</span>&nbsp;<span class="op" id="8036065">!=</span>&nbsp;<span class="ident" id="8036068">shortBody</span>&nbsp;<span class="op" id="8036078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8036082">t</span><span class="op" id="8036083">.</span><span class="ident" id="8036084">Errorf</span><span class="op" id="8036090">(</span><span class="string" id="8036091">&#34;Read&nbsp;body&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8036114">,</span>&nbsp;<span class="ident" id="8036116">buf</span><span class="op" id="8036119">.</span><span class="ident" id="8036120">String</span><span class="op" id="8036126">(</span><span class="op" id="8036127">)</span><span class="op" id="8036128">,</span>&nbsp;<span class="ident" id="8036130">shortBody</span><span class="op" id="8036139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8036142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8036145">if</span>&nbsp;<span class="ident" id="8036148">err</span>&nbsp;<span class="op" id="8036152">!=</span>&nbsp;<span class="ident" id="8036155">io</span><span class="op" id="8036157">.</span><span class="ident" id="8036158">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="8036175">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8036179">t</span><span class="op" id="8036180">.</span><span class="ident" id="8036181">Errorf</span><span class="op" id="8036187">(</span><span class="string" id="8036188">&#34;io.Copy&nbsp;error&nbsp;=&nbsp;%#v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="8036235">,</span>&nbsp;<span class="ident" id="8036237">err</span><span class="op" id="8036240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8036243">}</span><br>
<span class="lineno"></span><span class="op" id="8036245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8036248">func</span>&nbsp;<span class="ident" id="8036253">TestReadResponseUnexpectedEOF</span><span class="op" id="8036282">(</span><span class="ident" id="8036283">t</span>&nbsp;<span class="op" id="8036285">*</span><span class="ident" id="8036286">testing</span><span class="op" id="8036293">.</span><span class="ident" id="8036294">T</span><span class="op" id="8036295">)</span>&nbsp;<span class="op" id="8036297">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8036300">br</span>&nbsp;<span class="op" id="8036303">:=</span>&nbsp;<span class="ident" id="8036306">bufio</span><span class="op" id="8036311">.</span><span class="ident" id="8036312">NewReader</span><span class="op" id="8036321">(</span><span class="ident" id="8036322">strings</span><span class="op" id="8036329">.</span><span class="ident" id="8036330">NewReader</span><span class="op" id="8036339">(</span><span class="string" id="8036340">&#34;HTTP/1.1&nbsp;301&nbsp;Moved&nbsp;Permanently\r\n&#34;</span>&nbsp;<span class="op" id="8036377">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8036381">&#34;Location:&nbsp;http://example.com&#34;</span><span class="op" id="8036411">)</span><span class="op" id="8036412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8036415">_</span><span class="op" id="8036416">,</span>&nbsp;<span class="ident" id="8036418">err</span>&nbsp;<span class="op" id="8036422">:=</span>&nbsp;<span class="ident" id="8036425">ReadResponse</span><span class="op" id="8036437">(</span><span class="ident" id="8036438">br</span><span class="op" id="8036440">,</span>&nbsp;<span class="ident" id="8036442">nil</span><span class="op" id="8036445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8036448">if</span>&nbsp;<span class="ident" id="8036451">err</span>&nbsp;<span class="op" id="8036455">!=</span>&nbsp;<span class="ident" id="8036458">io</span><span class="op" id="8036460">.</span><span class="ident" id="8036461">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="8036478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8036482">t</span><span class="op" id="8036483">.</span><span class="ident" id="8036484">Errorf</span><span class="op" id="8036490">(</span><span class="string" id="8036491">&#34;ReadResponse&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="8036536">,</span>&nbsp;<span class="ident" id="8036538">err</span><span class="op" id="8036541">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8036544">}</span><br>
<span class="lineno"></span><span class="op" id="8036546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8036549">func</span>&nbsp;<span class="ident" id="8036554">TestNeedsSniff</span><span class="op" id="8036568">(</span><span class="ident" id="8036569">t</span>&nbsp;<span class="op" id="8036571">*</span><span class="ident" id="8036572">testing</span><span class="op" id="8036579">.</span><span class="ident" id="8036580">T</span><span class="op" id="8036581">)</span>&nbsp;<span class="op" id="8036583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8036586">//&nbsp;needsSniff&nbsp;returns&nbsp;true&nbsp;with&nbsp;an&nbsp;empty&nbsp;response.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8036638">r</span>&nbsp;<span class="op" id="8036640">:=</span>&nbsp;<span class="op" id="8036643">&amp;</span><span class="ident" id="8036644">response</span><span class="op" id="8036652">{</span><span class="op" id="8036653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8036656">if</span>&nbsp;<span class="ident" id="8036659">got</span><span class="op" id="8036662">,</span>&nbsp;<span class="ident" id="8036664">want</span>&nbsp;<span class="op" id="8036669">:=</span>&nbsp;<span class="ident" id="8036672">r</span><span class="op" id="8036673">.</span><span class="ident" id="8036674">needsSniff</span><span class="op" id="8036684">(</span><span class="op" id="8036685">)</span><span class="op" id="8036686">,</span>&nbsp;<span class="ident" id="8036688">true</span><span class="op" id="8036692">;</span>&nbsp;<span class="ident" id="8036694">got</span>&nbsp;<span class="op" id="8036698">!=</span>&nbsp;<span class="ident" id="8036701">want</span>&nbsp;<span class="op" id="8036706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8036710">t</span><span class="op" id="8036711">.</span><span class="ident" id="8036712">Errorf</span><span class="op" id="8036718">(</span><span class="string" id="8036719">&#34;needsSniff&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="8036745">,</span>&nbsp;<span class="ident" id="8036747">got</span><span class="op" id="8036750">,</span>&nbsp;<span class="ident" id="8036752">want</span><span class="op" id="8036756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8036759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8036762">//&nbsp;needsSniff&nbsp;returns&nbsp;false&nbsp;when&nbsp;Content-Type&nbsp;=&nbsp;nil.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8036816">r</span><span class="op" id="8036817">.</span><span class="ident" id="8036818">handlerHeader</span>&nbsp;<span class="op" id="8036832">=</span>&nbsp;<span class="ident" id="8036834">Header</span><span class="op" id="8036840">{</span><span class="string" id="8036841">&#34;Content-Type&#34;</span><span class="op" id="8036855">:</span>&nbsp;<span class="ident" id="8036857">nil</span><span class="op" id="8036860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8036863">if</span>&nbsp;<span class="ident" id="8036866">got</span><span class="op" id="8036869">,</span>&nbsp;<span class="ident" id="8036871">want</span>&nbsp;<span class="op" id="8036876">:=</span>&nbsp;<span class="ident" id="8036879">r</span><span class="op" id="8036880">.</span><span class="ident" id="8036881">needsSniff</span><span class="op" id="8036891">(</span><span class="op" id="8036892">)</span><span class="op" id="8036893">,</span>&nbsp;<span class="ident" id="8036895">false</span><span class="op" id="8036900">;</span>&nbsp;<span class="ident" id="8036902">got</span>&nbsp;<span class="op" id="8036906">!=</span>&nbsp;<span class="ident" id="8036909">want</span>&nbsp;<span class="op" id="8036914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8036918">t</span><span class="op" id="8036919">.</span><span class="ident" id="8036920">Errorf</span><span class="op" id="8036926">(</span><span class="string" id="8036927">&#34;needsSniff&nbsp;empty&nbsp;Content-Type&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="8036972">,</span>&nbsp;<span class="ident" id="8036974">got</span><span class="op" id="8036977">,</span>&nbsp;<span class="ident" id="8036979">want</span><span class="op" id="8036983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8036986">}</span><br>
<span class="lineno"></span><span class="op" id="8036988">}</span>
</div>
</body>
</html>
