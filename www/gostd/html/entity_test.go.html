<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html</h2>
<ul>
<li><a href="/gostd/html/entity.go.html">entity.go</a></li>
<li><a href="/gostd/html/entity_test.go.html">entity_test.go</a></li>
<li><a href="/gostd/html/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/escape_test.go.html">escape_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7388314">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7388369">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7388423">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7388474">package</span>&nbsp;<span class="ident" id="7388482">html</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7388488">import</span>&nbsp;<span class="op" id="7388495">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7388498">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7388509">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7388524">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7388527">func</span>&nbsp;<span class="ident" id="7388532">TestEntityLength</span><span class="op" id="7388548">(</span><span class="ident" id="7388549">t</span>&nbsp;<span class="op" id="7388551">*</span><span class="ident" id="7388552">testing</span><span class="op" id="7388559">.</span><span class="ident" id="7388560">T</span><span class="op" id="7388561">)</span>&nbsp;<span class="op" id="7388563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7388566">//&nbsp;We&nbsp;verify&nbsp;that&nbsp;the&nbsp;length&nbsp;of&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;each&nbsp;value&nbsp;is&nbsp;&lt;=&nbsp;1&nbsp;+&nbsp;len(key).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7388648">//&nbsp;The&nbsp;+1&nbsp;comes&nbsp;from&nbsp;the&nbsp;leading&nbsp;&#34;&amp;&#34;.&nbsp;This&nbsp;property&nbsp;implies&nbsp;that&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7388728">//&nbsp;unescaped&nbsp;text&nbsp;is&nbsp;&lt;=&nbsp;the&nbsp;length&nbsp;of&nbsp;escaped&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7388781">for</span>&nbsp;<span class="ident" id="7388785">k</span><span class="op" id="7388786">,</span>&nbsp;<span class="ident" id="7388788">v</span>&nbsp;<span class="op" id="7388790">:=</span>&nbsp;<span class="keyword" id="7388793">range</span>&nbsp;<span class="ident" id="7388799">entity</span>&nbsp;<span class="op" id="7388806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7388810">if</span>&nbsp;<span class="num" id="7388813">1</span><span class="op" id="7388814">+</span><span class="builtinfunc" id="7388815">len</span><span class="op" id="7388818">(</span><span class="ident" id="7388819">k</span><span class="op" id="7388820">)</span>&nbsp;<span class="op" id="7388822">&lt;</span>&nbsp;<span class="ident" id="7388824">utf8</span><span class="op" id="7388828">.</span><span class="ident" id="7388829">RuneLen</span><span class="op" id="7388836">(</span><span class="ident" id="7388837">v</span><span class="op" id="7388838">)</span>&nbsp;<span class="op" id="7388840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7388845">t</span><span class="op" id="7388846">.</span><span class="ident" id="7388847">Error</span><span class="op" id="7388852">(</span><span class="string" id="7388853">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="7388872">+</span>&nbsp;<span class="ident" id="7388874">k</span>&nbsp;<span class="op" id="7388876">+</span>&nbsp;<span class="string" id="7388878">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="7388917">+</span>&nbsp;<span class="builtintype" id="7388919">string</span><span class="op" id="7388925">(</span><span class="ident" id="7388926">v</span><span class="op" id="7388927">)</span><span class="op" id="7388928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7388932">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7388936">if</span>&nbsp;<span class="builtinfunc" id="7388939">len</span><span class="op" id="7388942">(</span><span class="ident" id="7388943">k</span><span class="op" id="7388944">)</span>&nbsp;<span class="op" id="7388946">&gt;</span>&nbsp;<span class="ident" id="7388948">longestEntityWithoutSemicolon</span>&nbsp;<span class="op" id="7388978">&amp;&amp;</span>&nbsp;<span class="ident" id="7388981">k</span><span class="op" id="7388982">[</span><span class="builtinfunc" id="7388983">len</span><span class="op" id="7388986">(</span><span class="ident" id="7388987">k</span><span class="op" id="7388988">)</span><span class="op" id="7388989">-</span><span class="num" id="7388990">1</span><span class="op" id="7388991">]</span>&nbsp;<span class="op" id="7388993">!=</span>&nbsp;<span class="string" id="7388996">&#39;;&#39;</span>&nbsp;<span class="op" id="7389000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7389005">t</span><span class="op" id="7389006">.</span><span class="ident" id="7389007">Errorf</span><span class="op" id="7389013">(</span><span class="string" id="7389014">&#34;entity&nbsp;name&nbsp;%s&nbsp;is&nbsp;%d&nbsp;characters,&nbsp;but&nbsp;longestEntityWithoutSemicolon=%d&#34;</span><span class="op" id="7389085">,</span>&nbsp;<span class="ident" id="7389087">k</span><span class="op" id="7389088">,</span>&nbsp;<span class="builtinfunc" id="7389090">len</span><span class="op" id="7389093">(</span><span class="ident" id="7389094">k</span><span class="op" id="7389095">)</span><span class="op" id="7389096">,</span>&nbsp;<span class="ident" id="7389098">longestEntityWithoutSemicolon</span><span class="op" id="7389127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7389131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7389134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7389137">for</span>&nbsp;<span class="ident" id="7389141">k</span><span class="op" id="7389142">,</span>&nbsp;<span class="ident" id="7389144">v</span>&nbsp;<span class="op" id="7389146">:=</span>&nbsp;<span class="keyword" id="7389149">range</span>&nbsp;<span class="ident" id="7389155">entity2</span>&nbsp;<span class="op" id="7389163">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7389167">if</span>&nbsp;<span class="num" id="7389170">1</span><span class="op" id="7389171">+</span><span class="builtinfunc" id="7389172">len</span><span class="op" id="7389175">(</span><span class="ident" id="7389176">k</span><span class="op" id="7389177">)</span>&nbsp;<span class="op" id="7389179">&lt;</span>&nbsp;<span class="ident" id="7389181">utf8</span><span class="op" id="7389185">.</span><span class="ident" id="7389186">RuneLen</span><span class="op" id="7389193">(</span><span class="ident" id="7389194">v</span><span class="op" id="7389195">[</span><span class="num" id="7389196">0</span><span class="op" id="7389197">]</span><span class="op" id="7389198">)</span><span class="op" id="7389199">+</span><span class="ident" id="7389200">utf8</span><span class="op" id="7389204">.</span><span class="ident" id="7389205">RuneLen</span><span class="op" id="7389212">(</span><span class="ident" id="7389213">v</span><span class="op" id="7389214">[</span><span class="num" id="7389215">1</span><span class="op" id="7389216">]</span><span class="op" id="7389217">)</span>&nbsp;<span class="op" id="7389219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7389224">t</span><span class="op" id="7389225">.</span><span class="ident" id="7389226">Error</span><span class="op" id="7389231">(</span><span class="string" id="7389232">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="7389251">+</span>&nbsp;<span class="ident" id="7389253">k</span>&nbsp;<span class="op" id="7389255">+</span>&nbsp;<span class="string" id="7389257">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="7389296">+</span>&nbsp;<span class="builtintype" id="7389298">string</span><span class="op" id="7389304">(</span><span class="ident" id="7389305">v</span><span class="op" id="7389306">[</span><span class="num" id="7389307">0</span><span class="op" id="7389308">]</span><span class="op" id="7389309">)</span>&nbsp;<span class="op" id="7389311">+</span>&nbsp;<span class="builtintype" id="7389313">string</span><span class="op" id="7389319">(</span><span class="ident" id="7389320">v</span><span class="op" id="7389321">[</span><span class="num" id="7389322">1</span><span class="op" id="7389323">]</span><span class="op" id="7389324">)</span><span class="op" id="7389325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7389329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7389332">}</span><br>
<span class="lineno"></span><span class="op" id="7389334">}</span>
</div>
</body>
</html>
