<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3201817">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3201872">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3201926">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3201977">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="3202005">//</span><br>
<span class="lineno"></span><span class="comment" id="3202008">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3202068">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3202126">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="3202176">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="3202237">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3202268">package</span>&nbsp;<span class="ident" id="3202276">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3202281">import</span>&nbsp;<span class="string" id="3202288">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3202298">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="3202329">const</span>&nbsp;<span class="op" id="3202335">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202338">IPv4len</span>&nbsp;<span class="op" id="3202346">=</span>&nbsp;<span class="num" id="3202348">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202351">IPv6len</span>&nbsp;<span class="op" id="3202359">=</span>&nbsp;<span class="num" id="3202361">16</span><br>
<span class="lineno"></span><span class="op" id="3202364">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3202367">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3202418">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="3202475">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3202513">//</span><br>
<span class="lineno"></span><span class="comment" id="3202516">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3202568">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="3202620">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="3202675">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="3202730">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3202753">type</span>&nbsp;<span class="ident" id="3202758">IP</span>&nbsp;<span class="op" id="3202761">[</span><span class="op" id="3202762">]</span><span class="builtintype" id="3202763">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3202769">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="3202801">type</span>&nbsp;<span class="ident" id="3202806">IPMask</span>&nbsp;<span class="op" id="3202813">[</span><span class="op" id="3202814">]</span><span class="builtintype" id="3202815">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3202821">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="3202859">type</span>&nbsp;<span class="ident" id="3202864">IPNet</span>&nbsp;<span class="keyword" id="3202870">struct</span>&nbsp;<span class="op" id="3202877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202880">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3202885">IP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3202892">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202911">Mask</span>&nbsp;<span class="ident" id="3202916">IPMask</span>&nbsp;<span class="comment" id="3202923">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="3202939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3202942">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3202998">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="3203023">func</span>&nbsp;<span class="ident" id="3203028">IPv4</span><span class="op" id="3203032">(</span><span class="ident" id="3203033">a</span><span class="op" id="3203034">,</span>&nbsp;<span class="ident" id="3203036">b</span><span class="op" id="3203037">,</span>&nbsp;<span class="ident" id="3203039">c</span><span class="op" id="3203040">,</span>&nbsp;<span class="ident" id="3203042">d</span>&nbsp;<span class="builtintype" id="3203044">byte</span><span class="op" id="3203048">)</span>&nbsp;<span class="ident" id="3203050">IP</span>&nbsp;<span class="op" id="3203053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203056">p</span>&nbsp;<span class="op" id="3203058">:=</span>&nbsp;<span class="builtinfunc" id="3203061">make</span><span class="op" id="3203065">(</span><span class="ident" id="3203066">IP</span><span class="op" id="3203068">,</span>&nbsp;<span class="ident" id="3203070">IPv6len</span><span class="op" id="3203077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3203080">copy</span><span class="op" id="3203084">(</span><span class="ident" id="3203085">p</span><span class="op" id="3203086">,</span>&nbsp;<span class="ident" id="3203088">v4InV6Prefix</span><span class="op" id="3203100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203103">p</span><span class="op" id="3203104">[</span><span class="num" id="3203105">12</span><span class="op" id="3203107">]</span>&nbsp;<span class="op" id="3203109">=</span>&nbsp;<span class="ident" id="3203111">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203114">p</span><span class="op" id="3203115">[</span><span class="num" id="3203116">13</span><span class="op" id="3203118">]</span>&nbsp;<span class="op" id="3203120">=</span>&nbsp;<span class="ident" id="3203122">b</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203125">p</span><span class="op" id="3203126">[</span><span class="num" id="3203127">14</span><span class="op" id="3203129">]</span>&nbsp;<span class="op" id="3203131">=</span>&nbsp;<span class="ident" id="3203133">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203136">p</span><span class="op" id="3203137">[</span><span class="num" id="3203138">15</span><span class="op" id="3203140">]</span>&nbsp;<span class="op" id="3203142">=</span>&nbsp;<span class="ident" id="3203144">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203147">return</span>&nbsp;<span class="ident" id="3203154">p</span><br>
<span class="lineno"></span><span class="op" id="3203156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3203159">var</span>&nbsp;<span class="ident" id="3203163">v4InV6Prefix</span>&nbsp;<span class="op" id="3203176">=</span>&nbsp;<span class="op" id="3203178">[</span><span class="op" id="3203179">]</span><span class="builtintype" id="3203180">byte</span><span class="op" id="3203184">{</span><span class="num" id="3203185">0</span><span class="op" id="3203186">,</span>&nbsp;<span class="num" id="3203188">0</span><span class="op" id="3203189">,</span>&nbsp;<span class="num" id="3203191">0</span><span class="op" id="3203192">,</span>&nbsp;<span class="num" id="3203194">0</span><span class="op" id="3203195">,</span>&nbsp;<span class="num" id="3203197">0</span><span class="op" id="3203198">,</span>&nbsp;<span class="num" id="3203200">0</span><span class="op" id="3203201">,</span>&nbsp;<span class="num" id="3203203">0</span><span class="op" id="3203204">,</span>&nbsp;<span class="num" id="3203206">0</span><span class="op" id="3203207">,</span>&nbsp;<span class="num" id="3203209">0</span><span class="op" id="3203210">,</span>&nbsp;<span class="num" id="3203212">0</span><span class="op" id="3203213">,</span>&nbsp;<span class="num" id="3203215">0xff</span><span class="op" id="3203219">,</span>&nbsp;<span class="num" id="3203221">0xff</span><span class="op" id="3203225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3203228">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3203284">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="3203306">func</span>&nbsp;<span class="ident" id="3203311">IPv4Mask</span><span class="op" id="3203319">(</span><span class="ident" id="3203320">a</span><span class="op" id="3203321">,</span>&nbsp;<span class="ident" id="3203323">b</span><span class="op" id="3203324">,</span>&nbsp;<span class="ident" id="3203326">c</span><span class="op" id="3203327">,</span>&nbsp;<span class="ident" id="3203329">d</span>&nbsp;<span class="builtintype" id="3203331">byte</span><span class="op" id="3203335">)</span>&nbsp;<span class="ident" id="3203337">IPMask</span>&nbsp;<span class="op" id="3203344">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203347">p</span>&nbsp;<span class="op" id="3203349">:=</span>&nbsp;<span class="builtinfunc" id="3203352">make</span><span class="op" id="3203356">(</span><span class="ident" id="3203357">IPMask</span><span class="op" id="3203363">,</span>&nbsp;<span class="ident" id="3203365">IPv4len</span><span class="op" id="3203372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203375">p</span><span class="op" id="3203376">[</span><span class="num" id="3203377">0</span><span class="op" id="3203378">]</span>&nbsp;<span class="op" id="3203380">=</span>&nbsp;<span class="ident" id="3203382">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203385">p</span><span class="op" id="3203386">[</span><span class="num" id="3203387">1</span><span class="op" id="3203388">]</span>&nbsp;<span class="op" id="3203390">=</span>&nbsp;<span class="ident" id="3203392">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203395">p</span><span class="op" id="3203396">[</span><span class="num" id="3203397">2</span><span class="op" id="3203398">]</span>&nbsp;<span class="op" id="3203400">=</span>&nbsp;<span class="ident" id="3203402">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203405">p</span><span class="op" id="3203406">[</span><span class="num" id="3203407">3</span><span class="op" id="3203408">]</span>&nbsp;<span class="op" id="3203410">=</span>&nbsp;<span class="ident" id="3203412">d</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203415">return</span>&nbsp;<span class="ident" id="3203422">p</span><br>
<span class="lineno"></span><span class="op" id="3203424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3203427">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="3203485">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="3203540">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="3203608">func</span>&nbsp;<span class="ident" id="3203613">CIDRMask</span><span class="op" id="3203621">(</span><span class="ident" id="3203622">ones</span><span class="op" id="3203626">,</span>&nbsp;<span class="ident" id="3203628">bits</span>&nbsp;<span class="builtintype" id="3203633">int</span><span class="op" id="3203636">)</span>&nbsp;<span class="ident" id="3203638">IPMask</span>&nbsp;<span class="op" id="3203645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203648">if</span>&nbsp;<span class="ident" id="3203651">bits</span>&nbsp;<span class="op" id="3203656">!=</span>&nbsp;<span class="num" id="3203659">8</span><span class="op" id="3203660">*</span><span class="ident" id="3203661">IPv4len</span>&nbsp;<span class="op" id="3203669">&amp;&amp;</span>&nbsp;<span class="ident" id="3203672">bits</span>&nbsp;<span class="op" id="3203677">!=</span>&nbsp;<span class="num" id="3203680">8</span><span class="op" id="3203681">*</span><span class="ident" id="3203682">IPv6len</span>&nbsp;<span class="op" id="3203690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203694">return</span>&nbsp;<span class="ident" id="3203701">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3203706">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203709">if</span>&nbsp;<span class="ident" id="3203712">ones</span>&nbsp;<span class="op" id="3203717">&lt;</span>&nbsp;<span class="num" id="3203719">0</span>&nbsp;<span class="op" id="3203721">||</span>&nbsp;<span class="ident" id="3203724">ones</span>&nbsp;<span class="op" id="3203729">&gt;</span>&nbsp;<span class="ident" id="3203731">bits</span>&nbsp;<span class="op" id="3203736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203740">return</span>&nbsp;<span class="ident" id="3203747">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3203752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203755">l</span>&nbsp;<span class="op" id="3203757">:=</span>&nbsp;<span class="ident" id="3203760">bits</span>&nbsp;<span class="op" id="3203765">/</span>&nbsp;<span class="num" id="3203767">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203770">m</span>&nbsp;<span class="op" id="3203772">:=</span>&nbsp;<span class="builtinfunc" id="3203775">make</span><span class="op" id="3203779">(</span><span class="ident" id="3203780">IPMask</span><span class="op" id="3203786">,</span>&nbsp;<span class="ident" id="3203788">l</span><span class="op" id="3203789">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203792">n</span>&nbsp;<span class="op" id="3203794">:=</span>&nbsp;<span class="builtintype" id="3203797">uint</span><span class="op" id="3203801">(</span><span class="ident" id="3203802">ones</span><span class="op" id="3203806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203809">for</span>&nbsp;<span class="ident" id="3203813">i</span>&nbsp;<span class="op" id="3203815">:=</span>&nbsp;<span class="num" id="3203818">0</span><span class="op" id="3203819">;</span>&nbsp;<span class="ident" id="3203821">i</span>&nbsp;<span class="op" id="3203823">&lt;</span>&nbsp;<span class="ident" id="3203825">l</span><span class="op" id="3203826">;</span>&nbsp;<span class="ident" id="3203828">i</span><span class="op" id="3203829">++</span>&nbsp;<span class="op" id="3203832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203836">if</span>&nbsp;<span class="ident" id="3203839">n</span>&nbsp;<span class="op" id="3203841">&gt;=</span>&nbsp;<span class="num" id="3203844">8</span>&nbsp;<span class="op" id="3203846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203851">m</span><span class="op" id="3203852">[</span><span class="ident" id="3203853">i</span><span class="op" id="3203854">]</span>&nbsp;<span class="op" id="3203856">=</span>&nbsp;<span class="num" id="3203858">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203866">n</span>&nbsp;<span class="op" id="3203868">-=</span>&nbsp;<span class="num" id="3203871">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203876">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3203887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203891">m</span><span class="op" id="3203892">[</span><span class="ident" id="3203893">i</span><span class="op" id="3203894">]</span>&nbsp;<span class="op" id="3203896">=</span>&nbsp;<span class="op" id="3203898">^</span><span class="builtintype" id="3203899">byte</span><span class="op" id="3203903">(</span><span class="num" id="3203904">0xff</span>&nbsp;<span class="op" id="3203909">&gt;&gt;</span>&nbsp;<span class="ident" id="3203912">n</span><span class="op" id="3203913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203917">n</span>&nbsp;<span class="op" id="3203919">=</span>&nbsp;<span class="num" id="3203921">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3203924">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3203927">return</span>&nbsp;<span class="ident" id="3203934">m</span><br>
<span class="lineno"></span><span class="op" id="3203936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3203939">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3203968">var</span>&nbsp;<span class="op" id="3203972">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203975">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3203989">=</span>&nbsp;<span class="ident" id="3203991">IPv4</span><span class="op" id="3203995">(</span><span class="num" id="3203996">255</span><span class="op" id="3203999">,</span>&nbsp;<span class="num" id="3204001">255</span><span class="op" id="3204004">,</span>&nbsp;<span class="num" id="3204006">255</span><span class="op" id="3204009">,</span>&nbsp;<span class="num" id="3204011">255</span><span class="op" id="3204014">)</span>&nbsp;<span class="comment" id="3204016">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204030">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3204044">=</span>&nbsp;<span class="ident" id="3204046">IPv4</span><span class="op" id="3204050">(</span><span class="num" id="3204051">224</span><span class="op" id="3204054">,</span>&nbsp;<span class="num" id="3204056">0</span><span class="op" id="3204057">,</span>&nbsp;<span class="num" id="3204059">0</span><span class="op" id="3204060">,</span>&nbsp;<span class="num" id="3204062">1</span><span class="op" id="3204063">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3204071">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204087">IPv4allrouter</span>&nbsp;<span class="op" id="3204101">=</span>&nbsp;<span class="ident" id="3204103">IPv4</span><span class="op" id="3204107">(</span><span class="num" id="3204108">224</span><span class="op" id="3204111">,</span>&nbsp;<span class="num" id="3204113">0</span><span class="op" id="3204114">,</span>&nbsp;<span class="num" id="3204116">0</span><span class="op" id="3204117">,</span>&nbsp;<span class="num" id="3204119">2</span><span class="op" id="3204120">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3204128">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204144">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3204158">=</span>&nbsp;<span class="ident" id="3204160">IPv4</span><span class="op" id="3204164">(</span><span class="num" id="3204165">0</span><span class="op" id="3204166">,</span>&nbsp;<span class="num" id="3204168">0</span><span class="op" id="3204169">,</span>&nbsp;<span class="num" id="3204171">0</span><span class="op" id="3204172">,</span>&nbsp;<span class="num" id="3204174">0</span><span class="op" id="3204175">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3204185">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="3204198">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3204201">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3204230">var</span>&nbsp;<span class="op" id="3204234">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204237">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3204264">=</span>&nbsp;<span class="ident" id="3204266">IP</span><span class="op" id="3204268">{</span><span class="num" id="3204269">0</span><span class="op" id="3204270">,</span>&nbsp;<span class="num" id="3204272">0</span><span class="op" id="3204273">,</span>&nbsp;<span class="num" id="3204275">0</span><span class="op" id="3204276">,</span>&nbsp;<span class="num" id="3204278">0</span><span class="op" id="3204279">,</span>&nbsp;<span class="num" id="3204281">0</span><span class="op" id="3204282">,</span>&nbsp;<span class="num" id="3204284">0</span><span class="op" id="3204285">,</span>&nbsp;<span class="num" id="3204287">0</span><span class="op" id="3204288">,</span>&nbsp;<span class="num" id="3204290">0</span><span class="op" id="3204291">,</span>&nbsp;<span class="num" id="3204293">0</span><span class="op" id="3204294">,</span>&nbsp;<span class="num" id="3204296">0</span><span class="op" id="3204297">,</span>&nbsp;<span class="num" id="3204299">0</span><span class="op" id="3204300">,</span>&nbsp;<span class="num" id="3204302">0</span><span class="op" id="3204303">,</span>&nbsp;<span class="num" id="3204305">0</span><span class="op" id="3204306">,</span>&nbsp;<span class="num" id="3204308">0</span><span class="op" id="3204309">,</span>&nbsp;<span class="num" id="3204311">0</span><span class="op" id="3204312">,</span>&nbsp;<span class="num" id="3204314">0</span><span class="op" id="3204315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204318">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3204345">=</span>&nbsp;<span class="ident" id="3204347">IP</span><span class="op" id="3204349">{</span><span class="num" id="3204350">0</span><span class="op" id="3204351">,</span>&nbsp;<span class="num" id="3204353">0</span><span class="op" id="3204354">,</span>&nbsp;<span class="num" id="3204356">0</span><span class="op" id="3204357">,</span>&nbsp;<span class="num" id="3204359">0</span><span class="op" id="3204360">,</span>&nbsp;<span class="num" id="3204362">0</span><span class="op" id="3204363">,</span>&nbsp;<span class="num" id="3204365">0</span><span class="op" id="3204366">,</span>&nbsp;<span class="num" id="3204368">0</span><span class="op" id="3204369">,</span>&nbsp;<span class="num" id="3204371">0</span><span class="op" id="3204372">,</span>&nbsp;<span class="num" id="3204374">0</span><span class="op" id="3204375">,</span>&nbsp;<span class="num" id="3204377">0</span><span class="op" id="3204378">,</span>&nbsp;<span class="num" id="3204380">0</span><span class="op" id="3204381">,</span>&nbsp;<span class="num" id="3204383">0</span><span class="op" id="3204384">,</span>&nbsp;<span class="num" id="3204386">0</span><span class="op" id="3204387">,</span>&nbsp;<span class="num" id="3204389">0</span><span class="op" id="3204390">,</span>&nbsp;<span class="num" id="3204392">0</span><span class="op" id="3204393">,</span>&nbsp;<span class="num" id="3204395">0</span><span class="op" id="3204396">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204399">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3204426">=</span>&nbsp;<span class="ident" id="3204428">IP</span><span class="op" id="3204430">{</span><span class="num" id="3204431">0</span><span class="op" id="3204432">,</span>&nbsp;<span class="num" id="3204434">0</span><span class="op" id="3204435">,</span>&nbsp;<span class="num" id="3204437">0</span><span class="op" id="3204438">,</span>&nbsp;<span class="num" id="3204440">0</span><span class="op" id="3204441">,</span>&nbsp;<span class="num" id="3204443">0</span><span class="op" id="3204444">,</span>&nbsp;<span class="num" id="3204446">0</span><span class="op" id="3204447">,</span>&nbsp;<span class="num" id="3204449">0</span><span class="op" id="3204450">,</span>&nbsp;<span class="num" id="3204452">0</span><span class="op" id="3204453">,</span>&nbsp;<span class="num" id="3204455">0</span><span class="op" id="3204456">,</span>&nbsp;<span class="num" id="3204458">0</span><span class="op" id="3204459">,</span>&nbsp;<span class="num" id="3204461">0</span><span class="op" id="3204462">,</span>&nbsp;<span class="num" id="3204464">0</span><span class="op" id="3204465">,</span>&nbsp;<span class="num" id="3204467">0</span><span class="op" id="3204468">,</span>&nbsp;<span class="num" id="3204470">0</span><span class="op" id="3204471">,</span>&nbsp;<span class="num" id="3204473">0</span><span class="op" id="3204474">,</span>&nbsp;<span class="num" id="3204476">1</span><span class="op" id="3204477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204480">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="3204507">=</span>&nbsp;<span class="ident" id="3204509">IP</span><span class="op" id="3204511">{</span><span class="num" id="3204512">0xff</span><span class="op" id="3204516">,</span>&nbsp;<span class="num" id="3204518">0x01</span><span class="op" id="3204522">,</span>&nbsp;<span class="num" id="3204524">0</span><span class="op" id="3204525">,</span>&nbsp;<span class="num" id="3204527">0</span><span class="op" id="3204528">,</span>&nbsp;<span class="num" id="3204530">0</span><span class="op" id="3204531">,</span>&nbsp;<span class="num" id="3204533">0</span><span class="op" id="3204534">,</span>&nbsp;<span class="num" id="3204536">0</span><span class="op" id="3204537">,</span>&nbsp;<span class="num" id="3204539">0</span><span class="op" id="3204540">,</span>&nbsp;<span class="num" id="3204542">0</span><span class="op" id="3204543">,</span>&nbsp;<span class="num" id="3204545">0</span><span class="op" id="3204546">,</span>&nbsp;<span class="num" id="3204548">0</span><span class="op" id="3204549">,</span>&nbsp;<span class="num" id="3204551">0</span><span class="op" id="3204552">,</span>&nbsp;<span class="num" id="3204554">0</span><span class="op" id="3204555">,</span>&nbsp;<span class="num" id="3204557">0</span><span class="op" id="3204558">,</span>&nbsp;<span class="num" id="3204560">0</span><span class="op" id="3204561">,</span>&nbsp;<span class="num" id="3204563">0x01</span><span class="op" id="3204567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204570">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3204597">=</span>&nbsp;<span class="ident" id="3204599">IP</span><span class="op" id="3204601">{</span><span class="num" id="3204602">0xff</span><span class="op" id="3204606">,</span>&nbsp;<span class="num" id="3204608">0x02</span><span class="op" id="3204612">,</span>&nbsp;<span class="num" id="3204614">0</span><span class="op" id="3204615">,</span>&nbsp;<span class="num" id="3204617">0</span><span class="op" id="3204618">,</span>&nbsp;<span class="num" id="3204620">0</span><span class="op" id="3204621">,</span>&nbsp;<span class="num" id="3204623">0</span><span class="op" id="3204624">,</span>&nbsp;<span class="num" id="3204626">0</span><span class="op" id="3204627">,</span>&nbsp;<span class="num" id="3204629">0</span><span class="op" id="3204630">,</span>&nbsp;<span class="num" id="3204632">0</span><span class="op" id="3204633">,</span>&nbsp;<span class="num" id="3204635">0</span><span class="op" id="3204636">,</span>&nbsp;<span class="num" id="3204638">0</span><span class="op" id="3204639">,</span>&nbsp;<span class="num" id="3204641">0</span><span class="op" id="3204642">,</span>&nbsp;<span class="num" id="3204644">0</span><span class="op" id="3204645">,</span>&nbsp;<span class="num" id="3204647">0</span><span class="op" id="3204648">,</span>&nbsp;<span class="num" id="3204650">0</span><span class="op" id="3204651">,</span>&nbsp;<span class="num" id="3204653">0x01</span><span class="op" id="3204657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204660">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3204687">=</span>&nbsp;<span class="ident" id="3204689">IP</span><span class="op" id="3204691">{</span><span class="num" id="3204692">0xff</span><span class="op" id="3204696">,</span>&nbsp;<span class="num" id="3204698">0x02</span><span class="op" id="3204702">,</span>&nbsp;<span class="num" id="3204704">0</span><span class="op" id="3204705">,</span>&nbsp;<span class="num" id="3204707">0</span><span class="op" id="3204708">,</span>&nbsp;<span class="num" id="3204710">0</span><span class="op" id="3204711">,</span>&nbsp;<span class="num" id="3204713">0</span><span class="op" id="3204714">,</span>&nbsp;<span class="num" id="3204716">0</span><span class="op" id="3204717">,</span>&nbsp;<span class="num" id="3204719">0</span><span class="op" id="3204720">,</span>&nbsp;<span class="num" id="3204722">0</span><span class="op" id="3204723">,</span>&nbsp;<span class="num" id="3204725">0</span><span class="op" id="3204726">,</span>&nbsp;<span class="num" id="3204728">0</span><span class="op" id="3204729">,</span>&nbsp;<span class="num" id="3204731">0</span><span class="op" id="3204732">,</span>&nbsp;<span class="num" id="3204734">0</span><span class="op" id="3204735">,</span>&nbsp;<span class="num" id="3204737">0</span><span class="op" id="3204738">,</span>&nbsp;<span class="num" id="3204740">0</span><span class="op" id="3204741">,</span>&nbsp;<span class="num" id="3204743">0x02</span><span class="op" id="3204747">}</span><br>
<span class="lineno"></span><span class="op" id="3204749">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3204752">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3204815">func</span>&nbsp;<span class="op" id="3204820">(</span><span class="ident" id="3204821">ip</span>&nbsp;<span class="ident" id="3204824">IP</span><span class="op" id="3204826">)</span>&nbsp;<span class="ident" id="3204828">IsUnspecified</span><span class="op" id="3204841">(</span><span class="op" id="3204842">)</span>&nbsp;<span class="builtintype" id="3204844">bool</span>&nbsp;<span class="op" id="3204849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204852">if</span>&nbsp;<span class="ident" id="3204855">ip</span><span class="op" id="3204857">.</span><span class="ident" id="3204858">Equal</span><span class="op" id="3204863">(</span><span class="ident" id="3204864">IPv4zero</span><span class="op" id="3204872">)</span>&nbsp;<span class="op" id="3204874">||</span>&nbsp;<span class="ident" id="3204877">ip</span><span class="op" id="3204879">.</span><span class="ident" id="3204880">Equal</span><span class="op" id="3204885">(</span><span class="ident" id="3204886">IPv6unspecified</span><span class="op" id="3204901">)</span>&nbsp;<span class="op" id="3204903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204907">return</span>&nbsp;<span class="builtintype" id="3204914">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204923">return</span>&nbsp;<span class="builtintype" id="3204930">false</span><br>
<span class="lineno"></span><span class="op" id="3204936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3204939">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="3204995">func</span>&nbsp;<span class="op" id="3205000">(</span><span class="ident" id="3205001">ip</span>&nbsp;<span class="ident" id="3205004">IP</span><span class="op" id="3205006">)</span>&nbsp;<span class="ident" id="3205008">IsLoopback</span><span class="op" id="3205018">(</span><span class="op" id="3205019">)</span>&nbsp;<span class="builtintype" id="3205021">bool</span>&nbsp;<span class="op" id="3205026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205029">if</span>&nbsp;<span class="ident" id="3205032">ip4</span>&nbsp;<span class="op" id="3205036">:=</span>&nbsp;<span class="ident" id="3205039">ip</span><span class="op" id="3205041">.</span><span class="ident" id="3205042">To4</span><span class="op" id="3205045">(</span><span class="op" id="3205046">)</span><span class="op" id="3205047">;</span>&nbsp;<span class="ident" id="3205049">ip4</span>&nbsp;<span class="op" id="3205053">!=</span>&nbsp;<span class="ident" id="3205056">nil</span>&nbsp;<span class="op" id="3205060">&amp;&amp;</span>&nbsp;<span class="ident" id="3205063">ip4</span><span class="op" id="3205066">[</span><span class="num" id="3205067">0</span><span class="op" id="3205068">]</span>&nbsp;<span class="op" id="3205070">==</span>&nbsp;<span class="num" id="3205073">127</span>&nbsp;<span class="op" id="3205077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205081">return</span>&nbsp;<span class="builtintype" id="3205088">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3205094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205097">return</span>&nbsp;<span class="ident" id="3205104">ip</span><span class="op" id="3205106">.</span><span class="ident" id="3205107">Equal</span><span class="op" id="3205112">(</span><span class="ident" id="3205113">IPv6loopback</span><span class="op" id="3205125">)</span><br>
<span class="lineno">125</span><span class="op" id="3205127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3205130">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3205188">func</span>&nbsp;<span class="op" id="3205193">(</span><span class="ident" id="3205194">ip</span>&nbsp;<span class="ident" id="3205197">IP</span><span class="op" id="3205199">)</span>&nbsp;<span class="ident" id="3205201">IsMulticast</span><span class="op" id="3205212">(</span><span class="op" id="3205213">)</span>&nbsp;<span class="builtintype" id="3205215">bool</span>&nbsp;<span class="op" id="3205220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205223">if</span>&nbsp;<span class="ident" id="3205226">ip4</span>&nbsp;<span class="op" id="3205230">:=</span>&nbsp;<span class="ident" id="3205233">ip</span><span class="op" id="3205235">.</span><span class="ident" id="3205236">To4</span><span class="op" id="3205239">(</span><span class="op" id="3205240">)</span><span class="op" id="3205241">;</span>&nbsp;<span class="ident" id="3205243">ip4</span>&nbsp;<span class="op" id="3205247">!=</span>&nbsp;<span class="ident" id="3205250">nil</span>&nbsp;<span class="op" id="3205254">&amp;&amp;</span>&nbsp;<span class="ident" id="3205257">ip4</span><span class="op" id="3205260">[</span><span class="num" id="3205261">0</span><span class="op" id="3205262">]</span><span class="op" id="3205263">&amp;</span><span class="num" id="3205264">0xf0</span>&nbsp;<span class="op" id="3205269">==</span>&nbsp;<span class="num" id="3205272">0xe0</span>&nbsp;<span class="op" id="3205277">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205281">return</span>&nbsp;<span class="builtintype" id="3205288">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3205294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205297">return</span>&nbsp;<span class="ident" id="3205304">ip</span><span class="op" id="3205306">[</span><span class="num" id="3205307">0</span><span class="op" id="3205308">]</span>&nbsp;<span class="op" id="3205310">==</span>&nbsp;<span class="num" id="3205313">0xff</span><br>
<span class="lineno"></span><span class="op" id="3205318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3205321">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3205376">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3205417">func</span>&nbsp;<span class="op" id="3205422">(</span><span class="ident" id="3205423">ip</span>&nbsp;<span class="ident" id="3205426">IP</span><span class="op" id="3205428">)</span>&nbsp;<span class="ident" id="3205430">IsInterfaceLocalMulticast</span><span class="op" id="3205455">(</span><span class="op" id="3205456">)</span>&nbsp;<span class="builtintype" id="3205458">bool</span>&nbsp;<span class="op" id="3205463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205466">return</span>&nbsp;<span class="builtinfunc" id="3205473">len</span><span class="op" id="3205476">(</span><span class="ident" id="3205477">ip</span><span class="op" id="3205479">)</span>&nbsp;<span class="op" id="3205481">==</span>&nbsp;<span class="ident" id="3205484">IPv6len</span>&nbsp;<span class="op" id="3205492">&amp;&amp;</span>&nbsp;<span class="ident" id="3205495">ip</span><span class="op" id="3205497">[</span><span class="num" id="3205498">0</span><span class="op" id="3205499">]</span>&nbsp;<span class="op" id="3205501">==</span>&nbsp;<span class="num" id="3205504">0xff</span>&nbsp;<span class="op" id="3205509">&amp;&amp;</span>&nbsp;<span class="ident" id="3205512">ip</span><span class="op" id="3205514">[</span><span class="num" id="3205515">1</span><span class="op" id="3205516">]</span><span class="op" id="3205517">&amp;</span><span class="num" id="3205518">0x0f</span>&nbsp;<span class="op" id="3205523">==</span>&nbsp;<span class="num" id="3205526">0x01</span><br>
<span class="lineno"></span><span class="op" id="3205531">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="3205534">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3205593">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3205615">func</span>&nbsp;<span class="op" id="3205620">(</span><span class="ident" id="3205621">ip</span>&nbsp;<span class="ident" id="3205624">IP</span><span class="op" id="3205626">)</span>&nbsp;<span class="ident" id="3205628">IsLinkLocalMulticast</span><span class="op" id="3205648">(</span><span class="op" id="3205649">)</span>&nbsp;<span class="builtintype" id="3205651">bool</span>&nbsp;<span class="op" id="3205656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205659">if</span>&nbsp;<span class="ident" id="3205662">ip4</span>&nbsp;<span class="op" id="3205666">:=</span>&nbsp;<span class="ident" id="3205669">ip</span><span class="op" id="3205671">.</span><span class="ident" id="3205672">To4</span><span class="op" id="3205675">(</span><span class="op" id="3205676">)</span><span class="op" id="3205677">;</span>&nbsp;<span class="ident" id="3205679">ip4</span>&nbsp;<span class="op" id="3205683">!=</span>&nbsp;<span class="ident" id="3205686">nil</span>&nbsp;<span class="op" id="3205690">&amp;&amp;</span>&nbsp;<span class="ident" id="3205693">ip4</span><span class="op" id="3205696">[</span><span class="num" id="3205697">0</span><span class="op" id="3205698">]</span>&nbsp;<span class="op" id="3205700">==</span>&nbsp;<span class="num" id="3205703">224</span>&nbsp;<span class="op" id="3205707">&amp;&amp;</span>&nbsp;<span class="ident" id="3205710">ip4</span><span class="op" id="3205713">[</span><span class="num" id="3205714">1</span><span class="op" id="3205715">]</span>&nbsp;<span class="op" id="3205717">==</span>&nbsp;<span class="num" id="3205720">0</span>&nbsp;<span class="op" id="3205722">&amp;&amp;</span>&nbsp;<span class="ident" id="3205725">ip4</span><span class="op" id="3205728">[</span><span class="num" id="3205729">2</span><span class="op" id="3205730">]</span>&nbsp;<span class="op" id="3205732">==</span>&nbsp;<span class="num" id="3205735">0</span>&nbsp;<span class="op" id="3205737">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205741">return</span>&nbsp;<span class="builtintype" id="3205748">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3205754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205757">return</span>&nbsp;<span class="ident" id="3205764">ip</span><span class="op" id="3205766">[</span><span class="num" id="3205767">0</span><span class="op" id="3205768">]</span>&nbsp;<span class="op" id="3205770">==</span>&nbsp;<span class="num" id="3205773">0xff</span>&nbsp;<span class="op" id="3205778">&amp;&amp;</span>&nbsp;<span class="ident" id="3205781">ip</span><span class="op" id="3205783">[</span><span class="num" id="3205784">1</span><span class="op" id="3205785">]</span><span class="op" id="3205786">&amp;</span><span class="num" id="3205787">0x0f</span>&nbsp;<span class="op" id="3205792">==</span>&nbsp;<span class="num" id="3205795">0x02</span><br>
<span class="lineno"></span><span class="op" id="3205800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="3205803">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3205860">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3205880">func</span>&nbsp;<span class="op" id="3205885">(</span><span class="ident" id="3205886">ip</span>&nbsp;<span class="ident" id="3205889">IP</span><span class="op" id="3205891">)</span>&nbsp;<span class="ident" id="3205893">IsLinkLocalUnicast</span><span class="op" id="3205911">(</span><span class="op" id="3205912">)</span>&nbsp;<span class="builtintype" id="3205914">bool</span>&nbsp;<span class="op" id="3205919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205922">if</span>&nbsp;<span class="ident" id="3205925">ip4</span>&nbsp;<span class="op" id="3205929">:=</span>&nbsp;<span class="ident" id="3205932">ip</span><span class="op" id="3205934">.</span><span class="ident" id="3205935">To4</span><span class="op" id="3205938">(</span><span class="op" id="3205939">)</span><span class="op" id="3205940">;</span>&nbsp;<span class="ident" id="3205942">ip4</span>&nbsp;<span class="op" id="3205946">!=</span>&nbsp;<span class="ident" id="3205949">nil</span>&nbsp;<span class="op" id="3205953">&amp;&amp;</span>&nbsp;<span class="ident" id="3205956">ip4</span><span class="op" id="3205959">[</span><span class="num" id="3205960">0</span><span class="op" id="3205961">]</span>&nbsp;<span class="op" id="3205963">==</span>&nbsp;<span class="num" id="3205966">169</span>&nbsp;<span class="op" id="3205970">&amp;&amp;</span>&nbsp;<span class="ident" id="3205973">ip4</span><span class="op" id="3205976">[</span><span class="num" id="3205977">1</span><span class="op" id="3205978">]</span>&nbsp;<span class="op" id="3205980">==</span>&nbsp;<span class="num" id="3205983">254</span>&nbsp;<span class="op" id="3205987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3205991">return</span>&nbsp;<span class="builtintype" id="3205998">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206007">return</span>&nbsp;<span class="ident" id="3206014">ip</span><span class="op" id="3206016">[</span><span class="num" id="3206017">0</span><span class="op" id="3206018">]</span>&nbsp;<span class="op" id="3206020">==</span>&nbsp;<span class="num" id="3206023">0xfe</span>&nbsp;<span class="op" id="3206028">&amp;&amp;</span>&nbsp;<span class="ident" id="3206031">ip</span><span class="op" id="3206033">[</span><span class="num" id="3206034">1</span><span class="op" id="3206035">]</span><span class="op" id="3206036">&amp;</span><span class="num" id="3206037">0xc0</span>&nbsp;<span class="op" id="3206042">==</span>&nbsp;<span class="num" id="3206045">0x80</span><br>
<span class="lineno"></span><span class="op" id="3206050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3206053">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="3206111">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3206123">func</span>&nbsp;<span class="op" id="3206128">(</span><span class="ident" id="3206129">ip</span>&nbsp;<span class="ident" id="3206132">IP</span><span class="op" id="3206134">)</span>&nbsp;<span class="ident" id="3206136">IsGlobalUnicast</span><span class="op" id="3206151">(</span><span class="op" id="3206152">)</span>&nbsp;<span class="builtintype" id="3206154">bool</span>&nbsp;<span class="op" id="3206159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206162">return</span>&nbsp;<span class="op" id="3206169">!</span><span class="ident" id="3206170">ip</span><span class="op" id="3206172">.</span><span class="ident" id="3206173">IsUnspecified</span><span class="op" id="3206186">(</span><span class="op" id="3206187">)</span>&nbsp;<span class="op" id="3206189">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206194">!</span><span class="ident" id="3206195">ip</span><span class="op" id="3206197">.</span><span class="ident" id="3206198">IsLoopback</span><span class="op" id="3206208">(</span><span class="op" id="3206209">)</span>&nbsp;<span class="op" id="3206211">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206216">!</span><span class="ident" id="3206217">ip</span><span class="op" id="3206219">.</span><span class="ident" id="3206220">IsMulticast</span><span class="op" id="3206231">(</span><span class="op" id="3206232">)</span>&nbsp;<span class="op" id="3206234">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206239">!</span><span class="ident" id="3206240">ip</span><span class="op" id="3206242">.</span><span class="ident" id="3206243">IsLinkLocalUnicast</span><span class="op" id="3206261">(</span><span class="op" id="3206262">)</span><br>
<span class="lineno"></span><span class="op" id="3206264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3206267">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="3206286">func</span>&nbsp;<span class="ident" id="3206291">isZeros</span><span class="op" id="3206298">(</span><span class="ident" id="3206299">p</span>&nbsp;<span class="ident" id="3206301">IP</span><span class="op" id="3206303">)</span>&nbsp;<span class="builtintype" id="3206305">bool</span>&nbsp;<span class="op" id="3206310">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206313">for</span>&nbsp;<span class="ident" id="3206317">i</span>&nbsp;<span class="op" id="3206319">:=</span>&nbsp;<span class="num" id="3206322">0</span><span class="op" id="3206323">;</span>&nbsp;<span class="ident" id="3206325">i</span>&nbsp;<span class="op" id="3206327">&lt;</span>&nbsp;<span class="builtinfunc" id="3206329">len</span><span class="op" id="3206332">(</span><span class="ident" id="3206333">p</span><span class="op" id="3206334">)</span><span class="op" id="3206335">;</span>&nbsp;<span class="ident" id="3206337">i</span><span class="op" id="3206338">++</span>&nbsp;<span class="op" id="3206341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206345">if</span>&nbsp;<span class="ident" id="3206348">p</span><span class="op" id="3206349">[</span><span class="ident" id="3206350">i</span><span class="op" id="3206351">]</span>&nbsp;<span class="op" id="3206353">!=</span>&nbsp;<span class="num" id="3206356">0</span>&nbsp;<span class="op" id="3206358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206363">return</span>&nbsp;<span class="builtintype" id="3206370">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206381">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206384">return</span>&nbsp;<span class="builtintype" id="3206391">true</span><br>
<span class="lineno"></span><span class="op" id="3206396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3206399">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3206463">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="3206513">func</span>&nbsp;<span class="op" id="3206518">(</span><span class="ident" id="3206519">ip</span>&nbsp;<span class="ident" id="3206522">IP</span><span class="op" id="3206524">)</span>&nbsp;<span class="ident" id="3206526">To4</span><span class="op" id="3206529">(</span><span class="op" id="3206530">)</span>&nbsp;<span class="ident" id="3206532">IP</span>&nbsp;<span class="op" id="3206535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206538">if</span>&nbsp;<span class="builtinfunc" id="3206541">len</span><span class="op" id="3206544">(</span><span class="ident" id="3206545">ip</span><span class="op" id="3206547">)</span>&nbsp;<span class="op" id="3206549">==</span>&nbsp;<span class="ident" id="3206552">IPv4len</span>&nbsp;<span class="op" id="3206560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206564">return</span>&nbsp;<span class="ident" id="3206571">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206578">if</span>&nbsp;<span class="builtinfunc" id="3206581">len</span><span class="op" id="3206584">(</span><span class="ident" id="3206585">ip</span><span class="op" id="3206587">)</span>&nbsp;<span class="op" id="3206589">==</span>&nbsp;<span class="ident" id="3206592">IPv6len</span>&nbsp;<span class="op" id="3206600">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206605">isZeros</span><span class="op" id="3206612">(</span><span class="ident" id="3206613">ip</span><span class="op" id="3206615">[</span><span class="num" id="3206616">0</span><span class="op" id="3206617">:</span><span class="num" id="3206618">10</span><span class="op" id="3206620">]</span><span class="op" id="3206621">)</span>&nbsp;<span class="op" id="3206623">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206628">ip</span><span class="op" id="3206630">[</span><span class="num" id="3206631">10</span><span class="op" id="3206633">]</span>&nbsp;<span class="op" id="3206635">==</span>&nbsp;<span class="num" id="3206638">0xff</span>&nbsp;<span class="op" id="3206643">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206648">ip</span><span class="op" id="3206650">[</span><span class="num" id="3206651">11</span><span class="op" id="3206653">]</span>&nbsp;<span class="op" id="3206655">==</span>&nbsp;<span class="num" id="3206658">0xff</span>&nbsp;<span class="op" id="3206663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206667">return</span>&nbsp;<span class="ident" id="3206674">ip</span><span class="op" id="3206676">[</span><span class="num" id="3206677">12</span><span class="op" id="3206679">:</span><span class="num" id="3206680">16</span><span class="op" id="3206682">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206685">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206688">return</span>&nbsp;<span class="ident" id="3206695">nil</span><br>
<span class="lineno"></span><span class="op" id="3206699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3206702">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3206766">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="3206840">func</span>&nbsp;<span class="op" id="3206845">(</span><span class="ident" id="3206846">ip</span>&nbsp;<span class="ident" id="3206849">IP</span><span class="op" id="3206851">)</span>&nbsp;<span class="ident" id="3206853">To16</span><span class="op" id="3206857">(</span><span class="op" id="3206858">)</span>&nbsp;<span class="ident" id="3206860">IP</span>&nbsp;<span class="op" id="3206863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206866">if</span>&nbsp;<span class="builtinfunc" id="3206869">len</span><span class="op" id="3206872">(</span><span class="ident" id="3206873">ip</span><span class="op" id="3206875">)</span>&nbsp;<span class="op" id="3206877">==</span>&nbsp;<span class="ident" id="3206880">IPv4len</span>&nbsp;<span class="op" id="3206888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206892">return</span>&nbsp;<span class="ident" id="3206899">IPv4</span><span class="op" id="3206903">(</span><span class="ident" id="3206904">ip</span><span class="op" id="3206906">[</span><span class="num" id="3206907">0</span><span class="op" id="3206908">]</span><span class="op" id="3206909">,</span>&nbsp;<span class="ident" id="3206911">ip</span><span class="op" id="3206913">[</span><span class="num" id="3206914">1</span><span class="op" id="3206915">]</span><span class="op" id="3206916">,</span>&nbsp;<span class="ident" id="3206918">ip</span><span class="op" id="3206920">[</span><span class="num" id="3206921">2</span><span class="op" id="3206922">]</span><span class="op" id="3206923">,</span>&nbsp;<span class="ident" id="3206925">ip</span><span class="op" id="3206927">[</span><span class="num" id="3206928">3</span><span class="op" id="3206929">]</span><span class="op" id="3206930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206936">if</span>&nbsp;<span class="builtinfunc" id="3206939">len</span><span class="op" id="3206942">(</span><span class="ident" id="3206943">ip</span><span class="op" id="3206945">)</span>&nbsp;<span class="op" id="3206947">==</span>&nbsp;<span class="ident" id="3206950">IPv6len</span>&nbsp;<span class="op" id="3206958">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206962">return</span>&nbsp;<span class="ident" id="3206969">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3206973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3206976">return</span>&nbsp;<span class="ident" id="3206983">nil</span><br>
<span class="lineno"></span><span class="op" id="3206987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3206990">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="3207023">var</span>&nbsp;<span class="op" id="3207027">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207030">classAMask</span>&nbsp;<span class="op" id="3207041">=</span>&nbsp;<span class="ident" id="3207043">IPv4Mask</span><span class="op" id="3207051">(</span><span class="num" id="3207052">0xff</span><span class="op" id="3207056">,</span>&nbsp;<span class="num" id="3207058">0</span><span class="op" id="3207059">,</span>&nbsp;<span class="num" id="3207061">0</span><span class="op" id="3207062">,</span>&nbsp;<span class="num" id="3207064">0</span><span class="op" id="3207065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207068">classBMask</span>&nbsp;<span class="op" id="3207079">=</span>&nbsp;<span class="ident" id="3207081">IPv4Mask</span><span class="op" id="3207089">(</span><span class="num" id="3207090">0xff</span><span class="op" id="3207094">,</span>&nbsp;<span class="num" id="3207096">0xff</span><span class="op" id="3207100">,</span>&nbsp;<span class="num" id="3207102">0</span><span class="op" id="3207103">,</span>&nbsp;<span class="num" id="3207105">0</span><span class="op" id="3207106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207109">classCMask</span>&nbsp;<span class="op" id="3207120">=</span>&nbsp;<span class="ident" id="3207122">IPv4Mask</span><span class="op" id="3207130">(</span><span class="num" id="3207131">0xff</span><span class="op" id="3207135">,</span>&nbsp;<span class="num" id="3207137">0xff</span><span class="op" id="3207141">,</span>&nbsp;<span class="num" id="3207143">0xff</span><span class="op" id="3207147">,</span>&nbsp;<span class="num" id="3207149">0</span><span class="op" id="3207150">)</span><br>
<span class="lineno">210</span><span class="op" id="3207152">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3207155">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3207221">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3207284">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="3207326">func</span>&nbsp;<span class="op" id="3207331">(</span><span class="ident" id="3207332">ip</span>&nbsp;<span class="ident" id="3207335">IP</span><span class="op" id="3207337">)</span>&nbsp;<span class="ident" id="3207339">DefaultMask</span><span class="op" id="3207350">(</span><span class="op" id="3207351">)</span>&nbsp;<span class="ident" id="3207353">IPMask</span>&nbsp;<span class="op" id="3207360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207363">if</span>&nbsp;<span class="ident" id="3207366">ip</span>&nbsp;<span class="op" id="3207369">=</span>&nbsp;<span class="ident" id="3207371">ip</span><span class="op" id="3207373">.</span><span class="ident" id="3207374">To4</span><span class="op" id="3207377">(</span><span class="op" id="3207378">)</span><span class="op" id="3207379">;</span>&nbsp;<span class="ident" id="3207381">ip</span>&nbsp;<span class="op" id="3207384">==</span>&nbsp;<span class="ident" id="3207387">nil</span>&nbsp;<span class="op" id="3207391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207395">return</span>&nbsp;<span class="ident" id="3207402">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3207407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207410">switch</span>&nbsp;<span class="builtintype" id="3207417">true</span>&nbsp;<span class="op" id="3207422">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207425">case</span>&nbsp;<span class="ident" id="3207430">ip</span><span class="op" id="3207432">[</span><span class="num" id="3207433">0</span><span class="op" id="3207434">]</span>&nbsp;<span class="op" id="3207436">&lt;</span>&nbsp;<span class="num" id="3207438">0x80</span><span class="op" id="3207442">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207446">return</span>&nbsp;<span class="ident" id="3207453">classAMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207465">case</span>&nbsp;<span class="ident" id="3207470">ip</span><span class="op" id="3207472">[</span><span class="num" id="3207473">0</span><span class="op" id="3207474">]</span>&nbsp;<span class="op" id="3207476">&lt;</span>&nbsp;<span class="num" id="3207478">0xC0</span><span class="op" id="3207482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207486">return</span>&nbsp;<span class="ident" id="3207493">classBMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207505">default</span><span class="op" id="3207512">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207516">return</span>&nbsp;<span class="ident" id="3207523">classCMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3207535">}</span><br>
<span class="lineno"></span><span class="op" id="3207537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3207540">func</span>&nbsp;<span class="ident" id="3207545">allFF</span><span class="op" id="3207550">(</span><span class="ident" id="3207551">b</span>&nbsp;<span class="op" id="3207553">[</span><span class="op" id="3207554">]</span><span class="builtintype" id="3207555">byte</span><span class="op" id="3207559">)</span>&nbsp;<span class="builtintype" id="3207561">bool</span>&nbsp;<span class="op" id="3207566">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207569">for</span>&nbsp;<span class="ident" id="3207573">_</span><span class="op" id="3207574">,</span>&nbsp;<span class="ident" id="3207576">c</span>&nbsp;<span class="op" id="3207578">:=</span>&nbsp;<span class="keyword" id="3207581">range</span>&nbsp;<span class="ident" id="3207587">b</span>&nbsp;<span class="op" id="3207589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207593">if</span>&nbsp;<span class="ident" id="3207596">c</span>&nbsp;<span class="op" id="3207598">!=</span>&nbsp;<span class="num" id="3207601">0xff</span>&nbsp;<span class="op" id="3207606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207611">return</span>&nbsp;<span class="builtintype" id="3207618">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3207626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3207629">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207632">return</span>&nbsp;<span class="builtintype" id="3207639">true</span><br>
<span class="lineno"></span><span class="op" id="3207644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3207647">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="3207714">func</span>&nbsp;<span class="op" id="3207719">(</span><span class="ident" id="3207720">ip</span>&nbsp;<span class="ident" id="3207723">IP</span><span class="op" id="3207725">)</span>&nbsp;<span class="ident" id="3207727">Mask</span><span class="op" id="3207731">(</span><span class="ident" id="3207732">mask</span>&nbsp;<span class="ident" id="3207737">IPMask</span><span class="op" id="3207743">)</span>&nbsp;<span class="ident" id="3207745">IP</span>&nbsp;<span class="op" id="3207748">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207751">if</span>&nbsp;<span class="builtinfunc" id="3207754">len</span><span class="op" id="3207757">(</span><span class="ident" id="3207758">mask</span><span class="op" id="3207762">)</span>&nbsp;<span class="op" id="3207764">==</span>&nbsp;<span class="ident" id="3207767">IPv6len</span>&nbsp;<span class="op" id="3207775">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3207778">len</span><span class="op" id="3207781">(</span><span class="ident" id="3207782">ip</span><span class="op" id="3207784">)</span>&nbsp;<span class="op" id="3207786">==</span>&nbsp;<span class="ident" id="3207789">IPv4len</span>&nbsp;<span class="op" id="3207797">&amp;&amp;</span>&nbsp;<span class="ident" id="3207800">allFF</span><span class="op" id="3207805">(</span><span class="ident" id="3207806">mask</span><span class="op" id="3207810">[</span><span class="op" id="3207811">:</span><span class="num" id="3207812">12</span><span class="op" id="3207814">]</span><span class="op" id="3207815">)</span>&nbsp;<span class="op" id="3207817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207821">mask</span>&nbsp;<span class="op" id="3207826">=</span>&nbsp;<span class="ident" id="3207828">mask</span><span class="op" id="3207832">[</span><span class="num" id="3207833">12</span><span class="op" id="3207835">:</span><span class="op" id="3207836">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3207839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207842">if</span>&nbsp;<span class="builtinfunc" id="3207845">len</span><span class="op" id="3207848">(</span><span class="ident" id="3207849">mask</span><span class="op" id="3207853">)</span>&nbsp;<span class="op" id="3207855">==</span>&nbsp;<span class="ident" id="3207858">IPv4len</span>&nbsp;<span class="op" id="3207866">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3207869">len</span><span class="op" id="3207872">(</span><span class="ident" id="3207873">ip</span><span class="op" id="3207875">)</span>&nbsp;<span class="op" id="3207877">==</span>&nbsp;<span class="ident" id="3207880">IPv6len</span>&nbsp;<span class="op" id="3207888">&amp;&amp;</span>&nbsp;<span class="ident" id="3207891">bytesEqual</span><span class="op" id="3207901">(</span><span class="ident" id="3207902">ip</span><span class="op" id="3207904">[</span><span class="op" id="3207905">:</span><span class="num" id="3207906">12</span><span class="op" id="3207908">]</span><span class="op" id="3207909">,</span>&nbsp;<span class="ident" id="3207911">v4InV6Prefix</span><span class="op" id="3207923">)</span>&nbsp;<span class="op" id="3207925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207929">ip</span>&nbsp;<span class="op" id="3207932">=</span>&nbsp;<span class="ident" id="3207934">ip</span><span class="op" id="3207936">[</span><span class="num" id="3207937">12</span><span class="op" id="3207939">:</span><span class="op" id="3207940">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3207943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207946">n</span>&nbsp;<span class="op" id="3207948">:=</span>&nbsp;<span class="builtinfunc" id="3207951">len</span><span class="op" id="3207954">(</span><span class="ident" id="3207955">ip</span><span class="op" id="3207957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207960">if</span>&nbsp;<span class="ident" id="3207963">n</span>&nbsp;<span class="op" id="3207965">!=</span>&nbsp;<span class="builtinfunc" id="3207968">len</span><span class="op" id="3207971">(</span><span class="ident" id="3207972">mask</span><span class="op" id="3207976">)</span>&nbsp;<span class="op" id="3207978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3207982">return</span>&nbsp;<span class="ident" id="3207989">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3207994">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3207997">out</span>&nbsp;<span class="op" id="3208001">:=</span>&nbsp;<span class="builtinfunc" id="3208004">make</span><span class="op" id="3208008">(</span><span class="ident" id="3208009">IP</span><span class="op" id="3208011">,</span>&nbsp;<span class="ident" id="3208013">n</span><span class="op" id="3208014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208017">for</span>&nbsp;<span class="ident" id="3208021">i</span>&nbsp;<span class="op" id="3208023">:=</span>&nbsp;<span class="num" id="3208026">0</span><span class="op" id="3208027">;</span>&nbsp;<span class="ident" id="3208029">i</span>&nbsp;<span class="op" id="3208031">&lt;</span>&nbsp;<span class="ident" id="3208033">n</span><span class="op" id="3208034">;</span>&nbsp;<span class="ident" id="3208036">i</span><span class="op" id="3208037">++</span>&nbsp;<span class="op" id="3208040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208044">out</span><span class="op" id="3208047">[</span><span class="ident" id="3208048">i</span><span class="op" id="3208049">]</span>&nbsp;<span class="op" id="3208051">=</span>&nbsp;<span class="ident" id="3208053">ip</span><span class="op" id="3208055">[</span><span class="ident" id="3208056">i</span><span class="op" id="3208057">]</span>&nbsp;<span class="op" id="3208059">&amp;</span>&nbsp;<span class="ident" id="3208061">mask</span><span class="op" id="3208065">[</span><span class="ident" id="3208066">i</span><span class="op" id="3208067">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208073">return</span>&nbsp;<span class="ident" id="3208080">out</span><br>
<span class="lineno">255</span><span class="op" id="3208084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3208087">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3208143">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="3208207">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="3208276">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="3208313">func</span>&nbsp;<span class="op" id="3208318">(</span><span class="ident" id="3208319">ip</span>&nbsp;<span class="ident" id="3208322">IP</span><span class="op" id="3208324">)</span>&nbsp;<span class="ident" id="3208326">String</span><span class="op" id="3208332">(</span><span class="op" id="3208333">)</span>&nbsp;<span class="builtintype" id="3208335">string</span>&nbsp;<span class="op" id="3208342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208345">p</span>&nbsp;<span class="op" id="3208347">:=</span>&nbsp;<span class="ident" id="3208350">ip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208355">if</span>&nbsp;<span class="builtinfunc" id="3208358">len</span><span class="op" id="3208361">(</span><span class="ident" id="3208362">ip</span><span class="op" id="3208364">)</span>&nbsp;<span class="op" id="3208366">==</span>&nbsp;<span class="num" id="3208369">0</span>&nbsp;<span class="op" id="3208371">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208375">return</span>&nbsp;<span class="string" id="3208382">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3208395">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208429">if</span>&nbsp;<span class="ident" id="3208432">p4</span>&nbsp;<span class="op" id="3208435">:=</span>&nbsp;<span class="ident" id="3208438">p</span><span class="op" id="3208439">.</span><span class="ident" id="3208440">To4</span><span class="op" id="3208443">(</span><span class="op" id="3208444">)</span><span class="op" id="3208445">;</span>&nbsp;<span class="builtinfunc" id="3208447">len</span><span class="op" id="3208450">(</span><span class="ident" id="3208451">p4</span><span class="op" id="3208453">)</span>&nbsp;<span class="op" id="3208455">==</span>&nbsp;<span class="ident" id="3208458">IPv4len</span>&nbsp;<span class="op" id="3208466">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208470">return</span>&nbsp;<span class="ident" id="3208477">itod</span><span class="op" id="3208481">(</span><span class="builtintype" id="3208482">uint</span><span class="op" id="3208486">(</span><span class="ident" id="3208487">p4</span><span class="op" id="3208489">[</span><span class="num" id="3208490">0</span><span class="op" id="3208491">]</span><span class="op" id="3208492">)</span><span class="op" id="3208493">)</span>&nbsp;<span class="op" id="3208495">+</span>&nbsp;<span class="string" id="3208497">&#34;.&#34;</span>&nbsp;<span class="op" id="3208501">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208506">itod</span><span class="op" id="3208510">(</span><span class="builtintype" id="3208511">uint</span><span class="op" id="3208515">(</span><span class="ident" id="3208516">p4</span><span class="op" id="3208518">[</span><span class="num" id="3208519">1</span><span class="op" id="3208520">]</span><span class="op" id="3208521">)</span><span class="op" id="3208522">)</span>&nbsp;<span class="op" id="3208524">+</span>&nbsp;<span class="string" id="3208526">&#34;.&#34;</span>&nbsp;<span class="op" id="3208530">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208535">itod</span><span class="op" id="3208539">(</span><span class="builtintype" id="3208540">uint</span><span class="op" id="3208544">(</span><span class="ident" id="3208545">p4</span><span class="op" id="3208547">[</span><span class="num" id="3208548">2</span><span class="op" id="3208549">]</span><span class="op" id="3208550">)</span><span class="op" id="3208551">)</span>&nbsp;<span class="op" id="3208553">+</span>&nbsp;<span class="string" id="3208555">&#34;.&#34;</span>&nbsp;<span class="op" id="3208559">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208564">itod</span><span class="op" id="3208568">(</span><span class="builtintype" id="3208569">uint</span><span class="op" id="3208573">(</span><span class="ident" id="3208574">p4</span><span class="op" id="3208576">[</span><span class="num" id="3208577">3</span><span class="op" id="3208578">]</span><span class="op" id="3208579">)</span><span class="op" id="3208580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208583">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208586">if</span>&nbsp;<span class="builtinfunc" id="3208589">len</span><span class="op" id="3208592">(</span><span class="ident" id="3208593">p</span><span class="op" id="3208594">)</span>&nbsp;<span class="op" id="3208596">!=</span>&nbsp;<span class="ident" id="3208599">IPv6len</span>&nbsp;<span class="op" id="3208607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208611">return</span>&nbsp;<span class="string" id="3208618">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3208627">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208658">e0</span>&nbsp;<span class="op" id="3208661">:=</span>&nbsp;<span class="op" id="3208664">-</span><span class="num" id="3208665">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208668">e1</span>&nbsp;<span class="op" id="3208671">:=</span>&nbsp;<span class="op" id="3208674">-</span><span class="num" id="3208675">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208678">for</span>&nbsp;<span class="ident" id="3208682">i</span>&nbsp;<span class="op" id="3208684">:=</span>&nbsp;<span class="num" id="3208687">0</span><span class="op" id="3208688">;</span>&nbsp;<span class="ident" id="3208690">i</span>&nbsp;<span class="op" id="3208692">&lt;</span>&nbsp;<span class="ident" id="3208694">IPv6len</span><span class="op" id="3208701">;</span>&nbsp;<span class="ident" id="3208703">i</span>&nbsp;<span class="op" id="3208705">+=</span>&nbsp;<span class="num" id="3208708">2</span>&nbsp;<span class="op" id="3208710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208714">j</span>&nbsp;<span class="op" id="3208716">:=</span>&nbsp;<span class="ident" id="3208719">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208723">for</span>&nbsp;<span class="ident" id="3208727">j</span>&nbsp;<span class="op" id="3208729">&lt;</span>&nbsp;<span class="ident" id="3208731">IPv6len</span>&nbsp;<span class="op" id="3208739">&amp;&amp;</span>&nbsp;<span class="ident" id="3208742">p</span><span class="op" id="3208743">[</span><span class="ident" id="3208744">j</span><span class="op" id="3208745">]</span>&nbsp;<span class="op" id="3208747">==</span>&nbsp;<span class="num" id="3208750">0</span>&nbsp;<span class="op" id="3208752">&amp;&amp;</span>&nbsp;<span class="ident" id="3208755">p</span><span class="op" id="3208756">[</span><span class="ident" id="3208757">j</span><span class="op" id="3208758">+</span><span class="num" id="3208759">1</span><span class="op" id="3208760">]</span>&nbsp;<span class="op" id="3208762">==</span>&nbsp;<span class="num" id="3208765">0</span>&nbsp;<span class="op" id="3208767">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208772">j</span>&nbsp;<span class="op" id="3208774">+=</span>&nbsp;<span class="num" id="3208777">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208785">if</span>&nbsp;<span class="ident" id="3208788">j</span>&nbsp;<span class="op" id="3208790">&gt;</span>&nbsp;<span class="ident" id="3208792">i</span>&nbsp;<span class="op" id="3208794">&amp;&amp;</span>&nbsp;<span class="ident" id="3208797">j</span><span class="op" id="3208798">-</span><span class="ident" id="3208799">i</span>&nbsp;<span class="op" id="3208801">&gt;</span>&nbsp;<span class="ident" id="3208803">e1</span><span class="op" id="3208805">-</span><span class="ident" id="3208806">e0</span>&nbsp;<span class="op" id="3208809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208814">e0</span>&nbsp;<span class="op" id="3208817">=</span>&nbsp;<span class="ident" id="3208819">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208824">e1</span>&nbsp;<span class="op" id="3208827">=</span>&nbsp;<span class="ident" id="3208829">j</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208834">i</span>&nbsp;<span class="op" id="3208836">=</span>&nbsp;<span class="ident" id="3208838">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3208848">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208921">if</span>&nbsp;<span class="ident" id="3208924">e1</span><span class="op" id="3208926">-</span><span class="ident" id="3208927">e0</span>&nbsp;<span class="op" id="3208930">&lt;=</span>&nbsp;<span class="num" id="3208933">2</span>&nbsp;<span class="op" id="3208935">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208939">e0</span>&nbsp;<span class="op" id="3208942">=</span>&nbsp;<span class="op" id="3208944">-</span><span class="num" id="3208945">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3208949">e1</span>&nbsp;<span class="op" id="3208952">=</span>&nbsp;<span class="op" id="3208954">-</span><span class="num" id="3208955">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3208958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3208962">const</span>&nbsp;<span class="ident" id="3208968">maxLen</span>&nbsp;<span class="op" id="3208975">=</span>&nbsp;<span class="builtinfunc" id="3208977">len</span><span class="op" id="3208980">(</span><span class="string" id="3208981">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="3209022">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3209025">b</span>&nbsp;<span class="op" id="3209027">:=</span>&nbsp;<span class="builtinfunc" id="3209030">make</span><span class="op" id="3209034">(</span><span class="op" id="3209035">[</span><span class="op" id="3209036">]</span><span class="builtintype" id="3209037">byte</span><span class="op" id="3209041">,</span>&nbsp;<span class="num" id="3209043">0</span><span class="op" id="3209044">,</span>&nbsp;<span class="ident" id="3209046">maxLen</span><span class="op" id="3209052">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3209056">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209108">for</span>&nbsp;<span class="ident" id="3209112">i</span>&nbsp;<span class="op" id="3209114">:=</span>&nbsp;<span class="num" id="3209117">0</span><span class="op" id="3209118">;</span>&nbsp;<span class="ident" id="3209120">i</span>&nbsp;<span class="op" id="3209122">&lt;</span>&nbsp;<span class="ident" id="3209124">IPv6len</span><span class="op" id="3209131">;</span>&nbsp;<span class="ident" id="3209133">i</span>&nbsp;<span class="op" id="3209135">+=</span>&nbsp;<span class="num" id="3209138">2</span>&nbsp;<span class="op" id="3209140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209144">if</span>&nbsp;<span class="ident" id="3209147">i</span>&nbsp;<span class="op" id="3209149">==</span>&nbsp;<span class="ident" id="3209152">e0</span>&nbsp;<span class="op" id="3209155">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3209160">b</span>&nbsp;<span class="op" id="3209162">=</span>&nbsp;<span class="builtinfunc" id="3209164">append</span><span class="op" id="3209170">(</span><span class="ident" id="3209171">b</span><span class="op" id="3209172">,</span>&nbsp;<span class="string" id="3209174">&#39;:&#39;</span><span class="op" id="3209177">,</span>&nbsp;<span class="string" id="3209179">&#39;:&#39;</span><span class="op" id="3209182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3209187">i</span>&nbsp;<span class="op" id="3209189">=</span>&nbsp;<span class="ident" id="3209191">e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209197">if</span>&nbsp;<span class="ident" id="3209200">i</span>&nbsp;<span class="op" id="3209202">&gt;=</span>&nbsp;<span class="ident" id="3209205">IPv6len</span>&nbsp;<span class="op" id="3209213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209219">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3209228">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3209232">}</span>&nbsp;<span class="keyword" id="3209234">else</span>&nbsp;<span class="keyword" id="3209239">if</span>&nbsp;<span class="ident" id="3209242">i</span>&nbsp;<span class="op" id="3209244">&gt;</span>&nbsp;<span class="num" id="3209246">0</span>&nbsp;<span class="op" id="3209248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3209253">b</span>&nbsp;<span class="op" id="3209255">=</span>&nbsp;<span class="builtinfunc" id="3209257">append</span><span class="op" id="3209263">(</span><span class="ident" id="3209264">b</span><span class="op" id="3209265">,</span>&nbsp;<span class="string" id="3209267">&#39;:&#39;</span><span class="op" id="3209270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3209274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3209278">b</span>&nbsp;<span class="op" id="3209280">=</span>&nbsp;<span class="ident" id="3209282">appendHex</span><span class="op" id="3209291">(</span><span class="ident" id="3209292">b</span><span class="op" id="3209293">,</span>&nbsp;<span class="op" id="3209295">(</span><span class="builtintype" id="3209296">uint32</span><span class="op" id="3209302">(</span><span class="ident" id="3209303">p</span><span class="op" id="3209304">[</span><span class="ident" id="3209305">i</span><span class="op" id="3209306">]</span><span class="op" id="3209307">)</span><span class="op" id="3209308">&lt;&lt;</span><span class="num" id="3209310">8</span><span class="op" id="3209311">)</span><span class="op" id="3209312">|</span><span class="builtintype" id="3209313">uint32</span><span class="op" id="3209319">(</span><span class="ident" id="3209320">p</span><span class="op" id="3209321">[</span><span class="ident" id="3209322">i</span><span class="op" id="3209323">+</span><span class="num" id="3209324">1</span><span class="op" id="3209325">]</span><span class="op" id="3209326">)</span><span class="op" id="3209327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3209330">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209333">return</span>&nbsp;<span class="builtintype" id="3209340">string</span><span class="op" id="3209346">(</span><span class="ident" id="3209347">b</span><span class="op" id="3209348">)</span><br>
<span class="lineno"></span><span class="op" id="3209350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3209353">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3209411">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="3209448">func</span>&nbsp;<span class="ident" id="3209453">ipEmptyString</span><span class="op" id="3209466">(</span><span class="ident" id="3209467">ip</span>&nbsp;<span class="ident" id="3209470">IP</span><span class="op" id="3209472">)</span>&nbsp;<span class="builtintype" id="3209474">string</span>&nbsp;<span class="op" id="3209481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209484">if</span>&nbsp;<span class="builtinfunc" id="3209487">len</span><span class="op" id="3209490">(</span><span class="ident" id="3209491">ip</span><span class="op" id="3209493">)</span>&nbsp;<span class="op" id="3209495">==</span>&nbsp;<span class="num" id="3209498">0</span>&nbsp;<span class="op" id="3209500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209504">return</span>&nbsp;<span class="string" id="3209511">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3209515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209518">return</span>&nbsp;<span class="ident" id="3209525">ip</span><span class="op" id="3209527">.</span><span class="ident" id="3209528">String</span><span class="op" id="3209534">(</span><span class="op" id="3209535">)</span><br>
<span class="lineno">325</span><span class="op" id="3209537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3209540">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3209604">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="3209655">func</span>&nbsp;<span class="op" id="3209660">(</span><span class="ident" id="3209661">ip</span>&nbsp;<span class="ident" id="3209664">IP</span><span class="op" id="3209666">)</span>&nbsp;<span class="ident" id="3209668">MarshalText</span><span class="op" id="3209679">(</span><span class="op" id="3209680">)</span>&nbsp;<span class="op" id="3209682">(</span><span class="op" id="3209683">[</span><span class="op" id="3209684">]</span><span class="builtintype" id="3209685">byte</span><span class="op" id="3209689">,</span>&nbsp;<span class="builtintype" id="3209691">error</span><span class="op" id="3209696">)</span>&nbsp;<span class="op" id="3209698">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209701">if</span>&nbsp;<span class="builtinfunc" id="3209704">len</span><span class="op" id="3209707">(</span><span class="ident" id="3209708">ip</span><span class="op" id="3209710">)</span>&nbsp;<span class="op" id="3209712">==</span>&nbsp;<span class="num" id="3209715">0</span>&nbsp;<span class="op" id="3209717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209721">return</span>&nbsp;<span class="op" id="3209728">[</span><span class="op" id="3209729">]</span><span class="builtintype" id="3209730">byte</span><span class="op" id="3209734">(</span><span class="string" id="3209735">&#34;&#34;</span><span class="op" id="3209737">)</span><span class="op" id="3209738">,</span>&nbsp;<span class="ident" id="3209740">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3209745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209748">if</span>&nbsp;<span class="builtinfunc" id="3209751">len</span><span class="op" id="3209754">(</span><span class="ident" id="3209755">ip</span><span class="op" id="3209757">)</span>&nbsp;<span class="op" id="3209759">!=</span>&nbsp;<span class="ident" id="3209762">IPv4len</span>&nbsp;<span class="op" id="3209770">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3209773">len</span><span class="op" id="3209776">(</span><span class="ident" id="3209777">ip</span><span class="op" id="3209779">)</span>&nbsp;<span class="op" id="3209781">!=</span>&nbsp;<span class="ident" id="3209784">IPv6len</span>&nbsp;<span class="op" id="3209792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209796">return</span>&nbsp;<span class="ident" id="3209803">nil</span><span class="op" id="3209806">,</span>&nbsp;<span class="ident" id="3209808">errors</span><span class="op" id="3209814">.</span><span class="ident" id="3209815">New</span><span class="op" id="3209818">(</span><span class="string" id="3209819">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="3209839">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3209842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3209845">return</span>&nbsp;<span class="op" id="3209852">[</span><span class="op" id="3209853">]</span><span class="builtintype" id="3209854">byte</span><span class="op" id="3209858">(</span><span class="ident" id="3209859">ip</span><span class="op" id="3209861">.</span><span class="ident" id="3209862">String</span><span class="op" id="3209868">(</span><span class="op" id="3209869">)</span><span class="op" id="3209870">)</span><span class="op" id="3209871">,</span>&nbsp;<span class="ident" id="3209873">nil</span><br>
<span class="lineno"></span><span class="op" id="3209877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3209880">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="3209948">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="3210009">func</span>&nbsp;<span class="op" id="3210014">(</span><span class="ident" id="3210015">ip</span>&nbsp;<span class="op" id="3210018">*</span><span class="ident" id="3210019">IP</span><span class="op" id="3210021">)</span>&nbsp;<span class="ident" id="3210023">UnmarshalText</span><span class="op" id="3210036">(</span><span class="ident" id="3210037">text</span>&nbsp;<span class="op" id="3210042">[</span><span class="op" id="3210043">]</span><span class="builtintype" id="3210044">byte</span><span class="op" id="3210048">)</span>&nbsp;<span class="builtintype" id="3210050">error</span>&nbsp;<span class="op" id="3210056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210059">if</span>&nbsp;<span class="builtinfunc" id="3210062">len</span><span class="op" id="3210065">(</span><span class="ident" id="3210066">text</span><span class="op" id="3210070">)</span>&nbsp;<span class="op" id="3210072">==</span>&nbsp;<span class="num" id="3210075">0</span>&nbsp;<span class="op" id="3210077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210081">*</span><span class="ident" id="3210082">ip</span>&nbsp;<span class="op" id="3210085">=</span>&nbsp;<span class="ident" id="3210087">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210093">return</span>&nbsp;<span class="ident" id="3210100">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3210108">s</span>&nbsp;<span class="op" id="3210110">:=</span>&nbsp;<span class="builtintype" id="3210113">string</span><span class="op" id="3210119">(</span><span class="ident" id="3210120">text</span><span class="op" id="3210124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3210127">x</span>&nbsp;<span class="op" id="3210129">:=</span>&nbsp;<span class="ident" id="3210132">ParseIP</span><span class="op" id="3210139">(</span><span class="ident" id="3210140">s</span><span class="op" id="3210141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210144">if</span>&nbsp;<span class="ident" id="3210147">x</span>&nbsp;<span class="op" id="3210149">==</span>&nbsp;<span class="ident" id="3210152">nil</span>&nbsp;<span class="op" id="3210156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210160">return</span>&nbsp;<span class="op" id="3210167">&amp;</span><span class="ident" id="3210168">ParseError</span><span class="op" id="3210178">{</span><span class="string" id="3210179">&#34;IP&nbsp;address&#34;</span><span class="op" id="3210191">,</span>&nbsp;<span class="ident" id="3210193">s</span><span class="op" id="3210194">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210200">*</span><span class="ident" id="3210201">ip</span>&nbsp;<span class="op" id="3210204">=</span>&nbsp;<span class="ident" id="3210206">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210209">return</span>&nbsp;<span class="ident" id="3210216">nil</span><br>
<span class="lineno"></span><span class="op" id="3210220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3210223">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="3210282">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3210340">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="3210367">func</span>&nbsp;<span class="op" id="3210372">(</span><span class="ident" id="3210373">ip</span>&nbsp;<span class="ident" id="3210376">IP</span><span class="op" id="3210378">)</span>&nbsp;<span class="ident" id="3210380">Equal</span><span class="op" id="3210385">(</span><span class="ident" id="3210386">x</span>&nbsp;<span class="ident" id="3210388">IP</span><span class="op" id="3210390">)</span>&nbsp;<span class="builtintype" id="3210392">bool</span>&nbsp;<span class="op" id="3210397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210400">if</span>&nbsp;<span class="builtinfunc" id="3210403">len</span><span class="op" id="3210406">(</span><span class="ident" id="3210407">ip</span><span class="op" id="3210409">)</span>&nbsp;<span class="op" id="3210411">==</span>&nbsp;<span class="builtinfunc" id="3210414">len</span><span class="op" id="3210417">(</span><span class="ident" id="3210418">x</span><span class="op" id="3210419">)</span>&nbsp;<span class="op" id="3210421">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210425">return</span>&nbsp;<span class="ident" id="3210432">bytesEqual</span><span class="op" id="3210442">(</span><span class="ident" id="3210443">ip</span><span class="op" id="3210445">,</span>&nbsp;<span class="ident" id="3210447">x</span><span class="op" id="3210448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210454">if</span>&nbsp;<span class="builtinfunc" id="3210457">len</span><span class="op" id="3210460">(</span><span class="ident" id="3210461">ip</span><span class="op" id="3210463">)</span>&nbsp;<span class="op" id="3210465">==</span>&nbsp;<span class="ident" id="3210468">IPv4len</span>&nbsp;<span class="op" id="3210476">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3210479">len</span><span class="op" id="3210482">(</span><span class="ident" id="3210483">x</span><span class="op" id="3210484">)</span>&nbsp;<span class="op" id="3210486">==</span>&nbsp;<span class="ident" id="3210489">IPv6len</span>&nbsp;<span class="op" id="3210497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210501">return</span>&nbsp;<span class="ident" id="3210508">bytesEqual</span><span class="op" id="3210518">(</span><span class="ident" id="3210519">x</span><span class="op" id="3210520">[</span><span class="num" id="3210521">0</span><span class="op" id="3210522">:</span><span class="num" id="3210523">12</span><span class="op" id="3210525">]</span><span class="op" id="3210526">,</span>&nbsp;<span class="ident" id="3210528">v4InV6Prefix</span><span class="op" id="3210540">)</span>&nbsp;<span class="op" id="3210542">&amp;&amp;</span>&nbsp;<span class="ident" id="3210545">bytesEqual</span><span class="op" id="3210555">(</span><span class="ident" id="3210556">ip</span><span class="op" id="3210558">,</span>&nbsp;<span class="ident" id="3210560">x</span><span class="op" id="3210561">[</span><span class="num" id="3210562">12</span><span class="op" id="3210564">:</span><span class="op" id="3210565">]</span><span class="op" id="3210566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210569">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210572">if</span>&nbsp;<span class="builtinfunc" id="3210575">len</span><span class="op" id="3210578">(</span><span class="ident" id="3210579">ip</span><span class="op" id="3210581">)</span>&nbsp;<span class="op" id="3210583">==</span>&nbsp;<span class="ident" id="3210586">IPv6len</span>&nbsp;<span class="op" id="3210594">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3210597">len</span><span class="op" id="3210600">(</span><span class="ident" id="3210601">x</span><span class="op" id="3210602">)</span>&nbsp;<span class="op" id="3210604">==</span>&nbsp;<span class="ident" id="3210607">IPv4len</span>&nbsp;<span class="op" id="3210615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210619">return</span>&nbsp;<span class="ident" id="3210626">bytesEqual</span><span class="op" id="3210636">(</span><span class="ident" id="3210637">ip</span><span class="op" id="3210639">[</span><span class="num" id="3210640">0</span><span class="op" id="3210641">:</span><span class="num" id="3210642">12</span><span class="op" id="3210644">]</span><span class="op" id="3210645">,</span>&nbsp;<span class="ident" id="3210647">v4InV6Prefix</span><span class="op" id="3210659">)</span>&nbsp;<span class="op" id="3210661">&amp;&amp;</span>&nbsp;<span class="ident" id="3210664">bytesEqual</span><span class="op" id="3210674">(</span><span class="ident" id="3210675">ip</span><span class="op" id="3210677">[</span><span class="num" id="3210678">12</span><span class="op" id="3210680">:</span><span class="op" id="3210681">]</span><span class="op" id="3210682">,</span>&nbsp;<span class="ident" id="3210684">x</span><span class="op" id="3210685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210691">return</span>&nbsp;<span class="builtintype" id="3210698">false</span><br>
<span class="lineno"></span><span class="op" id="3210704">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="3210707">func</span>&nbsp;<span class="ident" id="3210712">bytesEqual</span><span class="op" id="3210722">(</span><span class="ident" id="3210723">x</span><span class="op" id="3210724">,</span>&nbsp;<span class="ident" id="3210726">y</span>&nbsp;<span class="op" id="3210728">[</span><span class="op" id="3210729">]</span><span class="builtintype" id="3210730">byte</span><span class="op" id="3210734">)</span>&nbsp;<span class="builtintype" id="3210736">bool</span>&nbsp;<span class="op" id="3210741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210744">if</span>&nbsp;<span class="builtinfunc" id="3210747">len</span><span class="op" id="3210750">(</span><span class="ident" id="3210751">x</span><span class="op" id="3210752">)</span>&nbsp;<span class="op" id="3210754">!=</span>&nbsp;<span class="builtinfunc" id="3210757">len</span><span class="op" id="3210760">(</span><span class="ident" id="3210761">y</span><span class="op" id="3210762">)</span>&nbsp;<span class="op" id="3210764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210768">return</span>&nbsp;<span class="builtintype" id="3210775">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210782">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210785">for</span>&nbsp;<span class="ident" id="3210789">i</span><span class="op" id="3210790">,</span>&nbsp;<span class="ident" id="3210792">b</span>&nbsp;<span class="op" id="3210794">:=</span>&nbsp;<span class="keyword" id="3210797">range</span>&nbsp;<span class="ident" id="3210803">x</span>&nbsp;<span class="op" id="3210805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210809">if</span>&nbsp;<span class="ident" id="3210812">y</span><span class="op" id="3210813">[</span><span class="ident" id="3210814">i</span><span class="op" id="3210815">]</span>&nbsp;<span class="op" id="3210817">!=</span>&nbsp;<span class="ident" id="3210820">b</span>&nbsp;<span class="op" id="3210822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210827">return</span>&nbsp;<span class="builtintype" id="3210834">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3210845">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210848">return</span>&nbsp;<span class="builtintype" id="3210855">true</span><br>
<span class="lineno"></span><span class="op" id="3210860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3210863">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3210918">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="3210950">func</span>&nbsp;<span class="ident" id="3210955">simpleMaskLength</span><span class="op" id="3210971">(</span><span class="ident" id="3210972">mask</span>&nbsp;<span class="ident" id="3210977">IPMask</span><span class="op" id="3210983">)</span>&nbsp;<span class="builtintype" id="3210985">int</span>&nbsp;<span class="op" id="3210989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3210992">var</span>&nbsp;<span class="ident" id="3210996">n</span>&nbsp;<span class="builtintype" id="3210998">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211003">for</span>&nbsp;<span class="ident" id="3211007">i</span><span class="op" id="3211008">,</span>&nbsp;<span class="ident" id="3211010">v</span>&nbsp;<span class="op" id="3211012">:=</span>&nbsp;<span class="keyword" id="3211015">range</span>&nbsp;<span class="ident" id="3211021">mask</span>&nbsp;<span class="op" id="3211026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211030">if</span>&nbsp;<span class="ident" id="3211033">v</span>&nbsp;<span class="op" id="3211035">==</span>&nbsp;<span class="num" id="3211038">0xff</span>&nbsp;<span class="op" id="3211043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211048">n</span>&nbsp;<span class="op" id="3211050">+=</span>&nbsp;<span class="num" id="3211053">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211058">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3211073">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3211096">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211114">for</span>&nbsp;<span class="ident" id="3211118">v</span><span class="op" id="3211119">&amp;</span><span class="num" id="3211120">0x80</span>&nbsp;<span class="op" id="3211125">!=</span>&nbsp;<span class="num" id="3211128">0</span>&nbsp;<span class="op" id="3211130">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211135">n</span><span class="op" id="3211136">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211142">v</span>&nbsp;<span class="op" id="3211144">&lt;&lt;=</span>&nbsp;<span class="num" id="3211148">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3211156">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211181">if</span>&nbsp;<span class="ident" id="3211184">v</span>&nbsp;<span class="op" id="3211186">!=</span>&nbsp;<span class="num" id="3211189">0</span>&nbsp;<span class="op" id="3211191">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211196">return</span>&nbsp;<span class="op" id="3211203">-</span><span class="num" id="3211204">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211212">for</span>&nbsp;<span class="ident" id="3211216">i</span><span class="op" id="3211217">++</span><span class="op" id="3211219">;</span>&nbsp;<span class="ident" id="3211221">i</span>&nbsp;<span class="op" id="3211223">&lt;</span>&nbsp;<span class="builtinfunc" id="3211225">len</span><span class="op" id="3211228">(</span><span class="ident" id="3211229">mask</span><span class="op" id="3211233">)</span><span class="op" id="3211234">;</span>&nbsp;<span class="ident" id="3211236">i</span><span class="op" id="3211237">++</span>&nbsp;<span class="op" id="3211240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211245">if</span>&nbsp;<span class="ident" id="3211248">mask</span><span class="op" id="3211252">[</span><span class="ident" id="3211253">i</span><span class="op" id="3211254">]</span>&nbsp;<span class="op" id="3211256">!=</span>&nbsp;<span class="num" id="3211259">0</span>&nbsp;<span class="op" id="3211261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211267">return</span>&nbsp;<span class="op" id="3211274">-</span><span class="num" id="3211275">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211288">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211298">return</span>&nbsp;<span class="ident" id="3211305">n</span><br>
<span class="lineno">410</span><span class="op" id="3211307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3211310">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="3211381">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="3211455">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="3211477">func</span>&nbsp;<span class="op" id="3211482">(</span><span class="ident" id="3211483">m</span>&nbsp;<span class="ident" id="3211485">IPMask</span><span class="op" id="3211491">)</span>&nbsp;<span class="ident" id="3211493">Size</span><span class="op" id="3211497">(</span><span class="op" id="3211498">)</span>&nbsp;<span class="op" id="3211500">(</span><span class="ident" id="3211501">ones</span><span class="op" id="3211505">,</span>&nbsp;<span class="ident" id="3211507">bits</span>&nbsp;<span class="builtintype" id="3211512">int</span><span class="op" id="3211515">)</span>&nbsp;<span class="op" id="3211517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211520">ones</span><span class="op" id="3211524">,</span>&nbsp;<span class="ident" id="3211526">bits</span>&nbsp;<span class="op" id="3211531">=</span>&nbsp;<span class="ident" id="3211533">simpleMaskLength</span><span class="op" id="3211549">(</span><span class="ident" id="3211550">m</span><span class="op" id="3211551">)</span><span class="op" id="3211552">,</span>&nbsp;<span class="builtinfunc" id="3211554">len</span><span class="op" id="3211557">(</span><span class="ident" id="3211558">m</span><span class="op" id="3211559">)</span><span class="op" id="3211560">*</span><span class="num" id="3211561">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211564">if</span>&nbsp;<span class="ident" id="3211567">ones</span>&nbsp;<span class="op" id="3211572">==</span>&nbsp;<span class="op" id="3211575">-</span><span class="num" id="3211576">1</span>&nbsp;<span class="op" id="3211578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211582">return</span>&nbsp;<span class="num" id="3211589">0</span><span class="op" id="3211590">,</span>&nbsp;<span class="num" id="3211592">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211595">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211598">return</span><br>
<span class="lineno"></span><span class="op" id="3211605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3211608">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="3211674">func</span>&nbsp;<span class="op" id="3211679">(</span><span class="ident" id="3211680">m</span>&nbsp;<span class="ident" id="3211682">IPMask</span><span class="op" id="3211688">)</span>&nbsp;<span class="ident" id="3211690">String</span><span class="op" id="3211696">(</span><span class="op" id="3211697">)</span>&nbsp;<span class="builtintype" id="3211699">string</span>&nbsp;<span class="op" id="3211706">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211709">if</span>&nbsp;<span class="builtinfunc" id="3211712">len</span><span class="op" id="3211715">(</span><span class="ident" id="3211716">m</span><span class="op" id="3211717">)</span>&nbsp;<span class="op" id="3211719">==</span>&nbsp;<span class="num" id="3211722">0</span>&nbsp;<span class="op" id="3211724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211728">return</span>&nbsp;<span class="string" id="3211735">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211747">buf</span>&nbsp;<span class="op" id="3211751">:=</span>&nbsp;<span class="builtinfunc" id="3211754">make</span><span class="op" id="3211758">(</span><span class="op" id="3211759">[</span><span class="op" id="3211760">]</span><span class="builtintype" id="3211761">byte</span><span class="op" id="3211765">,</span>&nbsp;<span class="builtinfunc" id="3211767">len</span><span class="op" id="3211770">(</span><span class="ident" id="3211771">m</span><span class="op" id="3211772">)</span><span class="op" id="3211773">*</span><span class="num" id="3211774">2</span><span class="op" id="3211775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211778">for</span>&nbsp;<span class="ident" id="3211782">i</span><span class="op" id="3211783">,</span>&nbsp;<span class="ident" id="3211785">b</span>&nbsp;<span class="op" id="3211787">:=</span>&nbsp;<span class="keyword" id="3211790">range</span>&nbsp;<span class="ident" id="3211796">m</span>&nbsp;<span class="op" id="3211798">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211802">buf</span><span class="op" id="3211805">[</span><span class="ident" id="3211806">i</span><span class="op" id="3211807">*</span><span class="num" id="3211808">2</span><span class="op" id="3211809">]</span><span class="op" id="3211810">,</span>&nbsp;<span class="ident" id="3211812">buf</span><span class="op" id="3211815">[</span><span class="ident" id="3211816">i</span><span class="op" id="3211817">*</span><span class="num" id="3211818">2</span><span class="op" id="3211819">+</span><span class="num" id="3211820">1</span><span class="op" id="3211821">]</span>&nbsp;<span class="op" id="3211823">=</span>&nbsp;<span class="ident" id="3211825">hexDigit</span><span class="op" id="3211833">[</span><span class="ident" id="3211834">b</span><span class="op" id="3211835">&gt;&gt;</span><span class="num" id="3211837">4</span><span class="op" id="3211838">]</span><span class="op" id="3211839">,</span>&nbsp;<span class="ident" id="3211841">hexDigit</span><span class="op" id="3211849">[</span><span class="ident" id="3211850">b</span><span class="op" id="3211851">&amp;</span><span class="num" id="3211852">0xf</span><span class="op" id="3211855">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211861">return</span>&nbsp;<span class="builtintype" id="3211868">string</span><span class="op" id="3211874">(</span><span class="ident" id="3211875">buf</span><span class="op" id="3211878">)</span><br>
<span class="lineno"></span><span class="op" id="3211880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="3211883">func</span>&nbsp;<span class="ident" id="3211888">networkNumberAndMask</span><span class="op" id="3211908">(</span><span class="ident" id="3211909">n</span>&nbsp;<span class="op" id="3211911">*</span><span class="ident" id="3211912">IPNet</span><span class="op" id="3211917">)</span>&nbsp;<span class="op" id="3211919">(</span><span class="ident" id="3211920">ip</span>&nbsp;<span class="ident" id="3211923">IP</span><span class="op" id="3211925">,</span>&nbsp;<span class="ident" id="3211927">m</span>&nbsp;<span class="ident" id="3211929">IPMask</span><span class="op" id="3211935">)</span>&nbsp;<span class="op" id="3211937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211940">if</span>&nbsp;<span class="ident" id="3211943">ip</span>&nbsp;<span class="op" id="3211946">=</span>&nbsp;<span class="ident" id="3211948">n</span><span class="op" id="3211949">.</span><span class="ident" id="3211950">IP</span><span class="op" id="3211952">.</span><span class="ident" id="3211953">To4</span><span class="op" id="3211956">(</span><span class="op" id="3211957">)</span><span class="op" id="3211958">;</span>&nbsp;<span class="ident" id="3211960">ip</span>&nbsp;<span class="op" id="3211963">==</span>&nbsp;<span class="ident" id="3211966">nil</span>&nbsp;<span class="op" id="3211970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211974">ip</span>&nbsp;<span class="op" id="3211977">=</span>&nbsp;<span class="ident" id="3211979">n</span><span class="op" id="3211980">.</span><span class="ident" id="3211981">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211986">if</span>&nbsp;<span class="builtinfunc" id="3211989">len</span><span class="op" id="3211992">(</span><span class="ident" id="3211993">ip</span><span class="op" id="3211995">)</span>&nbsp;<span class="op" id="3211997">!=</span>&nbsp;<span class="ident" id="3212000">IPv6len</span>&nbsp;<span class="op" id="3212008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212013">return</span>&nbsp;<span class="ident" id="3212020">nil</span><span class="op" id="3212023">,</span>&nbsp;<span class="ident" id="3212025">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212037">m</span>&nbsp;<span class="op" id="3212039">=</span>&nbsp;<span class="ident" id="3212041">n</span><span class="op" id="3212042">.</span><span class="ident" id="3212043">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212049">switch</span>&nbsp;<span class="builtinfunc" id="3212056">len</span><span class="op" id="3212059">(</span><span class="ident" id="3212060">m</span><span class="op" id="3212061">)</span>&nbsp;<span class="op" id="3212063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212066">case</span>&nbsp;<span class="ident" id="3212071">IPv4len</span><span class="op" id="3212078">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212082">if</span>&nbsp;<span class="builtinfunc" id="3212085">len</span><span class="op" id="3212088">(</span><span class="ident" id="3212089">ip</span><span class="op" id="3212091">)</span>&nbsp;<span class="op" id="3212093">!=</span>&nbsp;<span class="ident" id="3212096">IPv4len</span>&nbsp;<span class="op" id="3212104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212109">return</span>&nbsp;<span class="ident" id="3212116">nil</span><span class="op" id="3212119">,</span>&nbsp;<span class="ident" id="3212121">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212130">case</span>&nbsp;<span class="ident" id="3212135">IPv6len</span><span class="op" id="3212142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212146">if</span>&nbsp;<span class="builtinfunc" id="3212149">len</span><span class="op" id="3212152">(</span><span class="ident" id="3212153">ip</span><span class="op" id="3212155">)</span>&nbsp;<span class="op" id="3212157">==</span>&nbsp;<span class="ident" id="3212160">IPv4len</span>&nbsp;<span class="op" id="3212168">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212173">m</span>&nbsp;<span class="op" id="3212175">=</span>&nbsp;<span class="ident" id="3212177">m</span><span class="op" id="3212178">[</span><span class="num" id="3212179">12</span><span class="op" id="3212181">:</span><span class="op" id="3212182">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212189">default</span><span class="op" id="3212196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212200">return</span>&nbsp;<span class="ident" id="3212207">nil</span><span class="op" id="3212210">,</span>&nbsp;<span class="ident" id="3212212">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212217">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212220">return</span><br>
<span class="lineno"></span><span class="op" id="3212227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3212230">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="3212283">func</span>&nbsp;<span class="op" id="3212288">(</span><span class="ident" id="3212289">n</span>&nbsp;<span class="op" id="3212291">*</span><span class="ident" id="3212292">IPNet</span><span class="op" id="3212297">)</span>&nbsp;<span class="ident" id="3212299">Contains</span><span class="op" id="3212307">(</span><span class="ident" id="3212308">ip</span>&nbsp;<span class="ident" id="3212311">IP</span><span class="op" id="3212313">)</span>&nbsp;<span class="builtintype" id="3212315">bool</span>&nbsp;<span class="op" id="3212320">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212323">nn</span><span class="op" id="3212325">,</span>&nbsp;<span class="ident" id="3212327">m</span>&nbsp;<span class="op" id="3212329">:=</span>&nbsp;<span class="ident" id="3212332">networkNumberAndMask</span><span class="op" id="3212352">(</span><span class="ident" id="3212353">n</span><span class="op" id="3212354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212357">if</span>&nbsp;<span class="ident" id="3212360">x</span>&nbsp;<span class="op" id="3212362">:=</span>&nbsp;<span class="ident" id="3212365">ip</span><span class="op" id="3212367">.</span><span class="ident" id="3212368">To4</span><span class="op" id="3212371">(</span><span class="op" id="3212372">)</span><span class="op" id="3212373">;</span>&nbsp;<span class="ident" id="3212375">x</span>&nbsp;<span class="op" id="3212377">!=</span>&nbsp;<span class="ident" id="3212380">nil</span>&nbsp;<span class="op" id="3212384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212388">ip</span>&nbsp;<span class="op" id="3212391">=</span>&nbsp;<span class="ident" id="3212393">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212399">l</span>&nbsp;<span class="op" id="3212401">:=</span>&nbsp;<span class="builtinfunc" id="3212404">len</span><span class="op" id="3212407">(</span><span class="ident" id="3212408">ip</span><span class="op" id="3212410">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212413">if</span>&nbsp;<span class="ident" id="3212416">l</span>&nbsp;<span class="op" id="3212418">!=</span>&nbsp;<span class="builtinfunc" id="3212421">len</span><span class="op" id="3212424">(</span><span class="ident" id="3212425">nn</span><span class="op" id="3212427">)</span>&nbsp;<span class="op" id="3212429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212433">return</span>&nbsp;<span class="builtintype" id="3212440">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212450">for</span>&nbsp;<span class="ident" id="3212454">i</span>&nbsp;<span class="op" id="3212456">:=</span>&nbsp;<span class="num" id="3212459">0</span><span class="op" id="3212460">;</span>&nbsp;<span class="ident" id="3212462">i</span>&nbsp;<span class="op" id="3212464">&lt;</span>&nbsp;<span class="ident" id="3212466">l</span><span class="op" id="3212467">;</span>&nbsp;<span class="ident" id="3212469">i</span><span class="op" id="3212470">++</span>&nbsp;<span class="op" id="3212473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212477">if</span>&nbsp;<span class="ident" id="3212480">nn</span><span class="op" id="3212482">[</span><span class="ident" id="3212483">i</span><span class="op" id="3212484">]</span><span class="op" id="3212485">&amp;</span><span class="ident" id="3212486">m</span><span class="op" id="3212487">[</span><span class="ident" id="3212488">i</span><span class="op" id="3212489">]</span>&nbsp;<span class="op" id="3212491">!=</span>&nbsp;<span class="ident" id="3212494">ip</span><span class="op" id="3212496">[</span><span class="ident" id="3212497">i</span><span class="op" id="3212498">]</span><span class="op" id="3212499">&amp;</span><span class="ident" id="3212500">m</span><span class="op" id="3212501">[</span><span class="ident" id="3212502">i</span><span class="op" id="3212503">]</span>&nbsp;<span class="op" id="3212505">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212510">return</span>&nbsp;<span class="builtintype" id="3212517">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212531">return</span>&nbsp;<span class="builtintype" id="3212538">true</span><br>
<span class="lineno"></span><span class="op" id="3212543">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="3212546">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3212603">func</span>&nbsp;<span class="op" id="3212608">(</span><span class="ident" id="3212609">n</span>&nbsp;<span class="op" id="3212611">*</span><span class="ident" id="3212612">IPNet</span><span class="op" id="3212617">)</span>&nbsp;<span class="ident" id="3212619">Network</span><span class="op" id="3212626">(</span><span class="op" id="3212627">)</span>&nbsp;<span class="builtintype" id="3212629">string</span>&nbsp;<span class="op" id="3212636">{</span>&nbsp;<span class="keyword" id="3212638">return</span>&nbsp;<span class="string" id="3212645">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="3212654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3212657">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="3212722">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3212781">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3212841">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="3212904">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3212966">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="3213012">func</span>&nbsp;<span class="op" id="3213017">(</span><span class="ident" id="3213018">n</span>&nbsp;<span class="op" id="3213020">*</span><span class="ident" id="3213021">IPNet</span><span class="op" id="3213026">)</span>&nbsp;<span class="ident" id="3213028">String</span><span class="op" id="3213034">(</span><span class="op" id="3213035">)</span>&nbsp;<span class="builtintype" id="3213037">string</span>&nbsp;<span class="op" id="3213044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213047">nn</span><span class="op" id="3213049">,</span>&nbsp;<span class="ident" id="3213051">m</span>&nbsp;<span class="op" id="3213053">:=</span>&nbsp;<span class="ident" id="3213056">networkNumberAndMask</span><span class="op" id="3213076">(</span><span class="ident" id="3213077">n</span><span class="op" id="3213078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213081">if</span>&nbsp;<span class="ident" id="3213084">nn</span>&nbsp;<span class="op" id="3213087">==</span>&nbsp;<span class="ident" id="3213090">nil</span>&nbsp;<span class="op" id="3213094">||</span>&nbsp;<span class="ident" id="3213097">m</span>&nbsp;<span class="op" id="3213099">==</span>&nbsp;<span class="ident" id="3213102">nil</span>&nbsp;<span class="op" id="3213106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213110">return</span>&nbsp;<span class="string" id="3213117">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213126">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213129">l</span>&nbsp;<span class="op" id="3213131">:=</span>&nbsp;<span class="ident" id="3213134">simpleMaskLength</span><span class="op" id="3213150">(</span><span class="ident" id="3213151">m</span><span class="op" id="3213152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213155">if</span>&nbsp;<span class="ident" id="3213158">l</span>&nbsp;<span class="op" id="3213160">==</span>&nbsp;<span class="op" id="3213163">-</span><span class="num" id="3213164">1</span>&nbsp;<span class="op" id="3213166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213170">return</span>&nbsp;<span class="ident" id="3213177">nn</span><span class="op" id="3213179">.</span><span class="ident" id="3213180">String</span><span class="op" id="3213186">(</span><span class="op" id="3213187">)</span>&nbsp;<span class="op" id="3213189">+</span>&nbsp;<span class="string" id="3213191">&#34;/&#34;</span>&nbsp;<span class="op" id="3213195">+</span>&nbsp;<span class="ident" id="3213197">m</span><span class="op" id="3213198">.</span><span class="ident" id="3213199">String</span><span class="op" id="3213205">(</span><span class="op" id="3213206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213212">return</span>&nbsp;<span class="ident" id="3213219">nn</span><span class="op" id="3213221">.</span><span class="ident" id="3213222">String</span><span class="op" id="3213228">(</span><span class="op" id="3213229">)</span>&nbsp;<span class="op" id="3213231">+</span>&nbsp;<span class="string" id="3213233">&#34;/&#34;</span>&nbsp;<span class="op" id="3213237">+</span>&nbsp;<span class="ident" id="3213239">itod</span><span class="op" id="3213243">(</span><span class="builtintype" id="3213244">uint</span><span class="op" id="3213248">(</span><span class="ident" id="3213249">l</span><span class="op" id="3213250">)</span><span class="op" id="3213251">)</span><br>
<span class="lineno">495</span><span class="op" id="3213253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3213256">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="3213289">func</span>&nbsp;<span class="ident" id="3213294">parseIPv4</span><span class="op" id="3213303">(</span><span class="ident" id="3213304">s</span>&nbsp;<span class="builtintype" id="3213306">string</span><span class="op" id="3213312">)</span>&nbsp;<span class="ident" id="3213314">IP</span>&nbsp;<span class="op" id="3213317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213320">var</span>&nbsp;<span class="ident" id="3213324">p</span>&nbsp;<span class="op" id="3213326">[</span><span class="ident" id="3213327">IPv4len</span><span class="op" id="3213334">]</span><span class="builtintype" id="3213335">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213341">i</span>&nbsp;<span class="op" id="3213343">:=</span>&nbsp;<span class="num" id="3213346">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213349">for</span>&nbsp;<span class="ident" id="3213353">j</span>&nbsp;<span class="op" id="3213355">:=</span>&nbsp;<span class="num" id="3213358">0</span><span class="op" id="3213359">;</span>&nbsp;<span class="ident" id="3213361">j</span>&nbsp;<span class="op" id="3213363">&lt;</span>&nbsp;<span class="ident" id="3213365">IPv4len</span><span class="op" id="3213372">;</span>&nbsp;<span class="ident" id="3213374">j</span><span class="op" id="3213375">++</span>&nbsp;<span class="op" id="3213378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213382">if</span>&nbsp;<span class="ident" id="3213385">i</span>&nbsp;<span class="op" id="3213387">&gt;=</span>&nbsp;<span class="builtinfunc" id="3213390">len</span><span class="op" id="3213393">(</span><span class="ident" id="3213394">s</span><span class="op" id="3213395">)</span>&nbsp;<span class="op" id="3213397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3213402">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213424">return</span>&nbsp;<span class="ident" id="3213431">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213441">if</span>&nbsp;<span class="ident" id="3213444">j</span>&nbsp;<span class="op" id="3213446">&gt;</span>&nbsp;<span class="num" id="3213448">0</span>&nbsp;<span class="op" id="3213450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213455">if</span>&nbsp;<span class="ident" id="3213458">s</span><span class="op" id="3213459">[</span><span class="ident" id="3213460">i</span><span class="op" id="3213461">]</span>&nbsp;<span class="op" id="3213463">!=</span>&nbsp;<span class="string" id="3213466">&#39;.&#39;</span>&nbsp;<span class="op" id="3213470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213476">return</span>&nbsp;<span class="ident" id="3213483">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213490">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213495">i</span><span class="op" id="3213496">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213505">var</span>&nbsp;<span class="op" id="3213509">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213514">n</span>&nbsp;&nbsp;<span class="builtintype" id="3213517">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213524">ok</span>&nbsp;<span class="builtintype" id="3213527">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213538">n</span><span class="op" id="3213539">,</span>&nbsp;<span class="ident" id="3213541">i</span><span class="op" id="3213542">,</span>&nbsp;<span class="ident" id="3213544">ok</span>&nbsp;<span class="op" id="3213547">=</span>&nbsp;<span class="ident" id="3213549">dtoi</span><span class="op" id="3213553">(</span><span class="ident" id="3213554">s</span><span class="op" id="3213555">,</span>&nbsp;<span class="ident" id="3213557">i</span><span class="op" id="3213558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213562">if</span>&nbsp;<span class="op" id="3213565">!</span><span class="ident" id="3213566">ok</span>&nbsp;<span class="op" id="3213569">||</span>&nbsp;<span class="ident" id="3213572">n</span>&nbsp;<span class="op" id="3213574">&gt;</span>&nbsp;<span class="num" id="3213576">0xFF</span>&nbsp;<span class="op" id="3213581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213586">return</span>&nbsp;<span class="ident" id="3213593">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213599">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213603">p</span><span class="op" id="3213604">[</span><span class="ident" id="3213605">j</span><span class="op" id="3213606">]</span>&nbsp;<span class="op" id="3213608">=</span>&nbsp;<span class="builtintype" id="3213610">byte</span><span class="op" id="3213614">(</span><span class="ident" id="3213615">n</span><span class="op" id="3213616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213622">if</span>&nbsp;<span class="ident" id="3213625">i</span>&nbsp;<span class="op" id="3213627">!=</span>&nbsp;<span class="builtinfunc" id="3213630">len</span><span class="op" id="3213633">(</span><span class="ident" id="3213634">s</span><span class="op" id="3213635">)</span>&nbsp;<span class="op" id="3213637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213641">return</span>&nbsp;<span class="ident" id="3213648">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213653">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213656">return</span>&nbsp;<span class="ident" id="3213663">IPv4</span><span class="op" id="3213667">(</span><span class="ident" id="3213668">p</span><span class="op" id="3213669">[</span><span class="num" id="3213670">0</span><span class="op" id="3213671">]</span><span class="op" id="3213672">,</span>&nbsp;<span class="ident" id="3213674">p</span><span class="op" id="3213675">[</span><span class="num" id="3213676">1</span><span class="op" id="3213677">]</span><span class="op" id="3213678">,</span>&nbsp;<span class="ident" id="3213680">p</span><span class="op" id="3213681">[</span><span class="num" id="3213682">2</span><span class="op" id="3213683">]</span><span class="op" id="3213684">,</span>&nbsp;<span class="ident" id="3213686">p</span><span class="op" id="3213687">[</span><span class="num" id="3213688">3</span><span class="op" id="3213689">]</span><span class="op" id="3213690">)</span><br>
<span class="lineno"></span><span class="op" id="3213692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3213695">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="3213765">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="3213836">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3213906">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3213915">func</span>&nbsp;<span class="ident" id="3213920">parseIPv6</span><span class="op" id="3213929">(</span><span class="ident" id="3213930">s</span>&nbsp;<span class="builtintype" id="3213932">string</span><span class="op" id="3213938">,</span>&nbsp;<span class="ident" id="3213940">zoneAllowed</span>&nbsp;<span class="builtintype" id="3213952">bool</span><span class="op" id="3213956">)</span>&nbsp;<span class="op" id="3213958">(</span><span class="ident" id="3213959">ip</span>&nbsp;<span class="ident" id="3213962">IP</span><span class="op" id="3213964">,</span>&nbsp;<span class="ident" id="3213966">zone</span>&nbsp;<span class="builtintype" id="3213971">string</span><span class="op" id="3213977">)</span>&nbsp;<span class="op" id="3213979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213982">ip</span>&nbsp;<span class="op" id="3213985">=</span>&nbsp;<span class="builtinfunc" id="3213987">make</span><span class="op" id="3213991">(</span><span class="ident" id="3213992">IP</span><span class="op" id="3213994">,</span>&nbsp;<span class="ident" id="3213996">IPv6len</span><span class="op" id="3214003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214006">ellipsis</span>&nbsp;<span class="op" id="3214015">:=</span>&nbsp;<span class="op" id="3214018">-</span><span class="num" id="3214019">1</span>&nbsp;<span class="comment" id="3214021">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214051">i</span>&nbsp;<span class="op" id="3214053">:=</span>&nbsp;<span class="num" id="3214056">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3214066">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214089">if</span>&nbsp;<span class="ident" id="3214092">zoneAllowed</span>&nbsp;<span class="op" id="3214104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214108">s</span><span class="op" id="3214109">,</span>&nbsp;<span class="ident" id="3214111">zone</span>&nbsp;<span class="op" id="3214116">=</span>&nbsp;<span class="ident" id="3214118">splitHostZone</span><span class="op" id="3214131">(</span><span class="ident" id="3214132">s</span><span class="op" id="3214133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214136">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214140">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214172">if</span>&nbsp;<span class="builtinfunc" id="3214175">len</span><span class="op" id="3214178">(</span><span class="ident" id="3214179">s</span><span class="op" id="3214180">)</span>&nbsp;<span class="op" id="3214182">&gt;=</span>&nbsp;<span class="num" id="3214185">2</span>&nbsp;<span class="op" id="3214187">&amp;&amp;</span>&nbsp;<span class="ident" id="3214190">s</span><span class="op" id="3214191">[</span><span class="num" id="3214192">0</span><span class="op" id="3214193">]</span>&nbsp;<span class="op" id="3214195">==</span>&nbsp;<span class="string" id="3214198">&#39;:&#39;</span>&nbsp;<span class="op" id="3214202">&amp;&amp;</span>&nbsp;<span class="ident" id="3214205">s</span><span class="op" id="3214206">[</span><span class="num" id="3214207">1</span><span class="op" id="3214208">]</span>&nbsp;<span class="op" id="3214210">==</span>&nbsp;<span class="string" id="3214213">&#39;:&#39;</span>&nbsp;<span class="op" id="3214217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214221">ellipsis</span>&nbsp;<span class="op" id="3214230">=</span>&nbsp;<span class="num" id="3214232">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214236">i</span>&nbsp;<span class="op" id="3214238">=</span>&nbsp;<span class="num" id="3214240">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214244">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214272">if</span>&nbsp;<span class="ident" id="3214275">i</span>&nbsp;<span class="op" id="3214277">==</span>&nbsp;<span class="builtinfunc" id="3214280">len</span><span class="op" id="3214283">(</span><span class="ident" id="3214284">s</span><span class="op" id="3214285">)</span>&nbsp;<span class="op" id="3214287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214292">return</span>&nbsp;<span class="ident" id="3214299">ip</span><span class="op" id="3214301">,</span>&nbsp;<span class="ident" id="3214303">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214313">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214317">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214366">j</span>&nbsp;<span class="op" id="3214368">:=</span>&nbsp;<span class="num" id="3214371">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214374">for</span>&nbsp;<span class="ident" id="3214378">j</span>&nbsp;<span class="op" id="3214380">&lt;</span>&nbsp;<span class="ident" id="3214382">IPv6len</span>&nbsp;<span class="op" id="3214390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214394">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214411">n</span><span class="op" id="3214412">,</span>&nbsp;<span class="ident" id="3214414">i1</span><span class="op" id="3214416">,</span>&nbsp;<span class="ident" id="3214418">ok</span>&nbsp;<span class="op" id="3214421">:=</span>&nbsp;<span class="ident" id="3214424">xtoi</span><span class="op" id="3214428">(</span><span class="ident" id="3214429">s</span><span class="op" id="3214430">,</span>&nbsp;<span class="ident" id="3214432">i</span><span class="op" id="3214433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214437">if</span>&nbsp;<span class="op" id="3214440">!</span><span class="ident" id="3214441">ok</span>&nbsp;<span class="op" id="3214444">||</span>&nbsp;<span class="ident" id="3214447">n</span>&nbsp;<span class="op" id="3214449">&gt;</span>&nbsp;<span class="num" id="3214451">0xFFFF</span>&nbsp;<span class="op" id="3214458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214463">return</span>&nbsp;<span class="ident" id="3214470">nil</span><span class="op" id="3214473">,</span>&nbsp;<span class="ident" id="3214475">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214487">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214539">if</span>&nbsp;<span class="ident" id="3214542">i1</span>&nbsp;<span class="op" id="3214545">&lt;</span>&nbsp;<span class="builtinfunc" id="3214547">len</span><span class="op" id="3214550">(</span><span class="ident" id="3214551">s</span><span class="op" id="3214552">)</span>&nbsp;<span class="op" id="3214554">&amp;&amp;</span>&nbsp;<span class="ident" id="3214557">s</span><span class="op" id="3214558">[</span><span class="ident" id="3214559">i1</span><span class="op" id="3214561">]</span>&nbsp;<span class="op" id="3214563">==</span>&nbsp;<span class="string" id="3214566">&#39;.&#39;</span>&nbsp;<span class="op" id="3214570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214575">if</span>&nbsp;<span class="ident" id="3214578">ellipsis</span>&nbsp;<span class="op" id="3214587">&lt;</span>&nbsp;<span class="num" id="3214589">0</span>&nbsp;<span class="op" id="3214591">&amp;&amp;</span>&nbsp;<span class="ident" id="3214594">j</span>&nbsp;<span class="op" id="3214596">!=</span>&nbsp;<span class="ident" id="3214599">IPv6len</span><span class="op" id="3214606">-</span><span class="ident" id="3214607">IPv4len</span>&nbsp;<span class="op" id="3214615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214621">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214649">return</span>&nbsp;<span class="ident" id="3214656">nil</span><span class="op" id="3214659">,</span>&nbsp;<span class="ident" id="3214661">zone</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214674">if</span>&nbsp;<span class="ident" id="3214677">j</span><span class="op" id="3214678">+</span><span class="ident" id="3214679">IPv4len</span>&nbsp;<span class="op" id="3214687">&gt;</span>&nbsp;<span class="ident" id="3214689">IPv6len</span>&nbsp;<span class="op" id="3214697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214703">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214727">return</span>&nbsp;<span class="ident" id="3214734">nil</span><span class="op" id="3214737">,</span>&nbsp;<span class="ident" id="3214739">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214747">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214752">ip4</span>&nbsp;<span class="op" id="3214756">:=</span>&nbsp;<span class="ident" id="3214759">parseIPv4</span><span class="op" id="3214768">(</span><span class="ident" id="3214769">s</span><span class="op" id="3214770">[</span><span class="ident" id="3214771">i</span><span class="op" id="3214772">:</span><span class="op" id="3214773">]</span><span class="op" id="3214774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214779">if</span>&nbsp;<span class="ident" id="3214782">ip4</span>&nbsp;<span class="op" id="3214786">==</span>&nbsp;<span class="ident" id="3214789">nil</span>&nbsp;<span class="op" id="3214793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214799">return</span>&nbsp;<span class="ident" id="3214806">nil</span><span class="op" id="3214809">,</span>&nbsp;<span class="ident" id="3214811">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214824">ip</span><span class="op" id="3214826">[</span><span class="ident" id="3214827">j</span><span class="op" id="3214828">]</span>&nbsp;<span class="op" id="3214830">=</span>&nbsp;<span class="ident" id="3214832">ip4</span><span class="op" id="3214835">[</span><span class="num" id="3214836">12</span><span class="op" id="3214838">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214843">ip</span><span class="op" id="3214845">[</span><span class="ident" id="3214846">j</span><span class="op" id="3214847">+</span><span class="num" id="3214848">1</span><span class="op" id="3214849">]</span>&nbsp;<span class="op" id="3214851">=</span>&nbsp;<span class="ident" id="3214853">ip4</span><span class="op" id="3214856">[</span><span class="num" id="3214857">13</span><span class="op" id="3214859">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214864">ip</span><span class="op" id="3214866">[</span><span class="ident" id="3214867">j</span><span class="op" id="3214868">+</span><span class="num" id="3214869">2</span><span class="op" id="3214870">]</span>&nbsp;<span class="op" id="3214872">=</span>&nbsp;<span class="ident" id="3214874">ip4</span><span class="op" id="3214877">[</span><span class="num" id="3214878">14</span><span class="op" id="3214880">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214885">ip</span><span class="op" id="3214887">[</span><span class="ident" id="3214888">j</span><span class="op" id="3214889">+</span><span class="num" id="3214890">3</span><span class="op" id="3214891">]</span>&nbsp;<span class="op" id="3214893">=</span>&nbsp;<span class="ident" id="3214895">ip4</span><span class="op" id="3214898">[</span><span class="num" id="3214899">15</span><span class="op" id="3214901">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214906">i</span>&nbsp;<span class="op" id="3214908">=</span>&nbsp;<span class="builtinfunc" id="3214910">len</span><span class="op" id="3214913">(</span><span class="ident" id="3214914">s</span><span class="op" id="3214915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214920">j</span>&nbsp;<span class="op" id="3214922">+=</span>&nbsp;<span class="ident" id="3214925">IPv4len</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214936">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214949">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214978">ip</span><span class="op" id="3214980">[</span><span class="ident" id="3214981">j</span><span class="op" id="3214982">]</span>&nbsp;<span class="op" id="3214984">=</span>&nbsp;<span class="builtintype" id="3214986">byte</span><span class="op" id="3214990">(</span><span class="ident" id="3214991">n</span>&nbsp;<span class="op" id="3214993">&gt;&gt;</span>&nbsp;<span class="num" id="3214996">8</span><span class="op" id="3214997">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215001">ip</span><span class="op" id="3215003">[</span><span class="ident" id="3215004">j</span><span class="op" id="3215005">+</span><span class="num" id="3215006">1</span><span class="op" id="3215007">]</span>&nbsp;<span class="op" id="3215009">=</span>&nbsp;<span class="builtintype" id="3215011">byte</span><span class="op" id="3215015">(</span><span class="ident" id="3215016">n</span><span class="op" id="3215017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215021">j</span>&nbsp;<span class="op" id="3215023">+=</span>&nbsp;<span class="num" id="3215026">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3215031">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215059">i</span>&nbsp;<span class="op" id="3215061">=</span>&nbsp;<span class="ident" id="3215063">i1</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215068">if</span>&nbsp;<span class="ident" id="3215071">i</span>&nbsp;<span class="op" id="3215073">==</span>&nbsp;<span class="builtinfunc" id="3215076">len</span><span class="op" id="3215079">(</span><span class="ident" id="3215080">s</span><span class="op" id="3215081">)</span>&nbsp;<span class="op" id="3215083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215088">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3215101">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215152">if</span>&nbsp;<span class="ident" id="3215155">s</span><span class="op" id="3215156">[</span><span class="ident" id="3215157">i</span><span class="op" id="3215158">]</span>&nbsp;<span class="op" id="3215160">!=</span>&nbsp;<span class="string" id="3215163">&#39;:&#39;</span>&nbsp;<span class="op" id="3215167">||</span>&nbsp;<span class="ident" id="3215170">i</span><span class="op" id="3215171">+</span><span class="num" id="3215172">1</span>&nbsp;<span class="op" id="3215174">==</span>&nbsp;<span class="builtinfunc" id="3215177">len</span><span class="op" id="3215180">(</span><span class="ident" id="3215181">s</span><span class="op" id="3215182">)</span>&nbsp;<span class="op" id="3215184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215189">return</span>&nbsp;<span class="ident" id="3215196">nil</span><span class="op" id="3215199">,</span>&nbsp;<span class="ident" id="3215201">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215212">i</span><span class="op" id="3215213">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3215219">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215243">if</span>&nbsp;<span class="ident" id="3215246">s</span><span class="op" id="3215247">[</span><span class="ident" id="3215248">i</span><span class="op" id="3215249">]</span>&nbsp;<span class="op" id="3215251">==</span>&nbsp;<span class="string" id="3215254">&#39;:&#39;</span>&nbsp;<span class="op" id="3215258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215263">if</span>&nbsp;<span class="ident" id="3215266">ellipsis</span>&nbsp;<span class="op" id="3215275">&gt;=</span>&nbsp;<span class="num" id="3215278">0</span>&nbsp;<span class="op" id="3215280">{</span>&nbsp;<span class="comment" id="3215282">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215306">return</span>&nbsp;<span class="ident" id="3215313">nil</span><span class="op" id="3215316">,</span>&nbsp;<span class="ident" id="3215318">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215326">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215331">ellipsis</span>&nbsp;<span class="op" id="3215340">=</span>&nbsp;<span class="ident" id="3215342">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215347">if</span>&nbsp;<span class="ident" id="3215350">i</span><span class="op" id="3215351">++</span><span class="op" id="3215353">;</span>&nbsp;<span class="ident" id="3215355">i</span>&nbsp;<span class="op" id="3215357">==</span>&nbsp;<span class="builtinfunc" id="3215360">len</span><span class="op" id="3215363">(</span><span class="ident" id="3215364">s</span><span class="op" id="3215365">)</span>&nbsp;<span class="op" id="3215367">{</span>&nbsp;<span class="comment" id="3215369">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215390">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215403">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3215410">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215444">if</span>&nbsp;<span class="ident" id="3215447">i</span>&nbsp;<span class="op" id="3215449">!=</span>&nbsp;<span class="builtinfunc" id="3215452">len</span><span class="op" id="3215455">(</span><span class="ident" id="3215456">s</span><span class="op" id="3215457">)</span>&nbsp;<span class="op" id="3215459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215463">return</span>&nbsp;<span class="ident" id="3215470">nil</span><span class="op" id="3215473">,</span>&nbsp;<span class="ident" id="3215475">zone</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3215485">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215530">if</span>&nbsp;<span class="ident" id="3215533">j</span>&nbsp;<span class="op" id="3215535">&lt;</span>&nbsp;<span class="ident" id="3215537">IPv6len</span>&nbsp;<span class="op" id="3215545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215549">if</span>&nbsp;<span class="ident" id="3215552">ellipsis</span>&nbsp;<span class="op" id="3215561">&lt;</span>&nbsp;<span class="num" id="3215563">0</span>&nbsp;<span class="op" id="3215565">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215570">return</span>&nbsp;<span class="ident" id="3215577">nil</span><span class="op" id="3215580">,</span>&nbsp;<span class="ident" id="3215582">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215593">n</span>&nbsp;<span class="op" id="3215595">:=</span>&nbsp;<span class="ident" id="3215598">IPv6len</span>&nbsp;<span class="op" id="3215606">-</span>&nbsp;<span class="ident" id="3215608">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215612">for</span>&nbsp;<span class="ident" id="3215616">k</span>&nbsp;<span class="op" id="3215618">:=</span>&nbsp;<span class="ident" id="3215621">j</span>&nbsp;<span class="op" id="3215623">-</span>&nbsp;<span class="num" id="3215625">1</span><span class="op" id="3215626">;</span>&nbsp;<span class="ident" id="3215628">k</span>&nbsp;<span class="op" id="3215630">&gt;=</span>&nbsp;<span class="ident" id="3215633">ellipsis</span><span class="op" id="3215641">;</span>&nbsp;<span class="ident" id="3215643">k</span><span class="op" id="3215644">--</span>&nbsp;<span class="op" id="3215647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215652">ip</span><span class="op" id="3215654">[</span><span class="ident" id="3215655">k</span><span class="op" id="3215656">+</span><span class="ident" id="3215657">n</span><span class="op" id="3215658">]</span>&nbsp;<span class="op" id="3215660">=</span>&nbsp;<span class="ident" id="3215662">ip</span><span class="op" id="3215664">[</span><span class="ident" id="3215665">k</span><span class="op" id="3215666">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215674">for</span>&nbsp;<span class="ident" id="3215678">k</span>&nbsp;<span class="op" id="3215680">:=</span>&nbsp;<span class="ident" id="3215683">ellipsis</span>&nbsp;<span class="op" id="3215692">+</span>&nbsp;<span class="ident" id="3215694">n</span>&nbsp;<span class="op" id="3215696">-</span>&nbsp;<span class="num" id="3215698">1</span><span class="op" id="3215699">;</span>&nbsp;<span class="ident" id="3215701">k</span>&nbsp;<span class="op" id="3215703">&gt;=</span>&nbsp;<span class="ident" id="3215706">ellipsis</span><span class="op" id="3215714">;</span>&nbsp;<span class="ident" id="3215716">k</span><span class="op" id="3215717">--</span>&nbsp;<span class="op" id="3215720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215725">ip</span><span class="op" id="3215727">[</span><span class="ident" id="3215728">k</span><span class="op" id="3215729">]</span>&nbsp;<span class="op" id="3215731">=</span>&nbsp;<span class="num" id="3215733">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215740">}</span>&nbsp;<span class="keyword" id="3215742">else</span>&nbsp;<span class="keyword" id="3215747">if</span>&nbsp;<span class="ident" id="3215750">ellipsis</span>&nbsp;<span class="op" id="3215759">&gt;=</span>&nbsp;<span class="num" id="3215762">0</span>&nbsp;<span class="op" id="3215764">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3215768">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215819">return</span>&nbsp;<span class="ident" id="3215826">nil</span><span class="op" id="3215829">,</span>&nbsp;<span class="ident" id="3215831">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215840">return</span>&nbsp;<span class="ident" id="3215847">ip</span><span class="op" id="3215849">,</span>&nbsp;<span class="ident" id="3215851">zone</span><br>
<span class="lineno"></span><span class="op" id="3215856">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="3215859">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="3215952">type</span>&nbsp;<span class="ident" id="3215957">ParseError</span>&nbsp;<span class="keyword" id="3215968">struct</span>&nbsp;<span class="op" id="3215975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215978">Type</span>&nbsp;<span class="builtintype" id="3215983">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215991">Text</span>&nbsp;<span class="builtintype" id="3215996">string</span><br>
<span class="lineno">640</span><span class="op" id="3216003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3216006">func</span>&nbsp;<span class="op" id="3216011">(</span><span class="ident" id="3216012">e</span>&nbsp;<span class="op" id="3216014">*</span><span class="ident" id="3216015">ParseError</span><span class="op" id="3216025">)</span>&nbsp;<span class="ident" id="3216027">Error</span><span class="op" id="3216032">(</span><span class="op" id="3216033">)</span>&nbsp;<span class="builtintype" id="3216035">string</span>&nbsp;<span class="op" id="3216042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216045">return</span>&nbsp;<span class="string" id="3216052">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="3216063">+</span>&nbsp;<span class="ident" id="3216065">e</span><span class="op" id="3216066">.</span><span class="ident" id="3216067">Type</span>&nbsp;<span class="op" id="3216072">+</span>&nbsp;<span class="string" id="3216074">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3216079">+</span>&nbsp;<span class="ident" id="3216081">e</span><span class="op" id="3216082">.</span><span class="ident" id="3216083">Text</span><br>
<span class="lineno"></span><span class="op" id="3216088">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="3216091">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="3216151">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3216209">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="3216251">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="3216315">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3216339">func</span>&nbsp;<span class="ident" id="3216344">ParseIP</span><span class="op" id="3216351">(</span><span class="ident" id="3216352">s</span>&nbsp;<span class="builtintype" id="3216354">string</span><span class="op" id="3216360">)</span>&nbsp;<span class="ident" id="3216362">IP</span>&nbsp;<span class="op" id="3216365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216368">for</span>&nbsp;<span class="ident" id="3216372">i</span>&nbsp;<span class="op" id="3216374">:=</span>&nbsp;<span class="num" id="3216377">0</span><span class="op" id="3216378">;</span>&nbsp;<span class="ident" id="3216380">i</span>&nbsp;<span class="op" id="3216382">&lt;</span>&nbsp;<span class="builtinfunc" id="3216384">len</span><span class="op" id="3216387">(</span><span class="ident" id="3216388">s</span><span class="op" id="3216389">)</span><span class="op" id="3216390">;</span>&nbsp;<span class="ident" id="3216392">i</span><span class="op" id="3216393">++</span>&nbsp;<span class="op" id="3216396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216400">switch</span>&nbsp;<span class="ident" id="3216407">s</span><span class="op" id="3216408">[</span><span class="ident" id="3216409">i</span><span class="op" id="3216410">]</span>&nbsp;<span class="op" id="3216412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216416">case</span>&nbsp;<span class="string" id="3216421">&#39;.&#39;</span><span class="op" id="3216424">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216429">return</span>&nbsp;<span class="ident" id="3216436">parseIPv4</span><span class="op" id="3216445">(</span><span class="ident" id="3216446">s</span><span class="op" id="3216447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216451">case</span>&nbsp;<span class="string" id="3216456">&#39;:&#39;</span><span class="op" id="3216459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216464">ip</span><span class="op" id="3216466">,</span>&nbsp;<span class="ident" id="3216468">_</span>&nbsp;<span class="op" id="3216470">:=</span>&nbsp;<span class="ident" id="3216473">parseIPv6</span><span class="op" id="3216482">(</span><span class="ident" id="3216483">s</span><span class="op" id="3216484">,</span>&nbsp;<span class="builtintype" id="3216486">false</span><span class="op" id="3216491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216496">return</span>&nbsp;<span class="ident" id="3216503">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216508">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216514">return</span>&nbsp;<span class="ident" id="3216521">nil</span><br>
<span class="lineno"></span><span class="op" id="3216525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3216528">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="3216590">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3216651">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3216677">//</span><br>
<span class="lineno"></span><span class="comment" id="3216680">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3216743">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="3216808">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="3216872">func</span>&nbsp;<span class="ident" id="3216877">ParseCIDR</span><span class="op" id="3216886">(</span><span class="ident" id="3216887">s</span>&nbsp;<span class="builtintype" id="3216889">string</span><span class="op" id="3216895">)</span>&nbsp;<span class="op" id="3216897">(</span><span class="ident" id="3216898">IP</span><span class="op" id="3216900">,</span>&nbsp;<span class="op" id="3216902">*</span><span class="ident" id="3216903">IPNet</span><span class="op" id="3216908">,</span>&nbsp;<span class="builtintype" id="3216910">error</span><span class="op" id="3216915">)</span>&nbsp;<span class="op" id="3216917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216920">i</span>&nbsp;<span class="op" id="3216922">:=</span>&nbsp;<span class="ident" id="3216925">byteIndex</span><span class="op" id="3216934">(</span><span class="ident" id="3216935">s</span><span class="op" id="3216936">,</span>&nbsp;<span class="string" id="3216938">&#39;/&#39;</span><span class="op" id="3216941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216944">if</span>&nbsp;<span class="ident" id="3216947">i</span>&nbsp;<span class="op" id="3216949">&lt;</span>&nbsp;<span class="num" id="3216951">0</span>&nbsp;<span class="op" id="3216953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216957">return</span>&nbsp;<span class="ident" id="3216964">nil</span><span class="op" id="3216967">,</span>&nbsp;<span class="ident" id="3216969">nil</span><span class="op" id="3216972">,</span>&nbsp;<span class="op" id="3216974">&amp;</span><span class="ident" id="3216975">ParseError</span><span class="op" id="3216985">{</span><span class="string" id="3216986">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3217000">,</span>&nbsp;<span class="ident" id="3217002">s</span><span class="op" id="3217003">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217009">addr</span><span class="op" id="3217013">,</span>&nbsp;<span class="ident" id="3217015">mask</span>&nbsp;<span class="op" id="3217020">:=</span>&nbsp;<span class="ident" id="3217023">s</span><span class="op" id="3217024">[</span><span class="op" id="3217025">:</span><span class="ident" id="3217026">i</span><span class="op" id="3217027">]</span><span class="op" id="3217028">,</span>&nbsp;<span class="ident" id="3217030">s</span><span class="op" id="3217031">[</span><span class="ident" id="3217032">i</span><span class="op" id="3217033">+</span><span class="num" id="3217034">1</span><span class="op" id="3217035">:</span><span class="op" id="3217036">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217039">iplen</span>&nbsp;<span class="op" id="3217045">:=</span>&nbsp;<span class="ident" id="3217048">IPv4len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217057">ip</span>&nbsp;<span class="op" id="3217060">:=</span>&nbsp;<span class="ident" id="3217063">parseIPv4</span><span class="op" id="3217072">(</span><span class="ident" id="3217073">addr</span><span class="op" id="3217077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217080">if</span>&nbsp;<span class="ident" id="3217083">ip</span>&nbsp;<span class="op" id="3217086">==</span>&nbsp;<span class="ident" id="3217089">nil</span>&nbsp;<span class="op" id="3217093">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217097">iplen</span>&nbsp;<span class="op" id="3217103">=</span>&nbsp;<span class="ident" id="3217105">IPv6len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217115">ip</span><span class="op" id="3217117">,</span>&nbsp;<span class="ident" id="3217119">_</span>&nbsp;<span class="op" id="3217121">=</span>&nbsp;<span class="ident" id="3217123">parseIPv6</span><span class="op" id="3217132">(</span><span class="ident" id="3217133">addr</span><span class="op" id="3217137">,</span>&nbsp;<span class="builtintype" id="3217139">false</span><span class="op" id="3217144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217150">n</span><span class="op" id="3217151">,</span>&nbsp;<span class="ident" id="3217153">i</span><span class="op" id="3217154">,</span>&nbsp;<span class="ident" id="3217156">ok</span>&nbsp;<span class="op" id="3217159">:=</span>&nbsp;<span class="ident" id="3217162">dtoi</span><span class="op" id="3217166">(</span><span class="ident" id="3217167">mask</span><span class="op" id="3217171">,</span>&nbsp;<span class="num" id="3217173">0</span><span class="op" id="3217174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217177">if</span>&nbsp;<span class="ident" id="3217180">ip</span>&nbsp;<span class="op" id="3217183">==</span>&nbsp;<span class="ident" id="3217186">nil</span>&nbsp;<span class="op" id="3217190">||</span>&nbsp;<span class="op" id="3217193">!</span><span class="ident" id="3217194">ok</span>&nbsp;<span class="op" id="3217197">||</span>&nbsp;<span class="ident" id="3217200">i</span>&nbsp;<span class="op" id="3217202">!=</span>&nbsp;<span class="builtinfunc" id="3217205">len</span><span class="op" id="3217208">(</span><span class="ident" id="3217209">mask</span><span class="op" id="3217213">)</span>&nbsp;<span class="op" id="3217215">||</span>&nbsp;<span class="ident" id="3217218">n</span>&nbsp;<span class="op" id="3217220">&lt;</span>&nbsp;<span class="num" id="3217222">0</span>&nbsp;<span class="op" id="3217224">||</span>&nbsp;<span class="ident" id="3217227">n</span>&nbsp;<span class="op" id="3217229">&gt;</span>&nbsp;<span class="num" id="3217231">8</span><span class="op" id="3217232">*</span><span class="ident" id="3217233">iplen</span>&nbsp;<span class="op" id="3217239">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217243">return</span>&nbsp;<span class="ident" id="3217250">nil</span><span class="op" id="3217253">,</span>&nbsp;<span class="ident" id="3217255">nil</span><span class="op" id="3217258">,</span>&nbsp;<span class="op" id="3217260">&amp;</span><span class="ident" id="3217261">ParseError</span><span class="op" id="3217271">{</span><span class="string" id="3217272">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3217286">,</span>&nbsp;<span class="ident" id="3217288">s</span><span class="op" id="3217289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217295">m</span>&nbsp;<span class="op" id="3217297">:=</span>&nbsp;<span class="ident" id="3217300">CIDRMask</span><span class="op" id="3217308">(</span><span class="ident" id="3217309">n</span><span class="op" id="3217310">,</span>&nbsp;<span class="num" id="3217312">8</span><span class="op" id="3217313">*</span><span class="ident" id="3217314">iplen</span><span class="op" id="3217319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217322">return</span>&nbsp;<span class="ident" id="3217329">ip</span><span class="op" id="3217331">,</span>&nbsp;<span class="op" id="3217333">&amp;</span><span class="ident" id="3217334">IPNet</span><span class="op" id="3217339">{</span><span class="ident" id="3217340">IP</span><span class="op" id="3217342">:</span>&nbsp;<span class="ident" id="3217344">ip</span><span class="op" id="3217346">.</span><span class="ident" id="3217347">Mask</span><span class="op" id="3217351">(</span><span class="ident" id="3217352">m</span><span class="op" id="3217353">)</span><span class="op" id="3217354">,</span>&nbsp;<span class="ident" id="3217356">Mask</span><span class="op" id="3217360">:</span>&nbsp;<span class="ident" id="3217362">m</span><span class="op" id="3217363">}</span><span class="op" id="3217364">,</span>&nbsp;<span class="ident" id="3217366">nil</span><br>
<span class="lineno"></span><span class="op" id="3217370">}</span>
</div>
</body>
</html>
