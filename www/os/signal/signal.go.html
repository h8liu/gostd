<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4907693">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4907748">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4907802">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4907853">//&nbsp;Package&nbsp;signal&nbsp;implements&nbsp;access&nbsp;to&nbsp;incoming&nbsp;signals.</span><br>
<span class="lineno"></span><span class="keyword" id="4907910">package</span>&nbsp;<span class="ident" id="4907918">signal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4907926">//&nbsp;BUG(rsc):&nbsp;This&nbsp;package&nbsp;is&nbsp;not&nbsp;yet&nbsp;implemented&nbsp;on&nbsp;Plan&nbsp;9.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4907987">import</span>&nbsp;<span class="op" id="4907994">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4907997">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4908003">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="4908010">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4908013">var</span>&nbsp;<span class="ident" id="4908017">handlers</span>&nbsp;<span class="keyword" id="4908026">struct</span>&nbsp;<span class="op" id="4908033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908036"><a href="/os/signal/signal.go.html#4908003">sync</a></span><span class="op" id="4908040">.</span><span class="ident" id="4908041">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908048">m</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4908052">map</span><span class="op" id="4908055">[</span><span class="keyword" id="4908056">chan</span><span class="op" id="4908060">&lt;-</span>&nbsp;<span class="ident" id="4908063"><a href="/os/signal/signal.go.html#4907997">os</a></span><span class="op" id="4908065">.</span><span class="ident" id="4908066">Signal</span><span class="op" id="4908072">]</span><span class="op" id="4908073">*</span><span class="ident" id="4908074"><a href="/os/signal/signal.go.html#4908109">handler</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908083">ref</span>&nbsp;<span class="op" id="4908087">[</span><span class="ident" id="4908088"><a href="/os/signal/signal_unix.go.html#4911012">numSig</a></span><span class="op" id="4908094">]</span><span class="ident" id="4908095">int64</span><br>
<span class="lineno"></span><span class="op" id="4908101">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="4908104">type</span>&nbsp;<span class="ident" id="4908109">handler</span>&nbsp;<span class="keyword" id="4908117">struct</span>&nbsp;<span class="op" id="4908124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908127">mask</span>&nbsp;<span class="op" id="4908132">[</span><span class="op" id="4908133">(</span><span class="ident" id="4908134"><a href="/os/signal/signal_unix.go.html#4911012">numSig</a></span>&nbsp;<span class="op" id="4908141">+</span>&nbsp;<span class="num" id="4908143">31</span><span class="op" id="4908145">)</span>&nbsp;<span class="op" id="4908147">/</span>&nbsp;<span class="num" id="4908149">32</span><span class="op" id="4908151">]</span><span class="builtintype" id="4908152">uint32</span><br>
<span class="lineno"></span><span class="op" id="4908159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4908162">func</span>&nbsp;<span class="op" id="4908167">(</span><span class="ident" id="4908168">h</span>&nbsp;<span class="op" id="4908170">*</span><span class="ident" id="4908171"><a href="/os/signal/signal.go.html#4908109">handler</a></span><span class="op" id="4908178">)</span>&nbsp;<span class="ident" id="4908180">want</span><span class="op" id="4908184">(</span><span class="ident" id="4908185">sig</span>&nbsp;<span class="builtintype" id="4908189">int</span><span class="op" id="4908192">)</span>&nbsp;<span class="builtintype" id="4908194">bool</span>&nbsp;<span class="op" id="4908199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908202">return</span>&nbsp;<span class="op" id="4908209">(</span><span class="ident" id="4908210"><a href="/os/signal/signal.go.html#4908168">h</a></span><span class="op" id="4908211">.</span><span class="ident" id="4908212">mask</span><span class="op" id="4908216">[</span><span class="ident" id="4908217"><a href="/os/signal/signal.go.html#4908185">sig</a></span><span class="op" id="4908220">/</span><span class="num" id="4908221">32</span><span class="op" id="4908223">]</span><span class="op" id="4908224">&gt;&gt;</span><span class="builtintype" id="4908226">uint</span><span class="op" id="4908230">(</span><span class="ident" id="4908231"><a href="/os/signal/signal.go.html#4908185">sig</a></span><span class="op" id="4908234">&amp;</span><span class="num" id="4908235">31</span><span class="op" id="4908237">)</span><span class="op" id="4908238">)</span><span class="op" id="4908239">&amp;</span><span class="num" id="4908240">1</span>&nbsp;<span class="op" id="4908242">!=</span>&nbsp;<span class="num" id="4908245">0</span><br>
<span class="lineno"></span><span class="op" id="4908247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4908250">func</span>&nbsp;<span class="op" id="4908255">(</span><span class="ident" id="4908256">h</span>&nbsp;<span class="op" id="4908258">*</span><span class="ident" id="4908259"><a href="/os/signal/signal.go.html#4908109">handler</a></span><span class="op" id="4908266">)</span>&nbsp;<span class="ident" id="4908268">set</span><span class="op" id="4908271">(</span><span class="ident" id="4908272">sig</span>&nbsp;<span class="builtintype" id="4908276">int</span><span class="op" id="4908279">)</span>&nbsp;<span class="op" id="4908281">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908284"><a href="/os/signal/signal.go.html#4908256">h</a></span><span class="op" id="4908285">.</span><span class="ident" id="4908286">mask</span><span class="op" id="4908290">[</span><span class="ident" id="4908291"><a href="/os/signal/signal.go.html#4908272">sig</a></span><span class="op" id="4908294">/</span><span class="num" id="4908295">32</span><span class="op" id="4908297">]</span>&nbsp;<span class="op" id="4908299">|=</span>&nbsp;<span class="num" id="4908302">1</span>&nbsp;<span class="op" id="4908304">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4908307">uint</span><span class="op" id="4908311">(</span><span class="ident" id="4908312"><a href="/os/signal/signal.go.html#4908272">sig</a></span><span class="op" id="4908315">&amp;</span><span class="num" id="4908316">31</span><span class="op" id="4908318">)</span><br>
<span class="lineno"></span><span class="op" id="4908320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4908323">//&nbsp;Notify&nbsp;causes&nbsp;package&nbsp;signal&nbsp;to&nbsp;relay&nbsp;incoming&nbsp;signals&nbsp;to&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="4908387">//&nbsp;If&nbsp;no&nbsp;signals&nbsp;are&nbsp;listed,&nbsp;all&nbsp;incoming&nbsp;signals&nbsp;will&nbsp;be&nbsp;relayed&nbsp;to&nbsp;c.</span><br>
<span class="lineno">35</span><span class="comment" id="4908459">//&nbsp;Otherwise,&nbsp;just&nbsp;the&nbsp;listed&nbsp;signals&nbsp;will.</span><br>
<span class="lineno"></span><span class="comment" id="4908503">//</span><br>
<span class="lineno"></span><span class="comment" id="4908506">//&nbsp;Package&nbsp;signal&nbsp;will&nbsp;not&nbsp;block&nbsp;sending&nbsp;to&nbsp;c:&nbsp;the&nbsp;caller&nbsp;must&nbsp;ensure</span><br>
<span class="lineno"></span><span class="comment" id="4908576">//&nbsp;that&nbsp;c&nbsp;has&nbsp;sufficient&nbsp;buffer&nbsp;space&nbsp;to&nbsp;keep&nbsp;up&nbsp;with&nbsp;the&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4908643">//&nbsp;signal&nbsp;rate.&nbsp;&nbsp;For&nbsp;a&nbsp;channel&nbsp;used&nbsp;for&nbsp;notification&nbsp;of&nbsp;just&nbsp;one&nbsp;signal&nbsp;value,</span><br>
<span class="lineno">40</span><span class="comment" id="4908722">//&nbsp;a&nbsp;buffer&nbsp;of&nbsp;size&nbsp;1&nbsp;is&nbsp;sufficient.</span><br>
<span class="lineno"></span><span class="comment" id="4908759">//</span><br>
<span class="lineno"></span><span class="comment" id="4908762">//&nbsp;It&nbsp;is&nbsp;allowed&nbsp;to&nbsp;call&nbsp;Notify&nbsp;multiple&nbsp;times&nbsp;with&nbsp;the&nbsp;same&nbsp;channel:</span><br>
<span class="lineno"></span><span class="comment" id="4908832">//&nbsp;each&nbsp;call&nbsp;expands&nbsp;the&nbsp;set&nbsp;of&nbsp;signals&nbsp;sent&nbsp;to&nbsp;that&nbsp;channel.</span><br>
<span class="lineno"></span><span class="comment" id="4908894">//&nbsp;The&nbsp;only&nbsp;way&nbsp;to&nbsp;remove&nbsp;signals&nbsp;from&nbsp;the&nbsp;set&nbsp;is&nbsp;to&nbsp;call&nbsp;Stop.</span><br>
<span class="lineno">45</span><span class="comment" id="4908958">//</span><br>
<span class="lineno"></span><span class="comment" id="4908961">//&nbsp;It&nbsp;is&nbsp;allowed&nbsp;to&nbsp;call&nbsp;Notify&nbsp;multiple&nbsp;times&nbsp;with&nbsp;different&nbsp;channels</span><br>
<span class="lineno"></span><span class="comment" id="4909032">//&nbsp;and&nbsp;the&nbsp;same&nbsp;signals:&nbsp;each&nbsp;channel&nbsp;receives&nbsp;copies&nbsp;of&nbsp;incoming</span><br>
<span class="lineno"></span><span class="comment" id="4909098">//&nbsp;signals&nbsp;independently.</span><br>
<span class="lineno"></span><span class="keyword" id="4909124">func</span>&nbsp;<span class="ident" id="4909129">Notify</span><span class="op" id="4909135">(</span><span class="ident" id="4909136">c</span>&nbsp;<span class="keyword" id="4909138">chan</span><span class="op" id="4909142">&lt;-</span>&nbsp;<span class="ident" id="4909145"><a href="/os/signal/signal.go.html#4907997">os</a></span><span class="op" id="4909147">.</span><span class="ident" id="4909148">Signal</span><span class="op" id="4909154">,</span>&nbsp;<span class="ident" id="4909156">sig</span>&nbsp;<span class="op" id="4909160">...</span><span class="ident" id="4909163"><a href="/os/signal/signal.go.html#4907997">os</a></span><span class="op" id="4909165">.</span><span class="ident" id="4909166">Signal</span><span class="op" id="4909172">)</span>&nbsp;<span class="op" id="4909174">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909177">if</span>&nbsp;<span class="ident" id="4909180"><a href="/os/signal/signal.go.html#4909136">c</a></span>&nbsp;<span class="op" id="4909182">==</span>&nbsp;<span class="ident" id="4909185">nil</span>&nbsp;<span class="op" id="4909189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4909193">panic</span><span class="op" id="4909198">(</span><span class="string" id="4909199">&#34;os/signal:&nbsp;Notify&nbsp;using&nbsp;nil&nbsp;channel&#34;</span><span class="op" id="4909236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909243"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4909251">.</span><span class="ident" id="4909252">Lock</span><span class="op" id="4909256">(</span><span class="op" id="4909257">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909260">defer</span>&nbsp;<span class="ident" id="4909266"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4909274">.</span><span class="ident" id="4909275">Unlock</span><span class="op" id="4909281">(</span><span class="op" id="4909282">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909286">h</span>&nbsp;<span class="op" id="4909288">:=</span>&nbsp;<span class="ident" id="4909291"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4909299">.</span><span class="ident" id="4909300">m</span><span class="op" id="4909301">[</span><span class="ident" id="4909302"><a href="/os/signal/signal.go.html#4909136">c</a></span><span class="op" id="4909303">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909306">if</span>&nbsp;<span class="ident" id="4909309"><a href="/os/signal/signal.go.html#4909286">h</a></span>&nbsp;<span class="op" id="4909311">==</span>&nbsp;<span class="ident" id="4909314">nil</span>&nbsp;<span class="op" id="4909318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909322">if</span>&nbsp;<span class="ident" id="4909325"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4909333">.</span><span class="ident" id="4909334">m</span>&nbsp;<span class="op" id="4909336">==</span>&nbsp;<span class="ident" id="4909339">nil</span>&nbsp;<span class="op" id="4909343">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909348"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4909356">.</span><span class="ident" id="4909357">m</span>&nbsp;<span class="op" id="4909359">=</span>&nbsp;<span class="builtinfunc" id="4909361">make</span><span class="op" id="4909365">(</span><span class="keyword" id="4909366">map</span><span class="op" id="4909369">[</span><span class="keyword" id="4909370">chan</span><span class="op" id="4909374">&lt;-</span>&nbsp;<span class="ident" id="4909377"><a href="/os/signal/signal.go.html#4907997">os</a></span><span class="op" id="4909379">.</span><span class="ident" id="4909380">Signal</span><span class="op" id="4909386">]</span><span class="op" id="4909387">*</span><span class="ident" id="4909388"><a href="/os/signal/signal.go.html#4908109">handler</a></span><span class="op" id="4909395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909403"><a href="/os/signal/signal.go.html#4909286">h</a></span>&nbsp;<span class="op" id="4909405">=</span>&nbsp;<span class="builtinfunc" id="4909407">new</span><span class="op" id="4909410">(</span><span class="ident" id="4909411"><a href="/os/signal/signal.go.html#4908109">handler</a></span><span class="op" id="4909418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909422"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4909430">.</span><span class="ident" id="4909431">m</span><span class="op" id="4909432">[</span><span class="ident" id="4909433"><a href="/os/signal/signal.go.html#4909136">c</a></span><span class="op" id="4909434">]</span>&nbsp;<span class="op" id="4909436">=</span>&nbsp;<span class="ident" id="4909438"><a href="/os/signal/signal.go.html#4909286">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909441">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909445">add</span>&nbsp;<span class="op" id="4909449">:=</span>&nbsp;<span class="keyword" id="4909452">func</span><span class="op" id="4909456">(</span><span class="ident" id="4909457">n</span>&nbsp;<span class="builtintype" id="4909459">int</span><span class="op" id="4909462">)</span>&nbsp;<span class="op" id="4909464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909468">if</span>&nbsp;<span class="ident" id="4909471"><a href="/os/signal/signal.go.html#4909457">n</a></span>&nbsp;<span class="op" id="4909473">&lt;</span>&nbsp;<span class="num" id="4909475">0</span>&nbsp;<span class="op" id="4909477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909482">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909491">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909495">if</span>&nbsp;<span class="op" id="4909498">!</span><span class="ident" id="4909499"><a href="/os/signal/signal.go.html#4909286">h</a></span><span class="op" id="4909500">.</span><span class="ident" id="4909501">want</span><span class="op" id="4909505">(</span><span class="ident" id="4909506"><a href="/os/signal/signal.go.html#4909457">n</a></span><span class="op" id="4909507">)</span>&nbsp;<span class="op" id="4909509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909514"><a href="/os/signal/signal.go.html#4909286">h</a></span><span class="op" id="4909515">.</span><span class="ident" id="4909516">set</span><span class="op" id="4909519">(</span><span class="ident" id="4909520"><a href="/os/signal/signal.go.html#4909457">n</a></span><span class="op" id="4909521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909526">if</span>&nbsp;<span class="ident" id="4909529"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4909537">.</span><span class="ident" id="4909538">ref</span><span class="op" id="4909541">[</span><span class="ident" id="4909542"><a href="/os/signal/signal.go.html#4909457">n</a></span><span class="op" id="4909543">]</span>&nbsp;<span class="op" id="4909545">==</span>&nbsp;<span class="num" id="4909548">0</span>&nbsp;<span class="op" id="4909550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909556"><a href="/os/signal/signal_unix.go.html#4911241">enableSignal</a></span><span class="op" id="4909568">(</span><span class="ident" id="4909569"><a href="/os/signal/signal.go.html#4909457">n</a></span><span class="op" id="4909570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909575">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909580"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4909588">.</span><span class="ident" id="4909589">ref</span><span class="op" id="4909592">[</span><span class="ident" id="4909593"><a href="/os/signal/signal.go.html#4909457">n</a></span><span class="op" id="4909594">]</span><span class="op" id="4909595">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909607">if</span>&nbsp;<span class="builtinfunc" id="4909610">len</span><span class="op" id="4909613">(</span><span class="ident" id="4909614"><a href="/os/signal/signal.go.html#4909156">sig</a></span><span class="op" id="4909617">)</span>&nbsp;<span class="op" id="4909619">==</span>&nbsp;<span class="num" id="4909622">0</span>&nbsp;<span class="op" id="4909624">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909628">for</span>&nbsp;<span class="ident" id="4909632">n</span>&nbsp;<span class="op" id="4909634">:=</span>&nbsp;<span class="num" id="4909637">0</span><span class="op" id="4909638">;</span>&nbsp;<span class="ident" id="4909640"><a href="/os/signal/signal.go.html#4909632">n</a></span>&nbsp;<span class="op" id="4909642">&lt;</span>&nbsp;<span class="ident" id="4909644"><a href="/os/signal/signal_unix.go.html#4911012">numSig</a></span><span class="op" id="4909650">;</span>&nbsp;<span class="ident" id="4909652"><a href="/os/signal/signal.go.html#4909632">n</a></span><span class="op" id="4909653">++</span>&nbsp;<span class="op" id="4909656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909661"><a href="/os/signal/signal.go.html#4909445">add</a></span><span class="op" id="4909664">(</span><span class="ident" id="4909665"><a href="/os/signal/signal.go.html#4909632">n</a></span><span class="op" id="4909666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909673">}</span>&nbsp;<span class="keyword" id="4909675">else</span>&nbsp;<span class="op" id="4909680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909684">for</span>&nbsp;<span class="ident" id="4909688">_</span><span class="op" id="4909689">,</span>&nbsp;<span class="ident" id="4909691">s</span>&nbsp;<span class="op" id="4909693">:=</span>&nbsp;<span class="keyword" id="4909696">range</span>&nbsp;<span class="ident" id="4909702"><a href="/os/signal/signal.go.html#4909156">sig</a></span>&nbsp;<span class="op" id="4909706">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909711"><a href="/os/signal/signal.go.html#4909445">add</a></span><span class="op" id="4909714">(</span><span class="ident" id="4909715"><a href="/os/signal/signal_unix.go.html#4911058">signum</a></span><span class="op" id="4909721">(</span><span class="ident" id="4909722"><a href="/os/signal/signal.go.html#4909691">s</a></span><span class="op" id="4909723">)</span><span class="op" id="4909724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4909731">}</span><br>
<span class="lineno"></span><span class="op" id="4909733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="4909736">//&nbsp;Stop&nbsp;causes&nbsp;package&nbsp;signal&nbsp;to&nbsp;stop&nbsp;relaying&nbsp;incoming&nbsp;signals&nbsp;to&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="4909806">//&nbsp;It&nbsp;undoes&nbsp;the&nbsp;effect&nbsp;of&nbsp;all&nbsp;prior&nbsp;calls&nbsp;to&nbsp;Notify&nbsp;using&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="4909868">//&nbsp;When&nbsp;Stop&nbsp;returns,&nbsp;it&nbsp;is&nbsp;guaranteed&nbsp;that&nbsp;c&nbsp;will&nbsp;receive&nbsp;no&nbsp;more&nbsp;signals.</span><br>
<span class="lineno"></span><span class="keyword" id="4909944">func</span>&nbsp;<span class="ident" id="4909949">Stop</span><span class="op" id="4909953">(</span><span class="ident" id="4909954">c</span>&nbsp;<span class="keyword" id="4909956">chan</span><span class="op" id="4909960">&lt;-</span>&nbsp;<span class="ident" id="4909963"><a href="/os/signal/signal.go.html#4907997">os</a></span><span class="op" id="4909965">.</span><span class="ident" id="4909966">Signal</span><span class="op" id="4909972">)</span>&nbsp;<span class="op" id="4909974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909977"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4909985">.</span><span class="ident" id="4909986">Lock</span><span class="op" id="4909990">(</span><span class="op" id="4909991">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909994">defer</span>&nbsp;<span class="ident" id="4910000"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4910008">.</span><span class="ident" id="4910009">Unlock</span><span class="op" id="4910015">(</span><span class="op" id="4910016">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910020">h</span>&nbsp;<span class="op" id="4910022">:=</span>&nbsp;<span class="ident" id="4910025"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4910033">.</span><span class="ident" id="4910034">m</span><span class="op" id="4910035">[</span><span class="ident" id="4910036"><a href="/os/signal/signal.go.html#4909954">c</a></span><span class="op" id="4910037">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910040">if</span>&nbsp;<span class="ident" id="4910043"><a href="/os/signal/signal.go.html#4910020">h</a></span>&nbsp;<span class="op" id="4910045">==</span>&nbsp;<span class="ident" id="4910048">nil</span>&nbsp;<span class="op" id="4910052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910056">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4910064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4910067">delete</span><span class="op" id="4910073">(</span><span class="ident" id="4910074"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4910082">.</span><span class="ident" id="4910083">m</span><span class="op" id="4910084">,</span>&nbsp;<span class="ident" id="4910086"><a href="/os/signal/signal.go.html#4909954">c</a></span><span class="op" id="4910087">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910091">for</span>&nbsp;<span class="ident" id="4910095">n</span>&nbsp;<span class="op" id="4910097">:=</span>&nbsp;<span class="num" id="4910100">0</span><span class="op" id="4910101">;</span>&nbsp;<span class="ident" id="4910103"><a href="/os/signal/signal.go.html#4910095">n</a></span>&nbsp;<span class="op" id="4910105">&lt;</span>&nbsp;<span class="ident" id="4910107"><a href="/os/signal/signal_unix.go.html#4911012">numSig</a></span><span class="op" id="4910113">;</span>&nbsp;<span class="ident" id="4910115"><a href="/os/signal/signal.go.html#4910095">n</a></span><span class="op" id="4910116">++</span>&nbsp;<span class="op" id="4910119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910123">if</span>&nbsp;<span class="ident" id="4910126"><a href="/os/signal/signal.go.html#4910020">h</a></span><span class="op" id="4910127">.</span><span class="ident" id="4910128">want</span><span class="op" id="4910132">(</span><span class="ident" id="4910133"><a href="/os/signal/signal.go.html#4910095">n</a></span><span class="op" id="4910134">)</span>&nbsp;<span class="op" id="4910136">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910141"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4910149">.</span><span class="ident" id="4910150">ref</span><span class="op" id="4910153">[</span><span class="ident" id="4910154"><a href="/os/signal/signal.go.html#4910095">n</a></span><span class="op" id="4910155">]</span><span class="op" id="4910156">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910162">if</span>&nbsp;<span class="ident" id="4910165"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4910173">.</span><span class="ident" id="4910174">ref</span><span class="op" id="4910177">[</span><span class="ident" id="4910178"><a href="/os/signal/signal.go.html#4910095">n</a></span><span class="op" id="4910179">]</span>&nbsp;<span class="op" id="4910181">==</span>&nbsp;<span class="num" id="4910184">0</span>&nbsp;<span class="op" id="4910186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910192"><a href="/os/signal/signal_unix.go.html#4911301">disableSignal</a></span><span class="op" id="4910205">(</span><span class="ident" id="4910206"><a href="/os/signal/signal.go.html#4910095">n</a></span><span class="op" id="4910207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4910212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4910216">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4910219">}</span><br>
<span class="lineno"></span><span class="op" id="4910221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4910224">func</span>&nbsp;<span class="ident" id="4910229">process</span><span class="op" id="4910236">(</span><span class="ident" id="4910237">sig</span>&nbsp;<span class="ident" id="4910241"><a href="/os/signal/signal.go.html#4907997">os</a></span><span class="op" id="4910243">.</span><span class="ident" id="4910244">Signal</span><span class="op" id="4910250">)</span>&nbsp;<span class="op" id="4910252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910255">n</span>&nbsp;<span class="op" id="4910257">:=</span>&nbsp;<span class="ident" id="4910260"><a href="/os/signal/signal_unix.go.html#4911058">signum</a></span><span class="op" id="4910266">(</span><span class="ident" id="4910267"><a href="/os/signal/signal.go.html#4910237">sig</a></span><span class="op" id="4910270">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910273">if</span>&nbsp;<span class="ident" id="4910276"><a href="/os/signal/signal.go.html#4910255">n</a></span>&nbsp;<span class="op" id="4910278">&lt;</span>&nbsp;<span class="num" id="4910280">0</span>&nbsp;<span class="op" id="4910282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910286">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4910294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910298"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4910306">.</span><span class="ident" id="4910307">Lock</span><span class="op" id="4910311">(</span><span class="op" id="4910312">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910315">defer</span>&nbsp;<span class="ident" id="4910321"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4910329">.</span><span class="ident" id="4910330">Unlock</span><span class="op" id="4910336">(</span><span class="op" id="4910337">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910341">for</span>&nbsp;<span class="ident" id="4910345">c</span><span class="op" id="4910346">,</span>&nbsp;<span class="ident" id="4910348">h</span>&nbsp;<span class="op" id="4910350">:=</span>&nbsp;<span class="keyword" id="4910353">range</span>&nbsp;<span class="ident" id="4910359"><a href="/os/signal/signal.go.html#4908017">handlers</a></span><span class="op" id="4910367">.</span><span class="ident" id="4910368">m</span>&nbsp;<span class="op" id="4910370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910374">if</span>&nbsp;<span class="ident" id="4910377"><a href="/os/signal/signal.go.html#4910348">h</a></span><span class="op" id="4910378">.</span><span class="ident" id="4910379">want</span><span class="op" id="4910383">(</span><span class="ident" id="4910384"><a href="/os/signal/signal.go.html#4910255">n</a></span><span class="op" id="4910385">)</span>&nbsp;<span class="op" id="4910387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4910392">//&nbsp;send&nbsp;but&nbsp;do&nbsp;not&nbsp;block&nbsp;for&nbsp;it</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910427">select</span>&nbsp;<span class="op" id="4910434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910439">case</span>&nbsp;<span class="ident" id="4910444"><a href="/os/signal/signal.go.html#4910345">c</a></span>&nbsp;<span class="op" id="4910446">&lt;-</span>&nbsp;<span class="ident" id="4910449"><a href="/os/signal/signal.go.html#4910237">sig</a></span><span class="op" id="4910452">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910457">default</span><span class="op" id="4910464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4910469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4910473">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4910476">}</span><br>
<span class="lineno"></span><span class="op" id="4910478">}</span>
</div>
</body>
</html>
