<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5853138">package</span>&nbsp;<span class="ident" id="5853146">link8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5853153">type</span>&nbsp;<span class="ident" id="5853158">tracer</span>&nbsp;<span class="keyword" id="5853165">struct</span>&nbsp;<span class="op" id="5853172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853175">lnk</span>&nbsp;&nbsp;<span class="op" id="5853180">*</span><span class="ident" id="5853181">Linker</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853189">hits</span>&nbsp;<span class="op" id="5853194">[</span><span class="op" id="5853195">]</span><span class="op" id="5853196">[</span><span class="op" id="5853197">]</span><span class="builtintype" id="5853198">bool</span><br>
<span class="lineno"></span><span class="op" id="5853203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5853206">func</span>&nbsp;<span class="ident" id="5853211">newTracer</span><span class="op" id="5853220">(</span><span class="ident" id="5853221">lnk</span>&nbsp;<span class="op" id="5853225">*</span><span class="ident" id="5853226">Linker</span><span class="op" id="5853232">)</span>&nbsp;<span class="op" id="5853234">*</span><span class="ident" id="5853235">tracer</span>&nbsp;<span class="op" id="5853242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853245">npkg</span>&nbsp;<span class="op" id="5853250">:=</span>&nbsp;<span class="ident" id="5853253">lnk</span><span class="op" id="5853256">.</span><span class="ident" id="5853257">Npkg</span><span class="op" id="5853261">(</span><span class="op" id="5853262">)</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853265">ret</span>&nbsp;<span class="op" id="5853269">:=</span>&nbsp;<span class="builtinfunc" id="5853272">new</span><span class="op" id="5853275">(</span><span class="ident" id="5853276">tracer</span><span class="op" id="5853282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853285">ret</span><span class="op" id="5853288">.</span><span class="ident" id="5853289">lnk</span>&nbsp;<span class="op" id="5853293">=</span>&nbsp;<span class="ident" id="5853295">lnk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853300">ret</span><span class="op" id="5853303">.</span><span class="ident" id="5853304">hits</span>&nbsp;<span class="op" id="5853309">=</span>&nbsp;<span class="builtinfunc" id="5853311">make</span><span class="op" id="5853315">(</span><span class="op" id="5853316">[</span><span class="op" id="5853317">]</span><span class="op" id="5853318">[</span><span class="op" id="5853319">]</span><span class="builtintype" id="5853320">bool</span><span class="op" id="5853324">,</span>&nbsp;<span class="ident" id="5853326">npkg</span><span class="op" id="5853330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853333">for</span>&nbsp;<span class="ident" id="5853337">i</span>&nbsp;<span class="op" id="5853339">:=</span>&nbsp;<span class="num" id="5853342">0</span><span class="op" id="5853343">;</span>&nbsp;<span class="ident" id="5853345">i</span>&nbsp;<span class="op" id="5853347">&lt;</span>&nbsp;<span class="ident" id="5853349">npkg</span><span class="op" id="5853353">;</span>&nbsp;<span class="ident" id="5853355">i</span><span class="op" id="5853356">++</span>&nbsp;<span class="op" id="5853359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853363">p</span>&nbsp;<span class="op" id="5853365">:=</span>&nbsp;<span class="ident" id="5853368">lnk</span><span class="op" id="5853371">.</span><span class="ident" id="5853372">Pkg</span><span class="op" id="5853375">(</span><span class="ident" id="5853376">i</span><span class="op" id="5853377">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853381">ret</span><span class="op" id="5853384">.</span><span class="ident" id="5853385">hits</span><span class="op" id="5853389">[</span><span class="ident" id="5853390">i</span><span class="op" id="5853391">]</span>&nbsp;<span class="op" id="5853393">=</span>&nbsp;<span class="builtinfunc" id="5853395">make</span><span class="op" id="5853399">(</span><span class="op" id="5853400">[</span><span class="op" id="5853401">]</span><span class="builtintype" id="5853402">bool</span><span class="op" id="5853406">,</span>&nbsp;<span class="builtinfunc" id="5853408">len</span><span class="op" id="5853411">(</span><span class="ident" id="5853412">p</span><span class="op" id="5853413">.</span><span class="ident" id="5853414">symbols</span><span class="op" id="5853421">)</span><span class="op" id="5853422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5853425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853429">return</span>&nbsp;<span class="ident" id="5853436">ret</span><br>
<span class="lineno"></span><span class="op" id="5853440">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5853443">func</span>&nbsp;<span class="op" id="5853448">(</span><span class="ident" id="5853449">t</span>&nbsp;<span class="op" id="5853451">*</span><span class="ident" id="5853452">tracer</span><span class="op" id="5853458">)</span>&nbsp;<span class="ident" id="5853460">hit</span><span class="op" id="5853463">(</span><span class="ident" id="5853464">pkg</span>&nbsp;<span class="op" id="5853468">*</span><span class="ident" id="5853469">Package</span><span class="op" id="5853476">,</span>&nbsp;<span class="ident" id="5853478">sym</span>&nbsp;<span class="builtintype" id="5853482">uint32</span><span class="op" id="5853488">)</span>&nbsp;<span class="builtintype" id="5853490">bool</span>&nbsp;<span class="op" id="5853495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853498">i</span>&nbsp;<span class="op" id="5853500">:=</span>&nbsp;<span class="ident" id="5853503">t</span><span class="op" id="5853504">.</span><span class="ident" id="5853505">lnk</span><span class="op" id="5853508">.</span><span class="ident" id="5853509">PkgIndex</span><span class="op" id="5853517">(</span><span class="ident" id="5853518">pkg</span><span class="op" id="5853521">.</span><span class="ident" id="5853522">path</span><span class="op" id="5853526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853529">pt</span>&nbsp;<span class="op" id="5853532">:=</span>&nbsp;<span class="op" id="5853535">&amp;</span><span class="ident" id="5853536">t</span><span class="op" id="5853537">.</span><span class="ident" id="5853538">hits</span><span class="op" id="5853542">[</span><span class="ident" id="5853543">i</span><span class="op" id="5853544">]</span><span class="op" id="5853545">[</span><span class="ident" id="5853546">sym</span><span class="op" id="5853549">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853552">ret</span>&nbsp;<span class="op" id="5853556">:=</span>&nbsp;<span class="op" id="5853559">*</span><span class="ident" id="5853560">pt</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5853564">*</span><span class="ident" id="5853565">pt</span>&nbsp;<span class="op" id="5853568">=</span>&nbsp;<span class="ident" id="5853570">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853576">return</span>&nbsp;<span class="ident" id="5853583">ret</span><br>
<span class="lineno"></span><span class="op" id="5853587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5853590">func</span>&nbsp;<span class="ident" id="5853595">traceUsed</span><span class="op" id="5853604">(</span><span class="ident" id="5853605">lnk</span>&nbsp;<span class="op" id="5853609">*</span><span class="ident" id="5853610">Linker</span><span class="op" id="5853616">,</span>&nbsp;<span class="ident" id="5853618">p</span>&nbsp;<span class="op" id="5853620">*</span><span class="ident" id="5853621">Package</span><span class="op" id="5853628">,</span>&nbsp;<span class="ident" id="5853630">index</span>&nbsp;<span class="builtintype" id="5853636">uint32</span><span class="op" id="5853642">)</span>&nbsp;<span class="op" id="5853644">[</span><span class="op" id="5853645">]</span><span class="ident" id="5853646">pkgSym</span>&nbsp;<span class="op" id="5853653">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853656">t</span>&nbsp;<span class="op" id="5853658">:=</span>&nbsp;<span class="ident" id="5853661">newTracer</span><span class="op" id="5853670">(</span><span class="ident" id="5853671">lnk</span><span class="op" id="5853674">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853678">cur</span>&nbsp;<span class="op" id="5853682">:=</span>&nbsp;<span class="op" id="5853685">[</span><span class="op" id="5853686">]</span><span class="ident" id="5853687">pkgSym</span><span class="op" id="5853693">{</span><span class="op" id="5853694">{</span><span class="ident" id="5853695">p</span><span class="op" id="5853696">,</span>&nbsp;<span class="ident" id="5853698">index</span><span class="op" id="5853703">}</span><span class="op" id="5853704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853707">var</span>&nbsp;<span class="ident" id="5853711">next</span>&nbsp;<span class="op" id="5853716">[</span><span class="op" id="5853717">]</span><span class="ident" id="5853718">pkgSym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853726">var</span>&nbsp;<span class="ident" id="5853730">ret</span>&nbsp;<span class="op" id="5853734">[</span><span class="op" id="5853735">]</span><span class="ident" id="5853736">pkgSym</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853745">//&nbsp;BFS&nbsp;traverse&nbsp;all&nbsp;the&nbsp;symbols&nbsp;used&nbsp;by&nbsp;the&nbsp;symbol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853797">for</span>&nbsp;<span class="builtinfunc" id="5853801">len</span><span class="op" id="5853804">(</span><span class="ident" id="5853805">cur</span><span class="op" id="5853808">)</span>&nbsp;<span class="op" id="5853810">&gt;</span>&nbsp;<span class="num" id="5853812">0</span>&nbsp;<span class="op" id="5853814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853818">for</span>&nbsp;<span class="ident" id="5853822">_</span><span class="op" id="5853823">,</span>&nbsp;<span class="ident" id="5853825">ps</span>&nbsp;<span class="op" id="5853828">:=</span>&nbsp;<span class="keyword" id="5853831">range</span>&nbsp;<span class="ident" id="5853837">cur</span>&nbsp;<span class="op" id="5853841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853846">ret</span>&nbsp;<span class="op" id="5853850">=</span>&nbsp;<span class="builtinfunc" id="5853852">append</span><span class="op" id="5853858">(</span><span class="ident" id="5853859">ret</span><span class="op" id="5853862">,</span>&nbsp;<span class="ident" id="5853864">ps</span><span class="op" id="5853866">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853872">typ</span>&nbsp;<span class="op" id="5853876">:=</span>&nbsp;<span class="ident" id="5853879">ps</span><span class="op" id="5853881">.</span><span class="ident" id="5853882">Type</span><span class="op" id="5853886">(</span><span class="op" id="5853887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853892">if</span>&nbsp;<span class="ident" id="5853895">typ</span>&nbsp;<span class="op" id="5853899">==</span>&nbsp;<span class="ident" id="5853902">SymFunc</span>&nbsp;<span class="op" id="5853910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853916">f</span>&nbsp;<span class="op" id="5853918">:=</span>&nbsp;<span class="ident" id="5853921">ps</span><span class="op" id="5853923">.</span><span class="ident" id="5853924">Func</span><span class="op" id="5853928">(</span><span class="op" id="5853929">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853936">for</span>&nbsp;<span class="ident" id="5853940">_</span><span class="op" id="5853941">,</span>&nbsp;<span class="ident" id="5853943">link</span>&nbsp;<span class="op" id="5853948">:=</span>&nbsp;<span class="keyword" id="5853951">range</span>&nbsp;<span class="ident" id="5853957">f</span><span class="op" id="5853958">.</span><span class="ident" id="5853959">links</span>&nbsp;<span class="op" id="5853965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853972">pkg</span>&nbsp;<span class="op" id="5853976">:=</span>&nbsp;<span class="ident" id="5853979">ps</span><span class="op" id="5853981">.</span><span class="ident" id="5853982">Import</span><span class="op" id="5853988">(</span><span class="ident" id="5853989">link</span><span class="op" id="5853993">.</span><span class="ident" id="5853994">pkg</span><span class="op" id="5853997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5854004">if</span>&nbsp;<span class="ident" id="5854007">t</span><span class="op" id="5854008">.</span><span class="ident" id="5854009">hit</span><span class="op" id="5854012">(</span><span class="ident" id="5854013">pkg</span><span class="op" id="5854016">,</span>&nbsp;<span class="ident" id="5854018">link</span><span class="op" id="5854022">.</span><span class="ident" id="5854023">sym</span><span class="op" id="5854026">)</span>&nbsp;<span class="op" id="5854028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5854036">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854050">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854058">item</span>&nbsp;<span class="op" id="5854063">:=</span>&nbsp;<span class="ident" id="5854066">pkgSym</span><span class="op" id="5854072">{</span><span class="ident" id="5854073">pkg</span><span class="op" id="5854076">,</span>&nbsp;<span class="ident" id="5854078">link</span><span class="op" id="5854082">.</span><span class="ident" id="5854083">sym</span><span class="op" id="5854086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854093">next</span>&nbsp;<span class="op" id="5854098">=</span>&nbsp;<span class="builtinfunc" id="5854100">append</span><span class="op" id="5854106">(</span><span class="ident" id="5854107">next</span><span class="op" id="5854111">,</span>&nbsp;<span class="ident" id="5854113">item</span><span class="op" id="5854117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854128">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854137">cur</span>&nbsp;<span class="op" id="5854141">=</span>&nbsp;<span class="ident" id="5854143">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854150">next</span>&nbsp;<span class="op" id="5854155">=</span>&nbsp;<span class="ident" id="5854157">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854162">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5854166">return</span>&nbsp;<span class="ident" id="5854173">ret</span><br>
<span class="lineno"></span><span class="op" id="5854177">}</span>
</div>
</body>
</html>
