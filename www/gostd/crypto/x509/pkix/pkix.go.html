<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509/pkix</h2>
<ul>
<li><a href="/gostd/crypto/x509/pkix/pkix.go.html" class="current">pkix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4227998">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4228053">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4228107">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4228158">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="4228235">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="4228293">package</span>&nbsp;<span class="ident" id="4228301">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4228307">import</span>&nbsp;<span class="op" id="4228314">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4228317">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4228334">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4228346">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4228353">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4228356">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4228436">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4228462">type</span>&nbsp;<span class="ident" id="4228467">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="4228487">struct</span>&nbsp;<span class="op" id="4228494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4228497">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="4228508">asn1</span><span class="op" id="4228512">.</span><span class="ident" id="4228513">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4228531">Parameters</span>&nbsp;<span class="ident" id="4228542">asn1</span><span class="op" id="4228546">.</span><span class="ident" id="4228547">RawValue</span>&nbsp;<span class="string" id="4228556">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="4228574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4228577">type</span>&nbsp;<span class="ident" id="4228582">RDNSequence</span>&nbsp;<span class="op" id="4228594">[</span><span class="op" id="4228595">]</span><span class="ident" id="4228596">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4228626">type</span>&nbsp;<span class="ident" id="4228631">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="4228660">[</span><span class="op" id="4228661">]</span><span class="ident" id="4228662">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4228685">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4228758">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="4228812">type</span>&nbsp;<span class="ident" id="4228817">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="4228839">struct</span>&nbsp;<span class="op" id="4228846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4228849">Type</span>&nbsp;&nbsp;<span class="ident" id="4228855">asn1</span><span class="op" id="4228859">.</span><span class="ident" id="4228860">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4228878">Value</span>&nbsp;<span class="keyword" id="4228884">interface</span><span class="op" id="4228893">{</span><span class="op" id="4228894">}</span><br>
<span class="lineno"></span><span class="op" id="4228896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4228899">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4228966">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="4229027">type</span>&nbsp;<span class="ident" id="4229032">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="4229057">struct</span>&nbsp;<span class="op" id="4229064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229067">Type</span>&nbsp;&nbsp;<span class="ident" id="4229073">asn1</span><span class="op" id="4229077">.</span><span class="ident" id="4229078">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229096">Value</span>&nbsp;<span class="op" id="4229102">[</span><span class="op" id="4229103">]</span><span class="op" id="4229104">[</span><span class="op" id="4229105">]</span><span class="ident" id="4229106">AttributeTypeAndValue</span>&nbsp;<span class="string" id="4229128">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4229141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4229144">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4229214">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4229236">type</span>&nbsp;<span class="ident" id="4229241">Extension</span>&nbsp;<span class="keyword" id="4229251">struct</span>&nbsp;<span class="op" id="4229258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229261">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229270">asn1</span><span class="op" id="4229274">.</span><span class="ident" id="4229275">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229293">Critical</span>&nbsp;<span class="builtintype" id="4229302">bool</span>&nbsp;<span class="string" id="4229307">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229326">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4229335">[</span><span class="op" id="4229336">]</span><span class="builtintype" id="4229337">byte</span><br>
<span class="lineno"></span><span class="op" id="4229342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4229345">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4229423">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="4229490">type</span>&nbsp;<span class="ident" id="4229495">Name</span>&nbsp;<span class="keyword" id="4229500">struct</span>&nbsp;<span class="op" id="4229507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229510">Country</span><span class="op" id="4229517">,</span>&nbsp;<span class="ident" id="4229519">Organization</span><span class="op" id="4229531">,</span>&nbsp;<span class="ident" id="4229533">OrganizationalUnit</span>&nbsp;<span class="op" id="4229552">[</span><span class="op" id="4229553">]</span><span class="builtintype" id="4229554">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229562">Locality</span><span class="op" id="4229570">,</span>&nbsp;<span class="ident" id="4229572">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4229604">[</span><span class="op" id="4229605">]</span><span class="builtintype" id="4229606">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229614">StreetAddress</span><span class="op" id="4229627">,</span>&nbsp;<span class="ident" id="4229629">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4229656">[</span><span class="op" id="4229657">]</span><span class="builtintype" id="4229658">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229666">SerialNumber</span><span class="op" id="4229678">,</span>&nbsp;<span class="ident" id="4229680">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4229708">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229717">Names</span>&nbsp;<span class="op" id="4229723">[</span><span class="op" id="4229724">]</span><span class="ident" id="4229725">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="4229747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4229750">func</span>&nbsp;<span class="op" id="4229755">(</span><span class="ident" id="4229756">n</span>&nbsp;<span class="op" id="4229758">*</span><span class="ident" id="4229759">Name</span><span class="op" id="4229763">)</span>&nbsp;<span class="ident" id="4229765">FillFromRDNSequence</span><span class="op" id="4229784">(</span><span class="ident" id="4229785">rdns</span>&nbsp;<span class="op" id="4229790">*</span><span class="ident" id="4229791">RDNSequence</span><span class="op" id="4229802">)</span>&nbsp;<span class="op" id="4229804">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4229807">for</span>&nbsp;<span class="ident" id="4229811">_</span><span class="op" id="4229812">,</span>&nbsp;<span class="ident" id="4229814">rdn</span>&nbsp;<span class="op" id="4229818">:=</span>&nbsp;<span class="keyword" id="4229821">range</span>&nbsp;<span class="op" id="4229827">*</span><span class="ident" id="4229828">rdns</span>&nbsp;<span class="op" id="4229833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4229837">if</span>&nbsp;<span class="builtinfunc" id="4229840">len</span><span class="op" id="4229843">(</span><span class="ident" id="4229844">rdn</span><span class="op" id="4229847">)</span>&nbsp;<span class="op" id="4229849">==</span>&nbsp;<span class="num" id="4229852">0</span>&nbsp;<span class="op" id="4229854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4229859">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4229870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229874">atv</span>&nbsp;<span class="op" id="4229878">:=</span>&nbsp;<span class="ident" id="4229881">rdn</span><span class="op" id="4229884">[</span><span class="num" id="4229885">0</span><span class="op" id="4229886">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229890">n</span><span class="op" id="4229891">.</span><span class="ident" id="4229892">Names</span>&nbsp;<span class="op" id="4229898">=</span>&nbsp;<span class="builtinfunc" id="4229900">append</span><span class="op" id="4229906">(</span><span class="ident" id="4229907">n</span><span class="op" id="4229908">.</span><span class="ident" id="4229909">Names</span><span class="op" id="4229914">,</span>&nbsp;<span class="ident" id="4229916">atv</span><span class="op" id="4229919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229923">value</span><span class="op" id="4229928">,</span>&nbsp;<span class="ident" id="4229930">ok</span>&nbsp;<span class="op" id="4229933">:=</span>&nbsp;<span class="ident" id="4229936">atv</span><span class="op" id="4229939">.</span><span class="ident" id="4229940">Value</span><span class="op" id="4229945">.</span><span class="op" id="4229946">(</span><span class="builtintype" id="4229947">string</span><span class="op" id="4229953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4229957">if</span>&nbsp;<span class="op" id="4229960">!</span><span class="ident" id="4229961">ok</span>&nbsp;<span class="op" id="4229964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4229969">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4229980">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4229985">t</span>&nbsp;<span class="op" id="4229987">:=</span>&nbsp;<span class="ident" id="4229990">atv</span><span class="op" id="4229993">.</span><span class="ident" id="4229994">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230001">if</span>&nbsp;<span class="builtinfunc" id="4230004">len</span><span class="op" id="4230007">(</span><span class="ident" id="4230008">t</span><span class="op" id="4230009">)</span>&nbsp;<span class="op" id="4230011">==</span>&nbsp;<span class="num" id="4230014">4</span>&nbsp;<span class="op" id="4230016">&amp;&amp;</span>&nbsp;<span class="ident" id="4230019">t</span><span class="op" id="4230020">[</span><span class="num" id="4230021">0</span><span class="op" id="4230022">]</span>&nbsp;<span class="op" id="4230024">==</span>&nbsp;<span class="num" id="4230027">2</span>&nbsp;<span class="op" id="4230029">&amp;&amp;</span>&nbsp;<span class="ident" id="4230032">t</span><span class="op" id="4230033">[</span><span class="num" id="4230034">1</span><span class="op" id="4230035">]</span>&nbsp;<span class="op" id="4230037">==</span>&nbsp;<span class="num" id="4230040">5</span>&nbsp;<span class="op" id="4230042">&amp;&amp;</span>&nbsp;<span class="ident" id="4230045">t</span><span class="op" id="4230046">[</span><span class="num" id="4230047">2</span><span class="op" id="4230048">]</span>&nbsp;<span class="op" id="4230050">==</span>&nbsp;<span class="num" id="4230053">4</span>&nbsp;<span class="op" id="4230055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230060">switch</span>&nbsp;<span class="ident" id="4230067">t</span><span class="op" id="4230068">[</span><span class="num" id="4230069">3</span><span class="op" id="4230070">]</span>&nbsp;<span class="op" id="4230072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230077">case</span>&nbsp;<span class="num" id="4230082">3</span><span class="op" id="4230083">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230089">n</span><span class="op" id="4230090">.</span><span class="ident" id="4230091">CommonName</span>&nbsp;<span class="op" id="4230102">=</span>&nbsp;<span class="ident" id="4230104">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230113">case</span>&nbsp;<span class="num" id="4230118">5</span><span class="op" id="4230119">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230125">n</span><span class="op" id="4230126">.</span><span class="ident" id="4230127">SerialNumber</span>&nbsp;<span class="op" id="4230140">=</span>&nbsp;<span class="ident" id="4230142">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230151">case</span>&nbsp;<span class="num" id="4230156">6</span><span class="op" id="4230157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230163">n</span><span class="op" id="4230164">.</span><span class="ident" id="4230165">Country</span>&nbsp;<span class="op" id="4230173">=</span>&nbsp;<span class="builtinfunc" id="4230175">append</span><span class="op" id="4230181">(</span><span class="ident" id="4230182">n</span><span class="op" id="4230183">.</span><span class="ident" id="4230184">Country</span><span class="op" id="4230191">,</span>&nbsp;<span class="ident" id="4230193">value</span><span class="op" id="4230198">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230203">case</span>&nbsp;<span class="num" id="4230208">7</span><span class="op" id="4230209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230215">n</span><span class="op" id="4230216">.</span><span class="ident" id="4230217">Locality</span>&nbsp;<span class="op" id="4230226">=</span>&nbsp;<span class="builtinfunc" id="4230228">append</span><span class="op" id="4230234">(</span><span class="ident" id="4230235">n</span><span class="op" id="4230236">.</span><span class="ident" id="4230237">Locality</span><span class="op" id="4230245">,</span>&nbsp;<span class="ident" id="4230247">value</span><span class="op" id="4230252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230257">case</span>&nbsp;<span class="num" id="4230262">8</span><span class="op" id="4230263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230269">n</span><span class="op" id="4230270">.</span><span class="ident" id="4230271">Province</span>&nbsp;<span class="op" id="4230280">=</span>&nbsp;<span class="builtinfunc" id="4230282">append</span><span class="op" id="4230288">(</span><span class="ident" id="4230289">n</span><span class="op" id="4230290">.</span><span class="ident" id="4230291">Province</span><span class="op" id="4230299">,</span>&nbsp;<span class="ident" id="4230301">value</span><span class="op" id="4230306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230311">case</span>&nbsp;<span class="num" id="4230316">9</span><span class="op" id="4230317">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230323">n</span><span class="op" id="4230324">.</span><span class="ident" id="4230325">StreetAddress</span>&nbsp;<span class="op" id="4230339">=</span>&nbsp;<span class="builtinfunc" id="4230341">append</span><span class="op" id="4230347">(</span><span class="ident" id="4230348">n</span><span class="op" id="4230349">.</span><span class="ident" id="4230350">StreetAddress</span><span class="op" id="4230363">,</span>&nbsp;<span class="ident" id="4230365">value</span><span class="op" id="4230370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230375">case</span>&nbsp;<span class="num" id="4230380">10</span><span class="op" id="4230382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230388">n</span><span class="op" id="4230389">.</span><span class="ident" id="4230390">Organization</span>&nbsp;<span class="op" id="4230403">=</span>&nbsp;<span class="builtinfunc" id="4230405">append</span><span class="op" id="4230411">(</span><span class="ident" id="4230412">n</span><span class="op" id="4230413">.</span><span class="ident" id="4230414">Organization</span><span class="op" id="4230426">,</span>&nbsp;<span class="ident" id="4230428">value</span><span class="op" id="4230433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230438">case</span>&nbsp;<span class="num" id="4230443">11</span><span class="op" id="4230445">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230451">n</span><span class="op" id="4230452">.</span><span class="ident" id="4230453">OrganizationalUnit</span>&nbsp;<span class="op" id="4230472">=</span>&nbsp;<span class="builtinfunc" id="4230474">append</span><span class="op" id="4230480">(</span><span class="ident" id="4230481">n</span><span class="op" id="4230482">.</span><span class="ident" id="4230483">OrganizationalUnit</span><span class="op" id="4230501">,</span>&nbsp;<span class="ident" id="4230503">value</span><span class="op" id="4230508">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4230513">case</span>&nbsp;<span class="num" id="4230518">17</span><span class="op" id="4230520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230526">n</span><span class="op" id="4230527">.</span><span class="ident" id="4230528">PostalCode</span>&nbsp;<span class="op" id="4230539">=</span>&nbsp;<span class="builtinfunc" id="4230541">append</span><span class="op" id="4230547">(</span><span class="ident" id="4230548">n</span><span class="op" id="4230549">.</span><span class="ident" id="4230550">PostalCode</span><span class="op" id="4230560">,</span>&nbsp;<span class="ident" id="4230562">value</span><span class="op" id="4230567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230579">}</span><br>
<span class="lineno">95</span><span class="op" id="4230581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4230584">var</span>&nbsp;<span class="op" id="4230588">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230591">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230613">=</span>&nbsp;<span class="op" id="4230615">[</span><span class="op" id="4230616">]</span><span class="builtintype" id="4230617">int</span><span class="op" id="4230620">{</span><span class="num" id="4230621">2</span><span class="op" id="4230622">,</span>&nbsp;<span class="num" id="4230624">5</span><span class="op" id="4230625">,</span>&nbsp;<span class="num" id="4230627">4</span><span class="op" id="4230628">,</span>&nbsp;<span class="num" id="4230630">6</span><span class="op" id="4230631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230634">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230656">=</span>&nbsp;<span class="op" id="4230658">[</span><span class="op" id="4230659">]</span><span class="builtintype" id="4230660">int</span><span class="op" id="4230663">{</span><span class="num" id="4230664">2</span><span class="op" id="4230665">,</span>&nbsp;<span class="num" id="4230667">5</span><span class="op" id="4230668">,</span>&nbsp;<span class="num" id="4230670">4</span><span class="op" id="4230671">,</span>&nbsp;<span class="num" id="4230673">10</span><span class="op" id="4230675">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230678">oidOrganizationalUnit</span>&nbsp;<span class="op" id="4230700">=</span>&nbsp;<span class="op" id="4230702">[</span><span class="op" id="4230703">]</span><span class="builtintype" id="4230704">int</span><span class="op" id="4230707">{</span><span class="num" id="4230708">2</span><span class="op" id="4230709">,</span>&nbsp;<span class="num" id="4230711">5</span><span class="op" id="4230712">,</span>&nbsp;<span class="num" id="4230714">4</span><span class="op" id="4230715">,</span>&nbsp;<span class="num" id="4230717">11</span><span class="op" id="4230719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230722">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230744">=</span>&nbsp;<span class="op" id="4230746">[</span><span class="op" id="4230747">]</span><span class="builtintype" id="4230748">int</span><span class="op" id="4230751">{</span><span class="num" id="4230752">2</span><span class="op" id="4230753">,</span>&nbsp;<span class="num" id="4230755">5</span><span class="op" id="4230756">,</span>&nbsp;<span class="num" id="4230758">4</span><span class="op" id="4230759">,</span>&nbsp;<span class="num" id="4230761">3</span><span class="op" id="4230762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230765">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230787">=</span>&nbsp;<span class="op" id="4230789">[</span><span class="op" id="4230790">]</span><span class="builtintype" id="4230791">int</span><span class="op" id="4230794">{</span><span class="num" id="4230795">2</span><span class="op" id="4230796">,</span>&nbsp;<span class="num" id="4230798">5</span><span class="op" id="4230799">,</span>&nbsp;<span class="num" id="4230801">4</span><span class="op" id="4230802">,</span>&nbsp;<span class="num" id="4230804">5</span><span class="op" id="4230805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230808">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230830">=</span>&nbsp;<span class="op" id="4230832">[</span><span class="op" id="4230833">]</span><span class="builtintype" id="4230834">int</span><span class="op" id="4230837">{</span><span class="num" id="4230838">2</span><span class="op" id="4230839">,</span>&nbsp;<span class="num" id="4230841">5</span><span class="op" id="4230842">,</span>&nbsp;<span class="num" id="4230844">4</span><span class="op" id="4230845">,</span>&nbsp;<span class="num" id="4230847">7</span><span class="op" id="4230848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230851">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230873">=</span>&nbsp;<span class="op" id="4230875">[</span><span class="op" id="4230876">]</span><span class="builtintype" id="4230877">int</span><span class="op" id="4230880">{</span><span class="num" id="4230881">2</span><span class="op" id="4230882">,</span>&nbsp;<span class="num" id="4230884">5</span><span class="op" id="4230885">,</span>&nbsp;<span class="num" id="4230887">4</span><span class="op" id="4230888">,</span>&nbsp;<span class="num" id="4230890">8</span><span class="op" id="4230891">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230894">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230916">=</span>&nbsp;<span class="op" id="4230918">[</span><span class="op" id="4230919">]</span><span class="builtintype" id="4230920">int</span><span class="op" id="4230923">{</span><span class="num" id="4230924">2</span><span class="op" id="4230925">,</span>&nbsp;<span class="num" id="4230927">5</span><span class="op" id="4230928">,</span>&nbsp;<span class="num" id="4230930">4</span><span class="op" id="4230931">,</span>&nbsp;<span class="num" id="4230933">9</span><span class="op" id="4230934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4230937">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4230959">=</span>&nbsp;<span class="op" id="4230961">[</span><span class="op" id="4230962">]</span><span class="builtintype" id="4230963">int</span><span class="op" id="4230966">{</span><span class="num" id="4230967">2</span><span class="op" id="4230968">,</span>&nbsp;<span class="num" id="4230970">5</span><span class="op" id="4230971">,</span>&nbsp;<span class="num" id="4230973">4</span><span class="op" id="4230974">,</span>&nbsp;<span class="num" id="4230976">17</span><span class="op" id="4230978">}</span><br>
<span class="lineno"></span><span class="op" id="4230980">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4230983">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="4231061">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4231136">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4231214">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="4231251">func</span>&nbsp;<span class="ident" id="4231256">appendRDNs</span><span class="op" id="4231266">(</span><span class="ident" id="4231267">in</span>&nbsp;<span class="ident" id="4231270">RDNSequence</span><span class="op" id="4231281">,</span>&nbsp;<span class="ident" id="4231283">values</span>&nbsp;<span class="op" id="4231290">[</span><span class="op" id="4231291">]</span><span class="builtintype" id="4231292">string</span><span class="op" id="4231298">,</span>&nbsp;<span class="ident" id="4231300">oid</span>&nbsp;<span class="ident" id="4231304">asn1</span><span class="op" id="4231308">.</span><span class="ident" id="4231309">ObjectIdentifier</span><span class="op" id="4231325">)</span>&nbsp;<span class="ident" id="4231327">RDNSequence</span>&nbsp;<span class="op" id="4231339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231342">if</span>&nbsp;<span class="builtinfunc" id="4231345">len</span><span class="op" id="4231348">(</span><span class="ident" id="4231349">values</span><span class="op" id="4231355">)</span>&nbsp;<span class="op" id="4231357">==</span>&nbsp;<span class="num" id="4231360">0</span>&nbsp;<span class="op" id="4231362">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231366">return</span>&nbsp;<span class="ident" id="4231373">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4231377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231381">s</span>&nbsp;<span class="op" id="4231383">:=</span>&nbsp;<span class="builtinfunc" id="4231386">make</span><span class="op" id="4231390">(</span><span class="op" id="4231391">[</span><span class="op" id="4231392">]</span><span class="ident" id="4231393">AttributeTypeAndValue</span><span class="op" id="4231414">,</span>&nbsp;<span class="builtinfunc" id="4231416">len</span><span class="op" id="4231419">(</span><span class="ident" id="4231420">values</span><span class="op" id="4231426">)</span><span class="op" id="4231427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231430">for</span>&nbsp;<span class="ident" id="4231434">i</span><span class="op" id="4231435">,</span>&nbsp;<span class="ident" id="4231437">value</span>&nbsp;<span class="op" id="4231443">:=</span>&nbsp;<span class="keyword" id="4231446">range</span>&nbsp;<span class="ident" id="4231452">values</span>&nbsp;<span class="op" id="4231459">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231463">s</span><span class="op" id="4231464">[</span><span class="ident" id="4231465">i</span><span class="op" id="4231466">]</span><span class="op" id="4231467">.</span><span class="ident" id="4231468">Type</span>&nbsp;<span class="op" id="4231473">=</span>&nbsp;<span class="ident" id="4231475">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231481">s</span><span class="op" id="4231482">[</span><span class="ident" id="4231483">i</span><span class="op" id="4231484">]</span><span class="op" id="4231485">.</span><span class="ident" id="4231486">Value</span>&nbsp;<span class="op" id="4231492">=</span>&nbsp;<span class="ident" id="4231494">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4231501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231505">return</span>&nbsp;<span class="builtinfunc" id="4231512">append</span><span class="op" id="4231518">(</span><span class="ident" id="4231519">in</span><span class="op" id="4231521">,</span>&nbsp;<span class="ident" id="4231523">s</span><span class="op" id="4231524">)</span><br>
<span class="lineno">125</span><span class="op" id="4231526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4231529">func</span>&nbsp;<span class="op" id="4231534">(</span><span class="ident" id="4231535">n</span>&nbsp;<span class="ident" id="4231537">Name</span><span class="op" id="4231541">)</span>&nbsp;<span class="ident" id="4231543">ToRDNSequence</span><span class="op" id="4231556">(</span><span class="op" id="4231557">)</span>&nbsp;<span class="op" id="4231559">(</span><span class="ident" id="4231560">ret</span>&nbsp;<span class="ident" id="4231564">RDNSequence</span><span class="op" id="4231575">)</span>&nbsp;<span class="op" id="4231577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231580">ret</span>&nbsp;<span class="op" id="4231584">=</span>&nbsp;<span class="ident" id="4231586">appendRDNs</span><span class="op" id="4231596">(</span><span class="ident" id="4231597">ret</span><span class="op" id="4231600">,</span>&nbsp;<span class="ident" id="4231602">n</span><span class="op" id="4231603">.</span><span class="ident" id="4231604">Country</span><span class="op" id="4231611">,</span>&nbsp;<span class="ident" id="4231613">oidCountry</span><span class="op" id="4231623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231626">ret</span>&nbsp;<span class="op" id="4231630">=</span>&nbsp;<span class="ident" id="4231632">appendRDNs</span><span class="op" id="4231642">(</span><span class="ident" id="4231643">ret</span><span class="op" id="4231646">,</span>&nbsp;<span class="ident" id="4231648">n</span><span class="op" id="4231649">.</span><span class="ident" id="4231650">Organization</span><span class="op" id="4231662">,</span>&nbsp;<span class="ident" id="4231664">oidOrganization</span><span class="op" id="4231679">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231682">ret</span>&nbsp;<span class="op" id="4231686">=</span>&nbsp;<span class="ident" id="4231688">appendRDNs</span><span class="op" id="4231698">(</span><span class="ident" id="4231699">ret</span><span class="op" id="4231702">,</span>&nbsp;<span class="ident" id="4231704">n</span><span class="op" id="4231705">.</span><span class="ident" id="4231706">OrganizationalUnit</span><span class="op" id="4231724">,</span>&nbsp;<span class="ident" id="4231726">oidOrganizationalUnit</span><span class="op" id="4231747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231750">ret</span>&nbsp;<span class="op" id="4231754">=</span>&nbsp;<span class="ident" id="4231756">appendRDNs</span><span class="op" id="4231766">(</span><span class="ident" id="4231767">ret</span><span class="op" id="4231770">,</span>&nbsp;<span class="ident" id="4231772">n</span><span class="op" id="4231773">.</span><span class="ident" id="4231774">Locality</span><span class="op" id="4231782">,</span>&nbsp;<span class="ident" id="4231784">oidLocality</span><span class="op" id="4231795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231798">ret</span>&nbsp;<span class="op" id="4231802">=</span>&nbsp;<span class="ident" id="4231804">appendRDNs</span><span class="op" id="4231814">(</span><span class="ident" id="4231815">ret</span><span class="op" id="4231818">,</span>&nbsp;<span class="ident" id="4231820">n</span><span class="op" id="4231821">.</span><span class="ident" id="4231822">Province</span><span class="op" id="4231830">,</span>&nbsp;<span class="ident" id="4231832">oidProvince</span><span class="op" id="4231843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231846">ret</span>&nbsp;<span class="op" id="4231850">=</span>&nbsp;<span class="ident" id="4231852">appendRDNs</span><span class="op" id="4231862">(</span><span class="ident" id="4231863">ret</span><span class="op" id="4231866">,</span>&nbsp;<span class="ident" id="4231868">n</span><span class="op" id="4231869">.</span><span class="ident" id="4231870">StreetAddress</span><span class="op" id="4231883">,</span>&nbsp;<span class="ident" id="4231885">oidStreetAddress</span><span class="op" id="4231901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231904">ret</span>&nbsp;<span class="op" id="4231908">=</span>&nbsp;<span class="ident" id="4231910">appendRDNs</span><span class="op" id="4231920">(</span><span class="ident" id="4231921">ret</span><span class="op" id="4231924">,</span>&nbsp;<span class="ident" id="4231926">n</span><span class="op" id="4231927">.</span><span class="ident" id="4231928">PostalCode</span><span class="op" id="4231938">,</span>&nbsp;<span class="ident" id="4231940">oidPostalCode</span><span class="op" id="4231953">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231956">if</span>&nbsp;<span class="builtinfunc" id="4231959">len</span><span class="op" id="4231962">(</span><span class="ident" id="4231963">n</span><span class="op" id="4231964">.</span><span class="ident" id="4231965">CommonName</span><span class="op" id="4231975">)</span>&nbsp;<span class="op" id="4231977">&gt;</span>&nbsp;<span class="num" id="4231979">0</span>&nbsp;<span class="op" id="4231981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231985">ret</span>&nbsp;<span class="op" id="4231989">=</span>&nbsp;<span class="ident" id="4231991">appendRDNs</span><span class="op" id="4232001">(</span><span class="ident" id="4232002">ret</span><span class="op" id="4232005">,</span>&nbsp;<span class="op" id="4232007">[</span><span class="op" id="4232008">]</span><span class="builtintype" id="4232009">string</span><span class="op" id="4232015">{</span><span class="ident" id="4232016">n</span><span class="op" id="4232017">.</span><span class="ident" id="4232018">CommonName</span><span class="op" id="4232028">}</span><span class="op" id="4232029">,</span>&nbsp;<span class="ident" id="4232031">oidCommonName</span><span class="op" id="4232044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4232050">if</span>&nbsp;<span class="builtinfunc" id="4232053">len</span><span class="op" id="4232056">(</span><span class="ident" id="4232057">n</span><span class="op" id="4232058">.</span><span class="ident" id="4232059">SerialNumber</span><span class="op" id="4232071">)</span>&nbsp;<span class="op" id="4232073">&gt;</span>&nbsp;<span class="num" id="4232075">0</span>&nbsp;<span class="op" id="4232077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232081">ret</span>&nbsp;<span class="op" id="4232085">=</span>&nbsp;<span class="ident" id="4232087">appendRDNs</span><span class="op" id="4232097">(</span><span class="ident" id="4232098">ret</span><span class="op" id="4232101">,</span>&nbsp;<span class="op" id="4232103">[</span><span class="op" id="4232104">]</span><span class="builtintype" id="4232105">string</span><span class="op" id="4232111">{</span><span class="ident" id="4232112">n</span><span class="op" id="4232113">.</span><span class="ident" id="4232114">SerialNumber</span><span class="op" id="4232126">}</span><span class="op" id="4232127">,</span>&nbsp;<span class="ident" id="4232129">oidSerialNumber</span><span class="op" id="4232144">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4232151">return</span>&nbsp;<span class="ident" id="4232158">ret</span><br>
<span class="lineno"></span><span class="op" id="4232162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4232165">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4232241">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4232311">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4232325">type</span>&nbsp;<span class="ident" id="4232330">CertificateList</span>&nbsp;<span class="keyword" id="4232346">struct</span>&nbsp;<span class="op" id="4232353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232356">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232375">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232395">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4232414">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232435">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232454">asn1</span><span class="op" id="4232458">.</span><span class="ident" id="4232459">BitString</span><br>
<span class="lineno"></span><span class="op" id="4232469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4232472">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="4232543">func</span>&nbsp;<span class="op" id="4232548">(</span><span class="ident" id="4232549">certList</span>&nbsp;<span class="op" id="4232558">*</span><span class="ident" id="4232559">CertificateList</span><span class="op" id="4232574">)</span>&nbsp;<span class="ident" id="4232576">HasExpired</span><span class="op" id="4232586">(</span><span class="ident" id="4232587">now</span>&nbsp;<span class="ident" id="4232591">time</span><span class="op" id="4232595">.</span><span class="ident" id="4232596">Time</span><span class="op" id="4232600">)</span>&nbsp;<span class="builtintype" id="4232602">bool</span>&nbsp;<span class="op" id="4232607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4232610">return</span>&nbsp;<span class="ident" id="4232617">now</span><span class="op" id="4232620">.</span><span class="ident" id="4232621">After</span><span class="op" id="4232626">(</span><span class="ident" id="4232627">certList</span><span class="op" id="4232635">.</span><span class="ident" id="4232636">TBSCertList</span><span class="op" id="4232647">.</span><span class="ident" id="4232648">NextUpdate</span><span class="op" id="4232658">)</span><br>
<span class="lineno"></span><span class="op" id="4232660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4232663">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="4232742">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4232764">type</span>&nbsp;<span class="ident" id="4232769">TBSCertificateList</span>&nbsp;<span class="keyword" id="4232788">struct</span>&nbsp;<span class="op" id="4232795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232798">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232818">asn1</span><span class="op" id="4232822">.</span><span class="ident" id="4232823">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232835">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4232855">int</span>&nbsp;<span class="string" id="4232859">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232888">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232908">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232929">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232949">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232962">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232982">time</span><span class="op" id="4232986">.</span><span class="ident" id="4232987">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232993">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233013">time</span><span class="op" id="4233017">.</span><span class="ident" id="4233018">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4233034">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233053">RevokedCertificates</span>&nbsp;<span class="op" id="4233073">[</span><span class="op" id="4233074">]</span><span class="ident" id="4233075">RevokedCertificate</span>&nbsp;<span class="string" id="4233094">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233113">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233133">[</span><span class="op" id="4233134">]</span><span class="ident" id="4233135">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4233154">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="4233187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4233190">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4233269">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4233291">type</span>&nbsp;<span class="ident" id="4233296">RevokedCertificate</span>&nbsp;<span class="keyword" id="4233315">struct</span>&nbsp;<span class="op" id="4233322">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233325">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4233340">*</span><span class="ident" id="4233341">big</span><span class="op" id="4233344">.</span><span class="ident" id="4233345">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233350">RevocationTime</span>&nbsp;<span class="ident" id="4233365">time</span><span class="op" id="4233369">.</span><span class="ident" id="4233370">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233376">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233391">[</span><span class="op" id="4233392">]</span><span class="ident" id="4233393">Extension</span>&nbsp;<span class="string" id="4233403">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4233421">}</span>
</div>
</body>
</html>
