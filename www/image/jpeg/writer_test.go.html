<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7968528">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7968583">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7968637">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7968688">package</span>&nbsp;<span class="ident" id="7968696">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7968702">import</span>&nbsp;<span class="op" id="7968709">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7968712">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7968721">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7968728">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7968737">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7968752">&#34;image/png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7968765">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7968778">&#34;math/rand&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7968791">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7968797">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7968807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7968810">//&nbsp;zigzag&nbsp;maps&nbsp;from&nbsp;the&nbsp;natural&nbsp;ordering&nbsp;to&nbsp;the&nbsp;zig-zag&nbsp;ordering.&nbsp;For&nbsp;example,</span><br>
<span class="lineno">20</span><span class="comment" id="7968889">//&nbsp;zigzag[0*8&nbsp;+&nbsp;3]&nbsp;is&nbsp;the&nbsp;zig-zag&nbsp;sequence&nbsp;number&nbsp;of&nbsp;the&nbsp;element&nbsp;in&nbsp;the&nbsp;fourth</span><br>
<span class="lineno"></span><span class="comment" id="7968968">//&nbsp;column&nbsp;and&nbsp;first&nbsp;row.</span><br>
<span class="lineno"></span><span class="keyword" id="7968993">var</span>&nbsp;<span class="ident" id="7968997">zigzag</span>&nbsp;<span class="op" id="7969004">=</span>&nbsp;<span class="op" id="7969006">[</span><span class="ident" id="7969007">blockSize</span><span class="op" id="7969016">]</span><span class="builtintype" id="7969017">int</span><span class="op" id="7969020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969023">0</span><span class="op" id="7969024">,</span>&nbsp;<span class="num" id="7969026">1</span><span class="op" id="7969027">,</span>&nbsp;<span class="num" id="7969029">5</span><span class="op" id="7969030">,</span>&nbsp;<span class="num" id="7969032">6</span><span class="op" id="7969033">,</span>&nbsp;<span class="num" id="7969035">14</span><span class="op" id="7969037">,</span>&nbsp;<span class="num" id="7969039">15</span><span class="op" id="7969041">,</span>&nbsp;<span class="num" id="7969043">27</span><span class="op" id="7969045">,</span>&nbsp;<span class="num" id="7969047">28</span><span class="op" id="7969049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969052">2</span><span class="op" id="7969053">,</span>&nbsp;<span class="num" id="7969055">4</span><span class="op" id="7969056">,</span>&nbsp;<span class="num" id="7969058">7</span><span class="op" id="7969059">,</span>&nbsp;<span class="num" id="7969061">13</span><span class="op" id="7969063">,</span>&nbsp;<span class="num" id="7969065">16</span><span class="op" id="7969067">,</span>&nbsp;<span class="num" id="7969069">26</span><span class="op" id="7969071">,</span>&nbsp;<span class="num" id="7969073">29</span><span class="op" id="7969075">,</span>&nbsp;<span class="num" id="7969077">42</span><span class="op" id="7969079">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969082">3</span><span class="op" id="7969083">,</span>&nbsp;<span class="num" id="7969085">8</span><span class="op" id="7969086">,</span>&nbsp;<span class="num" id="7969088">12</span><span class="op" id="7969090">,</span>&nbsp;<span class="num" id="7969092">17</span><span class="op" id="7969094">,</span>&nbsp;<span class="num" id="7969096">25</span><span class="op" id="7969098">,</span>&nbsp;<span class="num" id="7969100">30</span><span class="op" id="7969102">,</span>&nbsp;<span class="num" id="7969104">41</span><span class="op" id="7969106">,</span>&nbsp;<span class="num" id="7969108">43</span><span class="op" id="7969110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969113">9</span><span class="op" id="7969114">,</span>&nbsp;<span class="num" id="7969116">11</span><span class="op" id="7969118">,</span>&nbsp;<span class="num" id="7969120">18</span><span class="op" id="7969122">,</span>&nbsp;<span class="num" id="7969124">24</span><span class="op" id="7969126">,</span>&nbsp;<span class="num" id="7969128">31</span><span class="op" id="7969130">,</span>&nbsp;<span class="num" id="7969132">40</span><span class="op" id="7969134">,</span>&nbsp;<span class="num" id="7969136">44</span><span class="op" id="7969138">,</span>&nbsp;<span class="num" id="7969140">53</span><span class="op" id="7969142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969145">10</span><span class="op" id="7969147">,</span>&nbsp;<span class="num" id="7969149">19</span><span class="op" id="7969151">,</span>&nbsp;<span class="num" id="7969153">23</span><span class="op" id="7969155">,</span>&nbsp;<span class="num" id="7969157">32</span><span class="op" id="7969159">,</span>&nbsp;<span class="num" id="7969161">39</span><span class="op" id="7969163">,</span>&nbsp;<span class="num" id="7969165">45</span><span class="op" id="7969167">,</span>&nbsp;<span class="num" id="7969169">52</span><span class="op" id="7969171">,</span>&nbsp;<span class="num" id="7969173">54</span><span class="op" id="7969175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969178">20</span><span class="op" id="7969180">,</span>&nbsp;<span class="num" id="7969182">22</span><span class="op" id="7969184">,</span>&nbsp;<span class="num" id="7969186">33</span><span class="op" id="7969188">,</span>&nbsp;<span class="num" id="7969190">38</span><span class="op" id="7969192">,</span>&nbsp;<span class="num" id="7969194">46</span><span class="op" id="7969196">,</span>&nbsp;<span class="num" id="7969198">51</span><span class="op" id="7969200">,</span>&nbsp;<span class="num" id="7969202">55</span><span class="op" id="7969204">,</span>&nbsp;<span class="num" id="7969206">60</span><span class="op" id="7969208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969211">21</span><span class="op" id="7969213">,</span>&nbsp;<span class="num" id="7969215">34</span><span class="op" id="7969217">,</span>&nbsp;<span class="num" id="7969219">37</span><span class="op" id="7969221">,</span>&nbsp;<span class="num" id="7969223">47</span><span class="op" id="7969225">,</span>&nbsp;<span class="num" id="7969227">50</span><span class="op" id="7969229">,</span>&nbsp;<span class="num" id="7969231">56</span><span class="op" id="7969233">,</span>&nbsp;<span class="num" id="7969235">59</span><span class="op" id="7969237">,</span>&nbsp;<span class="num" id="7969239">61</span><span class="op" id="7969241">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969244">35</span><span class="op" id="7969246">,</span>&nbsp;<span class="num" id="7969248">36</span><span class="op" id="7969250">,</span>&nbsp;<span class="num" id="7969252">48</span><span class="op" id="7969254">,</span>&nbsp;<span class="num" id="7969256">49</span><span class="op" id="7969258">,</span>&nbsp;<span class="num" id="7969260">57</span><span class="op" id="7969262">,</span>&nbsp;<span class="num" id="7969264">58</span><span class="op" id="7969266">,</span>&nbsp;<span class="num" id="7969268">62</span><span class="op" id="7969270">,</span>&nbsp;<span class="num" id="7969272">63</span><span class="op" id="7969274">,</span><br>
<span class="lineno"></span><span class="op" id="7969276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7969279">func</span>&nbsp;<span class="ident" id="7969284">TestZigUnzig</span><span class="op" id="7969296">(</span><span class="ident" id="7969297">t</span>&nbsp;<span class="op" id="7969299">*</span><span class="ident" id="7969300">testing</span><span class="op" id="7969307">.</span><span class="ident" id="7969308">T</span><span class="op" id="7969309">)</span>&nbsp;<span class="op" id="7969311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7969314">for</span>&nbsp;<span class="ident" id="7969318">i</span>&nbsp;<span class="op" id="7969320">:=</span>&nbsp;<span class="num" id="7969323">0</span><span class="op" id="7969324">;</span>&nbsp;<span class="ident" id="7969326">i</span>&nbsp;<span class="op" id="7969328">&lt;</span>&nbsp;<span class="ident" id="7969330">blockSize</span><span class="op" id="7969339">;</span>&nbsp;<span class="ident" id="7969341">i</span><span class="op" id="7969342">++</span>&nbsp;<span class="op" id="7969345">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7969349">if</span>&nbsp;<span class="ident" id="7969352">unzig</span><span class="op" id="7969357">[</span><span class="ident" id="7969358">zigzag</span><span class="op" id="7969364">[</span><span class="ident" id="7969365">i</span><span class="op" id="7969366">]</span><span class="op" id="7969367">]</span>&nbsp;<span class="op" id="7969369">!=</span>&nbsp;<span class="ident" id="7969372">i</span>&nbsp;<span class="op" id="7969374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969379">t</span><span class="op" id="7969380">.</span><span class="ident" id="7969381">Errorf</span><span class="op" id="7969387">(</span><span class="string" id="7969388">&#34;unzig[zigzag[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7969413">,</span>&nbsp;<span class="ident" id="7969415">i</span><span class="op" id="7969416">,</span>&nbsp;<span class="ident" id="7969418">unzig</span><span class="op" id="7969423">[</span><span class="ident" id="7969424">zigzag</span><span class="op" id="7969430">[</span><span class="ident" id="7969431">i</span><span class="op" id="7969432">]</span><span class="op" id="7969433">]</span><span class="op" id="7969434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7969438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7969442">if</span>&nbsp;<span class="ident" id="7969445">zigzag</span><span class="op" id="7969451">[</span><span class="ident" id="7969452">unzig</span><span class="op" id="7969457">[</span><span class="ident" id="7969458">i</span><span class="op" id="7969459">]</span><span class="op" id="7969460">]</span>&nbsp;<span class="op" id="7969462">!=</span>&nbsp;<span class="ident" id="7969465">i</span>&nbsp;<span class="op" id="7969467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969472">t</span><span class="op" id="7969473">.</span><span class="ident" id="7969474">Errorf</span><span class="op" id="7969480">(</span><span class="string" id="7969481">&#34;zigzag[unzig[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7969506">,</span>&nbsp;<span class="ident" id="7969508">i</span><span class="op" id="7969509">,</span>&nbsp;<span class="ident" id="7969511">zigzag</span><span class="op" id="7969517">[</span><span class="ident" id="7969518">unzig</span><span class="op" id="7969523">[</span><span class="ident" id="7969524">i</span><span class="op" id="7969525">]</span><span class="op" id="7969526">]</span><span class="op" id="7969527">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7969531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7969534">}</span><br>
<span class="lineno"></span><span class="op" id="7969536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7969539">//&nbsp;unscaledQuantInNaturalOrder&nbsp;are&nbsp;the&nbsp;unscaled&nbsp;quantization&nbsp;tables&nbsp;in</span><br>
<span class="lineno">45</span><span class="comment" id="7969610">//&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order,&nbsp;as&nbsp;specified&nbsp;in&nbsp;section&nbsp;K.1.</span><br>
<span class="lineno"></span><span class="keyword" id="7969671">var</span>&nbsp;<span class="ident" id="7969675">unscaledQuantInNaturalOrder</span>&nbsp;<span class="op" id="7969703">=</span>&nbsp;<span class="op" id="7969705">[</span><span class="ident" id="7969706">nQuantIndex</span><span class="op" id="7969717">]</span><span class="op" id="7969718">[</span><span class="ident" id="7969719">blockSize</span><span class="op" id="7969728">]</span><span class="builtintype" id="7969729">byte</span><span class="op" id="7969733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7969736">//&nbsp;Luminance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7969751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969755">16</span><span class="op" id="7969757">,</span>&nbsp;<span class="num" id="7969759">11</span><span class="op" id="7969761">,</span>&nbsp;<span class="num" id="7969763">10</span><span class="op" id="7969765">,</span>&nbsp;<span class="num" id="7969767">16</span><span class="op" id="7969769">,</span>&nbsp;<span class="num" id="7969771">24</span><span class="op" id="7969773">,</span>&nbsp;<span class="num" id="7969775">40</span><span class="op" id="7969777">,</span>&nbsp;<span class="num" id="7969779">51</span><span class="op" id="7969781">,</span>&nbsp;<span class="num" id="7969783">61</span><span class="op" id="7969785">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969789">12</span><span class="op" id="7969791">,</span>&nbsp;<span class="num" id="7969793">12</span><span class="op" id="7969795">,</span>&nbsp;<span class="num" id="7969797">14</span><span class="op" id="7969799">,</span>&nbsp;<span class="num" id="7969801">19</span><span class="op" id="7969803">,</span>&nbsp;<span class="num" id="7969805">26</span><span class="op" id="7969807">,</span>&nbsp;<span class="num" id="7969809">58</span><span class="op" id="7969811">,</span>&nbsp;<span class="num" id="7969813">60</span><span class="op" id="7969815">,</span>&nbsp;<span class="num" id="7969817">55</span><span class="op" id="7969819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969823">14</span><span class="op" id="7969825">,</span>&nbsp;<span class="num" id="7969827">13</span><span class="op" id="7969829">,</span>&nbsp;<span class="num" id="7969831">16</span><span class="op" id="7969833">,</span>&nbsp;<span class="num" id="7969835">24</span><span class="op" id="7969837">,</span>&nbsp;<span class="num" id="7969839">40</span><span class="op" id="7969841">,</span>&nbsp;<span class="num" id="7969843">57</span><span class="op" id="7969845">,</span>&nbsp;<span class="num" id="7969847">69</span><span class="op" id="7969849">,</span>&nbsp;<span class="num" id="7969851">56</span><span class="op" id="7969853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969857">14</span><span class="op" id="7969859">,</span>&nbsp;<span class="num" id="7969861">17</span><span class="op" id="7969863">,</span>&nbsp;<span class="num" id="7969865">22</span><span class="op" id="7969867">,</span>&nbsp;<span class="num" id="7969869">29</span><span class="op" id="7969871">,</span>&nbsp;<span class="num" id="7969873">51</span><span class="op" id="7969875">,</span>&nbsp;<span class="num" id="7969877">87</span><span class="op" id="7969879">,</span>&nbsp;<span class="num" id="7969881">80</span><span class="op" id="7969883">,</span>&nbsp;<span class="num" id="7969885">62</span><span class="op" id="7969887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969891">18</span><span class="op" id="7969893">,</span>&nbsp;<span class="num" id="7969895">22</span><span class="op" id="7969897">,</span>&nbsp;<span class="num" id="7969899">37</span><span class="op" id="7969901">,</span>&nbsp;<span class="num" id="7969903">56</span><span class="op" id="7969905">,</span>&nbsp;<span class="num" id="7969907">68</span><span class="op" id="7969909">,</span>&nbsp;<span class="num" id="7969911">109</span><span class="op" id="7969914">,</span>&nbsp;<span class="num" id="7969916">103</span><span class="op" id="7969919">,</span>&nbsp;<span class="num" id="7969921">77</span><span class="op" id="7969923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969927">24</span><span class="op" id="7969929">,</span>&nbsp;<span class="num" id="7969931">35</span><span class="op" id="7969933">,</span>&nbsp;<span class="num" id="7969935">55</span><span class="op" id="7969937">,</span>&nbsp;<span class="num" id="7969939">64</span><span class="op" id="7969941">,</span>&nbsp;<span class="num" id="7969943">81</span><span class="op" id="7969945">,</span>&nbsp;<span class="num" id="7969947">104</span><span class="op" id="7969950">,</span>&nbsp;<span class="num" id="7969952">113</span><span class="op" id="7969955">,</span>&nbsp;<span class="num" id="7969957">92</span><span class="op" id="7969959">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7969963">49</span><span class="op" id="7969965">,</span>&nbsp;<span class="num" id="7969967">64</span><span class="op" id="7969969">,</span>&nbsp;<span class="num" id="7969971">78</span><span class="op" id="7969973">,</span>&nbsp;<span class="num" id="7969975">87</span><span class="op" id="7969977">,</span>&nbsp;<span class="num" id="7969979">103</span><span class="op" id="7969982">,</span>&nbsp;<span class="num" id="7969984">121</span><span class="op" id="7969987">,</span>&nbsp;<span class="num" id="7969989">120</span><span class="op" id="7969992">,</span>&nbsp;<span class="num" id="7969994">101</span><span class="op" id="7969997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7970001">72</span><span class="op" id="7970003">,</span>&nbsp;<span class="num" id="7970005">92</span><span class="op" id="7970007">,</span>&nbsp;<span class="num" id="7970009">95</span><span class="op" id="7970011">,</span>&nbsp;<span class="num" id="7970013">98</span><span class="op" id="7970015">,</span>&nbsp;<span class="num" id="7970017">112</span><span class="op" id="7970020">,</span>&nbsp;<span class="num" id="7970022">100</span><span class="op" id="7970025">,</span>&nbsp;<span class="num" id="7970027">103</span><span class="op" id="7970030">,</span>&nbsp;<span class="num" id="7970032">99</span><span class="op" id="7970034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7970037">}</span><span class="op" id="7970038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7970041">//&nbsp;Chrominance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7970058">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7970062">17</span><span class="op" id="7970064">,</span>&nbsp;<span class="num" id="7970066">18</span><span class="op" id="7970068">,</span>&nbsp;<span class="num" id="7970070">24</span><span class="op" id="7970072">,</span>&nbsp;<span class="num" id="7970074">47</span><span class="op" id="7970076">,</span>&nbsp;<span class="num" id="7970078">99</span><span class="op" id="7970080">,</span>&nbsp;<span class="num" id="7970082">99</span><span class="op" id="7970084">,</span>&nbsp;<span class="num" id="7970086">99</span><span class="op" id="7970088">,</span>&nbsp;<span class="num" id="7970090">99</span><span class="op" id="7970092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7970096">18</span><span class="op" id="7970098">,</span>&nbsp;<span class="num" id="7970100">21</span><span class="op" id="7970102">,</span>&nbsp;<span class="num" id="7970104">26</span><span class="op" id="7970106">,</span>&nbsp;<span class="num" id="7970108">66</span><span class="op" id="7970110">,</span>&nbsp;<span class="num" id="7970112">99</span><span class="op" id="7970114">,</span>&nbsp;<span class="num" id="7970116">99</span><span class="op" id="7970118">,</span>&nbsp;<span class="num" id="7970120">99</span><span class="op" id="7970122">,</span>&nbsp;<span class="num" id="7970124">99</span><span class="op" id="7970126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7970130">24</span><span class="op" id="7970132">,</span>&nbsp;<span class="num" id="7970134">26</span><span class="op" id="7970136">,</span>&nbsp;<span class="num" id="7970138">56</span><span class="op" id="7970140">,</span>&nbsp;<span class="num" id="7970142">99</span><span class="op" id="7970144">,</span>&nbsp;<span class="num" id="7970146">99</span><span class="op" id="7970148">,</span>&nbsp;<span class="num" id="7970150">99</span><span class="op" id="7970152">,</span>&nbsp;<span class="num" id="7970154">99</span><span class="op" id="7970156">,</span>&nbsp;<span class="num" id="7970158">99</span><span class="op" id="7970160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7970164">47</span><span class="op" id="7970166">,</span>&nbsp;<span class="num" id="7970168">66</span><span class="op" id="7970170">,</span>&nbsp;<span class="num" id="7970172">99</span><span class="op" id="7970174">,</span>&nbsp;<span class="num" id="7970176">99</span><span class="op" id="7970178">,</span>&nbsp;<span class="num" id="7970180">99</span><span class="op" id="7970182">,</span>&nbsp;<span class="num" id="7970184">99</span><span class="op" id="7970186">,</span>&nbsp;<span class="num" id="7970188">99</span><span class="op" id="7970190">,</span>&nbsp;<span class="num" id="7970192">99</span><span class="op" id="7970194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7970198">99</span><span class="op" id="7970200">,</span>&nbsp;<span class="num" id="7970202">99</span><span class="op" id="7970204">,</span>&nbsp;<span class="num" id="7970206">99</span><span class="op" id="7970208">,</span>&nbsp;<span class="num" id="7970210">99</span><span class="op" id="7970212">,</span>&nbsp;<span class="num" id="7970214">99</span><span class="op" id="7970216">,</span>&nbsp;<span class="num" id="7970218">99</span><span class="op" id="7970220">,</span>&nbsp;<span class="num" id="7970222">99</span><span class="op" id="7970224">,</span>&nbsp;<span class="num" id="7970226">99</span><span class="op" id="7970228">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7970232">99</span><span class="op" id="7970234">,</span>&nbsp;<span class="num" id="7970236">99</span><span class="op" id="7970238">,</span>&nbsp;<span class="num" id="7970240">99</span><span class="op" id="7970242">,</span>&nbsp;<span class="num" id="7970244">99</span><span class="op" id="7970246">,</span>&nbsp;<span class="num" id="7970248">99</span><span class="op" id="7970250">,</span>&nbsp;<span class="num" id="7970252">99</span><span class="op" id="7970254">,</span>&nbsp;<span class="num" id="7970256">99</span><span class="op" id="7970258">,</span>&nbsp;<span class="num" id="7970260">99</span><span class="op" id="7970262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7970266">99</span><span class="op" id="7970268">,</span>&nbsp;<span class="num" id="7970270">99</span><span class="op" id="7970272">,</span>&nbsp;<span class="num" id="7970274">99</span><span class="op" id="7970276">,</span>&nbsp;<span class="num" id="7970278">99</span><span class="op" id="7970280">,</span>&nbsp;<span class="num" id="7970282">99</span><span class="op" id="7970284">,</span>&nbsp;<span class="num" id="7970286">99</span><span class="op" id="7970288">,</span>&nbsp;<span class="num" id="7970290">99</span><span class="op" id="7970292">,</span>&nbsp;<span class="num" id="7970294">99</span><span class="op" id="7970296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7970300">99</span><span class="op" id="7970302">,</span>&nbsp;<span class="num" id="7970304">99</span><span class="op" id="7970306">,</span>&nbsp;<span class="num" id="7970308">99</span><span class="op" id="7970310">,</span>&nbsp;<span class="num" id="7970312">99</span><span class="op" id="7970314">,</span>&nbsp;<span class="num" id="7970316">99</span><span class="op" id="7970318">,</span>&nbsp;<span class="num" id="7970320">99</span><span class="op" id="7970322">,</span>&nbsp;<span class="num" id="7970324">99</span><span class="op" id="7970326">,</span>&nbsp;<span class="num" id="7970328">99</span><span class="op" id="7970330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7970333">}</span><span class="op" id="7970334">,</span><br>
<span class="lineno"></span><span class="op" id="7970336">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7970339">func</span>&nbsp;<span class="ident" id="7970344">TestUnscaledQuant</span><span class="op" id="7970361">(</span><span class="ident" id="7970362">t</span>&nbsp;<span class="op" id="7970364">*</span><span class="ident" id="7970365">testing</span><span class="op" id="7970372">.</span><span class="ident" id="7970373">T</span><span class="op" id="7970374">)</span>&nbsp;<span class="op" id="7970376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7970379">bad</span>&nbsp;<span class="op" id="7970383">:=</span>&nbsp;<span class="ident" id="7970386">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7970393">for</span>&nbsp;<span class="ident" id="7970397">i</span>&nbsp;<span class="op" id="7970399">:=</span>&nbsp;<span class="ident" id="7970402">quantIndex</span><span class="op" id="7970412">(</span><span class="num" id="7970413">0</span><span class="op" id="7970414">)</span><span class="op" id="7970415">;</span>&nbsp;<span class="ident" id="7970417">i</span>&nbsp;<span class="op" id="7970419">&lt;</span>&nbsp;<span class="ident" id="7970421">nQuantIndex</span><span class="op" id="7970432">;</span>&nbsp;<span class="ident" id="7970434">i</span><span class="op" id="7970435">++</span>&nbsp;<span class="op" id="7970438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7970442">for</span>&nbsp;<span class="ident" id="7970446">zig</span>&nbsp;<span class="op" id="7970450">:=</span>&nbsp;<span class="num" id="7970453">0</span><span class="op" id="7970454">;</span>&nbsp;<span class="ident" id="7970456">zig</span>&nbsp;<span class="op" id="7970460">&lt;</span>&nbsp;<span class="ident" id="7970462">blockSize</span><span class="op" id="7970471">;</span>&nbsp;<span class="ident" id="7970473">zig</span><span class="op" id="7970476">++</span>&nbsp;<span class="op" id="7970479">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7970484">got</span>&nbsp;<span class="op" id="7970488">:=</span>&nbsp;<span class="ident" id="7970491">unscaledQuant</span><span class="op" id="7970504">[</span><span class="ident" id="7970505">i</span><span class="op" id="7970506">]</span><span class="op" id="7970507">[</span><span class="ident" id="7970508">zig</span><span class="op" id="7970511">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7970516">want</span>&nbsp;<span class="op" id="7970521">:=</span>&nbsp;<span class="ident" id="7970524">unscaledQuantInNaturalOrder</span><span class="op" id="7970551">[</span><span class="ident" id="7970552">i</span><span class="op" id="7970553">]</span><span class="op" id="7970554">[</span><span class="ident" id="7970555">unzig</span><span class="op" id="7970560">[</span><span class="ident" id="7970561">zig</span><span class="op" id="7970564">]</span><span class="op" id="7970565">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7970570">if</span>&nbsp;<span class="ident" id="7970573">got</span>&nbsp;<span class="op" id="7970577">!=</span>&nbsp;<span class="ident" id="7970580">want</span>&nbsp;<span class="op" id="7970585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7970591">t</span><span class="op" id="7970592">.</span><span class="ident" id="7970593">Errorf</span><span class="op" id="7970599">(</span><span class="string" id="7970600">&#34;i=%d,&nbsp;zig=%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7970631">,</span>&nbsp;<span class="ident" id="7970633">i</span><span class="op" id="7970634">,</span>&nbsp;<span class="ident" id="7970636">zig</span><span class="op" id="7970639">,</span>&nbsp;<span class="ident" id="7970641">got</span><span class="op" id="7970644">,</span>&nbsp;<span class="ident" id="7970646">want</span><span class="op" id="7970650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7970656">bad</span>&nbsp;<span class="op" id="7970660">=</span>&nbsp;<span class="ident" id="7970662">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7970670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7970674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7970677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7970680">if</span>&nbsp;<span class="ident" id="7970683">bad</span>&nbsp;<span class="op" id="7970687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7970691">names</span>&nbsp;<span class="op" id="7970697">:=</span>&nbsp;<span class="op" id="7970700">[</span><span class="ident" id="7970701">nQuantIndex</span><span class="op" id="7970712">]</span><span class="builtintype" id="7970713">string</span><span class="op" id="7970719">{</span><span class="string" id="7970720">&#34;Luminance&#34;</span><span class="op" id="7970731">,</span>&nbsp;<span class="string" id="7970733">&#34;Chrominance&#34;</span><span class="op" id="7970746">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7970750">buf</span>&nbsp;<span class="op" id="7970754">:=</span>&nbsp;<span class="op" id="7970757">&amp;</span><span class="ident" id="7970758">bytes</span><span class="op" id="7970763">.</span><span class="ident" id="7970764">Buffer</span><span class="op" id="7970770">{</span><span class="op" id="7970771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7970775">for</span>&nbsp;<span class="ident" id="7970779">i</span><span class="op" id="7970780">,</span>&nbsp;<span class="ident" id="7970782">name</span>&nbsp;<span class="op" id="7970787">:=</span>&nbsp;<span class="keyword" id="7970790">range</span>&nbsp;<span class="ident" id="7970796">names</span>&nbsp;<span class="op" id="7970802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7970807">fmt</span><span class="op" id="7970810">.</span><span class="ident" id="7970811">Fprintf</span><span class="op" id="7970818">(</span><span class="ident" id="7970819">buf</span><span class="op" id="7970822">,</span>&nbsp;<span class="string" id="7970824">&#34;//&nbsp;%s.\n{\n&#34;</span><span class="op" id="7970837">,</span>&nbsp;<span class="ident" id="7970839">name</span><span class="op" id="7970843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7970848">for</span>&nbsp;<span class="ident" id="7970852">zig</span>&nbsp;<span class="op" id="7970856">:=</span>&nbsp;<span class="num" id="7970859">0</span><span class="op" id="7970860">;</span>&nbsp;<span class="ident" id="7970862">zig</span>&nbsp;<span class="op" id="7970866">&lt;</span>&nbsp;<span class="ident" id="7970868">blockSize</span><span class="op" id="7970877">;</span>&nbsp;<span class="ident" id="7970879">zig</span><span class="op" id="7970882">++</span>&nbsp;<span class="op" id="7970885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7970891">fmt</span><span class="op" id="7970894">.</span><span class="ident" id="7970895">Fprintf</span><span class="op" id="7970902">(</span><span class="ident" id="7970903">buf</span><span class="op" id="7970906">,</span>&nbsp;<span class="string" id="7970908">&#34;%d,&nbsp;&#34;</span><span class="op" id="7970914">,</span>&nbsp;<span class="ident" id="7970916">unscaledQuantInNaturalOrder</span><span class="op" id="7970943">[</span><span class="ident" id="7970944">i</span><span class="op" id="7970945">]</span><span class="op" id="7970946">[</span><span class="ident" id="7970947">unzig</span><span class="op" id="7970952">[</span><span class="ident" id="7970953">zig</span><span class="op" id="7970956">]</span><span class="op" id="7970957">]</span><span class="op" id="7970958">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7970964">if</span>&nbsp;<span class="ident" id="7970967">zig</span><span class="op" id="7970970">%</span><span class="num" id="7970971">8</span>&nbsp;<span class="op" id="7970973">==</span>&nbsp;<span class="num" id="7970976">7</span>&nbsp;<span class="op" id="7970978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7970985">buf</span><span class="op" id="7970988">.</span><span class="ident" id="7970989">WriteString</span><span class="op" id="7971000">(</span><span class="string" id="7971001">&#34;\n&#34;</span><span class="op" id="7971005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7971021">buf</span><span class="op" id="7971024">.</span><span class="ident" id="7971025">WriteString</span><span class="op" id="7971036">(</span><span class="string" id="7971037">&#34;},\n&#34;</span><span class="op" id="7971043">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7971051">t</span><span class="op" id="7971052">.</span><span class="ident" id="7971053">Logf</span><span class="op" id="7971057">(</span><span class="string" id="7971058">&#34;expected&nbsp;unscaledQuant&nbsp;values:\n%s&#34;</span><span class="op" id="7971094">,</span>&nbsp;<span class="ident" id="7971096">buf</span><span class="op" id="7971099">.</span><span class="ident" id="7971100">String</span><span class="op" id="7971106">(</span><span class="op" id="7971107">)</span><span class="op" id="7971108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971111">}</span><br>
<span class="lineno"></span><span class="op" id="7971113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="7971116">var</span>&nbsp;<span class="ident" id="7971120">testCase</span>&nbsp;<span class="op" id="7971129">=</span>&nbsp;<span class="op" id="7971131">[</span><span class="op" id="7971132">]</span><span class="keyword" id="7971133">struct</span>&nbsp;<span class="op" id="7971140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7971143">filename</span>&nbsp;&nbsp;<span class="builtintype" id="7971153">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7971161">quality</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7971171">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7971176">tolerance</span>&nbsp;<span class="ident" id="7971186">int64</span><br>
<span class="lineno"></span><span class="op" id="7971192">}</span><span class="op" id="7971193">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971196">{</span><span class="string" id="7971197">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7971224">,</span>&nbsp;<span class="num" id="7971226">1</span><span class="op" id="7971227">,</span>&nbsp;<span class="num" id="7971229">24</span>&nbsp;<span class="op" id="7971232">&lt;&lt;</span>&nbsp;<span class="num" id="7971235">8</span><span class="op" id="7971236">}</span><span class="op" id="7971237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971240">{</span><span class="string" id="7971241">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7971268">,</span>&nbsp;<span class="num" id="7971270">20</span><span class="op" id="7971272">,</span>&nbsp;<span class="num" id="7971274">12</span>&nbsp;<span class="op" id="7971277">&lt;&lt;</span>&nbsp;<span class="num" id="7971280">8</span><span class="op" id="7971281">}</span><span class="op" id="7971282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971285">{</span><span class="string" id="7971286">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7971313">,</span>&nbsp;<span class="num" id="7971315">60</span><span class="op" id="7971317">,</span>&nbsp;<span class="num" id="7971319">8</span>&nbsp;<span class="op" id="7971321">&lt;&lt;</span>&nbsp;<span class="num" id="7971324">8</span><span class="op" id="7971325">}</span><span class="op" id="7971326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971329">{</span><span class="string" id="7971330">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7971357">,</span>&nbsp;<span class="num" id="7971359">80</span><span class="op" id="7971361">,</span>&nbsp;<span class="num" id="7971363">6</span>&nbsp;<span class="op" id="7971365">&lt;&lt;</span>&nbsp;<span class="num" id="7971368">8</span><span class="op" id="7971369">}</span><span class="op" id="7971370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971373">{</span><span class="string" id="7971374">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7971401">,</span>&nbsp;<span class="num" id="7971403">90</span><span class="op" id="7971405">,</span>&nbsp;<span class="num" id="7971407">4</span>&nbsp;<span class="op" id="7971409">&lt;&lt;</span>&nbsp;<span class="num" id="7971412">8</span><span class="op" id="7971413">}</span><span class="op" id="7971414">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971417">{</span><span class="string" id="7971418">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7971445">,</span>&nbsp;<span class="num" id="7971447">100</span><span class="op" id="7971450">,</span>&nbsp;<span class="num" id="7971452">2</span>&nbsp;<span class="op" id="7971454">&lt;&lt;</span>&nbsp;<span class="num" id="7971457">8</span><span class="op" id="7971458">}</span><span class="op" id="7971459">,</span><br>
<span class="lineno"></span><span class="op" id="7971461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7971464">func</span>&nbsp;<span class="ident" id="7971469">delta</span><span class="op" id="7971474">(</span><span class="ident" id="7971475">u0</span><span class="op" id="7971477">,</span>&nbsp;<span class="ident" id="7971479">u1</span>&nbsp;<span class="builtintype" id="7971482">uint32</span><span class="op" id="7971488">)</span>&nbsp;<span class="ident" id="7971490">int64</span>&nbsp;<span class="op" id="7971496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7971499">d</span>&nbsp;<span class="op" id="7971501">:=</span>&nbsp;<span class="ident" id="7971504">int64</span><span class="op" id="7971509">(</span><span class="ident" id="7971510">u0</span><span class="op" id="7971512">)</span>&nbsp;<span class="op" id="7971514">-</span>&nbsp;<span class="ident" id="7971516">int64</span><span class="op" id="7971521">(</span><span class="ident" id="7971522">u1</span><span class="op" id="7971524">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971527">if</span>&nbsp;<span class="ident" id="7971530">d</span>&nbsp;<span class="op" id="7971532">&lt;</span>&nbsp;<span class="num" id="7971534">0</span>&nbsp;<span class="op" id="7971536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971540">return</span>&nbsp;<span class="op" id="7971547">-</span><span class="ident" id="7971548">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971554">return</span>&nbsp;<span class="ident" id="7971561">d</span><br>
<span class="lineno"></span><span class="op" id="7971563">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7971566">func</span>&nbsp;<span class="ident" id="7971571">readPng</span><span class="op" id="7971578">(</span><span class="ident" id="7971579">filename</span>&nbsp;<span class="builtintype" id="7971588">string</span><span class="op" id="7971594">)</span>&nbsp;<span class="op" id="7971596">(</span><span class="ident" id="7971597">image</span><span class="op" id="7971602">.</span><span class="ident" id="7971603">Image</span><span class="op" id="7971608">,</span>&nbsp;<span class="builtintype" id="7971610">error</span><span class="op" id="7971615">)</span>&nbsp;<span class="op" id="7971617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7971620">f</span><span class="op" id="7971621">,</span>&nbsp;<span class="ident" id="7971623">err</span>&nbsp;<span class="op" id="7971627">:=</span>&nbsp;<span class="ident" id="7971630">os</span><span class="op" id="7971632">.</span><span class="ident" id="7971633">Open</span><span class="op" id="7971637">(</span><span class="ident" id="7971638">filename</span><span class="op" id="7971646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971649">if</span>&nbsp;<span class="ident" id="7971652">err</span>&nbsp;<span class="op" id="7971656">!=</span>&nbsp;<span class="ident" id="7971659">nil</span>&nbsp;<span class="op" id="7971663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971667">return</span>&nbsp;<span class="ident" id="7971674">nil</span><span class="op" id="7971677">,</span>&nbsp;<span class="ident" id="7971679">err</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971687">defer</span>&nbsp;<span class="ident" id="7971693">f</span><span class="op" id="7971694">.</span><span class="ident" id="7971695">Close</span><span class="op" id="7971700">(</span><span class="op" id="7971701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971704">return</span>&nbsp;<span class="ident" id="7971711">png</span><span class="op" id="7971714">.</span><span class="ident" id="7971715">Decode</span><span class="op" id="7971721">(</span><span class="ident" id="7971722">f</span><span class="op" id="7971723">)</span><br>
<span class="lineno"></span><span class="op" id="7971725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7971728">func</span>&nbsp;<span class="ident" id="7971733">TestWriter</span><span class="op" id="7971743">(</span><span class="ident" id="7971744">t</span>&nbsp;<span class="op" id="7971746">*</span><span class="ident" id="7971747">testing</span><span class="op" id="7971754">.</span><span class="ident" id="7971755">T</span><span class="op" id="7971756">)</span>&nbsp;<span class="op" id="7971758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971761">for</span>&nbsp;<span class="ident" id="7971765">_</span><span class="op" id="7971766">,</span>&nbsp;<span class="ident" id="7971768">tc</span>&nbsp;<span class="op" id="7971771">:=</span>&nbsp;<span class="keyword" id="7971774">range</span>&nbsp;<span class="ident" id="7971780">testCase</span>&nbsp;<span class="op" id="7971789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7971793">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7971814">m0</span><span class="op" id="7971816">,</span>&nbsp;<span class="ident" id="7971818">err</span>&nbsp;<span class="op" id="7971822">:=</span>&nbsp;<span class="ident" id="7971825">readPng</span><span class="op" id="7971832">(</span><span class="ident" id="7971833">tc</span><span class="op" id="7971835">.</span><span class="ident" id="7971836">filename</span><span class="op" id="7971844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971848">if</span>&nbsp;<span class="ident" id="7971851">err</span>&nbsp;<span class="op" id="7971855">!=</span>&nbsp;<span class="ident" id="7971858">nil</span>&nbsp;<span class="op" id="7971862">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7971867">t</span><span class="op" id="7971868">.</span><span class="ident" id="7971869">Error</span><span class="op" id="7971874">(</span><span class="ident" id="7971875">tc</span><span class="op" id="7971877">.</span><span class="ident" id="7971878">filename</span><span class="op" id="7971886">,</span>&nbsp;<span class="ident" id="7971888">err</span><span class="op" id="7971891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971896">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7971907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7971911">//&nbsp;Encode&nbsp;that&nbsp;image&nbsp;as&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7971943">var</span>&nbsp;<span class="ident" id="7971947">buf</span>&nbsp;<span class="ident" id="7971951">bytes</span><span class="op" id="7971956">.</span><span class="ident" id="7971957">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7971966">err</span>&nbsp;<span class="op" id="7971970">=</span>&nbsp;<span class="ident" id="7971972">Encode</span><span class="op" id="7971978">(</span><span class="op" id="7971979">&amp;</span><span class="ident" id="7971980">buf</span><span class="op" id="7971983">,</span>&nbsp;<span class="ident" id="7971985">m0</span><span class="op" id="7971987">,</span>&nbsp;<span class="op" id="7971989">&amp;</span><span class="ident" id="7971990">Options</span><span class="op" id="7971997">{</span><span class="ident" id="7971998">Quality</span><span class="op" id="7972005">:</span>&nbsp;<span class="ident" id="7972007">tc</span><span class="op" id="7972009">.</span><span class="ident" id="7972010">quality</span><span class="op" id="7972017">}</span><span class="op" id="7972018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972022">if</span>&nbsp;<span class="ident" id="7972025">err</span>&nbsp;<span class="op" id="7972029">!=</span>&nbsp;<span class="ident" id="7972032">nil</span>&nbsp;<span class="op" id="7972036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972041">t</span><span class="op" id="7972042">.</span><span class="ident" id="7972043">Error</span><span class="op" id="7972048">(</span><span class="ident" id="7972049">tc</span><span class="op" id="7972051">.</span><span class="ident" id="7972052">filename</span><span class="op" id="7972060">,</span>&nbsp;<span class="ident" id="7972062">err</span><span class="op" id="7972065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972070">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7972081">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7972085">//&nbsp;Decode&nbsp;that&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972108">m1</span><span class="op" id="7972110">,</span>&nbsp;<span class="ident" id="7972112">err</span>&nbsp;<span class="op" id="7972116">:=</span>&nbsp;<span class="ident" id="7972119">Decode</span><span class="op" id="7972125">(</span><span class="op" id="7972126">&amp;</span><span class="ident" id="7972127">buf</span><span class="op" id="7972130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972134">if</span>&nbsp;<span class="ident" id="7972137">err</span>&nbsp;<span class="op" id="7972141">!=</span>&nbsp;<span class="ident" id="7972144">nil</span>&nbsp;<span class="op" id="7972148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972153">t</span><span class="op" id="7972154">.</span><span class="ident" id="7972155">Error</span><span class="op" id="7972160">(</span><span class="ident" id="7972161">tc</span><span class="op" id="7972163">.</span><span class="ident" id="7972164">filename</span><span class="op" id="7972172">,</span>&nbsp;<span class="ident" id="7972174">err</span><span class="op" id="7972177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972182">continue</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7972193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972197">if</span>&nbsp;<span class="ident" id="7972200">m0</span><span class="op" id="7972202">.</span><span class="ident" id="7972203">Bounds</span><span class="op" id="7972209">(</span><span class="op" id="7972210">)</span>&nbsp;<span class="op" id="7972212">!=</span>&nbsp;<span class="ident" id="7972215">m1</span><span class="op" id="7972217">.</span><span class="ident" id="7972218">Bounds</span><span class="op" id="7972224">(</span><span class="op" id="7972225">)</span>&nbsp;<span class="op" id="7972227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972232">t</span><span class="op" id="7972233">.</span><span class="ident" id="7972234">Errorf</span><span class="op" id="7972240">(</span><span class="string" id="7972241">&#34;%s,&nbsp;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7972271">,</span>&nbsp;<span class="ident" id="7972273">tc</span><span class="op" id="7972275">.</span><span class="ident" id="7972276">filename</span><span class="op" id="7972284">,</span>&nbsp;<span class="ident" id="7972286">m0</span><span class="op" id="7972288">.</span><span class="ident" id="7972289">Bounds</span><span class="op" id="7972295">(</span><span class="op" id="7972296">)</span><span class="op" id="7972297">,</span>&nbsp;<span class="ident" id="7972299">m1</span><span class="op" id="7972301">.</span><span class="ident" id="7972302">Bounds</span><span class="op" id="7972308">(</span><span class="op" id="7972309">)</span><span class="op" id="7972310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972315">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7972326">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7972330">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972385">if</span>&nbsp;<span class="ident" id="7972388">averageDelta</span><span class="op" id="7972400">(</span><span class="ident" id="7972401">m0</span><span class="op" id="7972403">,</span>&nbsp;<span class="ident" id="7972405">m1</span><span class="op" id="7972407">)</span>&nbsp;<span class="op" id="7972409">&gt;</span>&nbsp;<span class="ident" id="7972411">tc</span><span class="op" id="7972413">.</span><span class="ident" id="7972414">tolerance</span>&nbsp;<span class="op" id="7972424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972429">t</span><span class="op" id="7972430">.</span><span class="ident" id="7972431">Errorf</span><span class="op" id="7972437">(</span><span class="string" id="7972438">&#34;%s,&nbsp;quality=%d:&nbsp;average&nbsp;delta&nbsp;is&nbsp;too&nbsp;high&#34;</span><span class="op" id="7972481">,</span>&nbsp;<span class="ident" id="7972483">tc</span><span class="op" id="7972485">.</span><span class="ident" id="7972486">filename</span><span class="op" id="7972494">,</span>&nbsp;<span class="ident" id="7972496">tc</span><span class="op" id="7972498">.</span><span class="ident" id="7972499">quality</span><span class="op" id="7972506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972511">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7972522">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7972525">}</span><br>
<span class="lineno"></span><span class="op" id="7972527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7972530">//&nbsp;TestWriteGrayscale&nbsp;tests&nbsp;that&nbsp;a&nbsp;grayscale&nbsp;images&nbsp;survives&nbsp;a&nbsp;round-trip</span><br>
<span class="lineno"></span><span class="comment" id="7972604">//&nbsp;through&nbsp;encode/decode&nbsp;cycle.</span><br>
<span class="lineno">165</span><span class="keyword" id="7972636">func</span>&nbsp;<span class="ident" id="7972641">TestWriteGrayscale</span><span class="op" id="7972659">(</span><span class="ident" id="7972660">t</span>&nbsp;<span class="op" id="7972662">*</span><span class="ident" id="7972663">testing</span><span class="op" id="7972670">.</span><span class="ident" id="7972671">T</span><span class="op" id="7972672">)</span>&nbsp;<span class="op" id="7972674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972677">m0</span>&nbsp;<span class="op" id="7972680">:=</span>&nbsp;<span class="ident" id="7972683">image</span><span class="op" id="7972688">.</span><span class="ident" id="7972689">NewGray</span><span class="op" id="7972696">(</span><span class="ident" id="7972697">image</span><span class="op" id="7972702">.</span><span class="ident" id="7972703">Rect</span><span class="op" id="7972707">(</span><span class="num" id="7972708">0</span><span class="op" id="7972709">,</span>&nbsp;<span class="num" id="7972711">0</span><span class="op" id="7972712">,</span>&nbsp;<span class="num" id="7972714">32</span><span class="op" id="7972716">,</span>&nbsp;<span class="num" id="7972718">32</span><span class="op" id="7972720">)</span><span class="op" id="7972721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972724">for</span>&nbsp;<span class="ident" id="7972728">i</span>&nbsp;<span class="op" id="7972730">:=</span>&nbsp;<span class="keyword" id="7972733">range</span>&nbsp;<span class="ident" id="7972739">m0</span><span class="op" id="7972741">.</span><span class="ident" id="7972742">Pix</span>&nbsp;<span class="op" id="7972746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972750">m0</span><span class="op" id="7972752">.</span><span class="ident" id="7972753">Pix</span><span class="op" id="7972756">[</span><span class="ident" id="7972757">i</span><span class="op" id="7972758">]</span>&nbsp;<span class="op" id="7972760">=</span>&nbsp;<span class="builtintype" id="7972762">uint8</span><span class="op" id="7972767">(</span><span class="ident" id="7972768">i</span><span class="op" id="7972769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7972772">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972775">var</span>&nbsp;<span class="ident" id="7972779">buf</span>&nbsp;<span class="ident" id="7972783">bytes</span><span class="op" id="7972788">.</span><span class="ident" id="7972789">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972797">if</span>&nbsp;<span class="ident" id="7972800">err</span>&nbsp;<span class="op" id="7972804">:=</span>&nbsp;<span class="ident" id="7972807">Encode</span><span class="op" id="7972813">(</span><span class="op" id="7972814">&amp;</span><span class="ident" id="7972815">buf</span><span class="op" id="7972818">,</span>&nbsp;<span class="ident" id="7972820">m0</span><span class="op" id="7972822">,</span>&nbsp;<span class="ident" id="7972824">nil</span><span class="op" id="7972827">)</span><span class="op" id="7972828">;</span>&nbsp;<span class="ident" id="7972830">err</span>&nbsp;<span class="op" id="7972834">!=</span>&nbsp;<span class="ident" id="7972837">nil</span>&nbsp;<span class="op" id="7972841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972845">t</span><span class="op" id="7972846">.</span><span class="ident" id="7972847">Fatal</span><span class="op" id="7972852">(</span><span class="ident" id="7972853">err</span><span class="op" id="7972856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7972859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972862">m1</span><span class="op" id="7972864">,</span>&nbsp;<span class="ident" id="7972866">err</span>&nbsp;<span class="op" id="7972870">:=</span>&nbsp;<span class="ident" id="7972873">Decode</span><span class="op" id="7972879">(</span><span class="op" id="7972880">&amp;</span><span class="ident" id="7972881">buf</span><span class="op" id="7972884">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972887">if</span>&nbsp;<span class="ident" id="7972890">err</span>&nbsp;<span class="op" id="7972894">!=</span>&nbsp;<span class="ident" id="7972897">nil</span>&nbsp;<span class="op" id="7972901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972905">t</span><span class="op" id="7972906">.</span><span class="ident" id="7972907">Fatal</span><span class="op" id="7972912">(</span><span class="ident" id="7972913">err</span><span class="op" id="7972916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7972919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7972922">if</span>&nbsp;<span class="ident" id="7972925">m0</span><span class="op" id="7972927">.</span><span class="ident" id="7972928">Bounds</span><span class="op" id="7972934">(</span><span class="op" id="7972935">)</span>&nbsp;<span class="op" id="7972937">!=</span>&nbsp;<span class="ident" id="7972940">m1</span><span class="op" id="7972942">.</span><span class="ident" id="7972943">Bounds</span><span class="op" id="7972949">(</span><span class="op" id="7972950">)</span>&nbsp;<span class="op" id="7972952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7972956">t</span><span class="op" id="7972957">.</span><span class="ident" id="7972958">Fatalf</span><span class="op" id="7972964">(</span><span class="string" id="7972965">&#34;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7972991">,</span>&nbsp;<span class="ident" id="7972993">m0</span><span class="op" id="7972995">.</span><span class="ident" id="7972996">Bounds</span><span class="op" id="7973002">(</span><span class="op" id="7973003">)</span><span class="op" id="7973004">,</span>&nbsp;<span class="ident" id="7973006">m1</span><span class="op" id="7973008">.</span><span class="ident" id="7973009">Bounds</span><span class="op" id="7973015">(</span><span class="op" id="7973016">)</span><span class="op" id="7973017">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7973020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7973023">if</span>&nbsp;<span class="ident" id="7973026">_</span><span class="op" id="7973027">,</span>&nbsp;<span class="ident" id="7973029">ok</span>&nbsp;<span class="op" id="7973032">:=</span>&nbsp;<span class="ident" id="7973035">m1</span><span class="op" id="7973037">.</span><span class="op" id="7973038">(</span><span class="op" id="7973039">*</span><span class="ident" id="7973040">image</span><span class="op" id="7973045">.</span><span class="ident" id="7973046">Gray</span><span class="op" id="7973050">)</span><span class="op" id="7973051">;</span>&nbsp;<span class="op" id="7973053">!</span><span class="ident" id="7973054">ok</span>&nbsp;<span class="op" id="7973057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973061">t</span><span class="op" id="7973062">.</span><span class="ident" id="7973063">Errorf</span><span class="op" id="7973069">(</span><span class="string" id="7973070">&#34;got&nbsp;%T,&nbsp;want&nbsp;*image.Gray&#34;</span><span class="op" id="7973096">,</span>&nbsp;<span class="ident" id="7973098">m1</span><span class="op" id="7973100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7973103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7973106">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973160">want</span>&nbsp;<span class="op" id="7973165">:=</span>&nbsp;<span class="ident" id="7973168">int64</span><span class="op" id="7973173">(</span><span class="num" id="7973174">2</span>&nbsp;<span class="op" id="7973176">&lt;&lt;</span>&nbsp;<span class="num" id="7973179">8</span><span class="op" id="7973180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7973183">if</span>&nbsp;<span class="ident" id="7973186">got</span>&nbsp;<span class="op" id="7973190">:=</span>&nbsp;<span class="ident" id="7973193">averageDelta</span><span class="op" id="7973205">(</span><span class="ident" id="7973206">m0</span><span class="op" id="7973208">,</span>&nbsp;<span class="ident" id="7973210">m1</span><span class="op" id="7973212">)</span><span class="op" id="7973213">;</span>&nbsp;<span class="ident" id="7973215">got</span>&nbsp;<span class="op" id="7973219">&gt;</span>&nbsp;<span class="ident" id="7973221">want</span>&nbsp;<span class="op" id="7973226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973230">t</span><span class="op" id="7973231">.</span><span class="ident" id="7973232">Errorf</span><span class="op" id="7973238">(</span><span class="string" id="7973239">&#34;average&nbsp;delta&nbsp;too&nbsp;high;&nbsp;got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&#34;</span><span class="op" id="7973283">,</span>&nbsp;<span class="ident" id="7973285">got</span><span class="op" id="7973288">,</span>&nbsp;<span class="ident" id="7973290">want</span><span class="op" id="7973294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7973297">}</span><br>
<span class="lineno"></span><span class="op" id="7973299">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="7973302">//&nbsp;averageDelta&nbsp;returns&nbsp;the&nbsp;average&nbsp;delta&nbsp;in&nbsp;RGB&nbsp;space.&nbsp;The&nbsp;two&nbsp;images&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="7973378">//&nbsp;have&nbsp;the&nbsp;same&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword" id="7973403">func</span>&nbsp;<span class="ident" id="7973408">averageDelta</span><span class="op" id="7973420">(</span><span class="ident" id="7973421">m0</span><span class="op" id="7973423">,</span>&nbsp;<span class="ident" id="7973425">m1</span>&nbsp;<span class="ident" id="7973428">image</span><span class="op" id="7973433">.</span><span class="ident" id="7973434">Image</span><span class="op" id="7973439">)</span>&nbsp;<span class="ident" id="7973441">int64</span>&nbsp;<span class="op" id="7973447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973450">b</span>&nbsp;<span class="op" id="7973452">:=</span>&nbsp;<span class="ident" id="7973455">m0</span><span class="op" id="7973457">.</span><span class="ident" id="7973458">Bounds</span><span class="op" id="7973464">(</span><span class="op" id="7973465">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7973468">var</span>&nbsp;<span class="ident" id="7973472">sum</span><span class="op" id="7973475">,</span>&nbsp;<span class="ident" id="7973477">n</span>&nbsp;<span class="ident" id="7973479">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7973486">for</span>&nbsp;<span class="ident" id="7973490">y</span>&nbsp;<span class="op" id="7973492">:=</span>&nbsp;<span class="ident" id="7973495">b</span><span class="op" id="7973496">.</span><span class="ident" id="7973497">Min</span><span class="op" id="7973500">.</span><span class="ident" id="7973501">Y</span><span class="op" id="7973502">;</span>&nbsp;<span class="ident" id="7973504">y</span>&nbsp;<span class="op" id="7973506">&lt;</span>&nbsp;<span class="ident" id="7973508">b</span><span class="op" id="7973509">.</span><span class="ident" id="7973510">Max</span><span class="op" id="7973513">.</span><span class="ident" id="7973514">Y</span><span class="op" id="7973515">;</span>&nbsp;<span class="ident" id="7973517">y</span><span class="op" id="7973518">++</span>&nbsp;<span class="op" id="7973521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7973525">for</span>&nbsp;<span class="ident" id="7973529">x</span>&nbsp;<span class="op" id="7973531">:=</span>&nbsp;<span class="ident" id="7973534">b</span><span class="op" id="7973535">.</span><span class="ident" id="7973536">Min</span><span class="op" id="7973539">.</span><span class="ident" id="7973540">X</span><span class="op" id="7973541">;</span>&nbsp;<span class="ident" id="7973543">x</span>&nbsp;<span class="op" id="7973545">&lt;</span>&nbsp;<span class="ident" id="7973547">b</span><span class="op" id="7973548">.</span><span class="ident" id="7973549">Max</span><span class="op" id="7973552">.</span><span class="ident" id="7973553">X</span><span class="op" id="7973554">;</span>&nbsp;<span class="ident" id="7973556">x</span><span class="op" id="7973557">++</span>&nbsp;<span class="op" id="7973560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973565">c0</span>&nbsp;<span class="op" id="7973568">:=</span>&nbsp;<span class="ident" id="7973571">m0</span><span class="op" id="7973573">.</span><span class="ident" id="7973574">At</span><span class="op" id="7973576">(</span><span class="ident" id="7973577">x</span><span class="op" id="7973578">,</span>&nbsp;<span class="ident" id="7973580">y</span><span class="op" id="7973581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973586">c1</span>&nbsp;<span class="op" id="7973589">:=</span>&nbsp;<span class="ident" id="7973592">m1</span><span class="op" id="7973594">.</span><span class="ident" id="7973595">At</span><span class="op" id="7973597">(</span><span class="ident" id="7973598">x</span><span class="op" id="7973599">,</span>&nbsp;<span class="ident" id="7973601">y</span><span class="op" id="7973602">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973607">r0</span><span class="op" id="7973609">,</span>&nbsp;<span class="ident" id="7973611">g0</span><span class="op" id="7973613">,</span>&nbsp;<span class="ident" id="7973615">b0</span><span class="op" id="7973617">,</span>&nbsp;<span class="ident" id="7973619">_</span>&nbsp;<span class="op" id="7973621">:=</span>&nbsp;<span class="ident" id="7973624">c0</span><span class="op" id="7973626">.</span><span class="ident" id="7973627">RGBA</span><span class="op" id="7973631">(</span><span class="op" id="7973632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973637">r1</span><span class="op" id="7973639">,</span>&nbsp;<span class="ident" id="7973641">g1</span><span class="op" id="7973643">,</span>&nbsp;<span class="ident" id="7973645">b1</span><span class="op" id="7973647">,</span>&nbsp;<span class="ident" id="7973649">_</span>&nbsp;<span class="op" id="7973651">:=</span>&nbsp;<span class="ident" id="7973654">c1</span><span class="op" id="7973656">.</span><span class="ident" id="7973657">RGBA</span><span class="op" id="7973661">(</span><span class="op" id="7973662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973667">sum</span>&nbsp;<span class="op" id="7973671">+=</span>&nbsp;<span class="ident" id="7973674">delta</span><span class="op" id="7973679">(</span><span class="ident" id="7973680">r0</span><span class="op" id="7973682">,</span>&nbsp;<span class="ident" id="7973684">r1</span><span class="op" id="7973686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973691">sum</span>&nbsp;<span class="op" id="7973695">+=</span>&nbsp;<span class="ident" id="7973698">delta</span><span class="op" id="7973703">(</span><span class="ident" id="7973704">g0</span><span class="op" id="7973706">,</span>&nbsp;<span class="ident" id="7973708">g1</span><span class="op" id="7973710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973715">sum</span>&nbsp;<span class="op" id="7973719">+=</span>&nbsp;<span class="ident" id="7973722">delta</span><span class="op" id="7973727">(</span><span class="ident" id="7973728">b0</span><span class="op" id="7973730">,</span>&nbsp;<span class="ident" id="7973732">b1</span><span class="op" id="7973734">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973739">n</span>&nbsp;<span class="op" id="7973741">+=</span>&nbsp;<span class="num" id="7973744">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7973748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7973751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7973754">return</span>&nbsp;<span class="ident" id="7973761">sum</span>&nbsp;<span class="op" id="7973765">/</span>&nbsp;<span class="ident" id="7973767">n</span><br>
<span class="lineno"></span><span class="op" id="7973769">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="7973772">func</span>&nbsp;<span class="ident" id="7973777">BenchmarkEncode</span><span class="op" id="7973792">(</span><span class="ident" id="7973793">b</span>&nbsp;<span class="op" id="7973795">*</span><span class="ident" id="7973796">testing</span><span class="op" id="7973803">.</span><span class="ident" id="7973804">B</span><span class="op" id="7973805">)</span>&nbsp;<span class="op" id="7973807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973810">b</span><span class="op" id="7973811">.</span><span class="ident" id="7973812">StopTimer</span><span class="op" id="7973821">(</span><span class="op" id="7973822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973825">img</span>&nbsp;<span class="op" id="7973829">:=</span>&nbsp;<span class="ident" id="7973832">image</span><span class="op" id="7973837">.</span><span class="ident" id="7973838">NewRGBA</span><span class="op" id="7973845">(</span><span class="ident" id="7973846">image</span><span class="op" id="7973851">.</span><span class="ident" id="7973852">Rect</span><span class="op" id="7973856">(</span><span class="num" id="7973857">0</span><span class="op" id="7973858">,</span>&nbsp;<span class="num" id="7973860">0</span><span class="op" id="7973861">,</span>&nbsp;<span class="num" id="7973863">640</span><span class="op" id="7973866">,</span>&nbsp;<span class="num" id="7973868">480</span><span class="op" id="7973871">)</span><span class="op" id="7973872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973875">bo</span>&nbsp;<span class="op" id="7973878">:=</span>&nbsp;<span class="ident" id="7973881">img</span><span class="op" id="7973884">.</span><span class="ident" id="7973885">Bounds</span><span class="op" id="7973891">(</span><span class="op" id="7973892">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7973895">rnd</span>&nbsp;<span class="op" id="7973899">:=</span>&nbsp;<span class="ident" id="7973902">rand</span><span class="op" id="7973906">.</span><span class="ident" id="7973907">New</span><span class="op" id="7973910">(</span><span class="ident" id="7973911">rand</span><span class="op" id="7973915">.</span><span class="ident" id="7973916">NewSource</span><span class="op" id="7973925">(</span><span class="num" id="7973926">123</span><span class="op" id="7973929">)</span><span class="op" id="7973930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7973933">for</span>&nbsp;<span class="ident" id="7973937">y</span>&nbsp;<span class="op" id="7973939">:=</span>&nbsp;<span class="ident" id="7973942">bo</span><span class="op" id="7973944">.</span><span class="ident" id="7973945">Min</span><span class="op" id="7973948">.</span><span class="ident" id="7973949">Y</span><span class="op" id="7973950">;</span>&nbsp;<span class="ident" id="7973952">y</span>&nbsp;<span class="op" id="7973954">&lt;</span>&nbsp;<span class="ident" id="7973956">bo</span><span class="op" id="7973958">.</span><span class="ident" id="7973959">Max</span><span class="op" id="7973962">.</span><span class="ident" id="7973963">Y</span><span class="op" id="7973964">;</span>&nbsp;<span class="ident" id="7973966">y</span><span class="op" id="7973967">++</span>&nbsp;<span class="op" id="7973970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7973974">for</span>&nbsp;<span class="ident" id="7973978">x</span>&nbsp;<span class="op" id="7973980">:=</span>&nbsp;<span class="ident" id="7973983">bo</span><span class="op" id="7973985">.</span><span class="ident" id="7973986">Min</span><span class="op" id="7973989">.</span><span class="ident" id="7973990">X</span><span class="op" id="7973991">;</span>&nbsp;<span class="ident" id="7973993">x</span>&nbsp;<span class="op" id="7973995">&lt;</span>&nbsp;<span class="ident" id="7973997">bo</span><span class="op" id="7973999">.</span><span class="ident" id="7974000">Max</span><span class="op" id="7974003">.</span><span class="ident" id="7974004">X</span><span class="op" id="7974005">;</span>&nbsp;<span class="ident" id="7974007">x</span><span class="op" id="7974008">++</span>&nbsp;<span class="op" id="7974011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7974016">img</span><span class="op" id="7974019">.</span><span class="ident" id="7974020">SetRGBA</span><span class="op" id="7974027">(</span><span class="ident" id="7974028">x</span><span class="op" id="7974029">,</span>&nbsp;<span class="ident" id="7974031">y</span><span class="op" id="7974032">,</span>&nbsp;<span class="ident" id="7974034">color</span><span class="op" id="7974039">.</span><span class="ident" id="7974040">RGBA</span><span class="op" id="7974044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7974050">uint8</span><span class="op" id="7974055">(</span><span class="ident" id="7974056">rnd</span><span class="op" id="7974059">.</span><span class="ident" id="7974060">Intn</span><span class="op" id="7974064">(</span><span class="num" id="7974065">256</span><span class="op" id="7974068">)</span><span class="op" id="7974069">)</span><span class="op" id="7974070">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7974076">uint8</span><span class="op" id="7974081">(</span><span class="ident" id="7974082">rnd</span><span class="op" id="7974085">.</span><span class="ident" id="7974086">Intn</span><span class="op" id="7974090">(</span><span class="num" id="7974091">256</span><span class="op" id="7974094">)</span><span class="op" id="7974095">)</span><span class="op" id="7974096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7974102">uint8</span><span class="op" id="7974107">(</span><span class="ident" id="7974108">rnd</span><span class="op" id="7974111">.</span><span class="ident" id="7974112">Intn</span><span class="op" id="7974116">(</span><span class="num" id="7974117">256</span><span class="op" id="7974120">)</span><span class="op" id="7974121">)</span><span class="op" id="7974122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7974128">255</span><span class="op" id="7974131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974136">}</span><span class="op" id="7974137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974141">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7974147">b</span><span class="op" id="7974148">.</span><span class="ident" id="7974149">SetBytes</span><span class="op" id="7974157">(</span><span class="num" id="7974158">640</span>&nbsp;<span class="op" id="7974162">*</span>&nbsp;<span class="num" id="7974164">480</span>&nbsp;<span class="op" id="7974168">*</span>&nbsp;<span class="num" id="7974170">4</span><span class="op" id="7974171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7974174">b</span><span class="op" id="7974175">.</span><span class="ident" id="7974176">StartTimer</span><span class="op" id="7974186">(</span><span class="op" id="7974187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7974190">options</span>&nbsp;<span class="op" id="7974198">:=</span>&nbsp;<span class="op" id="7974201">&amp;</span><span class="ident" id="7974202">Options</span><span class="op" id="7974209">{</span><span class="ident" id="7974210">Quality</span><span class="op" id="7974217">:</span>&nbsp;<span class="num" id="7974219">90</span><span class="op" id="7974221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7974224">for</span>&nbsp;<span class="ident" id="7974228">i</span>&nbsp;<span class="op" id="7974230">:=</span>&nbsp;<span class="num" id="7974233">0</span><span class="op" id="7974234">;</span>&nbsp;<span class="ident" id="7974236">i</span>&nbsp;<span class="op" id="7974238">&lt;</span>&nbsp;<span class="ident" id="7974240">b</span><span class="op" id="7974241">.</span><span class="ident" id="7974242">N</span><span class="op" id="7974243">;</span>&nbsp;<span class="ident" id="7974245">i</span><span class="op" id="7974246">++</span>&nbsp;<span class="op" id="7974249">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7974253">Encode</span><span class="op" id="7974259">(</span><span class="ident" id="7974260">ioutil</span><span class="op" id="7974266">.</span><span class="ident" id="7974267">Discard</span><span class="op" id="7974274">,</span>&nbsp;<span class="ident" id="7974276">img</span><span class="op" id="7974279">,</span>&nbsp;<span class="ident" id="7974281">options</span><span class="op" id="7974288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974291">}</span><br>
<span class="lineno"></span><span class="op" id="7974293">}</span>
</div>
</body>
</html>
