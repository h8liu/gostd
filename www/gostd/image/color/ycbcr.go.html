<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html" class="current">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3791597">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3791652">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3791706">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3791757">package</span>&nbsp;<span class="ident" id="3791765">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3791772">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="3791829">func</span>&nbsp;<span class="ident" id="3791834">RGBToYCbCr</span><span class="op" id="3791844">(</span><span class="ident" id="3791845">r</span><span class="op" id="3791846">,</span>&nbsp;<span class="ident" id="3791848">g</span><span class="op" id="3791849">,</span>&nbsp;<span class="ident" id="3791851">b</span>&nbsp;<span class="builtintype" id="3791853">uint8</span><span class="op" id="3791858">)</span>&nbsp;<span class="op" id="3791860">(</span><span class="builtintype" id="3791861">uint8</span><span class="op" id="3791866">,</span>&nbsp;<span class="builtintype" id="3791868">uint8</span><span class="op" id="3791873">,</span>&nbsp;<span class="builtintype" id="3791875">uint8</span><span class="op" id="3791880">)</span>&nbsp;<span class="op" id="3791882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3791885">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3791918">//&nbsp;&nbsp;&nbsp;&nbsp;Y&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3791959">//&nbsp;&nbsp;&nbsp;&nbsp;Cb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3792006">//&nbsp;&nbsp;&nbsp;&nbsp;Cr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3792053">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792120">r1</span>&nbsp;<span class="op" id="3792123">:=</span>&nbsp;<span class="builtintype" id="3792126">int</span><span class="op" id="3792129">(</span><span class="ident" id="3792130">r</span><span class="op" id="3792131">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792134">g1</span>&nbsp;<span class="op" id="3792137">:=</span>&nbsp;<span class="builtintype" id="3792140">int</span><span class="op" id="3792143">(</span><span class="ident" id="3792144">g</span><span class="op" id="3792145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792148">b1</span>&nbsp;<span class="op" id="3792151">:=</span>&nbsp;<span class="builtintype" id="3792154">int</span><span class="op" id="3792157">(</span><span class="ident" id="3792158">b</span><span class="op" id="3792159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792162">yy</span>&nbsp;<span class="op" id="3792165">:=</span>&nbsp;<span class="op" id="3792168">(</span><span class="num" id="3792169">19595</span><span class="op" id="3792174">*</span><span class="ident" id="3792175">r1</span>&nbsp;<span class="op" id="3792178">+</span>&nbsp;<span class="num" id="3792180">38470</span><span class="op" id="3792185">*</span><span class="ident" id="3792186">g1</span>&nbsp;<span class="op" id="3792189">+</span>&nbsp;<span class="num" id="3792191">7471</span><span class="op" id="3792195">*</span><span class="ident" id="3792196">b1</span>&nbsp;<span class="op" id="3792199">+</span>&nbsp;<span class="num" id="3792201">1</span><span class="op" id="3792202">&lt;&lt;</span><span class="num" id="3792204">15</span><span class="op" id="3792206">)</span>&nbsp;<span class="op" id="3792208">&gt;&gt;</span>&nbsp;<span class="num" id="3792211">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792215">cb</span>&nbsp;<span class="op" id="3792218">:=</span>&nbsp;<span class="op" id="3792221">(</span><span class="op" id="3792222">-</span><span class="num" id="3792223">11056</span><span class="op" id="3792228">*</span><span class="ident" id="3792229">r1</span>&nbsp;<span class="op" id="3792232">-</span>&nbsp;<span class="num" id="3792234">21712</span><span class="op" id="3792239">*</span><span class="ident" id="3792240">g1</span>&nbsp;<span class="op" id="3792243">+</span>&nbsp;<span class="num" id="3792245">32768</span><span class="op" id="3792250">*</span><span class="ident" id="3792251">b1</span>&nbsp;<span class="op" id="3792254">+</span>&nbsp;<span class="num" id="3792256">257</span><span class="op" id="3792259">&lt;&lt;</span><span class="num" id="3792261">15</span><span class="op" id="3792263">)</span>&nbsp;<span class="op" id="3792265">&gt;&gt;</span>&nbsp;<span class="num" id="3792268">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792272">cr</span>&nbsp;<span class="op" id="3792275">:=</span>&nbsp;<span class="op" id="3792278">(</span><span class="num" id="3792279">32768</span><span class="op" id="3792284">*</span><span class="ident" id="3792285">r1</span>&nbsp;<span class="op" id="3792288">-</span>&nbsp;<span class="num" id="3792290">27440</span><span class="op" id="3792295">*</span><span class="ident" id="3792296">g1</span>&nbsp;<span class="op" id="3792299">-</span>&nbsp;<span class="num" id="3792301">5328</span><span class="op" id="3792305">*</span><span class="ident" id="3792306">b1</span>&nbsp;<span class="op" id="3792309">+</span>&nbsp;<span class="num" id="3792311">257</span><span class="op" id="3792314">&lt;&lt;</span><span class="num" id="3792316">15</span><span class="op" id="3792318">)</span>&nbsp;<span class="op" id="3792320">&gt;&gt;</span>&nbsp;<span class="num" id="3792323">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3792327">if</span>&nbsp;<span class="ident" id="3792330">yy</span>&nbsp;<span class="op" id="3792333">&lt;</span>&nbsp;<span class="num" id="3792335">0</span>&nbsp;<span class="op" id="3792337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792341">yy</span>&nbsp;<span class="op" id="3792344">=</span>&nbsp;<span class="num" id="3792346">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3792349">}</span>&nbsp;<span class="keyword" id="3792351">else</span>&nbsp;<span class="keyword" id="3792356">if</span>&nbsp;<span class="ident" id="3792359">yy</span>&nbsp;<span class="op" id="3792362">&gt;</span>&nbsp;<span class="num" id="3792364">255</span>&nbsp;<span class="op" id="3792368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792372">yy</span>&nbsp;<span class="op" id="3792375">=</span>&nbsp;<span class="num" id="3792377">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3792382">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3792385">if</span>&nbsp;<span class="ident" id="3792388">cb</span>&nbsp;<span class="op" id="3792391">&lt;</span>&nbsp;<span class="num" id="3792393">0</span>&nbsp;<span class="op" id="3792395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792399">cb</span>&nbsp;<span class="op" id="3792402">=</span>&nbsp;<span class="num" id="3792404">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3792407">}</span>&nbsp;<span class="keyword" id="3792409">else</span>&nbsp;<span class="keyword" id="3792414">if</span>&nbsp;<span class="ident" id="3792417">cb</span>&nbsp;<span class="op" id="3792420">&gt;</span>&nbsp;<span class="num" id="3792422">255</span>&nbsp;<span class="op" id="3792426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792430">cb</span>&nbsp;<span class="op" id="3792433">=</span>&nbsp;<span class="num" id="3792435">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3792440">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3792443">if</span>&nbsp;<span class="ident" id="3792446">cr</span>&nbsp;<span class="op" id="3792449">&lt;</span>&nbsp;<span class="num" id="3792451">0</span>&nbsp;<span class="op" id="3792453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792457">cr</span>&nbsp;<span class="op" id="3792460">=</span>&nbsp;<span class="num" id="3792462">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3792465">}</span>&nbsp;<span class="keyword" id="3792467">else</span>&nbsp;<span class="keyword" id="3792472">if</span>&nbsp;<span class="ident" id="3792475">cr</span>&nbsp;<span class="op" id="3792478">&gt;</span>&nbsp;<span class="num" id="3792480">255</span>&nbsp;<span class="op" id="3792484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792488">cr</span>&nbsp;<span class="op" id="3792491">=</span>&nbsp;<span class="num" id="3792493">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3792498">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3792501">return</span>&nbsp;<span class="builtintype" id="3792508">uint8</span><span class="op" id="3792513">(</span><span class="ident" id="3792514">yy</span><span class="op" id="3792516">)</span><span class="op" id="3792517">,</span>&nbsp;<span class="builtintype" id="3792519">uint8</span><span class="op" id="3792524">(</span><span class="ident" id="3792525">cb</span><span class="op" id="3792527">)</span><span class="op" id="3792528">,</span>&nbsp;<span class="builtintype" id="3792530">uint8</span><span class="op" id="3792535">(</span><span class="ident" id="3792536">cr</span><span class="op" id="3792538">)</span><br>
<span class="lineno"></span><span class="op" id="3792540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3792543">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="3792600">func</span>&nbsp;<span class="ident" id="3792605">YCbCrToRGB</span><span class="op" id="3792615">(</span><span class="ident" id="3792616">y</span><span class="op" id="3792617">,</span>&nbsp;<span class="ident" id="3792619">cb</span><span class="op" id="3792621">,</span>&nbsp;<span class="ident" id="3792623">cr</span>&nbsp;<span class="builtintype" id="3792626">uint8</span><span class="op" id="3792631">)</span>&nbsp;<span class="op" id="3792633">(</span><span class="builtintype" id="3792634">uint8</span><span class="op" id="3792639">,</span>&nbsp;<span class="builtintype" id="3792641">uint8</span><span class="op" id="3792646">,</span>&nbsp;<span class="builtintype" id="3792648">uint8</span><span class="op" id="3792653">)</span>&nbsp;<span class="op" id="3792655">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3792658">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3792691">//&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3792721">//&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3792770">//&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3792800">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792867">yy1</span>&nbsp;<span class="op" id="3792871">:=</span>&nbsp;<span class="builtintype" id="3792874">int</span><span class="op" id="3792877">(</span><span class="ident" id="3792878">y</span><span class="op" id="3792879">)</span><span class="op" id="3792880">&lt;&lt;</span><span class="num" id="3792882">16</span>&nbsp;<span class="op" id="3792885">+</span>&nbsp;<span class="num" id="3792887">1</span><span class="op" id="3792888">&lt;&lt;</span><span class="num" id="3792890">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792894">cb1</span>&nbsp;<span class="op" id="3792898">:=</span>&nbsp;<span class="builtintype" id="3792901">int</span><span class="op" id="3792904">(</span><span class="ident" id="3792905">cb</span><span class="op" id="3792907">)</span>&nbsp;<span class="op" id="3792909">-</span>&nbsp;<span class="num" id="3792911">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792916">cr1</span>&nbsp;<span class="op" id="3792920">:=</span>&nbsp;<span class="builtintype" id="3792923">int</span><span class="op" id="3792926">(</span><span class="ident" id="3792927">cr</span><span class="op" id="3792929">)</span>&nbsp;<span class="op" id="3792931">-</span>&nbsp;<span class="num" id="3792933">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792938">r</span>&nbsp;<span class="op" id="3792940">:=</span>&nbsp;<span class="op" id="3792943">(</span><span class="ident" id="3792944">yy1</span>&nbsp;<span class="op" id="3792948">+</span>&nbsp;<span class="num" id="3792950">91881</span><span class="op" id="3792955">*</span><span class="ident" id="3792956">cr1</span><span class="op" id="3792959">)</span>&nbsp;<span class="op" id="3792961">&gt;&gt;</span>&nbsp;<span class="num" id="3792964">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3792968">g</span>&nbsp;<span class="op" id="3792970">:=</span>&nbsp;<span class="op" id="3792973">(</span><span class="ident" id="3792974">yy1</span>&nbsp;<span class="op" id="3792978">-</span>&nbsp;<span class="num" id="3792980">22554</span><span class="op" id="3792985">*</span><span class="ident" id="3792986">cb1</span>&nbsp;<span class="op" id="3792990">-</span>&nbsp;<span class="num" id="3792992">46802</span><span class="op" id="3792997">*</span><span class="ident" id="3792998">cr1</span><span class="op" id="3793001">)</span>&nbsp;<span class="op" id="3793003">&gt;&gt;</span>&nbsp;<span class="num" id="3793006">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793010">b</span>&nbsp;<span class="op" id="3793012">:=</span>&nbsp;<span class="op" id="3793015">(</span><span class="ident" id="3793016">yy1</span>&nbsp;<span class="op" id="3793020">+</span>&nbsp;<span class="num" id="3793022">116130</span><span class="op" id="3793028">*</span><span class="ident" id="3793029">cb1</span><span class="op" id="3793032">)</span>&nbsp;<span class="op" id="3793034">&gt;&gt;</span>&nbsp;<span class="num" id="3793037">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793041">if</span>&nbsp;<span class="ident" id="3793044">r</span>&nbsp;<span class="op" id="3793046">&lt;</span>&nbsp;<span class="num" id="3793048">0</span>&nbsp;<span class="op" id="3793050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793054">r</span>&nbsp;<span class="op" id="3793056">=</span>&nbsp;<span class="num" id="3793058">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793061">}</span>&nbsp;<span class="keyword" id="3793063">else</span>&nbsp;<span class="keyword" id="3793068">if</span>&nbsp;<span class="ident" id="3793071">r</span>&nbsp;<span class="op" id="3793073">&gt;</span>&nbsp;<span class="num" id="3793075">255</span>&nbsp;<span class="op" id="3793079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793083">r</span>&nbsp;<span class="op" id="3793085">=</span>&nbsp;<span class="num" id="3793087">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793095">if</span>&nbsp;<span class="ident" id="3793098">g</span>&nbsp;<span class="op" id="3793100">&lt;</span>&nbsp;<span class="num" id="3793102">0</span>&nbsp;<span class="op" id="3793104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793108">g</span>&nbsp;<span class="op" id="3793110">=</span>&nbsp;<span class="num" id="3793112">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793115">}</span>&nbsp;<span class="keyword" id="3793117">else</span>&nbsp;<span class="keyword" id="3793122">if</span>&nbsp;<span class="ident" id="3793125">g</span>&nbsp;<span class="op" id="3793127">&gt;</span>&nbsp;<span class="num" id="3793129">255</span>&nbsp;<span class="op" id="3793133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793137">g</span>&nbsp;<span class="op" id="3793139">=</span>&nbsp;<span class="num" id="3793141">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793149">if</span>&nbsp;<span class="ident" id="3793152">b</span>&nbsp;<span class="op" id="3793154">&lt;</span>&nbsp;<span class="num" id="3793156">0</span>&nbsp;<span class="op" id="3793158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793162">b</span>&nbsp;<span class="op" id="3793164">=</span>&nbsp;<span class="num" id="3793166">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793169">}</span>&nbsp;<span class="keyword" id="3793171">else</span>&nbsp;<span class="keyword" id="3793176">if</span>&nbsp;<span class="ident" id="3793179">b</span>&nbsp;<span class="op" id="3793181">&gt;</span>&nbsp;<span class="num" id="3793183">255</span>&nbsp;<span class="op" id="3793187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793191">b</span>&nbsp;<span class="op" id="3793193">=</span>&nbsp;<span class="num" id="3793195">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3793200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3793203">return</span>&nbsp;<span class="builtintype" id="3793210">uint8</span><span class="op" id="3793215">(</span><span class="ident" id="3793216">r</span><span class="op" id="3793217">)</span><span class="op" id="3793218">,</span>&nbsp;<span class="builtintype" id="3793220">uint8</span><span class="op" id="3793225">(</span><span class="ident" id="3793226">g</span><span class="op" id="3793227">)</span><span class="op" id="3793228">,</span>&nbsp;<span class="builtintype" id="3793230">uint8</span><span class="op" id="3793235">(</span><span class="ident" id="3793236">b</span><span class="op" id="3793237">)</span><br>
<span class="lineno"></span><span class="op" id="3793239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3793242">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="3793321">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="3793360">//</span><br>
<span class="lineno"></span><span class="comment" id="3793363">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="3793437">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="3793512">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="3793590">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="3793643">//</span><br>
<span class="lineno"></span><span class="comment" id="3793646">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="3793725">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="3793800">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="3793872">type</span>&nbsp;<span class="ident" id="3793877">YCbCr</span>&nbsp;<span class="keyword" id="3793883">struct</span>&nbsp;<span class="op" id="3793890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793893">Y</span><span class="op" id="3793894">,</span>&nbsp;<span class="ident" id="3793896">Cb</span><span class="op" id="3793898">,</span>&nbsp;<span class="ident" id="3793900">Cr</span>&nbsp;<span class="builtintype" id="3793903">uint8</span><br>
<span class="lineno"></span><span class="op" id="3793909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3793912">func</span>&nbsp;<span class="op" id="3793917">(</span><span class="ident" id="3793918">c</span>&nbsp;<span class="ident" id="3793920">YCbCr</span><span class="op" id="3793925">)</span>&nbsp;<span class="ident" id="3793927">RGBA</span><span class="op" id="3793931">(</span><span class="op" id="3793932">)</span>&nbsp;<span class="op" id="3793934">(</span><span class="builtintype" id="3793935">uint32</span><span class="op" id="3793941">,</span>&nbsp;<span class="builtintype" id="3793943">uint32</span><span class="op" id="3793949">,</span>&nbsp;<span class="builtintype" id="3793951">uint32</span><span class="op" id="3793957">,</span>&nbsp;<span class="builtintype" id="3793959">uint32</span><span class="op" id="3793965">)</span>&nbsp;<span class="op" id="3793967">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3793970">r</span><span class="op" id="3793971">,</span>&nbsp;<span class="ident" id="3793973">g</span><span class="op" id="3793974">,</span>&nbsp;<span class="ident" id="3793976">b</span>&nbsp;<span class="op" id="3793978">:=</span>&nbsp;<span class="ident" id="3793981">YCbCrToRGB</span><span class="op" id="3793991">(</span><span class="ident" id="3793992">c</span><span class="op" id="3793993">.</span><span class="ident" id="3793994">Y</span><span class="op" id="3793995">,</span>&nbsp;<span class="ident" id="3793997">c</span><span class="op" id="3793998">.</span><span class="ident" id="3793999">Cb</span><span class="op" id="3794001">,</span>&nbsp;<span class="ident" id="3794003">c</span><span class="op" id="3794004">.</span><span class="ident" id="3794005">Cr</span><span class="op" id="3794007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3794010">return</span>&nbsp;<span class="builtintype" id="3794017">uint32</span><span class="op" id="3794023">(</span><span class="ident" id="3794024">r</span><span class="op" id="3794025">)</span>&nbsp;<span class="op" id="3794027">*</span>&nbsp;<span class="num" id="3794029">0x101</span><span class="op" id="3794034">,</span>&nbsp;<span class="builtintype" id="3794036">uint32</span><span class="op" id="3794042">(</span><span class="ident" id="3794043">g</span><span class="op" id="3794044">)</span>&nbsp;<span class="op" id="3794046">*</span>&nbsp;<span class="num" id="3794048">0x101</span><span class="op" id="3794053">,</span>&nbsp;<span class="builtintype" id="3794055">uint32</span><span class="op" id="3794061">(</span><span class="ident" id="3794062">b</span><span class="op" id="3794063">)</span>&nbsp;<span class="op" id="3794065">*</span>&nbsp;<span class="num" id="3794067">0x101</span><span class="op" id="3794072">,</span>&nbsp;<span class="num" id="3794074">0xffff</span><br>
<span class="lineno"></span><span class="op" id="3794081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3794084">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="3794130">var</span>&nbsp;<span class="ident" id="3794134">YCbCrModel</span>&nbsp;<span class="ident" id="3794145">Model</span>&nbsp;<span class="op" id="3794151">=</span>&nbsp;<span class="ident" id="3794153">ModelFunc</span><span class="op" id="3794162">(</span><span class="ident" id="3794163">yCbCrModel</span><span class="op" id="3794173">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3794176">func</span>&nbsp;<span class="ident" id="3794181">yCbCrModel</span><span class="op" id="3794191">(</span><span class="ident" id="3794192">c</span>&nbsp;<span class="ident" id="3794194">Color</span><span class="op" id="3794199">)</span>&nbsp;<span class="ident" id="3794201">Color</span>&nbsp;<span class="op" id="3794207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3794210">if</span>&nbsp;<span class="ident" id="3794213">_</span><span class="op" id="3794214">,</span>&nbsp;<span class="ident" id="3794216">ok</span>&nbsp;<span class="op" id="3794219">:=</span>&nbsp;<span class="ident" id="3794222">c</span><span class="op" id="3794223">.</span><span class="op" id="3794224">(</span><span class="ident" id="3794225">YCbCr</span><span class="op" id="3794230">)</span><span class="op" id="3794231">;</span>&nbsp;<span class="ident" id="3794233">ok</span>&nbsp;<span class="op" id="3794236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3794240">return</span>&nbsp;<span class="ident" id="3794247">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3794250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794253">r</span><span class="op" id="3794254">,</span>&nbsp;<span class="ident" id="3794256">g</span><span class="op" id="3794257">,</span>&nbsp;<span class="ident" id="3794259">b</span><span class="op" id="3794260">,</span>&nbsp;<span class="ident" id="3794262">_</span>&nbsp;<span class="op" id="3794264">:=</span>&nbsp;<span class="ident" id="3794267">c</span><span class="op" id="3794268">.</span><span class="ident" id="3794269">RGBA</span><span class="op" id="3794273">(</span><span class="op" id="3794274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794277">y</span><span class="op" id="3794278">,</span>&nbsp;<span class="ident" id="3794280">u</span><span class="op" id="3794281">,</span>&nbsp;<span class="ident" id="3794283">v</span>&nbsp;<span class="op" id="3794285">:=</span>&nbsp;<span class="ident" id="3794288">RGBToYCbCr</span><span class="op" id="3794298">(</span><span class="builtintype" id="3794299">uint8</span><span class="op" id="3794304">(</span><span class="ident" id="3794305">r</span><span class="op" id="3794306">&gt;&gt;</span><span class="num" id="3794308">8</span><span class="op" id="3794309">)</span><span class="op" id="3794310">,</span>&nbsp;<span class="builtintype" id="3794312">uint8</span><span class="op" id="3794317">(</span><span class="ident" id="3794318">g</span><span class="op" id="3794319">&gt;&gt;</span><span class="num" id="3794321">8</span><span class="op" id="3794322">)</span><span class="op" id="3794323">,</span>&nbsp;<span class="builtintype" id="3794325">uint8</span><span class="op" id="3794330">(</span><span class="ident" id="3794331">b</span><span class="op" id="3794332">&gt;&gt;</span><span class="num" id="3794334">8</span><span class="op" id="3794335">)</span><span class="op" id="3794336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3794339">return</span>&nbsp;<span class="ident" id="3794346">YCbCr</span><span class="op" id="3794351">{</span><span class="ident" id="3794352">y</span><span class="op" id="3794353">,</span>&nbsp;<span class="ident" id="3794355">u</span><span class="op" id="3794356">,</span>&nbsp;<span class="ident" id="3794358">v</span><span class="op" id="3794359">}</span><br>
<span class="lineno"></span><span class="op" id="3794361">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
