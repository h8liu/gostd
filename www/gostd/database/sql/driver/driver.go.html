<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5554788">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5554843">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5554897">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5554948">//&nbsp;Package&nbsp;driver&nbsp;defines&nbsp;interfaces&nbsp;to&nbsp;be&nbsp;implemented&nbsp;by&nbsp;database</span><br>
<span class="lineno"></span><span class="comment" id="5555015">//&nbsp;drivers&nbsp;as&nbsp;used&nbsp;by&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="comment" id="5555050">//</span><br>
<span class="lineno"></span><span class="comment" id="5555053">//&nbsp;Most&nbsp;code&nbsp;should&nbsp;use&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="keyword" id="5555090">package</span>&nbsp;<span class="ident" id="5555098">driver</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5555106">import</span>&nbsp;<span class="string" id="5555113">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5555123">//&nbsp;Value&nbsp;is&nbsp;a&nbsp;value&nbsp;that&nbsp;drivers&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.</span><br>
<span class="lineno"></span><span class="comment" id="5555180">//&nbsp;It&nbsp;is&nbsp;either&nbsp;nil&nbsp;or&nbsp;an&nbsp;instance&nbsp;of&nbsp;one&nbsp;of&nbsp;these&nbsp;types:</span><br>
<span class="lineno">15</span><span class="comment" id="5555238">//</span><br>
<span class="lineno"></span><span class="comment" id="5555241">//&nbsp;&nbsp;&nbsp;int64</span><br>
<span class="lineno"></span><span class="comment" id="5555252">//&nbsp;&nbsp;&nbsp;float64</span><br>
<span class="lineno"></span><span class="comment" id="5555265">//&nbsp;&nbsp;&nbsp;bool</span><br>
<span class="lineno"></span><span class="comment" id="5555275">//&nbsp;&nbsp;&nbsp;[]byte</span><br>
<span class="lineno">20</span><span class="comment" id="5555287">//&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;[*]&nbsp;everywhere&nbsp;except&nbsp;from&nbsp;Rows.Next.</span><br>
<span class="lineno"></span><span class="comment" id="5555339">//&nbsp;&nbsp;&nbsp;time.Time</span><br>
<span class="lineno"></span><span class="keyword" id="5555354">type</span>&nbsp;<span class="ident" id="5555359">Value</span>&nbsp;<span class="keyword" id="5555365">interface</span><span class="op" id="5555374">{</span><span class="op" id="5555375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5555378">//&nbsp;Driver&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;must&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;database</span><br>
<span class="lineno">25</span><span class="comment" id="5555444">//&nbsp;driver.</span><br>
<span class="lineno"></span><span class="keyword" id="5555455">type</span>&nbsp;<span class="ident" id="5555460">Driver</span>&nbsp;<span class="keyword" id="5555467">interface</span>&nbsp;<span class="op" id="5555477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5555480">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;connection&nbsp;to&nbsp;the&nbsp;database.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5555531">//&nbsp;The&nbsp;name&nbsp;is&nbsp;a&nbsp;string&nbsp;in&nbsp;a&nbsp;driver-specific&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5555585">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5555589">//&nbsp;Open&nbsp;may&nbsp;return&nbsp;a&nbsp;cached&nbsp;connection&nbsp;(one&nbsp;previously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5555645">//&nbsp;closed),&nbsp;but&nbsp;doing&nbsp;so&nbsp;is&nbsp;unnecessary;&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5555703">//&nbsp;maintains&nbsp;a&nbsp;pool&nbsp;of&nbsp;idle&nbsp;connections&nbsp;for&nbsp;efficient&nbsp;re-use.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5555766">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5555770">//&nbsp;The&nbsp;returned&nbsp;connection&nbsp;is&nbsp;only&nbsp;used&nbsp;by&nbsp;one&nbsp;goroutine&nbsp;at&nbsp;a</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5555833">//&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5555843">Open</span><span class="op" id="5555847">(</span><span class="ident" id="5555848">name</span>&nbsp;<span class="builtintype" id="5555853">string</span><span class="op" id="5555859">)</span>&nbsp;<span class="op" id="5555861">(</span><span class="ident" id="5555862">Conn</span><span class="op" id="5555866">,</span>&nbsp;<span class="builtintype" id="5555868">error</span><span class="op" id="5555873">)</span><br>
<span class="lineno"></span><span class="op" id="5555875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5555878">//&nbsp;ErrSkip&nbsp;may&nbsp;be&nbsp;returned&nbsp;by&nbsp;some&nbsp;optional&nbsp;interfaces&#39;&nbsp;methods&nbsp;to</span><br>
<span class="lineno">40</span><span class="comment" id="5555945">//&nbsp;indicate&nbsp;at&nbsp;runtime&nbsp;that&nbsp;the&nbsp;fast&nbsp;path&nbsp;is&nbsp;unavailable&nbsp;and&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5556014">//&nbsp;package&nbsp;should&nbsp;continue&nbsp;as&nbsp;if&nbsp;the&nbsp;optional&nbsp;interface&nbsp;was&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5556078">//&nbsp;implemented.&nbsp;ErrSkip&nbsp;is&nbsp;only&nbsp;supported&nbsp;where&nbsp;explicitly</span><br>
<span class="lineno"></span><span class="comment" id="5556137">//&nbsp;documented.</span><br>
<span class="lineno"></span><span class="keyword" id="5556152">var</span>&nbsp;<span class="ident" id="5556156">ErrSkip</span>&nbsp;<span class="op" id="5556164">=</span>&nbsp;<span class="ident" id="5556166">errors</span><span class="op" id="5556172">.</span><span class="ident" id="5556173">New</span><span class="op" id="5556176">(</span><span class="string" id="5556177">&#34;driver:&nbsp;skip&nbsp;fast-path;&nbsp;continue&nbsp;as&nbsp;if&nbsp;unimplemented&#34;</span><span class="op" id="5556231">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5556234">//&nbsp;ErrBadConn&nbsp;should&nbsp;be&nbsp;returned&nbsp;by&nbsp;a&nbsp;driver&nbsp;to&nbsp;signal&nbsp;to&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5556300">//&nbsp;package&nbsp;that&nbsp;a&nbsp;driver.Conn&nbsp;is&nbsp;in&nbsp;a&nbsp;bad&nbsp;state&nbsp;(such&nbsp;as&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="5556368">//&nbsp;having&nbsp;earlier&nbsp;closed&nbsp;the&nbsp;connection)&nbsp;and&nbsp;the&nbsp;sql&nbsp;package&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="5556436">//&nbsp;retry&nbsp;on&nbsp;a&nbsp;new&nbsp;connection.</span><br>
<span class="lineno">50</span><span class="comment" id="5556466">//</span><br>
<span class="lineno"></span><span class="comment" id="5556469">//&nbsp;To&nbsp;prevent&nbsp;duplicate&nbsp;operations,&nbsp;ErrBadConn&nbsp;should&nbsp;NOT&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="5556539">//&nbsp;if&nbsp;there&#39;s&nbsp;a&nbsp;possibility&nbsp;that&nbsp;the&nbsp;database&nbsp;server&nbsp;might&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="5556603">//&nbsp;performed&nbsp;the&nbsp;operation.&nbsp;Even&nbsp;if&nbsp;the&nbsp;server&nbsp;sends&nbsp;back&nbsp;an&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5556671">//&nbsp;you&nbsp;shouldn&#39;t&nbsp;return&nbsp;ErrBadConn.</span><br>
<span class="lineno">55</span><span class="keyword" id="5556707">var</span>&nbsp;<span class="ident" id="5556711">ErrBadConn</span>&nbsp;<span class="op" id="5556722">=</span>&nbsp;<span class="ident" id="5556724">errors</span><span class="op" id="5556730">.</span><span class="ident" id="5556731">New</span><span class="op" id="5556734">(</span><span class="string" id="5556735">&#34;driver:&nbsp;bad&nbsp;connection&#34;</span><span class="op" id="5556759">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5556762">//&nbsp;Execer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5556832">//</span><br>
<span class="lineno"></span><span class="comment" id="5556835">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Execer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Exec&nbsp;will</span><br>
<span class="lineno">60</span><span class="comment" id="5556906">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5556974">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5556988">//</span><br>
<span class="lineno"></span><span class="comment" id="5556991">//&nbsp;Exec&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno"></span><span class="keyword" id="5557019">type</span>&nbsp;<span class="ident" id="5557024">Execer</span>&nbsp;<span class="keyword" id="5557031">interface</span>&nbsp;<span class="op" id="5557041">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557044">Exec</span><span class="op" id="5557048">(</span><span class="ident" id="5557049">query</span>&nbsp;<span class="builtintype" id="5557055">string</span><span class="op" id="5557061">,</span>&nbsp;<span class="ident" id="5557063">args</span>&nbsp;<span class="op" id="5557068">[</span><span class="op" id="5557069">]</span><span class="ident" id="5557070">Value</span><span class="op" id="5557075">)</span>&nbsp;<span class="op" id="5557077">(</span><span class="ident" id="5557078">Result</span><span class="op" id="5557084">,</span>&nbsp;<span class="builtintype" id="5557086">error</span><span class="op" id="5557091">)</span><br>
<span class="lineno"></span><span class="op" id="5557093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5557096">//&nbsp;Queryer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5557167">//</span><br>
<span class="lineno">70</span><span class="comment" id="5557170">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Queryer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Query&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="5557243">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5557311">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5557325">//</span><br>
<span class="lineno"></span><span class="comment" id="5557328">//&nbsp;Query&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno">75</span><span class="keyword" id="5557357">type</span>&nbsp;<span class="ident" id="5557362">Queryer</span>&nbsp;<span class="keyword" id="5557370">interface</span>&nbsp;<span class="op" id="5557380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557383">Query</span><span class="op" id="5557388">(</span><span class="ident" id="5557389">query</span>&nbsp;<span class="builtintype" id="5557395">string</span><span class="op" id="5557401">,</span>&nbsp;<span class="ident" id="5557403">args</span>&nbsp;<span class="op" id="5557408">[</span><span class="op" id="5557409">]</span><span class="ident" id="5557410">Value</span><span class="op" id="5557415">)</span>&nbsp;<span class="op" id="5557417">(</span><span class="ident" id="5557418">Rows</span><span class="op" id="5557422">,</span>&nbsp;<span class="builtintype" id="5557424">error</span><span class="op" id="5557429">)</span><br>
<span class="lineno"></span><span class="op" id="5557431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5557434">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;connection&nbsp;to&nbsp;a&nbsp;database.&nbsp;It&nbsp;is&nbsp;not&nbsp;used&nbsp;concurrently</span><br>
<span class="lineno">80</span><span class="comment" id="5557501">//&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="5557528">//</span><br>
<span class="lineno"></span><span class="comment" id="5557531">//&nbsp;Conn&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;stateful.</span><br>
<span class="lineno"></span><span class="keyword" id="5557566">type</span>&nbsp;<span class="ident" id="5557571">Conn</span>&nbsp;<span class="keyword" id="5557576">interface</span>&nbsp;<span class="op" id="5557586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5557589">//&nbsp;Prepare&nbsp;returns&nbsp;a&nbsp;prepared&nbsp;statement,&nbsp;bound&nbsp;to&nbsp;this&nbsp;connection.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557657">Prepare</span><span class="op" id="5557664">(</span><span class="ident" id="5557665">query</span>&nbsp;<span class="builtintype" id="5557671">string</span><span class="op" id="5557677">)</span>&nbsp;<span class="op" id="5557679">(</span><span class="ident" id="5557680">Stmt</span><span class="op" id="5557684">,</span>&nbsp;<span class="builtintype" id="5557686">error</span><span class="op" id="5557691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5557695">//&nbsp;Close&nbsp;invalidates&nbsp;and&nbsp;potentially&nbsp;stops&nbsp;any&nbsp;current</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5557751">//&nbsp;prepared&nbsp;statements&nbsp;and&nbsp;transactions,&nbsp;marking&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5557806">//&nbsp;connection&nbsp;as&nbsp;no&nbsp;longer&nbsp;in&nbsp;use.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5557842">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5557846">//&nbsp;Because&nbsp;the&nbsp;sql&nbsp;package&nbsp;maintains&nbsp;a&nbsp;free&nbsp;pool&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5557899">//&nbsp;connections&nbsp;and&nbsp;only&nbsp;calls&nbsp;Close&nbsp;when&nbsp;there&#39;s&nbsp;a&nbsp;surplus&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5557962">//&nbsp;idle&nbsp;connections,&nbsp;it&nbsp;shouldn&#39;t&nbsp;be&nbsp;necessary&nbsp;for&nbsp;drivers&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558025">//&nbsp;do&nbsp;their&nbsp;own&nbsp;connection&nbsp;caching.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558062">Close</span><span class="op" id="5558067">(</span><span class="op" id="5558068">)</span>&nbsp;<span class="builtintype" id="5558070">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558078">//&nbsp;Begin&nbsp;starts&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;transaction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558126">Begin</span><span class="op" id="5558131">(</span><span class="op" id="5558132">)</span>&nbsp;<span class="op" id="5558134">(</span><span class="ident" id="5558135">Tx</span><span class="op" id="5558137">,</span>&nbsp;<span class="builtintype" id="5558139">error</span><span class="op" id="5558144">)</span><br>
<span class="lineno"></span><span class="op" id="5558146">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5558149">//&nbsp;Result&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;query&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="5558195">type</span>&nbsp;<span class="ident" id="5558200">Result</span>&nbsp;<span class="keyword" id="5558207">interface</span>&nbsp;<span class="op" id="5558217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558220">//&nbsp;LastInsertId&nbsp;returns&nbsp;the&nbsp;database&#39;s&nbsp;auto-generated&nbsp;ID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558278">//&nbsp;after,&nbsp;for&nbsp;example,&nbsp;an&nbsp;INSERT&nbsp;into&nbsp;a&nbsp;table&nbsp;with&nbsp;primary</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558338">//&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558347">LastInsertId</span><span class="op" id="5558359">(</span><span class="op" id="5558360">)</span>&nbsp;<span class="op" id="5558362">(</span><span class="ident" id="5558363">int64</span><span class="op" id="5558368">,</span>&nbsp;<span class="builtintype" id="5558370">error</span><span class="op" id="5558375">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558379">//&nbsp;RowsAffected&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;rows&nbsp;affected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558439">//&nbsp;query.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558450">RowsAffected</span><span class="op" id="5558462">(</span><span class="op" id="5558463">)</span>&nbsp;<span class="op" id="5558465">(</span><span class="ident" id="5558466">int64</span><span class="op" id="5558471">,</span>&nbsp;<span class="builtintype" id="5558473">error</span><span class="op" id="5558478">)</span><br>
<span class="lineno"></span><span class="op" id="5558480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5558483">//&nbsp;Stmt&nbsp;is&nbsp;a&nbsp;prepared&nbsp;statement.&nbsp;It&nbsp;is&nbsp;bound&nbsp;to&nbsp;a&nbsp;Conn&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5558546">//&nbsp;used&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;concurrently.</span><br>
<span class="lineno">115</span><span class="keyword" id="5558591">type</span>&nbsp;<span class="ident" id="5558596">Stmt</span>&nbsp;<span class="keyword" id="5558601">interface</span>&nbsp;<span class="op" id="5558611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558614">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;statement.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558646">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558650">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.1,&nbsp;a&nbsp;Stmt&nbsp;will&nbsp;not&nbsp;be&nbsp;closed&nbsp;if&nbsp;it&#39;s&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558709">//&nbsp;by&nbsp;any&nbsp;queries.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558729">Close</span><span class="op" id="5558734">(</span><span class="op" id="5558735">)</span>&nbsp;<span class="builtintype" id="5558737">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558745">//&nbsp;NumInput&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;placeholder&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558804">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558808">//&nbsp;If&nbsp;NumInput&nbsp;returns&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;sql&nbsp;package&nbsp;will&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558872">//&nbsp;argument&nbsp;counts&nbsp;from&nbsp;callers&nbsp;and&nbsp;return&nbsp;errors&nbsp;to&nbsp;the&nbsp;caller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558937">//&nbsp;before&nbsp;the&nbsp;statement&#39;s&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558998">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559002">//&nbsp;NumInput&nbsp;may&nbsp;also&nbsp;return&nbsp;-1,&nbsp;if&nbsp;the&nbsp;driver&nbsp;doesn&#39;t&nbsp;know</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559062">//&nbsp;its&nbsp;number&nbsp;of&nbsp;placeholders.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559124">//&nbsp;will&nbsp;not&nbsp;sanity&nbsp;check&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;argument&nbsp;counts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5559181">NumInput</span><span class="op" id="5559189">(</span><span class="op" id="5559190">)</span>&nbsp;<span class="builtintype" id="5559192">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559198">//&nbsp;Exec&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;doesn&#39;t&nbsp;return&nbsp;rows,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559255">//&nbsp;as&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5559283">Exec</span><span class="op" id="5559287">(</span><span class="ident" id="5559288">args</span>&nbsp;<span class="op" id="5559293">[</span><span class="op" id="5559294">]</span><span class="ident" id="5559295">Value</span><span class="op" id="5559300">)</span>&nbsp;<span class="op" id="5559302">(</span><span class="ident" id="5559303">Result</span><span class="op" id="5559309">,</span>&nbsp;<span class="builtintype" id="5559311">error</span><span class="op" id="5559316">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559320">//&nbsp;Query&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;may&nbsp;return&nbsp;rows,&nbsp;such&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559379">//&nbsp;SELECT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5559391">Query</span><span class="op" id="5559396">(</span><span class="ident" id="5559397">args</span>&nbsp;<span class="op" id="5559402">[</span><span class="op" id="5559403">]</span><span class="ident" id="5559404">Value</span><span class="op" id="5559409">)</span>&nbsp;<span class="op" id="5559411">(</span><span class="ident" id="5559412">Rows</span><span class="op" id="5559416">,</span>&nbsp;<span class="builtintype" id="5559418">error</span><span class="op" id="5559423">)</span><br>
<span class="lineno">140</span><span class="op" id="5559425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5559428">//&nbsp;ColumnConverter&nbsp;may&nbsp;be&nbsp;optionally&nbsp;implemented&nbsp;by&nbsp;Stmt&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5559492">//&nbsp;statement&nbsp;is&nbsp;aware&nbsp;of&nbsp;its&nbsp;own&nbsp;columns&#39;&nbsp;types&nbsp;and&nbsp;can&nbsp;convert&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5559561">//&nbsp;any&nbsp;type&nbsp;to&nbsp;a&nbsp;driver&nbsp;Value.</span><br>
<span class="lineno">145</span><span class="keyword" id="5559592">type</span>&nbsp;<span class="ident" id="5559597">ColumnConverter</span>&nbsp;<span class="keyword" id="5559613">interface</span>&nbsp;<span class="op" id="5559623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559626">//&nbsp;ColumnConverter&nbsp;returns&nbsp;a&nbsp;ValueConverter&nbsp;for&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559688">//&nbsp;column&nbsp;index.&nbsp;&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;specific&nbsp;column&nbsp;isn&#39;t&nbsp;known</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559752">//&nbsp;or&nbsp;shouldn&#39;t&nbsp;be&nbsp;handled&nbsp;specially,&nbsp;DefaultValueConverter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559813">//&nbsp;can&nbsp;be&nbsp;returned.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5559834">ColumnConverter</span><span class="op" id="5559849">(</span><span class="ident" id="5559850">idx</span>&nbsp;<span class="builtintype" id="5559854">int</span><span class="op" id="5559857">)</span>&nbsp;<span class="ident" id="5559859">ValueConverter</span><br>
<span class="lineno"></span><span class="op" id="5559874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5559877">//&nbsp;Rows&nbsp;is&nbsp;an&nbsp;iterator&nbsp;over&nbsp;an&nbsp;executed&nbsp;query&#39;s&nbsp;results.</span><br>
<span class="lineno"></span><span class="keyword" id="5559934">type</span>&nbsp;<span class="ident" id="5559939">Rows</span>&nbsp;<span class="keyword" id="5559944">interface</span>&nbsp;<span class="op" id="5559954">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559957">//&nbsp;Columns&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;columns.&nbsp;The&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560017">//&nbsp;columns&nbsp;of&nbsp;the&nbsp;result&nbsp;is&nbsp;inferred&nbsp;from&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560078">//&nbsp;slice.&nbsp;&nbsp;If&nbsp;a&nbsp;particular&nbsp;column&nbsp;name&nbsp;isn&#39;t&nbsp;known,&nbsp;an&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560140">//&nbsp;string&nbsp;should&nbsp;be&nbsp;returned&nbsp;for&nbsp;that&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5560186">Columns</span><span class="op" id="5560193">(</span><span class="op" id="5560194">)</span>&nbsp;<span class="op" id="5560196">[</span><span class="op" id="5560197">]</span><span class="builtintype" id="5560198">string</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560207">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;rows&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5560243">Close</span><span class="op" id="5560248">(</span><span class="op" id="5560249">)</span>&nbsp;<span class="builtintype" id="5560251">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560259">//&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;populate&nbsp;the&nbsp;next&nbsp;row&nbsp;of&nbsp;data&nbsp;into</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560316">//&nbsp;the&nbsp;provided&nbsp;slice.&nbsp;The&nbsp;provided&nbsp;slice&nbsp;will&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560376">//&nbsp;size&nbsp;as&nbsp;the&nbsp;Columns()&nbsp;are&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560412">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560416">//&nbsp;The&nbsp;dest&nbsp;slice&nbsp;may&nbsp;be&nbsp;populated&nbsp;only&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560462">//&nbsp;a&nbsp;driver&nbsp;Value&nbsp;type,&nbsp;but&nbsp;excluding&nbsp;string.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560509">//&nbsp;All&nbsp;string&nbsp;values&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560560">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560564">//&nbsp;Next&nbsp;should&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5560623">Next</span><span class="op" id="5560627">(</span><span class="ident" id="5560628">dest</span>&nbsp;<span class="op" id="5560633">[</span><span class="op" id="5560634">]</span><span class="ident" id="5560635">Value</span><span class="op" id="5560640">)</span>&nbsp;<span class="builtintype" id="5560642">error</span><br>
<span class="lineno"></span><span class="op" id="5560648">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="5560651">//&nbsp;Tx&nbsp;is&nbsp;a&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="5560675">type</span>&nbsp;<span class="ident" id="5560680">Tx</span>&nbsp;<span class="keyword" id="5560683">interface</span>&nbsp;<span class="op" id="5560693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5560696">Commit</span><span class="op" id="5560702">(</span><span class="op" id="5560703">)</span>&nbsp;<span class="builtintype" id="5560705">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5560712">Rollback</span><span class="op" id="5560720">(</span><span class="op" id="5560721">)</span>&nbsp;<span class="builtintype" id="5560723">error</span><br>
<span class="lineno">180</span><span class="op" id="5560729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5560732">//&nbsp;RowsAffected&nbsp;implements&nbsp;Result&nbsp;for&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE&nbsp;operation</span><br>
<span class="lineno"></span><span class="comment" id="5560800">//&nbsp;which&nbsp;mutates&nbsp;a&nbsp;number&nbsp;of&nbsp;rows.</span><br>
<span class="lineno"></span><span class="keyword" id="5560835">type</span>&nbsp;<span class="ident" id="5560840">RowsAffected</span>&nbsp;<span class="ident" id="5560853">int64</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="5560860">var</span>&nbsp;<span class="ident" id="5560864">_</span>&nbsp;<span class="ident" id="5560866">Result</span>&nbsp;<span class="op" id="5560873">=</span>&nbsp;<span class="ident" id="5560875">RowsAffected</span><span class="op" id="5560887">(</span><span class="num" id="5560888">0</span><span class="op" id="5560889">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5560892">func</span>&nbsp;<span class="op" id="5560897">(</span><span class="ident" id="5560898">RowsAffected</span><span class="op" id="5560910">)</span>&nbsp;<span class="ident" id="5560912">LastInsertId</span><span class="op" id="5560924">(</span><span class="op" id="5560925">)</span>&nbsp;<span class="op" id="5560927">(</span><span class="ident" id="5560928">int64</span><span class="op" id="5560933">,</span>&nbsp;<span class="builtintype" id="5560935">error</span><span class="op" id="5560940">)</span>&nbsp;<span class="op" id="5560942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560945">return</span>&nbsp;<span class="num" id="5560952">0</span><span class="op" id="5560953">,</span>&nbsp;<span class="ident" id="5560955">errors</span><span class="op" id="5560961">.</span><span class="ident" id="5560962">New</span><span class="op" id="5560965">(</span><span class="string" id="5560966">&#34;no&nbsp;LastInsertId&nbsp;available&#34;</span><span class="op" id="5560993">)</span><br>
<span class="lineno">190</span><span class="op" id="5560995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5560998">func</span>&nbsp;<span class="op" id="5561003">(</span><span class="ident" id="5561004">v</span>&nbsp;<span class="ident" id="5561006">RowsAffected</span><span class="op" id="5561018">)</span>&nbsp;<span class="ident" id="5561020">RowsAffected</span><span class="op" id="5561032">(</span><span class="op" id="5561033">)</span>&nbsp;<span class="op" id="5561035">(</span><span class="ident" id="5561036">int64</span><span class="op" id="5561041">,</span>&nbsp;<span class="builtintype" id="5561043">error</span><span class="op" id="5561048">)</span>&nbsp;<span class="op" id="5561050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561053">return</span>&nbsp;<span class="ident" id="5561060">int64</span><span class="op" id="5561065">(</span><span class="ident" id="5561066">v</span><span class="op" id="5561067">)</span><span class="op" id="5561068">,</span>&nbsp;<span class="ident" id="5561070">nil</span><br>
<span class="lineno"></span><span class="op" id="5561074">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="5561077">//&nbsp;ResultNoRows&nbsp;is&nbsp;a&nbsp;pre-defined&nbsp;Result&nbsp;for&nbsp;drivers&nbsp;to&nbsp;return&nbsp;when&nbsp;a&nbsp;DDL</span><br>
<span class="lineno"></span><span class="comment" id="5561150">//&nbsp;command&nbsp;(such&nbsp;as&nbsp;a&nbsp;CREATE&nbsp;TABLE)&nbsp;succeeds.&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;for&nbsp;both</span><br>
<span class="lineno"></span><span class="comment" id="5561225">//&nbsp;LastInsertId&nbsp;and&nbsp;RowsAffected.</span><br>
<span class="lineno"></span><span class="keyword" id="5561259">var</span>&nbsp;<span class="ident" id="5561263">ResultNoRows</span>&nbsp;<span class="ident" id="5561276">noRows</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="5561284">type</span>&nbsp;<span class="ident" id="5561289">noRows</span>&nbsp;<span class="keyword" id="5561296">struct</span><span class="op" id="5561302">{</span><span class="op" id="5561303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5561306">var</span>&nbsp;<span class="ident" id="5561310">_</span>&nbsp;<span class="ident" id="5561312">Result</span>&nbsp;<span class="op" id="5561319">=</span>&nbsp;<span class="ident" id="5561321">noRows</span><span class="op" id="5561327">{</span><span class="op" id="5561328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="5561331">func</span>&nbsp;<span class="op" id="5561336">(</span><span class="ident" id="5561337">noRows</span><span class="op" id="5561343">)</span>&nbsp;<span class="ident" id="5561345">LastInsertId</span><span class="op" id="5561357">(</span><span class="op" id="5561358">)</span>&nbsp;<span class="op" id="5561360">(</span><span class="ident" id="5561361">int64</span><span class="op" id="5561366">,</span>&nbsp;<span class="builtintype" id="5561368">error</span><span class="op" id="5561373">)</span>&nbsp;<span class="op" id="5561375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561378">return</span>&nbsp;<span class="num" id="5561385">0</span><span class="op" id="5561386">,</span>&nbsp;<span class="ident" id="5561388">errors</span><span class="op" id="5561394">.</span><span class="ident" id="5561395">New</span><span class="op" id="5561398">(</span><span class="string" id="5561399">&#34;no&nbsp;LastInsertId&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5561446">)</span><br>
<span class="lineno"></span><span class="op" id="5561448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5561451">func</span>&nbsp;<span class="op" id="5561456">(</span><span class="ident" id="5561457">noRows</span><span class="op" id="5561463">)</span>&nbsp;<span class="ident" id="5561465">RowsAffected</span><span class="op" id="5561477">(</span><span class="op" id="5561478">)</span>&nbsp;<span class="op" id="5561480">(</span><span class="ident" id="5561481">int64</span><span class="op" id="5561486">,</span>&nbsp;<span class="builtintype" id="5561488">error</span><span class="op" id="5561493">)</span>&nbsp;<span class="op" id="5561495">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561498">return</span>&nbsp;<span class="num" id="5561505">0</span><span class="op" id="5561506">,</span>&nbsp;<span class="ident" id="5561508">errors</span><span class="op" id="5561514">.</span><span class="ident" id="5561515">New</span><span class="op" id="5561518">(</span><span class="string" id="5561519">&#34;no&nbsp;RowsAffected&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5561566">)</span><br>
<span class="lineno"></span><span class="op" id="5561568">}</span>
</div>
</body>
</html>
