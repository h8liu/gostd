<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6565616">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6565671">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6565725">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6565776">package</span>&nbsp;<span class="ident" id="6565784">gif</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6565789">import</span>&nbsp;<span class="op" id="6565796">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565799">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565808">&#34;compress/lzw&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565824">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565833">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565848">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565859">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6565869">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6565872">//&nbsp;header,&nbsp;palette&nbsp;and&nbsp;trailer&nbsp;are&nbsp;parts&nbsp;of&nbsp;a&nbsp;valid&nbsp;2x1&nbsp;GIF&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="6565939">const</span>&nbsp;<span class="op" id="6565945">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565948">headerStr</span>&nbsp;<span class="op" id="6565958">=</span>&nbsp;<span class="string" id="6565960">&#34;GIF89a&#34;</span>&nbsp;<span class="op" id="6565969">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565973">&#34;\x02\x00\x01\x00&#34;</span>&nbsp;<span class="op" id="6565992">+</span>&nbsp;<span class="comment" id="6565994">//&nbsp;width=2,&nbsp;height=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6566017">&#34;\x80\x00\x00&#34;</span>&nbsp;<span class="comment" id="6566032">//&nbsp;headerFields=(a&nbsp;color&nbsp;map&nbsp;of&nbsp;2&nbsp;pixels),&nbsp;backgroundIndex,&nbsp;aspect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566100">paletteStr</span>&nbsp;<span class="op" id="6566111">=</span>&nbsp;<span class="string" id="6566113">&#34;\x10\x20\x30\x40\x50\x60&#34;</span>&nbsp;<span class="comment" id="6566140">//&nbsp;the&nbsp;color&nbsp;map,&nbsp;also&nbsp;known&nbsp;as&nbsp;a&nbsp;palette</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566183">trailerStr</span>&nbsp;<span class="op" id="6566194">=</span>&nbsp;<span class="string" id="6566196">&#34;\x3b&#34;</span><br>
<span class="lineno"></span><span class="op" id="6566203">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6566206">//&nbsp;lzwEncode&nbsp;returns&nbsp;an&nbsp;LZW&nbsp;encoding&nbsp;(with&nbsp;2-bit&nbsp;literals)&nbsp;of&nbsp;n&nbsp;zeroes.</span><br>
<span class="lineno"></span><span class="keyword" id="6566278">func</span>&nbsp;<span class="ident" id="6566283">lzwEncode</span><span class="op" id="6566292">(</span><span class="ident" id="6566293">n</span>&nbsp;<span class="builtintype" id="6566295">int</span><span class="op" id="6566298">)</span>&nbsp;<span class="op" id="6566300">[</span><span class="op" id="6566301">]</span><span class="builtintype" id="6566302">byte</span>&nbsp;<span class="op" id="6566307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566310">b</span>&nbsp;<span class="op" id="6566312">:=</span>&nbsp;<span class="op" id="6566315">&amp;</span><span class="ident" id="6566316"><a href="/image/gif/reader_test.go.html#6565799">bytes</a></span><span class="op" id="6566321">.</span><span class="ident" id="6566322">Buffer</span><span class="op" id="6566328">{</span><span class="op" id="6566329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566332">w</span>&nbsp;<span class="op" id="6566334">:=</span>&nbsp;<span class="ident" id="6566337"><a href="/image/gif/reader_test.go.html#6565808">lzw</a></span><span class="op" id="6566340">.</span><span class="ident" id="6566341">NewWriter</span><span class="op" id="6566350">(</span><span class="ident" id="6566351"><a href="/image/gif/reader_test.go.html#6566310">b</a></span><span class="op" id="6566352">,</span>&nbsp;<span class="ident" id="6566354"><a href="/image/gif/reader_test.go.html#6565808">lzw</a></span><span class="op" id="6566357">.</span><span class="ident" id="6566358">LSB</span><span class="op" id="6566361">,</span>&nbsp;<span class="num" id="6566363">2</span><span class="op" id="6566364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566367"><a href="/image/gif/reader_test.go.html#6566332">w</a></span><span class="op" id="6566368">.</span><span class="ident" id="6566369">Write</span><span class="op" id="6566374">(</span><span class="builtinfunc" id="6566375">make</span><span class="op" id="6566379">(</span><span class="op" id="6566380">[</span><span class="op" id="6566381">]</span><span class="builtintype" id="6566382">byte</span><span class="op" id="6566386">,</span>&nbsp;<span class="ident" id="6566388"><a href="/image/gif/reader_test.go.html#6566293">n</a></span><span class="op" id="6566389">)</span><span class="op" id="6566390">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566393"><a href="/image/gif/reader_test.go.html#6566332">w</a></span><span class="op" id="6566394">.</span><span class="ident" id="6566395">Close</span><span class="op" id="6566400">(</span><span class="op" id="6566401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566404">return</span>&nbsp;<span class="ident" id="6566411"><a href="/image/gif/reader_test.go.html#6566310">b</a></span><span class="op" id="6566412">.</span><span class="ident" id="6566413">Bytes</span><span class="op" id="6566418">(</span><span class="op" id="6566419">)</span><br>
<span class="lineno"></span><span class="op" id="6566421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6566424">func</span>&nbsp;<span class="ident" id="6566429">TestDecode</span><span class="op" id="6566439">(</span><span class="ident" id="6566440">t</span>&nbsp;<span class="op" id="6566442">*</span><span class="ident" id="6566443"><a href="/image/gif/reader_test.go.html#6565859">testing</a></span><span class="op" id="6566450">.</span><span class="ident" id="6566451">T</span><span class="op" id="6566452">)</span>&nbsp;<span class="op" id="6566454">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566457">testCases</span>&nbsp;<span class="op" id="6566467">:=</span>&nbsp;<span class="op" id="6566470">[</span><span class="op" id="6566471">]</span><span class="keyword" id="6566472">struct</span>&nbsp;<span class="op" id="6566479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566483">nPix</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6566491">int</span>&nbsp;&nbsp;<span class="comment" id="6566496">//&nbsp;The&nbsp;number&nbsp;of&nbsp;pixels&nbsp;in&nbsp;the&nbsp;image&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566541">extra</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6566549">bool</span>&nbsp;<span class="comment" id="6566554">//&nbsp;Whether&nbsp;to&nbsp;write&nbsp;an&nbsp;extra&nbsp;block&nbsp;after&nbsp;the&nbsp;LZW-encoded&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566619">wantErr</span>&nbsp;<span class="builtintype" id="6566627">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566634">}</span><span class="op" id="6566635">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566639">{</span><span class="num" id="6566640">0</span><span class="op" id="6566641">,</span>&nbsp;<span class="ident" id="6566643">false</span><span class="op" id="6566648">,</span>&nbsp;<span class="ident" id="6566650"><a href="/image/gif/reader.go.html#6306327">errNotEnough</a></span><span class="op" id="6566662">}</span><span class="op" id="6566663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566667">{</span><span class="num" id="6566668">1</span><span class="op" id="6566669">,</span>&nbsp;<span class="ident" id="6566671">false</span><span class="op" id="6566676">,</span>&nbsp;<span class="ident" id="6566678"><a href="/image/gif/reader.go.html#6306327">errNotEnough</a></span><span class="op" id="6566690">}</span><span class="op" id="6566691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566695">{</span><span class="num" id="6566696">2</span><span class="op" id="6566697">,</span>&nbsp;<span class="ident" id="6566699">false</span><span class="op" id="6566704">,</span>&nbsp;<span class="ident" id="6566706">nil</span><span class="op" id="6566709">}</span><span class="op" id="6566710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566714">{</span><span class="num" id="6566715">2</span><span class="op" id="6566716">,</span>&nbsp;<span class="ident" id="6566718">true</span><span class="op" id="6566722">,</span>&nbsp;<span class="ident" id="6566724"><a href="/image/gif/reader.go.html#6306384">errTooMuch</a></span><span class="op" id="6566734">}</span><span class="op" id="6566735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566739">{</span><span class="num" id="6566740">3</span><span class="op" id="6566741">,</span>&nbsp;<span class="ident" id="6566743">false</span><span class="op" id="6566748">,</span>&nbsp;<span class="ident" id="6566750"><a href="/image/gif/reader.go.html#6306384">errTooMuch</a></span><span class="op" id="6566760">}</span><span class="op" id="6566761">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566767">for</span>&nbsp;<span class="ident" id="6566771">_</span><span class="op" id="6566772">,</span>&nbsp;<span class="ident" id="6566774">tc</span>&nbsp;<span class="op" id="6566777">:=</span>&nbsp;<span class="keyword" id="6566780">range</span>&nbsp;<span class="ident" id="6566786"><a href="/image/gif/reader_test.go.html#6566457">testCases</a></span>&nbsp;<span class="op" id="6566796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566800">b</span>&nbsp;<span class="op" id="6566802">:=</span>&nbsp;<span class="op" id="6566805">&amp;</span><span class="ident" id="6566806"><a href="/image/gif/reader_test.go.html#6565799">bytes</a></span><span class="op" id="6566811">.</span><span class="ident" id="6566812">Buffer</span><span class="op" id="6566818">{</span><span class="op" id="6566819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566823"><a href="/image/gif/reader_test.go.html#6566800">b</a></span><span class="op" id="6566824">.</span><span class="ident" id="6566825">WriteString</span><span class="op" id="6566836">(</span><span class="ident" id="6566837"><a href="/image/gif/reader_test.go.html#6565948">headerStr</a></span><span class="op" id="6566846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566850"><a href="/image/gif/reader_test.go.html#6566800">b</a></span><span class="op" id="6566851">.</span><span class="ident" id="6566852">WriteString</span><span class="op" id="6566863">(</span><span class="ident" id="6566864"><a href="/image/gif/reader_test.go.html#6566100">paletteStr</a></span><span class="op" id="6566874">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6566878">//&nbsp;Write&nbsp;an&nbsp;image&nbsp;with&nbsp;bounds&nbsp;2x1&nbsp;but&nbsp;tc.nPix&nbsp;pixels.&nbsp;If&nbsp;tc.nPix&nbsp;!=&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6566950">//&nbsp;then&nbsp;this&nbsp;should&nbsp;result&nbsp;in&nbsp;an&nbsp;invalid&nbsp;GIF&nbsp;image.&nbsp;First,&nbsp;write&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6567019">//&nbsp;magic&nbsp;0x2c&nbsp;(image&nbsp;descriptor)&nbsp;byte,&nbsp;bounds=(0,0)-(2,1),&nbsp;a&nbsp;flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6567088">//&nbsp;byte,&nbsp;and&nbsp;2-bit&nbsp;LZW&nbsp;literals.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567123"><a href="/image/gif/reader_test.go.html#6566800">b</a></span><span class="op" id="6567124">.</span><span class="ident" id="6567125">WriteString</span><span class="op" id="6567136">(</span><span class="string" id="6567137">&#34;\x2c\x00\x00\x00\x00\x02\x00\x01\x00\x00\x02&#34;</span><span class="op" id="6567183">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567187">if</span>&nbsp;<span class="ident" id="6567190"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6567192">.</span><span class="ident" id="6567193">nPix</span>&nbsp;<span class="op" id="6567198">&gt;</span>&nbsp;<span class="num" id="6567200">0</span>&nbsp;<span class="op" id="6567202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567207">enc</span>&nbsp;<span class="op" id="6567211">:=</span>&nbsp;<span class="ident" id="6567214"><a href="/image/gif/reader_test.go.html#6566283">lzwEncode</a></span><span class="op" id="6567223">(</span><span class="ident" id="6567224"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6567226">.</span><span class="ident" id="6567227">nPix</span><span class="op" id="6567231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567236">if</span>&nbsp;<span class="builtinfunc" id="6567239">len</span><span class="op" id="6567242">(</span><span class="ident" id="6567243"><a href="/image/gif/reader_test.go.html#6567207">enc</a></span><span class="op" id="6567246">)</span>&nbsp;<span class="op" id="6567248">&gt;</span>&nbsp;<span class="num" id="6567250">0xff</span>&nbsp;<span class="op" id="6567255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567261"><a href="/image/gif/reader_test.go.html#6566440">t</a></span><span class="op" id="6567262">.</span><span class="ident" id="6567263">Errorf</span><span class="op" id="6567269">(</span><span class="string" id="6567270">&#34;nPix=%d,&nbsp;extra=%t:&nbsp;compressed&nbsp;length&nbsp;%d&nbsp;is&nbsp;too&nbsp;large&#34;</span><span class="op" id="6567324">,</span>&nbsp;<span class="ident" id="6567326"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6567328">.</span><span class="ident" id="6567329">nPix</span><span class="op" id="6567333">,</span>&nbsp;<span class="ident" id="6567335"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6567337">.</span><span class="ident" id="6567338">extra</span><span class="op" id="6567343">,</span>&nbsp;<span class="builtinfunc" id="6567345">len</span><span class="op" id="6567348">(</span><span class="ident" id="6567349"><a href="/image/gif/reader_test.go.html#6567207">enc</a></span><span class="op" id="6567352">)</span><span class="op" id="6567353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567359">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567376"><a href="/image/gif/reader_test.go.html#6566800">b</a></span><span class="op" id="6567377">.</span><span class="ident" id="6567378">WriteByte</span><span class="op" id="6567387">(</span><span class="builtintype" id="6567388">byte</span><span class="op" id="6567392">(</span><span class="builtinfunc" id="6567393">len</span><span class="op" id="6567396">(</span><span class="ident" id="6567397"><a href="/image/gif/reader_test.go.html#6567207">enc</a></span><span class="op" id="6567400">)</span><span class="op" id="6567401">)</span><span class="op" id="6567402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567407"><a href="/image/gif/reader_test.go.html#6566800">b</a></span><span class="op" id="6567408">.</span><span class="ident" id="6567409">Write</span><span class="op" id="6567414">(</span><span class="ident" id="6567415"><a href="/image/gif/reader_test.go.html#6567207">enc</a></span><span class="op" id="6567418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567426">if</span>&nbsp;<span class="ident" id="6567429"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6567431">.</span><span class="ident" id="6567432">extra</span>&nbsp;<span class="op" id="6567438">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567443"><a href="/image/gif/reader_test.go.html#6566800">b</a></span><span class="op" id="6567444">.</span><span class="ident" id="6567445">WriteString</span><span class="op" id="6567456">(</span><span class="string" id="6567457">&#34;\x01\x02&#34;</span><span class="op" id="6567467">)</span>&nbsp;<span class="comment" id="6567469">//&nbsp;A&nbsp;1-byte&nbsp;payload&nbsp;with&nbsp;an&nbsp;0x02&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567514"><a href="/image/gif/reader_test.go.html#6566800">b</a></span><span class="op" id="6567515">.</span><span class="ident" id="6567516">WriteByte</span><span class="op" id="6567525">(</span><span class="num" id="6567526">0x00</span><span class="op" id="6567530">)</span>&nbsp;<span class="comment" id="6567532">//&nbsp;An&nbsp;empty&nbsp;block&nbsp;signifies&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;image&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567589"><a href="/image/gif/reader_test.go.html#6566800">b</a></span><span class="op" id="6567590">.</span><span class="ident" id="6567591">WriteString</span><span class="op" id="6567602">(</span><span class="ident" id="6567603"><a href="/image/gif/reader_test.go.html#6566183">trailerStr</a></span><span class="op" id="6567613">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567618">got</span><span class="op" id="6567621">,</span>&nbsp;<span class="ident" id="6567623">err</span>&nbsp;<span class="op" id="6567627">:=</span>&nbsp;<span class="ident" id="6567630"><a href="/image/gif/reader.go.html#6316310">Decode</a></span><span class="op" id="6567636">(</span><span class="ident" id="6567637"><a href="/image/gif/reader_test.go.html#6566800">b</a></span><span class="op" id="6567638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567642">if</span>&nbsp;<span class="ident" id="6567645"><a href="/image/gif/reader_test.go.html#6567623">err</a></span>&nbsp;<span class="op" id="6567649">!=</span>&nbsp;<span class="ident" id="6567652"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6567654">.</span><span class="ident" id="6567655">wantErr</span>&nbsp;<span class="op" id="6567663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567668"><a href="/image/gif/reader_test.go.html#6566440">t</a></span><span class="op" id="6567669">.</span><span class="ident" id="6567670">Errorf</span><span class="op" id="6567676">(</span><span class="string" id="6567677">&#34;nPix=%d,&nbsp;extra=%t\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="6567714">,</span>&nbsp;<span class="ident" id="6567716"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6567718">.</span><span class="ident" id="6567719">nPix</span><span class="op" id="6567723">,</span>&nbsp;<span class="ident" id="6567725"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6567727">.</span><span class="ident" id="6567728">extra</span><span class="op" id="6567733">,</span>&nbsp;<span class="ident" id="6567735"><a href="/image/gif/reader_test.go.html#6567623">err</a></span><span class="op" id="6567738">,</span>&nbsp;<span class="ident" id="6567740"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6567742">.</span><span class="ident" id="6567743">wantErr</span><span class="op" id="6567750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567759">if</span>&nbsp;<span class="ident" id="6567762"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6567764">.</span><span class="ident" id="6567765">wantErr</span>&nbsp;<span class="op" id="6567773">!=</span>&nbsp;<span class="ident" id="6567776">nil</span>&nbsp;<span class="op" id="6567780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567785">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567800">want</span>&nbsp;<span class="op" id="6567805">:=</span>&nbsp;<span class="op" id="6567808">&amp;</span><span class="ident" id="6567809"><a href="/image/gif/reader_test.go.html#6565824">image</a></span><span class="op" id="6567814">.</span><span class="ident" id="6567815">Paletted</span><span class="op" id="6567823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567828">Pix</span><span class="op" id="6567831">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6567836">[</span><span class="op" id="6567837">]</span><span class="builtintype" id="6567838">uint8</span><span class="op" id="6567843">{</span><span class="num" id="6567844">0</span><span class="op" id="6567845">,</span>&nbsp;<span class="num" id="6567847">0</span><span class="op" id="6567848">}</span><span class="op" id="6567849">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567854">Stride</span><span class="op" id="6567860">:</span>&nbsp;<span class="num" id="6567862">2</span><span class="op" id="6567863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567868">Rect</span><span class="op" id="6567872">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6567876"><a href="/image/gif/reader_test.go.html#6565824">image</a></span><span class="op" id="6567881">.</span><span class="ident" id="6567882">Rect</span><span class="op" id="6567886">(</span><span class="num" id="6567887">0</span><span class="op" id="6567888">,</span>&nbsp;<span class="num" id="6567890">0</span><span class="op" id="6567891">,</span>&nbsp;<span class="num" id="6567893">2</span><span class="op" id="6567894">,</span>&nbsp;<span class="num" id="6567896">1</span><span class="op" id="6567897">)</span><span class="op" id="6567898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567903">Palette</span><span class="op" id="6567910">:</span>&nbsp;<span class="ident" id="6567912"><a href="/image/gif/reader_test.go.html#6565833">color</a></span><span class="op" id="6567917">.</span><span class="ident" id="6567918">Palette</span><span class="op" id="6567925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567931"><a href="/image/gif/reader_test.go.html#6565833">color</a></span><span class="op" id="6567936">.</span><span class="ident" id="6567937">RGBA</span><span class="op" id="6567941">{</span><span class="num" id="6567942">0x10</span><span class="op" id="6567946">,</span>&nbsp;<span class="num" id="6567948">0x20</span><span class="op" id="6567952">,</span>&nbsp;<span class="num" id="6567954">0x30</span><span class="op" id="6567958">,</span>&nbsp;<span class="num" id="6567960">0xff</span><span class="op" id="6567964">}</span><span class="op" id="6567965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567971"><a href="/image/gif/reader_test.go.html#6565833">color</a></span><span class="op" id="6567976">.</span><span class="ident" id="6567977">RGBA</span><span class="op" id="6567981">{</span><span class="num" id="6567982">0x40</span><span class="op" id="6567986">,</span>&nbsp;<span class="num" id="6567988">0x50</span><span class="op" id="6567992">,</span>&nbsp;<span class="num" id="6567994">0x60</span><span class="op" id="6567998">,</span>&nbsp;<span class="num" id="6568000">0xff</span><span class="op" id="6568004">}</span><span class="op" id="6568005">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568010">}</span><span class="op" id="6568011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568019">if</span>&nbsp;<span class="op" id="6568022">!</span><span class="ident" id="6568023"><a href="/image/gif/reader_test.go.html#6565848">reflect</a></span><span class="op" id="6568030">.</span><span class="ident" id="6568031">DeepEqual</span><span class="op" id="6568040">(</span><span class="ident" id="6568041"><a href="/image/gif/reader_test.go.html#6567618">got</a></span><span class="op" id="6568044">,</span>&nbsp;<span class="ident" id="6568046"><a href="/image/gif/reader_test.go.html#6567800">want</a></span><span class="op" id="6568050">)</span>&nbsp;<span class="op" id="6568052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568057"><a href="/image/gif/reader_test.go.html#6566440">t</a></span><span class="op" id="6568058">.</span><span class="ident" id="6568059">Errorf</span><span class="op" id="6568065">(</span><span class="string" id="6568066">&#34;nPix=%d,&nbsp;extra=%t\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="6568103">,</span>&nbsp;<span class="ident" id="6568105"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6568107">.</span><span class="ident" id="6568108">nPix</span><span class="op" id="6568112">,</span>&nbsp;<span class="ident" id="6568114"><a href="/image/gif/reader_test.go.html#6566774">tc</a></span><span class="op" id="6568116">.</span><span class="ident" id="6568117">extra</span><span class="op" id="6568122">,</span>&nbsp;<span class="ident" id="6568124"><a href="/image/gif/reader_test.go.html#6567618">got</a></span><span class="op" id="6568127">,</span>&nbsp;<span class="ident" id="6568129"><a href="/image/gif/reader_test.go.html#6567800">want</a></span><span class="op" id="6568133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568137">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568140">}</span><br>
<span class="lineno"></span><span class="op" id="6568142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6568145">func</span>&nbsp;<span class="ident" id="6568150">TestTransparentIndex</span><span class="op" id="6568170">(</span><span class="ident" id="6568171">t</span>&nbsp;<span class="op" id="6568173">*</span><span class="ident" id="6568174"><a href="/image/gif/reader_test.go.html#6565859">testing</a></span><span class="op" id="6568181">.</span><span class="ident" id="6568182">T</span><span class="op" id="6568183">)</span>&nbsp;<span class="op" id="6568185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568188">b</span>&nbsp;<span class="op" id="6568190">:=</span>&nbsp;<span class="op" id="6568193">&amp;</span><span class="ident" id="6568194"><a href="/image/gif/reader_test.go.html#6565799">bytes</a></span><span class="op" id="6568199">.</span><span class="ident" id="6568200">Buffer</span><span class="op" id="6568206">{</span><span class="op" id="6568207">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568210"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568211">.</span><span class="ident" id="6568212">WriteString</span><span class="op" id="6568223">(</span><span class="ident" id="6568224"><a href="/image/gif/reader_test.go.html#6565948">headerStr</a></span><span class="op" id="6568233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568236"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568237">.</span><span class="ident" id="6568238">WriteString</span><span class="op" id="6568249">(</span><span class="ident" id="6568250"><a href="/image/gif/reader_test.go.html#6566100">paletteStr</a></span><span class="op" id="6568260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568263">for</span>&nbsp;<span class="ident" id="6568267">transparentIndex</span>&nbsp;<span class="op" id="6568284">:=</span>&nbsp;<span class="num" id="6568287">0</span><span class="op" id="6568288">;</span>&nbsp;<span class="ident" id="6568290"><a href="/image/gif/reader_test.go.html#6568267">transparentIndex</a></span>&nbsp;<span class="op" id="6568307">&lt;</span>&nbsp;<span class="num" id="6568309">3</span><span class="op" id="6568310">;</span>&nbsp;<span class="ident" id="6568312"><a href="/image/gif/reader_test.go.html#6568267">transparentIndex</a></span><span class="op" id="6568328">++</span>&nbsp;<span class="op" id="6568331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568335">if</span>&nbsp;<span class="ident" id="6568338"><a href="/image/gif/reader_test.go.html#6568267">transparentIndex</a></span>&nbsp;<span class="op" id="6568355">&lt;</span>&nbsp;<span class="num" id="6568357">2</span>&nbsp;<span class="op" id="6568359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6568364">//&nbsp;Write&nbsp;the&nbsp;graphic&nbsp;control&nbsp;for&nbsp;the&nbsp;transparent&nbsp;index.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568423"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568424">.</span><span class="ident" id="6568425">WriteString</span><span class="op" id="6568436">(</span><span class="string" id="6568437">&#34;\x21\xf9\x00\x01\x00\x00&#34;</span><span class="op" id="6568463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568468"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568469">.</span><span class="ident" id="6568470">WriteByte</span><span class="op" id="6568479">(</span><span class="builtintype" id="6568480">byte</span><span class="op" id="6568484">(</span><span class="ident" id="6568485"><a href="/image/gif/reader_test.go.html#6568267">transparentIndex</a></span><span class="op" id="6568501">)</span><span class="op" id="6568502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568507"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568508">.</span><span class="ident" id="6568509">WriteByte</span><span class="op" id="6568518">(</span><span class="num" id="6568519">0</span><span class="op" id="6568520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6568528">//&nbsp;Write&nbsp;an&nbsp;image&nbsp;with&nbsp;bounds&nbsp;2x1,&nbsp;as&nbsp;per&nbsp;TestDecode.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568584"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568585">.</span><span class="ident" id="6568586">WriteString</span><span class="op" id="6568597">(</span><span class="string" id="6568598">&#34;\x2c\x00\x00\x00\x00\x02\x00\x01\x00\x00\x02&#34;</span><span class="op" id="6568644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568648">enc</span>&nbsp;<span class="op" id="6568652">:=</span>&nbsp;<span class="ident" id="6568655"><a href="/image/gif/reader_test.go.html#6566283">lzwEncode</a></span><span class="op" id="6568664">(</span><span class="num" id="6568665">2</span><span class="op" id="6568666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568670">if</span>&nbsp;<span class="builtinfunc" id="6568673">len</span><span class="op" id="6568676">(</span><span class="ident" id="6568677"><a href="/image/gif/reader_test.go.html#6568648">enc</a></span><span class="op" id="6568680">)</span>&nbsp;<span class="op" id="6568682">&gt;</span>&nbsp;<span class="num" id="6568684">0xff</span>&nbsp;<span class="op" id="6568689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568694"><a href="/image/gif/reader_test.go.html#6568171">t</a></span><span class="op" id="6568695">.</span><span class="ident" id="6568696">Fatalf</span><span class="op" id="6568702">(</span><span class="string" id="6568703">&#34;compressed&nbsp;length&nbsp;%d&nbsp;is&nbsp;too&nbsp;large&#34;</span><span class="op" id="6568738">,</span>&nbsp;<span class="builtinfunc" id="6568740">len</span><span class="op" id="6568743">(</span><span class="ident" id="6568744"><a href="/image/gif/reader_test.go.html#6568648">enc</a></span><span class="op" id="6568747">)</span><span class="op" id="6568748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568752">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568756"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568757">.</span><span class="ident" id="6568758">WriteByte</span><span class="op" id="6568767">(</span><span class="builtintype" id="6568768">byte</span><span class="op" id="6568772">(</span><span class="builtinfunc" id="6568773">len</span><span class="op" id="6568776">(</span><span class="ident" id="6568777"><a href="/image/gif/reader_test.go.html#6568648">enc</a></span><span class="op" id="6568780">)</span><span class="op" id="6568781">)</span><span class="op" id="6568782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568786"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568787">.</span><span class="ident" id="6568788">Write</span><span class="op" id="6568793">(</span><span class="ident" id="6568794"><a href="/image/gif/reader_test.go.html#6568648">enc</a></span><span class="op" id="6568797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568801"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568802">.</span><span class="ident" id="6568803">WriteByte</span><span class="op" id="6568812">(</span><span class="num" id="6568813">0x00</span><span class="op" id="6568817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568823"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568824">.</span><span class="ident" id="6568825">WriteString</span><span class="op" id="6568836">(</span><span class="ident" id="6568837"><a href="/image/gif/reader_test.go.html#6566183">trailerStr</a></span><span class="op" id="6568847">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568851">g</span><span class="op" id="6568852">,</span>&nbsp;<span class="ident" id="6568854">err</span>&nbsp;<span class="op" id="6568858">:=</span>&nbsp;<span class="ident" id="6568861"><a href="/image/gif/reader.go.html#6316855">DecodeAll</a></span><span class="op" id="6568870">(</span><span class="ident" id="6568871"><a href="/image/gif/reader_test.go.html#6568188">b</a></span><span class="op" id="6568872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6568875">if</span>&nbsp;<span class="ident" id="6568878"><a href="/image/gif/reader_test.go.html#6568854">err</a></span>&nbsp;<span class="op" id="6568882">!=</span>&nbsp;<span class="ident" id="6568885">nil</span>&nbsp;<span class="op" id="6568889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568893"><a href="/image/gif/reader_test.go.html#6568171">t</a></span><span class="op" id="6568894">.</span><span class="ident" id="6568895">Fatalf</span><span class="op" id="6568901">(</span><span class="string" id="6568902">&#34;DecodeAll:&nbsp;%v&#34;</span><span class="op" id="6568917">,</span>&nbsp;<span class="ident" id="6568919"><a href="/image/gif/reader_test.go.html#6568854">err</a></span><span class="op" id="6568922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6568925">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568928">c0</span>&nbsp;<span class="op" id="6568931">:=</span>&nbsp;<span class="ident" id="6568934"><a href="/image/gif/reader_test.go.html#6565833">color</a></span><span class="op" id="6568939">.</span><span class="ident" id="6568940">RGBA</span><span class="op" id="6568944">{</span><span class="ident" id="6568945"><a href="/image/gif/reader_test.go.html#6566100">paletteStr</a></span><span class="op" id="6568955">[</span><span class="num" id="6568956">0</span><span class="op" id="6568957">]</span><span class="op" id="6568958">,</span>&nbsp;<span class="ident" id="6568960"><a href="/image/gif/reader_test.go.html#6566100">paletteStr</a></span><span class="op" id="6568970">[</span><span class="num" id="6568971">1</span><span class="op" id="6568972">]</span><span class="op" id="6568973">,</span>&nbsp;<span class="ident" id="6568975"><a href="/image/gif/reader_test.go.html#6566100">paletteStr</a></span><span class="op" id="6568985">[</span><span class="num" id="6568986">2</span><span class="op" id="6568987">]</span><span class="op" id="6568988">,</span>&nbsp;<span class="num" id="6568990">0xff</span><span class="op" id="6568994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6568997">c1</span>&nbsp;<span class="op" id="6569000">:=</span>&nbsp;<span class="ident" id="6569003"><a href="/image/gif/reader_test.go.html#6565833">color</a></span><span class="op" id="6569008">.</span><span class="ident" id="6569009">RGBA</span><span class="op" id="6569013">{</span><span class="ident" id="6569014"><a href="/image/gif/reader_test.go.html#6566100">paletteStr</a></span><span class="op" id="6569024">[</span><span class="num" id="6569025">3</span><span class="op" id="6569026">]</span><span class="op" id="6569027">,</span>&nbsp;<span class="ident" id="6569029"><a href="/image/gif/reader_test.go.html#6566100">paletteStr</a></span><span class="op" id="6569039">[</span><span class="num" id="6569040">4</span><span class="op" id="6569041">]</span><span class="op" id="6569042">,</span>&nbsp;<span class="ident" id="6569044"><a href="/image/gif/reader_test.go.html#6566100">paletteStr</a></span><span class="op" id="6569054">[</span><span class="num" id="6569055">5</span><span class="op" id="6569056">]</span><span class="op" id="6569057">,</span>&nbsp;<span class="num" id="6569059">0xff</span><span class="op" id="6569063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569066">cz</span>&nbsp;<span class="op" id="6569069">:=</span>&nbsp;<span class="ident" id="6569072"><a href="/image/gif/reader_test.go.html#6565833">color</a></span><span class="op" id="6569077">.</span><span class="ident" id="6569078">RGBA</span><span class="op" id="6569082">{</span><span class="op" id="6569083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569086">wants</span>&nbsp;<span class="op" id="6569092">:=</span>&nbsp;<span class="op" id="6569095">[</span><span class="op" id="6569096">]</span><span class="ident" id="6569097"><a href="/image/gif/reader_test.go.html#6565833">color</a></span><span class="op" id="6569102">.</span><span class="ident" id="6569103">Palette</span><span class="op" id="6569110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569114">{</span><span class="ident" id="6569115"><a href="/image/gif/reader_test.go.html#6569066">cz</a></span><span class="op" id="6569117">,</span>&nbsp;<span class="ident" id="6569119"><a href="/image/gif/reader_test.go.html#6568997">c1</a></span><span class="op" id="6569121">}</span><span class="op" id="6569122">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569126">{</span><span class="ident" id="6569127"><a href="/image/gif/reader_test.go.html#6568928">c0</a></span><span class="op" id="6569129">,</span>&nbsp;<span class="ident" id="6569131"><a href="/image/gif/reader_test.go.html#6569066">cz</a></span><span class="op" id="6569133">}</span><span class="op" id="6569134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569138">{</span><span class="ident" id="6569139"><a href="/image/gif/reader_test.go.html#6568928">c0</a></span><span class="op" id="6569141">,</span>&nbsp;<span class="ident" id="6569143"><a href="/image/gif/reader_test.go.html#6568997">c1</a></span><span class="op" id="6569145">}</span><span class="op" id="6569146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569152">if</span>&nbsp;<span class="builtinfunc" id="6569155">len</span><span class="op" id="6569158">(</span><span class="ident" id="6569159"><a href="/image/gif/reader_test.go.html#6568851">g</a></span><span class="op" id="6569160">.</span><span class="ident" id="6569161">Image</span><span class="op" id="6569166">)</span>&nbsp;<span class="op" id="6569168">!=</span>&nbsp;<span class="builtinfunc" id="6569171">len</span><span class="op" id="6569174">(</span><span class="ident" id="6569175"><a href="/image/gif/reader_test.go.html#6569086">wants</a></span><span class="op" id="6569180">)</span>&nbsp;<span class="op" id="6569182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569186"><a href="/image/gif/reader_test.go.html#6568171">t</a></span><span class="op" id="6569187">.</span><span class="ident" id="6569188">Fatalf</span><span class="op" id="6569194">(</span><span class="string" id="6569195">&#34;got&nbsp;%d&nbsp;images,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6569219">,</span>&nbsp;<span class="builtinfunc" id="6569221">len</span><span class="op" id="6569224">(</span><span class="ident" id="6569225"><a href="/image/gif/reader_test.go.html#6568851">g</a></span><span class="op" id="6569226">.</span><span class="ident" id="6569227">Image</span><span class="op" id="6569232">)</span><span class="op" id="6569233">,</span>&nbsp;<span class="builtinfunc" id="6569235">len</span><span class="op" id="6569238">(</span><span class="ident" id="6569239"><a href="/image/gif/reader_test.go.html#6569086">wants</a></span><span class="op" id="6569244">)</span><span class="op" id="6569245">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569251">for</span>&nbsp;<span class="ident" id="6569255">i</span><span class="op" id="6569256">,</span>&nbsp;<span class="ident" id="6569258">want</span>&nbsp;<span class="op" id="6569263">:=</span>&nbsp;<span class="keyword" id="6569266">range</span>&nbsp;<span class="ident" id="6569272"><a href="/image/gif/reader_test.go.html#6569086">wants</a></span>&nbsp;<span class="op" id="6569278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569282">got</span>&nbsp;<span class="op" id="6569286">:=</span>&nbsp;<span class="ident" id="6569289"><a href="/image/gif/reader_test.go.html#6568851">g</a></span><span class="op" id="6569290">.</span><span class="ident" id="6569291">Image</span><span class="op" id="6569296">[</span><span class="ident" id="6569297"><a href="/image/gif/reader_test.go.html#6569255">i</a></span><span class="op" id="6569298">]</span><span class="op" id="6569299">.</span><span class="ident" id="6569300">Palette</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569310">if</span>&nbsp;<span class="op" id="6569313">!</span><span class="ident" id="6569314"><a href="/image/gif/reader_test.go.html#6565848">reflect</a></span><span class="op" id="6569321">.</span><span class="ident" id="6569322">DeepEqual</span><span class="op" id="6569331">(</span><span class="ident" id="6569332"><a href="/image/gif/reader_test.go.html#6569282">got</a></span><span class="op" id="6569335">,</span>&nbsp;<span class="ident" id="6569337"><a href="/image/gif/reader_test.go.html#6569258">want</a></span><span class="op" id="6569341">)</span>&nbsp;<span class="op" id="6569343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569348"><a href="/image/gif/reader_test.go.html#6568171">t</a></span><span class="op" id="6569349">.</span><span class="ident" id="6569350">Errorf</span><span class="op" id="6569356">(</span><span class="string" id="6569357">&#34;palette&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="6569389">,</span>&nbsp;<span class="ident" id="6569391"><a href="/image/gif/reader_test.go.html#6569255">i</a></span><span class="op" id="6569392">,</span>&nbsp;<span class="ident" id="6569394"><a href="/image/gif/reader_test.go.html#6569282">got</a></span><span class="op" id="6569397">,</span>&nbsp;<span class="ident" id="6569399"><a href="/image/gif/reader_test.go.html#6569258">want</a></span><span class="op" id="6569403">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6569410">}</span><br>
<span class="lineno"></span><span class="op" id="6569412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6569415">//&nbsp;testGIF&nbsp;is&nbsp;a&nbsp;simple&nbsp;GIF&nbsp;that&nbsp;we&nbsp;can&nbsp;modify&nbsp;to&nbsp;test&nbsp;different&nbsp;scenarios.</span><br>
<span class="lineno">140</span><span class="keyword" id="6569490">var</span>&nbsp;<span class="ident" id="6569494">testGIF</span>&nbsp;<span class="op" id="6569502">=</span>&nbsp;<span class="op" id="6569504">[</span><span class="op" id="6569505">]</span><span class="builtintype" id="6569506">byte</span><span class="op" id="6569510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6569513">&#39;G&#39;</span><span class="op" id="6569516">,</span>&nbsp;<span class="string" id="6569518">&#39;I&#39;</span><span class="op" id="6569521">,</span>&nbsp;<span class="string" id="6569523">&#39;F&#39;</span><span class="op" id="6569526">,</span>&nbsp;<span class="string" id="6569528">&#39;8&#39;</span><span class="op" id="6569531">,</span>&nbsp;<span class="string" id="6569533">&#39;9&#39;</span><span class="op" id="6569536">,</span>&nbsp;<span class="string" id="6569538">&#39;a&#39;</span><span class="op" id="6569541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6569544">1</span><span class="op" id="6569545">,</span>&nbsp;<span class="num" id="6569547">0</span><span class="op" id="6569548">,</span>&nbsp;<span class="num" id="6569550">1</span><span class="op" id="6569551">,</span>&nbsp;<span class="num" id="6569553">0</span><span class="op" id="6569554">,</span>&nbsp;<span class="comment" id="6569556">//&nbsp;w=1,&nbsp;h=1&nbsp;(6)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6569573">128</span><span class="op" id="6569576">,</span>&nbsp;<span class="num" id="6569578">0</span><span class="op" id="6569579">,</span>&nbsp;<span class="num" id="6569581">0</span><span class="op" id="6569582">,</span>&nbsp;<span class="comment" id="6569584">//&nbsp;headerFields,&nbsp;bg,&nbsp;aspect&nbsp;(10)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6569618">0</span><span class="op" id="6569619">,</span>&nbsp;<span class="num" id="6569621">0</span><span class="op" id="6569622">,</span>&nbsp;<span class="num" id="6569624">0</span><span class="op" id="6569625">,</span>&nbsp;<span class="num" id="6569627">1</span><span class="op" id="6569628">,</span>&nbsp;<span class="num" id="6569630">1</span><span class="op" id="6569631">,</span>&nbsp;<span class="num" id="6569633">1</span><span class="op" id="6569634">,</span>&nbsp;<span class="comment" id="6569636">//&nbsp;color&nbsp;map&nbsp;and&nbsp;graphics&nbsp;control&nbsp;(13)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6569676">0x21</span><span class="op" id="6569680">,</span>&nbsp;<span class="num" id="6569682">0xf9</span><span class="op" id="6569686">,</span>&nbsp;<span class="num" id="6569688">0x04</span><span class="op" id="6569692">,</span>&nbsp;<span class="num" id="6569694">0x00</span><span class="op" id="6569698">,</span>&nbsp;<span class="num" id="6569700">0x00</span><span class="op" id="6569704">,</span>&nbsp;<span class="num" id="6569706">0x00</span><span class="op" id="6569710">,</span>&nbsp;<span class="num" id="6569712">0xff</span><span class="op" id="6569716">,</span>&nbsp;<span class="num" id="6569718">0x00</span><span class="op" id="6569722">,</span>&nbsp;<span class="comment" id="6569724">//&nbsp;(19)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6569733">//&nbsp;frame&nbsp;1&nbsp;(0,0&nbsp;-&nbsp;1,1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6569757">0x2c</span><span class="op" id="6569761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6569764">0x00</span><span class="op" id="6569768">,</span>&nbsp;<span class="num" id="6569770">0x00</span><span class="op" id="6569774">,</span>&nbsp;<span class="num" id="6569776">0x00</span><span class="op" id="6569780">,</span>&nbsp;<span class="num" id="6569782">0x00</span><span class="op" id="6569786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6569789">0x01</span><span class="op" id="6569793">,</span>&nbsp;<span class="num" id="6569795">0x00</span><span class="op" id="6569799">,</span>&nbsp;<span class="num" id="6569801">0x01</span><span class="op" id="6569805">,</span>&nbsp;<span class="num" id="6569807">0x00</span><span class="op" id="6569811">,</span>&nbsp;<span class="comment" id="6569813">//&nbsp;(32)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6569822">0x00</span><span class="op" id="6569826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6569829">0x02</span><span class="op" id="6569833">,</span>&nbsp;<span class="num" id="6569835">0x02</span><span class="op" id="6569839">,</span>&nbsp;<span class="num" id="6569841">0x4c</span><span class="op" id="6569845">,</span>&nbsp;<span class="num" id="6569847">0x01</span><span class="op" id="6569851">,</span>&nbsp;<span class="num" id="6569853">0x00</span><span class="op" id="6569857">,</span>&nbsp;<span class="comment" id="6569859">//&nbsp;lzw&nbsp;pixels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6569874">//&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6569886">0x3b</span><span class="op" id="6569890">,</span><br>
<span class="lineno"></span><span class="op" id="6569892">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="6569895">func</span>&nbsp;<span class="ident" id="6569900">try</span><span class="op" id="6569903">(</span><span class="ident" id="6569904">t</span>&nbsp;<span class="op" id="6569906">*</span><span class="ident" id="6569907"><a href="/image/gif/reader_test.go.html#6565859">testing</a></span><span class="op" id="6569914">.</span><span class="ident" id="6569915">T</span><span class="op" id="6569916">,</span>&nbsp;<span class="ident" id="6569918">b</span>&nbsp;<span class="op" id="6569920">[</span><span class="op" id="6569921">]</span><span class="builtintype" id="6569922">byte</span><span class="op" id="6569926">,</span>&nbsp;<span class="ident" id="6569928">want</span>&nbsp;<span class="builtintype" id="6569933">string</span><span class="op" id="6569939">)</span>&nbsp;<span class="op" id="6569941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6569944">_</span><span class="op" id="6569945">,</span>&nbsp;<span class="ident" id="6569947">err</span>&nbsp;<span class="op" id="6569951">:=</span>&nbsp;<span class="ident" id="6569954"><a href="/image/gif/reader.go.html#6316855">DecodeAll</a></span><span class="op" id="6569963">(</span><span class="ident" id="6569964"><a href="/image/gif/reader_test.go.html#6565799">bytes</a></span><span class="op" id="6569969">.</span><span class="ident" id="6569970">NewReader</span><span class="op" id="6569979">(</span><span class="ident" id="6569980"><a href="/image/gif/reader_test.go.html#6569918">b</a></span><span class="op" id="6569981">)</span><span class="op" id="6569982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6569985">var</span>&nbsp;<span class="ident" id="6569989">got</span>&nbsp;<span class="builtintype" id="6569993">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6570001">if</span>&nbsp;<span class="ident" id="6570004"><a href="/image/gif/reader_test.go.html#6569947">err</a></span>&nbsp;<span class="op" id="6570008">!=</span>&nbsp;<span class="ident" id="6570011">nil</span>&nbsp;<span class="op" id="6570015">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570019"><a href="/image/gif/reader_test.go.html#6569989">got</a></span>&nbsp;<span class="op" id="6570023">=</span>&nbsp;<span class="ident" id="6570025"><a href="/image/gif/reader_test.go.html#6569947">err</a></span><span class="op" id="6570028">.</span><span class="ident" id="6570029">Error</span><span class="op" id="6570034">(</span><span class="op" id="6570035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6570038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6570041">if</span>&nbsp;<span class="ident" id="6570044"><a href="/image/gif/reader_test.go.html#6569989">got</a></span>&nbsp;<span class="op" id="6570048">!=</span>&nbsp;<span class="ident" id="6570051"><a href="/image/gif/reader_test.go.html#6569928">want</a></span>&nbsp;<span class="op" id="6570056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570060"><a href="/image/gif/reader_test.go.html#6569904">t</a></span><span class="op" id="6570061">.</span><span class="ident" id="6570062">Fatalf</span><span class="op" id="6570068">(</span><span class="string" id="6570069">&#34;got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6570086">,</span>&nbsp;<span class="ident" id="6570088"><a href="/image/gif/reader_test.go.html#6569989">got</a></span><span class="op" id="6570091">,</span>&nbsp;<span class="ident" id="6570093"><a href="/image/gif/reader_test.go.html#6569928">want</a></span><span class="op" id="6570097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6570100">}</span><br>
<span class="lineno">165</span><span class="op" id="6570102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6570105">func</span>&nbsp;<span class="ident" id="6570110">TestBounds</span><span class="op" id="6570120">(</span><span class="ident" id="6570121">t</span>&nbsp;<span class="op" id="6570123">*</span><span class="ident" id="6570124"><a href="/image/gif/reader_test.go.html#6565859">testing</a></span><span class="op" id="6570131">.</span><span class="ident" id="6570132">T</span><span class="op" id="6570133">)</span>&nbsp;<span class="op" id="6570135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6570138">//&nbsp;Make&nbsp;a&nbsp;local&nbsp;copy&nbsp;of&nbsp;testGIF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570172">gif</span>&nbsp;<span class="op" id="6570176">:=</span>&nbsp;<span class="builtinfunc" id="6570179">make</span><span class="op" id="6570183">(</span><span class="op" id="6570184">[</span><span class="op" id="6570185">]</span><span class="builtintype" id="6570186">byte</span><span class="op" id="6570190">,</span>&nbsp;<span class="builtinfunc" id="6570192">len</span><span class="op" id="6570195">(</span><span class="ident" id="6570196"><a href="/image/gif/reader_test.go.html#6569494">testGIF</a></span><span class="op" id="6570203">)</span><span class="op" id="6570204">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6570207">copy</span><span class="op" id="6570211">(</span><span class="ident" id="6570212"><a href="/image/gif/reader_test.go.html#6570172">gif</a></span><span class="op" id="6570215">,</span>&nbsp;<span class="ident" id="6570217"><a href="/image/gif/reader_test.go.html#6569494">testGIF</a></span><span class="op" id="6570224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6570227">//&nbsp;Make&nbsp;the&nbsp;bounds&nbsp;too&nbsp;big,&nbsp;just&nbsp;by&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570269"><a href="/image/gif/reader_test.go.html#6570172">gif</a></span><span class="op" id="6570272">[</span><span class="num" id="6570273">32</span><span class="op" id="6570275">]</span>&nbsp;<span class="op" id="6570277">=</span>&nbsp;<span class="num" id="6570279">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570282">want</span>&nbsp;<span class="op" id="6570287">:=</span>&nbsp;<span class="string" id="6570290">&#34;gif:&nbsp;frame&nbsp;bounds&nbsp;larger&nbsp;than&nbsp;image&nbsp;bounds&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570336"><a href="/image/gif/reader_test.go.html#6569900">try</a></span><span class="op" id="6570339">(</span><span class="ident" id="6570340"><a href="/image/gif/reader_test.go.html#6570121">t</a></span><span class="op" id="6570341">,</span>&nbsp;<span class="ident" id="6570343"><a href="/image/gif/reader_test.go.html#6570172">gif</a></span><span class="op" id="6570346">,</span>&nbsp;<span class="ident" id="6570348"><a href="/image/gif/reader_test.go.html#6570282">want</a></span><span class="op" id="6570352">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6570356">//&nbsp;Make&nbsp;the&nbsp;bounds&nbsp;too&nbsp;small;&nbsp;does&nbsp;not&nbsp;trigger&nbsp;bounds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6570411">//&nbsp;check,&nbsp;but&nbsp;now&nbsp;there&#39;s&nbsp;too&nbsp;much&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570453"><a href="/image/gif/reader_test.go.html#6570172">gif</a></span><span class="op" id="6570456">[</span><span class="num" id="6570457">32</span><span class="op" id="6570459">]</span>&nbsp;<span class="op" id="6570461">=</span>&nbsp;<span class="num" id="6570463">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570466"><a href="/image/gif/reader_test.go.html#6570282">want</a></span>&nbsp;<span class="op" id="6570471">=</span>&nbsp;<span class="string" id="6570473">&#34;gif:&nbsp;too&nbsp;much&nbsp;image&nbsp;data&#34;</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570501"><a href="/image/gif/reader_test.go.html#6569900">try</a></span><span class="op" id="6570504">(</span><span class="ident" id="6570505"><a href="/image/gif/reader_test.go.html#6570121">t</a></span><span class="op" id="6570506">,</span>&nbsp;<span class="ident" id="6570508"><a href="/image/gif/reader_test.go.html#6570172">gif</a></span><span class="op" id="6570511">,</span>&nbsp;<span class="ident" id="6570513"><a href="/image/gif/reader_test.go.html#6570282">want</a></span><span class="op" id="6570517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570520"><a href="/image/gif/reader_test.go.html#6570172">gif</a></span><span class="op" id="6570523">[</span><span class="num" id="6570524">32</span><span class="op" id="6570526">]</span>&nbsp;<span class="op" id="6570528">=</span>&nbsp;<span class="num" id="6570530">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6570534">//&nbsp;Make&nbsp;the&nbsp;bounds&nbsp;really&nbsp;big,&nbsp;expect&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570583"><a href="/image/gif/reader_test.go.html#6570282">want</a></span>&nbsp;<span class="op" id="6570588">=</span>&nbsp;<span class="string" id="6570590">&#34;gif:&nbsp;frame&nbsp;bounds&nbsp;larger&nbsp;than&nbsp;image&nbsp;bounds&#34;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6570636">for</span>&nbsp;<span class="ident" id="6570640">i</span>&nbsp;<span class="op" id="6570642">:=</span>&nbsp;<span class="num" id="6570645">0</span><span class="op" id="6570646">;</span>&nbsp;<span class="ident" id="6570648"><a href="/image/gif/reader_test.go.html#6570640">i</a></span>&nbsp;<span class="op" id="6570650">&lt;</span>&nbsp;<span class="num" id="6570652">4</span><span class="op" id="6570653">;</span>&nbsp;<span class="ident" id="6570655"><a href="/image/gif/reader_test.go.html#6570640">i</a></span><span class="op" id="6570656">++</span>&nbsp;<span class="op" id="6570659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570663"><a href="/image/gif/reader_test.go.html#6570172">gif</a></span><span class="op" id="6570666">[</span><span class="num" id="6570667">32</span><span class="op" id="6570669">+</span><span class="ident" id="6570670"><a href="/image/gif/reader_test.go.html#6570640">i</a></span><span class="op" id="6570671">]</span>&nbsp;<span class="op" id="6570673">=</span>&nbsp;<span class="num" id="6570675">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6570681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570684"><a href="/image/gif/reader_test.go.html#6569900">try</a></span><span class="op" id="6570687">(</span><span class="ident" id="6570688"><a href="/image/gif/reader_test.go.html#6570121">t</a></span><span class="op" id="6570689">,</span>&nbsp;<span class="ident" id="6570691"><a href="/image/gif/reader_test.go.html#6570172">gif</a></span><span class="op" id="6570694">,</span>&nbsp;<span class="ident" id="6570696"><a href="/image/gif/reader_test.go.html#6570282">want</a></span><span class="op" id="6570700">)</span><br>
<span class="lineno"></span><span class="op" id="6570702">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="keyword" id="6570705">func</span>&nbsp;<span class="ident" id="6570710">TestNoPalette</span><span class="op" id="6570723">(</span><span class="ident" id="6570724">t</span>&nbsp;<span class="op" id="6570726">*</span><span class="ident" id="6570727"><a href="/image/gif/reader_test.go.html#6565859">testing</a></span><span class="op" id="6570734">.</span><span class="ident" id="6570735">T</span><span class="op" id="6570736">)</span>&nbsp;<span class="op" id="6570738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570741">b</span>&nbsp;<span class="op" id="6570743">:=</span>&nbsp;<span class="op" id="6570746">&amp;</span><span class="ident" id="6570747"><a href="/image/gif/reader_test.go.html#6565799">bytes</a></span><span class="op" id="6570752">.</span><span class="ident" id="6570753">Buffer</span><span class="op" id="6570759">{</span><span class="op" id="6570760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6570764">//&nbsp;Manufacture&nbsp;a&nbsp;GIF&nbsp;with&nbsp;no&nbsp;palette,&nbsp;so&nbsp;any&nbsp;pixel&nbsp;at&nbsp;all</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6570823">//&nbsp;will&nbsp;be&nbsp;invalid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570844"><a href="/image/gif/reader_test.go.html#6570741">b</a></span><span class="op" id="6570845">.</span><span class="ident" id="6570846">WriteString</span><span class="op" id="6570857">(</span><span class="ident" id="6570858"><a href="/image/gif/reader_test.go.html#6565948">headerStr</a></span><span class="op" id="6570867">[</span><span class="op" id="6570868">:</span><span class="builtinfunc" id="6570869">len</span><span class="op" id="6570872">(</span><span class="ident" id="6570873"><a href="/image/gif/reader_test.go.html#6565948">headerStr</a></span><span class="op" id="6570882">)</span><span class="op" id="6570883">-</span><span class="num" id="6570884">3</span><span class="op" id="6570885">]</span><span class="op" id="6570886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570889"><a href="/image/gif/reader_test.go.html#6570741">b</a></span><span class="op" id="6570890">.</span><span class="ident" id="6570891">WriteString</span><span class="op" id="6570902">(</span><span class="string" id="6570903">&#34;\x00\x00\x00&#34;</span><span class="op" id="6570917">)</span>&nbsp;<span class="comment" id="6570919">//&nbsp;No&nbsp;global&nbsp;palette.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6570943">//&nbsp;Image&nbsp;descriptor:&nbsp;2x1,&nbsp;no&nbsp;local&nbsp;palette.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6570988"><a href="/image/gif/reader_test.go.html#6570741">b</a></span><span class="op" id="6570989">.</span><span class="ident" id="6570990">WriteString</span><span class="op" id="6571001">(</span><span class="string" id="6571002">&#34;\x2c\x00\x00\x00\x00\x02\x00\x01\x00\x00\x02&#34;</span><span class="op" id="6571048">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6571052">//&nbsp;Encode&nbsp;the&nbsp;pixels:&nbsp;neither&nbsp;is&nbsp;in&nbsp;range,&nbsp;because&nbsp;there&nbsp;is&nbsp;no&nbsp;palette.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571125">pix</span>&nbsp;<span class="op" id="6571129">:=</span>&nbsp;<span class="op" id="6571132">[</span><span class="op" id="6571133">]</span><span class="builtintype" id="6571134">byte</span><span class="op" id="6571138">{</span><span class="num" id="6571139">0</span><span class="op" id="6571140">,</span>&nbsp;<span class="num" id="6571142">128</span><span class="op" id="6571145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571148">enc</span>&nbsp;<span class="op" id="6571152">:=</span>&nbsp;<span class="op" id="6571155">&amp;</span><span class="ident" id="6571156"><a href="/image/gif/reader_test.go.html#6565799">bytes</a></span><span class="op" id="6571161">.</span><span class="ident" id="6571162">Buffer</span><span class="op" id="6571168">{</span><span class="op" id="6571169">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571172">w</span>&nbsp;<span class="op" id="6571174">:=</span>&nbsp;<span class="ident" id="6571177"><a href="/image/gif/reader_test.go.html#6565808">lzw</a></span><span class="op" id="6571180">.</span><span class="ident" id="6571181">NewWriter</span><span class="op" id="6571190">(</span><span class="ident" id="6571191"><a href="/image/gif/reader_test.go.html#6571148">enc</a></span><span class="op" id="6571194">,</span>&nbsp;<span class="ident" id="6571196"><a href="/image/gif/reader_test.go.html#6565808">lzw</a></span><span class="op" id="6571199">.</span><span class="ident" id="6571200">LSB</span><span class="op" id="6571203">,</span>&nbsp;<span class="num" id="6571205">2</span><span class="op" id="6571206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571209"><a href="/image/gif/reader_test.go.html#6571172">w</a></span><span class="op" id="6571210">.</span><span class="ident" id="6571211">Write</span><span class="op" id="6571216">(</span><span class="ident" id="6571217"><a href="/image/gif/reader_test.go.html#6571125">pix</a></span><span class="op" id="6571220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571223"><a href="/image/gif/reader_test.go.html#6571172">w</a></span><span class="op" id="6571224">.</span><span class="ident" id="6571225">Close</span><span class="op" id="6571230">(</span><span class="op" id="6571231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571234"><a href="/image/gif/reader_test.go.html#6570741">b</a></span><span class="op" id="6571235">.</span><span class="ident" id="6571236">WriteByte</span><span class="op" id="6571245">(</span><span class="builtintype" id="6571246">byte</span><span class="op" id="6571250">(</span><span class="builtinfunc" id="6571251">len</span><span class="op" id="6571254">(</span><span class="ident" id="6571255"><a href="/image/gif/reader_test.go.html#6571148">enc</a></span><span class="op" id="6571258">.</span><span class="ident" id="6571259">Bytes</span><span class="op" id="6571264">(</span><span class="op" id="6571265">)</span><span class="op" id="6571266">)</span><span class="op" id="6571267">)</span><span class="op" id="6571268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571271"><a href="/image/gif/reader_test.go.html#6570741">b</a></span><span class="op" id="6571272">.</span><span class="ident" id="6571273">Write</span><span class="op" id="6571278">(</span><span class="ident" id="6571279"><a href="/image/gif/reader_test.go.html#6571148">enc</a></span><span class="op" id="6571282">.</span><span class="ident" id="6571283">Bytes</span><span class="op" id="6571288">(</span><span class="op" id="6571289">)</span><span class="op" id="6571290">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571293"><a href="/image/gif/reader_test.go.html#6570741">b</a></span><span class="op" id="6571294">.</span><span class="ident" id="6571295">WriteByte</span><span class="op" id="6571304">(</span><span class="num" id="6571305">0x00</span><span class="op" id="6571309">)</span>&nbsp;<span class="comment" id="6571311">//&nbsp;An&nbsp;empty&nbsp;block&nbsp;signifies&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;image&nbsp;data.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571368"><a href="/image/gif/reader_test.go.html#6570741">b</a></span><span class="op" id="6571369">.</span><span class="ident" id="6571370">WriteString</span><span class="op" id="6571381">(</span><span class="ident" id="6571382"><a href="/image/gif/reader_test.go.html#6566183">trailerStr</a></span><span class="op" id="6571392">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571396"><a href="/image/gif/reader_test.go.html#6569900">try</a></span><span class="op" id="6571399">(</span><span class="ident" id="6571400"><a href="/image/gif/reader_test.go.html#6570724">t</a></span><span class="op" id="6571401">,</span>&nbsp;<span class="ident" id="6571403"><a href="/image/gif/reader_test.go.html#6570741">b</a></span><span class="op" id="6571404">.</span><span class="ident" id="6571405">Bytes</span><span class="op" id="6571410">(</span><span class="op" id="6571411">)</span><span class="op" id="6571412">,</span>&nbsp;<span class="string" id="6571414">&#34;gif:&nbsp;invalid&nbsp;pixel&nbsp;value&#34;</span><span class="op" id="6571440">)</span><br>
<span class="lineno">215</span><span class="op" id="6571442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6571445">func</span>&nbsp;<span class="ident" id="6571450">TestPixelOutsidePaletteRange</span><span class="op" id="6571478">(</span><span class="ident" id="6571479">t</span>&nbsp;<span class="op" id="6571481">*</span><span class="ident" id="6571482"><a href="/image/gif/reader_test.go.html#6565859">testing</a></span><span class="op" id="6571489">.</span><span class="ident" id="6571490">T</span><span class="op" id="6571491">)</span>&nbsp;<span class="op" id="6571493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6571496">for</span>&nbsp;<span class="ident" id="6571500">_</span><span class="op" id="6571501">,</span>&nbsp;<span class="ident" id="6571503">pval</span>&nbsp;<span class="op" id="6571508">:=</span>&nbsp;<span class="keyword" id="6571511">range</span>&nbsp;<span class="op" id="6571517">[</span><span class="op" id="6571518">]</span><span class="builtintype" id="6571519">byte</span><span class="op" id="6571523">{</span><span class="num" id="6571524">0</span><span class="op" id="6571525">,</span>&nbsp;<span class="num" id="6571527">1</span><span class="op" id="6571528">,</span>&nbsp;<span class="num" id="6571530">2</span><span class="op" id="6571531">,</span>&nbsp;<span class="num" id="6571533">3</span><span class="op" id="6571534">,</span>&nbsp;<span class="num" id="6571536">255</span><span class="op" id="6571539">}</span>&nbsp;<span class="op" id="6571541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571545">b</span>&nbsp;<span class="op" id="6571547">:=</span>&nbsp;<span class="op" id="6571550">&amp;</span><span class="ident" id="6571551"><a href="/image/gif/reader_test.go.html#6565799">bytes</a></span><span class="op" id="6571556">.</span><span class="ident" id="6571557">Buffer</span><span class="op" id="6571563">{</span><span class="op" id="6571564">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6571569">//&nbsp;Manufacture&nbsp;a&nbsp;GIF&nbsp;with&nbsp;a&nbsp;2&nbsp;color&nbsp;palette.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571616"><a href="/image/gif/reader_test.go.html#6571545">b</a></span><span class="op" id="6571617">.</span><span class="ident" id="6571618">WriteString</span><span class="op" id="6571629">(</span><span class="ident" id="6571630"><a href="/image/gif/reader_test.go.html#6565948">headerStr</a></span><span class="op" id="6571639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571643"><a href="/image/gif/reader_test.go.html#6571545">b</a></span><span class="op" id="6571644">.</span><span class="ident" id="6571645">WriteString</span><span class="op" id="6571656">(</span><span class="ident" id="6571657"><a href="/image/gif/reader_test.go.html#6566100">paletteStr</a></span><span class="op" id="6571667">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6571672">//&nbsp;Image&nbsp;descriptor:&nbsp;2x1,&nbsp;no&nbsp;local&nbsp;palette.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571718"><a href="/image/gif/reader_test.go.html#6571545">b</a></span><span class="op" id="6571719">.</span><span class="ident" id="6571720">WriteString</span><span class="op" id="6571731">(</span><span class="string" id="6571732">&#34;\x2c\x00\x00\x00\x00\x02\x00\x01\x00\x00\x02&#34;</span><span class="op" id="6571778">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6571783">//&nbsp;Encode&nbsp;the&nbsp;pixels;&nbsp;some&nbsp;pvals&nbsp;trigger&nbsp;the&nbsp;expected&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571846">pix</span>&nbsp;<span class="op" id="6571850">:=</span>&nbsp;<span class="op" id="6571853">[</span><span class="op" id="6571854">]</span><span class="builtintype" id="6571855">byte</span><span class="op" id="6571859">{</span><span class="ident" id="6571860"><a href="/image/gif/reader_test.go.html#6571503">pval</a></span><span class="op" id="6571864">,</span>&nbsp;<span class="ident" id="6571866"><a href="/image/gif/reader_test.go.html#6571503">pval</a></span><span class="op" id="6571870">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571874">enc</span>&nbsp;<span class="op" id="6571878">:=</span>&nbsp;<span class="op" id="6571881">&amp;</span><span class="ident" id="6571882"><a href="/image/gif/reader_test.go.html#6565799">bytes</a></span><span class="op" id="6571887">.</span><span class="ident" id="6571888">Buffer</span><span class="op" id="6571894">{</span><span class="op" id="6571895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571899">w</span>&nbsp;<span class="op" id="6571901">:=</span>&nbsp;<span class="ident" id="6571904"><a href="/image/gif/reader_test.go.html#6565808">lzw</a></span><span class="op" id="6571907">.</span><span class="ident" id="6571908">NewWriter</span><span class="op" id="6571917">(</span><span class="ident" id="6571918"><a href="/image/gif/reader_test.go.html#6571874">enc</a></span><span class="op" id="6571921">,</span>&nbsp;<span class="ident" id="6571923"><a href="/image/gif/reader_test.go.html#6565808">lzw</a></span><span class="op" id="6571926">.</span><span class="ident" id="6571927">LSB</span><span class="op" id="6571930">,</span>&nbsp;<span class="num" id="6571932">2</span><span class="op" id="6571933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571937"><a href="/image/gif/reader_test.go.html#6571899">w</a></span><span class="op" id="6571938">.</span><span class="ident" id="6571939">Write</span><span class="op" id="6571944">(</span><span class="ident" id="6571945"><a href="/image/gif/reader_test.go.html#6571846">pix</a></span><span class="op" id="6571948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571952"><a href="/image/gif/reader_test.go.html#6571899">w</a></span><span class="op" id="6571953">.</span><span class="ident" id="6571954">Close</span><span class="op" id="6571959">(</span><span class="op" id="6571960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6571964"><a href="/image/gif/reader_test.go.html#6571545">b</a></span><span class="op" id="6571965">.</span><span class="ident" id="6571966">WriteByte</span><span class="op" id="6571975">(</span><span class="builtintype" id="6571976">byte</span><span class="op" id="6571980">(</span><span class="builtinfunc" id="6571981">len</span><span class="op" id="6571984">(</span><span class="ident" id="6571985"><a href="/image/gif/reader_test.go.html#6571874">enc</a></span><span class="op" id="6571988">.</span><span class="ident" id="6571989">Bytes</span><span class="op" id="6571994">(</span><span class="op" id="6571995">)</span><span class="op" id="6571996">)</span><span class="op" id="6571997">)</span><span class="op" id="6571998">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6572002"><a href="/image/gif/reader_test.go.html#6571545">b</a></span><span class="op" id="6572003">.</span><span class="ident" id="6572004">Write</span><span class="op" id="6572009">(</span><span class="ident" id="6572010"><a href="/image/gif/reader_test.go.html#6571874">enc</a></span><span class="op" id="6572013">.</span><span class="ident" id="6572014">Bytes</span><span class="op" id="6572019">(</span><span class="op" id="6572020">)</span><span class="op" id="6572021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6572025"><a href="/image/gif/reader_test.go.html#6571545">b</a></span><span class="op" id="6572026">.</span><span class="ident" id="6572027">WriteByte</span><span class="op" id="6572036">(</span><span class="num" id="6572037">0x00</span><span class="op" id="6572041">)</span>&nbsp;<span class="comment" id="6572043">//&nbsp;An&nbsp;empty&nbsp;block&nbsp;signifies&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;image&nbsp;data.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6572101"><a href="/image/gif/reader_test.go.html#6571545">b</a></span><span class="op" id="6572102">.</span><span class="ident" id="6572103">WriteString</span><span class="op" id="6572114">(</span><span class="ident" id="6572115"><a href="/image/gif/reader_test.go.html#6566183">trailerStr</a></span><span class="op" id="6572125">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6572130">//&nbsp;No&nbsp;error&nbsp;expected,&nbsp;unless&nbsp;the&nbsp;pixels&nbsp;are&nbsp;beyond&nbsp;the&nbsp;2&nbsp;color&nbsp;palette.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6572204">want</span>&nbsp;<span class="op" id="6572209">:=</span>&nbsp;<span class="string" id="6572212">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6572217">if</span>&nbsp;<span class="ident" id="6572220"><a href="/image/gif/reader_test.go.html#6571503">pval</a></span>&nbsp;<span class="op" id="6572225">&gt;=</span>&nbsp;<span class="num" id="6572228">2</span>&nbsp;<span class="op" id="6572230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6572235"><a href="/image/gif/reader_test.go.html#6572204">want</a></span>&nbsp;<span class="op" id="6572240">=</span>&nbsp;<span class="string" id="6572242">&#34;gif:&nbsp;invalid&nbsp;pixel&nbsp;value&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6572271">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6572275"><a href="/image/gif/reader_test.go.html#6569900">try</a></span><span class="op" id="6572278">(</span><span class="ident" id="6572279"><a href="/image/gif/reader_test.go.html#6571479">t</a></span><span class="op" id="6572280">,</span>&nbsp;<span class="ident" id="6572282"><a href="/image/gif/reader_test.go.html#6571545">b</a></span><span class="op" id="6572283">.</span><span class="ident" id="6572284">Bytes</span><span class="op" id="6572289">(</span><span class="op" id="6572290">)</span><span class="op" id="6572291">,</span>&nbsp;<span class="ident" id="6572293"><a href="/image/gif/reader_test.go.html#6572204">want</a></span><span class="op" id="6572297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6572300">}</span><br>
<span class="lineno"></span><span class="op" id="6572302">}</span>
</div>
</body>
</html>
