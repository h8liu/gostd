<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/jpeg</h2>
<ul>
<li><a href="/gostd/image/jpeg/dct_test.go.html">dct_test.go</a></li>
<li><a href="/gostd/image/jpeg/fdct.go.html">fdct.go</a></li>
<li><a href="/gostd/image/jpeg/huffman.go.html">huffman.go</a></li>
<li><a href="/gostd/image/jpeg/idct.go.html">idct.go</a></li>
<li><a href="/gostd/image/jpeg/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/jpeg/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/jpeg/scan.go.html">scan.go</a></li>
<li><a href="/gostd/image/jpeg/writer.go.html" class="current">writer.go</a></li>
<li><a href="/gostd/image/jpeg/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5128371">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5128426">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5128480">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5128531">package</span>&nbsp;<span class="ident" id="5128539">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5128545">import</span>&nbsp;<span class="op" id="5128552">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128555">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128564">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128574">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128583">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5128598">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5128603">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5128606">//&nbsp;min&nbsp;returns&nbsp;the&nbsp;minimum&nbsp;of&nbsp;two&nbsp;integers.</span><br>
<span class="lineno"></span><span class="keyword" id="5128650">func</span>&nbsp;<span class="ident" id="5128655">min</span><span class="op" id="5128658">(</span><span class="ident" id="5128659">x</span><span class="op" id="5128660">,</span>&nbsp;<span class="ident" id="5128662">y</span>&nbsp;<span class="builtintype" id="5128664">int</span><span class="op" id="5128667">)</span>&nbsp;<span class="builtintype" id="5128669">int</span>&nbsp;<span class="op" id="5128673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128676">if</span>&nbsp;<span class="ident" id="5128679"><a href="/gostd/image/jpeg/writer.go.html#5128659">x</a></span>&nbsp;<span class="op" id="5128681">&lt;</span>&nbsp;<span class="ident" id="5128683"><a href="/gostd/image/jpeg/writer.go.html#5128662">y</a></span>&nbsp;<span class="op" id="5128685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128689">return</span>&nbsp;<span class="ident" id="5128696"><a href="/gostd/image/jpeg/writer.go.html#5128659">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5128699">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128702">return</span>&nbsp;<span class="ident" id="5128709"><a href="/gostd/image/jpeg/writer.go.html#5128662">y</a></span><br>
<span class="lineno"></span><span class="op" id="5128711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5128714">//&nbsp;div&nbsp;returns&nbsp;a/b&nbsp;rounded&nbsp;to&nbsp;the&nbsp;nearest&nbsp;integer,&nbsp;instead&nbsp;of&nbsp;rounded&nbsp;to&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="5128793">func</span>&nbsp;<span class="ident" id="5128798">div</span><span class="op" id="5128801">(</span><span class="ident" id="5128802">a</span><span class="op" id="5128803">,</span>&nbsp;<span class="ident" id="5128805">b</span>&nbsp;<span class="builtintype" id="5128807">int32</span><span class="op" id="5128812">)</span>&nbsp;<span class="builtintype" id="5128814">int32</span>&nbsp;<span class="op" id="5128820">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128823">if</span>&nbsp;<span class="ident" id="5128826"><a href="/gostd/image/jpeg/writer.go.html#5128802">a</a></span>&nbsp;<span class="op" id="5128828">&gt;=</span>&nbsp;<span class="num" id="5128831">0</span>&nbsp;<span class="op" id="5128833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128837">return</span>&nbsp;<span class="op" id="5128844">(</span><span class="ident" id="5128845"><a href="/gostd/image/jpeg/writer.go.html#5128802">a</a></span>&nbsp;<span class="op" id="5128847">+</span>&nbsp;<span class="op" id="5128849">(</span><span class="ident" id="5128850"><a href="/gostd/image/jpeg/writer.go.html#5128805">b</a></span>&nbsp;<span class="op" id="5128852">&gt;&gt;</span>&nbsp;<span class="num" id="5128855">1</span><span class="op" id="5128856">)</span><span class="op" id="5128857">)</span>&nbsp;<span class="op" id="5128859">/</span>&nbsp;<span class="ident" id="5128861"><a href="/gostd/image/jpeg/writer.go.html#5128805">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5128864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128867">return</span>&nbsp;<span class="op" id="5128874">-</span><span class="op" id="5128875">(</span><span class="op" id="5128876">(</span><span class="op" id="5128877">-</span><span class="ident" id="5128878"><a href="/gostd/image/jpeg/writer.go.html#5128802">a</a></span>&nbsp;<span class="op" id="5128880">+</span>&nbsp;<span class="op" id="5128882">(</span><span class="ident" id="5128883"><a href="/gostd/image/jpeg/writer.go.html#5128805">b</a></span>&nbsp;<span class="op" id="5128885">&gt;&gt;</span>&nbsp;<span class="num" id="5128888">1</span><span class="op" id="5128889">)</span><span class="op" id="5128890">)</span>&nbsp;<span class="op" id="5128892">/</span>&nbsp;<span class="ident" id="5128894"><a href="/gostd/image/jpeg/writer.go.html#5128805">b</a></span><span class="op" id="5128895">)</span><br>
<span class="lineno"></span><span class="op" id="5128897">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5128900">//&nbsp;bitCount&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;bits&nbsp;needed&nbsp;to&nbsp;hold&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="5128965">var</span>&nbsp;<span class="ident" id="5128969">bitCount</span>&nbsp;<span class="op" id="5128978">=</span>&nbsp;<span class="op" id="5128980">[</span><span class="num" id="5128981">256</span><span class="op" id="5128984">]</span><span class="builtintype" id="5128985">byte</span><span class="op" id="5128989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5128992">0</span><span class="op" id="5128993">,</span>&nbsp;<span class="num" id="5128995">1</span><span class="op" id="5128996">,</span>&nbsp;<span class="num" id="5128998">2</span><span class="op" id="5128999">,</span>&nbsp;<span class="num" id="5129001">2</span><span class="op" id="5129002">,</span>&nbsp;<span class="num" id="5129004">3</span><span class="op" id="5129005">,</span>&nbsp;<span class="num" id="5129007">3</span><span class="op" id="5129008">,</span>&nbsp;<span class="num" id="5129010">3</span><span class="op" id="5129011">,</span>&nbsp;<span class="num" id="5129013">3</span><span class="op" id="5129014">,</span>&nbsp;<span class="num" id="5129016">4</span><span class="op" id="5129017">,</span>&nbsp;<span class="num" id="5129019">4</span><span class="op" id="5129020">,</span>&nbsp;<span class="num" id="5129022">4</span><span class="op" id="5129023">,</span>&nbsp;<span class="num" id="5129025">4</span><span class="op" id="5129026">,</span>&nbsp;<span class="num" id="5129028">4</span><span class="op" id="5129029">,</span>&nbsp;<span class="num" id="5129031">4</span><span class="op" id="5129032">,</span>&nbsp;<span class="num" id="5129034">4</span><span class="op" id="5129035">,</span>&nbsp;<span class="num" id="5129037">4</span><span class="op" id="5129038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129041">5</span><span class="op" id="5129042">,</span>&nbsp;<span class="num" id="5129044">5</span><span class="op" id="5129045">,</span>&nbsp;<span class="num" id="5129047">5</span><span class="op" id="5129048">,</span>&nbsp;<span class="num" id="5129050">5</span><span class="op" id="5129051">,</span>&nbsp;<span class="num" id="5129053">5</span><span class="op" id="5129054">,</span>&nbsp;<span class="num" id="5129056">5</span><span class="op" id="5129057">,</span>&nbsp;<span class="num" id="5129059">5</span><span class="op" id="5129060">,</span>&nbsp;<span class="num" id="5129062">5</span><span class="op" id="5129063">,</span>&nbsp;<span class="num" id="5129065">5</span><span class="op" id="5129066">,</span>&nbsp;<span class="num" id="5129068">5</span><span class="op" id="5129069">,</span>&nbsp;<span class="num" id="5129071">5</span><span class="op" id="5129072">,</span>&nbsp;<span class="num" id="5129074">5</span><span class="op" id="5129075">,</span>&nbsp;<span class="num" id="5129077">5</span><span class="op" id="5129078">,</span>&nbsp;<span class="num" id="5129080">5</span><span class="op" id="5129081">,</span>&nbsp;<span class="num" id="5129083">5</span><span class="op" id="5129084">,</span>&nbsp;<span class="num" id="5129086">5</span><span class="op" id="5129087">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129090">6</span><span class="op" id="5129091">,</span>&nbsp;<span class="num" id="5129093">6</span><span class="op" id="5129094">,</span>&nbsp;<span class="num" id="5129096">6</span><span class="op" id="5129097">,</span>&nbsp;<span class="num" id="5129099">6</span><span class="op" id="5129100">,</span>&nbsp;<span class="num" id="5129102">6</span><span class="op" id="5129103">,</span>&nbsp;<span class="num" id="5129105">6</span><span class="op" id="5129106">,</span>&nbsp;<span class="num" id="5129108">6</span><span class="op" id="5129109">,</span>&nbsp;<span class="num" id="5129111">6</span><span class="op" id="5129112">,</span>&nbsp;<span class="num" id="5129114">6</span><span class="op" id="5129115">,</span>&nbsp;<span class="num" id="5129117">6</span><span class="op" id="5129118">,</span>&nbsp;<span class="num" id="5129120">6</span><span class="op" id="5129121">,</span>&nbsp;<span class="num" id="5129123">6</span><span class="op" id="5129124">,</span>&nbsp;<span class="num" id="5129126">6</span><span class="op" id="5129127">,</span>&nbsp;<span class="num" id="5129129">6</span><span class="op" id="5129130">,</span>&nbsp;<span class="num" id="5129132">6</span><span class="op" id="5129133">,</span>&nbsp;<span class="num" id="5129135">6</span><span class="op" id="5129136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129139">6</span><span class="op" id="5129140">,</span>&nbsp;<span class="num" id="5129142">6</span><span class="op" id="5129143">,</span>&nbsp;<span class="num" id="5129145">6</span><span class="op" id="5129146">,</span>&nbsp;<span class="num" id="5129148">6</span><span class="op" id="5129149">,</span>&nbsp;<span class="num" id="5129151">6</span><span class="op" id="5129152">,</span>&nbsp;<span class="num" id="5129154">6</span><span class="op" id="5129155">,</span>&nbsp;<span class="num" id="5129157">6</span><span class="op" id="5129158">,</span>&nbsp;<span class="num" id="5129160">6</span><span class="op" id="5129161">,</span>&nbsp;<span class="num" id="5129163">6</span><span class="op" id="5129164">,</span>&nbsp;<span class="num" id="5129166">6</span><span class="op" id="5129167">,</span>&nbsp;<span class="num" id="5129169">6</span><span class="op" id="5129170">,</span>&nbsp;<span class="num" id="5129172">6</span><span class="op" id="5129173">,</span>&nbsp;<span class="num" id="5129175">6</span><span class="op" id="5129176">,</span>&nbsp;<span class="num" id="5129178">6</span><span class="op" id="5129179">,</span>&nbsp;<span class="num" id="5129181">6</span><span class="op" id="5129182">,</span>&nbsp;<span class="num" id="5129184">6</span><span class="op" id="5129185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129188">7</span><span class="op" id="5129189">,</span>&nbsp;<span class="num" id="5129191">7</span><span class="op" id="5129192">,</span>&nbsp;<span class="num" id="5129194">7</span><span class="op" id="5129195">,</span>&nbsp;<span class="num" id="5129197">7</span><span class="op" id="5129198">,</span>&nbsp;<span class="num" id="5129200">7</span><span class="op" id="5129201">,</span>&nbsp;<span class="num" id="5129203">7</span><span class="op" id="5129204">,</span>&nbsp;<span class="num" id="5129206">7</span><span class="op" id="5129207">,</span>&nbsp;<span class="num" id="5129209">7</span><span class="op" id="5129210">,</span>&nbsp;<span class="num" id="5129212">7</span><span class="op" id="5129213">,</span>&nbsp;<span class="num" id="5129215">7</span><span class="op" id="5129216">,</span>&nbsp;<span class="num" id="5129218">7</span><span class="op" id="5129219">,</span>&nbsp;<span class="num" id="5129221">7</span><span class="op" id="5129222">,</span>&nbsp;<span class="num" id="5129224">7</span><span class="op" id="5129225">,</span>&nbsp;<span class="num" id="5129227">7</span><span class="op" id="5129228">,</span>&nbsp;<span class="num" id="5129230">7</span><span class="op" id="5129231">,</span>&nbsp;<span class="num" id="5129233">7</span><span class="op" id="5129234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129237">7</span><span class="op" id="5129238">,</span>&nbsp;<span class="num" id="5129240">7</span><span class="op" id="5129241">,</span>&nbsp;<span class="num" id="5129243">7</span><span class="op" id="5129244">,</span>&nbsp;<span class="num" id="5129246">7</span><span class="op" id="5129247">,</span>&nbsp;<span class="num" id="5129249">7</span><span class="op" id="5129250">,</span>&nbsp;<span class="num" id="5129252">7</span><span class="op" id="5129253">,</span>&nbsp;<span class="num" id="5129255">7</span><span class="op" id="5129256">,</span>&nbsp;<span class="num" id="5129258">7</span><span class="op" id="5129259">,</span>&nbsp;<span class="num" id="5129261">7</span><span class="op" id="5129262">,</span>&nbsp;<span class="num" id="5129264">7</span><span class="op" id="5129265">,</span>&nbsp;<span class="num" id="5129267">7</span><span class="op" id="5129268">,</span>&nbsp;<span class="num" id="5129270">7</span><span class="op" id="5129271">,</span>&nbsp;<span class="num" id="5129273">7</span><span class="op" id="5129274">,</span>&nbsp;<span class="num" id="5129276">7</span><span class="op" id="5129277">,</span>&nbsp;<span class="num" id="5129279">7</span><span class="op" id="5129280">,</span>&nbsp;<span class="num" id="5129282">7</span><span class="op" id="5129283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129286">7</span><span class="op" id="5129287">,</span>&nbsp;<span class="num" id="5129289">7</span><span class="op" id="5129290">,</span>&nbsp;<span class="num" id="5129292">7</span><span class="op" id="5129293">,</span>&nbsp;<span class="num" id="5129295">7</span><span class="op" id="5129296">,</span>&nbsp;<span class="num" id="5129298">7</span><span class="op" id="5129299">,</span>&nbsp;<span class="num" id="5129301">7</span><span class="op" id="5129302">,</span>&nbsp;<span class="num" id="5129304">7</span><span class="op" id="5129305">,</span>&nbsp;<span class="num" id="5129307">7</span><span class="op" id="5129308">,</span>&nbsp;<span class="num" id="5129310">7</span><span class="op" id="5129311">,</span>&nbsp;<span class="num" id="5129313">7</span><span class="op" id="5129314">,</span>&nbsp;<span class="num" id="5129316">7</span><span class="op" id="5129317">,</span>&nbsp;<span class="num" id="5129319">7</span><span class="op" id="5129320">,</span>&nbsp;<span class="num" id="5129322">7</span><span class="op" id="5129323">,</span>&nbsp;<span class="num" id="5129325">7</span><span class="op" id="5129326">,</span>&nbsp;<span class="num" id="5129328">7</span><span class="op" id="5129329">,</span>&nbsp;<span class="num" id="5129331">7</span><span class="op" id="5129332">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129335">7</span><span class="op" id="5129336">,</span>&nbsp;<span class="num" id="5129338">7</span><span class="op" id="5129339">,</span>&nbsp;<span class="num" id="5129341">7</span><span class="op" id="5129342">,</span>&nbsp;<span class="num" id="5129344">7</span><span class="op" id="5129345">,</span>&nbsp;<span class="num" id="5129347">7</span><span class="op" id="5129348">,</span>&nbsp;<span class="num" id="5129350">7</span><span class="op" id="5129351">,</span>&nbsp;<span class="num" id="5129353">7</span><span class="op" id="5129354">,</span>&nbsp;<span class="num" id="5129356">7</span><span class="op" id="5129357">,</span>&nbsp;<span class="num" id="5129359">7</span><span class="op" id="5129360">,</span>&nbsp;<span class="num" id="5129362">7</span><span class="op" id="5129363">,</span>&nbsp;<span class="num" id="5129365">7</span><span class="op" id="5129366">,</span>&nbsp;<span class="num" id="5129368">7</span><span class="op" id="5129369">,</span>&nbsp;<span class="num" id="5129371">7</span><span class="op" id="5129372">,</span>&nbsp;<span class="num" id="5129374">7</span><span class="op" id="5129375">,</span>&nbsp;<span class="num" id="5129377">7</span><span class="op" id="5129378">,</span>&nbsp;<span class="num" id="5129380">7</span><span class="op" id="5129381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129384">8</span><span class="op" id="5129385">,</span>&nbsp;<span class="num" id="5129387">8</span><span class="op" id="5129388">,</span>&nbsp;<span class="num" id="5129390">8</span><span class="op" id="5129391">,</span>&nbsp;<span class="num" id="5129393">8</span><span class="op" id="5129394">,</span>&nbsp;<span class="num" id="5129396">8</span><span class="op" id="5129397">,</span>&nbsp;<span class="num" id="5129399">8</span><span class="op" id="5129400">,</span>&nbsp;<span class="num" id="5129402">8</span><span class="op" id="5129403">,</span>&nbsp;<span class="num" id="5129405">8</span><span class="op" id="5129406">,</span>&nbsp;<span class="num" id="5129408">8</span><span class="op" id="5129409">,</span>&nbsp;<span class="num" id="5129411">8</span><span class="op" id="5129412">,</span>&nbsp;<span class="num" id="5129414">8</span><span class="op" id="5129415">,</span>&nbsp;<span class="num" id="5129417">8</span><span class="op" id="5129418">,</span>&nbsp;<span class="num" id="5129420">8</span><span class="op" id="5129421">,</span>&nbsp;<span class="num" id="5129423">8</span><span class="op" id="5129424">,</span>&nbsp;<span class="num" id="5129426">8</span><span class="op" id="5129427">,</span>&nbsp;<span class="num" id="5129429">8</span><span class="op" id="5129430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129433">8</span><span class="op" id="5129434">,</span>&nbsp;<span class="num" id="5129436">8</span><span class="op" id="5129437">,</span>&nbsp;<span class="num" id="5129439">8</span><span class="op" id="5129440">,</span>&nbsp;<span class="num" id="5129442">8</span><span class="op" id="5129443">,</span>&nbsp;<span class="num" id="5129445">8</span><span class="op" id="5129446">,</span>&nbsp;<span class="num" id="5129448">8</span><span class="op" id="5129449">,</span>&nbsp;<span class="num" id="5129451">8</span><span class="op" id="5129452">,</span>&nbsp;<span class="num" id="5129454">8</span><span class="op" id="5129455">,</span>&nbsp;<span class="num" id="5129457">8</span><span class="op" id="5129458">,</span>&nbsp;<span class="num" id="5129460">8</span><span class="op" id="5129461">,</span>&nbsp;<span class="num" id="5129463">8</span><span class="op" id="5129464">,</span>&nbsp;<span class="num" id="5129466">8</span><span class="op" id="5129467">,</span>&nbsp;<span class="num" id="5129469">8</span><span class="op" id="5129470">,</span>&nbsp;<span class="num" id="5129472">8</span><span class="op" id="5129473">,</span>&nbsp;<span class="num" id="5129475">8</span><span class="op" id="5129476">,</span>&nbsp;<span class="num" id="5129478">8</span><span class="op" id="5129479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129482">8</span><span class="op" id="5129483">,</span>&nbsp;<span class="num" id="5129485">8</span><span class="op" id="5129486">,</span>&nbsp;<span class="num" id="5129488">8</span><span class="op" id="5129489">,</span>&nbsp;<span class="num" id="5129491">8</span><span class="op" id="5129492">,</span>&nbsp;<span class="num" id="5129494">8</span><span class="op" id="5129495">,</span>&nbsp;<span class="num" id="5129497">8</span><span class="op" id="5129498">,</span>&nbsp;<span class="num" id="5129500">8</span><span class="op" id="5129501">,</span>&nbsp;<span class="num" id="5129503">8</span><span class="op" id="5129504">,</span>&nbsp;<span class="num" id="5129506">8</span><span class="op" id="5129507">,</span>&nbsp;<span class="num" id="5129509">8</span><span class="op" id="5129510">,</span>&nbsp;<span class="num" id="5129512">8</span><span class="op" id="5129513">,</span>&nbsp;<span class="num" id="5129515">8</span><span class="op" id="5129516">,</span>&nbsp;<span class="num" id="5129518">8</span><span class="op" id="5129519">,</span>&nbsp;<span class="num" id="5129521">8</span><span class="op" id="5129522">,</span>&nbsp;<span class="num" id="5129524">8</span><span class="op" id="5129525">,</span>&nbsp;<span class="num" id="5129527">8</span><span class="op" id="5129528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129531">8</span><span class="op" id="5129532">,</span>&nbsp;<span class="num" id="5129534">8</span><span class="op" id="5129535">,</span>&nbsp;<span class="num" id="5129537">8</span><span class="op" id="5129538">,</span>&nbsp;<span class="num" id="5129540">8</span><span class="op" id="5129541">,</span>&nbsp;<span class="num" id="5129543">8</span><span class="op" id="5129544">,</span>&nbsp;<span class="num" id="5129546">8</span><span class="op" id="5129547">,</span>&nbsp;<span class="num" id="5129549">8</span><span class="op" id="5129550">,</span>&nbsp;<span class="num" id="5129552">8</span><span class="op" id="5129553">,</span>&nbsp;<span class="num" id="5129555">8</span><span class="op" id="5129556">,</span>&nbsp;<span class="num" id="5129558">8</span><span class="op" id="5129559">,</span>&nbsp;<span class="num" id="5129561">8</span><span class="op" id="5129562">,</span>&nbsp;<span class="num" id="5129564">8</span><span class="op" id="5129565">,</span>&nbsp;<span class="num" id="5129567">8</span><span class="op" id="5129568">,</span>&nbsp;<span class="num" id="5129570">8</span><span class="op" id="5129571">,</span>&nbsp;<span class="num" id="5129573">8</span><span class="op" id="5129574">,</span>&nbsp;<span class="num" id="5129576">8</span><span class="op" id="5129577">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129580">8</span><span class="op" id="5129581">,</span>&nbsp;<span class="num" id="5129583">8</span><span class="op" id="5129584">,</span>&nbsp;<span class="num" id="5129586">8</span><span class="op" id="5129587">,</span>&nbsp;<span class="num" id="5129589">8</span><span class="op" id="5129590">,</span>&nbsp;<span class="num" id="5129592">8</span><span class="op" id="5129593">,</span>&nbsp;<span class="num" id="5129595">8</span><span class="op" id="5129596">,</span>&nbsp;<span class="num" id="5129598">8</span><span class="op" id="5129599">,</span>&nbsp;<span class="num" id="5129601">8</span><span class="op" id="5129602">,</span>&nbsp;<span class="num" id="5129604">8</span><span class="op" id="5129605">,</span>&nbsp;<span class="num" id="5129607">8</span><span class="op" id="5129608">,</span>&nbsp;<span class="num" id="5129610">8</span><span class="op" id="5129611">,</span>&nbsp;<span class="num" id="5129613">8</span><span class="op" id="5129614">,</span>&nbsp;<span class="num" id="5129616">8</span><span class="op" id="5129617">,</span>&nbsp;<span class="num" id="5129619">8</span><span class="op" id="5129620">,</span>&nbsp;<span class="num" id="5129622">8</span><span class="op" id="5129623">,</span>&nbsp;<span class="num" id="5129625">8</span><span class="op" id="5129626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129629">8</span><span class="op" id="5129630">,</span>&nbsp;<span class="num" id="5129632">8</span><span class="op" id="5129633">,</span>&nbsp;<span class="num" id="5129635">8</span><span class="op" id="5129636">,</span>&nbsp;<span class="num" id="5129638">8</span><span class="op" id="5129639">,</span>&nbsp;<span class="num" id="5129641">8</span><span class="op" id="5129642">,</span>&nbsp;<span class="num" id="5129644">8</span><span class="op" id="5129645">,</span>&nbsp;<span class="num" id="5129647">8</span><span class="op" id="5129648">,</span>&nbsp;<span class="num" id="5129650">8</span><span class="op" id="5129651">,</span>&nbsp;<span class="num" id="5129653">8</span><span class="op" id="5129654">,</span>&nbsp;<span class="num" id="5129656">8</span><span class="op" id="5129657">,</span>&nbsp;<span class="num" id="5129659">8</span><span class="op" id="5129660">,</span>&nbsp;<span class="num" id="5129662">8</span><span class="op" id="5129663">,</span>&nbsp;<span class="num" id="5129665">8</span><span class="op" id="5129666">,</span>&nbsp;<span class="num" id="5129668">8</span><span class="op" id="5129669">,</span>&nbsp;<span class="num" id="5129671">8</span><span class="op" id="5129672">,</span>&nbsp;<span class="num" id="5129674">8</span><span class="op" id="5129675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129678">8</span><span class="op" id="5129679">,</span>&nbsp;<span class="num" id="5129681">8</span><span class="op" id="5129682">,</span>&nbsp;<span class="num" id="5129684">8</span><span class="op" id="5129685">,</span>&nbsp;<span class="num" id="5129687">8</span><span class="op" id="5129688">,</span>&nbsp;<span class="num" id="5129690">8</span><span class="op" id="5129691">,</span>&nbsp;<span class="num" id="5129693">8</span><span class="op" id="5129694">,</span>&nbsp;<span class="num" id="5129696">8</span><span class="op" id="5129697">,</span>&nbsp;<span class="num" id="5129699">8</span><span class="op" id="5129700">,</span>&nbsp;<span class="num" id="5129702">8</span><span class="op" id="5129703">,</span>&nbsp;<span class="num" id="5129705">8</span><span class="op" id="5129706">,</span>&nbsp;<span class="num" id="5129708">8</span><span class="op" id="5129709">,</span>&nbsp;<span class="num" id="5129711">8</span><span class="op" id="5129712">,</span>&nbsp;<span class="num" id="5129714">8</span><span class="op" id="5129715">,</span>&nbsp;<span class="num" id="5129717">8</span><span class="op" id="5129718">,</span>&nbsp;<span class="num" id="5129720">8</span><span class="op" id="5129721">,</span>&nbsp;<span class="num" id="5129723">8</span><span class="op" id="5129724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5129727">8</span><span class="op" id="5129728">,</span>&nbsp;<span class="num" id="5129730">8</span><span class="op" id="5129731">,</span>&nbsp;<span class="num" id="5129733">8</span><span class="op" id="5129734">,</span>&nbsp;<span class="num" id="5129736">8</span><span class="op" id="5129737">,</span>&nbsp;<span class="num" id="5129739">8</span><span class="op" id="5129740">,</span>&nbsp;<span class="num" id="5129742">8</span><span class="op" id="5129743">,</span>&nbsp;<span class="num" id="5129745">8</span><span class="op" id="5129746">,</span>&nbsp;<span class="num" id="5129748">8</span><span class="op" id="5129749">,</span>&nbsp;<span class="num" id="5129751">8</span><span class="op" id="5129752">,</span>&nbsp;<span class="num" id="5129754">8</span><span class="op" id="5129755">,</span>&nbsp;<span class="num" id="5129757">8</span><span class="op" id="5129758">,</span>&nbsp;<span class="num" id="5129760">8</span><span class="op" id="5129761">,</span>&nbsp;<span class="num" id="5129763">8</span><span class="op" id="5129764">,</span>&nbsp;<span class="num" id="5129766">8</span><span class="op" id="5129767">,</span>&nbsp;<span class="num" id="5129769">8</span><span class="op" id="5129770">,</span>&nbsp;<span class="num" id="5129772">8</span><span class="op" id="5129773">,</span><br>
<span class="lineno"></span><span class="op" id="5129775">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="5129778">type</span>&nbsp;<span class="ident" id="5129783">quantIndex</span>&nbsp;<span class="builtintype" id="5129794">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5129799">const</span>&nbsp;<span class="op" id="5129805">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5129808">quantIndexLuminance</span>&nbsp;<span class="ident" id="5129828"><a href="/gostd/image/jpeg/writer.go.html#5129783">quantIndex</a></span>&nbsp;<span class="op" id="5129839">=</span>&nbsp;<span class="ident" id="5129841">iota</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5129847">quantIndexChrominance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5129870">nQuantIndex</span><br>
<span class="lineno"></span><span class="op" id="5129882">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5129885">//&nbsp;unscaledQuant&nbsp;are&nbsp;the&nbsp;unscaled&nbsp;quantization&nbsp;tables&nbsp;in&nbsp;zig-zag&nbsp;order.&nbsp;Each</span><br>
<span class="lineno">60</span><span class="comment" id="5129962">//&nbsp;encoder&nbsp;copies&nbsp;and&nbsp;scales&nbsp;the&nbsp;tables&nbsp;according&nbsp;to&nbsp;its&nbsp;quality&nbsp;parameter.</span><br>
<span class="lineno"></span><span class="comment" id="5130038">//&nbsp;The&nbsp;values&nbsp;are&nbsp;derived&nbsp;from&nbsp;section&nbsp;K.1&nbsp;after&nbsp;converting&nbsp;from&nbsp;natural&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5130114">//&nbsp;zig-zag&nbsp;order.</span><br>
<span class="lineno"></span><span class="keyword" id="5130132">var</span>&nbsp;<span class="ident" id="5130136">unscaledQuant</span>&nbsp;<span class="op" id="5130150">=</span>&nbsp;<span class="op" id="5130152">[</span><span class="ident" id="5130153"><a href="/gostd/image/jpeg/writer.go.html#5129870">nQuantIndex</a></span><span class="op" id="5130164">]</span><span class="op" id="5130165">[</span><span class="ident" id="5130166"><a href="/gostd/image/jpeg/idct.go.html#5096665">blockSize</a></span><span class="op" id="5130175">]</span><span class="builtintype" id="5130176">byte</span><span class="op" id="5130180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130183">//&nbsp;Luminance.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5130198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130202">16</span><span class="op" id="5130204">,</span>&nbsp;<span class="num" id="5130206">11</span><span class="op" id="5130208">,</span>&nbsp;<span class="num" id="5130210">12</span><span class="op" id="5130212">,</span>&nbsp;<span class="num" id="5130214">14</span><span class="op" id="5130216">,</span>&nbsp;<span class="num" id="5130218">12</span><span class="op" id="5130220">,</span>&nbsp;<span class="num" id="5130222">10</span><span class="op" id="5130224">,</span>&nbsp;<span class="num" id="5130226">16</span><span class="op" id="5130228">,</span>&nbsp;<span class="num" id="5130230">14</span><span class="op" id="5130232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130236">13</span><span class="op" id="5130238">,</span>&nbsp;<span class="num" id="5130240">14</span><span class="op" id="5130242">,</span>&nbsp;<span class="num" id="5130244">18</span><span class="op" id="5130246">,</span>&nbsp;<span class="num" id="5130248">17</span><span class="op" id="5130250">,</span>&nbsp;<span class="num" id="5130252">16</span><span class="op" id="5130254">,</span>&nbsp;<span class="num" id="5130256">19</span><span class="op" id="5130258">,</span>&nbsp;<span class="num" id="5130260">24</span><span class="op" id="5130262">,</span>&nbsp;<span class="num" id="5130264">40</span><span class="op" id="5130266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130270">26</span><span class="op" id="5130272">,</span>&nbsp;<span class="num" id="5130274">24</span><span class="op" id="5130276">,</span>&nbsp;<span class="num" id="5130278">22</span><span class="op" id="5130280">,</span>&nbsp;<span class="num" id="5130282">22</span><span class="op" id="5130284">,</span>&nbsp;<span class="num" id="5130286">24</span><span class="op" id="5130288">,</span>&nbsp;<span class="num" id="5130290">49</span><span class="op" id="5130292">,</span>&nbsp;<span class="num" id="5130294">35</span><span class="op" id="5130296">,</span>&nbsp;<span class="num" id="5130298">37</span><span class="op" id="5130300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130304">29</span><span class="op" id="5130306">,</span>&nbsp;<span class="num" id="5130308">40</span><span class="op" id="5130310">,</span>&nbsp;<span class="num" id="5130312">58</span><span class="op" id="5130314">,</span>&nbsp;<span class="num" id="5130316">51</span><span class="op" id="5130318">,</span>&nbsp;<span class="num" id="5130320">61</span><span class="op" id="5130322">,</span>&nbsp;<span class="num" id="5130324">60</span><span class="op" id="5130326">,</span>&nbsp;<span class="num" id="5130328">57</span><span class="op" id="5130330">,</span>&nbsp;<span class="num" id="5130332">51</span><span class="op" id="5130334">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130338">56</span><span class="op" id="5130340">,</span>&nbsp;<span class="num" id="5130342">55</span><span class="op" id="5130344">,</span>&nbsp;<span class="num" id="5130346">64</span><span class="op" id="5130348">,</span>&nbsp;<span class="num" id="5130350">72</span><span class="op" id="5130352">,</span>&nbsp;<span class="num" id="5130354">92</span><span class="op" id="5130356">,</span>&nbsp;<span class="num" id="5130358">78</span><span class="op" id="5130360">,</span>&nbsp;<span class="num" id="5130362">64</span><span class="op" id="5130364">,</span>&nbsp;<span class="num" id="5130366">68</span><span class="op" id="5130368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130372">87</span><span class="op" id="5130374">,</span>&nbsp;<span class="num" id="5130376">69</span><span class="op" id="5130378">,</span>&nbsp;<span class="num" id="5130380">55</span><span class="op" id="5130382">,</span>&nbsp;<span class="num" id="5130384">56</span><span class="op" id="5130386">,</span>&nbsp;<span class="num" id="5130388">80</span><span class="op" id="5130390">,</span>&nbsp;<span class="num" id="5130392">109</span><span class="op" id="5130395">,</span>&nbsp;<span class="num" id="5130397">81</span><span class="op" id="5130399">,</span>&nbsp;<span class="num" id="5130401">87</span><span class="op" id="5130403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130407">95</span><span class="op" id="5130409">,</span>&nbsp;<span class="num" id="5130411">98</span><span class="op" id="5130413">,</span>&nbsp;<span class="num" id="5130415">103</span><span class="op" id="5130418">,</span>&nbsp;<span class="num" id="5130420">104</span><span class="op" id="5130423">,</span>&nbsp;<span class="num" id="5130425">103</span><span class="op" id="5130428">,</span>&nbsp;<span class="num" id="5130430">62</span><span class="op" id="5130432">,</span>&nbsp;<span class="num" id="5130434">77</span><span class="op" id="5130436">,</span>&nbsp;<span class="num" id="5130438">113</span><span class="op" id="5130441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130445">121</span><span class="op" id="5130448">,</span>&nbsp;<span class="num" id="5130450">112</span><span class="op" id="5130453">,</span>&nbsp;<span class="num" id="5130455">100</span><span class="op" id="5130458">,</span>&nbsp;<span class="num" id="5130460">120</span><span class="op" id="5130463">,</span>&nbsp;<span class="num" id="5130465">92</span><span class="op" id="5130467">,</span>&nbsp;<span class="num" id="5130469">101</span><span class="op" id="5130472">,</span>&nbsp;<span class="num" id="5130474">103</span><span class="op" id="5130477">,</span>&nbsp;<span class="num" id="5130479">99</span><span class="op" id="5130481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5130484">}</span><span class="op" id="5130485">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130488">//&nbsp;Chrominance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5130505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130509">17</span><span class="op" id="5130511">,</span>&nbsp;<span class="num" id="5130513">18</span><span class="op" id="5130515">,</span>&nbsp;<span class="num" id="5130517">18</span><span class="op" id="5130519">,</span>&nbsp;<span class="num" id="5130521">24</span><span class="op" id="5130523">,</span>&nbsp;<span class="num" id="5130525">21</span><span class="op" id="5130527">,</span>&nbsp;<span class="num" id="5130529">24</span><span class="op" id="5130531">,</span>&nbsp;<span class="num" id="5130533">47</span><span class="op" id="5130535">,</span>&nbsp;<span class="num" id="5130537">26</span><span class="op" id="5130539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130543">26</span><span class="op" id="5130545">,</span>&nbsp;<span class="num" id="5130547">47</span><span class="op" id="5130549">,</span>&nbsp;<span class="num" id="5130551">99</span><span class="op" id="5130553">,</span>&nbsp;<span class="num" id="5130555">66</span><span class="op" id="5130557">,</span>&nbsp;<span class="num" id="5130559">56</span><span class="op" id="5130561">,</span>&nbsp;<span class="num" id="5130563">66</span><span class="op" id="5130565">,</span>&nbsp;<span class="num" id="5130567">99</span><span class="op" id="5130569">,</span>&nbsp;<span class="num" id="5130571">99</span><span class="op" id="5130573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130577">99</span><span class="op" id="5130579">,</span>&nbsp;<span class="num" id="5130581">99</span><span class="op" id="5130583">,</span>&nbsp;<span class="num" id="5130585">99</span><span class="op" id="5130587">,</span>&nbsp;<span class="num" id="5130589">99</span><span class="op" id="5130591">,</span>&nbsp;<span class="num" id="5130593">99</span><span class="op" id="5130595">,</span>&nbsp;<span class="num" id="5130597">99</span><span class="op" id="5130599">,</span>&nbsp;<span class="num" id="5130601">99</span><span class="op" id="5130603">,</span>&nbsp;<span class="num" id="5130605">99</span><span class="op" id="5130607">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130611">99</span><span class="op" id="5130613">,</span>&nbsp;<span class="num" id="5130615">99</span><span class="op" id="5130617">,</span>&nbsp;<span class="num" id="5130619">99</span><span class="op" id="5130621">,</span>&nbsp;<span class="num" id="5130623">99</span><span class="op" id="5130625">,</span>&nbsp;<span class="num" id="5130627">99</span><span class="op" id="5130629">,</span>&nbsp;<span class="num" id="5130631">99</span><span class="op" id="5130633">,</span>&nbsp;<span class="num" id="5130635">99</span><span class="op" id="5130637">,</span>&nbsp;<span class="num" id="5130639">99</span><span class="op" id="5130641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130645">99</span><span class="op" id="5130647">,</span>&nbsp;<span class="num" id="5130649">99</span><span class="op" id="5130651">,</span>&nbsp;<span class="num" id="5130653">99</span><span class="op" id="5130655">,</span>&nbsp;<span class="num" id="5130657">99</span><span class="op" id="5130659">,</span>&nbsp;<span class="num" id="5130661">99</span><span class="op" id="5130663">,</span>&nbsp;<span class="num" id="5130665">99</span><span class="op" id="5130667">,</span>&nbsp;<span class="num" id="5130669">99</span><span class="op" id="5130671">,</span>&nbsp;<span class="num" id="5130673">99</span><span class="op" id="5130675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130679">99</span><span class="op" id="5130681">,</span>&nbsp;<span class="num" id="5130683">99</span><span class="op" id="5130685">,</span>&nbsp;<span class="num" id="5130687">99</span><span class="op" id="5130689">,</span>&nbsp;<span class="num" id="5130691">99</span><span class="op" id="5130693">,</span>&nbsp;<span class="num" id="5130695">99</span><span class="op" id="5130697">,</span>&nbsp;<span class="num" id="5130699">99</span><span class="op" id="5130701">,</span>&nbsp;<span class="num" id="5130703">99</span><span class="op" id="5130705">,</span>&nbsp;<span class="num" id="5130707">99</span><span class="op" id="5130709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130713">99</span><span class="op" id="5130715">,</span>&nbsp;<span class="num" id="5130717">99</span><span class="op" id="5130719">,</span>&nbsp;<span class="num" id="5130721">99</span><span class="op" id="5130723">,</span>&nbsp;<span class="num" id="5130725">99</span><span class="op" id="5130727">,</span>&nbsp;<span class="num" id="5130729">99</span><span class="op" id="5130731">,</span>&nbsp;<span class="num" id="5130733">99</span><span class="op" id="5130735">,</span>&nbsp;<span class="num" id="5130737">99</span><span class="op" id="5130739">,</span>&nbsp;<span class="num" id="5130741">99</span><span class="op" id="5130743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5130747">99</span><span class="op" id="5130749">,</span>&nbsp;<span class="num" id="5130751">99</span><span class="op" id="5130753">,</span>&nbsp;<span class="num" id="5130755">99</span><span class="op" id="5130757">,</span>&nbsp;<span class="num" id="5130759">99</span><span class="op" id="5130761">,</span>&nbsp;<span class="num" id="5130763">99</span><span class="op" id="5130765">,</span>&nbsp;<span class="num" id="5130767">99</span><span class="op" id="5130769">,</span>&nbsp;<span class="num" id="5130771">99</span><span class="op" id="5130773">,</span>&nbsp;<span class="num" id="5130775">99</span><span class="op" id="5130777">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5130780">}</span><span class="op" id="5130781">,</span><br>
<span class="lineno"></span><span class="op" id="5130783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5130786">type</span>&nbsp;<span class="ident" id="5130791">huffIndex</span>&nbsp;<span class="builtintype" id="5130801">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="5130806">const</span>&nbsp;<span class="op" id="5130812">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130815">huffIndexLuminanceDC</span>&nbsp;<span class="ident" id="5130836"><a href="/gostd/image/jpeg/writer.go.html#5130791">huffIndex</a></span>&nbsp;<span class="op" id="5130846">=</span>&nbsp;<span class="ident" id="5130848">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130854">huffIndexLuminanceAC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130876">huffIndexChrominanceDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130900">huffIndexChrominanceAC</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130924">nHuffIndex</span><br>
<span class="lineno"></span><span class="op" id="5130935">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5130938">//&nbsp;huffmanSpec&nbsp;specifies&nbsp;a&nbsp;Huffman&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="5130983">type</span>&nbsp;<span class="ident" id="5130988">huffmanSpec</span>&nbsp;<span class="keyword" id="5131000">struct</span>&nbsp;<span class="op" id="5131007">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131010">//&nbsp;count[i]&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;codes&nbsp;of&nbsp;length&nbsp;i&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131064">count</span>&nbsp;<span class="op" id="5131070">[</span><span class="num" id="5131071">16</span><span class="op" id="5131073">]</span><span class="builtintype" id="5131074">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131080">//&nbsp;value[i]&nbsp;is&nbsp;the&nbsp;decoded&nbsp;value&nbsp;of&nbsp;the&nbsp;i&#39;th&nbsp;codeword.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131136">value</span>&nbsp;<span class="op" id="5131142">[</span><span class="op" id="5131143">]</span><span class="builtintype" id="5131144">byte</span><br>
<span class="lineno"></span><span class="op" id="5131149">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="5131152">//&nbsp;theHuffmanSpec&nbsp;is&nbsp;the&nbsp;Huffman&nbsp;encoding&nbsp;specifications.</span><br>
<span class="lineno"></span><span class="comment" id="5131210">//&nbsp;This&nbsp;encoder&nbsp;uses&nbsp;the&nbsp;same&nbsp;Huffman&nbsp;encoding&nbsp;for&nbsp;all&nbsp;images.</span><br>
<span class="lineno"></span><span class="keyword" id="5131273">var</span>&nbsp;<span class="ident" id="5131277">theHuffmanSpec</span>&nbsp;<span class="op" id="5131292">=</span>&nbsp;<span class="op" id="5131294">[</span><span class="ident" id="5131295"><a href="/gostd/image/jpeg/writer.go.html#5130924">nHuffIndex</a></span><span class="op" id="5131305">]</span><span class="ident" id="5131306"><a href="/gostd/image/jpeg/writer.go.html#5130988">huffmanSpec</a></span><span class="op" id="5131317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131320">//&nbsp;Luminance&nbsp;DC.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5131338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5131342">[</span><span class="num" id="5131343">16</span><span class="op" id="5131345">]</span><span class="builtintype" id="5131346">byte</span><span class="op" id="5131350">{</span><span class="num" id="5131351">0</span><span class="op" id="5131352">,</span>&nbsp;<span class="num" id="5131354">1</span><span class="op" id="5131355">,</span>&nbsp;<span class="num" id="5131357">5</span><span class="op" id="5131358">,</span>&nbsp;<span class="num" id="5131360">1</span><span class="op" id="5131361">,</span>&nbsp;<span class="num" id="5131363">1</span><span class="op" id="5131364">,</span>&nbsp;<span class="num" id="5131366">1</span><span class="op" id="5131367">,</span>&nbsp;<span class="num" id="5131369">1</span><span class="op" id="5131370">,</span>&nbsp;<span class="num" id="5131372">1</span><span class="op" id="5131373">,</span>&nbsp;<span class="num" id="5131375">1</span><span class="op" id="5131376">,</span>&nbsp;<span class="num" id="5131378">0</span><span class="op" id="5131379">,</span>&nbsp;<span class="num" id="5131381">0</span><span class="op" id="5131382">,</span>&nbsp;<span class="num" id="5131384">0</span><span class="op" id="5131385">,</span>&nbsp;<span class="num" id="5131387">0</span><span class="op" id="5131388">,</span>&nbsp;<span class="num" id="5131390">0</span><span class="op" id="5131391">,</span>&nbsp;<span class="num" id="5131393">0</span><span class="op" id="5131394">,</span>&nbsp;<span class="num" id="5131396">0</span><span class="op" id="5131397">}</span><span class="op" id="5131398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5131402">[</span><span class="op" id="5131403">]</span><span class="builtintype" id="5131404">byte</span><span class="op" id="5131408">{</span><span class="num" id="5131409">0</span><span class="op" id="5131410">,</span>&nbsp;<span class="num" id="5131412">1</span><span class="op" id="5131413">,</span>&nbsp;<span class="num" id="5131415">2</span><span class="op" id="5131416">,</span>&nbsp;<span class="num" id="5131418">3</span><span class="op" id="5131419">,</span>&nbsp;<span class="num" id="5131421">4</span><span class="op" id="5131422">,</span>&nbsp;<span class="num" id="5131424">5</span><span class="op" id="5131425">,</span>&nbsp;<span class="num" id="5131427">6</span><span class="op" id="5131428">,</span>&nbsp;<span class="num" id="5131430">7</span><span class="op" id="5131431">,</span>&nbsp;<span class="num" id="5131433">8</span><span class="op" id="5131434">,</span>&nbsp;<span class="num" id="5131436">9</span><span class="op" id="5131437">,</span>&nbsp;<span class="num" id="5131439">10</span><span class="op" id="5131441">,</span>&nbsp;<span class="num" id="5131443">11</span><span class="op" id="5131445">}</span><span class="op" id="5131446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5131449">}</span><span class="op" id="5131450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131453">//&nbsp;Luminance&nbsp;AC.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5131471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5131475">[</span><span class="num" id="5131476">16</span><span class="op" id="5131478">]</span><span class="builtintype" id="5131479">byte</span><span class="op" id="5131483">{</span><span class="num" id="5131484">0</span><span class="op" id="5131485">,</span>&nbsp;<span class="num" id="5131487">2</span><span class="op" id="5131488">,</span>&nbsp;<span class="num" id="5131490">1</span><span class="op" id="5131491">,</span>&nbsp;<span class="num" id="5131493">3</span><span class="op" id="5131494">,</span>&nbsp;<span class="num" id="5131496">3</span><span class="op" id="5131497">,</span>&nbsp;<span class="num" id="5131499">2</span><span class="op" id="5131500">,</span>&nbsp;<span class="num" id="5131502">4</span><span class="op" id="5131503">,</span>&nbsp;<span class="num" id="5131505">3</span><span class="op" id="5131506">,</span>&nbsp;<span class="num" id="5131508">5</span><span class="op" id="5131509">,</span>&nbsp;<span class="num" id="5131511">5</span><span class="op" id="5131512">,</span>&nbsp;<span class="num" id="5131514">4</span><span class="op" id="5131515">,</span>&nbsp;<span class="num" id="5131517">4</span><span class="op" id="5131518">,</span>&nbsp;<span class="num" id="5131520">0</span><span class="op" id="5131521">,</span>&nbsp;<span class="num" id="5131523">0</span><span class="op" id="5131524">,</span>&nbsp;<span class="num" id="5131526">1</span><span class="op" id="5131527">,</span>&nbsp;<span class="num" id="5131529">125</span><span class="op" id="5131532">}</span><span class="op" id="5131533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5131537">[</span><span class="op" id="5131538">]</span><span class="builtintype" id="5131539">byte</span><span class="op" id="5131543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5131548">0x01</span><span class="op" id="5131552">,</span>&nbsp;<span class="num" id="5131554">0x02</span><span class="op" id="5131558">,</span>&nbsp;<span class="num" id="5131560">0x03</span><span class="op" id="5131564">,</span>&nbsp;<span class="num" id="5131566">0x00</span><span class="op" id="5131570">,</span>&nbsp;<span class="num" id="5131572">0x04</span><span class="op" id="5131576">,</span>&nbsp;<span class="num" id="5131578">0x11</span><span class="op" id="5131582">,</span>&nbsp;<span class="num" id="5131584">0x05</span><span class="op" id="5131588">,</span>&nbsp;<span class="num" id="5131590">0x12</span><span class="op" id="5131594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5131599">0x21</span><span class="op" id="5131603">,</span>&nbsp;<span class="num" id="5131605">0x31</span><span class="op" id="5131609">,</span>&nbsp;<span class="num" id="5131611">0x41</span><span class="op" id="5131615">,</span>&nbsp;<span class="num" id="5131617">0x06</span><span class="op" id="5131621">,</span>&nbsp;<span class="num" id="5131623">0x13</span><span class="op" id="5131627">,</span>&nbsp;<span class="num" id="5131629">0x51</span><span class="op" id="5131633">,</span>&nbsp;<span class="num" id="5131635">0x61</span><span class="op" id="5131639">,</span>&nbsp;<span class="num" id="5131641">0x07</span><span class="op" id="5131645">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5131650">0x22</span><span class="op" id="5131654">,</span>&nbsp;<span class="num" id="5131656">0x71</span><span class="op" id="5131660">,</span>&nbsp;<span class="num" id="5131662">0x14</span><span class="op" id="5131666">,</span>&nbsp;<span class="num" id="5131668">0x32</span><span class="op" id="5131672">,</span>&nbsp;<span class="num" id="5131674">0x81</span><span class="op" id="5131678">,</span>&nbsp;<span class="num" id="5131680">0x91</span><span class="op" id="5131684">,</span>&nbsp;<span class="num" id="5131686">0xa1</span><span class="op" id="5131690">,</span>&nbsp;<span class="num" id="5131692">0x08</span><span class="op" id="5131696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5131701">0x23</span><span class="op" id="5131705">,</span>&nbsp;<span class="num" id="5131707">0x42</span><span class="op" id="5131711">,</span>&nbsp;<span class="num" id="5131713">0xb1</span><span class="op" id="5131717">,</span>&nbsp;<span class="num" id="5131719">0xc1</span><span class="op" id="5131723">,</span>&nbsp;<span class="num" id="5131725">0x15</span><span class="op" id="5131729">,</span>&nbsp;<span class="num" id="5131731">0x52</span><span class="op" id="5131735">,</span>&nbsp;<span class="num" id="5131737">0xd1</span><span class="op" id="5131741">,</span>&nbsp;<span class="num" id="5131743">0xf0</span><span class="op" id="5131747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5131752">0x24</span><span class="op" id="5131756">,</span>&nbsp;<span class="num" id="5131758">0x33</span><span class="op" id="5131762">,</span>&nbsp;<span class="num" id="5131764">0x62</span><span class="op" id="5131768">,</span>&nbsp;<span class="num" id="5131770">0x72</span><span class="op" id="5131774">,</span>&nbsp;<span class="num" id="5131776">0x82</span><span class="op" id="5131780">,</span>&nbsp;<span class="num" id="5131782">0x09</span><span class="op" id="5131786">,</span>&nbsp;<span class="num" id="5131788">0x0a</span><span class="op" id="5131792">,</span>&nbsp;<span class="num" id="5131794">0x16</span><span class="op" id="5131798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5131803">0x17</span><span class="op" id="5131807">,</span>&nbsp;<span class="num" id="5131809">0x18</span><span class="op" id="5131813">,</span>&nbsp;<span class="num" id="5131815">0x19</span><span class="op" id="5131819">,</span>&nbsp;<span class="num" id="5131821">0x1a</span><span class="op" id="5131825">,</span>&nbsp;<span class="num" id="5131827">0x25</span><span class="op" id="5131831">,</span>&nbsp;<span class="num" id="5131833">0x26</span><span class="op" id="5131837">,</span>&nbsp;<span class="num" id="5131839">0x27</span><span class="op" id="5131843">,</span>&nbsp;<span class="num" id="5131845">0x28</span><span class="op" id="5131849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5131854">0x29</span><span class="op" id="5131858">,</span>&nbsp;<span class="num" id="5131860">0x2a</span><span class="op" id="5131864">,</span>&nbsp;<span class="num" id="5131866">0x34</span><span class="op" id="5131870">,</span>&nbsp;<span class="num" id="5131872">0x35</span><span class="op" id="5131876">,</span>&nbsp;<span class="num" id="5131878">0x36</span><span class="op" id="5131882">,</span>&nbsp;<span class="num" id="5131884">0x37</span><span class="op" id="5131888">,</span>&nbsp;<span class="num" id="5131890">0x38</span><span class="op" id="5131894">,</span>&nbsp;<span class="num" id="5131896">0x39</span><span class="op" id="5131900">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5131905">0x3a</span><span class="op" id="5131909">,</span>&nbsp;<span class="num" id="5131911">0x43</span><span class="op" id="5131915">,</span>&nbsp;<span class="num" id="5131917">0x44</span><span class="op" id="5131921">,</span>&nbsp;<span class="num" id="5131923">0x45</span><span class="op" id="5131927">,</span>&nbsp;<span class="num" id="5131929">0x46</span><span class="op" id="5131933">,</span>&nbsp;<span class="num" id="5131935">0x47</span><span class="op" id="5131939">,</span>&nbsp;<span class="num" id="5131941">0x48</span><span class="op" id="5131945">,</span>&nbsp;<span class="num" id="5131947">0x49</span><span class="op" id="5131951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5131956">0x4a</span><span class="op" id="5131960">,</span>&nbsp;<span class="num" id="5131962">0x53</span><span class="op" id="5131966">,</span>&nbsp;<span class="num" id="5131968">0x54</span><span class="op" id="5131972">,</span>&nbsp;<span class="num" id="5131974">0x55</span><span class="op" id="5131978">,</span>&nbsp;<span class="num" id="5131980">0x56</span><span class="op" id="5131984">,</span>&nbsp;<span class="num" id="5131986">0x57</span><span class="op" id="5131990">,</span>&nbsp;<span class="num" id="5131992">0x58</span><span class="op" id="5131996">,</span>&nbsp;<span class="num" id="5131998">0x59</span><span class="op" id="5132002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132007">0x5a</span><span class="op" id="5132011">,</span>&nbsp;<span class="num" id="5132013">0x63</span><span class="op" id="5132017">,</span>&nbsp;<span class="num" id="5132019">0x64</span><span class="op" id="5132023">,</span>&nbsp;<span class="num" id="5132025">0x65</span><span class="op" id="5132029">,</span>&nbsp;<span class="num" id="5132031">0x66</span><span class="op" id="5132035">,</span>&nbsp;<span class="num" id="5132037">0x67</span><span class="op" id="5132041">,</span>&nbsp;<span class="num" id="5132043">0x68</span><span class="op" id="5132047">,</span>&nbsp;<span class="num" id="5132049">0x69</span><span class="op" id="5132053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132058">0x6a</span><span class="op" id="5132062">,</span>&nbsp;<span class="num" id="5132064">0x73</span><span class="op" id="5132068">,</span>&nbsp;<span class="num" id="5132070">0x74</span><span class="op" id="5132074">,</span>&nbsp;<span class="num" id="5132076">0x75</span><span class="op" id="5132080">,</span>&nbsp;<span class="num" id="5132082">0x76</span><span class="op" id="5132086">,</span>&nbsp;<span class="num" id="5132088">0x77</span><span class="op" id="5132092">,</span>&nbsp;<span class="num" id="5132094">0x78</span><span class="op" id="5132098">,</span>&nbsp;<span class="num" id="5132100">0x79</span><span class="op" id="5132104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132109">0x7a</span><span class="op" id="5132113">,</span>&nbsp;<span class="num" id="5132115">0x83</span><span class="op" id="5132119">,</span>&nbsp;<span class="num" id="5132121">0x84</span><span class="op" id="5132125">,</span>&nbsp;<span class="num" id="5132127">0x85</span><span class="op" id="5132131">,</span>&nbsp;<span class="num" id="5132133">0x86</span><span class="op" id="5132137">,</span>&nbsp;<span class="num" id="5132139">0x87</span><span class="op" id="5132143">,</span>&nbsp;<span class="num" id="5132145">0x88</span><span class="op" id="5132149">,</span>&nbsp;<span class="num" id="5132151">0x89</span><span class="op" id="5132155">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132160">0x8a</span><span class="op" id="5132164">,</span>&nbsp;<span class="num" id="5132166">0x92</span><span class="op" id="5132170">,</span>&nbsp;<span class="num" id="5132172">0x93</span><span class="op" id="5132176">,</span>&nbsp;<span class="num" id="5132178">0x94</span><span class="op" id="5132182">,</span>&nbsp;<span class="num" id="5132184">0x95</span><span class="op" id="5132188">,</span>&nbsp;<span class="num" id="5132190">0x96</span><span class="op" id="5132194">,</span>&nbsp;<span class="num" id="5132196">0x97</span><span class="op" id="5132200">,</span>&nbsp;<span class="num" id="5132202">0x98</span><span class="op" id="5132206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132211">0x99</span><span class="op" id="5132215">,</span>&nbsp;<span class="num" id="5132217">0x9a</span><span class="op" id="5132221">,</span>&nbsp;<span class="num" id="5132223">0xa2</span><span class="op" id="5132227">,</span>&nbsp;<span class="num" id="5132229">0xa3</span><span class="op" id="5132233">,</span>&nbsp;<span class="num" id="5132235">0xa4</span><span class="op" id="5132239">,</span>&nbsp;<span class="num" id="5132241">0xa5</span><span class="op" id="5132245">,</span>&nbsp;<span class="num" id="5132247">0xa6</span><span class="op" id="5132251">,</span>&nbsp;<span class="num" id="5132253">0xa7</span><span class="op" id="5132257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132262">0xa8</span><span class="op" id="5132266">,</span>&nbsp;<span class="num" id="5132268">0xa9</span><span class="op" id="5132272">,</span>&nbsp;<span class="num" id="5132274">0xaa</span><span class="op" id="5132278">,</span>&nbsp;<span class="num" id="5132280">0xb2</span><span class="op" id="5132284">,</span>&nbsp;<span class="num" id="5132286">0xb3</span><span class="op" id="5132290">,</span>&nbsp;<span class="num" id="5132292">0xb4</span><span class="op" id="5132296">,</span>&nbsp;<span class="num" id="5132298">0xb5</span><span class="op" id="5132302">,</span>&nbsp;<span class="num" id="5132304">0xb6</span><span class="op" id="5132308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132313">0xb7</span><span class="op" id="5132317">,</span>&nbsp;<span class="num" id="5132319">0xb8</span><span class="op" id="5132323">,</span>&nbsp;<span class="num" id="5132325">0xb9</span><span class="op" id="5132329">,</span>&nbsp;<span class="num" id="5132331">0xba</span><span class="op" id="5132335">,</span>&nbsp;<span class="num" id="5132337">0xc2</span><span class="op" id="5132341">,</span>&nbsp;<span class="num" id="5132343">0xc3</span><span class="op" id="5132347">,</span>&nbsp;<span class="num" id="5132349">0xc4</span><span class="op" id="5132353">,</span>&nbsp;<span class="num" id="5132355">0xc5</span><span class="op" id="5132359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132364">0xc6</span><span class="op" id="5132368">,</span>&nbsp;<span class="num" id="5132370">0xc7</span><span class="op" id="5132374">,</span>&nbsp;<span class="num" id="5132376">0xc8</span><span class="op" id="5132380">,</span>&nbsp;<span class="num" id="5132382">0xc9</span><span class="op" id="5132386">,</span>&nbsp;<span class="num" id="5132388">0xca</span><span class="op" id="5132392">,</span>&nbsp;<span class="num" id="5132394">0xd2</span><span class="op" id="5132398">,</span>&nbsp;<span class="num" id="5132400">0xd3</span><span class="op" id="5132404">,</span>&nbsp;<span class="num" id="5132406">0xd4</span><span class="op" id="5132410">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132415">0xd5</span><span class="op" id="5132419">,</span>&nbsp;<span class="num" id="5132421">0xd6</span><span class="op" id="5132425">,</span>&nbsp;<span class="num" id="5132427">0xd7</span><span class="op" id="5132431">,</span>&nbsp;<span class="num" id="5132433">0xd8</span><span class="op" id="5132437">,</span>&nbsp;<span class="num" id="5132439">0xd9</span><span class="op" id="5132443">,</span>&nbsp;<span class="num" id="5132445">0xda</span><span class="op" id="5132449">,</span>&nbsp;<span class="num" id="5132451">0xe1</span><span class="op" id="5132455">,</span>&nbsp;<span class="num" id="5132457">0xe2</span><span class="op" id="5132461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132466">0xe3</span><span class="op" id="5132470">,</span>&nbsp;<span class="num" id="5132472">0xe4</span><span class="op" id="5132476">,</span>&nbsp;<span class="num" id="5132478">0xe5</span><span class="op" id="5132482">,</span>&nbsp;<span class="num" id="5132484">0xe6</span><span class="op" id="5132488">,</span>&nbsp;<span class="num" id="5132490">0xe7</span><span class="op" id="5132494">,</span>&nbsp;<span class="num" id="5132496">0xe8</span><span class="op" id="5132500">,</span>&nbsp;<span class="num" id="5132502">0xe9</span><span class="op" id="5132506">,</span>&nbsp;<span class="num" id="5132508">0xea</span><span class="op" id="5132512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132517">0xf1</span><span class="op" id="5132521">,</span>&nbsp;<span class="num" id="5132523">0xf2</span><span class="op" id="5132527">,</span>&nbsp;<span class="num" id="5132529">0xf3</span><span class="op" id="5132533">,</span>&nbsp;<span class="num" id="5132535">0xf4</span><span class="op" id="5132539">,</span>&nbsp;<span class="num" id="5132541">0xf5</span><span class="op" id="5132545">,</span>&nbsp;<span class="num" id="5132547">0xf6</span><span class="op" id="5132551">,</span>&nbsp;<span class="num" id="5132553">0xf7</span><span class="op" id="5132557">,</span>&nbsp;<span class="num" id="5132559">0xf8</span><span class="op" id="5132563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132568">0xf9</span><span class="op" id="5132572">,</span>&nbsp;<span class="num" id="5132574">0xfa</span><span class="op" id="5132578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132582">}</span><span class="op" id="5132583">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132586">}</span><span class="op" id="5132587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132590">//&nbsp;Chrominance&nbsp;DC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132614">[</span><span class="num" id="5132615">16</span><span class="op" id="5132617">]</span><span class="builtintype" id="5132618">byte</span><span class="op" id="5132622">{</span><span class="num" id="5132623">0</span><span class="op" id="5132624">,</span>&nbsp;<span class="num" id="5132626">3</span><span class="op" id="5132627">,</span>&nbsp;<span class="num" id="5132629">1</span><span class="op" id="5132630">,</span>&nbsp;<span class="num" id="5132632">1</span><span class="op" id="5132633">,</span>&nbsp;<span class="num" id="5132635">1</span><span class="op" id="5132636">,</span>&nbsp;<span class="num" id="5132638">1</span><span class="op" id="5132639">,</span>&nbsp;<span class="num" id="5132641">1</span><span class="op" id="5132642">,</span>&nbsp;<span class="num" id="5132644">1</span><span class="op" id="5132645">,</span>&nbsp;<span class="num" id="5132647">1</span><span class="op" id="5132648">,</span>&nbsp;<span class="num" id="5132650">1</span><span class="op" id="5132651">,</span>&nbsp;<span class="num" id="5132653">1</span><span class="op" id="5132654">,</span>&nbsp;<span class="num" id="5132656">0</span><span class="op" id="5132657">,</span>&nbsp;<span class="num" id="5132659">0</span><span class="op" id="5132660">,</span>&nbsp;<span class="num" id="5132662">0</span><span class="op" id="5132663">,</span>&nbsp;<span class="num" id="5132665">0</span><span class="op" id="5132666">,</span>&nbsp;<span class="num" id="5132668">0</span><span class="op" id="5132669">}</span><span class="op" id="5132670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132674">[</span><span class="op" id="5132675">]</span><span class="builtintype" id="5132676">byte</span><span class="op" id="5132680">{</span><span class="num" id="5132681">0</span><span class="op" id="5132682">,</span>&nbsp;<span class="num" id="5132684">1</span><span class="op" id="5132685">,</span>&nbsp;<span class="num" id="5132687">2</span><span class="op" id="5132688">,</span>&nbsp;<span class="num" id="5132690">3</span><span class="op" id="5132691">,</span>&nbsp;<span class="num" id="5132693">4</span><span class="op" id="5132694">,</span>&nbsp;<span class="num" id="5132696">5</span><span class="op" id="5132697">,</span>&nbsp;<span class="num" id="5132699">6</span><span class="op" id="5132700">,</span>&nbsp;<span class="num" id="5132702">7</span><span class="op" id="5132703">,</span>&nbsp;<span class="num" id="5132705">8</span><span class="op" id="5132706">,</span>&nbsp;<span class="num" id="5132708">9</span><span class="op" id="5132709">,</span>&nbsp;<span class="num" id="5132711">10</span><span class="op" id="5132713">,</span>&nbsp;<span class="num" id="5132715">11</span><span class="op" id="5132717">}</span><span class="op" id="5132718">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132721">}</span><span class="op" id="5132722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132725">//&nbsp;Chrominance&nbsp;AC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132749">[</span><span class="num" id="5132750">16</span><span class="op" id="5132752">]</span><span class="builtintype" id="5132753">byte</span><span class="op" id="5132757">{</span><span class="num" id="5132758">0</span><span class="op" id="5132759">,</span>&nbsp;<span class="num" id="5132761">2</span><span class="op" id="5132762">,</span>&nbsp;<span class="num" id="5132764">1</span><span class="op" id="5132765">,</span>&nbsp;<span class="num" id="5132767">2</span><span class="op" id="5132768">,</span>&nbsp;<span class="num" id="5132770">4</span><span class="op" id="5132771">,</span>&nbsp;<span class="num" id="5132773">4</span><span class="op" id="5132774">,</span>&nbsp;<span class="num" id="5132776">3</span><span class="op" id="5132777">,</span>&nbsp;<span class="num" id="5132779">4</span><span class="op" id="5132780">,</span>&nbsp;<span class="num" id="5132782">7</span><span class="op" id="5132783">,</span>&nbsp;<span class="num" id="5132785">5</span><span class="op" id="5132786">,</span>&nbsp;<span class="num" id="5132788">4</span><span class="op" id="5132789">,</span>&nbsp;<span class="num" id="5132791">4</span><span class="op" id="5132792">,</span>&nbsp;<span class="num" id="5132794">0</span><span class="op" id="5132795">,</span>&nbsp;<span class="num" id="5132797">1</span><span class="op" id="5132798">,</span>&nbsp;<span class="num" id="5132800">2</span><span class="op" id="5132801">,</span>&nbsp;<span class="num" id="5132803">119</span><span class="op" id="5132806">}</span><span class="op" id="5132807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132811">[</span><span class="op" id="5132812">]</span><span class="builtintype" id="5132813">byte</span><span class="op" id="5132817">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132822">0x00</span><span class="op" id="5132826">,</span>&nbsp;<span class="num" id="5132828">0x01</span><span class="op" id="5132832">,</span>&nbsp;<span class="num" id="5132834">0x02</span><span class="op" id="5132838">,</span>&nbsp;<span class="num" id="5132840">0x03</span><span class="op" id="5132844">,</span>&nbsp;<span class="num" id="5132846">0x11</span><span class="op" id="5132850">,</span>&nbsp;<span class="num" id="5132852">0x04</span><span class="op" id="5132856">,</span>&nbsp;<span class="num" id="5132858">0x05</span><span class="op" id="5132862">,</span>&nbsp;<span class="num" id="5132864">0x21</span><span class="op" id="5132868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132873">0x31</span><span class="op" id="5132877">,</span>&nbsp;<span class="num" id="5132879">0x06</span><span class="op" id="5132883">,</span>&nbsp;<span class="num" id="5132885">0x12</span><span class="op" id="5132889">,</span>&nbsp;<span class="num" id="5132891">0x41</span><span class="op" id="5132895">,</span>&nbsp;<span class="num" id="5132897">0x51</span><span class="op" id="5132901">,</span>&nbsp;<span class="num" id="5132903">0x07</span><span class="op" id="5132907">,</span>&nbsp;<span class="num" id="5132909">0x61</span><span class="op" id="5132913">,</span>&nbsp;<span class="num" id="5132915">0x71</span><span class="op" id="5132919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132924">0x13</span><span class="op" id="5132928">,</span>&nbsp;<span class="num" id="5132930">0x22</span><span class="op" id="5132934">,</span>&nbsp;<span class="num" id="5132936">0x32</span><span class="op" id="5132940">,</span>&nbsp;<span class="num" id="5132942">0x81</span><span class="op" id="5132946">,</span>&nbsp;<span class="num" id="5132948">0x08</span><span class="op" id="5132952">,</span>&nbsp;<span class="num" id="5132954">0x14</span><span class="op" id="5132958">,</span>&nbsp;<span class="num" id="5132960">0x42</span><span class="op" id="5132964">,</span>&nbsp;<span class="num" id="5132966">0x91</span><span class="op" id="5132970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5132975">0xa1</span><span class="op" id="5132979">,</span>&nbsp;<span class="num" id="5132981">0xb1</span><span class="op" id="5132985">,</span>&nbsp;<span class="num" id="5132987">0xc1</span><span class="op" id="5132991">,</span>&nbsp;<span class="num" id="5132993">0x09</span><span class="op" id="5132997">,</span>&nbsp;<span class="num" id="5132999">0x23</span><span class="op" id="5133003">,</span>&nbsp;<span class="num" id="5133005">0x33</span><span class="op" id="5133009">,</span>&nbsp;<span class="num" id="5133011">0x52</span><span class="op" id="5133015">,</span>&nbsp;<span class="num" id="5133017">0xf0</span><span class="op" id="5133021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133026">0x15</span><span class="op" id="5133030">,</span>&nbsp;<span class="num" id="5133032">0x62</span><span class="op" id="5133036">,</span>&nbsp;<span class="num" id="5133038">0x72</span><span class="op" id="5133042">,</span>&nbsp;<span class="num" id="5133044">0xd1</span><span class="op" id="5133048">,</span>&nbsp;<span class="num" id="5133050">0x0a</span><span class="op" id="5133054">,</span>&nbsp;<span class="num" id="5133056">0x16</span><span class="op" id="5133060">,</span>&nbsp;<span class="num" id="5133062">0x24</span><span class="op" id="5133066">,</span>&nbsp;<span class="num" id="5133068">0x34</span><span class="op" id="5133072">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133077">0xe1</span><span class="op" id="5133081">,</span>&nbsp;<span class="num" id="5133083">0x25</span><span class="op" id="5133087">,</span>&nbsp;<span class="num" id="5133089">0xf1</span><span class="op" id="5133093">,</span>&nbsp;<span class="num" id="5133095">0x17</span><span class="op" id="5133099">,</span>&nbsp;<span class="num" id="5133101">0x18</span><span class="op" id="5133105">,</span>&nbsp;<span class="num" id="5133107">0x19</span><span class="op" id="5133111">,</span>&nbsp;<span class="num" id="5133113">0x1a</span><span class="op" id="5133117">,</span>&nbsp;<span class="num" id="5133119">0x26</span><span class="op" id="5133123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133128">0x27</span><span class="op" id="5133132">,</span>&nbsp;<span class="num" id="5133134">0x28</span><span class="op" id="5133138">,</span>&nbsp;<span class="num" id="5133140">0x29</span><span class="op" id="5133144">,</span>&nbsp;<span class="num" id="5133146">0x2a</span><span class="op" id="5133150">,</span>&nbsp;<span class="num" id="5133152">0x35</span><span class="op" id="5133156">,</span>&nbsp;<span class="num" id="5133158">0x36</span><span class="op" id="5133162">,</span>&nbsp;<span class="num" id="5133164">0x37</span><span class="op" id="5133168">,</span>&nbsp;<span class="num" id="5133170">0x38</span><span class="op" id="5133174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133179">0x39</span><span class="op" id="5133183">,</span>&nbsp;<span class="num" id="5133185">0x3a</span><span class="op" id="5133189">,</span>&nbsp;<span class="num" id="5133191">0x43</span><span class="op" id="5133195">,</span>&nbsp;<span class="num" id="5133197">0x44</span><span class="op" id="5133201">,</span>&nbsp;<span class="num" id="5133203">0x45</span><span class="op" id="5133207">,</span>&nbsp;<span class="num" id="5133209">0x46</span><span class="op" id="5133213">,</span>&nbsp;<span class="num" id="5133215">0x47</span><span class="op" id="5133219">,</span>&nbsp;<span class="num" id="5133221">0x48</span><span class="op" id="5133225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133230">0x49</span><span class="op" id="5133234">,</span>&nbsp;<span class="num" id="5133236">0x4a</span><span class="op" id="5133240">,</span>&nbsp;<span class="num" id="5133242">0x53</span><span class="op" id="5133246">,</span>&nbsp;<span class="num" id="5133248">0x54</span><span class="op" id="5133252">,</span>&nbsp;<span class="num" id="5133254">0x55</span><span class="op" id="5133258">,</span>&nbsp;<span class="num" id="5133260">0x56</span><span class="op" id="5133264">,</span>&nbsp;<span class="num" id="5133266">0x57</span><span class="op" id="5133270">,</span>&nbsp;<span class="num" id="5133272">0x58</span><span class="op" id="5133276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133281">0x59</span><span class="op" id="5133285">,</span>&nbsp;<span class="num" id="5133287">0x5a</span><span class="op" id="5133291">,</span>&nbsp;<span class="num" id="5133293">0x63</span><span class="op" id="5133297">,</span>&nbsp;<span class="num" id="5133299">0x64</span><span class="op" id="5133303">,</span>&nbsp;<span class="num" id="5133305">0x65</span><span class="op" id="5133309">,</span>&nbsp;<span class="num" id="5133311">0x66</span><span class="op" id="5133315">,</span>&nbsp;<span class="num" id="5133317">0x67</span><span class="op" id="5133321">,</span>&nbsp;<span class="num" id="5133323">0x68</span><span class="op" id="5133327">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133332">0x69</span><span class="op" id="5133336">,</span>&nbsp;<span class="num" id="5133338">0x6a</span><span class="op" id="5133342">,</span>&nbsp;<span class="num" id="5133344">0x73</span><span class="op" id="5133348">,</span>&nbsp;<span class="num" id="5133350">0x74</span><span class="op" id="5133354">,</span>&nbsp;<span class="num" id="5133356">0x75</span><span class="op" id="5133360">,</span>&nbsp;<span class="num" id="5133362">0x76</span><span class="op" id="5133366">,</span>&nbsp;<span class="num" id="5133368">0x77</span><span class="op" id="5133372">,</span>&nbsp;<span class="num" id="5133374">0x78</span><span class="op" id="5133378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133383">0x79</span><span class="op" id="5133387">,</span>&nbsp;<span class="num" id="5133389">0x7a</span><span class="op" id="5133393">,</span>&nbsp;<span class="num" id="5133395">0x82</span><span class="op" id="5133399">,</span>&nbsp;<span class="num" id="5133401">0x83</span><span class="op" id="5133405">,</span>&nbsp;<span class="num" id="5133407">0x84</span><span class="op" id="5133411">,</span>&nbsp;<span class="num" id="5133413">0x85</span><span class="op" id="5133417">,</span>&nbsp;<span class="num" id="5133419">0x86</span><span class="op" id="5133423">,</span>&nbsp;<span class="num" id="5133425">0x87</span><span class="op" id="5133429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133434">0x88</span><span class="op" id="5133438">,</span>&nbsp;<span class="num" id="5133440">0x89</span><span class="op" id="5133444">,</span>&nbsp;<span class="num" id="5133446">0x8a</span><span class="op" id="5133450">,</span>&nbsp;<span class="num" id="5133452">0x92</span><span class="op" id="5133456">,</span>&nbsp;<span class="num" id="5133458">0x93</span><span class="op" id="5133462">,</span>&nbsp;<span class="num" id="5133464">0x94</span><span class="op" id="5133468">,</span>&nbsp;<span class="num" id="5133470">0x95</span><span class="op" id="5133474">,</span>&nbsp;<span class="num" id="5133476">0x96</span><span class="op" id="5133480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133485">0x97</span><span class="op" id="5133489">,</span>&nbsp;<span class="num" id="5133491">0x98</span><span class="op" id="5133495">,</span>&nbsp;<span class="num" id="5133497">0x99</span><span class="op" id="5133501">,</span>&nbsp;<span class="num" id="5133503">0x9a</span><span class="op" id="5133507">,</span>&nbsp;<span class="num" id="5133509">0xa2</span><span class="op" id="5133513">,</span>&nbsp;<span class="num" id="5133515">0xa3</span><span class="op" id="5133519">,</span>&nbsp;<span class="num" id="5133521">0xa4</span><span class="op" id="5133525">,</span>&nbsp;<span class="num" id="5133527">0xa5</span><span class="op" id="5133531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133536">0xa6</span><span class="op" id="5133540">,</span>&nbsp;<span class="num" id="5133542">0xa7</span><span class="op" id="5133546">,</span>&nbsp;<span class="num" id="5133548">0xa8</span><span class="op" id="5133552">,</span>&nbsp;<span class="num" id="5133554">0xa9</span><span class="op" id="5133558">,</span>&nbsp;<span class="num" id="5133560">0xaa</span><span class="op" id="5133564">,</span>&nbsp;<span class="num" id="5133566">0xb2</span><span class="op" id="5133570">,</span>&nbsp;<span class="num" id="5133572">0xb3</span><span class="op" id="5133576">,</span>&nbsp;<span class="num" id="5133578">0xb4</span><span class="op" id="5133582">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133587">0xb5</span><span class="op" id="5133591">,</span>&nbsp;<span class="num" id="5133593">0xb6</span><span class="op" id="5133597">,</span>&nbsp;<span class="num" id="5133599">0xb7</span><span class="op" id="5133603">,</span>&nbsp;<span class="num" id="5133605">0xb8</span><span class="op" id="5133609">,</span>&nbsp;<span class="num" id="5133611">0xb9</span><span class="op" id="5133615">,</span>&nbsp;<span class="num" id="5133617">0xba</span><span class="op" id="5133621">,</span>&nbsp;<span class="num" id="5133623">0xc2</span><span class="op" id="5133627">,</span>&nbsp;<span class="num" id="5133629">0xc3</span><span class="op" id="5133633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133638">0xc4</span><span class="op" id="5133642">,</span>&nbsp;<span class="num" id="5133644">0xc5</span><span class="op" id="5133648">,</span>&nbsp;<span class="num" id="5133650">0xc6</span><span class="op" id="5133654">,</span>&nbsp;<span class="num" id="5133656">0xc7</span><span class="op" id="5133660">,</span>&nbsp;<span class="num" id="5133662">0xc8</span><span class="op" id="5133666">,</span>&nbsp;<span class="num" id="5133668">0xc9</span><span class="op" id="5133672">,</span>&nbsp;<span class="num" id="5133674">0xca</span><span class="op" id="5133678">,</span>&nbsp;<span class="num" id="5133680">0xd2</span><span class="op" id="5133684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133689">0xd3</span><span class="op" id="5133693">,</span>&nbsp;<span class="num" id="5133695">0xd4</span><span class="op" id="5133699">,</span>&nbsp;<span class="num" id="5133701">0xd5</span><span class="op" id="5133705">,</span>&nbsp;<span class="num" id="5133707">0xd6</span><span class="op" id="5133711">,</span>&nbsp;<span class="num" id="5133713">0xd7</span><span class="op" id="5133717">,</span>&nbsp;<span class="num" id="5133719">0xd8</span><span class="op" id="5133723">,</span>&nbsp;<span class="num" id="5133725">0xd9</span><span class="op" id="5133729">,</span>&nbsp;<span class="num" id="5133731">0xda</span><span class="op" id="5133735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133740">0xe2</span><span class="op" id="5133744">,</span>&nbsp;<span class="num" id="5133746">0xe3</span><span class="op" id="5133750">,</span>&nbsp;<span class="num" id="5133752">0xe4</span><span class="op" id="5133756">,</span>&nbsp;<span class="num" id="5133758">0xe5</span><span class="op" id="5133762">,</span>&nbsp;<span class="num" id="5133764">0xe6</span><span class="op" id="5133768">,</span>&nbsp;<span class="num" id="5133770">0xe7</span><span class="op" id="5133774">,</span>&nbsp;<span class="num" id="5133776">0xe8</span><span class="op" id="5133780">,</span>&nbsp;<span class="num" id="5133782">0xe9</span><span class="op" id="5133786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133791">0xea</span><span class="op" id="5133795">,</span>&nbsp;<span class="num" id="5133797">0xf2</span><span class="op" id="5133801">,</span>&nbsp;<span class="num" id="5133803">0xf3</span><span class="op" id="5133807">,</span>&nbsp;<span class="num" id="5133809">0xf4</span><span class="op" id="5133813">,</span>&nbsp;<span class="num" id="5133815">0xf5</span><span class="op" id="5133819">,</span>&nbsp;<span class="num" id="5133821">0xf6</span><span class="op" id="5133825">,</span>&nbsp;<span class="num" id="5133827">0xf7</span><span class="op" id="5133831">,</span>&nbsp;<span class="num" id="5133833">0xf8</span><span class="op" id="5133837">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5133842">0xf9</span><span class="op" id="5133846">,</span>&nbsp;<span class="num" id="5133848">0xfa</span><span class="op" id="5133852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5133856">}</span><span class="op" id="5133857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5133860">}</span><span class="op" id="5133861">,</span><br>
<span class="lineno"></span><span class="op" id="5133863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="5133866">//&nbsp;huffmanLUT&nbsp;is&nbsp;a&nbsp;compiled&nbsp;look-up&nbsp;table&nbsp;representation&nbsp;of&nbsp;a&nbsp;huffmanSpec.</span><br>
<span class="lineno"></span><span class="comment" id="5133941">//&nbsp;Each&nbsp;value&nbsp;maps&nbsp;to&nbsp;a&nbsp;uint32&nbsp;of&nbsp;which&nbsp;the&nbsp;8&nbsp;most&nbsp;significant&nbsp;bits&nbsp;hold&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5134018">//&nbsp;codeword&nbsp;size&nbsp;in&nbsp;bits&nbsp;and&nbsp;the&nbsp;24&nbsp;least&nbsp;significant&nbsp;bits&nbsp;hold&nbsp;the&nbsp;codeword.</span><br>
<span class="lineno"></span><span class="comment" id="5134096">//&nbsp;The&nbsp;maximum&nbsp;codeword&nbsp;size&nbsp;is&nbsp;16&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="5134137">type</span>&nbsp;<span class="ident" id="5134142">huffmanLUT</span>&nbsp;<span class="op" id="5134153">[</span><span class="op" id="5134154">]</span><span class="builtintype" id="5134155">uint32</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="5134163">func</span>&nbsp;<span class="op" id="5134168">(</span><span class="ident" id="5134169">h</span>&nbsp;<span class="op" id="5134171">*</span><span class="ident" id="5134172"><a href="/gostd/image/jpeg/writer.go.html#5134142">huffmanLUT</a></span><span class="op" id="5134182">)</span>&nbsp;<span class="ident" id="5134184">init</span><span class="op" id="5134188">(</span><span class="ident" id="5134189">s</span>&nbsp;<span class="ident" id="5134191"><a href="/gostd/image/jpeg/writer.go.html#5130988">huffmanSpec</a></span><span class="op" id="5134202">)</span>&nbsp;<span class="op" id="5134204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134207">maxValue</span>&nbsp;<span class="op" id="5134216">:=</span>&nbsp;<span class="num" id="5134219">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134222">for</span>&nbsp;<span class="ident" id="5134226">_</span><span class="op" id="5134227">,</span>&nbsp;<span class="ident" id="5134229">v</span>&nbsp;<span class="op" id="5134231">:=</span>&nbsp;<span class="keyword" id="5134234">range</span>&nbsp;<span class="ident" id="5134240"><a href="/gostd/image/jpeg/writer.go.html#5134189">s</a></span><span class="op" id="5134241">.</span><span class="ident" id="5134242"><a href="/gostd/image/jpeg/writer.go.html#5131136">value</a></span>&nbsp;<span class="op" id="5134248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134252">if</span>&nbsp;<span class="builtintype" id="5134255">int</span><span class="op" id="5134258">(</span><span class="ident" id="5134259"><a href="/gostd/image/jpeg/writer.go.html#5134229">v</a></span><span class="op" id="5134260">)</span>&nbsp;<span class="op" id="5134262">&gt;</span>&nbsp;<span class="ident" id="5134264"><a href="/gostd/image/jpeg/writer.go.html#5134207">maxValue</a></span>&nbsp;<span class="op" id="5134273">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134278"><a href="/gostd/image/jpeg/writer.go.html#5134207">maxValue</a></span>&nbsp;<span class="op" id="5134287">=</span>&nbsp;<span class="builtintype" id="5134289">int</span><span class="op" id="5134292">(</span><span class="ident" id="5134293"><a href="/gostd/image/jpeg/writer.go.html#5134229">v</a></span><span class="op" id="5134294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134304">*</span><span class="ident" id="5134305"><a href="/gostd/image/jpeg/writer.go.html#5134169">h</a></span>&nbsp;<span class="op" id="5134307">=</span>&nbsp;<span class="builtinfunc" id="5134309">make</span><span class="op" id="5134313">(</span><span class="op" id="5134314">[</span><span class="op" id="5134315">]</span><span class="builtintype" id="5134316">uint32</span><span class="op" id="5134322">,</span>&nbsp;<span class="ident" id="5134324"><a href="/gostd/image/jpeg/writer.go.html#5134207">maxValue</a></span><span class="op" id="5134332">+</span><span class="num" id="5134333">1</span><span class="op" id="5134334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134337">code</span><span class="op" id="5134341">,</span>&nbsp;<span class="ident" id="5134343">k</span>&nbsp;<span class="op" id="5134345">:=</span>&nbsp;<span class="builtintype" id="5134348">uint32</span><span class="op" id="5134354">(</span><span class="num" id="5134355">0</span><span class="op" id="5134356">)</span><span class="op" id="5134357">,</span>&nbsp;<span class="num" id="5134359">0</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134362">for</span>&nbsp;<span class="ident" id="5134366">i</span>&nbsp;<span class="op" id="5134368">:=</span>&nbsp;<span class="num" id="5134371">0</span><span class="op" id="5134372">;</span>&nbsp;<span class="ident" id="5134374"><a href="/gostd/image/jpeg/writer.go.html#5134366">i</a></span>&nbsp;<span class="op" id="5134376">&lt;</span>&nbsp;<span class="builtinfunc" id="5134378">len</span><span class="op" id="5134381">(</span><span class="ident" id="5134382"><a href="/gostd/image/jpeg/writer.go.html#5134189">s</a></span><span class="op" id="5134383">.</span><span class="ident" id="5134384"><a href="/gostd/image/jpeg/writer.go.html#5131064">count</a></span><span class="op" id="5134389">)</span><span class="op" id="5134390">;</span>&nbsp;<span class="ident" id="5134392"><a href="/gostd/image/jpeg/writer.go.html#5134366">i</a></span><span class="op" id="5134393">++</span>&nbsp;<span class="op" id="5134396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134400">nBits</span>&nbsp;<span class="op" id="5134406">:=</span>&nbsp;<span class="builtintype" id="5134409">uint32</span><span class="op" id="5134415">(</span><span class="ident" id="5134416"><a href="/gostd/image/jpeg/writer.go.html#5134366">i</a></span><span class="op" id="5134417">+</span><span class="num" id="5134418">1</span><span class="op" id="5134419">)</span>&nbsp;<span class="op" id="5134421">&lt;&lt;</span>&nbsp;<span class="num" id="5134424">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134429">for</span>&nbsp;<span class="ident" id="5134433">j</span>&nbsp;<span class="op" id="5134435">:=</span>&nbsp;<span class="builtintype" id="5134438">uint8</span><span class="op" id="5134443">(</span><span class="num" id="5134444">0</span><span class="op" id="5134445">)</span><span class="op" id="5134446">;</span>&nbsp;<span class="ident" id="5134448"><a href="/gostd/image/jpeg/writer.go.html#5134433">j</a></span>&nbsp;<span class="op" id="5134450">&lt;</span>&nbsp;<span class="ident" id="5134452"><a href="/gostd/image/jpeg/writer.go.html#5134189">s</a></span><span class="op" id="5134453">.</span><span class="ident" id="5134454"><a href="/gostd/image/jpeg/writer.go.html#5131064">count</a></span><span class="op" id="5134459">[</span><span class="ident" id="5134460"><a href="/gostd/image/jpeg/writer.go.html#5134366">i</a></span><span class="op" id="5134461">]</span><span class="op" id="5134462">;</span>&nbsp;<span class="ident" id="5134464"><a href="/gostd/image/jpeg/writer.go.html#5134433">j</a></span><span class="op" id="5134465">++</span>&nbsp;<span class="op" id="5134468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134473">(</span><span class="op" id="5134474">*</span><span class="ident" id="5134475"><a href="/gostd/image/jpeg/writer.go.html#5134169">h</a></span><span class="op" id="5134476">)</span><span class="op" id="5134477">[</span><span class="ident" id="5134478"><a href="/gostd/image/jpeg/writer.go.html#5134189">s</a></span><span class="op" id="5134479">.</span><span class="ident" id="5134480"><a href="/gostd/image/jpeg/writer.go.html#5131136">value</a></span><span class="op" id="5134485">[</span><span class="ident" id="5134486"><a href="/gostd/image/jpeg/writer.go.html#5134343">k</a></span><span class="op" id="5134487">]</span><span class="op" id="5134488">]</span>&nbsp;<span class="op" id="5134490">=</span>&nbsp;<span class="ident" id="5134492"><a href="/gostd/image/jpeg/writer.go.html#5134400">nBits</a></span>&nbsp;<span class="op" id="5134498">|</span>&nbsp;<span class="ident" id="5134500"><a href="/gostd/image/jpeg/writer.go.html#5134337">code</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134508"><a href="/gostd/image/jpeg/writer.go.html#5134337">code</a></span><span class="op" id="5134512">++</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134518"><a href="/gostd/image/jpeg/writer.go.html#5134343">k</a></span><span class="op" id="5134519">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134528"><a href="/gostd/image/jpeg/writer.go.html#5134337">code</a></span>&nbsp;<span class="op" id="5134533">&lt;&lt;=</span>&nbsp;<span class="num" id="5134537">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134540">}</span><br>
<span class="lineno"></span><span class="op" id="5134542">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="comment" id="5134545">//&nbsp;theHuffmanLUT&nbsp;are&nbsp;compiled&nbsp;representations&nbsp;of&nbsp;theHuffmanSpec.</span><br>
<span class="lineno"></span><span class="keyword" id="5134610">var</span>&nbsp;<span class="ident" id="5134614">theHuffmanLUT</span>&nbsp;<span class="op" id="5134628">[</span><span class="num" id="5134629">4</span><span class="op" id="5134630">]</span><span class="ident" id="5134631"><a href="/gostd/image/jpeg/writer.go.html#5134142">huffmanLUT</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5134643">func</span>&nbsp;<span class="ident" id="5134648">init</span><span class="op" id="5134652">(</span><span class="op" id="5134653">)</span>&nbsp;<span class="op" id="5134655">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134658">for</span>&nbsp;<span class="ident" id="5134662">i</span><span class="op" id="5134663">,</span>&nbsp;<span class="ident" id="5134665">s</span>&nbsp;<span class="op" id="5134667">:=</span>&nbsp;<span class="keyword" id="5134670">range</span>&nbsp;<span class="ident" id="5134676"><a href="/gostd/image/jpeg/writer.go.html#5131277">theHuffmanSpec</a></span>&nbsp;<span class="op" id="5134691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134695"><a href="/gostd/image/jpeg/writer.go.html#5134614">theHuffmanLUT</a></span><span class="op" id="5134708">[</span><span class="ident" id="5134709"><a href="/gostd/image/jpeg/writer.go.html#5134662">i</a></span><span class="op" id="5134710">]</span><span class="op" id="5134711">.</span><span class="ident" id="5134712"><a href="/gostd/image/jpeg/writer.go.html#5134184">init</a></span><span class="op" id="5134716">(</span><span class="ident" id="5134717"><a href="/gostd/image/jpeg/writer.go.html#5134665">s</a></span><span class="op" id="5134718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134721">}</span><br>
<span class="lineno"></span><span class="op" id="5134723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="comment" id="5134726">//&nbsp;writer&nbsp;is&nbsp;a&nbsp;buffered&nbsp;writer.</span><br>
<span class="lineno"></span><span class="keyword" id="5134758">type</span>&nbsp;<span class="ident" id="5134763">writer</span>&nbsp;<span class="keyword" id="5134770">interface</span>&nbsp;<span class="op" id="5134780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134783">Flush</span><span class="op" id="5134788">(</span><span class="op" id="5134789">)</span>&nbsp;<span class="builtintype" id="5134791">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134798"><a href="/gostd/image/jpeg/writer.go.html#5128598">io</a></span><span class="op" id="5134800">.</span><span class="ident" id="5134801"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134809"><a href="/gostd/image/jpeg/writer.go.html#5128598">io</a></span><span class="op" id="5134811">.</span><span class="ident" id="5134812"><a href="/gostd/io/io.go.html#1427455">ByteWriter</a></span><br>
<span class="lineno">215</span><span class="op" id="5134823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5134826">//&nbsp;encoder&nbsp;encodes&nbsp;an&nbsp;image&nbsp;to&nbsp;the&nbsp;JPEG&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="5134874">type</span>&nbsp;<span class="ident" id="5134879">encoder</span>&nbsp;<span class="keyword" id="5134887">struct</span>&nbsp;<span class="op" id="5134894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5134897">//&nbsp;w&nbsp;is&nbsp;the&nbsp;writer&nbsp;to&nbsp;write&nbsp;to.&nbsp;err&nbsp;is&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered&nbsp;during</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5134972">//&nbsp;writing.&nbsp;All&nbsp;attempted&nbsp;writes&nbsp;after&nbsp;the&nbsp;first&nbsp;error&nbsp;become&nbsp;no-ops.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135043">w</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5135047"><a href="/gostd/image/jpeg/writer.go.html#5134763">writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135055">err</span>&nbsp;<span class="builtintype" id="5135059">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5135066">//&nbsp;buf&nbsp;is&nbsp;a&nbsp;scratch&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135095">buf</span>&nbsp;<span class="op" id="5135099">[</span><span class="num" id="5135100">16</span><span class="op" id="5135102">]</span><span class="builtintype" id="5135103">byte</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5135109">//&nbsp;bits&nbsp;and&nbsp;nBits&nbsp;are&nbsp;accumulated&nbsp;bits&nbsp;to&nbsp;write&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135164">bits</span><span class="op" id="5135168">,</span>&nbsp;<span class="ident" id="5135170">nBits</span>&nbsp;<span class="builtintype" id="5135176">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5135184">//&nbsp;quant&nbsp;is&nbsp;the&nbsp;scaled&nbsp;quantization&nbsp;tables,&nbsp;in&nbsp;zig-zag&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135247">quant</span>&nbsp;<span class="op" id="5135253">[</span><span class="ident" id="5135254"><a href="/gostd/image/jpeg/writer.go.html#5129870">nQuantIndex</a></span><span class="op" id="5135265">]</span><span class="op" id="5135266">[</span><span class="ident" id="5135267"><a href="/gostd/image/jpeg/idct.go.html#5096665">blockSize</a></span><span class="op" id="5135276">]</span><span class="builtintype" id="5135277">byte</span><br>
<span class="lineno"></span><span class="op" id="5135282">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="5135285">func</span>&nbsp;<span class="op" id="5135290">(</span><span class="ident" id="5135291">e</span>&nbsp;<span class="op" id="5135293">*</span><span class="ident" id="5135294"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5135301">)</span>&nbsp;<span class="ident" id="5135303">flush</span><span class="op" id="5135308">(</span><span class="op" id="5135309">)</span>&nbsp;<span class="op" id="5135311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135314">if</span>&nbsp;<span class="ident" id="5135317"><a href="/gostd/image/jpeg/writer.go.html#5135291">e</a></span><span class="op" id="5135318">.</span><span class="ident" id="5135319"><a href="/gostd/image/jpeg/writer.go.html#5135055">err</a></span>&nbsp;<span class="op" id="5135323">!=</span>&nbsp;<span class="builtintype" id="5135326">nil</span>&nbsp;<span class="op" id="5135330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135334">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135342">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135345"><a href="/gostd/image/jpeg/writer.go.html#5135291">e</a></span><span class="op" id="5135346">.</span><span class="ident" id="5135347"><a href="/gostd/image/jpeg/writer.go.html#5135055">err</a></span>&nbsp;<span class="op" id="5135351">=</span>&nbsp;<span class="ident" id="5135353"><a href="/gostd/image/jpeg/writer.go.html#5135291">e</a></span><span class="op" id="5135354">.</span><span class="ident" id="5135355"><a href="/gostd/image/jpeg/writer.go.html#5135043">w</a></span><span class="op" id="5135356">.</span><span class="ident" id="5135357"><a href="/gostd/image/jpeg/writer.go.html#5134783">Flush</a></span><span class="op" id="5135362">(</span><span class="op" id="5135363">)</span><br>
<span class="lineno"></span><span class="op" id="5135365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5135368">func</span>&nbsp;<span class="op" id="5135373">(</span><span class="ident" id="5135374">e</span>&nbsp;<span class="op" id="5135376">*</span><span class="ident" id="5135377"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5135384">)</span>&nbsp;<span class="ident" id="5135386">write</span><span class="op" id="5135391">(</span><span class="ident" id="5135392">p</span>&nbsp;<span class="op" id="5135394">[</span><span class="op" id="5135395">]</span><span class="builtintype" id="5135396">byte</span><span class="op" id="5135400">)</span>&nbsp;<span class="op" id="5135402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135405">if</span>&nbsp;<span class="ident" id="5135408"><a href="/gostd/image/jpeg/writer.go.html#5135374">e</a></span><span class="op" id="5135409">.</span><span class="ident" id="5135410"><a href="/gostd/image/jpeg/writer.go.html#5135055">err</a></span>&nbsp;<span class="op" id="5135414">!=</span>&nbsp;<span class="builtintype" id="5135417">nil</span>&nbsp;<span class="op" id="5135421">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135425">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135436">_</span><span class="op" id="5135437">,</span>&nbsp;<span class="ident" id="5135439"><a href="/gostd/image/jpeg/writer.go.html#5135374">e</a></span><span class="op" id="5135440">.</span><span class="ident" id="5135441"><a href="/gostd/image/jpeg/writer.go.html#5135055">err</a></span>&nbsp;<span class="op" id="5135445">=</span>&nbsp;<span class="ident" id="5135447"><a href="/gostd/image/jpeg/writer.go.html#5135374">e</a></span><span class="op" id="5135448">.</span><span class="ident" id="5135449"><a href="/gostd/image/jpeg/writer.go.html#5135043">w</a></span><span class="op" id="5135450">.</span><span class="ident" id="5135451"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="5135456">(</span><span class="ident" id="5135457"><a href="/gostd/image/jpeg/writer.go.html#5135392">p</a></span><span class="op" id="5135458">)</span><br>
<span class="lineno"></span><span class="op" id="5135460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="5135463">func</span>&nbsp;<span class="op" id="5135468">(</span><span class="ident" id="5135469">e</span>&nbsp;<span class="op" id="5135471">*</span><span class="ident" id="5135472"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5135479">)</span>&nbsp;<span class="ident" id="5135481">writeByte</span><span class="op" id="5135490">(</span><span class="ident" id="5135491">b</span>&nbsp;<span class="builtintype" id="5135493">byte</span><span class="op" id="5135497">)</span>&nbsp;<span class="op" id="5135499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135502">if</span>&nbsp;<span class="ident" id="5135505"><a href="/gostd/image/jpeg/writer.go.html#5135469">e</a></span><span class="op" id="5135506">.</span><span class="ident" id="5135507"><a href="/gostd/image/jpeg/writer.go.html#5135055">err</a></span>&nbsp;<span class="op" id="5135511">!=</span>&nbsp;<span class="builtintype" id="5135514">nil</span>&nbsp;<span class="op" id="5135518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135522">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135533"><a href="/gostd/image/jpeg/writer.go.html#5135469">e</a></span><span class="op" id="5135534">.</span><span class="ident" id="5135535"><a href="/gostd/image/jpeg/writer.go.html#5135055">err</a></span>&nbsp;<span class="op" id="5135539">=</span>&nbsp;<span class="ident" id="5135541"><a href="/gostd/image/jpeg/writer.go.html#5135469">e</a></span><span class="op" id="5135542">.</span><span class="ident" id="5135543"><a href="/gostd/image/jpeg/writer.go.html#5135043">w</a></span><span class="op" id="5135544">.</span><span class="ident" id="5135545"><a href="/gostd/io/io.go.html#1427479">WriteByte</a></span><span class="op" id="5135554">(</span><span class="ident" id="5135555"><a href="/gostd/image/jpeg/writer.go.html#5135491">b</a></span><span class="op" id="5135556">)</span><br>
<span class="lineno">250</span><span class="op" id="5135558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5135561">//&nbsp;emit&nbsp;emits&nbsp;the&nbsp;least&nbsp;significant&nbsp;nBits&nbsp;bits&nbsp;of&nbsp;bits&nbsp;to&nbsp;the&nbsp;bit-stream.</span><br>
<span class="lineno"></span><span class="comment" id="5135635">//&nbsp;The&nbsp;precondition&nbsp;is&nbsp;bits&nbsp;&lt;&nbsp;1&lt;&lt;nBits&nbsp;&amp;&amp;&nbsp;nBits&nbsp;&lt;=&nbsp;16.</span><br>
<span class="lineno"></span><span class="keyword" id="5135690">func</span>&nbsp;<span class="op" id="5135695">(</span><span class="ident" id="5135696">e</span>&nbsp;<span class="op" id="5135698">*</span><span class="ident" id="5135699"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5135706">)</span>&nbsp;<span class="ident" id="5135708">emit</span><span class="op" id="5135712">(</span><span class="ident" id="5135713">bits</span><span class="op" id="5135717">,</span>&nbsp;<span class="ident" id="5135719">nBits</span>&nbsp;<span class="builtintype" id="5135725">uint32</span><span class="op" id="5135731">)</span>&nbsp;<span class="op" id="5135733">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135736"><a href="/gostd/image/jpeg/writer.go.html#5135719">nBits</a></span>&nbsp;<span class="op" id="5135742">+=</span>&nbsp;<span class="ident" id="5135745"><a href="/gostd/image/jpeg/writer.go.html#5135696">e</a></span><span class="op" id="5135746">.</span><span class="ident" id="5135747"><a href="/gostd/image/jpeg/writer.go.html#5135170">nBits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135754"><a href="/gostd/image/jpeg/writer.go.html#5135713">bits</a></span>&nbsp;<span class="op" id="5135759">&lt;&lt;=</span>&nbsp;<span class="num" id="5135763">32</span>&nbsp;<span class="op" id="5135766">-</span>&nbsp;<span class="ident" id="5135768"><a href="/gostd/image/jpeg/writer.go.html#5135719">nBits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135775"><a href="/gostd/image/jpeg/writer.go.html#5135713">bits</a></span>&nbsp;<span class="op" id="5135780">|=</span>&nbsp;<span class="ident" id="5135783"><a href="/gostd/image/jpeg/writer.go.html#5135696">e</a></span><span class="op" id="5135784">.</span><span class="ident" id="5135785"><a href="/gostd/image/jpeg/writer.go.html#5135164">bits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135791">for</span>&nbsp;<span class="ident" id="5135795"><a href="/gostd/image/jpeg/writer.go.html#5135719">nBits</a></span>&nbsp;<span class="op" id="5135801">&gt;=</span>&nbsp;<span class="num" id="5135804">8</span>&nbsp;<span class="op" id="5135806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135810">b</span>&nbsp;<span class="op" id="5135812">:=</span>&nbsp;<span class="builtintype" id="5135815">uint8</span><span class="op" id="5135820">(</span><span class="ident" id="5135821"><a href="/gostd/image/jpeg/writer.go.html#5135713">bits</a></span>&nbsp;<span class="op" id="5135826">&gt;&gt;</span>&nbsp;<span class="num" id="5135829">24</span><span class="op" id="5135831">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135835"><a href="/gostd/image/jpeg/writer.go.html#5135696">e</a></span><span class="op" id="5135836">.</span><span class="ident" id="5135837"><a href="/gostd/image/jpeg/writer.go.html#5135481">writeByte</a></span><span class="op" id="5135846">(</span><span class="ident" id="5135847"><a href="/gostd/image/jpeg/writer.go.html#5135810">b</a></span><span class="op" id="5135848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135852">if</span>&nbsp;<span class="ident" id="5135855"><a href="/gostd/image/jpeg/writer.go.html#5135810">b</a></span>&nbsp;<span class="op" id="5135857">==</span>&nbsp;<span class="num" id="5135860">0xff</span>&nbsp;<span class="op" id="5135865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135870"><a href="/gostd/image/jpeg/writer.go.html#5135696">e</a></span><span class="op" id="5135871">.</span><span class="ident" id="5135872"><a href="/gostd/image/jpeg/writer.go.html#5135481">writeByte</a></span><span class="op" id="5135881">(</span><span class="num" id="5135882">0x00</span><span class="op" id="5135886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135894"><a href="/gostd/image/jpeg/writer.go.html#5135713">bits</a></span>&nbsp;<span class="op" id="5135899">&lt;&lt;=</span>&nbsp;<span class="num" id="5135903">8</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135907"><a href="/gostd/image/jpeg/writer.go.html#5135719">nBits</a></span>&nbsp;<span class="op" id="5135913">-=</span>&nbsp;<span class="num" id="5135916">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135922"><a href="/gostd/image/jpeg/writer.go.html#5135696">e</a></span><span class="op" id="5135923">.</span><span class="ident" id="5135924"><a href="/gostd/image/jpeg/writer.go.html#5135164">bits</a></span><span class="op" id="5135928">,</span>&nbsp;<span class="ident" id="5135930"><a href="/gostd/image/jpeg/writer.go.html#5135696">e</a></span><span class="op" id="5135931">.</span><span class="ident" id="5135932"><a href="/gostd/image/jpeg/writer.go.html#5135170">nBits</a></span>&nbsp;<span class="op" id="5135938">=</span>&nbsp;<span class="ident" id="5135940"><a href="/gostd/image/jpeg/writer.go.html#5135713">bits</a></span><span class="op" id="5135944">,</span>&nbsp;<span class="ident" id="5135946"><a href="/gostd/image/jpeg/writer.go.html#5135719">nBits</a></span><br>
<span class="lineno"></span><span class="op" id="5135952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment" id="5135955">//&nbsp;emitHuff&nbsp;emits&nbsp;the&nbsp;given&nbsp;value&nbsp;with&nbsp;the&nbsp;given&nbsp;Huffman&nbsp;encoder.</span><br>
<span class="lineno"></span><span class="keyword" id="5136021">func</span>&nbsp;<span class="op" id="5136026">(</span><span class="ident" id="5136027">e</span>&nbsp;<span class="op" id="5136029">*</span><span class="ident" id="5136030"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5136037">)</span>&nbsp;<span class="ident" id="5136039">emitHuff</span><span class="op" id="5136047">(</span><span class="ident" id="5136048">h</span>&nbsp;<span class="ident" id="5136050"><a href="/gostd/image/jpeg/writer.go.html#5130791">huffIndex</a></span><span class="op" id="5136059">,</span>&nbsp;<span class="ident" id="5136061">value</span>&nbsp;<span class="builtintype" id="5136067">int32</span><span class="op" id="5136072">)</span>&nbsp;<span class="op" id="5136074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136077">x</span>&nbsp;<span class="op" id="5136079">:=</span>&nbsp;<span class="ident" id="5136082"><a href="/gostd/image/jpeg/writer.go.html#5134614">theHuffmanLUT</a></span><span class="op" id="5136095">[</span><span class="ident" id="5136096"><a href="/gostd/image/jpeg/writer.go.html#5136048">h</a></span><span class="op" id="5136097">]</span><span class="op" id="5136098">[</span><span class="ident" id="5136099"><a href="/gostd/image/jpeg/writer.go.html#5136061">value</a></span><span class="op" id="5136104">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136107"><a href="/gostd/image/jpeg/writer.go.html#5136027">e</a></span><span class="op" id="5136108">.</span><span class="ident" id="5136109"><a href="/gostd/image/jpeg/writer.go.html#5135708">emit</a></span><span class="op" id="5136113">(</span><span class="ident" id="5136114"><a href="/gostd/image/jpeg/writer.go.html#5136077">x</a></span><span class="op" id="5136115">&amp;</span><span class="op" id="5136116">(</span><span class="num" id="5136117">1</span><span class="op" id="5136118">&lt;&lt;</span><span class="num" id="5136120">24</span><span class="op" id="5136122">-</span><span class="num" id="5136123">1</span><span class="op" id="5136124">)</span><span class="op" id="5136125">,</span>&nbsp;<span class="ident" id="5136127"><a href="/gostd/image/jpeg/writer.go.html#5136077">x</a></span><span class="op" id="5136128">&gt;&gt;</span><span class="num" id="5136130">24</span><span class="op" id="5136132">)</span><br>
<span class="lineno"></span><span class="op" id="5136134">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="5136137">//&nbsp;emitHuffRLE&nbsp;emits&nbsp;a&nbsp;run&nbsp;of&nbsp;runLength&nbsp;copies&nbsp;of&nbsp;value&nbsp;encoded&nbsp;with&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="5136216">//&nbsp;Huffman&nbsp;encoder.</span><br>
<span class="lineno"></span><span class="keyword" id="5136236">func</span>&nbsp;<span class="op" id="5136241">(</span><span class="ident" id="5136242">e</span>&nbsp;<span class="op" id="5136244">*</span><span class="ident" id="5136245"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5136252">)</span>&nbsp;<span class="ident" id="5136254">emitHuffRLE</span><span class="op" id="5136265">(</span><span class="ident" id="5136266">h</span>&nbsp;<span class="ident" id="5136268"><a href="/gostd/image/jpeg/writer.go.html#5130791">huffIndex</a></span><span class="op" id="5136277">,</span>&nbsp;<span class="ident" id="5136279">runLength</span><span class="op" id="5136288">,</span>&nbsp;<span class="ident" id="5136290">value</span>&nbsp;<span class="builtintype" id="5136296">int32</span><span class="op" id="5136301">)</span>&nbsp;<span class="op" id="5136303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136306">a</span><span class="op" id="5136307">,</span>&nbsp;<span class="ident" id="5136309">b</span>&nbsp;<span class="op" id="5136311">:=</span>&nbsp;<span class="ident" id="5136314"><a href="/gostd/image/jpeg/writer.go.html#5136290">value</a></span><span class="op" id="5136319">,</span>&nbsp;<span class="ident" id="5136321"><a href="/gostd/image/jpeg/writer.go.html#5136290">value</a></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136328">if</span>&nbsp;<span class="ident" id="5136331"><a href="/gostd/image/jpeg/writer.go.html#5136306">a</a></span>&nbsp;<span class="op" id="5136333">&lt;</span>&nbsp;<span class="num" id="5136335">0</span>&nbsp;<span class="op" id="5136337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136341"><a href="/gostd/image/jpeg/writer.go.html#5136306">a</a></span><span class="op" id="5136342">,</span>&nbsp;<span class="ident" id="5136344"><a href="/gostd/image/jpeg/writer.go.html#5136309">b</a></span>&nbsp;<span class="op" id="5136346">=</span>&nbsp;<span class="op" id="5136348">-</span><span class="ident" id="5136349"><a href="/gostd/image/jpeg/writer.go.html#5136290">value</a></span><span class="op" id="5136354">,</span>&nbsp;<span class="ident" id="5136356"><a href="/gostd/image/jpeg/writer.go.html#5136290">value</a></span><span class="op" id="5136361">-</span><span class="num" id="5136362">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5136365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136368">var</span>&nbsp;<span class="ident" id="5136372">nBits</span>&nbsp;<span class="builtintype" id="5136378">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136386">if</span>&nbsp;<span class="ident" id="5136389"><a href="/gostd/image/jpeg/writer.go.html#5136306">a</a></span>&nbsp;<span class="op" id="5136391">&lt;</span>&nbsp;<span class="num" id="5136393">0x100</span>&nbsp;<span class="op" id="5136399">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136403"><a href="/gostd/image/jpeg/writer.go.html#5136372">nBits</a></span>&nbsp;<span class="op" id="5136409">=</span>&nbsp;<span class="builtintype" id="5136411">uint32</span><span class="op" id="5136417">(</span><span class="ident" id="5136418"><a href="/gostd/image/jpeg/writer.go.html#5128969">bitCount</a></span><span class="op" id="5136426">[</span><span class="ident" id="5136427"><a href="/gostd/image/jpeg/writer.go.html#5136306">a</a></span><span class="op" id="5136428">]</span><span class="op" id="5136429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5136432">}</span>&nbsp;<span class="keyword" id="5136434">else</span>&nbsp;<span class="op" id="5136439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136443"><a href="/gostd/image/jpeg/writer.go.html#5136372">nBits</a></span>&nbsp;<span class="op" id="5136449">=</span>&nbsp;<span class="num" id="5136451">8</span>&nbsp;<span class="op" id="5136453">+</span>&nbsp;<span class="builtintype" id="5136455">uint32</span><span class="op" id="5136461">(</span><span class="ident" id="5136462"><a href="/gostd/image/jpeg/writer.go.html#5128969">bitCount</a></span><span class="op" id="5136470">[</span><span class="ident" id="5136471"><a href="/gostd/image/jpeg/writer.go.html#5136306">a</a></span><span class="op" id="5136472">&gt;&gt;</span><span class="num" id="5136474">8</span><span class="op" id="5136475">]</span><span class="op" id="5136476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5136479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136482"><a href="/gostd/image/jpeg/writer.go.html#5136242">e</a></span><span class="op" id="5136483">.</span><span class="ident" id="5136484"><a href="/gostd/image/jpeg/writer.go.html#5136039">emitHuff</a></span><span class="op" id="5136492">(</span><span class="ident" id="5136493"><a href="/gostd/image/jpeg/writer.go.html#5136266">h</a></span><span class="op" id="5136494">,</span>&nbsp;<span class="ident" id="5136496"><a href="/gostd/image/jpeg/writer.go.html#5136279">runLength</a></span><span class="op" id="5136505">&lt;&lt;</span><span class="num" id="5136507">4</span><span class="op" id="5136508">|</span><span class="builtintype" id="5136509">int32</span><span class="op" id="5136514">(</span><span class="ident" id="5136515"><a href="/gostd/image/jpeg/writer.go.html#5136372">nBits</a></span><span class="op" id="5136520">)</span><span class="op" id="5136521">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136524">if</span>&nbsp;<span class="ident" id="5136527"><a href="/gostd/image/jpeg/writer.go.html#5136372">nBits</a></span>&nbsp;<span class="op" id="5136533">&gt;</span>&nbsp;<span class="num" id="5136535">0</span>&nbsp;<span class="op" id="5136537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136541"><a href="/gostd/image/jpeg/writer.go.html#5136242">e</a></span><span class="op" id="5136542">.</span><span class="ident" id="5136543"><a href="/gostd/image/jpeg/writer.go.html#5135708">emit</a></span><span class="op" id="5136547">(</span><span class="builtintype" id="5136548">uint32</span><span class="op" id="5136554">(</span><span class="ident" id="5136555"><a href="/gostd/image/jpeg/writer.go.html#5136309">b</a></span><span class="op" id="5136556">)</span><span class="op" id="5136557">&amp;</span><span class="op" id="5136558">(</span><span class="num" id="5136559">1</span><span class="op" id="5136560">&lt;&lt;</span><span class="ident" id="5136562"><a href="/gostd/image/jpeg/writer.go.html#5136372">nBits</a></span><span class="op" id="5136567">-</span><span class="num" id="5136568">1</span><span class="op" id="5136569">)</span><span class="op" id="5136570">,</span>&nbsp;<span class="ident" id="5136572"><a href="/gostd/image/jpeg/writer.go.html#5136372">nBits</a></span><span class="op" id="5136577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5136580">}</span><br>
<span class="lineno"></span><span class="op" id="5136582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="comment" id="5136585">//&nbsp;writeMarkerHeader&nbsp;writes&nbsp;the&nbsp;header&nbsp;for&nbsp;a&nbsp;marker&nbsp;with&nbsp;the&nbsp;given&nbsp;length.</span><br>
<span class="lineno"></span><span class="keyword" id="5136660">func</span>&nbsp;<span class="op" id="5136665">(</span><span class="ident" id="5136666">e</span>&nbsp;<span class="op" id="5136668">*</span><span class="ident" id="5136669"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5136676">)</span>&nbsp;<span class="ident" id="5136678">writeMarkerHeader</span><span class="op" id="5136695">(</span><span class="ident" id="5136696">marker</span>&nbsp;<span class="builtintype" id="5136703">uint8</span><span class="op" id="5136708">,</span>&nbsp;<span class="ident" id="5136710">markerlen</span>&nbsp;<span class="builtintype" id="5136720">int</span><span class="op" id="5136723">)</span>&nbsp;<span class="op" id="5136725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136728"><a href="/gostd/image/jpeg/writer.go.html#5136666">e</a></span><span class="op" id="5136729">.</span><span class="ident" id="5136730"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5136733">[</span><span class="num" id="5136734">0</span><span class="op" id="5136735">]</span>&nbsp;<span class="op" id="5136737">=</span>&nbsp;<span class="num" id="5136739">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136745"><a href="/gostd/image/jpeg/writer.go.html#5136666">e</a></span><span class="op" id="5136746">.</span><span class="ident" id="5136747"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5136750">[</span><span class="num" id="5136751">1</span><span class="op" id="5136752">]</span>&nbsp;<span class="op" id="5136754">=</span>&nbsp;<span class="ident" id="5136756"><a href="/gostd/image/jpeg/writer.go.html#5136696">marker</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136764"><a href="/gostd/image/jpeg/writer.go.html#5136666">e</a></span><span class="op" id="5136765">.</span><span class="ident" id="5136766"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5136769">[</span><span class="num" id="5136770">2</span><span class="op" id="5136771">]</span>&nbsp;<span class="op" id="5136773">=</span>&nbsp;<span class="builtintype" id="5136775">uint8</span><span class="op" id="5136780">(</span><span class="ident" id="5136781"><a href="/gostd/image/jpeg/writer.go.html#5136710">markerlen</a></span>&nbsp;<span class="op" id="5136791">&gt;&gt;</span>&nbsp;<span class="num" id="5136794">8</span><span class="op" id="5136795">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136798"><a href="/gostd/image/jpeg/writer.go.html#5136666">e</a></span><span class="op" id="5136799">.</span><span class="ident" id="5136800"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5136803">[</span><span class="num" id="5136804">3</span><span class="op" id="5136805">]</span>&nbsp;<span class="op" id="5136807">=</span>&nbsp;<span class="builtintype" id="5136809">uint8</span><span class="op" id="5136814">(</span><span class="ident" id="5136815"><a href="/gostd/image/jpeg/writer.go.html#5136710">markerlen</a></span>&nbsp;<span class="op" id="5136825">&amp;</span>&nbsp;<span class="num" id="5136827">0xff</span><span class="op" id="5136831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136834"><a href="/gostd/image/jpeg/writer.go.html#5136666">e</a></span><span class="op" id="5136835">.</span><span class="ident" id="5136836"><a href="/gostd/image/jpeg/writer.go.html#5135386">write</a></span><span class="op" id="5136841">(</span><span class="ident" id="5136842"><a href="/gostd/image/jpeg/writer.go.html#5136666">e</a></span><span class="op" id="5136843">.</span><span class="ident" id="5136844"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5136847">[</span><span class="op" id="5136848">:</span><span class="num" id="5136849">4</span><span class="op" id="5136850">]</span><span class="op" id="5136851">)</span><br>
<span class="lineno"></span><span class="op" id="5136853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5136856">//&nbsp;writeDQT&nbsp;writes&nbsp;the&nbsp;Define&nbsp;Quantization&nbsp;Table&nbsp;marker.</span><br>
<span class="lineno">305</span><span class="keyword" id="5136913">func</span>&nbsp;<span class="op" id="5136918">(</span><span class="ident" id="5136919">e</span>&nbsp;<span class="op" id="5136921">*</span><span class="ident" id="5136922"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5136929">)</span>&nbsp;<span class="ident" id="5136931">writeDQT</span><span class="op" id="5136939">(</span><span class="op" id="5136940">)</span>&nbsp;<span class="op" id="5136942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136945">const</span>&nbsp;<span class="ident" id="5136951">markerlen</span>&nbsp;<span class="op" id="5136961">=</span>&nbsp;<span class="num" id="5136963">2</span>&nbsp;<span class="op" id="5136965">+</span>&nbsp;<span class="builtintype" id="5136967">int</span><span class="op" id="5136970">(</span><span class="ident" id="5136971"><a href="/gostd/image/jpeg/writer.go.html#5129870">nQuantIndex</a></span><span class="op" id="5136982">)</span><span class="op" id="5136983">*</span><span class="op" id="5136984">(</span><span class="num" id="5136985">1</span><span class="op" id="5136986">+</span><span class="ident" id="5136987"><a href="/gostd/image/jpeg/idct.go.html#5096665">blockSize</a></span><span class="op" id="5136996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136999"><a href="/gostd/image/jpeg/writer.go.html#5136919">e</a></span><span class="op" id="5137000">.</span><span class="ident" id="5137001"><a href="/gostd/image/jpeg/writer.go.html#5136678">writeMarkerHeader</a></span><span class="op" id="5137018">(</span><span class="ident" id="5137019"><a href="/gostd/image/jpeg/reader.go.html#5101992">dqtMarker</a></span><span class="op" id="5137028">,</span>&nbsp;<span class="ident" id="5137030"><a href="/gostd/image/jpeg/writer.go.html#5136951">markerlen</a></span><span class="op" id="5137039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137042">for</span>&nbsp;<span class="ident" id="5137046">i</span>&nbsp;<span class="op" id="5137048">:=</span>&nbsp;<span class="keyword" id="5137051">range</span>&nbsp;<span class="ident" id="5137057"><a href="/gostd/image/jpeg/writer.go.html#5136919">e</a></span><span class="op" id="5137058">.</span><span class="ident" id="5137059"><a href="/gostd/image/jpeg/writer.go.html#5135247">quant</a></span>&nbsp;<span class="op" id="5137065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137069"><a href="/gostd/image/jpeg/writer.go.html#5136919">e</a></span><span class="op" id="5137070">.</span><span class="ident" id="5137071"><a href="/gostd/image/jpeg/writer.go.html#5135481">writeByte</a></span><span class="op" id="5137080">(</span><span class="builtintype" id="5137081">uint8</span><span class="op" id="5137086">(</span><span class="ident" id="5137087"><a href="/gostd/image/jpeg/writer.go.html#5137046">i</a></span><span class="op" id="5137088">)</span><span class="op" id="5137089">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137093"><a href="/gostd/image/jpeg/writer.go.html#5136919">e</a></span><span class="op" id="5137094">.</span><span class="ident" id="5137095"><a href="/gostd/image/jpeg/writer.go.html#5135386">write</a></span><span class="op" id="5137100">(</span><span class="ident" id="5137101"><a href="/gostd/image/jpeg/writer.go.html#5136919">e</a></span><span class="op" id="5137102">.</span><span class="ident" id="5137103"><a href="/gostd/image/jpeg/writer.go.html#5135247">quant</a></span><span class="op" id="5137108">[</span><span class="ident" id="5137109"><a href="/gostd/image/jpeg/writer.go.html#5137046">i</a></span><span class="op" id="5137110">]</span><span class="op" id="5137111">[</span><span class="op" id="5137112">:</span><span class="op" id="5137113">]</span><span class="op" id="5137114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5137117">}</span><br>
<span class="lineno"></span><span class="op" id="5137119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5137122">//&nbsp;writeSOF0&nbsp;writes&nbsp;the&nbsp;Start&nbsp;Of&nbsp;Frame&nbsp;(Baseline)&nbsp;marker.</span><br>
<span class="lineno">315</span><span class="keyword" id="5137180">func</span>&nbsp;<span class="op" id="5137185">(</span><span class="ident" id="5137186">e</span>&nbsp;<span class="op" id="5137188">*</span><span class="ident" id="5137189"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5137196">)</span>&nbsp;<span class="ident" id="5137198">writeSOF0</span><span class="op" id="5137207">(</span><span class="ident" id="5137208">size</span>&nbsp;<span class="ident" id="5137213"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5137218">.</span><span class="ident" id="5137219"><a href="/gostd/image/geom.go.html#5148435">Point</a></span><span class="op" id="5137224">,</span>&nbsp;<span class="ident" id="5137226">nComponent</span>&nbsp;<span class="builtintype" id="5137237">int</span><span class="op" id="5137240">)</span>&nbsp;<span class="op" id="5137242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137245">markerlen</span>&nbsp;<span class="op" id="5137255">:=</span>&nbsp;<span class="num" id="5137258">8</span>&nbsp;<span class="op" id="5137260">+</span>&nbsp;<span class="num" id="5137262">3</span><span class="op" id="5137263">*</span><span class="ident" id="5137264"><a href="/gostd/image/jpeg/writer.go.html#5137226">nComponent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137276"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137277">.</span><span class="ident" id="5137278"><a href="/gostd/image/jpeg/writer.go.html#5136678">writeMarkerHeader</a></span><span class="op" id="5137295">(</span><span class="ident" id="5137296"><a href="/gostd/image/jpeg/reader.go.html#5101844">sof0Marker</a></span><span class="op" id="5137306">,</span>&nbsp;<span class="ident" id="5137308"><a href="/gostd/image/jpeg/writer.go.html#5137245">markerlen</a></span><span class="op" id="5137317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137320"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137321">.</span><span class="ident" id="5137322"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137325">[</span><span class="num" id="5137326">0</span><span class="op" id="5137327">]</span>&nbsp;<span class="op" id="5137329">=</span>&nbsp;<span class="num" id="5137331">8</span>&nbsp;<span class="comment" id="5137333">//&nbsp;8-bit&nbsp;color.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137350"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137351">.</span><span class="ident" id="5137352"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137355">[</span><span class="num" id="5137356">1</span><span class="op" id="5137357">]</span>&nbsp;<span class="op" id="5137359">=</span>&nbsp;<span class="builtintype" id="5137361">uint8</span><span class="op" id="5137366">(</span><span class="ident" id="5137367"><a href="/gostd/image/jpeg/writer.go.html#5137208">size</a></span><span class="op" id="5137371">.</span><span class="ident" id="5137372"><a href="/gostd/image/geom.go.html#5148454">Y</a></span>&nbsp;<span class="op" id="5137374">&gt;&gt;</span>&nbsp;<span class="num" id="5137377">8</span><span class="op" id="5137378">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137381"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137382">.</span><span class="ident" id="5137383"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137386">[</span><span class="num" id="5137387">2</span><span class="op" id="5137388">]</span>&nbsp;<span class="op" id="5137390">=</span>&nbsp;<span class="builtintype" id="5137392">uint8</span><span class="op" id="5137397">(</span><span class="ident" id="5137398"><a href="/gostd/image/jpeg/writer.go.html#5137208">size</a></span><span class="op" id="5137402">.</span><span class="ident" id="5137403"><a href="/gostd/image/geom.go.html#5148454">Y</a></span>&nbsp;<span class="op" id="5137405">&amp;</span>&nbsp;<span class="num" id="5137407">0xff</span><span class="op" id="5137411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137414"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137415">.</span><span class="ident" id="5137416"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137419">[</span><span class="num" id="5137420">3</span><span class="op" id="5137421">]</span>&nbsp;<span class="op" id="5137423">=</span>&nbsp;<span class="builtintype" id="5137425">uint8</span><span class="op" id="5137430">(</span><span class="ident" id="5137431"><a href="/gostd/image/jpeg/writer.go.html#5137208">size</a></span><span class="op" id="5137435">.</span><span class="ident" id="5137436"><a href="/gostd/image/geom.go.html#5148451">X</a></span>&nbsp;<span class="op" id="5137438">&gt;&gt;</span>&nbsp;<span class="num" id="5137441">8</span><span class="op" id="5137442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137445"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137446">.</span><span class="ident" id="5137447"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137450">[</span><span class="num" id="5137451">4</span><span class="op" id="5137452">]</span>&nbsp;<span class="op" id="5137454">=</span>&nbsp;<span class="builtintype" id="5137456">uint8</span><span class="op" id="5137461">(</span><span class="ident" id="5137462"><a href="/gostd/image/jpeg/writer.go.html#5137208">size</a></span><span class="op" id="5137466">.</span><span class="ident" id="5137467"><a href="/gostd/image/geom.go.html#5148451">X</a></span>&nbsp;<span class="op" id="5137469">&amp;</span>&nbsp;<span class="num" id="5137471">0xff</span><span class="op" id="5137475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137478"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137479">.</span><span class="ident" id="5137480"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137483">[</span><span class="num" id="5137484">5</span><span class="op" id="5137485">]</span>&nbsp;<span class="op" id="5137487">=</span>&nbsp;<span class="builtintype" id="5137489">uint8</span><span class="op" id="5137494">(</span><span class="ident" id="5137495"><a href="/gostd/image/jpeg/writer.go.html#5137226">nComponent</a></span><span class="op" id="5137505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137508">if</span>&nbsp;<span class="ident" id="5137511"><a href="/gostd/image/jpeg/writer.go.html#5137226">nComponent</a></span>&nbsp;<span class="op" id="5137522">==</span>&nbsp;<span class="num" id="5137525">1</span>&nbsp;<span class="op" id="5137527">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137531"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137532">.</span><span class="ident" id="5137533"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137536">[</span><span class="num" id="5137537">6</span><span class="op" id="5137538">]</span>&nbsp;<span class="op" id="5137540">=</span>&nbsp;<span class="num" id="5137542">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5137546">//&nbsp;No&nbsp;subsampling&nbsp;for&nbsp;grayscale&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137587"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137588">.</span><span class="ident" id="5137589"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137592">[</span><span class="num" id="5137593">7</span><span class="op" id="5137594">]</span>&nbsp;<span class="op" id="5137596">=</span>&nbsp;<span class="num" id="5137598">0x11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137605"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137606">.</span><span class="ident" id="5137607"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137610">[</span><span class="num" id="5137611">8</span><span class="op" id="5137612">]</span>&nbsp;<span class="op" id="5137614">=</span>&nbsp;<span class="num" id="5137616">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5137622">}</span>&nbsp;<span class="keyword" id="5137624">else</span>&nbsp;<span class="op" id="5137629">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137633">for</span>&nbsp;<span class="ident" id="5137637">i</span>&nbsp;<span class="op" id="5137639">:=</span>&nbsp;<span class="num" id="5137642">0</span><span class="op" id="5137643">;</span>&nbsp;<span class="ident" id="5137645"><a href="/gostd/image/jpeg/writer.go.html#5137637">i</a></span>&nbsp;<span class="op" id="5137647">&lt;</span>&nbsp;<span class="ident" id="5137649"><a href="/gostd/image/jpeg/writer.go.html#5137226">nComponent</a></span><span class="op" id="5137659">;</span>&nbsp;<span class="ident" id="5137661"><a href="/gostd/image/jpeg/writer.go.html#5137637">i</a></span><span class="op" id="5137662">++</span>&nbsp;<span class="op" id="5137665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137670"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137671">.</span><span class="ident" id="5137672"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137675">[</span><span class="num" id="5137676">3</span><span class="op" id="5137677">*</span><span class="ident" id="5137678"><a href="/gostd/image/jpeg/writer.go.html#5137637">i</a></span><span class="op" id="5137679">+</span><span class="num" id="5137680">6</span><span class="op" id="5137681">]</span>&nbsp;<span class="op" id="5137683">=</span>&nbsp;<span class="builtintype" id="5137685">uint8</span><span class="op" id="5137690">(</span><span class="ident" id="5137691"><a href="/gostd/image/jpeg/writer.go.html#5137637">i</a></span>&nbsp;<span class="op" id="5137693">+</span>&nbsp;<span class="num" id="5137695">1</span><span class="op" id="5137696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5137701">//&nbsp;We&nbsp;use&nbsp;4:2:0&nbsp;chroma&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137740"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137741">.</span><span class="ident" id="5137742"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137745">[</span><span class="num" id="5137746">3</span><span class="op" id="5137747">*</span><span class="ident" id="5137748"><a href="/gostd/image/jpeg/writer.go.html#5137637">i</a></span><span class="op" id="5137749">+</span><span class="num" id="5137750">7</span><span class="op" id="5137751">]</span>&nbsp;<span class="op" id="5137753">=</span>&nbsp;<span class="string" id="5137755">&#34;\x22\x11\x11&#34;</span><span class="op" id="5137769">[</span><span class="ident" id="5137770"><a href="/gostd/image/jpeg/writer.go.html#5137637">i</a></span><span class="op" id="5137771">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137776"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137777">.</span><span class="ident" id="5137778"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137781">[</span><span class="num" id="5137782">3</span><span class="op" id="5137783">*</span><span class="ident" id="5137784"><a href="/gostd/image/jpeg/writer.go.html#5137637">i</a></span><span class="op" id="5137785">+</span><span class="num" id="5137786">8</span><span class="op" id="5137787">]</span>&nbsp;<span class="op" id="5137789">=</span>&nbsp;<span class="string" id="5137791">&#34;\x00\x01\x01&#34;</span><span class="op" id="5137805">[</span><span class="ident" id="5137806"><a href="/gostd/image/jpeg/writer.go.html#5137637">i</a></span><span class="op" id="5137807">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5137811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5137814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137817"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137818">.</span><span class="ident" id="5137819"><a href="/gostd/image/jpeg/writer.go.html#5135386">write</a></span><span class="op" id="5137824">(</span><span class="ident" id="5137825"><a href="/gostd/image/jpeg/writer.go.html#5137186">e</a></span><span class="op" id="5137826">.</span><span class="ident" id="5137827"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5137830">[</span><span class="op" id="5137831">:</span><span class="num" id="5137832">3</span><span class="op" id="5137833">*</span><span class="op" id="5137834">(</span><span class="ident" id="5137835"><a href="/gostd/image/jpeg/writer.go.html#5137226">nComponent</a></span><span class="op" id="5137845">-</span><span class="num" id="5137846">1</span><span class="op" id="5137847">)</span><span class="op" id="5137848">+</span><span class="num" id="5137849">9</span><span class="op" id="5137850">]</span><span class="op" id="5137851">)</span><br>
<span class="lineno"></span><span class="op" id="5137853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="5137856">//&nbsp;writeDHT&nbsp;writes&nbsp;the&nbsp;Define&nbsp;Huffman&nbsp;Table&nbsp;marker.</span><br>
<span class="lineno"></span><span class="keyword" id="5137908">func</span>&nbsp;<span class="op" id="5137913">(</span><span class="ident" id="5137914">e</span>&nbsp;<span class="op" id="5137916">*</span><span class="ident" id="5137917"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5137924">)</span>&nbsp;<span class="ident" id="5137926">writeDHT</span><span class="op" id="5137934">(</span><span class="ident" id="5137935">nComponent</span>&nbsp;<span class="builtintype" id="5137946">int</span><span class="op" id="5137949">)</span>&nbsp;<span class="op" id="5137951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137954">markerlen</span>&nbsp;<span class="op" id="5137964">:=</span>&nbsp;<span class="num" id="5137967">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137970">specs</span>&nbsp;<span class="op" id="5137976">:=</span>&nbsp;<span class="ident" id="5137979"><a href="/gostd/image/jpeg/writer.go.html#5131277">theHuffmanSpec</a></span><span class="op" id="5137993">[</span><span class="op" id="5137994">:</span><span class="op" id="5137995">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137998">if</span>&nbsp;<span class="ident" id="5138001"><a href="/gostd/image/jpeg/writer.go.html#5137935">nComponent</a></span>&nbsp;<span class="op" id="5138012">==</span>&nbsp;<span class="num" id="5138015">1</span>&nbsp;<span class="op" id="5138017">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5138021">//&nbsp;Drop&nbsp;the&nbsp;Chrominance&nbsp;tables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138055"><a href="/gostd/image/jpeg/writer.go.html#5137970">specs</a></span>&nbsp;<span class="op" id="5138061">=</span>&nbsp;<span class="ident" id="5138063"><a href="/gostd/image/jpeg/writer.go.html#5137970">specs</a></span><span class="op" id="5138068">[</span><span class="op" id="5138069">:</span><span class="num" id="5138070">2</span><span class="op" id="5138071">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5138074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138077">for</span>&nbsp;<span class="ident" id="5138081">_</span><span class="op" id="5138082">,</span>&nbsp;<span class="ident" id="5138084">s</span>&nbsp;<span class="op" id="5138086">:=</span>&nbsp;<span class="keyword" id="5138089">range</span>&nbsp;<span class="ident" id="5138095"><a href="/gostd/image/jpeg/writer.go.html#5137970">specs</a></span>&nbsp;<span class="op" id="5138101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138105"><a href="/gostd/image/jpeg/writer.go.html#5137954">markerlen</a></span>&nbsp;<span class="op" id="5138115">+=</span>&nbsp;<span class="num" id="5138118">1</span>&nbsp;<span class="op" id="5138120">+</span>&nbsp;<span class="num" id="5138122">16</span>&nbsp;<span class="op" id="5138125">+</span>&nbsp;<span class="builtinfunc" id="5138127">len</span><span class="op" id="5138130">(</span><span class="ident" id="5138131"><a href="/gostd/image/jpeg/writer.go.html#5138084">s</a></span><span class="op" id="5138132">.</span><span class="ident" id="5138133"><a href="/gostd/image/jpeg/writer.go.html#5131136">value</a></span><span class="op" id="5138138">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5138141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138144"><a href="/gostd/image/jpeg/writer.go.html#5137914">e</a></span><span class="op" id="5138145">.</span><span class="ident" id="5138146"><a href="/gostd/image/jpeg/writer.go.html#5136678">writeMarkerHeader</a></span><span class="op" id="5138163">(</span><span class="ident" id="5138164"><a href="/gostd/image/jpeg/reader.go.html#5101947">dhtMarker</a></span><span class="op" id="5138173">,</span>&nbsp;<span class="ident" id="5138175"><a href="/gostd/image/jpeg/writer.go.html#5137954">markerlen</a></span><span class="op" id="5138184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138187">for</span>&nbsp;<span class="ident" id="5138191">i</span><span class="op" id="5138192">,</span>&nbsp;<span class="ident" id="5138194">s</span>&nbsp;<span class="op" id="5138196">:=</span>&nbsp;<span class="keyword" id="5138199">range</span>&nbsp;<span class="ident" id="5138205"><a href="/gostd/image/jpeg/writer.go.html#5137970">specs</a></span>&nbsp;<span class="op" id="5138211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138215"><a href="/gostd/image/jpeg/writer.go.html#5137914">e</a></span><span class="op" id="5138216">.</span><span class="ident" id="5138217"><a href="/gostd/image/jpeg/writer.go.html#5135481">writeByte</a></span><span class="op" id="5138226">(</span><span class="string" id="5138227">&#34;\x00\x10\x01\x11&#34;</span><span class="op" id="5138245">[</span><span class="ident" id="5138246"><a href="/gostd/image/jpeg/writer.go.html#5138191">i</a></span><span class="op" id="5138247">]</span><span class="op" id="5138248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138252"><a href="/gostd/image/jpeg/writer.go.html#5137914">e</a></span><span class="op" id="5138253">.</span><span class="ident" id="5138254"><a href="/gostd/image/jpeg/writer.go.html#5135386">write</a></span><span class="op" id="5138259">(</span><span class="ident" id="5138260"><a href="/gostd/image/jpeg/writer.go.html#5138194">s</a></span><span class="op" id="5138261">.</span><span class="ident" id="5138262"><a href="/gostd/image/jpeg/writer.go.html#5131064">count</a></span><span class="op" id="5138267">[</span><span class="op" id="5138268">:</span><span class="op" id="5138269">]</span><span class="op" id="5138270">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138274"><a href="/gostd/image/jpeg/writer.go.html#5137914">e</a></span><span class="op" id="5138275">.</span><span class="ident" id="5138276"><a href="/gostd/image/jpeg/writer.go.html#5135386">write</a></span><span class="op" id="5138281">(</span><span class="ident" id="5138282"><a href="/gostd/image/jpeg/writer.go.html#5138194">s</a></span><span class="op" id="5138283">.</span><span class="ident" id="5138284"><a href="/gostd/image/jpeg/writer.go.html#5131136">value</a></span><span class="op" id="5138289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5138292">}</span><br>
<span class="lineno"></span><span class="op" id="5138294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5138297">//&nbsp;writeBlock&nbsp;writes&nbsp;a&nbsp;block&nbsp;of&nbsp;pixel&nbsp;data&nbsp;using&nbsp;the&nbsp;given&nbsp;quantization&nbsp;table,</span><br>
<span class="lineno">360</span><span class="comment" id="5138376">//&nbsp;returning&nbsp;the&nbsp;post-quantized&nbsp;DC&nbsp;value&nbsp;of&nbsp;the&nbsp;DCT-transformed&nbsp;block.&nbsp;b&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5138455">//&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order.</span><br>
<span class="lineno"></span><span class="keyword" id="5138487">func</span>&nbsp;<span class="op" id="5138492">(</span><span class="ident" id="5138493">e</span>&nbsp;<span class="op" id="5138495">*</span><span class="ident" id="5138496"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5138503">)</span>&nbsp;<span class="ident" id="5138505">writeBlock</span><span class="op" id="5138515">(</span><span class="ident" id="5138516">b</span>&nbsp;<span class="op" id="5138518">*</span><span class="ident" id="5138519"><a href="/gostd/image/jpeg/idct.go.html#5096709">block</a></span><span class="op" id="5138524">,</span>&nbsp;<span class="ident" id="5138526">q</span>&nbsp;<span class="ident" id="5138528"><a href="/gostd/image/jpeg/writer.go.html#5129783">quantIndex</a></span><span class="op" id="5138538">,</span>&nbsp;<span class="ident" id="5138540">prevDC</span>&nbsp;<span class="builtintype" id="5138547">int32</span><span class="op" id="5138552">)</span>&nbsp;<span class="builtintype" id="5138554">int32</span>&nbsp;<span class="op" id="5138560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138563"><a href="/gostd/image/jpeg/fdct.go.html#5085719">fdct</a></span><span class="op" id="5138567">(</span><span class="ident" id="5138568"><a href="/gostd/image/jpeg/writer.go.html#5138516">b</a></span><span class="op" id="5138569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5138572">//&nbsp;Emit&nbsp;the&nbsp;DC&nbsp;delta.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138595">dc</span>&nbsp;<span class="op" id="5138598">:=</span>&nbsp;<span class="ident" id="5138601"><a href="/gostd/image/jpeg/writer.go.html#5128798">div</a></span><span class="op" id="5138604">(</span><span class="ident" id="5138605"><a href="/gostd/image/jpeg/writer.go.html#5138516">b</a></span><span class="op" id="5138606">[</span><span class="num" id="5138607">0</span><span class="op" id="5138608">]</span><span class="op" id="5138609">,</span>&nbsp;<span class="num" id="5138611">8</span><span class="op" id="5138612">*</span><span class="builtintype" id="5138613">int32</span><span class="op" id="5138618">(</span><span class="ident" id="5138619"><a href="/gostd/image/jpeg/writer.go.html#5138493">e</a></span><span class="op" id="5138620">.</span><span class="ident" id="5138621"><a href="/gostd/image/jpeg/writer.go.html#5135247">quant</a></span><span class="op" id="5138626">[</span><span class="ident" id="5138627"><a href="/gostd/image/jpeg/writer.go.html#5138526">q</a></span><span class="op" id="5138628">]</span><span class="op" id="5138629">[</span><span class="num" id="5138630">0</span><span class="op" id="5138631">]</span><span class="op" id="5138632">)</span><span class="op" id="5138633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138636"><a href="/gostd/image/jpeg/writer.go.html#5138493">e</a></span><span class="op" id="5138637">.</span><span class="ident" id="5138638"><a href="/gostd/image/jpeg/writer.go.html#5136254">emitHuffRLE</a></span><span class="op" id="5138649">(</span><span class="ident" id="5138650"><a href="/gostd/image/jpeg/writer.go.html#5130791">huffIndex</a></span><span class="op" id="5138659">(</span><span class="num" id="5138660">2</span><span class="op" id="5138661">*</span><span class="ident" id="5138662"><a href="/gostd/image/jpeg/writer.go.html#5138526">q</a></span><span class="op" id="5138663">+</span><span class="num" id="5138664">0</span><span class="op" id="5138665">)</span><span class="op" id="5138666">,</span>&nbsp;<span class="num" id="5138668">0</span><span class="op" id="5138669">,</span>&nbsp;<span class="ident" id="5138671"><a href="/gostd/image/jpeg/writer.go.html#5138595">dc</a></span><span class="op" id="5138673">-</span><span class="ident" id="5138674"><a href="/gostd/image/jpeg/writer.go.html#5138540">prevDC</a></span><span class="op" id="5138680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5138683">//&nbsp;Emit&nbsp;the&nbsp;AC&nbsp;components.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138711">h</span><span class="op" id="5138712">,</span>&nbsp;<span class="ident" id="5138714">runLength</span>&nbsp;<span class="op" id="5138724">:=</span>&nbsp;<span class="ident" id="5138727"><a href="/gostd/image/jpeg/writer.go.html#5130791">huffIndex</a></span><span class="op" id="5138736">(</span><span class="num" id="5138737">2</span><span class="op" id="5138738">*</span><span class="ident" id="5138739"><a href="/gostd/image/jpeg/writer.go.html#5138526">q</a></span><span class="op" id="5138740">+</span><span class="num" id="5138741">1</span><span class="op" id="5138742">)</span><span class="op" id="5138743">,</span>&nbsp;<span class="builtintype" id="5138745">int32</span><span class="op" id="5138750">(</span><span class="num" id="5138751">0</span><span class="op" id="5138752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138755">for</span>&nbsp;<span class="ident" id="5138759">zig</span>&nbsp;<span class="op" id="5138763">:=</span>&nbsp;<span class="num" id="5138766">1</span><span class="op" id="5138767">;</span>&nbsp;<span class="ident" id="5138769"><a href="/gostd/image/jpeg/writer.go.html#5138759">zig</a></span>&nbsp;<span class="op" id="5138773">&lt;</span>&nbsp;<span class="ident" id="5138775"><a href="/gostd/image/jpeg/idct.go.html#5096665">blockSize</a></span><span class="op" id="5138784">;</span>&nbsp;<span class="ident" id="5138786"><a href="/gostd/image/jpeg/writer.go.html#5138759">zig</a></span><span class="op" id="5138789">++</span>&nbsp;<span class="op" id="5138792">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138796">ac</span>&nbsp;<span class="op" id="5138799">:=</span>&nbsp;<span class="ident" id="5138802"><a href="/gostd/image/jpeg/writer.go.html#5128798">div</a></span><span class="op" id="5138805">(</span><span class="ident" id="5138806"><a href="/gostd/image/jpeg/writer.go.html#5138516">b</a></span><span class="op" id="5138807">[</span><span class="ident" id="5138808"><a href="/gostd/image/jpeg/reader.go.html#5102573">unzig</a></span><span class="op" id="5138813">[</span><span class="ident" id="5138814"><a href="/gostd/image/jpeg/writer.go.html#5138759">zig</a></span><span class="op" id="5138817">]</span><span class="op" id="5138818">]</span><span class="op" id="5138819">,</span>&nbsp;<span class="num" id="5138821">8</span><span class="op" id="5138822">*</span><span class="builtintype" id="5138823">int32</span><span class="op" id="5138828">(</span><span class="ident" id="5138829"><a href="/gostd/image/jpeg/writer.go.html#5138493">e</a></span><span class="op" id="5138830">.</span><span class="ident" id="5138831"><a href="/gostd/image/jpeg/writer.go.html#5135247">quant</a></span><span class="op" id="5138836">[</span><span class="ident" id="5138837"><a href="/gostd/image/jpeg/writer.go.html#5138526">q</a></span><span class="op" id="5138838">]</span><span class="op" id="5138839">[</span><span class="ident" id="5138840"><a href="/gostd/image/jpeg/writer.go.html#5138759">zig</a></span><span class="op" id="5138843">]</span><span class="op" id="5138844">)</span><span class="op" id="5138845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138849">if</span>&nbsp;<span class="ident" id="5138852"><a href="/gostd/image/jpeg/writer.go.html#5138796">ac</a></span>&nbsp;<span class="op" id="5138855">==</span>&nbsp;<span class="num" id="5138858">0</span>&nbsp;<span class="op" id="5138860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138865"><a href="/gostd/image/jpeg/writer.go.html#5138714">runLength</a></span><span class="op" id="5138874">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5138879">}</span>&nbsp;<span class="keyword" id="5138881">else</span>&nbsp;<span class="op" id="5138886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138891">for</span>&nbsp;<span class="ident" id="5138895"><a href="/gostd/image/jpeg/writer.go.html#5138714">runLength</a></span>&nbsp;<span class="op" id="5138905">&gt;</span>&nbsp;<span class="num" id="5138907">15</span>&nbsp;<span class="op" id="5138910">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138916"><a href="/gostd/image/jpeg/writer.go.html#5138493">e</a></span><span class="op" id="5138917">.</span><span class="ident" id="5138918"><a href="/gostd/image/jpeg/writer.go.html#5136039">emitHuff</a></span><span class="op" id="5138926">(</span><span class="ident" id="5138927"><a href="/gostd/image/jpeg/writer.go.html#5138711">h</a></span><span class="op" id="5138928">,</span>&nbsp;<span class="num" id="5138930">0xf0</span><span class="op" id="5138934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138940"><a href="/gostd/image/jpeg/writer.go.html#5138714">runLength</a></span>&nbsp;<span class="op" id="5138950">-=</span>&nbsp;<span class="num" id="5138953">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5138959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138964"><a href="/gostd/image/jpeg/writer.go.html#5138493">e</a></span><span class="op" id="5138965">.</span><span class="ident" id="5138966"><a href="/gostd/image/jpeg/writer.go.html#5136254">emitHuffRLE</a></span><span class="op" id="5138977">(</span><span class="ident" id="5138978"><a href="/gostd/image/jpeg/writer.go.html#5138711">h</a></span><span class="op" id="5138979">,</span>&nbsp;<span class="ident" id="5138981"><a href="/gostd/image/jpeg/writer.go.html#5138714">runLength</a></span><span class="op" id="5138990">,</span>&nbsp;<span class="ident" id="5138992"><a href="/gostd/image/jpeg/writer.go.html#5138796">ac</a></span><span class="op" id="5138994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138999"><a href="/gostd/image/jpeg/writer.go.html#5138714">runLength</a></span>&nbsp;<span class="op" id="5139009">=</span>&nbsp;<span class="num" id="5139011">0</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139021">if</span>&nbsp;<span class="ident" id="5139024"><a href="/gostd/image/jpeg/writer.go.html#5138714">runLength</a></span>&nbsp;<span class="op" id="5139034">&gt;</span>&nbsp;<span class="num" id="5139036">0</span>&nbsp;<span class="op" id="5139038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139042"><a href="/gostd/image/jpeg/writer.go.html#5138493">e</a></span><span class="op" id="5139043">.</span><span class="ident" id="5139044"><a href="/gostd/image/jpeg/writer.go.html#5136039">emitHuff</a></span><span class="op" id="5139052">(</span><span class="ident" id="5139053"><a href="/gostd/image/jpeg/writer.go.html#5138711">h</a></span><span class="op" id="5139054">,</span>&nbsp;<span class="num" id="5139056">0x00</span><span class="op" id="5139060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139063">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139066">return</span>&nbsp;<span class="ident" id="5139073"><a href="/gostd/image/jpeg/writer.go.html#5138595">dc</a></span><br>
<span class="lineno"></span><span class="op" id="5139076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5139079">//&nbsp;toYCbCr&nbsp;converts&nbsp;the&nbsp;8x8&nbsp;region&nbsp;of&nbsp;m&nbsp;whose&nbsp;top-left&nbsp;corner&nbsp;is&nbsp;p&nbsp;to&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5139153">//&nbsp;YCbCr&nbsp;values.</span><br>
<span class="lineno">390</span><span class="keyword" id="5139170">func</span>&nbsp;<span class="ident" id="5139175">toYCbCr</span><span class="op" id="5139182">(</span><span class="ident" id="5139183">m</span>&nbsp;<span class="ident" id="5139185"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5139190">.</span><span class="ident" id="5139191"><a href="/gostd/image/image.go.html#5154907">Image</a></span><span class="op" id="5139196">,</span>&nbsp;<span class="ident" id="5139198">p</span>&nbsp;<span class="ident" id="5139200"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5139205">.</span><span class="ident" id="5139206"><a href="/gostd/image/geom.go.html#5148435">Point</a></span><span class="op" id="5139211">,</span>&nbsp;<span class="ident" id="5139213">yBlock</span><span class="op" id="5139219">,</span>&nbsp;<span class="ident" id="5139221">cbBlock</span><span class="op" id="5139228">,</span>&nbsp;<span class="ident" id="5139230">crBlock</span>&nbsp;<span class="op" id="5139238">*</span><span class="ident" id="5139239"><a href="/gostd/image/jpeg/idct.go.html#5096709">block</a></span><span class="op" id="5139244">)</span>&nbsp;<span class="op" id="5139246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139249">b</span>&nbsp;<span class="op" id="5139251">:=</span>&nbsp;<span class="ident" id="5139254"><a href="/gostd/image/jpeg/writer.go.html#5139183">m</a></span><span class="op" id="5139255">.</span><span class="ident" id="5139256"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="5139262">(</span><span class="op" id="5139263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139266">xmax</span>&nbsp;<span class="op" id="5139271">:=</span>&nbsp;<span class="ident" id="5139274"><a href="/gostd/image/jpeg/writer.go.html#5139249">b</a></span><span class="op" id="5139275">.</span><span class="ident" id="5139276"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="5139279">.</span><span class="ident" id="5139280"><a href="/gostd/image/geom.go.html#5148451">X</a></span>&nbsp;<span class="op" id="5139282">-</span>&nbsp;<span class="num" id="5139284">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139287">ymax</span>&nbsp;<span class="op" id="5139292">:=</span>&nbsp;<span class="ident" id="5139295"><a href="/gostd/image/jpeg/writer.go.html#5139249">b</a></span><span class="op" id="5139296">.</span><span class="ident" id="5139297"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="5139300">.</span><span class="ident" id="5139301"><a href="/gostd/image/geom.go.html#5148454">Y</a></span>&nbsp;<span class="op" id="5139303">-</span>&nbsp;<span class="num" id="5139305">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139308">for</span>&nbsp;<span class="ident" id="5139312">j</span>&nbsp;<span class="op" id="5139314">:=</span>&nbsp;<span class="num" id="5139317">0</span><span class="op" id="5139318">;</span>&nbsp;<span class="ident" id="5139320"><a href="/gostd/image/jpeg/writer.go.html#5139312">j</a></span>&nbsp;<span class="op" id="5139322">&lt;</span>&nbsp;<span class="num" id="5139324">8</span><span class="op" id="5139325">;</span>&nbsp;<span class="ident" id="5139327"><a href="/gostd/image/jpeg/writer.go.html#5139312">j</a></span><span class="op" id="5139328">++</span>&nbsp;<span class="op" id="5139331">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139335">for</span>&nbsp;<span class="ident" id="5139339">i</span>&nbsp;<span class="op" id="5139341">:=</span>&nbsp;<span class="num" id="5139344">0</span><span class="op" id="5139345">;</span>&nbsp;<span class="ident" id="5139347"><a href="/gostd/image/jpeg/writer.go.html#5139339">i</a></span>&nbsp;<span class="op" id="5139349">&lt;</span>&nbsp;<span class="num" id="5139351">8</span><span class="op" id="5139352">;</span>&nbsp;<span class="ident" id="5139354"><a href="/gostd/image/jpeg/writer.go.html#5139339">i</a></span><span class="op" id="5139355">++</span>&nbsp;<span class="op" id="5139358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139363">r</span><span class="op" id="5139364">,</span>&nbsp;<span class="ident" id="5139366">g</span><span class="op" id="5139367">,</span>&nbsp;<span class="ident" id="5139369">b</span><span class="op" id="5139370">,</span>&nbsp;<span class="ident" id="5139372">_</span>&nbsp;<span class="op" id="5139374">:=</span>&nbsp;<span class="ident" id="5139377"><a href="/gostd/image/jpeg/writer.go.html#5139183">m</a></span><span class="op" id="5139378">.</span><span class="ident" id="5139379"><a href="/gostd/image/image.go.html#5155352">At</a></span><span class="op" id="5139381">(</span><span class="ident" id="5139382"><a href="/gostd/image/jpeg/writer.go.html#5128655">min</a></span><span class="op" id="5139385">(</span><span class="ident" id="5139386"><a href="/gostd/image/jpeg/writer.go.html#5139198">p</a></span><span class="op" id="5139387">.</span><span class="ident" id="5139388"><a href="/gostd/image/geom.go.html#5148451">X</a></span><span class="op" id="5139389">+</span><span class="ident" id="5139390"><a href="/gostd/image/jpeg/writer.go.html#5139339">i</a></span><span class="op" id="5139391">,</span>&nbsp;<span class="ident" id="5139393"><a href="/gostd/image/jpeg/writer.go.html#5139266">xmax</a></span><span class="op" id="5139397">)</span><span class="op" id="5139398">,</span>&nbsp;<span class="ident" id="5139400"><a href="/gostd/image/jpeg/writer.go.html#5128655">min</a></span><span class="op" id="5139403">(</span><span class="ident" id="5139404"><a href="/gostd/image/jpeg/writer.go.html#5139198">p</a></span><span class="op" id="5139405">.</span><span class="ident" id="5139406"><a href="/gostd/image/geom.go.html#5148454">Y</a></span><span class="op" id="5139407">+</span><span class="ident" id="5139408"><a href="/gostd/image/jpeg/writer.go.html#5139312">j</a></span><span class="op" id="5139409">,</span>&nbsp;<span class="ident" id="5139411"><a href="/gostd/image/jpeg/writer.go.html#5139287">ymax</a></span><span class="op" id="5139415">)</span><span class="op" id="5139416">)</span><span class="op" id="5139417">.</span><span class="ident" id="5139418"><a href="/gostd/image/color/color.go.html#5185453">RGBA</a></span><span class="op" id="5139422">(</span><span class="op" id="5139423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139428">yy</span><span class="op" id="5139430">,</span>&nbsp;<span class="ident" id="5139432">cb</span><span class="op" id="5139434">,</span>&nbsp;<span class="ident" id="5139436">cr</span>&nbsp;<span class="op" id="5139439">:=</span>&nbsp;<span class="ident" id="5139442"><a href="/gostd/image/jpeg/writer.go.html#5128583">color</a></span><span class="op" id="5139447">.</span><span class="ident" id="5139448"><a href="/gostd/image/color/ycbcr.go.html#5191752">RGBToYCbCr</a></span><span class="op" id="5139458">(</span><span class="builtintype" id="5139459">uint8</span><span class="op" id="5139464">(</span><span class="ident" id="5139465"><a href="/gostd/image/jpeg/writer.go.html#5139363">r</a></span><span class="op" id="5139466">&gt;&gt;</span><span class="num" id="5139468">8</span><span class="op" id="5139469">)</span><span class="op" id="5139470">,</span>&nbsp;<span class="builtintype" id="5139472">uint8</span><span class="op" id="5139477">(</span><span class="ident" id="5139478"><a href="/gostd/image/jpeg/writer.go.html#5139366">g</a></span><span class="op" id="5139479">&gt;&gt;</span><span class="num" id="5139481">8</span><span class="op" id="5139482">)</span><span class="op" id="5139483">,</span>&nbsp;<span class="builtintype" id="5139485">uint8</span><span class="op" id="5139490">(</span><span class="ident" id="5139491"><a href="/gostd/image/jpeg/writer.go.html#5139369">b</a></span><span class="op" id="5139492">&gt;&gt;</span><span class="num" id="5139494">8</span><span class="op" id="5139495">)</span><span class="op" id="5139496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139501"><a href="/gostd/image/jpeg/writer.go.html#5139213">yBlock</a></span><span class="op" id="5139507">[</span><span class="num" id="5139508">8</span><span class="op" id="5139509">*</span><span class="ident" id="5139510"><a href="/gostd/image/jpeg/writer.go.html#5139312">j</a></span><span class="op" id="5139511">+</span><span class="ident" id="5139512"><a href="/gostd/image/jpeg/writer.go.html#5139339">i</a></span><span class="op" id="5139513">]</span>&nbsp;<span class="op" id="5139515">=</span>&nbsp;<span class="builtintype" id="5139517">int32</span><span class="op" id="5139522">(</span><span class="ident" id="5139523"><a href="/gostd/image/jpeg/writer.go.html#5139428">yy</a></span><span class="op" id="5139525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139530"><a href="/gostd/image/jpeg/writer.go.html#5139221">cbBlock</a></span><span class="op" id="5139537">[</span><span class="num" id="5139538">8</span><span class="op" id="5139539">*</span><span class="ident" id="5139540"><a href="/gostd/image/jpeg/writer.go.html#5139312">j</a></span><span class="op" id="5139541">+</span><span class="ident" id="5139542"><a href="/gostd/image/jpeg/writer.go.html#5139339">i</a></span><span class="op" id="5139543">]</span>&nbsp;<span class="op" id="5139545">=</span>&nbsp;<span class="builtintype" id="5139547">int32</span><span class="op" id="5139552">(</span><span class="ident" id="5139553"><a href="/gostd/image/jpeg/writer.go.html#5139432">cb</a></span><span class="op" id="5139555">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139560"><a href="/gostd/image/jpeg/writer.go.html#5139230">crBlock</a></span><span class="op" id="5139567">[</span><span class="num" id="5139568">8</span><span class="op" id="5139569">*</span><span class="ident" id="5139570"><a href="/gostd/image/jpeg/writer.go.html#5139312">j</a></span><span class="op" id="5139571">+</span><span class="ident" id="5139572"><a href="/gostd/image/jpeg/writer.go.html#5139339">i</a></span><span class="op" id="5139573">]</span>&nbsp;<span class="op" id="5139575">=</span>&nbsp;<span class="builtintype" id="5139577">int32</span><span class="op" id="5139582">(</span><span class="ident" id="5139583"><a href="/gostd/image/jpeg/writer.go.html#5139436">cr</a></span><span class="op" id="5139585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139592">}</span><br>
<span class="lineno"></span><span class="op" id="5139594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="5139597">//&nbsp;grayToY&nbsp;stores&nbsp;the&nbsp;8x8&nbsp;region&nbsp;of&nbsp;m&nbsp;whose&nbsp;top-left&nbsp;corner&nbsp;is&nbsp;p&nbsp;in&nbsp;yBlock.</span><br>
<span class="lineno"></span><span class="keyword" id="5139673">func</span>&nbsp;<span class="ident" id="5139678">grayToY</span><span class="op" id="5139685">(</span><span class="ident" id="5139686">m</span>&nbsp;<span class="op" id="5139688">*</span><span class="ident" id="5139689"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5139694">.</span><span class="ident" id="5139695"><a href="/gostd/image/image.go.html#5172029">Gray</a></span><span class="op" id="5139699">,</span>&nbsp;<span class="ident" id="5139701">p</span>&nbsp;<span class="ident" id="5139703"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5139708">.</span><span class="ident" id="5139709"><a href="/gostd/image/geom.go.html#5148435">Point</a></span><span class="op" id="5139714">,</span>&nbsp;<span class="ident" id="5139716">yBlock</span>&nbsp;<span class="op" id="5139723">*</span><span class="ident" id="5139724"><a href="/gostd/image/jpeg/idct.go.html#5096709">block</a></span><span class="op" id="5139729">)</span>&nbsp;<span class="op" id="5139731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139734">b</span>&nbsp;<span class="op" id="5139736">:=</span>&nbsp;<span class="ident" id="5139739"><a href="/gostd/image/jpeg/writer.go.html#5139686">m</a></span><span class="op" id="5139740">.</span><span class="ident" id="5139741"><a href="/gostd/image/image.go.html#5172409">Bounds</a></span><span class="op" id="5139747">(</span><span class="op" id="5139748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139751">xmax</span>&nbsp;<span class="op" id="5139756">:=</span>&nbsp;<span class="ident" id="5139759"><a href="/gostd/image/jpeg/writer.go.html#5139734">b</a></span><span class="op" id="5139760">.</span><span class="ident" id="5139761"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="5139764">.</span><span class="ident" id="5139765"><a href="/gostd/image/geom.go.html#5148451">X</a></span>&nbsp;<span class="op" id="5139767">-</span>&nbsp;<span class="num" id="5139769">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139772">ymax</span>&nbsp;<span class="op" id="5139777">:=</span>&nbsp;<span class="ident" id="5139780"><a href="/gostd/image/jpeg/writer.go.html#5139734">b</a></span><span class="op" id="5139781">.</span><span class="ident" id="5139782"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="5139785">.</span><span class="ident" id="5139786"><a href="/gostd/image/geom.go.html#5148454">Y</a></span>&nbsp;<span class="op" id="5139788">-</span>&nbsp;<span class="num" id="5139790">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139793">pix</span>&nbsp;<span class="op" id="5139797">:=</span>&nbsp;<span class="ident" id="5139800"><a href="/gostd/image/jpeg/writer.go.html#5139686">m</a></span><span class="op" id="5139801">.</span><span class="ident" id="5139802"><a href="/gostd/image/image.go.html#5172175">Pix</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139807">for</span>&nbsp;<span class="ident" id="5139811">j</span>&nbsp;<span class="op" id="5139813">:=</span>&nbsp;<span class="num" id="5139816">0</span><span class="op" id="5139817">;</span>&nbsp;<span class="ident" id="5139819"><a href="/gostd/image/jpeg/writer.go.html#5139811">j</a></span>&nbsp;<span class="op" id="5139821">&lt;</span>&nbsp;<span class="num" id="5139823">8</span><span class="op" id="5139824">;</span>&nbsp;<span class="ident" id="5139826"><a href="/gostd/image/jpeg/writer.go.html#5139811">j</a></span><span class="op" id="5139827">++</span>&nbsp;<span class="op" id="5139830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139834">for</span>&nbsp;<span class="ident" id="5139838">i</span>&nbsp;<span class="op" id="5139840">:=</span>&nbsp;<span class="num" id="5139843">0</span><span class="op" id="5139844">;</span>&nbsp;<span class="ident" id="5139846"><a href="/gostd/image/jpeg/writer.go.html#5139838">i</a></span>&nbsp;<span class="op" id="5139848">&lt;</span>&nbsp;<span class="num" id="5139850">8</span><span class="op" id="5139851">;</span>&nbsp;<span class="ident" id="5139853"><a href="/gostd/image/jpeg/writer.go.html#5139838">i</a></span><span class="op" id="5139854">++</span>&nbsp;<span class="op" id="5139857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139862">idx</span>&nbsp;<span class="op" id="5139866">:=</span>&nbsp;<span class="ident" id="5139869"><a href="/gostd/image/jpeg/writer.go.html#5139686">m</a></span><span class="op" id="5139870">.</span><span class="ident" id="5139871"><a href="/gostd/image/image.go.html#5172791">PixOffset</a></span><span class="op" id="5139880">(</span><span class="ident" id="5139881"><a href="/gostd/image/jpeg/writer.go.html#5128655">min</a></span><span class="op" id="5139884">(</span><span class="ident" id="5139885"><a href="/gostd/image/jpeg/writer.go.html#5139701">p</a></span><span class="op" id="5139886">.</span><span class="ident" id="5139887"><a href="/gostd/image/geom.go.html#5148451">X</a></span><span class="op" id="5139888">+</span><span class="ident" id="5139889"><a href="/gostd/image/jpeg/writer.go.html#5139838">i</a></span><span class="op" id="5139890">,</span>&nbsp;<span class="ident" id="5139892"><a href="/gostd/image/jpeg/writer.go.html#5139751">xmax</a></span><span class="op" id="5139896">)</span><span class="op" id="5139897">,</span>&nbsp;<span class="ident" id="5139899"><a href="/gostd/image/jpeg/writer.go.html#5128655">min</a></span><span class="op" id="5139902">(</span><span class="ident" id="5139903"><a href="/gostd/image/jpeg/writer.go.html#5139701">p</a></span><span class="op" id="5139904">.</span><span class="ident" id="5139905"><a href="/gostd/image/geom.go.html#5148454">Y</a></span><span class="op" id="5139906">+</span><span class="ident" id="5139907"><a href="/gostd/image/jpeg/writer.go.html#5139811">j</a></span><span class="op" id="5139908">,</span>&nbsp;<span class="ident" id="5139910"><a href="/gostd/image/jpeg/writer.go.html#5139772">ymax</a></span><span class="op" id="5139914">)</span><span class="op" id="5139915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139920"><a href="/gostd/image/jpeg/writer.go.html#5139716">yBlock</a></span><span class="op" id="5139926">[</span><span class="num" id="5139927">8</span><span class="op" id="5139928">*</span><span class="ident" id="5139929"><a href="/gostd/image/jpeg/writer.go.html#5139811">j</a></span><span class="op" id="5139930">+</span><span class="ident" id="5139931"><a href="/gostd/image/jpeg/writer.go.html#5139838">i</a></span><span class="op" id="5139932">]</span>&nbsp;<span class="op" id="5139934">=</span>&nbsp;<span class="builtintype" id="5139936">int32</span><span class="op" id="5139941">(</span><span class="ident" id="5139942"><a href="/gostd/image/jpeg/writer.go.html#5139793">pix</a></span><span class="op" id="5139945">[</span><span class="ident" id="5139946"><a href="/gostd/image/jpeg/writer.go.html#5139862">idx</a></span><span class="op" id="5139949">]</span><span class="op" id="5139950">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139957">}</span><br>
<span class="lineno"></span><span class="op" id="5139959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5139962">//&nbsp;rgbaToYCbCr&nbsp;is&nbsp;a&nbsp;specialized&nbsp;version&nbsp;of&nbsp;toYCbCr&nbsp;for&nbsp;image.RGBA&nbsp;images.</span><br>
<span class="lineno">420</span><span class="keyword" id="5140036">func</span>&nbsp;<span class="ident" id="5140041">rgbaToYCbCr</span><span class="op" id="5140052">(</span><span class="ident" id="5140053">m</span>&nbsp;<span class="op" id="5140055">*</span><span class="ident" id="5140056"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5140061">.</span><span class="ident" id="5140062"><a href="/gostd/image/image.go.html#5155914">RGBA</a></span><span class="op" id="5140066">,</span>&nbsp;<span class="ident" id="5140068">p</span>&nbsp;<span class="ident" id="5140070"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5140075">.</span><span class="ident" id="5140076"><a href="/gostd/image/geom.go.html#5148435">Point</a></span><span class="op" id="5140081">,</span>&nbsp;<span class="ident" id="5140083">yBlock</span><span class="op" id="5140089">,</span>&nbsp;<span class="ident" id="5140091">cbBlock</span><span class="op" id="5140098">,</span>&nbsp;<span class="ident" id="5140100">crBlock</span>&nbsp;<span class="op" id="5140108">*</span><span class="ident" id="5140109"><a href="/gostd/image/jpeg/idct.go.html#5096709">block</a></span><span class="op" id="5140114">)</span>&nbsp;<span class="op" id="5140116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140119">b</span>&nbsp;<span class="op" id="5140121">:=</span>&nbsp;<span class="ident" id="5140124"><a href="/gostd/image/jpeg/writer.go.html#5140053">m</a></span><span class="op" id="5140125">.</span><span class="ident" id="5140126"><a href="/gostd/image/image.go.html#5156299">Bounds</a></span><span class="op" id="5140132">(</span><span class="op" id="5140133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140136">xmax</span>&nbsp;<span class="op" id="5140141">:=</span>&nbsp;<span class="ident" id="5140144"><a href="/gostd/image/jpeg/writer.go.html#5140119">b</a></span><span class="op" id="5140145">.</span><span class="ident" id="5140146"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="5140149">.</span><span class="ident" id="5140150"><a href="/gostd/image/geom.go.html#5148451">X</a></span>&nbsp;<span class="op" id="5140152">-</span>&nbsp;<span class="num" id="5140154">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140157">ymax</span>&nbsp;<span class="op" id="5140162">:=</span>&nbsp;<span class="ident" id="5140165"><a href="/gostd/image/jpeg/writer.go.html#5140119">b</a></span><span class="op" id="5140166">.</span><span class="ident" id="5140167"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="5140170">.</span><span class="ident" id="5140171"><a href="/gostd/image/geom.go.html#5148454">Y</a></span>&nbsp;<span class="op" id="5140173">-</span>&nbsp;<span class="num" id="5140175">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140178">for</span>&nbsp;<span class="ident" id="5140182">j</span>&nbsp;<span class="op" id="5140184">:=</span>&nbsp;<span class="num" id="5140187">0</span><span class="op" id="5140188">;</span>&nbsp;<span class="ident" id="5140190"><a href="/gostd/image/jpeg/writer.go.html#5140182">j</a></span>&nbsp;<span class="op" id="5140192">&lt;</span>&nbsp;<span class="num" id="5140194">8</span><span class="op" id="5140195">;</span>&nbsp;<span class="ident" id="5140197"><a href="/gostd/image/jpeg/writer.go.html#5140182">j</a></span><span class="op" id="5140198">++</span>&nbsp;<span class="op" id="5140201">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140205">sj</span>&nbsp;<span class="op" id="5140208">:=</span>&nbsp;<span class="ident" id="5140211"><a href="/gostd/image/jpeg/writer.go.html#5140068">p</a></span><span class="op" id="5140212">.</span><span class="ident" id="5140213"><a href="/gostd/image/geom.go.html#5148454">Y</a></span>&nbsp;<span class="op" id="5140215">+</span>&nbsp;<span class="ident" id="5140217"><a href="/gostd/image/jpeg/writer.go.html#5140182">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140221">if</span>&nbsp;<span class="ident" id="5140224"><a href="/gostd/image/jpeg/writer.go.html#5140205">sj</a></span>&nbsp;<span class="op" id="5140227">&gt;</span>&nbsp;<span class="ident" id="5140229"><a href="/gostd/image/jpeg/writer.go.html#5140157">ymax</a></span>&nbsp;<span class="op" id="5140234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140239"><a href="/gostd/image/jpeg/writer.go.html#5140205">sj</a></span>&nbsp;<span class="op" id="5140242">=</span>&nbsp;<span class="ident" id="5140244"><a href="/gostd/image/jpeg/writer.go.html#5140157">ymax</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140255">offset</span>&nbsp;<span class="op" id="5140262">:=</span>&nbsp;<span class="op" id="5140265">(</span><span class="ident" id="5140266"><a href="/gostd/image/jpeg/writer.go.html#5140205">sj</a></span><span class="op" id="5140268">-</span><span class="ident" id="5140269"><a href="/gostd/image/jpeg/writer.go.html#5140119">b</a></span><span class="op" id="5140270">.</span><span class="ident" id="5140271"><a href="/gostd/image/geom.go.html#5150016">Min</a></span><span class="op" id="5140274">.</span><span class="ident" id="5140275"><a href="/gostd/image/geom.go.html#5148454">Y</a></span><span class="op" id="5140276">)</span><span class="op" id="5140277">*</span><span class="ident" id="5140278"><a href="/gostd/image/jpeg/writer.go.html#5140053">m</a></span><span class="op" id="5140279">.</span><span class="ident" id="5140280"><a href="/gostd/image/image.go.html#5156154">Stride</a></span>&nbsp;<span class="op" id="5140287">-</span>&nbsp;<span class="ident" id="5140289"><a href="/gostd/image/jpeg/writer.go.html#5140119">b</a></span><span class="op" id="5140290">.</span><span class="ident" id="5140291"><a href="/gostd/image/geom.go.html#5150016">Min</a></span><span class="op" id="5140294">.</span><span class="ident" id="5140295"><a href="/gostd/image/geom.go.html#5148451">X</a></span><span class="op" id="5140296">*</span><span class="num" id="5140297">4</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140301">for</span>&nbsp;<span class="ident" id="5140305">i</span>&nbsp;<span class="op" id="5140307">:=</span>&nbsp;<span class="num" id="5140310">0</span><span class="op" id="5140311">;</span>&nbsp;<span class="ident" id="5140313"><a href="/gostd/image/jpeg/writer.go.html#5140305">i</a></span>&nbsp;<span class="op" id="5140315">&lt;</span>&nbsp;<span class="num" id="5140317">8</span><span class="op" id="5140318">;</span>&nbsp;<span class="ident" id="5140320"><a href="/gostd/image/jpeg/writer.go.html#5140305">i</a></span><span class="op" id="5140321">++</span>&nbsp;<span class="op" id="5140324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140329">sx</span>&nbsp;<span class="op" id="5140332">:=</span>&nbsp;<span class="ident" id="5140335"><a href="/gostd/image/jpeg/writer.go.html#5140068">p</a></span><span class="op" id="5140336">.</span><span class="ident" id="5140337"><a href="/gostd/image/geom.go.html#5148451">X</a></span>&nbsp;<span class="op" id="5140339">+</span>&nbsp;<span class="ident" id="5140341"><a href="/gostd/image/jpeg/writer.go.html#5140305">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140346">if</span>&nbsp;<span class="ident" id="5140349"><a href="/gostd/image/jpeg/writer.go.html#5140329">sx</a></span>&nbsp;<span class="op" id="5140352">&gt;</span>&nbsp;<span class="ident" id="5140354"><a href="/gostd/image/jpeg/writer.go.html#5140136">xmax</a></span>&nbsp;<span class="op" id="5140359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140365"><a href="/gostd/image/jpeg/writer.go.html#5140329">sx</a></span>&nbsp;<span class="op" id="5140368">=</span>&nbsp;<span class="ident" id="5140370"><a href="/gostd/image/jpeg/writer.go.html#5140136">xmax</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140378">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140383">pix</span>&nbsp;<span class="op" id="5140387">:=</span>&nbsp;<span class="ident" id="5140390"><a href="/gostd/image/jpeg/writer.go.html#5140053">m</a></span><span class="op" id="5140391">.</span><span class="ident" id="5140392"><a href="/gostd/image/image.go.html#5156065">Pix</a></span><span class="op" id="5140395">[</span><span class="ident" id="5140396"><a href="/gostd/image/jpeg/writer.go.html#5140255">offset</a></span><span class="op" id="5140402">+</span><span class="ident" id="5140403"><a href="/gostd/image/jpeg/writer.go.html#5140329">sx</a></span><span class="op" id="5140405">*</span><span class="num" id="5140406">4</span><span class="op" id="5140407">:</span><span class="op" id="5140408">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140413">yy</span><span class="op" id="5140415">,</span>&nbsp;<span class="ident" id="5140417">cb</span><span class="op" id="5140419">,</span>&nbsp;<span class="ident" id="5140421">cr</span>&nbsp;<span class="op" id="5140424">:=</span>&nbsp;<span class="ident" id="5140427"><a href="/gostd/image/jpeg/writer.go.html#5128583">color</a></span><span class="op" id="5140432">.</span><span class="ident" id="5140433"><a href="/gostd/image/color/ycbcr.go.html#5191752">RGBToYCbCr</a></span><span class="op" id="5140443">(</span><span class="ident" id="5140444"><a href="/gostd/image/jpeg/writer.go.html#5140383">pix</a></span><span class="op" id="5140447">[</span><span class="num" id="5140448">0</span><span class="op" id="5140449">]</span><span class="op" id="5140450">,</span>&nbsp;<span class="ident" id="5140452"><a href="/gostd/image/jpeg/writer.go.html#5140383">pix</a></span><span class="op" id="5140455">[</span><span class="num" id="5140456">1</span><span class="op" id="5140457">]</span><span class="op" id="5140458">,</span>&nbsp;<span class="ident" id="5140460"><a href="/gostd/image/jpeg/writer.go.html#5140383">pix</a></span><span class="op" id="5140463">[</span><span class="num" id="5140464">2</span><span class="op" id="5140465">]</span><span class="op" id="5140466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140471"><a href="/gostd/image/jpeg/writer.go.html#5140083">yBlock</a></span><span class="op" id="5140477">[</span><span class="num" id="5140478">8</span><span class="op" id="5140479">*</span><span class="ident" id="5140480"><a href="/gostd/image/jpeg/writer.go.html#5140182">j</a></span><span class="op" id="5140481">+</span><span class="ident" id="5140482"><a href="/gostd/image/jpeg/writer.go.html#5140305">i</a></span><span class="op" id="5140483">]</span>&nbsp;<span class="op" id="5140485">=</span>&nbsp;<span class="builtintype" id="5140487">int32</span><span class="op" id="5140492">(</span><span class="ident" id="5140493"><a href="/gostd/image/jpeg/writer.go.html#5140413">yy</a></span><span class="op" id="5140495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140500"><a href="/gostd/image/jpeg/writer.go.html#5140091">cbBlock</a></span><span class="op" id="5140507">[</span><span class="num" id="5140508">8</span><span class="op" id="5140509">*</span><span class="ident" id="5140510"><a href="/gostd/image/jpeg/writer.go.html#5140182">j</a></span><span class="op" id="5140511">+</span><span class="ident" id="5140512"><a href="/gostd/image/jpeg/writer.go.html#5140305">i</a></span><span class="op" id="5140513">]</span>&nbsp;<span class="op" id="5140515">=</span>&nbsp;<span class="builtintype" id="5140517">int32</span><span class="op" id="5140522">(</span><span class="ident" id="5140523"><a href="/gostd/image/jpeg/writer.go.html#5140417">cb</a></span><span class="op" id="5140525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140530"><a href="/gostd/image/jpeg/writer.go.html#5140100">crBlock</a></span><span class="op" id="5140537">[</span><span class="num" id="5140538">8</span><span class="op" id="5140539">*</span><span class="ident" id="5140540"><a href="/gostd/image/jpeg/writer.go.html#5140182">j</a></span><span class="op" id="5140541">+</span><span class="ident" id="5140542"><a href="/gostd/image/jpeg/writer.go.html#5140305">i</a></span><span class="op" id="5140543">]</span>&nbsp;<span class="op" id="5140545">=</span>&nbsp;<span class="builtintype" id="5140547">int32</span><span class="op" id="5140552">(</span><span class="ident" id="5140553"><a href="/gostd/image/jpeg/writer.go.html#5140421">cr</a></span><span class="op" id="5140555">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140562">}</span><br>
<span class="lineno"></span><span class="op" id="5140564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5140567">//&nbsp;scale&nbsp;scales&nbsp;the&nbsp;16x16&nbsp;region&nbsp;represented&nbsp;by&nbsp;the&nbsp;4&nbsp;src&nbsp;blocks&nbsp;to&nbsp;the&nbsp;8x8</span><br>
<span class="lineno">445</span><span class="comment" id="5140643">//&nbsp;dst&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="5140657">func</span>&nbsp;<span class="ident" id="5140662">scale</span><span class="op" id="5140667">(</span><span class="ident" id="5140668">dst</span>&nbsp;<span class="op" id="5140672">*</span><span class="ident" id="5140673"><a href="/gostd/image/jpeg/idct.go.html#5096709">block</a></span><span class="op" id="5140678">,</span>&nbsp;<span class="ident" id="5140680">src</span>&nbsp;<span class="op" id="5140684">*</span><span class="op" id="5140685">[</span><span class="num" id="5140686">4</span><span class="op" id="5140687">]</span><span class="ident" id="5140688"><a href="/gostd/image/jpeg/idct.go.html#5096709">block</a></span><span class="op" id="5140693">)</span>&nbsp;<span class="op" id="5140695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140698">for</span>&nbsp;<span class="ident" id="5140702">i</span>&nbsp;<span class="op" id="5140704">:=</span>&nbsp;<span class="num" id="5140707">0</span><span class="op" id="5140708">;</span>&nbsp;<span class="ident" id="5140710"><a href="/gostd/image/jpeg/writer.go.html#5140702">i</a></span>&nbsp;<span class="op" id="5140712">&lt;</span>&nbsp;<span class="num" id="5140714">4</span><span class="op" id="5140715">;</span>&nbsp;<span class="ident" id="5140717"><a href="/gostd/image/jpeg/writer.go.html#5140702">i</a></span><span class="op" id="5140718">++</span>&nbsp;<span class="op" id="5140721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140725">dstOff</span>&nbsp;<span class="op" id="5140732">:=</span>&nbsp;<span class="op" id="5140735">(</span><span class="ident" id="5140736"><a href="/gostd/image/jpeg/writer.go.html#5140702">i</a></span><span class="op" id="5140737">&amp;</span><span class="num" id="5140738">2</span><span class="op" id="5140739">)</span><span class="op" id="5140740">&lt;&lt;</span><span class="num" id="5140742">4</span>&nbsp;<span class="op" id="5140744">|</span>&nbsp;<span class="op" id="5140746">(</span><span class="ident" id="5140747"><a href="/gostd/image/jpeg/writer.go.html#5140702">i</a></span><span class="op" id="5140748">&amp;</span><span class="num" id="5140749">1</span><span class="op" id="5140750">)</span><span class="op" id="5140751">&lt;&lt;</span><span class="num" id="5140753">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140757">for</span>&nbsp;<span class="ident" id="5140761">y</span>&nbsp;<span class="op" id="5140763">:=</span>&nbsp;<span class="num" id="5140766">0</span><span class="op" id="5140767">;</span>&nbsp;<span class="ident" id="5140769"><a href="/gostd/image/jpeg/writer.go.html#5140761">y</a></span>&nbsp;<span class="op" id="5140771">&lt;</span>&nbsp;<span class="num" id="5140773">4</span><span class="op" id="5140774">;</span>&nbsp;<span class="ident" id="5140776"><a href="/gostd/image/jpeg/writer.go.html#5140761">y</a></span><span class="op" id="5140777">++</span>&nbsp;<span class="op" id="5140780">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140785">for</span>&nbsp;<span class="ident" id="5140789">x</span>&nbsp;<span class="op" id="5140791">:=</span>&nbsp;<span class="num" id="5140794">0</span><span class="op" id="5140795">;</span>&nbsp;<span class="ident" id="5140797"><a href="/gostd/image/jpeg/writer.go.html#5140789">x</a></span>&nbsp;<span class="op" id="5140799">&lt;</span>&nbsp;<span class="num" id="5140801">4</span><span class="op" id="5140802">;</span>&nbsp;<span class="ident" id="5140804"><a href="/gostd/image/jpeg/writer.go.html#5140789">x</a></span><span class="op" id="5140805">++</span>&nbsp;<span class="op" id="5140808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140814">j</span>&nbsp;<span class="op" id="5140816">:=</span>&nbsp;<span class="num" id="5140819">16</span><span class="op" id="5140821">*</span><span class="ident" id="5140822"><a href="/gostd/image/jpeg/writer.go.html#5140761">y</a></span>&nbsp;<span class="op" id="5140824">+</span>&nbsp;<span class="num" id="5140826">2</span><span class="op" id="5140827">*</span><span class="ident" id="5140828"><a href="/gostd/image/jpeg/writer.go.html#5140789">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140834">sum</span>&nbsp;<span class="op" id="5140838">:=</span>&nbsp;<span class="ident" id="5140841"><a href="/gostd/image/jpeg/writer.go.html#5140680">src</a></span><span class="op" id="5140844">[</span><span class="ident" id="5140845"><a href="/gostd/image/jpeg/writer.go.html#5140702">i</a></span><span class="op" id="5140846">]</span><span class="op" id="5140847">[</span><span class="ident" id="5140848"><a href="/gostd/image/jpeg/writer.go.html#5140814">j</a></span><span class="op" id="5140849">]</span>&nbsp;<span class="op" id="5140851">+</span>&nbsp;<span class="ident" id="5140853"><a href="/gostd/image/jpeg/writer.go.html#5140680">src</a></span><span class="op" id="5140856">[</span><span class="ident" id="5140857"><a href="/gostd/image/jpeg/writer.go.html#5140702">i</a></span><span class="op" id="5140858">]</span><span class="op" id="5140859">[</span><span class="ident" id="5140860"><a href="/gostd/image/jpeg/writer.go.html#5140814">j</a></span><span class="op" id="5140861">+</span><span class="num" id="5140862">1</span><span class="op" id="5140863">]</span>&nbsp;<span class="op" id="5140865">+</span>&nbsp;<span class="ident" id="5140867"><a href="/gostd/image/jpeg/writer.go.html#5140680">src</a></span><span class="op" id="5140870">[</span><span class="ident" id="5140871"><a href="/gostd/image/jpeg/writer.go.html#5140702">i</a></span><span class="op" id="5140872">]</span><span class="op" id="5140873">[</span><span class="ident" id="5140874"><a href="/gostd/image/jpeg/writer.go.html#5140814">j</a></span><span class="op" id="5140875">+</span><span class="num" id="5140876">8</span><span class="op" id="5140877">]</span>&nbsp;<span class="op" id="5140879">+</span>&nbsp;<span class="ident" id="5140881"><a href="/gostd/image/jpeg/writer.go.html#5140680">src</a></span><span class="op" id="5140884">[</span><span class="ident" id="5140885"><a href="/gostd/image/jpeg/writer.go.html#5140702">i</a></span><span class="op" id="5140886">]</span><span class="op" id="5140887">[</span><span class="ident" id="5140888"><a href="/gostd/image/jpeg/writer.go.html#5140814">j</a></span><span class="op" id="5140889">+</span><span class="num" id="5140890">9</span><span class="op" id="5140891">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140897"><a href="/gostd/image/jpeg/writer.go.html#5140668">dst</a></span><span class="op" id="5140900">[</span><span class="num" id="5140901">8</span><span class="op" id="5140902">*</span><span class="ident" id="5140903"><a href="/gostd/image/jpeg/writer.go.html#5140761">y</a></span><span class="op" id="5140904">+</span><span class="ident" id="5140905"><a href="/gostd/image/jpeg/writer.go.html#5140789">x</a></span><span class="op" id="5140906">+</span><span class="ident" id="5140907"><a href="/gostd/image/jpeg/writer.go.html#5140725">dstOff</a></span><span class="op" id="5140913">]</span>&nbsp;<span class="op" id="5140915">=</span>&nbsp;<span class="op" id="5140917">(</span><span class="ident" id="5140918"><a href="/gostd/image/jpeg/writer.go.html#5140834">sum</a></span>&nbsp;<span class="op" id="5140922">+</span>&nbsp;<span class="num" id="5140924">2</span><span class="op" id="5140925">)</span>&nbsp;<span class="op" id="5140927">&gt;&gt;</span>&nbsp;<span class="num" id="5140930">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140935">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140942">}</span><br>
<span class="lineno"></span><span class="op" id="5140944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5140947">//&nbsp;sosHeaderY&nbsp;is&nbsp;the&nbsp;SOS&nbsp;marker&nbsp;&#34;\xff\xda&#34;&nbsp;followed&nbsp;by&nbsp;8&nbsp;bytes:</span><br>
<span class="lineno">460</span><span class="comment" id="5141011">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;marker&nbsp;length&nbsp;&#34;\x00\x08&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5141046">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;number&nbsp;of&nbsp;components&nbsp;&#34;\x01&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5141084">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;component&nbsp;1&nbsp;uses&nbsp;DC&nbsp;table&nbsp;0&nbsp;and&nbsp;AC&nbsp;table&nbsp;0&nbsp;&#34;\x01\x00&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5141144">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;bytes&nbsp;&#34;\x00\x3f\x00&#34;.&nbsp;Section&nbsp;B.2.3&nbsp;of&nbsp;the&nbsp;spec&nbsp;says&nbsp;that&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="5141215">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sequential&nbsp;DCTs,&nbsp;those&nbsp;bytes&nbsp;(8-bit&nbsp;Ss,&nbsp;8-bit&nbsp;Se,&nbsp;4-bit&nbsp;Ah,&nbsp;4-bit&nbsp;Al)</span><br>
<span class="lineno">465</span><span class="comment" id="5141290">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;should&nbsp;be&nbsp;0x00,&nbsp;0x3f,&nbsp;0x00&lt;&lt;4&nbsp;|&nbsp;0x00.</span><br>
<span class="lineno"></span><span class="keyword" id="5141333">var</span>&nbsp;<span class="ident" id="5141337">sosHeaderY</span>&nbsp;<span class="op" id="5141348">=</span>&nbsp;<span class="op" id="5141350">[</span><span class="op" id="5141351">]</span><span class="builtintype" id="5141352">byte</span><span class="op" id="5141356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5141359">0xff</span><span class="op" id="5141363">,</span>&nbsp;<span class="num" id="5141365">0xda</span><span class="op" id="5141369">,</span>&nbsp;<span class="num" id="5141371">0x00</span><span class="op" id="5141375">,</span>&nbsp;<span class="num" id="5141377">0x08</span><span class="op" id="5141381">,</span>&nbsp;<span class="num" id="5141383">0x01</span><span class="op" id="5141387">,</span>&nbsp;<span class="num" id="5141389">0x01</span><span class="op" id="5141393">,</span>&nbsp;<span class="num" id="5141395">0x00</span><span class="op" id="5141399">,</span>&nbsp;<span class="num" id="5141401">0x00</span><span class="op" id="5141405">,</span>&nbsp;<span class="num" id="5141407">0x3f</span><span class="op" id="5141411">,</span>&nbsp;<span class="num" id="5141413">0x00</span><span class="op" id="5141417">,</span><br>
<span class="lineno"></span><span class="op" id="5141419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span><span class="comment" id="5141422">//&nbsp;sosHeaderYCbCr&nbsp;is&nbsp;the&nbsp;SOS&nbsp;marker&nbsp;&#34;\xff\xda&#34;&nbsp;followed&nbsp;by&nbsp;12&nbsp;bytes:</span><br>
<span class="lineno"></span><span class="comment" id="5141491">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;marker&nbsp;length&nbsp;&#34;\x00\x0c&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5141526">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;number&nbsp;of&nbsp;components&nbsp;&#34;\x03&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5141564">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;component&nbsp;1&nbsp;uses&nbsp;DC&nbsp;table&nbsp;0&nbsp;and&nbsp;AC&nbsp;table&nbsp;0&nbsp;&#34;\x01\x00&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5141624">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;component&nbsp;2&nbsp;uses&nbsp;DC&nbsp;table&nbsp;1&nbsp;and&nbsp;AC&nbsp;table&nbsp;1&nbsp;&#34;\x02\x11&#34;,</span><br>
<span class="lineno">475</span><span class="comment" id="5141684">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;component&nbsp;3&nbsp;uses&nbsp;DC&nbsp;table&nbsp;1&nbsp;and&nbsp;AC&nbsp;table&nbsp;1&nbsp;&#34;\x03\x11&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5141744">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;bytes&nbsp;&#34;\x00\x3f\x00&#34;.&nbsp;Section&nbsp;B.2.3&nbsp;of&nbsp;the&nbsp;spec&nbsp;says&nbsp;that&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="5141815">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sequential&nbsp;DCTs,&nbsp;those&nbsp;bytes&nbsp;(8-bit&nbsp;Ss,&nbsp;8-bit&nbsp;Se,&nbsp;4-bit&nbsp;Ah,&nbsp;4-bit&nbsp;Al)</span><br>
<span class="lineno"></span><span class="comment" id="5141890">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;should&nbsp;be&nbsp;0x00,&nbsp;0x3f,&nbsp;0x00&lt;&lt;4&nbsp;|&nbsp;0x00.</span><br>
<span class="lineno"></span><span class="keyword" id="5141933">var</span>&nbsp;<span class="ident" id="5141937">sosHeaderYCbCr</span>&nbsp;<span class="op" id="5141952">=</span>&nbsp;<span class="op" id="5141954">[</span><span class="op" id="5141955">]</span><span class="builtintype" id="5141956">byte</span><span class="op" id="5141960">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5141963">0xff</span><span class="op" id="5141967">,</span>&nbsp;<span class="num" id="5141969">0xda</span><span class="op" id="5141973">,</span>&nbsp;<span class="num" id="5141975">0x00</span><span class="op" id="5141979">,</span>&nbsp;<span class="num" id="5141981">0x0c</span><span class="op" id="5141985">,</span>&nbsp;<span class="num" id="5141987">0x03</span><span class="op" id="5141991">,</span>&nbsp;<span class="num" id="5141993">0x01</span><span class="op" id="5141997">,</span>&nbsp;<span class="num" id="5141999">0x00</span><span class="op" id="5142003">,</span>&nbsp;<span class="num" id="5142005">0x02</span><span class="op" id="5142009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5142012">0x11</span><span class="op" id="5142016">,</span>&nbsp;<span class="num" id="5142018">0x03</span><span class="op" id="5142022">,</span>&nbsp;<span class="num" id="5142024">0x11</span><span class="op" id="5142028">,</span>&nbsp;<span class="num" id="5142030">0x00</span><span class="op" id="5142034">,</span>&nbsp;<span class="num" id="5142036">0x3f</span><span class="op" id="5142040">,</span>&nbsp;<span class="num" id="5142042">0x00</span><span class="op" id="5142046">,</span><br>
<span class="lineno"></span><span class="op" id="5142048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5142051">//&nbsp;writeSOS&nbsp;writes&nbsp;the&nbsp;StartOfScan&nbsp;marker.</span><br>
<span class="lineno">485</span><span class="keyword" id="5142094">func</span>&nbsp;<span class="op" id="5142099">(</span><span class="ident" id="5142100">e</span>&nbsp;<span class="op" id="5142102">*</span><span class="ident" id="5142103"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><span class="op" id="5142110">)</span>&nbsp;<span class="ident" id="5142112">writeSOS</span><span class="op" id="5142120">(</span><span class="ident" id="5142121">m</span>&nbsp;<span class="ident" id="5142123"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5142128">.</span><span class="ident" id="5142129"><a href="/gostd/image/image.go.html#5154907">Image</a></span><span class="op" id="5142134">)</span>&nbsp;<span class="op" id="5142136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142139">switch</span>&nbsp;<span class="ident" id="5142146"><a href="/gostd/image/jpeg/writer.go.html#5142121">m</a></span><span class="op" id="5142147">.</span><span class="op" id="5142148">(</span><span class="keyword" id="5142149">type</span><span class="op" id="5142153">)</span>&nbsp;<span class="op" id="5142155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142158">case</span>&nbsp;<span class="op" id="5142163">*</span><span class="ident" id="5142164"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5142169">.</span><span class="ident" id="5142170"><a href="/gostd/image/image.go.html#5172029">Gray</a></span><span class="op" id="5142174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142178"><a href="/gostd/image/jpeg/writer.go.html#5142100">e</a></span><span class="op" id="5142179">.</span><span class="ident" id="5142180"><a href="/gostd/image/jpeg/writer.go.html#5135386">write</a></span><span class="op" id="5142185">(</span><span class="ident" id="5142186"><a href="/gostd/image/jpeg/writer.go.html#5141337">sosHeaderY</a></span><span class="op" id="5142196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142199">default</span><span class="op" id="5142206">:</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142210"><a href="/gostd/image/jpeg/writer.go.html#5142100">e</a></span><span class="op" id="5142211">.</span><span class="ident" id="5142212"><a href="/gostd/image/jpeg/writer.go.html#5135386">write</a></span><span class="op" id="5142217">(</span><span class="ident" id="5142218"><a href="/gostd/image/jpeg/writer.go.html#5141937">sosHeaderYCbCr</a></span><span class="op" id="5142232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142238">var</span>&nbsp;<span class="op" id="5142242">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5142246">//&nbsp;Scratch&nbsp;buffers&nbsp;to&nbsp;hold&nbsp;the&nbsp;YCbCr&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5142293">//&nbsp;The&nbsp;blocks&nbsp;are&nbsp;in&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142345">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142352"><a href="/gostd/image/jpeg/idct.go.html#5096709">block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142360">cb</span><span class="op" id="5142362">,</span>&nbsp;<span class="ident" id="5142364">cr</span>&nbsp;<span class="op" id="5142367">[</span><span class="num" id="5142368">4</span><span class="op" id="5142369">]</span><span class="ident" id="5142370"><a href="/gostd/image/jpeg/idct.go.html#5096709">block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5142378">//&nbsp;DC&nbsp;components&nbsp;are&nbsp;delta-encoded.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142416">prevDCY</span><span class="op" id="5142423">,</span>&nbsp;<span class="ident" id="5142425">prevDCCb</span><span class="op" id="5142433">,</span>&nbsp;<span class="ident" id="5142435">prevDCCr</span>&nbsp;<span class="builtintype" id="5142444">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142451">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142454">bounds</span>&nbsp;<span class="op" id="5142461">:=</span>&nbsp;<span class="ident" id="5142464"><a href="/gostd/image/jpeg/writer.go.html#5142121">m</a></span><span class="op" id="5142465">.</span><span class="ident" id="5142466"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="5142472">(</span><span class="op" id="5142473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142476">switch</span>&nbsp;<span class="ident" id="5142483">m</span>&nbsp;<span class="op" id="5142485">:=</span>&nbsp;<span class="ident" id="5142488"><a href="/gostd/image/jpeg/writer.go.html#5142121">m</a></span><span class="op" id="5142489">.</span><span class="op" id="5142490">(</span><span class="keyword" id="5142491">type</span><span class="op" id="5142495">)</span>&nbsp;<span class="op" id="5142497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5142500">//&nbsp;TODO(wathiede):&nbsp;switch&nbsp;on&nbsp;m.ColorModel()&nbsp;instead&nbsp;of&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142562">case</span>&nbsp;<span class="op" id="5142567">*</span><span class="ident" id="5142568"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5142573">.</span><span class="ident" id="5142574"><a href="/gostd/image/image.go.html#5172029">Gray</a></span><span class="op" id="5142578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142582">for</span>&nbsp;<span class="ident" id="5142586">y</span>&nbsp;<span class="op" id="5142588">:=</span>&nbsp;<span class="ident" id="5142591"><a href="/gostd/image/jpeg/writer.go.html#5142454">bounds</a></span><span class="op" id="5142597">.</span><span class="ident" id="5142598"><a href="/gostd/image/geom.go.html#5150016">Min</a></span><span class="op" id="5142601">.</span><span class="ident" id="5142602"><a href="/gostd/image/geom.go.html#5148454">Y</a></span><span class="op" id="5142603">;</span>&nbsp;<span class="ident" id="5142605"><a href="/gostd/image/jpeg/writer.go.html#5142586">y</a></span>&nbsp;<span class="op" id="5142607">&lt;</span>&nbsp;<span class="ident" id="5142609"><a href="/gostd/image/jpeg/writer.go.html#5142454">bounds</a></span><span class="op" id="5142615">.</span><span class="ident" id="5142616"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="5142619">.</span><span class="ident" id="5142620"><a href="/gostd/image/geom.go.html#5148454">Y</a></span><span class="op" id="5142621">;</span>&nbsp;<span class="ident" id="5142623"><a href="/gostd/image/jpeg/writer.go.html#5142586">y</a></span>&nbsp;<span class="op" id="5142625">+=</span>&nbsp;<span class="num" id="5142628">8</span>&nbsp;<span class="op" id="5142630">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142635">for</span>&nbsp;<span class="ident" id="5142639">x</span>&nbsp;<span class="op" id="5142641">:=</span>&nbsp;<span class="ident" id="5142644"><a href="/gostd/image/jpeg/writer.go.html#5142454">bounds</a></span><span class="op" id="5142650">.</span><span class="ident" id="5142651"><a href="/gostd/image/geom.go.html#5150016">Min</a></span><span class="op" id="5142654">.</span><span class="ident" id="5142655"><a href="/gostd/image/geom.go.html#5148451">X</a></span><span class="op" id="5142656">;</span>&nbsp;<span class="ident" id="5142658"><a href="/gostd/image/jpeg/writer.go.html#5142639">x</a></span>&nbsp;<span class="op" id="5142660">&lt;</span>&nbsp;<span class="ident" id="5142662"><a href="/gostd/image/jpeg/writer.go.html#5142454">bounds</a></span><span class="op" id="5142668">.</span><span class="ident" id="5142669"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="5142672">.</span><span class="ident" id="5142673"><a href="/gostd/image/geom.go.html#5148451">X</a></span><span class="op" id="5142674">;</span>&nbsp;<span class="ident" id="5142676"><a href="/gostd/image/jpeg/writer.go.html#5142639">x</a></span>&nbsp;<span class="op" id="5142678">+=</span>&nbsp;<span class="num" id="5142681">8</span>&nbsp;<span class="op" id="5142683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142689">p</span>&nbsp;<span class="op" id="5142691">:=</span>&nbsp;<span class="ident" id="5142694"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5142699">.</span><span class="ident" id="5142700"><a href="/gostd/image/geom.go.html#5149691">Pt</a></span><span class="op" id="5142702">(</span><span class="ident" id="5142703"><a href="/gostd/image/jpeg/writer.go.html#5142639">x</a></span><span class="op" id="5142704">,</span>&nbsp;<span class="ident" id="5142706"><a href="/gostd/image/jpeg/writer.go.html#5142586">y</a></span><span class="op" id="5142707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142713"><a href="/gostd/image/jpeg/writer.go.html#5139678">grayToY</a></span><span class="op" id="5142720">(</span><span class="ident" id="5142721"><a href="/gostd/image/jpeg/writer.go.html#5142483">m</a></span><span class="op" id="5142722">,</span>&nbsp;<span class="ident" id="5142724"><a href="/gostd/image/jpeg/writer.go.html#5142689">p</a></span><span class="op" id="5142725">,</span>&nbsp;<span class="op" id="5142727">&amp;</span><span class="ident" id="5142728"><a href="/gostd/image/jpeg/writer.go.html#5142345">b</a></span><span class="op" id="5142729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142735"><a href="/gostd/image/jpeg/writer.go.html#5142416">prevDCY</a></span>&nbsp;<span class="op" id="5142743">=</span>&nbsp;<span class="ident" id="5142745"><a href="/gostd/image/jpeg/writer.go.html#5142100">e</a></span><span class="op" id="5142746">.</span><span class="ident" id="5142747"><a href="/gostd/image/jpeg/writer.go.html#5138505">writeBlock</a></span><span class="op" id="5142757">(</span><span class="op" id="5142758">&amp;</span><span class="ident" id="5142759"><a href="/gostd/image/jpeg/writer.go.html#5142345">b</a></span><span class="op" id="5142760">,</span>&nbsp;<span class="num" id="5142762">0</span><span class="op" id="5142763">,</span>&nbsp;<span class="ident" id="5142765"><a href="/gostd/image/jpeg/writer.go.html#5142416">prevDCY</a></span><span class="op" id="5142772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142777">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142784">default</span><span class="op" id="5142791">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142795">rgba</span><span class="op" id="5142799">,</span>&nbsp;<span class="ident" id="5142801">_</span>&nbsp;<span class="op" id="5142803">:=</span>&nbsp;<span class="ident" id="5142806"><a href="/gostd/image/jpeg/writer.go.html#5142483">m</a></span><span class="op" id="5142807">.</span><span class="op" id="5142808">(</span><span class="op" id="5142809">*</span><span class="ident" id="5142810"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5142815">.</span><span class="ident" id="5142816"><a href="/gostd/image/image.go.html#5155914">RGBA</a></span><span class="op" id="5142820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142824">for</span>&nbsp;<span class="ident" id="5142828">y</span>&nbsp;<span class="op" id="5142830">:=</span>&nbsp;<span class="ident" id="5142833"><a href="/gostd/image/jpeg/writer.go.html#5142454">bounds</a></span><span class="op" id="5142839">.</span><span class="ident" id="5142840"><a href="/gostd/image/geom.go.html#5150016">Min</a></span><span class="op" id="5142843">.</span><span class="ident" id="5142844"><a href="/gostd/image/geom.go.html#5148454">Y</a></span><span class="op" id="5142845">;</span>&nbsp;<span class="ident" id="5142847"><a href="/gostd/image/jpeg/writer.go.html#5142828">y</a></span>&nbsp;<span class="op" id="5142849">&lt;</span>&nbsp;<span class="ident" id="5142851"><a href="/gostd/image/jpeg/writer.go.html#5142454">bounds</a></span><span class="op" id="5142857">.</span><span class="ident" id="5142858"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="5142861">.</span><span class="ident" id="5142862"><a href="/gostd/image/geom.go.html#5148454">Y</a></span><span class="op" id="5142863">;</span>&nbsp;<span class="ident" id="5142865"><a href="/gostd/image/jpeg/writer.go.html#5142828">y</a></span>&nbsp;<span class="op" id="5142867">+=</span>&nbsp;<span class="num" id="5142870">16</span>&nbsp;<span class="op" id="5142873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142878">for</span>&nbsp;<span class="ident" id="5142882">x</span>&nbsp;<span class="op" id="5142884">:=</span>&nbsp;<span class="ident" id="5142887"><a href="/gostd/image/jpeg/writer.go.html#5142454">bounds</a></span><span class="op" id="5142893">.</span><span class="ident" id="5142894"><a href="/gostd/image/geom.go.html#5150016">Min</a></span><span class="op" id="5142897">.</span><span class="ident" id="5142898"><a href="/gostd/image/geom.go.html#5148451">X</a></span><span class="op" id="5142899">;</span>&nbsp;<span class="ident" id="5142901"><a href="/gostd/image/jpeg/writer.go.html#5142882">x</a></span>&nbsp;<span class="op" id="5142903">&lt;</span>&nbsp;<span class="ident" id="5142905"><a href="/gostd/image/jpeg/writer.go.html#5142454">bounds</a></span><span class="op" id="5142911">.</span><span class="ident" id="5142912"><a href="/gostd/image/geom.go.html#5150021">Max</a></span><span class="op" id="5142915">.</span><span class="ident" id="5142916"><a href="/gostd/image/geom.go.html#5148451">X</a></span><span class="op" id="5142917">;</span>&nbsp;<span class="ident" id="5142919"><a href="/gostd/image/jpeg/writer.go.html#5142882">x</a></span>&nbsp;<span class="op" id="5142921">+=</span>&nbsp;<span class="num" id="5142924">16</span>&nbsp;<span class="op" id="5142927">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142933">for</span>&nbsp;<span class="ident" id="5142937">i</span>&nbsp;<span class="op" id="5142939">:=</span>&nbsp;<span class="num" id="5142942">0</span><span class="op" id="5142943">;</span>&nbsp;<span class="ident" id="5142945"><a href="/gostd/image/jpeg/writer.go.html#5142937">i</a></span>&nbsp;<span class="op" id="5142947">&lt;</span>&nbsp;<span class="num" id="5142949">4</span><span class="op" id="5142950">;</span>&nbsp;<span class="ident" id="5142952"><a href="/gostd/image/jpeg/writer.go.html#5142937">i</a></span><span class="op" id="5142953">++</span>&nbsp;<span class="op" id="5142956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142963">xOff</span>&nbsp;<span class="op" id="5142968">:=</span>&nbsp;<span class="op" id="5142971">(</span><span class="ident" id="5142972"><a href="/gostd/image/jpeg/writer.go.html#5142937">i</a></span>&nbsp;<span class="op" id="5142974">&amp;</span>&nbsp;<span class="num" id="5142976">1</span><span class="op" id="5142977">)</span>&nbsp;<span class="op" id="5142979">*</span>&nbsp;<span class="num" id="5142981">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142988">yOff</span>&nbsp;<span class="op" id="5142993">:=</span>&nbsp;<span class="op" id="5142996">(</span><span class="ident" id="5142997"><a href="/gostd/image/jpeg/writer.go.html#5142937">i</a></span>&nbsp;<span class="op" id="5142999">&amp;</span>&nbsp;<span class="num" id="5143001">2</span><span class="op" id="5143002">)</span>&nbsp;<span class="op" id="5143004">*</span>&nbsp;<span class="num" id="5143006">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143013">p</span>&nbsp;<span class="op" id="5143015">:=</span>&nbsp;<span class="ident" id="5143018"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5143023">.</span><span class="ident" id="5143024"><a href="/gostd/image/geom.go.html#5149691">Pt</a></span><span class="op" id="5143026">(</span><span class="ident" id="5143027"><a href="/gostd/image/jpeg/writer.go.html#5142882">x</a></span><span class="op" id="5143028">+</span><span class="ident" id="5143029"><a href="/gostd/image/jpeg/writer.go.html#5142963">xOff</a></span><span class="op" id="5143033">,</span>&nbsp;<span class="ident" id="5143035"><a href="/gostd/image/jpeg/writer.go.html#5142828">y</a></span><span class="op" id="5143036">+</span><span class="ident" id="5143037"><a href="/gostd/image/jpeg/writer.go.html#5142988">yOff</a></span><span class="op" id="5143041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5143048">if</span>&nbsp;<span class="ident" id="5143051"><a href="/gostd/image/jpeg/writer.go.html#5142795">rgba</a></span>&nbsp;<span class="op" id="5143056">!=</span>&nbsp;<span class="builtintype" id="5143059">nil</span>&nbsp;<span class="op" id="5143063">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143071"><a href="/gostd/image/jpeg/writer.go.html#5140041">rgbaToYCbCr</a></span><span class="op" id="5143082">(</span><span class="ident" id="5143083"><a href="/gostd/image/jpeg/writer.go.html#5142795">rgba</a></span><span class="op" id="5143087">,</span>&nbsp;<span class="ident" id="5143089"><a href="/gostd/image/jpeg/writer.go.html#5143013">p</a></span><span class="op" id="5143090">,</span>&nbsp;<span class="op" id="5143092">&amp;</span><span class="ident" id="5143093"><a href="/gostd/image/jpeg/writer.go.html#5142345">b</a></span><span class="op" id="5143094">,</span>&nbsp;<span class="op" id="5143096">&amp;</span><span class="ident" id="5143097"><a href="/gostd/image/jpeg/writer.go.html#5142360">cb</a></span><span class="op" id="5143099">[</span><span class="ident" id="5143100"><a href="/gostd/image/jpeg/writer.go.html#5142937">i</a></span><span class="op" id="5143101">]</span><span class="op" id="5143102">,</span>&nbsp;<span class="op" id="5143104">&amp;</span><span class="ident" id="5143105"><a href="/gostd/image/jpeg/writer.go.html#5142364">cr</a></span><span class="op" id="5143107">[</span><span class="ident" id="5143108"><a href="/gostd/image/jpeg/writer.go.html#5142937">i</a></span><span class="op" id="5143109">]</span><span class="op" id="5143110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5143117">}</span>&nbsp;<span class="keyword" id="5143119">else</span>&nbsp;<span class="op" id="5143124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143132"><a href="/gostd/image/jpeg/writer.go.html#5139175">toYCbCr</a></span><span class="op" id="5143139">(</span><span class="ident" id="5143140"><a href="/gostd/image/jpeg/writer.go.html#5142483">m</a></span><span class="op" id="5143141">,</span>&nbsp;<span class="ident" id="5143143"><a href="/gostd/image/jpeg/writer.go.html#5143013">p</a></span><span class="op" id="5143144">,</span>&nbsp;<span class="op" id="5143146">&amp;</span><span class="ident" id="5143147"><a href="/gostd/image/jpeg/writer.go.html#5142345">b</a></span><span class="op" id="5143148">,</span>&nbsp;<span class="op" id="5143150">&amp;</span><span class="ident" id="5143151"><a href="/gostd/image/jpeg/writer.go.html#5142360">cb</a></span><span class="op" id="5143153">[</span><span class="ident" id="5143154"><a href="/gostd/image/jpeg/writer.go.html#5142937">i</a></span><span class="op" id="5143155">]</span><span class="op" id="5143156">,</span>&nbsp;<span class="op" id="5143158">&amp;</span><span class="ident" id="5143159"><a href="/gostd/image/jpeg/writer.go.html#5142364">cr</a></span><span class="op" id="5143161">[</span><span class="ident" id="5143162"><a href="/gostd/image/jpeg/writer.go.html#5142937">i</a></span><span class="op" id="5143163">]</span><span class="op" id="5143164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5143171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143178"><a href="/gostd/image/jpeg/writer.go.html#5142416">prevDCY</a></span>&nbsp;<span class="op" id="5143186">=</span>&nbsp;<span class="ident" id="5143188"><a href="/gostd/image/jpeg/writer.go.html#5142100">e</a></span><span class="op" id="5143189">.</span><span class="ident" id="5143190"><a href="/gostd/image/jpeg/writer.go.html#5138505">writeBlock</a></span><span class="op" id="5143200">(</span><span class="op" id="5143201">&amp;</span><span class="ident" id="5143202"><a href="/gostd/image/jpeg/writer.go.html#5142345">b</a></span><span class="op" id="5143203">,</span>&nbsp;<span class="num" id="5143205">0</span><span class="op" id="5143206">,</span>&nbsp;<span class="ident" id="5143208"><a href="/gostd/image/jpeg/writer.go.html#5142416">prevDCY</a></span><span class="op" id="5143215">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5143221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143227"><a href="/gostd/image/jpeg/writer.go.html#5140662">scale</a></span><span class="op" id="5143232">(</span><span class="op" id="5143233">&amp;</span><span class="ident" id="5143234"><a href="/gostd/image/jpeg/writer.go.html#5142345">b</a></span><span class="op" id="5143235">,</span>&nbsp;<span class="op" id="5143237">&amp;</span><span class="ident" id="5143238"><a href="/gostd/image/jpeg/writer.go.html#5142360">cb</a></span><span class="op" id="5143240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143246"><a href="/gostd/image/jpeg/writer.go.html#5142425">prevDCCb</a></span>&nbsp;<span class="op" id="5143255">=</span>&nbsp;<span class="ident" id="5143257"><a href="/gostd/image/jpeg/writer.go.html#5142100">e</a></span><span class="op" id="5143258">.</span><span class="ident" id="5143259"><a href="/gostd/image/jpeg/writer.go.html#5138505">writeBlock</a></span><span class="op" id="5143269">(</span><span class="op" id="5143270">&amp;</span><span class="ident" id="5143271"><a href="/gostd/image/jpeg/writer.go.html#5142345">b</a></span><span class="op" id="5143272">,</span>&nbsp;<span class="num" id="5143274">1</span><span class="op" id="5143275">,</span>&nbsp;<span class="ident" id="5143277"><a href="/gostd/image/jpeg/writer.go.html#5142425">prevDCCb</a></span><span class="op" id="5143285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143291"><a href="/gostd/image/jpeg/writer.go.html#5140662">scale</a></span><span class="op" id="5143296">(</span><span class="op" id="5143297">&amp;</span><span class="ident" id="5143298"><a href="/gostd/image/jpeg/writer.go.html#5142345">b</a></span><span class="op" id="5143299">,</span>&nbsp;<span class="op" id="5143301">&amp;</span><span class="ident" id="5143302"><a href="/gostd/image/jpeg/writer.go.html#5142364">cr</a></span><span class="op" id="5143304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143310"><a href="/gostd/image/jpeg/writer.go.html#5142435">prevDCCr</a></span>&nbsp;<span class="op" id="5143319">=</span>&nbsp;<span class="ident" id="5143321"><a href="/gostd/image/jpeg/writer.go.html#5142100">e</a></span><span class="op" id="5143322">.</span><span class="ident" id="5143323"><a href="/gostd/image/jpeg/writer.go.html#5138505">writeBlock</a></span><span class="op" id="5143333">(</span><span class="op" id="5143334">&amp;</span><span class="ident" id="5143335"><a href="/gostd/image/jpeg/writer.go.html#5142345">b</a></span><span class="op" id="5143336">,</span>&nbsp;<span class="num" id="5143338">1</span><span class="op" id="5143339">,</span>&nbsp;<span class="ident" id="5143341"><a href="/gostd/image/jpeg/writer.go.html#5142435">prevDCCr</a></span><span class="op" id="5143349">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5143354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5143358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5143361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5143364">//&nbsp;Pad&nbsp;the&nbsp;last&nbsp;byte&nbsp;with&nbsp;1&#39;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143396"><a href="/gostd/image/jpeg/writer.go.html#5142100">e</a></span><span class="op" id="5143397">.</span><span class="ident" id="5143398"><a href="/gostd/image/jpeg/writer.go.html#5135708">emit</a></span><span class="op" id="5143402">(</span><span class="num" id="5143403">0x7f</span><span class="op" id="5143407">,</span>&nbsp;<span class="num" id="5143409">7</span><span class="op" id="5143410">)</span><br>
<span class="lineno">535</span><span class="op" id="5143412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5143415">//&nbsp;DefaultQuality&nbsp;is&nbsp;the&nbsp;default&nbsp;quality&nbsp;encoding&nbsp;parameter.</span><br>
<span class="lineno"></span><span class="keyword" id="5143476">const</span>&nbsp;<span class="ident" id="5143482">DefaultQuality</span>&nbsp;<span class="op" id="5143497">=</span>&nbsp;<span class="num" id="5143499">75</span><br>
<span class="lineno"></span><br>
<span class="lineno">540</span><span class="comment" id="5143503">//&nbsp;Options&nbsp;are&nbsp;the&nbsp;encoding&nbsp;parameters.</span><br>
<span class="lineno"></span><span class="comment" id="5143543">//&nbsp;Quality&nbsp;ranges&nbsp;from&nbsp;1&nbsp;to&nbsp;100&nbsp;inclusive,&nbsp;higher&nbsp;is&nbsp;better.</span><br>
<span class="lineno"></span><span class="keyword" id="5143604">type</span>&nbsp;<span class="ident" id="5143609">Options</span>&nbsp;<span class="keyword" id="5143617">struct</span>&nbsp;<span class="op" id="5143624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143627">Quality</span>&nbsp;<span class="builtintype" id="5143635">int</span><br>
<span class="lineno"></span><span class="op" id="5143639">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="5143642">//&nbsp;Encode&nbsp;writes&nbsp;the&nbsp;Image&nbsp;m&nbsp;to&nbsp;w&nbsp;in&nbsp;JPEG&nbsp;4:2:0&nbsp;baseline&nbsp;format&nbsp;with&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="5143721">//&nbsp;options.&nbsp;Default&nbsp;parameters&nbsp;are&nbsp;used&nbsp;if&nbsp;a&nbsp;nil&nbsp;*Options&nbsp;is&nbsp;passed.</span><br>
<span class="lineno"></span><span class="keyword" id="5143790">func</span>&nbsp;<span class="ident" id="5143795">Encode</span><span class="op" id="5143801">(</span><span class="ident" id="5143802">w</span>&nbsp;<span class="ident" id="5143804"><a href="/gostd/image/jpeg/writer.go.html#5128598">io</a></span><span class="op" id="5143806">.</span><span class="ident" id="5143807"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5143813">,</span>&nbsp;<span class="ident" id="5143815">m</span>&nbsp;<span class="ident" id="5143817"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5143822">.</span><span class="ident" id="5143823"><a href="/gostd/image/image.go.html#5154907">Image</a></span><span class="op" id="5143828">,</span>&nbsp;<span class="ident" id="5143830">o</span>&nbsp;<span class="op" id="5143832">*</span><span class="ident" id="5143833"><a href="/gostd/image/jpeg/writer.go.html#5143609">Options</a></span><span class="op" id="5143840">)</span>&nbsp;<span class="builtintype" id="5143842">error</span>&nbsp;<span class="op" id="5143848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5143851">b</span>&nbsp;<span class="op" id="5143853">:=</span>&nbsp;<span class="ident" id="5143856"><a href="/gostd/image/jpeg/writer.go.html#5143815">m</a></span><span class="op" id="5143857">.</span><span class="ident" id="5143858"><a href="/gostd/image/image.go.html#5155130">Bounds</a></span><span class="op" id="5143864">(</span><span class="op" id="5143865">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5143868">if</span>&nbsp;<span class="ident" id="5143871"><a href="/gostd/image/jpeg/writer.go.html#5143851">b</a></span><span class="op" id="5143872">.</span><span class="ident" id="5143873"><a href="/gostd/image/geom.go.html#5150231">Dx</a></span><span class="op" id="5143875">(</span><span class="op" id="5143876">)</span>&nbsp;<span class="op" id="5143878">&gt;=</span>&nbsp;<span class="num" id="5143881">1</span><span class="op" id="5143882">&lt;&lt;</span><span class="num" id="5143884">16</span>&nbsp;<span class="op" id="5143887">||</span>&nbsp;<span class="ident" id="5143890"><a href="/gostd/image/jpeg/writer.go.html#5143851">b</a></span><span class="op" id="5143891">.</span><span class="ident" id="5143892"><a href="/gostd/image/geom.go.html#5150316">Dy</a></span><span class="op" id="5143894">(</span><span class="op" id="5143895">)</span>&nbsp;<span class="op" id="5143897">&gt;=</span>&nbsp;<span class="num" id="5143900">1</span><span class="op" id="5143901">&lt;&lt;</span><span class="num" id="5143903">16</span>&nbsp;<span class="op" id="5143906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5143910">return</span>&nbsp;<span class="ident" id="5143917"><a href="/gostd/image/jpeg/writer.go.html#5128564">errors</a></span><span class="op" id="5143923">.</span><span class="ident" id="5143924"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5143927">(</span><span class="string" id="5143928">&#34;jpeg:&nbsp;image&nbsp;is&nbsp;too&nbsp;large&nbsp;to&nbsp;encode&#34;</span><span class="op" id="5143964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5143967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5143970">var</span>&nbsp;<span class="ident" id="5143974">e</span>&nbsp;<span class="ident" id="5143976"><a href="/gostd/image/jpeg/writer.go.html#5134879">encoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5143985">if</span>&nbsp;<span class="ident" id="5143988">ww</span><span class="op" id="5143990">,</span>&nbsp;<span class="ident" id="5143992">ok</span>&nbsp;<span class="op" id="5143995">:=</span>&nbsp;<span class="ident" id="5143998"><a href="/gostd/image/jpeg/writer.go.html#5143802">w</a></span><span class="op" id="5143999">.</span><span class="op" id="5144000">(</span><span class="ident" id="5144001"><a href="/gostd/image/jpeg/writer.go.html#5134763">writer</a></span><span class="op" id="5144007">)</span><span class="op" id="5144008">;</span>&nbsp;<span class="ident" id="5144010"><a href="/gostd/image/jpeg/writer.go.html#5143992">ok</a></span>&nbsp;<span class="op" id="5144013">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144017"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5144018">.</span><span class="ident" id="5144019"><a href="/gostd/image/jpeg/writer.go.html#5135043">w</a></span>&nbsp;<span class="op" id="5144021">=</span>&nbsp;<span class="ident" id="5144023"><a href="/gostd/image/jpeg/writer.go.html#5143988">ww</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144027">}</span>&nbsp;<span class="keyword" id="5144029">else</span>&nbsp;<span class="op" id="5144034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144038"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5144039">.</span><span class="ident" id="5144040"><a href="/gostd/image/jpeg/writer.go.html#5135043">w</a></span>&nbsp;<span class="op" id="5144042">=</span>&nbsp;<span class="ident" id="5144044"><a href="/gostd/image/jpeg/writer.go.html#5128555">bufio</a></span><span class="op" id="5144049">.</span><span class="ident" id="5144050"><a href="/gostd/bufio/bufio.go.html#1367149">NewWriter</a></span><span class="op" id="5144059">(</span><span class="ident" id="5144060"><a href="/gostd/image/jpeg/writer.go.html#5143802">w</a></span><span class="op" id="5144061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144067">//&nbsp;Clip&nbsp;quality&nbsp;to&nbsp;[1,&nbsp;100].</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144097">quality</span>&nbsp;<span class="op" id="5144105">:=</span>&nbsp;<span class="ident" id="5144108"><a href="/gostd/image/jpeg/writer.go.html#5143482">DefaultQuality</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144124">if</span>&nbsp;<span class="ident" id="5144127"><a href="/gostd/image/jpeg/writer.go.html#5143830">o</a></span>&nbsp;<span class="op" id="5144129">!=</span>&nbsp;<span class="builtintype" id="5144132">nil</span>&nbsp;<span class="op" id="5144136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144140"><a href="/gostd/image/jpeg/writer.go.html#5144097">quality</a></span>&nbsp;<span class="op" id="5144148">=</span>&nbsp;<span class="ident" id="5144150"><a href="/gostd/image/jpeg/writer.go.html#5143830">o</a></span><span class="op" id="5144151">.</span><span class="ident" id="5144152"><a href="/gostd/image/jpeg/writer.go.html#5143627">Quality</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144162">if</span>&nbsp;<span class="ident" id="5144165"><a href="/gostd/image/jpeg/writer.go.html#5144097">quality</a></span>&nbsp;<span class="op" id="5144173">&lt;</span>&nbsp;<span class="num" id="5144175">1</span>&nbsp;<span class="op" id="5144177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144182"><a href="/gostd/image/jpeg/writer.go.html#5144097">quality</a></span>&nbsp;<span class="op" id="5144190">=</span>&nbsp;<span class="num" id="5144192">1</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144196">}</span>&nbsp;<span class="keyword" id="5144198">else</span>&nbsp;<span class="keyword" id="5144203">if</span>&nbsp;<span class="ident" id="5144206"><a href="/gostd/image/jpeg/writer.go.html#5144097">quality</a></span>&nbsp;<span class="op" id="5144214">&gt;</span>&nbsp;<span class="num" id="5144216">100</span>&nbsp;<span class="op" id="5144220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144225"><a href="/gostd/image/jpeg/writer.go.html#5144097">quality</a></span>&nbsp;<span class="op" id="5144233">=</span>&nbsp;<span class="num" id="5144235">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144247">//&nbsp;Convert&nbsp;from&nbsp;a&nbsp;quality&nbsp;rating&nbsp;to&nbsp;a&nbsp;scaling&nbsp;factor.</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144302">var</span>&nbsp;<span class="ident" id="5144306">scale</span>&nbsp;<span class="builtintype" id="5144312">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144317">if</span>&nbsp;<span class="ident" id="5144320"><a href="/gostd/image/jpeg/writer.go.html#5144097">quality</a></span>&nbsp;<span class="op" id="5144328">&lt;</span>&nbsp;<span class="num" id="5144330">50</span>&nbsp;<span class="op" id="5144333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144337"><a href="/gostd/image/jpeg/writer.go.html#5144306">scale</a></span>&nbsp;<span class="op" id="5144343">=</span>&nbsp;<span class="num" id="5144345">5000</span>&nbsp;<span class="op" id="5144350">/</span>&nbsp;<span class="ident" id="5144352"><a href="/gostd/image/jpeg/writer.go.html#5144097">quality</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144361">}</span>&nbsp;<span class="keyword" id="5144363">else</span>&nbsp;<span class="op" id="5144368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144372"><a href="/gostd/image/jpeg/writer.go.html#5144306">scale</a></span>&nbsp;<span class="op" id="5144378">=</span>&nbsp;<span class="num" id="5144380">200</span>&nbsp;<span class="op" id="5144384">-</span>&nbsp;<span class="ident" id="5144386"><a href="/gostd/image/jpeg/writer.go.html#5144097">quality</a></span><span class="op" id="5144393">*</span><span class="num" id="5144394">2</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144400">//&nbsp;Initialize&nbsp;the&nbsp;quantization&nbsp;tables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144440">for</span>&nbsp;<span class="ident" id="5144444">i</span>&nbsp;<span class="op" id="5144446">:=</span>&nbsp;<span class="keyword" id="5144449">range</span>&nbsp;<span class="ident" id="5144455"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5144456">.</span><span class="ident" id="5144457"><a href="/gostd/image/jpeg/writer.go.html#5135247">quant</a></span>&nbsp;<span class="op" id="5144463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144467">for</span>&nbsp;<span class="ident" id="5144471">j</span>&nbsp;<span class="op" id="5144473">:=</span>&nbsp;<span class="keyword" id="5144476">range</span>&nbsp;<span class="ident" id="5144482"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5144483">.</span><span class="ident" id="5144484"><a href="/gostd/image/jpeg/writer.go.html#5135247">quant</a></span><span class="op" id="5144489">[</span><span class="ident" id="5144490"><a href="/gostd/image/jpeg/writer.go.html#5144444">i</a></span><span class="op" id="5144491">]</span>&nbsp;<span class="op" id="5144493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144498">x</span>&nbsp;<span class="op" id="5144500">:=</span>&nbsp;<span class="builtintype" id="5144503">int</span><span class="op" id="5144506">(</span><span class="ident" id="5144507"><a href="/gostd/image/jpeg/writer.go.html#5130136">unscaledQuant</a></span><span class="op" id="5144520">[</span><span class="ident" id="5144521"><a href="/gostd/image/jpeg/writer.go.html#5144444">i</a></span><span class="op" id="5144522">]</span><span class="op" id="5144523">[</span><span class="ident" id="5144524"><a href="/gostd/image/jpeg/writer.go.html#5144471">j</a></span><span class="op" id="5144525">]</span><span class="op" id="5144526">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144531"><a href="/gostd/image/jpeg/writer.go.html#5144498">x</a></span>&nbsp;<span class="op" id="5144533">=</span>&nbsp;<span class="op" id="5144535">(</span><span class="ident" id="5144536"><a href="/gostd/image/jpeg/writer.go.html#5144498">x</a></span><span class="op" id="5144537">*</span><span class="ident" id="5144538"><a href="/gostd/image/jpeg/writer.go.html#5144306">scale</a></span>&nbsp;<span class="op" id="5144544">+</span>&nbsp;<span class="num" id="5144546">50</span><span class="op" id="5144548">)</span>&nbsp;<span class="op" id="5144550">/</span>&nbsp;<span class="num" id="5144552">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144559">if</span>&nbsp;<span class="ident" id="5144562"><a href="/gostd/image/jpeg/writer.go.html#5144498">x</a></span>&nbsp;<span class="op" id="5144564">&lt;</span>&nbsp;<span class="num" id="5144566">1</span>&nbsp;<span class="op" id="5144568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144574"><a href="/gostd/image/jpeg/writer.go.html#5144498">x</a></span>&nbsp;<span class="op" id="5144576">=</span>&nbsp;<span class="num" id="5144578">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144583">}</span>&nbsp;<span class="keyword" id="5144585">else</span>&nbsp;<span class="keyword" id="5144590">if</span>&nbsp;<span class="ident" id="5144593"><a href="/gostd/image/jpeg/writer.go.html#5144498">x</a></span>&nbsp;<span class="op" id="5144595">&gt;</span>&nbsp;<span class="num" id="5144597">255</span>&nbsp;<span class="op" id="5144601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144607"><a href="/gostd/image/jpeg/writer.go.html#5144498">x</a></span>&nbsp;<span class="op" id="5144609">=</span>&nbsp;<span class="num" id="5144611">255</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144623"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5144624">.</span><span class="ident" id="5144625"><a href="/gostd/image/jpeg/writer.go.html#5135247">quant</a></span><span class="op" id="5144630">[</span><span class="ident" id="5144631"><a href="/gostd/image/jpeg/writer.go.html#5144444">i</a></span><span class="op" id="5144632">]</span><span class="op" id="5144633">[</span><span class="ident" id="5144634"><a href="/gostd/image/jpeg/writer.go.html#5144471">j</a></span><span class="op" id="5144635">]</span>&nbsp;<span class="op" id="5144637">=</span>&nbsp;<span class="builtintype" id="5144639">uint8</span><span class="op" id="5144644">(</span><span class="ident" id="5144645"><a href="/gostd/image/jpeg/writer.go.html#5144498">x</a></span><span class="op" id="5144646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144656">//&nbsp;Compute&nbsp;number&nbsp;of&nbsp;components&nbsp;based&nbsp;on&nbsp;input&nbsp;image&nbsp;type.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144716">nComponent</span>&nbsp;<span class="op" id="5144727">:=</span>&nbsp;<span class="num" id="5144730">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144733">switch</span>&nbsp;<span class="ident" id="5144740"><a href="/gostd/image/jpeg/writer.go.html#5143815">m</a></span><span class="op" id="5144741">.</span><span class="op" id="5144742">(</span><span class="keyword" id="5144743">type</span><span class="op" id="5144747">)</span>&nbsp;<span class="op" id="5144749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144752">//&nbsp;TODO(wathiede):&nbsp;switch&nbsp;on&nbsp;m.ColorModel()&nbsp;instead&nbsp;of&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5144814">case</span>&nbsp;<span class="op" id="5144819">*</span><span class="ident" id="5144820"><a href="/gostd/image/jpeg/writer.go.html#5128574">image</a></span><span class="op" id="5144825">.</span><span class="ident" id="5144826"><a href="/gostd/image/image.go.html#5172029">Gray</a></span><span class="op" id="5144830">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144834"><a href="/gostd/image/jpeg/writer.go.html#5144716">nComponent</a></span>&nbsp;<span class="op" id="5144845">=</span>&nbsp;<span class="num" id="5144847">1</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5144850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144853">//&nbsp;Write&nbsp;the&nbsp;Start&nbsp;Of&nbsp;Image&nbsp;marker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144890"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5144891">.</span><span class="ident" id="5144892"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5144895">[</span><span class="num" id="5144896">0</span><span class="op" id="5144897">]</span>&nbsp;<span class="op" id="5144899">=</span>&nbsp;<span class="num" id="5144901">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144907"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5144908">.</span><span class="ident" id="5144909"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5144912">[</span><span class="num" id="5144913">1</span><span class="op" id="5144914">]</span>&nbsp;<span class="op" id="5144916">=</span>&nbsp;<span class="num" id="5144918">0xd8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144924"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5144925">.</span><span class="ident" id="5144926"><a href="/gostd/image/jpeg/writer.go.html#5135386">write</a></span><span class="op" id="5144931">(</span><span class="ident" id="5144932"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5144933">.</span><span class="ident" id="5144934"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5144937">[</span><span class="op" id="5144938">:</span><span class="num" id="5144939">2</span><span class="op" id="5144940">]</span><span class="op" id="5144941">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144944">//&nbsp;Write&nbsp;the&nbsp;quantization&nbsp;tables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5144979"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5144980">.</span><span class="ident" id="5144981"><a href="/gostd/image/jpeg/writer.go.html#5136931">writeDQT</a></span><span class="op" id="5144989">(</span><span class="op" id="5144990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5144993">//&nbsp;Write&nbsp;the&nbsp;image&nbsp;dimensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145025"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5145026">.</span><span class="ident" id="5145027"><a href="/gostd/image/jpeg/writer.go.html#5137198">writeSOF0</a></span><span class="op" id="5145036">(</span><span class="ident" id="5145037"><a href="/gostd/image/jpeg/writer.go.html#5143851">b</a></span><span class="op" id="5145038">.</span><span class="ident" id="5145039"><a href="/gostd/image/geom.go.html#5150413">Size</a></span><span class="op" id="5145043">(</span><span class="op" id="5145044">)</span><span class="op" id="5145045">,</span>&nbsp;<span class="ident" id="5145047"><a href="/gostd/image/jpeg/writer.go.html#5144716">nComponent</a></span><span class="op" id="5145057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145060">//&nbsp;Write&nbsp;the&nbsp;Huffman&nbsp;tables.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145090"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5145091">.</span><span class="ident" id="5145092"><a href="/gostd/image/jpeg/writer.go.html#5137926">writeDHT</a></span><span class="op" id="5145100">(</span><span class="ident" id="5145101"><a href="/gostd/image/jpeg/writer.go.html#5144716">nComponent</a></span><span class="op" id="5145111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145114">//&nbsp;Write&nbsp;the&nbsp;image&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145140"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5145141">.</span><span class="ident" id="5145142"><a href="/gostd/image/jpeg/writer.go.html#5142112">writeSOS</a></span><span class="op" id="5145150">(</span><span class="ident" id="5145151"><a href="/gostd/image/jpeg/writer.go.html#5143815">m</a></span><span class="op" id="5145152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5145155">//&nbsp;Write&nbsp;the&nbsp;End&nbsp;Of&nbsp;Image&nbsp;marker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145190"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5145191">.</span><span class="ident" id="5145192"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5145195">[</span><span class="num" id="5145196">0</span><span class="op" id="5145197">]</span>&nbsp;<span class="op" id="5145199">=</span>&nbsp;<span class="num" id="5145201">0xff</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145207"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5145208">.</span><span class="ident" id="5145209"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5145212">[</span><span class="num" id="5145213">1</span><span class="op" id="5145214">]</span>&nbsp;<span class="op" id="5145216">=</span>&nbsp;<span class="num" id="5145218">0xd9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145224"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5145225">.</span><span class="ident" id="5145226"><a href="/gostd/image/jpeg/writer.go.html#5135386">write</a></span><span class="op" id="5145231">(</span><span class="ident" id="5145232"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5145233">.</span><span class="ident" id="5145234"><a href="/gostd/image/jpeg/writer.go.html#5135095">buf</a></span><span class="op" id="5145237">[</span><span class="op" id="5145238">:</span><span class="num" id="5145239">2</span><span class="op" id="5145240">]</span><span class="op" id="5145241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5145244"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5145245">.</span><span class="ident" id="5145246"><a href="/gostd/image/jpeg/writer.go.html#5135303">flush</a></span><span class="op" id="5145251">(</span><span class="op" id="5145252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5145255">return</span>&nbsp;<span class="ident" id="5145262"><a href="/gostd/image/jpeg/writer.go.html#5143974">e</a></span><span class="op" id="5145263">.</span><span class="ident" id="5145264"><a href="/gostd/image/jpeg/writer.go.html#5135055">err</a></span><br>
<span class="lineno"></span><span class="op" id="5145268">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
