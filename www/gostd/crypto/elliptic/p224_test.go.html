<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html" class="current">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7862416">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7862472">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7862526">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7862577">package</span>&nbsp;<span class="ident" id="7862585">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7862595">import</span>&nbsp;<span class="op" id="7862602">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7862605">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7862617">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7862627">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7862630">var</span>&nbsp;<span class="ident" id="7862634">toFromBigTests</span>&nbsp;<span class="op" id="7862649">=</span>&nbsp;<span class="op" id="7862651">[</span><span class="op" id="7862652">]</span><span class="builtintype" id="7862653">string</span><span class="op" id="7862659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7862662">&#34;0&#34;</span><span class="op" id="7862665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7862668">&#34;1&#34;</span><span class="op" id="7862671">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7862674">&#34;23&#34;</span><span class="op" id="7862678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7862681">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="7862739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7862742">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="7862800">,</span><br>
<span class="lineno"></span><span class="op" id="7862802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7862805">func</span>&nbsp;<span class="ident" id="7862810">p224AlternativeToBig</span><span class="op" id="7862830">(</span><span class="ident" id="7862831">in</span>&nbsp;<span class="op" id="7862834">*</span><span class="ident" id="7862835">p224FieldElement</span><span class="op" id="7862851">)</span>&nbsp;<span class="op" id="7862853">*</span><span class="ident" id="7862854">big</span><span class="op" id="7862857">.</span><span class="ident" id="7862858">Int</span>&nbsp;<span class="op" id="7862862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862865">ret</span>&nbsp;<span class="op" id="7862869">:=</span>&nbsp;<span class="builtinfunc" id="7862872">new</span><span class="op" id="7862875">(</span><span class="ident" id="7862876">big</span><span class="op" id="7862879">.</span><span class="ident" id="7862880">Int</span><span class="op" id="7862883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862886">tmp</span>&nbsp;<span class="op" id="7862890">:=</span>&nbsp;<span class="builtinfunc" id="7862893">new</span><span class="op" id="7862896">(</span><span class="ident" id="7862897">big</span><span class="op" id="7862900">.</span><span class="ident" id="7862901">Int</span><span class="op" id="7862904">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7862908">for</span>&nbsp;<span class="ident" id="7862912">i</span>&nbsp;<span class="op" id="7862914">:=</span>&nbsp;<span class="builtintype" id="7862917">uint</span><span class="op" id="7862921">(</span><span class="num" id="7862922">0</span><span class="op" id="7862923">)</span><span class="op" id="7862924">;</span>&nbsp;<span class="ident" id="7862926">i</span>&nbsp;<span class="op" id="7862928">&lt;</span>&nbsp;<span class="num" id="7862930">8</span><span class="op" id="7862931">;</span>&nbsp;<span class="ident" id="7862933">i</span><span class="op" id="7862934">++</span>&nbsp;<span class="op" id="7862937">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862941">tmp</span><span class="op" id="7862944">.</span><span class="ident" id="7862945">SetInt64</span><span class="op" id="7862953">(</span><span class="builtintype" id="7862954">int64</span><span class="op" id="7862959">(</span><span class="ident" id="7862960">in</span><span class="op" id="7862962">[</span><span class="ident" id="7862963">i</span><span class="op" id="7862964">]</span><span class="op" id="7862965">)</span><span class="op" id="7862966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862970">tmp</span><span class="op" id="7862973">.</span><span class="ident" id="7862974">Lsh</span><span class="op" id="7862977">(</span><span class="ident" id="7862978">tmp</span><span class="op" id="7862981">,</span>&nbsp;<span class="num" id="7862983">28</span><span class="op" id="7862985">*</span><span class="ident" id="7862986">i</span><span class="op" id="7862987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862991">ret</span><span class="op" id="7862994">.</span><span class="ident" id="7862995">Add</span><span class="op" id="7862998">(</span><span class="ident" id="7862999">ret</span><span class="op" id="7863002">,</span>&nbsp;<span class="ident" id="7863004">tmp</span><span class="op" id="7863007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7863010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863013">ret</span><span class="op" id="7863016">.</span><span class="ident" id="7863017">Mod</span><span class="op" id="7863020">(</span><span class="ident" id="7863021">ret</span><span class="op" id="7863024">,</span>&nbsp;<span class="ident" id="7863026">p224</span><span class="op" id="7863030">.</span><span class="ident" id="7863031">P</span><span class="op" id="7863032">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7863035">return</span>&nbsp;<span class="ident" id="7863042">ret</span><br>
<span class="lineno"></span><span class="op" id="7863046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7863049">func</span>&nbsp;<span class="ident" id="7863054">TestToFromBig</span><span class="op" id="7863067">(</span><span class="ident" id="7863068">t</span>&nbsp;<span class="op" id="7863070">*</span><span class="ident" id="7863071">testing</span><span class="op" id="7863078">.</span><span class="ident" id="7863079">T</span><span class="op" id="7863080">)</span>&nbsp;<span class="op" id="7863082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7863085">for</span>&nbsp;<span class="ident" id="7863089">i</span><span class="op" id="7863090">,</span>&nbsp;<span class="ident" id="7863092">test</span>&nbsp;<span class="op" id="7863097">:=</span>&nbsp;<span class="keyword" id="7863100">range</span>&nbsp;<span class="ident" id="7863106">toFromBigTests</span>&nbsp;<span class="op" id="7863121">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863125">n</span><span class="op" id="7863126">,</span>&nbsp;<span class="ident" id="7863128">_</span>&nbsp;<span class="op" id="7863130">:=</span>&nbsp;<span class="builtinfunc" id="7863133">new</span><span class="op" id="7863136">(</span><span class="ident" id="7863137">big</span><span class="op" id="7863140">.</span><span class="ident" id="7863141">Int</span><span class="op" id="7863144">)</span><span class="op" id="7863145">.</span><span class="ident" id="7863146">SetString</span><span class="op" id="7863155">(</span><span class="ident" id="7863156">test</span><span class="op" id="7863160">,</span>&nbsp;<span class="num" id="7863162">16</span><span class="op" id="7863164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7863168">var</span>&nbsp;<span class="ident" id="7863172">x</span>&nbsp;<span class="ident" id="7863174">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863193">p224FromBig</span><span class="op" id="7863204">(</span><span class="op" id="7863205">&amp;</span><span class="ident" id="7863206">x</span><span class="op" id="7863207">,</span>&nbsp;<span class="ident" id="7863209">n</span><span class="op" id="7863210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863214">m</span>&nbsp;<span class="op" id="7863216">:=</span>&nbsp;<span class="ident" id="7863219">p224ToBig</span><span class="op" id="7863228">(</span><span class="op" id="7863229">&amp;</span><span class="ident" id="7863230">x</span><span class="op" id="7863231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7863235">if</span>&nbsp;<span class="ident" id="7863238">n</span><span class="op" id="7863239">.</span><span class="ident" id="7863240">Cmp</span><span class="op" id="7863243">(</span><span class="ident" id="7863244">m</span><span class="op" id="7863245">)</span>&nbsp;<span class="op" id="7863247">!=</span>&nbsp;<span class="num" id="7863250">0</span>&nbsp;<span class="op" id="7863252">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863257">t</span><span class="op" id="7863258">.</span><span class="ident" id="7863259">Errorf</span><span class="op" id="7863265">(</span><span class="string" id="7863266">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="7863281">,</span>&nbsp;<span class="ident" id="7863283">i</span><span class="op" id="7863284">,</span>&nbsp;<span class="ident" id="7863286">n</span><span class="op" id="7863287">,</span>&nbsp;<span class="ident" id="7863289">m</span><span class="op" id="7863290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7863294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863298">q</span>&nbsp;<span class="op" id="7863300">:=</span>&nbsp;<span class="ident" id="7863303">p224AlternativeToBig</span><span class="op" id="7863323">(</span><span class="op" id="7863324">&amp;</span><span class="ident" id="7863325">x</span><span class="op" id="7863326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7863330">if</span>&nbsp;<span class="ident" id="7863333">n</span><span class="op" id="7863334">.</span><span class="ident" id="7863335">Cmp</span><span class="op" id="7863338">(</span><span class="ident" id="7863339">q</span><span class="op" id="7863340">)</span>&nbsp;<span class="op" id="7863342">!=</span>&nbsp;<span class="num" id="7863345">0</span>&nbsp;<span class="op" id="7863347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863352">t</span><span class="op" id="7863353">.</span><span class="ident" id="7863354">Errorf</span><span class="op" id="7863360">(</span><span class="string" id="7863361">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="7863390">,</span>&nbsp;<span class="ident" id="7863392">i</span><span class="op" id="7863393">,</span>&nbsp;<span class="ident" id="7863395">n</span><span class="op" id="7863396">,</span>&nbsp;<span class="ident" id="7863398">m</span><span class="op" id="7863399">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7863403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7863406">}</span><br>
<span class="lineno"></span><span class="op" id="7863408">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
