<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html" class="current">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8106545">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8106600">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8106654">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8106705">package</span>&nbsp;<span class="ident" id="8106713">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8106718">import</span>&nbsp;<span class="op" id="8106725">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8106728">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8106738">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="8106741">func</span>&nbsp;<span class="ident" id="8106746">TestRoundUp</span><span class="op" id="8106757">(</span><span class="ident" id="8106758">t</span>&nbsp;<span class="op" id="8106760">*</span><span class="ident" id="8106761"><a href="/gostd/crypto/tls/conn_test.go.html#8106728">testing</a></span><span class="op" id="8106768">.</span><span class="ident" id="8106769"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8106770">)</span>&nbsp;<span class="op" id="8106772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8106775">if</span>&nbsp;<span class="ident" id="8106778"><a href="/gostd/crypto/tls/conn.go.html#4467937">roundUp</a></span><span class="op" id="8106785">(</span><span class="num" id="8106786">0</span><span class="op" id="8106787">,</span>&nbsp;<span class="num" id="8106789">16</span><span class="op" id="8106791">)</span>&nbsp;<span class="op" id="8106793">!=</span>&nbsp;<span class="num" id="8106796">0</span>&nbsp;<span class="op" id="8106798">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8106803"><a href="/gostd/crypto/tls/conn.go.html#4467937">roundUp</a></span><span class="op" id="8106810">(</span><span class="num" id="8106811">1</span><span class="op" id="8106812">,</span>&nbsp;<span class="num" id="8106814">16</span><span class="op" id="8106816">)</span>&nbsp;<span class="op" id="8106818">!=</span>&nbsp;<span class="num" id="8106821">16</span>&nbsp;<span class="op" id="8106824">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8106829"><a href="/gostd/crypto/tls/conn.go.html#4467937">roundUp</a></span><span class="op" id="8106836">(</span><span class="num" id="8106837">15</span><span class="op" id="8106839">,</span>&nbsp;<span class="num" id="8106841">16</span><span class="op" id="8106843">)</span>&nbsp;<span class="op" id="8106845">!=</span>&nbsp;<span class="num" id="8106848">16</span>&nbsp;<span class="op" id="8106851">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8106856"><a href="/gostd/crypto/tls/conn.go.html#4467937">roundUp</a></span><span class="op" id="8106863">(</span><span class="num" id="8106864">16</span><span class="op" id="8106866">,</span>&nbsp;<span class="num" id="8106868">16</span><span class="op" id="8106870">)</span>&nbsp;<span class="op" id="8106872">!=</span>&nbsp;<span class="num" id="8106875">16</span>&nbsp;<span class="op" id="8106878">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8106883"><a href="/gostd/crypto/tls/conn.go.html#4467937">roundUp</a></span><span class="op" id="8106890">(</span><span class="num" id="8106891">17</span><span class="op" id="8106893">,</span>&nbsp;<span class="num" id="8106895">16</span><span class="op" id="8106897">)</span>&nbsp;<span class="op" id="8106899">!=</span>&nbsp;<span class="num" id="8106902">32</span>&nbsp;<span class="op" id="8106905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8106909"><a href="/gostd/crypto/tls/conn_test.go.html#8106758">t</a></span><span class="op" id="8106910">.</span><span class="ident" id="8106911"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8106916">(</span><span class="string" id="8106917">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="8106933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8106936">}</span><br>
<span class="lineno"></span><span class="op" id="8106938">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8106941">var</span>&nbsp;<span class="ident" id="8106945">paddingTests</span>&nbsp;<span class="op" id="8106958">=</span>&nbsp;<span class="op" id="8106960">[</span><span class="op" id="8106961">]</span><span class="keyword" id="8106962">struct</span>&nbsp;<span class="op" id="8106969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8106972">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8106984">[</span><span class="op" id="8106985">]</span><span class="builtintype" id="8106986">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8106992">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8107004">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8107010">expectedLen</span>&nbsp;<span class="builtintype" id="8107022">int</span><br>
<span class="lineno">25</span><span class="op" id="8107026">}</span><span class="op" id="8107027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107030">{</span><span class="op" id="8107031">[</span><span class="op" id="8107032">]</span><span class="builtintype" id="8107033">byte</span><span class="op" id="8107037">{</span><span class="num" id="8107038">1</span><span class="op" id="8107039">,</span>&nbsp;<span class="num" id="8107041">2</span><span class="op" id="8107042">,</span>&nbsp;<span class="num" id="8107044">3</span><span class="op" id="8107045">,</span>&nbsp;<span class="num" id="8107047">4</span><span class="op" id="8107048">,</span>&nbsp;<span class="num" id="8107050">0</span><span class="op" id="8107051">}</span><span class="op" id="8107052">,</span>&nbsp;<span class="builtintype" id="8107054">true</span><span class="op" id="8107058">,</span>&nbsp;<span class="num" id="8107060">4</span><span class="op" id="8107061">}</span><span class="op" id="8107062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107065">{</span><span class="op" id="8107066">[</span><span class="op" id="8107067">]</span><span class="builtintype" id="8107068">byte</span><span class="op" id="8107072">{</span><span class="num" id="8107073">1</span><span class="op" id="8107074">,</span>&nbsp;<span class="num" id="8107076">2</span><span class="op" id="8107077">,</span>&nbsp;<span class="num" id="8107079">3</span><span class="op" id="8107080">,</span>&nbsp;<span class="num" id="8107082">4</span><span class="op" id="8107083">,</span>&nbsp;<span class="num" id="8107085">0</span><span class="op" id="8107086">,</span>&nbsp;<span class="num" id="8107088">1</span><span class="op" id="8107089">}</span><span class="op" id="8107090">,</span>&nbsp;<span class="builtintype" id="8107092">false</span><span class="op" id="8107097">,</span>&nbsp;<span class="num" id="8107099">0</span><span class="op" id="8107100">}</span><span class="op" id="8107101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107104">{</span><span class="op" id="8107105">[</span><span class="op" id="8107106">]</span><span class="builtintype" id="8107107">byte</span><span class="op" id="8107111">{</span><span class="num" id="8107112">1</span><span class="op" id="8107113">,</span>&nbsp;<span class="num" id="8107115">2</span><span class="op" id="8107116">,</span>&nbsp;<span class="num" id="8107118">3</span><span class="op" id="8107119">,</span>&nbsp;<span class="num" id="8107121">4</span><span class="op" id="8107122">,</span>&nbsp;<span class="num" id="8107124">99</span><span class="op" id="8107126">,</span>&nbsp;<span class="num" id="8107128">99</span><span class="op" id="8107130">}</span><span class="op" id="8107131">,</span>&nbsp;<span class="builtintype" id="8107133">false</span><span class="op" id="8107138">,</span>&nbsp;<span class="num" id="8107140">0</span><span class="op" id="8107141">}</span><span class="op" id="8107142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107145">{</span><span class="op" id="8107146">[</span><span class="op" id="8107147">]</span><span class="builtintype" id="8107148">byte</span><span class="op" id="8107152">{</span><span class="num" id="8107153">1</span><span class="op" id="8107154">,</span>&nbsp;<span class="num" id="8107156">2</span><span class="op" id="8107157">,</span>&nbsp;<span class="num" id="8107159">3</span><span class="op" id="8107160">,</span>&nbsp;<span class="num" id="8107162">4</span><span class="op" id="8107163">,</span>&nbsp;<span class="num" id="8107165">1</span><span class="op" id="8107166">,</span>&nbsp;<span class="num" id="8107168">1</span><span class="op" id="8107169">}</span><span class="op" id="8107170">,</span>&nbsp;<span class="builtintype" id="8107172">true</span><span class="op" id="8107176">,</span>&nbsp;<span class="num" id="8107178">4</span><span class="op" id="8107179">}</span><span class="op" id="8107180">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107183">{</span><span class="op" id="8107184">[</span><span class="op" id="8107185">]</span><span class="builtintype" id="8107186">byte</span><span class="op" id="8107190">{</span><span class="num" id="8107191">1</span><span class="op" id="8107192">,</span>&nbsp;<span class="num" id="8107194">2</span><span class="op" id="8107195">,</span>&nbsp;<span class="num" id="8107197">3</span><span class="op" id="8107198">,</span>&nbsp;<span class="num" id="8107200">2</span><span class="op" id="8107201">,</span>&nbsp;<span class="num" id="8107203">2</span><span class="op" id="8107204">,</span>&nbsp;<span class="num" id="8107206">2</span><span class="op" id="8107207">}</span><span class="op" id="8107208">,</span>&nbsp;<span class="builtintype" id="8107210">true</span><span class="op" id="8107214">,</span>&nbsp;<span class="num" id="8107216">3</span><span class="op" id="8107217">}</span><span class="op" id="8107218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107221">{</span><span class="op" id="8107222">[</span><span class="op" id="8107223">]</span><span class="builtintype" id="8107224">byte</span><span class="op" id="8107228">{</span><span class="num" id="8107229">1</span><span class="op" id="8107230">,</span>&nbsp;<span class="num" id="8107232">2</span><span class="op" id="8107233">,</span>&nbsp;<span class="num" id="8107235">3</span><span class="op" id="8107236">,</span>&nbsp;<span class="num" id="8107238">3</span><span class="op" id="8107239">,</span>&nbsp;<span class="num" id="8107241">3</span><span class="op" id="8107242">,</span>&nbsp;<span class="num" id="8107244">3</span><span class="op" id="8107245">}</span><span class="op" id="8107246">,</span>&nbsp;<span class="builtintype" id="8107248">true</span><span class="op" id="8107252">,</span>&nbsp;<span class="num" id="8107254">2</span><span class="op" id="8107255">}</span><span class="op" id="8107256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107259">{</span><span class="op" id="8107260">[</span><span class="op" id="8107261">]</span><span class="builtintype" id="8107262">byte</span><span class="op" id="8107266">{</span><span class="num" id="8107267">1</span><span class="op" id="8107268">,</span>&nbsp;<span class="num" id="8107270">2</span><span class="op" id="8107271">,</span>&nbsp;<span class="num" id="8107273">3</span><span class="op" id="8107274">,</span>&nbsp;<span class="num" id="8107276">4</span><span class="op" id="8107277">,</span>&nbsp;<span class="num" id="8107279">3</span><span class="op" id="8107280">,</span>&nbsp;<span class="num" id="8107282">3</span><span class="op" id="8107283">}</span><span class="op" id="8107284">,</span>&nbsp;<span class="builtintype" id="8107286">false</span><span class="op" id="8107291">,</span>&nbsp;<span class="num" id="8107293">0</span><span class="op" id="8107294">}</span><span class="op" id="8107295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107298">{</span><span class="op" id="8107299">[</span><span class="op" id="8107300">]</span><span class="builtintype" id="8107301">byte</span><span class="op" id="8107305">{</span><span class="num" id="8107306">1</span><span class="op" id="8107307">,</span>&nbsp;<span class="num" id="8107309">4</span><span class="op" id="8107310">,</span>&nbsp;<span class="num" id="8107312">4</span><span class="op" id="8107313">,</span>&nbsp;<span class="num" id="8107315">4</span><span class="op" id="8107316">,</span>&nbsp;<span class="num" id="8107318">4</span><span class="op" id="8107319">,</span>&nbsp;<span class="num" id="8107321">4</span><span class="op" id="8107322">}</span><span class="op" id="8107323">,</span>&nbsp;<span class="builtintype" id="8107325">true</span><span class="op" id="8107329">,</span>&nbsp;<span class="num" id="8107331">1</span><span class="op" id="8107332">}</span><span class="op" id="8107333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107336">{</span><span class="op" id="8107337">[</span><span class="op" id="8107338">]</span><span class="builtintype" id="8107339">byte</span><span class="op" id="8107343">{</span><span class="num" id="8107344">5</span><span class="op" id="8107345">,</span>&nbsp;<span class="num" id="8107347">5</span><span class="op" id="8107348">,</span>&nbsp;<span class="num" id="8107350">5</span><span class="op" id="8107351">,</span>&nbsp;<span class="num" id="8107353">5</span><span class="op" id="8107354">,</span>&nbsp;<span class="num" id="8107356">5</span><span class="op" id="8107357">,</span>&nbsp;<span class="num" id="8107359">5</span><span class="op" id="8107360">}</span><span class="op" id="8107361">,</span>&nbsp;<span class="builtintype" id="8107363">true</span><span class="op" id="8107367">,</span>&nbsp;<span class="num" id="8107369">0</span><span class="op" id="8107370">}</span><span class="op" id="8107371">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107374">{</span><span class="op" id="8107375">[</span><span class="op" id="8107376">]</span><span class="builtintype" id="8107377">byte</span><span class="op" id="8107381">{</span><span class="num" id="8107382">6</span><span class="op" id="8107383">,</span>&nbsp;<span class="num" id="8107385">6</span><span class="op" id="8107386">,</span>&nbsp;<span class="num" id="8107388">6</span><span class="op" id="8107389">,</span>&nbsp;<span class="num" id="8107391">6</span><span class="op" id="8107392">,</span>&nbsp;<span class="num" id="8107394">6</span><span class="op" id="8107395">,</span>&nbsp;<span class="num" id="8107397">6</span><span class="op" id="8107398">}</span><span class="op" id="8107399">,</span>&nbsp;<span class="builtintype" id="8107401">false</span><span class="op" id="8107406">,</span>&nbsp;<span class="num" id="8107408">0</span><span class="op" id="8107409">}</span><span class="op" id="8107410">,</span><br>
<span class="lineno"></span><span class="op" id="8107412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8107415">func</span>&nbsp;<span class="ident" id="8107420">TestRemovePadding</span><span class="op" id="8107437">(</span><span class="ident" id="8107438">t</span>&nbsp;<span class="op" id="8107440">*</span><span class="ident" id="8107441"><a href="/gostd/crypto/tls/conn_test.go.html#8106728">testing</a></span><span class="op" id="8107448">.</span><span class="ident" id="8107449"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8107450">)</span>&nbsp;<span class="op" id="8107452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8107455">for</span>&nbsp;<span class="ident" id="8107459">i</span><span class="op" id="8107460">,</span>&nbsp;<span class="ident" id="8107462">test</span>&nbsp;<span class="op" id="8107467">:=</span>&nbsp;<span class="keyword" id="8107470">range</span>&nbsp;<span class="ident" id="8107476"><a href="/gostd/crypto/tls/conn_test.go.html#8106945">paddingTests</a></span>&nbsp;<span class="op" id="8107489">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8107493">payload</span><span class="op" id="8107500">,</span>&nbsp;<span class="ident" id="8107502">good</span>&nbsp;<span class="op" id="8107507">:=</span>&nbsp;<span class="ident" id="8107510"><a href="/gostd/crypto/tls/conn.go.html#4466534">removePadding</a></span><span class="op" id="8107523">(</span><span class="ident" id="8107524"><a href="/gostd/crypto/tls/conn_test.go.html#8107462">test</a></span><span class="op" id="8107528">.</span><span class="ident" id="8107529"><a href="/gostd/crypto/tls/conn_test.go.html#8106972">in</a></span><span class="op" id="8107531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8107535">expectedGood</span>&nbsp;<span class="op" id="8107548">:=</span>&nbsp;<span class="builtintype" id="8107551">byte</span><span class="op" id="8107555">(</span><span class="num" id="8107556">255</span><span class="op" id="8107559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8107563">if</span>&nbsp;<span class="op" id="8107566">!</span><span class="ident" id="8107567"><a href="/gostd/crypto/tls/conn_test.go.html#8107462">test</a></span><span class="op" id="8107571">.</span><span class="ident" id="8107572"><a href="/gostd/crypto/tls/conn_test.go.html#8106992">good</a></span>&nbsp;<span class="op" id="8107577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8107582"><a href="/gostd/crypto/tls/conn_test.go.html#8107535">expectedGood</a></span>&nbsp;<span class="op" id="8107595">=</span>&nbsp;<span class="num" id="8107597">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107601">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8107605">if</span>&nbsp;<span class="ident" id="8107608"><a href="/gostd/crypto/tls/conn_test.go.html#8107502">good</a></span>&nbsp;<span class="op" id="8107613">!=</span>&nbsp;<span class="ident" id="8107616"><a href="/gostd/crypto/tls/conn_test.go.html#8107535">expectedGood</a></span>&nbsp;<span class="op" id="8107629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8107634"><a href="/gostd/crypto/tls/conn_test.go.html#8107438">t</a></span><span class="op" id="8107635">.</span><span class="ident" id="8107636"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8107642">(</span><span class="string" id="8107643">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="8107680">,</span>&nbsp;<span class="ident" id="8107682"><a href="/gostd/crypto/tls/conn_test.go.html#8107459">i</a></span><span class="op" id="8107683">,</span>&nbsp;<span class="ident" id="8107685"><a href="/gostd/crypto/tls/conn_test.go.html#8107535">expectedGood</a></span><span class="op" id="8107697">,</span>&nbsp;<span class="ident" id="8107699"><a href="/gostd/crypto/tls/conn_test.go.html#8107502">good</a></span><span class="op" id="8107703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8107711">if</span>&nbsp;<span class="ident" id="8107714"><a href="/gostd/crypto/tls/conn_test.go.html#8107502">good</a></span>&nbsp;<span class="op" id="8107719">==</span>&nbsp;<span class="num" id="8107722">255</span>&nbsp;<span class="op" id="8107726">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8107729">len</span><span class="op" id="8107732">(</span><span class="ident" id="8107733"><a href="/gostd/crypto/tls/conn_test.go.html#8107493">payload</a></span><span class="op" id="8107740">)</span>&nbsp;<span class="op" id="8107742">!=</span>&nbsp;<span class="ident" id="8107745"><a href="/gostd/crypto/tls/conn_test.go.html#8107462">test</a></span><span class="op" id="8107749">.</span><span class="ident" id="8107750"><a href="/gostd/crypto/tls/conn_test.go.html#8107010">expectedLen</a></span>&nbsp;<span class="op" id="8107762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8107767"><a href="/gostd/crypto/tls/conn_test.go.html#8107438">t</a></span><span class="op" id="8107768">.</span><span class="ident" id="8107769"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8107775">(</span><span class="string" id="8107776">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8107798">,</span>&nbsp;<span class="ident" id="8107800"><a href="/gostd/crypto/tls/conn_test.go.html#8107459">i</a></span><span class="op" id="8107801">,</span>&nbsp;<span class="builtinfunc" id="8107803">len</span><span class="op" id="8107806">(</span><span class="ident" id="8107807"><a href="/gostd/crypto/tls/conn_test.go.html#8107493">payload</a></span><span class="op" id="8107814">)</span><span class="op" id="8107815">,</span>&nbsp;<span class="ident" id="8107817"><a href="/gostd/crypto/tls/conn_test.go.html#8107462">test</a></span><span class="op" id="8107821">.</span><span class="ident" id="8107822"><a href="/gostd/crypto/tls/conn_test.go.html#8107010">expectedLen</a></span><span class="op" id="8107833">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8107840">}</span><br>
<span class="lineno"></span><span class="op" id="8107842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8107845">var</span>&nbsp;<span class="ident" id="8107849">certExampleCom</span>&nbsp;<span class="op" id="8107864">=</span>&nbsp;<span class="string" id="8107866">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="8108518">var</span>&nbsp;<span class="ident" id="8108522">certWildcardExampleCom</span>&nbsp;<span class="op" id="8108545">=</span>&nbsp;<span class="string" id="8108547">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8109203">var</span>&nbsp;<span class="ident" id="8109207">certFooExampleCom</span>&nbsp;<span class="op" id="8109225">=</span>&nbsp;<span class="string" id="8109227">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="8109887">var</span>&nbsp;<span class="ident" id="8109891">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="8109920">=</span>&nbsp;<span class="string" id="8109922">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8110582">func</span>&nbsp;<span class="ident" id="8110587">TestCertificateSelection</span><span class="op" id="8110611">(</span><span class="ident" id="8110612">t</span>&nbsp;<span class="op" id="8110614">*</span><span class="ident" id="8110615"><a href="/gostd/crypto/tls/conn_test.go.html#8106728">testing</a></span><span class="op" id="8110622">.</span><span class="ident" id="8110623"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8110624">)</span>&nbsp;<span class="op" id="8110626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8110629">config</span>&nbsp;<span class="op" id="8110636">:=</span>&nbsp;<span class="ident" id="8110639"><a href="/gostd/crypto/tls/common.go.html#4450481">Config</a></span><span class="op" id="8110645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8110649"><a href="/gostd/crypto/tls/common.go.html#4451046">Certificates</a></span><span class="op" id="8110661">:</span>&nbsp;<span class="op" id="8110663">[</span><span class="op" id="8110664">]</span><span class="ident" id="8110665"><a href="/gostd/crypto/tls/common.go.html#4457987">Certificate</a></span><span class="op" id="8110676">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8110681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8110687"><a href="/gostd/crypto/tls/common.go.html#4458009">Certificate</a></span><span class="op" id="8110698">:</span>&nbsp;<span class="op" id="8110700">[</span><span class="op" id="8110701">]</span><span class="op" id="8110702">[</span><span class="op" id="8110703">]</span><span class="builtintype" id="8110704">byte</span><span class="op" id="8110708">{</span><span class="ident" id="8110709"><a href="/gostd/crypto/tls/handshake_server_test.go.html#8157927">fromHex</a></span><span class="op" id="8110716">(</span><span class="ident" id="8110717"><a href="/gostd/crypto/tls/conn_test.go.html#8107849">certExampleCom</a></span><span class="op" id="8110731">)</span><span class="op" id="8110732">}</span><span class="op" id="8110733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8110738">}</span><span class="op" id="8110739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8110744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8110750"><a href="/gostd/crypto/tls/common.go.html#4458009">Certificate</a></span><span class="op" id="8110761">:</span>&nbsp;<span class="op" id="8110763">[</span><span class="op" id="8110764">]</span><span class="op" id="8110765">[</span><span class="op" id="8110766">]</span><span class="builtintype" id="8110767">byte</span><span class="op" id="8110771">{</span><span class="ident" id="8110772"><a href="/gostd/crypto/tls/handshake_server_test.go.html#8157927">fromHex</a></span><span class="op" id="8110779">(</span><span class="ident" id="8110780"><a href="/gostd/crypto/tls/conn_test.go.html#8108522">certWildcardExampleCom</a></span><span class="op" id="8110802">)</span><span class="op" id="8110803">}</span><span class="op" id="8110804">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8110809">}</span><span class="op" id="8110810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8110815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8110821"><a href="/gostd/crypto/tls/common.go.html#4458009">Certificate</a></span><span class="op" id="8110832">:</span>&nbsp;<span class="op" id="8110834">[</span><span class="op" id="8110835">]</span><span class="op" id="8110836">[</span><span class="op" id="8110837">]</span><span class="builtintype" id="8110838">byte</span><span class="op" id="8110842">{</span><span class="ident" id="8110843"><a href="/gostd/crypto/tls/handshake_server_test.go.html#8157927">fromHex</a></span><span class="op" id="8110850">(</span><span class="ident" id="8110851"><a href="/gostd/crypto/tls/conn_test.go.html#8109207">certFooExampleCom</a></span><span class="op" id="8110868">)</span><span class="op" id="8110869">}</span><span class="op" id="8110870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8110875">}</span><span class="op" id="8110876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8110881">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8110887"><a href="/gostd/crypto/tls/common.go.html#4458009">Certificate</a></span><span class="op" id="8110898">:</span>&nbsp;<span class="op" id="8110900">[</span><span class="op" id="8110901">]</span><span class="op" id="8110902">[</span><span class="op" id="8110903">]</span><span class="builtintype" id="8110904">byte</span><span class="op" id="8110908">{</span><span class="ident" id="8110909"><a href="/gostd/crypto/tls/handshake_server_test.go.html#8157927">fromHex</a></span><span class="op" id="8110916">(</span><span class="ident" id="8110917"><a href="/gostd/crypto/tls/conn_test.go.html#8109891">certDoubleWildcardExampleCom</a></span><span class="op" id="8110945">)</span><span class="op" id="8110946">}</span><span class="op" id="8110947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8110952">}</span><span class="op" id="8110953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8110957">}</span><span class="op" id="8110958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8110961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8110965"><a href="/gostd/crypto/tls/conn_test.go.html#8110629">config</a></span><span class="op" id="8110971">.</span><span class="ident" id="8110972"><a href="/gostd/crypto/tls/common.go.html#4457481">BuildNameToCertificate</a></span><span class="op" id="8110994">(</span><span class="op" id="8110995">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8110999">pointerToIndex</span>&nbsp;<span class="op" id="8111014">:=</span>&nbsp;<span class="keyword" id="8111017">func</span><span class="op" id="8111021">(</span><span class="ident" id="8111022">c</span>&nbsp;<span class="op" id="8111024">*</span><span class="ident" id="8111025"><a href="/gostd/crypto/tls/common.go.html#4457987">Certificate</a></span><span class="op" id="8111036">)</span>&nbsp;<span class="builtintype" id="8111038">int</span>&nbsp;<span class="op" id="8111042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111046">for</span>&nbsp;<span class="ident" id="8111050">i</span>&nbsp;<span class="op" id="8111052">:=</span>&nbsp;<span class="keyword" id="8111055">range</span>&nbsp;<span class="ident" id="8111061"><a href="/gostd/crypto/tls/conn_test.go.html#8110629">config</a></span><span class="op" id="8111067">.</span><span class="ident" id="8111068"><a href="/gostd/crypto/tls/common.go.html#4451046">Certificates</a></span>&nbsp;<span class="op" id="8111081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111086">if</span>&nbsp;<span class="ident" id="8111089"><a href="/gostd/crypto/tls/conn_test.go.html#8111022">c</a></span>&nbsp;<span class="op" id="8111091">==</span>&nbsp;<span class="op" id="8111094">&amp;</span><span class="ident" id="8111095"><a href="/gostd/crypto/tls/conn_test.go.html#8110629">config</a></span><span class="op" id="8111101">.</span><span class="ident" id="8111102"><a href="/gostd/crypto/tls/common.go.html#4451046">Certificates</a></span><span class="op" id="8111114">[</span><span class="ident" id="8111115"><a href="/gostd/crypto/tls/conn_test.go.html#8111050">i</a></span><span class="op" id="8111116">]</span>&nbsp;<span class="op" id="8111118">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111124">return</span>&nbsp;<span class="ident" id="8111131"><a href="/gostd/crypto/tls/conn_test.go.html#8111050">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8111136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8111140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111144">return</span>&nbsp;<span class="op" id="8111151">-</span><span class="num" id="8111152">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8111155">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8111159">certificateForName</span>&nbsp;<span class="op" id="8111178">:=</span>&nbsp;<span class="keyword" id="8111181">func</span><span class="op" id="8111185">(</span><span class="ident" id="8111186">name</span>&nbsp;<span class="builtintype" id="8111191">string</span><span class="op" id="8111197">)</span>&nbsp;<span class="op" id="8111199">*</span><span class="ident" id="8111200"><a href="/gostd/crypto/tls/common.go.html#4457987">Certificate</a></span>&nbsp;<span class="op" id="8111212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8111216">clientHello</span>&nbsp;<span class="op" id="8111228">:=</span>&nbsp;<span class="op" id="8111231">&amp;</span><span class="ident" id="8111232"><a href="/gostd/crypto/tls/common.go.html#4449371">ClientHelloInfo</a></span><span class="op" id="8111247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8111252"><a href="/gostd/crypto/tls/common.go.html#4449747">ServerName</a></span><span class="op" id="8111262">:</span>&nbsp;<span class="ident" id="8111264"><a href="/gostd/crypto/tls/conn_test.go.html#8111186">name</a></span><span class="op" id="8111268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8111272">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111276">if</span>&nbsp;<span class="ident" id="8111279">cert</span><span class="op" id="8111283">,</span>&nbsp;<span class="ident" id="8111285">err</span>&nbsp;<span class="op" id="8111289">:=</span>&nbsp;<span class="ident" id="8111292"><a href="/gostd/crypto/tls/conn_test.go.html#8110629">config</a></span><span class="op" id="8111298">.</span><span class="ident" id="8111299"><a href="/gostd/crypto/tls/common.go.html#4456362">getCertificate</a></span><span class="op" id="8111313">(</span><span class="ident" id="8111314"><a href="/gostd/crypto/tls/conn_test.go.html#8111216">clientHello</a></span><span class="op" id="8111325">)</span><span class="op" id="8111326">;</span>&nbsp;<span class="ident" id="8111328"><a href="/gostd/crypto/tls/conn_test.go.html#8111285">err</a></span>&nbsp;<span class="op" id="8111332">!=</span>&nbsp;<span class="builtintype" id="8111335">nil</span>&nbsp;<span class="op" id="8111339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8111344"><a href="/gostd/crypto/tls/conn_test.go.html#8110612">t</a></span><span class="op" id="8111345">.</span><span class="ident" id="8111346"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8111352">(</span><span class="string" id="8111353">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="8111398">,</span>&nbsp;<span class="ident" id="8111400"><a href="/gostd/crypto/tls/conn_test.go.html#8111186">name</a></span><span class="op" id="8111404">,</span>&nbsp;<span class="ident" id="8111406"><a href="/gostd/crypto/tls/conn_test.go.html#8111285">err</a></span><span class="op" id="8111409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111414">return</span>&nbsp;<span class="builtintype" id="8111421">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8111427">}</span>&nbsp;<span class="keyword" id="8111429">else</span>&nbsp;<span class="op" id="8111434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111439">return</span>&nbsp;<span class="ident" id="8111446"><a href="/gostd/crypto/tls/conn_test.go.html#8111279">cert</a></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8111453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8111456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111460">if</span>&nbsp;<span class="ident" id="8111463">n</span>&nbsp;<span class="op" id="8111465">:=</span>&nbsp;<span class="ident" id="8111468"><a href="/gostd/crypto/tls/conn_test.go.html#8110999">pointerToIndex</a></span><span class="op" id="8111482">(</span><span class="ident" id="8111483"><a href="/gostd/crypto/tls/conn_test.go.html#8111159">certificateForName</a></span><span class="op" id="8111501">(</span><span class="string" id="8111502">&#34;example.com&#34;</span><span class="op" id="8111515">)</span><span class="op" id="8111516">)</span><span class="op" id="8111517">;</span>&nbsp;<span class="ident" id="8111519"><a href="/gostd/crypto/tls/conn_test.go.html#8111463">n</a></span>&nbsp;<span class="op" id="8111521">!=</span>&nbsp;<span class="num" id="8111524">0</span>&nbsp;<span class="op" id="8111526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8111530"><a href="/gostd/crypto/tls/conn_test.go.html#8110612">t</a></span><span class="op" id="8111531">.</span><span class="ident" id="8111532"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8111538">(</span><span class="string" id="8111539">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="8111583">,</span>&nbsp;<span class="ident" id="8111585"><a href="/gostd/crypto/tls/conn_test.go.html#8111463">n</a></span><span class="op" id="8111586">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8111589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111592">if</span>&nbsp;<span class="ident" id="8111595">n</span>&nbsp;<span class="op" id="8111597">:=</span>&nbsp;<span class="ident" id="8111600"><a href="/gostd/crypto/tls/conn_test.go.html#8110999">pointerToIndex</a></span><span class="op" id="8111614">(</span><span class="ident" id="8111615"><a href="/gostd/crypto/tls/conn_test.go.html#8111159">certificateForName</a></span><span class="op" id="8111633">(</span><span class="string" id="8111634">&#34;bar.example.com&#34;</span><span class="op" id="8111651">)</span><span class="op" id="8111652">)</span><span class="op" id="8111653">;</span>&nbsp;<span class="ident" id="8111655"><a href="/gostd/crypto/tls/conn_test.go.html#8111595">n</a></span>&nbsp;<span class="op" id="8111657">!=</span>&nbsp;<span class="num" id="8111660">1</span>&nbsp;<span class="op" id="8111662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8111666"><a href="/gostd/crypto/tls/conn_test.go.html#8110612">t</a></span><span class="op" id="8111667">.</span><span class="ident" id="8111668"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8111674">(</span><span class="string" id="8111675">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="8111723">,</span>&nbsp;<span class="ident" id="8111725"><a href="/gostd/crypto/tls/conn_test.go.html#8111595">n</a></span><span class="op" id="8111726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8111729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111732">if</span>&nbsp;<span class="ident" id="8111735">n</span>&nbsp;<span class="op" id="8111737">:=</span>&nbsp;<span class="ident" id="8111740"><a href="/gostd/crypto/tls/conn_test.go.html#8110999">pointerToIndex</a></span><span class="op" id="8111754">(</span><span class="ident" id="8111755"><a href="/gostd/crypto/tls/conn_test.go.html#8111159">certificateForName</a></span><span class="op" id="8111773">(</span><span class="string" id="8111774">&#34;foo.example.com&#34;</span><span class="op" id="8111791">)</span><span class="op" id="8111792">)</span><span class="op" id="8111793">;</span>&nbsp;<span class="ident" id="8111795"><a href="/gostd/crypto/tls/conn_test.go.html#8111735">n</a></span>&nbsp;<span class="op" id="8111797">!=</span>&nbsp;<span class="num" id="8111800">2</span>&nbsp;<span class="op" id="8111802">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8111806"><a href="/gostd/crypto/tls/conn_test.go.html#8110612">t</a></span><span class="op" id="8111807">.</span><span class="ident" id="8111808"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8111814">(</span><span class="string" id="8111815">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="8111863">,</span>&nbsp;<span class="ident" id="8111865"><a href="/gostd/crypto/tls/conn_test.go.html#8111735">n</a></span><span class="op" id="8111866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8111869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8111872">if</span>&nbsp;<span class="ident" id="8111875">n</span>&nbsp;<span class="op" id="8111877">:=</span>&nbsp;<span class="ident" id="8111880"><a href="/gostd/crypto/tls/conn_test.go.html#8110999">pointerToIndex</a></span><span class="op" id="8111894">(</span><span class="ident" id="8111895"><a href="/gostd/crypto/tls/conn_test.go.html#8111159">certificateForName</a></span><span class="op" id="8111913">(</span><span class="string" id="8111914">&#34;foo.bar.example.com&#34;</span><span class="op" id="8111935">)</span><span class="op" id="8111936">)</span><span class="op" id="8111937">;</span>&nbsp;<span class="ident" id="8111939"><a href="/gostd/crypto/tls/conn_test.go.html#8111875">n</a></span>&nbsp;<span class="op" id="8111941">!=</span>&nbsp;<span class="num" id="8111944">3</span>&nbsp;<span class="op" id="8111946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8111950"><a href="/gostd/crypto/tls/conn_test.go.html#8110612">t</a></span><span class="op" id="8111951">.</span><span class="ident" id="8111952"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8111958">(</span><span class="string" id="8111959">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="8112011">,</span>&nbsp;<span class="ident" id="8112013"><a href="/gostd/crypto/tls/conn_test.go.html#8111875">n</a></span><span class="op" id="8112014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8112017">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8112020">if</span>&nbsp;<span class="ident" id="8112023">n</span>&nbsp;<span class="op" id="8112025">:=</span>&nbsp;<span class="ident" id="8112028"><a href="/gostd/crypto/tls/conn_test.go.html#8110999">pointerToIndex</a></span><span class="op" id="8112042">(</span><span class="ident" id="8112043"><a href="/gostd/crypto/tls/conn_test.go.html#8111159">certificateForName</a></span><span class="op" id="8112061">(</span><span class="string" id="8112062">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="8112087">)</span><span class="op" id="8112088">)</span><span class="op" id="8112089">;</span>&nbsp;<span class="ident" id="8112091"><a href="/gostd/crypto/tls/conn_test.go.html#8112023">n</a></span>&nbsp;<span class="op" id="8112093">!=</span>&nbsp;<span class="num" id="8112096">0</span>&nbsp;<span class="op" id="8112098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8112102"><a href="/gostd/crypto/tls/conn_test.go.html#8110612">t</a></span><span class="op" id="8112103">.</span><span class="ident" id="8112104"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8112110">(</span><span class="string" id="8112111">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="8112167">,</span>&nbsp;<span class="ident" id="8112169"><a href="/gostd/crypto/tls/conn_test.go.html#8112023">n</a></span><span class="op" id="8112170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8112173">}</span><br>
<span class="lineno"></span><span class="op" id="8112175">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
