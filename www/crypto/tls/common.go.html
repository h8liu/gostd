<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4107832">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4107887">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4107941">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4107992">package</span>&nbsp;<span class="ident" id="4108000">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4108005">import</span>&nbsp;<span class="op" id="4108012">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4108015">&#34;container/list&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4108033">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4108043">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4108058">&#34;crypto/x509&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4108073">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4108080">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4108086">&#34;math/big&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4108098">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4108109">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4108117">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4108124">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="4108127">const</span>&nbsp;<span class="op" id="4108133">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108136">VersionSSL30</span>&nbsp;<span class="op" id="4108149">=</span>&nbsp;<span class="num" id="4108151">0x0300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108159">VersionTLS10</span>&nbsp;<span class="op" id="4108172">=</span>&nbsp;<span class="num" id="4108174">0x0301</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108182">VersionTLS11</span>&nbsp;<span class="op" id="4108195">=</span>&nbsp;<span class="num" id="4108197">0x0302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108205">VersionTLS12</span>&nbsp;<span class="op" id="4108218">=</span>&nbsp;<span class="num" id="4108220">0x0303</span><br>
<span class="lineno">25</span><span class="op" id="4108227">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4108230">const</span>&nbsp;<span class="op" id="4108236">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108239">maxPlaintext</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108255">=</span>&nbsp;<span class="num" id="4108257">16384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4108270">//&nbsp;maximum&nbsp;plaintext&nbsp;payload&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108307">maxCiphertext</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4108323">=</span>&nbsp;<span class="num" id="4108325">16384</span>&nbsp;<span class="op" id="4108331">+</span>&nbsp;<span class="num" id="4108333">2048</span>&nbsp;<span class="comment" id="4108338">//&nbsp;maximum&nbsp;ciphertext&nbsp;payload&nbsp;length</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108376">recordHeaderLen</span>&nbsp;<span class="op" id="4108392">=</span>&nbsp;<span class="num" id="4108394">5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4108407">//&nbsp;record&nbsp;header&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108432">maxHandshake</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108448">=</span>&nbsp;<span class="num" id="4108450">65536</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4108463">//&nbsp;maximum&nbsp;handshake&nbsp;we&nbsp;support&nbsp;(protocol&nbsp;max&nbsp;is&nbsp;16&nbsp;MB)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108521">minVersion</span>&nbsp;<span class="op" id="4108532">=</span>&nbsp;<span class="ident" id="4108534"><a href="/crypto/tls/common.go.html#4108136">VersionSSL30</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108548">maxVersion</span>&nbsp;<span class="op" id="4108559">=</span>&nbsp;<span class="ident" id="4108561"><a href="/crypto/tls/common.go.html#4108205">VersionTLS12</a></span><br>
<span class="lineno">35</span><span class="op" id="4108574">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4108577">//&nbsp;TLS&nbsp;record&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="4108598">type</span>&nbsp;<span class="ident" id="4108603">recordType</span>&nbsp;<span class="builtintype" id="4108614">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4108621">const</span>&nbsp;<span class="op" id="4108627">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108630">recordTypeChangeCipherSpec</span>&nbsp;<span class="ident" id="4108657"><a href="/crypto/tls/common.go.html#4108603">recordType</a></span>&nbsp;<span class="op" id="4108668">=</span>&nbsp;<span class="num" id="4108670">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108674">recordTypeAlert</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108701"><a href="/crypto/tls/common.go.html#4108603">recordType</a></span>&nbsp;<span class="op" id="4108712">=</span>&nbsp;<span class="num" id="4108714">21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108718">recordTypeHandshake</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108745"><a href="/crypto/tls/common.go.html#4108603">recordType</a></span>&nbsp;<span class="op" id="4108756">=</span>&nbsp;<span class="num" id="4108758">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108762">recordTypeApplicationData</span>&nbsp;&nbsp;<span class="ident" id="4108789"><a href="/crypto/tls/common.go.html#4108603">recordType</a></span>&nbsp;<span class="op" id="4108800">=</span>&nbsp;<span class="num" id="4108802">23</span><br>
<span class="lineno">45</span><span class="op" id="4108805">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4108808">//&nbsp;TLS&nbsp;handshake&nbsp;message&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="4108840">const</span>&nbsp;<span class="op" id="4108846">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108849">typeClientHello</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4108872">uint8</span>&nbsp;<span class="op" id="4108878">=</span>&nbsp;<span class="num" id="4108880">1</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108883">typeServerHello</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4108906">uint8</span>&nbsp;<span class="op" id="4108912">=</span>&nbsp;<span class="num" id="4108914">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108917">typeNewSessionTicket</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4108940">uint8</span>&nbsp;<span class="op" id="4108946">=</span>&nbsp;<span class="num" id="4108948">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108951">typeCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4108974">uint8</span>&nbsp;<span class="op" id="4108980">=</span>&nbsp;<span class="num" id="4108982">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108986">typeServerKeyExchange</span>&nbsp;&nbsp;<span class="builtintype" id="4109009">uint8</span>&nbsp;<span class="op" id="4109015">=</span>&nbsp;<span class="num" id="4109017">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109021">typeCertificateRequest</span>&nbsp;<span class="builtintype" id="4109044">uint8</span>&nbsp;<span class="op" id="4109050">=</span>&nbsp;<span class="num" id="4109052">13</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109056">typeServerHelloDone</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109079">uint8</span>&nbsp;<span class="op" id="4109085">=</span>&nbsp;<span class="num" id="4109087">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109091">typeCertificateVerify</span>&nbsp;&nbsp;<span class="builtintype" id="4109114">uint8</span>&nbsp;<span class="op" id="4109120">=</span>&nbsp;<span class="num" id="4109122">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109126">typeClientKeyExchange</span>&nbsp;&nbsp;<span class="builtintype" id="4109149">uint8</span>&nbsp;<span class="op" id="4109155">=</span>&nbsp;<span class="num" id="4109157">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109161">typeFinished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109184">uint8</span>&nbsp;<span class="op" id="4109190">=</span>&nbsp;<span class="num" id="4109192">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109196">typeCertificateStatus</span>&nbsp;&nbsp;<span class="builtintype" id="4109219">uint8</span>&nbsp;<span class="op" id="4109225">=</span>&nbsp;<span class="num" id="4109227">22</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109231">typeNextProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109254">uint8</span>&nbsp;<span class="op" id="4109260">=</span>&nbsp;<span class="num" id="4109262">67</span>&nbsp;<span class="comment" id="4109265">//&nbsp;Not&nbsp;IANA&nbsp;assigned</span><br>
<span class="lineno"></span><span class="op" id="4109286">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4109289">//&nbsp;TLS&nbsp;compression&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="4109315">const</span>&nbsp;<span class="op" id="4109321">(</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109324">compressionNone</span>&nbsp;<span class="builtintype" id="4109340">uint8</span>&nbsp;<span class="op" id="4109346">=</span>&nbsp;<span class="num" id="4109348">0</span><br>
<span class="lineno"></span><span class="op" id="4109350">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4109353">//&nbsp;TLS&nbsp;extension&nbsp;numbers</span><br>
<span class="lineno"></span><span class="keyword" id="4109378">const</span>&nbsp;<span class="op" id="4109384">(</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109387">extensionServerName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109416">uint16</span>&nbsp;<span class="op" id="4109423">=</span>&nbsp;<span class="num" id="4109425">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109428">extensionStatusRequest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109457">uint16</span>&nbsp;<span class="op" id="4109464">=</span>&nbsp;<span class="num" id="4109466">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109469">extensionSupportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109498">uint16</span>&nbsp;<span class="op" id="4109505">=</span>&nbsp;<span class="num" id="4109507">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109511">extensionSupportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109540">uint16</span>&nbsp;<span class="op" id="4109547">=</span>&nbsp;<span class="num" id="4109549">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109553">extensionSignatureAlgorithms</span>&nbsp;<span class="builtintype" id="4109582">uint16</span>&nbsp;<span class="op" id="4109589">=</span>&nbsp;<span class="num" id="4109591">13</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109595">extensionALPN</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109624">uint16</span>&nbsp;<span class="op" id="4109631">=</span>&nbsp;<span class="num" id="4109633">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109637">extensionSessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109666">uint16</span>&nbsp;<span class="op" id="4109673">=</span>&nbsp;<span class="num" id="4109675">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109679">extensionNextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109708">uint16</span>&nbsp;<span class="op" id="4109715">=</span>&nbsp;<span class="num" id="4109717">13172</span>&nbsp;<span class="comment" id="4109723">//&nbsp;not&nbsp;IANA&nbsp;assigned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109745">extensionRenegotiationInfo</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4109774">uint16</span>&nbsp;<span class="op" id="4109781">=</span>&nbsp;<span class="num" id="4109783">0xff01</span><br>
<span class="lineno"></span><span class="op" id="4109790">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4109793">//&nbsp;TLS&nbsp;signaling&nbsp;cipher&nbsp;suite&nbsp;values</span><br>
<span class="lineno"></span><span class="keyword" id="4109830">const</span>&nbsp;<span class="op" id="4109836">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109839">scsvRenegotiation</span>&nbsp;<span class="builtintype" id="4109857">uint16</span>&nbsp;<span class="op" id="4109864">=</span>&nbsp;<span class="num" id="4109866">0x00ff</span><br>
<span class="lineno"></span><span class="op" id="4109873">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="4109876">//&nbsp;CurveID&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;TLS&nbsp;identifier&nbsp;for&nbsp;an&nbsp;elliptic&nbsp;curve.&nbsp;See</span><br>
<span class="lineno"></span><span class="comment" id="4109946">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml#tls-parameters-8</span><br>
<span class="lineno"></span><span class="keyword" id="4110032">type</span>&nbsp;<span class="ident" id="4110037">CurveID</span>&nbsp;<span class="builtintype" id="4110045">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="4110053">const</span>&nbsp;<span class="op" id="4110059">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110062">CurveP256</span>&nbsp;<span class="ident" id="4110072"><a href="/crypto/tls/common.go.html#4110037">CurveID</a></span>&nbsp;<span class="op" id="4110080">=</span>&nbsp;<span class="num" id="4110082">23</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110086">CurveP384</span>&nbsp;<span class="ident" id="4110096"><a href="/crypto/tls/common.go.html#4110037">CurveID</a></span>&nbsp;<span class="op" id="4110104">=</span>&nbsp;<span class="num" id="4110106">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110110">CurveP521</span>&nbsp;<span class="ident" id="4110120"><a href="/crypto/tls/common.go.html#4110037">CurveID</a></span>&nbsp;<span class="op" id="4110128">=</span>&nbsp;<span class="num" id="4110130">25</span><br>
<span class="lineno"></span><span class="op" id="4110133">)</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="4110136">//&nbsp;TLS&nbsp;Elliptic&nbsp;Curve&nbsp;Point&nbsp;Formats</span><br>
<span class="lineno"></span><span class="comment" id="4110172">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml#tls-parameters-9</span><br>
<span class="lineno"></span><span class="keyword" id="4110258">const</span>&nbsp;<span class="op" id="4110264">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110267">pointFormatUncompressed</span>&nbsp;<span class="builtintype" id="4110291">uint8</span>&nbsp;<span class="op" id="4110297">=</span>&nbsp;<span class="num" id="4110299">0</span><br>
<span class="lineno">100</span><span class="op" id="4110301">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4110304">//&nbsp;TLS&nbsp;CertificateStatusType&nbsp;(RFC&nbsp;3546)</span><br>
<span class="lineno"></span><span class="keyword" id="4110344">const</span>&nbsp;<span class="op" id="4110350">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110353">statusTypeOCSP</span>&nbsp;<span class="builtintype" id="4110368">uint8</span>&nbsp;<span class="op" id="4110374">=</span>&nbsp;<span class="num" id="4110376">1</span><br>
<span class="lineno">105</span><span class="op" id="4110378">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4110381">//&nbsp;Certificate&nbsp;types&nbsp;(for&nbsp;certificateRequestMsg)</span><br>
<span class="lineno"></span><span class="keyword" id="4110430">const</span>&nbsp;<span class="op" id="4110436">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110439">certTypeRSASign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110458">=</span>&nbsp;<span class="num" id="4110460">1</span>&nbsp;<span class="comment" id="4110462">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;an&nbsp;RSA&nbsp;key</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110502">certTypeDSSSign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110521">=</span>&nbsp;<span class="num" id="4110523">2</span>&nbsp;<span class="comment" id="4110525">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;a&nbsp;DSA&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110564">certTypeRSAFixedDH</span>&nbsp;<span class="op" id="4110583">=</span>&nbsp;<span class="num" id="4110585">3</span>&nbsp;<span class="comment" id="4110587">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;a&nbsp;static&nbsp;DH&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110632">certTypeDSSFixedDH</span>&nbsp;<span class="op" id="4110651">=</span>&nbsp;<span class="num" id="4110653">4</span>&nbsp;<span class="comment" id="4110655">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;a&nbsp;static&nbsp;DH&nbsp;key</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4110701">//&nbsp;See&nbsp;RFC4492&nbsp;sections&nbsp;3&nbsp;and&nbsp;5.5.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110737">certTypeECDSASign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110760">=</span>&nbsp;<span class="num" id="4110762">64</span>&nbsp;<span class="comment" id="4110765">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;an&nbsp;ECDSA-capable&nbsp;public&nbsp;key,&nbsp;signed&nbsp;with&nbsp;ECDSA.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110842">certTypeRSAFixedECDH</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4110865">=</span>&nbsp;<span class="num" id="4110867">65</span>&nbsp;<span class="comment" id="4110870">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;an&nbsp;ECDH-capable&nbsp;public&nbsp;key,&nbsp;signed&nbsp;with&nbsp;RSA.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110944">certTypeECDSAFixedECDH</span>&nbsp;<span class="op" id="4110967">=</span>&nbsp;<span class="num" id="4110969">66</span>&nbsp;<span class="comment" id="4110972">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;an&nbsp;ECDH-capable&nbsp;public&nbsp;key,&nbsp;signed&nbsp;with&nbsp;ECDSA.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4111049">//&nbsp;Rest&nbsp;of&nbsp;these&nbsp;are&nbsp;reserved&nbsp;by&nbsp;the&nbsp;TLS&nbsp;spec</span><br>
<span class="lineno">120</span><span class="op" id="4111095">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4111098">//&nbsp;Hash&nbsp;functions&nbsp;for&nbsp;TLS&nbsp;1.2&nbsp;(See&nbsp;RFC&nbsp;5246,&nbsp;section&nbsp;A.4.1)</span><br>
<span class="lineno"></span><span class="keyword" id="4111158">const</span>&nbsp;<span class="op" id="4111164">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4111167">hashSHA1</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4111178">uint8</span>&nbsp;<span class="op" id="4111184">=</span>&nbsp;<span class="num" id="4111186">2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4111189">hashSHA256</span>&nbsp;<span class="builtintype" id="4111200">uint8</span>&nbsp;<span class="op" id="4111206">=</span>&nbsp;<span class="num" id="4111208">4</span><br>
<span class="lineno"></span><span class="op" id="4111210">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4111213">//&nbsp;Signature&nbsp;algorithms&nbsp;for&nbsp;TLS&nbsp;1.2&nbsp;(See&nbsp;RFC&nbsp;5246,&nbsp;section&nbsp;A.4.1)</span><br>
<span class="lineno"></span><span class="keyword" id="4111279">const</span>&nbsp;<span class="op" id="4111285">(</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4111288">signatureRSA</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4111303">uint8</span>&nbsp;<span class="op" id="4111309">=</span>&nbsp;<span class="num" id="4111311">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4111314">signatureECDSA</span>&nbsp;<span class="builtintype" id="4111329">uint8</span>&nbsp;<span class="op" id="4111335">=</span>&nbsp;<span class="num" id="4111337">3</span><br>
<span class="lineno"></span><span class="op" id="4111339">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4111342">//&nbsp;signatureAndHash&nbsp;mirrors&nbsp;the&nbsp;TLS&nbsp;1.2,&nbsp;SignatureAndHashAlgorithm&nbsp;struct.&nbsp;See</span><br>
<span class="lineno">135</span><span class="comment" id="4111421">//&nbsp;RFC&nbsp;5246,&nbsp;section&nbsp;A.4.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4111449">type</span>&nbsp;<span class="ident" id="4111454">signatureAndHash</span>&nbsp;<span class="keyword" id="4111471">struct</span>&nbsp;<span class="op" id="4111478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4111481">hash</span><span class="op" id="4111485">,</span>&nbsp;<span class="ident" id="4111487">signature</span>&nbsp;<span class="builtintype" id="4111497">uint8</span><br>
<span class="lineno"></span><span class="op" id="4111503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="4111506">//&nbsp;supportedSKXSignatureAlgorithms&nbsp;contains&nbsp;the&nbsp;signature&nbsp;and&nbsp;hash&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4111584">//&nbsp;that&nbsp;the&nbsp;code&nbsp;advertises&nbsp;as&nbsp;supported&nbsp;in&nbsp;a&nbsp;TLS&nbsp;1.2&nbsp;ClientHello.</span><br>
<span class="lineno"></span><span class="keyword" id="4111651">var</span>&nbsp;<span class="ident" id="4111655">supportedSKXSignatureAlgorithms</span>&nbsp;<span class="op" id="4111687">=</span>&nbsp;<span class="op" id="4111689">[</span><span class="op" id="4111690">]</span><span class="ident" id="4111691"><a href="/crypto/tls/common.go.html#4111454">signatureAndHash</a></span><span class="op" id="4111707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4111710">{</span><span class="ident" id="4111711"><a href="/crypto/tls/common.go.html#4111189">hashSHA256</a></span><span class="op" id="4111721">,</span>&nbsp;<span class="ident" id="4111723"><a href="/crypto/tls/common.go.html#4111288">signatureRSA</a></span><span class="op" id="4111735">}</span><span class="op" id="4111736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4111739">{</span><span class="ident" id="4111740"><a href="/crypto/tls/common.go.html#4111189">hashSHA256</a></span><span class="op" id="4111750">,</span>&nbsp;<span class="ident" id="4111752"><a href="/crypto/tls/common.go.html#4111314">signatureECDSA</a></span><span class="op" id="4111766">}</span><span class="op" id="4111767">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4111770">{</span><span class="ident" id="4111771"><a href="/crypto/tls/common.go.html#4111167">hashSHA1</a></span><span class="op" id="4111779">,</span>&nbsp;<span class="ident" id="4111781"><a href="/crypto/tls/common.go.html#4111288">signatureRSA</a></span><span class="op" id="4111793">}</span><span class="op" id="4111794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4111797">{</span><span class="ident" id="4111798"><a href="/crypto/tls/common.go.html#4111167">hashSHA1</a></span><span class="op" id="4111806">,</span>&nbsp;<span class="ident" id="4111808"><a href="/crypto/tls/common.go.html#4111314">signatureECDSA</a></span><span class="op" id="4111822">}</span><span class="op" id="4111823">,</span><br>
<span class="lineno"></span><span class="op" id="4111825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4111828">//&nbsp;supportedClientCertSignatureAlgorithms&nbsp;contains&nbsp;the&nbsp;signature&nbsp;and&nbsp;hash</span><br>
<span class="lineno">150</span><span class="comment" id="4111902">//&nbsp;algorithms&nbsp;that&nbsp;the&nbsp;code&nbsp;advertises&nbsp;as&nbsp;supported&nbsp;in&nbsp;a&nbsp;TLS&nbsp;1.2</span><br>
<span class="lineno"></span><span class="comment" id="4111967">//&nbsp;CertificateRequest.</span><br>
<span class="lineno"></span><span class="keyword" id="4111990">var</span>&nbsp;<span class="ident" id="4111994">supportedClientCertSignatureAlgorithms</span>&nbsp;<span class="op" id="4112033">=</span>&nbsp;<span class="op" id="4112035">[</span><span class="op" id="4112036">]</span><span class="ident" id="4112037"><a href="/crypto/tls/common.go.html#4111454">signatureAndHash</a></span><span class="op" id="4112053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4112056">{</span><span class="ident" id="4112057"><a href="/crypto/tls/common.go.html#4111189">hashSHA256</a></span><span class="op" id="4112067">,</span>&nbsp;<span class="ident" id="4112069"><a href="/crypto/tls/common.go.html#4111288">signatureRSA</a></span><span class="op" id="4112081">}</span><span class="op" id="4112082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4112085">{</span><span class="ident" id="4112086"><a href="/crypto/tls/common.go.html#4111189">hashSHA256</a></span><span class="op" id="4112096">,</span>&nbsp;<span class="ident" id="4112098"><a href="/crypto/tls/common.go.html#4111314">signatureECDSA</a></span><span class="op" id="4112112">}</span><span class="op" id="4112113">,</span><br>
<span class="lineno">155</span><span class="op" id="4112115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4112118">//&nbsp;ConnectionState&nbsp;records&nbsp;basic&nbsp;TLS&nbsp;details&nbsp;about&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4112185">type</span>&nbsp;<span class="ident" id="4112190">ConnectionState</span>&nbsp;<span class="keyword" id="4112206">struct</span>&nbsp;<span class="op" id="4112213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112216">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4112243">uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4112265">//&nbsp;TLS&nbsp;version&nbsp;used&nbsp;by&nbsp;the&nbsp;connection&nbsp;(e.g.&nbsp;VersionTLS12)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112324">HandshakeComplete</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4112351">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4112373">//&nbsp;TLS&nbsp;handshake&nbsp;is&nbsp;complete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112403">DidResume</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4112430">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4112452">//&nbsp;connection&nbsp;resumes&nbsp;a&nbsp;previous&nbsp;TLS&nbsp;connection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112501">CipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4112528">uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4112550">//&nbsp;cipher&nbsp;suite&nbsp;in&nbsp;use&nbsp;(TLS_RSA_WITH_RC4_128_SHA,&nbsp;...)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112606">NegotiatedProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4112633">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4112655">//&nbsp;negotiated&nbsp;next&nbsp;protocol&nbsp;(from&nbsp;Config.NextProtos)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112709">NegotiatedProtocolIsMutual</span>&nbsp;<span class="builtintype" id="4112736">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4112758">//&nbsp;negotiated&nbsp;protocol&nbsp;was&nbsp;advertised&nbsp;by&nbsp;server</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112807">ServerName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4112834">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4112856">//&nbsp;server&nbsp;name&nbsp;requested&nbsp;by&nbsp;client,&nbsp;if&nbsp;any&nbsp;(server&nbsp;side&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112919">PeerCertificates</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4112946">[</span><span class="op" id="4112947">]</span><span class="op" id="4112948">*</span><span class="ident" id="4112949"><a href="/crypto/tls/common.go.html#4108058">x509</a></span><span class="op" id="4112953">.</span><span class="ident" id="4112954">Certificate</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4112968">//&nbsp;certificate&nbsp;chain&nbsp;presented&nbsp;by&nbsp;remote&nbsp;peer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113015">VerifiedChains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4113042">[</span><span class="op" id="4113043">]</span><span class="op" id="4113044">[</span><span class="op" id="4113045">]</span><span class="op" id="4113046">*</span><span class="ident" id="4113047"><a href="/crypto/tls/common.go.html#4108058">x509</a></span><span class="op" id="4113051">.</span><span class="ident" id="4113052">Certificate</span>&nbsp;<span class="comment" id="4113064">//&nbsp;verified&nbsp;chains&nbsp;built&nbsp;from&nbsp;PeerCertificates</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4113113">//&nbsp;TLSUnique&nbsp;contains&nbsp;the&nbsp;&#34;tls-unique&#34;&nbsp;channel&nbsp;binding&nbsp;value&nbsp;(see&nbsp;RFC</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4113184">//&nbsp;5929,&nbsp;section&nbsp;3).&nbsp;For&nbsp;resumed&nbsp;sessions&nbsp;this&nbsp;value&nbsp;will&nbsp;be&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4113250">//&nbsp;because&nbsp;resumption&nbsp;does&nbsp;not&nbsp;include&nbsp;enough&nbsp;context&nbsp;(see</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4113310">//&nbsp;https://secure-resumption.com/#channelbindings).&nbsp;This&nbsp;will&nbsp;change&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4113383">//&nbsp;future&nbsp;versions&nbsp;of&nbsp;Go&nbsp;once&nbsp;the&nbsp;TLS&nbsp;master-secret&nbsp;fix&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4113449">//&nbsp;standardized&nbsp;and&nbsp;implemented.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113483">TLSUnique</span>&nbsp;<span class="op" id="4113493">[</span><span class="op" id="4113494">]</span><span class="builtintype" id="4113495">byte</span><br>
<span class="lineno"></span><span class="op" id="4113500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4113503">//&nbsp;ClientAuthType&nbsp;declares&nbsp;the&nbsp;policy&nbsp;the&nbsp;server&nbsp;will&nbsp;follow&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4113568">//&nbsp;TLS&nbsp;Client&nbsp;Authentication.</span><br>
<span class="lineno">180</span><span class="keyword" id="4113598">type</span>&nbsp;<span class="ident" id="4113603">ClientAuthType</span>&nbsp;<span class="builtintype" id="4113618">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4113623">const</span>&nbsp;<span class="op" id="4113629">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113632">NoClientCert</span>&nbsp;<span class="ident" id="4113645"><a href="/crypto/tls/common.go.html#4113603">ClientAuthType</a></span>&nbsp;<span class="op" id="4113660">=</span>&nbsp;<span class="ident" id="4113662">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113668">RequestClientCert</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113687">RequireAnyClientCert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113709">VerifyClientCertIfGiven</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113734">RequireAndVerifyClientCert</span><br>
<span class="lineno"></span><span class="op" id="4113761">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4113764">//&nbsp;ClientSessionState&nbsp;contains&nbsp;the&nbsp;state&nbsp;needed&nbsp;by&nbsp;clients&nbsp;to&nbsp;resume&nbsp;TLS</span><br>
<span class="lineno"></span><span class="comment" id="4113837">//&nbsp;sessions.</span><br>
<span class="lineno"></span><span class="keyword" id="4113850">type</span>&nbsp;<span class="ident" id="4113855">ClientSessionState</span>&nbsp;<span class="keyword" id="4113874">struct</span>&nbsp;<span class="op" id="4113881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113884">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4113903">[</span><span class="op" id="4113904">]</span><span class="builtintype" id="4113905">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4113923">//&nbsp;Encrypted&nbsp;ticket&nbsp;used&nbsp;for&nbsp;session&nbsp;resumption&nbsp;with&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113984">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4114003">uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4114023">//&nbsp;SSL/TLS&nbsp;version&nbsp;negotiated&nbsp;for&nbsp;the&nbsp;session</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114070">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4114089">uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4114109">//&nbsp;Ciphersuite&nbsp;negotiated&nbsp;for&nbsp;the&nbsp;session</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114152">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114171">[</span><span class="op" id="4114172">]</span><span class="builtintype" id="4114173">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4114191">//&nbsp;MasterSecret&nbsp;generated&nbsp;by&nbsp;client&nbsp;on&nbsp;a&nbsp;full&nbsp;handshake</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114248">serverCertificates</span>&nbsp;<span class="op" id="4114267">[</span><span class="op" id="4114268">]</span><span class="op" id="4114269">*</span><span class="ident" id="4114270"><a href="/crypto/tls/common.go.html#4108058">x509</a></span><span class="op" id="4114274">.</span><span class="ident" id="4114275">Certificate</span>&nbsp;<span class="comment" id="4114287">//&nbsp;Certificate&nbsp;chain&nbsp;presented&nbsp;by&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="op" id="4114332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="4114335">//&nbsp;ClientSessionCache&nbsp;is&nbsp;a&nbsp;cache&nbsp;of&nbsp;ClientSessionState&nbsp;objects&nbsp;that&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4114415">//&nbsp;by&nbsp;a&nbsp;client&nbsp;to&nbsp;resume&nbsp;a&nbsp;TLS&nbsp;session&nbsp;with&nbsp;a&nbsp;given&nbsp;server.&nbsp;ClientSessionCache</span><br>
<span class="lineno"></span><span class="comment" id="4114494">//&nbsp;implementations&nbsp;should&nbsp;expect&nbsp;to&nbsp;be&nbsp;called&nbsp;concurrently&nbsp;from&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="4114568">//&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="4114583">type</span>&nbsp;<span class="ident" id="4114588">ClientSessionCache</span>&nbsp;<span class="keyword" id="4114607">interface</span>&nbsp;<span class="op" id="4114617">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4114620">//&nbsp;Get&nbsp;searches&nbsp;for&nbsp;a&nbsp;ClientSessionState&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4114693">//&nbsp;On&nbsp;return,&nbsp;ok&nbsp;is&nbsp;true&nbsp;if&nbsp;one&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114737">Get</span><span class="op" id="4114740">(</span><span class="ident" id="4114741">sessionKey</span>&nbsp;<span class="builtintype" id="4114752">string</span><span class="op" id="4114758">)</span>&nbsp;<span class="op" id="4114760">(</span><span class="ident" id="4114761">session</span>&nbsp;<span class="op" id="4114769">*</span><span class="ident" id="4114770"><a href="/crypto/tls/common.go.html#4113855">ClientSessionState</a></span><span class="op" id="4114788">,</span>&nbsp;<span class="ident" id="4114790">ok</span>&nbsp;<span class="builtintype" id="4114793">bool</span><span class="op" id="4114797">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4114801">//&nbsp;Put&nbsp;adds&nbsp;the&nbsp;ClientSessionState&nbsp;to&nbsp;the&nbsp;cache&nbsp;with&nbsp;the&nbsp;given&nbsp;key.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114870">Put</span><span class="op" id="4114873">(</span><span class="ident" id="4114874">sessionKey</span>&nbsp;<span class="builtintype" id="4114885">string</span><span class="op" id="4114891">,</span>&nbsp;<span class="ident" id="4114893">cs</span>&nbsp;<span class="op" id="4114896">*</span><span class="ident" id="4114897"><a href="/crypto/tls/common.go.html#4113855">ClientSessionState</a></span><span class="op" id="4114915">)</span><br>
<span class="lineno"></span><span class="op" id="4114917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4114920">//&nbsp;ClientHelloInfo&nbsp;contains&nbsp;information&nbsp;from&nbsp;a&nbsp;ClientHello&nbsp;message&nbsp;in&nbsp;order&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4114999">//&nbsp;guide&nbsp;certificate&nbsp;selection&nbsp;in&nbsp;the&nbsp;GetCertificate&nbsp;callback.</span><br>
<span class="lineno">215</span><span class="keyword" id="4115062">type</span>&nbsp;<span class="ident" id="4115067">ClientHelloInfo</span>&nbsp;<span class="keyword" id="4115083">struct</span>&nbsp;<span class="op" id="4115090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115093">//&nbsp;CipherSuites&nbsp;lists&nbsp;the&nbsp;CipherSuites&nbsp;supported&nbsp;by&nbsp;the&nbsp;client&nbsp;(e.g.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115163">//&nbsp;TLS_RSA_WITH_RC4_128_SHA).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115194">CipherSuites</span>&nbsp;<span class="op" id="4115207">[</span><span class="op" id="4115208">]</span><span class="builtintype" id="4115209">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115218">//&nbsp;ServerName&nbsp;indicates&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;server&nbsp;requested&nbsp;by&nbsp;the&nbsp;client</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115290">//&nbsp;in&nbsp;order&nbsp;to&nbsp;support&nbsp;virtual&nbsp;hosting.&nbsp;ServerName&nbsp;is&nbsp;only&nbsp;set&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115361">//&nbsp;client&nbsp;is&nbsp;using&nbsp;SNI&nbsp;(see</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115390">//&nbsp;http://tools.ietf.org/html/rfc4366#section-3.1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115443">ServerName</span>&nbsp;<span class="builtintype" id="4115454">string</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115463">//&nbsp;SupportedCurves&nbsp;lists&nbsp;the&nbsp;elliptic&nbsp;curves&nbsp;supported&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115534">//&nbsp;SupportedCurves&nbsp;is&nbsp;set&nbsp;only&nbsp;if&nbsp;the&nbsp;Supported&nbsp;Elliptic&nbsp;Curves</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115599">//&nbsp;Extension&nbsp;is&nbsp;being&nbsp;used&nbsp;(see</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115632">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.1.1).</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115687">SupportedCurves</span>&nbsp;<span class="op" id="4115703">[</span><span class="op" id="4115704">]</span><span class="ident" id="4115705"><a href="/crypto/tls/common.go.html#4110037">CurveID</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115715">//&nbsp;SupportedPoints&nbsp;lists&nbsp;the&nbsp;point&nbsp;formats&nbsp;supported&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115784">//&nbsp;SupportedPoints&nbsp;is&nbsp;set&nbsp;only&nbsp;if&nbsp;the&nbsp;Supported&nbsp;Point&nbsp;Formats&nbsp;Extension</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115857">//&nbsp;is&nbsp;being&nbsp;used&nbsp;(see</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4115880">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.1.2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115935">SupportedPoints</span>&nbsp;<span class="op" id="4115951">[</span><span class="op" id="4115952">]</span><span class="builtintype" id="4115953">uint8</span><br>
<span class="lineno"></span><span class="op" id="4115959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4115962">//&nbsp;A&nbsp;Config&nbsp;structure&nbsp;is&nbsp;used&nbsp;to&nbsp;configure&nbsp;a&nbsp;TLS&nbsp;client&nbsp;or&nbsp;server.</span><br>
<span class="lineno">240</span><span class="comment" id="4116029">//&nbsp;After&nbsp;one&nbsp;has&nbsp;been&nbsp;passed&nbsp;to&nbsp;a&nbsp;TLS&nbsp;function&nbsp;it&nbsp;must&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4116091">//&nbsp;modified.&nbsp;A&nbsp;Config&nbsp;may&nbsp;be&nbsp;reused;&nbsp;the&nbsp;tls&nbsp;package&nbsp;will&nbsp;also&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="4116158">//&nbsp;modify&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4116172">type</span>&nbsp;<span class="ident" id="4116177">Config</span>&nbsp;<span class="keyword" id="4116184">struct</span>&nbsp;<span class="op" id="4116191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116194">//&nbsp;Rand&nbsp;provides&nbsp;the&nbsp;source&nbsp;of&nbsp;entropy&nbsp;for&nbsp;nonces&nbsp;and&nbsp;RSA&nbsp;blinding.</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116263">//&nbsp;If&nbsp;Rand&nbsp;is&nbsp;nil,&nbsp;TLS&nbsp;uses&nbsp;the&nbsp;cryptographic&nbsp;random&nbsp;reader&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116335">//&nbsp;crypto/rand.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116352">//&nbsp;The&nbsp;Reader&nbsp;must&nbsp;be&nbsp;safe&nbsp;for&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116412">Rand</span>&nbsp;<span class="ident" id="4116417"><a href="/crypto/tls/common.go.html#4108080">io</a></span><span class="op" id="4116419">.</span><span class="ident" id="4116420">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116429">//&nbsp;Time&nbsp;returns&nbsp;the&nbsp;current&nbsp;time&nbsp;as&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;since&nbsp;the&nbsp;epoch.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116505">//&nbsp;If&nbsp;Time&nbsp;is&nbsp;nil,&nbsp;TLS&nbsp;uses&nbsp;time.Now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116544">Time</span>&nbsp;<span class="keyword" id="4116549">func</span><span class="op" id="4116553">(</span><span class="op" id="4116554">)</span>&nbsp;<span class="ident" id="4116556"><a href="/crypto/tls/common.go.html#4108117">time</a></span><span class="op" id="4116560">.</span><span class="ident" id="4116561">Time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116568">//&nbsp;Certificates&nbsp;contains&nbsp;one&nbsp;or&nbsp;more&nbsp;certificate&nbsp;chains</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116625">//&nbsp;to&nbsp;present&nbsp;to&nbsp;the&nbsp;other&nbsp;side&nbsp;of&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116677">//&nbsp;Server&nbsp;configurations&nbsp;must&nbsp;include&nbsp;at&nbsp;least&nbsp;one&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116742">Certificates</span>&nbsp;<span class="op" id="4116755">[</span><span class="op" id="4116756">]</span><span class="ident" id="4116757"><a href="/crypto/tls/common.go.html#4123683">Certificate</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116771">//&nbsp;NameToCertificate&nbsp;maps&nbsp;from&nbsp;a&nbsp;certificate&nbsp;name&nbsp;to&nbsp;an&nbsp;element&nbsp;of</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116839">//&nbsp;Certificates.&nbsp;Note&nbsp;that&nbsp;a&nbsp;certificate&nbsp;name&nbsp;can&nbsp;be&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116905">//&nbsp;&#39;*.example.com&#39;&nbsp;and&nbsp;so&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;a&nbsp;domain&nbsp;name&nbsp;as&nbsp;such.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4116974">//&nbsp;See&nbsp;Config.BuildNameToCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117012">//&nbsp;The&nbsp;nil&nbsp;value&nbsp;causes&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Certificates&nbsp;to&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117082">//&nbsp;for&nbsp;all&nbsp;connections.</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4117107">NameToCertificate</span>&nbsp;<span class="keyword" id="4117125">map</span><span class="op" id="4117128">[</span><span class="builtintype" id="4117129">string</span><span class="op" id="4117135">]</span><span class="op" id="4117136">*</span><span class="ident" id="4117137"><a href="/crypto/tls/common.go.html#4123683">Certificate</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117151">//&nbsp;GetCertificate&nbsp;returns&nbsp;a&nbsp;Certificate&nbsp;based&nbsp;on&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117211">//&nbsp;ClientHelloInfo.&nbsp;If&nbsp;GetCertificate&nbsp;is&nbsp;nil&nbsp;or&nbsp;returns&nbsp;nil,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117282">//&nbsp;certificate&nbsp;is&nbsp;retrieved&nbsp;from&nbsp;NameToCertificate.&nbsp;If</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117338">//&nbsp;NameToCertificate&nbsp;is&nbsp;nil,&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Certificates&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117410">//&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4117420">GetCertificate</span>&nbsp;<span class="keyword" id="4117435">func</span><span class="op" id="4117439">(</span><span class="ident" id="4117440">clientHello</span>&nbsp;<span class="op" id="4117452">*</span><span class="ident" id="4117453"><a href="/crypto/tls/common.go.html#4115067">ClientHelloInfo</a></span><span class="op" id="4117468">)</span>&nbsp;<span class="op" id="4117470">(</span><span class="op" id="4117471">*</span><span class="ident" id="4117472"><a href="/crypto/tls/common.go.html#4123683">Certificate</a></span><span class="op" id="4117483">,</span>&nbsp;<span class="builtintype" id="4117485">error</span><span class="op" id="4117490">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117494">//&nbsp;RootCAs&nbsp;defines&nbsp;the&nbsp;set&nbsp;of&nbsp;root&nbsp;certificate&nbsp;authorities</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117554">//&nbsp;that&nbsp;clients&nbsp;use&nbsp;when&nbsp;verifying&nbsp;server&nbsp;certificates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117611">//&nbsp;If&nbsp;RootCAs&nbsp;is&nbsp;nil,&nbsp;TLS&nbsp;uses&nbsp;the&nbsp;host&#39;s&nbsp;root&nbsp;CA&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4117667">RootCAs</span>&nbsp;<span class="op" id="4117675">*</span><span class="ident" id="4117676"><a href="/crypto/tls/common.go.html#4108058">x509</a></span><span class="op" id="4117680">.</span><span class="ident" id="4117681">CertPool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117692">//&nbsp;NextProtos&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;supported,&nbsp;application&nbsp;level&nbsp;protocols.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4117760">NextProtos</span>&nbsp;<span class="op" id="4117771">[</span><span class="op" id="4117772">]</span><span class="builtintype" id="4117773">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117782">//&nbsp;ServerName&nbsp;is&nbsp;used&nbsp;to&nbsp;verify&nbsp;the&nbsp;hostname&nbsp;on&nbsp;the&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117844">//&nbsp;certificates&nbsp;unless&nbsp;InsecureSkipVerify&nbsp;is&nbsp;given.&nbsp;It&nbsp;is&nbsp;also&nbsp;included</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117917">//&nbsp;in&nbsp;the&nbsp;client&#39;s&nbsp;handshake&nbsp;to&nbsp;support&nbsp;virtual&nbsp;hosting.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4117975">ServerName</span>&nbsp;<span class="builtintype" id="4117986">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117995">//&nbsp;ClientAuth&nbsp;determines&nbsp;the&nbsp;server&#39;s&nbsp;policy&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118045">//&nbsp;TLS&nbsp;Client&nbsp;Authentication.&nbsp;The&nbsp;default&nbsp;is&nbsp;NoClientCert.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118105">ClientAuth</span>&nbsp;<span class="ident" id="4118116"><a href="/crypto/tls/common.go.html#4113603">ClientAuthType</a></span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118133">//&nbsp;ClientCAs&nbsp;defines&nbsp;the&nbsp;set&nbsp;of&nbsp;root&nbsp;certificate&nbsp;authorities</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118195">//&nbsp;that&nbsp;servers&nbsp;use&nbsp;if&nbsp;required&nbsp;to&nbsp;verify&nbsp;a&nbsp;client&nbsp;certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118259">//&nbsp;by&nbsp;the&nbsp;policy&nbsp;in&nbsp;ClientAuth.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118292">ClientCAs</span>&nbsp;<span class="op" id="4118302">*</span><span class="ident" id="4118303"><a href="/crypto/tls/common.go.html#4108058">x509</a></span><span class="op" id="4118307">.</span><span class="ident" id="4118308">CertPool</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118319">//&nbsp;InsecureSkipVerify&nbsp;controls&nbsp;whether&nbsp;a&nbsp;client&nbsp;verifies&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118381">//&nbsp;server&#39;s&nbsp;certificate&nbsp;chain&nbsp;and&nbsp;host&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118427">//&nbsp;If&nbsp;InsecureSkipVerify&nbsp;is&nbsp;true,&nbsp;TLS&nbsp;accepts&nbsp;any&nbsp;certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118490">//&nbsp;presented&nbsp;by&nbsp;the&nbsp;server&nbsp;and&nbsp;any&nbsp;host&nbsp;name&nbsp;in&nbsp;that&nbsp;certificate.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118557">//&nbsp;In&nbsp;this&nbsp;mode,&nbsp;TLS&nbsp;is&nbsp;susceptible&nbsp;to&nbsp;man-in-the-middle&nbsp;attacks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118624">//&nbsp;This&nbsp;should&nbsp;be&nbsp;used&nbsp;only&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118666">InsecureSkipVerify</span>&nbsp;<span class="builtintype" id="4118685">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118692">//&nbsp;CipherSuites&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;supported&nbsp;cipher&nbsp;suites.&nbsp;If&nbsp;CipherSuites</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118763">//&nbsp;is&nbsp;nil,&nbsp;TLS&nbsp;uses&nbsp;a&nbsp;list&nbsp;of&nbsp;suites&nbsp;supported&nbsp;by&nbsp;the&nbsp;implementation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118834">CipherSuites</span>&nbsp;<span class="op" id="4118847">[</span><span class="op" id="4118848">]</span><span class="builtintype" id="4118849">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118858">//&nbsp;PreferServerCipherSuites&nbsp;controls&nbsp;whether&nbsp;the&nbsp;server&nbsp;selects&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118927">//&nbsp;client&#39;s&nbsp;most&nbsp;preferred&nbsp;ciphersuite,&nbsp;or&nbsp;the&nbsp;server&#39;s&nbsp;most&nbsp;preferred</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118999">//&nbsp;ciphersuite.&nbsp;If&nbsp;true&nbsp;then&nbsp;the&nbsp;server&#39;s&nbsp;preference,&nbsp;as&nbsp;expressed&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119070">//&nbsp;the&nbsp;order&nbsp;of&nbsp;elements&nbsp;in&nbsp;CipherSuites,&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119122">PreferServerCipherSuites</span>&nbsp;<span class="builtintype" id="4119147">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119154">//&nbsp;SessionTicketsDisabled&nbsp;may&nbsp;be&nbsp;set&nbsp;to&nbsp;true&nbsp;to&nbsp;disable&nbsp;session&nbsp;ticket</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119226">//&nbsp;(resumption)&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119252">SessionTicketsDisabled</span>&nbsp;<span class="builtintype" id="4119275">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119282">//&nbsp;SessionTicketKey&nbsp;is&nbsp;used&nbsp;by&nbsp;TLS&nbsp;servers&nbsp;to&nbsp;provide&nbsp;session</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119345">//&nbsp;resumption.&nbsp;See&nbsp;RFC&nbsp;5077.&nbsp;If&nbsp;zero,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119407">//&nbsp;random&nbsp;data&nbsp;before&nbsp;the&nbsp;first&nbsp;server&nbsp;handshake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119458">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119462">//&nbsp;If&nbsp;multiple&nbsp;servers&nbsp;are&nbsp;terminating&nbsp;connections&nbsp;for&nbsp;the&nbsp;same&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119532">//&nbsp;they&nbsp;should&nbsp;all&nbsp;have&nbsp;the&nbsp;same&nbsp;SessionTicketKey.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119591">//&nbsp;SessionTicketKey&nbsp;leaks,&nbsp;previously&nbsp;recorded&nbsp;and&nbsp;future&nbsp;TLS</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119654">//&nbsp;connections&nbsp;using&nbsp;that&nbsp;key&nbsp;are&nbsp;compromised.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119702">SessionTicketKey</span>&nbsp;<span class="op" id="4119719">[</span><span class="num" id="4119720">32</span><span class="op" id="4119722">]</span><span class="builtintype" id="4119723">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119730">//&nbsp;SessionCache&nbsp;is&nbsp;a&nbsp;cache&nbsp;of&nbsp;ClientSessionState&nbsp;entries&nbsp;for&nbsp;TLS&nbsp;session</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119804">//&nbsp;resumption.</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119820">ClientSessionCache</span>&nbsp;<span class="ident" id="4119839"><a href="/crypto/tls/common.go.html#4114588">ClientSessionCache</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119860">//&nbsp;MinVersion&nbsp;contains&nbsp;the&nbsp;minimum&nbsp;SSL/TLS&nbsp;version&nbsp;that&nbsp;is&nbsp;acceptable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119932">//&nbsp;If&nbsp;zero,&nbsp;then&nbsp;SSLv3&nbsp;is&nbsp;taken&nbsp;as&nbsp;the&nbsp;minimum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119981">MinVersion</span>&nbsp;<span class="builtintype" id="4119992">uint16</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120001">//&nbsp;MaxVersion&nbsp;contains&nbsp;the&nbsp;maximum&nbsp;SSL/TLS&nbsp;version&nbsp;that&nbsp;is&nbsp;acceptable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120073">//&nbsp;If&nbsp;zero,&nbsp;then&nbsp;the&nbsp;maximum&nbsp;version&nbsp;supported&nbsp;by&nbsp;this&nbsp;package&nbsp;is&nbsp;used,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120146">//&nbsp;which&nbsp;is&nbsp;currently&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120178">MaxVersion</span>&nbsp;<span class="builtintype" id="4120189">uint16</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120198">//&nbsp;CurvePreferences&nbsp;contains&nbsp;the&nbsp;elliptic&nbsp;curves&nbsp;that&nbsp;will&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120269">//&nbsp;an&nbsp;ECDHE&nbsp;handshake,&nbsp;in&nbsp;preference&nbsp;order.&nbsp;If&nbsp;empty,&nbsp;the&nbsp;default&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120341">//&nbsp;be&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120354">CurvePreferences</span>&nbsp;<span class="op" id="4120371">[</span><span class="op" id="4120372">]</span><span class="ident" id="4120373"><a href="/crypto/tls/common.go.html#4110037">CurveID</a></span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120383">serverInitOnce</span>&nbsp;<span class="ident" id="4120398"><a href="/crypto/tls/common.go.html#4108109">sync</a></span><span class="op" id="4120402">.</span><span class="ident" id="4120403">Once</span>&nbsp;<span class="comment" id="4120408">//&nbsp;guards&nbsp;calling&nbsp;(*Config).serverInit</span><br>
<span class="lineno"></span><span class="op" id="4120447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4120450">func</span>&nbsp;<span class="op" id="4120455">(</span><span class="ident" id="4120456">c</span>&nbsp;<span class="op" id="4120458">*</span><span class="ident" id="4120459"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4120465">)</span>&nbsp;<span class="ident" id="4120467">serverInit</span><span class="op" id="4120477">(</span><span class="op" id="4120478">)</span>&nbsp;<span class="op" id="4120480">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120483">if</span>&nbsp;<span class="ident" id="4120486"><a href="/crypto/tls/common.go.html#4120456">c</a></span><span class="op" id="4120487">.</span><span class="ident" id="4120488">SessionTicketsDisabled</span>&nbsp;<span class="op" id="4120511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120515">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120527">//&nbsp;If&nbsp;the&nbsp;key&nbsp;has&nbsp;already&nbsp;been&nbsp;set&nbsp;then&nbsp;we&nbsp;have&nbsp;nothing&nbsp;to&nbsp;do.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120591">for</span>&nbsp;<span class="ident" id="4120595">_</span><span class="op" id="4120596">,</span>&nbsp;<span class="ident" id="4120598">b</span>&nbsp;<span class="op" id="4120600">:=</span>&nbsp;<span class="keyword" id="4120603">range</span>&nbsp;<span class="ident" id="4120609"><a href="/crypto/tls/common.go.html#4120456">c</a></span><span class="op" id="4120610">.</span><span class="ident" id="4120611">SessionTicketKey</span>&nbsp;<span class="op" id="4120628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120632">if</span>&nbsp;<span class="ident" id="4120635"><a href="/crypto/tls/common.go.html#4120598">b</a></span>&nbsp;<span class="op" id="4120637">!=</span>&nbsp;<span class="num" id="4120640">0</span>&nbsp;<span class="op" id="4120642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120647">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120659">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120663">if</span>&nbsp;<span class="ident" id="4120666">_</span><span class="op" id="4120667">,</span>&nbsp;<span class="ident" id="4120669">err</span>&nbsp;<span class="op" id="4120673">:=</span>&nbsp;<span class="ident" id="4120676"><a href="/crypto/tls/common.go.html#4108080">io</a></span><span class="op" id="4120678">.</span><span class="ident" id="4120679">ReadFull</span><span class="op" id="4120687">(</span><span class="ident" id="4120688"><a href="/crypto/tls/common.go.html#4120456">c</a></span><span class="op" id="4120689">.</span><span class="ident" id="4120690">rand</span><span class="op" id="4120694">(</span><span class="op" id="4120695">)</span><span class="op" id="4120696">,</span>&nbsp;<span class="ident" id="4120698"><a href="/crypto/tls/common.go.html#4120456">c</a></span><span class="op" id="4120699">.</span><span class="ident" id="4120700">SessionTicketKey</span><span class="op" id="4120716">[</span><span class="op" id="4120717">:</span><span class="op" id="4120718">]</span><span class="op" id="4120719">)</span><span class="op" id="4120720">;</span>&nbsp;<span class="ident" id="4120722"><a href="/crypto/tls/common.go.html#4120669">err</a></span>&nbsp;<span class="op" id="4120726">!=</span>&nbsp;<span class="ident" id="4120729">nil</span>&nbsp;<span class="op" id="4120733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120737"><a href="/crypto/tls/common.go.html#4120456">c</a></span><span class="op" id="4120738">.</span><span class="ident" id="4120739">SessionTicketsDisabled</span>&nbsp;<span class="op" id="4120762">=</span>&nbsp;<span class="ident" id="4120764">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120770">}</span><br>
<span class="lineno"></span><span class="op" id="4120772">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="4120775">func</span>&nbsp;<span class="op" id="4120780">(</span><span class="ident" id="4120781">c</span>&nbsp;<span class="op" id="4120783">*</span><span class="ident" id="4120784"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4120790">)</span>&nbsp;<span class="ident" id="4120792">rand</span><span class="op" id="4120796">(</span><span class="op" id="4120797">)</span>&nbsp;<span class="ident" id="4120799"><a href="/crypto/tls/common.go.html#4108080">io</a></span><span class="op" id="4120801">.</span><span class="ident" id="4120802">Reader</span>&nbsp;<span class="op" id="4120809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120812">r</span>&nbsp;<span class="op" id="4120814">:=</span>&nbsp;<span class="ident" id="4120817"><a href="/crypto/tls/common.go.html#4120781">c</a></span><span class="op" id="4120818">.</span><span class="ident" id="4120819">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120825">if</span>&nbsp;<span class="ident" id="4120828"><a href="/crypto/tls/common.go.html#4120812">r</a></span>&nbsp;<span class="op" id="4120830">==</span>&nbsp;<span class="ident" id="4120833">nil</span>&nbsp;<span class="op" id="4120837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120841">return</span>&nbsp;<span class="ident" id="4120848"><a href="/crypto/tls/common.go.html#4108043">rand</a></span><span class="op" id="4120852">.</span><span class="ident" id="4120853">Reader</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120864">return</span>&nbsp;<span class="ident" id="4120871"><a href="/crypto/tls/common.go.html#4120812">r</a></span><br>
<span class="lineno"></span><span class="op" id="4120873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4120876">func</span>&nbsp;<span class="op" id="4120881">(</span><span class="ident" id="4120882">c</span>&nbsp;<span class="op" id="4120884">*</span><span class="ident" id="4120885"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4120891">)</span>&nbsp;<span class="ident" id="4120893">time</span><span class="op" id="4120897">(</span><span class="op" id="4120898">)</span>&nbsp;<span class="ident" id="4120900"><a href="/crypto/tls/common.go.html#4108117">time</a></span><span class="op" id="4120904">.</span><span class="ident" id="4120905">Time</span>&nbsp;<span class="op" id="4120910">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120913">t</span>&nbsp;<span class="op" id="4120915">:=</span>&nbsp;<span class="ident" id="4120918"><a href="/crypto/tls/common.go.html#4120882">c</a></span><span class="op" id="4120919">.</span><span class="ident" id="4120920">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120926">if</span>&nbsp;<span class="ident" id="4120929"><a href="/crypto/tls/common.go.html#4120913">t</a></span>&nbsp;<span class="op" id="4120931">==</span>&nbsp;<span class="ident" id="4120934">nil</span>&nbsp;<span class="op" id="4120938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120942"><a href="/crypto/tls/common.go.html#4120913">t</a></span>&nbsp;<span class="op" id="4120944">=</span>&nbsp;<span class="ident" id="4120946"><a href="/crypto/tls/common.go.html#4108117">time</a></span><span class="op" id="4120950">.</span><span class="ident" id="4120951">Now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120959">return</span>&nbsp;<span class="ident" id="4120966"><a href="/crypto/tls/common.go.html#4120913">t</a></span><span class="op" id="4120967">(</span><span class="op" id="4120968">)</span><br>
<span class="lineno">380</span><span class="op" id="4120970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4120973">func</span>&nbsp;<span class="op" id="4120978">(</span><span class="ident" id="4120979">c</span>&nbsp;<span class="op" id="4120981">*</span><span class="ident" id="4120982"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4120988">)</span>&nbsp;<span class="ident" id="4120990">cipherSuites</span><span class="op" id="4121002">(</span><span class="op" id="4121003">)</span>&nbsp;<span class="op" id="4121005">[</span><span class="op" id="4121006">]</span><span class="builtintype" id="4121007">uint16</span>&nbsp;<span class="op" id="4121014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121017">s</span>&nbsp;<span class="op" id="4121019">:=</span>&nbsp;<span class="ident" id="4121022"><a href="/crypto/tls/common.go.html#4120979">c</a></span><span class="op" id="4121023">.</span><span class="ident" id="4121024">CipherSuites</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121038">if</span>&nbsp;<span class="ident" id="4121041"><a href="/crypto/tls/common.go.html#4121017">s</a></span>&nbsp;<span class="op" id="4121043">==</span>&nbsp;<span class="ident" id="4121046">nil</span>&nbsp;<span class="op" id="4121050">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121054"><a href="/crypto/tls/common.go.html#4121017">s</a></span>&nbsp;<span class="op" id="4121056">=</span>&nbsp;<span class="ident" id="4121058"><a href="/crypto/tls/common.go.html#4126725">defaultCipherSuites</a></span><span class="op" id="4121077">(</span><span class="op" id="4121078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121084">return</span>&nbsp;<span class="ident" id="4121091"><a href="/crypto/tls/common.go.html#4121017">s</a></span><br>
<span class="lineno"></span><span class="op" id="4121093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="4121096">func</span>&nbsp;<span class="op" id="4121101">(</span><span class="ident" id="4121102">c</span>&nbsp;<span class="op" id="4121104">*</span><span class="ident" id="4121105"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4121111">)</span>&nbsp;<span class="ident" id="4121113">minVersion</span><span class="op" id="4121123">(</span><span class="op" id="4121124">)</span>&nbsp;<span class="builtintype" id="4121126">uint16</span>&nbsp;<span class="op" id="4121133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121136">if</span>&nbsp;<span class="ident" id="4121139"><a href="/crypto/tls/common.go.html#4121102">c</a></span>&nbsp;<span class="op" id="4121141">==</span>&nbsp;<span class="ident" id="4121144">nil</span>&nbsp;<span class="op" id="4121148">||</span>&nbsp;<span class="ident" id="4121151"><a href="/crypto/tls/common.go.html#4121102">c</a></span><span class="op" id="4121152">.</span><span class="ident" id="4121153">MinVersion</span>&nbsp;<span class="op" id="4121164">==</span>&nbsp;<span class="num" id="4121167">0</span>&nbsp;<span class="op" id="4121169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121173">return</span>&nbsp;<span class="ident" id="4121180"><a href="/crypto/tls/common.go.html#4108521">minVersion</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121195">return</span>&nbsp;<span class="ident" id="4121202"><a href="/crypto/tls/common.go.html#4121102">c</a></span><span class="op" id="4121203">.</span><span class="ident" id="4121204">MinVersion</span><br>
<span class="lineno">395</span><span class="op" id="4121215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4121218">func</span>&nbsp;<span class="op" id="4121223">(</span><span class="ident" id="4121224">c</span>&nbsp;<span class="op" id="4121226">*</span><span class="ident" id="4121227"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4121233">)</span>&nbsp;<span class="ident" id="4121235">maxVersion</span><span class="op" id="4121245">(</span><span class="op" id="4121246">)</span>&nbsp;<span class="builtintype" id="4121248">uint16</span>&nbsp;<span class="op" id="4121255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121258">if</span>&nbsp;<span class="ident" id="4121261"><a href="/crypto/tls/common.go.html#4121224">c</a></span>&nbsp;<span class="op" id="4121263">==</span>&nbsp;<span class="ident" id="4121266">nil</span>&nbsp;<span class="op" id="4121270">||</span>&nbsp;<span class="ident" id="4121273"><a href="/crypto/tls/common.go.html#4121224">c</a></span><span class="op" id="4121274">.</span><span class="ident" id="4121275">MaxVersion</span>&nbsp;<span class="op" id="4121286">==</span>&nbsp;<span class="num" id="4121289">0</span>&nbsp;<span class="op" id="4121291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121295">return</span>&nbsp;<span class="ident" id="4121302"><a href="/crypto/tls/common.go.html#4108548">maxVersion</a></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121317">return</span>&nbsp;<span class="ident" id="4121324"><a href="/crypto/tls/common.go.html#4121224">c</a></span><span class="op" id="4121325">.</span><span class="ident" id="4121326">MaxVersion</span><br>
<span class="lineno"></span><span class="op" id="4121337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4121340">var</span>&nbsp;<span class="ident" id="4121344">defaultCurvePreferences</span>&nbsp;<span class="op" id="4121368">=</span>&nbsp;<span class="op" id="4121370">[</span><span class="op" id="4121371">]</span><span class="ident" id="4121372"><a href="/crypto/tls/common.go.html#4110037">CurveID</a></span><span class="op" id="4121379">{</span><span class="ident" id="4121380"><a href="/crypto/tls/common.go.html#4110062">CurveP256</a></span><span class="op" id="4121389">,</span>&nbsp;<span class="ident" id="4121391"><a href="/crypto/tls/common.go.html#4110086">CurveP384</a></span><span class="op" id="4121400">,</span>&nbsp;<span class="ident" id="4121402"><a href="/crypto/tls/common.go.html#4110110">CurveP521</a></span><span class="op" id="4121411">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4121414">func</span>&nbsp;<span class="op" id="4121419">(</span><span class="ident" id="4121420">c</span>&nbsp;<span class="op" id="4121422">*</span><span class="ident" id="4121423"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4121429">)</span>&nbsp;<span class="ident" id="4121431">curvePreferences</span><span class="op" id="4121447">(</span><span class="op" id="4121448">)</span>&nbsp;<span class="op" id="4121450">[</span><span class="op" id="4121451">]</span><span class="ident" id="4121452"><a href="/crypto/tls/common.go.html#4110037">CurveID</a></span>&nbsp;<span class="op" id="4121460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121463">if</span>&nbsp;<span class="ident" id="4121466"><a href="/crypto/tls/common.go.html#4121420">c</a></span>&nbsp;<span class="op" id="4121468">==</span>&nbsp;<span class="ident" id="4121471">nil</span>&nbsp;<span class="op" id="4121475">||</span>&nbsp;<span class="builtinfunc" id="4121478">len</span><span class="op" id="4121481">(</span><span class="ident" id="4121482"><a href="/crypto/tls/common.go.html#4121420">c</a></span><span class="op" id="4121483">.</span><span class="ident" id="4121484">CurvePreferences</span><span class="op" id="4121500">)</span>&nbsp;<span class="op" id="4121502">==</span>&nbsp;<span class="num" id="4121505">0</span>&nbsp;<span class="op" id="4121507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121511">return</span>&nbsp;<span class="ident" id="4121518"><a href="/crypto/tls/common.go.html#4121344">defaultCurvePreferences</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121543">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121546">return</span>&nbsp;<span class="ident" id="4121553"><a href="/crypto/tls/common.go.html#4121420">c</a></span><span class="op" id="4121554">.</span><span class="ident" id="4121555">CurvePreferences</span><br>
<span class="lineno"></span><span class="op" id="4121572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4121575">//&nbsp;mutualVersion&nbsp;returns&nbsp;the&nbsp;protocol&nbsp;version&nbsp;to&nbsp;use&nbsp;given&nbsp;the&nbsp;advertised</span><br>
<span class="lineno"></span><span class="comment" id="4121649">//&nbsp;version&nbsp;of&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">415</span><span class="keyword" id="4121673">func</span>&nbsp;<span class="op" id="4121678">(</span><span class="ident" id="4121679">c</span>&nbsp;<span class="op" id="4121681">*</span><span class="ident" id="4121682"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4121688">)</span>&nbsp;<span class="ident" id="4121690">mutualVersion</span><span class="op" id="4121703">(</span><span class="ident" id="4121704">vers</span>&nbsp;<span class="builtintype" id="4121709">uint16</span><span class="op" id="4121715">)</span>&nbsp;<span class="op" id="4121717">(</span><span class="builtintype" id="4121718">uint16</span><span class="op" id="4121724">,</span>&nbsp;<span class="builtintype" id="4121726">bool</span><span class="op" id="4121730">)</span>&nbsp;<span class="op" id="4121732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121735">minVersion</span>&nbsp;<span class="op" id="4121746">:=</span>&nbsp;<span class="ident" id="4121749"><a href="/crypto/tls/common.go.html#4121679">c</a></span><span class="op" id="4121750">.</span><span class="ident" id="4121751">minVersion</span><span class="op" id="4121761">(</span><span class="op" id="4121762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121765">maxVersion</span>&nbsp;<span class="op" id="4121776">:=</span>&nbsp;<span class="ident" id="4121779"><a href="/crypto/tls/common.go.html#4121679">c</a></span><span class="op" id="4121780">.</span><span class="ident" id="4121781">maxVersion</span><span class="op" id="4121791">(</span><span class="op" id="4121792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121796">if</span>&nbsp;<span class="ident" id="4121799"><a href="/crypto/tls/common.go.html#4121704">vers</a></span>&nbsp;<span class="op" id="4121804">&lt;</span>&nbsp;<span class="ident" id="4121806"><a href="/crypto/tls/common.go.html#4121735">minVersion</a></span>&nbsp;<span class="op" id="4121817">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121821">return</span>&nbsp;<span class="num" id="4121828">0</span><span class="op" id="4121829">,</span>&nbsp;<span class="ident" id="4121831">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121841">if</span>&nbsp;<span class="ident" id="4121844"><a href="/crypto/tls/common.go.html#4121704">vers</a></span>&nbsp;<span class="op" id="4121849">&gt;</span>&nbsp;<span class="ident" id="4121851"><a href="/crypto/tls/common.go.html#4121765">maxVersion</a></span>&nbsp;<span class="op" id="4121862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121866"><a href="/crypto/tls/common.go.html#4121704">vers</a></span>&nbsp;<span class="op" id="4121871">=</span>&nbsp;<span class="ident" id="4121873"><a href="/crypto/tls/common.go.html#4121765">maxVersion</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121885">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121888">return</span>&nbsp;<span class="ident" id="4121895"><a href="/crypto/tls/common.go.html#4121704">vers</a></span><span class="op" id="4121899">,</span>&nbsp;<span class="ident" id="4121901">true</span><br>
<span class="lineno"></span><span class="op" id="4121906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4121909">//&nbsp;getCertificate&nbsp;returns&nbsp;the&nbsp;best&nbsp;certificate&nbsp;for&nbsp;the&nbsp;given&nbsp;ClientHelloInfo,</span><br>
<span class="lineno"></span><span class="comment" id="4121987">//&nbsp;defaulting&nbsp;to&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;c.Certificates.</span><br>
<span class="lineno">430</span><span class="keyword" id="4122041">func</span>&nbsp;<span class="op" id="4122046">(</span><span class="ident" id="4122047">c</span>&nbsp;<span class="op" id="4122049">*</span><span class="ident" id="4122050"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4122056">)</span>&nbsp;<span class="ident" id="4122058">getCertificate</span><span class="op" id="4122072">(</span><span class="ident" id="4122073">clientHello</span>&nbsp;<span class="op" id="4122085">*</span><span class="ident" id="4122086"><a href="/crypto/tls/common.go.html#4115067">ClientHelloInfo</a></span><span class="op" id="4122101">)</span>&nbsp;<span class="op" id="4122103">(</span><span class="op" id="4122104">*</span><span class="ident" id="4122105"><a href="/crypto/tls/common.go.html#4123683">Certificate</a></span><span class="op" id="4122116">,</span>&nbsp;<span class="builtintype" id="4122118">error</span><span class="op" id="4122123">)</span>&nbsp;<span class="op" id="4122125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122128">if</span>&nbsp;<span class="ident" id="4122131"><a href="/crypto/tls/common.go.html#4122047">c</a></span><span class="op" id="4122132">.</span><span class="ident" id="4122133">GetCertificate</span>&nbsp;<span class="op" id="4122148">!=</span>&nbsp;<span class="ident" id="4122151">nil</span>&nbsp;<span class="op" id="4122155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122159">cert</span><span class="op" id="4122163">,</span>&nbsp;<span class="ident" id="4122165">err</span>&nbsp;<span class="op" id="4122169">:=</span>&nbsp;<span class="ident" id="4122172"><a href="/crypto/tls/common.go.html#4122047">c</a></span><span class="op" id="4122173">.</span><span class="ident" id="4122174">GetCertificate</span><span class="op" id="4122188">(</span><span class="ident" id="4122189"><a href="/crypto/tls/common.go.html#4122073">clientHello</a></span><span class="op" id="4122200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122204">if</span>&nbsp;<span class="ident" id="4122207"><a href="/crypto/tls/common.go.html#4122159">cert</a></span>&nbsp;<span class="op" id="4122212">!=</span>&nbsp;<span class="ident" id="4122215">nil</span>&nbsp;<span class="op" id="4122219">||</span>&nbsp;<span class="ident" id="4122222"><a href="/crypto/tls/common.go.html#4122165">err</a></span>&nbsp;<span class="op" id="4122226">!=</span>&nbsp;<span class="ident" id="4122229">nil</span>&nbsp;<span class="op" id="4122233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122238">return</span>&nbsp;<span class="ident" id="4122245"><a href="/crypto/tls/common.go.html#4122159">cert</a></span><span class="op" id="4122249">,</span>&nbsp;<span class="ident" id="4122251"><a href="/crypto/tls/common.go.html#4122165">err</a></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122264">if</span>&nbsp;<span class="builtinfunc" id="4122267">len</span><span class="op" id="4122270">(</span><span class="ident" id="4122271"><a href="/crypto/tls/common.go.html#4122047">c</a></span><span class="op" id="4122272">.</span><span class="ident" id="4122273">Certificates</span><span class="op" id="4122285">)</span>&nbsp;<span class="op" id="4122287">==</span>&nbsp;<span class="num" id="4122290">1</span>&nbsp;<span class="op" id="4122292">||</span>&nbsp;<span class="ident" id="4122295"><a href="/crypto/tls/common.go.html#4122047">c</a></span><span class="op" id="4122296">.</span><span class="ident" id="4122297">NameToCertificate</span>&nbsp;<span class="op" id="4122315">==</span>&nbsp;<span class="ident" id="4122318">nil</span>&nbsp;<span class="op" id="4122322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122326">//&nbsp;There&#39;s&nbsp;only&nbsp;one&nbsp;choice,&nbsp;so&nbsp;no&nbsp;point&nbsp;doing&nbsp;any&nbsp;work.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122384">return</span>&nbsp;<span class="op" id="4122391">&amp;</span><span class="ident" id="4122392"><a href="/crypto/tls/common.go.html#4122047">c</a></span><span class="op" id="4122393">.</span><span class="ident" id="4122394">Certificates</span><span class="op" id="4122406">[</span><span class="num" id="4122407">0</span><span class="op" id="4122408">]</span><span class="op" id="4122409">,</span>&nbsp;<span class="ident" id="4122411">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122420">name</span>&nbsp;<span class="op" id="4122425">:=</span>&nbsp;<span class="ident" id="4122428"><a href="/crypto/tls/common.go.html#4108098">strings</a></span><span class="op" id="4122435">.</span><span class="ident" id="4122436">ToLower</span><span class="op" id="4122443">(</span><span class="ident" id="4122444"><a href="/crypto/tls/common.go.html#4122073">clientHello</a></span><span class="op" id="4122455">.</span><span class="ident" id="4122456">ServerName</span><span class="op" id="4122466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122469">for</span>&nbsp;<span class="builtinfunc" id="4122473">len</span><span class="op" id="4122476">(</span><span class="ident" id="4122477"><a href="/crypto/tls/common.go.html#4122420">name</a></span><span class="op" id="4122481">)</span>&nbsp;<span class="op" id="4122483">&gt;</span>&nbsp;<span class="num" id="4122485">0</span>&nbsp;<span class="op" id="4122487">&amp;&amp;</span>&nbsp;<span class="ident" id="4122490"><a href="/crypto/tls/common.go.html#4122420">name</a></span><span class="op" id="4122494">[</span><span class="builtinfunc" id="4122495">len</span><span class="op" id="4122498">(</span><span class="ident" id="4122499"><a href="/crypto/tls/common.go.html#4122420">name</a></span><span class="op" id="4122503">)</span><span class="op" id="4122504">-</span><span class="num" id="4122505">1</span><span class="op" id="4122506">]</span>&nbsp;<span class="op" id="4122508">==</span>&nbsp;<span class="string" id="4122511">&#39;.&#39;</span>&nbsp;<span class="op" id="4122515">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122519"><a href="/crypto/tls/common.go.html#4122420">name</a></span>&nbsp;<span class="op" id="4122524">=</span>&nbsp;<span class="ident" id="4122526"><a href="/crypto/tls/common.go.html#4122420">name</a></span><span class="op" id="4122530">[</span><span class="op" id="4122531">:</span><span class="builtinfunc" id="4122532">len</span><span class="op" id="4122535">(</span><span class="ident" id="4122536"><a href="/crypto/tls/common.go.html#4122420">name</a></span><span class="op" id="4122540">)</span><span class="op" id="4122541">-</span><span class="num" id="4122542">1</span><span class="op" id="4122543">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122550">if</span>&nbsp;<span class="ident" id="4122553">cert</span><span class="op" id="4122557">,</span>&nbsp;<span class="ident" id="4122559">ok</span>&nbsp;<span class="op" id="4122562">:=</span>&nbsp;<span class="ident" id="4122565"><a href="/crypto/tls/common.go.html#4122047">c</a></span><span class="op" id="4122566">.</span><span class="ident" id="4122567">NameToCertificate</span><span class="op" id="4122584">[</span><span class="ident" id="4122585"><a href="/crypto/tls/common.go.html#4122420">name</a></span><span class="op" id="4122589">]</span><span class="op" id="4122590">;</span>&nbsp;<span class="ident" id="4122592"><a href="/crypto/tls/common.go.html#4122559">ok</a></span>&nbsp;<span class="op" id="4122595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122599">return</span>&nbsp;<span class="ident" id="4122606"><a href="/crypto/tls/common.go.html#4122553">cert</a></span><span class="op" id="4122610">,</span>&nbsp;<span class="ident" id="4122612">nil</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122621">//&nbsp;try&nbsp;replacing&nbsp;labels&nbsp;in&nbsp;the&nbsp;name&nbsp;with&nbsp;wildcards&nbsp;until&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122688">//&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122699">labels</span>&nbsp;<span class="op" id="4122706">:=</span>&nbsp;<span class="ident" id="4122709"><a href="/crypto/tls/common.go.html#4108098">strings</a></span><span class="op" id="4122716">.</span><span class="ident" id="4122717">Split</span><span class="op" id="4122722">(</span><span class="ident" id="4122723"><a href="/crypto/tls/common.go.html#4122420">name</a></span><span class="op" id="4122727">,</span>&nbsp;<span class="string" id="4122729">&#34;.&#34;</span><span class="op" id="4122732">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122735">for</span>&nbsp;<span class="ident" id="4122739">i</span>&nbsp;<span class="op" id="4122741">:=</span>&nbsp;<span class="keyword" id="4122744">range</span>&nbsp;<span class="ident" id="4122750"><a href="/crypto/tls/common.go.html#4122699">labels</a></span>&nbsp;<span class="op" id="4122757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122761"><a href="/crypto/tls/common.go.html#4122699">labels</a></span><span class="op" id="4122767">[</span><span class="ident" id="4122768"><a href="/crypto/tls/common.go.html#4122739">i</a></span><span class="op" id="4122769">]</span>&nbsp;<span class="op" id="4122771">=</span>&nbsp;<span class="string" id="4122773">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122779">candidate</span>&nbsp;<span class="op" id="4122789">:=</span>&nbsp;<span class="ident" id="4122792"><a href="/crypto/tls/common.go.html#4108098">strings</a></span><span class="op" id="4122799">.</span><span class="ident" id="4122800">Join</span><span class="op" id="4122804">(</span><span class="ident" id="4122805"><a href="/crypto/tls/common.go.html#4122699">labels</a></span><span class="op" id="4122811">,</span>&nbsp;<span class="string" id="4122813">&#34;.&#34;</span><span class="op" id="4122816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122820">if</span>&nbsp;<span class="ident" id="4122823">cert</span><span class="op" id="4122827">,</span>&nbsp;<span class="ident" id="4122829">ok</span>&nbsp;<span class="op" id="4122832">:=</span>&nbsp;<span class="ident" id="4122835"><a href="/crypto/tls/common.go.html#4122047">c</a></span><span class="op" id="4122836">.</span><span class="ident" id="4122837">NameToCertificate</span><span class="op" id="4122854">[</span><span class="ident" id="4122855"><a href="/crypto/tls/common.go.html#4122779">candidate</a></span><span class="op" id="4122864">]</span><span class="op" id="4122865">;</span>&nbsp;<span class="ident" id="4122867"><a href="/crypto/tls/common.go.html#4122829">ok</a></span>&nbsp;<span class="op" id="4122870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122875">return</span>&nbsp;<span class="ident" id="4122882"><a href="/crypto/tls/common.go.html#4122823">cert</a></span><span class="op" id="4122886">,</span>&nbsp;<span class="ident" id="4122888">nil</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122901">//&nbsp;If&nbsp;nothing&nbsp;matches,&nbsp;return&nbsp;the&nbsp;first&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122955">return</span>&nbsp;<span class="op" id="4122962">&amp;</span><span class="ident" id="4122963"><a href="/crypto/tls/common.go.html#4122047">c</a></span><span class="op" id="4122964">.</span><span class="ident" id="4122965">Certificates</span><span class="op" id="4122977">[</span><span class="num" id="4122978">0</span><span class="op" id="4122979">]</span><span class="op" id="4122980">,</span>&nbsp;<span class="ident" id="4122982">nil</span><br>
<span class="lineno">465</span><span class="op" id="4122986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4122989">//&nbsp;BuildNameToCertificate&nbsp;parses&nbsp;c.Certificates&nbsp;and&nbsp;builds&nbsp;c.NameToCertificate</span><br>
<span class="lineno"></span><span class="comment" id="4123068">//&nbsp;from&nbsp;the&nbsp;CommonName&nbsp;and&nbsp;SubjectAlternateName&nbsp;fields&nbsp;of&nbsp;each&nbsp;of&nbsp;the&nbsp;leaf</span><br>
<span class="lineno"></span><span class="comment" id="4123143">//&nbsp;certificates.</span><br>
<span class="lineno">470</span><span class="keyword" id="4123160">func</span>&nbsp;<span class="op" id="4123165">(</span><span class="ident" id="4123166">c</span>&nbsp;<span class="op" id="4123168">*</span><span class="ident" id="4123169"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4123175">)</span>&nbsp;<span class="ident" id="4123177">BuildNameToCertificate</span><span class="op" id="4123199">(</span><span class="op" id="4123200">)</span>&nbsp;<span class="op" id="4123202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123205"><a href="/crypto/tls/common.go.html#4123166">c</a></span><span class="op" id="4123206">.</span><span class="ident" id="4123207">NameToCertificate</span>&nbsp;<span class="op" id="4123225">=</span>&nbsp;<span class="builtinfunc" id="4123227">make</span><span class="op" id="4123231">(</span><span class="keyword" id="4123232">map</span><span class="op" id="4123235">[</span><span class="builtintype" id="4123236">string</span><span class="op" id="4123242">]</span><span class="op" id="4123243">*</span><span class="ident" id="4123244"><a href="/crypto/tls/common.go.html#4123683">Certificate</a></span><span class="op" id="4123255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123258">for</span>&nbsp;<span class="ident" id="4123262">i</span>&nbsp;<span class="op" id="4123264">:=</span>&nbsp;<span class="keyword" id="4123267">range</span>&nbsp;<span class="ident" id="4123273"><a href="/crypto/tls/common.go.html#4123166">c</a></span><span class="op" id="4123274">.</span><span class="ident" id="4123275">Certificates</span>&nbsp;<span class="op" id="4123288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123292">cert</span>&nbsp;<span class="op" id="4123297">:=</span>&nbsp;<span class="op" id="4123300">&amp;</span><span class="ident" id="4123301"><a href="/crypto/tls/common.go.html#4123166">c</a></span><span class="op" id="4123302">.</span><span class="ident" id="4123303">Certificates</span><span class="op" id="4123315">[</span><span class="ident" id="4123316"><a href="/crypto/tls/common.go.html#4123262">i</a></span><span class="op" id="4123317">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123321">x509Cert</span><span class="op" id="4123329">,</span>&nbsp;<span class="ident" id="4123331">err</span>&nbsp;<span class="op" id="4123335">:=</span>&nbsp;<span class="ident" id="4123338"><a href="/crypto/tls/common.go.html#4108058">x509</a></span><span class="op" id="4123342">.</span><span class="ident" id="4123343">ParseCertificate</span><span class="op" id="4123359">(</span><span class="ident" id="4123360"><a href="/crypto/tls/common.go.html#4123292">cert</a></span><span class="op" id="4123364">.</span><span class="ident" id="4123365">Certificate</span><span class="op" id="4123376">[</span><span class="num" id="4123377">0</span><span class="op" id="4123378">]</span><span class="op" id="4123379">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123383">if</span>&nbsp;<span class="ident" id="4123386"><a href="/crypto/tls/common.go.html#4123331">err</a></span>&nbsp;<span class="op" id="4123390">!=</span>&nbsp;<span class="ident" id="4123393">nil</span>&nbsp;<span class="op" id="4123397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123402">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123417">if</span>&nbsp;<span class="builtinfunc" id="4123420">len</span><span class="op" id="4123423">(</span><span class="ident" id="4123424"><a href="/crypto/tls/common.go.html#4123321">x509Cert</a></span><span class="op" id="4123432">.</span><span class="ident" id="4123433">Subject</span><span class="op" id="4123440">.</span><span class="ident" id="4123441">CommonName</span><span class="op" id="4123451">)</span>&nbsp;<span class="op" id="4123453">&gt;</span>&nbsp;<span class="num" id="4123455">0</span>&nbsp;<span class="op" id="4123457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123462"><a href="/crypto/tls/common.go.html#4123166">c</a></span><span class="op" id="4123463">.</span><span class="ident" id="4123464">NameToCertificate</span><span class="op" id="4123481">[</span><span class="ident" id="4123482"><a href="/crypto/tls/common.go.html#4123321">x509Cert</a></span><span class="op" id="4123490">.</span><span class="ident" id="4123491">Subject</span><span class="op" id="4123498">.</span><span class="ident" id="4123499">CommonName</span><span class="op" id="4123509">]</span>&nbsp;<span class="op" id="4123511">=</span>&nbsp;<span class="ident" id="4123513"><a href="/crypto/tls/common.go.html#4123292">cert</a></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123524">for</span>&nbsp;<span class="ident" id="4123528">_</span><span class="op" id="4123529">,</span>&nbsp;<span class="ident" id="4123531">san</span>&nbsp;<span class="op" id="4123535">:=</span>&nbsp;<span class="keyword" id="4123538">range</span>&nbsp;<span class="ident" id="4123544"><a href="/crypto/tls/common.go.html#4123321">x509Cert</a></span><span class="op" id="4123552">.</span><span class="ident" id="4123553">DNSNames</span>&nbsp;<span class="op" id="4123562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123567"><a href="/crypto/tls/common.go.html#4123166">c</a></span><span class="op" id="4123568">.</span><span class="ident" id="4123569">NameToCertificate</span><span class="op" id="4123586">[</span><span class="ident" id="4123587"><a href="/crypto/tls/common.go.html#4123531">san</a></span><span class="op" id="4123590">]</span>&nbsp;<span class="op" id="4123592">=</span>&nbsp;<span class="ident" id="4123594"><a href="/crypto/tls/common.go.html#4123292">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123604">}</span><br>
<span class="lineno">485</span><span class="op" id="4123606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4123609">//&nbsp;A&nbsp;Certificate&nbsp;is&nbsp;a&nbsp;chain&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates,&nbsp;leaf&nbsp;first.</span><br>
<span class="lineno"></span><span class="keyword" id="4123678">type</span>&nbsp;<span class="ident" id="4123683">Certificate</span>&nbsp;<span class="keyword" id="4123695">struct</span>&nbsp;<span class="op" id="4123702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123705">Certificate</span>&nbsp;<span class="op" id="4123717">[</span><span class="op" id="4123718">]</span><span class="op" id="4123719">[</span><span class="op" id="4123720">]</span><span class="builtintype" id="4123721">byte</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123727">//&nbsp;PrivateKey&nbsp;contains&nbsp;the&nbsp;private&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;public&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123799">//&nbsp;in&nbsp;Leaf.&nbsp;For&nbsp;a&nbsp;server,&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;*rsa.PrivateKey&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123860">//&nbsp;*ecdsa.PrivateKey.&nbsp;For&nbsp;a&nbsp;client&nbsp;doing&nbsp;client&nbsp;authentication,&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123930">//&nbsp;can&nbsp;be&nbsp;any&nbsp;type&nbsp;that&nbsp;implements&nbsp;crypto.Signer&nbsp;(which&nbsp;includes&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124000">//&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys).</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124029">PrivateKey</span>&nbsp;<span class="ident" id="4124040"><a href="/crypto/tls/common.go.html#4108033">crypto</a></span><span class="op" id="4124046">.</span><span class="ident" id="4124047">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124059">//&nbsp;OCSPStaple&nbsp;contains&nbsp;an&nbsp;optional&nbsp;OCSP&nbsp;response&nbsp;which&nbsp;will&nbsp;be&nbsp;served</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124130">//&nbsp;to&nbsp;clients&nbsp;that&nbsp;request&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124162">OCSPStaple</span>&nbsp;<span class="op" id="4124173">[</span><span class="op" id="4124174">]</span><span class="builtintype" id="4124175">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124181">//&nbsp;Leaf&nbsp;is&nbsp;the&nbsp;parsed&nbsp;form&nbsp;of&nbsp;the&nbsp;leaf&nbsp;certificate,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124247">//&nbsp;initialized&nbsp;using&nbsp;x509.ParseCertificate&nbsp;to&nbsp;reduce&nbsp;per-handshake</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124315">//&nbsp;processing&nbsp;for&nbsp;TLS&nbsp;clients&nbsp;doing&nbsp;client&nbsp;authentication.&nbsp;If&nbsp;nil,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124387">//&nbsp;leaf&nbsp;certificate&nbsp;will&nbsp;be&nbsp;parsed&nbsp;as&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124434">Leaf</span>&nbsp;<span class="op" id="4124439">*</span><span class="ident" id="4124440"><a href="/crypto/tls/common.go.html#4108058">x509</a></span><span class="op" id="4124444">.</span><span class="ident" id="4124445">Certificate</span><br>
<span class="lineno"></span><span class="op" id="4124457">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="4124460">//&nbsp;A&nbsp;TLS&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="4124477">type</span>&nbsp;<span class="ident" id="4124482">record</span>&nbsp;<span class="keyword" id="4124489">struct</span>&nbsp;<span class="op" id="4124496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124499">contentType</span>&nbsp;&nbsp;<span class="ident" id="4124512"><a href="/crypto/tls/common.go.html#4108603">recordType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124524">major</span><span class="op" id="4124529">,</span>&nbsp;<span class="ident" id="4124531">minor</span>&nbsp;<span class="builtintype" id="4124537">uint8</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124544">payload</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124557">[</span><span class="op" id="4124558">]</span><span class="builtintype" id="4124559">byte</span><br>
<span class="lineno"></span><span class="op" id="4124564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4124567">type</span>&nbsp;<span class="ident" id="4124572">handshakeMessage</span>&nbsp;<span class="keyword" id="4124589">interface</span>&nbsp;<span class="op" id="4124599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124602">marshal</span><span class="op" id="4124609">(</span><span class="op" id="4124610">)</span>&nbsp;<span class="op" id="4124612">[</span><span class="op" id="4124613">]</span><span class="builtintype" id="4124614">byte</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124620">unmarshal</span><span class="op" id="4124629">(</span><span class="op" id="4124630">[</span><span class="op" id="4124631">]</span><span class="builtintype" id="4124632">byte</span><span class="op" id="4124636">)</span>&nbsp;<span class="builtintype" id="4124638">bool</span><br>
<span class="lineno"></span><span class="op" id="4124643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4124646">//&nbsp;lruSessionCache&nbsp;is&nbsp;a&nbsp;ClientSessionCache&nbsp;implementation&nbsp;that&nbsp;uses&nbsp;an&nbsp;LRU</span><br>
<span class="lineno"></span><span class="comment" id="4124721">//&nbsp;caching&nbsp;strategy.</span><br>
<span class="lineno">520</span><span class="keyword" id="4124742">type</span>&nbsp;<span class="ident" id="4124747">lruSessionCache</span>&nbsp;<span class="keyword" id="4124763">struct</span>&nbsp;<span class="op" id="4124770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124773"><a href="/crypto/tls/common.go.html#4108109">sync</a></span><span class="op" id="4124777">.</span><span class="ident" id="4124778">Mutex</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124786">m</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124795">map</span><span class="op" id="4124798">[</span><span class="builtintype" id="4124799">string</span><span class="op" id="4124805">]</span><span class="op" id="4124806">*</span><span class="ident" id="4124807"><a href="/crypto/tls/common.go.html#4108015">list</a></span><span class="op" id="4124811">.</span><span class="ident" id="4124812">Element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124821">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124830">*</span><span class="ident" id="4124831"><a href="/crypto/tls/common.go.html#4108015">list</a></span><span class="op" id="4124835">.</span><span class="ident" id="4124836">List</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124842">capacity</span>&nbsp;<span class="builtintype" id="4124851">int</span><br>
<span class="lineno"></span><span class="op" id="4124855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4124858">type</span>&nbsp;<span class="ident" id="4124863">lruSessionCacheEntry</span>&nbsp;<span class="keyword" id="4124884">struct</span>&nbsp;<span class="op" id="4124891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124894">sessionKey</span>&nbsp;<span class="builtintype" id="4124905">string</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124913">state</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124924">*</span><span class="ident" id="4124925"><a href="/crypto/tls/common.go.html#4113855">ClientSessionState</a></span><br>
<span class="lineno"></span><span class="op" id="4124944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4124947">//&nbsp;NewLRUClientSessionCache&nbsp;returns&nbsp;a&nbsp;ClientSessionCache&nbsp;with&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4125019">//&nbsp;capacity&nbsp;that&nbsp;uses&nbsp;an&nbsp;LRU&nbsp;strategy.&nbsp;If&nbsp;capacity&nbsp;is&nbsp;&lt;&nbsp;1,&nbsp;a&nbsp;default&nbsp;capacity</span><br>
<span class="lineno">535</span><span class="comment" id="4125097">//&nbsp;is&nbsp;used&nbsp;instead.</span><br>
<span class="lineno"></span><span class="keyword" id="4125117">func</span>&nbsp;<span class="ident" id="4125122">NewLRUClientSessionCache</span><span class="op" id="4125146">(</span><span class="ident" id="4125147">capacity</span>&nbsp;<span class="builtintype" id="4125156">int</span><span class="op" id="4125159">)</span>&nbsp;<span class="ident" id="4125161"><a href="/crypto/tls/common.go.html#4114588">ClientSessionCache</a></span>&nbsp;<span class="op" id="4125180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125183">const</span>&nbsp;<span class="ident" id="4125189">defaultSessionCacheCapacity</span>&nbsp;<span class="op" id="4125217">=</span>&nbsp;<span class="num" id="4125219">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125224">if</span>&nbsp;<span class="ident" id="4125227"><a href="/crypto/tls/common.go.html#4125147">capacity</a></span>&nbsp;<span class="op" id="4125236">&lt;</span>&nbsp;<span class="num" id="4125238">1</span>&nbsp;<span class="op" id="4125240">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125244"><a href="/crypto/tls/common.go.html#4125147">capacity</a></span>&nbsp;<span class="op" id="4125253">=</span>&nbsp;<span class="ident" id="4125255"><a href="/crypto/tls/common.go.html#4125189">defaultSessionCacheCapacity</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125287">return</span>&nbsp;<span class="op" id="4125294">&amp;</span><span class="ident" id="4125295"><a href="/crypto/tls/common.go.html#4124747">lruSessionCache</a></span><span class="op" id="4125310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125314">m</span><span class="op" id="4125315">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4125324">make</span><span class="op" id="4125328">(</span><span class="keyword" id="4125329">map</span><span class="op" id="4125332">[</span><span class="builtintype" id="4125333">string</span><span class="op" id="4125339">]</span><span class="op" id="4125340">*</span><span class="ident" id="4125341"><a href="/crypto/tls/common.go.html#4108015">list</a></span><span class="op" id="4125345">.</span><span class="ident" id="4125346">Element</span><span class="op" id="4125353">)</span><span class="op" id="4125354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125358">q</span><span class="op" id="4125359">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125368"><a href="/crypto/tls/common.go.html#4108015">list</a></span><span class="op" id="4125372">.</span><span class="ident" id="4125373">New</span><span class="op" id="4125376">(</span><span class="op" id="4125377">)</span><span class="op" id="4125378">,</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125382">capacity</span><span class="op" id="4125390">:</span>&nbsp;<span class="ident" id="4125392"><a href="/crypto/tls/common.go.html#4125147">capacity</a></span><span class="op" id="4125400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125403">}</span><br>
<span class="lineno"></span><span class="op" id="4125405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4125408">//&nbsp;Put&nbsp;adds&nbsp;the&nbsp;provided&nbsp;(sessionKey,&nbsp;cs)&nbsp;pair&nbsp;to&nbsp;the&nbsp;cache.</span><br>
<span class="lineno">550</span><span class="keyword" id="4125469">func</span>&nbsp;<span class="op" id="4125474">(</span><span class="ident" id="4125475">c</span>&nbsp;<span class="op" id="4125477">*</span><span class="ident" id="4125478"><a href="/crypto/tls/common.go.html#4124747">lruSessionCache</a></span><span class="op" id="4125493">)</span>&nbsp;<span class="ident" id="4125495">Put</span><span class="op" id="4125498">(</span><span class="ident" id="4125499">sessionKey</span>&nbsp;<span class="builtintype" id="4125510">string</span><span class="op" id="4125516">,</span>&nbsp;<span class="ident" id="4125518">cs</span>&nbsp;<span class="op" id="4125521">*</span><span class="ident" id="4125522"><a href="/crypto/tls/common.go.html#4113855">ClientSessionState</a></span><span class="op" id="4125540">)</span>&nbsp;<span class="op" id="4125542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125545"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125546">.</span><span class="ident" id="4125547">Lock</span><span class="op" id="4125551">(</span><span class="op" id="4125552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125555">defer</span>&nbsp;<span class="ident" id="4125561"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125562">.</span><span class="ident" id="4125563">Unlock</span><span class="op" id="4125569">(</span><span class="op" id="4125570">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125574">if</span>&nbsp;<span class="ident" id="4125577">elem</span><span class="op" id="4125581">,</span>&nbsp;<span class="ident" id="4125583">ok</span>&nbsp;<span class="op" id="4125586">:=</span>&nbsp;<span class="ident" id="4125589"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125590">.</span><span class="ident" id="4125591">m</span><span class="op" id="4125592">[</span><span class="ident" id="4125593"><a href="/crypto/tls/common.go.html#4125499">sessionKey</a></span><span class="op" id="4125603">]</span><span class="op" id="4125604">;</span>&nbsp;<span class="ident" id="4125606"><a href="/crypto/tls/common.go.html#4125583">ok</a></span>&nbsp;<span class="op" id="4125609">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125613">entry</span>&nbsp;<span class="op" id="4125619">:=</span>&nbsp;<span class="ident" id="4125622"><a href="/crypto/tls/common.go.html#4125577">elem</a></span><span class="op" id="4125626">.</span><span class="ident" id="4125627">Value</span><span class="op" id="4125632">.</span><span class="op" id="4125633">(</span><span class="op" id="4125634">*</span><span class="ident" id="4125635"><a href="/crypto/tls/common.go.html#4124863">lruSessionCacheEntry</a></span><span class="op" id="4125655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125659"><a href="/crypto/tls/common.go.html#4125613">entry</a></span><span class="op" id="4125664">.</span><span class="ident" id="4125665">state</span>&nbsp;<span class="op" id="4125671">=</span>&nbsp;<span class="ident" id="4125673"><a href="/crypto/tls/common.go.html#4125518">cs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125678"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125679">.</span><span class="ident" id="4125680">q</span><span class="op" id="4125681">.</span><span class="ident" id="4125682">MoveToFront</span><span class="op" id="4125693">(</span><span class="ident" id="4125694"><a href="/crypto/tls/common.go.html#4125577">elem</a></span><span class="op" id="4125698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125702">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125710">}</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125714">if</span>&nbsp;<span class="ident" id="4125717"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125718">.</span><span class="ident" id="4125719">q</span><span class="op" id="4125720">.</span><span class="ident" id="4125721">Len</span><span class="op" id="4125724">(</span><span class="op" id="4125725">)</span>&nbsp;<span class="op" id="4125727">&lt;</span>&nbsp;<span class="ident" id="4125729"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125730">.</span><span class="ident" id="4125731">capacity</span>&nbsp;<span class="op" id="4125740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125744">entry</span>&nbsp;<span class="op" id="4125750">:=</span>&nbsp;<span class="op" id="4125753">&amp;</span><span class="ident" id="4125754"><a href="/crypto/tls/common.go.html#4124863">lruSessionCacheEntry</a></span><span class="op" id="4125774">{</span><span class="ident" id="4125775"><a href="/crypto/tls/common.go.html#4125499">sessionKey</a></span><span class="op" id="4125785">,</span>&nbsp;<span class="ident" id="4125787"><a href="/crypto/tls/common.go.html#4125518">cs</a></span><span class="op" id="4125789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125793"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125794">.</span><span class="ident" id="4125795">m</span><span class="op" id="4125796">[</span><span class="ident" id="4125797"><a href="/crypto/tls/common.go.html#4125499">sessionKey</a></span><span class="op" id="4125807">]</span>&nbsp;<span class="op" id="4125809">=</span>&nbsp;<span class="ident" id="4125811"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125812">.</span><span class="ident" id="4125813">q</span><span class="op" id="4125814">.</span><span class="ident" id="4125815">PushFront</span><span class="op" id="4125824">(</span><span class="ident" id="4125825"><a href="/crypto/tls/common.go.html#4125744">entry</a></span><span class="op" id="4125830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125834">return</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125846">elem</span>&nbsp;<span class="op" id="4125851">:=</span>&nbsp;<span class="ident" id="4125854"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125855">.</span><span class="ident" id="4125856">q</span><span class="op" id="4125857">.</span><span class="ident" id="4125858">Back</span><span class="op" id="4125862">(</span><span class="op" id="4125863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125866">entry</span>&nbsp;<span class="op" id="4125872">:=</span>&nbsp;<span class="ident" id="4125875"><a href="/crypto/tls/common.go.html#4125846">elem</a></span><span class="op" id="4125879">.</span><span class="ident" id="4125880">Value</span><span class="op" id="4125885">.</span><span class="op" id="4125886">(</span><span class="op" id="4125887">*</span><span class="ident" id="4125888"><a href="/crypto/tls/common.go.html#4124863">lruSessionCacheEntry</a></span><span class="op" id="4125908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4125911">delete</span><span class="op" id="4125917">(</span><span class="ident" id="4125918"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125919">.</span><span class="ident" id="4125920">m</span><span class="op" id="4125921">,</span>&nbsp;<span class="ident" id="4125923"><a href="/crypto/tls/common.go.html#4125866">entry</a></span><span class="op" id="4125928">.</span><span class="ident" id="4125929">sessionKey</span><span class="op" id="4125939">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125942"><a href="/crypto/tls/common.go.html#4125866">entry</a></span><span class="op" id="4125947">.</span><span class="ident" id="4125948">sessionKey</span>&nbsp;<span class="op" id="4125959">=</span>&nbsp;<span class="ident" id="4125961"><a href="/crypto/tls/common.go.html#4125499">sessionKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125973"><a href="/crypto/tls/common.go.html#4125866">entry</a></span><span class="op" id="4125978">.</span><span class="ident" id="4125979">state</span>&nbsp;<span class="op" id="4125985">=</span>&nbsp;<span class="ident" id="4125987"><a href="/crypto/tls/common.go.html#4125518">cs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125991"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4125992">.</span><span class="ident" id="4125993">q</span><span class="op" id="4125994">.</span><span class="ident" id="4125995">MoveToFront</span><span class="op" id="4126006">(</span><span class="ident" id="4126007"><a href="/crypto/tls/common.go.html#4125846">elem</a></span><span class="op" id="4126011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126014"><a href="/crypto/tls/common.go.html#4125475">c</a></span><span class="op" id="4126015">.</span><span class="ident" id="4126016">m</span><span class="op" id="4126017">[</span><span class="ident" id="4126018"><a href="/crypto/tls/common.go.html#4125499">sessionKey</a></span><span class="op" id="4126028">]</span>&nbsp;<span class="op" id="4126030">=</span>&nbsp;<span class="ident" id="4126032"><a href="/crypto/tls/common.go.html#4125846">elem</a></span><br>
<span class="lineno"></span><span class="op" id="4126037">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="4126040">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;ClientSessionState&nbsp;value&nbsp;associated&nbsp;with&nbsp;a&nbsp;given&nbsp;key.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="4126116">//&nbsp;returns&nbsp;(nil,&nbsp;false)&nbsp;if&nbsp;no&nbsp;value&nbsp;is&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="4126162">func</span>&nbsp;<span class="op" id="4126167">(</span><span class="ident" id="4126168">c</span>&nbsp;<span class="op" id="4126170">*</span><span class="ident" id="4126171"><a href="/crypto/tls/common.go.html#4124747">lruSessionCache</a></span><span class="op" id="4126186">)</span>&nbsp;<span class="ident" id="4126188">Get</span><span class="op" id="4126191">(</span><span class="ident" id="4126192">sessionKey</span>&nbsp;<span class="builtintype" id="4126203">string</span><span class="op" id="4126209">)</span>&nbsp;<span class="op" id="4126211">(</span><span class="op" id="4126212">*</span><span class="ident" id="4126213"><a href="/crypto/tls/common.go.html#4113855">ClientSessionState</a></span><span class="op" id="4126231">,</span>&nbsp;<span class="builtintype" id="4126233">bool</span><span class="op" id="4126237">)</span>&nbsp;<span class="op" id="4126239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126242"><a href="/crypto/tls/common.go.html#4126168">c</a></span><span class="op" id="4126243">.</span><span class="ident" id="4126244">Lock</span><span class="op" id="4126248">(</span><span class="op" id="4126249">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126252">defer</span>&nbsp;<span class="ident" id="4126258"><a href="/crypto/tls/common.go.html#4126168">c</a></span><span class="op" id="4126259">.</span><span class="ident" id="4126260">Unlock</span><span class="op" id="4126266">(</span><span class="op" id="4126267">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126271">if</span>&nbsp;<span class="ident" id="4126274">elem</span><span class="op" id="4126278">,</span>&nbsp;<span class="ident" id="4126280">ok</span>&nbsp;<span class="op" id="4126283">:=</span>&nbsp;<span class="ident" id="4126286"><a href="/crypto/tls/common.go.html#4126168">c</a></span><span class="op" id="4126287">.</span><span class="ident" id="4126288">m</span><span class="op" id="4126289">[</span><span class="ident" id="4126290"><a href="/crypto/tls/common.go.html#4126192">sessionKey</a></span><span class="op" id="4126300">]</span><span class="op" id="4126301">;</span>&nbsp;<span class="ident" id="4126303"><a href="/crypto/tls/common.go.html#4126280">ok</a></span>&nbsp;<span class="op" id="4126306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126310"><a href="/crypto/tls/common.go.html#4126168">c</a></span><span class="op" id="4126311">.</span><span class="ident" id="4126312">q</span><span class="op" id="4126313">.</span><span class="ident" id="4126314">MoveToFront</span><span class="op" id="4126325">(</span><span class="ident" id="4126326"><a href="/crypto/tls/common.go.html#4126274">elem</a></span><span class="op" id="4126330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126334">return</span>&nbsp;<span class="ident" id="4126341"><a href="/crypto/tls/common.go.html#4126274">elem</a></span><span class="op" id="4126345">.</span><span class="ident" id="4126346">Value</span><span class="op" id="4126351">.</span><span class="op" id="4126352">(</span><span class="op" id="4126353">*</span><span class="ident" id="4126354"><a href="/crypto/tls/common.go.html#4124863">lruSessionCacheEntry</a></span><span class="op" id="4126374">)</span><span class="op" id="4126375">.</span><span class="ident" id="4126376">state</span><span class="op" id="4126381">,</span>&nbsp;<span class="ident" id="4126383">true</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126392">return</span>&nbsp;<span class="ident" id="4126399">nil</span><span class="op" id="4126402">,</span>&nbsp;<span class="ident" id="4126404">false</span><br>
<span class="lineno"></span><span class="op" id="4126410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4126413">//&nbsp;TODO(jsing):&nbsp;Make&nbsp;these&nbsp;available&nbsp;to&nbsp;both&nbsp;crypto/x509&nbsp;and&nbsp;crypto/tls.</span><br>
<span class="lineno">590</span><span class="keyword" id="4126486">type</span>&nbsp;<span class="ident" id="4126491">dsaSignature</span>&nbsp;<span class="keyword" id="4126504">struct</span>&nbsp;<span class="op" id="4126511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126514">R</span><span class="op" id="4126515">,</span>&nbsp;<span class="ident" id="4126517">S</span>&nbsp;<span class="op" id="4126519">*</span><span class="ident" id="4126520"><a href="/crypto/tls/common.go.html#4108086">big</a></span><span class="op" id="4126523">.</span><span class="ident" id="4126524">Int</span><br>
<span class="lineno"></span><span class="op" id="4126528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4126531">type</span>&nbsp;<span class="ident" id="4126536">ecdsaSignature</span>&nbsp;<span class="ident" id="4126551"><a href="/crypto/tls/common.go.html#4126491">dsaSignature</a></span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span><span class="keyword" id="4126565">var</span>&nbsp;<span class="ident" id="4126569">emptyConfig</span>&nbsp;<span class="ident" id="4126581"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4126589">func</span>&nbsp;<span class="ident" id="4126594">defaultConfig</span><span class="op" id="4126607">(</span><span class="op" id="4126608">)</span>&nbsp;<span class="op" id="4126610">*</span><span class="ident" id="4126611"><a href="/crypto/tls/common.go.html#4116177">Config</a></span>&nbsp;<span class="op" id="4126618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126621">return</span>&nbsp;<span class="op" id="4126628">&amp;</span><span class="ident" id="4126629"><a href="/crypto/tls/common.go.html#4126569">emptyConfig</a></span><br>
<span class="lineno">600</span><span class="op" id="4126641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4126644">var</span>&nbsp;<span class="op" id="4126648">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126651">once</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126674"><a href="/crypto/tls/common.go.html#4108109">sync</a></span><span class="op" id="4126678">.</span><span class="ident" id="4126679">Once</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126685">varDefaultCipherSuites</span>&nbsp;<span class="op" id="4126708">[</span><span class="op" id="4126709">]</span><span class="builtintype" id="4126710">uint16</span><br>
<span class="lineno">605</span><span class="op" id="4126717">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4126720">func</span>&nbsp;<span class="ident" id="4126725">defaultCipherSuites</span><span class="op" id="4126744">(</span><span class="op" id="4126745">)</span>&nbsp;<span class="op" id="4126747">[</span><span class="op" id="4126748">]</span><span class="builtintype" id="4126749">uint16</span>&nbsp;<span class="op" id="4126756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126759"><a href="/crypto/tls/common.go.html#4126651">once</a></span><span class="op" id="4126763">.</span><span class="ident" id="4126764">Do</span><span class="op" id="4126766">(</span><span class="ident" id="4126767"><a href="/crypto/tls/common.go.html#4126831">initDefaultCipherSuites</a></span><span class="op" id="4126790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126793">return</span>&nbsp;<span class="ident" id="4126800"><a href="/crypto/tls/common.go.html#4126685">varDefaultCipherSuites</a></span><br>
<span class="lineno">610</span><span class="op" id="4126823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4126826">func</span>&nbsp;<span class="ident" id="4126831">initDefaultCipherSuites</span><span class="op" id="4126854">(</span><span class="op" id="4126855">)</span>&nbsp;<span class="op" id="4126857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126860"><a href="/crypto/tls/common.go.html#4126685">varDefaultCipherSuites</a></span>&nbsp;<span class="op" id="4126883">=</span>&nbsp;<span class="builtinfunc" id="4126885">make</span><span class="op" id="4126889">(</span><span class="op" id="4126890">[</span><span class="op" id="4126891">]</span><span class="builtintype" id="4126892">uint16</span><span class="op" id="4126898">,</span>&nbsp;<span class="builtinfunc" id="4126900">len</span><span class="op" id="4126903">(</span><span class="ident" id="4126904"><a href="/crypto/tls/cipher_suites.go.html#4100787">cipherSuites</a></span><span class="op" id="4126916">)</span><span class="op" id="4126917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126920">for</span>&nbsp;<span class="ident" id="4126924">i</span><span class="op" id="4126925">,</span>&nbsp;<span class="ident" id="4126927">suite</span>&nbsp;<span class="op" id="4126933">:=</span>&nbsp;<span class="keyword" id="4126936">range</span>&nbsp;<span class="ident" id="4126942"><a href="/crypto/tls/cipher_suites.go.html#4100787">cipherSuites</a></span>&nbsp;<span class="op" id="4126955">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126959"><a href="/crypto/tls/common.go.html#4126685">varDefaultCipherSuites</a></span><span class="op" id="4126981">[</span><span class="ident" id="4126982"><a href="/crypto/tls/common.go.html#4126924">i</a></span><span class="op" id="4126983">]</span>&nbsp;<span class="op" id="4126985">=</span>&nbsp;<span class="ident" id="4126987"><a href="/crypto/tls/common.go.html#4126927">suite</a></span><span class="op" id="4126992">.</span><span class="ident" id="4126993">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126997">}</span><br>
<span class="lineno"></span><span class="op" id="4126999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4127002">func</span>&nbsp;<span class="ident" id="4127007">unexpectedMessageError</span><span class="op" id="4127029">(</span><span class="ident" id="4127030">wanted</span><span class="op" id="4127036">,</span>&nbsp;<span class="ident" id="4127038">got</span>&nbsp;<span class="keyword" id="4127042">interface</span><span class="op" id="4127051">{</span><span class="op" id="4127052">}</span><span class="op" id="4127053">)</span>&nbsp;<span class="builtintype" id="4127055">error</span>&nbsp;<span class="op" id="4127061">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127064">return</span>&nbsp;<span class="ident" id="4127071"><a href="/crypto/tls/common.go.html#4108073">fmt</a></span><span class="op" id="4127074">.</span><span class="ident" id="4127075">Errorf</span><span class="op" id="4127081">(</span><span class="string" id="4127082">&#34;tls:&nbsp;received&nbsp;unexpected&nbsp;handshake&nbsp;message&nbsp;of&nbsp;type&nbsp;%T&nbsp;when&nbsp;waiting&nbsp;for&nbsp;%T&#34;</span><span class="op" id="4127157">,</span>&nbsp;<span class="ident" id="4127159"><a href="/crypto/tls/common.go.html#4127038">got</a></span><span class="op" id="4127162">,</span>&nbsp;<span class="ident" id="4127164"><a href="/crypto/tls/common.go.html#4127030">wanted</a></span><span class="op" id="4127170">)</span><br>
<span class="lineno"></span><span class="op" id="4127172">}</span>
</div>
</body>
</html>
