<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html" class="current">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3648381">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3648436">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3648490">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3648541">package</span>&nbsp;<span class="ident" id="3648549">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3648555">import</span>&nbsp;<span class="op" id="3648562">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3648565">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3648574">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3648584">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3648591">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3648599">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3648610">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="3648620">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3648623">//&nbsp;FormatMediaType&nbsp;serializes&nbsp;mediatype&nbsp;t&nbsp;and&nbsp;the&nbsp;parameters</span><br>
<span class="lineno"></span><span class="comment" id="3648684">//&nbsp;param&nbsp;as&nbsp;a&nbsp;media&nbsp;type&nbsp;conforming&nbsp;to&nbsp;RFC&nbsp;2045&nbsp;and&nbsp;RFC&nbsp;2616.</span><br>
<span class="lineno"></span><span class="comment" id="3648746">//&nbsp;The&nbsp;type&nbsp;and&nbsp;parameter&nbsp;names&nbsp;are&nbsp;written&nbsp;in&nbsp;lower-case.</span><br>
<span class="lineno"></span><span class="comment" id="3648805">//&nbsp;When&nbsp;any&nbsp;of&nbsp;the&nbsp;arguments&nbsp;result&nbsp;in&nbsp;a&nbsp;standard&nbsp;violation&nbsp;then</span><br>
<span class="lineno">20</span><span class="comment" id="3648870">//&nbsp;FormatMediaType&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3648915">func</span>&nbsp;<span class="ident" id="3648920">FormatMediaType</span><span class="op" id="3648935">(</span><span class="ident" id="3648936">t</span>&nbsp;<span class="builtintype" id="3648938">string</span><span class="op" id="3648944">,</span>&nbsp;<span class="ident" id="3648946">param</span>&nbsp;<span class="keyword" id="3648952">map</span><span class="op" id="3648955">[</span><span class="builtintype" id="3648956">string</span><span class="op" id="3648962">]</span><span class="builtintype" id="3648963">string</span><span class="op" id="3648969">)</span>&nbsp;<span class="builtintype" id="3648971">string</span>&nbsp;<span class="op" id="3648978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3648981">slash</span>&nbsp;<span class="op" id="3648987">:=</span>&nbsp;<span class="ident" id="3648990">strings</span><span class="op" id="3648997">.</span><span class="ident" id="3648998">Index</span><span class="op" id="3649003">(</span><span class="ident" id="3649004">t</span><span class="op" id="3649005">,</span>&nbsp;<span class="string" id="3649007">&#34;/&#34;</span><span class="op" id="3649010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649013">if</span>&nbsp;<span class="ident" id="3649016">slash</span>&nbsp;<span class="op" id="3649022">==</span>&nbsp;<span class="op" id="3649025">-</span><span class="num" id="3649026">1</span>&nbsp;<span class="op" id="3649028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649032">return</span>&nbsp;<span class="string" id="3649039">&#34;&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649046">major</span><span class="op" id="3649051">,</span>&nbsp;<span class="ident" id="3649053">sub</span>&nbsp;<span class="op" id="3649057">:=</span>&nbsp;<span class="ident" id="3649060">t</span><span class="op" id="3649061">[</span><span class="op" id="3649062">:</span><span class="ident" id="3649063">slash</span><span class="op" id="3649068">]</span><span class="op" id="3649069">,</span>&nbsp;<span class="ident" id="3649071">t</span><span class="op" id="3649072">[</span><span class="ident" id="3649073">slash</span><span class="op" id="3649078">+</span><span class="num" id="3649079">1</span><span class="op" id="3649080">:</span><span class="op" id="3649081">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649084">if</span>&nbsp;<span class="op" id="3649087">!</span><span class="ident" id="3649088">isToken</span><span class="op" id="3649095">(</span><span class="ident" id="3649096">major</span><span class="op" id="3649101">)</span>&nbsp;<span class="op" id="3649103">||</span>&nbsp;<span class="op" id="3649106">!</span><span class="ident" id="3649107">isToken</span><span class="op" id="3649114">(</span><span class="ident" id="3649115">sub</span><span class="op" id="3649118">)</span>&nbsp;<span class="op" id="3649120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649124">return</span>&nbsp;<span class="string" id="3649131">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649135">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649138">var</span>&nbsp;<span class="ident" id="3649142">b</span>&nbsp;<span class="ident" id="3649144">bytes</span><span class="op" id="3649149">.</span><span class="ident" id="3649150">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649158">b</span><span class="op" id="3649159">.</span><span class="ident" id="3649160">WriteString</span><span class="op" id="3649171">(</span><span class="ident" id="3649172">strings</span><span class="op" id="3649179">.</span><span class="ident" id="3649180">ToLower</span><span class="op" id="3649187">(</span><span class="ident" id="3649188">major</span><span class="op" id="3649193">)</span><span class="op" id="3649194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649197">b</span><span class="op" id="3649198">.</span><span class="ident" id="3649199">WriteByte</span><span class="op" id="3649208">(</span><span class="string" id="3649209">&#39;/&#39;</span><span class="op" id="3649212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649215">b</span><span class="op" id="3649216">.</span><span class="ident" id="3649217">WriteString</span><span class="op" id="3649228">(</span><span class="ident" id="3649229">strings</span><span class="op" id="3649236">.</span><span class="ident" id="3649237">ToLower</span><span class="op" id="3649244">(</span><span class="ident" id="3649245">sub</span><span class="op" id="3649248">)</span><span class="op" id="3649249">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649253">attrs</span>&nbsp;<span class="op" id="3649259">:=</span>&nbsp;<span class="builtinfunc" id="3649262">make</span><span class="op" id="3649266">(</span><span class="op" id="3649267">[</span><span class="op" id="3649268">]</span><span class="builtintype" id="3649269">string</span><span class="op" id="3649275">,</span>&nbsp;<span class="num" id="3649277">0</span><span class="op" id="3649278">,</span>&nbsp;<span class="builtinfunc" id="3649280">len</span><span class="op" id="3649283">(</span><span class="ident" id="3649284">param</span><span class="op" id="3649289">)</span><span class="op" id="3649290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649293">for</span>&nbsp;<span class="ident" id="3649297">a</span>&nbsp;<span class="op" id="3649299">:=</span>&nbsp;<span class="keyword" id="3649302">range</span>&nbsp;<span class="ident" id="3649308">param</span>&nbsp;<span class="op" id="3649314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649318">attrs</span>&nbsp;<span class="op" id="3649324">=</span>&nbsp;<span class="builtinfunc" id="3649326">append</span><span class="op" id="3649332">(</span><span class="ident" id="3649333">attrs</span><span class="op" id="3649338">,</span>&nbsp;<span class="ident" id="3649340">a</span><span class="op" id="3649341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649347">sort</span><span class="op" id="3649351">.</span><span class="ident" id="3649352">Strings</span><span class="op" id="3649359">(</span><span class="ident" id="3649360">attrs</span><span class="op" id="3649365">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649369">for</span>&nbsp;<span class="ident" id="3649373">_</span><span class="op" id="3649374">,</span>&nbsp;<span class="ident" id="3649376">attribute</span>&nbsp;<span class="op" id="3649386">:=</span>&nbsp;<span class="keyword" id="3649389">range</span>&nbsp;<span class="ident" id="3649395">attrs</span>&nbsp;<span class="op" id="3649401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649405">value</span>&nbsp;<span class="op" id="3649411">:=</span>&nbsp;<span class="ident" id="3649414">param</span><span class="op" id="3649419">[</span><span class="ident" id="3649420">attribute</span><span class="op" id="3649429">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649433">b</span><span class="op" id="3649434">.</span><span class="ident" id="3649435">WriteByte</span><span class="op" id="3649444">(</span><span class="string" id="3649445">&#39;;&#39;</span><span class="op" id="3649448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649452">b</span><span class="op" id="3649453">.</span><span class="ident" id="3649454">WriteByte</span><span class="op" id="3649463">(</span><span class="string" id="3649464">&#39;&nbsp;&#39;</span><span class="op" id="3649467">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649471">if</span>&nbsp;<span class="op" id="3649474">!</span><span class="ident" id="3649475">isToken</span><span class="op" id="3649482">(</span><span class="ident" id="3649483">attribute</span><span class="op" id="3649492">)</span>&nbsp;<span class="op" id="3649494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649499">return</span>&nbsp;<span class="string" id="3649506">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649515">b</span><span class="op" id="3649516">.</span><span class="ident" id="3649517">WriteString</span><span class="op" id="3649528">(</span><span class="ident" id="3649529">strings</span><span class="op" id="3649536">.</span><span class="ident" id="3649537">ToLower</span><span class="op" id="3649544">(</span><span class="ident" id="3649545">attribute</span><span class="op" id="3649554">)</span><span class="op" id="3649555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649559">b</span><span class="op" id="3649560">.</span><span class="ident" id="3649561">WriteByte</span><span class="op" id="3649570">(</span><span class="string" id="3649571">&#39;=&#39;</span><span class="op" id="3649574">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649578">if</span>&nbsp;<span class="ident" id="3649581">isToken</span><span class="op" id="3649588">(</span><span class="ident" id="3649589">value</span><span class="op" id="3649594">)</span>&nbsp;<span class="op" id="3649596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649601">b</span><span class="op" id="3649602">.</span><span class="ident" id="3649603">WriteString</span><span class="op" id="3649614">(</span><span class="ident" id="3649615">value</span><span class="op" id="3649620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649625">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649641">b</span><span class="op" id="3649642">.</span><span class="ident" id="3649643">WriteByte</span><span class="op" id="3649652">(</span><span class="string" id="3649653">&#39;&#34;&#39;</span><span class="op" id="3649656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649660">offset</span>&nbsp;<span class="op" id="3649667">:=</span>&nbsp;<span class="num" id="3649670">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649674">for</span>&nbsp;<span class="ident" id="3649678">index</span><span class="op" id="3649683">,</span>&nbsp;<span class="ident" id="3649685">character</span>&nbsp;<span class="op" id="3649695">:=</span>&nbsp;<span class="keyword" id="3649698">range</span>&nbsp;<span class="ident" id="3649704">value</span>&nbsp;<span class="op" id="3649710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649715">if</span>&nbsp;<span class="ident" id="3649718">character</span>&nbsp;<span class="op" id="3649728">==</span>&nbsp;<span class="string" id="3649731">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3649735">||</span>&nbsp;<span class="ident" id="3649738">character</span>&nbsp;<span class="op" id="3649748">==</span>&nbsp;<span class="string" id="3649751">&#39;\\&#39;</span>&nbsp;<span class="op" id="3649756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649762">b</span><span class="op" id="3649763">.</span><span class="ident" id="3649764">WriteString</span><span class="op" id="3649775">(</span><span class="ident" id="3649776">value</span><span class="op" id="3649781">[</span><span class="ident" id="3649782">offset</span><span class="op" id="3649788">:</span><span class="ident" id="3649789">index</span><span class="op" id="3649794">]</span><span class="op" id="3649795">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649801">offset</span>&nbsp;<span class="op" id="3649808">=</span>&nbsp;<span class="ident" id="3649810">index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649820">b</span><span class="op" id="3649821">.</span><span class="ident" id="3649822">WriteByte</span><span class="op" id="3649831">(</span><span class="string" id="3649832">&#39;\\&#39;</span><span class="op" id="3649836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649846">if</span>&nbsp;<span class="ident" id="3649849">character</span><span class="op" id="3649858">&amp;</span><span class="num" id="3649859">0x80</span>&nbsp;<span class="op" id="3649864">!=</span>&nbsp;<span class="num" id="3649867">0</span>&nbsp;<span class="op" id="3649869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649875">return</span>&nbsp;<span class="string" id="3649882">&#34;&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649896">b</span><span class="op" id="3649897">.</span><span class="ident" id="3649898">WriteString</span><span class="op" id="3649909">(</span><span class="ident" id="3649910">value</span><span class="op" id="3649915">[</span><span class="ident" id="3649916">offset</span><span class="op" id="3649922">:</span><span class="op" id="3649923">]</span><span class="op" id="3649924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649928">b</span><span class="op" id="3649929">.</span><span class="ident" id="3649930">WriteByte</span><span class="op" id="3649939">(</span><span class="string" id="3649940">&#39;&#34;&#39;</span><span class="op" id="3649943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649946">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649949">return</span>&nbsp;<span class="ident" id="3649956">b</span><span class="op" id="3649957">.</span><span class="ident" id="3649958">String</span><span class="op" id="3649964">(</span><span class="op" id="3649965">)</span><br>
<span class="lineno"></span><span class="op" id="3649967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3649970">func</span>&nbsp;<span class="ident" id="3649975">checkMediaTypeDisposition</span><span class="op" id="3650000">(</span><span class="ident" id="3650001">s</span>&nbsp;<span class="builtintype" id="3650003">string</span><span class="op" id="3650009">)</span>&nbsp;<span class="builtintype" id="3650011">error</span>&nbsp;<span class="op" id="3650017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3650020">typ</span><span class="op" id="3650023">,</span>&nbsp;<span class="ident" id="3650025">rest</span>&nbsp;<span class="op" id="3650030">:=</span>&nbsp;<span class="ident" id="3650033">consumeToken</span><span class="op" id="3650045">(</span><span class="ident" id="3650046">s</span><span class="op" id="3650047">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650050">if</span>&nbsp;<span class="ident" id="3650053">typ</span>&nbsp;<span class="op" id="3650057">==</span>&nbsp;<span class="string" id="3650060">&#34;&#34;</span>&nbsp;<span class="op" id="3650063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650067">return</span>&nbsp;<span class="ident" id="3650074">errors</span><span class="op" id="3650080">.</span><span class="ident" id="3650081">New</span><span class="op" id="3650084">(</span><span class="string" id="3650085">&#34;mime:&nbsp;no&nbsp;media&nbsp;type&#34;</span><span class="op" id="3650106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650112">if</span>&nbsp;<span class="ident" id="3650115">rest</span>&nbsp;<span class="op" id="3650120">==</span>&nbsp;<span class="string" id="3650123">&#34;&#34;</span>&nbsp;<span class="op" id="3650126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650130">return</span>&nbsp;<span class="ident" id="3650137">nil</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650145">if</span>&nbsp;<span class="op" id="3650148">!</span><span class="ident" id="3650149">strings</span><span class="op" id="3650156">.</span><span class="ident" id="3650157">HasPrefix</span><span class="op" id="3650166">(</span><span class="ident" id="3650167">rest</span><span class="op" id="3650171">,</span>&nbsp;<span class="string" id="3650173">&#34;/&#34;</span><span class="op" id="3650176">)</span>&nbsp;<span class="op" id="3650178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650182">return</span>&nbsp;<span class="ident" id="3650189">errors</span><span class="op" id="3650195">.</span><span class="ident" id="3650196">New</span><span class="op" id="3650199">(</span><span class="string" id="3650200">&#34;mime:&nbsp;expected&nbsp;slash&nbsp;after&nbsp;first&nbsp;token&#34;</span><span class="op" id="3650240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3650246">subtype</span><span class="op" id="3650253">,</span>&nbsp;<span class="ident" id="3650255">rest</span>&nbsp;<span class="op" id="3650260">:=</span>&nbsp;<span class="ident" id="3650263">consumeToken</span><span class="op" id="3650275">(</span><span class="ident" id="3650276">rest</span><span class="op" id="3650280">[</span><span class="num" id="3650281">1</span><span class="op" id="3650282">:</span><span class="op" id="3650283">]</span><span class="op" id="3650284">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650287">if</span>&nbsp;<span class="ident" id="3650290">subtype</span>&nbsp;<span class="op" id="3650298">==</span>&nbsp;<span class="string" id="3650301">&#34;&#34;</span>&nbsp;<span class="op" id="3650304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650308">return</span>&nbsp;<span class="ident" id="3650315">errors</span><span class="op" id="3650321">.</span><span class="ident" id="3650322">New</span><span class="op" id="3650325">(</span><span class="string" id="3650326">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="3650360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650366">if</span>&nbsp;<span class="ident" id="3650369">rest</span>&nbsp;<span class="op" id="3650374">!=</span>&nbsp;<span class="string" id="3650377">&#34;&#34;</span>&nbsp;<span class="op" id="3650380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650384">return</span>&nbsp;<span class="ident" id="3650391">errors</span><span class="op" id="3650397">.</span><span class="ident" id="3650398">New</span><span class="op" id="3650401">(</span><span class="string" id="3650402">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="3650448">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650454">return</span>&nbsp;<span class="ident" id="3650461">nil</span><br>
<span class="lineno"></span><span class="op" id="3650465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3650468">//&nbsp;ParseMediaType&nbsp;parses&nbsp;a&nbsp;media&nbsp;type&nbsp;value&nbsp;and&nbsp;any&nbsp;optional</span><br>
<span class="lineno">95</span><span class="comment" id="3650529">//&nbsp;parameters,&nbsp;per&nbsp;RFC&nbsp;1521.&nbsp;&nbsp;Media&nbsp;types&nbsp;are&nbsp;the&nbsp;values&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3650589">//&nbsp;Content-Type&nbsp;and&nbsp;Content-Disposition&nbsp;headers&nbsp;(RFC&nbsp;2183).</span><br>
<span class="lineno"></span><span class="comment" id="3650649">//&nbsp;On&nbsp;success,&nbsp;ParseMediaType&nbsp;returns&nbsp;the&nbsp;media&nbsp;type&nbsp;converted</span><br>
<span class="lineno"></span><span class="comment" id="3650712">//&nbsp;to&nbsp;lowercase&nbsp;and&nbsp;trimmed&nbsp;of&nbsp;white&nbsp;space&nbsp;and&nbsp;a&nbsp;non-nil&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="3650774">//&nbsp;The&nbsp;returned&nbsp;map,&nbsp;params,&nbsp;maps&nbsp;from&nbsp;the&nbsp;lowercase</span><br>
<span class="lineno">100</span><span class="comment" id="3650827">//&nbsp;attribute&nbsp;to&nbsp;the&nbsp;attribute&nbsp;value&nbsp;with&nbsp;its&nbsp;case&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="keyword" id="3650888">func</span>&nbsp;<span class="ident" id="3650893">ParseMediaType</span><span class="op" id="3650907">(</span><span class="ident" id="3650908">v</span>&nbsp;<span class="builtintype" id="3650910">string</span><span class="op" id="3650916">)</span>&nbsp;<span class="op" id="3650918">(</span><span class="ident" id="3650919">mediatype</span>&nbsp;<span class="builtintype" id="3650929">string</span><span class="op" id="3650935">,</span>&nbsp;<span class="ident" id="3650937">params</span>&nbsp;<span class="keyword" id="3650944">map</span><span class="op" id="3650947">[</span><span class="builtintype" id="3650948">string</span><span class="op" id="3650954">]</span><span class="builtintype" id="3650955">string</span><span class="op" id="3650961">,</span>&nbsp;<span class="ident" id="3650963">err</span>&nbsp;<span class="builtintype" id="3650967">error</span><span class="op" id="3650972">)</span>&nbsp;<span class="op" id="3650974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3650977">i</span>&nbsp;<span class="op" id="3650979">:=</span>&nbsp;<span class="ident" id="3650982">strings</span><span class="op" id="3650989">.</span><span class="ident" id="3650990">Index</span><span class="op" id="3650995">(</span><span class="ident" id="3650996">v</span><span class="op" id="3650997">,</span>&nbsp;<span class="string" id="3650999">&#34;;&#34;</span><span class="op" id="3651002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651005">if</span>&nbsp;<span class="ident" id="3651008">i</span>&nbsp;<span class="op" id="3651010">==</span>&nbsp;<span class="op" id="3651013">-</span><span class="num" id="3651014">1</span>&nbsp;<span class="op" id="3651016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651020">i</span>&nbsp;<span class="op" id="3651022">=</span>&nbsp;<span class="builtinfunc" id="3651024">len</span><span class="op" id="3651027">(</span><span class="ident" id="3651028">v</span><span class="op" id="3651029">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651035">mediatype</span>&nbsp;<span class="op" id="3651045">=</span>&nbsp;<span class="ident" id="3651047">strings</span><span class="op" id="3651054">.</span><span class="ident" id="3651055">TrimSpace</span><span class="op" id="3651064">(</span><span class="ident" id="3651065">strings</span><span class="op" id="3651072">.</span><span class="ident" id="3651073">ToLower</span><span class="op" id="3651080">(</span><span class="ident" id="3651081">v</span><span class="op" id="3651082">[</span><span class="num" id="3651083">0</span><span class="op" id="3651084">:</span><span class="ident" id="3651085">i</span><span class="op" id="3651086">]</span><span class="op" id="3651087">)</span><span class="op" id="3651088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651092">err</span>&nbsp;<span class="op" id="3651096">=</span>&nbsp;<span class="ident" id="3651098">checkMediaTypeDisposition</span><span class="op" id="3651123">(</span><span class="ident" id="3651124">mediatype</span><span class="op" id="3651133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651136">if</span>&nbsp;<span class="ident" id="3651139">err</span>&nbsp;<span class="op" id="3651143">!=</span>&nbsp;<span class="ident" id="3651146">nil</span>&nbsp;<span class="op" id="3651150">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651154">return</span>&nbsp;<span class="string" id="3651161">&#34;&#34;</span><span class="op" id="3651163">,</span>&nbsp;<span class="ident" id="3651165">nil</span><span class="op" id="3651168">,</span>&nbsp;<span class="ident" id="3651170">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651179">params</span>&nbsp;<span class="op" id="3651186">=</span>&nbsp;<span class="builtinfunc" id="3651188">make</span><span class="op" id="3651192">(</span><span class="keyword" id="3651193">map</span><span class="op" id="3651196">[</span><span class="builtintype" id="3651197">string</span><span class="op" id="3651203">]</span><span class="builtintype" id="3651204">string</span><span class="op" id="3651210">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651214">//&nbsp;Map&nbsp;of&nbsp;base&nbsp;parameter&nbsp;name&nbsp;-&gt;&nbsp;parameter&nbsp;name&nbsp;-&gt;&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651272">//&nbsp;for&nbsp;parameters&nbsp;containing&nbsp;a&nbsp;&#39;*&#39;&nbsp;character.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651319">//&nbsp;Lazily&nbsp;initialized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651343">var</span>&nbsp;<span class="ident" id="3651347">continuation</span>&nbsp;<span class="keyword" id="3651360">map</span><span class="op" id="3651363">[</span><span class="builtintype" id="3651364">string</span><span class="op" id="3651370">]</span><span class="keyword" id="3651371">map</span><span class="op" id="3651374">[</span><span class="builtintype" id="3651375">string</span><span class="op" id="3651381">]</span><span class="builtintype" id="3651382">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651391">v</span>&nbsp;<span class="op" id="3651393">=</span>&nbsp;<span class="ident" id="3651395">v</span><span class="op" id="3651396">[</span><span class="ident" id="3651397">i</span><span class="op" id="3651398">:</span><span class="op" id="3651399">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651402">for</span>&nbsp;<span class="builtinfunc" id="3651406">len</span><span class="op" id="3651409">(</span><span class="ident" id="3651410">v</span><span class="op" id="3651411">)</span>&nbsp;<span class="op" id="3651413">&gt;</span>&nbsp;<span class="num" id="3651415">0</span>&nbsp;<span class="op" id="3651417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651421">v</span>&nbsp;<span class="op" id="3651423">=</span>&nbsp;<span class="ident" id="3651425">strings</span><span class="op" id="3651432">.</span><span class="ident" id="3651433">TrimLeftFunc</span><span class="op" id="3651445">(</span><span class="ident" id="3651446">v</span><span class="op" id="3651447">,</span>&nbsp;<span class="ident" id="3651449">unicode</span><span class="op" id="3651456">.</span><span class="ident" id="3651457">IsSpace</span><span class="op" id="3651464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651468">if</span>&nbsp;<span class="builtinfunc" id="3651471">len</span><span class="op" id="3651474">(</span><span class="ident" id="3651475">v</span><span class="op" id="3651476">)</span>&nbsp;<span class="op" id="3651478">==</span>&nbsp;<span class="num" id="3651481">0</span>&nbsp;<span class="op" id="3651483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651488">break</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651500">key</span><span class="op" id="3651503">,</span>&nbsp;<span class="ident" id="3651505">value</span><span class="op" id="3651510">,</span>&nbsp;<span class="ident" id="3651512">rest</span>&nbsp;<span class="op" id="3651517">:=</span>&nbsp;<span class="ident" id="3651520">consumeMediaParam</span><span class="op" id="3651537">(</span><span class="ident" id="3651538">v</span><span class="op" id="3651539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651543">if</span>&nbsp;<span class="ident" id="3651546">key</span>&nbsp;<span class="op" id="3651550">==</span>&nbsp;<span class="string" id="3651553">&#34;&#34;</span>&nbsp;<span class="op" id="3651556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651561">if</span>&nbsp;<span class="ident" id="3651564">strings</span><span class="op" id="3651571">.</span><span class="ident" id="3651572">TrimSpace</span><span class="op" id="3651581">(</span><span class="ident" id="3651582">rest</span><span class="op" id="3651586">)</span>&nbsp;<span class="op" id="3651588">==</span>&nbsp;<span class="string" id="3651591">&#34;;&#34;</span>&nbsp;<span class="op" id="3651595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651601">//&nbsp;Ignore&nbsp;trailing&nbsp;semicolons.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651636">//&nbsp;Not&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651657">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651672">//&nbsp;Parse&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651691">return</span>&nbsp;<span class="string" id="3651698">&#34;&#34;</span><span class="op" id="3651700">,</span>&nbsp;<span class="ident" id="3651702">nil</span><span class="op" id="3651705">,</span>&nbsp;<span class="ident" id="3651707">errors</span><span class="op" id="3651713">.</span><span class="ident" id="3651714">New</span><span class="op" id="3651717">(</span><span class="string" id="3651718">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="3651749">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651758">pmap</span>&nbsp;<span class="op" id="3651763">:=</span>&nbsp;<span class="ident" id="3651766">params</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651775">if</span>&nbsp;<span class="ident" id="3651778">idx</span>&nbsp;<span class="op" id="3651782">:=</span>&nbsp;<span class="ident" id="3651785">strings</span><span class="op" id="3651792">.</span><span class="ident" id="3651793">Index</span><span class="op" id="3651798">(</span><span class="ident" id="3651799">key</span><span class="op" id="3651802">,</span>&nbsp;<span class="string" id="3651804">&#34;*&#34;</span><span class="op" id="3651807">)</span><span class="op" id="3651808">;</span>&nbsp;<span class="ident" id="3651810">idx</span>&nbsp;<span class="op" id="3651814">!=</span>&nbsp;<span class="op" id="3651817">-</span><span class="num" id="3651818">1</span>&nbsp;<span class="op" id="3651820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651825">baseName</span>&nbsp;<span class="op" id="3651834">:=</span>&nbsp;<span class="ident" id="3651837">key</span><span class="op" id="3651840">[</span><span class="op" id="3651841">:</span><span class="ident" id="3651842">idx</span><span class="op" id="3651845">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651850">if</span>&nbsp;<span class="ident" id="3651853">continuation</span>&nbsp;<span class="op" id="3651866">==</span>&nbsp;<span class="ident" id="3651869">nil</span>&nbsp;<span class="op" id="3651873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651879">continuation</span>&nbsp;<span class="op" id="3651892">=</span>&nbsp;<span class="builtinfunc" id="3651894">make</span><span class="op" id="3651898">(</span><span class="keyword" id="3651899">map</span><span class="op" id="3651902">[</span><span class="builtintype" id="3651903">string</span><span class="op" id="3651909">]</span><span class="keyword" id="3651910">map</span><span class="op" id="3651913">[</span><span class="builtintype" id="3651914">string</span><span class="op" id="3651920">]</span><span class="builtintype" id="3651921">string</span><span class="op" id="3651927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651937">var</span>&nbsp;<span class="ident" id="3651941">ok</span>&nbsp;<span class="builtintype" id="3651944">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651952">if</span>&nbsp;<span class="ident" id="3651955">pmap</span><span class="op" id="3651959">,</span>&nbsp;<span class="ident" id="3651961">ok</span>&nbsp;<span class="op" id="3651964">=</span>&nbsp;<span class="ident" id="3651966">continuation</span><span class="op" id="3651978">[</span><span class="ident" id="3651979">baseName</span><span class="op" id="3651987">]</span><span class="op" id="3651988">;</span>&nbsp;<span class="op" id="3651990">!</span><span class="ident" id="3651991">ok</span>&nbsp;<span class="op" id="3651994">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652000">continuation</span><span class="op" id="3652012">[</span><span class="ident" id="3652013">baseName</span><span class="op" id="3652021">]</span>&nbsp;<span class="op" id="3652023">=</span>&nbsp;<span class="builtinfunc" id="3652025">make</span><span class="op" id="3652029">(</span><span class="keyword" id="3652030">map</span><span class="op" id="3652033">[</span><span class="builtintype" id="3652034">string</span><span class="op" id="3652040">]</span><span class="builtintype" id="3652041">string</span><span class="op" id="3652047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652053">pmap</span>&nbsp;<span class="op" id="3652058">=</span>&nbsp;<span class="ident" id="3652060">continuation</span><span class="op" id="3652072">[</span><span class="ident" id="3652073">baseName</span><span class="op" id="3652081">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652094">if</span>&nbsp;<span class="ident" id="3652097">_</span><span class="op" id="3652098">,</span>&nbsp;<span class="ident" id="3652100">exists</span>&nbsp;<span class="op" id="3652107">:=</span>&nbsp;<span class="ident" id="3652110">pmap</span><span class="op" id="3652114">[</span><span class="ident" id="3652115">key</span><span class="op" id="3652118">]</span><span class="op" id="3652119">;</span>&nbsp;<span class="ident" id="3652121">exists</span>&nbsp;<span class="op" id="3652128">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3652133">//&nbsp;Duplicate&nbsp;parameter&nbsp;name&nbsp;is&nbsp;bogus.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652174">return</span>&nbsp;<span class="string" id="3652181">&#34;&#34;</span><span class="op" id="3652183">,</span>&nbsp;<span class="ident" id="3652185">nil</span><span class="op" id="3652188">,</span>&nbsp;<span class="ident" id="3652190">errors</span><span class="op" id="3652196">.</span><span class="ident" id="3652197">New</span><span class="op" id="3652200">(</span><span class="string" id="3652201">&#34;mime:&nbsp;duplicate&nbsp;parameter&nbsp;name&#34;</span><span class="op" id="3652233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652241">pmap</span><span class="op" id="3652245">[</span><span class="ident" id="3652246">key</span><span class="op" id="3652249">]</span>&nbsp;<span class="op" id="3652251">=</span>&nbsp;<span class="ident" id="3652253">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652261">v</span>&nbsp;<span class="op" id="3652263">=</span>&nbsp;<span class="ident" id="3652265">rest</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3652275">//&nbsp;Stitch&nbsp;together&nbsp;any&nbsp;continuations&nbsp;or&nbsp;things&nbsp;with&nbsp;stars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3652334">//&nbsp;(i.e.&nbsp;RFC&nbsp;2231&nbsp;things&nbsp;with&nbsp;stars:&nbsp;&#34;foo*0&#34;&nbsp;or&nbsp;&#34;foo*&#34;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652391">var</span>&nbsp;<span class="ident" id="3652395">buf</span>&nbsp;<span class="ident" id="3652399">bytes</span><span class="op" id="3652404">.</span><span class="ident" id="3652405">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652413">for</span>&nbsp;<span class="ident" id="3652417">key</span><span class="op" id="3652420">,</span>&nbsp;<span class="ident" id="3652422">pieceMap</span>&nbsp;<span class="op" id="3652431">:=</span>&nbsp;<span class="keyword" id="3652434">range</span>&nbsp;<span class="ident" id="3652440">continuation</span>&nbsp;<span class="op" id="3652453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652457">singlePartKey</span>&nbsp;<span class="op" id="3652471">:=</span>&nbsp;<span class="ident" id="3652474">key</span>&nbsp;<span class="op" id="3652478">+</span>&nbsp;<span class="string" id="3652480">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652486">if</span>&nbsp;<span class="ident" id="3652489">v</span><span class="op" id="3652490">,</span>&nbsp;<span class="ident" id="3652492">ok</span>&nbsp;<span class="op" id="3652495">:=</span>&nbsp;<span class="ident" id="3652498">pieceMap</span><span class="op" id="3652506">[</span><span class="ident" id="3652507">singlePartKey</span><span class="op" id="3652520">]</span><span class="op" id="3652521">;</span>&nbsp;<span class="ident" id="3652523">ok</span>&nbsp;<span class="op" id="3652526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652531">decv</span>&nbsp;<span class="op" id="3652536">:=</span>&nbsp;<span class="ident" id="3652539">decode2231Enc</span><span class="op" id="3652552">(</span><span class="ident" id="3652553">v</span><span class="op" id="3652554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652559">params</span><span class="op" id="3652565">[</span><span class="ident" id="3652566">key</span><span class="op" id="3652569">]</span>&nbsp;<span class="op" id="3652571">=</span>&nbsp;<span class="ident" id="3652573">decv</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652581">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652597">buf</span><span class="op" id="3652600">.</span><span class="ident" id="3652601">Reset</span><span class="op" id="3652606">(</span><span class="op" id="3652607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652611">valid</span>&nbsp;<span class="op" id="3652617">:=</span>&nbsp;<span class="builtintype" id="3652620">false</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652628">for</span>&nbsp;<span class="ident" id="3652632">n</span>&nbsp;<span class="op" id="3652634">:=</span>&nbsp;<span class="num" id="3652637">0</span><span class="op" id="3652638">;</span>&nbsp;<span class="op" id="3652640">;</span>&nbsp;<span class="ident" id="3652642">n</span><span class="op" id="3652643">++</span>&nbsp;<span class="op" id="3652646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652651">simplePart</span>&nbsp;<span class="op" id="3652662">:=</span>&nbsp;<span class="ident" id="3652665">fmt</span><span class="op" id="3652668">.</span><span class="ident" id="3652669">Sprintf</span><span class="op" id="3652676">(</span><span class="string" id="3652677">&#34;%s*%d&#34;</span><span class="op" id="3652684">,</span>&nbsp;<span class="ident" id="3652686">key</span><span class="op" id="3652689">,</span>&nbsp;<span class="ident" id="3652691">n</span><span class="op" id="3652692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652697">if</span>&nbsp;<span class="ident" id="3652700">v</span><span class="op" id="3652701">,</span>&nbsp;<span class="ident" id="3652703">ok</span>&nbsp;<span class="op" id="3652706">:=</span>&nbsp;<span class="ident" id="3652709">pieceMap</span><span class="op" id="3652717">[</span><span class="ident" id="3652718">simplePart</span><span class="op" id="3652728">]</span><span class="op" id="3652729">;</span>&nbsp;<span class="ident" id="3652731">ok</span>&nbsp;<span class="op" id="3652734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652740">valid</span>&nbsp;<span class="op" id="3652746">=</span>&nbsp;<span class="builtintype" id="3652748">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652757">buf</span><span class="op" id="3652760">.</span><span class="ident" id="3652761">WriteString</span><span class="op" id="3652772">(</span><span class="ident" id="3652773">v</span><span class="op" id="3652774">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652780">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652797">encodedPart</span>&nbsp;<span class="op" id="3652809">:=</span>&nbsp;<span class="ident" id="3652812">simplePart</span>&nbsp;<span class="op" id="3652823">+</span>&nbsp;<span class="string" id="3652825">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652832">if</span>&nbsp;<span class="ident" id="3652835">v</span><span class="op" id="3652836">,</span>&nbsp;<span class="ident" id="3652838">ok</span>&nbsp;<span class="op" id="3652841">:=</span>&nbsp;<span class="ident" id="3652844">pieceMap</span><span class="op" id="3652852">[</span><span class="ident" id="3652853">encodedPart</span><span class="op" id="3652864">]</span><span class="op" id="3652865">;</span>&nbsp;<span class="ident" id="3652867">ok</span>&nbsp;<span class="op" id="3652870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652876">valid</span>&nbsp;<span class="op" id="3652882">=</span>&nbsp;<span class="builtintype" id="3652884">true</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652893">if</span>&nbsp;<span class="ident" id="3652896">n</span>&nbsp;<span class="op" id="3652898">==</span>&nbsp;<span class="num" id="3652901">0</span>&nbsp;<span class="op" id="3652903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652910">buf</span><span class="op" id="3652913">.</span><span class="ident" id="3652914">WriteString</span><span class="op" id="3652925">(</span><span class="ident" id="3652926">decode2231Enc</span><span class="op" id="3652939">(</span><span class="ident" id="3652940">v</span><span class="op" id="3652941">)</span><span class="op" id="3652942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652948">}</span>&nbsp;<span class="keyword" id="3652950">else</span>&nbsp;<span class="op" id="3652955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652962">decv</span><span class="op" id="3652966">,</span>&nbsp;<span class="ident" id="3652968">_</span>&nbsp;<span class="op" id="3652970">:=</span>&nbsp;<span class="ident" id="3652973">percentHexUnescape</span><span class="op" id="3652991">(</span><span class="ident" id="3652992">v</span><span class="op" id="3652993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653000">buf</span><span class="op" id="3653003">.</span><span class="ident" id="3653004">WriteString</span><span class="op" id="3653015">(</span><span class="ident" id="3653016">decv</span><span class="op" id="3653020">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653031">}</span>&nbsp;<span class="keyword" id="3653033">else</span>&nbsp;<span class="op" id="3653038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653044">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653057">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653061">if</span>&nbsp;<span class="ident" id="3653064">valid</span>&nbsp;<span class="op" id="3653070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653075">params</span><span class="op" id="3653081">[</span><span class="ident" id="3653082">key</span><span class="op" id="3653085">]</span>&nbsp;<span class="op" id="3653087">=</span>&nbsp;<span class="ident" id="3653089">buf</span><span class="op" id="3653092">.</span><span class="ident" id="3653093">String</span><span class="op" id="3653099">(</span><span class="op" id="3653100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653111">return</span><br>
<span class="lineno"></span><span class="op" id="3653118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3653121">func</span>&nbsp;<span class="ident" id="3653126">decode2231Enc</span><span class="op" id="3653139">(</span><span class="ident" id="3653140">v</span>&nbsp;<span class="builtintype" id="3653142">string</span><span class="op" id="3653148">)</span>&nbsp;<span class="builtintype" id="3653150">string</span>&nbsp;<span class="op" id="3653157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653160">sv</span>&nbsp;<span class="op" id="3653163">:=</span>&nbsp;<span class="ident" id="3653166">strings</span><span class="op" id="3653173">.</span><span class="ident" id="3653174">SplitN</span><span class="op" id="3653180">(</span><span class="ident" id="3653181">v</span><span class="op" id="3653182">,</span>&nbsp;<span class="string" id="3653184">&#34;&#39;&#34;</span><span class="op" id="3653187">,</span>&nbsp;<span class="num" id="3653189">3</span><span class="op" id="3653190">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653193">if</span>&nbsp;<span class="builtinfunc" id="3653196">len</span><span class="op" id="3653199">(</span><span class="ident" id="3653200">sv</span><span class="op" id="3653202">)</span>&nbsp;<span class="op" id="3653204">!=</span>&nbsp;<span class="num" id="3653207">3</span>&nbsp;<span class="op" id="3653209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653213">return</span>&nbsp;<span class="string" id="3653220">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3653227">//&nbsp;TODO:&nbsp;ignoring&nbsp;lang&nbsp;in&nbsp;sv[1]&nbsp;for&nbsp;now.&nbsp;If&nbsp;anybody&nbsp;needs&nbsp;it&nbsp;we&#39;ll</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3653295">//&nbsp;need&nbsp;to&nbsp;decide&nbsp;how&nbsp;to&nbsp;expose&nbsp;it&nbsp;in&nbsp;the&nbsp;API.&nbsp;But&nbsp;I&#39;m&nbsp;not&nbsp;sure</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3653360">//&nbsp;anybody&nbsp;uses&nbsp;it&nbsp;in&nbsp;practice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653393">charset</span>&nbsp;<span class="op" id="3653401">:=</span>&nbsp;<span class="ident" id="3653404">strings</span><span class="op" id="3653411">.</span><span class="ident" id="3653412">ToLower</span><span class="op" id="3653419">(</span><span class="ident" id="3653420">sv</span><span class="op" id="3653422">[</span><span class="num" id="3653423">0</span><span class="op" id="3653424">]</span><span class="op" id="3653425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653428">if</span>&nbsp;<span class="ident" id="3653431">charset</span>&nbsp;<span class="op" id="3653439">!=</span>&nbsp;<span class="string" id="3653442">&#34;us-ascii&#34;</span>&nbsp;<span class="op" id="3653453">&amp;&amp;</span>&nbsp;<span class="ident" id="3653456">charset</span>&nbsp;<span class="op" id="3653464">!=</span>&nbsp;<span class="string" id="3653467">&#34;utf-8&#34;</span>&nbsp;<span class="op" id="3653475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3653479">//&nbsp;TODO:&nbsp;unsupported&nbsp;encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653511">return</span>&nbsp;<span class="string" id="3653518">&#34;&#34;</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653525">encv</span><span class="op" id="3653529">,</span>&nbsp;<span class="ident" id="3653531">_</span>&nbsp;<span class="op" id="3653533">:=</span>&nbsp;<span class="ident" id="3653536">percentHexUnescape</span><span class="op" id="3653554">(</span><span class="ident" id="3653555">sv</span><span class="op" id="3653557">[</span><span class="num" id="3653558">2</span><span class="op" id="3653559">]</span><span class="op" id="3653560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653563">return</span>&nbsp;<span class="ident" id="3653570">encv</span><br>
<span class="lineno"></span><span class="op" id="3653575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="3653578">func</span>&nbsp;<span class="ident" id="3653583">isNotTokenChar</span><span class="op" id="3653597">(</span><span class="ident" id="3653598">r</span>&nbsp;<span class="builtintype" id="3653600">rune</span><span class="op" id="3653604">)</span>&nbsp;<span class="builtintype" id="3653606">bool</span>&nbsp;<span class="op" id="3653611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653614">return</span>&nbsp;<span class="op" id="3653621">!</span><span class="ident" id="3653622">isTokenChar</span><span class="op" id="3653633">(</span><span class="ident" id="3653634">r</span><span class="op" id="3653635">)</span><br>
<span class="lineno"></span><span class="op" id="3653637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3653640">//&nbsp;consumeToken&nbsp;consumes&nbsp;a&nbsp;token&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;provided</span><br>
<span class="lineno">220</span><span class="comment" id="3653704">//&nbsp;string,&nbsp;per&nbsp;RFC&nbsp;2045&nbsp;section&nbsp;5.1&nbsp;(referenced&nbsp;from&nbsp;2183),&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3653775">//&nbsp;the&nbsp;token&nbsp;consumed&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;Returns&nbsp;(&#34;&#34;,&nbsp;v)&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3653845">//&nbsp;failure&nbsp;to&nbsp;consume&nbsp;at&nbsp;least&nbsp;one&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3653891">func</span>&nbsp;<span class="ident" id="3653896">consumeToken</span><span class="op" id="3653908">(</span><span class="ident" id="3653909">v</span>&nbsp;<span class="builtintype" id="3653911">string</span><span class="op" id="3653917">)</span>&nbsp;<span class="op" id="3653919">(</span><span class="ident" id="3653920">token</span><span class="op" id="3653925">,</span>&nbsp;<span class="ident" id="3653927">rest</span>&nbsp;<span class="builtintype" id="3653932">string</span><span class="op" id="3653938">)</span>&nbsp;<span class="op" id="3653940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653943">notPos</span>&nbsp;<span class="op" id="3653950">:=</span>&nbsp;<span class="ident" id="3653953">strings</span><span class="op" id="3653960">.</span><span class="ident" id="3653961">IndexFunc</span><span class="op" id="3653970">(</span><span class="ident" id="3653971">v</span><span class="op" id="3653972">,</span>&nbsp;<span class="ident" id="3653974">isNotTokenChar</span><span class="op" id="3653988">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653991">if</span>&nbsp;<span class="ident" id="3653994">notPos</span>&nbsp;<span class="op" id="3654001">==</span>&nbsp;<span class="op" id="3654004">-</span><span class="num" id="3654005">1</span>&nbsp;<span class="op" id="3654007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654011">return</span>&nbsp;<span class="ident" id="3654018">v</span><span class="op" id="3654019">,</span>&nbsp;<span class="string" id="3654021">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654028">if</span>&nbsp;<span class="ident" id="3654031">notPos</span>&nbsp;<span class="op" id="3654038">==</span>&nbsp;<span class="num" id="3654041">0</span>&nbsp;<span class="op" id="3654043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654047">return</span>&nbsp;<span class="string" id="3654054">&#34;&#34;</span><span class="op" id="3654056">,</span>&nbsp;<span class="ident" id="3654058">v</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654064">return</span>&nbsp;<span class="ident" id="3654071">v</span><span class="op" id="3654072">[</span><span class="num" id="3654073">0</span><span class="op" id="3654074">:</span><span class="ident" id="3654075">notPos</span><span class="op" id="3654081">]</span><span class="op" id="3654082">,</span>&nbsp;<span class="ident" id="3654084">v</span><span class="op" id="3654085">[</span><span class="ident" id="3654086">notPos</span><span class="op" id="3654092">:</span><span class="op" id="3654093">]</span><br>
<span class="lineno"></span><span class="op" id="3654095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3654098">//&nbsp;consumeValue&nbsp;consumes&nbsp;a&nbsp;&#34;value&#34;&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;where&nbsp;a&nbsp;value&nbsp;is</span><br>
<span class="lineno">235</span><span class="comment" id="3654164">//&nbsp;either&nbsp;a&nbsp;&#39;token&#39;&nbsp;or&nbsp;a&nbsp;&#39;quoted-string&#39;.&nbsp;&nbsp;On&nbsp;success,&nbsp;consumeValue</span><br>
<span class="lineno"></span><span class="comment" id="3654232">//&nbsp;returns&nbsp;the&nbsp;value&nbsp;consumed&nbsp;(and&nbsp;de-quoted/escaped,&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3654291">//&nbsp;quoted-string)&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;On&nbsp;failure,&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3654358">//&nbsp;(&#34;&#34;,&nbsp;v).</span><br>
<span class="lineno"></span><span class="keyword" id="3654370">func</span>&nbsp;<span class="ident" id="3654375">consumeValue</span><span class="op" id="3654387">(</span><span class="ident" id="3654388">v</span>&nbsp;<span class="builtintype" id="3654390">string</span><span class="op" id="3654396">)</span>&nbsp;<span class="op" id="3654398">(</span><span class="ident" id="3654399">value</span><span class="op" id="3654404">,</span>&nbsp;<span class="ident" id="3654406">rest</span>&nbsp;<span class="builtintype" id="3654411">string</span><span class="op" id="3654417">)</span>&nbsp;<span class="op" id="3654419">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654422">if</span>&nbsp;<span class="op" id="3654425">!</span><span class="ident" id="3654426">strings</span><span class="op" id="3654433">.</span><span class="ident" id="3654434">HasPrefix</span><span class="op" id="3654443">(</span><span class="ident" id="3654444">v</span><span class="op" id="3654445">,</span>&nbsp;<span class="string" id="3654447">`&#34;`</span><span class="op" id="3654450">)</span>&nbsp;<span class="op" id="3654452">&amp;&amp;</span>&nbsp;<span class="op" id="3654455">!</span><span class="ident" id="3654456">strings</span><span class="op" id="3654463">.</span><span class="ident" id="3654464">HasPrefix</span><span class="op" id="3654473">(</span><span class="ident" id="3654474">v</span><span class="op" id="3654475">,</span>&nbsp;<span class="string" id="3654477">`&#39;`</span><span class="op" id="3654480">)</span>&nbsp;<span class="op" id="3654482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654486">return</span>&nbsp;<span class="ident" id="3654493">consumeToken</span><span class="op" id="3654505">(</span><span class="ident" id="3654506">v</span><span class="op" id="3654507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654514">leadQuote</span>&nbsp;<span class="op" id="3654524">:=</span>&nbsp;<span class="builtintype" id="3654527">rune</span><span class="op" id="3654531">(</span><span class="ident" id="3654532">v</span><span class="op" id="3654533">[</span><span class="num" id="3654534">0</span><span class="op" id="3654535">]</span><span class="op" id="3654536">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3654540">//&nbsp;parse&nbsp;a&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654566">rest</span>&nbsp;<span class="op" id="3654571">=</span>&nbsp;<span class="ident" id="3654573">v</span><span class="op" id="3654574">[</span><span class="num" id="3654575">1</span><span class="op" id="3654576">:</span><span class="op" id="3654577">]</span>&nbsp;<span class="comment" id="3654579">//&nbsp;consume&nbsp;the&nbsp;leading&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654609">buffer</span>&nbsp;<span class="op" id="3654616">:=</span>&nbsp;<span class="builtinfunc" id="3654619">new</span><span class="op" id="3654622">(</span><span class="ident" id="3654623">bytes</span><span class="op" id="3654628">.</span><span class="ident" id="3654629">Buffer</span><span class="op" id="3654635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654638">var</span>&nbsp;<span class="ident" id="3654642">idx</span>&nbsp;<span class="builtintype" id="3654646">int</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654651">var</span>&nbsp;<span class="ident" id="3654655">r</span>&nbsp;<span class="builtintype" id="3654657">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654663">var</span>&nbsp;<span class="ident" id="3654667">nextIsLiteral</span>&nbsp;<span class="builtintype" id="3654681">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654687">for</span>&nbsp;<span class="ident" id="3654691">idx</span><span class="op" id="3654694">,</span>&nbsp;<span class="ident" id="3654696">r</span>&nbsp;<span class="op" id="3654698">=</span>&nbsp;<span class="keyword" id="3654700">range</span>&nbsp;<span class="ident" id="3654706">rest</span>&nbsp;<span class="op" id="3654711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654715">switch</span>&nbsp;<span class="op" id="3654722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654726">case</span>&nbsp;<span class="ident" id="3654731">nextIsLiteral</span><span class="op" id="3654744">:</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654749">buffer</span><span class="op" id="3654755">.</span><span class="ident" id="3654756">WriteRune</span><span class="op" id="3654765">(</span><span class="ident" id="3654766">r</span><span class="op" id="3654767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654772">nextIsLiteral</span>&nbsp;<span class="op" id="3654786">=</span>&nbsp;<span class="builtintype" id="3654788">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654796">case</span>&nbsp;<span class="ident" id="3654801">r</span>&nbsp;<span class="op" id="3654803">==</span>&nbsp;<span class="ident" id="3654806">leadQuote</span><span class="op" id="3654815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654820">return</span>&nbsp;<span class="ident" id="3654827">buffer</span><span class="op" id="3654833">.</span><span class="ident" id="3654834">String</span><span class="op" id="3654840">(</span><span class="op" id="3654841">)</span><span class="op" id="3654842">,</span>&nbsp;<span class="ident" id="3654844">rest</span><span class="op" id="3654848">[</span><span class="ident" id="3654849">idx</span><span class="op" id="3654852">+</span><span class="num" id="3654853">1</span><span class="op" id="3654854">:</span><span class="op" id="3654855">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654859">case</span>&nbsp;<span class="ident" id="3654864">r</span>&nbsp;<span class="op" id="3654866">==</span>&nbsp;<span class="string" id="3654869">&#39;\\&#39;</span><span class="op" id="3654873">:</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654878">nextIsLiteral</span>&nbsp;<span class="op" id="3654892">=</span>&nbsp;<span class="builtintype" id="3654894">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654901">case</span>&nbsp;<span class="ident" id="3654906">r</span>&nbsp;<span class="op" id="3654908">!=</span>&nbsp;<span class="string" id="3654911">&#39;\r&#39;</span>&nbsp;<span class="op" id="3654916">&amp;&amp;</span>&nbsp;<span class="ident" id="3654919">r</span>&nbsp;<span class="op" id="3654921">!=</span>&nbsp;<span class="string" id="3654924">&#39;\n&#39;</span><span class="op" id="3654928">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654933">buffer</span><span class="op" id="3654939">.</span><span class="ident" id="3654940">WriteRune</span><span class="op" id="3654949">(</span><span class="ident" id="3654950">r</span><span class="op" id="3654951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654955">default</span><span class="op" id="3654962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654967">return</span>&nbsp;<span class="string" id="3654974">&#34;&#34;</span><span class="op" id="3654976">,</span>&nbsp;<span class="ident" id="3654978">v</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654988">return</span>&nbsp;<span class="string" id="3654995">&#34;&#34;</span><span class="op" id="3654997">,</span>&nbsp;<span class="ident" id="3654999">v</span><br>
<span class="lineno"></span><span class="op" id="3655001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="keyword" id="3655004">func</span>&nbsp;<span class="ident" id="3655009">consumeMediaParam</span><span class="op" id="3655026">(</span><span class="ident" id="3655027">v</span>&nbsp;<span class="builtintype" id="3655029">string</span><span class="op" id="3655035">)</span>&nbsp;<span class="op" id="3655037">(</span><span class="ident" id="3655038">param</span><span class="op" id="3655043">,</span>&nbsp;<span class="ident" id="3655045">value</span><span class="op" id="3655050">,</span>&nbsp;<span class="ident" id="3655052">rest</span>&nbsp;<span class="builtintype" id="3655057">string</span><span class="op" id="3655063">)</span>&nbsp;<span class="op" id="3655065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655068">rest</span>&nbsp;<span class="op" id="3655073">=</span>&nbsp;<span class="ident" id="3655075">strings</span><span class="op" id="3655082">.</span><span class="ident" id="3655083">TrimLeftFunc</span><span class="op" id="3655095">(</span><span class="ident" id="3655096">v</span><span class="op" id="3655097">,</span>&nbsp;<span class="ident" id="3655099">unicode</span><span class="op" id="3655106">.</span><span class="ident" id="3655107">IsSpace</span><span class="op" id="3655114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655117">if</span>&nbsp;<span class="op" id="3655120">!</span><span class="ident" id="3655121">strings</span><span class="op" id="3655128">.</span><span class="ident" id="3655129">HasPrefix</span><span class="op" id="3655138">(</span><span class="ident" id="3655139">rest</span><span class="op" id="3655143">,</span>&nbsp;<span class="string" id="3655145">&#34;;&#34;</span><span class="op" id="3655148">)</span>&nbsp;<span class="op" id="3655150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655154">return</span>&nbsp;<span class="string" id="3655161">&#34;&#34;</span><span class="op" id="3655163">,</span>&nbsp;<span class="string" id="3655165">&#34;&#34;</span><span class="op" id="3655167">,</span>&nbsp;<span class="ident" id="3655169">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655172">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655176">rest</span>&nbsp;<span class="op" id="3655181">=</span>&nbsp;<span class="ident" id="3655183">rest</span><span class="op" id="3655187">[</span><span class="num" id="3655188">1</span><span class="op" id="3655189">:</span><span class="op" id="3655190">]</span>&nbsp;<span class="comment" id="3655192">//&nbsp;consume&nbsp;semicolon</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655214">rest</span>&nbsp;<span class="op" id="3655219">=</span>&nbsp;<span class="ident" id="3655221">strings</span><span class="op" id="3655228">.</span><span class="ident" id="3655229">TrimLeftFunc</span><span class="op" id="3655241">(</span><span class="ident" id="3655242">rest</span><span class="op" id="3655246">,</span>&nbsp;<span class="ident" id="3655248">unicode</span><span class="op" id="3655255">.</span><span class="ident" id="3655256">IsSpace</span><span class="op" id="3655263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655266">param</span><span class="op" id="3655271">,</span>&nbsp;<span class="ident" id="3655273">rest</span>&nbsp;<span class="op" id="3655278">=</span>&nbsp;<span class="ident" id="3655280">consumeToken</span><span class="op" id="3655292">(</span><span class="ident" id="3655293">rest</span><span class="op" id="3655297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655300">param</span>&nbsp;<span class="op" id="3655306">=</span>&nbsp;<span class="ident" id="3655308">strings</span><span class="op" id="3655315">.</span><span class="ident" id="3655316">ToLower</span><span class="op" id="3655323">(</span><span class="ident" id="3655324">param</span><span class="op" id="3655329">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655332">if</span>&nbsp;<span class="ident" id="3655335">param</span>&nbsp;<span class="op" id="3655341">==</span>&nbsp;<span class="string" id="3655344">&#34;&#34;</span>&nbsp;<span class="op" id="3655347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655351">return</span>&nbsp;<span class="string" id="3655358">&#34;&#34;</span><span class="op" id="3655360">,</span>&nbsp;<span class="string" id="3655362">&#34;&#34;</span><span class="op" id="3655364">,</span>&nbsp;<span class="ident" id="3655366">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655373">rest</span>&nbsp;<span class="op" id="3655378">=</span>&nbsp;<span class="ident" id="3655380">strings</span><span class="op" id="3655387">.</span><span class="ident" id="3655388">TrimLeftFunc</span><span class="op" id="3655400">(</span><span class="ident" id="3655401">rest</span><span class="op" id="3655405">,</span>&nbsp;<span class="ident" id="3655407">unicode</span><span class="op" id="3655414">.</span><span class="ident" id="3655415">IsSpace</span><span class="op" id="3655422">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655425">if</span>&nbsp;<span class="op" id="3655428">!</span><span class="ident" id="3655429">strings</span><span class="op" id="3655436">.</span><span class="ident" id="3655437">HasPrefix</span><span class="op" id="3655446">(</span><span class="ident" id="3655447">rest</span><span class="op" id="3655451">,</span>&nbsp;<span class="string" id="3655453">&#34;=&#34;</span><span class="op" id="3655456">)</span>&nbsp;<span class="op" id="3655458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655462">return</span>&nbsp;<span class="string" id="3655469">&#34;&#34;</span><span class="op" id="3655471">,</span>&nbsp;<span class="string" id="3655473">&#34;&#34;</span><span class="op" id="3655475">,</span>&nbsp;<span class="ident" id="3655477">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655483">rest</span>&nbsp;<span class="op" id="3655488">=</span>&nbsp;<span class="ident" id="3655490">rest</span><span class="op" id="3655494">[</span><span class="num" id="3655495">1</span><span class="op" id="3655496">:</span><span class="op" id="3655497">]</span>&nbsp;<span class="comment" id="3655499">//&nbsp;consume&nbsp;equals&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655523">rest</span>&nbsp;<span class="op" id="3655528">=</span>&nbsp;<span class="ident" id="3655530">strings</span><span class="op" id="3655537">.</span><span class="ident" id="3655538">TrimLeftFunc</span><span class="op" id="3655550">(</span><span class="ident" id="3655551">rest</span><span class="op" id="3655555">,</span>&nbsp;<span class="ident" id="3655557">unicode</span><span class="op" id="3655564">.</span><span class="ident" id="3655565">IsSpace</span><span class="op" id="3655572">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655575">value</span><span class="op" id="3655580">,</span>&nbsp;<span class="ident" id="3655582">rest</span>&nbsp;<span class="op" id="3655587">=</span>&nbsp;<span class="ident" id="3655589">consumeValue</span><span class="op" id="3655601">(</span><span class="ident" id="3655602">rest</span><span class="op" id="3655606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655609">if</span>&nbsp;<span class="ident" id="3655612">value</span>&nbsp;<span class="op" id="3655618">==</span>&nbsp;<span class="string" id="3655621">&#34;&#34;</span>&nbsp;<span class="op" id="3655624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655628">return</span>&nbsp;<span class="string" id="3655635">&#34;&#34;</span><span class="op" id="3655637">,</span>&nbsp;<span class="string" id="3655639">&#34;&#34;</span><span class="op" id="3655641">,</span>&nbsp;<span class="ident" id="3655643">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655649">return</span>&nbsp;<span class="ident" id="3655656">param</span><span class="op" id="3655661">,</span>&nbsp;<span class="ident" id="3655663">value</span><span class="op" id="3655668">,</span>&nbsp;<span class="ident" id="3655670">rest</span><br>
<span class="lineno">295</span><span class="op" id="3655675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3655678">func</span>&nbsp;<span class="ident" id="3655683">percentHexUnescape</span><span class="op" id="3655701">(</span><span class="ident" id="3655702">s</span>&nbsp;<span class="builtintype" id="3655704">string</span><span class="op" id="3655710">)</span>&nbsp;<span class="op" id="3655712">(</span><span class="builtintype" id="3655713">string</span><span class="op" id="3655719">,</span>&nbsp;<span class="builtintype" id="3655721">error</span><span class="op" id="3655726">)</span>&nbsp;<span class="op" id="3655728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3655731">//&nbsp;Count&nbsp;%,&nbsp;check&nbsp;that&nbsp;they&#39;re&nbsp;well-formed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655776">percents</span>&nbsp;<span class="op" id="3655785">:=</span>&nbsp;<span class="num" id="3655788">0</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655791">for</span>&nbsp;<span class="ident" id="3655795">i</span>&nbsp;<span class="op" id="3655797">:=</span>&nbsp;<span class="num" id="3655800">0</span><span class="op" id="3655801">;</span>&nbsp;<span class="ident" id="3655803">i</span>&nbsp;<span class="op" id="3655805">&lt;</span>&nbsp;<span class="builtinfunc" id="3655807">len</span><span class="op" id="3655810">(</span><span class="ident" id="3655811">s</span><span class="op" id="3655812">)</span><span class="op" id="3655813">;</span>&nbsp;<span class="op" id="3655815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655819">if</span>&nbsp;<span class="ident" id="3655822">s</span><span class="op" id="3655823">[</span><span class="ident" id="3655824">i</span><span class="op" id="3655825">]</span>&nbsp;<span class="op" id="3655827">!=</span>&nbsp;<span class="string" id="3655830">&#39;%&#39;</span>&nbsp;<span class="op" id="3655834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655839">i</span><span class="op" id="3655840">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655846">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655857">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655861">percents</span><span class="op" id="3655869">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655874">if</span>&nbsp;<span class="ident" id="3655877">i</span><span class="op" id="3655878">+</span><span class="num" id="3655879">2</span>&nbsp;<span class="op" id="3655881">&gt;=</span>&nbsp;<span class="builtinfunc" id="3655884">len</span><span class="op" id="3655887">(</span><span class="ident" id="3655888">s</span><span class="op" id="3655889">)</span>&nbsp;<span class="op" id="3655891">||</span>&nbsp;<span class="op" id="3655894">!</span><span class="ident" id="3655895">ishex</span><span class="op" id="3655900">(</span><span class="ident" id="3655901">s</span><span class="op" id="3655902">[</span><span class="ident" id="3655903">i</span><span class="op" id="3655904">+</span><span class="num" id="3655905">1</span><span class="op" id="3655906">]</span><span class="op" id="3655907">)</span>&nbsp;<span class="op" id="3655909">||</span>&nbsp;<span class="op" id="3655912">!</span><span class="ident" id="3655913">ishex</span><span class="op" id="3655918">(</span><span class="ident" id="3655919">s</span><span class="op" id="3655920">[</span><span class="ident" id="3655921">i</span><span class="op" id="3655922">+</span><span class="num" id="3655923">2</span><span class="op" id="3655924">]</span><span class="op" id="3655925">)</span>&nbsp;<span class="op" id="3655927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655932">s</span>&nbsp;<span class="op" id="3655934">=</span>&nbsp;<span class="ident" id="3655936">s</span><span class="op" id="3655937">[</span><span class="ident" id="3655938">i</span><span class="op" id="3655939">:</span><span class="op" id="3655940">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655945">if</span>&nbsp;<span class="builtinfunc" id="3655948">len</span><span class="op" id="3655951">(</span><span class="ident" id="3655952">s</span><span class="op" id="3655953">)</span>&nbsp;<span class="op" id="3655955">&gt;</span>&nbsp;<span class="num" id="3655957">3</span>&nbsp;<span class="op" id="3655959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655965">s</span>&nbsp;<span class="op" id="3655967">=</span>&nbsp;<span class="ident" id="3655969">s</span><span class="op" id="3655970">[</span><span class="num" id="3655971">0</span><span class="op" id="3655972">:</span><span class="num" id="3655973">3</span><span class="op" id="3655974">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655984">return</span>&nbsp;<span class="string" id="3655991">&#34;&#34;</span><span class="op" id="3655993">,</span>&nbsp;<span class="ident" id="3655995">fmt</span><span class="op" id="3655998">.</span><span class="ident" id="3655999">Errorf</span><span class="op" id="3656005">(</span><span class="string" id="3656006">&#34;mime:&nbsp;bogus&nbsp;characters&nbsp;after&nbsp;%%:&nbsp;%q&#34;</span><span class="op" id="3656043">,</span>&nbsp;<span class="ident" id="3656045">s</span><span class="op" id="3656046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3656050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656054">i</span>&nbsp;<span class="op" id="3656056">+=</span>&nbsp;<span class="num" id="3656059">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3656062">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656065">if</span>&nbsp;<span class="ident" id="3656068">percents</span>&nbsp;<span class="op" id="3656077">==</span>&nbsp;<span class="num" id="3656080">0</span>&nbsp;<span class="op" id="3656082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656086">return</span>&nbsp;<span class="ident" id="3656093">s</span><span class="op" id="3656094">,</span>&nbsp;<span class="ident" id="3656096">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3656101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656105">t</span>&nbsp;<span class="op" id="3656107">:=</span>&nbsp;<span class="builtinfunc" id="3656110">make</span><span class="op" id="3656114">(</span><span class="op" id="3656115">[</span><span class="op" id="3656116">]</span><span class="builtintype" id="3656117">byte</span><span class="op" id="3656121">,</span>&nbsp;<span class="builtinfunc" id="3656123">len</span><span class="op" id="3656126">(</span><span class="ident" id="3656127">s</span><span class="op" id="3656128">)</span><span class="op" id="3656129">-</span><span class="num" id="3656130">2</span><span class="op" id="3656131">*</span><span class="ident" id="3656132">percents</span><span class="op" id="3656140">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656143">j</span>&nbsp;<span class="op" id="3656145">:=</span>&nbsp;<span class="num" id="3656148">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656151">for</span>&nbsp;<span class="ident" id="3656155">i</span>&nbsp;<span class="op" id="3656157">:=</span>&nbsp;<span class="num" id="3656160">0</span><span class="op" id="3656161">;</span>&nbsp;<span class="ident" id="3656163">i</span>&nbsp;<span class="op" id="3656165">&lt;</span>&nbsp;<span class="builtinfunc" id="3656167">len</span><span class="op" id="3656170">(</span><span class="ident" id="3656171">s</span><span class="op" id="3656172">)</span><span class="op" id="3656173">;</span>&nbsp;<span class="op" id="3656175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656179">switch</span>&nbsp;<span class="ident" id="3656186">s</span><span class="op" id="3656187">[</span><span class="ident" id="3656188">i</span><span class="op" id="3656189">]</span>&nbsp;<span class="op" id="3656191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656195">case</span>&nbsp;<span class="string" id="3656200">&#39;%&#39;</span><span class="op" id="3656203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656208">t</span><span class="op" id="3656209">[</span><span class="ident" id="3656210">j</span><span class="op" id="3656211">]</span>&nbsp;<span class="op" id="3656213">=</span>&nbsp;<span class="ident" id="3656215">unhex</span><span class="op" id="3656220">(</span><span class="ident" id="3656221">s</span><span class="op" id="3656222">[</span><span class="ident" id="3656223">i</span><span class="op" id="3656224">+</span><span class="num" id="3656225">1</span><span class="op" id="3656226">]</span><span class="op" id="3656227">)</span><span class="op" id="3656228">&lt;&lt;</span><span class="num" id="3656230">4</span>&nbsp;<span class="op" id="3656232">|</span>&nbsp;<span class="ident" id="3656234">unhex</span><span class="op" id="3656239">(</span><span class="ident" id="3656240">s</span><span class="op" id="3656241">[</span><span class="ident" id="3656242">i</span><span class="op" id="3656243">+</span><span class="num" id="3656244">2</span><span class="op" id="3656245">]</span><span class="op" id="3656246">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656251">j</span><span class="op" id="3656252">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656258">i</span>&nbsp;<span class="op" id="3656260">+=</span>&nbsp;<span class="num" id="3656263">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656267">default</span><span class="op" id="3656274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656279">t</span><span class="op" id="3656280">[</span><span class="ident" id="3656281">j</span><span class="op" id="3656282">]</span>&nbsp;<span class="op" id="3656284">=</span>&nbsp;<span class="ident" id="3656286">s</span><span class="op" id="3656287">[</span><span class="ident" id="3656288">i</span><span class="op" id="3656289">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656294">j</span><span class="op" id="3656295">++</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656301">i</span><span class="op" id="3656302">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3656307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3656310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656313">return</span>&nbsp;<span class="builtintype" id="3656320">string</span><span class="op" id="3656326">(</span><span class="ident" id="3656327">t</span><span class="op" id="3656328">)</span><span class="op" id="3656329">,</span>&nbsp;<span class="ident" id="3656331">nil</span><br>
<span class="lineno"></span><span class="op" id="3656335">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="keyword" id="3656338">func</span>&nbsp;<span class="ident" id="3656343">ishex</span><span class="op" id="3656348">(</span><span class="ident" id="3656349">c</span>&nbsp;<span class="builtintype" id="3656351">byte</span><span class="op" id="3656355">)</span>&nbsp;<span class="builtintype" id="3656357">bool</span>&nbsp;<span class="op" id="3656362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656365">switch</span>&nbsp;<span class="op" id="3656372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656375">case</span>&nbsp;<span class="string" id="3656380">&#39;0&#39;</span>&nbsp;<span class="op" id="3656384">&lt;=</span>&nbsp;<span class="ident" id="3656387">c</span>&nbsp;<span class="op" id="3656389">&amp;&amp;</span>&nbsp;<span class="ident" id="3656392">c</span>&nbsp;<span class="op" id="3656394">&lt;=</span>&nbsp;<span class="string" id="3656397">&#39;9&#39;</span><span class="op" id="3656400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656404">return</span>&nbsp;<span class="builtintype" id="3656411">true</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656417">case</span>&nbsp;<span class="string" id="3656422">&#39;a&#39;</span>&nbsp;<span class="op" id="3656426">&lt;=</span>&nbsp;<span class="ident" id="3656429">c</span>&nbsp;<span class="op" id="3656431">&amp;&amp;</span>&nbsp;<span class="ident" id="3656434">c</span>&nbsp;<span class="op" id="3656436">&lt;=</span>&nbsp;<span class="string" id="3656439">&#39;f&#39;</span><span class="op" id="3656442">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656446">return</span>&nbsp;<span class="builtintype" id="3656453">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656459">case</span>&nbsp;<span class="string" id="3656464">&#39;A&#39;</span>&nbsp;<span class="op" id="3656468">&lt;=</span>&nbsp;<span class="ident" id="3656471">c</span>&nbsp;<span class="op" id="3656473">&amp;&amp;</span>&nbsp;<span class="ident" id="3656476">c</span>&nbsp;<span class="op" id="3656478">&lt;=</span>&nbsp;<span class="string" id="3656481">&#39;F&#39;</span><span class="op" id="3656484">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656488">return</span>&nbsp;<span class="builtintype" id="3656495">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3656501">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656504">return</span>&nbsp;<span class="builtintype" id="3656511">false</span><br>
<span class="lineno"></span><span class="op" id="3656517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3656520">func</span>&nbsp;<span class="ident" id="3656525">unhex</span><span class="op" id="3656530">(</span><span class="ident" id="3656531">c</span>&nbsp;<span class="builtintype" id="3656533">byte</span><span class="op" id="3656537">)</span>&nbsp;<span class="builtintype" id="3656539">byte</span>&nbsp;<span class="op" id="3656544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656547">switch</span>&nbsp;<span class="op" id="3656554">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656557">case</span>&nbsp;<span class="string" id="3656562">&#39;0&#39;</span>&nbsp;<span class="op" id="3656566">&lt;=</span>&nbsp;<span class="ident" id="3656569">c</span>&nbsp;<span class="op" id="3656571">&amp;&amp;</span>&nbsp;<span class="ident" id="3656574">c</span>&nbsp;<span class="op" id="3656576">&lt;=</span>&nbsp;<span class="string" id="3656579">&#39;9&#39;</span><span class="op" id="3656582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656586">return</span>&nbsp;<span class="ident" id="3656593">c</span>&nbsp;<span class="op" id="3656595">-</span>&nbsp;<span class="string" id="3656597">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656602">case</span>&nbsp;<span class="string" id="3656607">&#39;a&#39;</span>&nbsp;<span class="op" id="3656611">&lt;=</span>&nbsp;<span class="ident" id="3656614">c</span>&nbsp;<span class="op" id="3656616">&amp;&amp;</span>&nbsp;<span class="ident" id="3656619">c</span>&nbsp;<span class="op" id="3656621">&lt;=</span>&nbsp;<span class="string" id="3656624">&#39;f&#39;</span><span class="op" id="3656627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656631">return</span>&nbsp;<span class="ident" id="3656638">c</span>&nbsp;<span class="op" id="3656640">-</span>&nbsp;<span class="string" id="3656642">&#39;a&#39;</span>&nbsp;<span class="op" id="3656646">+</span>&nbsp;<span class="num" id="3656648">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656652">case</span>&nbsp;<span class="string" id="3656657">&#39;A&#39;</span>&nbsp;<span class="op" id="3656661">&lt;=</span>&nbsp;<span class="ident" id="3656664">c</span>&nbsp;<span class="op" id="3656666">&amp;&amp;</span>&nbsp;<span class="ident" id="3656669">c</span>&nbsp;<span class="op" id="3656671">&lt;=</span>&nbsp;<span class="string" id="3656674">&#39;F&#39;</span><span class="op" id="3656677">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656681">return</span>&nbsp;<span class="ident" id="3656688">c</span>&nbsp;<span class="op" id="3656690">-</span>&nbsp;<span class="string" id="3656692">&#39;A&#39;</span>&nbsp;<span class="op" id="3656696">+</span>&nbsp;<span class="num" id="3656698">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3656702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656705">return</span>&nbsp;<span class="num" id="3656712">0</span><br>
<span class="lineno"></span><span class="op" id="3656714">}</span>
</div>
</body>
</html>
