<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2784040">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2784095">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2784149">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2784200">//&nbsp;Parse&nbsp;&#34;zoneinfo&#34;&nbsp;time&nbsp;zone&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2784236">//&nbsp;This&nbsp;is&nbsp;a&nbsp;fairly&nbsp;standard&nbsp;file&nbsp;format&nbsp;used&nbsp;on&nbsp;OS&nbsp;X,&nbsp;Linux,&nbsp;BSD,&nbsp;Sun,&nbsp;and&nbsp;others.</span><br>
<span class="lineno"></span><span class="comment" id="2784320">//&nbsp;See&nbsp;tzfile(5),&nbsp;http://en.wikipedia.org/wiki/Zoneinfo,</span><br>
<span class="lineno"></span><span class="comment" id="2784377">//&nbsp;and&nbsp;ftp://munnari.oz.au/pub/oldtz/</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2784416">package</span>&nbsp;<span class="ident" id="2784424">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2784430">import</span>&nbsp;<span class="string" id="2784437">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2784447">//&nbsp;Simple&nbsp;I/O&nbsp;interface&nbsp;to&nbsp;binary&nbsp;blob&nbsp;of&nbsp;data.</span><br>
<span class="lineno">15</span><span class="keyword" id="2784495">type</span>&nbsp;<span class="ident" id="2784500">data</span>&nbsp;<span class="keyword" id="2784505">struct</span>&nbsp;<span class="op" id="2784512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784515">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2784521">[</span><span class="op" id="2784522">]</span><span class="builtintype" id="2784523">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2784529">error</span>&nbsp;<span class="builtintype" id="2784535">bool</span><br>
<span class="lineno"></span><span class="op" id="2784540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2784543">func</span>&nbsp;<span class="op" id="2784548">(</span><span class="ident" id="2784549">d</span>&nbsp;<span class="op" id="2784551">*</span><span class="ident" id="2784552">data</span><span class="op" id="2784556">)</span>&nbsp;<span class="ident" id="2784558">read</span><span class="op" id="2784562">(</span><span class="ident" id="2784563">n</span>&nbsp;<span class="builtintype" id="2784565">int</span><span class="op" id="2784568">)</span>&nbsp;<span class="op" id="2784570">[</span><span class="op" id="2784571">]</span><span class="builtintype" id="2784572">byte</span>&nbsp;<span class="op" id="2784577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784580">if</span>&nbsp;<span class="builtinfunc" id="2784583">len</span><span class="op" id="2784586">(</span><span class="ident" id="2784587">d</span><span class="op" id="2784588">.</span><span class="ident" id="2784589">p</span><span class="op" id="2784590">)</span>&nbsp;<span class="op" id="2784592">&lt;</span>&nbsp;<span class="ident" id="2784594">n</span>&nbsp;<span class="op" id="2784596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784600">d</span><span class="op" id="2784601">.</span><span class="ident" id="2784602">p</span>&nbsp;<span class="op" id="2784604">=</span>&nbsp;<span class="ident" id="2784606">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784612">d</span><span class="op" id="2784613">.</span><span class="builtintype" id="2784614">error</span>&nbsp;<span class="op" id="2784620">=</span>&nbsp;<span class="builtintype" id="2784622">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784629">return</span>&nbsp;<span class="ident" id="2784636">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2784641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784644">p</span>&nbsp;<span class="op" id="2784646">:=</span>&nbsp;<span class="ident" id="2784649">d</span><span class="op" id="2784650">.</span><span class="ident" id="2784651">p</span><span class="op" id="2784652">[</span><span class="num" id="2784653">0</span><span class="op" id="2784654">:</span><span class="ident" id="2784655">n</span><span class="op" id="2784656">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784659">d</span><span class="op" id="2784660">.</span><span class="ident" id="2784661">p</span>&nbsp;<span class="op" id="2784663">=</span>&nbsp;<span class="ident" id="2784665">d</span><span class="op" id="2784666">.</span><span class="ident" id="2784667">p</span><span class="op" id="2784668">[</span><span class="ident" id="2784669">n</span><span class="op" id="2784670">:</span><span class="op" id="2784671">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784674">return</span>&nbsp;<span class="ident" id="2784681">p</span><br>
<span class="lineno"></span><span class="op" id="2784683">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2784686">func</span>&nbsp;<span class="op" id="2784691">(</span><span class="ident" id="2784692">d</span>&nbsp;<span class="op" id="2784694">*</span><span class="ident" id="2784695">data</span><span class="op" id="2784699">)</span>&nbsp;<span class="ident" id="2784701">big4</span><span class="op" id="2784705">(</span><span class="op" id="2784706">)</span>&nbsp;<span class="op" id="2784708">(</span><span class="ident" id="2784709">n</span>&nbsp;<span class="builtintype" id="2784711">uint32</span><span class="op" id="2784717">,</span>&nbsp;<span class="ident" id="2784719">ok</span>&nbsp;<span class="builtintype" id="2784722">bool</span><span class="op" id="2784726">)</span>&nbsp;<span class="op" id="2784728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784731">p</span>&nbsp;<span class="op" id="2784733">:=</span>&nbsp;<span class="ident" id="2784736">d</span><span class="op" id="2784737">.</span><span class="ident" id="2784738">read</span><span class="op" id="2784742">(</span><span class="num" id="2784743">4</span><span class="op" id="2784744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784747">if</span>&nbsp;<span class="builtinfunc" id="2784750">len</span><span class="op" id="2784753">(</span><span class="ident" id="2784754">p</span><span class="op" id="2784755">)</span>&nbsp;<span class="op" id="2784757">&lt;</span>&nbsp;<span class="num" id="2784759">4</span>&nbsp;<span class="op" id="2784761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784765">d</span><span class="op" id="2784766">.</span><span class="builtintype" id="2784767">error</span>&nbsp;<span class="op" id="2784773">=</span>&nbsp;<span class="builtintype" id="2784775">true</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784782">return</span>&nbsp;<span class="num" id="2784789">0</span><span class="op" id="2784790">,</span>&nbsp;<span class="builtintype" id="2784792">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2784799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784802">return</span>&nbsp;<span class="builtintype" id="2784809">uint32</span><span class="op" id="2784815">(</span><span class="ident" id="2784816">p</span><span class="op" id="2784817">[</span><span class="num" id="2784818">0</span><span class="op" id="2784819">]</span><span class="op" id="2784820">)</span><span class="op" id="2784821">&lt;&lt;</span><span class="num" id="2784823">24</span>&nbsp;<span class="op" id="2784826">|</span>&nbsp;<span class="builtintype" id="2784828">uint32</span><span class="op" id="2784834">(</span><span class="ident" id="2784835">p</span><span class="op" id="2784836">[</span><span class="num" id="2784837">1</span><span class="op" id="2784838">]</span><span class="op" id="2784839">)</span><span class="op" id="2784840">&lt;&lt;</span><span class="num" id="2784842">16</span>&nbsp;<span class="op" id="2784845">|</span>&nbsp;<span class="builtintype" id="2784847">uint32</span><span class="op" id="2784853">(</span><span class="ident" id="2784854">p</span><span class="op" id="2784855">[</span><span class="num" id="2784856">2</span><span class="op" id="2784857">]</span><span class="op" id="2784858">)</span><span class="op" id="2784859">&lt;&lt;</span><span class="num" id="2784861">8</span>&nbsp;<span class="op" id="2784863">|</span>&nbsp;<span class="builtintype" id="2784865">uint32</span><span class="op" id="2784871">(</span><span class="ident" id="2784872">p</span><span class="op" id="2784873">[</span><span class="num" id="2784874">3</span><span class="op" id="2784875">]</span><span class="op" id="2784876">)</span><span class="op" id="2784877">,</span>&nbsp;<span class="builtintype" id="2784879">true</span><br>
<span class="lineno"></span><span class="op" id="2784884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2784887">func</span>&nbsp;<span class="op" id="2784892">(</span><span class="ident" id="2784893">d</span>&nbsp;<span class="op" id="2784895">*</span><span class="ident" id="2784896">data</span><span class="op" id="2784900">)</span>&nbsp;<span class="builtintype" id="2784902">byte</span><span class="op" id="2784906">(</span><span class="op" id="2784907">)</span>&nbsp;<span class="op" id="2784909">(</span><span class="ident" id="2784910">n</span>&nbsp;<span class="builtintype" id="2784912">byte</span><span class="op" id="2784916">,</span>&nbsp;<span class="ident" id="2784918">ok</span>&nbsp;<span class="builtintype" id="2784921">bool</span><span class="op" id="2784925">)</span>&nbsp;<span class="op" id="2784927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784930">p</span>&nbsp;<span class="op" id="2784932">:=</span>&nbsp;<span class="ident" id="2784935">d</span><span class="op" id="2784936">.</span><span class="ident" id="2784937">read</span><span class="op" id="2784941">(</span><span class="num" id="2784942">1</span><span class="op" id="2784943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784946">if</span>&nbsp;<span class="builtinfunc" id="2784949">len</span><span class="op" id="2784952">(</span><span class="ident" id="2784953">p</span><span class="op" id="2784954">)</span>&nbsp;<span class="op" id="2784956">&lt;</span>&nbsp;<span class="num" id="2784958">1</span>&nbsp;<span class="op" id="2784960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784964">d</span><span class="op" id="2784965">.</span><span class="builtintype" id="2784966">error</span>&nbsp;<span class="op" id="2784972">=</span>&nbsp;<span class="builtintype" id="2784974">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784981">return</span>&nbsp;<span class="num" id="2784988">0</span><span class="op" id="2784989">,</span>&nbsp;<span class="builtintype" id="2784991">false</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2784998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785001">return</span>&nbsp;<span class="ident" id="2785008">p</span><span class="op" id="2785009">[</span><span class="num" id="2785010">0</span><span class="op" id="2785011">]</span><span class="op" id="2785012">,</span>&nbsp;<span class="builtintype" id="2785014">true</span><br>
<span class="lineno"></span><span class="op" id="2785019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2785022">//&nbsp;Make&nbsp;a&nbsp;string&nbsp;by&nbsp;stopping&nbsp;at&nbsp;the&nbsp;first&nbsp;NUL</span><br>
<span class="lineno">50</span><span class="keyword" id="2785068">func</span>&nbsp;<span class="ident" id="2785073">byteString</span><span class="op" id="2785083">(</span><span class="ident" id="2785084">p</span>&nbsp;<span class="op" id="2785086">[</span><span class="op" id="2785087">]</span><span class="builtintype" id="2785088">byte</span><span class="op" id="2785092">)</span>&nbsp;<span class="builtintype" id="2785094">string</span>&nbsp;<span class="op" id="2785101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785104">for</span>&nbsp;<span class="ident" id="2785108">i</span>&nbsp;<span class="op" id="2785110">:=</span>&nbsp;<span class="num" id="2785113">0</span><span class="op" id="2785114">;</span>&nbsp;<span class="ident" id="2785116">i</span>&nbsp;<span class="op" id="2785118">&lt;</span>&nbsp;<span class="builtinfunc" id="2785120">len</span><span class="op" id="2785123">(</span><span class="ident" id="2785124">p</span><span class="op" id="2785125">)</span><span class="op" id="2785126">;</span>&nbsp;<span class="ident" id="2785128">i</span><span class="op" id="2785129">++</span>&nbsp;<span class="op" id="2785132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785136">if</span>&nbsp;<span class="ident" id="2785139">p</span><span class="op" id="2785140">[</span><span class="ident" id="2785141">i</span><span class="op" id="2785142">]</span>&nbsp;<span class="op" id="2785144">==</span>&nbsp;<span class="num" id="2785147">0</span>&nbsp;<span class="op" id="2785149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785154">return</span>&nbsp;<span class="builtintype" id="2785161">string</span><span class="op" id="2785167">(</span><span class="ident" id="2785168">p</span><span class="op" id="2785169">[</span><span class="num" id="2785170">0</span><span class="op" id="2785171">:</span><span class="ident" id="2785172">i</span><span class="op" id="2785173">]</span><span class="op" id="2785174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2785178">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2785181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785184">return</span>&nbsp;<span class="builtintype" id="2785191">string</span><span class="op" id="2785197">(</span><span class="ident" id="2785198">p</span><span class="op" id="2785199">)</span><br>
<span class="lineno"></span><span class="op" id="2785201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785204">var</span>&nbsp;<span class="ident" id="2785208">badData</span>&nbsp;<span class="op" id="2785216">=</span>&nbsp;<span class="ident" id="2785218">errors</span><span class="op" id="2785224">.</span><span class="ident" id="2785225">New</span><span class="op" id="2785228">(</span><span class="string" id="2785229">&#34;malformed&nbsp;time&nbsp;zone&nbsp;information&#34;</span><span class="op" id="2785262">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2785265">func</span>&nbsp;<span class="ident" id="2785270">loadZoneData</span><span class="op" id="2785282">(</span><span class="ident" id="2785283">bytes</span>&nbsp;<span class="op" id="2785289">[</span><span class="op" id="2785290">]</span><span class="builtintype" id="2785291">byte</span><span class="op" id="2785295">)</span>&nbsp;<span class="op" id="2785297">(</span><span class="ident" id="2785298">l</span>&nbsp;<span class="op" id="2785300">*</span><span class="ident" id="2785301">Location</span><span class="op" id="2785309">,</span>&nbsp;<span class="ident" id="2785311">err</span>&nbsp;<span class="builtintype" id="2785315">error</span><span class="op" id="2785320">)</span>&nbsp;<span class="op" id="2785322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785325">d</span>&nbsp;<span class="op" id="2785327">:=</span>&nbsp;<span class="ident" id="2785330">data</span><span class="op" id="2785334">{</span><span class="ident" id="2785335">bytes</span><span class="op" id="2785340">,</span>&nbsp;<span class="builtintype" id="2785342">false</span><span class="op" id="2785347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2785351">//&nbsp;4-byte&nbsp;magic&nbsp;&#34;TZif&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785375">if</span>&nbsp;<span class="ident" id="2785378">magic</span>&nbsp;<span class="op" id="2785384">:=</span>&nbsp;<span class="ident" id="2785387">d</span><span class="op" id="2785388">.</span><span class="ident" id="2785389">read</span><span class="op" id="2785393">(</span><span class="num" id="2785394">4</span><span class="op" id="2785395">)</span><span class="op" id="2785396">;</span>&nbsp;<span class="builtintype" id="2785398">string</span><span class="op" id="2785404">(</span><span class="ident" id="2785405">magic</span><span class="op" id="2785410">)</span>&nbsp;<span class="op" id="2785412">!=</span>&nbsp;<span class="string" id="2785415">&#34;TZif&#34;</span>&nbsp;<span class="op" id="2785422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785426">return</span>&nbsp;<span class="ident" id="2785433">nil</span><span class="op" id="2785436">,</span>&nbsp;<span class="ident" id="2785438">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2785447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2785451">//&nbsp;1-byte&nbsp;version,&nbsp;then&nbsp;15&nbsp;bytes&nbsp;of&nbsp;padding</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785496">var</span>&nbsp;<span class="ident" id="2785500">p</span>&nbsp;<span class="op" id="2785502">[</span><span class="op" id="2785503">]</span><span class="builtintype" id="2785504">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785510">if</span>&nbsp;<span class="ident" id="2785513">p</span>&nbsp;<span class="op" id="2785515">=</span>&nbsp;<span class="ident" id="2785517">d</span><span class="op" id="2785518">.</span><span class="ident" id="2785519">read</span><span class="op" id="2785523">(</span><span class="num" id="2785524">16</span><span class="op" id="2785526">)</span><span class="op" id="2785527">;</span>&nbsp;<span class="builtinfunc" id="2785529">len</span><span class="op" id="2785532">(</span><span class="ident" id="2785533">p</span><span class="op" id="2785534">)</span>&nbsp;<span class="op" id="2785536">!=</span>&nbsp;<span class="num" id="2785539">16</span>&nbsp;<span class="op" id="2785542">||</span>&nbsp;<span class="ident" id="2785545">p</span><span class="op" id="2785546">[</span><span class="num" id="2785547">0</span><span class="op" id="2785548">]</span>&nbsp;<span class="op" id="2785550">!=</span>&nbsp;<span class="num" id="2785553">0</span>&nbsp;<span class="op" id="2785555">&amp;&amp;</span>&nbsp;<span class="ident" id="2785558">p</span><span class="op" id="2785559">[</span><span class="num" id="2785560">0</span><span class="op" id="2785561">]</span>&nbsp;<span class="op" id="2785563">!=</span>&nbsp;<span class="string" id="2785566">&#39;2&#39;</span>&nbsp;<span class="op" id="2785570">&amp;&amp;</span>&nbsp;<span class="ident" id="2785573">p</span><span class="op" id="2785574">[</span><span class="num" id="2785575">0</span><span class="op" id="2785576">]</span>&nbsp;<span class="op" id="2785578">!=</span>&nbsp;<span class="string" id="2785581">&#39;3&#39;</span>&nbsp;<span class="op" id="2785585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785589">return</span>&nbsp;<span class="ident" id="2785596">nil</span><span class="op" id="2785599">,</span>&nbsp;<span class="ident" id="2785601">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2785610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2785614">//&nbsp;six&nbsp;big-endian&nbsp;32-bit&nbsp;integers:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2785650">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;UTC/local&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2785685">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;standard/wall&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2785724">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;leap&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2785751">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;transition&nbsp;times</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2785782">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;local&nbsp;time&nbsp;zones</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2785813">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;characters&nbsp;of&nbsp;time&nbsp;zone&nbsp;abbrev&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785866">const</span>&nbsp;<span class="op" id="2785872">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785876">NUTCLocal</span>&nbsp;<span class="op" id="2785886">=</span>&nbsp;<span class="ident" id="2785888">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785895">NStdWall</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785906">NLeap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785914">NTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785922">NZone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785930">NChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2785937">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785940">var</span>&nbsp;<span class="ident" id="2785944">n</span>&nbsp;<span class="op" id="2785946">[</span><span class="num" id="2785947">6</span><span class="op" id="2785948">]</span><span class="builtintype" id="2785949">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785954">for</span>&nbsp;<span class="ident" id="2785958">i</span>&nbsp;<span class="op" id="2785960">:=</span>&nbsp;<span class="num" id="2785963">0</span><span class="op" id="2785964">;</span>&nbsp;<span class="ident" id="2785966">i</span>&nbsp;<span class="op" id="2785968">&lt;</span>&nbsp;<span class="num" id="2785970">6</span><span class="op" id="2785971">;</span>&nbsp;<span class="ident" id="2785973">i</span><span class="op" id="2785974">++</span>&nbsp;<span class="op" id="2785977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785981">nn</span><span class="op" id="2785983">,</span>&nbsp;<span class="ident" id="2785985">ok</span>&nbsp;<span class="op" id="2785988">:=</span>&nbsp;<span class="ident" id="2785991">d</span><span class="op" id="2785992">.</span><span class="ident" id="2785993">big4</span><span class="op" id="2785997">(</span><span class="op" id="2785998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2786002">if</span>&nbsp;<span class="op" id="2786005">!</span><span class="ident" id="2786006">ok</span>&nbsp;<span class="op" id="2786009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2786014">return</span>&nbsp;<span class="ident" id="2786021">nil</span><span class="op" id="2786024">,</span>&nbsp;<span class="ident" id="2786026">badData</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2786036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786040">n</span><span class="op" id="2786041">[</span><span class="ident" id="2786042">i</span><span class="op" id="2786043">]</span>&nbsp;<span class="op" id="2786045">=</span>&nbsp;<span class="builtintype" id="2786047">int</span><span class="op" id="2786050">(</span><span class="ident" id="2786051">nn</span><span class="op" id="2786053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2786056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786060">//&nbsp;Transition&nbsp;times.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786082">txtimes</span>&nbsp;<span class="op" id="2786090">:=</span>&nbsp;<span class="ident" id="2786093">data</span><span class="op" id="2786097">{</span><span class="ident" id="2786098">d</span><span class="op" id="2786099">.</span><span class="ident" id="2786100">read</span><span class="op" id="2786104">(</span><span class="ident" id="2786105">n</span><span class="op" id="2786106">[</span><span class="ident" id="2786107">NTime</span><span class="op" id="2786112">]</span>&nbsp;<span class="op" id="2786114">*</span>&nbsp;<span class="num" id="2786116">4</span><span class="op" id="2786117">)</span><span class="op" id="2786118">,</span>&nbsp;<span class="builtintype" id="2786120">false</span><span class="op" id="2786125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786129">//&nbsp;Time&nbsp;zone&nbsp;indices&nbsp;for&nbsp;transition&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786173">txzones</span>&nbsp;<span class="op" id="2786181">:=</span>&nbsp;<span class="ident" id="2786184">d</span><span class="op" id="2786185">.</span><span class="ident" id="2786186">read</span><span class="op" id="2786190">(</span><span class="ident" id="2786191">n</span><span class="op" id="2786192">[</span><span class="ident" id="2786193">NTime</span><span class="op" id="2786198">]</span><span class="op" id="2786199">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786203">//&nbsp;Zone&nbsp;info&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786228">zonedata</span>&nbsp;<span class="op" id="2786237">:=</span>&nbsp;<span class="ident" id="2786240">data</span><span class="op" id="2786244">{</span><span class="ident" id="2786245">d</span><span class="op" id="2786246">.</span><span class="ident" id="2786247">read</span><span class="op" id="2786251">(</span><span class="ident" id="2786252">n</span><span class="op" id="2786253">[</span><span class="ident" id="2786254">NZone</span><span class="op" id="2786259">]</span>&nbsp;<span class="op" id="2786261">*</span>&nbsp;<span class="num" id="2786263">6</span><span class="op" id="2786264">)</span><span class="op" id="2786265">,</span>&nbsp;<span class="builtintype" id="2786267">false</span><span class="op" id="2786272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786276">//&nbsp;Time&nbsp;zone&nbsp;abbreviations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786305">abbrev</span>&nbsp;<span class="op" id="2786312">:=</span>&nbsp;<span class="ident" id="2786315">d</span><span class="op" id="2786316">.</span><span class="ident" id="2786317">read</span><span class="op" id="2786321">(</span><span class="ident" id="2786322">n</span><span class="op" id="2786323">[</span><span class="ident" id="2786324">NChar</span><span class="op" id="2786329">]</span><span class="op" id="2786330">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786334">//&nbsp;Leap-second&nbsp;time&nbsp;pairs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786361">d</span><span class="op" id="2786362">.</span><span class="ident" id="2786363">read</span><span class="op" id="2786367">(</span><span class="ident" id="2786368">n</span><span class="op" id="2786369">[</span><span class="ident" id="2786370">NLeap</span><span class="op" id="2786375">]</span>&nbsp;<span class="op" id="2786377">*</span>&nbsp;<span class="num" id="2786379">8</span><span class="op" id="2786380">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786384">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786438">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;standard&nbsp;time&nbsp;or&nbsp;wall&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786487">isstd</span>&nbsp;<span class="op" id="2786493">:=</span>&nbsp;<span class="ident" id="2786496">d</span><span class="op" id="2786497">.</span><span class="ident" id="2786498">read</span><span class="op" id="2786502">(</span><span class="ident" id="2786503">n</span><span class="op" id="2786504">[</span><span class="ident" id="2786505">NStdWall</span><span class="op" id="2786513">]</span><span class="op" id="2786514">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786518">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786572">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;UTC&nbsp;or&nbsp;local&nbsp;time.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786612">isutc</span>&nbsp;<span class="op" id="2786618">:=</span>&nbsp;<span class="ident" id="2786621">d</span><span class="op" id="2786622">.</span><span class="ident" id="2786623">read</span><span class="op" id="2786627">(</span><span class="ident" id="2786628">n</span><span class="op" id="2786629">[</span><span class="ident" id="2786630">NUTCLocal</span><span class="op" id="2786639">]</span><span class="op" id="2786640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2786644">if</span>&nbsp;<span class="ident" id="2786647">d</span><span class="op" id="2786648">.</span><span class="builtintype" id="2786649">error</span>&nbsp;<span class="op" id="2786655">{</span>&nbsp;<span class="comment" id="2786657">//&nbsp;ran&nbsp;out&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2786678">return</span>&nbsp;<span class="ident" id="2786685">nil</span><span class="op" id="2786688">,</span>&nbsp;<span class="ident" id="2786690">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2786699">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786703">//&nbsp;If&nbsp;version&nbsp;==&nbsp;2&nbsp;or&nbsp;3,&nbsp;the&nbsp;entire&nbsp;file&nbsp;repeats,&nbsp;this&nbsp;time&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786770">//&nbsp;8-byte&nbsp;ints&nbsp;for&nbsp;txtimes&nbsp;and&nbsp;leap&nbsp;seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786816">//&nbsp;We&nbsp;won&#39;t&nbsp;need&nbsp;those&nbsp;until&nbsp;2106.</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786853">//&nbsp;Now&nbsp;we&nbsp;can&nbsp;build&nbsp;up&nbsp;a&nbsp;useful&nbsp;data&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786902">//&nbsp;First&nbsp;the&nbsp;zone&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786934">//&nbsp;&nbsp;&nbsp;&nbsputcoff[4]&nbsp;isdst[1]&nbsp;nameindex[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786970">zone</span>&nbsp;<span class="op" id="2786975">:=</span>&nbsp;<span class="builtinfunc" id="2786978">make</span><span class="op" id="2786982">(</span><span class="op" id="2786983">[</span><span class="op" id="2786984">]</span><span class="ident" id="2786985">zone</span><span class="op" id="2786989">,</span>&nbsp;<span class="ident" id="2786991">n</span><span class="op" id="2786992">[</span><span class="ident" id="2786993">NZone</span><span class="op" id="2786998">]</span><span class="op" id="2786999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787002">for</span>&nbsp;<span class="ident" id="2787006">i</span>&nbsp;<span class="op" id="2787008">:=</span>&nbsp;<span class="keyword" id="2787011">range</span>&nbsp;<span class="ident" id="2787017">zone</span>&nbsp;<span class="op" id="2787022">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787026">var</span>&nbsp;<span class="ident" id="2787030">ok</span>&nbsp;<span class="builtintype" id="2787033">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787040">var</span>&nbsp;<span class="ident" id="2787044">n</span>&nbsp;<span class="builtintype" id="2787046">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787055">if</span>&nbsp;<span class="ident" id="2787058">n</span><span class="op" id="2787059">,</span>&nbsp;<span class="ident" id="2787061">ok</span>&nbsp;<span class="op" id="2787064">=</span>&nbsp;<span class="ident" id="2787066">zonedata</span><span class="op" id="2787074">.</span><span class="ident" id="2787075">big4</span><span class="op" id="2787079">(</span><span class="op" id="2787080">)</span><span class="op" id="2787081">;</span>&nbsp;<span class="op" id="2787083">!</span><span class="ident" id="2787084">ok</span>&nbsp;<span class="op" id="2787087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787092">return</span>&nbsp;<span class="ident" id="2787099">nil</span><span class="op" id="2787102">,</span>&nbsp;<span class="ident" id="2787104">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787114">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787118">zone</span><span class="op" id="2787122">[</span><span class="ident" id="2787123">i</span><span class="op" id="2787124">]</span><span class="op" id="2787125">.</span><span class="ident" id="2787126">offset</span>&nbsp;<span class="op" id="2787133">=</span>&nbsp;<span class="builtintype" id="2787135">int</span><span class="op" id="2787138">(</span><span class="builtintype" id="2787139">int32</span><span class="op" id="2787144">(</span><span class="ident" id="2787145">n</span><span class="op" id="2787146">)</span><span class="op" id="2787147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787151">var</span>&nbsp;<span class="ident" id="2787155">b</span>&nbsp;<span class="builtintype" id="2787157">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787164">if</span>&nbsp;<span class="ident" id="2787167">b</span><span class="op" id="2787168">,</span>&nbsp;<span class="ident" id="2787170">ok</span>&nbsp;<span class="op" id="2787173">=</span>&nbsp;<span class="ident" id="2787175">zonedata</span><span class="op" id="2787183">.</span><span class="builtintype" id="2787184">byte</span><span class="op" id="2787188">(</span><span class="op" id="2787189">)</span><span class="op" id="2787190">;</span>&nbsp;<span class="op" id="2787192">!</span><span class="ident" id="2787193">ok</span>&nbsp;<span class="op" id="2787196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787201">return</span>&nbsp;<span class="ident" id="2787208">nil</span><span class="op" id="2787211">,</span>&nbsp;<span class="ident" id="2787213">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787223">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787227">zone</span><span class="op" id="2787231">[</span><span class="ident" id="2787232">i</span><span class="op" id="2787233">]</span><span class="op" id="2787234">.</span><span class="ident" id="2787235">isDST</span>&nbsp;<span class="op" id="2787241">=</span>&nbsp;<span class="ident" id="2787243">b</span>&nbsp;<span class="op" id="2787245">!=</span>&nbsp;<span class="num" id="2787248">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787252">if</span>&nbsp;<span class="ident" id="2787255">b</span><span class="op" id="2787256">,</span>&nbsp;<span class="ident" id="2787258">ok</span>&nbsp;<span class="op" id="2787261">=</span>&nbsp;<span class="ident" id="2787263">zonedata</span><span class="op" id="2787271">.</span><span class="builtintype" id="2787272">byte</span><span class="op" id="2787276">(</span><span class="op" id="2787277">)</span><span class="op" id="2787278">;</span>&nbsp;<span class="op" id="2787280">!</span><span class="ident" id="2787281">ok</span>&nbsp;<span class="op" id="2787284">||</span>&nbsp;<span class="builtintype" id="2787287">int</span><span class="op" id="2787290">(</span><span class="ident" id="2787291">b</span><span class="op" id="2787292">)</span>&nbsp;<span class="op" id="2787294">&gt;=</span>&nbsp;<span class="builtinfunc" id="2787297">len</span><span class="op" id="2787300">(</span><span class="ident" id="2787301">abbrev</span><span class="op" id="2787307">)</span>&nbsp;<span class="op" id="2787309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787314">return</span>&nbsp;<span class="ident" id="2787321">nil</span><span class="op" id="2787324">,</span>&nbsp;<span class="ident" id="2787326">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787340">zone</span><span class="op" id="2787344">[</span><span class="ident" id="2787345">i</span><span class="op" id="2787346">]</span><span class="op" id="2787347">.</span><span class="ident" id="2787348">name</span>&nbsp;<span class="op" id="2787353">=</span>&nbsp;<span class="ident" id="2787355">byteString</span><span class="op" id="2787365">(</span><span class="ident" id="2787366">abbrev</span><span class="op" id="2787372">[</span><span class="ident" id="2787373">b</span><span class="op" id="2787374">:</span><span class="op" id="2787375">]</span><span class="op" id="2787376">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2787383">//&nbsp;Now&nbsp;the&nbsp;transition&nbsp;time&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787417">tx</span>&nbsp;<span class="op" id="2787420">:=</span>&nbsp;<span class="builtinfunc" id="2787423">make</span><span class="op" id="2787427">(</span><span class="op" id="2787428">[</span><span class="op" id="2787429">]</span><span class="ident" id="2787430">zoneTrans</span><span class="op" id="2787439">,</span>&nbsp;<span class="ident" id="2787441">n</span><span class="op" id="2787442">[</span><span class="ident" id="2787443">NTime</span><span class="op" id="2787448">]</span><span class="op" id="2787449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787452">for</span>&nbsp;<span class="ident" id="2787456">i</span>&nbsp;<span class="op" id="2787458">:=</span>&nbsp;<span class="keyword" id="2787461">range</span>&nbsp;<span class="ident" id="2787467">tx</span>&nbsp;<span class="op" id="2787470">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787474">var</span>&nbsp;<span class="ident" id="2787478">ok</span>&nbsp;<span class="builtintype" id="2787481">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787488">var</span>&nbsp;<span class="ident" id="2787492">n</span>&nbsp;<span class="builtintype" id="2787494">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787503">if</span>&nbsp;<span class="ident" id="2787506">n</span><span class="op" id="2787507">,</span>&nbsp;<span class="ident" id="2787509">ok</span>&nbsp;<span class="op" id="2787512">=</span>&nbsp;<span class="ident" id="2787514">txtimes</span><span class="op" id="2787521">.</span><span class="ident" id="2787522">big4</span><span class="op" id="2787526">(</span><span class="op" id="2787527">)</span><span class="op" id="2787528">;</span>&nbsp;<span class="op" id="2787530">!</span><span class="ident" id="2787531">ok</span>&nbsp;<span class="op" id="2787534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787539">return</span>&nbsp;<span class="ident" id="2787546">nil</span><span class="op" id="2787549">,</span>&nbsp;<span class="ident" id="2787551">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787561">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787565">tx</span><span class="op" id="2787567">[</span><span class="ident" id="2787568">i</span><span class="op" id="2787569">]</span><span class="op" id="2787570">.</span><span class="ident" id="2787571">when</span>&nbsp;<span class="op" id="2787576">=</span>&nbsp;<span class="ident" id="2787578">int64</span><span class="op" id="2787583">(</span><span class="builtintype" id="2787584">int32</span><span class="op" id="2787589">(</span><span class="ident" id="2787590">n</span><span class="op" id="2787591">)</span><span class="op" id="2787592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787596">if</span>&nbsp;<span class="builtintype" id="2787599">int</span><span class="op" id="2787602">(</span><span class="ident" id="2787603">txzones</span><span class="op" id="2787610">[</span><span class="ident" id="2787611">i</span><span class="op" id="2787612">]</span><span class="op" id="2787613">)</span>&nbsp;<span class="op" id="2787615">&gt;=</span>&nbsp;<span class="builtinfunc" id="2787618">len</span><span class="op" id="2787621">(</span><span class="ident" id="2787622">zone</span><span class="op" id="2787626">)</span>&nbsp;<span class="op" id="2787628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787633">return</span>&nbsp;<span class="ident" id="2787640">nil</span><span class="op" id="2787643">,</span>&nbsp;<span class="ident" id="2787645">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787659">tx</span><span class="op" id="2787661">[</span><span class="ident" id="2787662">i</span><span class="op" id="2787663">]</span><span class="op" id="2787664">.</span><span class="ident" id="2787665">index</span>&nbsp;<span class="op" id="2787671">=</span>&nbsp;<span class="ident" id="2787673">txzones</span><span class="op" id="2787680">[</span><span class="ident" id="2787681">i</span><span class="op" id="2787682">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787686">if</span>&nbsp;<span class="ident" id="2787689">i</span>&nbsp;<span class="op" id="2787691">&lt;</span>&nbsp;<span class="builtinfunc" id="2787693">len</span><span class="op" id="2787696">(</span><span class="ident" id="2787697">isstd</span><span class="op" id="2787702">)</span>&nbsp;<span class="op" id="2787704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787709">tx</span><span class="op" id="2787711">[</span><span class="ident" id="2787712">i</span><span class="op" id="2787713">]</span><span class="op" id="2787714">.</span><span class="ident" id="2787715">isstd</span>&nbsp;<span class="op" id="2787721">=</span>&nbsp;<span class="ident" id="2787723">isstd</span><span class="op" id="2787728">[</span><span class="ident" id="2787729">i</span><span class="op" id="2787730">]</span>&nbsp;<span class="op" id="2787732">!=</span>&nbsp;<span class="num" id="2787735">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787743">if</span>&nbsp;<span class="ident" id="2787746">i</span>&nbsp;<span class="op" id="2787748">&lt;</span>&nbsp;<span class="builtinfunc" id="2787750">len</span><span class="op" id="2787753">(</span><span class="ident" id="2787754">isutc</span><span class="op" id="2787759">)</span>&nbsp;<span class="op" id="2787761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787766">tx</span><span class="op" id="2787768">[</span><span class="ident" id="2787769">i</span><span class="op" id="2787770">]</span><span class="op" id="2787771">.</span><span class="ident" id="2787772">isutc</span>&nbsp;<span class="op" id="2787778">=</span>&nbsp;<span class="ident" id="2787780">isutc</span><span class="op" id="2787785">[</span><span class="ident" id="2787786">i</span><span class="op" id="2787787">]</span>&nbsp;<span class="op" id="2787789">!=</span>&nbsp;<span class="num" id="2787792">0</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787803">if</span>&nbsp;<span class="builtinfunc" id="2787806">len</span><span class="op" id="2787809">(</span><span class="ident" id="2787810">tx</span><span class="op" id="2787812">)</span>&nbsp;<span class="op" id="2787814">==</span>&nbsp;<span class="num" id="2787817">0</span>&nbsp;<span class="op" id="2787819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2787823">//&nbsp;Build&nbsp;fake&nbsp;transition&nbsp;to&nbsp;cover&nbsp;all&nbsp;time.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2787869">//&nbsp;This&nbsp;happens&nbsp;in&nbsp;fixed&nbsp;locations&nbsp;like&nbsp;&#34;Etc/GMT0&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787923">tx</span>&nbsp;<span class="op" id="2787926">=</span>&nbsp;<span class="builtinfunc" id="2787928">append</span><span class="op" id="2787934">(</span><span class="ident" id="2787935">tx</span><span class="op" id="2787937">,</span>&nbsp;<span class="ident" id="2787939">zoneTrans</span><span class="op" id="2787948">{</span><span class="ident" id="2787949">when</span><span class="op" id="2787953">:</span>&nbsp;<span class="ident" id="2787955">alpha</span><span class="op" id="2787960">,</span>&nbsp;<span class="ident" id="2787962">index</span><span class="op" id="2787967">:</span>&nbsp;<span class="num" id="2787969">0</span><span class="op" id="2787970">}</span><span class="op" id="2787971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2787978">//&nbsp;Committed&nbsp;to&nbsp;succeed.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788004">l</span>&nbsp;<span class="op" id="2788006">=</span>&nbsp;<span class="op" id="2788008">&amp;</span><span class="ident" id="2788009">Location</span><span class="op" id="2788017">{</span><span class="ident" id="2788018">zone</span><span class="op" id="2788022">:</span>&nbsp;<span class="ident" id="2788024">zone</span><span class="op" id="2788028">,</span>&nbsp;<span class="ident" id="2788030">tx</span><span class="op" id="2788032">:</span>&nbsp;<span class="ident" id="2788034">tx</span><span class="op" id="2788036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2788040">//&nbsp;Fill&nbsp;in&nbsp;the&nbsp;cache&nbsp;with&nbsp;information&nbsp;about&nbsp;right&nbsp;now,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2788096">//&nbsp;since&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;most&nbsp;common&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788143">sec</span><span class="op" id="2788146">,</span>&nbsp;<span class="ident" id="2788148">_</span>&nbsp;<span class="op" id="2788150">:=</span>&nbsp;<span class="ident" id="2788153">now</span><span class="op" id="2788156">(</span><span class="op" id="2788157">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788160">for</span>&nbsp;<span class="ident" id="2788164">i</span>&nbsp;<span class="op" id="2788166">:=</span>&nbsp;<span class="keyword" id="2788169">range</span>&nbsp;<span class="ident" id="2788175">tx</span>&nbsp;<span class="op" id="2788178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788182">if</span>&nbsp;<span class="ident" id="2788185">tx</span><span class="op" id="2788187">[</span><span class="ident" id="2788188">i</span><span class="op" id="2788189">]</span><span class="op" id="2788190">.</span><span class="ident" id="2788191">when</span>&nbsp;<span class="op" id="2788196">&lt;=</span>&nbsp;<span class="ident" id="2788199">sec</span>&nbsp;<span class="op" id="2788203">&amp;&amp;</span>&nbsp;<span class="op" id="2788206">(</span><span class="ident" id="2788207">i</span><span class="op" id="2788208">+</span><span class="num" id="2788209">1</span>&nbsp;<span class="op" id="2788211">==</span>&nbsp;<span class="builtinfunc" id="2788214">len</span><span class="op" id="2788217">(</span><span class="ident" id="2788218">tx</span><span class="op" id="2788220">)</span>&nbsp;<span class="op" id="2788222">||</span>&nbsp;<span class="ident" id="2788225">sec</span>&nbsp;<span class="op" id="2788229">&lt;</span>&nbsp;<span class="ident" id="2788231">tx</span><span class="op" id="2788233">[</span><span class="ident" id="2788234">i</span><span class="op" id="2788235">+</span><span class="num" id="2788236">1</span><span class="op" id="2788237">]</span><span class="op" id="2788238">.</span><span class="ident" id="2788239">when</span><span class="op" id="2788243">)</span>&nbsp;<span class="op" id="2788245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788250">l</span><span class="op" id="2788251">.</span><span class="ident" id="2788252">cacheStart</span>&nbsp;<span class="op" id="2788263">=</span>&nbsp;<span class="ident" id="2788265">tx</span><span class="op" id="2788267">[</span><span class="ident" id="2788268">i</span><span class="op" id="2788269">]</span><span class="op" id="2788270">.</span><span class="ident" id="2788271">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788279">l</span><span class="op" id="2788280">.</span><span class="ident" id="2788281">cacheEnd</span>&nbsp;<span class="op" id="2788290">=</span>&nbsp;<span class="ident" id="2788292">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788301">if</span>&nbsp;<span class="ident" id="2788304">i</span><span class="op" id="2788305">+</span><span class="num" id="2788306">1</span>&nbsp;<span class="op" id="2788308">&lt;</span>&nbsp;<span class="builtinfunc" id="2788310">len</span><span class="op" id="2788313">(</span><span class="ident" id="2788314">tx</span><span class="op" id="2788316">)</span>&nbsp;<span class="op" id="2788318">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788324">l</span><span class="op" id="2788325">.</span><span class="ident" id="2788326">cacheEnd</span>&nbsp;<span class="op" id="2788335">=</span>&nbsp;<span class="ident" id="2788337">tx</span><span class="op" id="2788339">[</span><span class="ident" id="2788340">i</span><span class="op" id="2788341">+</span><span class="num" id="2788342">1</span><span class="op" id="2788343">]</span><span class="op" id="2788344">.</span><span class="ident" id="2788345">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2788353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788358">l</span><span class="op" id="2788359">.</span><span class="ident" id="2788360">cacheZone</span>&nbsp;<span class="op" id="2788370">=</span>&nbsp;<span class="op" id="2788372">&amp;</span><span class="ident" id="2788373">l</span><span class="op" id="2788374">.</span><span class="ident" id="2788375">zone</span><span class="op" id="2788379">[</span><span class="ident" id="2788380">tx</span><span class="op" id="2788382">[</span><span class="ident" id="2788383">i</span><span class="op" id="2788384">]</span><span class="op" id="2788385">.</span><span class="ident" id="2788386">index</span><span class="op" id="2788391">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2788395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2788398">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788402">return</span>&nbsp;<span class="ident" id="2788409">l</span><span class="op" id="2788410">,</span>&nbsp;<span class="ident" id="2788412">nil</span><br>
<span class="lineno"></span><span class="op" id="2788416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2788419">func</span>&nbsp;<span class="ident" id="2788424">loadZoneFile</span><span class="op" id="2788436">(</span><span class="ident" id="2788437">dir</span><span class="op" id="2788440">,</span>&nbsp;<span class="ident" id="2788442">name</span>&nbsp;<span class="builtintype" id="2788447">string</span><span class="op" id="2788453">)</span>&nbsp;<span class="op" id="2788455">(</span><span class="ident" id="2788456">l</span>&nbsp;<span class="op" id="2788458">*</span><span class="ident" id="2788459">Location</span><span class="op" id="2788467">,</span>&nbsp;<span class="ident" id="2788469">err</span>&nbsp;<span class="builtintype" id="2788473">error</span><span class="op" id="2788478">)</span>&nbsp;<span class="op" id="2788480">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788483">if</span>&nbsp;<span class="builtinfunc" id="2788486">len</span><span class="op" id="2788489">(</span><span class="ident" id="2788490">dir</span><span class="op" id="2788493">)</span>&nbsp;<span class="op" id="2788495">&gt;</span>&nbsp;<span class="num" id="2788497">4</span>&nbsp;<span class="op" id="2788499">&amp;&amp;</span>&nbsp;<span class="ident" id="2788502">dir</span><span class="op" id="2788505">[</span><span class="builtinfunc" id="2788506">len</span><span class="op" id="2788509">(</span><span class="ident" id="2788510">dir</span><span class="op" id="2788513">)</span><span class="op" id="2788514">-</span><span class="num" id="2788515">4</span><span class="op" id="2788516">:</span><span class="op" id="2788517">]</span>&nbsp;<span class="op" id="2788519">==</span>&nbsp;<span class="string" id="2788522">&#34;.zip&#34;</span>&nbsp;<span class="op" id="2788529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788533">return</span>&nbsp;<span class="ident" id="2788540">loadZoneZip</span><span class="op" id="2788551">(</span><span class="ident" id="2788552">dir</span><span class="op" id="2788555">,</span>&nbsp;<span class="ident" id="2788557">name</span><span class="op" id="2788561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2788564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788567">if</span>&nbsp;<span class="ident" id="2788570">dir</span>&nbsp;<span class="op" id="2788574">!=</span>&nbsp;<span class="string" id="2788577">&#34;&#34;</span>&nbsp;<span class="op" id="2788580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788584">name</span>&nbsp;<span class="op" id="2788589">=</span>&nbsp;<span class="ident" id="2788591">dir</span>&nbsp;<span class="op" id="2788595">+</span>&nbsp;<span class="string" id="2788597">&#34;/&#34;</span>&nbsp;<span class="op" id="2788601">+</span>&nbsp;<span class="ident" id="2788603">name</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2788609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788612">buf</span><span class="op" id="2788615">,</span>&nbsp;<span class="ident" id="2788617">err</span>&nbsp;<span class="op" id="2788621">:=</span>&nbsp;<span class="ident" id="2788624">readFile</span><span class="op" id="2788632">(</span><span class="ident" id="2788633">name</span><span class="op" id="2788637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788640">if</span>&nbsp;<span class="ident" id="2788643">err</span>&nbsp;<span class="op" id="2788647">!=</span>&nbsp;<span class="ident" id="2788650">nil</span>&nbsp;<span class="op" id="2788654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788658">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2788666">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788669">return</span>&nbsp;<span class="ident" id="2788676">loadZoneData</span><span class="op" id="2788688">(</span><span class="ident" id="2788689">buf</span><span class="op" id="2788692">)</span><br>
<span class="lineno"></span><span class="op" id="2788694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2788697">//&nbsp;There&nbsp;are&nbsp;500+&nbsp;zoneinfo&nbsp;files.&nbsp;&nbsp;Rather&nbsp;than&nbsp;distribute&nbsp;them&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2788764">//&nbsp;individually,&nbsp;we&nbsp;ship&nbsp;them&nbsp;in&nbsp;an&nbsp;uncompressed&nbsp;zip&nbsp;file.</span><br>
<span class="lineno">215</span><span class="comment" id="2788823">//&nbsp;Used&nbsp;this&nbsp;way,&nbsp;the&nbsp;zip&nbsp;file&nbsp;format&nbsp;serves&nbsp;as&nbsp;a&nbsp;commonly&nbsp;readable</span><br>
<span class="lineno"></span><span class="comment" id="2788891">//&nbsp;container&nbsp;for&nbsp;the&nbsp;individual&nbsp;small&nbsp;files.&nbsp;&nbsp;We&nbsp;choose&nbsp;zip&nbsp;over&nbsp;tar</span><br>
<span class="lineno"></span><span class="comment" id="2788960">//&nbsp;because&nbsp;zip&nbsp;files&nbsp;have&nbsp;a&nbsp;contiguous&nbsp;table&nbsp;of&nbsp;contents,&nbsp;making</span><br>
<span class="lineno"></span><span class="comment" id="2789025">//&nbsp;individual&nbsp;file&nbsp;lookups&nbsp;faster,&nbsp;and&nbsp;because&nbsp;the&nbsp;per-file&nbsp;overhead</span><br>
<span class="lineno"></span><span class="comment" id="2789094">//&nbsp;in&nbsp;a&nbsp;zip&nbsp;file&nbsp;is&nbsp;considerably&nbsp;less&nbsp;than&nbsp;tar&#39;s&nbsp;512&nbsp;bytes.</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2789155">//&nbsp;get4&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;32-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="2789208">func</span>&nbsp;<span class="ident" id="2789213">get4</span><span class="op" id="2789217">(</span><span class="ident" id="2789218">b</span>&nbsp;<span class="op" id="2789220">[</span><span class="op" id="2789221">]</span><span class="builtintype" id="2789222">byte</span><span class="op" id="2789226">)</span>&nbsp;<span class="builtintype" id="2789228">int</span>&nbsp;<span class="op" id="2789232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789235">if</span>&nbsp;<span class="builtinfunc" id="2789238">len</span><span class="op" id="2789241">(</span><span class="ident" id="2789242">b</span><span class="op" id="2789243">)</span>&nbsp;<span class="op" id="2789245">&lt;</span>&nbsp;<span class="num" id="2789247">4</span>&nbsp;<span class="op" id="2789249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789253">return</span>&nbsp;<span class="num" id="2789260">0</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789266">return</span>&nbsp;<span class="builtintype" id="2789273">int</span><span class="op" id="2789276">(</span><span class="ident" id="2789277">b</span><span class="op" id="2789278">[</span><span class="num" id="2789279">0</span><span class="op" id="2789280">]</span><span class="op" id="2789281">)</span>&nbsp;<span class="op" id="2789283">|</span>&nbsp;<span class="builtintype" id="2789285">int</span><span class="op" id="2789288">(</span><span class="ident" id="2789289">b</span><span class="op" id="2789290">[</span><span class="num" id="2789291">1</span><span class="op" id="2789292">]</span><span class="op" id="2789293">)</span><span class="op" id="2789294">&lt;&lt;</span><span class="num" id="2789296">8</span>&nbsp;<span class="op" id="2789298">|</span>&nbsp;<span class="builtintype" id="2789300">int</span><span class="op" id="2789303">(</span><span class="ident" id="2789304">b</span><span class="op" id="2789305">[</span><span class="num" id="2789306">2</span><span class="op" id="2789307">]</span><span class="op" id="2789308">)</span><span class="op" id="2789309">&lt;&lt;</span><span class="num" id="2789311">16</span>&nbsp;<span class="op" id="2789314">|</span>&nbsp;<span class="builtintype" id="2789316">int</span><span class="op" id="2789319">(</span><span class="ident" id="2789320">b</span><span class="op" id="2789321">[</span><span class="num" id="2789322">3</span><span class="op" id="2789323">]</span><span class="op" id="2789324">)</span><span class="op" id="2789325">&lt;&lt;</span><span class="num" id="2789327">24</span><br>
<span class="lineno"></span><span class="op" id="2789330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2789333">//&nbsp;get2&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;16-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno">230</span><span class="keyword" id="2789386">func</span>&nbsp;<span class="ident" id="2789391">get2</span><span class="op" id="2789395">(</span><span class="ident" id="2789396">b</span>&nbsp;<span class="op" id="2789398">[</span><span class="op" id="2789399">]</span><span class="builtintype" id="2789400">byte</span><span class="op" id="2789404">)</span>&nbsp;<span class="builtintype" id="2789406">int</span>&nbsp;<span class="op" id="2789410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789413">if</span>&nbsp;<span class="builtinfunc" id="2789416">len</span><span class="op" id="2789419">(</span><span class="ident" id="2789420">b</span><span class="op" id="2789421">)</span>&nbsp;<span class="op" id="2789423">&lt;</span>&nbsp;<span class="num" id="2789425">2</span>&nbsp;<span class="op" id="2789427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789431">return</span>&nbsp;<span class="num" id="2789438">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789444">return</span>&nbsp;<span class="builtintype" id="2789451">int</span><span class="op" id="2789454">(</span><span class="ident" id="2789455">b</span><span class="op" id="2789456">[</span><span class="num" id="2789457">0</span><span class="op" id="2789458">]</span><span class="op" id="2789459">)</span>&nbsp;<span class="op" id="2789461">|</span>&nbsp;<span class="builtintype" id="2789463">int</span><span class="op" id="2789466">(</span><span class="ident" id="2789467">b</span><span class="op" id="2789468">[</span><span class="num" id="2789469">1</span><span class="op" id="2789470">]</span><span class="op" id="2789471">)</span><span class="op" id="2789472">&lt;&lt;</span><span class="num" id="2789474">8</span><br>
<span class="lineno">235</span><span class="op" id="2789476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2789479">func</span>&nbsp;<span class="ident" id="2789484">loadZoneZip</span><span class="op" id="2789495">(</span><span class="ident" id="2789496">zipfile</span><span class="op" id="2789503">,</span>&nbsp;<span class="ident" id="2789505">name</span>&nbsp;<span class="builtintype" id="2789510">string</span><span class="op" id="2789516">)</span>&nbsp;<span class="op" id="2789518">(</span><span class="ident" id="2789519">l</span>&nbsp;<span class="op" id="2789521">*</span><span class="ident" id="2789522">Location</span><span class="op" id="2789530">,</span>&nbsp;<span class="ident" id="2789532">err</span>&nbsp;<span class="builtintype" id="2789536">error</span><span class="op" id="2789541">)</span>&nbsp;<span class="op" id="2789543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789546">fd</span><span class="op" id="2789548">,</span>&nbsp;<span class="ident" id="2789550">err</span>&nbsp;<span class="op" id="2789554">:=</span>&nbsp;<span class="ident" id="2789557">open</span><span class="op" id="2789561">(</span><span class="ident" id="2789562">zipfile</span><span class="op" id="2789569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789572">if</span>&nbsp;<span class="ident" id="2789575">err</span>&nbsp;<span class="op" id="2789579">!=</span>&nbsp;<span class="ident" id="2789582">nil</span>&nbsp;<span class="op" id="2789586">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789590">return</span>&nbsp;<span class="ident" id="2789597">nil</span><span class="op" id="2789600">,</span>&nbsp;<span class="ident" id="2789602">errors</span><span class="op" id="2789608">.</span><span class="ident" id="2789609">New</span><span class="op" id="2789612">(</span><span class="string" id="2789613">&#34;open&nbsp;&#34;</span>&nbsp;<span class="op" id="2789621">+</span>&nbsp;<span class="ident" id="2789623">zipfile</span>&nbsp;<span class="op" id="2789631">+</span>&nbsp;<span class="string" id="2789633">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2789638">+</span>&nbsp;<span class="ident" id="2789640">err</span><span class="op" id="2789643">.</span><span class="ident" id="2789644">Error</span><span class="op" id="2789649">(</span><span class="op" id="2789650">)</span><span class="op" id="2789651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789657">defer</span>&nbsp;<span class="ident" id="2789663">closefd</span><span class="op" id="2789670">(</span><span class="ident" id="2789671">fd</span><span class="op" id="2789673">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789677">const</span>&nbsp;<span class="op" id="2789683">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789687">zecheader</span>&nbsp;<span class="op" id="2789697">=</span>&nbsp;<span class="num" id="2789699">0x06054b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789712">zcheader</span>&nbsp;&nbsp;<span class="op" id="2789722">=</span>&nbsp;<span class="num" id="2789724">0x02014b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789737">ztailsize</span>&nbsp;<span class="op" id="2789747">=</span>&nbsp;<span class="num" id="2789749">22</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789755">zheadersize</span>&nbsp;<span class="op" id="2789767">=</span>&nbsp;<span class="num" id="2789769">30</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789774">zheader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789786">=</span>&nbsp;<span class="num" id="2789788">0x04034b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789804">buf</span>&nbsp;<span class="op" id="2789808">:=</span>&nbsp;<span class="builtinfunc" id="2789811">make</span><span class="op" id="2789815">(</span><span class="op" id="2789816">[</span><span class="op" id="2789817">]</span><span class="builtintype" id="2789818">byte</span><span class="op" id="2789822">,</span>&nbsp;<span class="ident" id="2789824">ztailsize</span><span class="op" id="2789833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789836">if</span>&nbsp;<span class="ident" id="2789839">err</span>&nbsp;<span class="op" id="2789843">:=</span>&nbsp;<span class="ident" id="2789846">preadn</span><span class="op" id="2789852">(</span><span class="ident" id="2789853">fd</span><span class="op" id="2789855">,</span>&nbsp;<span class="ident" id="2789857">buf</span><span class="op" id="2789860">,</span>&nbsp;<span class="op" id="2789862">-</span><span class="ident" id="2789863">ztailsize</span><span class="op" id="2789872">)</span><span class="op" id="2789873">;</span>&nbsp;<span class="ident" id="2789875">err</span>&nbsp;<span class="op" id="2789879">!=</span>&nbsp;<span class="ident" id="2789882">nil</span>&nbsp;<span class="op" id="2789886">||</span>&nbsp;<span class="ident" id="2789889">get4</span><span class="op" id="2789893">(</span><span class="ident" id="2789894">buf</span><span class="op" id="2789897">)</span>&nbsp;<span class="op" id="2789899">!=</span>&nbsp;<span class="ident" id="2789902">zecheader</span>&nbsp;<span class="op" id="2789912">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789916">return</span>&nbsp;<span class="ident" id="2789923">nil</span><span class="op" id="2789926">,</span>&nbsp;<span class="ident" id="2789928">errors</span><span class="op" id="2789934">.</span><span class="ident" id="2789935">New</span><span class="op" id="2789938">(</span><span class="string" id="2789939">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2789959">+</span>&nbsp;<span class="ident" id="2789961">zipfile</span><span class="op" id="2789968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789974">n</span>&nbsp;<span class="op" id="2789976">:=</span>&nbsp;<span class="ident" id="2789979">get2</span><span class="op" id="2789983">(</span><span class="ident" id="2789984">buf</span><span class="op" id="2789987">[</span><span class="num" id="2789988">10</span><span class="op" id="2789990">:</span><span class="op" id="2789991">]</span><span class="op" id="2789992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789995">size</span>&nbsp;<span class="op" id="2790000">:=</span>&nbsp;<span class="ident" id="2790003">get4</span><span class="op" id="2790007">(</span><span class="ident" id="2790008">buf</span><span class="op" id="2790011">[</span><span class="num" id="2790012">12</span><span class="op" id="2790014">:</span><span class="op" id="2790015">]</span><span class="op" id="2790016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2790019">off</span>&nbsp;<span class="op" id="2790023">:=</span>&nbsp;<span class="ident" id="2790026">get4</span><span class="op" id="2790030">(</span><span class="ident" id="2790031">buf</span><span class="op" id="2790034">[</span><span class="num" id="2790035">16</span><span class="op" id="2790037">:</span><span class="op" id="2790038">]</span><span class="op" id="2790039">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2790043">buf</span>&nbsp;<span class="op" id="2790047">=</span>&nbsp;<span class="builtinfunc" id="2790049">make</span><span class="op" id="2790053">(</span><span class="op" id="2790054">[</span><span class="op" id="2790055">]</span><span class="builtintype" id="2790056">byte</span><span class="op" id="2790060">,</span>&nbsp;<span class="ident" id="2790062">size</span><span class="op" id="2790066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790069">if</span>&nbsp;<span class="ident" id="2790072">err</span>&nbsp;<span class="op" id="2790076">:=</span>&nbsp;<span class="ident" id="2790079">preadn</span><span class="op" id="2790085">(</span><span class="ident" id="2790086">fd</span><span class="op" id="2790088">,</span>&nbsp;<span class="ident" id="2790090">buf</span><span class="op" id="2790093">,</span>&nbsp;<span class="ident" id="2790095">off</span><span class="op" id="2790098">)</span><span class="op" id="2790099">;</span>&nbsp;<span class="ident" id="2790101">err</span>&nbsp;<span class="op" id="2790105">!=</span>&nbsp;<span class="ident" id="2790108">nil</span>&nbsp;<span class="op" id="2790112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790116">return</span>&nbsp;<span class="ident" id="2790123">nil</span><span class="op" id="2790126">,</span>&nbsp;<span class="ident" id="2790128">errors</span><span class="op" id="2790134">.</span><span class="ident" id="2790135">New</span><span class="op" id="2790138">(</span><span class="string" id="2790139">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2790159">+</span>&nbsp;<span class="ident" id="2790161">zipfile</span><span class="op" id="2790168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2790171">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790175">for</span>&nbsp;<span class="ident" id="2790179">i</span>&nbsp;<span class="op" id="2790181">:=</span>&nbsp;<span class="num" id="2790184">0</span><span class="op" id="2790185">;</span>&nbsp;<span class="ident" id="2790187">i</span>&nbsp;<span class="op" id="2790189">&lt;</span>&nbsp;<span class="ident" id="2790191">n</span><span class="op" id="2790192">;</span>&nbsp;<span class="ident" id="2790194">i</span><span class="op" id="2790195">++</span>&nbsp;<span class="op" id="2790198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790202">//&nbsp;zip&nbsp;entry&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790225">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790241">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspmadevers[1]</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790260">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspmadeos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790277">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790295">//&nbsp;&nbsp;&nbsp;&nbsp7&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790311">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790327">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790343">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790362">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790381">//&nbsp;&nbsp;&nbsp;&nbsp16&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790396">//&nbsp;&nbsp;&nbsp;&nbsp20&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790413">//&nbsp;&nbsp;&nbsp;&nbsp24&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790432">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790451">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790467">//&nbsp;&nbsp;&nbsp;&nbsp32&nbsp;&nbsp;&nbsp;&nbspfclen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790484">//&nbsp;&nbsp;&nbsp;&nbsp34&nbsp;&nbsp;&nbsp;&nbspdisknum[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790503">//&nbsp;&nbsp;&nbsp;&nbsp36&nbsp;&nbsp;&nbsp;&nbspiattr[2]</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790520">//&nbsp;&nbsp;&nbsp;&nbsp38&nbsp;&nbsp;&nbsp;&nbspeattr[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790537">//&nbsp;&nbsp;&nbsp;&nbsp42&nbsp;&nbsp;&nbsp;&nbspoff[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790552">//&nbsp;&nbsp;&nbsp;&nbsp46&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790574">//&nbsp;&nbsp;&nbsp;&nbsp46+namelen+xlen+fclen&nbsp;-&nbsp;next&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790615">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790620">if</span>&nbsp;<span class="ident" id="2790623">get4</span><span class="op" id="2790627">(</span><span class="ident" id="2790628">buf</span><span class="op" id="2790631">)</span>&nbsp;<span class="op" id="2790633">!=</span>&nbsp;<span class="ident" id="2790636">zcheader</span>&nbsp;<span class="op" id="2790645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790650">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2790658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2790662">meth</span>&nbsp;<span class="op" id="2790667">:=</span>&nbsp;<span class="ident" id="2790670">get2</span><span class="op" id="2790674">(</span><span class="ident" id="2790675">buf</span><span class="op" id="2790678">[</span><span class="num" id="2790679">10</span><span class="op" id="2790681">:</span><span class="op" id="2790682">]</span><span class="op" id="2790683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2790687">size</span>&nbsp;<span class="op" id="2790692">:=</span>&nbsp;<span class="ident" id="2790695">get4</span><span class="op" id="2790699">(</span><span class="ident" id="2790700">buf</span><span class="op" id="2790703">[</span><span class="num" id="2790704">24</span><span class="op" id="2790706">:</span><span class="op" id="2790707">]</span><span class="op" id="2790708">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2790712">namelen</span>&nbsp;<span class="op" id="2790720">:=</span>&nbsp;<span class="ident" id="2790723">get2</span><span class="op" id="2790727">(</span><span class="ident" id="2790728">buf</span><span class="op" id="2790731">[</span><span class="num" id="2790732">28</span><span class="op" id="2790734">:</span><span class="op" id="2790735">]</span><span class="op" id="2790736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2790740">xlen</span>&nbsp;<span class="op" id="2790745">:=</span>&nbsp;<span class="ident" id="2790748">get2</span><span class="op" id="2790752">(</span><span class="ident" id="2790753">buf</span><span class="op" id="2790756">[</span><span class="num" id="2790757">30</span><span class="op" id="2790759">:</span><span class="op" id="2790760">]</span><span class="op" id="2790761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2790765">fclen</span>&nbsp;<span class="op" id="2790771">:=</span>&nbsp;<span class="ident" id="2790774">get2</span><span class="op" id="2790778">(</span><span class="ident" id="2790779">buf</span><span class="op" id="2790782">[</span><span class="num" id="2790783">32</span><span class="op" id="2790785">:</span><span class="op" id="2790786">]</span><span class="op" id="2790787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2790791">off</span>&nbsp;<span class="op" id="2790795">:=</span>&nbsp;<span class="ident" id="2790798">get4</span><span class="op" id="2790802">(</span><span class="ident" id="2790803">buf</span><span class="op" id="2790806">[</span><span class="num" id="2790807">42</span><span class="op" id="2790809">:</span><span class="op" id="2790810">]</span><span class="op" id="2790811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2790815">zname</span>&nbsp;<span class="op" id="2790821">:=</span>&nbsp;<span class="ident" id="2790824">buf</span><span class="op" id="2790827">[</span><span class="num" id="2790828">46</span>&nbsp;<span class="op" id="2790831">:</span>&nbsp;<span class="num" id="2790833">46</span><span class="op" id="2790835">+</span><span class="ident" id="2790836">namelen</span><span class="op" id="2790843">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2790847">buf</span>&nbsp;<span class="op" id="2790851">=</span>&nbsp;<span class="ident" id="2790853">buf</span><span class="op" id="2790856">[</span><span class="num" id="2790857">46</span><span class="op" id="2790859">+</span><span class="ident" id="2790860">namelen</span><span class="op" id="2790867">+</span><span class="ident" id="2790868">xlen</span><span class="op" id="2790872">+</span><span class="ident" id="2790873">fclen</span><span class="op" id="2790878">:</span><span class="op" id="2790879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790883">if</span>&nbsp;<span class="builtintype" id="2790886">string</span><span class="op" id="2790892">(</span><span class="ident" id="2790893">zname</span><span class="op" id="2790898">)</span>&nbsp;<span class="op" id="2790900">!=</span>&nbsp;<span class="ident" id="2790903">name</span>&nbsp;<span class="op" id="2790908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790913">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2790924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790928">if</span>&nbsp;<span class="ident" id="2790931">meth</span>&nbsp;<span class="op" id="2790936">!=</span>&nbsp;<span class="num" id="2790939">0</span>&nbsp;<span class="op" id="2790941">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790946">return</span>&nbsp;<span class="ident" id="2790953">nil</span><span class="op" id="2790956">,</span>&nbsp;<span class="ident" id="2790958">errors</span><span class="op" id="2790964">.</span><span class="ident" id="2790965">New</span><span class="op" id="2790968">(</span><span class="string" id="2790969">&#34;unsupported&nbsp;compression&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2791000">+</span>&nbsp;<span class="ident" id="2791002">name</span>&nbsp;<span class="op" id="2791007">+</span>&nbsp;<span class="string" id="2791009">&#34;&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="2791016">+</span>&nbsp;<span class="ident" id="2791018">zipfile</span><span class="op" id="2791025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791034">//&nbsp;zip&nbsp;per-file&nbsp;header&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791067">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791083">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791101">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791117">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791133">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791148">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791167">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791186">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791201">//&nbsp;&nbsp;&nbsp;&nbsp18&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791218">//&nbsp;&nbsp;&nbsp;&nbsp22&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791237">//&nbsp;&nbsp;&nbsp;&nbsp26&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791256">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791272">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791294">//&nbsp;&nbsp;&nbsp;&nbsp30+namelen+xlen&nbsp;-&nbsp;file&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791327">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791332">buf</span>&nbsp;<span class="op" id="2791336">=</span>&nbsp;<span class="builtinfunc" id="2791338">make</span><span class="op" id="2791342">(</span><span class="op" id="2791343">[</span><span class="op" id="2791344">]</span><span class="builtintype" id="2791345">byte</span><span class="op" id="2791349">,</span>&nbsp;<span class="ident" id="2791351">zheadersize</span><span class="op" id="2791362">+</span><span class="ident" id="2791363">namelen</span><span class="op" id="2791370">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791374">if</span>&nbsp;<span class="ident" id="2791377">err</span>&nbsp;<span class="op" id="2791381">:=</span>&nbsp;<span class="ident" id="2791384">preadn</span><span class="op" id="2791390">(</span><span class="ident" id="2791391">fd</span><span class="op" id="2791393">,</span>&nbsp;<span class="ident" id="2791395">buf</span><span class="op" id="2791398">,</span>&nbsp;<span class="ident" id="2791400">off</span><span class="op" id="2791403">)</span><span class="op" id="2791404">;</span>&nbsp;<span class="ident" id="2791406">err</span>&nbsp;<span class="op" id="2791410">!=</span>&nbsp;<span class="ident" id="2791413">nil</span>&nbsp;<span class="op" id="2791417">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791423">get4</span><span class="op" id="2791427">(</span><span class="ident" id="2791428">buf</span><span class="op" id="2791431">)</span>&nbsp;<span class="op" id="2791433">!=</span>&nbsp;<span class="ident" id="2791436">zheader</span>&nbsp;<span class="op" id="2791444">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791450">get2</span><span class="op" id="2791454">(</span><span class="ident" id="2791455">buf</span><span class="op" id="2791458">[</span><span class="num" id="2791459">8</span><span class="op" id="2791460">:</span><span class="op" id="2791461">]</span><span class="op" id="2791462">)</span>&nbsp;<span class="op" id="2791464">!=</span>&nbsp;<span class="ident" id="2791467">meth</span>&nbsp;<span class="op" id="2791472">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791478">get2</span><span class="op" id="2791482">(</span><span class="ident" id="2791483">buf</span><span class="op" id="2791486">[</span><span class="num" id="2791487">26</span><span class="op" id="2791489">:</span><span class="op" id="2791490">]</span><span class="op" id="2791491">)</span>&nbsp;<span class="op" id="2791493">!=</span>&nbsp;<span class="ident" id="2791496">namelen</span>&nbsp;<span class="op" id="2791504">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2791510">string</span><span class="op" id="2791516">(</span><span class="ident" id="2791517">buf</span><span class="op" id="2791520">[</span><span class="num" id="2791521">30</span><span class="op" id="2791523">:</span><span class="num" id="2791524">30</span><span class="op" id="2791526">+</span><span class="ident" id="2791527">namelen</span><span class="op" id="2791534">]</span><span class="op" id="2791535">)</span>&nbsp;<span class="op" id="2791537">!=</span>&nbsp;<span class="ident" id="2791540">name</span>&nbsp;<span class="op" id="2791545">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791550">return</span>&nbsp;<span class="ident" id="2791557">nil</span><span class="op" id="2791560">,</span>&nbsp;<span class="ident" id="2791562">errors</span><span class="op" id="2791568">.</span><span class="ident" id="2791569">New</span><span class="op" id="2791572">(</span><span class="string" id="2791573">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2791593">+</span>&nbsp;<span class="ident" id="2791595">zipfile</span><span class="op" id="2791602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791610">xlen</span>&nbsp;<span class="op" id="2791615">=</span>&nbsp;<span class="ident" id="2791617">get2</span><span class="op" id="2791621">(</span><span class="ident" id="2791622">buf</span><span class="op" id="2791625">[</span><span class="num" id="2791626">28</span><span class="op" id="2791628">:</span><span class="op" id="2791629">]</span><span class="op" id="2791630">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791635">buf</span>&nbsp;<span class="op" id="2791639">=</span>&nbsp;<span class="builtinfunc" id="2791641">make</span><span class="op" id="2791645">(</span><span class="op" id="2791646">[</span><span class="op" id="2791647">]</span><span class="builtintype" id="2791648">byte</span><span class="op" id="2791652">,</span>&nbsp;<span class="ident" id="2791654">size</span><span class="op" id="2791658">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791662">if</span>&nbsp;<span class="ident" id="2791665">err</span>&nbsp;<span class="op" id="2791669">:=</span>&nbsp;<span class="ident" id="2791672">preadn</span><span class="op" id="2791678">(</span><span class="ident" id="2791679">fd</span><span class="op" id="2791681">,</span>&nbsp;<span class="ident" id="2791683">buf</span><span class="op" id="2791686">,</span>&nbsp;<span class="ident" id="2791688">off</span><span class="op" id="2791691">+</span><span class="num" id="2791692">30</span><span class="op" id="2791694">+</span><span class="ident" id="2791695">namelen</span><span class="op" id="2791702">+</span><span class="ident" id="2791703">xlen</span><span class="op" id="2791707">)</span><span class="op" id="2791708">;</span>&nbsp;<span class="ident" id="2791710">err</span>&nbsp;<span class="op" id="2791714">!=</span>&nbsp;<span class="ident" id="2791717">nil</span>&nbsp;<span class="op" id="2791721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791726">return</span>&nbsp;<span class="ident" id="2791733">nil</span><span class="op" id="2791736">,</span>&nbsp;<span class="ident" id="2791738">errors</span><span class="op" id="2791744">.</span><span class="ident" id="2791745">New</span><span class="op" id="2791748">(</span><span class="string" id="2791749">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2791769">+</span>&nbsp;<span class="ident" id="2791771">zipfile</span><span class="op" id="2791778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791787">return</span>&nbsp;<span class="ident" id="2791794">loadZoneData</span><span class="op" id="2791806">(</span><span class="ident" id="2791807">buf</span><span class="op" id="2791810">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791817">return</span>&nbsp;<span class="ident" id="2791824">nil</span><span class="op" id="2791827">,</span>&nbsp;<span class="ident" id="2791829">errors</span><span class="op" id="2791835">.</span><span class="ident" id="2791836">New</span><span class="op" id="2791839">(</span><span class="string" id="2791840">&#34;cannot&nbsp;find&nbsp;&#34;</span>&nbsp;<span class="op" id="2791855">+</span>&nbsp;<span class="ident" id="2791857">name</span>&nbsp;<span class="op" id="2791862">+</span>&nbsp;<span class="string" id="2791864">&#34;&nbsp;in&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2791880">+</span>&nbsp;<span class="ident" id="2791882">zipfile</span><span class="op" id="2791889">)</span><br>
<span class="lineno"></span><span class="op" id="2791891">}</span>
</div>
</body>
</html>
